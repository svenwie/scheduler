{"version":3,"file":"ej2-documenteditor.umd.min.js","sources":["../src/document-editor/base/dictionary.js","../src/document-editor/base/unique-format.js","../src/document-editor/base/unique-formats.js","../src/document-editor/document-editor.js","../src/document-editor/implementation/print.js","../src/document-editor/implementation/format/section-format.js","../src/document-editor/implementation/list/level-override.js","../src/document-editor/implementation/list/list.js","../src/document-editor/implementation/format/list-format.js","../src/document-editor/implementation/format/paragraph-format.js","../src/document-editor/implementation/format/character-format.js","../src/document-editor/implementation/editor/editor-helper.js","../src/document-editor/implementation/format/style.js","../src/document-editor/implementation/format/border.js","../src/document-editor/implementation/format/borders.js","../src/document-editor/implementation/format/shading.js","../src/document-editor/implementation/format/table-format.js","../src/document-editor/implementation/format/row-format.js","../src/document-editor/implementation/format/cell-format.js","../src/document-editor/implementation/viewer/page.js","../src/document-editor/implementation/context-menu.js","../src/document-editor/implementation/list/abstract-list.js","../src/document-editor/implementation/list/list-level.js","../src/document-editor/implementation/viewer/layout.js","../src/document-editor/implementation/viewer/render.js","../src/document-editor/implementation/viewer/text-helper.js","../src/document-editor/implementation/viewer/zooming.js","../src/document-editor/implementation/viewer/viewer.js","../src/document-editor/implementation/viewer/sfdt-reader.js","../src/document-editor/implementation/selection/selection-format.js","../src/document-editor/implementation/writer/html-export.js","../src/document-editor/implementation/selection/selection-helper.js","../src/document-editor/implementation/selection/selection.js","../src/document-editor/implementation/search/text-search.js","../src/document-editor/implementation/search/text-search-result.js","../src/document-editor/implementation/search/text-search-results.js","../src/document-editor/implementation/search/search-results.js","../src/document-editor/implementation/search/search.js","../src/document-editor/implementation/search/options-pane.js","../src/document-editor/implementation/editor/table-resizer.js","../src/document-editor/implementation/editor/editor.js","../src/document-editor/implementation/editor-history/history-helper.js","../src/document-editor/implementation/editor-history/base-history-info.js","../src/document-editor/implementation/editor/image-resizer.js","../src/document-editor/implementation/editor-history/history-info.js","../src/document-editor/implementation/editor-history/editor-history.js","../src/document-editor/implementation/writer/word-export.js","../src/document-editor/implementation/writer/text-export.js","../src/document-editor/implementation/writer/sfdt-export.js","../src/document-editor/implementation/dialogs/hyperlink-dialog.js","../src/document-editor/implementation/dialogs/table-dialog.js","../src/document-editor/implementation/dialogs/bookmark-dialog.js","../src/document-editor/implementation/dialogs/table-of-contents-dialog.js","../src/document-editor/implementation/dialogs/page-setup-dialog.js","../src/document-editor/implementation/dialogs/paragraph-dialog.js","../src/document-editor/implementation/dialogs/list-view-model.js","../src/document-editor/implementation/dialogs/list-dialog.js","../src/document-editor/implementation/dialogs/style-dialog.js","../src/document-editor/implementation/dialogs/bullets-and-numbering-dialog.js","../src/document-editor/implementation/dialogs/font-dialog.js","../src/document-editor/implementation/dialogs/table-properties-dialog.js","../src/document-editor/implementation/dialogs/borders-and-shading-dialog.js","../src/document-editor/implementation/dialogs/table-options-dialog.js","../src/document-editor/implementation/dialogs/cell-options-dialog.js","../src/document-editor/implementation/dialogs/styles-dialog.js"],"sourcesContent":["import { isNullOrUndefined } from '@syncfusion/ej2-base';\n/**\n * @private\n */\nvar Dictionary = /** @class */ (function () {\n    function Dictionary() {\n        this.keysInternal = [];\n        this.valuesInternal = [];\n        this.item = [];\n    }\n    Object.defineProperty(Dictionary.prototype, \"length\", {\n        /**\n         * @private\n         */\n        get: function () {\n            return this.keysInternal.length;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(Dictionary.prototype, \"keys\", {\n        /**\n         * @private\n         */\n        get: function () {\n            return this.getItem();\n        },\n        enumerable: true,\n        configurable: true\n    });\n    /**\n     * @private\n     */\n    Dictionary.prototype.getItem = function () {\n        this.item = [];\n        for (var i = 0; i < this.keysInternal.length; i++) {\n            this.item.push(this.keysInternal[i]);\n        }\n        return this.item;\n    };\n    /**\n     * @private\n     */\n    Dictionary.prototype.add = function (key, value) {\n        if (isNullOrUndefined(key)) {\n            throw new ReferenceError('Provided key or value is not valid.');\n        }\n        var index = this.keysInternal.indexOf(key);\n        // if (index < 0 || index > this.keysInternal.length - 1) {\n        if (index < 0) {\n            this.keysInternal.push(key);\n            this.valuesInternal.push(value);\n        }\n        return 1;\n        // else {\n        //     throw new RangeError('An item with the same key has already been added.');\n        // }\n    };\n    /**\n     * @private\n     */\n    Dictionary.prototype.get = function (key) {\n        if (isNullOrUndefined(key)) {\n            throw new ReferenceError('Provided key is not valid.');\n        }\n        var index = this.keysInternal.indexOf(key);\n        if (index < 0 || index > this.keysInternal.length - 1) {\n            throw new RangeError('No item with the specified key has been added.');\n        }\n        else {\n            return this.valuesInternal[index];\n        }\n    };\n    /**\n     * @private\n     */\n    Dictionary.prototype.set = function (key, value) {\n        if (isNullOrUndefined(key)) {\n            throw new ReferenceError('Provided key is not valid.');\n        }\n        var index = this.keysInternal.indexOf(key);\n        if (index < 0 || index > this.keysInternal.length - 1) {\n            throw new RangeError('No item with the specified key has been added.');\n        }\n        else {\n            this.valuesInternal[index] = value;\n        }\n    };\n    /**\n     * @private\n     */\n    Dictionary.prototype.remove = function (key) {\n        if (isNullOrUndefined(key)) {\n            throw new ReferenceError('Provided key is not valid.');\n        }\n        var index = this.keysInternal.indexOf(key);\n        if (index < 0 || index > this.keysInternal.length - 1) {\n            throw new RangeError('No item with the specified key has been added.');\n        }\n        else {\n            this.keysInternal.splice(index, 1);\n            this.valuesInternal.splice(index, 1);\n            return true;\n        }\n    };\n    /**\n     * @private\n     */\n    Dictionary.prototype.containsKey = function (key) {\n        if (isNullOrUndefined(key)) {\n            throw new ReferenceError('Provided key is not valid.');\n        }\n        var index = this.keysInternal.indexOf(key);\n        if (index < 0 || index > this.keysInternal.length - 1) {\n            return false;\n        }\n        return true;\n    };\n    /**\n     * @private\n     */\n    Dictionary.prototype.clear = function () {\n        this.keysInternal = [];\n        this.valuesInternal = [];\n    };\n    /**\n     * @private\n     */\n    Dictionary.prototype.destroy = function () {\n        this.clear();\n        this.keysInternal = undefined;\n        this.valuesInternal = undefined;\n    };\n    return Dictionary;\n}());\nexport { Dictionary };\n","import { isNullOrUndefined } from '@syncfusion/ej2-base';\nimport { Dictionary } from './dictionary';\n/**\n * @private\n */\nvar WUniqueFormat = /** @class */ (function () {\n    function WUniqueFormat(type) {\n        this.referenceCount = 0;\n        this.uniqueFormatType = type;\n        this.propertiesHash = new Dictionary();\n    }\n    /**\n     * @private\n     */\n    WUniqueFormat.prototype.isEqual = function (source, property, modifiedValue) {\n        var isEqual = false;\n        switch (this.uniqueFormatType) {\n            case 1:\n                isEqual = this.isBorderEqual(source, property, modifiedValue);\n                break;\n            case 2:\n                isEqual = this.isCharacterFormatEqual(source, property, modifiedValue);\n                break;\n            case 3:\n                isEqual = this.isParagraphFormatEqual(source, property, modifiedValue);\n                break;\n            case 4:\n                isEqual = this.isCellFormatEqual(source, property, modifiedValue);\n                break;\n            case 5:\n                isEqual = this.isShadingEqual(source, property, modifiedValue);\n                break;\n            case 6:\n                isEqual = this.isRowFormatEqual(source, property, modifiedValue);\n                break;\n            case 7:\n                isEqual = this.isListFormatEqual(source, property, modifiedValue);\n                break;\n            case 8:\n                isEqual = this.isTableFormatEqual(source, property, modifiedValue);\n                break;\n            case 9:\n                isEqual = this.isListLevelEqual(source, property, modifiedValue);\n                break;\n            case 10:\n                isEqual = this.isSectionFormatEqual(source, property, modifiedValue);\n                break;\n            default:\n                break;\n        }\n        return isEqual;\n    };\n    // tslint:disable-next-line:max-line-length\n    WUniqueFormat.prototype.isNotEqual = function (property, source, modifiedProperty, modifiedValue, uniqueFormatType) {\n        var targetValue = undefined;\n        var propertyType = WUniqueFormat.getPropertyType(uniqueFormatType, property);\n        if (this.propertiesHash.containsKey(propertyType)) {\n            targetValue = this.propertiesHash.get(propertyType);\n        }\n        var sourceValue = undefined;\n        if (property === modifiedProperty) {\n            sourceValue = modifiedValue;\n        }\n        else if (source.containsKey(propertyType)) {\n            sourceValue = source.get(propertyType);\n        }\n        // tslint:disable-next-line:max-line-length\n        if (!(targetValue === sourceValue || (!isNullOrUndefined(targetValue) && !isNullOrUndefined(sourceValue) && targetValue === sourceValue))) {\n            return true;\n        }\n        return false;\n    };\n    /**\n     * @private\n     */\n    WUniqueFormat.getPropertyType = function (uniqueFormatType, property) {\n        var type = 0;\n        switch (uniqueFormatType) {\n            case 1:\n                type = this.getBorderPropertyType(property);\n                break;\n            case 2:\n                type = this.getCharacterFormatPropertyType(property);\n                break;\n            case 3:\n                type = this.getParaFormatPropertyType(property);\n                break;\n            case 4:\n                type = this.getCellFormatPropertyType(property);\n                break;\n            case 5:\n                type = this.getShadingPropertyType(property);\n                break;\n            case 6:\n                type = this.getRowFormatType(property);\n                break;\n            case 7:\n                type = this.getListFormatType(property);\n                break;\n            case 8:\n                type = this.getTableFormatType(property);\n                break;\n            case 9:\n                type = this.getListLevelType(property);\n                break;\n            case 10:\n                type = this.getSectionFormatType(property);\n                break;\n            default:\n                break;\n        }\n        return type;\n    };\n    WUniqueFormat.getRowFormatType = function (property) {\n        if (property === 'allowBreakAcrossPages') {\n            return 1;\n        }\n        if (property === 'isHeader') {\n            return 2;\n        }\n        if (property === 'height') {\n            return 3;\n        }\n        if (property === 'heightType') {\n            return 4;\n        }\n        if (property === 'gridBefore') {\n            return 5;\n        }\n        if (property === 'gridBeforeWidth') {\n            return 6;\n        }\n        if (property === 'gridBeforeWidthType') {\n            return 7;\n        }\n        if (property === 'gridAfter') {\n            return 8;\n        }\n        if (property === 'gridAfterWidth') {\n            return 9;\n        }\n        if (property === 'gridAfterWidthType') {\n            return 10;\n        }\n        return 0;\n    };\n    WUniqueFormat.getListFormatType = function (property) {\n        if (property === 'listId') {\n            return 1;\n        }\n        if (property === 'listLevelNumber') {\n            return 2;\n        }\n        return 0;\n    };\n    WUniqueFormat.getTableFormatType = function (property) {\n        if (property === 'leftMargin') {\n            return 1;\n        }\n        if (property === 'rightMargin') {\n            return 2;\n        }\n        if (property === 'topMargin') {\n            return 3;\n        }\n        if (property === 'bottomMargin') {\n            return 4;\n        }\n        if (property === 'cellSpacing') {\n            return 5;\n        }\n        if (property === 'leftIndent') {\n            return 6;\n        }\n        if (property === 'tableAlignment') {\n            return 7;\n        }\n        if (property === 'preferredWidth') {\n            return 8;\n        }\n        if (property === 'preferredWidthType') {\n            return 9;\n        }\n        return 0;\n    };\n    WUniqueFormat.getListLevelType = function (property) {\n        if (property === 'listLevelPattern') {\n            return 1;\n        }\n        if (property === 'startAt') {\n            return 2;\n        }\n        if (property === 'followCharacter') {\n            return 3;\n        }\n        if (property === 'numberFormat') {\n            return 4;\n        }\n        if (property === 'restartLevel') {\n            return 5;\n        }\n        return 0;\n    };\n    WUniqueFormat.getShadingPropertyType = function (property) {\n        if (property === 'backgroundColor') {\n            return 1;\n        }\n        if (property === 'foregroundColor') {\n            return 2;\n        }\n        if (property === 'textureStyle') {\n            return 3;\n        }\n        return 0;\n    };\n    WUniqueFormat.getCellFormatPropertyType = function (property) {\n        if (property === 'leftMargin') {\n            return 1;\n        }\n        if (property === 'rightMargin') {\n            return 2;\n        }\n        if (property === 'topMargin') {\n            return 3;\n        }\n        if (property === 'bottomMargin') {\n            return 4;\n        }\n        if (property === 'columnSpan') {\n            return 5;\n        }\n        if (property === 'rowSpan') {\n            return 6;\n        }\n        if (property === 'verticalAlignment') {\n            return 7;\n        }\n        if (property === 'preferredWidthType') {\n            return 8;\n        }\n        if (property === 'preferredWidth') {\n            return 9;\n        }\n        if (property === 'cellWidth') {\n            return 10;\n        }\n        return 0;\n    };\n    WUniqueFormat.getBorderPropertyType = function (property) {\n        if (property === 'color') {\n            return 1;\n        }\n        if (property === 'lineStyle') {\n            return 2;\n        }\n        if (property === 'lineWidth') {\n            return 3;\n        }\n        if (property === 'shadow') {\n            return 4;\n        }\n        if (property === 'space') {\n            return 5;\n        }\n        if (property === 'hasNoneStyle') {\n            return 6;\n        }\n        return 0;\n    };\n    WUniqueFormat.getCharacterFormatPropertyType = function (property) {\n        if (property === 'fontColor') {\n            return 1;\n        }\n        if (property === 'fontFamily') {\n            return 2;\n        }\n        if (property === 'fontSize') {\n            return 3;\n        }\n        if (property === 'bold') {\n            return 4;\n        }\n        if (property === 'italic') {\n            return 5;\n        }\n        if (property === 'underline') {\n            return 6;\n        }\n        if (property === 'strikethrough') {\n            return 7;\n        }\n        if (property === 'baselineAlignment') {\n            return 8;\n        }\n        if (property === 'highlightColor') {\n            return 9;\n        }\n        return 0;\n    };\n    WUniqueFormat.getParaFormatPropertyType = function (property) {\n        if (property === 'leftIndent') {\n            return 1;\n        }\n        if (property === 'rightIndent') {\n            return 2;\n        }\n        if (property === 'firstLineIndent') {\n            return 3;\n        }\n        if (property === 'textAlignment') {\n            return 4;\n        }\n        if (property === 'beforeSpacing') {\n            return 5;\n        }\n        if (property === 'afterSpacing') {\n            return 6;\n        }\n        if (property === 'lineSpacing') {\n            return 7;\n        }\n        if (property === 'lineSpacingType') {\n            return 8;\n        }\n        if (property === 'outlineLevel') {\n            return 9;\n        }\n        return 0;\n    };\n    WUniqueFormat.getSectionFormatType = function (property) {\n        if (property === 'headerDistance') {\n            return 1;\n        }\n        if (property === 'footerDistance') {\n            return 2;\n        }\n        if (property === 'differentFirstPage') {\n            return 3;\n        }\n        if (property === 'differentOddAndEvenPages') {\n            return 4;\n        }\n        if (property === 'pageWidth') {\n            return 5;\n        }\n        if (property === 'pageHeight') {\n            return 6;\n        }\n        if (property === 'leftMargin') {\n            return 7;\n        }\n        if (property === 'topMargin') {\n            return 8;\n        }\n        if (property === 'rightMargin') {\n            return 9;\n        }\n        if (property === 'bottomMargin') {\n            return 10;\n        }\n        return 0;\n    };\n    /**\n     * @private\n     */\n    WUniqueFormat.prototype.isBorderEqual = function (source, modifiedProperty, modifiedValue) {\n        if (this.isNotEqual('color', source, modifiedProperty, modifiedValue, 1)) {\n            return false;\n        }\n        if (this.isNotEqual('lineStyle', source, modifiedProperty, modifiedValue, 1)) {\n            return false;\n        }\n        if (this.isNotEqual('lineWidth', source, modifiedProperty, modifiedValue, 1)) {\n            return false;\n        }\n        if (this.isNotEqual('shadow', source, modifiedProperty, modifiedValue, 1)) {\n            return false;\n        }\n        if (this.isNotEqual('space', source, modifiedProperty, modifiedValue, 1)) {\n            return false;\n        }\n        if (this.isNotEqual('hasNoneStyle', source, modifiedProperty, modifiedValue, 1)) {\n            return false;\n        }\n        return true;\n    };\n    /**\n     * @private\n     */\n    WUniqueFormat.prototype.isCharacterFormatEqual = function (source, modifiedProperty, modifiedValue) {\n        if (this.isNotEqual('fontColor', source, modifiedProperty, modifiedValue, 2)) {\n            return false;\n        }\n        if (this.isNotEqual('fontFamily', source, modifiedProperty, modifiedValue, 2)) {\n            return false;\n        }\n        if (this.isNotEqual('fontSize', source, modifiedProperty, modifiedValue, 2)) {\n            return false;\n        }\n        if (this.isNotEqual('bold', source, modifiedProperty, modifiedValue, 2)) {\n            return false;\n        }\n        if (this.isNotEqual('italic', source, modifiedProperty, modifiedValue, 2)) {\n            return false;\n        }\n        if (this.isNotEqual('underline', source, modifiedProperty, modifiedValue, 2)) {\n            return false;\n        }\n        if (this.isNotEqual('strikethrough', source, modifiedProperty, modifiedValue, 2)) {\n            return false;\n        }\n        if (this.isNotEqual('baselineAlignment', source, modifiedProperty, modifiedValue, 2)) {\n            return false;\n        }\n        if (this.isNotEqual('highlightColor', source, modifiedProperty, modifiedValue, 2)) {\n            return false;\n        }\n        return true;\n    };\n    WUniqueFormat.prototype.isParagraphFormatEqual = function (source, modifiedProperty, modifiedValue) {\n        if (this.isNotEqual('leftIndent', source, modifiedProperty, modifiedValue, 3)) {\n            return false;\n        }\n        if (this.isNotEqual('rightIndent', source, modifiedProperty, modifiedValue, 3)) {\n            return false;\n        }\n        if (this.isNotEqual('firstLineIndent', source, modifiedProperty, modifiedValue, 3)) {\n            return false;\n        }\n        if (this.isNotEqual('textAlignment', source, modifiedProperty, modifiedValue, 3)) {\n            return false;\n        }\n        if (this.isNotEqual('beforeSpacing', source, modifiedProperty, modifiedValue, 3)) {\n            return false;\n        }\n        if (this.isNotEqual('afterSpacing', source, modifiedProperty, modifiedValue, 3)) {\n            return false;\n        }\n        if (this.isNotEqual('lineSpacing', source, modifiedProperty, modifiedValue, 3)) {\n            return false;\n        }\n        if (this.isNotEqual('lineSpacingType', source, modifiedProperty, modifiedValue, 3)) {\n            return false;\n        }\n        if (this.isNotEqual('outlineLevel', source, modifiedProperty, modifiedValue, 3)) {\n            return false;\n        }\n        return true;\n    };\n    /**\n     * @private\n     */\n    WUniqueFormat.prototype.isCellFormatEqual = function (source, modifiedProperty, modifiedValue) {\n        if (this.isNotEqual('leftMargin', source, modifiedProperty, modifiedValue, 4)) {\n            return false;\n        }\n        if (this.isNotEqual('rightMargin', source, modifiedProperty, modifiedValue, 4)) {\n            return false;\n        }\n        if (this.isNotEqual('topMargin', source, modifiedProperty, modifiedValue, 4)) {\n            return false;\n        }\n        if (this.isNotEqual('bottomMargin', source, modifiedProperty, modifiedValue, 4)) {\n            return false;\n        }\n        if (this.isNotEqual('columnSpan', source, modifiedProperty, modifiedValue, 4)) {\n            return false;\n        }\n        if (this.isNotEqual('rowSpan', source, modifiedProperty, modifiedValue, 4)) {\n            return false;\n        }\n        if (this.isNotEqual('verticalAlignment', source, modifiedProperty, modifiedValue, 4)) {\n            return false;\n        }\n        if (this.isNotEqual('preferredWidthType', source, modifiedProperty, modifiedValue, 4)) {\n            return false;\n        }\n        if (this.isNotEqual('preferredWidth', source, modifiedProperty, modifiedValue, 4)) {\n            return false;\n        }\n        if (this.isNotEqual('cellWidth', source, modifiedProperty, modifiedValue, 4)) {\n            return false;\n        }\n        return true;\n    };\n    /**\n     * @private\n     */\n    WUniqueFormat.prototype.isShadingEqual = function (source, modifiedProperty, modifiedValue) {\n        if (this.isNotEqual('backgroundColor', source, modifiedProperty, modifiedValue, 5)) {\n            return false;\n        }\n        if (this.isNotEqual('foregroundColor', source, modifiedProperty, modifiedValue, 5)) {\n            return false;\n        }\n        if (this.isNotEqual('textureStyle', source, modifiedProperty, modifiedValue, 5)) {\n            return false;\n        }\n        return true;\n    };\n    /**\n     * @private\n     */\n    WUniqueFormat.prototype.isRowFormatEqual = function (source, modifiedProperty, modifiedValue) {\n        if (this.isNotEqual('allowBreakAcrossPages', source, modifiedProperty, modifiedValue, 6)) {\n            return false;\n        }\n        if (this.isNotEqual('isHeader', source, modifiedProperty, modifiedValue, 6)) {\n            return false;\n        }\n        if (this.isNotEqual('height', source, modifiedProperty, modifiedValue, 6)) {\n            return false;\n        }\n        if (this.isNotEqual('heightType', source, modifiedProperty, modifiedValue, 6)) {\n            return false;\n        }\n        if (this.isNotEqual('gridBefore', source, modifiedProperty, modifiedValue, 6)) {\n            return false;\n        }\n        if (this.isNotEqual('gridBeforeWidth', source, modifiedProperty, modifiedValue, 6)) {\n            return false;\n        }\n        if (this.isNotEqual('gridBeforeWidthType', source, modifiedProperty, modifiedValue, 6)) {\n            return false;\n        }\n        if (this.isNotEqual('gridAfter', source, modifiedProperty, modifiedValue, 6)) {\n            return false;\n        }\n        if (this.isNotEqual('gridAfterWidth', source, modifiedProperty, modifiedValue, 6)) {\n            return false;\n        }\n        if (this.isNotEqual('gridAfterWidthType', source, modifiedProperty, modifiedValue, 6)) {\n            return false;\n        }\n        return true;\n    };\n    /**\n     * @private\n     */\n    WUniqueFormat.prototype.isListFormatEqual = function (source, modifiedProperty, modifiedValue) {\n        if (this.isNotEqual('listId', source, modifiedProperty, modifiedValue, 7)) {\n            return false;\n        }\n        if (this.isNotEqual('listLevelNumber', source, modifiedProperty, modifiedValue, 7)) {\n            return false;\n        }\n        return true;\n    };\n    /**\n     * @private\n     */\n    WUniqueFormat.prototype.isTableFormatEqual = function (source, modifiedProperty, modifiedValue) {\n        if (this.isNotEqual('leftMargin', source, modifiedProperty, modifiedValue, 8)) {\n            return false;\n        }\n        if (this.isNotEqual('rightMargin', source, modifiedProperty, modifiedValue, 8)) {\n            return false;\n        }\n        if (this.isNotEqual('topMargin', source, modifiedProperty, modifiedValue, 8)) {\n            return false;\n        }\n        if (this.isNotEqual('bottomMargin', source, modifiedProperty, modifiedValue, 8)) {\n            return false;\n        }\n        if (this.isNotEqual('cellSpacing', source, modifiedProperty, modifiedValue, 8)) {\n            return false;\n        }\n        if (this.isNotEqual('leftIndent', source, modifiedProperty, modifiedValue, 8)) {\n            return false;\n        }\n        if (this.isNotEqual('tableAlignment', source, modifiedProperty, modifiedValue, 8)) {\n            return false;\n        }\n        if (this.isNotEqual('preferredWidth', source, modifiedProperty, modifiedValue, 8)) {\n            return false;\n        }\n        if (this.isNotEqual('preferredWidthType', source, modifiedProperty, modifiedValue, 8)) {\n            return false;\n        }\n        return true;\n    };\n    /**\n     * @private\n     */\n    WUniqueFormat.prototype.isListLevelEqual = function (source, modifiedProperty, modifiedValue) {\n        if (this.isNotEqual('listLevelPattern', source, modifiedProperty, modifiedValue, 9)) {\n            return false;\n        }\n        if (this.isNotEqual('startAt', source, modifiedProperty, modifiedValue, 9)) {\n            return false;\n        }\n        if (this.isNotEqual('followCharacter', source, modifiedProperty, modifiedValue, 9)) {\n            return false;\n        }\n        if (this.isNotEqual('numberFormat', source, modifiedProperty, modifiedValue, 9)) {\n            return false;\n        }\n        if (this.isNotEqual('restartLevel', source, modifiedProperty, modifiedValue, 9)) {\n            return false;\n        }\n        return true;\n    };\n    /**\n     * @private\n     */\n    WUniqueFormat.prototype.isSectionFormatEqual = function (source, modifiedProperty, modifiedValue) {\n        if (this.isNotEqual('headerDistance', source, modifiedProperty, modifiedValue, 10)) {\n            return false;\n        }\n        if (this.isNotEqual('footerDistance', source, modifiedProperty, modifiedValue, 10)) {\n            return false;\n        }\n        if (this.isNotEqual('differentFirstPage', source, modifiedProperty, modifiedValue, 10)) {\n            return false;\n        }\n        if (this.isNotEqual('differentOddAndEvenPages', source, modifiedProperty, modifiedValue, 10)) {\n            return false;\n        }\n        if (this.isNotEqual('pageWidth', source, modifiedProperty, modifiedValue, 10)) {\n            return false;\n        }\n        if (this.isNotEqual('pageHeight', source, modifiedProperty, modifiedValue, 10)) {\n            return false;\n        }\n        if (this.isNotEqual('leftMargin', source, modifiedProperty, modifiedValue, 10)) {\n            return false;\n        }\n        if (this.isNotEqual('topMargin', source, modifiedProperty, modifiedValue, 10)) {\n            return false;\n        }\n        if (this.isNotEqual('rightMargin', source, modifiedProperty, modifiedValue, 10)) {\n            return false;\n        }\n        if (this.isNotEqual('bottomMargin', source, modifiedProperty, modifiedValue, 10)) {\n            return false;\n        }\n        return true;\n    };\n    /**\n     * @private\n     */\n    WUniqueFormat.prototype.cloneItems = function (format, property, value, uniqueFormatType) {\n        var propertyType = WUniqueFormat.getPropertyType(uniqueFormatType, property);\n        var keys = format.propertiesHash.getItem();\n        for (var i = 0; i < keys.length; i++) {\n            if (keys[i] === propertyType) {\n                this.propertiesHash.add(propertyType, value);\n            }\n            else {\n                this.propertiesHash.add(keys[i], format.propertiesHash.get(keys[i]));\n            }\n        }\n        if (!format.propertiesHash.containsKey(propertyType)) {\n            this.propertiesHash.add(propertyType, value);\n        }\n    };\n    /**\n     * @private\n     */\n    WUniqueFormat.prototype.mergeProperties = function (format) {\n        var hash = format.cloneProperties();\n        var keys = this.propertiesHash.keys;\n        for (var i = 0; i < keys.length; i++) {\n            if (!hash.containsKey(keys[i])) {\n                hash.add(keys[i], this.propertiesHash.get(keys[i]));\n            }\n        }\n        return hash;\n    };\n    /**\n     * @private\n     */\n    WUniqueFormat.prototype.cloneProperties = function () {\n        var hash = new Dictionary();\n        var keys = this.propertiesHash.keys;\n        for (var i = 0; i < keys.length; i++) {\n            hash.add(keys[i], this.propertiesHash.get(keys[i]));\n        }\n        return hash;\n    };\n    // public cloneItemsInternal(format: WUniqueFormat): void {\n    //     let keys: number[] = format.propertiesHash.getItem();\n    //     for (let i: number = 0; i < keys.length; i++) {\n    //         this.propertiesHash.add(keys[i], format.propertiesHash.get(keys[i]));\n    //     }\n    //     this.referenceCount = format.referenceCount;\n    // }\n    /**\n     * @private\n     */\n    WUniqueFormat.prototype.destroy = function () {\n        if (!isNullOrUndefined(this.propertiesHash)) {\n            this.propertiesHash.destroy();\n        }\n        this.propertiesHash = undefined;\n        this.referenceCount = undefined;\n        this.uniqueFormatType = undefined;\n    };\n    return WUniqueFormat;\n}());\nexport { WUniqueFormat };\n","import { isNullOrUndefined } from '@syncfusion/ej2-base';\nimport { WUniqueFormat } from './unique-format';\n/**\n * @private\n */\nvar WUniqueFormats = /** @class */ (function () {\n    function WUniqueFormats() {\n        this.items = [];\n    }\n    /**\n     * @private\n     */\n    WUniqueFormats.prototype.addUniqueFormat = function (format, type) {\n        var matchedFormat = undefined;\n        for (var i = 0; i < this.items.length; i++) {\n            if (this.items[i].isEqual(format, undefined, undefined)) {\n                matchedFormat = this.items[i];\n                break;\n            }\n        }\n        if (isNullOrUndefined(matchedFormat)) {\n            matchedFormat = new WUniqueFormat(type);\n            matchedFormat.propertiesHash = format;\n            matchedFormat.referenceCount = 1;\n            this.items.push(matchedFormat);\n        }\n        else {\n            matchedFormat.referenceCount++;\n        }\n        return matchedFormat;\n    };\n    /**\n     * @private\n     */\n    WUniqueFormats.prototype.updateUniqueFormat = function (uniqueFormat, property, value) {\n        var matchedFormat = undefined;\n        for (var i = 0; i < this.items.length; i++) {\n            if (this.items[i].isEqual(uniqueFormat.propertiesHash, property, value)) {\n                matchedFormat = this.items[i];\n                break;\n            }\n        }\n        if (isNullOrUndefined(matchedFormat)) {\n            matchedFormat = new WUniqueFormat(uniqueFormat.uniqueFormatType);\n            matchedFormat.cloneItems(uniqueFormat, property, value, uniqueFormat.uniqueFormatType);\n            matchedFormat.referenceCount = 1;\n            this.items.push(matchedFormat);\n        }\n        else {\n            matchedFormat.referenceCount++;\n        }\n        this.remove(uniqueFormat);\n        uniqueFormat = undefined;\n        return matchedFormat;\n    };\n    /**\n     * @private\n     */\n    WUniqueFormats.prototype.remove = function (uniqueFormat) {\n        uniqueFormat.referenceCount--;\n        if (uniqueFormat.referenceCount <= 0) {\n            this.items.splice(this.items.indexOf(uniqueFormat), 1);\n            uniqueFormat.destroy();\n            uniqueFormat = undefined;\n        }\n    };\n    /**\n     * @private\n     */\n    WUniqueFormats.prototype.clear = function () {\n        if (isNullOrUndefined(this.items)) {\n            for (var i = 0; i < this.items.length; i++) {\n                this.items[i].destroy();\n            }\n        }\n        this.items = [];\n    };\n    /**\n     * @private\n     */\n    WUniqueFormats.prototype.destroy = function () {\n        this.clear();\n        this.items = undefined;\n    };\n    return WUniqueFormats;\n}());\nexport { WUniqueFormats };\n","var __extends = (this && this.__extends) || (function () {\n    var extendStatics = Object.setPrototypeOf ||\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nimport { Component, Property, NotifyPropertyChanges, Event } from '@syncfusion/ej2-base';\nimport { isNullOrUndefined, L10n, setCulture, Browser } from '@syncfusion/ej2-base';\nimport { Save } from '@syncfusion/ej2-file-utils';\nimport { LayoutViewer, PageLayoutViewer, BulletsAndNumberingDialog } from './index';\nimport { Print } from './index';\nimport { BodyWidget, ParagraphWidget } from './index';\nimport { WSectionFormat, WParagraphFormat, WCharacterFormat } from './index';\nimport { SfdtReader } from './index';\nimport { Selection } from './index';\nimport { Editor, EditorHistory } from './index';\nimport { WStyles } from './index';\nimport { Search } from './index';\nimport { OptionsPane } from './index';\nimport { WordExport } from './index';\nimport { TextExport } from './index';\nimport { ContextMenu } from './index';\nimport { ImageResizer } from './index';\nimport { SfdtExport } from './index';\nimport { HyperlinkDialog, TableDialog, BookmarkDialog, StylesDialog, TableOfContentsDialog } from './index';\nimport { PageSetupDialog, ParagraphDialog, ListDialog, StyleDialog, FontDialog } from './index';\nimport { TablePropertiesDialog, BordersAndShadingDialog, CellOptionsDialog, TableOptionsDialog } from './index';\n/**\n * The Document editor component is used to draft, save or print rich text contents as page by page.\n */\nvar DocumentEditor = /** @class */ (function (_super) {\n    __extends(DocumentEditor, _super);\n    /**\n     * Initialize the constructor of DocumentEditor\n     */\n    function DocumentEditor(options, element) {\n        var _this = _super.call(this, options, element) || this;\n        //Internal Variable\n        _this.enableHeaderFooterIn = false;\n        /**\n         * @private\n         */\n        _this.isShiftingEnabled = false;\n        /**\n         * @private\n         */\n        _this.isLayoutEnabled = true;\n        /**\n         * @private\n         */\n        _this.isPastingContent = false;\n        /**\n         * @private\n         */\n        _this.parser = undefined;\n        _this.disableHistoryIn = false;\n        /**\n         * @private\n         */\n        _this.findResultsList = undefined;\n        /**\n         * Gets or sets the name of the document.\n         */\n        _this.documentName = '';\n        /**\n         * @private\n         */\n        _this.tablePropertiesDialogModule = undefined;\n        /**\n         * @private\n         */\n        _this.bordersAndShadingDialogModule = undefined;\n        /**\n         * @private\n         */\n        _this.cellOptionsDialogModule = undefined;\n        /**\n         * @private\n         */\n        _this.tableOptionsDialogModule = undefined;\n        /**\n         * @private\n         */\n        _this.paragraphDialogModule = undefined;\n        /**\n         * @private\n         */\n        _this.imageResizerModule = undefined;\n        /**\n         * Gets or Sets a value indicating whether holding Ctrl key is required to follow hyperlink on click. The default value is true.\n         */\n        _this.useCtrlClickToFollowHyperlink = true;\n        /**\n         * Gets or sets the page outline color.\n         */\n        _this.pageOutline = '#000000';\n        /**\n         * Gets or sets a value indicating whether to enable cursor in document editor on read only state or not. The default value is false.\n         */\n        _this.enableCursorOnReadOnly = false;\n        /**\n         * Gets or sets a value indicating whether local paste needs to be enabled or not.\n         */\n        _this.enableLocalPaste = false;\n        /**\n         * @private\n         */\n        _this.defaultLocale = {\n            'Table': 'Table',\n            'Row': 'Row',\n            'Cell': 'Cell',\n            'Ok': 'Ok',\n            'Cancel': 'Cancel',\n            'Size': 'Size',\n            'Preferred Width': 'Preferred width',\n            'Points': 'Points',\n            'Percent': 'Percent',\n            'Measure in': 'Measure in',\n            'Alignment': 'Alignment',\n            'Left': 'Left',\n            'Center': 'Center',\n            'Right': 'Right',\n            'Justify': 'Justify',\n            'Indent from left': 'Indent from left',\n            'Borders and Shading': 'Borders and Shading',\n            'Options': 'Options',\n            'Specify height': 'Specify height',\n            'At least': 'At least',\n            'Exactly': 'Exactly',\n            'Row height is': 'Row height is',\n            'Allow row to break across pages': 'Allow row to break across pages',\n            'Repeat as header row at the top of each page': 'Repeat as header row at the top of each page',\n            'Vertical alignment': 'Vertical alignment',\n            'Top': 'Top',\n            'Bottom': 'Bottom',\n            'Default cell margins': 'Default cell margins',\n            'Default cell spacing': 'Default cell spacing',\n            'Allow spacing between cells': 'Allow spacing between cells',\n            'Cell margins': 'Cell margins',\n            'Same as the whole table': 'Same as the whole table',\n            'Borders': 'Borders',\n            'None': 'None',\n            'Single': 'Single',\n            'Dot': 'Dot',\n            'DashSmallGap': 'DashSmallGap',\n            'DashLargeGap': 'DashLargeGap',\n            'DashDot': 'DashDot',\n            'DashDotDot': 'DashDotDot',\n            'Double': 'Double',\n            'Triple': 'Triple',\n            'ThinThickSmallGap': 'ThinThickSmallGap',\n            'ThickThinSmallGap': 'ThickThinSmallGap',\n            'ThinThickThinSmallGap': 'ThinThickThinSmallGap',\n            'ThinThickMediumGap': 'ThinThickMediumGap',\n            'ThickThinMediumGap': 'ThickThinMediumGap',\n            'ThinThickThinMediumGap': 'ThinThickThinMediumGap',\n            'ThinThickLargeGap': 'ThinThickLargeGap',\n            'ThickThinLargeGap': 'ThickThinLargeGap',\n            'ThinThickThinLargeGap': 'ThinThickThinLargeGap',\n            'SingleWavy': 'SingleWavy',\n            'DoubleWavy': 'DoubleWavy',\n            'DashDotStroked': 'DashDotStroked',\n            'Emboss3D': 'Emboss3D',\n            'Engrave3D': 'Engrave3D',\n            'Outset': 'Outset',\n            'Inset': 'Inset',\n            'Thick': 'Thick',\n            'Style': 'Style',\n            'Width': 'Width',\n            'Height': 'Height',\n            'Letter': 'Letter',\n            'Tabloid': 'Tabloid',\n            'Legal': 'Legal',\n            'Statement': 'Statement',\n            'Executive': 'Executive',\n            'A3': 'A3',\n            'A4': 'A4',\n            'A5': 'A5',\n            'B4': 'B4',\n            'B5': 'B5',\n            'Custom Size': 'Custom size',\n            'Different odd and even': 'Different odd and even',\n            'Different first page': 'Different first page',\n            'From edge': 'From edge',\n            'Header': 'Header',\n            'Footer': 'Footer',\n            'Margin': 'Margins',\n            'Paper': 'Paper',\n            'Layout': 'Layout',\n            'Orientation': 'Orientation',\n            'Landscape': 'Landscape',\n            'Portrait': 'Portrait',\n            'Table Of Contents': 'Table Of Contents',\n            'Show page numbers': 'Show page numbers',\n            'Right align page numbers': 'Right align page numbers',\n            'Nothing': 'Nothing',\n            'Tab leader': 'Tab leader',\n            'Show levels': 'Show levels',\n            'Use hyperlinks instead of page numbers': 'Use hyperlinks instead of page numbers',\n            'Build table of contents from': 'Build table of contents from',\n            'Styles': 'Styles',\n            'Available styles': 'Available styles',\n            'TOC level': 'TOC level',\n            'Heading': 'Heading',\n            'List Paragraph': 'List Paragraph',\n            'Normal': 'Normal',\n            'Outline levels': 'Outline levels',\n            'Table entry fields': 'Table entry fields',\n            'Modify': 'Modify',\n            'Color': 'Color',\n            'Setting': 'Setting',\n            'Box': 'Box',\n            'All': 'All',\n            'Custom': 'Custom',\n            'Preview': 'Preview',\n            'Shading': 'Shading',\n            'Fill': 'Fill',\n            'Apply To': 'Apply to',\n            'Table Properties': 'Table Properties',\n            'Cell Options': 'Cell Options',\n            'Table Options': 'Table Options',\n            'Insert Table': 'Insert Table',\n            'Number of columns': 'Number of columns',\n            'Number of rows': 'Number of rows',\n            'Text to display': 'Text to display',\n            'Address': 'Address',\n            'Insert Hyperlink': 'Insert Hyperlink',\n            'Edit Hyperlink': 'Edit Hyperlink',\n            'Insert': 'Insert',\n            'General': 'General',\n            'Indentation': 'Indentation',\n            'Before text': 'Before text',\n            'Special': 'Special',\n            'First line': 'First line',\n            'Hanging': 'Hanging',\n            'After text': 'After text',\n            'By': 'By',\n            'Before': 'Before',\n            'Line Spacing': 'Line spacing',\n            'After': 'After',\n            'At': 'At',\n            'Multiple': 'Multiple',\n            'Spacing': 'Spacing',\n            'Define new Multilevel list': 'Define new Multilevel list',\n            'List level': 'List level',\n            'Choose level to modify': 'Choose level to modify',\n            'Level': 'Level',\n            'Number format': 'Number format',\n            'Number style for this level': 'Number style for this level',\n            'Enter formatting for number': 'Enter formatting for number',\n            'Start at': 'Start at',\n            'Restart list after': 'Restart list after',\n            'Position': 'Position',\n            'Text indent at': 'Text indent at',\n            'Aligned at': 'Aligned at',\n            'Follow number with': 'Follow number with',\n            'Tab character': 'Tab character',\n            'Space': 'Space',\n            'Arabic': 'Arabic',\n            'UpRoman': 'UpRoman',\n            'LowRoman': 'LowRoman',\n            'UpLetter': 'UpLetter',\n            'LowLetter': 'LowLetter',\n            'Number': 'Number',\n            'Leading zero': 'Leading zero',\n            'Bullet': 'Bullet',\n            'Ordinal': 'Ordinal',\n            'Ordinal Text': 'Ordinal Text',\n            'For East': 'For East',\n            'No Restart': 'No Restart',\n            'Font': 'Font',\n            'Font style': 'Font style',\n            'Underline style': 'Underline style',\n            'Font color': 'Font color',\n            'Effects': 'Effects',\n            'Strikethrough': 'Strikethrough',\n            'Superscript': 'Superscript',\n            'Subscript': 'Subscript',\n            'Double strikethrough': 'Double strikethrough',\n            'Regular': 'Regular',\n            'Bold': 'Bold',\n            'Italic': 'Italic',\n            'Cut': 'Cut',\n            'Copy': 'Copy',\n            'Paste': 'Paste',\n            'Hyperlink': 'Hyperlink',\n            'Open Hyperlink': 'Open Hyperlink',\n            'Copy Hyperlink': 'Copy Hyperlink',\n            'Remove Hyperlink': 'Remove Hyperlink',\n            'Paragraph': 'Paragraph',\n            'Merge Cells': 'Merge Cells',\n            'Insert Above': 'Insert Above',\n            'Insert Below': 'Insert Below',\n            'Insert Left': 'Insert Left',\n            'Insert Right': 'Insert Right',\n            'Delete': 'Delete',\n            'Delete Table': 'Delete Table',\n            'Delete Row': 'Delete Row',\n            'Delete Column': 'Delete Column',\n            'File Name': 'File Name',\n            'Format Type': 'Format Type',\n            'Save': 'Save',\n            'Navigation': 'Navigation',\n            'Results': 'Results',\n            'Replace': 'Replace',\n            'Replace All': 'Replace All',\n            'We replaced all': 'We replaced all',\n            'Find': 'Find',\n            'No matches': 'No matches',\n            'All Done': 'All Done',\n            'Result': 'Result',\n            'of': 'of',\n            'instances': 'instances',\n            'with': 'with',\n            'Click to follow link': 'Click to follow link',\n            'Continue Numbering': 'Continue Numbering',\n            'Bookmark name': 'Bookmark name',\n            'Close': 'Close',\n            'Restart At': 'Restart At',\n            'Properties': 'Properties',\n            'Name': 'Name',\n            'Style type': 'Style type',\n            'Style based on': 'Style based on',\n            'Style for following paragraph': 'Style for following paragraph',\n            'Formatting': 'Formatting',\n            'Numbering and Bullets': 'Numbering and Bullets',\n            'Numbering': 'Numbering',\n            'Update Field': 'Update Field',\n            'Edit Field': 'Edit Field',\n            'Bookmark': 'Bookmark',\n            'Page Setup': 'Page Setup',\n            'No bookmarks found': 'No bookmarks found',\n            'Number format tooltip information': 'Single-level number format: </br>[PREFIX]%[LEVELNUMBER][SUFFIX]</br>'\n                + 'For example, \"Chapter %1.\" will display numbering like</br>Chapter 1. Item</br>Chapter 2. Item</br>…'\n                + '</br>Chapter N. Item</br>'\n                + '</br>Multilevel number format:</br>[PREFIX]%[LEVELNUMBER][SUFFIX]+[PREFIX]%[LEVELNUMBER][SUFFIX]'\n                + '</br>For example, \"%1.%2.\" will display numbering like</br>1.1. Item</br>1.2. Item</br>…</br>1.N. Item',\n            'Format': 'Format',\n            'Create New Style': 'Create New Style',\n            'Modify Style': 'Modify Style',\n            'New': 'New',\n            'Bullets': 'Bullets',\n            'Use bookmarks': 'Use bookmarks',\n            'Table of Contents': 'Table of Contents'\n        };\n        _this.viewer = new PageLayoutViewer(_this);\n        _this.parser = new SfdtReader(_this.viewer);\n        return _this;\n    }\n    DocumentEditor_1 = DocumentEditor;\n    Object.defineProperty(DocumentEditor.prototype, \"enableHeaderAndFooter\", {\n        /**\n         * @private\n         */\n        get: function () {\n            return this.enableHeaderFooterIn;\n        },\n        set: function (value) {\n            this.enableHeaderFooterIn = value;\n            this.viewer.updateScrollBars();\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(DocumentEditor.prototype, \"pageCount\", {\n        /**\n         * Gets the total number of pages.\n         */\n        get: function () {\n            if (!this.isDocumentLoaded || isNullOrUndefined(this.viewer)) {\n                return 1;\n            }\n            return this.viewer.pages.length;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(DocumentEditor.prototype, \"selection\", {\n        /**\n         *  Gets the selection object of the document editor.\n         * @returns Selection\n         * @default undefined\n         */\n        get: function () {\n            return this.selectionModule;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(DocumentEditor.prototype, \"editor\", {\n        /**\n         *  Gets the editor object of the document editor.\n         * @returns Editor\n         * @default undefined\n         */\n        get: function () {\n            return this.editorModule;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(DocumentEditor.prototype, \"editorHistory\", {\n        /**\n         * Gets the editor history object of the document editor.\n         * @returns EditorHistory\n         */\n        get: function () {\n            return this.editorHistoryModule;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(DocumentEditor.prototype, \"search\", {\n        /**\n         * Gets the search object of the document editor.\n         * @returns { Search }\n         */\n        get: function () {\n            return this.searchModule;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(DocumentEditor.prototype, \"contextMenu\", {\n        /**\n         * Gets the context menu object of the document editor.\n         * @returns ContextMenu\n         */\n        get: function () {\n            return this.contextMenuModule;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(DocumentEditor.prototype, \"containerId\", {\n        /**\n         * @private\n         */\n        get: function () {\n            return this.element.id;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(DocumentEditor.prototype, \"isDocumentLoaded\", {\n        /**\n         * @private\n         */\n        get: function () {\n            return this.isDocumentLoadedIn;\n        },\n        set: function (value) {\n            this.isDocumentLoadedIn = value;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(DocumentEditor.prototype, \"enableHistoryMode\", {\n        /**\n         * Determines whether history needs to be enabled or not.\n         * @default - false\n         * @private\n         */\n        get: function () {\n            return this.enableEditorHistory && !isNullOrUndefined(this.editorHistoryModule);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(DocumentEditor.prototype, \"documentStart\", {\n        /**\n         * Gets the start text position in the document.\n         * @default undefined\n         * @private\n         */\n        get: function () {\n            if (!isNullOrUndefined(this.selectionModule)) {\n                return this.selection.getDocumentStart();\n            }\n            return undefined;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(DocumentEditor.prototype, \"documentEnd\", {\n        /**\n         * Gets the end text position in the document.\n         * @default undefined\n         * @private\n         */\n        get: function () {\n            if (!isNullOrUndefined(this.selectionModule)) {\n                return this.selection.getDocumentEnd();\n            }\n            return undefined;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(DocumentEditor.prototype, \"isReadOnlyMode\", {\n        /**\n         * @private\n         */\n        get: function () {\n            return this.isReadOnly || isNullOrUndefined(this.editorModule) || isNullOrUndefined(this.selectionModule);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(DocumentEditor.prototype, \"enableImageResizerMode\", {\n        /**\n         * Specifies to enable image resizer option\n         * default - false\n         * @private\n         */\n        get: function () {\n            return this.enableImageResizer && !isNullOrUndefined(this.imageResizerModule);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    DocumentEditor.prototype.preRender = function () {\n        this.findResultsList = [];\n        //pre render section\n    };\n    DocumentEditor.prototype.render = function () {\n        this.viewer.initializeComponents();\n        this.openBlank();\n        if (!isNullOrUndefined(this.element)) {\n            var container = this.element;\n            container.style.minHeight = '200px';\n            container.style.minWidth = '200px';\n        }\n    };\n    /**\n     * Get component name\n     * @private\n     */\n    DocumentEditor.prototype.getModuleName = function () {\n        return 'DocumentEditor';\n    };\n    /**\n     * Called internally if any of the property value changed.\n     * @private\n     */\n    DocumentEditor.prototype.onPropertyChanged = function (model, oldProp) {\n        for (var _i = 0, _a = Object.keys(model); _i < _a.length; _i++) {\n            var prop = _a[_i];\n            switch (prop) {\n                case 'zoomFactor':\n                    if (this.viewer) {\n                        this.viewer.zoomFactor = model.zoomFactor;\n                    }\n                    break;\n                case 'locale':\n                    this.localizeDialogs();\n                    break;\n                case 'isReadOnly':\n                    if (!isNullOrUndefined(this.optionsPaneModule) && this.optionsPaneModule.isOptionsPaneShow) {\n                        this.optionsPaneModule.showHideOptionsPane(false);\n                    }\n                    break;\n            }\n        }\n    };\n    DocumentEditor.prototype.localizeDialogs = function () {\n        if (this.locale !== '') {\n            var l10n = new L10n('documenteditor', this.defaultLocale);\n            l10n.setLocale(this.locale);\n            setCulture(this.locale);\n            if (this.optionsPaneModule) {\n                this.optionsPaneModule.initOptionsPane(l10n);\n            }\n            if (this.paragraphDialogModule) {\n                this.paragraphDialogModule.initParagraphDialog(l10n);\n            }\n            if (this.pageSetupDialogModule) {\n                this.pageSetupDialogModule.initPageSetupDialog(l10n);\n            }\n            if (this.fontDialogModule) {\n                this.fontDialogModule.initFontDialog(l10n);\n            }\n            if (this.hyperlinkDialogModule) {\n                this.hyperlinkDialogModule.initHyperlinkDialog(l10n);\n            }\n            if (this.contextMenuModule) {\n                this.contextMenuModule.initContextMenu(l10n);\n            }\n            if (this.listDialogModule) {\n                this.listDialogModule.initListDialog(l10n);\n            }\n            if (this.tablePropertiesDialogModule) {\n                this.tablePropertiesDialogModule.initTablePropertyDialog(l10n);\n            }\n            if (this.bordersAndShadingDialogModule) {\n                this.bordersAndShadingDialogModule.initBordersAndShadingsDialog(l10n);\n            }\n            if (this.cellOptionsDialogModule) {\n                this.cellOptionsDialogModule.initCellMarginsDialog(l10n);\n            }\n            if (this.tableOptionsDialogModule) {\n                this.tableOptionsDialogModule.initTableOptionsDialog(l10n);\n            }\n            if (this.tableDialogModule) {\n                this.tableDialogModule.initTableDialog(l10n);\n            }\n            if (this.styleDialogModule) {\n                this.styleDialogModule.initStyleDialog(l10n);\n            }\n            if (this.tableOfContentsDialogModule) {\n                this.tableOfContentsDialogModule.initTableOfContentDialog(l10n);\n            }\n        }\n    };\n    /**\n     * Get the properties to be maintained in the persisted state.\n     * @private\n     */\n    DocumentEditor.prototype.getPersistData = function () {\n        return 'documenteditor';\n    };\n    DocumentEditor.prototype.clearPreservedCollectionsInViewer = function () {\n        if (this.viewer instanceof LayoutViewer) {\n            this.viewer.clearDocumentItems();\n        }\n    };\n    /**\n     * @private\n     */\n    DocumentEditor.prototype.getDocumentEditorElement = function () {\n        return this.element;\n    };\n    /**\n     * @private\n     */\n    DocumentEditor.prototype.fireContentChange = function () {\n        var eventArgs = { source: this };\n        this.trigger('contentChange', eventArgs);\n    };\n    /**\n     * @private\n     */\n    DocumentEditor.prototype.fireDocumentChange = function () {\n        var eventArgs = { source: this };\n        this.trigger('documentChange', eventArgs);\n    };\n    /**\n     * @private\n     */\n    DocumentEditor.prototype.fireSelectionChange = function () {\n        if (!this.viewer.isCompositionStart && Browser.isDevice && this.editorModule) {\n            this.editorModule.predictText();\n        }\n        var eventArgs = { source: this };\n        this.trigger('selectionChange', eventArgs);\n    };\n    /**\n     * @private\n     */\n    DocumentEditor.prototype.fireZoomFactorChange = function () {\n        var eventArgs = { source: this };\n        this.trigger('zoomFactorChange', eventArgs);\n    };\n    /**\n     * @private\n     */\n    DocumentEditor.prototype.fireViewChange = function () {\n        if (this.viewer && this.viewer.pages.length > 0) {\n            if (this.viewer.visiblePages.length > 0) {\n                var pages = this.viewer.visiblePages;\n                var eventArgs = {\n                    startPage: pages[0].index + 1,\n                    endPage: pages[pages.length - 1].index + 1,\n                    source: this\n                };\n                this.trigger('viewChange', eventArgs);\n            }\n        }\n    };\n    /**\n     * Shows the Paragraph dialog\n     * @private\n     */\n    DocumentEditor.prototype.showParagraphDialog = function (paragraphFormat) {\n        if (this.paragraphDialogModule && !this.isReadOnlyMode && this.viewer) {\n            this.paragraphDialogModule.show(paragraphFormat);\n        }\n    };\n    /**\n     * Shows the margin dialog\n     * @private\n     */\n    DocumentEditor.prototype.showPageSetupDialog = function () {\n        if (this.pageSetupDialogModule && !this.isReadOnlyMode && this.viewer) {\n            this.pageSetupDialogModule.show();\n        }\n    };\n    /**\n     * Shows the font dialog\n     * @private\n     */\n    DocumentEditor.prototype.showFontDialog = function (characterFormat) {\n        if (this.fontDialogModule && !this.isReadOnlyMode && this.viewer) {\n            this.fontDialogModule.showFontDialog(characterFormat);\n        }\n    };\n    /**\n     * Shows the cell option dialog\n     * @private\n     */\n    DocumentEditor.prototype.showCellOptionsDialog = function () {\n        if (this.cellOptionsDialogModule && !this.isReadOnlyMode && this.viewer) {\n            this.cellOptionsDialogModule.show();\n        }\n    };\n    /**\n     * Shows the table options dialog.\n     * @private\n     */\n    DocumentEditor.prototype.showTableOptionsDialog = function () {\n        if (this.tableOptionsDialogModule && !this.isReadOnlyMode && this.viewer) {\n            this.tableOptionsDialogModule.show();\n        }\n    };\n    /**\n     * Shows insert table dialog\n     * @private\n     */\n    DocumentEditor.prototype.showTableDialog = function () {\n        if (this.tableDialogModule && !this.isReadOnlyMode && this.viewer) {\n            this.tableDialogModule.show();\n        }\n    };\n    /**\n     * Shows the table of content dialog\n     * @private\n     */\n    DocumentEditor.prototype.showTableOfContentsDialog = function () {\n        if (this.tableOfContentsDialogModule && !this.isReadOnlyMode && this.viewer) {\n            this.tableOfContentsDialogModule.show();\n        }\n    };\n    /* tslint:enable:no-any */\n    /**\n     * Shows the style dialog\n     * @private\n     */\n    DocumentEditor.prototype.showStyleDialog = function () {\n        if (this.styleDialogModule && !this.isReadOnlyMode && this.viewer) {\n            this.styleDialogModule.show();\n        }\n    };\n    /**\n     * Shows the hyperlink dialog\n     * @private\n     */\n    DocumentEditor.prototype.showHyperlinkDialog = function () {\n        if (this.hyperlinkDialogModule && !this.isReadOnlyMode && this.viewer) {\n            this.hyperlinkDialogModule.show();\n        }\n    };\n    /**\n     * Shows the bookmark dialog.\n     * @private\n     */\n    DocumentEditor.prototype.showBookmarkDialog = function () {\n        if (this.bookmarkDialogModule && !this.isReadOnlyMode && this.viewer) {\n            this.bookmarkDialogModule.show();\n        }\n    };\n    /**\n     * Shows the styles dialog.\n     * @private\n     */\n    DocumentEditor.prototype.showStylesDialog = function () {\n        if (this.stylesDialogModule && !this.isReadOnlyMode && this.viewer) {\n            this.stylesDialogModule.show();\n        }\n    };\n    /**\n     * Shows the List dialog\n     * @private\n     */\n    DocumentEditor.prototype.showListDialog = function () {\n        if (this.listDialogModule && !this.isReadOnlyMode && this.viewer) {\n            this.listDialogModule.showListDialog();\n        }\n    };\n    /**\n     * Shows the table properties dialog\n     * @private\n     */\n    DocumentEditor.prototype.showTablePropertiesDialog = function () {\n        if (this.tablePropertiesDialogModule && !this.isReadOnlyMode && this.viewer) {\n            this.tablePropertiesDialogModule.show();\n        }\n    };\n    /**\n     * Shows the borders and shading dialog\n     * @private\n     */\n    DocumentEditor.prototype.showBordersAndShadingDialog = function () {\n        if (this.bordersAndShadingDialogModule && !this.isReadOnlyMode && this.viewer) {\n            this.bordersAndShadingDialogModule.show();\n        }\n    };\n    //tslint:disable: max-func-body-length\n    DocumentEditor.prototype.requiredModules = function () {\n        var modules = [];\n        if (this.enablePrint) {\n            modules.push({\n                member: 'Print', args: []\n            });\n        }\n        if (this.enableSfdtExport || this.enableWordExport || this.enableTextExport || this.enableSelection || this.enableEditor) {\n            modules.push({\n                member: 'SfdtExport', args: [this.viewer]\n            });\n        }\n        if (this.enableWordExport) {\n            modules.push({\n                member: 'WordExport', args: []\n            });\n        }\n        if (this.enableTextExport) {\n            modules.push({\n                member: 'TextExport', args: []\n            });\n        }\n        if (this.enableSelection || this.enableSearch || this.enableEditor) {\n            modules.push({\n                member: 'Selection', args: [this]\n            });\n            if (this.enableContextMenu) {\n                modules.push({\n                    member: 'ContextMenu', args: [this.viewer]\n                });\n            }\n        }\n        if (this.enableSearch) {\n            modules.push({\n                member: 'Search', args: [this]\n            });\n            if (this.enableOptionsPane) {\n                modules.push({\n                    member: 'OptionsPane', args: [this.viewer]\n                });\n            }\n        }\n        if (this.enableEditor) {\n            modules.push({\n                member: 'Editor', args: [this.viewer]\n            });\n            if (this.enableImageResizer) {\n                modules.push({\n                    member: 'ImageResizer', args: [this, this.viewer]\n                });\n            }\n            if (this.enableEditorHistory) {\n                modules.push({\n                    member: 'EditorHistory', args: [this]\n                });\n            }\n            if (this.enableHyperlinkDialog) {\n                modules.push({\n                    member: 'HyperlinkDialog', args: [this.viewer]\n                });\n            }\n            if (this.enableTableDialog) {\n                modules.push({\n                    member: 'TableDialog', args: [this.viewer]\n                });\n            }\n            if (this.enableBookmarkDialog) {\n                modules.push({\n                    member: 'BookmarkDialog', args: [this.viewer]\n                });\n            }\n            if (this.enableTableOfContentsDialog) {\n                modules.push({\n                    member: 'TableOfContentsDialog', args: [this.viewer]\n                });\n            }\n            if (this.enablePageSetupDialog) {\n                modules.push({\n                    member: 'PageSetupDialog', args: [this.viewer]\n                });\n            }\n            if (this.enableStyleDialog) {\n                modules.push({\n                    member: 'StylesDialog', args: [this.viewer]\n                });\n                modules.push({\n                    member: 'StyleDialog', args: [this.viewer]\n                });\n                modules.push({\n                    member: 'BulletsAndNumberingDialog', args: [this.viewer]\n                });\n            }\n            if (this.enableListDialog) {\n                modules.push({\n                    member: 'ListDialog', args: [this.viewer]\n                });\n            }\n            if (this.enableParagraphDialog) {\n                modules.push({\n                    member: 'ParagraphDialog', args: [this.viewer]\n                });\n            }\n            if (this.enableFontDialog) {\n                modules.push({\n                    member: 'FontDialog', args: [this.viewer]\n                });\n            }\n            if (this.enableTablePropertiesDialog) {\n                modules.push({\n                    member: 'TablePropertiesDialog', args: [this.viewer]\n                });\n                modules.push({\n                    member: 'CellOptionsDialog', args: [this.viewer]\n                });\n            }\n            if (this.enableBordersAndShadingDialog) {\n                modules.push({\n                    member: 'BordersAndShadingDialog', args: [this.viewer]\n                });\n            }\n            if (this.enableTableOptionsDialog) {\n                modules.push({\n                    member: 'TableOptionsDialog', args: [this.viewer]\n                });\n            }\n        }\n        return modules;\n    };\n    // Public Implementation Starts\n    /**\n     * Opens the given Sfdt text.\n     * @param {string} sfdtText.\n     */\n    DocumentEditor.prototype.open = function (sfdtText) {\n        if (!isNullOrUndefined(this.viewer)) {\n            this.clearPreservedCollectionsInViewer();\n            this.viewer.lists = [];\n            this.viewer.abstractLists = [];\n            this.viewer.styles = new WStyles();\n            if (!isNullOrUndefined(sfdtText) && this.viewer) {\n                this.viewer.onDocumentChanged(this.parser.convertJsonToDocument(sfdtText));\n                if (this.editorModule) {\n                    this.editorModule.intializeDefaultStyles();\n                }\n            }\n        }\n    };\n    /**\n     * Scrolls view to start of the given page number if exists.\n     * @param  {number} pageNumber.\n     * @returns void\n     */\n    DocumentEditor.prototype.scrollToPage = function (pageNumber) {\n        if (isNullOrUndefined(this.viewer) || pageNumber < 1 || pageNumber > this.viewer.pages.length) {\n            return false;\n        }\n        this.viewer.scrollToPage(pageNumber - 1);\n        return true;\n    };\n    /**\n     * Enables all the modules.\n     * @returns void\n     */\n    DocumentEditor.prototype.enableAllModules = function () {\n        this.enablePrint = this.enableSfdtExport = this.enableWordExport = this.enableTextExport\n            = this.enableSelection = this.enableContextMenu = this.enableSearch = this.enableOptionsPane\n                = this.enableEditor = this.enableImageResizer = this.enableEditorHistory\n                    = this.enableHyperlinkDialog = this.enableTableDialog = this.enableBookmarkDialog\n                        = this.enableTableOfContentsDialog = this.enablePageSetupDialog = this.enableStyleDialog\n                            = this.enableListDialog = this.enableParagraphDialog = this.enableFontDialog\n                                = this.enableTablePropertiesDialog = this.enableBordersAndShadingDialog\n                                    = this.enableTableOptionsDialog = true;\n        // tslint:disable-next-line:max-line-length\n        DocumentEditor_1.Inject(Print, SfdtExport, WordExport, TextExport, Selection, Search, Editor, ImageResizer, EditorHistory, ContextMenu, OptionsPane, HyperlinkDialog, TableDialog, BookmarkDialog, TableOfContentsDialog, PageSetupDialog, StyleDialog, ListDialog, ParagraphDialog, BulletsAndNumberingDialog, FontDialog, TablePropertiesDialog, BordersAndShadingDialog, TableOptionsDialog, CellOptionsDialog, StylesDialog);\n    };\n    /**\n     * Resizes the component and its sub elements based on given size or container size.\n     * @param width\n     * @param height\n     */\n    DocumentEditor.prototype.resize = function (width, height) {\n        if (this.element) {\n            if (!isNullOrUndefined(width) && width > 200) {\n                this.element.style.width = width + 'px';\n            }\n            if (!isNullOrUndefined(height) && height > 200) {\n                this.element.style.height = height + 'px';\n            }\n            if (this.viewer) {\n                this.viewer.updateViewerSize();\n            }\n        }\n    };\n    /**\n     * Shifts the focus to the document.\n     */\n    DocumentEditor.prototype.focusIn = function () {\n        if (this.viewer) {\n            this.viewer.updateFocus();\n        }\n    };\n    /**\n     * Fits the page based on given fit type.\n     * @param  {PageFitType} pageFitType? - Default value of ‘pageFitType’ parameter is 'None'\n     * @returns void\n     */\n    DocumentEditor.prototype.fitPage = function (pageFitType) {\n        if (isNullOrUndefined(pageFitType)) {\n            pageFitType = 'None';\n        }\n        if (this.viewer) {\n            this.viewer.pageFitType = pageFitType;\n        }\n    };\n    /**\n     * Prints the document.\n     * @param  {Window} printWindow? - Default value of 'printWindow' parameter is undefined.\n     */\n    DocumentEditor.prototype.print = function (printWindow) {\n        if (isNullOrUndefined(this.viewer)) {\n            throw new Error('Invalid operation.');\n        }\n        if (this.printModule) {\n            this.printModule.print(this.viewer, printWindow);\n        }\n        else {\n            throw new Error('Invalid operation. Print is not enabled.');\n        }\n    };\n    /**\n     * Serialize the data to JSON string.\n     */\n    DocumentEditor.prototype.serialize = function () {\n        var json = '';\n        if (this.enableSfdtExport && this.sfdtExportModule instanceof SfdtExport) {\n            json = this.sfdtExportModule.serialize();\n        }\n        else {\n            throw new Error('Invalid operation. Sfdt export is not enabled.');\n        }\n        return json;\n    };\n    /**\n     * Saves the document.\n     * @param {string} fileName\n     * @param {FormatType} formatType\n     */\n    DocumentEditor.prototype.save = function (fileName, formatType) {\n        fileName = fileName || 'Untitled';\n        if (isNullOrUndefined(this.viewer)) {\n            throw new Error('Invalid operation.');\n        }\n        if (formatType === 'Docx' && this.wordExportModule) {\n            if (this.wordExportModule) {\n                this.wordExportModule.save(this.viewer, fileName);\n            }\n        }\n        else if (formatType === 'Txt' && this.textExportModule) {\n            this.textExportModule.save(this.viewer, fileName);\n        }\n        else if (formatType === 'Sfdt' && this.enableSfdtExport && this.sfdtExportModule) {\n            var jsonString = this.serialize();\n            var blob = new Blob([jsonString], {\n                type: 'application/json'\n            });\n            Save.save(fileName + '.sfdt', blob);\n        }\n        else {\n            throw new Error('Invalid operation. Specified export is not enabled.');\n        }\n    };\n    /**\n     * Saves the document as blob.\n     * @param {FormatType} formatType\n     */\n    DocumentEditor.prototype.saveAsBlob = function (formatType) {\n        var _this = this;\n        if (isNullOrUndefined(this.viewer)) {\n            throw new Error('Invalid operation');\n        }\n        return new Promise(function (resolve, reject) {\n            if (formatType === 'Docx' && _this.wordExportModule) {\n                resolve(_this.wordExportModule.saveAsBlob(_this.viewer));\n            }\n            else if (formatType === 'Txt' && _this.textExportModule) {\n                resolve(_this.textExportModule.saveAsBlob(_this.viewer));\n            }\n            else if (formatType === 'Sfdt' && _this.enableSfdtExport && _this.sfdtExportModule) {\n                resolve(_this.sfdtExportModule.saveAsBlob(_this.viewer));\n            }\n        });\n    };\n    /**\n     * Opens a blank document.\n     */\n    DocumentEditor.prototype.openBlank = function () {\n        var section = new BodyWidget();\n        section.index = 0;\n        section.sectionFormat = new WSectionFormat(section);\n        var paragraph = new ParagraphWidget();\n        paragraph.index = 0;\n        paragraph.paragraphFormat = new WParagraphFormat(paragraph);\n        paragraph.characterFormat = new WCharacterFormat(paragraph);\n        section.childWidgets.push(paragraph);\n        paragraph.containerWidget = section;\n        var sections = [];\n        sections.push(section);\n        // tslint:disable-next-line:max-line-length\n        var hfs = this.parser.parseHeaderFooter({ header: {}, footer: {}, evenHeader: {}, evenFooter: {}, firstPageHeader: {}, firstPageFooter: {} }, undefined);\n        if (this.viewer) {\n            this.clearPreservedCollectionsInViewer();\n            this.viewer.headersFooters.push(hfs);\n            this.viewer.onDocumentChanged(sections);\n            if (this.editorModule) {\n                this.editorModule.intializeDefaultStyles();\n                var style = this.viewer.styles.findByName('Normal');\n                paragraph.paragraphFormat.baseStyle = style;\n                paragraph.paragraphFormat.listFormat.baseStyle = style;\n            }\n        }\n    };\n    /**\n     * Gets the style names based on given style type.\n     * @param styleType\n     */\n    DocumentEditor.prototype.getStyleNames = function (styleType) {\n        if (this.viewer) {\n            return this.viewer.styles.getStyleNames(styleType);\n        }\n        return [];\n    };\n    /**\n     * Gets the style objects on given style type.\n     * @param styleType\n     */\n    DocumentEditor.prototype.getStyles = function (styleType) {\n        if (this.viewer) {\n            return this.viewer.styles.getStyles(styleType);\n        }\n        return [];\n    };\n    /**\n     * Shows the dialog.\n     * @param {DialogType} dialogType\n     * @returns void\n     */\n    DocumentEditor.prototype.showDialog = function (dialogType) {\n        switch (dialogType) {\n            case 'Hyperlink':\n                this.showHyperlinkDialog();\n                break;\n            case 'Table':\n                this.showTableDialog();\n                break;\n            case 'Bookmark':\n                this.showBookmarkDialog();\n                break;\n            case 'TableOfContents':\n                this.showTableOfContentsDialog();\n                break;\n            case 'PageSetup':\n                this.showPageSetupDialog();\n                break;\n            case 'List':\n                this.showListDialog();\n                break;\n            case 'Styles':\n                this.showStylesDialog();\n                break;\n            case 'Style':\n                this.showStyleDialog();\n                break;\n            case 'Paragraph':\n                this.showParagraphDialog();\n                break;\n            case 'Font':\n                this.showFontDialog();\n                break;\n            case 'TableProperties':\n                this.showTablePropertiesDialog();\n                break;\n            case 'BordersAndShading':\n                this.showBordersAndShadingDialog();\n                break;\n            case 'TableOptions':\n                this.showTableOptionsDialog();\n                break;\n        }\n    };\n    /**\n     * Shows the options pane.\n     */\n    DocumentEditor.prototype.showOptionsPane = function () {\n        if (!isNullOrUndefined(this.optionsPaneModule) && !isNullOrUndefined(this.viewer)) {\n            this.optionsPaneModule.showHideOptionsPane(true);\n        }\n    };\n    /**\n     * Destroys all managed resources used by this object.\n     */\n    DocumentEditor.prototype.destroy = function () {\n        _super.prototype.destroy.call(this);\n        this.destroyDependentModules();\n        if (!isNullOrUndefined(this.viewer)) {\n            this.viewer.destroy();\n        }\n        this.viewer = undefined;\n        if (!isNullOrUndefined(this.element)) {\n            this.element.classList.remove('e-documenteditor');\n            this.element.innerHTML = '';\n        }\n        this.element = undefined;\n        this.findResultsList = [];\n        this.findResultsList = undefined;\n    };\n    DocumentEditor.prototype.destroyDependentModules = function () {\n        if (this.printModule) {\n            this.printModule.destroy();\n            this.printModule = undefined;\n        }\n        if (this.sfdtExportModule) {\n            this.sfdtExportModule.destroy();\n            this.sfdtExportModule = undefined;\n        }\n        if (this.optionsPaneModule) {\n            this.optionsPaneModule.destroy();\n            this.optionsPaneModule = undefined;\n        }\n        if (!isNullOrUndefined(this.hyperlinkDialogModule)) {\n            this.hyperlinkDialogModule.destroy();\n            this.hyperlinkDialogModule = undefined;\n        }\n        if (this.searchModule) {\n            this.searchModule.destroy();\n            this.searchModule = undefined;\n        }\n        if (this.contextMenuModule) {\n            this.contextMenuModule.destroy();\n            this.contextMenuModule = undefined;\n        }\n        if (this.editorModule) {\n            this.editorModule.destroy();\n            this.editorModule = undefined;\n        }\n        if (this.selectionModule) {\n            this.selectionModule.destroy();\n            this.selectionModule = undefined;\n        }\n        if (this.editorHistoryModule) {\n            this.editorHistoryModule.destroy();\n            this.editorHistoryModule = undefined;\n        }\n        if (!isNullOrUndefined(this.paragraphDialogModule)) {\n            this.paragraphDialogModule.destroy();\n            this.paragraphDialogModule = undefined;\n        }\n        if (this.pageSetupDialogModule) {\n            this.pageSetupDialogModule.destroy();\n            this.pageSetupDialogModule = undefined;\n        }\n        if (this.fontDialogModule) {\n            this.fontDialogModule.destroy();\n            this.fontDialogModule = undefined;\n        }\n        if (this.listDialogModule) {\n            this.listDialogModule.destroy();\n            this.listDialogModule = undefined;\n        }\n        if (this.imageResizerModule) {\n            this.imageResizerModule.destroy();\n            this.imageResizerModule = undefined;\n        }\n        if (this.tablePropertiesDialogModule) {\n            this.tablePropertiesDialogModule.destroy();\n            this.tablePropertiesDialogModule = undefined;\n        }\n        if (this.bordersAndShadingDialogModule) {\n            this.bordersAndShadingDialogModule.destroy();\n            this.bordersAndShadingDialogModule = undefined;\n        }\n        if (this.cellOptionsDialogModule) {\n            this.cellOptionsDialogModule.destroy();\n            this.cellOptionsDialogModule = undefined;\n        }\n        if (this.tableOptionsDialogModule) {\n            this.tableOptionsDialogModule.destroy();\n            this.tableOptionsDialogModule = undefined;\n        }\n        if (this.tableDialogModule) {\n            this.tableDialogModule.destroy();\n            this.tableDialogModule = undefined;\n        }\n        if (this.styleDialogModule) {\n            this.styleDialogModule = undefined;\n        }\n        if (this.bookmarkDialogModule) {\n            this.bookmarkDialogModule.destroy();\n            this.bookmarkDialogModule = undefined;\n        }\n        if (this.styleDialogModule) {\n            this.styleDialogModule.destroy();\n            this.styleDialogModule = undefined;\n        }\n        if (this.textExportModule) {\n            this.textExportModule.destroy();\n            this.textExportModule = undefined;\n        }\n        if (this.wordExportModule) {\n            this.wordExportModule.destroy();\n            this.wordExportModule = undefined;\n        }\n        if (this.tableOfContentsDialogModule) {\n            this.tableOfContentsDialogModule.destroy();\n            this.tableOfContentsDialogModule = undefined;\n        }\n    };\n    __decorate([\n        Property(1)\n    ], DocumentEditor.prototype, \"zoomFactor\", void 0);\n    __decorate([\n        Property(true)\n    ], DocumentEditor.prototype, \"isReadOnly\", void 0);\n    __decorate([\n        Property(false)\n    ], DocumentEditor.prototype, \"enablePrint\", void 0);\n    __decorate([\n        Property(false)\n    ], DocumentEditor.prototype, \"enableSelection\", void 0);\n    __decorate([\n        Property(false)\n    ], DocumentEditor.prototype, \"enableEditor\", void 0);\n    __decorate([\n        Property(false)\n    ], DocumentEditor.prototype, \"enableEditorHistory\", void 0);\n    __decorate([\n        Property(false)\n    ], DocumentEditor.prototype, \"enableSfdtExport\", void 0);\n    __decorate([\n        Property(false)\n    ], DocumentEditor.prototype, \"enableWordExport\", void 0);\n    __decorate([\n        Property(false)\n    ], DocumentEditor.prototype, \"enableTextExport\", void 0);\n    __decorate([\n        Property(false)\n    ], DocumentEditor.prototype, \"enableOptionsPane\", void 0);\n    __decorate([\n        Property(false)\n    ], DocumentEditor.prototype, \"enableContextMenu\", void 0);\n    __decorate([\n        Property(false)\n    ], DocumentEditor.prototype, \"enableHyperlinkDialog\", void 0);\n    __decorate([\n        Property(false)\n    ], DocumentEditor.prototype, \"enableBookmarkDialog\", void 0);\n    __decorate([\n        Property(false)\n    ], DocumentEditor.prototype, \"enableTableOfContentsDialog\", void 0);\n    __decorate([\n        Property(false)\n    ], DocumentEditor.prototype, \"enableSearch\", void 0);\n    __decorate([\n        Property(false)\n    ], DocumentEditor.prototype, \"enableParagraphDialog\", void 0);\n    __decorate([\n        Property(false)\n    ], DocumentEditor.prototype, \"enableListDialog\", void 0);\n    __decorate([\n        Property(false)\n    ], DocumentEditor.prototype, \"enableTablePropertiesDialog\", void 0);\n    __decorate([\n        Property(false)\n    ], DocumentEditor.prototype, \"enableBordersAndShadingDialog\", void 0);\n    __decorate([\n        Property(false)\n    ], DocumentEditor.prototype, \"enablePageSetupDialog\", void 0);\n    __decorate([\n        Property(false)\n    ], DocumentEditor.prototype, \"enableStyleDialog\", void 0);\n    __decorate([\n        Property(false)\n    ], DocumentEditor.prototype, \"enableFontDialog\", void 0);\n    __decorate([\n        Property(false)\n    ], DocumentEditor.prototype, \"enableTableOptionsDialog\", void 0);\n    __decorate([\n        Property(false)\n    ], DocumentEditor.prototype, \"enableTableDialog\", void 0);\n    __decorate([\n        Property(false)\n    ], DocumentEditor.prototype, \"enableImageResizer\", void 0);\n    __decorate([\n        Event()\n    ], DocumentEditor.prototype, \"documentChange\", void 0);\n    __decorate([\n        Event()\n    ], DocumentEditor.prototype, \"viewChange\", void 0);\n    __decorate([\n        Event()\n    ], DocumentEditor.prototype, \"zoomFactorChange\", void 0);\n    __decorate([\n        Event()\n    ], DocumentEditor.prototype, \"selectionChange\", void 0);\n    __decorate([\n        Event()\n    ], DocumentEditor.prototype, \"requestNavigate\", void 0);\n    __decorate([\n        Event()\n    ], DocumentEditor.prototype, \"contentChange\", void 0);\n    __decorate([\n        Event()\n    ], DocumentEditor.prototype, \"keyDown\", void 0);\n    __decorate([\n        Event()\n    ], DocumentEditor.prototype, \"searchResultsChange\", void 0);\n    __decorate([\n        Event()\n    ], DocumentEditor.prototype, \"created\", void 0);\n    __decorate([\n        Event()\n    ], DocumentEditor.prototype, \"destroyed\", void 0);\n    DocumentEditor = DocumentEditor_1 = __decorate([\n        NotifyPropertyChanges\n    ], DocumentEditor);\n    return DocumentEditor;\n    var DocumentEditor_1;\n}(Component));\nexport { DocumentEditor };\n","import { isNullOrUndefined } from '@syncfusion/ej2-base';\n/**\n * Print class\n */\nvar Print = /** @class */ (function () {\n    function Print() {\n    }\n    /**\n     * Gets module name.\n     */\n    Print.prototype.getModuleName = function () {\n        return 'Print';\n    };\n    /**\n     * Prints the current viewer\n     * @param viewer\n     * @param printWindow\n     * @private\n     */\n    Print.prototype.print = function (viewer, printWindow) {\n        this.printWindow(viewer, navigator.userAgent, printWindow);\n    };\n    /**\n     * Opens print window and displays current page to print.\n     * @private\n     */\n    Print.prototype.printWindow = function (viewer, browserUserAgent, printWindow) {\n        var height = this.getPageHeight(viewer.pages);\n        var width = this.getPageWidth(viewer.pages);\n        var printElement = document.createElement('div');\n        printElement.style.width = '100%';\n        printElement.style.height = '100%';\n        printElement.style.overflow = 'scroll';\n        // Rendering canvas to print\n        this.generatePrintContent(viewer, printElement);\n        if (isNullOrUndefined(printWindow)) {\n            printWindow = window.open('', 'print', 'height=452,width=1024,tabbar=no');\n        }\n        if ((browserUserAgent.indexOf('Chrome') !== -1) || (browserUserAgent.indexOf('Firefox')) !== -1) {\n            // Chrome and Firefox\n            printWindow.document.write('<!DOCTYPE html>');\n            // tslint:disable-next-line:max-line-length\n            printWindow.document.write('<html moznomarginboxes mozdisallowselectionprint><head><style>html, body { height: 100 %; } img { height: 100 %; width: 100 %; display: block;}img { box-sizing: border-box; }br, button { display: none; }@page{ margin: 0cm; size:' + width.toString() + 'px ' + height.toString() + 'px; }@media print{ body { margin: 0cm; }</style></head> <body><center>');\n        }\n        else {\n            // Internet Explorer and Edge\n            // tslint:disable-next-line:max-line-length\n            printWindow.document.write('<html><head><style>@page{margin:0;size:' + width.toString() + 'px ' + height.toString() + 'px;}</style></head><body><center>');\n        }\n        // tslint:disable-next-line:max-line-length\n        printWindow.document.write(printElement.innerHTML + '</center><script> (function() { window.ready = true; })(); </script></body></html>');\n        printElement = undefined;\n        printWindow.document.close();\n        printWindow.focus();\n        var interval = setInterval(function () {\n            if (printWindow.ready) {\n                printWindow.print();\n                printWindow.close();\n                clearInterval(interval);\n            }\n        }, 500);\n    };\n    /**\n     * Generates print content.\n     * @private\n     */\n    Print.prototype.generatePrintContent = function (viewer, element) {\n        // Rendering canvas to print\n        var htmlString = '';\n        for (var i = 0; i < viewer.pages.length; i++) {\n            var page = viewer.pages[i];\n            var pageHeight = page.boundingRectangle.height;\n            var pageWidth = page.boundingRectangle.width;\n            viewer.render.isPrinting = true;\n            viewer.render.renderWidgets(page, 0, 0, 0, 0);\n            var canvasURL = viewer.render.pageCanvas.toDataURL();\n            viewer.render.isPrinting = false;\n            // tslint:disable-next-line:max-line-length\n            htmlString += '<div><img src=' + canvasURL + ' style=\"margin:0px;display:block;width: ' + pageWidth.toString() + 'px; height:' + pageHeight.toString() + 'px; \"/></div><br/>';\n        }\n        element.innerHTML = htmlString;\n    };\n    /**\n     * Gets page width.\n     * @param pages\n     * @private\n     */\n    Print.prototype.getPageWidth = function (pages) {\n        var width = 0;\n        for (var i = 0; i < pages.length; i++) {\n            if (width < pages[i].boundingRectangle.width) {\n                width = pages[i].boundingRectangle.width;\n            }\n        }\n        return width;\n    };\n    /**\n     *  Gets page height.\n     * @private\n     */\n    Print.prototype.getPageHeight = function (pages) {\n        var height = 0;\n        for (var i = 0; i < pages.length; i++) {\n            if (height < pages[i].boundingRectangle.height) {\n                height = pages[i].boundingRectangle.height;\n            }\n        }\n        return height;\n    };\n    /**\n     * @private\n     */\n    Print.prototype.destroy = function () {\n        return;\n    };\n    return Print;\n}());\nexport { Print };\n","import { isNullOrUndefined } from '@syncfusion/ej2-base';\nimport { Dictionary } from '../../base/dictionary';\nimport { WUniqueFormat } from '../../base/unique-format';\nimport { WUniqueFormats } from '../../base/unique-formats';\n/**\n * @private\n */\nvar WSectionFormat = /** @class */ (function () {\n    function WSectionFormat(node) {\n        this.uniqueSectionFormat = undefined;\n        this.ownerBase = node;\n    }\n    Object.defineProperty(WSectionFormat.prototype, \"headerDistance\", {\n        get: function () {\n            return this.getPropertyValue('headerDistance');\n        },\n        set: function (value) {\n            this.setPropertyValue('headerDistance', value);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(WSectionFormat.prototype, \"footerDistance\", {\n        get: function () {\n            return this.getPropertyValue('footerDistance');\n        },\n        set: function (value) {\n            this.setPropertyValue('footerDistance', value);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(WSectionFormat.prototype, \"differentFirstPage\", {\n        get: function () {\n            return this.getPropertyValue('differentFirstPage');\n        },\n        set: function (value) {\n            this.setPropertyValue('differentFirstPage', value);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(WSectionFormat.prototype, \"differentOddAndEvenPages\", {\n        get: function () {\n            return this.getPropertyValue('differentOddAndEvenPages');\n        },\n        set: function (value) {\n            this.setPropertyValue('differentOddAndEvenPages', value);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(WSectionFormat.prototype, \"pageHeight\", {\n        get: function () {\n            return this.getPropertyValue('pageHeight');\n        },\n        set: function (value) {\n            this.setPropertyValue('pageHeight', value);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(WSectionFormat.prototype, \"rightMargin\", {\n        get: function () {\n            return this.getPropertyValue('rightMargin');\n        },\n        set: function (value) {\n            this.setPropertyValue('rightMargin', value);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(WSectionFormat.prototype, \"pageWidth\", {\n        get: function () {\n            return this.getPropertyValue('pageWidth');\n        },\n        set: function (value) {\n            this.setPropertyValue('pageWidth', value);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(WSectionFormat.prototype, \"leftMargin\", {\n        get: function () {\n            return this.getPropertyValue('leftMargin');\n        },\n        set: function (value) {\n            this.setPropertyValue('leftMargin', value);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(WSectionFormat.prototype, \"bottomMargin\", {\n        get: function () {\n            return this.getPropertyValue('bottomMargin');\n        },\n        set: function (value) {\n            this.setPropertyValue('bottomMargin', value);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(WSectionFormat.prototype, \"topMargin\", {\n        get: function () {\n            return this.getPropertyValue('topMargin');\n        },\n        set: function (value) {\n            this.setPropertyValue('topMargin', value);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    WSectionFormat.prototype.destroy = function () {\n        if (!isNullOrUndefined(this.uniqueSectionFormat)) {\n            WSectionFormat.uniqueSectionFormats.remove(this.uniqueSectionFormat);\n        }\n        this.uniqueSectionFormat = undefined;\n    };\n    WSectionFormat.prototype.hasValue = function (property) {\n        if (!isNullOrUndefined(this.uniqueSectionFormat)) {\n            var propertyType = WUniqueFormat.getPropertyType(this.uniqueSectionFormat.uniqueFormatType, property);\n            return this.uniqueSectionFormat.propertiesHash.containsKey(propertyType);\n        }\n        return false;\n    };\n    WSectionFormat.getPropertyDefaultValue = function (property) {\n        var value = undefined;\n        switch (property) {\n            case 'headerDistance':\n                value = 36;\n                break;\n            case 'footerDistance':\n                value = 36;\n                break;\n            case 'differentFirstPage':\n                value = false;\n                break;\n            case 'differentOddAndEvenPages':\n                value = false;\n                break;\n            case 'pageWidth':\n                value = 612;\n                break;\n            case 'pageHeight':\n                value = 792;\n                break;\n            case 'leftMargin':\n                value = 72;\n                break;\n            case 'topMargin':\n                value = 72;\n                break;\n            case 'rightMargin':\n                value = 72;\n                break;\n            case 'bottomMargin':\n                value = 72;\n                break;\n        }\n        return value;\n    };\n    WSectionFormat.prototype.getPropertyValue = function (property) {\n        var hasValue = this.hasValue(property);\n        if (hasValue) {\n            var propertyType = WUniqueFormat.getPropertyType(WSectionFormat.uniqueFormatType, property);\n            if (!isNullOrUndefined(this.uniqueSectionFormat) && this.uniqueSectionFormat.propertiesHash.containsKey(propertyType)) {\n                return this.uniqueSectionFormat.propertiesHash.get(propertyType);\n            }\n        }\n        return WSectionFormat.getPropertyDefaultValue(property);\n    };\n    WSectionFormat.prototype.setPropertyValue = function (property, value) {\n        if (isNullOrUndefined(value) || value === '') {\n            value = WSectionFormat.getPropertyDefaultValue(property);\n        }\n        if (isNullOrUndefined(this.uniqueSectionFormat)) {\n            this.initializeUniqueSectionFormat(property, value);\n        }\n        else {\n            var propertyType = WUniqueFormat.getPropertyType(this.uniqueSectionFormat.uniqueFormatType, property);\n            if (this.uniqueSectionFormat.propertiesHash.containsKey(propertyType) &&\n                this.uniqueSectionFormat.propertiesHash.get(propertyType) === value) {\n                //Do nothing, since no change in property value and return\n                return;\n            }\n            // tslint:disable-next-line:max-line-length\n            this.uniqueSectionFormat = WSectionFormat.uniqueSectionFormats.updateUniqueFormat(this.uniqueSectionFormat, property, value);\n        }\n    };\n    WSectionFormat.prototype.initializeUniqueSectionFormat = function (property, propValue) {\n        var uniqueSectionFormatTemp = new Dictionary();\n        this.addUniqueSectionFormat('headerDistance', property, propValue, uniqueSectionFormatTemp);\n        this.addUniqueSectionFormat('footerDistance', property, propValue, uniqueSectionFormatTemp);\n        this.addUniqueSectionFormat('differentFirstPage', property, propValue, uniqueSectionFormatTemp);\n        this.addUniqueSectionFormat('differentOddAndEvenPages', property, propValue, uniqueSectionFormatTemp);\n        this.addUniqueSectionFormat('pageWidth', property, propValue, uniqueSectionFormatTemp);\n        this.addUniqueSectionFormat('pageHeight', property, propValue, uniqueSectionFormatTemp);\n        this.addUniqueSectionFormat('leftMargin', property, propValue, uniqueSectionFormatTemp);\n        this.addUniqueSectionFormat('topMargin', property, propValue, uniqueSectionFormatTemp);\n        this.addUniqueSectionFormat('rightMargin', property, propValue, uniqueSectionFormatTemp);\n        this.addUniqueSectionFormat('bottomMargin', property, propValue, uniqueSectionFormatTemp);\n        // tslint:disable-next-line:max-line-length\n        this.uniqueSectionFormat = WSectionFormat.uniqueSectionFormats.addUniqueFormat(uniqueSectionFormatTemp, WSectionFormat.uniqueFormatType);\n    };\n    // tslint:disable-next-line:max-line-length\n    WSectionFormat.prototype.addUniqueSectionFormat = function (property, modifiedProperty, propValue, uniqueSectionFormatTemp) {\n        var propertyType;\n        propertyType = WUniqueFormat.getPropertyType(WSectionFormat.uniqueFormatType, property);\n        if (property === modifiedProperty) {\n            uniqueSectionFormatTemp.add(propertyType, propValue);\n        }\n        else {\n            uniqueSectionFormatTemp.add(propertyType, WSectionFormat.getPropertyDefaultValue(property));\n        }\n    };\n    WSectionFormat.prototype.copyFormat = function (format, history) {\n        if (history && (history.isUndoing || history.isRedoing)) {\n            this.uniqueSectionFormat = format.uniqueSectionFormat;\n        }\n        else {\n            if (!isNullOrUndefined(format)) {\n                if (!isNullOrUndefined(format.uniqueSectionFormat) && format.uniqueSectionFormat.propertiesHash) {\n                    this.updateUniqueSectionFormat(format);\n                }\n            }\n        }\n    };\n    WSectionFormat.prototype.updateUniqueSectionFormat = function (format) {\n        var hash = undefined;\n        if (this.uniqueSectionFormat) {\n            hash = this.uniqueSectionFormat.mergeProperties(format.uniqueSectionFormat);\n            if (this.uniqueSectionFormat.referenceCount === 0) {\n                WSectionFormat.uniqueSectionFormats.remove(this.uniqueSectionFormat);\n                this.uniqueSectionFormat = undefined;\n            }\n        }\n        this.uniqueSectionFormat = new WUniqueFormat(WSectionFormat.uniqueFormatType);\n        if (isNullOrUndefined(hash)) {\n            hash = this.uniqueSectionFormat.mergeProperties(format.uniqueSectionFormat);\n        }\n        this.uniqueSectionFormat = WSectionFormat.uniqueSectionFormats.addUniqueFormat(hash, WSectionFormat.uniqueFormatType);\n    };\n    WSectionFormat.prototype.cloneFormat = function () {\n        var format = new WSectionFormat();\n        format.uniqueSectionFormat = this.uniqueSectionFormat;\n        return format;\n    };\n    WSectionFormat.clear = function () {\n        this.uniqueSectionFormats.clear();\n    };\n    WSectionFormat.uniqueSectionFormats = new WUniqueFormats();\n    WSectionFormat.uniqueFormatType = 10;\n    return WSectionFormat;\n}());\nexport { WSectionFormat };\n","import { isNullOrUndefined } from '@syncfusion/ej2-base';\n/**\n * @private\n */\nvar WLevelOverride = /** @class */ (function () {\n    function WLevelOverride() {\n    }\n    WLevelOverride.prototype.destroy = function () {\n        if (!isNullOrUndefined(this.overrideListLevel)) {\n            this.overrideListLevel.destroy();\n        }\n        this.levelNumber = undefined;\n        this.startAt = undefined;\n        this.overrideListLevel = undefined;\n    };\n    return WLevelOverride;\n}());\nexport { WLevelOverride };\n","import { isNullOrUndefined } from '@syncfusion/ej2-base';\nimport { WLevelOverride } from './level-override';\n/**\n * @private\n */\nvar WList = /** @class */ (function () {\n    function WList() {\n        this.listId = -1;\n        this.sourceListId = -1;\n        this.abstractListId = -1;\n        this.abstractList = undefined;\n        this.levelOverrides = [];\n    }\n    WList.prototype.getListLevel = function (levelNumber) {\n        var listLevel = undefined;\n        var levelOverride = this.getLevelOverride(levelNumber);\n        if (!isNullOrUndefined(levelOverride) && !isNullOrUndefined(levelOverride.overrideListLevel)) {\n            listLevel = levelOverride.overrideListLevel;\n        }\n        else {\n            listLevel = this.abstractList.levels[levelNumber];\n        }\n        return listLevel;\n    };\n    WList.prototype.getLevelOverride = function (levelNumber) {\n        for (var i = 0; i < this.levelOverrides.length; i++) {\n            if (this.levelOverrides[i] instanceof WLevelOverride) {\n                var levelOverride = this.levelOverrides[i];\n                if (levelOverride.levelNumber === levelNumber) {\n                    return levelOverride;\n                }\n            }\n        }\n        return undefined;\n    };\n    WList.prototype.destroy = function () {\n        if (!isNullOrUndefined(this.levelOverrides)) {\n            this.levelOverrides = [];\n        }\n        this.abstractListId = undefined;\n        this.listId = undefined;\n        this.sourceListId = undefined;\n        this.levelOverrides = undefined;\n    };\n    WList.prototype.mergeList = function (list) {\n        if (!isNullOrUndefined(this.abstractListId) && this.abstractListId !== -1) {\n            this.abstractListId = list.abstractListId;\n        }\n        if (!isNullOrUndefined(this.listId) && this.listId !== -1) {\n            this.listId = list.listId;\n        }\n        if (!isNullOrUndefined(this.sourceListId) && this.sourceListId !== -1) {\n            this.sourceListId = list.sourceListId;\n        }\n        if (!isNullOrUndefined(this.levelOverrides) && this.levelOverrides.length !== 0) {\n            this.levelOverrides = list.levelOverrides;\n        }\n    };\n    return WList;\n}());\nexport { WList };\n","import { isNullOrUndefined } from '@syncfusion/ej2-base';\nimport { Dictionary } from '../../base/dictionary';\nimport { WUniqueFormat } from '../../base/unique-format';\nimport { WUniqueFormats } from '../../base/unique-formats';\nimport { WParagraphStyle } from './style';\nimport { WList } from '../list/list';\n/**\n * @private\n */\nvar WListFormat = /** @class */ (function () {\n    function WListFormat(node) {\n        this.uniqueListFormat = undefined;\n        this.ownerBase = undefined;\n        this.baseStyle = undefined;\n        this.list = undefined;\n        this.ownerBase = node;\n    }\n    Object.defineProperty(WListFormat.prototype, \"listId\", {\n        get: function () {\n            return this.getPropertyValue('listId');\n        },\n        set: function (listId) {\n            this.setPropertyValue('listId', listId);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(WListFormat.prototype, \"listLevelNumber\", {\n        get: function () {\n            return this.getPropertyValue('listLevelNumber');\n        },\n        set: function (value) {\n            this.setPropertyValue('listLevelNumber', value);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(WListFormat.prototype, \"listLevel\", {\n        get: function () {\n            var list = undefined;\n            if (!isNullOrUndefined(this.list)) {\n                list = this.list;\n            }\n            else {\n                /* tslint:disable-next-line:no-any */\n                var baseListStyle = this.baseStyle;\n                while (!isNullOrUndefined(baseListStyle)) {\n                    if (baseListStyle.paragraphFormat.listFormat.list) {\n                        list = baseListStyle.paragraphFormat.listFormat.list;\n                        break;\n                    }\n                    else {\n                        baseListStyle = baseListStyle.basedOn;\n                    }\n                }\n            }\n            if (!isNullOrUndefined(list)) {\n                return list.getListLevel(this.listLevelNumber);\n            }\n            else {\n                return undefined;\n            }\n        },\n        enumerable: true,\n        configurable: true\n    });\n    WListFormat.prototype.getPropertyValue = function (property) {\n        if (!this.hasValue(property)) {\n            if (this.baseStyle instanceof WParagraphStyle) {\n                /* tslint:disable-next-line:no-any */\n                var baseStyle = this.baseStyle;\n                while (!isNullOrUndefined(baseStyle)) {\n                    if (baseStyle.paragraphFormat.listFormat.hasValue(property)) {\n                        break;\n                    }\n                    else {\n                        baseStyle = baseStyle.basedOn;\n                    }\n                }\n                if (!isNullOrUndefined(baseStyle)) {\n                    var propertyType = WUniqueFormat.getPropertyType(WListFormat.uniqueFormatType, property);\n                    return baseStyle.paragraphFormat.listFormat.uniqueListFormat.propertiesHash.get(propertyType);\n                }\n            }\n        }\n        else {\n            var propertyType = WUniqueFormat.getPropertyType(WListFormat.uniqueFormatType, property);\n            if (!isNullOrUndefined(this.uniqueListFormat) && this.uniqueListFormat.propertiesHash.containsKey(propertyType)) {\n                return this.uniqueListFormat.propertiesHash.get(propertyType);\n            }\n        }\n        return WListFormat.getPropertyDefaultValue(property);\n    };\n    WListFormat.prototype.setPropertyValue = function (property, value) {\n        if (isNullOrUndefined(value) || value === '') {\n            value = WListFormat.getPropertyDefaultValue(property);\n        }\n        if (isNullOrUndefined(this.uniqueListFormat)) {\n            this.initializeUniqueListFormat(property, value);\n        }\n        else {\n            var propertyType = WUniqueFormat.getPropertyType(this.uniqueListFormat.uniqueFormatType, property);\n            if (this.uniqueListFormat.propertiesHash.containsKey(propertyType) &&\n                this.uniqueListFormat.propertiesHash.get(propertyType) === value) {\n                //Do nothing, since no change in property value and return\n                return;\n            }\n            this.uniqueListFormat = WListFormat.uniqueListFormats.updateUniqueFormat(this.uniqueListFormat, property, value);\n        }\n    };\n    WListFormat.prototype.initializeUniqueListFormat = function (property, propValue) {\n        var uniqueListFormatTemp = new Dictionary();\n        this.addUniqueListFormat('listId', property, propValue, uniqueListFormatTemp);\n        this.addUniqueListFormat('listLevelNumber', property, propValue, uniqueListFormatTemp);\n        this.uniqueListFormat = WListFormat.uniqueListFormats.addUniqueFormat(uniqueListFormatTemp, WListFormat.uniqueFormatType);\n    };\n    // tslint:disable-next-line:max-line-length\n    WListFormat.prototype.addUniqueListFormat = function (property, modifiedProperty, propValue, uniqueListFormatTemp) {\n        var propertyType;\n        propertyType = WUniqueFormat.getPropertyType(WListFormat.uniqueFormatType, property);\n        if (property === modifiedProperty) {\n            uniqueListFormatTemp.add(propertyType, propValue);\n        }\n    };\n    WListFormat.getPropertyDefaultValue = function (property) {\n        var value = undefined;\n        switch (property) {\n            case 'listId':\n                value = -1;\n                break;\n            case 'listLevelNumber':\n                value = 0;\n                break;\n        }\n        return value;\n    };\n    WListFormat.prototype.copyFormat = function (format) {\n        if (!isNullOrUndefined(format)) {\n            if (!isNullOrUndefined(format.uniqueListFormat)) {\n                this.listId = format.listId;\n                this.listLevelNumber = format.listLevelNumber;\n            }\n            if (!isNullOrUndefined(format.baseStyle)) {\n                this.baseStyle = format.baseStyle;\n            }\n            if (!isNullOrUndefined(format.list)) {\n                this.list = format.list;\n            }\n        }\n    };\n    WListFormat.prototype.hasValue = function (property) {\n        if (!isNullOrUndefined(this.uniqueListFormat)) {\n            var propertyType = WUniqueFormat.getPropertyType(this.uniqueListFormat.uniqueFormatType, property);\n            return this.uniqueListFormat.propertiesHash.containsKey(propertyType);\n        }\n        return false;\n    };\n    WListFormat.prototype.clearFormat = function () {\n        if (!isNullOrUndefined(this.uniqueListFormat) && this.uniqueListFormat.referenceCount === 0) {\n            WListFormat.uniqueListFormats.remove(this.uniqueListFormat);\n        }\n        this.uniqueListFormat = undefined;\n        this.list = undefined;\n    };\n    WListFormat.prototype.destroy = function () {\n        this.clearFormat();\n    };\n    WListFormat.clear = function () {\n        this.uniqueListFormats.clear();\n    };\n    WListFormat.prototype.ApplyStyle = function (baseStyle) {\n        this.baseStyle = baseStyle;\n    };\n    /**\n     * For internal use\n     * @private\n     */\n    WListFormat.prototype.getValue = function (property) {\n        return this.hasValue(property) ? this.getPropertyValue(property) : undefined;\n    };\n    /**\n     * For internal use\n     * @private\n     */\n    WListFormat.prototype.mergeFormat = function (format) {\n        if (isNullOrUndefined(this.getValue('listId'))) {\n            this.listId = format.getValue('listId');\n        }\n        if (isNullOrUndefined(this.getValue('listLevelNumber'))) {\n            this.listLevelNumber = format.getValue('listLevelNumber');\n        }\n        if (!isNullOrUndefined(format.list)) {\n            if (isNullOrUndefined(this.list)) {\n                this.list = new WList();\n            }\n            this.list.mergeList(format.list);\n        }\n    };\n    WListFormat.uniqueListFormats = new WUniqueFormats();\n    WListFormat.uniqueFormatType = 7;\n    return WListFormat;\n}());\nexport { WListFormat };\n","import { isNullOrUndefined } from '@syncfusion/ej2-base';\nimport { Dictionary } from '../../base/dictionary';\nimport { WUniqueFormat } from '../../base/unique-format';\nimport { WUniqueFormats } from '../../base/unique-formats';\nimport { WListFormat } from './list-format';\nimport { WParagraphStyle } from './style';\n/**\n * @private\n */\nvar WTabStop = /** @class */ (function () {\n    function WTabStop() {\n    }\n    Object.defineProperty(WTabStop.prototype, \"position\", {\n        get: function () {\n            return this.positionIn;\n        },\n        set: function (value) {\n            this.positionIn = value;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(WTabStop.prototype, \"deletePosition\", {\n        get: function () {\n            return this.deletePositionIn;\n        },\n        set: function (value) {\n            this.deletePositionIn = value;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(WTabStop.prototype, \"tabJustification\", {\n        get: function () {\n            return this.justification;\n        },\n        set: function (value) {\n            this.justification = value;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(WTabStop.prototype, \"tabLeader\", {\n        get: function () {\n            return this.leader;\n        },\n        set: function (value) {\n            this.leader = value;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    WTabStop.prototype.destroy = function () {\n        this.position = undefined;\n        this.deletePosition = undefined;\n        this.tabJustification = undefined;\n        this.leader = undefined;\n    };\n    return WTabStop;\n}());\nexport { WTabStop };\n/**\n * @private\n */\nvar WParagraphFormat = /** @class */ (function () {\n    function WParagraphFormat(node) {\n        this.uniqueParagraphFormat = undefined;\n        this.ownerBase = undefined;\n        this.baseStyle = undefined;\n        this.tabs = undefined;\n        this.ownerBase = node;\n        this.listFormat = new WListFormat(this);\n        this.tabs = [];\n    }\n    WParagraphFormat.prototype.getUpdatedTabs = function () {\n        var inTabs = [];\n        if (!isNullOrUndefined(this.baseStyle)) {\n            /* tslint:disable-next-line:no-any */\n            var baseStyle = this.baseStyle;\n            var tabStops = new Dictionary();\n            while (!isNullOrUndefined(baseStyle)) {\n                for (var _i = 0, _a = baseStyle.paragraphFormat.tabs; _i < _a.length; _i++) {\n                    var tab = _a[_i];\n                    if (!tabStops.containsKey(tab.position)) {\n                        tabStops.add(tab.position, tab);\n                    }\n                }\n                baseStyle = baseStyle.basedOn;\n            }\n            for (var _b = 0, _c = tabStops.keys; _b < _c.length; _b++) {\n                var key = _c[_b];\n                if (!this.hasTabStop(key)) {\n                    inTabs.push(tabStops.get(key));\n                }\n            }\n            inTabs = inTabs.concat(this.tabs.filter(function (a) { return (a.position !== 0 && a.deletePosition === 0); }));\n            inTabs = inTabs.sort(function (a, b) { return a.position - b.position; });\n        }\n        return inTabs;\n    };\n    WParagraphFormat.prototype.hasTabStop = function (position) {\n        for (var i = 0; i < this.tabs.length; i++) {\n            if (this.tabs[i].deletePosition === position) {\n                return true;\n            }\n        }\n        return false;\n    };\n    Object.defineProperty(WParagraphFormat.prototype, \"leftIndent\", {\n        get: function () {\n            return this.getPropertyValue('leftIndent');\n        },\n        set: function (value) {\n            this.setPropertyValue('leftIndent', value);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(WParagraphFormat.prototype, \"rightIndent\", {\n        get: function () {\n            return this.getPropertyValue('rightIndent');\n        },\n        set: function (value) {\n            this.setPropertyValue('rightIndent', value);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(WParagraphFormat.prototype, \"firstLineIndent\", {\n        get: function () {\n            return this.getPropertyValue('firstLineIndent');\n        },\n        set: function (value) {\n            this.setPropertyValue('firstLineIndent', value);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(WParagraphFormat.prototype, \"beforeSpacing\", {\n        get: function () {\n            return this.getPropertyValue('beforeSpacing');\n        },\n        set: function (value) {\n            this.setPropertyValue('beforeSpacing', value);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(WParagraphFormat.prototype, \"afterSpacing\", {\n        get: function () {\n            return this.getPropertyValue('afterSpacing');\n        },\n        set: function (value) {\n            this.setPropertyValue('afterSpacing', value);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(WParagraphFormat.prototype, \"lineSpacing\", {\n        get: function () {\n            return this.getPropertyValue('lineSpacing');\n        },\n        set: function (value) {\n            this.setPropertyValue('lineSpacing', value);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(WParagraphFormat.prototype, \"lineSpacingType\", {\n        get: function () {\n            return this.getPropertyValue('lineSpacingType');\n        },\n        set: function (value) {\n            this.setPropertyValue('lineSpacingType', value);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(WParagraphFormat.prototype, \"textAlignment\", {\n        get: function () {\n            return this.getPropertyValue('textAlignment');\n        },\n        set: function (value) {\n            this.setPropertyValue('textAlignment', value);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(WParagraphFormat.prototype, \"outlineLevel\", {\n        get: function () {\n            return this.getPropertyValue('outlineLevel');\n        },\n        set: function (value) {\n            this.setPropertyValue('outlineLevel', value);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    WParagraphFormat.prototype.getListFormatParagraphFormat = function (property) {\n        if (this.listFormat.listId > -1 && this.listFormat.listLevelNumber > -1) {\n            var level = this.listFormat.listLevel;\n            var propertyType = WUniqueFormat.getPropertyType(WParagraphFormat.uniqueFormatType, property);\n            // tslint:disable-next-line:max-line-length\n            if (!isNullOrUndefined(level) && !isNullOrUndefined(level.paragraphFormat.uniqueParagraphFormat) && level.paragraphFormat.uniqueParagraphFormat.propertiesHash.containsKey(propertyType)) {\n                return level.paragraphFormat.uniqueParagraphFormat.propertiesHash.get(propertyType);\n            }\n            else {\n                return undefined;\n            }\n        }\n        return undefined;\n    };\n    WParagraphFormat.prototype.getPropertyValue = function (property) {\n        if (!this.hasValue(property)) {\n            var ifListFormat = this.getListFormatParagraphFormat(property);\n            if (!isNullOrUndefined(ifListFormat)) {\n                return ifListFormat;\n            }\n            else {\n                if (this.baseStyle instanceof WParagraphStyle) {\n                    /* tslint:disable-next-line:no-any */\n                    var baseStyle = this.baseStyle;\n                    while (!isNullOrUndefined(baseStyle)) {\n                        if (baseStyle.paragraphFormat.hasValue(property)) {\n                            break;\n                        }\n                        else {\n                            baseStyle = baseStyle.basedOn;\n                        }\n                    }\n                    if (!isNullOrUndefined(baseStyle)) {\n                        var propertyType = WUniqueFormat.getPropertyType(WParagraphFormat.uniqueFormatType, property);\n                        return baseStyle.paragraphFormat.uniqueParagraphFormat.propertiesHash.get(propertyType);\n                    }\n                }\n            }\n        }\n        else {\n            var propertyType = WUniqueFormat.getPropertyType(WParagraphFormat.uniqueFormatType, property);\n            if (!isNullOrUndefined(this.uniqueParagraphFormat) && this.uniqueParagraphFormat.propertiesHash.containsKey(propertyType)) {\n                return this.uniqueParagraphFormat.propertiesHash.get(propertyType);\n            }\n        }\n        return this.getDefaultValue(property);\n    };\n    WParagraphFormat.prototype.getDefaultValue = function (property) {\n        var propertyType = WUniqueFormat.getPropertyType(WParagraphFormat.uniqueFormatType, property);\n        var docParagraphFormat = this.documentParagraphFormat();\n        // tslint:disable-next-line:max-line-length\n        if (!isNullOrUndefined(docParagraphFormat) && !isNullOrUndefined(docParagraphFormat.uniqueParagraphFormat) && docParagraphFormat.uniqueParagraphFormat.propertiesHash.containsKey(propertyType)) {\n            return docParagraphFormat.uniqueParagraphFormat.propertiesHash.get(propertyType);\n        }\n        else {\n            return WParagraphFormat.getPropertyDefaultValue(property);\n        }\n    };\n    WParagraphFormat.prototype.documentParagraphFormat = function () {\n        var docParagraphFormat;\n        if (!isNullOrUndefined(this.ownerBase)) {\n            if (!isNullOrUndefined(this.ownerBase.bodyWidget)) {\n                docParagraphFormat = this.ownerBase.bodyWidget.page.viewer.paragraphFormat;\n            }\n        }\n        return docParagraphFormat;\n    };\n    WParagraphFormat.prototype.setPropertyValue = function (property, value) {\n        if (isNullOrUndefined(value) || value === '') {\n            value = WParagraphFormat.getPropertyDefaultValue(property);\n        }\n        if (isNullOrUndefined(this.uniqueParagraphFormat)) {\n            this.initializeUniqueParagraphFormat(property, value);\n        }\n        else {\n            var propertyType = WUniqueFormat.getPropertyType(this.uniqueParagraphFormat.uniqueFormatType, property);\n            if (this.uniqueParagraphFormat.propertiesHash.containsKey(propertyType) &&\n                this.uniqueParagraphFormat.propertiesHash.get(propertyType) === value) {\n                //Do nothing, since no change in property value and return\n                return;\n            }\n            // tslint:disable-next-line:max-line-length\n            this.uniqueParagraphFormat = WParagraphFormat.uniqueParagraphFormats.updateUniqueFormat(this.uniqueParagraphFormat, property, value);\n        }\n    };\n    WParagraphFormat.prototype.initializeUniqueParagraphFormat = function (property, propValue) {\n        var uniqueParaFormatTemp = new Dictionary();\n        this.addUniqueParaFormat('leftIndent', property, propValue, uniqueParaFormatTemp);\n        this.addUniqueParaFormat('rightIndent', property, propValue, uniqueParaFormatTemp);\n        this.addUniqueParaFormat('firstLineIndent', property, propValue, uniqueParaFormatTemp);\n        this.addUniqueParaFormat('textAlignment', property, propValue, uniqueParaFormatTemp);\n        this.addUniqueParaFormat('beforeSpacing', property, propValue, uniqueParaFormatTemp);\n        this.addUniqueParaFormat('afterSpacing', property, propValue, uniqueParaFormatTemp);\n        this.addUniqueParaFormat('lineSpacing', property, propValue, uniqueParaFormatTemp);\n        this.addUniqueParaFormat('lineSpacingType', property, propValue, uniqueParaFormatTemp);\n        this.addUniqueParaFormat('outlineLevel', property, propValue, uniqueParaFormatTemp);\n        // tslint:disable-next-line:max-line-length\n        this.uniqueParagraphFormat = WParagraphFormat.uniqueParagraphFormats.addUniqueFormat(uniqueParaFormatTemp, WParagraphFormat.uniqueFormatType);\n    };\n    // tslint:disable-next-line:max-line-length\n    WParagraphFormat.prototype.addUniqueParaFormat = function (property, modifiedProperty, propValue, uniqueParaFormatTemp) {\n        var propertyType;\n        propertyType = WUniqueFormat.getPropertyType(WParagraphFormat.uniqueFormatType, property);\n        if (property === modifiedProperty) {\n            uniqueParaFormatTemp.add(propertyType, propValue);\n        }\n    };\n    WParagraphFormat.getPropertyDefaultValue = function (property) {\n        var value = undefined;\n        switch (property) {\n            case 'leftIndent':\n                value = 0;\n                break;\n            case 'rightIndent':\n                value = 0;\n                break;\n            case 'firstLineIndent':\n                value = 0;\n                break;\n            case 'textAlignment':\n                value = 'Left';\n                break;\n            case 'beforeSpacing':\n                value = 0;\n                break;\n            case 'afterSpacing':\n                value = 0;\n                break;\n            case 'lineSpacing':\n                value = 1;\n                break;\n            case 'lineSpacingType':\n                value = 'Multiple';\n                break;\n            case 'styleName':\n                value = 'Normal';\n                break;\n            case 'outlineLevel':\n                value = 'BodyText';\n                break;\n        }\n        return value;\n    };\n    WParagraphFormat.prototype.clearFormat = function () {\n        if (!isNullOrUndefined(this.listFormat)) {\n            this.listFormat.clearFormat();\n        }\n        if (!isNullOrUndefined(this.uniqueParagraphFormat) && this.uniqueParagraphFormat.referenceCount === 0) {\n            WParagraphFormat.uniqueParagraphFormats.remove(this.uniqueParagraphFormat);\n        }\n        this.uniqueParagraphFormat = undefined;\n        this.baseStyle = undefined;\n    };\n    WParagraphFormat.prototype.destroy = function () {\n        this.clearFormat();\n        if (!isNullOrUndefined(this.listFormat)) {\n            this.listFormat.destroy();\n        }\n        this.listFormat = undefined;\n        if (this.tabs !== undefined) {\n            for (var i = 0; i < this.tabs.length; i++) {\n                this.tabs[i].destroy();\n            }\n            this.tabs = undefined;\n        }\n    };\n    WParagraphFormat.prototype.copyFormat = function (format) {\n        if (!isNullOrUndefined(format)) {\n            if (!isNullOrUndefined(format.uniqueParagraphFormat)) {\n                this.updateUniqueParagraphFormat(format);\n            }\n            if (!isNullOrUndefined(format.listFormat)) {\n                this.listFormat.copyFormat(format.listFormat);\n            }\n            if (!isNullOrUndefined(format.baseStyle)) {\n                this.baseStyle = format.baseStyle;\n            }\n            if (!isNullOrUndefined(format.tabs)) {\n                for (var i = 0; i < format.tabs.length; i++) {\n                    this.tabs[i] = format.tabs[i];\n                }\n            }\n        }\n    };\n    WParagraphFormat.prototype.updateUniqueParagraphFormat = function (format) {\n        var hash = undefined;\n        if (this.uniqueParagraphFormat) {\n            hash = this.uniqueParagraphFormat.mergeProperties(format.uniqueParagraphFormat);\n            if (this.uniqueParagraphFormat.referenceCount === 0) {\n                WParagraphFormat.uniqueParagraphFormats.remove(this.uniqueParagraphFormat);\n                this.uniqueParagraphFormat = undefined;\n            }\n        }\n        this.uniqueParagraphFormat = new WUniqueFormat(WParagraphFormat.uniqueFormatType);\n        if (isNullOrUndefined(hash)) {\n            hash = this.uniqueParagraphFormat.mergeProperties(format.uniqueParagraphFormat);\n        }\n        this.uniqueParagraphFormat = WParagraphFormat.uniqueParagraphFormats.addUniqueFormat(hash, WParagraphFormat.uniqueFormatType);\n    };\n    WParagraphFormat.prototype.cloneFormat = function () {\n        var format = new WParagraphFormat(undefined);\n        format.uniqueParagraphFormat = this.uniqueParagraphFormat;\n        format.baseStyle = this.baseStyle;\n        if (isNullOrUndefined(this.listFormat)) {\n            format.listFormat = undefined;\n        }\n        else {\n            format.listFormat = new WListFormat();\n            format.listFormat.listId = this.listFormat.listId;\n            format.listFormat.listLevelNumber = this.listFormat.listLevelNumber;\n        }\n        return format;\n    };\n    WParagraphFormat.prototype.hasValue = function (property) {\n        if (!isNullOrUndefined(this.uniqueParagraphFormat) && !isNullOrUndefined(this.uniqueParagraphFormat.propertiesHash)) {\n            var propertyType = WUniqueFormat.getPropertyType(this.uniqueParagraphFormat.uniqueFormatType, property);\n            return this.uniqueParagraphFormat.propertiesHash.containsKey(propertyType);\n        }\n        return false;\n    };\n    WParagraphFormat.clear = function () {\n        this.uniqueParagraphFormats.clear();\n    };\n    WParagraphFormat.prototype.ApplyStyle = function (baseStyle) {\n        this.baseStyle = baseStyle;\n        this.listFormat.ApplyStyle(this.baseStyle);\n    };\n    /**\n     * For internal use\n     * @private\n     */\n    WParagraphFormat.prototype.getValue = function (property) {\n        return this.hasValue(property) ? this.getPropertyValue(property) : undefined;\n    };\n    /**\n     * For internal use\n     * @private\n     */\n    WParagraphFormat.prototype.mergeFormat = function (format) {\n        if (isNullOrUndefined(this.getValue('leftIndent'))) {\n            this.leftIndent = format.getValue('leftIndent');\n        }\n        if (isNullOrUndefined(this.getValue('rightIndent'))) {\n            this.rightIndent = format.getValue('rightIndent');\n        }\n        if (isNullOrUndefined(this.getValue('firstLineIndent'))) {\n            this.firstLineIndent = format.getValue('firstLineIndent');\n        }\n        if (isNullOrUndefined(this.getValue('beforeSpacing'))) {\n            this.beforeSpacing = format.getValue('beforeSpacing');\n        }\n        if (isNullOrUndefined(this.getValue('afterSpacing'))) {\n            this.afterSpacing = format.getValue('afterSpacing');\n        }\n        if (isNullOrUndefined(this.getValue('lineSpacing'))) {\n            this.lineSpacing = format.getValue('lineSpacing');\n        }\n        if (isNullOrUndefined(this.getValue('lineSpacingType'))) {\n            this.lineSpacingType = format.getValue('lineSpacingType');\n        }\n        if (isNullOrUndefined(this.getValue('textAlignment'))) {\n            this.textAlignment = format.getValue('textAlignment');\n        }\n        if (isNullOrUndefined(this.getValue('outlineLevel'))) {\n            this.outlineLevel = format.getValue('outlineLevel');\n        }\n        if (isNullOrUndefined(this.listFormat)) {\n            this.listFormat.mergeFormat(format.listFormat);\n        }\n    };\n    WParagraphFormat.uniqueParagraphFormats = new WUniqueFormats();\n    WParagraphFormat.uniqueFormatType = 3;\n    return WParagraphFormat;\n}());\nexport { WParagraphFormat };\n","import { ParagraphWidget } from '../viewer/page';\nimport { Dictionary } from '../../base/dictionary';\nimport { WUniqueFormat } from '../../base/unique-format';\nimport { WUniqueFormats } from '../../base/unique-formats';\nimport { WParagraphStyle } from './style';\nimport { isNullOrUndefined } from '@syncfusion/ej2-base';\n/**\n * @private\n */\nvar WCharacterFormat = /** @class */ (function () {\n    function WCharacterFormat(node) {\n        this.uniqueCharacterFormat = undefined;\n        this.ownerBase = undefined;\n        this.baseCharStyle = undefined;\n        this.ownerBase = node;\n    }\n    Object.defineProperty(WCharacterFormat.prototype, \"bold\", {\n        get: function () {\n            return this.getPropertyValue('bold');\n        },\n        set: function (value) {\n            this.setPropertyValue('bold', value);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(WCharacterFormat.prototype, \"italic\", {\n        get: function () {\n            return this.getPropertyValue('italic');\n        },\n        set: function (value) {\n            this.setPropertyValue('italic', value);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(WCharacterFormat.prototype, \"fontSize\", {\n        get: function () {\n            return this.getPropertyValue('fontSize');\n        },\n        set: function (value) {\n            this.setPropertyValue('fontSize', value);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(WCharacterFormat.prototype, \"fontFamily\", {\n        get: function () {\n            return this.getPropertyValue('fontFamily');\n        },\n        set: function (value) {\n            this.setPropertyValue('fontFamily', value);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(WCharacterFormat.prototype, \"underline\", {\n        get: function () {\n            return this.getPropertyValue('underline');\n        },\n        set: function (value) {\n            this.setPropertyValue('underline', value);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(WCharacterFormat.prototype, \"strikethrough\", {\n        get: function () {\n            return this.getPropertyValue('strikethrough');\n        },\n        set: function (value) {\n            this.setPropertyValue('strikethrough', value);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(WCharacterFormat.prototype, \"baselineAlignment\", {\n        get: function () {\n            return this.getPropertyValue('baselineAlignment');\n        },\n        set: function (value) {\n            this.setPropertyValue('baselineAlignment', value);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(WCharacterFormat.prototype, \"highlightColor\", {\n        get: function () {\n            return this.getPropertyValue('highlightColor');\n        },\n        set: function (value) {\n            this.setPropertyValue('highlightColor', value);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(WCharacterFormat.prototype, \"fontColor\", {\n        get: function () {\n            return this.getPropertyValue('fontColor');\n        },\n        set: function (value) {\n            this.setPropertyValue('fontColor', value);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    WCharacterFormat.prototype.getPropertyValue = function (property) {\n        if (!this.hasValue(property)) {\n            var charStyleValue = this.checkCharacterStyle(property);\n            if (!isNullOrUndefined(charStyleValue)) {\n                return charStyleValue;\n            }\n            else {\n                var baseStyleValue = this.checkBaseStyle(property);\n                if (!isNullOrUndefined(baseStyleValue)) {\n                    return baseStyleValue;\n                }\n            }\n        }\n        else {\n            var propertyType = WUniqueFormat.getPropertyType(WCharacterFormat.uniqueFormatType, property);\n            if (!isNullOrUndefined(this.uniqueCharacterFormat) && this.uniqueCharacterFormat.propertiesHash.containsKey(propertyType)) {\n                return this.uniqueCharacterFormat.propertiesHash.get(propertyType);\n            }\n        }\n        return this.getDefaultValue(property);\n    };\n    WCharacterFormat.prototype.getDefaultValue = function (property) {\n        var propertyType = WUniqueFormat.getPropertyType(WCharacterFormat.uniqueFormatType, property);\n        var docCharacterFormat = this.documentCharacterFormat();\n        // tslint:disable-next-line:max-line-length\n        if (!isNullOrUndefined(docCharacterFormat) && !isNullOrUndefined(docCharacterFormat.uniqueCharacterFormat) && docCharacterFormat.uniqueCharacterFormat.propertiesHash.containsKey(propertyType)) {\n            return docCharacterFormat.uniqueCharacterFormat.propertiesHash.get(propertyType);\n        }\n        else {\n            return WCharacterFormat.getPropertyDefaultValue(property);\n        }\n    };\n    WCharacterFormat.prototype.documentCharacterFormat = function () {\n        var docCharacterFormat;\n        if (!isNullOrUndefined(this.ownerBase)) {\n            if (!isNullOrUndefined(this.ownerBase.paragraph)) {\n                docCharacterFormat = this.ownerBase.paragraph.bodyWidget.page.viewer.characterFormat;\n            }\n            else {\n                if (!isNullOrUndefined(this.ownerBase.bodyWidget)) {\n                    docCharacterFormat = this.ownerBase.bodyWidget.page.viewer.characterFormat;\n                }\n            }\n        }\n        return docCharacterFormat;\n    };\n    WCharacterFormat.prototype.checkBaseStyle = function (property) {\n        /* tslint:disable-next-line:no-any */\n        var baseStyle;\n        if (!isNullOrUndefined(this.ownerBase)) {\n            if (!isNullOrUndefined(this.ownerBase.paragraph)) {\n                baseStyle = this.ownerBase.paragraph.paragraphFormat.baseStyle;\n            }\n            else {\n                // tslint:disable-next-line:max-line-length\n                if ((this.ownerBase instanceof ParagraphWidget) && !isNullOrUndefined(this.ownerBase.paragraphFormat)) {\n                    baseStyle = this.ownerBase.paragraphFormat.baseStyle;\n                }\n                else {\n                    if (!isNullOrUndefined(this.ownerBase instanceof WParagraphStyle)) {\n                        baseStyle = this.ownerBase.basedOn;\n                    }\n                }\n            }\n        }\n        while (!isNullOrUndefined(baseStyle)) {\n            if (baseStyle.characterFormat.hasValue(property)) {\n                break;\n            }\n            else {\n                baseStyle = baseStyle.basedOn;\n            }\n        }\n        if (!isNullOrUndefined(baseStyle)) {\n            var propertyType = WUniqueFormat.getPropertyType(WCharacterFormat.uniqueFormatType, property);\n            return baseStyle.characterFormat.uniqueCharacterFormat.propertiesHash.get(propertyType);\n        }\n        return undefined;\n    };\n    WCharacterFormat.prototype.checkCharacterStyle = function (property) {\n        /* tslint:disable-next-line:no-any */\n        var baseStyle = this.baseCharStyle;\n        if (!isNullOrUndefined(baseStyle)) {\n            while (!isNullOrUndefined(baseStyle) && baseStyle.name !== 'Default Paragraph Font') {\n                var hasKey = baseStyle.characterFormat.hasValue(property);\n                if (hasKey) {\n                    var returnPropertyType = WUniqueFormat.getPropertyType(WCharacterFormat.uniqueFormatType, property);\n                    return baseStyle.characterFormat.uniqueCharacterFormat.propertiesHash.get(returnPropertyType);\n                }\n                else {\n                    baseStyle = baseStyle.basedOn;\n                }\n            }\n        }\n        return undefined;\n    };\n    WCharacterFormat.prototype.setPropertyValue = function (property, value) {\n        if (isNullOrUndefined(value) || value === '') {\n            value = WCharacterFormat.getPropertyDefaultValue(property);\n        }\n        if (isNullOrUndefined(this.uniqueCharacterFormat)) {\n            this.initializeUniqueCharacterFormat(property, value);\n        }\n        else {\n            var propertyType = WUniqueFormat.getPropertyType(this.uniqueCharacterFormat.uniqueFormatType, property);\n            if (this.uniqueCharacterFormat.propertiesHash.containsKey(propertyType) &&\n                // tslint:disable-next-line:max-line-length\n                this.uniqueCharacterFormat.propertiesHash.get(propertyType) === value) {\n                return;\n            }\n            // tslint:disable-next-line:max-line-length\n            this.uniqueCharacterFormat = WCharacterFormat.uniqueCharacterFormats.updateUniqueFormat(this.uniqueCharacterFormat, property, value);\n        }\n    };\n    WCharacterFormat.prototype.initializeUniqueCharacterFormat = function (property, propValue) {\n        var uniqueCharFormatTemp = new Dictionary();\n        this.addUniqueCharacterFormat('fontColor', property, propValue, uniqueCharFormatTemp);\n        this.addUniqueCharacterFormat('fontFamily', property, propValue, uniqueCharFormatTemp);\n        this.addUniqueCharacterFormat('fontSize', property, propValue, uniqueCharFormatTemp);\n        this.addUniqueCharacterFormat('bold', property, propValue, uniqueCharFormatTemp);\n        this.addUniqueCharacterFormat('italic', property, propValue, uniqueCharFormatTemp);\n        this.addUniqueCharacterFormat('underline', property, propValue, uniqueCharFormatTemp);\n        this.addUniqueCharacterFormat('strikethrough', property, propValue, uniqueCharFormatTemp);\n        this.addUniqueCharacterFormat('baselineAlignment', property, propValue, uniqueCharFormatTemp);\n        this.addUniqueCharacterFormat('highlightColor', property, propValue, uniqueCharFormatTemp);\n        this.addUniqueCharacterFormat('styleName', property, propValue, uniqueCharFormatTemp);\n        // tslint:disable-next-line:max-line-length\n        this.uniqueCharacterFormat = WCharacterFormat.uniqueCharacterFormats.addUniqueFormat(uniqueCharFormatTemp, WCharacterFormat.uniqueFormatType);\n    };\n    // tslint:disable-next-line:max-line-length\n    WCharacterFormat.prototype.addUniqueCharacterFormat = function (property, modifiedProperty, propValue, uniqueCharFormatTemp) {\n        var propertyType;\n        propertyType = WUniqueFormat.getPropertyType(WCharacterFormat.uniqueFormatType, property);\n        if (property === modifiedProperty) {\n            uniqueCharFormatTemp.add(propertyType, propValue);\n        }\n    };\n    WCharacterFormat.getPropertyDefaultValue = function (property) {\n        var value = undefined;\n        switch (property) {\n            case 'bold':\n                value = false;\n                break;\n            case 'italic':\n                value = false;\n                break;\n            case 'fontSize':\n                value = 11;\n                break;\n            case 'underline':\n                value = 'None';\n                break;\n            case 'strikethrough':\n                value = 'None';\n                break;\n            case 'baselineAlignment':\n                value = 'Normal';\n                break;\n            case 'highlightColor':\n                value = 'NoColor';\n                break;\n            case 'fontColor':\n                value = '#000000';\n                break;\n            case 'fontFamily':\n                value = 'Calibri';\n                break;\n            case 'styleName':\n                value = 'Default Paragraph Font';\n                break;\n        }\n        return value;\n    };\n    WCharacterFormat.prototype.isEqualFormat = function (format) {\n        return (this.fontSize === format.fontSize\n            && this.fontFamily === format.fontFamily\n            && this.bold === format.bold\n            && this.italic === format.italic\n            && this.baselineAlignment === format.baselineAlignment\n            && this.underline === format.underline\n            && this.fontColor === format.fontColor\n            && this.strikethrough === format.strikethrough\n            && this.highlightColor === format.highlightColor);\n    };\n    WCharacterFormat.prototype.isSameFormat = function (format) {\n        return this.baseCharStyle === format.baseCharStyle &&\n            this.uniqueCharacterFormat === format.uniqueCharacterFormat;\n    };\n    WCharacterFormat.prototype.cloneFormat = function () {\n        var format = new WCharacterFormat(undefined);\n        format.uniqueCharacterFormat = this.uniqueCharacterFormat;\n        format.baseCharStyle = this.baseCharStyle;\n        return format;\n    };\n    WCharacterFormat.prototype.hasValue = function (property) {\n        if (!isNullOrUndefined(this.uniqueCharacterFormat) && !isNullOrUndefined(this.uniqueCharacterFormat.propertiesHash)) {\n            var propertyType = WUniqueFormat.getPropertyType(this.uniqueCharacterFormat.uniqueFormatType, property);\n            return this.uniqueCharacterFormat.propertiesHash.containsKey(propertyType);\n        }\n        return false;\n    };\n    WCharacterFormat.prototype.clearFormat = function () {\n        if (!isNullOrUndefined(this.uniqueCharacterFormat) && this.uniqueCharacterFormat.referenceCount === 0) {\n            WCharacterFormat.uniqueCharacterFormats.remove(this.uniqueCharacterFormat);\n        }\n        this.uniqueCharacterFormat = undefined;\n        this.baseCharStyle = undefined;\n    };\n    WCharacterFormat.prototype.destroy = function () {\n        this.clearFormat();\n    };\n    WCharacterFormat.prototype.copyFormat = function (format) {\n        if (!isNullOrUndefined(format)) {\n            if (!isNullOrUndefined(format.uniqueCharacterFormat) && format.uniqueCharacterFormat.propertiesHash) {\n                this.updateUniqueCharacterFormat(format);\n            }\n            if (!isNullOrUndefined(format.baseCharStyle)) {\n                this.baseCharStyle = format.baseCharStyle;\n            }\n        }\n    };\n    WCharacterFormat.prototype.updateUniqueCharacterFormat = function (format) {\n        var hash = undefined;\n        if (this.uniqueCharacterFormat) {\n            hash = this.uniqueCharacterFormat.mergeProperties(format.uniqueCharacterFormat);\n            if (this.uniqueCharacterFormat.referenceCount === 0) {\n                WCharacterFormat.uniqueCharacterFormats.remove(this.uniqueCharacterFormat);\n                this.uniqueCharacterFormat = undefined;\n            }\n        }\n        this.uniqueCharacterFormat = new WUniqueFormat(WCharacterFormat.uniqueFormatType);\n        if (isNullOrUndefined(hash)) {\n            hash = this.uniqueCharacterFormat.mergeProperties(format.uniqueCharacterFormat);\n        }\n        this.uniqueCharacterFormat = WCharacterFormat.uniqueCharacterFormats.addUniqueFormat(hash, WCharacterFormat.uniqueFormatType);\n    };\n    WCharacterFormat.clear = function () {\n        this.uniqueCharacterFormats.clear();\n    };\n    WCharacterFormat.prototype.ApplyStyle = function (baseCharStyle) {\n        this.baseCharStyle = baseCharStyle;\n    };\n    /**\n     * For internal use\n     * @private\n     */\n    WCharacterFormat.prototype.getValue = function (property) {\n        return this.hasValue(property) ? this.getPropertyValue(property) : undefined;\n    };\n    /**\n     * For internal use\n     * @private\n     */\n    WCharacterFormat.prototype.mergeFormat = function (format) {\n        if (isNullOrUndefined(this.getValue('bold'))) {\n            this.bold = format.getValue('bold');\n        }\n        if (isNullOrUndefined(this.getValue('italic'))) {\n            this.italic = format.getValue('italic');\n        }\n        if (isNullOrUndefined(this.getValue('fontSize'))) {\n            this.fontSize = format.getValue('fontSize');\n        }\n        if (isNullOrUndefined(this.getValue('fontFamily'))) {\n            this.fontFamily = format.getValue('fontFamily');\n        }\n        if (isNullOrUndefined(this.getValue('underline'))) {\n            this.underline = format.getValue('underline');\n        }\n        if (isNullOrUndefined(this.getValue('strikethrough'))) {\n            this.strikethrough = format.getValue('strikethrough');\n        }\n        if (isNullOrUndefined(this.getValue('baselineAlignment'))) {\n            this.baselineAlignment = format.getValue('baselineAlignment');\n        }\n        if (isNullOrUndefined(this.getValue('highlightColor'))) {\n            this.highlightColor = format.getValue('highlightColor');\n        }\n        if (isNullOrUndefined(this.getValue('fontColor'))) {\n            this.fontColor = format.getValue('fontColor');\n        }\n    };\n    WCharacterFormat.uniqueCharacterFormats = new WUniqueFormats();\n    WCharacterFormat.uniqueFormatType = 2;\n    return WCharacterFormat;\n}());\nexport { WCharacterFormat };\n","import { isNullOrUndefined } from '@syncfusion/ej2-base';\nimport { FieldElementBox } from '../viewer/page';\n/**\n * @private\n */\nvar HelperMethods = /** @class */ (function () {\n    function HelperMethods() {\n    }\n    /**\n     * Inserts text at specified index in string.\n     * @param {string} spanText\n     * @param {number} index\n     * @param {string} text\n     * @private\n     */\n    HelperMethods.insert = function (spanText, index, text) {\n        if (index >= 0) {\n            return [spanText.slice(0, index) + text + spanText.slice(index)].join('');\n        }\n        else {\n            return text + this;\n        }\n    };\n    /**\n     * Removes text from specified index in string.\n     * @param {string} text\n     * @param {number} index\n     * @param {number} length\n     * @private\n     */\n    HelperMethods.remove = function (text, index, length) {\n        if (index === 0) {\n            return text.substring(index + 1, text.length);\n        }\n        else {\n            return text.substring(0, index) + text.substring(index + 1, text.length);\n        }\n    };\n    /**\n     * Returns the index of word split character in a string.\n     * @param {string} text\n     * @param {string[]} wordSplitCharacter\n     * @private\n     */\n    /* tslint:disable:no-any */\n    HelperMethods.indexOfAny = function (text, wordSplitCharacter) {\n        var index = undefined;\n        for (var j = 0; j < wordSplitCharacter.length; j++) {\n            var temp = text.indexOf(wordSplitCharacter[j]);\n            if (temp !== -1 && isNullOrUndefined(index)) {\n                index = temp;\n            }\n            else if (temp !== -1 && temp < index) {\n                index = temp;\n            }\n        }\n        return isNullOrUndefined(index) ? -1 : index;\n    };\n    /**\n     * Returns the last index of word split character in a string.\n     * @param {string} text\n     * @param {string[]} wordSplitCharacter\n     * @private\n     */\n    HelperMethods.lastIndexOfAny = function (text, wordSplitCharacter) {\n        for (var i = text.length - 1; i >= 0; i--) {\n            for (var j = 0; j <= wordSplitCharacter.length - 1; j++) {\n                if (text[i] === wordSplitCharacter[j]) {\n                    return i;\n                }\n            }\n        }\n        return -1;\n    };\n    /**\n     * Adds css styles to document header.\n     * @param {string} css\n     * @private\n     */\n    HelperMethods.addCssStyle = function (css) {\n        var style = document.createElement('style');\n        if (style.style.cssText) {\n            style.style.cssText = css;\n        }\n        else {\n            style.appendChild(document.createTextNode(css));\n        }\n        document.getElementsByTagName('head')[0].appendChild(style);\n    };\n    /**\n     * Gets highlight color code.\n     * @param {HighlightColor} highlightColor\n     * @private\n     */\n    HelperMethods.getHighlightColorCode = function (highlightColor) {\n        var color = '#ffffff';\n        switch (highlightColor) {\n            case 'Yellow':\n                color = '#ffff00';\n                break;\n            case 'BrightGreen':\n                color = '#00ff00';\n                break;\n            case 'Turquoise':\n                color = '#00ffff';\n                break;\n            case 'Pink':\n                color = '#ff00ff';\n                break;\n            case 'Blue':\n                color = '#0000ff';\n                break;\n            case 'Red':\n                color = '#ff0000';\n                break;\n            case 'DarkBlue':\n                color = '#000080';\n                break;\n            case 'Teal':\n                color = '#008080';\n                break;\n            case 'Green':\n                color = '#008000';\n                break;\n            case 'Violet':\n                color = '#800080';\n                break;\n            case 'DarkRed':\n                color = '#800000';\n                break;\n            case 'DarkYellow':\n                color = '#808000';\n                break;\n            case 'Gray50':\n                color = '#808080';\n                break;\n            case 'Gray25':\n                color = '#c0c0c0';\n                break;\n            case 'Black':\n                color = '#000000';\n                break;\n        }\n        return color;\n    };\n    /**\n     * Converts point to pixel.\n     * @param {number} point\n     * @private\n     */\n    HelperMethods.convertPointToPixel = function (point) {\n        var pixel = HelperMethods.round((point * 96 / 72), 5);\n        return pixel;\n    };\n    /**\n     * Converts pixel to point.\n     * @param {number} pixel\n     * @private\n     */\n    HelperMethods.convertPixelToPoint = function (pixel) {\n        var point = HelperMethods.round((pixel * 72 / 96), 5);\n        return point;\n    };\n    /**\n     * Return true if field linked\n     * @private\n     */\n    HelperMethods.isLinkedFieldCharacter = function (inline) {\n        if (inline instanceof FieldElementBox && inline.fieldType === 0) {\n            return !isNullOrUndefined(inline.fieldEnd);\n        }\n        else if (inline instanceof FieldElementBox && inline.fieldType === 2) {\n            return !isNullOrUndefined(inline.fieldBegin) && !isNullOrUndefined(inline.fieldEnd);\n        }\n        else {\n            return !isNullOrUndefined(inline.fieldBegin);\n        }\n    };\n    /**\n     * Removes white space in a string.\n     * @param {string} text\n     * @private\n     */\n    HelperMethods.removeSpace = function (text) {\n        if (!isNullOrUndefined(text) && text.length !== 0) {\n            for (var i = 0; i < text.length; i++) {\n                if (text.charAt(i) === ' ') {\n                    //replace the space by empty string in string\n                    text = text.replace(' ', '');\n                }\n            }\n        }\n        return text;\n    };\n    /**\n     * Trims white space at start of the string.\n     * @param {string} text\n     * @private\n     */\n    HelperMethods.trimStart = function (text) {\n        var i = 0;\n        for (i; i < text.length; i++) {\n            if (text[i] !== ' ') {\n                break;\n            }\n        }\n        return text.substring(i, text.length);\n    };\n    /**\n     * Trims white space at end of the string.\n     * @param {string} text\n     * @private\n     */\n    HelperMethods.trimEnd = function (text) {\n        var i = text.length - 1;\n        for (i; i >= 0; i--) {\n            if (text[i] !== ' ') {\n                break;\n            }\n        }\n        return text.substring(0, i + 1);\n    };\n    /**\n     * Checks whether string ends with whitespace.\n     * @param {string} text\n     * @private\n     */\n    HelperMethods.endsWith = function (text) {\n        if (!isNullOrUndefined(text) && text.length !== 0) {\n            return text[text.length - 1] === ' ';\n        }\n        return false;\n    };\n    /**\n     * @private\n     * Write Characterformat\n     * @param {any} characterFormat\n     * @param {boolean} isInline\n     * @param {WCharacterFormat} format\n     */\n    HelperMethods.writeCharacterFormat = function (characterFormat, isInline, format) {\n        characterFormat.bold = isInline ? format.bold : format.getValue('bold');\n        characterFormat.italic = isInline ? format.italic : format.getValue('italic');\n        characterFormat.fontSize = isInline ? format.fontSize : format.getValue('fontSize');\n        characterFormat.fontFamily = isInline ? format.fontFamily : format.getValue('fontFamily');\n        characterFormat.underline = isInline ? format.underline : format.getValue('underline');\n        characterFormat.strikethrough = isInline ? format.strikethrough : format.getValue('strikethrough');\n        characterFormat.baselineAlignment = isInline ? format.baselineAlignment : format.getValue('baselineAlignment');\n        characterFormat.highlightColor = isInline ? format.highlightColor : format.getValue('highlightColor');\n        characterFormat.fontColor = isInline ? format.fontColor : format.getValue('fontColor');\n        characterFormat.styleName = !isNullOrUndefined(format.baseCharStyle) ? format.baseCharStyle.name : undefined;\n    };\n    /* tslint:enable:no-any */\n    /**\n     * Rounds the values with specified decimal digits.\n     * @param {number} value\n     * @param {number} decimalDigits\n     * @private\n     */\n    HelperMethods.round = function (value, decimalDigits) {\n        var temp = value;\n        for (var i = 0; i < decimalDigits; i++) {\n            temp = temp * 10;\n        }\n        temp = Math.round(temp);\n        for (var i = 0; i < decimalDigits; i++) {\n            temp = temp / 10;\n        }\n        return temp;\n    };\n    /**\n     * @private\n     */\n    HelperMethods.wordBefore = '\\\\b';\n    /**\n     * @private\n     */\n    HelperMethods.wordAfter = '\\\\b';\n    /**\n     * @private\n     */\n    HelperMethods.wordSplitCharacters = [' ', ',', '.', ':', ';', '<', '>', '=',\n        '+', '-', '_', '{', '}', '[', ']', '`', '~', '!', '@', '#', '$', '%', '^', '&',\n        '*', '(', ')', '\"', '?', '/', '|', '\\\\', '”'];\n    return HelperMethods;\n}());\nexport { HelperMethods };\n/**\n * @private\n */\nvar Point = /** @class */ (function () {\n    function Point(xPosition, yPosition) {\n        this.xIn = 0;\n        this.yIn = 0;\n        this.xIn = xPosition;\n        this.yIn = yPosition;\n    }\n    Object.defineProperty(Point.prototype, \"x\", {\n        /**\n         * Gets or sets x value.\n         * @private\n         */\n        get: function () {\n            return this.xIn;\n        },\n        set: function (value) {\n            this.xIn = value;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(Point.prototype, \"y\", {\n        /**\n         * Gets or sets y value.\n         * @private\n         */\n        get: function () {\n            return this.yIn;\n        },\n        set: function (value) {\n            this.yIn = value;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    /**\n     * @private\n     */\n    Point.prototype.copy = function (point) {\n        this.xIn = point.xIn;\n        this.yIn = point.yIn;\n    };\n    /**\n     * Destroys the internal objects maintained.\n     * @returns void\n     */\n    Point.prototype.destroy = function () {\n        this.xIn = undefined;\n        this.yIn = undefined;\n    };\n    return Point;\n}());\nexport { Point };\n","var __extends = (this && this.__extends) || (function () {\n    var extendStatics = Object.setPrototypeOf ||\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nimport { WParagraphFormat } from './paragraph-format';\nimport { WCharacterFormat } from './character-format';\nimport { HelperMethods } from '../editor/editor-helper';\nimport { isNullOrUndefined } from '@syncfusion/ej2-base';\n/**\n * @private\n */\nvar WStyle = /** @class */ (function () {\n    function WStyle() {\n    }\n    return WStyle;\n}());\nexport { WStyle };\n/**\n * @private\n */\nvar WParagraphStyle = /** @class */ (function (_super) {\n    __extends(WParagraphStyle, _super);\n    function WParagraphStyle(node) {\n        var _this = _super.call(this) || this;\n        _this.ownerBase = node;\n        _this.paragraphFormat = new WParagraphFormat(_this);\n        _this.characterFormat = new WCharacterFormat(_this);\n        return _this;\n    }\n    WParagraphStyle.prototype.destroy = function () {\n        this.characterFormat.destroy();\n        this.paragraphFormat.destroy();\n    };\n    WParagraphStyle.prototype.copyStyle = function (paraStyle) {\n        this.name = paraStyle.name;\n        this.ownerBase = paraStyle.ownerBase;\n        this.type = paraStyle.type;\n        this.next = paraStyle.next;\n        this.basedOn = paraStyle.basedOn;\n        this.link = paraStyle.link;\n        this.characterFormat.copyFormat(paraStyle.characterFormat);\n        this.paragraphFormat.copyFormat(paraStyle.paragraphFormat);\n    };\n    return WParagraphStyle;\n}(WStyle));\nexport { WParagraphStyle };\n/**\n * @private\n */\nvar WCharacterStyle = /** @class */ (function (_super) {\n    __extends(WCharacterStyle, _super);\n    function WCharacterStyle(node) {\n        var _this = _super.call(this) || this;\n        _this.ownerBase = node;\n        _this.characterFormat = new WCharacterFormat(_this);\n        return _this;\n    }\n    WCharacterStyle.prototype.destroy = function () {\n        this.characterFormat.destroy();\n    };\n    WCharacterStyle.prototype.copyStyle = function (charStyle) {\n        this.name = charStyle.name;\n        this.ownerBase = charStyle.ownerBase;\n        this.type = charStyle.type;\n        this.next = charStyle.next;\n        this.basedOn = charStyle.basedOn;\n        this.characterFormat.copyFormat(charStyle.characterFormat);\n    };\n    return WCharacterStyle;\n}(WStyle));\nexport { WCharacterStyle };\n/**\n * @private\n */\nvar WStyles = /** @class */ (function () {\n    function WStyles() {\n        this.collection = [];\n        /* tslint:enable:no-any */\n    }\n    Object.defineProperty(WStyles.prototype, \"length\", {\n        get: function () {\n            return this.collection.length;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    WStyles.prototype.remove = function (item) {\n        this.collection = this.collection.filter(function (a) { return (a.name !== item.name); });\n    };\n    WStyles.prototype.push = function (item) {\n        if (item != null && item !== undefined) {\n            this.collection.push(item);\n        }\n        return 1;\n    };\n    WStyles.prototype.getItem = function (index) {\n        if (this.collection.length > index) {\n            return this.collection[index];\n        }\n        return null;\n    };\n    WStyles.prototype.indexOf = function (item) {\n        return this.collection.indexOf(item);\n    };\n    WStyles.prototype.contains = function (item) {\n        var index = this.collection.indexOf(item);\n        return index > -1 && index < this.collection.length;\n    };\n    WStyles.prototype.clear = function () {\n        while (this.collection.length > 0) {\n            this.collection.pop();\n        }\n    };\n    WStyles.prototype.findByName = function (name, type) {\n        var returnStyle;\n        for (var _i = 0, _a = this.collection; _i < _a.length; _i++) {\n            var value = _a[_i];\n            if (value.name === name) {\n                returnStyle = value;\n                if (!isNullOrUndefined(type) && value.type === type) {\n                    returnStyle = value;\n                }\n            }\n        }\n        return returnStyle;\n    };\n    WStyles.prototype.getStyleNames = function (type) {\n        return this.collection.filter(function (a) { return (a.type === type); }).map(function (a) { return a.name; });\n    };\n    /* tslint:disable:no-any */\n    WStyles.prototype.getStyles = function (type) {\n        var styles = this.collection.filter(function (a) { return (a.type === type); }).map(function (a) { return a; });\n        var styleObjects = [];\n        for (var _i = 0, styles_1 = styles; _i < styles_1.length; _i++) {\n            var style = styles_1[_i];\n            var returnStyle = {};\n            var returnStyleObject = {};\n            returnStyleObject.characterFormat = {};\n            HelperMethods.writeCharacterFormat(returnStyleObject.characterFormat, true, style.characterFormat);\n            returnStyle.name = style.name;\n            returnStyle.style = JSON.stringify(returnStyleObject);\n            styleObjects.push(returnStyle);\n        }\n        return styleObjects;\n    };\n    return WStyles;\n}());\nexport { WStyles };\n","import { Dictionary } from '../../base/dictionary';\nimport { WUniqueFormat } from '../../base/unique-format';\nimport { WUniqueFormats } from '../../base/unique-formats';\nimport { isNullOrUndefined } from '@syncfusion/ej2-base';\n/**\n * @private\n */\nvar WBorder = /** @class */ (function () {\n    function WBorder(node) {\n        this.uniqueBorderFormat = undefined;\n        this.ownerBase = undefined;\n        this.ownerBase = node;\n    }\n    Object.defineProperty(WBorder.prototype, \"color\", {\n        get: function () {\n            return this.getPropertyValue('color');\n        },\n        set: function (value) {\n            this.setPropertyValue('color', value);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(WBorder.prototype, \"lineStyle\", {\n        get: function () {\n            return this.getPropertyValue('lineStyle');\n        },\n        set: function (value) {\n            this.setPropertyValue('lineStyle', value);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(WBorder.prototype, \"lineWidth\", {\n        get: function () {\n            return this.getPropertyValue('lineWidth');\n        },\n        set: function (value) {\n            this.setPropertyValue('lineWidth', value);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(WBorder.prototype, \"shadow\", {\n        get: function () {\n            return this.getPropertyValue('shadow');\n        },\n        set: function (value) {\n            this.setPropertyValue('shadow', value);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(WBorder.prototype, \"space\", {\n        get: function () {\n            return this.getPropertyValue('space');\n        },\n        set: function (value) {\n            this.setPropertyValue('space', value);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(WBorder.prototype, \"hasNoneStyle\", {\n        get: function () {\n            return this.getPropertyValue('hasNoneStyle');\n        },\n        set: function (value) {\n            this.setPropertyValue('hasNoneStyle', value);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    WBorder.prototype.getPropertyValue = function (property) {\n        var hasValue = this.hasValue(property);\n        if (hasValue) {\n            var propertyType = WUniqueFormat.getPropertyType(WBorder.uniqueFormatType, property);\n            if (!isNullOrUndefined(this.uniqueBorderFormat) && this.uniqueBorderFormat.propertiesHash.containsKey(propertyType)) {\n                return this.uniqueBorderFormat.propertiesHash.get(propertyType);\n            }\n        }\n        return WBorder.getPropertyDefaultValue(property);\n    };\n    WBorder.prototype.setPropertyValue = function (property, value) {\n        if (isNullOrUndefined(value) || value === '') {\n            value = WBorder.getPropertyDefaultValue(property);\n        }\n        if (isNullOrUndefined(this.uniqueBorderFormat)) {\n            this.initializeUniqueBorder(property, value);\n        }\n        else {\n            var propertyType = WUniqueFormat.getPropertyType(this.uniqueBorderFormat.uniqueFormatType, property);\n            if (this.uniqueBorderFormat.propertiesHash.containsKey(propertyType) &&\n                this.uniqueBorderFormat.propertiesHash.get(propertyType) === value) {\n                //Do nothing, since no change in property value and return\n                return;\n            }\n            this.uniqueBorderFormat = WBorder.uniqueBorderFormats.updateUniqueFormat(this.uniqueBorderFormat, property, value);\n        }\n    };\n    WBorder.prototype.initializeUniqueBorder = function (property, propValue) {\n        var uniqueBorderFormatTemp = new Dictionary();\n        this.addUniqueBorderFormat('color', property, propValue, uniqueBorderFormatTemp);\n        this.addUniqueBorderFormat('lineStyle', property, propValue, uniqueBorderFormatTemp);\n        this.addUniqueBorderFormat('lineWidth', property, propValue, uniqueBorderFormatTemp);\n        this.addUniqueBorderFormat('shadow', property, propValue, uniqueBorderFormatTemp);\n        this.addUniqueBorderFormat('space', property, propValue, uniqueBorderFormatTemp);\n        this.addUniqueBorderFormat('hasNoneStyle', property, propValue, uniqueBorderFormatTemp);\n        this.uniqueBorderFormat = WBorder.uniqueBorderFormats.addUniqueFormat(uniqueBorderFormatTemp, WBorder.uniqueFormatType);\n    };\n    // tslint:disable-next-line:max-line-length\n    WBorder.prototype.addUniqueBorderFormat = function (property, modifiedProperty, propValue, uniqueBorderFormatTemp) {\n        var propertyType;\n        propertyType = WUniqueFormat.getPropertyType(WBorder.uniqueFormatType, property);\n        if (property === modifiedProperty) {\n            uniqueBorderFormatTemp.add(propertyType, propValue);\n        }\n        else {\n            uniqueBorderFormatTemp.add(propertyType, WBorder.getPropertyDefaultValue(property));\n        }\n    };\n    WBorder.getPropertyDefaultValue = function (property) {\n        var value = undefined;\n        switch (property) {\n            case 'color':\n                value = '#000000';\n                break;\n            case 'lineStyle':\n                value = 'None';\n                break;\n            case 'lineWidth':\n                value = 0;\n                break;\n            case 'shadow':\n                value = false;\n                break;\n            case 'space':\n                value = 0;\n                break;\n            case 'hasNoneStyle':\n                value = false;\n                break;\n        }\n        return value;\n    };\n    WBorder.prototype.getLineWidth = function () {\n        /* tslint:disable */\n        switch (this.lineStyle) {\n            case 'None':\n            case 'Cleared':\n                return 0;\n            case 'Triple':\n            case 'Double':\n            case 'ThinThickSmallGap':\n            case 'ThickThinSmallGap':\n            case 'ThinThickThinSmallGap':\n            case 'ThinThickMediumGap':\n            case 'ThickThinMediumGap':\n            case 'ThinThickThinMediumGap':\n            case 'ThinThickLargeGap':\n            case 'ThickThinLargeGap':\n            case 'ThinThickThinLargeGap':\n            case 'Emboss3D':\n            case 'Engrave3D':\n                {\n                    var lineArray = this.getBorderLineWidthArray(this.lineStyle, this.lineWidth);\n                    var width = 0;\n                    for (var i = 0; i < lineArray.length; i++) {\n                        width += lineArray[i];\n                    }\n                    return width;\n                }\n            case 'Single':\n            case 'DashLargeGap':\n            case 'DashSmallGap':\n            case 'Dot':\n            case 'DashDot':\n            case 'DashDotDot':\n            case 'Thick':\n                return this.lineWidth;\n            case 'SingleWavy':\n                return (this.lineWidth === 1.5 ? 3 : 2.5); //Double wave border only draw with the fixed width\n            case 'DoubleWavy':\n                return (6.75); //Double wave border only draw with the fixed width\n            case 'DashDotStroked':\n            case 'Outset':\n                return this.lineWidth;\n        }\n        return this.lineWidth;\n        /* tslint:enable */\n    };\n    WBorder.prototype.getBorderLineWidthArray = function (lineStyle, lineWidth) {\n        var borderLineArray = [lineWidth];\n        switch (lineStyle) {\n            case 'Double':\n                borderLineArray = [1, 1, 1];\n                break;\n            case 'ThinThickSmallGap':\n                borderLineArray = [1, -0.75, -0.75];\n                break;\n            case 'ThickThinSmallGap':\n                borderLineArray = [-0.75, -0.75, 1];\n                break;\n            case 'ThinThickMediumGap':\n                borderLineArray = [1, 0.5, 0.5];\n                break;\n            case 'ThickThinMediumGap':\n                borderLineArray = [0.5, 0.5, 1];\n                break;\n            case 'ThinThickLargeGap':\n                borderLineArray = [-1.5, 1, -0.75];\n                break;\n            case 'ThickThinLargeGap':\n                borderLineArray = [-0.75, 1, -1.5];\n                break;\n            case 'Triple':\n                borderLineArray = [1, 1, 1, 1, 1];\n                break;\n            case 'ThinThickThinSmallGap':\n                borderLineArray = [-0.75, -0.75, 1, -0.75, -0.75];\n                break;\n            case 'ThinThickThinMediumGap':\n                borderLineArray = [0.5, 0.5, 1, 0.5, 0.5];\n                break;\n            case 'ThinThickThinLargeGap':\n                borderLineArray = [-0.75, 1, -1.5, 1, -0.75];\n                break;\n            case 'Emboss3D':\n            case 'Engrave3D':\n                borderLineArray = [0.25, 0, 1, 0, 0.25];\n                break;\n        }\n        if (borderLineArray.length === 1) {\n            return [lineWidth];\n        }\n        for (var i = 0; i < borderLineArray.length; i++) {\n            if (borderLineArray[i] >= 0) {\n                borderLineArray[i] = borderLineArray[i] * lineWidth;\n            }\n            else {\n                borderLineArray[i] = Math.abs(borderLineArray[i]);\n            }\n        }\n        return borderLineArray;\n    };\n    WBorder.prototype.getBorderWeight = function () {\n        var weight = 0;\n        var numberOfLines = this.getNumberOfLines();\n        var borderNumber = this.getBorderNumber();\n        switch (this.lineStyle) {\n            case 'Single':\n            case 'DashSmallGap':\n            case 'DashDot':\n            case 'DashDotDot':\n            case 'Double':\n            case 'Triple':\n            case 'ThinThickSmallGap':\n            case 'ThickThinSmallGap':\n            case 'ThinThickThinSmallGap':\n            case 'ThinThickMediumGap':\n            case 'ThickThinMediumGap':\n            case 'ThinThickThinMediumGap':\n            case 'ThinThickLargeGap':\n            case 'ThickThinLargeGap':\n            case 'ThinThickThinLargeGap':\n            case 'SingleWavy':\n            case 'DoubleWavy':\n            case 'DashDotStroked':\n            case 'Emboss3D':\n            case 'Engrave3D':\n            case 'Outset':\n            case 'Inset':\n            case 'Thick':\n                weight = numberOfLines * borderNumber;\n                break;\n            case 'Dot':\n            case 'DashLargeGap':\n                weight = 1;\n                break;\n        }\n        return weight;\n    };\n    WBorder.prototype.getBorderNumber = function () {\n        var borderNumber = 0;\n        switch (this.lineStyle) {\n            case 'Single':\n                borderNumber = 1;\n                break;\n            case 'Thick':\n                borderNumber = 2;\n                break;\n            case 'Double':\n                borderNumber = 3;\n                break;\n            case 'Dot':\n                borderNumber = 4;\n                break;\n            case 'DashLargeGap'://dashed.\n                borderNumber = 5;\n                break;\n            case 'DashDot':\n                borderNumber = 6;\n                break;\n            case 'DashDotDot':\n                borderNumber = 7;\n                break;\n            case 'Triple':\n                borderNumber = 8;\n                break;\n            case 'ThinThickSmallGap':\n                borderNumber = 9;\n                break;\n            case 'ThickThinSmallGap':\n                borderNumber = 10;\n                break;\n            case 'ThinThickThinSmallGap':\n                borderNumber = 11;\n                break;\n            case 'ThinThickMediumGap':\n                borderNumber = 12;\n                break;\n            case 'ThickThinMediumGap':\n                borderNumber = 13;\n                break;\n            case 'ThinThickThinMediumGap':\n                borderNumber = 14;\n                break;\n            case 'ThinThickLargeGap':\n                borderNumber = 15;\n                break;\n            case 'ThickThinLargeGap':\n                borderNumber = 16;\n                break;\n            case 'ThinThickThinLargeGap':\n                borderNumber = 17;\n                break;\n            case 'SingleWavy'://wave.\n                borderNumber = 18;\n                break;\n            case 'DoubleWavy':\n                borderNumber = 19;\n                break;\n            case 'DashSmallGap':\n                borderNumber = 20;\n                break;\n            case 'DashDotStroked':\n                borderNumber = 21;\n                break;\n            case 'Emboss3D':\n                borderNumber = 22;\n                break;\n            case 'Engrave3D':\n                borderNumber = 23;\n                break;\n            case 'Outset':\n                borderNumber = 24;\n                break;\n            case 'Inset':\n                borderNumber = 25;\n                break;\n        }\n        return borderNumber;\n    };\n    WBorder.prototype.getNumberOfLines = function () {\n        //ToDo: Need to analyze more on this.\n        var value = 0;\n        switch (this.lineStyle) {\n            case 'Single':\n            case 'Dot':\n            case 'DashSmallGap':\n            case 'DashLargeGap':\n            case 'DashDot':\n            case 'DashDotDot':\n                value = 1;\n                break;\n            case 'Double':\n                value = 3;\n                break;\n            case 'Triple':\n                value = 5;\n                break;\n            case 'ThinThickSmallGap':\n                value = 3;\n                break;\n            case 'ThickThinSmallGap':\n                value = 3;\n                break;\n            case 'ThinThickThinSmallGap':\n                value = 5;\n                break;\n            case 'ThinThickMediumGap':\n                value = 3;\n                break;\n            case 'ThickThinMediumGap':\n                value = 3;\n                break;\n            case 'ThinThickThinMediumGap':\n                value = 5;\n                break;\n            case 'ThinThickLargeGap':\n                value = 3;\n                break;\n            case 'ThickThinLargeGap':\n                value = 3;\n                break;\n            case 'ThinThickThinLargeGap':\n                value = 5;\n                break;\n            case 'SingleWavy':\n                value = 1;\n                break;\n            case 'DoubleWavy':\n                value = 2;\n                break;\n            case 'DashDotStroked':\n                value = 1;\n                break;\n            case 'Emboss3D':\n            case 'Engrave3D':\n                value = 3;\n                break;\n            case 'Outset':\n            case 'Inset':\n            case 'Thick':\n                value = 1;\n                break;\n        }\n        return value;\n    };\n    WBorder.prototype.getPrecedence = function () {\n        var value = 0;\n        switch (this.lineStyle) {\n            case 'Single':\n                value = 1;\n                break;\n            case 'Thick':\n                value = 2;\n                break;\n            case 'Double':\n                value = 3;\n                break;\n            case 'Dot':\n                value = 4;\n                break;\n            case 'DashLargeGap'://dashed.\n                value = 5;\n                break;\n            case 'DashDot':\n                value = 6;\n                break;\n            case 'DashDotDot':\n                value = 7;\n                break;\n            case 'Triple':\n                value = 8;\n                break;\n            case 'ThinThickSmallGap':\n                value = 9;\n                break;\n            case 'ThickThinSmallGap':\n                value = 10;\n                break;\n            case 'ThinThickThinSmallGap':\n                value = 11;\n                break;\n            case 'ThinThickMediumGap':\n                value = 12;\n                break;\n            case 'ThickThinMediumGap':\n                value = 13;\n                break;\n            case 'ThinThickThinMediumGap':\n                value = 14;\n                break;\n            case 'ThinThickLargeGap':\n                value = 15;\n                break;\n            case 'ThickThinLargeGap':\n                value = 16;\n                break;\n            case 'ThinThickThinLargeGap':\n                value = 17;\n                break;\n            case 'SingleWavy'://wave.\n                value = 18;\n                break;\n            case 'DoubleWavy':\n                value = 19;\n                break;\n            case 'DashSmallGap':\n                value = 20;\n                break;\n            case 'DashDotStroked':\n                value = 21;\n                break;\n            case 'Emboss3D':\n                value = 22;\n                break;\n            case 'Engrave3D':\n                value = 23;\n                break;\n            case 'Outset':\n                value = 24;\n                break;\n            case 'Inset':\n                value = 25;\n                break;\n        }\n        return value;\n    };\n    WBorder.prototype.hasValue = function (property) {\n        if (!isNullOrUndefined(this.uniqueBorderFormat)) {\n            var propertyType = WUniqueFormat.getPropertyType(this.uniqueBorderFormat.uniqueFormatType, property);\n            return this.uniqueBorderFormat.propertiesHash.containsKey(propertyType);\n        }\n        return false;\n    };\n    WBorder.prototype.cloneFormat = function () {\n        var border = new WBorder(undefined);\n        border.color = this.color;\n        border.lineStyle = this.lineStyle;\n        border.lineWidth = this.lineWidth;\n        border.shadow = this.shadow;\n        border.space = this.space;\n        return border;\n    };\n    WBorder.prototype.destroy = function () {\n        if (!isNullOrUndefined(this.uniqueBorderFormat)) {\n            WBorder.uniqueBorderFormats.remove(this.uniqueBorderFormat);\n        }\n        this.uniqueBorderFormat = undefined;\n    };\n    WBorder.prototype.copyFormat = function (border) {\n        if (!isNullOrUndefined(border) && !isNullOrUndefined(border.uniqueBorderFormat)) {\n            this.color = border.color;\n            this.lineStyle = border.lineStyle;\n            this.lineWidth = border.lineWidth;\n            this.shadow = border.shadow;\n            this.space = border.space;\n        }\n    };\n    WBorder.clear = function () {\n        this.uniqueBorderFormats.clear();\n    };\n    WBorder.uniqueBorderFormats = new WUniqueFormats();\n    WBorder.uniqueFormatType = 1;\n    return WBorder;\n}());\nexport { WBorder };\n","import { WBorder } from './border';\nimport { isNullOrUndefined } from '@syncfusion/ej2-base';\n/**\n * @private\n */\nvar WBorders = /** @class */ (function () {\n    function WBorders(node) {\n        this.leftIn = new WBorder(this);\n        this.rightIn = new WBorder(this);\n        this.topIn = new WBorder(this);\n        this.bottomIn = new WBorder(this);\n        this.horizontalIn = new WBorder(this);\n        this.verticalIn = new WBorder(this);\n        this.diagonalUpIn = new WBorder(this);\n        this.diagonalDownIn = new WBorder(this);\n        this.lineWidthIn = 0;\n        this.ownerBase = node;\n    }\n    Object.defineProperty(WBorders.prototype, \"left\", {\n        get: function () {\n            return this.leftIn;\n        },\n        set: function (value) {\n            this.leftIn = value;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(WBorders.prototype, \"right\", {\n        get: function () {\n            return this.rightIn;\n        },\n        set: function (value) {\n            this.rightIn = value;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(WBorders.prototype, \"top\", {\n        get: function () {\n            return this.topIn;\n        },\n        set: function (value) {\n            this.topIn = value;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(WBorders.prototype, \"bottom\", {\n        get: function () {\n            return this.bottomIn;\n        },\n        set: function (value) {\n            this.bottomIn = value;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(WBorders.prototype, \"horizontal\", {\n        get: function () {\n            return this.horizontalIn;\n        },\n        set: function (value) {\n            this.horizontalIn = value;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(WBorders.prototype, \"vertical\", {\n        get: function () {\n            return this.verticalIn;\n        },\n        set: function (value) {\n            this.verticalIn = value;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(WBorders.prototype, \"diagonalUp\", {\n        get: function () {\n            return this.diagonalUpIn;\n        },\n        set: function (value) {\n            this.diagonalUpIn = value;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(WBorders.prototype, \"diagonalDown\", {\n        get: function () {\n            return this.diagonalDownIn;\n        },\n        set: function (value) {\n            this.diagonalDownIn = value;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    WBorders.prototype.destroy = function () {\n        if (!isNullOrUndefined(this.left)) {\n            this.left.destroy();\n        }\n        if (!isNullOrUndefined(this.top)) {\n            this.top.destroy();\n        }\n        if (!isNullOrUndefined(this.bottom)) {\n            this.bottom.destroy();\n        }\n        if (!isNullOrUndefined(this.right)) {\n            this.right.destroy();\n        }\n        if (!isNullOrUndefined(this.horizontal)) {\n            this.horizontal.destroy();\n        }\n        if (!isNullOrUndefined(this.vertical)) {\n            this.vertical.destroy();\n        }\n        if (!isNullOrUndefined(this.diagonalDown)) {\n            this.diagonalDown.destroy();\n        }\n        if (!isNullOrUndefined(this.diagonalUp)) {\n            this.diagonalUp.destroy();\n        }\n        this.topIn = undefined;\n        this.bottomIn = undefined;\n        this.leftIn = undefined;\n        this.rightIn = undefined;\n        this.horizontalIn = undefined;\n        this.verticalIn = undefined;\n        this.diagonalDownIn = undefined;\n        this.diagonalUpIn = undefined;\n        this.lineWidthIn = undefined;\n        this.valueIn = undefined;\n    };\n    WBorders.prototype.cloneFormat = function () {\n        var borders = new WBorders(undefined);\n        borders.top = isNullOrUndefined(this.top) ? undefined : this.top.cloneFormat();\n        borders.bottom = isNullOrUndefined(this.bottom) ? undefined : this.bottom.cloneFormat();\n        borders.left = isNullOrUndefined(this.left) ? undefined : this.left.cloneFormat();\n        borders.right = isNullOrUndefined(this.right) ? undefined : this.right.cloneFormat();\n        borders.horizontal = isNullOrUndefined(this.horizontal) ? undefined : this.horizontal.cloneFormat();\n        borders.vertical = isNullOrUndefined(this.vertical) ? undefined : this.vertical.cloneFormat();\n        borders.diagonalUp = isNullOrUndefined(this.diagonalUp) ? undefined : this.diagonalUp.cloneFormat();\n        borders.diagonalDown = isNullOrUndefined(this.diagonalDown) ? undefined : this.diagonalDown.cloneFormat();\n        return borders;\n    };\n    WBorders.prototype.copyFormat = function (borders) {\n        if (!isNullOrUndefined(borders.left) && borders.left instanceof WBorder) {\n            this.left = new WBorder(this);\n            this.left.copyFormat(borders.left);\n        }\n        if (!isNullOrUndefined(borders.right) && borders.right instanceof WBorder) {\n            this.right = new WBorder(this);\n            this.right.copyFormat(borders.right);\n        }\n        if (!isNullOrUndefined(borders.top) && borders.top instanceof WBorder) {\n            this.top = new WBorder(this);\n            this.top.copyFormat(borders.top);\n        }\n        if (!isNullOrUndefined(borders.bottom) && borders.bottom instanceof WBorder) {\n            this.bottom = new WBorder(this);\n            this.bottom.copyFormat(borders.bottom);\n        }\n        if (!isNullOrUndefined(borders.horizontal) && borders.horizontal instanceof WBorder) {\n            this.horizontal = new WBorder(this);\n            this.horizontal.copyFormat(borders.horizontal);\n        }\n        if (!isNullOrUndefined(borders.vertical) && borders.vertical instanceof WBorder) {\n            this.vertical = new WBorder(this);\n            this.vertical.copyFormat(borders.vertical);\n        }\n        if (!isNullOrUndefined(borders.diagonalDown) && borders.diagonalDown instanceof WBorder) {\n            this.diagonalDown = new WBorder(this);\n            this.diagonalDown.copyFormat(borders.diagonalDown);\n        }\n        if (!isNullOrUndefined(borders.diagonalUp) && borders.diagonalUp instanceof WBorder) {\n            this.diagonalUp = new WBorder(this);\n            this.diagonalUp.copyFormat(borders.diagonalUp);\n        }\n    };\n    return WBorders;\n}());\nexport { WBorders };\n","import { isNullOrUndefined } from '@syncfusion/ej2-base';\nimport { WUniqueFormat } from '../../base/unique-format';\nimport { WUniqueFormats } from '../../base/unique-formats';\nimport { Dictionary } from '../../base/dictionary';\n/**\n * @private\n */\nvar WShading = /** @class */ (function () {\n    function WShading(node) {\n        this.uniqueShadingFormat = undefined;\n        this.ownerBase = undefined;\n        this.ownerBase = node;\n    }\n    Object.defineProperty(WShading.prototype, \"backgroundColor\", {\n        get: function () {\n            return this.getPropertyValue('backgroundColor');\n        },\n        set: function (value) {\n            this.setPropertyValue('backgroundColor', value);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(WShading.prototype, \"foregroundColor\", {\n        get: function () {\n            return this.getPropertyValue('foregroundColor');\n        },\n        set: function (value) {\n            this.setPropertyValue('foregroundColor', value);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(WShading.prototype, \"textureStyle\", {\n        get: function () {\n            return this.getPropertyValue('textureStyle');\n        },\n        set: function (value) {\n            this.setPropertyValue('textureStyle', value);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    WShading.prototype.getPropertyValue = function (property) {\n        var hasValue = this.hasValue(property);\n        if (hasValue) {\n            var propertyType = WUniqueFormat.getPropertyType(WShading.uniqueFormatType, property);\n            if (!isNullOrUndefined(this.uniqueShadingFormat) && this.uniqueShadingFormat.propertiesHash.containsKey(propertyType)) {\n                return this.uniqueShadingFormat.propertiesHash.get(propertyType);\n            }\n        }\n        return WShading.getPropertyDefaultValue(property);\n    };\n    WShading.prototype.setPropertyValue = function (property, value) {\n        if (isNullOrUndefined(value) || value === '') {\n            value = WShading.getPropertyDefaultValue(property);\n        }\n        if (isNullOrUndefined(this.uniqueShadingFormat)) {\n            this.initializeUniqueShading(property, value);\n        }\n        else {\n            var propertyType = WUniqueFormat.getPropertyType(this.uniqueShadingFormat.uniqueFormatType, property);\n            if (this.uniqueShadingFormat.propertiesHash.containsKey(propertyType) &&\n                this.uniqueShadingFormat.propertiesHash.get(propertyType) === value) {\n                //Do nothing, since no change in property value and return\n                return;\n            }\n            this.uniqueShadingFormat = WShading.uniqueShadingFormats.updateUniqueFormat(this.uniqueShadingFormat, property, value);\n        }\n    };\n    WShading.getPropertyDefaultValue = function (property) {\n        var value = undefined;\n        switch (property) {\n            case 'backgroundColor':\n                value = '#ffffff';\n                break;\n            case 'foregroundColor':\n                value = 'empty';\n                break;\n            case 'textureStyle':\n                value = 'TextureNone';\n                break;\n        }\n        return value;\n    };\n    WShading.prototype.initializeUniqueShading = function (property, propValue) {\n        var uniqueShadingTemp = new Dictionary();\n        this.addUniqueShading('backgroundColor', property, propValue, uniqueShadingTemp);\n        this.addUniqueShading('foregroundColor', property, propValue, uniqueShadingTemp);\n        this.addUniqueShading('textureStyle', property, propValue, uniqueShadingTemp);\n        // tslint:disable-next-line:max-line-length        \n        this.uniqueShadingFormat = WShading.uniqueShadingFormats.addUniqueFormat(uniqueShadingTemp, WShading.uniqueFormatType);\n    };\n    // tslint:disable-next-line:max-line-length\n    WShading.prototype.addUniqueShading = function (property, modifiedProperty, propValue, uniqueShadingTemp) {\n        var propertyType;\n        propertyType = WUniqueFormat.getPropertyType(WShading.uniqueFormatType, property);\n        if (property === modifiedProperty) {\n            uniqueShadingTemp.add(propertyType, propValue);\n        }\n        else {\n            uniqueShadingTemp.add(propertyType, WShading.getPropertyDefaultValue(property));\n        }\n    };\n    WShading.prototype.destroy = function () {\n        if (!isNullOrUndefined(this.uniqueShadingFormat)) {\n            WShading.uniqueShadingFormats.remove(this.uniqueShadingFormat);\n        }\n        this.uniqueShadingFormat = undefined;\n    };\n    WShading.prototype.cloneFormat = function () {\n        var shading = new WShading(undefined);\n        shading.backgroundColor = this.backgroundColor;\n        shading.foregroundColor = this.foregroundColor;\n        shading.textureStyle = this.textureStyle;\n        return shading;\n    };\n    WShading.prototype.copyFormat = function (shading) {\n        if (!isNullOrUndefined(shading) && !isNullOrUndefined(shading.uniqueShadingFormat)) {\n            this.backgroundColor = shading.backgroundColor;\n            this.foregroundColor = shading.foregroundColor;\n            this.textureStyle = shading.textureStyle;\n        }\n    };\n    WShading.prototype.hasValue = function (property) {\n        if (!isNullOrUndefined(this.uniqueShadingFormat)) {\n            var propertyType = WUniqueFormat.getPropertyType(this.uniqueShadingFormat.uniqueFormatType, property);\n            return this.uniqueShadingFormat.propertiesHash.containsKey(propertyType);\n        }\n        return false;\n    };\n    WShading.clear = function () {\n        this.uniqueShadingFormats.clear();\n    };\n    WShading.uniqueShadingFormats = new WUniqueFormats();\n    WShading.uniqueFormatType = 5;\n    return WShading;\n}());\nexport { WShading };\n","import { Dictionary } from '../../base/dictionary';\nimport { WUniqueFormat } from '../../base/unique-format';\nimport { WUniqueFormats } from '../../base/unique-formats';\nimport { WBorders } from './borders';\nimport { WShading } from './shading';\nimport { isNullOrUndefined } from '@syncfusion/ej2-base';\n/**\n * @private\n */\nvar WTableFormat = /** @class */ (function () {\n    function WTableFormat(owner) {\n        this.uniqueTableFormat = undefined;\n        this.borders = new WBorders(this);\n        this.shading = new WShading(this);\n        this.ownerBase = undefined;\n        this.ownerBase = owner;\n        this.assignTableMarginValue(5.4, 0, 5.4, 0);\n    }\n    Object.defineProperty(WTableFormat.prototype, \"cellSpacing\", {\n        get: function () {\n            return this.getPropertyValue('cellSpacing');\n        },\n        set: function (value) {\n            if (value < 0 || value > 264.6) {\n                throw new RangeError('The measurement must be between 0 px and 264.6 px.');\n            }\n            this.setPropertyValue('cellSpacing', value);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(WTableFormat.prototype, \"leftMargin\", {\n        get: function () {\n            return this.getPropertyValue('leftMargin');\n        },\n        set: function (value) {\n            this.setPropertyValue('leftMargin', value);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(WTableFormat.prototype, \"topMargin\", {\n        get: function () {\n            return this.getPropertyValue('topMargin');\n        },\n        set: function (value) {\n            this.setPropertyValue('topMargin', value);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(WTableFormat.prototype, \"rightMargin\", {\n        get: function () {\n            return this.getPropertyValue('rightMargin');\n        },\n        set: function (value) {\n            this.setPropertyValue('rightMargin', value);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(WTableFormat.prototype, \"bottomMargin\", {\n        get: function () {\n            return this.getPropertyValue('bottomMargin');\n        },\n        set: function (value) {\n            this.setPropertyValue('bottomMargin', value);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(WTableFormat.prototype, \"leftIndent\", {\n        get: function () {\n            return this.getPropertyValue('leftIndent');\n        },\n        set: function (value) {\n            if (value < -1440 || value > 1440) {\n                throw new RangeError('The measurement must be between -1440 px and 1440 px.');\n            }\n            this.setPropertyValue('leftIndent', value);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(WTableFormat.prototype, \"tableAlignment\", {\n        get: function () {\n            return this.getPropertyValue('tableAlignment');\n        },\n        set: function (value) {\n            this.setPropertyValue('tableAlignment', value);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(WTableFormat.prototype, \"preferredWidth\", {\n        get: function () {\n            return this.getPropertyValue('preferredWidth');\n        },\n        set: function (value) {\n            this.setPropertyValue('preferredWidth', value);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(WTableFormat.prototype, \"preferredWidthType\", {\n        get: function () {\n            return this.getPropertyValue('preferredWidthType');\n        },\n        set: function (value) {\n            this.setPropertyValue('preferredWidthType', value);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    WTableFormat.prototype.getPropertyValue = function (property) {\n        var hasValue = this.hasValue(property);\n        if (hasValue) {\n            var propertyType = WUniqueFormat.getPropertyType(WTableFormat.uniqueFormatType, property);\n            if (!isNullOrUndefined(this.uniqueTableFormat) && this.uniqueTableFormat.propertiesHash.containsKey(propertyType)) {\n                return this.uniqueTableFormat.propertiesHash.get(propertyType);\n            }\n        }\n        return WTableFormat.getPropertyDefaultValue(property);\n    };\n    WTableFormat.prototype.setPropertyValue = function (property, value) {\n        if (isNullOrUndefined(value) || value === '') {\n            value = WTableFormat.getPropertyDefaultValue(property);\n        }\n        if (isNullOrUndefined(this.uniqueTableFormat)) {\n            this.initializeUniqueTableFormat(property, value);\n        }\n        else {\n            var propertyType = WUniqueFormat.getPropertyType(this.uniqueTableFormat.uniqueFormatType, property);\n            if (this.uniqueTableFormat.propertiesHash.containsKey(propertyType) &&\n                this.uniqueTableFormat.propertiesHash.get(propertyType) === value) {\n                //Do nothing, since no change in property value and return\n                return;\n            }\n            this.uniqueTableFormat = WTableFormat.uniqueTableFormats.updateUniqueFormat(this.uniqueTableFormat, property, value);\n        }\n    };\n    WTableFormat.prototype.initializeUniqueTableFormat = function (property, propValue) {\n        var uniqueTableFormatTemp = new Dictionary();\n        this.addUniqueTableFormat('cellSpacing', property, propValue, uniqueTableFormatTemp);\n        this.addUniqueTableFormat('leftMargin', property, propValue, uniqueTableFormatTemp);\n        this.addUniqueTableFormat('topMargin', property, propValue, uniqueTableFormatTemp);\n        this.addUniqueTableFormat('bottomMargin', property, propValue, uniqueTableFormatTemp);\n        this.addUniqueTableFormat('rightMargin', property, propValue, uniqueTableFormatTemp);\n        this.addUniqueTableFormat('leftIndent', property, propValue, uniqueTableFormatTemp);\n        this.addUniqueTableFormat('tableAlignment', property, propValue, uniqueTableFormatTemp);\n        this.addUniqueTableFormat('preferredWidth', property, propValue, uniqueTableFormatTemp);\n        this.addUniqueTableFormat('preferredWidthType', property, propValue, uniqueTableFormatTemp);\n        this.uniqueTableFormat = WTableFormat.uniqueTableFormats.addUniqueFormat(uniqueTableFormatTemp, WTableFormat.uniqueFormatType);\n    };\n    // tslint:disable-next-line:max-line-length\n    WTableFormat.prototype.addUniqueTableFormat = function (property, modifiedProperty, propValue, uniqueTableFormatTemp) {\n        var propertyType;\n        propertyType = WUniqueFormat.getPropertyType(WTableFormat.uniqueFormatType, property);\n        if (property === modifiedProperty) {\n            uniqueTableFormatTemp.add(propertyType, propValue);\n        }\n    };\n    WTableFormat.getPropertyDefaultValue = function (property) {\n        var value = undefined;\n        switch (property) {\n            case 'cellSpacing':\n                value = 0;\n                break;\n            case 'leftMargin':\n                value = 5.4;\n                break;\n            case 'topMargin':\n                value = 0;\n                break;\n            case 'bottomMargin':\n                value = 0;\n                break;\n            case 'rightMargin':\n                value = 5.4;\n                break;\n            case 'leftIndent':\n                value = 0;\n                break;\n            case 'tableAlignment':\n                value = 'Left';\n                break;\n            case 'preferredWidth':\n                value = 0;\n                break;\n            case 'preferredWidthType':\n                value = 'Point';\n                break;\n        }\n        return value;\n    };\n    WTableFormat.prototype.assignTableMarginValue = function (left, top, right, bottom) {\n        this.leftMargin = left;\n        this.topMargin = top;\n        this.rightMargin = right;\n        this.bottomMargin = bottom;\n    };\n    WTableFormat.prototype.initializeTableBorders = function () {\n        this.borders.left.lineStyle = 'Single';\n        this.borders.left.lineWidth = 0.5;\n        this.borders.right.lineStyle = 'Single';\n        this.borders.right.lineWidth = 0.5;\n        this.borders.top.lineStyle = 'Single';\n        this.borders.top.lineWidth = 0.5;\n        this.borders.bottom.lineStyle = 'Single';\n        this.borders.bottom.lineWidth = 0.5;\n        this.borders.horizontal.lineStyle = 'Single';\n        this.borders.horizontal.lineWidth = 0.5;\n        this.borders.vertical.lineStyle = 'Single';\n        this.borders.vertical.lineWidth = 0.5;\n    };\n    WTableFormat.prototype.destroy = function () {\n        if (!isNullOrUndefined(this.borders)) {\n            this.borders.destroy();\n        }\n        if (!isNullOrUndefined(this.shading)) {\n            this.shading.destroy();\n        }\n        if (!isNullOrUndefined(this.uniqueTableFormat)) {\n            WTableFormat.uniqueTableFormats.remove(this.uniqueTableFormat);\n        }\n        this.uniqueTableFormat = undefined;\n        this.borders = undefined;\n        this.shading = undefined;\n    };\n    WTableFormat.prototype.cloneFormat = function () {\n        var tableFormat = new WTableFormat(undefined);\n        tableFormat.leftIndent = this.leftIndent;\n        tableFormat.tableAlignment = this.tableAlignment;\n        tableFormat.cellSpacing = this.cellSpacing;\n        tableFormat.leftMargin = this.leftMargin;\n        tableFormat.rightMargin = this.rightMargin;\n        tableFormat.topMargin = this.topMargin;\n        tableFormat.bottomMargin = this.bottomMargin;\n        tableFormat.preferredWidth = this.preferredWidth;\n        tableFormat.preferredWidthType = this.preferredWidthType;\n        tableFormat.borders = isNullOrUndefined(this.borders) ? undefined : this.borders.cloneFormat();\n        tableFormat.shading = isNullOrUndefined(this.shading) ? undefined : this.shading.cloneFormat();\n        return tableFormat;\n    };\n    WTableFormat.prototype.hasValue = function (property) {\n        if (!isNullOrUndefined(this.uniqueTableFormat)) {\n            var propertyType = WUniqueFormat.getPropertyType(this.uniqueTableFormat.uniqueFormatType, property);\n            return this.uniqueTableFormat.propertiesHash.containsKey(propertyType);\n        }\n        return false;\n    };\n    WTableFormat.prototype.copyFormat = function (format) {\n        if (!isNullOrUndefined(format)) {\n            if (!isNullOrUndefined(format.uniqueTableFormat)) {\n                this.cellSpacing = format.cellSpacing;\n                this.leftMargin = format.leftMargin;\n                this.topMargin = format.topMargin;\n                this.rightMargin = format.rightMargin;\n                this.bottomMargin = format.bottomMargin;\n                this.leftIndent = format.leftIndent;\n                this.tableAlignment = format.tableAlignment;\n                this.preferredWidth = format.preferredWidth;\n                this.preferredWidthType = format.preferredWidthType;\n            }\n            if (!isNullOrUndefined(format.borders)) {\n                this.borders = new WBorders(this);\n                this.borders.copyFormat(format.borders);\n            }\n            if (!isNullOrUndefined(format.shading)) {\n                this.shading = new WShading(this);\n                this.shading.copyFormat(format.shading);\n            }\n        }\n    };\n    WTableFormat.clear = function () {\n        this.uniqueTableFormats.clear();\n    };\n    WTableFormat.uniqueTableFormats = new WUniqueFormats();\n    WTableFormat.uniqueFormatType = 8;\n    return WTableFormat;\n}());\nexport { WTableFormat };\n","import { isNullOrUndefined } from '@syncfusion/ej2-base';\nimport { Dictionary } from '../../base/dictionary';\nimport { WUniqueFormat } from '../../base/unique-format';\nimport { WUniqueFormats } from '../../base/unique-formats';\nimport { WBorders } from './borders';\n/**\n * @private\n */\nvar WRowFormat = /** @class */ (function () {\n    function WRowFormat(node) {\n        this.uniqueRowFormat = undefined;\n        /**\n         * @private\n         */\n        this.borders = new WBorders(this);\n        /**\n         * @private\n         */\n        this.ownerBase = undefined;\n        /**\n         * @private\n         */\n        this.beforeWidth = 0;\n        /**\n         * @private\n         */\n        this.afterWidth = 0;\n        this.ownerBase = node;\n    }\n    Object.defineProperty(WRowFormat.prototype, \"gridBefore\", {\n        get: function () {\n            return this.getPropertyValue('gridBefore');\n        },\n        set: function (value) {\n            this.setPropertyValue('gridBefore', value);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(WRowFormat.prototype, \"gridBeforeWidth\", {\n        get: function () {\n            return this.getPropertyValue('gridBeforeWidth');\n        },\n        set: function (value) {\n            this.setPropertyValue('gridBeforeWidth', value);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(WRowFormat.prototype, \"gridBeforeWidthType\", {\n        get: function () {\n            return this.getPropertyValue('gridBeforeWidthType');\n        },\n        set: function (value) {\n            this.setPropertyValue('gridBeforeWidthType', value);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(WRowFormat.prototype, \"gridAfter\", {\n        get: function () {\n            return this.getPropertyValue('gridAfter');\n        },\n        set: function (value) {\n            this.setPropertyValue('gridAfter', value);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(WRowFormat.prototype, \"gridAfterWidth\", {\n        get: function () {\n            return this.getPropertyValue('gridAfterWidth');\n        },\n        set: function (value) {\n            this.setPropertyValue('gridAfterWidth', value);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(WRowFormat.prototype, \"gridAfterWidthType\", {\n        get: function () {\n            return this.getPropertyValue('gridAfterWidthType');\n        },\n        set: function (value) {\n            this.setPropertyValue('gridAfterWidthType', value);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(WRowFormat.prototype, \"allowBreakAcrossPages\", {\n        get: function () {\n            return this.getPropertyValue('allowBreakAcrossPages');\n        },\n        set: function (value) {\n            this.setPropertyValue('allowBreakAcrossPages', value);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(WRowFormat.prototype, \"isHeader\", {\n        get: function () {\n            return this.getPropertyValue('isHeader');\n        },\n        set: function (value) {\n            this.setPropertyValue('isHeader', value);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(WRowFormat.prototype, \"height\", {\n        get: function () {\n            return this.getPropertyValue('height');\n        },\n        set: function (value) {\n            if (value === 0 && (this.heightType === 'AtLeast' || this.heightType === 'Exactly')) {\n                value = 1;\n            }\n            else if (this.heightType === 'Auto') {\n                value = 0;\n            }\n            this.setPropertyValue('height', value);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(WRowFormat.prototype, \"heightType\", {\n        get: function () {\n            return this.getPropertyValue('heightType');\n        },\n        set: function (value) {\n            if (value === 'AtLeast' || value === 'Exactly') {\n                this.height = 1;\n            }\n            else {\n                this.height = 0;\n            }\n            this.setPropertyValue('heightType', value);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    WRowFormat.prototype.getPropertyValue = function (property) {\n        var hasValue = this.hasValue(property);\n        if (hasValue) {\n            var propertyType = WUniqueFormat.getPropertyType(WRowFormat.uniqueFormatType, property);\n            if (!isNullOrUndefined(this.uniqueRowFormat) && this.uniqueRowFormat.propertiesHash.containsKey(propertyType)) {\n                return this.uniqueRowFormat.propertiesHash.get(propertyType);\n            }\n        }\n        return WRowFormat.getPropertyDefaultValue(property);\n    };\n    WRowFormat.prototype.setPropertyValue = function (property, value) {\n        if (isNullOrUndefined(value) || value === '') {\n            value = WRowFormat.getPropertyDefaultValue(property);\n        }\n        if (isNullOrUndefined(this.uniqueRowFormat)) {\n            this.initializeUniqueRowFormat(property, value);\n        }\n        else {\n            var propertyType = WUniqueFormat.getPropertyType(this.uniqueRowFormat.uniqueFormatType, property);\n            if (this.uniqueRowFormat.propertiesHash.containsKey(propertyType) &&\n                this.uniqueRowFormat.propertiesHash.get(propertyType) === value) {\n                //Do nothing, since no change in property value and return\n                return;\n            }\n            this.uniqueRowFormat = WRowFormat.uniqueRowFormats.updateUniqueFormat(this.uniqueRowFormat, property, value);\n        }\n    };\n    WRowFormat.prototype.initializeUniqueRowFormat = function (property, propValue) {\n        var uniqueRowFormatTemp = new Dictionary();\n        this.addUniqueRowFormat('allowBreakAcrossPages', property, propValue, uniqueRowFormatTemp);\n        this.addUniqueRowFormat('isHeader', property, propValue, uniqueRowFormatTemp);\n        this.addUniqueRowFormat('height', property, propValue, uniqueRowFormatTemp);\n        this.addUniqueRowFormat('heightType', property, propValue, uniqueRowFormatTemp);\n        this.addUniqueRowFormat('gridBefore', property, propValue, uniqueRowFormatTemp);\n        this.addUniqueRowFormat('gridBeforeWidth', property, propValue, uniqueRowFormatTemp);\n        this.addUniqueRowFormat('gridBeforeWidthType', property, propValue, uniqueRowFormatTemp);\n        this.addUniqueRowFormat('gridAfter', property, propValue, uniqueRowFormatTemp);\n        this.addUniqueRowFormat('gridAfterWidth', property, propValue, uniqueRowFormatTemp);\n        this.addUniqueRowFormat('gridgridAfterWidth', property, propValue, uniqueRowFormatTemp);\n        this.addUniqueRowFormat('gridBeforeWidthType', property, propValue, uniqueRowFormatTemp);\n        this.uniqueRowFormat = WRowFormat.uniqueRowFormats.addUniqueFormat(uniqueRowFormatTemp, WRowFormat.uniqueFormatType);\n    };\n    // tslint:disable-next-line:max-line-length\n    WRowFormat.prototype.addUniqueRowFormat = function (property, modifiedProperty, propValue, uniqueRowFormatTemp) {\n        var propertyType;\n        propertyType = WUniqueFormat.getPropertyType(WRowFormat.uniqueFormatType, property);\n        if (property === modifiedProperty) {\n            uniqueRowFormatTemp.add(propertyType, propValue);\n        }\n    };\n    WRowFormat.getPropertyDefaultValue = function (property) {\n        var value = undefined;\n        switch (property) {\n            case 'allowBreakAcrossPages':\n                value = true;\n                break;\n            case 'isHeader':\n                value = false;\n                break;\n            case 'height':\n                value = 0;\n                break;\n            case 'heightType':\n                value = 'Auto';\n                break;\n            case 'gridBefore':\n                value = 0;\n                break;\n            case 'gridBeforeWidth':\n                value = 0;\n                break;\n            case 'gridBeforeWidthType':\n                value = 'Point';\n                break;\n            case 'gridAfter':\n                value = 0;\n                break;\n            case 'gridAfterWidth':\n                value = 0;\n                break;\n            case 'gridAfterWidthType':\n                value = 'Point';\n                break;\n        }\n        return value;\n    };\n    WRowFormat.prototype.cloneFormat = function () {\n        var format = new WRowFormat();\n        format.allowBreakAcrossPages = this.allowBreakAcrossPages;\n        format.heightType = this.heightType;\n        format.height = this.height;\n        format.isHeader = this.isHeader;\n        format.gridBefore = this.gridBefore;\n        format.gridBeforeWidth = this.gridBeforeWidth;\n        format.gridBeforeWidthType = this.gridBeforeWidthType;\n        format.gridAfter = this.gridAfter;\n        format.gridAfterWidth = this.gridAfterWidth;\n        format.gridAfterWidthType = this.gridAfterWidthType;\n        return format;\n    };\n    WRowFormat.prototype.hasValue = function (property) {\n        if (!isNullOrUndefined(this.uniqueRowFormat)) {\n            var propertyType = WUniqueFormat.getPropertyType(this.uniqueRowFormat.uniqueFormatType, property);\n            return this.uniqueRowFormat.propertiesHash.containsKey(propertyType);\n        }\n        return false;\n    };\n    WRowFormat.prototype.copyFormat = function (format) {\n        if (!isNullOrUndefined(format)) {\n            if (!isNullOrUndefined(format.uniqueRowFormat)) {\n                this.allowBreakAcrossPages = format.allowBreakAcrossPages;\n                this.isHeader = format.isHeader;\n                this.heightType = format.heightType;\n                this.height = format.height;\n                this.gridBefore = format.gridBefore;\n                this.gridBeforeWidth = format.gridBeforeWidth;\n                this.gridBeforeWidthType = format.gridBeforeWidthType;\n                this.gridAfter = format.gridAfter;\n                this.gridAfterWidth = format.gridAfterWidth;\n                this.gridAfterWidthType = format.gridAfterWidthType;\n            }\n            if (!isNullOrUndefined(format.borders)) {\n                this.borders = new WBorders(this);\n                this.borders.ownerBase = format;\n                this.borders.copyFormat(format.borders);\n            }\n        }\n    };\n    WRowFormat.prototype.destroy = function () {\n        if (!isNullOrUndefined(this.borders)) {\n            this.borders.destroy();\n        }\n        if (!isNullOrUndefined(this.uniqueRowFormat)) {\n            WRowFormat.uniqueRowFormats.remove(this.uniqueRowFormat);\n        }\n        this.beforeWidth = undefined;\n        this.afterWidth = undefined;\n        this.borders = undefined;\n        this.uniqueRowFormat = undefined;\n    };\n    WRowFormat.clear = function () {\n        this.uniqueRowFormats.clear();\n    };\n    WRowFormat.uniqueRowFormats = new WUniqueFormats();\n    WRowFormat.uniqueFormatType = 6;\n    return WRowFormat;\n}());\nexport { WRowFormat };\n","import { isNullOrUndefined } from '@syncfusion/ej2-base';\nimport { Dictionary } from '../../base/dictionary';\nimport { WUniqueFormat } from '../../base/unique-format';\nimport { WUniqueFormats } from '../../base/unique-formats';\nimport { WBorders } from './borders';\nimport { WShading } from './shading';\n/**\n * @private\n */\nvar WCellFormat = /** @class */ (function () {\n    function WCellFormat(node) {\n        this.uniqueCellFormat = undefined;\n        this.borders = new WBorders(this);\n        this.shading = new WShading(this);\n        this.ownerBase = node;\n        this.borders = new WBorders(this);\n        this.shading = new WShading(this);\n    }\n    Object.defineProperty(WCellFormat.prototype, \"leftMargin\", {\n        get: function () {\n            return this.getPropertyValue('leftMargin');\n        },\n        set: function (value) {\n            this.setPropertyValue('leftMargin', value);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(WCellFormat.prototype, \"rightMargin\", {\n        get: function () {\n            return this.getPropertyValue('rightMargin');\n        },\n        set: function (value) {\n            this.setPropertyValue('rightMargin', value);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(WCellFormat.prototype, \"topMargin\", {\n        get: function () {\n            return this.getPropertyValue('topMargin');\n        },\n        set: function (value) {\n            this.setPropertyValue('topMargin', value);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(WCellFormat.prototype, \"bottomMargin\", {\n        get: function () {\n            return this.getPropertyValue('bottomMargin');\n        },\n        set: function (value) {\n            this.setPropertyValue('bottomMargin', value);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(WCellFormat.prototype, \"cellWidth\", {\n        get: function () {\n            return this.getPropertyValue('cellWidth');\n        },\n        set: function (value) {\n            this.setPropertyValue('cellWidth', value);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(WCellFormat.prototype, \"columnSpan\", {\n        get: function () {\n            return this.getPropertyValue('columnSpan');\n        },\n        set: function (value) {\n            this.setPropertyValue('columnSpan', value);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(WCellFormat.prototype, \"rowSpan\", {\n        get: function () {\n            return this.getPropertyValue('rowSpan');\n        },\n        set: function (value) {\n            this.setPropertyValue('rowSpan', value);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(WCellFormat.prototype, \"preferredWidth\", {\n        get: function () {\n            return this.getPropertyValue('preferredWidth');\n        },\n        set: function (value) {\n            this.setPropertyValue('preferredWidth', value);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(WCellFormat.prototype, \"verticalAlignment\", {\n        get: function () {\n            return this.getPropertyValue('verticalAlignment');\n        },\n        set: function (value) {\n            this.setPropertyValue('verticalAlignment', value);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(WCellFormat.prototype, \"preferredWidthType\", {\n        get: function () {\n            return this.getPropertyValue('preferredWidthType');\n        },\n        set: function (value) {\n            this.setPropertyValue('preferredWidthType', value);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    WCellFormat.prototype.getPropertyValue = function (property) {\n        var hasValue = this.hasValue(property);\n        if (hasValue) {\n            var propertyType = WUniqueFormat.getPropertyType(WCellFormat.uniqueFormatType, property);\n            if (!isNullOrUndefined(this.uniqueCellFormat) && this.uniqueCellFormat.propertiesHash.containsKey(propertyType)) {\n                return this.uniqueCellFormat.propertiesHash.get(propertyType);\n            }\n        }\n        return WCellFormat.getPropertyDefaultValue(property);\n    };\n    WCellFormat.prototype.setPropertyValue = function (property, value) {\n        if (isNullOrUndefined(value) || value === '') {\n            value = WCellFormat.getPropertyDefaultValue(property);\n        }\n        if (isNullOrUndefined(this.uniqueCellFormat)) {\n            this.initializeUniqueCellFormat(property, value);\n        }\n        else {\n            var propertyType = WUniqueFormat.getPropertyType(this.uniqueCellFormat.uniqueFormatType, property);\n            if (this.uniqueCellFormat.propertiesHash.containsKey(propertyType) &&\n                this.uniqueCellFormat.propertiesHash.get(propertyType) === value) {\n                //Do nothing, since no change in property value and return\n                return;\n            }\n            this.uniqueCellFormat = WCellFormat.uniqueCellFormats.updateUniqueFormat(this.uniqueCellFormat, property, value);\n        }\n    };\n    WCellFormat.prototype.initializeUniqueCellFormat = function (property, propValue) {\n        var uniqueCellFormatTemp = new Dictionary();\n        this.addUniqueCellFormat('leftMargin', property, propValue, uniqueCellFormatTemp);\n        this.addUniqueCellFormat('topMargin', property, propValue, uniqueCellFormatTemp);\n        this.addUniqueCellFormat('bottomMargin', property, propValue, uniqueCellFormatTemp);\n        this.addUniqueCellFormat('rightMargin', property, propValue, uniqueCellFormatTemp);\n        this.addUniqueCellFormat('cellWidth', property, propValue, uniqueCellFormatTemp);\n        this.addUniqueCellFormat('columnSpan', property, propValue, uniqueCellFormatTemp);\n        this.addUniqueCellFormat('rowSpan', property, propValue, uniqueCellFormatTemp);\n        this.addUniqueCellFormat('preferredWidth', property, propValue, uniqueCellFormatTemp);\n        this.addUniqueCellFormat('verticalAlignment', property, propValue, uniqueCellFormatTemp);\n        this.addUniqueCellFormat('preferredWidthType', property, propValue, uniqueCellFormatTemp);\n        this.uniqueCellFormat = WCellFormat.uniqueCellFormats.addUniqueFormat(uniqueCellFormatTemp, WCellFormat.uniqueFormatType);\n    };\n    // tslint:disable-next-line:max-line-length\n    WCellFormat.prototype.addUniqueCellFormat = function (property, modifiedProperty, propValue, uniqueCellFormatTemp) {\n        var propertyType;\n        propertyType = WUniqueFormat.getPropertyType(WCellFormat.uniqueFormatType, property);\n        if (property === modifiedProperty) {\n            uniqueCellFormatTemp.add(propertyType, propValue);\n        }\n    };\n    WCellFormat.getPropertyDefaultValue = function (property) {\n        var value = undefined;\n        switch (property) {\n            case 'leftMargin':\n                value = undefined;\n                break;\n            case 'topMargin':\n                value = undefined;\n                break;\n            case 'bottomMargin':\n                value = undefined;\n                break;\n            case 'rightMargin':\n                value = undefined;\n                break;\n            case 'cellWidth':\n                value = 0;\n                break;\n            case 'columnSpan':\n                value = 1;\n                break;\n            case 'rowSpan':\n                value = 1;\n                break;\n            case 'preferredWidth':\n                value = 0;\n                break;\n            case 'verticalAlignment':\n                value = 'Top';\n                break;\n            case 'preferredWidthType':\n                value = 'Point';\n                break;\n        }\n        return value;\n    };\n    WCellFormat.prototype.containsMargins = function () {\n        return (!isNullOrUndefined(this.leftMargin)\n            || !isNullOrUndefined(this.rightMargin)\n            || !isNullOrUndefined(this.bottomMargin)\n            || !isNullOrUndefined(this.topMargin));\n    };\n    WCellFormat.prototype.destroy = function () {\n        if (!isNullOrUndefined(this.borders)) {\n            this.borders.destroy();\n        }\n        if (!isNullOrUndefined(this.shading)) {\n            this.shading.destroy();\n        }\n        if (!isNullOrUndefined(this.uniqueCellFormat)) {\n            WCellFormat.uniqueCellFormats.remove(this.uniqueCellFormat);\n        }\n        this.uniqueCellFormat = undefined;\n        this.borders = undefined;\n        this.shading = undefined;\n    };\n    WCellFormat.prototype.cloneFormat = function () {\n        var format = new WCellFormat(undefined);\n        format.verticalAlignment = this.verticalAlignment;\n        format.leftMargin = this.leftMargin;\n        format.rightMargin = this.rightMargin;\n        format.topMargin = this.topMargin;\n        format.bottomMargin = this.bottomMargin;\n        format.preferredWidth = this.preferredWidth;\n        format.preferredWidthType = this.preferredWidthType;\n        format.cellWidth = this.cellWidth;\n        format.borders = isNullOrUndefined(this.borders) ? undefined : this.borders.cloneFormat();\n        format.shading = isNullOrUndefined(this.shading) ? undefined : this.shading.cloneFormat();\n        return format;\n    };\n    WCellFormat.prototype.hasValue = function (property) {\n        if (!isNullOrUndefined(this.uniqueCellFormat)) {\n            var propertyType = WUniqueFormat.getPropertyType(this.uniqueCellFormat.uniqueFormatType, property);\n            return this.uniqueCellFormat.propertiesHash.containsKey(propertyType);\n        }\n        return false;\n    };\n    WCellFormat.prototype.copyFormat = function (format) {\n        if (!isNullOrUndefined(format)) {\n            if (!isNullOrUndefined(format.uniqueCellFormat)) {\n                this.cellWidth = format.cellWidth;\n                this.leftMargin = format.leftMargin;\n                this.topMargin = format.topMargin;\n                this.rightMargin = format.rightMargin;\n                this.bottomMargin = format.bottomMargin;\n                this.preferredWidth = format.preferredWidth;\n                this.columnSpan = format.columnSpan;\n                this.rowSpan = format.rowSpan;\n                this.preferredWidthType = format.preferredWidthType;\n                this.verticalAlignment = format.verticalAlignment;\n            }\n            if (!isNullOrUndefined(format.shading)) {\n                this.shading = new WShading(this);\n                this.shading.copyFormat(format.shading);\n            }\n            if (!isNullOrUndefined(format.borders)) {\n                this.borders = new WBorders(this);\n                this.borders.copyFormat(format.borders);\n            }\n        }\n    };\n    WCellFormat.clear = function () {\n        this.uniqueCellFormats.clear();\n    };\n    WCellFormat.uniqueCellFormats = new WUniqueFormats();\n    WCellFormat.uniqueFormatType = 4;\n    return WCellFormat;\n}());\nexport { WCellFormat };\n","var __extends = (this && this.__extends) || (function () {\n    var extendStatics = Object.setPrototypeOf ||\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nimport { WTableFormat, WRowFormat, WCellFormat } from '../format/index';\nimport { WParagraphFormat, WCharacterFormat, WBorder, WBorders } from '../format/index';\nimport { isNullOrUndefined } from '@syncfusion/ej2-base';\nimport { Dictionary } from '../../base/dictionary';\nimport { HelperMethods } from '../editor/editor-helper';\n/**\n * @private\n */\nvar Rect = /** @class */ (function () {\n    function Rect(x, y, width, height) {\n        this.x = x;\n        this.y = y;\n        this.width = width;\n        this.height = height;\n    }\n    Object.defineProperty(Rect.prototype, \"right\", {\n        /**\n         * @private\n         */\n        get: function () {\n            return this.x + this.width;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(Rect.prototype, \"bottom\", {\n        /**\n         * @private\n         */\n        get: function () {\n            return this.y + this.height;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    return Rect;\n}());\nexport { Rect };\n/**\n * @private\n */\nvar Margin = /** @class */ (function () {\n    function Margin(leftMargin, topMargin, rightMargin, bottomMargin) {\n        this.left = leftMargin;\n        this.top = topMargin;\n        this.right = rightMargin;\n        this.bottom = bottomMargin;\n    }\n    /**\n     * @private\n     */\n    Margin.prototype.clone = function () {\n        return new Margin(this.left, this.top, this.right, this.bottom);\n    };\n    /**\n     * @private\n     */\n    Margin.prototype.destroy = function () {\n        this.left = undefined;\n        this.right = undefined;\n        this.top = undefined;\n        this.bottom = undefined;\n    };\n    return Margin;\n}());\nexport { Margin };\n/**\n * @private\n */\nvar Widget = /** @class */ (function () {\n    function Widget() {\n        /**\n         * @private\n         */\n        this.childWidgets = [];\n        /**\n         * @private\n         */\n        this.x = 0;\n        /**\n         * @private\n         */\n        this.y = 0;\n        /**\n         * @private\n         */\n        this.width = 0;\n        /**\n         * @private\n         */\n        this.height = 0;\n        /**\n         * @private\n         */\n        this.index = 0;\n    }\n    Object.defineProperty(Widget.prototype, \"indexInOwner\", {\n        /**\n         * @private\n         */\n        get: function () {\n            if (this instanceof BodyWidget && this.page) {\n                return this.page.bodyWidgets.indexOf(this);\n            }\n            else if (this.containerWidget && this.containerWidget.childWidgets) {\n                return this.containerWidget.childWidgets.indexOf(this);\n            }\n            return -1;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(Widget.prototype, \"firstChild\", {\n        /**\n         * @private\n         */\n        get: function () {\n            return this.childWidgets.length > 0 ? this.childWidgets[0] : undefined;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(Widget.prototype, \"lastChild\", {\n        /**\n         * @private\n         */\n        get: function () {\n            if (this.childWidgets) {\n                return this.childWidgets.length > 0 ?\n                    this.childWidgets[this.childWidgets.length - 1] : undefined;\n            }\n            return undefined;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(Widget.prototype, \"previousWidget\", {\n        /**\n         * @private\n         */\n        get: function () {\n            var widget = this;\n            var index = this.indexInOwner;\n            if (widget instanceof BodyWidget) {\n                widget = index > 0 ? widget.page.bodyWidgets[index - 1] : undefined;\n            }\n            else {\n                widget = index > 0 ? widget.containerWidget.childWidgets[index - 1] : undefined;\n            }\n            return widget;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(Widget.prototype, \"nextWidget\", {\n        /**\n         * @private\n         */\n        get: function () {\n            var widget = this;\n            var index = this.indexInOwner;\n            if (index === -1) {\n                return undefined;\n            }\n            if (widget instanceof BodyWidget) {\n                widget = index < widget.page.bodyWidgets.length - 1 ?\n                    widget.page.bodyWidgets[index + 1] : undefined;\n            }\n            else {\n                widget = index < widget.containerWidget.childWidgets.length - 1 ?\n                    widget.containerWidget.childWidgets[index + 1] : undefined;\n            }\n            return widget;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(Widget.prototype, \"previousRenderedWidget\", {\n        /**\n         * @private\n         */\n        get: function () {\n            var widget = this;\n            var index = this.indexInOwner;\n            if (index < 0) {\n                return undefined;\n            }\n            if (widget instanceof BodyWidget) {\n                if (index > 0) {\n                    widget = widget.page.bodyWidgets[index - 1];\n                }\n                else {\n                    var page = widget.page.previousPage;\n                    widget = page && page.bodyWidgets.length > 0 ? page.bodyWidgets[page.bodyWidgets.length - 1] : undefined;\n                }\n            }\n            else {\n                if (index > 0) {\n                    widget = widget.containerWidget.childWidgets[index - 1];\n                }\n                else {\n                    var previousContainer = undefined;\n                    if (widget.containerWidget instanceof TableCellWidget) {\n                        previousContainer = widget.containerWidget.getPreviousSplitWidget();\n                    }\n                    else if (!(widget.containerWidget instanceof TableRowWidget\n                        || widget.containerWidget instanceof HeaderFooterWidget)) {\n                        // Since cells are lay outed left to right, we should not navigate to previous row.\n                        previousContainer = widget.containerWidget.previousRenderedWidget;\n                    }\n                    while (previousContainer && previousContainer.childWidgets.length === 0) {\n                        previousContainer = previousContainer.previousRenderedWidget;\n                        if (isNullOrUndefined(previousContainer)) {\n                            break;\n                        }\n                    }\n                    widget = previousContainer && previousContainer.constructor === widget.containerWidget.constructor ?\n                        previousContainer.lastChild : undefined;\n                }\n            }\n            return widget;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(Widget.prototype, \"nextRenderedWidget\", {\n        /**\n         * @private\n         */\n        get: function () {\n            var widget = this;\n            var index = this.indexInOwner;\n            if (index < 0) {\n                return undefined;\n            }\n            if (widget instanceof BodyWidget) {\n                if (index < widget.page.bodyWidgets.length - 1) {\n                    widget = widget.page.bodyWidgets[index + 1];\n                }\n                else {\n                    var page = widget.page.nextPage;\n                    widget = page && page.bodyWidgets.length > 0 ? page.bodyWidgets[0] : undefined;\n                }\n            }\n            else {\n                if (index < widget.containerWidget.childWidgets.length - 1) {\n                    widget = widget.containerWidget.childWidgets[index + 1];\n                }\n                else {\n                    var nextContainer = undefined;\n                    if (widget.containerWidget instanceof TableCellWidget) {\n                        nextContainer = widget.containerWidget.getNextSplitWidget();\n                    }\n                    else if (!(widget.containerWidget instanceof TableRowWidget\n                        || widget.containerWidget instanceof HeaderFooterWidget)) {\n                        // Since cells are lay outed left to right, we should not navigate to next row.\n                        nextContainer = widget.containerWidget.nextRenderedWidget;\n                    }\n                    while (nextContainer && nextContainer.childWidgets.length === 0 && !(nextContainer instanceof TableCellWidget)) {\n                        nextContainer = nextContainer.nextRenderedWidget;\n                        if (isNullOrUndefined(nextContainer)) {\n                            break;\n                        }\n                    }\n                    widget = nextContainer && nextContainer.constructor === widget.containerWidget.constructor ?\n                        nextContainer.firstChild : undefined;\n                }\n            }\n            return widget;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(Widget.prototype, \"previousSplitWidget\", {\n        /**\n         * @private\n         */\n        get: function () {\n            var widget = this;\n            if (widget instanceof TableCellWidget) {\n                return widget.getPreviousSplitWidget();\n            }\n            else {\n                var previous = widget.previousRenderedWidget;\n                if (widget instanceof BodyWidget && previous instanceof BodyWidget && widget.equals(previous)) {\n                    return previous;\n                }\n                else if (previous instanceof BlockWidget && widget.index === previous.index && widget.equals(previous)) {\n                    return previous;\n                }\n            }\n            return undefined;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(Widget.prototype, \"nextSplitWidget\", {\n        /**\n         * @private\n         */\n        get: function () {\n            var widget = this;\n            if (widget instanceof TableCellWidget) {\n                return widget.getNextSplitWidget();\n            }\n            else {\n                var next = widget.nextRenderedWidget;\n                if (widget instanceof BodyWidget && next instanceof BodyWidget && widget.equals(next)) {\n                    return next;\n                }\n                else if (next instanceof BlockWidget && widget.index === next.index && widget.equals(next)) {\n                    return next;\n                }\n            }\n            return undefined;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    /**\n     * @private\n     */\n    Widget.prototype.getPreviousSplitWidgets = function () {\n        var widgets = [];\n        var widget = this.previousSplitWidget;\n        while (widget) {\n            widgets.unshift(widget);\n            widget = widget.previousSplitWidget;\n        }\n        return widgets;\n    };\n    /**\n     * @private\n     */\n    Widget.prototype.getSplitWidgets = function () {\n        var widgets = this.getPreviousSplitWidgets();\n        var widget = this;\n        while (widget) {\n            widgets.push(widget);\n            widget = widget.nextSplitWidget;\n        }\n        return widgets;\n    };\n    /**\n     * @private\n     */\n    Widget.prototype.combineWidget = function (viewer) {\n        var root = this;\n        var widgets = this.getSplitWidgets();\n        if (widgets.length > 1) {\n            root = widgets.shift();\n            while (widgets.length > 0) {\n                var splitWidget = widgets.shift();\n                root.combine(splitWidget, viewer);\n            }\n        }\n        if (root instanceof TableWidget) {\n            root.combineRows(viewer);\n        }\n        return root;\n    };\n    Widget.prototype.combine = function (widget, viewer) {\n        if (widget.childWidgets.length > 0) {\n            var lastChild = this.lastChild;\n            if (lastChild instanceof TableWidget) {\n                lastChild.combineWidget(viewer);\n            }\n            else {\n                var firstChild = widget.firstChild;\n                if (!(widget instanceof TableWidget) && lastChild instanceof Widget && firstChild instanceof Widget &&\n                    lastChild.index === firstChild.index) {\n                    lastChild.combine(widget.childWidgets.shift(), viewer);\n                }\n            }\n            this.addWidgets(widget.childWidgets);\n            widget.childWidgets = [];\n        }\n        widget.destroyInternal(viewer);\n    };\n    /**\n     * @private\n     */\n    Widget.prototype.addWidgets = function (childWidgets) {\n        while (childWidgets.length > 0) {\n            var widget = childWidgets.shift();\n            if (widget instanceof LineWidget && this instanceof ParagraphWidget) {\n                widget.paragraph = this;\n                this.height += widget.height;\n            }\n            else if (widget instanceof Widget) {\n                var lastChild = this.lastChild;\n                widget.containerWidget = this;\n                widget.y = lastChild instanceof Widget ? lastChild.y + lastChild.height : this.y;\n                this.height += widget.height;\n            }\n            this.childWidgets.push(widget);\n        }\n    };\n    /**\n     * @private\n     */\n    Widget.prototype.removeChild = function (index) {\n        if (index > -1 && index < this.childWidgets.length) {\n            this.childWidgets.splice(index, 1);\n        }\n    };\n    /**\n     * @private\n     */\n    Widget.prototype.destroy = function () {\n        if (this.childWidgets) {\n            while (this.childWidgets.length > 0) {\n                var child = this.childWidgets.pop();\n                if (child instanceof LineWidget || child instanceof Widget) {\n                    child.destroy();\n                }\n            }\n        }\n        this.childWidgets = undefined;\n        if (this.containerWidget) {\n            this.containerWidget.removeChild(this.indexInOwner);\n        }\n        this.containerWidget = undefined;\n        // if (this.margin) {\n        //     this.margin.destroy();\n        // }\n        this.margin = undefined;\n        this.x = undefined;\n        this.y = undefined;\n        this.width = undefined;\n        this.height = undefined;\n        this.index = undefined;\n    };\n    return Widget;\n}());\nexport { Widget };\n/**\n * @private\n */\nvar BlockContainer = /** @class */ (function (_super) {\n    __extends(BlockContainer, _super);\n    function BlockContainer() {\n        var _this = _super !== null && _super.apply(this, arguments) || this;\n        /**\n         * @private\n         */\n        _this.sectionFormatIn = undefined;\n        return _this;\n    }\n    Object.defineProperty(BlockContainer.prototype, \"sectionFormat\", {\n        /**\n         * @private\n         */\n        get: function () {\n            var container = this;\n            if (container instanceof BodyWidget) {\n                return container.sectionFormatIn;\n            }\n            else if (container.page) {\n                return container.page.bodyWidgets[0].sectionFormat;\n            }\n            return undefined;\n        },\n        /**\n         * @private\n         */\n        set: function (value) {\n            if (this instanceof BodyWidget) {\n                this.sectionFormatIn = value;\n            }\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(BlockContainer.prototype, \"sectionIndex\", {\n        /**\n         * @private\n         */\n        get: function () {\n            var container = this;\n            var index = 0;\n            if (container instanceof BodyWidget) {\n                index = container.index;\n            }\n            else if (container.page) {\n                index = container.page.bodyWidgets[0].index;\n            }\n            return index;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    /**\n     * @private\n     */\n    BlockContainer.prototype.getHierarchicalIndex = function (hierarchicalIndex) {\n        var viewer = undefined;\n        var node = this;\n        if (node instanceof BodyWidget) {\n            hierarchicalIndex = node.index + ';' + hierarchicalIndex;\n        }\n        else {\n            if (node.headerFooterType.indexOf('Header') !== -1) {\n                hierarchicalIndex = 'H' + ';' + hierarchicalIndex;\n            }\n            else {\n                hierarchicalIndex = 'F' + ';' + hierarchicalIndex;\n            }\n        }\n        if (!isNullOrUndefined(node.page)) {\n            viewer = this.page.viewer;\n            var pageIndex = viewer.pages.indexOf(this.page);\n            return pageIndex + ';' + hierarchicalIndex;\n        }\n        return hierarchicalIndex;\n    };\n    return BlockContainer;\n}(Widget));\nexport { BlockContainer };\n/**\n * @private\n */\nvar BodyWidget = /** @class */ (function (_super) {\n    __extends(BodyWidget, _super);\n    /**\n     * Initialize the constructor of BodyWidget\n     */\n    function BodyWidget() {\n        return _super.call(this) || this;\n    }\n    /**\n     * @private\n     */\n    BodyWidget.prototype.equals = function (widget) {\n        return widget instanceof BodyWidget && widget.sectionFormat === this.sectionFormat;\n    };\n    /**\n     * @private\n     */\n    BodyWidget.prototype.getHierarchicalIndex = function (hierarchicalIndex) {\n        var viewer = undefined;\n        var node = this;\n        hierarchicalIndex = node.index + ';' + hierarchicalIndex;\n        if (!isNullOrUndefined(node.page)) {\n            viewer = this.page.viewer;\n            var pageIndex = viewer.pages.indexOf(this.page);\n            return pageIndex + ';' + hierarchicalIndex;\n        }\n        return hierarchicalIndex;\n    };\n    /**\n     * @private\n     */\n    BodyWidget.prototype.getTableCellWidget = function (touchPoint) {\n        for (var i = 0; i < this.childWidgets.length; i++) {\n            if (this.childWidgets[i].y <= touchPoint.y\n                && (this.childWidgets[i].y + this.childWidgets[i].height) >= touchPoint.y) {\n                return this.childWidgets[i].getTableCellWidget(touchPoint);\n            }\n        }\n        var tableCellWidget = undefined;\n        if (this.childWidgets.length > 0) {\n            if (this.childWidgets[0].y <= touchPoint.y) {\n                tableCellWidget = this.childWidgets[this.childWidgets.length - 1].getTableCellWidget(touchPoint);\n            }\n            else {\n                tableCellWidget = this.childWidgets[0].getTableCellWidget(touchPoint);\n            }\n        }\n        return tableCellWidget;\n    };\n    /**\n     * @private\n     */\n    BodyWidget.prototype.destroyInternal = function (viewer) {\n        var height = this.height;\n        if (!isNullOrUndefined(this.childWidgets)) {\n            for (var n = 0; n < this.childWidgets.length; n++) {\n                var chilgWidget = this.childWidgets[n];\n                if (chilgWidget instanceof ParagraphWidget) {\n                    chilgWidget.destroyInternal(viewer);\n                }\n                else {\n                    chilgWidget.destroyInternal(viewer);\n                }\n                if (isNullOrUndefined(this.childWidgets)) {\n                    break;\n                }\n                n--;\n            }\n            this.childWidgets = undefined;\n        }\n        // if (this instanceof HeaderFooterWidget && ((this as HeaderFooterWidget).currentNode ))) {\n        //     if (((this as HeaderFooterWidget).currentNode as WHeaderFooter).layoutedWidgets )) {\n        //         let index: number = ((this as HeaderFooterWidget).currentNode as WHeaderFooter).layoutedWidgets.indexOf(this);\n        //         ((this as HeaderFooterWidget).currentNode as WHeaderFooter).layoutedWidgets.splice(index, 1);\n        //     }\n        //     this.currentNode = undefined;\n        /* tslint:disable: one-line */\n        if (!isNullOrUndefined(this.page)) {\n            var index = this.indexInOwner;\n            if (this.indexInOwner > -1) {\n                this.page.bodyWidgets.splice(index, 1);\n                if (this.page.bodyWidgets.length === 0) {\n                    this.page.destroy();\n                    // }\n                }\n                else if ((this instanceof HeaderFooterWidget)\n                    && this.page.headerWidget === this) {\n                    this.page.headerWidget = undefined;\n                }\n                else if ((this instanceof HeaderFooterWidget)\n                    && this.page.footerWidget === this) {\n                    this.page.footerWidget = undefined;\n                }\n                this.page = undefined;\n            }\n        }\n        this.destroy();\n    };\n    /**\n     * @private\n     */\n    BodyWidget.prototype.destroy = function () {\n        // if (this.sectionFormat) {\n        //     this.sectionFormat.destroy();\n        // }\n        this.sectionFormat = undefined;\n        this.page = undefined;\n        _super.prototype.destroy.call(this);\n    };\n    return BodyWidget;\n}(BlockContainer));\nexport { BodyWidget };\n/**\n * @private\n */\nvar HeaderFooterWidget = /** @class */ (function (_super) {\n    __extends(HeaderFooterWidget, _super);\n    function HeaderFooterWidget(type) {\n        var _this = _super.call(this) || this;\n        _this.headerFooterType = type;\n        return _this;\n    }\n    /**\n     * @private\n     */\n    HeaderFooterWidget.prototype.getTableCellWidget = function (point) {\n        return undefined;\n    };\n    /**\n     * @private\n     */\n    HeaderFooterWidget.prototype.equals = function (widget) {\n        // Todo: Need to work\n        return widget instanceof HeaderFooterWidget\n            && widget.containerWidget === this.containerWidget;\n    };\n    /**\n     * @private\n     */\n    HeaderFooterWidget.prototype.clone = function () {\n        var headerFooter = new HeaderFooterWidget(this.headerFooterType);\n        for (var i = 0; i < this.childWidgets.length; i++) {\n            var block = this.childWidgets[i].clone();\n            headerFooter.childWidgets.push(block);\n            block.index = i;\n            block.containerWidget = headerFooter;\n        }\n        headerFooter.x = this.x;\n        headerFooter.y = this.y;\n        headerFooter.height = 0;\n        headerFooter.width = 0;\n        return headerFooter;\n    };\n    /**\n     * @private\n     */\n    HeaderFooterWidget.prototype.destroyInternal = function (viewer) {\n        this.page = undefined;\n        _super.prototype.destroy.call(this);\n    };\n    return HeaderFooterWidget;\n}(BlockContainer));\nexport { HeaderFooterWidget };\n/**\n * @private\n */\nvar BlockWidget = /** @class */ (function (_super) {\n    __extends(BlockWidget, _super);\n    function BlockWidget() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    Object.defineProperty(BlockWidget.prototype, \"bodyWidget\", {\n        /**\n         * @private\n         */\n        get: function () {\n            var widget = this;\n            while (widget.containerWidget) {\n                if (widget.containerWidget instanceof BlockContainer) {\n                    return widget.containerWidget;\n                }\n                widget = widget.containerWidget;\n            }\n            return undefined;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(BlockWidget.prototype, \"leftIndent\", {\n        /**\n         * @private\n         */\n        get: function () {\n            var blockAdv = this;\n            if (blockAdv instanceof ParagraphWidget && blockAdv.paragraphFormat instanceof WParagraphFormat) {\n                return blockAdv.paragraphFormat.leftIndent;\n            }\n            else if (blockAdv instanceof TableWidget && blockAdv.tableFormat instanceof WTableFormat) {\n                return blockAdv.tableFormat.leftIndent;\n            }\n            return 0;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(BlockWidget.prototype, \"rightIndent\", {\n        /**\n         * @private\n         */\n        get: function () {\n            var blockAdv = this;\n            if (blockAdv instanceof ParagraphWidget && blockAdv.paragraphFormat instanceof WParagraphFormat) {\n                return blockAdv.paragraphFormat.rightIndent;\n            }\n            return 0;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(BlockWidget.prototype, \"isInsideTable\", {\n        /**\n         * @private\n         */\n        get: function () {\n            return this.containerWidget instanceof TableCellWidget;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(BlockWidget.prototype, \"isInHeaderFooter\", {\n        /**\n         * @private\n         */\n        get: function () {\n            return this.bodyWidget instanceof HeaderFooterWidget;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(BlockWidget.prototype, \"associatedCell\", {\n        /**\n         * @private\n         */\n        get: function () {\n            if (this.containerWidget instanceof TableCellWidget) {\n                return this.containerWidget;\n            }\n            return undefined;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    /**\n     * Check whether the paragraph contains only page break.\n     * @private\n     */\n    BlockWidget.prototype.isPageBreak = function () {\n        var isPageBreak = false;\n        if (this instanceof ParagraphWidget) {\n            var paragraph = this;\n            if (paragraph != null && paragraph.childWidgets.length === 1 &&\n                paragraph.firstChild.children.length === 1) {\n                var pageBreak = paragraph.firstChild.children[0];\n                isPageBreak = pageBreak.isPageBreak;\n            }\n        }\n        return isPageBreak;\n    };\n    /**\n     * @private\n     */\n    BlockWidget.prototype.getHierarchicalIndex = function (hierarchicalIndex) {\n        var node = this;\n        hierarchicalIndex = node.containerWidget.childWidgets.indexOf(node) + ';' + hierarchicalIndex;\n        if (!isNullOrUndefined(node.containerWidget)) {\n            if (node.containerWidget instanceof BlockWidget) {\n                return node.containerWidget.getHierarchicalIndex(hierarchicalIndex);\n            }\n            else if (node.containerWidget instanceof BlockContainer) {\n                hierarchicalIndex = node.containerWidget.getHierarchicalIndex(hierarchicalIndex);\n            }\n        }\n        return hierarchicalIndex;\n    };\n    /**\n     * @private\n     */\n    BlockWidget.prototype.getIndex = function () {\n        if (this instanceof ParagraphWidget || this instanceof TableWidget) {\n            return this.containerWidget.childWidgets.indexOf(this);\n        }\n        else if (this instanceof TableRowWidget) {\n            return this.ownerTable.childWidgets.indexOf(this);\n        }\n        else if (this instanceof TableCellWidget) {\n            return this.ownerRow.childWidgets.indexOf(this);\n        }\n        return 0;\n    };\n    /**\n     * @private\n     */\n    BlockWidget.prototype.getContainerWidth = function () {\n        if (this.isInsideTable) {\n            return this.associatedCell.cellFormat.cellWidth - (this.associatedCell.margin.left + this.associatedCell.margin.right);\n        }\n        else {\n            var bodyWidget = this.bodyWidget;\n            var sectionFormat = bodyWidget.sectionFormat;\n            return sectionFormat.pageWidth - (sectionFormat.leftMargin + sectionFormat.rightMargin);\n        }\n    };\n    return BlockWidget;\n}(Widget));\nexport { BlockWidget };\n/**\n * @private\n */\nvar ParagraphWidget = /** @class */ (function (_super) {\n    __extends(ParagraphWidget, _super);\n    /**\n     * Initialize the constructor of ParagraphWidget\n     */\n    function ParagraphWidget() {\n        var _this = _super.call(this) || this;\n        _this.paragraphFormat = new WParagraphFormat(_this);\n        _this.characterFormat = new WCharacterFormat(_this);\n        return _this;\n    }\n    Object.defineProperty(ParagraphWidget.prototype, \"isEndsWithPageBreak\", {\n        /**\n         * @private\n         */\n        get: function () {\n            if (this.childWidgets.length > 0) {\n                return this.lastChild.isEndsWithPageBreak;\n            }\n            return false;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    /**\n     * @private\n     */\n    ParagraphWidget.prototype.equals = function (widget) {\n        return widget instanceof ParagraphWidget && widget.paragraphFormat === this.paragraphFormat;\n    };\n    /**\n     * @private\n     */\n    ParagraphWidget.prototype.isEmpty = function () {\n        if (isNullOrUndefined(this.childWidgets) || this.childWidgets.length === 0) {\n            return true;\n        }\n        for (var j = 0; j < this.childWidgets.length; j++) {\n            var inlineElement = this.childWidgets[j];\n            for (var i = 0; i < inlineElement.children.length; i++) {\n                var inline = inlineElement.children[i];\n                if (inline.length === 0) {\n                    continue;\n                }\n                if (inline instanceof TextElementBox || inline instanceof ImageElementBox || inline instanceof BookmarkElementBox\n                    || (inline instanceof FieldElementBox && HelperMethods.isLinkedFieldCharacter(inline))) {\n                    return false;\n                }\n            }\n        }\n        return true;\n    };\n    /**\n     * @private\n     */\n    ParagraphWidget.prototype.getInline = function (offset, indexInInline) {\n        var inline = undefined;\n        var count = 0;\n        var isStarted = false;\n        var splittedWidget = this.getSplitWidgets();\n        for (var k = 0; k < splittedWidget.length; k++) {\n            var widget = splittedWidget[k];\n            for (var j = 0; j < widget.childWidgets.length; j++) {\n                var line = widget.childWidgets[j];\n                for (var i = 0; i < line.children.length; i++) {\n                    inline = line.children[i];\n                    if (inline instanceof ListTextElementBox) {\n                        continue;\n                    }\n                    if (!isStarted && (inline instanceof TextElementBox || inline instanceof ImageElementBox\n                        || inline instanceof BookmarkElementBox || inline instanceof FieldElementBox\n                        && HelperMethods.isLinkedFieldCharacter(inline))) {\n                        isStarted = true;\n                    }\n                    if (isStarted && offset <= count + inline.length) {\n                        indexInInline = (offset - count);\n                        return { 'element': inline, 'index': indexInInline };\n                    }\n                    count += inline.length;\n                }\n            }\n        }\n        if (offset > count) {\n            indexInInline = isNullOrUndefined(inline) ? offset : inline.length;\n        }\n        return { 'element': inline, 'index': indexInInline };\n    };\n    /**\n     * @private\n     */\n    ParagraphWidget.prototype.getLength = function () {\n        var length = 0;\n        for (var j = 0; j < this.childWidgets.length; j++) {\n            var line = this.childWidgets[j];\n            for (var i = 0; i < line.children.length; i++) {\n                var element = line.children[i];\n                if (element instanceof ListTextElementBox) {\n                    continue;\n                }\n                length += element.length;\n            }\n        }\n        return length;\n    };\n    /**\n     * @private\n     */\n    ParagraphWidget.prototype.getTableCellWidget = function (point) {\n        return undefined;\n    };\n    /**\n     * @private\n     */\n    ParagraphWidget.prototype.clone = function () {\n        var paragraph = new ParagraphWidget();\n        paragraph.paragraphFormat.copyFormat(this.paragraphFormat);\n        paragraph.characterFormat.copyFormat(this.characterFormat);\n        for (var i = 0; i < this.childWidgets.length; i++) {\n            var line = this.childWidgets[i];\n            var cloneLine = line.clone();\n            paragraph.childWidgets.push(cloneLine);\n            cloneLine.paragraph = paragraph;\n        }\n        paragraph.x = this.x;\n        paragraph.y = this.y;\n        paragraph.height = this.height;\n        paragraph.width = this.width;\n        return paragraph;\n    };\n    /**\n     * @private\n     */\n    ParagraphWidget.prototype.destroyInternal = function (viewer) {\n        var height = this.height;\n        if (!isNullOrUndefined(this.childWidgets)) {\n            for (var i = 0; i < this.childWidgets.length; i++) {\n                var widget = this.childWidgets[i];\n                widget.destroy();\n                if (this.childWidgets.length === 1 && isNullOrUndefined(this.childWidgets[0].children)) {\n                    this.childWidgets = undefined;\n                }\n                if (isNullOrUndefined(this.childWidgets)) {\n                    break;\n                }\n                i--;\n            }\n            this.childWidgets = undefined;\n        }\n        if (!isNullOrUndefined(this.containerWidget) && !isNullOrUndefined(this.containerWidget.childWidgets)\n            && this.containerWidget.childWidgets.indexOf(this) !== -1) {\n            this.containerWidget.childWidgets.splice(this.containerWidget.childWidgets.indexOf(this), 1);\n            this.containerWidget.height -= height;\n            // if ((isNullOrUndefined(this.containerWidget.childWidgets) || this.containerWidget.childWidgets.length === 0)\n            //     && this.containerWidget instanceof BodyWidget) {\n            //     // (this.containerWidget as BodyWidget).destroyInternal(viewer);\n            // }\n            this.containerWidget = undefined;\n        }\n        this.destroy();\n    };\n    /**\n     * @private\n     */\n    ParagraphWidget.prototype.destroy = function () {\n        // if (this.paragraphFormat) {\n        //     this.paragraphFormat.destroy();\n        // }\n        this.paragraphFormat = undefined;\n        // if (this.characterFormat) {\n        //     this.characterFormat.destroy();\n        // }\n        this.characterFormat = undefined;\n        _super.prototype.destroy.call(this);\n    };\n    return ParagraphWidget;\n}(BlockWidget));\nexport { ParagraphWidget };\n/**\n * @private\n */\nvar TableWidget = /** @class */ (function (_super) {\n    __extends(TableWidget, _super);\n    function TableWidget() {\n        var _this = _super.call(this) || this;\n        _this.flags = 0;\n        /**\n         * @private\n         */\n        _this.leftMargin = 0;\n        /**\n         * @private\n         */\n        _this.topMargin = 0;\n        /**\n         * @private\n         */\n        _this.rightMargin = 0;\n        /**\n         * @private\n         */\n        _this.bottomMargin = 0;\n        _this.margin = new Margin(_this.leftMargin, _this.topMargin, _this.rightMargin, _this.bottomMargin);\n        _this.leftBorderWidth = 0;\n        _this.rightBorderWidth = 0;\n        _this.topBorderWidth = 0;\n        _this.bottomBorderWidth = 0;\n        _this.tableFormat = new WTableFormat(_this);\n        _this.tableHolder = new WTableHolder();\n        _this.spannedRowCollection = new Dictionary();\n        return _this;\n    }\n    Object.defineProperty(TableWidget.prototype, \"isGridUpdated\", {\n        /**\n         * @private\n         */\n        get: function () {\n            return ((this.flags & 0x4) >> 2) !== 0;\n        },\n        /**\n         * @private\n         */\n        set: function (value) {\n            this.flags = ((this.flags & 0xFB) | ((value ? 1 : 0) << 2));\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(TableWidget.prototype, \"continueHeader\", {\n        /**\n         * @private\n         */\n        get: function () {\n            return ((this.flags & 0x2) >> 1) !== 0;\n        },\n        /**\n         * @private\n         */\n        set: function (value) {\n            this.flags = ((this.flags & 0xFD) | ((value ? 1 : 0) << 1));\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(TableWidget.prototype, \"header\", {\n        /**\n         * @private\n         */\n        get: function () {\n            return (this.flags & 0x1) !== 0;\n        },\n        /**\n         * @private\n         */\n        set: function (value) {\n            this.flags = ((this.flags & 0xFE) | (value ? 1 : 0));\n        },\n        enumerable: true,\n        configurable: true\n    });\n    /**\n     * @private\n     */\n    TableWidget.prototype.equals = function (widget) {\n        return widget instanceof TableWidget && widget.tableFormat === this.tableFormat;\n    };\n    /**\n     * @private\n     */\n    TableWidget.prototype.combineRows = function (viewer) {\n        for (var i = 0; i < this.childWidgets.length; i++) {\n            var row = this.childWidgets[i];\n            if (row.childWidgets.length === 0) {\n                row.destroy();\n                i--;\n            }\n            else {\n                row.combineCells(viewer);\n            }\n        }\n    };\n    /**\n     * @private\n     */\n    TableWidget.prototype.contains = function (tableCell) {\n        if (this.equals(tableCell.ownerTable)) {\n            return true;\n        }\n        while (tableCell.ownerTable.isInsideTable) {\n            if (this.equals(tableCell.ownerTable)) {\n                return true;\n            }\n            tableCell = tableCell.ownerTable.associatedCell;\n        }\n        return this.equals(tableCell.ownerTable);\n    };\n    /**\n     * @private\n     */\n    TableWidget.prototype.getOwnerWidth = function (isBasedOnViewer) {\n        var width = this.getContainerWidth();\n        // Left and right indents should be neglected.\n        width = width - this.leftIndent - this.rightIndent;\n        return width >= 0 ? width : 0;\n    };\n    TableWidget.prototype.getTableWidth = function () {\n        var width = 0;\n        for (var i = 0; i < this.childWidgets.length; i++) {\n            var rowWidth = 0;\n            var row = this.childWidgets[i];\n            for (var j = 0; j < row.childWidgets.length; j++) {\n                rowWidth += row.childWidgets[j].cellFormat.cellWidth;\n            }\n            if (width < rowWidth) {\n                width = rowWidth;\n            }\n        }\n        return width;\n    };\n    /**\n     * @private\n     */\n    TableWidget.prototype.getTableClientWidth = function (clientWidth) {\n        var tableWidth = clientWidth;\n        if (this.tableFormat.preferredWidthType === 'Point'\n            && this.tableFormat.preferredWidth > 0) {\n            tableWidth = this.tableFormat.preferredWidth;\n        }\n        else {\n            if (this.tableFormat.preferredWidthType === 'Percent'\n                && this.tableFormat.preferredWidth > 0) {\n                tableWidth = tableWidth * this.tableFormat.preferredWidth / 100;\n            }\n            else {\n                //By default, if Table preferred widthType is auto , width is set based on ClientWidth and type is set as 'Point'\n                this.tableFormat.preferredWidthType = 'Point';\n                this.tableFormat.preferredWidth = tableWidth;\n            }\n        }\n        return tableWidth;\n    };\n    /**\n     * @private\n     */\n    TableWidget.prototype.getCellWidth = function (preferredWidth, preferredWidthType, containerWidth, cell) {\n        var cellWidth = preferredWidth;\n        if (preferredWidthType === 'Percent') {\n            cellWidth = (preferredWidth * containerWidth) / 100;\n        }\n        else if (preferredWidthType === 'Point') {\n            cellWidth = preferredWidth;\n        }\n        else if (!isNullOrUndefined(cell)) {\n            cellWidth = cell.getMinimumPreferredWidth();\n        }\n        return cellWidth;\n    };\n    /**\n     * @private\n     */\n    TableWidget.prototype.fitCellsToClientArea = function (clientWidth) {\n        var tableWidth = this.getTableWidth();\n        var factor = clientWidth / tableWidth;\n        for (var i = 0; i < this.childWidgets.length; i++) {\n            var row = this.childWidgets[i];\n            row.rowFormat.gridAfterWidth *= factor;\n            row.rowFormat.gridBeforeWidth *= factor;\n            for (var j = 0; j < row.childWidgets.length; j++) {\n                row.childWidgets[j].cellFormat.cellWidth *= factor;\n            }\n        }\n    };\n    /**\n     * @private\n     */\n    TableWidget.prototype.getTableCellWidget = function (point) {\n        var tableCellWidget = undefined;\n        for (var i = 0; i < this.childWidgets.length; i++) {\n            if (this.childWidgets[i].y <= point.y\n                && (this.childWidgets[i].y + this.childWidgets[i].height) >= point.y) {\n                tableCellWidget = this.childWidgets[i].getTableCellWidget(point);\n                break;\n            }\n        }\n        return tableCellWidget;\n    };\n    /**\n     * @private\n     */\n    //tslint:disable: max-func-body-length\n    TableWidget.prototype.calculateGrid = function () {\n        var tempGrid = [];\n        var spannedCells = [];\n        var containerWidth = this.getOwnerWidth(true);\n        var tableWidth = this.getTableClientWidth(containerWidth);\n        this.tableCellInfo = new Dictionary();\n        for (var i = 0; i < this.childWidgets.length; i++) {\n            var row = this.childWidgets[i];\n            var rowCellInfo = new Dictionary();\n            var rowFormat = row.rowFormat;\n            var cellWidth = 0;\n            var columnSpan = row.rowFormat.gridBefore;\n            var currOffset = 0;\n            if (tempGrid.indexOf(currOffset) < 0) {\n                tempGrid.push(currOffset);\n            }\n            //Converts the row grid before width from point to twips point by 15 factor.\n            cellWidth = this.getCellWidth(rowFormat.gridBeforeWidth, rowFormat.gridBeforeWidthType, tableWidth, null);\n            currOffset += cellWidth;\n            var startOffset = Math.round(currOffset);\n            if (tempGrid.indexOf(startOffset) < 0) {\n                tempGrid.push(startOffset);\n            }\n            for (var j = 0; j < row.childWidgets.length; j++) {\n                var cell = row.childWidgets[j];\n                for (var k = 0; k < spannedCells.length; k++) {\n                    if (spannedCells[k].columnIndex < columnSpan) {\n                        continue;\n                    }\n                    var rowSpan = spannedCells[k].cellFormat.rowSpan;\n                    var removeSpannedCell = true;\n                    if (spannedCells[k].columnIndex > columnSpan) {\n                        {\n                            removeSpannedCell = false;\n                            // If the cell is the last cell in the row and the row has grid after value..\n                            if (j === row.childWidgets.length - 1 && row.rowFormat.gridAfter > 0) {\n                                // tslint:disable-next-line:max-line-length\n                                cellWidth = this.getCellWidth(spannedCells[k].cellFormat.preferredWidth, spannedCells[k].cellFormat.preferredWidthType, tableWidth, null);\n                                currOffset += cellWidth;\n                            }\n                        }\n                    }\n                    else {\n                        // If the table gird alone calculted then column index of the rowspanned cell will be directly taken. \n                        // If the gird calculation is done from the UI level opearations such as resizing then table holder \n                        // will have the columns at that time we can get the column index from the table holder.\n                        //Converts the cell width from point to twips point by 15 factor.\n                        // tslint:disable-next-line:max-line-length\n                        cellWidth = this.getCellWidth(spannedCells[k].cellFormat.preferredWidth, spannedCells[k].cellFormat.preferredWidthType, tableWidth, null);\n                        currOffset += cellWidth;\n                        columnSpan = spannedCells[k].columnIndex + spannedCells[k].cellFormat.columnSpan;\n                    }\n                    if (!removeSpannedCell && j === row.childWidgets.length - 1) {\n                        removeSpannedCell = true;\n                    }\n                    if (removeSpannedCell && i - spannedCells[k].ownerRow.rowIndex === rowSpan - 1) {\n                        spannedCells.splice(k, 1);\n                        k--;\n                    }\n                }\n                // At the start of each row, we will process the row spanned cells to get the start column index.\n                // To calculate grid properly, we need the items in the spanned cells collection in the order of their column index\n                if (cell.cellFormat.rowSpan > 1) {\n                    if (spannedCells.length === 0 || spannedCells[spannedCells.length - 1].columnIndex <= columnSpan) {\n                        spannedCells.push(cell);\n                    }\n                    else {\n                        for (var m = spannedCells.length; m > 0; m--) {\n                            if (spannedCells[m - 1].columnIndex > columnSpan) {\n                                spannedCells.splice(m - 1, 0, cell);\n                            }\n                        }\n                    }\n                }\n                // Add start offset of each cell based on its index\n                if (!rowCellInfo.containsKey(cell.cellIndex)) {\n                    rowCellInfo.add(cell.cellIndex, Math.round(currOffset - startOffset));\n                }\n                columnSpan += cell.cellFormat.columnSpan;\n                //Converts the cell width from pixel to twips point by 15 factor.\n                cellWidth = this.getCellWidth(cell.cellFormat.preferredWidth, cell.cellFormat.preferredWidthType, tableWidth, null);\n                currOffset += cellWidth;\n                var offset = Math.round(currOffset);\n                if (tempGrid.indexOf(offset) < 0) {\n                    tempGrid.push(offset);\n                }\n                if (j === row.childWidgets.length - 1 && rowFormat.gridAfter > 0) {\n                    cellWidth = this.getCellWidth(rowFormat.gridAfterWidth, 'Point', tableWidth, null);\n                    currOffset += cellWidth;\n                    if (tempGrid.indexOf(Math.round(currOffset)) < 0) {\n                        tempGrid.push(Math.round(currOffset));\n                    }\n                    columnSpan += rowFormat.gridAfter;\n                }\n                // Add rowindex and its cells info for each row\n                if (!this.tableCellInfo.containsKey(row.rowIndex)) {\n                    this.tableCellInfo.add(row.rowIndex, rowCellInfo);\n                }\n            }\n        }\n        tempGrid.sort(function (a, b) { return a - b; });\n        if (tempGrid.length - 1 !== this.tableHolder.columns.length) {\n            this.updateColumnSpans(tempGrid, tableWidth);\n        }\n        this.tableCellInfo.clear();\n        this.tableCellInfo = undefined;\n    };\n    TableWidget.prototype.updateColumnSpans = function (tempGrid, containerWidth) {\n        for (var i = 0; i < this.childWidgets.length; i++) {\n            var row = this.childWidgets[i];\n            if (row.rowFormat.gridBeforeWidth >= 0) {\n                row.rowFormat.gridBefore = row.getGridCount(tempGrid, undefined, -1, containerWidth);\n            }\n            for (var j = 0; j < row.childWidgets.length; j++) {\n                var cell = row.childWidgets[j];\n                var columnSpan = row.getGridCount(tempGrid, cell, cell.getIndex(), containerWidth);\n                if (columnSpan > 0 && cell.cellFormat.columnSpan !== columnSpan) {\n                    cell.cellFormat.columnSpan = columnSpan;\n                }\n            }\n            if (row.rowFormat.gridAfterWidth >= 0) {\n                row.rowFormat.gridAfter = row.getGridCount(tempGrid, undefined, row.childWidgets.length, containerWidth);\n            }\n        }\n    };\n    /**\n     * @private\n     */\n    TableWidget.prototype.buildTableColumns = function () {\n        if (this.isGridUpdated) {\n            return;\n        }\n        // Clear existing columns in order to start creating columns freshly.\n        this.tableHolder.resetColumns();\n        var containerWidth = 0;\n        var tableWidth = 0;\n        var rowSpannedCells = [];\n        var isAutoWidth = this.tableFormat.preferredWidthType === 'Auto';\n        // For continuous layout, window width should be considered. \n        // If preferred width exceeds this limit, it can take upto maximum of 2112 pixels (1584 points will be assigned by Microsoft Word).\n        containerWidth = this.getOwnerWidth(true);\n        tableWidth = this.getTableClientWidth(containerWidth);\n        for (var i = 0; i < this.childWidgets.length; i++) {\n            var row = this.childWidgets[i];\n            var rowFormat = row.rowFormat;\n            var columnSpan = 0;\n            var cellWidth = 0;\n            var offset = 0;\n            if (rowFormat.gridBefore > 0) {\n                cellWidth = this.getCellWidth(rowFormat.gridBeforeWidth, row.rowFormat.gridAfterWidthType, tableWidth, null);\n                this.tableHolder.addColumns(columnSpan, columnSpan = rowFormat.gridBefore, cellWidth, cellWidth, offset = cellWidth);\n            }\n            for (var j = 0; j < row.childWidgets.length; j++) {\n                var cell = row.childWidgets[j];\n                if (rowSpannedCells.length === 0) {\n                    cell.columnIndex = columnSpan;\n                }\n                for (var k = 0; k < rowSpannedCells.length; k++) {\n                    var rowSpannedCell = rowSpannedCells[k];\n                    if (rowSpannedCell.columnIndex < columnSpan) {\n                        cell.columnIndex = columnSpan;\n                        continue;\n                    }\n                    var rowSpan = 1;\n                    var removeSpannedCell = true;\n                    rowSpan = rowSpannedCell.cellFormat.rowSpan;\n                    if (rowSpannedCell.columnIndex > columnSpan) {\n                        cell.columnIndex = columnSpan;\n                        removeSpannedCell = false;\n                    }\n                    else {\n                        // tslint:disable-next-line:max-line-length\n                        cellWidth = this.getCellWidth(rowSpannedCell.cellFormat.preferredWidth, rowSpannedCell.cellFormat.preferredWidthType, tableWidth, rowSpannedCell);\n                        var minWidth_1 = rowSpannedCell.getMinimumPreferredWidth();\n                        // If the table gird alone calculted then column index of the rowspanned cell will be directly taken. \n                        // tslint:disable-next-line:max-line-length\n                        // If the gird calculation is done from the UI level opearations such as resizing then table holder will have the columns at that time we can get the column index from the table holder.\n                        // tslint:disable-next-line:max-line-length\n                        if (this.tableHolder.columns.length > 0) {\n                            this.tableHolder.addColumns(columnSpan, columnSpan = this.tableHolder.columns.indexOf(rowSpannedCell.ownerColumn) + rowSpannedCell.cellFormat.columnSpan, cellWidth, minWidth_1, offset += cellWidth);\n                            cell.columnIndex = columnSpan;\n                        }\n                        else {\n                            // tslint:disable-next-line:max-line-length\n                            this.tableHolder.addColumns(columnSpan, columnSpan = rowSpannedCell.columnIndex + rowSpannedCell.cellFormat.columnSpan, cellWidth, minWidth_1, offset += cellWidth);\n                            cell.columnIndex = columnSpan;\n                        }\n                    }\n                    if (!removeSpannedCell && j === row.childWidgets.length - 1) {\n                        removeSpannedCell = true;\n                    }\n                    if (removeSpannedCell && i - rowSpannedCell.ownerRow.rowIndex === rowSpan - 1) {\n                        rowSpannedCells.splice(k, 1);\n                        k--;\n                    }\n                }\n                // At the start of each row, we will process the row spanned cells to get the start column index.\n                // To calculate grid properly, we need the items in the spanned cells collection in the order of their column index\n                if (cell.cellFormat.rowSpan > 1) {\n                    if (rowSpannedCells.length === 0 || rowSpannedCells[rowSpannedCells.length - 1].columnIndex <= columnSpan) {\n                        rowSpannedCells.push(cell);\n                    }\n                    else {\n                        for (var m = rowSpannedCells.length; m > 0; m--) {\n                            if (rowSpannedCells[m - 1].columnIndex > columnSpan) {\n                                rowSpannedCells.splice(m - 1, 0, cell);\n                            }\n                        }\n                    }\n                }\n                cellWidth = this.getCellWidth(cell.cellFormat.preferredWidth, cell.cellFormat.preferredWidthType, tableWidth, cell);\n                var minWidth = cell.getMinimumPreferredWidth();\n                this.tableHolder.addColumns(columnSpan, columnSpan += cell.cellFormat.columnSpan, cellWidth, minWidth, offset += cellWidth);\n                if (j === row.childWidgets.length - 1 && rowFormat.gridAfterWidth > 0) {\n                    cellWidth = this.getCellWidth(rowFormat.gridAfterWidth, 'Point', tableWidth, null);\n                    this.tableHolder.addColumns(columnSpan, columnSpan += rowFormat.gridAfter, cellWidth, cellWidth, offset += cellWidth);\n                }\n            }\n        }\n        this.tableHolder.validateColumnWidths();\n        // Fits the column width based on preferred width. i.e. Fixed layout.\n        this.tableHolder.fitColumns(containerWidth, tableWidth, isAutoWidth);\n        //Sets the width to cells\n        this.setWidthToCells(tableWidth, isAutoWidth);\n    };\n    /**\n     * @private\n     */\n    TableWidget.prototype.setWidthToCells = function (tableWidth, isAutoWidth) {\n        for (var i = 0; i < this.childWidgets.length; i++) {\n            var rw = this.childWidgets[i];\n            var rowFormat = rw.rowFormat;\n            if (rowFormat.gridBefore > 0) {\n                rowFormat.beforeWidth = this.tableHolder.getCellWidth(0, rowFormat.gridBefore, tableWidth, isAutoWidth);\n            }\n            for (var j = 0; j < rw.childWidgets.length; j++) {\n                var cell = rw.childWidgets[j];\n                // tslint:disable-next-line:max-line-length\n                cell.cellFormat.cellWidth = this.tableHolder.getCellWidth(cell.columnIndex, cell.cellFormat.columnSpan, tableWidth, isAutoWidth);\n                //By default, if cell preferred widthType is auto , width set based on table width and type is changed to 'Point'\n                if (cell.cellFormat.preferredWidthType !== 'Percent') {\n                    cell.cellFormat.preferredWidth = cell.cellFormat.cellWidth;\n                    cell.cellFormat.preferredWidthType = 'Point';\n                }\n            }\n            if (rowFormat.gridAfter > 0) {\n                rowFormat.afterWidth = this.tableHolder.getCellWidth(0, rowFormat.gridAfter, tableWidth, isAutoWidth);\n            }\n        }\n    };\n    /**\n     * @private\n     */\n    TableWidget.prototype.getMaxRowWidth = function (clientWidth) {\n        var width = 0;\n        for (var i = 0; i < this.childWidgets.length; i++) {\n            var row = this.childWidgets[i];\n            var rowWidth = 0;\n            for (var j = 0; j < row.childWidgets.length; j++) {\n                var cell = row.childWidgets[j];\n                rowWidth += this.getCellWidth(cell.cellFormat.preferredWidth, cell.cellFormat.preferredWidthType, clientWidth, cell);\n            }\n            if (width < rowWidth) {\n                width = rowWidth;\n            }\n        }\n        return width;\n    };\n    /**\n     * @private\n     */\n    TableWidget.prototype.updateWidth = function (dragValue) {\n        var totalPreferredWidth = this.tableHolder.getTotalWidth();\n        var containerWidth = this.getTableClientWidth(this.getOwnerWidth(true));\n        if (containerWidth <= totalPreferredWidth) {\n            if (this.tableFormat.preferredWidthType === 'Auto') {\n                this.tableFormat.preferredWidthType = 'Point';\n            }\n        }\n        if (this.tableFormat.preferredWidthType !== 'Auto') {\n            if (this.tableFormat.preferredWidthType === 'Point') {\n                this.tableFormat.preferredWidth = this.getMaxRowWidth(containerWidth);\n            }\n            // else\n            // {   //ToDo:Need to anzlyze more the Percentage calculation for table width.\n            //     let value:number = ConvertPixelToPercent(GetMaxRowWidth(containerWidth));\n            //     this.tableFormat.preferredWidth = value;\n            // }\n        }\n    };\n    /**\n     * @private\n     */\n    TableWidget.prototype.convertPointToPercent = function (tablePreferredWidth, ownerWidth) {\n        var value = 0;\n        value = (tablePreferredWidth / ownerWidth) * 100;\n        value = Math.round(value);\n        return value < 100 ? value : 100; // The value should be lesser than or equal to 100%;\n    };\n    /**\n     * @private\n     */\n    TableWidget.prototype.clone = function () {\n        var table = new TableWidget();\n        table.tableHolder = this.tableHolder.clone();\n        table.tableFormat.copyFormat(this.tableFormat);\n        for (var i = 0; i < this.childWidgets.length; i++) {\n            var row = this.childWidgets[i].clone();\n            table.childWidgets.push(row);\n            row.containerWidget = table;\n            row.index = i;\n        }\n        table.x = this.x;\n        table.y = this.y;\n        table.height = this.height;\n        table.width = this.width;\n        table.containerWidget = this.containerWidget;\n        return table;\n    };\n    /**\n     * @private\n     */\n    TableWidget.getTableOf = function (node) {\n        if (node instanceof WBorders) {\n            var row = TableRowWidget.getRowOf(node);\n            if (!isNullOrUndefined(row)) {\n                return row.ownerTable;\n            }\n            else if (node.ownerBase instanceof WTableFormat && node.ownerBase.ownerBase instanceof TableWidget) {\n                return node.ownerBase.ownerBase;\n            }\n            else {\n                return undefined;\n            }\n        }\n        return undefined;\n    };\n    /**\n     * @private\n     */\n    TableWidget.prototype.fitChildToClientArea = function () {\n        var clientWidth = this.getContainerWidth();\n        if (Math.round(clientWidth) < Math.round(this.getTableWidth())) {\n            this.fitCellsToClientArea(clientWidth);\n        }\n        for (var i = 0; i < this.childWidgets.length; i++) {\n            var row = this.childWidgets[i];\n            for (var j = 0; j < row.childWidgets.length; j++) {\n                var cell = row.childWidgets[j];\n                for (var k = 0; k < cell.childWidgets.length; k++) {\n                    if (cell.childWidgets[k] instanceof TableWidget) {\n                        cell.childWidgets[k].fitChildToClientArea();\n                    }\n                }\n            }\n        }\n    };\n    /**\n     * @private\n     */\n    TableWidget.prototype.getColumnCellsForSelection = function (startCell, endCell) {\n        var cells = [];\n        var start = startCell.columnIndex;\n        var end = endCell.columnIndex + endCell.cellFormat.columnSpan;\n        for (var i = 0; i < this.childWidgets.length; i++) {\n            var row = this.childWidgets[i];\n            for (var j = 0; j < row.childWidgets.length; j++) {\n                var cell = row.childWidgets[j];\n                var columnIndex = cell.columnIndex;\n                var columnSpan = cell.cellFormat.columnSpan;\n                if ((columnIndex + columnSpan > start && columnIndex + columnSpan < end) || (columnIndex > start && columnIndex < end)) {\n                    if (cells.indexOf(cell) < 0) {\n                        cells.push(cell);\n                    }\n                }\n                else if ((columnIndex > start && columnIndex < end && columnIndex + columnSpan < end)\n                    || (columnIndex < start && columnIndex + columnSpan > end)) {\n                    if (cells.indexOf(cell) < 0) {\n                        cells.push(cell);\n                    }\n                }\n                else if (columnIndex === start || columnIndex + columnSpan === end) {\n                    if (cells.indexOf(cell) < 0) {\n                        cells.push(cell);\n                    }\n                }\n            }\n        }\n        return cells;\n    };\n    /**\n     * Splits width equally for all the cells.\n     * @param tableClientWidth\n     * @private\n     */\n    TableWidget.prototype.splitWidthToTableCells = function (tableClientWidth) {\n        for (var row = 0; row < this.childWidgets.length; row++) {\n            this.childWidgets[row].splitWidthToRowCells(tableClientWidth);\n        }\n    };\n    /**\n     * @private\n     */\n    TableWidget.prototype.insertTableRowsInternal = function (tableRows, startIndex) {\n        for (var i = 0; i < tableRows.length; i++) {\n            var row = tableRows.splice(i, 1)[0];\n            row.containerWidget = this;\n            this.childWidgets.splice(startIndex, 0, row);\n            i--;\n        }\n        this.updateRowIndex(startIndex);\n        this.isGridUpdated = false;\n        this.buildTableColumns();\n        this.isGridUpdated = true;\n    };\n    /**\n     * @private\n     */\n    TableWidget.prototype.updateRowIndex = function (startIndex) {\n        for (var i = startIndex; i < this.childWidgets.length; i++) {\n            var row = this.childWidgets[i];\n            row.index = i;\n            for (var j = 0; j < row.childWidgets.length; j++) {\n                row.childWidgets[j].index = j;\n                row.childWidgets[j].rowIndex = row.rowIndex;\n            }\n            startIndex++;\n        }\n    };\n    /**\n     * @private\n     */\n    TableWidget.prototype.getCellStartOffset = function (cell) {\n        var offset = 0;\n        if (cell && this.tableCellInfo) {\n            if (this.tableCellInfo.containsKey(cell.ownerRow.rowIndex)) {\n                var rowCellInfo = this.tableCellInfo.get(cell.ownerRow.rowIndex);\n                if (rowCellInfo.containsKey(cell.cellIndex)) {\n                    offset = rowCellInfo.get(cell.cellIndex);\n                }\n            }\n        }\n        return offset;\n    };\n    /**\n     * @private\n     */\n    TableWidget.prototype.destroyInternal = function (viewer) {\n        var height = this.height;\n        if (!isNullOrUndefined(this.childWidgets)) {\n            for (var j = 0; j < this.childWidgets.length; j++) {\n                var widget = undefined;\n                var childWidget = this.childWidgets[j];\n                widget = childWidget;\n                if (!isNullOrUndefined(widget)) {\n                    widget.destroyInternal(viewer);\n                }\n                if (isNullOrUndefined(this.childWidgets)) {\n                    break;\n                }\n                j--;\n            }\n            this.childWidgets = undefined;\n        }\n        if (!isNullOrUndefined(this.containerWidget)) {\n            if (!isNullOrUndefined(this.containerWidget.childWidgets)) {\n                if (this.containerWidget.childWidgets.indexOf(this) !== -1) {\n                    this.containerWidget.childWidgets.splice(this.containerWidget.childWidgets.indexOf(this), 1);\n                }\n                this.containerWidget.height -= height;\n                // if ((isNullOrUndefined(this.containerWidget.childWidgets) || this.containerWidget.childWidgets.length === 0)\n                //     && this.containerWidget instanceof BodyWidget) {\n                //     // (this.containerWidget as BodyWidget).destroyInternal(viewer);\n                // }\n            }\n            this.containerWidget = undefined;\n        }\n        this.destroy();\n    };\n    /**\n     * @private\n     */\n    TableWidget.prototype.destroy = function () {\n        // if (this.tableFormat) {\n        //     this.tableFormat.destroy();\n        // }\n        this.tableFormat = undefined;\n        // if (this.spannedRowCollection) {\n        //     this.spannedRowCollection.destroy();\n        // }\n        this.spannedRowCollection = undefined;\n        this.tableGrids = [];\n        this.tableGrids = undefined;\n        // if (this.tableHolder) {\n        //     this.tableHolder.destroy();\n        // }\n        this.tableHolder = undefined;\n        this.flags = undefined;\n        this.leftMargin = undefined;\n        this.topMargin = undefined;\n        this.rightMargin = undefined;\n        this.bottomMargin = undefined;\n        this.headerHeight = undefined;\n        this.description = undefined;\n        this.title = undefined;\n        _super.prototype.destroy.call(this);\n    };\n    return TableWidget;\n}(BlockWidget));\nexport { TableWidget };\n/**\n * @private\n */\nvar TableRowWidget = /** @class */ (function (_super) {\n    __extends(TableRowWidget, _super);\n    function TableRowWidget() {\n        var _this = _super.call(this) || this;\n        /**\n         * @private\n         */\n        _this.spannedRowCollection = [];\n        _this.topBorderWidth = 0;\n        _this.bottomBorderWidth = 0;\n        _this.rowFormat = new WRowFormat(_this);\n        return _this;\n    }\n    Object.defineProperty(TableRowWidget.prototype, \"rowIndex\", {\n        /**\n         * @private\n         */\n        get: function () {\n            if (this.containerWidget) {\n                return this.containerWidget.childWidgets.indexOf(this);\n            }\n            return -1;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(TableRowWidget.prototype, \"ownerTable\", {\n        /**\n         * @private\n         */\n        get: function () {\n            if (this.containerWidget instanceof TableWidget) {\n                return this.containerWidget;\n            }\n            return undefined;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(TableRowWidget.prototype, \"nextRow\", {\n        /**\n         * @private\n         */\n        get: function () {\n            var index = this.indexInOwner;\n            if (index > -1 && index < this.ownerTable.childWidgets.length - 1) {\n                return this.ownerTable.childWidgets[index + 1];\n            }\n            return undefined;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    /**\n     * @private\n     */\n    TableRowWidget.prototype.equals = function (widget) {\n        return widget instanceof TableRowWidget && widget.rowFormat === this.rowFormat;\n    };\n    /**\n     * @private\n     */\n    TableRowWidget.prototype.combineCells = function (viewer) {\n        for (var i = 0; i < this.childWidgets.length; i++) {\n            var cell = this.childWidgets[i];\n            cell.combineWidget(viewer);\n            if (cell.cellFormat.rowSpan === 1) {\n                var cellHeight = cell.height + cell.margin.top + cell.margin.bottom;\n                if ((this.height - this.ownerTable.tableFormat.cellSpacing) < cell.height) {\n                    this.height = this.ownerTable.tableFormat.cellSpacing + cell.height;\n                }\n            }\n        }\n    };\n    /**\n     * @private\n     */\n    TableRowWidget.getRowOf = function (node) {\n        if (node instanceof WBorders) {\n            var cell = TableCellWidget.getCellOf(node);\n            if (!isNullOrUndefined(cell)) {\n                return cell.ownerRow;\n            }\n            else if (node.ownerBase instanceof WRowFormat && node.ownerBase.ownerBase instanceof TableRowWidget) {\n                return node.ownerBase.ownerBase;\n            }\n            else {\n                return undefined;\n            }\n        }\n        return undefined;\n    };\n    /**\n     * @private\n     */\n    TableRowWidget.prototype.getCell = function (rowIndex, cellIndex) {\n        for (var i = 0; i < this.childWidgets.length; i++) {\n            var cell = this.childWidgets[i];\n            if (cell.rowIndex === rowIndex && cell.index === cellIndex) {\n                return cell;\n            }\n        }\n        return undefined;\n    };\n    /**\n     * @private\n     */\n    TableRowWidget.prototype.splitWidthToRowCells = function (tableClientWidth) {\n        var cells = this.childWidgets;\n        var cellWidth = tableClientWidth / cells.length;\n        for (var cell = 0; cell < cells.length; cell++) {\n            cells[cell].cellFormat.preferredWidth = cellWidth;\n        }\n    };\n    /**\n     * @private\n     */\n    TableRowWidget.prototype.getGridCount = function (tableGrid, cell, index, containerWidth) {\n        var prevOffset = 0;\n        var width = 0;\n        var ownerTable = this.ownerTable;\n        var rowFormat = this.rowFormat;\n        if (index === -1) {\n            width = ownerTable.getCellWidth(rowFormat.gridBeforeWidth, rowFormat.gridBeforeWidthType, containerWidth, null);\n        }\n        else {\n            prevOffset += ownerTable.getCellWidth(rowFormat.gridBeforeWidth, rowFormat.gridBeforeWidthType, containerWidth, null);\n            if (index >= 0) {\n                prevOffset += ownerTable.getCellStartOffset(cell);\n            }\n            if (index < this.childWidgets.length) {\n                width = ownerTable.getCellWidth(cell.cellFormat.preferredWidth, cell.cellFormat.preferredWidthType, containerWidth, null);\n            }\n            else {\n                width = ownerTable.getCellWidth(rowFormat.gridAfterWidth, rowFormat.gridAfterWidthType, containerWidth, null);\n            }\n        }\n        var gridStartIndex = this.getOffsetIndex(tableGrid, prevOffset);\n        var gridEndIndex = this.getOffsetIndex(tableGrid, prevOffset + width);\n        return gridEndIndex - gridStartIndex;\n    };\n    TableRowWidget.prototype.getOffsetIndex = function (tableGrid, offset) {\n        offset = Math.round(offset);\n        var index = 0;\n        if (tableGrid.indexOf(offset) >= 0) {\n            index = tableGrid.indexOf(offset);\n        }\n        else {\n            for (var i = 0; i < tableGrid.length; i++) {\n                if (tableGrid[i] > offset) {\n                    return i;\n                }\n            }\n            index = tableGrid.length - 1;\n        }\n        return index;\n    };\n    TableRowWidget.prototype.getCellOffset = function (index, containerWidth) {\n        var prevOffset = 0;\n        var ownerTable = this.ownerTable;\n        for (var i = 0; i < this.childWidgets.length; i++) {\n            var cellFormat = this.childWidgets[i].cellFormat;\n            if (i === index) {\n                break;\n            }\n            prevOffset += ownerTable.getCellWidth(cellFormat.preferredWidth, cellFormat.preferredWidthType, containerWidth, null);\n        }\n        return prevOffset;\n    };\n    /**\n     * @private\n     */\n    TableRowWidget.prototype.updateRowBySpannedCells = function () {\n        var rowSpannedCells = this.getPreviousRowSpannedCells();\n        var currentRowIndex = this.rowIndex;\n        for (var i = 0; i < rowSpannedCells.length; i++) {\n            var spannedCell = rowSpannedCells[i];\n            var rowSpanEnd = spannedCell.ownerRow.rowIndex + spannedCell.cellFormat.rowSpan - 1;\n            // If current row is row span end or includes spanned cells. then, decrease the rowspan\n            if (rowSpanEnd >= currentRowIndex) {\n                spannedCell.cellFormat.rowSpan -= 1;\n            }\n        }\n    };\n    /**\n     * @private\n     */\n    TableRowWidget.prototype.getPreviousRowSpannedCells = function (include) {\n        var rowSpannedCells = [];\n        var row = include ? this : this.previousWidget;\n        while (!isNullOrUndefined(row)) {\n            for (var i = 0; i < row.childWidgets.length; i++) {\n                var cell = row.childWidgets[i];\n                if (cell.cellFormat.rowSpan > 1) {\n                    rowSpannedCells.splice(0, 0, cell);\n                }\n            }\n            row = row.previousWidget;\n        }\n        return rowSpannedCells;\n    };\n    /**\n     * @private\n     */\n    TableRowWidget.prototype.getTableCellWidget = function (point) {\n        for (var i = 0; i < this.childWidgets.length; i++) {\n            var x = Math.round(this.childWidgets[i].x);\n            if (x - this.childWidgets[i].margin.left - 1 <= point.x\n                && (x + this.childWidgets[i].width) >= point.x) {\n                return this.childWidgets[i];\n            }\n            else if (i === this.childWidgets.length - 1\n                && (this.childWidgets[i].x + this.childWidgets[i].width) + 1 <= point.x) {\n                return this.childWidgets[i];\n            }\n        }\n        var cellWidget = undefined;\n        if (this.childWidgets.length > 0) {\n            if (this.childWidgets[0].x <= point.x) {\n                cellWidget = this.childWidgets[this.childWidgets.length - 1].getTableCellWidget(point);\n            }\n            else {\n                cellWidget = this.childWidgets[0].getTableCellWidget(point);\n            }\n        }\n        return cellWidget;\n    };\n    /**\n     * @private\n     */\n    TableRowWidget.prototype.destroyInternal = function (viewer) {\n        var height = this.height;\n        if (!isNullOrUndefined(this.childWidgets)) {\n            for (var i = 0; i < this.childWidgets.length; i++) {\n                var widget = this.childWidgets[i];\n                widget.destroyInternal(viewer);\n                if (isNullOrUndefined(this.childWidgets)) {\n                    break;\n                }\n                i--;\n            }\n            this.childWidgets = undefined;\n        }\n        if (!isNullOrUndefined(this.containerWidget)) {\n            if (!isNullOrUndefined(this.containerWidget.childWidgets)) {\n                this.containerWidget.childWidgets.splice(this.containerWidget.childWidgets.indexOf(this), 1);\n                if ((isNullOrUndefined(this.containerWidget.childWidgets) || this.containerWidget.childWidgets.length === 0)\n                    && this.containerWidget instanceof TableWidget) {\n                    this.containerWidget.destroyInternal(viewer);\n                }\n                else if (this.containerWidget.containerWidget instanceof BodyWidget) {\n                    this.containerWidget.containerWidget.height -= height;\n                }\n                this.containerWidget.height -= height;\n            }\n        }\n        this.destroy();\n    };\n    /**\n     * @private\n     */\n    TableRowWidget.prototype.clone = function () {\n        var row = new TableRowWidget();\n        row.rowFormat.copyFormat(this.rowFormat);\n        row.topBorderWidth = this.topBorderWidth;\n        row.bottomBorderWidth = this.bottomBorderWidth;\n        for (var i = 0; i < this.childWidgets.length; i++) {\n            var cell = this.childWidgets[i].clone();\n            row.childWidgets.push(cell);\n            cell.containerWidget = row;\n            cell.index = i;\n            cell.rowIndex = this.rowIndex;\n        }\n        row.x = this.x;\n        row.y = this.y;\n        row.height = this.height;\n        row.width = this.width;\n        return row;\n    };\n    /**\n     * @private\n     */\n    TableRowWidget.prototype.destroy = function () {\n        // if (this.rowFormat) {\n        //     this.rowFormat.destroy();\n        // }\n        this.rowFormat = undefined;\n        this.rowFormat = undefined;\n        this.spannedRowCollection = [];\n        this.spannedRowCollection = undefined;\n        this.topBorderWidth = undefined;\n        this.bottomBorderWidth = undefined;\n        _super.prototype.destroy.call(this);\n    };\n    return TableRowWidget;\n}(BlockWidget));\nexport { TableRowWidget };\n/**\n * @private\n */\nvar TableCellWidget = /** @class */ (function (_super) {\n    __extends(TableCellWidget, _super);\n    function TableCellWidget() {\n        var _this = _super.call(this) || this;\n        /**\n         * @private\n         */\n        _this.rowIndex = -1;\n        _this.margin = new Margin(_this.leftMargin, _this.topMargin, _this.rightMargin, _this.bottomMargin);\n        _this.leftBorderWidth = 0;\n        _this.rightBorderWidth = 0;\n        _this.cellFormat = new WCellFormat(_this);\n        return _this;\n    }\n    Object.defineProperty(TableCellWidget.prototype, \"ownerColumn\", {\n        /**\n         * @private\n         */\n        get: function () {\n            return this.ownerTable.tableHolder.columns[this.columnIndex];\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(TableCellWidget.prototype, \"leftMargin\", {\n        /**\n         * @private\n         */\n        get: function () {\n            if (this.cellFormat && this.cellFormat.containsMargins()) {\n                return this.cellFormat.leftMargin;\n            }\n            else if (!isNullOrUndefined(this.ownerTable) && !isNullOrUndefined(this.ownerTable.tableFormat)) {\n                return this.ownerTable.tableFormat.leftMargin;\n            }\n            else {\n                return 0;\n            }\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(TableCellWidget.prototype, \"topMargin\", {\n        /**\n         * @private\n         */\n        get: function () {\n            if (this.cellFormat && this.cellFormat.containsMargins()) {\n                return this.cellFormat.topMargin;\n            }\n            else if (!isNullOrUndefined(this.ownerTable) && !isNullOrUndefined(this.ownerTable.tableFormat)) {\n                return this.ownerTable.tableFormat.topMargin;\n            }\n            else {\n                return 0;\n            }\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(TableCellWidget.prototype, \"rightMargin\", {\n        /**\n         * @private\n         */\n        get: function () {\n            if (this.cellFormat && this.cellFormat.containsMargins()) {\n                return this.cellFormat.rightMargin;\n            }\n            else if (!isNullOrUndefined(this.ownerTable) && !isNullOrUndefined(this.ownerTable.tableFormat)) {\n                return this.ownerTable.tableFormat.rightMargin;\n            }\n            else {\n                return 0;\n            }\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(TableCellWidget.prototype, \"bottomMargin\", {\n        /**\n         * @private\n         */\n        get: function () {\n            if (this.cellFormat && this.cellFormat.containsMargins()) {\n                return this.cellFormat.bottomMargin;\n            }\n            else if (!isNullOrUndefined(this.ownerTable) && !isNullOrUndefined(this.ownerTable.tableFormat)) {\n                return this.ownerTable.tableFormat.bottomMargin;\n            }\n            else {\n                return 0;\n            }\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(TableCellWidget.prototype, \"cellIndex\", {\n        /**\n         * @private\n         */\n        get: function () {\n            if (this.ownerRow) {\n                return this.ownerRow.childWidgets.indexOf(this);\n            }\n            return -1;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(TableCellWidget.prototype, \"ownerTable\", {\n        /**\n         * @private\n         */\n        get: function () {\n            if (this.containerWidget instanceof TableRowWidget) {\n                return this.containerWidget.ownerTable;\n            }\n            return undefined;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(TableCellWidget.prototype, \"ownerRow\", {\n        /**\n         * @private\n         */\n        get: function () {\n            return this.containerWidget;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    /**\n     * @private\n     */\n    TableCellWidget.prototype.equals = function (widget) {\n        return widget instanceof TableCellWidget && widget.cellFormat === this.cellFormat;\n    };\n    /**\n     * @private\n     */\n    TableCellWidget.prototype.getContainerTable = function () {\n        var table = this.ownerTable;\n        while (table instanceof TableWidget && table.associatedCell instanceof TableCellWidget) {\n            table = table.associatedCell.getContainerTable();\n        }\n        return table;\n    };\n    /**\n     * @private\n     */\n    TableCellWidget.prototype.getPreviousSplitWidget = function () {\n        if (this.containerWidget instanceof TableRowWidget) {\n            var row = this.containerWidget;\n            do {\n                row = row.previousRenderedWidget;\n                if (isNullOrUndefined(row) || row.index < this.rowIndex) {\n                    break;\n                }\n                var previousCell = row.getCell(this.rowIndex, this.index);\n                if (previousCell && this.equals(previousCell)) {\n                    return previousCell;\n                }\n            } while (row);\n        }\n        return undefined;\n    };\n    /**\n     * @private\n     */\n    TableCellWidget.prototype.getNextSplitWidget = function () {\n        var rowSpan = this.cellFormat.rowSpan;\n        if (this.containerWidget instanceof TableRowWidget) {\n            var row = this.containerWidget;\n            do {\n                row = row.nextRenderedWidget;\n                if (isNullOrUndefined(row) || row.index > this.rowIndex + rowSpan) {\n                    break;\n                }\n                var nextCell = row.getCell(this.rowIndex, this.index);\n                if (nextCell && this.equals(nextCell)) {\n                    return nextCell;\n                }\n            } while (row);\n        }\n        return undefined;\n    };\n    /**\n     * @private\n     */\n    TableCellWidget.prototype.getTableCellWidget = function (point) {\n        for (var i = 0; i < this.childWidgets.length; i++) {\n            if (this.childWidgets[i].y <= point.y\n                && (this.childWidgets[i].y + this.childWidgets[i].height) >= point.y) {\n                return this.childWidgets[i].getTableCellWidget(point);\n            }\n        }\n        var tableCellWidget = undefined;\n        if (this.childWidgets.length > 0) {\n            if (this.childWidgets[0].y <= point.y) {\n                tableCellWidget = this.childWidgets[this.childWidgets.length - 1].getTableCellWidget(point);\n            }\n            else {\n                tableCellWidget = this.childWidgets[0].getTableCellWidget(point);\n            }\n        }\n        return tableCellWidget;\n    };\n    /**\n     * @private\n     */\n    TableCellWidget.prototype.updateWidth = function (preferredWidth) {\n        if (this.cellFormat.preferredWidthType === 'Auto') {\n            this.cellFormat.preferredWidth = preferredWidth;\n            this.cellFormat.preferredWidthType = 'Point';\n        }\n        else if (this.cellFormat.preferredWidthType === 'Point') {\n            this.cellFormat.preferredWidth = preferredWidth;\n        }\n        else if (this.cellFormat.preferredWidthType === 'Percent') {\n            this.cellFormat.preferredWidth = this.convertPointToPercent(preferredWidth);\n        }\n        this.cellFormat.cellWidth = preferredWidth;\n    };\n    /**\n     * @private\n     */\n    TableCellWidget.prototype.convertPointToPercent = function (cellPreferredWidth) {\n        var value = 0;\n        var clientWidth = this.ownerTable.getOwnerWidth(true);\n        var tableWidth = this.ownerTable.getTableClientWidth(clientWidth);\n        value = (cellPreferredWidth / tableWidth) * 100;\n        value = Math.round(value);\n        return value < 100 ? value : 100; // The value should be lesser than or equal to 100%;\n    };\n    /**\n     * @private\n     */\n    TableCellWidget.getCellLeftBorder = function (tableCell) {\n        var leftBorder = undefined;\n        var cellBorder = tableCell.cellFormat.borders;\n        var rowBorders = !isNullOrUndefined(tableCell.ownerRow) ? tableCell.ownerRow.rowFormat.borders : undefined;\n        var tableBorders = !isNullOrUndefined(tableCell.ownerTable) ? tableCell.ownerTable.tableFormat.borders : undefined;\n        if (!isNullOrUndefined(cellBorder.left)) {\n            leftBorder = cellBorder.left;\n        }\n        if (isNullOrUndefined(leftBorder)) {\n            leftBorder = tableCell.getLeftBorderToRenderByHierarchy(leftBorder, rowBorders, tableBorders);\n        }\n        if (tableCell.ownerTable.tableFormat.cellSpacing > 0) {\n            leftBorder = tableCell.getLeftBorderToRenderByHierarchy(leftBorder, rowBorders, tableBorders);\n        }\n        else {\n            var prevCell = undefined;\n            if (!isNullOrUndefined(tableCell.previousWidget)) {\n                // if the border is shared then choose the border based on Conflict Resolution algorithm.\n                prevCell = tableCell.previousWidget;\n            }\n            else if ((tableCell.cellFormat.columnSpan > 1 || tableCell.columnIndex > 1) && tableCell.ownerRow.rowIndex > 0) {\n                var previousRow = tableCell.ownerRow.previousWidget;\n                while (!isNullOrUndefined(previousRow) && previousRow.childWidgets.length > 0) {\n                    for (var i = 0; i < previousRow.childWidgets.length; i++) {\n                        var prevRowCell = previousRow.childWidgets[i];\n                        if (prevRowCell.columnIndex + prevRowCell.cellFormat.columnSpan === tableCell.columnIndex) {\n                            prevCell = previousRow.childWidgets[i];\n                            break;\n                        }\n                    }\n                    if (!isNullOrUndefined(prevCell)) {\n                        break;\n                    }\n                    previousRow = previousRow.previousWidget;\n                }\n            }\n            leftBorder = tableCell.getPreviousCellLeftBorder(leftBorder, prevCell);\n        }\n        if (isNullOrUndefined(leftBorder)) {\n            leftBorder = new WBorder(tableCell.cellFormat.borders);\n        }\n        return leftBorder;\n    };\n    /**\n     * @private\n     */\n    TableCellWidget.prototype.getLeftBorderWidth = function () {\n        var borderWidth = 0;\n        //let ownerTable = this.ownerTable;\n        //Added null condition check for asynchronous loading.\n        // if (this.cellFormat !== null && this.cellFormat.borders !== null) {\n        // update the margins values respect to layouting of borders.\n        //For normal table cells only left border is rendred. for last cell left and right border is rendred.\n        // this border widths are not included in margins.\n        //     boderWidth = this.cellFormat.borders.GetRightBorderToRender(this).GetLineWidth();\n        //need to render rightBorder specifically for all the cells when the cellSpacing is greater than zero or for last cell of each row.\n        // }\n        return borderWidth;\n    };\n    /**\n     * @private\n     */\n    TableCellWidget.prototype.getRightBorderWidth = function () {\n        var borderWidth = 0;\n        var ownerTable = this.ownerTable;\n        //Added null condition check for asynchronous loading.\n        // if (this.cellFormat !== null && this.cellFormat.borders !== null) {\n        ///need to render right border specifically for all the cells when the cell spacing is \n        //greater than zero or for last cell of each row.\n        //     let isLastCell: boolean = false;\n        //     isLastCell = this.cellIndex === 0;\n        //     if (ownerTable.tableFormat.cellSpacing > 0 || isLastCell) {\n        //         boderWidth = this.cellFormat.borders.getLeftBorderToRender(this).GetLineWidth();\n        //     }\n        // }\n        return borderWidth;\n    };\n    /**\n     * @private\n     */\n    TableCellWidget.prototype.getCellSpacing = function () {\n        var actualCellSpacing = this.ownerTable && this.ownerTable.tableFormat ? this.ownerTable.tableFormat.cellSpacing : 0;\n        var cellSpacingToLayout = actualCellSpacing;\n        // Considers the left, right margins and border widths(only available for Layouted table) for Minimum width.\n        if (this.ownerRow.childWidgets.length === 1) {\n            cellSpacingToLayout = actualCellSpacing * 2;\n        }\n        else if (this.cellIndex === 0 || this.cellIndex === this.ownerRow.childWidgets.length - 1) {\n            cellSpacingToLayout = actualCellSpacing + (actualCellSpacing / 2);\n        }\n        else {\n            cellSpacingToLayout = actualCellSpacing;\n        }\n        return cellSpacingToLayout;\n    };\n    /**\n     * @private\n     */\n    TableCellWidget.prototype.getMinimumPreferredWidth = function () {\n        var defaultWidth = 0;\n        defaultWidth = this.leftMargin + this.rightMargin + this.getLeftBorderWidth() + this.getRightBorderWidth() + this.getCellSpacing();\n        return defaultWidth;\n    };\n    /**\n     * @private\n     */\n    TableCellWidget.prototype.getPreviousCellLeftBorder = function (leftBorder, previousCell) {\n        // tslint:disable-next-line:max-line-length\n        if ((isNullOrUndefined(previousCell) || (!isNullOrUndefined(leftBorder) && (leftBorder.lineStyle === 'None' && !leftBorder.hasNoneStyle)))) {\n            if (!isNullOrUndefined(leftBorder) && !(leftBorder.ownerBase.ownerBase instanceof WTableFormat)) {\n                // tslint:disable-next-line:max-line-length\n                return this.getLeftBorderToRenderByHierarchy(leftBorder, TableRowWidget.getRowOf(leftBorder.ownerBase).rowFormat.borders, TableWidget.getTableOf(leftBorder.ownerBase).tableFormat.borders);\n            }\n        }\n        else {\n            var prevCellRightBorder = undefined;\n            // tslint:disable-next-line:max-line-length\n            if (!isNullOrUndefined(previousCell.cellFormat.borders) && !isNullOrUndefined(previousCell.cellFormat.borders.right) && previousCell.cellFormat.borders.right.lineStyle !== 'None') {\n                prevCellRightBorder = previousCell.cellFormat.borders.right;\n            }\n            if (!isNullOrUndefined(prevCellRightBorder) && prevCellRightBorder.lineStyle !== 'None') {\n                return this.getBorderBasedOnPriority(prevCellRightBorder, leftBorder);\n            }\n            else if (!isNullOrUndefined(leftBorder) && !(leftBorder.ownerBase.ownerBase instanceof WTableFormat)) {\n                // tslint:disable-next-line:max-line-length\n                return this.getLeftBorderToRenderByHierarchy(leftBorder, TableRowWidget.getRowOf(leftBorder.ownerBase).rowFormat.borders, TableWidget.getTableOf(leftBorder.ownerBase).tableFormat.borders);\n            }\n        }\n        return leftBorder;\n    };\n    /**\n     * @private\n     */\n    TableCellWidget.prototype.getBorderBasedOnPriority = function (border, adjacentBorder) {\n        // If the cell and its adjacent cell defined different borders then based on this algorithm the border choose to render.\n        // Reference link :https://msdn.microsoft.com/en-us/library/office/documentformat.openxml.wordprocessing.tablecellborders.aspx\n        if (isNullOrUndefined(border)) {\n            return adjacentBorder;\n        }\n        else if (isNullOrUndefined(adjacentBorder)) {\n            return border;\n        }\n        var borderWeight = border.getBorderWeight();\n        var adjacentBorderWeight = adjacentBorder.getBorderWeight();\n        //the border with higher wight  shall be displayed.\n        if (borderWeight === adjacentBorderWeight) {\n            //if the border is equal weight the based on the priority the border will be choosen to render.\n            var borderPriority = border.getPrecedence();\n            var adjacentBorderPriority = adjacentBorder.getPrecedence();\n            if (borderPriority === adjacentBorderPriority) {\n                //The color with the smaller brightness value shall be displayed.\n                var borderColInRGB = this.convertHexToRGB(border.color);\n                var R1 = borderColInRGB.r;\n                var G1 = borderColInRGB.g;\n                var B1 = borderColInRGB.b;\n                var adjacentBorderColInRGB = this.convertHexToRGB(adjacentBorder.color);\n                var R2 = adjacentBorderColInRGB.r;\n                var G2 = adjacentBorderColInRGB.g;\n                var B2 = adjacentBorderColInRGB.b;\n                var borderBrightness = (R1 + B1 + (2 * G1));\n                var adjacentBorderBrightness = (R2 + B2 + (2 * G2));\n                if (borderBrightness === adjacentBorderBrightness) {\n                    borderBrightness = (B1 + (2 * G1));\n                    adjacentBorderBrightness = (B2 + (2 * G2));\n                    if (borderBrightness === adjacentBorderBrightness) {\n                        if (G1 === G2) {\n                            return border;\n                        }\n                        else if (G1 > G2) {\n                            return adjacentBorder;\n                        }\n                        else {\n                            return border;\n                        }\n                    }\n                    else if (borderBrightness > adjacentBorderBrightness) {\n                        return adjacentBorder;\n                    }\n                    else {\n                        return border;\n                    }\n                }\n                else if (borderBrightness > adjacentBorderBrightness) {\n                    return adjacentBorder;\n                }\n                else {\n                    return border;\n                }\n            }\n            else if (borderPriority > adjacentBorderPriority) {\n                return border;\n            }\n            else {\n                return adjacentBorder;\n            }\n        }\n        else if (borderWeight > adjacentBorderWeight) {\n            return border;\n        }\n        else {\n            return adjacentBorder;\n        }\n    };\n    /**\n     * @private\n     */\n    TableCellWidget.prototype.getLeftBorderToRenderByHierarchy = function (leftBorder, rowBorders, tableBorders) {\n        if (!isNullOrUndefined(leftBorder) && (leftBorder.lineStyle !== 'None' || (leftBorder.hasNoneStyle &&\n            //If border defined with default values then border drawn based on hierarchy. \n            !(leftBorder.lineStyle === 'None' && leftBorder.lineWidth === 0 && leftBorder.color === '#000000')))) {\n            return leftBorder;\n            // tslint:disable-next-line:max-line-length\n        }\n        else if (!isNullOrUndefined(leftBorder) && (leftBorder.ownerBase instanceof WBorders) && TableCellWidget.getCellOf(leftBorder.ownerBase).columnIndex === 0) {\n            if (!isNullOrUndefined(tableBorders) && !isNullOrUndefined(tableBorders.left)) {\n                leftBorder = tableBorders.left;\n            }\n            return leftBorder;\n        }\n        else if (!isNullOrUndefined(rowBorders)\n            && !isNullOrUndefined(rowBorders.vertical) && rowBorders.vertical.lineStyle !== 'None') {\n            return leftBorder = rowBorders.vertical;\n        }\n        else if (!isNullOrUndefined(tableBorders)\n            && !isNullOrUndefined(tableBorders.vertical) && tableBorders.vertical.lineStyle !== 'None') {\n            return leftBorder = tableBorders.vertical;\n        }\n        else {\n            return leftBorder;\n        }\n    };\n    /**\n     * @private\n     */\n    TableCellWidget.getCellRightBorder = function (tableCell) {\n        var rightBorder = undefined;\n        var cellBorder = tableCell.cellFormat.borders;\n        var rowBorders = !isNullOrUndefined(tableCell.ownerRow) ? tableCell.ownerRow.rowFormat.borders : undefined;\n        var tableBorders = !isNullOrUndefined(tableCell.ownerTable) ? tableCell.ownerTable.tableFormat.borders : undefined;\n        if (!isNullOrUndefined(cellBorder.right)) {\n            rightBorder = cellBorder.right;\n        }\n        if (isNullOrUndefined(rightBorder)) {\n            rightBorder = tableCell.getRightBorderToRenderByHierarchy(rightBorder, rowBorders, tableBorders);\n        }\n        if (tableCell.ownerTable.tableFormat.cellSpacing > 0) {\n            rightBorder = tableCell.getRightBorderToRenderByHierarchy(rightBorder, rowBorders, tableBorders);\n        }\n        else {\n            var nextCell = undefined;\n            if (!isNullOrUndefined(tableCell.nextWidget)) {\n                nextCell = tableCell.nextWidget;\n            }\n            // if the border is shared then choose the border based on Conflict Resolution algorithm.\n            rightBorder = tableCell.getAdjacentCellRightBorder(rightBorder, nextCell);\n        }\n        if (isNullOrUndefined(rightBorder)) {\n            rightBorder = new WBorder(tableCell.cellFormat.borders);\n        }\n        return rightBorder;\n    };\n    /**\n     * @private\n     */\n    TableCellWidget.prototype.getAdjacentCellRightBorder = function (rightBorder, nextCell) {\n        // tslint:disable-next-line:max-line-length\n        if (isNullOrUndefined(nextCell) || (!isNullOrUndefined(rightBorder) && (rightBorder.lineStyle === 'None' && !rightBorder.hasNoneStyle))) {\n            if (!isNullOrUndefined(rightBorder) && !(rightBorder.ownerBase.ownerBase instanceof WTableFormat)) {\n                // tslint:disable-next-line:max-line-length\n                return this.getRightBorderToRenderByHierarchy(rightBorder, TableRowWidget.getRowOf(rightBorder.ownerBase).rowFormat.borders, TableWidget.getTableOf(rightBorder.ownerBase).tableFormat.borders);\n            }\n        }\n        else {\n            var nextCellLeftBorder = undefined;\n            // tslint:disable-next-line:max-line-length\n            if (!isNullOrUndefined(nextCell.cellFormat.borders) && !isNullOrUndefined(nextCell.cellFormat.borders.left) && nextCell.cellFormat.borders.left.lineStyle !== 'None') {\n                nextCellLeftBorder = nextCell.cellFormat.borders.left;\n            }\n            if (!isNullOrUndefined(nextCellLeftBorder) && nextCellLeftBorder.lineStyle !== 'None') {\n                return this.getBorderBasedOnPriority(rightBorder, nextCellLeftBorder);\n            }\n            else if (!isNullOrUndefined(rightBorder) && !(rightBorder.ownerBase.ownerBase instanceof WTableFormat)) {\n                // tslint:disable-next-line:max-line-length\n                return this.getRightBorderToRenderByHierarchy(rightBorder, TableRowWidget.getRowOf(rightBorder.ownerBase).rowFormat.borders, TableWidget.getTableOf(rightBorder.ownerBase).tableFormat.borders);\n            }\n        }\n        return rightBorder;\n    };\n    /**\n     * @private\n     */\n    TableCellWidget.prototype.getRightBorderToRenderByHierarchy = function (rightBorder, rowBorders, tableBorders) {\n        if (!isNullOrUndefined(rightBorder) && (rightBorder.lineStyle !== 'None' || (rightBorder.hasNoneStyle &&\n            //If border defined with default values then border drawn based on hierarchy. \n            !(rightBorder.lineStyle === 'None' && rightBorder.lineWidth === 0 && rightBorder.color === '#000000')))) {\n            return rightBorder;\n            // tslint:disable-next-line:max-line-length\n        }\n        else if (!isNullOrUndefined(rightBorder) && (rightBorder.ownerBase instanceof WBorders) && TableCellWidget.getCellOf(rightBorder.ownerBase).columnIndex === TableCellWidget.getCellOf(rightBorder.ownerBase).ownerRow.childWidgets.length - 1) {\n            if (!isNullOrUndefined(tableBorders) && !isNullOrUndefined(tableBorders.right)) {\n                rightBorder = tableBorders.right;\n            }\n            return rightBorder;\n        }\n        else if (!isNullOrUndefined(rowBorders)\n            && !isNullOrUndefined(rowBorders.vertical) && rowBorders.vertical.lineStyle !== 'None') {\n            return rightBorder = rowBorders.vertical;\n        }\n        else if (!isNullOrUndefined(tableBorders)\n            && !isNullOrUndefined(tableBorders.vertical) && tableBorders.vertical.lineStyle !== 'None') {\n            return rightBorder = tableBorders.vertical;\n        }\n        else {\n            return rightBorder;\n        }\n    };\n    /**\n     * @private\n     */\n    TableCellWidget.getCellTopBorder = function (tableCell) {\n        var topBorder = undefined;\n        var cellBorder = tableCell.cellFormat.borders;\n        var rowBorders = !isNullOrUndefined(tableCell.ownerRow) ? tableCell.ownerRow.rowFormat.borders : undefined;\n        var tableBorders = !isNullOrUndefined(tableCell.ownerTable) ? tableCell.ownerTable.tableFormat.borders : undefined;\n        if (!isNullOrUndefined(cellBorder.top)) {\n            topBorder = cellBorder.top;\n        }\n        if (isNullOrUndefined(topBorder)) {\n            topBorder = tableCell.getTopBorderToRenderByHierarchy(topBorder, rowBorders, tableBorders);\n        }\n        if (tableCell.ownerTable.tableFormat.cellSpacing > 0) {\n            topBorder = tableCell.getTopBorderToRenderByHierarchy(topBorder, rowBorders, tableBorders);\n        }\n        else {\n            var prevTopCell = undefined;\n            //ToDo: Need to analyze more to get the previous cell.\n            var prevRow = tableCell.ownerRow.previousWidget;\n            while (!isNullOrUndefined(prevRow) && prevRow.childWidgets.length > 0) {\n                for (var i = 0; i < prevRow.childWidgets.length; i++) {\n                    var prevRowCell = prevRow.childWidgets[i];\n                    if (prevRowCell.columnIndex + prevRowCell.cellFormat.columnSpan - 1 >= tableCell.columnIndex) {\n                        prevTopCell = prevRow.childWidgets[i];\n                        break;\n                    }\n                }\n                if (!isNullOrUndefined(prevTopCell)) {\n                    break;\n                }\n                prevRow = prevRow.previousWidget;\n                //If all the previous rows checked and the previous top cell is null\n                // then TableCell previus row matched column index cell is taken for border calculation.\n                if (isNullOrUndefined(prevRow) && isNullOrUndefined(prevTopCell)) {\n                    prevRow = tableCell.ownerRow.previousWidget;\n                    if (tableCell.columnIndex < prevRow.childWidgets.length) {\n                        for (var i = 0; i < prevRow.childWidgets.length; i++) {\n                            var prevRowCell = prevRow.childWidgets[i];\n                            if (prevRowCell.columnIndex === tableCell.columnIndex) {\n                                prevTopCell = prevRow.childWidgets[i];\n                                break;\n                            }\n                        }\n                        //If table cell Column index is greater than previous row cells count then last cell is taken as previous top cell.\n                    }\n                    else {\n                        // tslint:disable-next-line:max-line-length\n                        prevTopCell = tableCell.ownerRow.previousWidget.childWidgets[tableCell.ownerRow.previousWidget.childWidgets.length - 1];\n                    }\n                }\n            }\n            //If the border is shared then choose the border based on Conflict Resolution algorithm.\n            topBorder = tableCell.getPreviousCellTopBorder(topBorder, prevTopCell);\n        }\n        if (isNullOrUndefined(topBorder)) {\n            topBorder = new WBorder(tableCell.cellFormat.borders);\n        }\n        return topBorder;\n    };\n    /**\n     * @private\n     */\n    TableCellWidget.prototype.getPreviousCellTopBorder = function (topBorder, previousTopCell) {\n        // tslint:disable-next-line:max-line-length\n        if (isNullOrUndefined(previousTopCell) || (!isNullOrUndefined(topBorder) && (topBorder.lineStyle === 'None' && !topBorder.hasNoneStyle))) {\n            if (!isNullOrUndefined(topBorder) && !(topBorder.ownerBase.ownerBase instanceof WTableFormat)) {\n                // tslint:disable-next-line:max-line-length\n                return this.getTopBorderToRenderByHierarchy(topBorder, TableRowWidget.getRowOf(topBorder.ownerBase).rowFormat.borders, TableWidget.getTableOf(topBorder.ownerBase).tableFormat.borders);\n            }\n        }\n        else {\n            var prevTopCellBottomBorder = undefined;\n            // tslint:disable-next-line:max-line-length\n            if (!isNullOrUndefined(previousTopCell.cellFormat.borders) && !isNullOrUndefined(previousTopCell.cellFormat.borders.bottom) && previousTopCell.cellFormat.borders.bottom.lineStyle !== 'None') {\n                prevTopCellBottomBorder = previousTopCell.cellFormat.borders.bottom;\n            }\n            if (!isNullOrUndefined(prevTopCellBottomBorder) && prevTopCellBottomBorder.lineStyle !== 'None') {\n                return this.getBorderBasedOnPriority(topBorder, prevTopCellBottomBorder);\n            }\n            else if (!isNullOrUndefined(topBorder) && !(topBorder.ownerBase.ownerBase instanceof WTableFormat)) {\n                // tslint:disable-next-line:max-line-length\n                return this.getTopBorderToRenderByHierarchy(topBorder, TableRowWidget.getRowOf(topBorder.ownerBase).rowFormat.borders, TableWidget.getTableOf(topBorder.ownerBase).tableFormat.borders);\n            }\n        }\n        return topBorder;\n    };\n    /**\n     * @private\n     */\n    TableCellWidget.prototype.getTopBorderToRenderByHierarchy = function (topBorder, rowBorders, tableBorders) {\n        if (!isNullOrUndefined(topBorder) && (topBorder.lineStyle !== 'None' || (topBorder.hasNoneStyle &&\n            //If border defined with default values then border drawn based on hierarchy. \n            !(topBorder.lineStyle === 'None' && topBorder.lineWidth === 0 && topBorder.color === '#000000')))) {\n            return topBorder;\n            // tslint:disable-next-line:max-line-length\n        }\n        else if (!isNullOrUndefined(topBorder) && (topBorder.ownerBase instanceof WBorders) && TableCellWidget.getCellOf(topBorder.ownerBase).ownerRow.rowIndex === 0) {\n            if (!isNullOrUndefined(tableBorders) && !isNullOrUndefined(tableBorders.top)) {\n                topBorder = tableBorders.top;\n            }\n            return topBorder;\n        }\n        else if (!isNullOrUndefined(rowBorders)\n            && !isNullOrUndefined(rowBorders.horizontal) && rowBorders.horizontal.lineStyle !== 'None') {\n            return topBorder = rowBorders.horizontal;\n        }\n        else if (!isNullOrUndefined(tableBorders)\n            && !isNullOrUndefined(tableBorders.horizontal) && tableBorders.horizontal.lineStyle !== 'None') {\n            return topBorder = tableBorders.horizontal;\n        }\n        else {\n            return topBorder;\n        }\n    };\n    /**\n     * @private\n     */\n    TableCellWidget.getCellBottomBorder = function (tableCell) {\n        var bottomBorder = undefined;\n        var cellBorder = tableCell.cellFormat.borders;\n        var rowBorders = !isNullOrUndefined(tableCell.ownerRow) ? tableCell.ownerRow.rowFormat.borders : undefined;\n        var tableBorders = !isNullOrUndefined(tableCell.ownerTable) ? tableCell.ownerTable.tableFormat.borders : undefined;\n        if (!isNullOrUndefined(cellBorder.bottom)) {\n            bottomBorder = cellBorder.bottom;\n        }\n        if (isNullOrUndefined(bottomBorder)) {\n            // tslint:disable-next-line:max-line-length\n            bottomBorder = tableCell.getBottomBorderToRenderByHierarchy(bottomBorder, rowBorders, tableBorders); // select the left border based on heirarchy.\n        }\n        if (tableCell.ownerTable.tableFormat.cellSpacing > 0) {\n            bottomBorder = tableCell.getBottomBorderToRenderByHierarchy(bottomBorder, rowBorders, tableBorders);\n        }\n        else {\n            var nextBottomCell = undefined;\n            var nextRow = tableCell.ownerRow.nextWidget;\n            if (!isNullOrUndefined(nextRow) && tableCell.columnIndex < nextRow.childWidgets.length) {\n                nextBottomCell = nextRow.childWidgets[tableCell.columnIndex];\n            }\n            //If the border is shared then choose the border based on Conflict Resolution algorithm.\n            bottomBorder = tableCell.getAdjacentCellBottomBorder(bottomBorder, nextBottomCell);\n        }\n        if (isNullOrUndefined(bottomBorder)) {\n            bottomBorder = new WBorder(tableCell.cellFormat.borders);\n        }\n        return bottomBorder;\n    };\n    /**\n     * @private\n     */\n    TableCellWidget.prototype.getAdjacentCellBottomBorder = function (bottomBorder, nextBottomCell) {\n        // tslint:disable-next-line:max-line-length\n        if (isNullOrUndefined(nextBottomCell) || (!isNullOrUndefined(bottomBorder) && (bottomBorder.lineStyle === 'None' && !bottomBorder.hasNoneStyle))) {\n            if (!isNullOrUndefined(bottomBorder) && !(bottomBorder.ownerBase.ownerBase instanceof WTableFormat)) {\n                // tslint:disable-next-line:max-line-length\n                return this.getBottomBorderToRenderByHierarchy(bottomBorder, TableRowWidget.getRowOf(bottomBorder.ownerBase).rowFormat.borders, TableWidget.getTableOf(bottomBorder.ownerBase).tableFormat.borders);\n            }\n        }\n        else {\n            var prevBottomCellTopBorder = undefined;\n            // tslint:disable-next-line:max-line-length\n            if (!isNullOrUndefined(nextBottomCell.cellFormat.borders) && !isNullOrUndefined(nextBottomCell.cellFormat.borders.top) && nextBottomCell.cellFormat.borders.top.lineStyle !== 'None') {\n                prevBottomCellTopBorder = nextBottomCell.cellFormat.borders.top;\n            }\n            if (!isNullOrUndefined(prevBottomCellTopBorder) && prevBottomCellTopBorder.lineStyle !== 'None') {\n                return this.getBorderBasedOnPriority(bottomBorder, prevBottomCellTopBorder);\n            }\n            else if (!isNullOrUndefined(bottomBorder) && !(bottomBorder.ownerBase.ownerBase instanceof WTableFormat)) {\n                // tslint:disable-next-line:max-line-length\n                return this.getBottomBorderToRenderByHierarchy(bottomBorder, TableRowWidget.getRowOf(bottomBorder.ownerBase).rowFormat.borders, TableWidget.getTableOf(bottomBorder.ownerBase).tableFormat.borders);\n            }\n        }\n        return bottomBorder;\n    };\n    /**\n     * @private\n     */\n    TableCellWidget.prototype.getBottomBorderToRenderByHierarchy = function (bottomBorder, rowBorders, tableBorders) {\n        if (!isNullOrUndefined(bottomBorder) && (bottomBorder.lineStyle !== 'None' || (bottomBorder.hasNoneStyle &&\n            //If border defined with default values then border drawn based on hierarchy. \n            !(bottomBorder.lineStyle === 'None' && bottomBorder.lineWidth === 0 && bottomBorder.color === '#000000')))) {\n            return bottomBorder;\n            // tslint:disable-next-line:max-line-length\n        }\n        else if (!isNullOrUndefined(bottomBorder) && (bottomBorder.ownerBase instanceof WBorders) && TableCellWidget.getCellOf(bottomBorder.ownerBase).ownerRow.rowIndex + TableCellWidget.getCellOf(bottomBorder.ownerBase).cellFormat.rowSpan === TableCellWidget.getCellOf(bottomBorder.ownerBase).ownerTable.childWidgets.length) {\n            if (!isNullOrUndefined(tableBorders) && !isNullOrUndefined(tableBorders.bottom)) {\n                bottomBorder = tableBorders.bottom;\n            }\n            return bottomBorder;\n        }\n        else if (!isNullOrUndefined(rowBorders)\n            && !isNullOrUndefined(rowBorders.horizontal) && rowBorders.horizontal.lineStyle !== 'None') {\n            return bottomBorder = rowBorders.horizontal;\n        }\n        else if (!isNullOrUndefined(tableBorders)\n            && !isNullOrUndefined(tableBorders.horizontal) && tableBorders.horizontal.lineStyle !== 'None') {\n            return bottomBorder = tableBorders.horizontal;\n        }\n        else {\n            return bottomBorder;\n        }\n    };\n    TableCellWidget.prototype.convertHexToRGB = function (colorCode) {\n        if (colorCode) {\n            colorCode = colorCode.replace(/[^0-9A-â€Œâ€‹F]/gi, ''); // To remove # from color code string.\n            var colCodeNo = parseInt(colorCode, 16);\n            var r = (colCodeNo >> 16) & 255;\n            var g = (colCodeNo >> 8) & 255;\n            var b = colCodeNo & 255;\n            return { 'r': r, 'g': g, 'b': b };\n        }\n        return undefined;\n    };\n    /**\n     * @private\n     */\n    TableCellWidget.getCellOf = function (node) {\n        if (node instanceof WBorders) {\n            if (node.ownerBase instanceof WCellFormat && node.ownerBase.ownerBase instanceof TableCellWidget) {\n                return node.ownerBase.ownerBase;\n            }\n            else {\n                return undefined;\n            }\n        }\n        return undefined;\n    };\n    /**\n     * @private\n     */\n    TableCellWidget.prototype.destroyInternal = function (viewer) {\n        // let viewer: LayoutViewer = undefined;\n        // let page: Page = this.getPage();\n        // if (!isNullOrUndefined(page ))\n        //     viewer = page.viewer;\n        if (!isNullOrUndefined(this.childWidgets)) {\n            for (var i = 0; i < this.childWidgets.length; i++) {\n                var widget = this.childWidgets[i];\n                if (widget instanceof ParagraphWidget) {\n                    widget.destroyInternal(viewer);\n                }\n                else {\n                    widget.destroyInternal(viewer);\n                }\n                i--;\n            }\n            this.childWidgets = undefined;\n        }\n        this.destroy();\n    };\n    /**\n     * @private\n     */\n    TableCellWidget.prototype.clone = function () {\n        var cell = new TableCellWidget();\n        cell.cellFormat.copyFormat(this.cellFormat);\n        for (var i = 0; i < this.childWidgets.length; i++) {\n            var block = this.childWidgets[i].clone();\n            cell.childWidgets.push(block);\n            block.containerWidget = cell;\n            block.index = i;\n        }\n        cell.leftBorderWidth = this.leftBorderWidth;\n        cell.rightBorderWidth = this.rightBorderWidth;\n        if (this.margin) {\n            cell.margin = this.margin.clone();\n        }\n        cell.columnIndex = this.columnIndex;\n        cell.x = this.x;\n        cell.y = this.y;\n        cell.height = this.height;\n        cell.width = this.width;\n        return cell;\n    };\n    /**\n     * @private\n     */\n    TableCellWidget.prototype.destroy = function () {\n        // if (this.cellFormat) {\n        //     this.cellFormat.destroy();\n        // }\n        this.cellFormat = undefined;\n        this.rowIndex = undefined;\n        this.columnIndex = undefined;\n        _super.prototype.destroy.call(this);\n    };\n    return TableCellWidget;\n}(BlockWidget));\nexport { TableCellWidget };\n/**\n * @private\n */\nvar LineWidget = /** @class */ (function () {\n    /**\n     * Initialize the constructor of LineWidget\n     */\n    function LineWidget(paragraphWidget) {\n        /**\n         * @private\n         */\n        this.children = [];\n        /**\n         * @private\n         */\n        this.x = 0;\n        /**\n         * @private\n         */\n        this.y = 0;\n        /**\n         * @private\n         */\n        this.width = 0;\n        /**\n         * @private\n         */\n        this.height = 0;\n        this.paragraph = paragraphWidget;\n    }\n    Object.defineProperty(LineWidget.prototype, \"indexInOwner\", {\n        /**\n         * @private\n         */\n        get: function () {\n            if (this.paragraph && this.paragraph.childWidgets) {\n                return this.paragraph.childWidgets.indexOf(this);\n            }\n            return -1;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(LineWidget.prototype, \"nextLine\", {\n        /**\n         * @private\n         */\n        get: function () {\n            var paragraph = this.paragraph;\n            var lineIndex = this.indexInOwner;\n            if (lineIndex <= paragraph.childWidgets.length - 2) {\n                return paragraph.childWidgets[lineIndex + 1];\n            }\n            else if (paragraph.nextSplitWidget) {\n                var line = paragraph.nextSplitWidget.firstChild;\n                if (line instanceof LineWidget && line.paragraph.equals(this.paragraph)) {\n                    return line;\n                }\n            }\n            return undefined;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(LineWidget.prototype, \"previousLine\", {\n        /**\n         * @private\n         */\n        get: function () {\n            var paragraph = this.paragraph;\n            var lineIndex = this.indexInOwner;\n            var splitParagraph = paragraph.previousSplitWidget;\n            if (lineIndex > 0) {\n                return paragraph.childWidgets[lineIndex - 1];\n            }\n            else if (splitParagraph instanceof ParagraphWidget) {\n                var line = splitParagraph.lastChild;\n                if (line instanceof LineWidget && line.paragraph.equals(this.paragraph)) {\n                    return line;\n                }\n            }\n            return undefined;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(LineWidget.prototype, \"isEndsWithPageBreak\", {\n        /**\n         * @private\n         */\n        get: function () {\n            if (this.children.length > 0) {\n                var lastElement = this.children[this.children.length - 1];\n                if (lastElement instanceof TextElementBox) {\n                    return lastElement.isPageBreak;\n                }\n            }\n            return false;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    /**\n     * @private\n     */\n    LineWidget.prototype.isFirstLine = function () {\n        var index = this.indexInOwner;\n        if (index > -1 && this.paragraph.previousSplitWidget === undefined) {\n            return index === 0;\n        }\n        return false;\n    };\n    /**\n     * @private\n     */\n    LineWidget.prototype.isLastLine = function () {\n        var index = this.indexInOwner;\n        if (index > -1 && this.paragraph.nextSplitWidget === undefined) {\n            return index === this.paragraph.childWidgets.length - 1;\n        }\n        return false;\n    };\n    /**\n     * @private\n     */\n    LineWidget.prototype.getOffset = function (inline, index) {\n        if (isNullOrUndefined(inline)) {\n            return index;\n        }\n        var textIndex = index;\n        var line = inline.line;\n        var lineIndex = inline.line.paragraph.childWidgets.indexOf(inline.line);\n        for (var i = 0; i < line.children.length; i++) {\n            var inlineElement = line.children[i];\n            if (inline === inlineElement) {\n                break;\n            }\n            if (inlineElement instanceof ListTextElementBox) {\n                continue;\n            }\n            textIndex += inlineElement.length;\n        }\n        return textIndex;\n    };\n    /**\n     * @private\n     */\n    LineWidget.prototype.getEndOffset = function () {\n        var startOffset = 0;\n        var count = 0;\n        for (var i = 0; i < this.children.length; i++) {\n            var inlineElement = this.children[i];\n            if (inlineElement.length === 0) {\n                continue;\n            }\n            if (inlineElement instanceof ListTextElementBox) {\n                continue;\n            }\n            if (inlineElement instanceof TextElementBox || inlineElement instanceof ImageElementBox\n                || inlineElement instanceof BookmarkElementBox || (inlineElement instanceof FieldElementBox\n                && HelperMethods.isLinkedFieldCharacter(inlineElement))) {\n                startOffset = count + inlineElement.length;\n            }\n            count += inlineElement.length;\n        }\n        return startOffset;\n    };\n    /**\n     * @private\n     */\n    LineWidget.prototype.getInline = function (offset, indexInInline) {\n        var inlineElement = undefined;\n        var count = 0;\n        var isStarted = false;\n        if (this.children.length === 0) {\n            if (this.previousLine) {\n                var elementBox = this.previousLine.children[this.previousLine.children.length - 1];\n                if (elementBox instanceof TextElementBox && elementBox.text === '\\v') {\n                    inlineElement = this.previousLine.children[this.previousLine.children.length - 1];\n                    indexInInline = 1;\n                    return { 'element': inlineElement, 'index': indexInInline };\n                }\n            }\n        }\n        for (var i = 0; i < this.children.length; i++) {\n            inlineElement = this.children[i];\n            if (inlineElement instanceof ListTextElementBox) {\n                continue;\n            }\n            if (!isStarted && (inlineElement instanceof TextElementBox || inlineElement instanceof ImageElementBox\n                || inlineElement instanceof BookmarkElementBox\n                || inlineElement instanceof FieldElementBox && HelperMethods.isLinkedFieldCharacter(inlineElement))) {\n                isStarted = true;\n            }\n            if (isStarted && offset <= count + inlineElement.length) {\n                indexInInline = (offset - count);\n                return { 'element': inlineElement, 'index': indexInInline };\n            }\n            count += inlineElement.length;\n        }\n        if (offset > count) {\n            indexInInline = isNullOrUndefined(inlineElement) ? offset : inlineElement.length;\n        }\n        return { 'element': inlineElement, 'index': indexInInline };\n    };\n    /**\n     * @private\n     */\n    LineWidget.prototype.getHierarchicalIndex = function (hierarchicalIndex) {\n        var node = this;\n        hierarchicalIndex = node.paragraph.childWidgets.indexOf(node) + ';' + hierarchicalIndex;\n        if (node.paragraph instanceof BlockWidget) {\n            return node.paragraph.getHierarchicalIndex(hierarchicalIndex);\n        }\n        return hierarchicalIndex;\n    };\n    /**\n     * @private\n     */\n    LineWidget.prototype.clone = function () {\n        var line = new LineWidget(undefined);\n        for (var j = 0; j < this.children.length; j++) {\n            var element = this.children[j];\n            var clone = element.clone();\n            line.children.push(clone);\n            clone.line = line;\n        }\n        line.width = this.width;\n        line.height = this.height;\n        return line;\n    };\n    /**\n     * @private\n     */\n    LineWidget.prototype.destroy = function () {\n        if (!isNullOrUndefined(this.children)) {\n            for (var i = 0; i < this.children.length; i++) {\n                this.children[i].destroy();\n            }\n            this.children = [];\n        }\n        this.children = undefined;\n        if (this.paragraph) {\n            this.paragraph.removeChild(this.indexInOwner);\n        }\n        this.paragraph = undefined;\n        this.x = undefined;\n        this.y = undefined;\n        this.width = undefined;\n        this.height = undefined;\n    };\n    return LineWidget;\n}());\nexport { LineWidget };\n/**\n * @private\n */\nvar ElementBox = /** @class */ (function () {\n    /**\n     * Initialize the constructor of ElementBox\n     */\n    function ElementBox() {\n        /**\n         * @private\n         */\n        this.x = 0;\n        /**\n         * @private\n         */\n        this.y = 0;\n        /**\n         * @private\n         */\n        this.width = 0;\n        /**\n         * @private\n         */\n        this.height = 0;\n        /**\n         * @private\n         */\n        this.margin = new Margin(0, 0, 0, 0);\n        /**\n         * @private\n         */\n        this.characterFormat = undefined;\n        this.characterFormat = new WCharacterFormat(this);\n        this.margin = new Margin(0, 0, 0, 0);\n    }\n    Object.defineProperty(ElementBox.prototype, \"isPageBreak\", {\n        /**\n         * @private\n         */\n        get: function () {\n            if (this instanceof TextElementBox) {\n                return this.text === '\\f';\n            }\n            return false;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    /**\n     * @private\n     */\n    ElementBox.prototype.linkFieldCharacter = function (viewer) {\n        if (!(this instanceof FieldElementBox)) {\n            return;\n        }\n        if (this.fieldType === 0) {\n            var fieldBegin = this;\n            if (isNullOrUndefined(fieldBegin.fieldEnd)) {\n                this.linkFieldTraversingForward(this.line, fieldBegin, fieldBegin);\n                if (viewer.fields.indexOf(fieldBegin) === -1) {\n                    viewer.fields.push(fieldBegin);\n                }\n            }\n        }\n        else if (this.fieldType === 2) {\n            var fieldSeparator = this;\n            //Links the field begin for the current separator.\n            if (isNullOrUndefined(fieldSeparator.fieldBegin)) {\n                this.linkFieldTraversingBackwardSeparator(this.line, fieldSeparator, fieldSeparator);\n            }\n            fieldSeparator.fieldBegin.fieldSeparator = fieldSeparator;\n            if (!isNullOrUndefined(fieldSeparator.fieldBegin)) {\n                //Links to field end traversing from field separator.\n                var isFieldEnd = this.linkFieldTraversingForward(this.line, fieldSeparator.fieldBegin, fieldSeparator);\n                if (isNullOrUndefined(fieldSeparator.fieldEnd) && isFieldEnd) {\n                    fieldSeparator.fieldEnd = fieldSeparator.fieldBegin.fieldEnd;\n                }\n                if (fieldSeparator.fieldEnd) {\n                    fieldSeparator.fieldEnd.fieldSeparator = fieldSeparator;\n                }\n            }\n        }\n        else {\n            var fieldEnd = this;\n            //Links the field begin and separator for the current end.\n            if (isNullOrUndefined(fieldEnd.fieldBegin)) {\n                this.linkFieldTraversingBackward(this.line, fieldEnd, fieldEnd);\n            }\n        }\n    };\n    /**\n     * @private\n     */\n    ElementBox.prototype.linkFieldTraversingBackward = function (line, fieldEnd, previousNode) {\n        var k = line.children.length - 1;\n        if (line.children.indexOf(previousNode) > -1) {\n            k = line.children.indexOf(previousNode) - 1;\n        }\n        for (var j = k; j >= 0; j--) {\n            var childNode = line.children[j];\n            if (childNode instanceof FieldElementBox) {\n                if (childNode.fieldType === 0) {\n                    if (isNullOrUndefined(childNode.fieldEnd)) {\n                        fieldEnd.fieldBegin = childNode;\n                        if (isNullOrUndefined(childNode.fieldEnd)) {\n                            childNode.fieldEnd = fieldEnd;\n                        }\n                        if (fieldEnd.fieldSeparator && isNullOrUndefined(fieldEnd.fieldSeparator.fieldBegin)) {\n                            fieldEnd.fieldSeparator.fieldBegin = childNode;\n                            if (isNullOrUndefined(childNode.fieldSeparator)) {\n                                childNode.fieldSeparator = fieldEnd.fieldSeparator;\n                            }\n                        }\n                    }\n                    return !isNullOrUndefined(fieldEnd.fieldBegin);\n                }\n                else if (childNode.fieldType === 2 && isNullOrUndefined(childNode.fieldEnd)) {\n                    fieldEnd.fieldSeparator = childNode;\n                    childNode.fieldEnd = fieldEnd;\n                    if (!isNullOrUndefined(childNode.fieldBegin)) {\n                        fieldEnd.fieldBegin = childNode.fieldBegin;\n                    }\n                }\n            }\n        }\n        if (line.previousLine) {\n            this.linkFieldTraversingBackward(line.previousLine, fieldEnd, this);\n        }\n        else if (line.paragraph.previousRenderedWidget instanceof ParagraphWidget) {\n            var prevParagraph = line.paragraph.previousRenderedWidget;\n            // tslint:disable-next-line:max-line-length\n            this.linkFieldTraversingBackward(prevParagraph.childWidgets[prevParagraph.childWidgets.length - 1], fieldEnd, this);\n        }\n        return true;\n    };\n    /**\n     * @private\n     */\n    ElementBox.prototype.linkFieldTraversingForward = function (line, fieldBegin, previousNode) {\n        var i = 0;\n        if (line.children.indexOf(previousNode) > -1) {\n            i = line.children.indexOf(previousNode) + 1;\n        }\n        for (var j = i; j < line.children.length; j++) {\n            var node = line.children[j];\n            if (node instanceof FieldElementBox) {\n                if (node.fieldType === 1) {\n                    if (isNullOrUndefined(node.fieldBegin)) {\n                        fieldBegin.fieldEnd = node;\n                    }\n                    if (fieldBegin.fieldEnd && isNullOrUndefined(fieldBegin.fieldEnd.fieldBegin)) {\n                        fieldBegin.fieldEnd.fieldBegin = fieldBegin;\n                    }\n                    return true;\n                }\n                else if (isNullOrUndefined(fieldBegin.fieldSeparator)) {\n                    if (node.fieldType === 2 && isNullOrUndefined(node.fieldBegin)) {\n                        fieldBegin.fieldSeparator = node;\n                        if (!isNullOrUndefined(node.fieldEnd)) {\n                            fieldBegin.fieldEnd = node.fieldEnd;\n                            return true;\n                        }\n                    }\n                    else {\n                        return false;\n                    }\n                }\n            }\n        }\n        if (line.nextLine) {\n            this.linkFieldTraversingForward(line.nextLine, fieldBegin, this);\n        }\n        else if (line.paragraph.nextRenderedWidget instanceof ParagraphWidget) {\n            this.linkFieldTraversingForward(line.paragraph.nextRenderedWidget.childWidgets[0], fieldBegin, this);\n        }\n        return true;\n    };\n    /**\n     * @private\n     */\n    ElementBox.prototype.linkFieldTraversingBackwardSeparator = function (line, fieldSeparator, previousNode) {\n        var index = line.children.length - 1;\n        if (line.children.indexOf(previousNode) > -1) {\n            index = line.children.indexOf(previousNode) - 1;\n        }\n        for (var i = index; i >= 0; i--) {\n            var childElement = line.children[i];\n            if (childElement instanceof FieldElementBox) {\n                if (childElement instanceof FieldElementBox && childElement.fieldType === 0) {\n                    if (isNullOrUndefined(childElement.fieldSeparator)) {\n                        fieldSeparator.fieldBegin = childElement;\n                    }\n                    return !isNullOrUndefined(fieldSeparator.fieldBegin);\n                }\n            }\n        }\n        if (line.previousLine) {\n            this.linkFieldTraversingBackwardSeparator(line.previousLine, fieldSeparator, this);\n        }\n        else if (line.paragraph.nextRenderedWidget instanceof ParagraphWidget) {\n            // tslint:disable-next-line:max-line-length\n            line = line.paragraph.previousRenderedWidget.childWidgets[line.paragraph.previousRenderedWidget.childWidgets.length - 1];\n            this.linkFieldTraversingBackwardSeparator(line, fieldSeparator, this);\n        }\n        else {\n            return true;\n        }\n        return true;\n    };\n    Object.defineProperty(ElementBox.prototype, \"length\", {\n        /**\n         * @private\n         */\n        get: function () {\n            return this.getLength();\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(ElementBox.prototype, \"indexInOwner\", {\n        /**\n         * @private\n         */\n        get: function () {\n            return this.line instanceof LineWidget && this.line.children ? this.line.children.indexOf(this) : -1;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(ElementBox.prototype, \"previousElement\", {\n        /**\n         * @private\n         */\n        get: function () {\n            var index = this.indexInOwner;\n            if (index > 0 && index < this.line.children.length) {\n                return this.line.children[index - 1];\n            }\n            return undefined;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(ElementBox.prototype, \"nextElement\", {\n        /**\n         * @private\n         */\n        get: function () {\n            var index = this.indexInOwner;\n            if (index > -1 && index < this.line.children.length - 1) {\n                return this.line.children[index + 1];\n            }\n            return undefined;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(ElementBox.prototype, \"nextNode\", {\n        /**\n         * @private\n         */\n        get: function () {\n            var index = this.line.children.indexOf(this);\n            var lineIndex = this.line.paragraph.childWidgets.indexOf(this.line);\n            if (index < this.line.children.length - 1) {\n                return this.line.children[index + 1];\n            }\n            else if (lineIndex < this.line.paragraph.childWidgets.length - 1) {\n                return this.line.paragraph.childWidgets[lineIndex + 1].children[0];\n            }\n            return undefined;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(ElementBox.prototype, \"previousNode\", {\n        /**\n         * @private\n         */\n        get: function () {\n            var index = this.line.children.indexOf(this);\n            var lineIndex = this.line.paragraph.childWidgets.indexOf(this.line);\n            if (index > 0) {\n                return this.line.children[index - 1];\n            }\n            else if (lineIndex > 0) {\n                var lineWidget = this.line.paragraph.childWidgets[lineIndex - 1];\n                return lineWidget.children[lineWidget.children.length - 1];\n            }\n            return undefined;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(ElementBox.prototype, \"paragraph\", {\n        /**\n         * @private\n         */\n        get: function () {\n            if (this.line) {\n                return this.line.paragraph;\n            }\n            return undefined;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    /**\n     * @private\n     */\n    ElementBox.prototype.destroy = function () {\n        if (!isNullOrUndefined(this.line) && this.line.children && this.line.children.indexOf(this) > -1) {\n            var index = this.line.children.indexOf(this);\n            this.line.children.splice(index, 1);\n        }\n        this.line = undefined;\n        if (this.characterFormat) {\n            this.characterFormat.destroy();\n        }\n        this.characterFormat = undefined;\n        if (this.margin) {\n            this.margin.destroy();\n        }\n        this.margin = undefined;\n        this.x = undefined;\n        this.y = undefined;\n        this.width = undefined;\n        this.height = undefined;\n    };\n    /**\n     * @private\n     */\n    ElementBox.objectCharacter = String.fromCharCode(65532);\n    return ElementBox;\n}());\nexport { ElementBox };\n/**\n * @private\n */\nvar FieldElementBox = /** @class */ (function (_super) {\n    __extends(FieldElementBox, _super);\n    function FieldElementBox(type) {\n        var _this = _super.call(this) || this;\n        /**\n         * @private\n         */\n        _this.fieldType = 0;\n        /**\n         * @private\n         */\n        _this.hasFieldEnd = false;\n        _this.fieldBeginInternal = undefined;\n        _this.fieldSeparatorInternal = undefined;\n        _this.fieldEndInternal = undefined;\n        _this.fieldType = type;\n        return _this;\n    }\n    Object.defineProperty(FieldElementBox.prototype, \"fieldBegin\", {\n        get: function () {\n            return this.fieldBeginInternal;\n        },\n        set: function (field) {\n            this.fieldBeginInternal = field;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(FieldElementBox.prototype, \"fieldSeparator\", {\n        get: function () {\n            return this.fieldSeparatorInternal;\n        },\n        set: function (field) {\n            this.fieldSeparatorInternal = field;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(FieldElementBox.prototype, \"fieldEnd\", {\n        get: function () {\n            return this.fieldEndInternal;\n        },\n        set: function (field) {\n            this.fieldEndInternal = field;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    /**\n     * @private\n     */\n    FieldElementBox.prototype.getLength = function () {\n        return 1;\n    };\n    /**\n     * @private\n     */\n    FieldElementBox.prototype.clone = function () {\n        var field = new FieldElementBox(this.fieldType);\n        field.characterFormat.copyFormat(this.characterFormat);\n        if (this.margin) {\n            field.margin = this.margin.clone();\n        }\n        field.width = this.width;\n        field.height = this.height;\n        return field;\n    };\n    /**\n     * @private\n     */\n    FieldElementBox.prototype.destroy = function () {\n        this.fieldType = undefined;\n        this.hasFieldEnd = undefined;\n        this.fieldBeginInternal = undefined;\n        this.fieldEndInternal = undefined;\n        this.fieldSeparatorInternal = undefined;\n        _super.prototype.destroy.call(this);\n    };\n    return FieldElementBox;\n}(ElementBox));\nexport { FieldElementBox };\n/**\n * @private\n */\nvar TextElementBox = /** @class */ (function (_super) {\n    __extends(TextElementBox, _super);\n    function TextElementBox() {\n        var _this = _super.call(this) || this;\n        /**\n         * @private\n         */\n        _this.baselineOffset = 0;\n        /**\n         * @private\n         */\n        _this.text = '';\n        return _this;\n    }\n    /**\n     * @private\n     */\n    TextElementBox.prototype.getLength = function () {\n        return this.text ? this.text.length : 0;\n    };\n    /**\n     * @private\n     */\n    TextElementBox.prototype.clone = function () {\n        var span = new TextElementBox();\n        span.characterFormat.copyFormat(this.characterFormat);\n        span.text = this.text;\n        if (this.margin) {\n            span.margin = this.margin.clone();\n        }\n        span.width = this.width;\n        span.height = this.height;\n        return span;\n    };\n    /**\n     * @private\n     */\n    TextElementBox.prototype.destroy = function () {\n        this.text = undefined;\n        _super.prototype.destroy.call(this);\n    };\n    return TextElementBox;\n}(ElementBox));\nexport { TextElementBox };\n/**\n * @private\n */\nvar FieldTextElementBox = /** @class */ (function (_super) {\n    __extends(FieldTextElementBox, _super);\n    function FieldTextElementBox() {\n        var _this = _super.call(this) || this;\n        _this.fieldText = '';\n        return _this;\n    }\n    Object.defineProperty(FieldTextElementBox.prototype, \"text\", {\n        get: function () {\n            return this.fieldText;\n        },\n        set: function (value) {\n            this.fieldText = value;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    /**\n     * @private\n     */\n    FieldTextElementBox.prototype.clone = function () {\n        var span = new FieldTextElementBox();\n        span.characterFormat.copyFormat(this.characterFormat);\n        span.fieldBegin = this.fieldBegin;\n        span.text = this.text;\n        if (this.margin) {\n            span.margin = this.margin.clone();\n        }\n        span.width = this.width;\n        span.height = this.height;\n        return span;\n    };\n    return FieldTextElementBox;\n}(TextElementBox));\nexport { FieldTextElementBox };\n/**\n * @private\n */\nvar TabElementBox = /** @class */ (function (_super) {\n    __extends(TabElementBox, _super);\n    function TabElementBox() {\n        var _this = _super.call(this) || this;\n        /**\n         * @private\n         */\n        _this.tabText = '';\n        /**\n         * @private\n         */\n        _this.tabLeader = 'None';\n        return _this;\n    }\n    /**\n     * @private\n     */\n    TabElementBox.prototype.destroy = function () {\n        this.tabText = undefined;\n        this.tabLeader = undefined;\n    };\n    /**\n     * @private\n     */\n    TabElementBox.prototype.clone = function () {\n        var span = new TabElementBox();\n        span.characterFormat.copyFormat(this.characterFormat);\n        span.tabText = this.tabText;\n        span.tabLeader = this.tabLeader;\n        span.text = this.text;\n        if (this.margin) {\n            span.margin = this.margin.clone();\n        }\n        span.width = this.width;\n        span.height = this.height;\n        return span;\n    };\n    return TabElementBox;\n}(TextElementBox));\nexport { TabElementBox };\n/**\n * @private\n */\nvar BookmarkElementBox = /** @class */ (function (_super) {\n    __extends(BookmarkElementBox, _super);\n    function BookmarkElementBox(type) {\n        var _this = _super.call(this) || this;\n        _this.bookmarkTypeIn = 0;\n        _this.refereneceIn = undefined;\n        _this.nameIn = '';\n        _this.bookmarkTypeIn = type;\n        return _this;\n    }\n    Object.defineProperty(BookmarkElementBox.prototype, \"bookmarkType\", {\n        /**\n         * @private\n         */\n        get: function () {\n            return this.bookmarkTypeIn;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(BookmarkElementBox.prototype, \"name\", {\n        /**\n         * @private\n         */\n        get: function () {\n            return this.nameIn;\n        },\n        /**\n         * @private\n         */\n        set: function (name) {\n            this.nameIn = name;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(BookmarkElementBox.prototype, \"reference\", {\n        /**\n         * @private\n         */\n        get: function () {\n            return this.refereneceIn;\n        },\n        /**\n         * @private\n         */\n        set: function (reference) {\n            this.refereneceIn = reference;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    /**\n     * @private\n     */\n    BookmarkElementBox.prototype.getLength = function () {\n        return 1;\n    };\n    /**\n     * @private\n     */\n    BookmarkElementBox.prototype.destroy = function () {\n        this.name = undefined;\n        this.reference = undefined;\n        this.bookmarkTypeIn = undefined;\n    };\n    /**\n     * Clones the bookmark element box.\n     * @param element - book mark element\n     */\n    /**\n     * @private\n     */\n    BookmarkElementBox.prototype.clone = function () {\n        var span = new BookmarkElementBox(this.bookmarkType);\n        span.name = this.name;\n        span.reference = this.reference;\n        if (this.margin) {\n            span.margin = this.margin.clone();\n        }\n        span.width = this.width;\n        span.height = this.height;\n        return span;\n    };\n    return BookmarkElementBox;\n}(ElementBox));\nexport { BookmarkElementBox };\n/**\n * @private\n */\nvar ImageElementBox = /** @class */ (function (_super) {\n    __extends(ImageElementBox, _super);\n    function ImageElementBox(isInlineImage) {\n        var _this = _super.call(this) || this;\n        _this.imageStr = '';\n        _this.imgElement = undefined;\n        _this.isInlineImageIn = true;\n        /**\n         * @private\n         */\n        _this.isMetaFile = false;\n        _this.isInlineImageIn = isInlineImage;\n        return _this;\n    }\n    Object.defineProperty(ImageElementBox.prototype, \"isInlineImage\", {\n        /**\n         * @private\n         */\n        get: function () {\n            return this.isInlineImageIn;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(ImageElementBox.prototype, \"element\", {\n        /**\n         * @private\n         */\n        get: function () {\n            if (isNullOrUndefined(this.imgElement)) {\n                this.imgElement = document.createElement('img');\n            }\n            return this.imgElement;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(ImageElementBox.prototype, \"length\", {\n        /**\n         * @private\n         */\n        get: function () {\n            return 1;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(ImageElementBox.prototype, \"imageString\", {\n        /**\n         * @private\n         */\n        get: function () {\n            return this.imageStr;\n        },\n        /**\n         * @private\n         */\n        set: function (value) {\n            this.imageStr = value;\n            if (!isNullOrUndefined(value)) {\n                this.element.src = this.imageStr;\n            }\n        },\n        enumerable: true,\n        configurable: true\n    });\n    /**\n     * @private\n     */\n    ImageElementBox.prototype.getLength = function () {\n        return 1;\n    };\n    /**\n     * @private\n     */\n    ImageElementBox.prototype.clone = function () {\n        var image = new ImageElementBox(this.isInlineImage);\n        image.characterFormat.copyFormat(this.characterFormat);\n        image.imageString = this.imageString;\n        image.isMetaFile = this.isMetaFile;\n        image.width = this.width;\n        image.height = this.height;\n        if (this.margin) {\n            image.margin = this.margin.clone();\n        }\n        return image;\n    };\n    /**\n     * @private\n     */\n    ImageElementBox.prototype.destroy = function () {\n        this.imgElement = undefined;\n        this.imageString = undefined;\n        this.isInlineImageIn = undefined;\n        _super.prototype.destroy.call(this);\n    };\n    return ImageElementBox;\n}(ElementBox));\nexport { ImageElementBox };\n/**\n * @private\n */\nvar ListTextElementBox = /** @class */ (function (_super) {\n    __extends(ListTextElementBox, _super);\n    function ListTextElementBox(listLevel, isListFollowCharacter) {\n        var _this = _super.call(this) || this;\n        /**\n         * @private\n         */\n        _this.baselineOffset = 0;\n        /**\n         * @private\n         */\n        _this.isFollowCharacter = false;\n        _this.listLevel = listLevel;\n        _this.isFollowCharacter = isListFollowCharacter;\n        return _this;\n    }\n    /**\n     * @private\n     */\n    ListTextElementBox.prototype.getLength = function () {\n        return this.text ? this.text.length : 0;\n    };\n    /**\n     * @private\n     */\n    ListTextElementBox.prototype.clone = function () {\n        var list = new ListTextElementBox(this.listLevel, this.isFollowCharacter);\n        list.text = this.text;\n        list.baselineOffset = this.baselineOffset;\n        if (this.margin) {\n            list.margin = this.margin.clone();\n        }\n        list.width = this.width;\n        list.height = this.height;\n        return list;\n    };\n    /**\n     * @private\n     */\n    ListTextElementBox.prototype.destroy = function () {\n        this.text = undefined;\n        _super.prototype.destroy.call(this);\n    };\n    return ListTextElementBox;\n}(ElementBox));\nexport { ListTextElementBox };\n/**\n * @private\n */\nvar Page = /** @class */ (function () {\n    /**\n     * Initialize the constructor of Page\n     */\n    function Page() {\n        /**\n         * Specifies the Bonding Rectangle\n         * @private\n         */\n        this.boundingRectangle = new Rect(96, 96, 816, 1056);\n        /**\n         * @private\n         */\n        this.repeatHeaderRowTableWidget = false;\n        /**\n         * Specifies the bodyWidgets\n         * @default []\n         * @private\n         */\n        this.bodyWidgets = [];\n        /**\n         * @private\n         */\n        this.headerWidget = undefined;\n        /**\n         * @private\n         */\n        this.footerWidget = undefined;\n        // let text: string = 'DocumentEditor';\n    }\n    Object.defineProperty(Page.prototype, \"index\", {\n        /**\n         * @private\n         */\n        get: function () {\n            if (this.viewer) {\n                return this.viewer.pages.indexOf(this);\n            }\n            return -1;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(Page.prototype, \"previousPage\", {\n        /**\n         * @private\n         */\n        get: function () {\n            var index = this.index;\n            if (index > 0) {\n                return this.viewer.pages[index - 1];\n            }\n            return undefined;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(Page.prototype, \"nextPage\", {\n        /**\n         * @private\n         */\n        get: function () {\n            var index = this.index;\n            if (index < this.viewer.pages.length - 1) {\n                return this.viewer.pages[index + 1];\n            }\n            return undefined;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(Page.prototype, \"sectionIndex\", {\n        /**\n         * @private\n         */\n        get: function () {\n            if (this.bodyWidgets.length > 0) {\n                return this.bodyWidgets[0].index;\n            }\n            return -1;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Page.prototype.destroy = function () {\n        if (this.headerWidget) {\n            if (this.viewer && this.viewer.owner.editor) {\n                this.viewer.owner.editor.removeFieldInWidget(this.headerWidget);\n            }\n            this.headerWidget.destroy();\n        }\n        this.headerWidget = undefined;\n        if (this.footerWidget) {\n            if (this.viewer && this.viewer.owner.editor) {\n                this.viewer.owner.editor.removeFieldInWidget(this.footerWidget);\n            }\n            this.footerWidget.destroy();\n        }\n        this.footerWidget = undefined;\n        this.bodyWidgets = [];\n        this.bodyWidgets = undefined;\n        if (!isNullOrUndefined(this.viewer)) {\n            if (!isNullOrUndefined(this.viewer.pages)) {\n                this.viewer.removePage(this);\n            }\n        }\n        this.viewer = undefined;\n    };\n    return Page;\n}());\nexport { Page };\n/**\n * @private\n */\nvar WTableHolder = /** @class */ (function () {\n    function WTableHolder() {\n        this.tableColumns = [];\n        /**\n         * @private\n         */\n        this.tableWidth = 0;\n    }\n    Object.defineProperty(WTableHolder.prototype, \"columns\", {\n        get: function () {\n            return this.tableColumns;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    /**\n     * @private\n     */\n    WTableHolder.prototype.resetColumns = function () {\n        for (var i = 0; i < this.tableColumns.length; i++) {\n            this.tableColumns[i].destroy();\n        }\n        this.tableColumns = [];\n    };\n    /**\n     * @private\n     */\n    WTableHolder.prototype.getPreviousSpannedCellWidth = function (previousColumnIndex, curColumnIndex) {\n        var width = 0;\n        for (var i = previousColumnIndex; i < curColumnIndex; i++) {\n            width += this.tableColumns[i].preferredWidth;\n        }\n        return width;\n    };\n    /**\n     * @private\n     */\n    WTableHolder.prototype.addColumns = function (currentColumnIndex, columnSpan, width, minWidth, offset) {\n        for (var i = this.columns.length; i < columnSpan; i++) {\n            this.columns.push(new WColumn());\n        }\n        var availableWidth = 0;\n        for (var j = currentColumnIndex; j < columnSpan; j++) {\n            availableWidth += this.columns[j].preferredWidth;\n        }\n        // If width to add is greater than preferred width, then preferred width will be increased.\n        // In case of Gridspan > 1, only last grid column width will be updated.\n        var gridSpan = columnSpan - currentColumnIndex;\n        if (!(gridSpan > 1) && availableWidth < width) {\n            this.columns[columnSpan - 1].preferredWidth += (width - availableWidth);\n        }\n        if (minWidth > this.columns[columnSpan - 1].minWidth) {\n            this.columns[columnSpan - 1].minWidth = minWidth;\n        }\n        if (offset > this.columns[columnSpan - 1].endOffset) {\n            this.columns[columnSpan - 1].endOffset = offset;\n        }\n    };\n    /**\n     * @private\n     */\n    WTableHolder.prototype.getTotalWidth = function () {\n        var width = 0;\n        for (var i = 0; i < this.columns.length; i++) {\n            var column = this.columns[i];\n            width += column.preferredWidth;\n        }\n        return width;\n    };\n    /**\n     * @private\n     */\n    WTableHolder.prototype.isFitColumns = function (containerWidth, preferredTableWidth, isAutoWidth) {\n        // Gets total preferred width.\n        var totalColumnWidth = this.getTotalWidth();\n        // If auto table width, based on total column widths, minimum value will be updated.\n        if (isAutoWidth) {\n            this.tableWidth = preferredTableWidth > totalColumnWidth ? totalColumnWidth : preferredTableWidth;\n        }\n        else {\n            this.tableWidth = preferredTableWidth;\n        }\n        // If total columns width doesn't match table width, then all grid column widths will be updated by even factor.\n        // If totalColumnWidth < TableWidth, all grid columns are enlarged. Otherwise shrinked.\n        if (totalColumnWidth !== this.tableWidth) {\n            var factor = this.tableWidth / totalColumnWidth;\n            factor = isNaN(factor) ? 1 : factor;\n            for (var i = 0; i < this.columns.length; i++) {\n                var column = this.columns[i];\n                //column.PreferredWidth = factor * column.PreferredWidth;\n                if (factor * column.preferredWidth < column.minWidth) {\n                    return false;\n                }\n            }\n            return true;\n        }\n        else {\n            return true;\n        }\n    };\n    /**\n     * @private\n     */\n    WTableHolder.prototype.fitColumns = function (containerWidth, preferredTableWidth, isAutoWidth) {\n        // Gets total preferred width.\n        var totalColumnWidth = this.getTotalWidth();\n        // If auto table width, based on total column widths, minimum value will be updated.\n        if (isAutoWidth) {\n            this.tableWidth = preferredTableWidth > totalColumnWidth ? totalColumnWidth : preferredTableWidth;\n        }\n        else {\n            this.tableWidth = preferredTableWidth;\n        }\n        // If total columns width doesn't match table width, then all grid column widths will be updated by even factor.\n        // If totalColumnWidth < TableWidth, all grid columns are enlarged. Otherwise shrinked.\n        if (totalColumnWidth !== this.tableWidth) {\n            var factor = this.tableWidth / totalColumnWidth;\n            for (var i = 0; i < this.columns.length; i++) {\n                var column = this.columns[i];\n                column.preferredWidth = factor * column.preferredWidth;\n            }\n        }\n    };\n    /**\n     * @private\n     */\n    WTableHolder.prototype.getCellWidth = function (columnIndex, columnSpan, preferredTableWidth, isAutoWidth) {\n        var width = 0;\n        for (var i = 0; i < columnSpan; i++) {\n            width += this.tableColumns[i + columnIndex].preferredWidth;\n        }\n        return width;\n    };\n    /**\n     * @private\n     */\n    WTableHolder.prototype.validateColumnWidths = function () {\n        for (var i = 0; i < this.columns.length; i++) {\n            if (i === 0) {\n                if (this.columns[i].preferredWidth !== this.columns[i].endOffset) {\n                    this.columns[i].preferredWidth = this.columns[i].endOffset;\n                }\n            }\n            else {\n                // If Previous column offset + current column preferred width is less than current column offset, \n                // Then current column preferred width is set to current column offset - previous column offset.\n                if (this.columns[i - 1].endOffset + this.columns[i].preferredWidth < this.columns[i].endOffset) {\n                    this.columns[i].preferredWidth = this.columns[i].endOffset - this.columns[i - 1].endOffset;\n                }\n            }\n        }\n    };\n    /**\n     * @private\n     */\n    WTableHolder.prototype.clone = function () {\n        var tableHolder = new WTableHolder();\n        tableHolder.tableWidth = this.tableWidth;\n        for (var i = 0; i < this.columns.length; i++) {\n            tableHolder.columns.push(this.columns[i].clone());\n        }\n        return tableHolder;\n    };\n    /**\n     * @private\n     */\n    WTableHolder.prototype.destroy = function () {\n        if (!isNullOrUndefined(this.tableColumns)) {\n            for (var i = 0; i < this.tableColumns.length; i++) {\n                var column = this.tableColumns[i];\n                column.destroy();\n            }\n        }\n        this.tableColumns = [];\n        this.tableColumns = undefined;\n        this.tableWidth = undefined;\n    };\n    return WTableHolder;\n}());\nexport { WTableHolder };\n/**\n * @private\n */\nvar WColumn = /** @class */ (function () {\n    function WColumn() {\n        /**\n         * @private\n         */\n        this.preferredWidth = 0;\n        /**\n         * @private\n         */\n        this.minWidth = 0;\n        /**\n         * @private\n         */\n        this.maxWidth = 0;\n        /**\n         * @private\n         */\n        this.endOffset = 0;\n    }\n    /**\n     * @private\n     */\n    WColumn.prototype.clone = function () {\n        var column = new WColumn();\n        column.preferredWidth = this.preferredWidth;\n        column.minWidth = this.minWidth;\n        column.maxWidth = this.maxWidth;\n        return column;\n    };\n    /**\n     * @private\n     */\n    WColumn.prototype.destroy = function () {\n        this.preferredWidth = undefined;\n        this.minWidth = undefined;\n        this.maxWidth = undefined;\n    };\n    return WColumn;\n}());\nexport { WColumn };\n","import { ContextMenu as Menu } from '@syncfusion/ej2-navigations';\nimport { isNullOrUndefined, L10n, setCulture, classList } from '@syncfusion/ej2-base';\nimport { FieldElementBox } from './viewer/page';\nvar CONTEXTMENU_COPY = '_contextmenu_copy';\nvar CONTEXTMENU_CUT = '_contextmenu_cut';\nvar CONTEXTMENU_PASTE = '_contextmenu_paste';\nvar CONTEXTMENU_UPDATE_FIELD = '_contextmenu_update_field';\nvar CONTEXTMENU_EDIT_FIELD = '_contextmenu_edit_field';\nvar CONTEXTMENU_HYPERLINK = '_contextmenu_hyperlink';\nvar CONTEXTMENU_OPEN_HYPERLINK = '_contextmenu_open_hyperlink';\nvar CONTEXTMENU_COPY_HYPERLINK = '_contextmenu_copy_hyperlink';\nvar CONTEXTMENU_REMOVE_HYPERLINK = '_contextmenu_remove_hyperlink';\nvar CONTEXTMENU_EDIT_HYPERLINK = '_contextmenu_edit_hyperlink';\nvar CONTEXTMENU_FONT_DIALOG = '_contextmenu_font_dialog';\nvar CONTEXTMENU_PARAGRAPH = '_contextmenu_paragraph_dialog';\nvar CONTEXTMENU_TABLE = '_contextmenu_table_dialog';\nvar CONTEXTMENU_INSERT_TABLE = '_contextmenu_insert_table';\nvar CONTEXTMENU_DELETE_TABLE = '_contextmenu_delete_table';\nvar CONTEXTMENU_INSERT_ABOVE = '_contextmenu_insert_above';\nvar CONTEXTMENU_INSERT_BELOW = '_contextmenu_insert_below';\nvar CONTEXTMENU_INSERT_RIGHT = '_contextmenu_insert_right';\nvar CONTEXTMENU_INSERT_LEFT = '_contextmenu_insert_left';\nvar CONTEXTMENU_COMPLETE_DELETE_TABLE = '_contextmenu_complete_table_delete';\nvar CONTEXTMENU_DELETE_ROW = '_contextmenu_delete_row';\nvar CONTEXTMENU_DELETE_COLUMN = '_contextmenu_delete_column';\nvar CONTEXTMENU_MERGE_CELL = '_contextmenu_merge_cell';\nvar CONTEXTMENU_CONTINUE_NUMBERING = '_contextmenu_continue_numbering';\nvar CONTEXTMENU_RESTART_AT = '_contextmenu_restart_at';\n/**\n * Context Menu class\n */\nvar ContextMenu = /** @class */ (function () {\n    /**\n     * @private\n     */\n    function ContextMenu(viewer) {\n        var _this = this;\n        /**\n         * @private\n         */\n        this.contextMenuInstance = undefined;\n        /**\n         * Handles on context menu key pressed.\n         * @param  {PointerEvent} event\n         * @private\n         */\n        this.onContextMenuInternal = function (event) {\n            if (_this.showHideElements(_this.viewer.selection)) {\n                _this.contextMenuInstance.open(event.y, event.x);\n                event.preventDefault();\n            }\n        };\n        this.viewer = viewer;\n        var locale = new L10n('documenteditor', this.viewer.owner.defaultLocale);\n        locale.setLocale(this.viewer.owner.locale);\n        setCulture(this.viewer.owner.locale);\n        this.initContextMenu(locale);\n    }\n    /**\n     * Gets module name.\n     */\n    ContextMenu.prototype.getModuleName = function () {\n        return 'ContextMenu';\n    };\n    /**\n     * Initialize context menu.\n     * @param localValue Localize value.\n     * @private\n     */\n    // tslint:disable:max-func-body-length\n    ContextMenu.prototype.initContextMenu = function (localValue) {\n        var _this = this;\n        var id = this.viewer.owner.element.id;\n        this.contextMenu = document.createElement('div');\n        this.contextMenu.id = this.viewer.owner.containerId + 'e-de-contextmenu';\n        document.body.appendChild(this.contextMenu);\n        var ul = document.createElement('ul');\n        ul.style.width = 'auto';\n        ul.id = this.viewer.owner.containerId + 'e-de-contextmenu-list';\n        ul.style.listStyle = 'none';\n        ul.style.margin = '0px';\n        ul.style.padding = '0px';\n        ul.style.maxHeight = 'auto';\n        ul.oncontextmenu = this.disableBrowserContextmenu;\n        this.contextMenu.appendChild(ul);\n        var menuItems = [\n            {\n                text: localValue.getConstant('Cut'),\n                iconCss: 'e-icons e-de-cut',\n                id: id + CONTEXTMENU_CUT\n            },\n            {\n                text: localValue.getConstant('Copy'),\n                iconCss: 'e-icons e-de-copy',\n                id: id + CONTEXTMENU_COPY\n            },\n            {\n                text: localValue.getConstant('Paste'),\n                iconCss: 'e-icons e-de-paste',\n                id: id + CONTEXTMENU_PASTE\n            },\n            {\n                separator: true\n            },\n            {\n                text: localValue.getConstant('Update Field'),\n                iconCss: 'e-icons e-de-update_field',\n                id: id + CONTEXTMENU_UPDATE_FIELD\n            },\n            {\n                text: localValue.getConstant('Edit Field'),\n                iconCss: 'e-icons e-de-edit_field',\n                id: id + CONTEXTMENU_EDIT_FIELD\n            },\n            {\n                text: localValue.getConstant('Continue Numbering'),\n                iconCss: 'e-icons e-de-continue-numbering',\n                id: id + CONTEXTMENU_CONTINUE_NUMBERING\n            },\n            {\n                text: localValue.getConstant('Restart At') + ' 1',\n                iconCss: 'e-icons e-de-restart-at',\n                id: id + CONTEXTMENU_RESTART_AT\n            },\n            {\n                separator: true\n            },\n            {\n                text: localValue.getConstant('Hyperlink'),\n                iconCss: 'e-icons e-de-insertlink',\n                id: id + CONTEXTMENU_HYPERLINK\n            },\n            {\n                text: localValue.getConstant('Edit Hyperlink') + '...',\n                iconCss: 'e-icons e-de-edit-hyperlink',\n                id: id + CONTEXTMENU_EDIT_HYPERLINK\n            },\n            {\n                text: localValue.getConstant('Open Hyperlink'),\n                iconCss: 'e-icons e-de-open-hyperlink',\n                id: id + CONTEXTMENU_OPEN_HYPERLINK\n            },\n            {\n                text: localValue.getConstant('Copy Hyperlink'),\n                iconCss: 'e-icons e-de-copy-hyperlink',\n                id: id + CONTEXTMENU_COPY_HYPERLINK\n            },\n            {\n                text: localValue.getConstant('Remove Hyperlink'),\n                iconCss: 'e-icons e-de-remove-hyperlink',\n                id: id + CONTEXTMENU_REMOVE_HYPERLINK\n            },\n            {\n                separator: true\n            },\n            {\n                text: localValue.getConstant('Font'),\n                iconCss: 'e-icons e-de-fonts',\n                id: id + CONTEXTMENU_FONT_DIALOG\n            },\n            {\n                text: localValue.getConstant('Paragraph'),\n                iconCss: 'e-icons e-de-paragraph',\n                id: id + CONTEXTMENU_PARAGRAPH\n            },\n            {\n                separator: true,\n            },\n            {\n                text: localValue.getConstant('Table Properties'),\n                id: id + CONTEXTMENU_TABLE,\n                iconCss: 'e-icons e-de-table'\n            },\n            {\n                text: localValue.getConstant('Merge Cells'),\n                id: id + CONTEXTMENU_MERGE_CELL,\n                iconCss: 'e-icons e-de-icon-table-merge-cells'\n            },\n            {\n                text: localValue.getConstant('Insert'),\n                id: id + CONTEXTMENU_INSERT_TABLE,\n                iconCss: 'e-icons',\n                items: [\n                    {\n                        text: localValue.getConstant('Insert Above'),\n                        id: id + CONTEXTMENU_INSERT_ABOVE,\n                        iconCss: 'e-icons e-de-insertabove'\n                    },\n                    {\n                        text: localValue.getConstant('Insert Below'),\n                        id: id + CONTEXTMENU_INSERT_BELOW,\n                        iconCss: 'e-icons e-de-insertbelow'\n                    },\n                    {\n                        text: localValue.getConstant('Insert Left'),\n                        id: id + CONTEXTMENU_INSERT_LEFT,\n                        iconCss: 'e-icons e-de-insertleft'\n                    },\n                    {\n                        text: localValue.getConstant('Insert Right'),\n                        id: id + CONTEXTMENU_INSERT_RIGHT,\n                        iconCss: 'e-icons e-de-insertright'\n                    }\n                ]\n            },\n            {\n                text: localValue.getConstant('Delete'),\n                id: id + CONTEXTMENU_DELETE_TABLE,\n                iconCss: 'e-icons',\n                items: [\n                    {\n                        text: localValue.getConstant('Delete Table'),\n                        id: id + CONTEXTMENU_COMPLETE_DELETE_TABLE,\n                        iconCss: 'e-icons e-de-delete-table'\n                    },\n                    {\n                        text: localValue.getConstant('Delete Row'),\n                        id: id + CONTEXTMENU_DELETE_ROW,\n                        iconCss: 'e-icons e-de-deleterow'\n                    },\n                    {\n                        text: localValue.getConstant('Delete Column'),\n                        id: id + CONTEXTMENU_DELETE_COLUMN,\n                        iconCss: 'e-icons e-de-deletecolumn'\n                    }\n                ]\n            },\n        ];\n        var menuOptions = {\n            target: '#' + this.viewer.owner.containerId + 'e-de-contextmenu',\n            items: menuItems,\n            select: function (args) {\n                var item = args.element.id;\n                _this.handleContextMenuItem(item);\n            },\n        };\n        this.contextMenuInstance = new Menu(menuOptions, '#' + this.viewer.owner.containerId + 'e-de-contextmenu-list');\n        this.contextMenuInstance.beforeOpen = function () {\n            if (_this.viewer && _this.viewer.selection) {\n                classList(_this.viewer.selection.caret, [], ['e-de-cursor-animation']);\n                _this.viewer.selection.showCaret();\n            }\n        };\n        this.contextMenuInstance.onClose = function () {\n            if (_this.viewer && _this.viewer.selection) {\n                classList(_this.viewer.selection.caret, ['e-de-cursor-animation'], []);\n                _this.viewer.updateFocus();\n            }\n        };\n    };\n    /**\n     * Disable browser context menu.\n     */\n    ContextMenu.prototype.disableBrowserContextmenu = function () {\n        return false;\n    };\n    /**\n     * Handles context menu items.\n     * @param  {string} item Specifies which item is selected.\n     * @private\n     */\n    ContextMenu.prototype.handleContextMenuItem = function (item) {\n        var id = this.viewer.owner.element.id;\n        switch (item) {\n            case id + CONTEXTMENU_COPY:\n                this.viewer.selection.copy();\n                break;\n            case id + CONTEXTMENU_CUT:\n                this.viewer.owner.editor.cut();\n                break;\n            case id + CONTEXTMENU_PASTE:\n                if (!this.viewer.owner.isReadOnlyMode) {\n                    this.viewer.owner.editorModule.pasteInternal(undefined);\n                }\n                break;\n            case id + CONTEXTMENU_UPDATE_FIELD:\n                if (!this.viewer.owner.isReadOnlyMode) {\n                    this.viewer.owner.editorModule.updateToc();\n                }\n                break;\n            case id + CONTEXTMENU_EDIT_FIELD:\n                if (!this.viewer.owner.isReadOnlyMode) {\n                    this.viewer.owner.tableOfContentsDialogModule.show();\n                }\n                break;\n            case id + CONTEXTMENU_FONT_DIALOG:\n                if (this.viewer.owner.fontDialogModule) {\n                    this.viewer.owner.fontDialogModule.showFontDialog();\n                }\n                break;\n            case id + CONTEXTMENU_OPEN_HYPERLINK:\n                this.viewer.selection.navigateHyperlink();\n                break;\n            case id + CONTEXTMENU_COPY_HYPERLINK:\n                this.viewer.selection.copyHyperlink();\n                break;\n            case id + CONTEXTMENU_EDIT_HYPERLINK:\n            case id + CONTEXTMENU_HYPERLINK:\n                if (this.viewer.owner.hyperlinkDialogModule) {\n                    this.viewer.owner.hyperlinkDialogModule.show();\n                }\n                break;\n            case id + CONTEXTMENU_REMOVE_HYPERLINK:\n                this.viewer.owner.editor.removeHyperlink();\n                break;\n            case id + CONTEXTMENU_PARAGRAPH:\n                if (this.viewer.owner.paragraphDialogModule) {\n                    this.viewer.owner.paragraphDialogModule.show();\n                }\n                break;\n            case id + CONTEXTMENU_TABLE:\n                this.viewer.owner.tablePropertiesDialogModule.show();\n                break;\n            case id + CONTEXTMENU_MERGE_CELL:\n                this.viewer.owner.editor.mergeCells();\n                break;\n            case id + CONTEXTMENU_INSERT_ABOVE:\n                this.viewer.owner.editor.insertRow(true);\n                break;\n            case id + CONTEXTMENU_INSERT_BELOW:\n                this.viewer.owner.editor.insertRow(false);\n                break;\n            case id + CONTEXTMENU_INSERT_LEFT:\n                this.viewer.owner.editor.insertColumn(true);\n                break;\n            case id + CONTEXTMENU_INSERT_RIGHT:\n                this.viewer.owner.editor.insertColumn(false);\n                break;\n            case id + CONTEXTMENU_COMPLETE_DELETE_TABLE:\n                this.viewer.owner.editor.deleteTable();\n                break;\n            case id + CONTEXTMENU_DELETE_ROW:\n                this.viewer.owner.editor.deleteRow();\n                break;\n            case id + CONTEXTMENU_DELETE_COLUMN:\n                this.viewer.owner.editor.deleteColumn();\n                break;\n            case id + CONTEXTMENU_CONTINUE_NUMBERING:\n                this.viewer.owner.editorModule.applyContinueNumbering(this.viewer.selection);\n                break;\n            case id + CONTEXTMENU_RESTART_AT:\n                this.viewer.owner.editorModule.applyRestartNumbering(this.viewer.selection);\n                break;\n        }\n    };\n    ContextMenu.prototype.showHideElements = function (selection) {\n        var owner = this.viewer.owner;\n        var id = owner.element.id;\n        var copy = document.getElementById(id + CONTEXTMENU_COPY);\n        var cut = document.getElementById(id + CONTEXTMENU_CUT);\n        var paste = document.getElementById(id + CONTEXTMENU_PASTE);\n        var updateField = document.getElementById(id + CONTEXTMENU_UPDATE_FIELD);\n        var editField = document.getElementById(id + CONTEXTMENU_EDIT_FIELD);\n        var font = document.getElementById(id + CONTEXTMENU_FONT_DIALOG);\n        var paragraph = document.getElementById(id + CONTEXTMENU_PARAGRAPH);\n        var tableProperties = document.getElementById(id + CONTEXTMENU_TABLE);\n        var insertTable = document.getElementById(id + CONTEXTMENU_INSERT_TABLE);\n        var deleteTable = document.getElementById(id + CONTEXTMENU_DELETE_TABLE);\n        var mergeCells = document.getElementById(id + CONTEXTMENU_MERGE_CELL);\n        var hyperlink = document.getElementById(id + CONTEXTMENU_HYPERLINK);\n        var openHyperlink = document.getElementById(id + CONTEXTMENU_OPEN_HYPERLINK);\n        var editHyperlink = document.getElementById(id + CONTEXTMENU_EDIT_HYPERLINK);\n        var copyHyperlink = document.getElementById(id + CONTEXTMENU_COPY_HYPERLINK);\n        var removeHyperlink = document.getElementById(id + CONTEXTMENU_REMOVE_HYPERLINK);\n        var continueNumbering = document.getElementById(id + CONTEXTMENU_CONTINUE_NUMBERING);\n        var restartAt = document.getElementById(id + CONTEXTMENU_RESTART_AT);\n        cut.style.display = 'none';\n        paste.style.display = 'none';\n        paste.nextSibling.style.display = 'none';\n        hyperlink.style.display = 'none';\n        openHyperlink.style.display = 'none';\n        copyHyperlink.style.display = 'none';\n        editHyperlink.style.display = 'none';\n        removeHyperlink.style.display = 'none';\n        removeHyperlink.nextSibling.style.display = 'none';\n        mergeCells.style.display = 'none';\n        font.style.display = 'none';\n        paragraph.style.display = 'none';\n        paragraph.nextSibling.style.display = 'none';\n        insertTable.style.display = 'none';\n        deleteTable.style.display = 'none';\n        tableProperties.style.display = 'none';\n        updateField.style.display = 'none';\n        editField.style.display = 'none';\n        continueNumbering.style.display = 'none';\n        restartAt.style.display = 'none';\n        restartAt.nextSibling.style.display = 'none';\n        if (isNullOrUndefined(selection)) {\n            return false;\n        }\n        selection.hideToolTip();\n        if (selection.isEmpty) {\n            cut.classList.add('e-disabled');\n            copy.classList.add('e-disabled');\n        }\n        else {\n            cut.classList.remove('e-disabled');\n            copy.classList.remove('e-disabled');\n        }\n        if (owner.isReadOnlyMode) {\n            return true;\n        }\n        cut.style.display = 'block';\n        paste.style.display = 'block';\n        paste.nextSibling.style.display = 'block';\n        insertTable.classList.add('e-blankicon');\n        deleteTable.classList.add('e-blankicon');\n        updateField.classList.add('e-blankicon');\n        editField.classList.add('e-blankicon');\n        if (owner.enableLocalPaste && !isNullOrUndefined(owner.editor.copiedData)) {\n            paste.classList.remove('e-disabled');\n        }\n        else {\n            paste.classList.add('e-disabled');\n        }\n        if (selection.contextType === 'TableOfContents') {\n            updateField.style.display = 'block';\n            editField.style.display = 'block';\n            restartAt.nextSibling.style.display = 'block';\n        }\n        else {\n            var start = selection.start;\n            var end = selection.end;\n            if (selection.contextType === 'List'\n                && owner.editorModule.getListLevel(start.paragraph).listLevelPattern !== 'Bullet') {\n                continueNumbering.style.display = 'block';\n                restartAt.style.display = 'block';\n                restartAt.nextSibling.style.display = 'block';\n            }\n            var isCellOrRowSelected = start.paragraph.isInsideTable && (!end.paragraph.isInsideTable\n                || start.paragraph.associatedCell !== end.paragraph.associatedCell\n                || selection.isCellSelected(start.paragraph.associatedCell, start, end));\n            if (isCellOrRowSelected) {\n                hyperlink.classList.add('e-disabled');\n            }\n            else {\n                if (hyperlink.classList.contains('e-disabled')) {\n                    hyperlink.classList.remove('e-disabled');\n                }\n            }\n            var field = selection.getHyperlinkField();\n            if (field instanceof FieldElementBox && !selection.isImageField()) {\n                openHyperlink.style.display = 'block';\n                copyHyperlink.style.display = 'block';\n                if (owner.hyperlinkDialogModule) {\n                    editHyperlink.style.display = 'block';\n                }\n                removeHyperlink.style.display = 'block';\n                removeHyperlink.nextSibling.style.display = 'block';\n            }\n            else {\n                if (owner.hyperlinkDialogModule) {\n                    hyperlink.style.display = 'block';\n                }\n            }\n        }\n        if (this.viewer.owner.selection.start.paragraph.isInsideTable\n            && this.viewer.owner.selection.end.paragraph.isInsideTable) {\n            paragraph.nextSibling.style.display = 'block';\n            if (owner.tablePropertiesDialogModule) {\n                tableProperties.style.display = 'block';\n            }\n            insertTable.style.display = 'block';\n            deleteTable.style.display = 'block';\n            if (this.viewer.owner.editor.canMergeCells()) {\n                mergeCells.style.display = 'block';\n            }\n        }\n        else {\n            if (this.viewer.owner.fontDialogModule) {\n                font.style.display = 'block';\n                font.previousSibling.style.display = 'block';\n            }\n            if (this.viewer.owner.paragraphDialogModule) {\n                paragraph.style.display = 'block';\n            }\n        }\n        if (selection.contextType === 'Image') {\n            font.style.display = 'none';\n            paragraph.style.display = 'none';\n            removeHyperlink.nextSibling.style.display = 'none';\n        }\n        return true;\n    };\n    /**\n     * Disposes the internal objects which are maintained.\n     * @private\n     */\n    ContextMenu.prototype.destroy = function () {\n        if (this.contextMenuInstance) {\n            this.contextMenuInstance.destroy();\n        }\n        if (this.contextMenu) {\n            if (this.contextMenu.parentElement) {\n                this.contextMenu.parentElement.removeChild(this.contextMenu);\n            }\n            this.contextMenu.innerHTML = '';\n        }\n        this.contextMenu = undefined;\n        this.contextMenuInstance = undefined;\n    };\n    return ContextMenu;\n}());\nexport { ContextMenu };\n","import { isNullOrUndefined } from '@syncfusion/ej2-base';\n/**\n * @private\n */\nvar WAbstractList = /** @class */ (function () {\n    function WAbstractList() {\n        this.abstractListIdIn = -1;\n        this.levels = [];\n    }\n    Object.defineProperty(WAbstractList.prototype, \"abstractListId\", {\n        get: function () {\n            return this.abstractListIdIn;\n        },\n        set: function (abstractListId) {\n            this.abstractListIdIn = abstractListId;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    WAbstractList.prototype.destroy = function () {\n        if (!isNullOrUndefined(this.levels)) {\n            for (var i = 0; i < this.levels.length; i++) {\n                var listLevel = this.levels[i];\n                listLevel.destroy();\n                this.levels.splice(this.levels.indexOf(listLevel), 1);\n                i--;\n            }\n            this.levels = [];\n        }\n        this.levels = undefined;\n    };\n    return WAbstractList;\n}());\nexport { WAbstractList };\n","import { Dictionary } from '../../base/dictionary';\nimport { WUniqueFormat } from '../../base/unique-format';\nimport { WUniqueFormats } from '../../base/unique-formats';\nimport { WCharacterFormat } from '../format/character-format';\nimport { WParagraphFormat } from '../format/paragraph-format';\nimport { WAbstractList } from './abstract-list';\nimport { isNullOrUndefined } from '@syncfusion/ej2-base';\n/**\n * @private\n */\nvar WListLevel = /** @class */ (function () {\n    function WListLevel(node) {\n        this.uniqueListLevel = undefined;\n        this.paragraphFormat = undefined;\n        this.characterFormat = undefined;\n        if (node instanceof WAbstractList) {\n            this.ownerBase = node;\n        }\n        else {\n            this.ownerBase = node;\n        }\n        this.characterFormat = new WCharacterFormat(undefined);\n        this.paragraphFormat = new WParagraphFormat(undefined);\n    }\n    Object.defineProperty(WListLevel.prototype, \"listLevelPattern\", {\n        get: function () {\n            return this.getPropertyValue('listLevelPattern');\n        },\n        set: function (listLevelPattern) {\n            this.setPropertyValue('listLevelPattern', listLevelPattern);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(WListLevel.prototype, \"followCharacter\", {\n        get: function () {\n            return this.getPropertyValue('followCharacter');\n        },\n        set: function (followCharacter) {\n            this.setPropertyValue('followCharacter', followCharacter);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(WListLevel.prototype, \"startAt\", {\n        get: function () {\n            return this.getPropertyValue('startAt');\n        },\n        set: function (startAt) {\n            this.setPropertyValue('startAt', startAt);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(WListLevel.prototype, \"numberFormat\", {\n        get: function () {\n            return this.getPropertyValue('numberFormat');\n        },\n        set: function (numberFormat) {\n            this.setPropertyValue('numberFormat', numberFormat);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(WListLevel.prototype, \"restartLevel\", {\n        get: function () {\n            return this.getPropertyValue('restartLevel');\n        },\n        set: function (restartLevel) {\n            this.setPropertyValue('restartLevel', restartLevel);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    WListLevel.prototype.getPropertyValue = function (property) {\n        var propertyType = WUniqueFormat.getPropertyType(WListLevel.uniqueFormatType, property);\n        if (!isNullOrUndefined(this.uniqueListLevel) && this.uniqueListLevel.propertiesHash.containsKey(propertyType)) {\n            return this.uniqueListLevel.propertiesHash.get(propertyType);\n        }\n        return WListLevel.getPropertyDefaultValue(property);\n    };\n    WListLevel.prototype.setPropertyValue = function (property, value) {\n        if (isNullOrUndefined(value) || value === '') {\n            value = WListLevel.getPropertyDefaultValue(property);\n        }\n        if (isNullOrUndefined(this.uniqueListLevel)) {\n            this.initializeUniqueWListLevel(property, value);\n        }\n        else {\n            var propertyType = WUniqueFormat.getPropertyType(this.uniqueListLevel.uniqueFormatType, property);\n            if (this.uniqueListLevel.propertiesHash.containsKey(propertyType) &&\n                // tslint:disable-next-line:max-line-length\n                this.uniqueListLevel.propertiesHash.get(propertyType) === value) {\n                return;\n            }\n            // tslint:disable-next-line:max-line-length\n            this.uniqueListLevel = WListLevel.uniqueListLevels.updateUniqueFormat(this.uniqueListLevel, property, value);\n        }\n    };\n    WListLevel.prototype.initializeUniqueWListLevel = function (property, propValue) {\n        var uniqueListLevelTemp = new Dictionary();\n        this.addUniqueWListLevel('listLevelPattern', property, propValue, uniqueListLevelTemp);\n        this.addUniqueWListLevel('startAt', property, propValue, uniqueListLevelTemp);\n        this.addUniqueWListLevel('followCharacter', property, propValue, uniqueListLevelTemp);\n        this.addUniqueWListLevel('numberFormat', property, propValue, uniqueListLevelTemp);\n        this.addUniqueWListLevel('restartLevel', property, propValue, uniqueListLevelTemp);\n        // tslint:disable-next-line:max-line-length    \n        this.uniqueListLevel = WListLevel.uniqueListLevels.addUniqueFormat(uniqueListLevelTemp, WListLevel.uniqueFormatType);\n    };\n    // tslint:disable-next-line:max-line-length\n    WListLevel.prototype.addUniqueWListLevel = function (property, modifiedProperty, propValue, uniqueCharFormatTemp) {\n        var propertyType;\n        propertyType = WUniqueFormat.getPropertyType(WListLevel.uniqueFormatType, property);\n        if (property === modifiedProperty) {\n            uniqueCharFormatTemp.add(propertyType, propValue);\n        }\n        else {\n            uniqueCharFormatTemp.add(propertyType, WListLevel.getPropertyDefaultValue(property));\n        }\n    };\n    WListLevel.getPropertyDefaultValue = function (property) {\n        var value = undefined;\n        switch (property) {\n            case 'listLevelPattern':\n                value = 'Arabic';\n                break;\n            case 'startAt':\n                value = 0;\n                break;\n            case 'followCharacter':\n                value = 'Tab';\n                break;\n            case 'numberFormat':\n                value = '';\n                break;\n            case 'restartLevel':\n                value = 0;\n                break;\n        }\n        return value;\n    };\n    WListLevel.prototype.destroy = function () {\n        if (!isNullOrUndefined(this.characterFormat)) {\n            this.characterFormat.destroy();\n        }\n        if (!isNullOrUndefined(this.paragraphFormat)) {\n            this.paragraphFormat.destroy();\n        }\n        if (!isNullOrUndefined(this.uniqueListLevel)) {\n            WListLevel.uniqueListLevels.remove(this.uniqueListLevel);\n        }\n        this.uniqueListLevel = undefined;\n        this.characterFormat = undefined;\n        this.paragraphFormat = undefined;\n    };\n    WListLevel.clear = function () {\n        this.uniqueListLevels.clear();\n    };\n    WListLevel.dotBullet = '\\uf0b7';\n    WListLevel.squareBullet = '\\uf0a7'; //Symbol font \\u25aa.\n    WListLevel.arrowBullet = '\\u27a4';\n    WListLevel.circleBullet = '\\uf06f' + '\\u0020';\n    WListLevel.uniqueListLevels = new WUniqueFormats();\n    WListLevel.uniqueFormatType = 9;\n    return WListLevel;\n}());\nexport { WListLevel };\n","import { Dictionary } from '../../base/dictionary';\nimport { WListLevel } from '../list/list-level';\nimport { WCharacterFormat, WParagraphFormat } from '../format/index';\nimport { WBorder } from '../format/index';\nimport { PageLayoutViewer } from './viewer';\nimport { LineWidget, Rect, Widget, Margin, ParagraphWidget, BodyWidget, TextElementBox, ElementBox, ListTextElementBox, TableCellWidget, TableRowWidget, TableWidget, FieldElementBox, BlockWidget, HeaderFooterWidget, BlockContainer, BookmarkElementBox, FieldTextElementBox, TabElementBox } from './page';\nimport { HelperMethods } from '../editor/editor-helper';\nimport { isNullOrUndefined } from '@syncfusion/ej2-base';\n/**\n * @private\n */\nvar Layout = /** @class */ (function () {\n    /**\n     * viewer definition\n     */\n    function Layout(viewer) {\n        /**\n         * @private\n         */\n        this.allowLayout = true;\n        /**\n         * @private\n         */\n        this.isInitialLoad = true;\n        this.fieldBegin = undefined;\n        this.maxTextHeight = 0;\n        this.maxBaseline = 0;\n        this.maxTextBaseline = 0;\n        this.isFieldCode = false;\n        this.viewer = viewer;\n    }\n    /**\n     * @private\n     */\n    Layout.prototype.layout = function () {\n        // Todo: Need to handle complete document layout(relayout).\n        var page = this.viewer.pages[0];\n        var body = page.bodyWidgets[0];\n    };\n    /**\n     * Releases un-managed and - optionally - managed resources.\n     */\n    Layout.prototype.destroy = function () {\n        this.viewer = undefined;\n        this.value = undefined;\n        this.allowLayout = undefined;\n        this.isInitialLoad = undefined;\n        this.fieldBegin = undefined;\n        this.maxTextHeight = undefined;\n        this.maxBaseline = undefined;\n        this.maxTextBaseline = undefined;\n        this.isFieldCode = undefined;\n    };\n    /**\n     * Layouts the items\n     * @private\n     */\n    Layout.prototype.layoutItems = function (sections) {\n        var page;\n        for (var i = 0; i < sections.length; i++) {\n            var section = sections[i];\n            page = this.viewer.createNewPage(section);\n            this.addBodyWidget(this.viewer.clientActiveArea, section);\n            if (this.viewer.pages.length > 1) {\n                var pageIndex = 0;\n                for (var i_1 = 0; i_1 < this.viewer.pages.length; i_1++) {\n                    var prevPage = this.viewer.pages[i_1];\n                    var prevSectionIndex = prevPage.sectionIndex;\n                    var index = section.index;\n                    if (prevSectionIndex > index || prevPage === page) {\n                        break;\n                    }\n                    pageIndex++;\n                }\n                if (pageIndex < this.viewer.pages.length - 1) {\n                    this.viewer.insertPage(pageIndex, page);\n                }\n            }\n            this.layoutSection(section, 0, this.viewer);\n        }\n        this.updateFieldElements();\n        this.viewer.updateScrollBars();\n        this.isInitialLoad = false;\n    };\n    /**\n     * Layouts the items\n     * @param section\n     * @param viewer\n     * @private\n     */\n    Layout.prototype.layoutSection = function (section, index, viewer, ownerWidget) {\n        var block = section.firstChild;\n        var nextBlock;\n        do {\n            this.viewer.updateClientAreaForBlock(block, true);\n            nextBlock = this.layoutBlock(block, index);\n            index = 0;\n            this.viewer.updateClientAreaForBlock(block, false);\n            block = nextBlock;\n        } while (block);\n    };\n    /**\n     * Layouts the header footer items\n     * @param section\n     * @param viewer\n     * @private\n     */\n    Layout.prototype.layoutHeaderFooter = function (section, viewer, page) {\n        //Header layout\n        var headerFooterWidget = viewer.getCurrentPageHeaderFooter(section, true);\n        if (headerFooterWidget) {\n            var header = headerFooterWidget.clone();\n            header.page = page;\n            viewer.updateHFClientArea(section.sectionFormat, true);\n            page.headerWidget = this.layoutHeaderFooterItems(viewer, header);\n            this.updateHeaderFooterToParent(header);\n        }\n        //Footer Layout\n        headerFooterWidget = viewer.getCurrentPageHeaderFooter(section, false);\n        if (headerFooterWidget) {\n            var footer = headerFooterWidget.clone();\n            footer.page = page;\n            viewer.updateHFClientArea(section.sectionFormat, false);\n            page.footerWidget = this.layoutHeaderFooterItems(viewer, footer);\n            this.updateHeaderFooterToParent(footer);\n        }\n    };\n    /**\n     * @private\n     */\n    Layout.prototype.updateHeaderFooterToParent = function (node) {\n        var sectionIndex = node.page.sectionIndex;\n        var typeIndex = this.viewer.getHeaderFooter(node.headerFooterType);\n        var clone = node.clone();\n        this.viewer.headersFooters[sectionIndex][typeIndex] = clone;\n        for (var j = 0; j < clone.childWidgets.length; j++) {\n            var child = clone.childWidgets[j];\n            if (child instanceof TableWidget) {\n                this.clearTableWidget(child, false, true);\n            }\n        }\n        return clone;\n    };\n    Layout.prototype.linkFieldInHeaderFooter = function (widget) {\n        var firstChild = widget.firstChild;\n        do {\n            if (firstChild instanceof ParagraphWidget) {\n                this.linkFieldInParagraph(firstChild);\n            }\n            else {\n                this.linkFieldInTable(firstChild);\n            }\n            //tslint:disable:no-conditional-assignment\n        } while (firstChild = firstChild.nextWidget);\n    };\n    /**\n     * @private\n     */\n    Layout.prototype.linkFieldInParagraph = function (widget) {\n        for (var j = 0; j < widget.childWidgets.length; j++) {\n            var line = widget.childWidgets[j];\n            for (var i = 0; i < line.children.length; i++) {\n                var element = line.children[i];\n                if (element instanceof FieldElementBox && element.fieldType !== 0) {\n                    element.linkFieldCharacter(this.viewer);\n                }\n            }\n        }\n    };\n    /**\n     * @private\n     */\n    Layout.prototype.linkFieldInTable = function (widget) {\n        for (var i = 0; i < widget.childWidgets.length; i++) {\n            var row = widget.childWidgets[i];\n            for (var j = 0; j < row.childWidgets.length; j++) {\n                var cell = row.childWidgets[j];\n                for (var k = 0; k < cell.childWidgets.length; k++) {\n                    var block = cell.childWidgets[k];\n                    if (block instanceof ParagraphWidget) {\n                        this.linkFieldInParagraph(block);\n                    }\n                    else {\n                        this.linkFieldInTable(block);\n                    }\n                }\n            }\n        }\n    };\n    /**\n     * Layouts the header footer items.\n     * @param viewer\n     * @param hfModule\n     * @private\n     */\n    Layout.prototype.layoutHeaderFooterItems = function (viewer, widget) {\n        this.viewer.updateClientAreaLocation(widget, viewer.clientActiveArea);\n        if (widget.childWidgets.length === 0) {\n            var pargaraph = new ParagraphWidget();\n            var line = new LineWidget(pargaraph);\n            pargaraph.childWidgets.push(line);\n            widget.childWidgets.push(pargaraph);\n            pargaraph.containerWidget = widget;\n        }\n        this.linkFieldInHeaderFooter(widget);\n        for (var i = 0; i < widget.childWidgets.length; i++) {\n            var block = widget.childWidgets[i];\n            viewer.updateClientAreaForBlock(block, true);\n            this.layoutBlock(block, 0);\n            viewer.updateClientAreaForBlock(block, false);\n        }\n        var type = widget.headerFooterType;\n        if (type === 'OddFooter' || type === 'EvenFooter' || type === 'FirstPageFooter') {\n            this.shiftChildLocation(viewer.clientArea.y - viewer.clientActiveArea.y, widget);\n        }\n        return widget;\n    };\n    /**\n     * Shifts the child location\n     * @param shiftTop\n     * @param bodyWidget\n     */\n    Layout.prototype.shiftChildLocation = function (shiftTop, bodyWidget) {\n        var widgetTop = bodyWidget.y + shiftTop;\n        var footerMaxHeight = bodyWidget.page.boundingRectangle.height - (bodyWidget.page.boundingRectangle.height / 100) * 40;\n        widgetTop = Math.max(widgetTop, footerMaxHeight);\n        shiftTop = widgetTop - bodyWidget.y;\n        bodyWidget.y = widgetTop;\n        for (var i = 0; i < bodyWidget.childWidgets.length; i++) {\n            var childWidget = bodyWidget.childWidgets[i];\n            if (childWidget instanceof ParagraphWidget) {\n                childWidget.x = childWidget.x;\n                childWidget.y = childWidget.y + shiftTop;\n            }\n            else {\n                this.shiftChildLocationForTableWidget(childWidget, shiftTop);\n            }\n        }\n    };\n    /**\n     * Shifts the child location for table widget.\n     * @param tableWidget\n     * @param shiftTop\n     */\n    Layout.prototype.shiftChildLocationForTableWidget = function (tableWidget, shiftTop) {\n        tableWidget.y = tableWidget.y + shiftTop;\n        for (var i = 0; i < tableWidget.childWidgets.length; i++) {\n            var childWidget = tableWidget.childWidgets[i];\n            if (childWidget instanceof TableRowWidget) {\n                this.shiftChildLocationForTableRowWidget(childWidget, shiftTop);\n            }\n        }\n    };\n    /**\n     * Shifts the child location for table row widget.\n     * @param rowWidget\n     * @param shiftTop\n     */\n    Layout.prototype.shiftChildLocationForTableRowWidget = function (rowWidget, shiftTop) {\n        rowWidget.y = rowWidget.y + shiftTop;\n        for (var i = 0; i < rowWidget.childWidgets.length; i++) {\n            this.shiftChildLocationForTableCellWidget(rowWidget.childWidgets[i], shiftTop);\n        }\n    };\n    /**\n     * Shifts the child location for table cell widget.\n     * @param cellWidget\n     * @param shiftTop\n     */\n    Layout.prototype.shiftChildLocationForTableCellWidget = function (cellWidget, shiftTop) {\n        cellWidget.y = cellWidget.y + shiftTop;\n        for (var i = 0; i < cellWidget.childWidgets.length; i++) {\n            if (cellWidget.childWidgets[i] instanceof ParagraphWidget) {\n                cellWidget.childWidgets[i].x = cellWidget.childWidgets[i].x;\n                cellWidget.childWidgets[i].y = cellWidget.childWidgets[i].y + shiftTop;\n            }\n            else {\n                this.shiftChildLocationForTableWidget(cellWidget.childWidgets[i], shiftTop);\n            }\n        }\n    };\n    /**\n     * Layouts specified block.\n     * @param block\n     * @private\n     */\n    Layout.prototype.layoutBlock = function (block, index, moveToLine) {\n        var nextBlock;\n        if (block instanceof ParagraphWidget) {\n            nextBlock = this.layoutParagraph(block, index);\n        }\n        else {\n            nextBlock = this.layoutTable(block, index);\n        }\n        return nextBlock.nextRenderedWidget;\n    };\n    /**\n     * Adds paragraph widget.\n     * @param area\n     */\n    Layout.prototype.addParagraphWidget = function (area, paragraphWidget) {\n        var ownerParaWidget = undefined;\n        if (paragraphWidget.isEmpty() && !isNullOrUndefined(paragraphWidget.paragraphFormat) &&\n            (paragraphWidget.paragraphFormat.textAlignment === 'Center' || paragraphWidget.paragraphFormat.textAlignment === 'Right') &&\n            paragraphWidget.paragraphFormat.listFormat.listId === -1) {\n            var top_1 = 0;\n            var bottom = 0;\n            var width = this.viewer.textHelper.getParagraphMarkWidth(paragraphWidget.characterFormat);\n            var left = area.x;\n            if (paragraphWidget.paragraphFormat.textAlignment === 'Center') {\n                left += (area.width - width) / 2;\n            }\n            else {\n                left += area.width - width;\n            }\n            paragraphWidget.width = width;\n            paragraphWidget.x = left;\n            paragraphWidget.y = area.y;\n        }\n        else {\n            paragraphWidget.width = area.width;\n            paragraphWidget.x = area.x;\n            paragraphWidget.y = area.y;\n        }\n        return paragraphWidget;\n    };\n    /**\n     * Adds line widget.\n     * @param paragraph\n     */\n    Layout.prototype.addLineWidget = function (paragraphWidget) {\n        var line = undefined;\n        line = new LineWidget(paragraphWidget);\n        line.width = paragraphWidget.width;\n        paragraphWidget.childWidgets.push(line);\n        line.paragraph = paragraphWidget;\n        return line;\n    };\n    /**\n     * Layouts specified paragraph.\n     * @private\n     * @param paragraph\n     */\n    Layout.prototype.layoutParagraph = function (paragraph, lineIndex) {\n        this.addParagraphWidget(this.viewer.clientActiveArea, paragraph);\n        this.layoutListItems(paragraph);\n        if (paragraph.isEmpty()) {\n            this.layoutEmptyLineWidget(paragraph, true);\n        }\n        else {\n            var line = lineIndex < paragraph.childWidgets.length ?\n                paragraph.childWidgets[lineIndex] : undefined;\n            while (line instanceof LineWidget) {\n                if (line.isFirstLine() && isNullOrUndefined(this.fieldBegin)) {\n                    if (!isNullOrUndefined(paragraph.paragraphFormat)) {\n                        // tslint:disable-next-line:max-line-length\n                        var firstLineIndent = -HelperMethods.convertPointToPixel(paragraph.paragraphFormat.firstLineIndent);\n                        this.viewer.updateClientWidth(firstLineIndent);\n                    }\n                }\n                line = this.layoutLine(line, 0);\n                paragraph = line.paragraph;\n                line = line.nextLine;\n            }\n        }\n        this.updateWidgetToPage(this.viewer, paragraph);\n        return paragraph;\n    };\n    Layout.prototype.clearLineMeasures = function () {\n        this.maxBaseline = 0;\n        this.maxTextBaseline = 0;\n        this.maxTextHeight = 0;\n    };\n    Layout.prototype.moveElementFromNextLine = function (line) {\n        var nextLine = line.nextLine;\n        while (nextLine instanceof LineWidget) {\n            if (nextLine.children.length > 0) {\n                var element = nextLine.children.splice(0, 1)[0];\n                line.children.push(element);\n                element.line = line;\n                break;\n            }\n            else {\n                if (nextLine.paragraph.childWidgets.length === 1) {\n                    nextLine.paragraph.destroy();\n                }\n                else {\n                    nextLine.destroy();\n                }\n                nextLine = line.nextLine;\n            }\n        }\n    };\n    Layout.prototype.layoutLine = function (line, count) {\n        var paragraph = line.paragraph;\n        if (line.children.length === 0) {\n            this.moveElementFromNextLine(line);\n        }\n        var element = line.children[count];\n        this.clearLineMeasures();\n        while (element instanceof ElementBox) {\n            this.layoutElement(element, paragraph);\n            line = element.line;\n            element = element.nextElement;\n        }\n        return line;\n    };\n    // tslint:disable:max-func-body-length\n    Layout.prototype.layoutElement = function (element, paragraph) {\n        var line = element.line;\n        var text = '';\n        var index = element.indexInOwner;\n        if (element instanceof FieldElementBox) {\n            if (element.fieldType === 0 && this.viewer.fields.indexOf(element) === -1) {\n                this.viewer.fields.push(element);\n            }\n            this.layoutFieldCharacters(element);\n            if (element.line.isLastLine() && isNullOrUndefined(element.nextNode) && !this.isFieldCode) {\n                if (isNullOrUndefined(element.fieldSeparator)) {\n                    this.layoutEmptyLineWidget(paragraph, false, element.line);\n                }\n                this.moveToNextLine(line);\n            }\n            else if (isNullOrUndefined(element.nextElement) && this.viewer.clientActiveArea.width > 0 && !element.line.isLastLine()) {\n                this.moveElementFromNextLine(line);\n            }\n            else if (isNullOrUndefined(element.nextElement) && this.viewer.clientActiveArea.width === 0) {\n                this.moveToNextLine(line);\n                if (line.paragraph.lastChild === line && !isNullOrUndefined(line.nextLine) &&\n                    this.viewer.clientActiveArea.height >= 0) {\n                    this.moveFromNextPage(line);\n                }\n            }\n            return;\n        }\n        if (element instanceof ListTextElementBox || this.isFieldCode || element instanceof BookmarkElementBox) {\n            if (isNullOrUndefined(element.nextElement) && this.viewer.clientActiveArea.width > 0 && !element.line.isLastLine()) {\n                this.moveElementFromNextLine(line);\n            }\n            if (element.line.isLastLine() && isNullOrUndefined(element.nextElement)) {\n                if (this.hasValidElement(line.paragraph)) {\n                    this.moveToNextLine(line);\n                }\n                else {\n                    this.layoutEmptyLineWidget(line.paragraph, false, line, false);\n                }\n            }\n            return;\n        }\n        var width = element.width;\n        if (element instanceof FieldTextElementBox) {\n            text = this.viewer.getFieldResult(element.fieldBegin, element.paragraph.bodyWidget.page);\n            if (text !== '') {\n                element.text = text;\n            }\n            else {\n                text = element.text;\n            }\n        }\n        else if (element instanceof TextElementBox) {\n            this.checkAndSplitTabOrLineBreakCharacter(element.text, element);\n            text = element.text;\n        }\n        // Here field code width and height update need to skipped based on the hidden property.\n        if (element instanceof TextElementBox) {\n            width = this.viewer.textHelper.getTextSize(element, element.characterFormat);\n            if (element.text === '\\t') {\n                element.width = this.getTabWidth(paragraph, this.viewer, index, line, element);\n            }\n        }\n        if (this.viewer instanceof PageLayoutViewer\n            && this.viewer.clientActiveArea.height < element.height && this.viewer.clientActiveArea.y !== this.viewer.clientArea.y) {\n            this.moveToNextPage(this.viewer, line);\n            if (element instanceof FieldTextElementBox) {\n                this.updateFieldText(element);\n            }\n            if (element.previousElement) {\n                this.cutClientWidth(element.previousElement);\n            }\n        }\n        if (width < this.viewer.clientActiveArea.width || !this.viewer.textWrap) {\n            //Fits the text in current line.\n            this.addElementToLine(paragraph, element);\n            if (isNullOrUndefined(element.nextElement) && this.viewer.clientActiveArea.width > 0 && !element.line.isLastLine()) {\n                this.moveElementFromNextLine(line);\n            }\n            else if (!element.line.isLastLine() && isNullOrUndefined(element.nextElement) && this.viewer.clientActiveArea.width === 0) {\n                this.moveToNextLine(line);\n                if (line.paragraph.lastChild === line && this.viewer.clientActiveArea.height >= 0) {\n                    this.moveFromNextPage(line);\n                }\n            }\n        }\n        else if (element instanceof TextElementBox) {\n            if (element.text === '\\t') {\n                var currentLine = element.line;\n                this.addSplittedLineWidget(currentLine, currentLine.children.indexOf(element));\n                this.moveToNextLine(currentLine);\n                // Recalculates tab width based on new client active area X position\n                element.width = this.getTabWidth(paragraph, this.viewer, index, line, element);\n                this.addElementToLine(paragraph, element);\n            }\n            else {\n                //Splits the text and arrange line by line, till end of text.\n                do {\n                    line = element.line;\n                    this.splitTextForClientArea(line, element, element.text, element.width, element.characterFormat);\n                    this.checkLineWidgetWithClientArea(line, element);\n                    if (element instanceof FieldTextElementBox) {\n                        this.updateFieldText(element);\n                    }\n                } while (element.line !== line && this.cutClientWidth(element));\n            }\n        }\n        else {\n            do {\n                line = element.line;\n                this.splitElementForClientArea(paragraph, element);\n                this.checkLineWidgetWithClientArea(line, element);\n                if (element instanceof FieldTextElementBox) {\n                    this.updateFieldText(element);\n                }\n            } while (element.line !== line && this.cutClientWidth(element));\n        }\n        if (text === '\\v' || text === '\\f') {\n            var elementIndex = line.children.indexOf(element);\n            if (elementIndex > -1) {\n                this.addSplittedLineWidget(line, elementIndex);\n            }\n        }\n        if (element.line.isLastLine() && isNullOrUndefined(element.nextElement) || text === '\\v' || text === '\\f') {\n            this.moveToNextLine(element.line);\n            if (text === '\\v' && isNullOrUndefined(element.nextNode)) {\n                this.layoutEmptyLineWidget(paragraph, true, line, true);\n            }\n            else if (text === '\\f') {\n                if (isNullOrUndefined(element.nextNode)) {\n                    this.moveToNextPage(this.viewer, element.line, true);\n                }\n                else {\n                    this.moveToNextPage(this.viewer, element.line.nextLine, false);\n                }\n            }\n        }\n    };\n    /**\n     * Return true if paragraph has valid inline\n     * @private\n     */\n    Layout.prototype.hasValidElement = function (paragraph) {\n        var line = paragraph.firstChild;\n        if (line && !isNullOrUndefined(this.viewer.selection)) {\n            var elementBox = line.children[0];\n            while (elementBox) {\n                if (elementBox instanceof FieldElementBox) {\n                    elementBox = this.viewer.selection.getNextValidElementForField(elementBox);\n                    if (!elementBox.line.paragraph.equals(paragraph)) {\n                        return false;\n                    }\n                }\n                if (elementBox instanceof TextElementBox) {\n                    return true;\n                }\n                elementBox = elementBox.nextNode;\n            }\n        }\n        return false;\n    };\n    Layout.prototype.updateFieldText = function (element) {\n        // tslint:disable-next-line:max-line-length\n        var text = this.viewer.getFieldResult(element.fieldBegin, element.paragraph.bodyWidget.page);\n        if (text !== '') {\n            element.text = text;\n            this.viewer.textHelper.getTextSize(element, element.characterFormat);\n        }\n    };\n    Layout.prototype.checkLineWidgetWithClientArea = function (line, element) {\n        if (line !== element.line || element.line === line && isNullOrUndefined(element.nextElement)\n            && !element.line.isLastLine()) {\n            this.moveToNextLine(line);\n        }\n        if (element.line !== line && this.viewer instanceof PageLayoutViewer\n            && this.viewer.clientActiveArea.height < element.height &&\n            this.viewer.clientActiveArea.y !== this.viewer.clientArea.y) {\n            this.moveToNextPage(this.viewer, element.line);\n        }\n        else if (element.line === line && isNullOrUndefined(element.nextElement)\n            && line.paragraph.lastChild === line && !line.isLastLine() && this.viewer.clientActiveArea.height >= 0) {\n            this.moveFromNextPage(line);\n        }\n    };\n    Layout.prototype.checkAndSplitTabOrLineBreakCharacter = function (text, element) {\n        var char = ['\\t', '\\v', '\\f'];\n        var index = HelperMethods.indexOfAny(text, char);\n        if (index > -1) {\n            var character = text[index];\n            if ((character === '\\t' && text !== '\\t') || (character === '\\v' && text !== '\\v')\n                || (character === '\\f' && text !== '\\f')) {\n                this.splitByLineBreakOrTab(this.viewer, element, index, character);\n            }\n        }\n    };\n    /**\n     * @private\n     */\n    Layout.prototype.moveFromNextPage = function (line) {\n        var nextLine = line.nextLine;\n        if (nextLine && line.paragraph.childWidgets.indexOf(nextLine) === -1) {\n            nextLine.paragraph.childWidgets.splice(nextLine.indexInOwner, 1);\n            line.paragraph.childWidgets.push(nextLine);\n            nextLine.paragraph = line.paragraph;\n        }\n    };\n    Layout.prototype.cutClientWidth = function (currentElement) {\n        this.clearLineMeasures();\n        var line = currentElement.line;\n        var width = 0;\n        for (var i = 0; i < line.children.length; i++) {\n            var element = line.children[i];\n            width += element.width;\n            if (currentElement === element) {\n                break;\n            }\n        }\n        var splitCurrentWidget = this.viewer.clientActiveArea.width - width < 0;\n        if (!splitCurrentWidget) {\n            this.viewer.cutFromLeft(this.viewer.clientActiveArea.x + width);\n            if (currentElement.line.paragraph.paragraphFormat.textAlignment === 'Justify' &&\n                currentElement instanceof TextElementBox) {\n                this.splitTextElementWordByWord(currentElement);\n            }\n            if (isNullOrUndefined(currentElement.nextElement) && this.viewer.clientActiveArea.width > 0\n                && !currentElement.line.isLastLine()) {\n                this.moveElementFromNextLine(line);\n            }\n        }\n        else if (currentElement.previousElement) {\n            this.cutClientWidth(currentElement.previousElement);\n        }\n        return splitCurrentWidget;\n    };\n    Layout.prototype.layoutFieldCharacters = function (element) {\n        if (element.fieldType === 0) {\n            if (!this.isFieldCode && (!isNullOrUndefined(element.fieldEnd) || element.hasFieldEnd)) {\n                this.viewer.fieldStacks.push(element);\n                this.isFieldCode = true;\n                element.hasFieldEnd = true;\n            }\n        }\n        else if (this.viewer.fieldStacks.length > 0) {\n            if (element.fieldType === 2) {\n                var field = this.viewer.fieldStacks[this.viewer.fieldStacks.length - 1];\n                if (field.fieldSeparator === element && (!isNullOrUndefined(field.fieldEnd) || field.hasFieldEnd)) {\n                    this.isFieldCode = false;\n                }\n            }\n            else {\n                var field = this.viewer.fieldStacks[this.viewer.fieldStacks.length - 1];\n                if (element === field.fieldEnd) {\n                    this.viewer.fieldStacks.pop();\n                    this.isFieldCode = false;\n                }\n            }\n        }\n    };\n    /**\n     * Layouts empty line widget.\n     */\n    // tslint:disable-next-line:max-line-length\n    Layout.prototype.layoutEmptyLineWidget = function (paragraph, isEmptyLine, line, isShiftEnter) {\n        isShiftEnter = isNullOrUndefined(isShiftEnter) ? false : isShiftEnter;\n        //Calculate line height and descent based on formatting defined in paragraph.\n        var paragraphMarkSize = this.viewer.textHelper.getParagraphMarkSize(paragraph.characterFormat);\n        var maxHeight = paragraphMarkSize.Height;\n        var beforeSpacing = this.getBeforeSpacing(paragraph);\n        var lineWidget;\n        if (paragraph.childWidgets.length > 0 && !isShiftEnter) {\n            lineWidget = paragraph.childWidgets[0];\n        }\n        else {\n            lineWidget = isEmptyLine ? this.addLineWidget(paragraph) : line;\n        }\n        //isNullOrUndefined(this.viewer.currentHeaderFooter) && \n        if (this.viewer instanceof PageLayoutViewer\n            && this.viewer.clientActiveArea.height < beforeSpacing + maxHeight\n            && this.viewer.clientActiveArea.y !== this.viewer.clientArea.y) {\n            this.moveToNextPage(this.viewer, lineWidget);\n        }\n        //Gets line spacing.\n        var lineSpacing = this.getLineSpacing(paragraph, maxHeight);\n        var maxDescent = maxHeight - paragraphMarkSize.BaselineOffset;\n        //Calculate the bottom position of current line - max height + line spacing.\n        if (!isNaN(this.maxTextHeight)\n            && maxHeight < this.maxTextHeight) {\n            maxHeight = this.maxTextHeight;\n            maxDescent = maxHeight - this.maxTextBaseline;\n        }\n        var topMargin = 0;\n        var bottomMargin = 0;\n        var leftMargin = 0;\n        var height = maxHeight;\n        var lineSpacingType = paragraph.paragraphFormat.lineSpacingType;\n        if (lineSpacingType === 'Multiple') {\n            if (lineSpacing > maxHeight) {\n                bottomMargin += lineSpacing - maxHeight;\n            }\n            else {\n                topMargin += lineSpacing - maxHeight;\n            }\n        }\n        else if (lineSpacingType === 'Exactly') {\n            topMargin += lineSpacing - (topMargin + height + bottomMargin);\n        }\n        else if (lineSpacing > topMargin + height + bottomMargin) {\n            topMargin += lineSpacing - (topMargin + height + bottomMargin);\n        }\n        topMargin += beforeSpacing;\n        bottomMargin += HelperMethods.convertPointToPixel(paragraph.paragraphFormat.afterSpacing);\n        for (var i = 0; i < lineWidget.children.length; i++) {\n            var element = lineWidget.children[i];\n            if (element instanceof ListTextElementBox) {\n                var textAlignment = paragraph.paragraphFormat.textAlignment;\n                if (textAlignment === 'Right') {\n                    leftMargin = this.viewer.clientArea.width - element.width;\n                }\n                else if (textAlignment === 'Center') {\n                    leftMargin = (this.viewer.clientArea.width - element.width) / 2;\n                }\n                element.margin = new Margin(leftMargin, topMargin, 0, bottomMargin);\n                element.line = lineWidget;\n                lineWidget.height = topMargin + height + bottomMargin;\n            }\n        }\n        lineWidget.height = topMargin + height + bottomMargin;\n        this.viewer.cutFromTop(this.viewer.clientActiveArea.y + lineWidget.height);\n        //Clears the previous line elements from collection.     \n    };\n    /**\n     * @private\n     */\n    Layout.prototype.layoutListItems = function (paragraph) {\n        if (!this.isFieldCode) {\n            if (!isNullOrUndefined(paragraph.paragraphFormat)\n                && !isNullOrUndefined(paragraph.paragraphFormat.listFormat)\n                && !isNullOrUndefined(this.viewer.getListById(paragraph.paragraphFormat.listFormat.listId)) &&\n                paragraph.paragraphFormat.listFormat.listLevelNumber >= 0\n                && paragraph.paragraphFormat.listFormat.listLevelNumber < 9) {\n                this.clearListElementBox(paragraph);\n                this.layoutList(paragraph, this.viewer);\n            }\n            else if (paragraph.paragraphFormat.listFormat && paragraph.paragraphFormat.listFormat.listId === -1) {\n                this.clearListElementBox(paragraph);\n            }\n        }\n    };\n    /**\n     * Layouts list.\n     * @param viewer\n     */\n    Layout.prototype.layoutList = function (paragraph, viewer) {\n        var list = viewer.getListById(paragraph.paragraphFormat.listFormat.listId);\n        viewer.updateClientWidth(-HelperMethods.convertPointToPixel(paragraph.paragraphFormat.firstLineIndent));\n        var currentListLevel = this.getListLevel(list, paragraph.paragraphFormat.listFormat.listLevelNumber);\n        // if (isNullOrUndefined(currentListLevel)) {\n        //     return;\n        // }\n        var lineWidget = paragraph.childWidgets[0];\n        if (isNullOrUndefined(lineWidget)) {\n            lineWidget = new LineWidget(paragraph);\n            paragraph.childWidgets.push(lineWidget);\n        }\n        var element = new ListTextElementBox(currentListLevel, false);\n        element.line = lineWidget;\n        if (currentListLevel.listLevelPattern === 'Bullet') {\n            element.text = currentListLevel.numberFormat;\n        }\n        else {\n            element.text = this.getListNumber(paragraph.paragraphFormat.listFormat);\n        }\n        viewer.textHelper.updateTextSize(element, paragraph);\n        var moveToNextPage;\n        if (this.viewer instanceof PageLayoutViewer\n            && this.viewer.clientActiveArea.height < element.height && this.viewer.clientActiveArea.y !== this.viewer.clientArea.y) {\n            moveToNextPage = true;\n        }\n        viewer.cutFromLeft(viewer.clientActiveArea.x + element.width);\n        //Adds the text element to the line\n        lineWidget.children.splice(0, 0, element);\n        if (currentListLevel.followCharacter !== 'None') {\n            element = new ListTextElementBox(currentListLevel, true);\n            if (currentListLevel.followCharacter === 'Tab') {\n                element.text = '\\t';\n                var index = lineWidget.children.indexOf(element);\n                element.width = this.getTabWidth(paragraph, viewer, index, lineWidget, undefined);\n            }\n            else {\n                element.text = ' ';\n                viewer.textHelper.updateTextSize(element, paragraph);\n            }\n            viewer.cutFromLeft(viewer.clientActiveArea.x + element.width);\n            //Adds the tabSpace to the line\n            lineWidget.children.splice(1, 0, element);\n            element.line = lineWidget;\n        }\n        if (moveToNextPage) {\n            this.moveToNextPage(this.viewer, lineWidget);\n            this.cutClientWidth(element);\n            return;\n        }\n        if (currentListLevel.followCharacter !== 'None') {\n            viewer.updateClientWidth(HelperMethods.convertPointToPixel(paragraph.paragraphFormat.firstLineIndent));\n        }\n    };\n    /**\n     * Adds body widget.\n     * @param area\n     * @param section\n     * @private\n     */\n    Layout.prototype.addBodyWidget = function (area, widget) {\n        var bodyWidget;\n        if (widget) {\n            bodyWidget = widget;\n        }\n        else {\n            bodyWidget = new BodyWidget();\n        }\n        bodyWidget.width = area.width;\n        bodyWidget.x = area.x;\n        bodyWidget.y = area.y;\n        // this.addSectionInDictionary(this.viewer, section, bodyWidget);\n        return bodyWidget;\n    };\n    /**\n     * Adds list level.\n     * @param abstractList\n     */\n    Layout.prototype.addListLevels = function (abstractList) {\n        for (var i = abstractList.levels.length; i < 9; i++) {\n            var listLevel = new WListLevel(abstractList);\n            var val = i % 3;\n            if (abstractList.levels[0].listLevelPattern === 'Bullet') {\n                listLevel.listLevelPattern = 'Bullet';\n                listLevel.numberFormat = val === 0 ? '\\uf0b7' : val === 1 ? '\\uf0a7' : '\\uf0d8';\n                listLevel.characterFormat.fontFamily = listLevel.numberFormat === '\\uf0a7' || '\\uf0d8' ? 'Wingdings' : 'Symbol';\n            }\n            else {\n                listLevel.listLevelPattern = this.getListLevelPattern(val);\n                listLevel.numberFormat = '%' + (i + 1).toString() + '.';\n                listLevel.startAt = 1;\n                listLevel.restartLevel = i;\n            }\n            listLevel.paragraphFormat = new WParagraphFormat(undefined);\n            listLevel.paragraphFormat.leftIndent = 48 * (i + 1);\n            listLevel.paragraphFormat.firstLineIndent = -24;\n            abstractList.levels.push(listLevel);\n        }\n    };\n    Layout.prototype.addSplittedLineWidget = function (lineWidget, elementIndex, splittedElementBox) {\n        var paragraph = lineWidget.paragraph;\n        var movedElementBox = [];\n        var lineIndex = paragraph.childWidgets.indexOf(lineWidget);\n        if (!isNullOrUndefined(splittedElementBox)) {\n            movedElementBox.push(splittedElementBox);\n        }\n        var newLineWidget = undefined;\n        //Move Next element box to temp collection\n        for (var i = elementIndex + 1; i < lineWidget.children.length; i++) {\n            movedElementBox.push(lineWidget.children[i]);\n        }\n        if (movedElementBox.length > 0) {\n            if (lineIndex === paragraph.childWidgets.length - 1) {\n                newLineWidget = new LineWidget(paragraph);\n            }\n            else {\n                newLineWidget = paragraph.childWidgets[lineIndex + 1];\n            }\n            for (var j = 0; j < movedElementBox.length; j++) {\n                movedElementBox[j].line = newLineWidget;\n            }\n            lineWidget.children.splice(elementIndex + 1, lineWidget.children.length - 1);\n            newLineWidget.children = movedElementBox.concat(newLineWidget.children);\n            if (paragraph.childWidgets.indexOf(newLineWidget) === -1) {\n                paragraph.childWidgets.splice(lineIndex + 1, 0, newLineWidget);\n            }\n        }\n    };\n    /**\n     * Adds element to line.\n     * @param element\n     */\n    Layout.prototype.addElementToLine = function (paragraph, element) {\n        this.viewer.cutFromLeft(this.viewer.clientActiveArea.x + element.width);\n        if (paragraph.paragraphFormat.textAlignment === 'Justify' && element instanceof TextElementBox) {\n            this.splitTextElementWordByWord(element);\n        }\n    };\n    /**\n     * Splits element for client area.\n     * @param element\n     */\n    Layout.prototype.splitElementForClientArea = function (paragraph, element) {\n        var line = element.line;\n        if (element.line.children.length > 0) {\n            var previousElement = element.previousElement;\n            var index = element.indexInOwner;\n            // if line widget contain only single image element box need to skip this from splitting\n            // else move element to next line\n            if (element.line.children.length > 1) {\n                if (previousElement && this.viewer.clientActiveArea.x !== this.viewer.clientArea.x) {\n                    index -= 1;\n                }\n            }\n            this.addSplittedLineWidget(element.line, index);\n        }\n    };\n    /**\n     * Splits by word\n     * @param elementBox\n     * @param text\n     * @param width\n     * @param characterFormat\n     */\n    // tslint:disable-next-line:max-line-length\n    Layout.prototype.splitByWord = function (lineWidget, paragraph, elementBox, text, width, characterFormat) {\n        var index = this.getSplitIndexByWord(this.viewer.clientActiveArea.width, text, width, characterFormat);\n        if (index > 0 && index < elementBox.length) {\n            var indexOf = lineWidget.children.indexOf(elementBox);\n            var lineIndex = paragraph.childWidgets.indexOf(lineWidget);\n            var splittedElementBox = new TextElementBox();\n            text = text.substring(index);\n            splittedElementBox.text = text;\n            if (text[0] === ' ') {\n                var prevLength = text.length;\n                text = HelperMethods.trimStart(text); //To trim white space at starting of the text.\n                index += prevLength - text.length;\n            }\n            splittedElementBox.characterFormat.copyFormat(elementBox.characterFormat);\n            splittedElementBox.width = this.viewer.textHelper.getWidth(splittedElementBox.text, characterFormat);\n            elementBox.text = elementBox.text.substr(0, index);\n            elementBox.width -= splittedElementBox.width;\n            splittedElementBox.height = elementBox.height;\n            splittedElementBox.baselineOffset = elementBox.baselineOffset;\n            this.addSplittedLineWidget(lineWidget, indexOf, splittedElementBox);\n            this.addElementToLine(paragraph, elementBox);\n            if (elementBox.width === 0) {\n                lineWidget.children.splice(indexOf, 1);\n            }\n        }\n    };\n    /**\n     * Splits by character.\n     * @param textElement\n     * @param text\n     * @param width\n     * @param characterFormat\n     */\n    // tslint:disable-next-line:max-line-length\n    Layout.prototype.splitByCharacter = function (lineWidget, textElement, text, width, characterFormat) {\n        var paragraph = lineWidget.paragraph;\n        // tslint:disable-next-line:max-line-length\n        var index = this.getTextSplitIndexByCharacter(this.viewer.clientArea.width, this.viewer.clientActiveArea.width, text, width, characterFormat);\n        var splitWidth = 0;\n        if (index < textElement.length) {\n            splitWidth = this.viewer.textHelper.measureTextExcludingSpaceAtEnd(text.substring(0, index), characterFormat);\n            text = text.substring(index);\n        }\n        if (splitWidth > this.viewer.clientActiveArea.width && textElement.indexInOwner > 0) {\n            this.addSplittedLineWidget(lineWidget, textElement.indexInOwner - 1);\n            return;\n        }\n        var indexOf = lineWidget.children.indexOf(textElement);\n        if (index < textElement.length) {\n            var lineIndex = paragraph.childWidgets.indexOf(lineWidget);\n            var splittedElement = new TextElementBox();\n            splittedElement.text = text;\n            textElement.text = textElement.text.substr(0, index);\n            splittedElement.characterFormat.copyFormat(textElement.characterFormat);\n            splittedElement.width = this.viewer.textHelper.getWidth(splittedElement.text, characterFormat);\n            textElement.width -= splittedElement.width;\n            splittedElement.height = textElement.height;\n            splittedElement.baselineOffset = textElement.baselineOffset;\n            lineWidget.children.splice(textElement.indexInOwner + 1, 0, splittedElement);\n            this.addSplittedLineWidget(lineWidget, indexOf);\n            this.addElementToLine(paragraph, textElement);\n            if (textElement.width === 0) {\n                lineWidget.children.splice(indexOf, 1);\n            }\n        }\n        else {\n            //Adds the last text element on inline to line elements collection. \n            this.addSplittedLineWidget(lineWidget, indexOf);\n            this.addElementToLine(paragraph, textElement);\n        }\n    };\n    /**\n     * Splits text element word by word.\n     * @param textElement\n     */\n    Layout.prototype.splitTextElementWordByWord = function (textElement) {\n        var lineWidget = textElement.line;\n        var indexOf = lineWidget.children.indexOf(textElement);\n        var text = textElement.text;\n        var format;\n        var characterUptoWs = text.trim().indexOf(' ');\n        if (characterUptoWs >= 0) {\n            lineWidget.children.splice(indexOf, 1);\n            format = textElement.characterFormat;\n            var fontSize = format.fontSize;\n            var index = textElement.length - HelperMethods.trimStart(text).length; //Trim start\n            while (index < textElement.length) {\n                index = this.getTextIndexAfterSpace(text, index);\n                if (index === 0 || index === textElement.length) {\n                    break;\n                }\n                if (index < textElement.length) {\n                    var splittedElement = new TextElementBox();\n                    var splittedText = text.substring(0, index);\n                    text = text.substring(index);\n                    if (text.substring(0, 1) === ' ') {\n                        // start of the text is trimmed and its length is reduced from text length.                        \n                        index += text.length - HelperMethods.trimStart(text).length;\n                    }\n                    splittedElement.text = splittedText;\n                    splittedElement.characterFormat.copyFormat(textElement.characterFormat);\n                    splittedElement.line = lineWidget;\n                    splittedElement.width = this.viewer.textHelper.getWidth(splittedElement.text, format);\n                    splittedElement.height = textElement.height;\n                    splittedElement.baselineOffset = textElement.baselineOffset;\n                    lineWidget.children.splice(indexOf, 0, splittedElement);\n                    textElement.text = text;\n                    textElement.width -= splittedElement.width;\n                    if (textElement.width === 0) {\n                        lineWidget.children.splice(lineWidget.children.indexOf(textElement), 1);\n                    }\n                    index = 0;\n                    indexOf++;\n                }\n            }\n            textElement.text = text;\n            lineWidget.children.splice(indexOf, 0, textElement);\n        }\n    };\n    /**\n     * Splits text for client area.\n     * @param element\n     * @param text\n     * @param width\n     * @param characterFormat\n     */\n    // tslint:disable-next-line:max-line-length\n    Layout.prototype.splitTextForClientArea = function (lineWidget, element, text, width, characterFormat) {\n        var paragraph = lineWidget.paragraph;\n        var isSplitByWord = true;\n        var index = -1;\n        if (!(text.substring(0, 1) === ' ')) {\n            var textWidth = width;\n            var characterUptoWS = 0;\n            characterUptoWS = HelperMethods.trimEnd(text).indexOf(' ') + 1;\n            index = characterUptoWS;\n            //Checks whether text not starts with white space. If starts with white space, no need to check previous text blocks.\n            if (index > 0) {\n                textWidth = this.viewer.textHelper.measureTextExcludingSpaceAtEnd(text.slice(0, index), characterFormat);\n            }\n            if (this.viewer.clientActiveArea.width < textWidth) {\n                //Check and split the previous text elements to next line.            \n                isSplitByWord = this.checkPreviousElement(lineWidget, lineWidget.children.indexOf(element), characterFormat);\n                if (isSplitByWord) {\n                    //lineWidget = paragraph.childWidgets[paragraph.childWidgets.indexOf(lineWidget) + 1] as LineWidget;\n                    //isSplitByWord = textWidth <= this.viewer.clientActiveArea.width;\n                    return;\n                }\n            }\n        }\n        else {\n            index = 1;\n        }\n        if (width <= this.viewer.clientActiveArea.width) {\n            //Fits the text in current line.\n            this.addElementToLine(paragraph, element);\n        }\n        else if (isSplitByWord && (index > 0 || text.indexOf(' ') !== -1)) {\n            this.splitByWord(lineWidget, paragraph, element, text, width, characterFormat);\n        }\n        else {\n            this.splitByCharacter(lineWidget, element, text, width, characterFormat);\n        }\n    };\n    /**\n     * Handle tab or line break character splitting\n     * @param  {LayoutViewer} viewer\n     * @param  {TextElementBox} span\n     * @param  {number} index\n     * @param  {string} spiltBy\n     * @private\n     */\n    Layout.prototype.splitByLineBreakOrTab = function (viewer, span, index, spiltBy) {\n        // Splits tab character to separate SpanAdv\n        var inlineIndex = span.line.children.indexOf(span);\n        var value = span.text;\n        var remainder = value.substring(index);\n        var newSpan = spiltBy === '\\t' ? new TabElementBox() : new TextElementBox();\n        newSpan.line = span.line;\n        newSpan.characterFormat.copyFormat(span.characterFormat);\n        span.line.children.splice(inlineIndex + 1, 0, newSpan);\n        if (index > 0 && remainder.length === 1) {\n            newSpan.text = value.substring(index);\n            span.text = value.substring(0, index);\n        }\n        else if (index > 0) {\n            newSpan.text = spiltBy;\n            var newText = new TextElementBox();\n            newText.line = span.line;\n            newText.text = value.substring(index + 1);\n            newText.characterFormat.copyFormat(span.characterFormat);\n            span.line.children.splice(inlineIndex + 2, 0, newText);\n            span.text = value.substring(0, index);\n        }\n        else if (remainder !== '') {\n            newSpan.text = value.substring(index + 1);\n            span.text = spiltBy;\n        }\n    };\n    /**\n     * Moves to next line.\n     */\n    Layout.prototype.moveToNextLine = function (line) {\n        var paragraph = line.paragraph;\n        var paraFormat = paragraph.paragraphFormat;\n        var isParagraphStart = line.isFirstLine();\n        var isParagraphEnd = line.isLastLine();\n        var height = 0;\n        var maxDescent = 0;\n        var afterSpacing = 0;\n        var beforeSpacing = 0;\n        var lineSpacing = 0;\n        var firstLineIndent = 0;\n        this.updateLineWidget(line);\n        height = this.maxTextHeight;\n        maxDescent = height - this.maxTextBaseline;\n        //Updates before spacing at the top of Paragraph first line.\n        if (isParagraphStart) {\n            beforeSpacing = this.getBeforeSpacing(paragraph);\n            firstLineIndent = HelperMethods.convertPointToPixel(paraFormat.firstLineIndent);\n        }\n        //Updates after spacing at the bottom of Paragraph last line.\n        if (isParagraphEnd) {\n            afterSpacing = HelperMethods.convertPointToPixel(paraFormat.afterSpacing);\n        }\n        if (isNaN(this.maxTextHeight)) {\n            //Calculate line height and descent based on formatting defined in paragraph.\n            var measurement = this.viewer.textHelper.measureText('a', paragraph.characterFormat);\n            height = measurement.Height;\n            maxDescent = height - measurement.BaselineOffset;\n        }\n        else {\n            height = this.maxTextHeight;\n            maxDescent = height - this.maxTextBaseline;\n        }\n        // Gets line spacing.\n        lineSpacing = this.getLineSpacing(paragraph, height);\n        if (paraFormat.lineSpacingType === 'Exactly'\n            && lineSpacing < maxDescent + this.maxBaseline) {\n            lineSpacing = maxDescent + this.maxBaseline;\n        }\n        var subWidth = 0;\n        var whiteSpaceCount = 0;\n        var textAlignment = paraFormat.textAlignment;\n        //Calculates the sub width, for text alignments - Center, Right, Justify.\n        if (textAlignment !== 'Left' && this.viewer.textWrap && !(textAlignment === 'Justify' && isParagraphEnd)) {\n            // tslint:disable-next-line:max-line-length\n            var getWidthAndSpace = this.getSubWidth(line, textAlignment === 'Justify', whiteSpaceCount, firstLineIndent);\n            subWidth = getWidthAndSpace.subWidth;\n            whiteSpaceCount = getWidthAndSpace.spaceCount;\n        }\n        var addSubWidth = false;\n        var lineSpacingType = paraFormat.lineSpacingType;\n        for (var i = 0; i < line.children.length; i++) {\n            var topMargin = 0;\n            var bottomMargin = 0;\n            var leftMargin = 0;\n            var elementBox = line.children[i];\n            // tslint:disable-next-line:max-line-length\n            var alignElements = this.alignLineElements(elementBox, topMargin, bottomMargin, maxDescent, addSubWidth, subWidth, textAlignment, whiteSpaceCount, i === line.children.length - 1);\n            topMargin = alignElements.topMargin;\n            bottomMargin = alignElements.bottomMargin;\n            addSubWidth = alignElements.addSubWidth;\n            whiteSpaceCount = alignElements.whiteSpaceCount;\n            //Updates line spacing, paragraph after/ before spacing and aligns the text to base line offset.\n            if (lineSpacingType === 'Multiple') {\n                if (lineSpacing > height) {\n                    bottomMargin += lineSpacing - height;\n                }\n                else {\n                    topMargin += lineSpacing - height;\n                }\n            }\n            else if (lineSpacingType === 'Exactly') {\n                topMargin += lineSpacing - (topMargin + elementBox.height + bottomMargin);\n            }\n            else if (lineSpacing > topMargin + elementBox.height + bottomMargin) {\n                topMargin += lineSpacing - (topMargin + elementBox.height + bottomMargin);\n            }\n            topMargin += beforeSpacing;\n            bottomMargin += afterSpacing;\n            if (i === 0) {\n                line.height = topMargin + elementBox.height + bottomMargin;\n                if (textAlignment === 'Right') {\n                    //Aligns the text as right justified.\n                    leftMargin = subWidth;\n                }\n                else if (textAlignment === 'Center') {\n                    //Aligns the text as center justified.\n                    leftMargin = subWidth / 2;\n                }\n            }\n            elementBox.margin = new Margin(leftMargin, topMargin, 0, bottomMargin);\n            elementBox.line = line;\n        }\n        this.viewer.cutFromTop(this.viewer.clientActiveArea.y + line.height);\n    };\n    Layout.prototype.updateLineWidget = function (line) {\n        for (var i = 0; i < line.children.length; i++) {\n            var element = line.children[i];\n            if (element instanceof TextElementBox || element instanceof ListTextElementBox) {\n                if (this.maxTextHeight < element.height) {\n                    this.maxTextHeight = element.height;\n                    this.maxTextBaseline = element.baselineOffset;\n                }\n                if (this.maxBaseline < this.maxTextBaseline) {\n                    this.maxBaseline = this.maxTextBaseline;\n                }\n            }\n            else if (this.maxBaseline < element.height) {\n                this.maxBaseline = element.height;\n            }\n        }\n    };\n    /**\n     * @param viewer\n     */\n    Layout.prototype.moveToNextPage = function (viewer, line, isPageBreak) {\n        var paragraphWidget = line.paragraph;\n        var index = 0;\n        if (!isNullOrUndefined(line)) {\n            index = paragraphWidget.childWidgets.indexOf(line);\n            if (index > 0 || isPageBreak) {\n                paragraphWidget.height = viewer.clientActiveArea.y - paragraphWidget.y;\n            }\n        }\n        var nextBody = this.moveBlocksToNextPage(paragraphWidget);\n        this.viewer.updateClientArea(nextBody.sectionFormat, nextBody.page);\n        this.viewer.updateClientAreaForBlock(paragraphWidget, true);\n        if (index > 0) {\n            if (line.isLastLine() && isPageBreak) {\n                return;\n            }\n            var nextParagraph = void 0;\n            if (nextBody.firstChild instanceof ParagraphWidget && nextBody.firstChild.equals(paragraphWidget)) {\n                nextParagraph = nextBody.firstChild;\n            }\n            else {\n                nextParagraph = new ParagraphWidget();\n            }\n            nextParagraph = this.addParagraphWidget(this.viewer.clientActiveArea, nextParagraph);\n            nextParagraph.index = paragraphWidget.index;\n            var insertIndex = 0;\n            for (var i = index; i < paragraphWidget.childWidgets.length; i++) {\n                var lineWidget = paragraphWidget.childWidgets[i];\n                lineWidget.paragraph = nextParagraph;\n                nextParagraph.childWidgets.splice(insertIndex, 0, lineWidget);\n                lineWidget.paragraph = nextParagraph;\n                insertIndex++;\n            }\n            nextParagraph.paragraphFormat = paragraphWidget.paragraphFormat;\n            nextParagraph.characterFormat = paragraphWidget.characterFormat;\n            paragraphWidget.childWidgets.splice(index);\n            paragraphWidget = nextParagraph;\n        }\n        else if (!isPageBreak) {\n            paragraphWidget.containerWidget.removeChild(paragraphWidget.indexInOwner);\n        }\n        if (!isPageBreak) {\n            if (nextBody.childWidgets.indexOf(paragraphWidget) === -1) {\n                nextBody.childWidgets.splice(0, 0, paragraphWidget);\n            }\n            paragraphWidget.containerWidget = nextBody;\n            this.viewer.updateClientAreaLocation(paragraphWidget, this.viewer.clientActiveArea);\n        }\n    };\n    /**\n     * Aligns line elements\n     * @param element\n     * @param topMargin\n     * @param bottomMargin\n     * @param maxDescent\n     * @param addSubWidth\n     * @param subWidth\n     * @param textAlignment\n     * @param whiteSpaceCount\n     * @param isLastElement\n     */\n    // tslint:disable-next-line:max-line-length\n    Layout.prototype.alignLineElements = function (element, topMargin, bottomMargin, maxDescent, addSubWidth, subWidth, textAlignment, whiteSpaceCount, isLastElement) {\n        if (element instanceof TextElementBox || element instanceof ListTextElementBox) {\n            var textElement = element instanceof TextElementBox ? element : undefined;\n            //Updates the text to base line offset.\n            // tslint:disable-next-line:max-line-length\n            var baselineOffset = element instanceof TextElementBox ? textElement.baselineOffset : element.baselineOffset;\n            topMargin += this.maxBaseline - baselineOffset;\n            bottomMargin += maxDescent - (element.height - baselineOffset);\n            //Updates the text to base line offset.\n            if (!isNullOrUndefined(textElement) && textAlignment === 'Justify' && whiteSpaceCount > 0) {\n                //Aligns the text as Justified.\n                var width = textElement.width;\n                var text = textElement.text;\n                if (!addSubWidth) {\n                    text = HelperMethods.trimStart(text); // trim start\n                    addSubWidth = (text.length > 0);\n                }\n                if (addSubWidth) {\n                    var spaceCount = text.length - HelperMethods.removeSpace(text).length;\n                    if (isLastElement) {\n                        spaceCount -= text.length - HelperMethods.trimEnd(text).length;\n                    }\n                    if (whiteSpaceCount < spaceCount) {\n                        width = this.viewer.textHelper.measureTextExcludingSpaceAtEnd(text, textElement.characterFormat);\n                        spaceCount = whiteSpaceCount;\n                    }\n                    if (spaceCount > 0) {\n                        textElement.width = width + subWidth * spaceCount;\n                        whiteSpaceCount -= spaceCount;\n                    }\n                }\n            }\n        }\n        else {\n            addSubWidth = true;\n            //Updates the Image/UIElement to base line offset.\n            topMargin += this.maxBaseline - element.height;\n            bottomMargin += maxDescent;\n        }\n        return { 'topMargin': topMargin, 'bottomMargin': bottomMargin, 'addSubWidth': addSubWidth, 'whiteSpaceCount': whiteSpaceCount };\n    };\n    /**\n     * Updates widget to page.\n     * @param viewer\n     * @param block\n     * @private\n     */\n    Layout.prototype.updateWidgetToPage = function (viewer, paragraphWidget) {\n        if (paragraphWidget.isInsideTable) {\n            var cellWidget = paragraphWidget.associatedCell;\n            paragraphWidget.height = viewer.clientActiveArea.y - paragraphWidget.y;\n            // if (viewer instanceof PageLayoutViewer) {\n            if (isNullOrUndefined(paragraphWidget.associatedCell) || isNullOrUndefined(paragraphWidget.associatedCell.ownerRow)\n                || isNullOrUndefined(paragraphWidget.associatedCell.ownerRow.rowFormat)) {\n                return;\n            }\n            if (paragraphWidget.associatedCell.ownerRow.rowFormat.heightType === 'Exactly') {\n                cellWidget.height = HelperMethods.convertPointToPixel(paragraphWidget.associatedCell.ownerRow.rowFormat.height);\n            }\n            else {\n                // tslint:disable-next-line:max-line-length\n                if ([cellWidget].length <= 1 && paragraphWidget.associatedCell.ownerRow.rowFormat.heightType === 'AtLeast') {\n                    cellWidget.height = Math.max(HelperMethods.convertPointToPixel(paragraphWidget.associatedCell.ownerRow.rowFormat.height), this.getCellContentHeight(cellWidget));\n                }\n                else {\n                    cellWidget.height = cellWidget.height + paragraphWidget.height;\n                }\n            }\n            // } else {\n            //     cellWidget.height = cellWidget.height + paragraphWidget.height;\n            // }\n            // cellWidget.childWidgets.push(paragraphWidget);\n            paragraphWidget.containerWidget = cellWidget;\n        }\n        else {\n            if (!paragraphWidget.isEndsWithPageBreak) {\n                paragraphWidget.height = viewer.clientActiveArea.y - paragraphWidget.y;\n            }\n            //Adds the paragraph widget to the Header Footer/ Body widget.\n            // this.updateWidgetsToBody(paragraphWidget, viewer, paragraphWidget);\n            //For canvas no need to render paragraph widget here. In case of div, need to render paragraph here.\n            // tslint:disable-next-line:max-line-length             \n            // this.render.renderParagraphWidget((paragraphWidget.containerWidget as BodyWidget).page, paragraphWidget);\n        }\n        if (paragraphWidget.bodyWidget instanceof HeaderFooterWidget) {\n            if (!paragraphWidget.isInsideTable) {\n                paragraphWidget.containerWidget.height += paragraphWidget.height;\n            }\n            if (this.viewer.owner.enableHeaderAndFooter && paragraphWidget.bodyWidget.headerFooterType.indexOf('Footer') !== -1) {\n                this.shiftFooterChildLocation(paragraphWidget.bodyWidget, this.viewer);\n            }\n        }\n    };\n    /**\n     * @private\n     */\n    Layout.prototype.shiftFooterChildLocation = function (widget, viewer) {\n        var pageHeight = widget.page.bodyWidgets[0].sectionFormat.pageHeight;\n        if (widget.headerFooterType.indexOf('Footer') !== -1) {\n            var footerDistance = widget.page.bodyWidgets[0].sectionFormat.footerDistance;\n            var height = HelperMethods.convertPointToPixel(pageHeight - footerDistance);\n            var top_2;\n            if (widget.y + widget.height > height) {\n                top_2 = height - (widget.y + widget.height);\n            }\n            else if (widget.y + widget.height < height) {\n                top_2 = (widget.y + widget.height) - height;\n            }\n            if (!isNullOrUndefined(top_2)) {\n                top_2 = height - (widget.y + widget.height);\n                this.shiftChildLocation(top_2, widget);\n                viewer.clientActiveArea.y += top_2;\n            }\n        }\n    };\n    /**\n     * Checks previous element.\n     * @param characterFormat\n     */\n    Layout.prototype.checkPreviousElement = function (line, index, characterFormat) {\n        var paragraph = line.paragraph;\n        var isSplitByWord = false;\n        var lastTextElement = 0;\n        for (var i = index - 1; i >= 0; i--) {\n            var textElement = line.children[i];\n            if (textElement instanceof TextElementBox) {\n                var text = textElement.text;\n                lastTextElement = i;\n                if (text.length > 0 && text[text.length - 1] === ' ') {\n                    if (i === index - 1) {\n                        this.addSplittedLineWidget(line, index - 1);\n                        return true;\n                    }\n                    isSplitByWord = true;\n                    break;\n                }\n                else if (text === '\\t') {\n                    return false;\n                }\n                else if (text.indexOf(' ') >= 0) {\n                    isSplitByWord = true;\n                    var index_1 = text.lastIndexOf(' ') + 1;\n                    //Splits the text element by space.\n                    var splittedElement = new TextElementBox();\n                    splittedElement.text = text.substr(index_1);\n                    splittedElement.characterFormat.copyFormat(textElement.characterFormat);\n                    textElement.text = text.substr(0, index_1);\n                    this.viewer.textHelper.getTextSize(splittedElement, characterFormat);\n                    textElement.width -= splittedElement.width;\n                    textElement.height = splittedElement.height;\n                    if (textElement.width === 0) {\n                        line.children.splice(i, 1);\n                    }\n                    //Adds the text element to the line\n                    line.children.splice(i + 1, 0, splittedElement);\n                    break;\n                }\n            }\n            else if (!(textElement instanceof ListTextElementBox)) {\n                //Handled for inline images/UIelements.\n                lastTextElement = i;\n                isSplitByWord = true;\n                break;\n            }\n        }\n        if (isSplitByWord) {\n            lastTextElement++;\n            if (lastTextElement < line.children.length) {\n                var splitWidth = 0;\n                for (var i = lastTextElement; i < line.children.length; i++) {\n                    splitWidth += line.children[i].width;\n                    this.addSplittedLineWidget(line, i - 1);\n                    i--;\n                }\n                this.viewer.updateClientWidth(splitWidth);\n            }\n        }\n        return isSplitByWord;\n    };\n    /**\n     * @private\n     */\n    Layout.prototype.clearListElementBox = function (paragraph) {\n        if (paragraph.childWidgets.length === 0) {\n            return;\n        }\n        var line = paragraph.childWidgets[0];\n        if (isNullOrUndefined(line.children)) {\n            return;\n        }\n        for (var i = 0; i < line.children.length; i++) {\n            if (line.children[i] instanceof ListTextElementBox) {\n                line.children.splice(i, 1);\n                i--;\n            }\n            else {\n                break;\n            }\n        }\n    };\n    /**\n     * Gets list number.\n     * @param listFormat\n     * @param document\n     * @private\n     */\n    Layout.prototype.getListNumber = function (listFormat) {\n        var list = this.viewer.getListById(listFormat.listId);\n        var levelNumber = listFormat.listLevelNumber;\n        var listLevel = this.getListLevel(list, listFormat.listLevelNumber);\n        // tslint:disable-next-line:max-line-length\n        var levelOverride = !isNullOrUndefined(list.levelOverrides) ? list.levelOverrides[levelNumber] : undefined;\n        // If LevelOverride exists and have either override list level or StartAtOverride, then only list numbering will be restarted.\n        // tslint:disable-next-line:max-line-length\n        // if (!isNullOrUndefined(levelOverride) && !(document.renderedLevelOverrides.indexOf(levelOverride) > -1) && isNullOrUndefined(levelOverride.overrideListLevel)) {\n        //     //Add List Override style\n        //     document.renderedLevelOverrides.push(list.levelOverrides.getItem(levelNumber) as WLevelOverride);\n        //     if (document.renderedLists.containsKey((list.wordDocument as WordDocument).getAbstractListById(list.abstractListId))) {\n        // tslint:disable-next-line:max-line-length\n        //         let levels: Dictionary<number, number> = document.renderedLists.get((list.wordDocument as WordDocument).getAbstractListById(list.abstractListId));\n        //         if (levels.containsKey(levelNumber)) {\n        //             levels.remove(levelNumber);\n        //         }\n        //     }\n        // }\n        this.updateListValues(list, levelNumber);\n        return this.getListText(list, levelNumber, listLevel);\n    };\n    /**\n     * Gets list start value\n     * @param listLevelNumber\n     * @param list\n     * @private\n     */\n    Layout.prototype.getListStartValue = function (listLevelNumber, list) {\n        // tslint:disable-next-line:max-line-length\n        var levelOverride = !isNullOrUndefined(list.levelOverrides) ? list.levelOverrides[listLevelNumber] : undefined;\n        if (!isNullOrUndefined(levelOverride) && isNullOrUndefined(levelOverride.overrideListLevel)) {\n            return levelOverride.startAt;\n        }\n        var listLevel = this.getListLevel(list, listLevelNumber);\n        if (isNullOrUndefined(listLevel)) {\n            return 0;\n        }\n        else {\n            return listLevel.startAt;\n        }\n    };\n    /**\n     * Updates list values.\n     * @param list\n     * @param listLevelNumber\n     * @param document\n     */\n    Layout.prototype.updateListValues = function (list, listLevelNumber) {\n        if (!this.viewer.renderedLists.containsKey(this.viewer.getAbstractListById(list.abstractListId))) {\n            var startVal = new Dictionary();\n            this.viewer.renderedLists.add(this.viewer.getAbstractListById(list.abstractListId), startVal);\n            var listLevel = this.getListLevel(list, listLevelNumber);\n            for (var i = 0; i <= listLevelNumber; i++) {\n                startVal.add(i, this.getListStartValue(i, list));\n            }\n        }\n        else {\n            // tslint:disable-next-line:max-line-length\n            var levels = this.viewer.renderedLists.get(this.viewer.getAbstractListById(list.abstractListId));\n            if (levels.containsKey(listLevelNumber)) {\n                var startAt = levels.get(listLevelNumber);\n                levels.set(listLevelNumber, startAt + 1);\n                var levelNumber = listLevelNumber + 1;\n                while (levelNumber < this.viewer.getAbstractListById(list.abstractListId).levels.length) {\n                    var listLevel = this.getListLevel(list, levelNumber);\n                    // if (!isNullOrUndefined(listLevel)) {\n                    if (levels.containsKey(levelNumber) && listLevel.restartLevel > listLevelNumber) {\n                        levels.remove(levelNumber);\n                        // if (document.renderedListLevels.indexOf(listLevel) > -1) {\n                        //     document.renderedListLevels.pop();\n                        // }\n                    }\n                    // }\n                    levelNumber++;\n                }\n            }\n            else {\n                var levelNumber = listLevelNumber;\n                while (!levels.containsKey(levelNumber - 1) && levelNumber > 0) {\n                    var listLevel = this.getListLevel(list, levelNumber - 1);\n                    // if (!isNullOrUndefined(listLevel)) {\n                    levels.add(levelNumber - 1, this.getListStartValue(levelNumber - 1, list));\n                    // if (document.renderedListLevels.indexOf(listLevel) !== -1) {\n                    //     document.renderedListLevels.push(listLevel);\n                    // }\n                    // }\n                    levelNumber--;\n                }\n                var startAt = this.getListStartValue(listLevelNumber, list);\n                levels.add(listLevelNumber, startAt);\n            }\n        }\n    };\n    /**\n     * Gets list text\n     * @param listAdv\n     * @param listLevelNumber\n     * @param currentListLevel\n     * @param document\n     */\n    Layout.prototype.getListText = function (listAdv, listLevelNumber, currentListLevel) {\n        var listText = currentListLevel.numberFormat;\n        // tslint:disable-next-line:max-line-length\n        if (this.viewer.renderedLists.containsKey(this.viewer.getAbstractListById(listAdv.abstractListId))) {\n            var levels = this.viewer.renderedLists.get(this.viewer.getAbstractListById(listAdv.abstractListId));\n            var keys = levels.keys;\n            for (var i = 0; i < keys.length; i++) {\n                var levelNumber = keys[i];\n                var levelKey = '%' + (levelNumber + 1).toString();\n                var listLevel = this.getListLevel(listAdv, levelNumber);\n                if (listText.match(levelKey)) {\n                    if (levelNumber > listLevelNumber) {\n                        return '';\n                    }\n                    else if (levels.containsKey(levelNumber) && !isNullOrUndefined(listLevel)) {\n                        listText = listText.replace(levelKey, this.getListTextListLevel(listLevel, levels.get(levelNumber)));\n                    }\n                    else {\n                        listText = listText.replace(levelKey, '0');\n                    }\n                }\n            }\n        }\n        return listText;\n    };\n    /**\n     * Gets the roman letter.\n     * @param number\n     * @private\n     */\n    Layout.prototype.getAsLetter = function (number) {\n        // if (number <= 0) {\n        //     return '';\n        // }\n        var quotient = number / 26;\n        var remainder = number % 26;\n        if (remainder === 0) {\n            //If number denotes the factor of 26, then reduce quotient by 1 and set remainder as 26.\n            remainder = 26;\n            quotient--;\n        }\n        //Index of A char in the ASCII table.     \n        var letter = String.fromCharCode(65 - 1 + remainder);\n        var listValue = '';\n        while (quotient >= 0) {\n            listValue = listValue + letter.toString();\n            quotient--;\n        }\n        return listValue;\n    };\n    /**\n     * Gets list text using list level pattern.\n     * @param listLevel\n     * @param listValue\n     * @private\n     */\n    Layout.prototype.getListTextListLevel = function (listLevel, listValue) {\n        switch (listLevel.listLevelPattern) {\n            case 'UpRoman':\n                return this.getAsRoman(listValue).toUpperCase();\n            case 'LowRoman':\n                return this.getAsRoman(listValue).toLowerCase();\n            case 'UpLetter':\n                return this.getAsLetter(listValue).toUpperCase();\n            case 'LowLetter':\n                return this.getAsLetter(listValue).toLowerCase();\n            case 'Arabic':\n                return (listValue).toString();\n            case 'LeadingZero':\n                return this.getAsLeadingZero(listValue);\n            case 'Number':\n                return (listValue).toString();\n            case 'OrdinalText':\n                return (listValue).toString();\n            case 'Ordinal':\n                return (listValue).toString();\n            case 'FarEast':\n                return (listValue).toString();\n            case 'Special':\n                return (listValue).toString();\n            default:\n                return '';\n        }\n    };\n    /**\n     * Generate roman number for the specified number.\n     * @param number\n     * @param magnitude\n     * @param letter\n     */\n    Layout.prototype.generateNumber = function (number, magnitude, letter) {\n        var numberstring = '';\n        while (number >= magnitude) {\n            number -= magnitude;\n            numberstring += letter;\n            this.value = number;\n        }\n        return numberstring.toString();\n    };\n    /**\n     * Gets list value prefixed with zero, if less than 10\n     * @param listValue\n     */\n    Layout.prototype.getAsLeadingZero = function (listValue) {\n        if (listValue < 10) {\n            return '0' + listValue.toString();\n        }\n        else {\n            return listValue.toString();\n        }\n    };\n    /**\n     * Gets the roman number\n     * @param number\n     * @private\n     */\n    Layout.prototype.getAsRoman = function (number) {\n        var retval = '';\n        this.value = number;\n        retval += this.generateNumber(this.value, 1000, 'M');\n        retval += this.generateNumber(this.value, 900, 'CM');\n        retval += this.generateNumber(this.value, 500, 'D');\n        retval += this.generateNumber(this.value, 400, 'CD');\n        retval += this.generateNumber(this.value, 100, 'C');\n        retval += this.generateNumber(this.value, 90, 'XC');\n        retval += this.generateNumber(this.value, 50, 'L');\n        retval += this.generateNumber(this.value, 40, 'XL');\n        retval += this.generateNumber(this.value, 10, 'X');\n        retval += this.generateNumber(this.value, 9, 'IX');\n        retval += this.generateNumber(this.value, 5, 'V');\n        retval += this.generateNumber(this.value, 4, 'IV');\n        retval += this.generateNumber(this.value, 1, 'I');\n        return retval.toString();\n    };\n    /**\n     * Gets the list level\n     * @param list\n     * @param listLevelNumber\n     * @private\n     */\n    Layout.prototype.getListLevel = function (list, listLevelNumber) {\n        if (!isNullOrUndefined(list)) {\n            var abstractList = this.viewer.getAbstractListById(list.abstractListId);\n            if (!isNullOrUndefined(list) && abstractList.levels.length <= listLevelNumber\n                && listLevelNumber >= 0 && listLevelNumber < 9) {\n                this.addListLevels(abstractList);\n            }\n            var levelOverrideAdv = undefined;\n            var level = false;\n            level = (!isNullOrUndefined(list.levelOverrides))\n                && !isNullOrUndefined(((levelOverrideAdv = list.levelOverrides[listLevelNumber])))\n                && (!isNullOrUndefined(levelOverrideAdv.overrideListLevel));\n            if (level) {\n                return levelOverrideAdv.overrideListLevel;\n            }\n            else if (!isNullOrUndefined(abstractList) && listLevelNumber >= 0 && listLevelNumber < abstractList.levels.length) {\n                return abstractList.levels[listLevelNumber];\n            }\n        }\n        return undefined;\n    };\n    /**\n     * Gets tab width\n     * @param paragraph\n     * @param viewer\n     */\n    // tslint:disable-next-line:max-line-length\n    Layout.prototype.getTabWidth = function (paragraph, viewer, index, lineWidget, element) {\n        var fposition = 0;\n        var isCustomTab = false;\n        var tabs = paragraph.paragraphFormat.getUpdatedTabs();\n        //  Calculate hanging width\n        if (viewer.clientActiveArea.x < viewer.clientArea.x) {\n            return viewer.clientArea.x - viewer.clientActiveArea.x;\n        }\n        // Calculates tabwidth based on pageleftmargin and defaulttabwidth property\n        var position = viewer.clientActiveArea.x -\n            (viewer.clientArea.x - HelperMethods.convertPointToPixel(paragraph.paragraphFormat.leftIndent));\n        var defaultTabWidth = HelperMethods.convertPointToPixel(viewer.defaultTabWidth);\n        if (tabs.length === 0 && (position === 0 || defaultTabWidth === 0)) {\n            return defaultTabWidth;\n        }\n        else {\n            if (tabs.length > 0) {\n                for (var i = 0; i < tabs.length; i++) {\n                    var tabPosition = HelperMethods.convertPointToPixel(tabs[i].position);\n                    if (tabs[i].tabJustification === 'Left' && position < tabPosition) {\n                        fposition = tabPosition;\n                        isCustomTab = true;\n                        if (!isNullOrUndefined(element)) {\n                            element.tabLeader = tabs[i].tabLeader;\n                            element.tabText = '';\n                        }\n                        break;\n                    }\n                    else if (tabs[i].tabJustification === 'Right' && position < tabPosition) {\n                        var tabwidth = tabPosition - position;\n                        var width = this.getRightTabWidth(index + 1, lineWidget, paragraph);\n                        if (width < tabwidth) {\n                            defaultTabWidth = tabwidth - width;\n                        }\n                        else {\n                            defaultTabWidth = 0;\n                        }\n                        fposition = position;\n                        isCustomTab = true;\n                        if (!isNullOrUndefined(element)) {\n                            element.tabLeader = tabs[i].tabLeader;\n                            element.tabText = '';\n                        }\n                        break;\n                    }\n                }\n            }\n            if (!isCustomTab) {\n                var diff = ((Math.round(position) * 100) % (Math.round(defaultTabWidth) * 100)) / 100;\n                var cnt = (Math.round(position) - diff) / Math.round(defaultTabWidth);\n                fposition = (cnt + 1) * defaultTabWidth;\n            }\n            return (fposition - position) > 0 ? fposition - position : defaultTabWidth;\n        }\n    };\n    /**\n     * Returns the right tab width\n     * @param index - index of starting inline\n     * @param lineWidget - current line widget\n     * @param paragraph - current paragraph widget\n     */\n    Layout.prototype.getRightTabWidth = function (index, lineWidget, paragraph) {\n        var width = 0;\n        var isFieldCode = false;\n        while (index < lineWidget.children.length) {\n            var elementBox = lineWidget.children[index];\n            if ((elementBox instanceof FieldElementBox) || (elementBox instanceof BookmarkElementBox) || isFieldCode) {\n                if (elementBox instanceof FieldElementBox) {\n                    if (elementBox.fieldType === 0) {\n                        isFieldCode = true;\n                    }\n                    else if (elementBox.fieldType === 2) {\n                        isFieldCode = false;\n                    }\n                }\n                elementBox.width = 0;\n            }\n            else {\n                this.viewer.textHelper.getTextSize(elementBox, elementBox.characterFormat);\n            }\n            if (elementBox instanceof TextElementBox && elementBox.text === '\\t') {\n                return width;\n            }\n            else {\n                width = width + elementBox.width;\n            }\n            index++;\n        }\n        return width;\n    };\n    /**\n     * Gets split index by word.\n     * @param clientActiveWidth\n     * @param text\n     * @param width\n     * @param characterFormat\n     */\n    Layout.prototype.getSplitIndexByWord = function (clientActiveWidth, text, width, characterFormat) {\n        var index = 0;\n        var length = text.length;\n        while (index < length) {\n            var nextIndex = this.getTextIndexAfterSpace(text, index);\n            if (nextIndex === 0 || nextIndex === length) {\n                nextIndex = length - 1;\n            }\n            var splitWidth = width;\n            if ((nextIndex < length - 1 || (nextIndex === length - 1 && text[nextIndex - 1] === ' ')) && index !== nextIndex) {\n                splitWidth = this.viewer.textHelper.measureTextExcludingSpaceAtEnd(text.slice(0, nextIndex), characterFormat);\n            }\n            if (splitWidth <= clientActiveWidth) {\n                index = nextIndex;\n            }\n            else {\n                if (index === 0 && text[0] === ' ') {\n                    index = this.getTextIndexAfterSpace(text, 0);\n                }\n                break;\n            }\n        }\n        return index;\n    };\n    /**\n     * Gets split index by character\n     * @param totalClientWidth\n     * @param clientActiveAreaWidth\n     * @param text\n     * @param width\n     * @param characterFormat\n     */\n    // tslint:disable-next-line:max-line-length\n    Layout.prototype.getTextSplitIndexByCharacter = function (totalClientWidth, clientActiveAreaWidth, text, width, characterFormat) {\n        var length = text.length;\n        for (var i = 0; i < length; i++) {\n            var splitWidth = width;\n            if (i + 1 < length) {\n                splitWidth = this.viewer.textHelper.measureTextExcludingSpaceAtEnd(text.substring(0, i + 1), characterFormat);\n            }\n            if (splitWidth > clientActiveAreaWidth) {\n                if (i === 0 && splitWidth > totalClientWidth) {\n                    //Handle for cell/section having client width less than a character's width.\n                    return (length > 1 && text[1] === ' ') ? this.getTextIndexAfterSpace(text, 1) : 1;\n                }\n                return i;\n            }\n        }\n        return 0;\n    };\n    /**\n     * Gets sub width.\n     * @param justify\n     * @param spaceCount\n     * @param firstLineIndent\n     */\n    Layout.prototype.getSubWidth = function (lineWidget, justify, spaceCount, firstLineIndent) {\n        var width = 0;\n        var trimSpace = true;\n        var lineText = '';\n        for (var i = lineWidget.children.length - 1; i >= 0; i--) {\n            var element = lineWidget.children[i];\n            if (element instanceof TextElementBox) {\n                var elementText = element.text;\n                lineText = elementText + lineText;\n                if (trimSpace && (elementText.trim() !== '' || elementText === '\\t')) {\n                    if (HelperMethods.endsWith(elementText)) {\n                        width += this.viewer.textHelper.measureTextExcludingSpaceAtEnd(elementText, element.characterFormat);\n                    }\n                    else {\n                        width += element.width;\n                    }\n                    trimSpace = false;\n                }\n                else if (!trimSpace) {\n                    width += element.width;\n                }\n            }\n            else {\n                lineText = 'a' + lineText;\n                trimSpace = false;\n                width += element.width;\n            }\n            if (!justify) {\n                width = Math.round(width);\n            }\n        }\n        lineText = lineText.trim();\n        spaceCount = lineText.length - HelperMethods.removeSpace(lineText).length;\n        var subWidth = (this.viewer.clientArea.width - firstLineIndent - width);\n        if (subWidth <= 0 || (spaceCount === 0 && justify)) {\n            spaceCount = 0;\n            subWidth = 0;\n        }\n        else if (justify) {\n            subWidth = subWidth / spaceCount;\n        }\n        return { 'subWidth': subWidth, 'spaceCount': spaceCount };\n    };\n    /**\n     * Gets before spacing.\n     * @param paragraph\n     * @private\n     */\n    Layout.prototype.getBeforeSpacing = function (paragraph) {\n        var beforeSpacing = 0;\n        if (paragraph.previousWidget instanceof ParagraphWidget) {\n            if (paragraph.previousWidget.paragraphFormat.afterSpacing < paragraph.paragraphFormat.beforeSpacing) {\n                // tslint:disable-next-line:max-line-length\n                beforeSpacing = paragraph.paragraphFormat.beforeSpacing - paragraph.previousWidget.paragraphFormat.afterSpacing;\n            }\n        }\n        else {\n            beforeSpacing = paragraph.paragraphFormat.beforeSpacing;\n        }\n        return beforeSpacing;\n    };\n    /**\n     * Gets line spacing.\n     * @param paragraph\n     * @param maxHeight\n     * @private\n     */\n    Layout.prototype.getLineSpacing = function (paragraph, maxHeight) {\n        if (isNullOrUndefined(paragraph.paragraphFormat)) {\n            return 0;\n        }\n        var lineSpacing = 0;\n        switch (paragraph.paragraphFormat.lineSpacingType) {\n            case 'AtLeast':\n            case 'Exactly':\n                lineSpacing = paragraph.paragraphFormat.lineSpacing;\n                break;\n            default:\n                lineSpacing = paragraph.paragraphFormat.lineSpacing * maxHeight;\n                break;\n        }\n        return lineSpacing;\n    };\n    /**\n     * Checks whether current line is first line in a paragraph.\n     * @param paragraph\n     */\n    Layout.prototype.isParagraphFirstLine = function (paragraph, line) {\n        var widget = paragraph;\n        if (isNullOrUndefined(widget.childWidgets) || widget.childWidgets.indexOf(line) === 0) {\n            //If the line elements conatins the elements from previous paragraph then need to retun false.\n            //Example scenario, Field start and field end in different paragraphs.\n            if (line.children.length > 0 && !isNullOrUndefined(paragraph.previousWidget)\n                && paragraph.previousWidget instanceof ParagraphWidget) {\n                return line.paragraph.index !== paragraph.previousWidget.index;\n            }\n            return true; //If the line elements count is zero then also need to return true.\n        }\n        return false;\n    };\n    /**\n     * Checks whether current line is last line in a paragraph.\n     * @param paragraph\n     */\n    Layout.prototype.isParagraphLastLine = function (element) {\n        var paragraph = element.line.paragraph;\n        var lastLineWidget = paragraph.childWidgets[paragraph.childWidgets.length - 1];\n        var lastInline = lastLineWidget.children[lastLineWidget.children.length - 1];\n        if (element === lastInline) {\n            // tslint:disable-next-line:max-line-length            \n            return (lastInline instanceof FieldElementBox) || ((!(lastInline instanceof TextElementBox && lastInline.text === '\\v')));\n        }\n        return false;\n    };\n    /**\n     * Gets text index after space.\n     * @param text\n     * @param startIndex\n     */\n    Layout.prototype.getTextIndexAfterSpace = function (text, startIndex) {\n        var length = text.length;\n        var index = 0;\n        index = text.indexOf(' ', startIndex) + 1;\n        var nextIndex = index;\n        if (nextIndex === 0 || nextIndex === length) {\n            return nextIndex;\n        }\n        while (text[nextIndex] === ' ') {\n            nextIndex++;\n            if (nextIndex === length) {\n                break;\n            }\n        }\n        return nextIndex;\n    };\n    //#region Table\n    /**\n     * @private\n     */\n    Layout.prototype.moveNextWidgetsToTable = function (tableWidget, rowWidgets, moveFromNext) {\n        var currentRow = moveFromNext ? rowWidgets[rowWidgets.length - 2] : rowWidgets[rowWidgets.length - 1];\n        var rowIndex = currentRow.indexInOwner;\n        var currentTable = tableWidget[tableWidget.length - 1];\n        if (moveFromNext) {\n            rowIndex += 1;\n        }\n        var nextWidgets = currentRow.containerWidget.childWidgets.splice(rowIndex);\n        for (var i = 0; i < nextWidgets.length; i++) {\n            currentTable.childWidgets.push(nextWidgets[i]);\n            nextWidgets[i].containerWidget = currentTable;\n        }\n    };\n    /**\n     * Adds table cell widget.\n     * @param cell\n     * @param area\n     * @param maxCellMarginTop\n     * @param maxCellMarginBottom\n     */\n    Layout.prototype.addTableCellWidget = function (cell, area, maxCellMarginTop, maxCellMarginBottom) {\n        //let tableCellWidget: TableCellWidget = new TableCellWidget(cell);\n        var prevColumnIndex = 0;\n        var cellspace = 0;\n        var left = 0;\n        var top = maxCellMarginTop;\n        var right = 0;\n        var bottom = maxCellMarginBottom;\n        if (!isNullOrUndefined(cell.cellFormat)) {\n            if (cell.cellFormat.containsMargins()) {\n                // tslint:disable-next-line:max-line-length\n                left = isNullOrUndefined(cell.cellFormat.leftMargin) ? HelperMethods.convertPointToPixel(cell.ownerTable.tableFormat.leftMargin) : HelperMethods.convertPointToPixel(cell.cellFormat.leftMargin);\n                right = isNullOrUndefined(cell.cellFormat.rightMargin) ? HelperMethods.convertPointToPixel(cell.ownerTable.tableFormat.rightMargin) : HelperMethods.convertPointToPixel(cell.cellFormat.rightMargin);\n            }\n            else {\n                left = HelperMethods.convertPointToPixel(cell.ownerTable.tableFormat.leftMargin);\n                right = HelperMethods.convertPointToPixel(cell.ownerTable.tableFormat.rightMargin);\n            }\n        }\n        cell.margin = new Margin(left, top, right, bottom);\n        cell.width = HelperMethods.convertPointToPixel(cell.cellFormat.cellWidth);\n        if (!isNullOrUndefined(cell.previousWidget)) {\n            // tslint:disable-next-line:max-line-length\n            prevColumnIndex = cell.previousWidget.columnIndex + cell.previousWidget.cellFormat.columnSpan;\n        }\n        // tslint:disable-next-line:max-line-length\n        cellspace = !isNullOrUndefined(cell.ownerTable) && !isNullOrUndefined(cell.ownerTable.tableFormat) ? HelperMethods.convertPointToPixel(cell.ownerTable.tableFormat.cellSpacing) : 0;\n        var prevSpannedCellWidth = 0;\n        if (prevColumnIndex < cell.columnIndex) {\n            // tslint:disable-next-line:max-line-length\n            prevSpannedCellWidth = HelperMethods.convertPointToPixel(cell.ownerTable.tableHolder.getPreviousSpannedCellWidth(prevColumnIndex, cell.columnIndex));\n            if (prevColumnIndex === 0) {\n                prevSpannedCellWidth = prevSpannedCellWidth - cellspace / 2;\n            }\n        }\n        cell.x = area.x + prevSpannedCellWidth + cell.margin.left;\n        cell.y = area.y + cell.margin.top + cellspace;\n        cell.width = cell.width - cell.margin.left - cell.margin.right;\n        if (cellspace > 0) {\n            cell.x += cellspace;\n            if (cell.ownerTable.tableHolder.columns.length === 1) {\n                cell.width -= cellspace * 2;\n            }\n            else if (cell.columnIndex === 0 || cell.columnIndex === cell.ownerTable.tableHolder.columns.length - 1) {\n                cell.width -= ((cellspace * 2) - cellspace / 2);\n            }\n            else {\n                cell.width -= cellspace;\n            }\n        }\n        // update the margins values respect to layouting of borders.\n        // tslint:disable-next-line:max-line-length\n        //For normal table cells only left border is rendred. for last cell left and right border is rendred. this border widths are not included in margins.\n        cell.leftBorderWidth = HelperMethods.convertPointToPixel(TableCellWidget.getCellLeftBorder(cell).getLineWidth());\n        cell.x += cell.leftBorderWidth;\n        cell.width -= cell.leftBorderWidth;\n        if (cellspace > 0 || cell.cellIndex === cell.ownerRow.childWidgets.length - 1) {\n            cell.rightBorderWidth = TableCellWidget.getCellRightBorder(cell).getLineWidth();\n            cell.width -= cell.rightBorderWidth;\n        }\n        //Add the border widths to respective margin side.\n        cell.margin.left = cell.margin.left + cell.leftBorderWidth;\n        cell.margin.right = cell.margin.right + cell.rightBorderWidth;\n        //cell.ownerWidget = owner;\n        return cell;\n    };\n    /**\n     * Adds specified row widget to table.\n     * @param viewer\n     * @param tableRowWidget\n     * @param row\n     */\n    // tslint:disable-next-line:max-line-length\n    Layout.prototype.addWidgetToTable = function (viewer, tableCollection, rowCollection, row, endRowWidget) {\n        //Adds table row widget to owner table widget.\n        var tableWidget = tableCollection[0];\n        var index = tableWidget.childWidgets.length;\n        var prevWidget = undefined;\n        var rowWidgetIndex = rowCollection.indexOf(row);\n        if (rowWidgetIndex > 0) {\n            prevWidget = rowCollection[rowWidgetIndex - 1];\n            // Need to update on this further\n        }\n        else if (row.previousRenderedWidget instanceof TableRowWidget &&\n            row.previousRenderedWidget.ownerTable.equals(row.ownerTable)) {\n            // Need to update on this further\n            prevWidget = row.previousRenderedWidget;\n        }\n        if (!isNullOrUndefined(prevWidget)) {\n            tableWidget = prevWidget.containerWidget;\n            // index = tableWidget.childWidgets.length;\n            index = tableWidget.childWidgets.indexOf(prevWidget) + 1;\n            if (Math.round(row.y) !== Math.round(prevWidget.y + prevWidget.height)) {\n                var prevIndex = tableCollection.indexOf(tableWidget);\n                if (prevIndex + 1 >= tableCollection.length) {\n                    //Creates new table widget for splitted rows.\n                    this.addTableWidget(viewer.clientActiveArea, tableCollection, true);\n                }\n                tableWidget = tableCollection[prevIndex + 1];\n                index = tableWidget.childWidgets.length;\n            }\n            if (rowWidgetIndex > 0) {\n                index = 0;\n            }\n        }\n        this.updateRowHeightBySpannedCell(tableWidget, row, index);\n        this.updateRowHeightByCellSpacing(tableCollection, row, viewer);\n        //Remove widget from previous container after splitteing\n        if (row.containerWidget && row.containerWidget !== tableWidget &&\n            row.containerWidget.childWidgets.indexOf(row) !== -1) {\n            row.containerWidget.childWidgets.splice(row.containerWidget.childWidgets.indexOf(row), 1);\n        }\n        if (tableWidget.childWidgets.indexOf(row) === -1) {\n            tableWidget.childWidgets.splice(index, 0, row);\n        }\n        row.containerWidget = tableWidget;\n        tableWidget.height = tableWidget.height + row.height;\n        if (!isNullOrUndefined(tableWidget.containerWidget)\n            && tableWidget.containerWidget.childWidgets.indexOf(tableWidget) >= 0 &&\n            !(tableWidget.containerWidget instanceof HeaderFooterWidget)) {\n            tableWidget.containerWidget.height += row.height;\n        }\n        this.updateHeightForRowWidget(viewer, false, tableCollection, rowCollection, row, false, endRowWidget);\n        viewer.cutFromTop(row.y + row.height);\n    };\n    /**\n     * Updates row height by spanned cell.\n     * @param tableWidget\n     * @param rowWidget\n     * @param insertIndex\n     * @param row\n     * @private\n     */\n    Layout.prototype.updateRowHeightBySpannedCell = function (tableWidget, row, insertIndex) {\n        var rowSpan = 1;\n        if (tableWidget.childWidgets.length === 0 || insertIndex === 0) {\n            this.updateRowHeight(row, row);\n            return;\n        }\n        for (var i = 0; i < row.childWidgets.length; i++) {\n            var cellWidget = row.childWidgets[i];\n            // tslint:disable-next-line:max-line-length\n            rowSpan = (isNullOrUndefined(cellWidget) || isNullOrUndefined(cellWidget.cellFormat)) ? rowSpan : cellWidget.cellFormat.rowSpan;\n            this.updateSpannedRowCollection(rowSpan, row);\n        }\n        if (!isNullOrUndefined(row.ownerTable)) {\n            for (var i = 0; i < row.ownerTable.spannedRowCollection.length; i++) {\n                if (row.ownerTable.spannedRowCollection.keys[i] === row.index) {\n                    // Back track to previous table row widgets and update it height if vertical merge ends with this row.\n                    for (var j = 0; j < insertIndex; j++) {\n                        var prevRowWidget = tableWidget.childWidgets[j];\n                        this.updateRowHeight(prevRowWidget, row);\n                    }\n                    row.ownerTable.spannedRowCollection.remove(row.ownerTable.spannedRowCollection.keys[i]);\n                    break;\n                }\n            }\n        }\n    };\n    /**\n     * Updates row height.\n     * @param prevRowWidget\n     * @param rowWidget\n     * @param row\n     */\n    Layout.prototype.updateRowHeight = function (prevRowWidget, row) {\n        var rowIndex = row.index;\n        var rowSpan = 1;\n        for (var i = 0; i < prevRowWidget.childWidgets.length; i++) {\n            var cellWidget = prevRowWidget.childWidgets[i];\n            // tslint:disable-next-line:max-line-length\n            rowSpan = (isNullOrUndefined(cellWidget) || isNullOrUndefined(cellWidget.cellFormat)) ? rowSpan : cellWidget.cellFormat.rowSpan;\n            //To update Row height- if row has row span value greater than 1, need to add it in spannedRowCollection            \n            this.updateSpannedRowCollection(rowSpan, row);\n            if (rowIndex - cellWidget.rowIndex === rowSpan - 1) {\n                var mergedCellHeight = cellWidget.y + cellWidget.height + cellWidget.margin.bottom - row.y;\n                if (row.height < mergedCellHeight) {\n                    row.height = mergedCellHeight;\n                }\n            }\n        }\n    };\n    //if row has row span value greater than 1, need to add it in spannedRowCollection\n    Layout.prototype.updateSpannedRowCollection = function (rowSpan, row) {\n        if (rowSpan > 1 && !isNullOrUndefined(row.ownerTable)) {\n            //Checks the rowspan is already exist in the list\n            if (!row.ownerTable.spannedRowCollection.containsKey(row.index + rowSpan - 1)) {\n                row.ownerTable.spannedRowCollection.add(row.index + rowSpan - 1, row.index);\n            }\n        }\n    };\n    /**\n     * Updates row height by cell spacing\n     * @param rowWidget\n     * @param viewer\n     * @param row\n     */\n    Layout.prototype.updateRowHeightByCellSpacing = function (tableCollection, row, viewer) {\n        if (row.ownerTable.tableFormat.cellSpacing > 0) {\n            // In the Case of tableWidget is greater than one and rowWidget is start at the Top Position of the page. \n            // In such case we have update the row height with half of cell spacing.\n            // Remaining cases we have to update the entire hight\n            // tslint:disable-next-line:max-line-length\n            if (tableCollection.length > 1 && row.y === viewer.clientArea.y && viewer instanceof PageLayoutViewer) {\n                row.height = row.height - HelperMethods.convertPointToPixel(row.ownerTable.tableFormat.cellSpacing) / 2;\n            }\n        }\n    };\n    /**\n     * Checks whether row span is end.\n     * @param row\n     * @param viewer\n     */\n    Layout.prototype.isRowSpanEnd = function (row, viewer) {\n        var rowIndex = row.index;\n        var rowSpan = 1;\n        for (var i = 0; i < viewer.splittedCellWidgets.length; i++) {\n            var splittedCell = viewer.splittedCellWidgets[i];\n            // tslint:disable-next-line:max-line-length\n            rowSpan = (isNullOrUndefined(splittedCell) || isNullOrUndefined(splittedCell.cellFormat)) ? rowSpan : splittedCell.cellFormat.rowSpan;\n            if (rowIndex - splittedCell.rowIndex === rowSpan - 1) {\n                return true;\n            }\n        }\n        return false;\n    };\n    /**\n     * Checks whether vertical merged cell to continue or not.\n     * @param row\n     * @private\n     */\n    Layout.prototype.isVerticalMergedCellContinue = function (row) {\n        var colIndex = 0;\n        for (var i = 0; i < row.childWidgets.length; i++) {\n            var cell = row.childWidgets[i];\n            if (colIndex < cell.columnIndex) {\n                return true;\n            }\n            colIndex += cell.cellFormat.columnSpan;\n        }\n        return colIndex < row.ownerTable.tableHolder.columns.length;\n    };\n    /**\n     * Splits widgets.\n     * @param tableRowWidget\n     * @param viewer\n     * @param splittedWidget\n     * @param row\n     */\n    // tslint:disable-next-line:max-line-length\n    Layout.prototype.splitWidgets = function (tableRowWidget, viewer, tableCollection, rowCollection, splittedWidget, isLastRow) {\n        if (this.isFirstLineFitForRow(viewer.clientArea.bottom, tableRowWidget) && tableRowWidget.childWidgets.length > 0) {\n            splittedWidget = this.getSplittedWidgetForRow(viewer.clientArea.bottom, tableCollection, rowCollection, tableRowWidget);\n            if (viewer.splittedCellWidgets.length > 0 || splittedWidget !== tableRowWidget) {\n                if (isLastRow) {\n                    for (var i = 0; i < splittedWidget.childWidgets.length; i++) {\n                        var cell = splittedWidget.childWidgets[i];\n                        if (cell.rowIndex !== splittedWidget.index) {\n                            splittedWidget.childWidgets.splice(i, 1);\n                            i--;\n                        }\n                    }\n                }\n                //Adds the splitted widget of a vertical merged cell, to next row widget in the next page.\n                this.insertSplittedCellWidgets(viewer, tableCollection, splittedWidget, tableRowWidget.indexInOwner - 1);\n            }\n        }\n        else {\n            //Adds the splitted widget of a vertical merged cell, to next row widget in the next page.\n            this.insertSplittedCellWidgets(viewer, tableCollection, splittedWidget, tableRowWidget.indexInOwner - 1);\n        }\n        return splittedWidget;\n    };\n    /**\n     * Gets splitted widget for row.\n     * @param bottom\n     * @param tableRowWidget\n     */\n    // tslint:disable-next-line:max-line-length\n    Layout.prototype.getSplittedWidgetForRow = function (bottom, tableCollection, rowCollection, tableRowWidget) {\n        var splittedWidget = undefined;\n        var rowIndex = tableRowWidget.index;\n        for (var i = 0; i < tableRowWidget.childWidgets.length; i++) {\n            var cellWidget = tableRowWidget.childWidgets[i];\n            var splittedCell = this.getSplittedWidget(bottom, true, tableCollection, rowCollection, cellWidget);\n            if (!isNullOrUndefined(splittedCell)) {\n                if (splittedCell === cellWidget) {\n                    //Returns if the whole content of the row does not fit in current page.\n                    return tableRowWidget;\n                }\n                if (tableRowWidget.childWidgets.indexOf(splittedCell) !== -1) {\n                    tableRowWidget.childWidgets.splice(tableRowWidget.childWidgets.indexOf(splittedCell), 1);\n                }\n                if (i === 0 || tableRowWidget.height < cellWidget.height + cellWidget.margin.top + cellWidget.margin.bottom) {\n                    tableRowWidget.height = cellWidget.height + cellWidget.margin.top + cellWidget.margin.bottom;\n                }\n                if (isNullOrUndefined(splittedWidget)) {\n                    //Creates new widget, to hold the splitted contents.\n                    splittedWidget = new TableRowWidget();\n                    splittedWidget.containerWidget = tableRowWidget.containerWidget;\n                    splittedWidget.index = tableRowWidget.index;\n                    splittedWidget.rowFormat = tableRowWidget.rowFormat;\n                    this.updateWidgetLocation(tableRowWidget, splittedWidget);\n                    splittedWidget.height = 0;\n                    rowCollection.push(splittedWidget);\n                }\n                var rowSpan = 1;\n                // tslint:disable-next-line:max-line-length\n                rowSpan = (isNullOrUndefined(splittedCell) || isNullOrUndefined(splittedCell.cellFormat)) ? rowSpan : splittedCell.cellFormat.rowSpan;\n                if (rowIndex - splittedCell.rowIndex === rowSpan - 1\n                    && splittedWidget.height < splittedCell.height + splittedCell.margin.top + splittedCell.margin.bottom) {\n                    splittedWidget.height = splittedCell.height + splittedCell.margin.top + splittedCell.margin.bottom;\n                }\n                splittedWidget.childWidgets.push(splittedCell);\n                splittedCell.containerWidget = splittedWidget;\n            }\n        }\n        return splittedWidget;\n    };\n    /**\n     * Updates widget to table.\n     * @param row\n     * @param viewer\n     */\n    /* tslint:disable */\n    Layout.prototype.updateWidgetsToTable = function (tableWidgets, rowWidgets, row) {\n        var rowHeight = this.getRowHeight(row, [row]);\n        var viewer = this.viewer;\n        //initializing row properties with default values.\n        var isHeader = row.rowFormat.isHeader;\n        var isAllowBreakAcrossPages = row.rowFormat.allowBreakAcrossPages;\n        var heightType = row.rowFormat.heightType;\n        var cellSpacing = 0;\n        var count = 0;\n        var tableRowWidget = row;\n        var moveRowToNextTable = false;\n        if (row.ownerTable.continueHeader && !isHeader) {\n            row.ownerTable.continueHeader = false;\n        }\n        var isLastRow = false;\n        cellSpacing = (!isNullOrUndefined(row.ownerTable) && !isNullOrUndefined(row.ownerTable.tableFormat)) ? HelperMethods.convertPointToPixel(row.ownerTable.tableFormat.cellSpacing) : 0;\n        while (count < rowWidgets.length) {\n            count = rowWidgets.length;\n            if (row.ownerTable.isInsideTable || (viewer.splittedCellWidgets.length === 0 && tableRowWidget.y + tableRowWidget.height + cellSpacing <= viewer.clientArea.bottom)) {\n                this.addWidgetToTable(viewer, tableWidgets, rowWidgets, tableRowWidget);\n                if (viewer.splittedCellWidgets.length > 0 && isNullOrUndefined(rowWidgets[rowWidgets.length - 1].nextRow)) {\n                    count--;\n                    isLastRow = true;\n                }\n            }\n            else {\n                //Split widget for next page\n                if (viewer.splittedCellWidgets.length > 0 && tableRowWidget.y + tableRowWidget.height <= viewer.clientArea.bottom) {\n                    var isRowSpanEnd = this.isRowSpanEnd(row, viewer);\n                    if (!isRowSpanEnd) {\n                        if (this.isVerticalMergedCellContinue(row) && tableRowWidget.y == viewer.clientArea.y) {\n                            this.insertSplittedCellWidgets(viewer, tableWidgets, tableRowWidget, tableRowWidget.indexInOwner - 1);\n                        }\n                        this.addWidgetToTable(viewer, tableWidgets, rowWidgets, tableRowWidget);\n                        continue;\n                    }\n                }\n                var splittedWidget = tableRowWidget;\n                var tableWidget = tableWidgets[tableWidgets.length - 1];\n                if (rowHeight + tableRowWidget.y > viewer.clientArea.bottom) {\n                    // tslint:disable-next-line:max-line-length\n                    if (!isAllowBreakAcrossPages || (isHeader && row.ownerTable.continueHeader) || (heightType === 'AtLeast' && HelperMethods.convertPointToPixel(row.rowFormat.height) < viewer.clientArea.bottom)) {\n                        // tslint:disable-next-line:max-line-length\n                        if ((heightType === 'AtLeast' && HelperMethods.convertPointToPixel(row.rowFormat.height) < viewer.clientActiveArea.height && isAllowBreakAcrossPages) || (heightType !== 'Exactly' && tableRowWidget.y === viewer.clientArea.y) || (heightType === 'Auto' && isAllowBreakAcrossPages)) {\n                            splittedWidget = this.splitWidgets(tableRowWidget, viewer, tableWidgets, rowWidgets, splittedWidget, isLastRow);\n                        }\n                        if (heightType === 'Exactly' && tableRowWidget.y === viewer.clientArea.y) {\n                            this.addWidgetToTable(viewer, tableWidgets, rowWidgets, tableRowWidget);\n                            count++;\n                        }\n                        if (isHeader && row.ownerTable.continueHeader) {\n                            row.ownerTable.header = false;\n                            row.ownerTable.continueHeader = false;\n                            row.ownerTable.headerHeight = 0;\n                            var pages = undefined;\n                            // if (viewer instanceof PageLayoutViewer) {\n                            pages = viewer.pages;\n                            // }\n                            if (!isNullOrUndefined(pages)) {\n                                for (var i = 0; i < pages.length; i++) {\n                                    if (pages[i].repeatHeaderRowTableWidget) {\n                                        pages[i].repeatHeaderRowTableWidget = false;\n                                    }\n                                }\n                            }\n                        }\n                    }\n                    else {\n                        if ((heightType === 'Auto' || heightType === 'AtLeast') && isAllowBreakAcrossPages) {\n                            // tslint:disable-next-line:max-line-length\n                            if (!(HelperMethods.convertPointToPixel(row.rowFormat.height) > viewer.clientArea.bottom) || tableRowWidget.y === viewer.clientArea.y) {\n                                splittedWidget = this.splitWidgets(tableRowWidget, viewer, tableWidgets, rowWidgets, splittedWidget, isLastRow);\n                            }\n                        }\n                        else if (heightType === 'Exactly' && tableRowWidget.y === viewer.clientArea.y) {\n                            this.addWidgetToTable(viewer, tableWidgets, rowWidgets, tableRowWidget);\n                            count++;\n                        }\n                    }\n                }\n                else {\n                    var isInsertSplittedWidgets = false;\n                    // Splitting handled for the merged cell with allowRowBreakAcross pages. \n                    if (this.isVerticalMergedCellContinue(row) && (isAllowBreakAcrossPages ||\n                        (isInsertSplittedWidgets = tableRowWidget.y == viewer.clientArea.y))) {\n                        if (isInsertSplittedWidgets) {\n                            this.insertSplittedCellWidgets(viewer, tableWidgets, splittedWidget, tableRowWidget.indexInOwner - 1);\n                        }\n                        else {\n                            splittedWidget = this.splitWidgets(tableRowWidget, viewer, tableWidgets, rowWidgets, splittedWidget, isLastRow);\n                        }\n                    }\n                    else if (isLastRow && !isAllowBreakAcrossPages) {\n                        splittedWidget = this.splitWidgets(tableRowWidget, viewer, tableWidgets, rowWidgets, splittedWidget, isLastRow);\n                    }\n                }\n                //Create New table for splitted widget\n                if (!isNullOrUndefined(splittedWidget)) {\n                    if (splittedWidget !== tableRowWidget) {\n                        this.addWidgetToTable(viewer, tableWidgets, rowWidgets, tableRowWidget, tableRowWidget.nextRow);\n                        //Updates the fitted table rows to current page.\n                        this.updateWidgetsToPage(tableWidgets, rowWidgets, row.ownerTable, tableRowWidget.nextRow);\n                        var index_2 = tableWidgets.indexOf(tableRowWidget.containerWidget);\n                        if (index_2 + 1 >= tableWidgets.length) {\n                            //Creates new table widget for splitted rows.\n                            this.addTableWidget(viewer.clientActiveArea, tableWidgets, true);\n                        }\n                        tableRowWidget = splittedWidget;\n                    }\n                    else {\n                        if (row.index > 0) {\n                            //Updates the fitted table rows to current page.\n                            this.updateWidgetsToPage(tableWidgets, rowWidgets, row.ownerTable, row);\n                            // Need to update on this further\n                            if (row.previousRenderedWidget instanceof TableRowWidget) {\n                                // Need to update on this further\n                                var prevWidget = row.previousRenderedWidget;\n                                if (HelperMethods.round(tableRowWidget.y, 2) === HelperMethods.round(prevWidget.y + prevWidget.height, 2)) {\n                                    var prevIndex = tableWidgets.indexOf(prevWidget.containerWidget);\n                                    if (prevIndex + 1 >= tableWidgets.length) {\n                                        //Creates new table widget for splitted rows.\n                                        this.addTableWidget(viewer.clientActiveArea, tableWidgets, true);\n                                    }\n                                }\n                                else {\n                                    //Creates new table widget for splitted rows.\n                                    this.addTableWidget(viewer.clientActiveArea, tableWidgets, true);\n                                }\n                            }\n                            else {\n                                //Creates new table widget for splitted rows.\n                                this.addTableWidget(viewer.clientActiveArea, tableWidgets, true);\n                            }\n                        }\n                        moveRowToNextTable = true;\n                        count--;\n                    }\n                    tableWidget = tableWidgets[tableWidgets.length - 1];\n                    var prevBodyWidget = undefined;\n                    if (tableWidgets.length > 1) {\n                        //Get Previous Splitted Widget container\n                        prevBodyWidget = tableWidgets[tableWidgets.length - 2].containerWidget;\n                    }\n                    else {\n                        var previousBlock = row.ownerTable.previousRenderedWidget;\n                        prevBodyWidget = previousBlock.containerWidget;\n                    }\n                    var pageIndex = 0;\n                    if (!isNullOrUndefined(prevBodyWidget)) {\n                        pageIndex = viewer.pages.indexOf(prevBodyWidget.page);\n                    }\n                    var index = row.ownerTable.containerWidget.index;\n                    var bodyWidget = void 0;\n                    var block = void 0;\n                    if (moveRowToNextTable && tableWidgets.length === 1) {\n                        block = tableWidgets[tableWidgets.length - 1];\n                    }\n                    else {\n                        block = tableWidgets[tableWidgets.length - 2];\n                    }\n                    bodyWidget = this.moveBlocksToNextPage(block);\n                    var curretTable = tableWidgets[tableWidgets.length - 1];\n                    //Move Next RowWidge to next page\n                    if (moveRowToNextTable) {\n                        // tslint:disable-next-line:max-line-length\n                        if (row.index === 0 && curretTable.containerWidget && curretTable.containerWidget.childWidgets.indexOf(curretTable) !== -1) {\n                            curretTable.containerWidget.childWidgets.splice(curretTable.containerWidget.childWidgets.indexOf(curretTable), 1);\n                        }\n                    }\n                    if (bodyWidget.childWidgets.indexOf(curretTable) !== -1) {\n                        bodyWidget.childWidgets.splice(bodyWidget.childWidgets.indexOf(curretTable), 1);\n                    }\n                    bodyWidget.childWidgets.unshift(curretTable);\n                    curretTable.containerWidget = bodyWidget;\n                    if (moveRowToNextTable && row.index > 0 || rowWidgets.length > 1) {\n                        this.moveNextWidgetsToTable(tableWidgets, rowWidgets, !moveRowToNextTable);\n                    }\n                    moveRowToNextTable = false;\n                    if (row.ownerTable.header && tableRowWidget.height < viewer.clientArea.bottom) {\n                        // if (viewer instanceof PageLayoutViewer) {\n                        viewer.currentRenderingPage.repeatHeaderRowTableWidget = true;\n                        // }\n                        //Updates table widgets location.\n                        viewer.updateClientAreaForBlock(row.ownerTable, true, tableWidgets);\n                        // tslint:disable-next-line:max-line-length\n                        //Update splitted row widget location. if header is repeated update the y position of splitted widget to header height.\n                        splittedWidget.x = splittedWidget.x;\n                        splittedWidget.y = tableWidget.y + row.ownerTable.headerHeight;\n                        // let cellspace: number = viewer instanceof PageLayoutViewer ? cellspacing / 2 : cellspacing;\n                        var cellspace = cellSpacing / 2;\n                        this.updateChildLocationForRow(tableWidget.y + row.ownerTable.headerHeight - cellspace, splittedWidget);\n                    }\n                    else {\n                        //Updates table widgets location.\n                        viewer.updateClientAreaForBlock(row.ownerTable, true, tableWidgets);\n                        // tslint:disable-next-line:max-line-length\n                        //Update splitted row widget location. if header is repeated update the y position of splitted widget to header height.\n                        splittedWidget.x = splittedWidget.x;\n                        splittedWidget.y = tableWidget.y;\n                        // let cellspace: number = viewer instanceof PageLayoutViewer ? cellspacing / 2 : cellspacing;\n                        var cellspace = cellSpacing / 2;\n                        this.updateChildLocationForRow(tableWidget.y - cellspace, splittedWidget);\n                    }\n                }\n                isLastRow = false;\n            }\n            if (isHeader && row.ownerTable.continueHeader) {\n                row.ownerTable.header = true;\n                row.ownerTable.headerHeight = rowHeight + row.ownerTable.headerHeight;\n            }\n            if (isHeader && !isNullOrUndefined(this.getHeader(row.ownerTable)) && row.index === this.getHeader(row.ownerTable).index) {\n                var headerHeight = this.getHeaderHeight(row.ownerTable, row, rowWidgets);\n                if (headerHeight > row.ownerTable.headerHeight || headerHeight > row.ownerTable.headerHeight) {\n                    row.ownerTable.headerHeight = headerHeight;\n                }\n                if (row.ownerTable.headerHeight > viewer.clientArea.height) {\n                    row.ownerTable.header = false;\n                    row.ownerTable.continueHeader = false;\n                    row.ownerTable.headerHeight = 0;\n                    var pages = viewer.pages;\n                    for (var i = 0; i < pages.length; i++) {\n                        if (pages[i].repeatHeaderRowTableWidget) {\n                            pages[i].repeatHeaderRowTableWidget = false;\n                        }\n                    }\n                }\n            }\n            if (tableWidgets.length > 2 && row.ownerTable.header && tableRowWidget.height < viewer.clientActiveArea.bottom &&\n                !viewer.currentRenderingPage.repeatHeaderRowTableWidget) {\n                viewer.currentRenderingPage.repeatHeaderRowTableWidget = true;\n            }\n        }\n    };\n    /* tslint:enable */\n    /**\n     * Gets header.\n     * @param table\n     * @private\n     */\n    Layout.prototype.getHeader = function (table) {\n        var header = undefined;\n        var flag = true;\n        table = table.getSplitWidgets()[0];\n        for (var i = 0; i < table.childWidgets.length; i++) {\n            var row = table.childWidgets[i];\n            if (row.rowFormat.isHeader) {\n                header = row;\n            }\n            else {\n                flag = false;\n            }\n            if (!flag) {\n                break;\n            }\n        }\n        return header;\n    };\n    /**\n     * Gets header height.\n     * @param ownerTable\n     * @param row\n     */\n    Layout.prototype.getHeaderHeight = function (ownerTable, row, rowCollection) {\n        var height = 0;\n        if (row.ownerTable.childWidgets.length > 0 && ownerTable.childWidgets[0].rowFormat.isHeader) {\n            for (var i = 0; i < ownerTable.childWidgets.length; i++) {\n                var row_1 = ownerTable.childWidgets[i];\n                if (row_1.rowFormat.isHeader) {\n                    height = height + this.getRowHeight(row_1, rowCollection);\n                }\n                else {\n                    break;\n                }\n            }\n        }\n        return height;\n    };\n    /**\n     * Updates widgets to row.\n     * @param cell\n     */\n    Layout.prototype.updateWidgetToRow = function (cell) {\n        var viewer = this.viewer;\n        //Adds table cell widget to owner row widget.\n        var rowWidget = cell.ownerRow;\n        var cellLeft = rowWidget.x;\n        if (rowWidget.childWidgets.length > 0) {\n            var lastWidget = rowWidget.childWidgets[rowWidget.childWidgets.length - 1];\n            cellLeft = lastWidget.x + lastWidget.width + lastWidget.margin.right;\n        }\n        // rowWidget.childWidgets.push(cell);\n        cell.containerWidget = rowWidget;\n        //If the row height is set as Atleast then height is set to atleast height for the first cell of the row.\n        // tslint:disable-next-line:max-line-length\n        if (!isNullOrUndefined(cell.ownerRow) && cell.ownerRow.rowFormat.heightType !== 'Exactly' && HelperMethods.convertPointToPixel(cell.ownerRow.rowFormat.height) > 0 && cell.cellIndex === 0) {\n            rowWidget.height = rowWidget.height + HelperMethods.convertPointToPixel(cell.ownerRow.rowFormat.height);\n        }\n        //Add condition not cell merged vertically.\n        if (cell.cellFormat.rowSpan === 1) {\n            var cellHeight = cell.height + cell.margin.top + cell.margin.bottom;\n            if (rowWidget.height - HelperMethods.convertPointToPixel(cell.ownerTable.tableFormat.cellSpacing) < cellHeight) {\n                rowWidget.height = cellHeight + HelperMethods.convertPointToPixel(cell.ownerTable.tableFormat.cellSpacing);\n            }\n        }\n    };\n    /**\n     * Updates height for row widget.\n     * @param viewer\n     * @param isUpdateVerticalPosition\n     * @param rowWidget\n     */\n    // tslint:disable-next-line:max-line-length\n    Layout.prototype.updateHeightForRowWidget = function (viewer, isUpdateVerticalPosition, tableCollection, rowCollection, rowWidget, isLayouted, endRowWidget) {\n        for (var i = 0; i < rowWidget.childWidgets.length; i++) {\n            var cellspacing = 0;\n            var cellWidget = undefined;\n            var childWidget = rowWidget.childWidgets[i];\n            // if (childWidget instanceof TableCellWidget) {\n            cellWidget = childWidget;\n            // }\n            var rowSpan = 1;\n            rowSpan = cellWidget.cellFormat.rowSpan;\n            cellspacing = HelperMethods.convertPointToPixel(cellWidget.ownerTable.tableFormat.cellSpacing);\n            if (rowSpan > 1) {\n                var currentRowWidgetIndex = rowWidget.containerWidget.childWidgets.indexOf(rowWidget);\n                // tslint:disable-next-line:max-line-length\n                var rowSpanWidgetEndIndex = currentRowWidgetIndex + rowSpan - 1 - (rowWidget.index - cellWidget.rowIndex);\n                if (viewer.clientArea.bottom < cellWidget.y + cellWidget.height + cellWidget.margin.bottom\n                    || rowSpanWidgetEndIndex >= currentRowWidgetIndex + 1) {\n                    this.splitSpannedCellWidget(cellWidget, tableCollection, rowCollection, viewer);\n                }\n                var spanEndRowWidget = rowWidget;\n                if (rowSpanWidgetEndIndex > 0) {\n                    if (rowSpanWidgetEndIndex < rowWidget.containerWidget.childWidgets.length) {\n                        var childWidget_1 = rowWidget.containerWidget.childWidgets[rowSpanWidgetEndIndex];\n                        if (childWidget_1 instanceof TableRowWidget) {\n                            spanEndRowWidget = childWidget_1;\n                            if (spanEndRowWidget === endRowWidget) {\n                                spanEndRowWidget = rowWidget;\n                            }\n                        }\n                    }\n                    else {\n                        // tslint:disable-next-line:max-line-length\n                        spanEndRowWidget = rowWidget.containerWidget.childWidgets[rowWidget.containerWidget.childWidgets.length - 1];\n                    }\n                }\n                if (cellWidget.y + cellWidget.height + cellWidget.margin.bottom < spanEndRowWidget.y + spanEndRowWidget.height) {\n                    cellWidget.height = spanEndRowWidget.y + spanEndRowWidget.height - cellWidget.y - cellWidget.margin.bottom;\n                    // tslint:disable-next-line:max-line-length\n                }\n                else if (isLayouted && spanEndRowWidget && (spanEndRowWidget.y !== 0 && spanEndRowWidget.height !== 0) && cellWidget.y + cellWidget.height + cellWidget.margin.bottom > spanEndRowWidget.y + spanEndRowWidget.height) {\n                    spanEndRowWidget.height = cellWidget.y + cellWidget.height + cellWidget.margin.bottom - spanEndRowWidget.y;\n                    // tslint:disable-next-line:max-line-length\n                    //Update the next rowlayout widget location. Reason for the updation is previous row height is updated when cell height is greater. So already layouted next row location has to be updated again.\n                    // if (rowWidget === spanEndRowWidget && rowWidget.nextWidget instanceof TableRowWidget) {\n                    //     let nextRow: TableRowWidget = rowWidget.nextWidget as TableRowWidget;\n                    //     // Need to update on this further\n                    //     // if (viewer.renderedElements.containsKey(nextRow)) {\n                    //     //     let nextWidget: TableRowWidget[] = viewer.renderedElements.get(nextRow) as TableRowWidget[];\n                    //     //     if (nextWidget.length > 0) {\n                    //     //         nextWidget[0].x = nextWidget[0].x;\n                    //     //         nextWidget[0].y = rowWidget.y + rowWidget.height;\n                    //     //     }\n                    //     // }\n                    // }\n                }\n            }\n            else {\n                if (cellspacing > 0) {\n                    // In the Case of tableWidget is greater than one and rowWidget is start at the Top Position of the page. \n                    // In such case we have update the cell height with half of cell spacing.\n                    // Remaining cases we have to update the entire hight\n                    // tslint:disable-next-line:max-line-length\n                    if (tableCollection.length > 1 && rowWidget.y === viewer.clientArea.y && viewer instanceof PageLayoutViewer) {\n                        cellspacing = cellspacing / 2;\n                    }\n                }\n                cellWidget.height = rowWidget.height - cellWidget.margin.top - cellWidget.margin.bottom - cellspacing;\n            }\n            this.updateHeightForCellWidget(viewer, tableCollection, rowCollection, cellWidget);\n            var widget = rowWidget.containerWidget;\n            while (widget.containerWidget instanceof Widget) {\n                widget = widget.containerWidget;\n            }\n            var page = undefined;\n            if (widget instanceof BodyWidget) {\n                page = widget.page;\n            }\n            // tslint:disable-next-line:max-line-length\n            if ((viewer instanceof PageLayoutViewer && viewer.visiblePages.indexOf(page) !== -1) || isUpdateVerticalPosition) {\n                this.updateCellVerticalPosition(cellWidget, false, false);\n            }\n            //Renders the current table row contents, after relayout based on editing.\n            // if (viewer instanceof PageLayoutViewer && (viewer as PageLayoutViewer).visiblePages.indexOf(page) !== -1) {\n            //     //Added proper undefined condition check for Asynchronous operation.\n            //     if (!isNullOrUndefined(rowWidget.tableRow) && !isNullOrUndefined(rowWidget.tableRow.rowFormat)) {\n            //         this.viewer.updateScrollBars();\n            //         //this.render.renderTableCellWidget(page, cellWidget);\n            //     }\n            // }\n        }\n    };\n    /**\n     * Updates height for cell widget.\n     * @param viewer\n     * @param cellWidget\n     */\n    // tslint:disable-next-line:max-line-length\n    Layout.prototype.updateHeightForCellWidget = function (viewer, tableWidget, rowCollection, cellWidget) {\n        for (var i = 0; i < cellWidget.childWidgets.length; i++) {\n            if (cellWidget.childWidgets[i] instanceof TableWidget) {\n                this.updateHeightForTableWidget(tableWidget, rowCollection, cellWidget.childWidgets[i]);\n            }\n        }\n    };\n    /**\n     * Gets row height.\n     * @param row\n     * @private\n     */\n    Layout.prototype.getRowHeight = function (row, rowCollection) {\n        var height = 0;\n        if (row.rowFormat.heightType === 'Exactly') {\n            height = row.rowFormat.height;\n        }\n        else {\n            for (var i = 0; i < rowCollection.length; i++) {\n                if (rowCollection[i] instanceof TableRowWidget) {\n                    height = rowCollection[i].height + height;\n                }\n            }\n            height = Math.max(height, row.rowFormat.height);\n        }\n        return height;\n    };\n    /**\n     * splits spanned cell widget.\n     * @param cellWidget\n     * @param viewer\n     */\n    // tslint:disable-next-line:max-line-length\n    Layout.prototype.splitSpannedCellWidget = function (cellWidget, tableCollection, rowCollection, viewer) {\n        var splittedCell = this.getSplittedWidget(viewer.clientArea.bottom, false, tableCollection, rowCollection, cellWidget);\n        if (!isNullOrUndefined(splittedCell)) {\n            //Adds the splitted contents of a vertical merged cell, in order preserve in next page.\n            viewer.splittedCellWidgets.push(splittedCell);\n        }\n    };\n    /**\n     * Inserts splitted cell widgets.\n     * @param viewer\n     * @param rowWidget\n     */\n    // tslint:disable-next-line:max-line-length\n    Layout.prototype.insertSplittedCellWidgets = function (viewer, tableCollection, rowWidget, previousRowIndex) {\n        var left = rowWidget.x;\n        var tableWidth = 0;\n        tableWidth = HelperMethods.convertPointToPixel(rowWidget.ownerTable.tableHolder.tableWidth);\n        for (var i = 0; i < rowWidget.childWidgets.length; i++) {\n            var cellWidget = rowWidget.childWidgets[i];\n            if (Math.round(left) < Math.round(cellWidget.x - cellWidget.margin.left)) {\n                if (this.insertRowSpannedWidget(rowWidget, viewer, left, i)) {\n                    i--;\n                    continue;\n                }\n                var length_1 = rowWidget.childWidgets.length;\n                this.insertEmptySplittedCellWidget(rowWidget, tableCollection, left, i, previousRowIndex);\n                if (length_1 < rowWidget.childWidgets.length) {\n                    i--;\n                    continue;\n                }\n            }\n            left += cellWidget.margin.left + cellWidget.width + cellWidget.margin.right;\n            if (i === rowWidget.childWidgets.length - 1 && Math.round(left) < Math.round(rowWidget.x + tableWidth)) {\n                if (this.insertRowSpannedWidget(rowWidget, viewer, left, i + 1)) {\n                    continue;\n                }\n                this.insertEmptySplittedCellWidget(rowWidget, tableCollection, left, i + 1, previousRowIndex);\n                continue;\n            }\n        }\n        // tslint:disable-next-line:max-line-length\n        // Special case: when the child widgets of row is equal to 0 then the splitted widgets in the viewer is added in the table row widgets. \n        if ((isNullOrUndefined(rowWidget.childWidgets) || rowWidget.childWidgets.length === 0) && viewer.splittedCellWidgets.length > 0) {\n            for (var j = 0; j < viewer.splittedCellWidgets.length; j++) {\n                var widget = viewer.splittedCellWidgets[j];\n                if (Math.round(left) <= Math.round(widget.x - widget.margin.left)) {\n                    if (this.insertRowSpannedWidget(rowWidget, viewer, left, j)) {\n                        j--;\n                        continue;\n                    }\n                    var count = rowWidget.childWidgets.length;\n                    this.insertEmptySplittedCellWidget(rowWidget, tableCollection, left, j, previousRowIndex);\n                    if (count < rowWidget.childWidgets.length) {\n                        j--;\n                        continue;\n                    }\n                }\n                left += widget.margin.left + widget.width + widget.margin.right;\n                if (j === rowWidget.childWidgets.length - 1 && Math.round(left) <\n                    Math.round(rowWidget.x + tableWidth)) {\n                    if (this.insertRowSpannedWidget(rowWidget, viewer, left, j + 1)) {\n                        continue;\n                    }\n                    this.insertEmptySplittedCellWidget(rowWidget, tableCollection, left, j + 1, previousRowIndex);\n                    continue;\n                }\n            }\n        }\n        if (viewer.splittedCellWidgets.length > 0) {\n            viewer.splittedCellWidgets = [];\n        }\n    };\n    /**\n     * Inserts spanned row widget.\n     * @param rowWidget\n     * @param viewer\n     * @param left\n     * @param index\n     */\n    Layout.prototype.insertRowSpannedWidget = function (rowWidget, viewer, left, index) {\n        var cellSpacing = 0;\n        if (rowWidget.ownerTable.tableFormat.cellSpacing > 0) {\n            cellSpacing = HelperMethods.convertPointToPixel(rowWidget.ownerTable.tableFormat.cellSpacing);\n        }\n        for (var i = 0; i < viewer.splittedCellWidgets.length; i++) {\n            var splittedCell = viewer.splittedCellWidgets[i];\n            if (Math.round(left) === Math.round(splittedCell.x - splittedCell.margin.left)) {\n                rowWidget.childWidgets.splice(index, 0, splittedCell);\n                splittedCell.containerWidget = rowWidget;\n                //If the splitted cell location differs from expected location update the location of row child widgets.\n                if (splittedCell.y !== rowWidget.y + splittedCell.margin.top + cellSpacing) {\n                    this.updateChildLocationForRow(rowWidget.y, rowWidget);\n                }\n                viewer.splittedCellWidgets = [];\n                return true;\n            }\n        }\n        return false;\n    };\n    /**\n     * Inserts empty splitted cell widgets.\n     * @param rowWidget\n     * @param left\n     * @param index\n     */\n    // tslint:disable-next-line:max-line-length\n    Layout.prototype.insertEmptySplittedCellWidget = function (currentRow, tableCollection, left, index, previousRowIndex) {\n        var tableWidget = tableCollection[tableCollection.length - 1];\n        for (var i = previousRowIndex; i >= 0; i--) {\n            var rowWidget = tableWidget.childWidgets[i];\n            var previousLeft = rowWidget.x;\n            for (var j = 0; j < rowWidget.childWidgets.length; j++) {\n                var rowSpan = 1;\n                var cellWidget = rowWidget.childWidgets[j];\n                if (Math.round(left) === Math.round(previousLeft)) {\n                    rowSpan = (isNullOrUndefined(cellWidget) || isNullOrUndefined(cellWidget.cellFormat)) ? rowSpan :\n                        cellWidget.cellFormat.rowSpan;\n                    if (rowSpan > 1) {\n                        var emptyCellWidget = this.createCellWidget(cellWidget);\n                        currentRow.childWidgets.splice(index, 0, emptyCellWidget);\n                        emptyCellWidget.containerWidget = currentRow;\n                    }\n                    return;\n                }\n                previousLeft += cellWidget.margin.left + cellWidget.width + cellWidget.margin.right;\n            }\n        }\n    };\n    /**\n     * Gets spllited widget.\n     * @param bottom\n     * @param splitMinimalWidget\n     * @param cellWidget\n     */\n    // tslint:disable-next-line:max-line-length\n    Layout.prototype.getSplittedWidget = function (bottom, splitMinimalWidget, tableCollection, rowCollection, cellWidget) {\n        var splittedWidget = undefined;\n        if (cellWidget.y + cellWidget.height > bottom - cellWidget.margin.bottom) {\n            for (var i = 0; i < cellWidget.childWidgets.length; i++) {\n                if (cellWidget.childWidgets[i] instanceof ParagraphWidget) {\n                    var paragraphWidget = cellWidget.childWidgets[i];\n                    var splittedPara = this.getSplittedWidgetForPara(bottom - cellWidget.margin.bottom, paragraphWidget);\n                    if (!isNullOrUndefined(splittedPara)) {\n                        if (i === 0 && splittedPara === paragraphWidget) {\n                            //Returns if the whole content of the cell does not fit in current page.\n                            return cellWidget;\n                        }\n                        if (cellWidget.childWidgets.indexOf(splittedPara) !== -1) {\n                            cellWidget.childWidgets.splice(cellWidget.childWidgets.indexOf(splittedPara), 1);\n                            i--;\n                        }\n                        cellWidget.height -= splittedPara.height;\n                        if (isNullOrUndefined(splittedWidget)) {\n                            //Creates new widget, to hold the splitted contents.\n                            splittedWidget = this.createCellWidget(cellWidget);\n                        }\n                        splittedWidget.height += splittedPara.height;\n                        splittedWidget.childWidgets.push(splittedPara);\n                        splittedPara.containerWidget = splittedWidget;\n                    }\n                }\n                else {\n                    var tableWidget = cellWidget.childWidgets[i];\n                    var tableCol = [tableWidget];\n                    //Check for nested table.\n                    if (bottom - cellWidget.margin.bottom < tableWidget.y + tableWidget.height) {\n                        var tableHeight = tableWidget.height;\n                        // tslint:disable-next-line:max-line-length\n                        var splittedTable = this.getSplittedWidgetForTable(bottom - cellWidget.margin.bottom, tableCol, tableWidget);\n                        if (!isNullOrUndefined(splittedTable)) {\n                            if (i === 0 && splittedTable === tableWidget) {\n                                //Returns if the whole table does not fit in current page.\n                                return cellWidget;\n                            }\n                            if (cellWidget.childWidgets.indexOf(splittedTable) !== -1) {\n                                cellWidget.childWidgets.splice(cellWidget.childWidgets.indexOf(splittedTable), 1);\n                                i--;\n                                cellWidget.height -= splittedTable.height;\n                            }\n                            else {\n                                cellWidget.height -= tableHeight - tableWidget.height;\n                            }\n                            if (isNullOrUndefined(splittedWidget)) {\n                                //Creates new widget, to hold the splitted contents.\n                                splittedWidget = this.createCellWidget(cellWidget);\n                            }\n                            splittedWidget.height += splittedTable.height;\n                            splittedWidget.childWidgets.push(splittedTable);\n                            splittedTable.containerWidget = splittedWidget;\n                        }\n                    }\n                }\n            }\n        }\n        if (isNullOrUndefined(splittedWidget) && splitMinimalWidget) {\n            //Creates new widget, to hold the splitted contents.\n            splittedWidget = this.createCellWidget(cellWidget);\n        }\n        return splittedWidget;\n    };\n    /**\n     * Gets list level pattern\n     * @param value\n     * @private\n     */\n    Layout.prototype.getListLevelPattern = function (value) {\n        switch (value) {\n            case 0:\n                return 'Arabic';\n            case 1:\n                return 'UpRoman';\n            case 2:\n                return 'LowRoman';\n            case 3:\n                return 'UpLetter';\n            case 4:\n                return 'LowLetter';\n            case 5:\n                return 'Ordinal';\n            case 6:\n                return 'Number';\n            case 7:\n                return 'OrdinalText';\n            case 8:\n                return 'LeadingZero';\n            case 9:\n                return 'Bullet';\n            case 10:\n                return 'FarEast';\n            case 11:\n                return 'Special';\n            default:\n                return 'None';\n        }\n    };\n    /**\n     * Creates cell widget.\n     * @param cell\n     */\n    Layout.prototype.createCellWidget = function (cell) {\n        var cellWidget = new TableCellWidget();\n        cellWidget.cellFormat = cell.cellFormat;\n        cellWidget.index = cell.index;\n        cellWidget.rowIndex = cell.rowIndex;\n        cellWidget.columnIndex = cell.columnIndex;\n        cellWidget.containerWidget = cell.containerWidget;\n        this.updateWidgetLocation(cell, cellWidget);\n        cellWidget.margin = cell.margin;\n        cellWidget.leftBorderWidth = HelperMethods.convertPointToPixel(cell.leftBorderWidth);\n        cellWidget.rightBorderWidth = HelperMethods.convertPointToPixel(cell.rightBorderWidth);\n        return cellWidget;\n    };\n    /**\n     * Create Table Widget\n     */\n    Layout.prototype.createTableWidget = function (table) {\n        var newTable = new TableWidget();\n        if (table.header) {\n            newTable.header = table.header;\n            newTable.headerHeight = table.headerHeight;\n        }\n        newTable.index = table.index;\n        newTable.tableFormat = table.tableFormat;\n        newTable.tableHolder = table.tableHolder;\n        newTable.isGridUpdated = table.isGridUpdated;\n        return newTable;\n    };\n    /**\n     * Gets splitted widget for paragraph.\n     * @param bottom\n     * @param paragraphWidget\n     */\n    Layout.prototype.getSplittedWidgetForPara = function (bottom, paragraphWidget) {\n        var lineBottom = paragraphWidget.y;\n        var splittedWidget = undefined;\n        for (var i = 0; i < paragraphWidget.childWidgets.length; i++) {\n            var lineWidget = paragraphWidget.childWidgets[i];\n            if (bottom < lineBottom + lineWidget.height) {\n                if (i === 0) {\n                    if (lineWidget.paragraph.containerWidget instanceof TableCellWidget) {\n                        //checks first line of the page is exceed the page height\n                        if (lineWidget.paragraph.containerWidget.y === paragraphWidget.y) {\n                            lineBottom += lineWidget.height;\n                            continue;\n                        }\n                    }\n                    splittedWidget = paragraphWidget;\n                    break;\n                }\n                if (paragraphWidget.childWidgets.indexOf(lineWidget) !== -1) {\n                    paragraphWidget.childWidgets.splice(paragraphWidget.childWidgets.indexOf(lineWidget), 1);\n                    i--;\n                }\n                paragraphWidget.height -= lineWidget.height;\n                if (isNullOrUndefined(splittedWidget)) {\n                    //Creates new widget, to hold the splitted contents.\n                    splittedWidget = new ParagraphWidget();\n                    splittedWidget.characterFormat = paragraphWidget.characterFormat;\n                    splittedWidget.paragraphFormat = paragraphWidget.paragraphFormat;\n                    splittedWidget.index = paragraphWidget.index;\n                    this.updateWidgetLocation(paragraphWidget, splittedWidget);\n                    splittedWidget.height = lineWidget.height;\n                }\n                else {\n                    splittedWidget.height += lineWidget.height;\n                }\n                splittedWidget.childWidgets.push(lineWidget);\n                lineWidget.paragraph = splittedWidget;\n            }\n            lineBottom += lineWidget.height;\n        }\n        return splittedWidget;\n    };\n    /**\n     * Gets splitted table widget.\n     * @param bottom\n     * @param tableWidget\n     * @private\n     */\n    // tslint:disable-next-line:max-line-length\n    Layout.prototype.getSplittedWidgetForTable = function (bottom, tableCollection, tableWidget) {\n        var rowBottom = tableWidget.y;\n        var splittedWidget = undefined;\n        for (var i = 0; i < tableWidget.childWidgets.length; i++) {\n            var rowWidget = undefined;\n            var childWidget = tableWidget.childWidgets[i];\n            // if (childWidget instanceof TableRowWidget) {\n            rowWidget = childWidget;\n            // }\n            var rowHeight = rowWidget.height;\n            if (bottom < rowBottom + rowHeight || !isNullOrUndefined(splittedWidget)) {\n                //ToDo: Check whether row included in vertical merge or AllowRowSplitbyPage is true, if so split row.\n                //Checks if atleast first line fits in the client area.                \n                var splittedRow = undefined;\n                var allowRowBreakAcrossPages = true;\n                if (!isNullOrUndefined(rowWidget) && !isNullOrUndefined(rowWidget.rowFormat)) {\n                    allowRowBreakAcrossPages = rowWidget.rowFormat.allowBreakAcrossPages;\n                }\n                if (allowRowBreakAcrossPages) {\n                    // tslint:disable-next-line:max-line-length\n                    splittedRow = (isNullOrUndefined(splittedWidget) && this.isFirstLineFitForRow(bottom, rowWidget)) ? this.getSplittedWidgetForRow(bottom, tableCollection, [rowWidget], rowWidget) : rowWidget;\n                }\n                if (!isNullOrUndefined(splittedRow)) {\n                    if (i === 0 && splittedRow === rowWidget) {\n                        //Returns if the whole table does not fit in current page.\n                        return tableWidget;\n                    }\n                    if (tableWidget.childWidgets.indexOf(splittedRow) !== -1) {\n                        tableWidget.childWidgets.splice(tableWidget.childWidgets.indexOf(splittedRow), 1);\n                        i--;\n                        tableWidget.height -= splittedRow.height;\n                    }\n                    else {\n                        tableWidget.height -= rowHeight - rowWidget.height;\n                    }\n                    if (isNullOrUndefined(splittedWidget)) {\n                        //Creates new widget, to hold the splitted contents.\n                        splittedWidget = this.createTableWidget(tableWidget);\n                        this.updateWidgetLocation(tableWidget, splittedWidget);\n                        splittedWidget.height = splittedRow.height;\n                    }\n                    else {\n                        splittedWidget.height += splittedRow.height;\n                    }\n                    splittedWidget.childWidgets.push(splittedRow);\n                    splittedRow.containerWidget = splittedWidget;\n                }\n            }\n            rowBottom += rowWidget.height;\n        }\n        return splittedWidget;\n    };\n    /**\n     * Checks whether first line fits for paragraph or not.\n     * @param bottom\n     * @param paraWidget\n     */\n    Layout.prototype.isFirstLineFitForPara = function (bottom, paraWidget) {\n        var lineWidget = paraWidget.childWidgets[0];\n        var cellwidget = lineWidget.paragraph.containerWidget;\n        // let document: WordDocument = undefined;\n        // if (!isNullOrUndefined(lineWidget.paragraph.currentNode) && !isNullOrUndefined(cellwidget.containerWidget)) {\n        //     document = WordDocument.getDocumentOf(lineWidget.paragraph.currentNode);\n        // }\n        //checks first line of the page is exceed the page height\n        if (this.viewer.isFirstLineFitInShiftWidgets) {\n            if (this.viewer.clientActiveArea.y === this.viewer.clientArea.y && paraWidget.y + lineWidget.height >= bottom) {\n                return true;\n            }\n        }\n        else {\n            // For nested tables,\n            if (cellwidget.ownerTable.isInsideTable) {\n                // Gets the container cell widgets, consider it as client area for the cell widget.\n                var containerCellWidget = undefined;\n                if (cellwidget.containerWidget instanceof TableRowWidget &&\n                    cellwidget.containerWidget.containerWidget instanceof TableWidget\n                    && cellwidget.containerWidget.containerWidget.containerWidget instanceof TableCellWidget) {\n                    containerCellWidget = cellwidget.containerWidget.containerWidget.containerWidget;\n                }\n                if (!isNullOrUndefined(containerCellWidget) && cellwidget.containerWidget.y === containerCellWidget.y\n                    && paraWidget.y + lineWidget.height >= bottom) {\n                    return true;\n                }\n            }\n            else if (cellwidget.containerWidget.y === this.viewer.clientArea.y && paraWidget.y + lineWidget.height >= bottom) {\n                return true;\n            }\n        }\n        return (paraWidget.y + lineWidget.height <= bottom);\n    };\n    /**\n     * Checks whether first line fits for table or not.\n     * @param bottom\n     * @param tableWidget\n     * @private\n     */\n    Layout.prototype.isFirstLineFitForTable = function (bottom, tableWidget) {\n        var rowWidget = undefined;\n        var isFit = false;\n        var childWidget = tableWidget.childWidgets[0];\n        // if (childWidget instanceof TableRowWidget) {\n        rowWidget = childWidget;\n        // }\n        if (!isNullOrUndefined(rowWidget)) {\n            isFit = this.isFirstLineFitForRow(bottom, rowWidget);\n        }\n        return isFit;\n    };\n    /**\n     * Checks whether first line fits for row or not.\n     * @param bottom\n     * @param rowWidget\n     */\n    Layout.prototype.isFirstLineFitForRow = function (bottom, rowWidget) {\n        for (var i = 0; i < rowWidget.childWidgets.length; i++) {\n            var cellWidget = rowWidget.childWidgets[i];\n            if (!this.isFirstLineFitForCell(bottom, cellWidget)) {\n                return false;\n            }\n        }\n        return true;\n    };\n    /**\n     * Checks whether first line fits for cell or not.\n     * @param bottom\n     * @param cellWidget\n     */\n    Layout.prototype.isFirstLineFitForCell = function (bottom, cellWidget) {\n        if (cellWidget.childWidgets.length === 0) {\n            return true;\n        }\n        if (cellWidget.childWidgets[0] instanceof ParagraphWidget) {\n            var paraWidget = cellWidget.childWidgets[0];\n            return this.isFirstLineFitForPara(bottom - cellWidget.margin.bottom, paraWidget);\n        }\n        else {\n            var tableWidget = cellWidget.childWidgets[0];\n            return this.isFirstLineFitForTable(bottom - cellWidget.margin.bottom, tableWidget);\n        }\n    };\n    /**\n     * Updates widget location.\n     * @param widget\n     * @param table\n     */\n    Layout.prototype.updateWidgetLocation = function (widget, table) {\n        table.x = widget.x;\n        table.y = widget.y;\n        table.width = widget.width;\n    };\n    /**\n     * Updates child location for table.\n     * @param top\n     * @param tableWidget\n     * @private\n     */\n    Layout.prototype.updateChildLocationForTable = function (top, tableWidget) {\n        for (var i = 0; i < tableWidget.childWidgets.length; i++) {\n            var rowWidget = tableWidget.childWidgets[i];\n            rowWidget.x = rowWidget.x;\n            rowWidget.y = top;\n            this.updateChildLocationForRow(top, rowWidget);\n            top += rowWidget.height;\n        }\n    };\n    /**\n     * Updates child location for row.\n     * @param top\n     * @param rowWidget\n     * @private\n     */\n    Layout.prototype.updateChildLocationForRow = function (top, rowWidget) {\n        var spacing = 0;\n        if (rowWidget.ownerTable.tableFormat.cellSpacing > 0) {\n            spacing = HelperMethods.convertPointToPixel(rowWidget.ownerTable.tableFormat.cellSpacing);\n        }\n        for (var i = 0; i < rowWidget.childWidgets.length; i++) {\n            var cellWidget = rowWidget.childWidgets[i];\n            cellWidget.x = cellWidget.x;\n            cellWidget.y = top + cellWidget.margin.top + spacing;\n            this.updateChildLocationForCell(cellWidget.y, cellWidget);\n        }\n    };\n    /**\n     * Updates child location for cell.\n     * @param top\n     * @param cellWidget\n     */\n    Layout.prototype.updateChildLocationForCell = function (top, cellWidget) {\n        for (var i = 0; i < cellWidget.childWidgets.length; i++) {\n            cellWidget.childWidgets[i].x = cellWidget.childWidgets[i].x;\n            cellWidget.childWidgets[i].y = top;\n            if (cellWidget.childWidgets[i] instanceof TableWidget) {\n                this.updateChildLocationForTable(top, cellWidget.childWidgets[i]);\n            }\n            top += cellWidget.childWidgets[i].height;\n        }\n    };\n    /**\n     * Updates cell vertical position.\n     * @param cellWidget\n     * @param isUpdateToTop\n     * @param isInsideTable\n     * @private\n     */\n    Layout.prototype.updateCellVerticalPosition = function (cellWidget, isUpdateToTop, isInsideTable) {\n        if (cellWidget.ownerTable.containerWidget instanceof BodyWidget || isInsideTable) {\n            var displacement = this.getDisplacement(cellWidget, isUpdateToTop);\n            //Update Y position alone for the child widget of cell\n            this.updateCellContentVerticalPosition(cellWidget, displacement, isUpdateToTop);\n        }\n    };\n    /**\n     * Updates cell content vertical position.\n     * @param cellWidget\n     * @param displacement\n     * @param isUpdateToTop\n     */\n    Layout.prototype.updateCellContentVerticalPosition = function (cellWidget, displacement, isUpdateToTop) {\n        if (displacement === 0) {\n            return;\n        }\n        var location = cellWidget.y + displacement;\n        for (var i = 0; i < cellWidget.childWidgets.length; i++) {\n            if (cellWidget.childWidgets[i] instanceof ParagraphWidget) {\n                cellWidget.childWidgets[i].y = location;\n            }\n            else {\n                location = this.updateTableWidgetLocation(cellWidget.childWidgets[i], location, isUpdateToTop);\n            }\n            location = location + cellWidget.childWidgets[i].height;\n        }\n    };\n    /**\n     * Updates table widget location.\n     * @param tableWidget\n     * @param location\n     * @param isUpdateToTop\n     */\n    Layout.prototype.updateTableWidgetLocation = function (tableWidget, location, isUpdateToTop) {\n        tableWidget.y = location = location + tableWidget.topBorderWidth;\n        var cellSpacing = 0;\n        for (var i = 0; i < tableWidget.childWidgets.length; i++) {\n            var rowWidget = tableWidget.childWidgets[i];\n            rowWidget.y = location;\n            for (var j = 0; j < rowWidget.childWidgets.length; j++) {\n                var cellWidget = rowWidget.childWidgets[j];\n                cellWidget.y = location + cellWidget.margin.top + cellSpacing;\n                this.updateCellVerticalPosition(cellWidget, isUpdateToTop, true);\n            }\n            location = location + rowWidget.height;\n        }\n        return location;\n    };\n    /**\n     * Gets displacement.\n     * @param cellWidget\n     * @param isUpdateToTop\n     */\n    Layout.prototype.getDisplacement = function (cellWidget, isUpdateToTop) {\n        //Gets the height of row\n        var rowHeight = 0;\n        var rowWidget = cellWidget.containerWidget;\n        var padding = cellWidget.margin.top + cellWidget.margin.bottom;\n        if (!isNullOrUndefined(cellWidget.cellFormat) && cellWidget.cellFormat.rowSpan > 1) {\n            rowHeight = cellWidget.height;\n        }\n        else {\n            rowHeight = ((!isNullOrUndefined(rowWidget) ? rowWidget.height : 0) - padding);\n        }\n        //Gets the height of content within the cell\n        var cellContentHeight = this.getCellContentHeight(cellWidget);\n        //Displacement field holds the value which has reduced from rowHeight and cellContentHeight\n        var displacement = 0;\n        if (rowHeight > cellContentHeight) {\n            displacement = rowHeight - cellContentHeight;\n            if (cellWidget.cellFormat.verticalAlignment === 'Center') {\n                displacement = displacement / 2;\n            }\n            else if ((cellWidget.cellFormat.verticalAlignment === 'Top' || isUpdateToTop)) {\n                displacement = 0;\n            }\n        }\n        return displacement;\n    };\n    /**\n     * Gets cell content height.\n     * @param cellWidget\n     */\n    Layout.prototype.getCellContentHeight = function (cellWidget) {\n        if (isNullOrUndefined(cellWidget.childWidgets)) {\n            return 0;\n        }\n        var contentHeight = 0;\n        for (var i = 0; i < cellWidget.childWidgets.length; i++) {\n            if (cellWidget.childWidgets[i] instanceof ParagraphWidget) {\n                contentHeight += cellWidget.childWidgets[i].height;\n            }\n            else {\n                contentHeight += cellWidget.childWidgets[i].height;\n            }\n        }\n        return contentHeight;\n    };\n    /**\n     * Gets table left borders.\n     * @param borders\n     * @private\n     */\n    Layout.prototype.getTableLeftBorder = function (borders) {\n        if (!isNullOrUndefined(borders.left)) {\n            return borders.left;\n        }\n        else {\n            var border = new WBorder(borders);\n            border.lineStyle = 'Single';\n            border.lineWidth = 0.66;\n            return border;\n        }\n    };\n    /**\n     * Gets table right border.\n     * @param borders\n     * @private\n     */\n    Layout.prototype.getTableRightBorder = function (borders) {\n        if (!isNullOrUndefined(borders.right)) {\n            return borders.right;\n        }\n        else {\n            var border = new WBorder(borders);\n            border.lineStyle = 'Single';\n            border.lineWidth = 0.66;\n            return border;\n        }\n    };\n    /**\n     * Get table top border.\n     * @param borders\n     * @private\n     */\n    Layout.prototype.getTableTopBorder = function (borders) {\n        if (!isNullOrUndefined(borders.top)) {\n            return borders.top;\n        }\n        else {\n            var border = new WBorder(borders);\n            border.lineStyle = 'Single';\n            border.lineWidth = 0.66;\n            return border;\n        }\n    };\n    /**\n     * Gets table bottom border.\n     * @param borders\n     * @private\n     */\n    Layout.prototype.getTableBottomBorder = function (borders) {\n        if (!isNullOrUndefined(borders.bottom)) {\n            return borders.bottom;\n        }\n        else {\n            var border = new WBorder(borders);\n            border.lineStyle = 'Single';\n            border.lineWidth = 0.66;\n            return border;\n        }\n    };\n    /**\n     * Get diagonal cell up border.\n     * @param tableCell\n     * @private\n     */\n    Layout.prototype.getCellDiagonalUpBorder = function (tableCell) {\n        var diagonalUpBorder = undefined;\n        var cellBorder = undefined;\n        cellBorder = tableCell.cellFormat.borders;\n        diagonalUpBorder = cellBorder.diagonalUp;\n        return diagonalUpBorder;\n    };\n    /**\n     * Gets diagonal cell down border\n     * @param tableCell\n     * @private\n     */\n    Layout.prototype.getCellDiagonalDownBorder = function (tableCell) {\n        var diagonalDownBorder = undefined;\n        var cellBorder = undefined;\n        cellBorder = tableCell.cellFormat.borders;\n        diagonalDownBorder = cellBorder.diagonalDown;\n        return diagonalDownBorder;\n    };\n    /**\n     * Gets table width.\n     * @param table\n     * @private\n     */\n    Layout.prototype.getTableWidth = function (table) {\n        var width = 0;\n        for (var i = 0; i < table.childWidgets.length; i++) {\n            var row = table.childWidgets[i];\n            var rowWidth = 0;\n            for (var j = 0; j < row.childWidgets.length; j++) {\n                var cell = row.childWidgets[j];\n                rowWidth += HelperMethods.convertPointToPixel(cell.cellFormat.cellWidth);\n            }\n            if (width < rowWidth) {\n                width = rowWidth;\n            }\n        }\n        return width;\n    };\n    //#region shifting\n    /**\n     * @private\n     */\n    Layout.prototype.layoutNextItemsBlock = function (blockAdv, viewer) {\n        var sectionIndex = blockAdv.bodyWidget.sectionIndex;\n        var block = blockAdv;\n        var splittedWidget = block.getSplitWidgets();\n        var nextBlock = splittedWidget[splittedWidget.length - 1].nextRenderedWidget;\n        if (isNullOrUndefined(nextBlock) || this.viewer.blockToShift === block) {\n            this.viewer.blockToShift = undefined;\n        }\n        var updateNextBlockList = true;\n        while (nextBlock instanceof BlockWidget && nextBlock.bodyWidget.sectionIndex === sectionIndex) {\n            var currentWidget = undefined;\n            var blocks = block.getSplitWidgets();\n            currentWidget = blocks[blocks.length - 1];\n            // if (viewer.fieldEndParagraph === block) {\n            //     //Sets field end paragraph to undefined, inorder to hold reLayouting with this paragraph.\n            //     viewer.fieldEndParagraph = undefined;\n            // }\n            block = nextBlock;\n            if (viewer.blockToShift === block) {\n                viewer.blockToShift = undefined;\n            }\n            updateNextBlockList = false;\n            var nextWidget = undefined;\n            nextWidget = block.getSplitWidgets()[0];\n            // tslint:disable-next-line:max-line-length\n            if (viewer.fieldStacks.length === 0 && !isNullOrUndefined(nextWidget) && currentWidget.containerWidget === nextWidget.containerWidget\n                && (HelperMethods.round(nextWidget.y, 2) === HelperMethods.round(currentWidget.y + currentWidget.height, 2))) {\n                if (!isNullOrUndefined(viewer.blockToShift)) {\n                    viewer.blockToShift = block;\n                    break;\n                }\n                if (isNullOrUndefined(nextWidget.nextWidget)) {\n                    break;\n                }\n            }\n            updateNextBlockList = true;\n            if (viewer.owner.isShiftingEnabled && viewer.fieldStacks.length === 0) {\n                viewer.blockToShift = block;\n                break;\n            }\n            else if (isNullOrUndefined(this.viewer.owner.editorModule) || !this.viewer.owner.editorModule.isInsertingTOC) {\n                block = block.combineWidget(this.viewer);\n                var paragraph = void 0;\n                if (currentWidget.containerWidget !== block.containerWidget) {\n                    if (!(currentWidget instanceof ParagraphWidget) ||\n                        (currentWidget instanceof ParagraphWidget) && !currentWidget.isEndsWithPageBreak) {\n                        // tslint:disable-next-line:max-line-length\n                        this.updateContainerWidget(block, currentWidget.containerWidget, currentWidget.indexInOwner + 1, false);\n                    }\n                }\n                if (block instanceof TableWidget) {\n                    this.clearTableWidget(block, true, true);\n                    block.isGridUpdated = false;\n                    paragraph = this.viewer.selection.getFirstParagraphInFirstCell(block);\n                }\n                else {\n                    paragraph = block;\n                }\n                if ((this.viewer.owner.isDocumentLoaded) && this.viewer.owner.editorModule) {\n                    this.viewer.owner.editorModule.updateWholeListItems(paragraph);\n                }\n                viewer.updateClientAreaForBlock(block, true);\n                this.viewer.layout.layoutBlock(block, 0);\n                viewer.updateClientAreaForBlock(block, false);\n            }\n            splittedWidget = nextBlock.getSplitWidgets();\n            nextBlock = splittedWidget[splittedWidget.length - 1].nextRenderedWidget;\n        }\n        if (!viewer.owner.isShiftingEnabled || this.viewer.blockToShift !== block) {\n            this.viewer.owner.editorModule.updateListItemsTillEnd(block, updateNextBlockList);\n        }\n    };\n    /**\n     * @private\n     */\n    Layout.prototype.updateClientAreaForLine = function (paragraph, startLineWidget, elementIndex) {\n        //Clears the line widget starting from current line.\n        var top = this.viewer.selection.getTop(startLineWidget);\n        var left = this.viewer.clientArea.x;\n        this.viewer.cutFromTop(top);\n        this.viewer.cutFromLeft(left);\n    };\n    /**\n     * @private\n     */\n    Layout.prototype.getParentTable = function (block) {\n        var widget = block;\n        while (widget.containerWidget) {\n            if (widget.containerWidget instanceof BlockContainer) {\n                return widget;\n            }\n            widget = widget.containerWidget;\n        }\n        return undefined;\n    };\n    /**\n     * @private\n     */\n    Layout.prototype.reLayoutParagraph = function (paragraphWidget, lineIndex, elementBoxIndex) {\n        if (this.viewer.blockToShift === paragraphWidget) {\n            this.layoutBodyWidgetCollection(paragraphWidget.index, paragraphWidget.containerWidget, paragraphWidget, false);\n        }\n        // let isElementMoved: boolean = elementBoxIndex > 0;\n        if (paragraphWidget.isInsideTable) {\n            this.reLayoutTable(paragraphWidget);\n        }\n        else {\n            this.reLayoutLine(paragraphWidget, lineIndex);\n        }\n        if (paragraphWidget.bodyWidget instanceof HeaderFooterWidget &&\n            paragraphWidget.bodyWidget.headerFooterType.indexOf('Footer') !== -1) {\n            this.shiftFooterChildLocation(paragraphWidget.bodyWidget, this.viewer);\n        }\n    };\n    /**\n     * @private\n     */\n    Layout.prototype.reLayoutTable = function (block) {\n        //Get Top level owner of block\n        var table = this.getParentTable(block);\n        //Combine splitted table in to single table\n        // this.combineTableWidgets(this.viewer, table, undefined);\n        //Get Parent table\n        var currentTable = table.combineWidget(this.viewer);\n        currentTable.isGridUpdated = false;\n        currentTable.buildTableColumns();\n        currentTable.isGridUpdated = true;\n        var bodyWidget = currentTable.containerWidget;\n        if (this.viewer.owner.enableHeaderAndFooter || block.isInHeaderFooter) {\n            bodyWidget.height -= currentTable.height;\n            // tslint:disable-next-line:max-line-length\n            this.viewer.updateHCFClientAreaWithTop(table.bodyWidget.sectionFormat, this.viewer.isBlockInHeader(table), bodyWidget.page);\n        }\n        else {\n            this.viewer.updateClientArea(bodyWidget.sectionFormat, bodyWidget.page);\n        }\n        //Clear Hieght for all the content \n        if (this.viewer.owner.isDocumentLoaded && this.viewer.owner.editorModule) {\n            var block_1 = this.viewer.selection.getFirstParagraphInFirstCell(currentTable);\n            this.viewer.owner.editorModule.updateWholeListItems(block_1);\n        }\n        this.viewer.updateClientAreaForBlock(currentTable, true);\n        //Remove border width\n        currentTable.x -= currentTable.leftBorderWidth;\n        currentTable.y -= currentTable.topBorderWidth;\n        //Update Client area for current position\n        this.viewer.cutFromTop(currentTable.y);\n        this.clearTableWidget(currentTable, true, true);\n        this.layoutBlock(currentTable, 0, true);\n        this.viewer.updateClientAreaForBlock(currentTable, false);\n        this.layoutNextItemsBlock(currentTable, this.viewer);\n    };\n    /**\n     * @private\n     */\n    Layout.prototype.clearTableWidget = function (table, clearPosition, clearHeight) {\n        table.height = 0;\n        if (clearPosition) {\n            table.y = 0;\n            table.x = 0;\n        }\n        for (var i = 0; i < table.childWidgets.length; i++) {\n            var row = table.childWidgets[i];\n            this.clearRowWidget(row, clearPosition, clearHeight);\n        }\n    };\n    /**\n     * @private\n     */\n    Layout.prototype.clearRowWidget = function (row, clearPosition, clearHeight) {\n        row.height = 0;\n        if (clearPosition) {\n            row.y = 0;\n            row.x = 0;\n        }\n        for (var i = 0; i < row.childWidgets.length; i++) {\n            var cell = row.childWidgets[i];\n            this.clearCellWidget(cell, clearPosition, clearHeight);\n        }\n    };\n    /**\n     * @private\n     */\n    Layout.prototype.clearCellWidget = function (cell, clearPosition, clearHeight) {\n        cell.height = 0;\n        if (clearPosition) {\n            cell.y = 0;\n            cell.x = 0;\n        }\n        for (var i = 0; i < cell.childWidgets.length; i++) {\n            var block = cell.childWidgets[i];\n            if (block instanceof ParagraphWidget) {\n                if (clearHeight) {\n                    block.height = 0;\n                }\n            }\n            else {\n                this.clearTableWidget(block, clearPosition, clearHeight);\n            }\n        }\n    };\n    /**\n     * @param blockIndex\n     * @param bodyWidget\n     * @param block\n     * @private\n     */\n    // tslint:disable-next-line:max-line-length\n    Layout.prototype.layoutBodyWidgetCollection = function (blockIndex, bodyWidget, block, shiftNextWidget) {\n        if (!isNullOrUndefined(this.viewer.owner)\n            && this.viewer.owner.isLayoutEnabled) {\n            if (bodyWidget instanceof BlockContainer) {\n                var curretBlock = this.checkAndGetBlock(bodyWidget, blockIndex);\n                if (isNullOrUndefined(curretBlock)) {\n                    return;\n                }\n                if (bodyWidget instanceof HeaderFooterWidget) {\n                    // tslint:disable-next-line:max-line-length\n                    this.viewer.updateHCFClientAreaWithTop(bodyWidget.sectionFormat, bodyWidget.headerFooterType.indexOf('Header') !== -1, bodyWidget.page);\n                    curretBlock.containerWidget.height -= curretBlock.height;\n                }\n                else {\n                    this.viewer.updateClientArea(bodyWidget.sectionFormat, bodyWidget.page);\n                }\n                if (blockIndex > 0) {\n                    var prevWidget = curretBlock.getSplitWidgets()[0].previousRenderedWidget;\n                    if (!(prevWidget instanceof ParagraphWidget) ||\n                        (prevWidget instanceof ParagraphWidget) && !prevWidget.isEndsWithPageBreak) {\n                        this.viewer.cutFromTop(prevWidget.y + prevWidget.height);\n                        if (curretBlock.containerWidget !== prevWidget.containerWidget) {\n                            // tslint:disable-next-line:max-line-length\n                            this.updateContainerWidget(curretBlock, prevWidget.containerWidget, prevWidget.indexInOwner + 1, false);\n                        }\n                    }\n                    else if (prevWidget instanceof ParagraphWidget && prevWidget.isEndsWithPageBreak &&\n                        prevWidget.containerWidget === curretBlock.containerWidget) {\n                        this.moveBlocksToNextPage(prevWidget);\n                    }\n                }\n                var currentParagraph = void 0;\n                curretBlock = curretBlock.combineWidget(this.viewer);\n                if (curretBlock instanceof TableWidget) {\n                    this.clearTableWidget(curretBlock, true, true);\n                    curretBlock.isGridUpdated = false;\n                    currentParagraph = this.viewer.selection.getFirstParagraphInFirstCell(curretBlock);\n                }\n                else {\n                    currentParagraph = curretBlock;\n                }\n                if ((this.viewer.owner.isDocumentLoaded) && this.viewer.owner.editorModule) {\n                    this.viewer.owner.editorModule.updateWholeListItems(currentParagraph);\n                }\n                this.viewer.updateClientAreaForBlock(curretBlock, true);\n                this.viewer.layout.layoutBlock(curretBlock, 0, true);\n                this.viewer.updateClientAreaForBlock(curretBlock, false);\n                if (shiftNextWidget) {\n                    this.shiftNextWidgets(curretBlock);\n                }\n                else {\n                    this.layoutNextItemsBlock(curretBlock, this.viewer);\n                }\n            }\n            else if (bodyWidget instanceof TableCellWidget) {\n                var table = this.viewer.layout.getParentTable(bodyWidget.ownerTable.getSplitWidgets()[0]);\n                this.reLayoutTable(bodyWidget.ownerTable);\n                this.layoutNextItemsBlock(table, this.viewer);\n            }\n        }\n    };\n    Layout.prototype.checkAndGetBlock = function (containerWidget, blockIndex) {\n        var sectionIndex = containerWidget.index;\n        while (containerWidget && containerWidget.index === sectionIndex) {\n            if (containerWidget.childWidgets.length > 0 && containerWidget.firstChild.index <= blockIndex &&\n                containerWidget.lastChild.index >= blockIndex) {\n                for (var i = 0; i < containerWidget.childWidgets.length; i++) {\n                    var block = containerWidget.childWidgets[i];\n                    if (block.index === blockIndex) {\n                        return block;\n                    }\n                }\n            }\n            if (containerWidget instanceof BodyWidget) {\n                containerWidget = containerWidget.nextRenderedWidget;\n            }\n            else {\n                break;\n            }\n        }\n        return undefined;\n    };\n    //#endregion\n    //#region Table\n    /**\n     * Layouts table.\n     * @param table\n     * @private\n     */\n    Layout.prototype.layoutTable = function (table, startIndex) {\n        if (!table.isGridUpdated) {\n            table.buildTableColumns();\n            table.isGridUpdated = true;\n        }\n        var tableView = [table];\n        this.addTableWidget(this.viewer.clientActiveArea, tableView);\n        this.viewer.updateClientAreaTopOrLeft(table, true);\n        var isHeader = table.childWidgets[0].rowFormat.isHeader;\n        if (table.childWidgets.length > 0) {\n            table.header = isHeader;\n            table.continueHeader = isHeader;\n            table.headerHeight = 0;\n        }\n        var row = table.childWidgets[startIndex];\n        while (row) {\n            row = this.layoutRow(tableView, row);\n            row = row.nextRow;\n        }\n        this.updateWidgetsToPage(tableView, [], table);\n        return tableView[tableView.length - 1];\n    };\n    /**\n     * Adds table widget.\n     * @param area\n     * @param table\n     * @private\n     */\n    Layout.prototype.addTableWidget = function (area, table, create) {\n        var tableWidget = table[table.length - 1];\n        if (create) {\n            tableWidget = this.createTableWidget(tableWidget);\n            table.push(tableWidget);\n        }\n        tableWidget.width = area.width;\n        tableWidget.x = area.x;\n        tableWidget.y = area.y;\n        //Update the table height of tableWidget when cell spacing has been defined. \n        if (tableWidget.tableFormat.cellSpacing > 0) {\n            tableWidget.height = tableWidget.height + HelperMethods.convertPointToPixel(tableWidget.tableFormat.cellSpacing);\n            // tslint:disable-next-line:max-line-length\n            tableWidget.leftBorderWidth = HelperMethods.convertPointToPixel(this.getTableLeftBorder(tableWidget.tableFormat.borders).getLineWidth());\n            tableWidget.rightBorderWidth = HelperMethods.convertPointToPixel(this.getTableRightBorder(tableWidget.tableFormat.borders).getLineWidth());\n            // tslint:disable-next-line:max-line-length\n            tableWidget.topBorderWidth = HelperMethods.convertPointToPixel(this.getTableTopBorder(tableWidget.tableFormat.borders).getLineWidth());\n            tableWidget.bottomBorderWidth = HelperMethods.convertPointToPixel(this.getTableBottomBorder(tableWidget.tableFormat.borders).getLineWidth());\n            tableWidget.x += tableWidget.leftBorderWidth;\n            tableWidget.y += tableWidget.topBorderWidth;\n            tableWidget.width -= tableWidget.leftBorderWidth;\n            tableWidget.width -= tableWidget.rightBorderWidth;\n            tableWidget.height += tableWidget.bottomBorderWidth;\n        }\n        return tableWidget;\n    };\n    /**\n     * Updates widget to page.\n     * @param table\n     * @private\n     */\n    Layout.prototype.updateWidgetsToPage = function (tables, rows, table, endRowWidget) {\n        var viewer = this.viewer;\n        var tableWidget = tables[tables.length - 1];\n        if (!table.isInsideTable) {\n            this.updateHeightForTableWidget(tables, rows, tableWidget, endRowWidget);\n            if (tableWidget.childWidgets.length > 0 && tableWidget.y !== tableWidget.childWidgets[0].y) {\n                tableWidget.y = tableWidget.childWidgets[0].y;\n            }\n            // Need to update on this further\n            //Adds the table widget to owner cell widget.\n            // tslint:disable-next-line:max-line-length\n            // (viewer.renderedElements.get(table.associatedCell)[viewer.renderedElements.get(table.associatedCell).length - 1] as TableCellWidget).childWidgets.push(tableWidget);\n            // tableWidget.containerWidget = viewer.renderedElements.get(table.associatedCell)[viewer.renderedElements.get(table.associatedCell).length - 1] as BodyWidget;\n            // tslint:disable-next-line:max-line-length\n            // (viewer.renderedElements.get(table.associatedCell)[viewer.renderedElements.get(table.associatedCell).length - 1] as TableCellWidget).height = (viewer.renderedElements.get(table.associatedCell)[viewer.renderedElements.get(table.associatedCell).length - 1] as TableCellWidget).height + tableWidget.height;\n        }\n        if (table.tableFormat.cellSpacing > 0) {\n            // tslint:disable-next-line:max-line-length\n            if (tableWidget.y + tableWidget.height + HelperMethods.convertPointToPixel(table.tableFormat.cellSpacing) > viewer.clientArea.bottom && viewer instanceof PageLayoutViewer) {\n                //update the table height when split to next page. Which is equivalent Ms Word Behaviour. \n                //In Ms Word if the Table Split to next page the bottom spacing of the table will be half of the current spacing.\n                //And the Remaining space will be used in next page top of the table.\n                tableWidget.height = tableWidget.height - HelperMethods.convertPointToPixel(table.tableFormat.cellSpacing) / 2;\n            }\n            //Update the current Y position of current clientactivearea.\n            viewer.cutFromTop(tableWidget.y + tableWidget.height);\n        }\n        if (table.bodyWidget instanceof HeaderFooterWidget) {\n            table.containerWidget.height += table.height;\n            if (this.viewer.owner.enableHeaderAndFooter && table.bodyWidget.headerFooterType.indexOf('Footer') !== -1) {\n                this.shiftFooterChildLocation(table.bodyWidget, this.viewer);\n            }\n        }\n    };\n    /**\n     * Updates height for table widget.\n     * @param viewer\n     * @param tableWidget\n     * @private\n     */\n    // tslint:disable-next-line:max-line-length\n    Layout.prototype.updateHeightForTableWidget = function (tables, rows, tableWidget, endRowWidget) {\n        for (var i = 0; i < tableWidget.childWidgets.length; i++) {\n            var rowWidget = tableWidget.childWidgets[i];\n            if (rowWidget === endRowWidget) {\n                break;\n            }\n            this.updateHeightForRowWidget(this.viewer, true, tables, rows, rowWidget, true, endRowWidget);\n        }\n    };\n    //#endregion\n    //#region Row\n    /**\n     * Layouts table row.\n     * @param row\n     * @private\n     */\n    Layout.prototype.layoutRow = function (tableWidget, row) {\n        var viewer = this.viewer;\n        var rowWidgets = [row];\n        var widget = this.addTableRowWidget(viewer.clientActiveArea, rowWidgets);\n        viewer.updateClientAreaForRow(row, true);\n        for (var i = 0; i < row.childWidgets.length; i++) {\n            var cell = row.childWidgets[i];\n            // tslint:disable-next-line:max-line-length\n            this.layoutCell(cell, this.getMaxTopOrBottomCellMargin(row, 0) + row.topBorderWidth, this.getMaxTopOrBottomCellMargin(row, 1) + row.bottomBorderWidth, widget);\n        }\n        viewer.updateClientAreaForRow(row, false);\n        var rows = [row];\n        this.updateWidgetsToTable(tableWidget, rows, row);\n        return rows[rows.length - 1];\n    };\n    /**\n     * @param area\n     * @param row\n     */\n    Layout.prototype.addTableRowWidget = function (area, row) {\n        var rowWidget = row[row.length - 1];\n        rowWidget.x = area.x + rowWidget.rowFormat.gridBeforeWidth;\n        rowWidget.y = area.y;\n        rowWidget.width = area.width;\n        var borderWidth = 0;\n        if (!isNullOrUndefined(rowWidget.ownerTable) && !isNullOrUndefined(rowWidget.ownerTable.tableFormat)\n            && rowWidget.ownerTable.tableFormat.cellSpacing > 0) {\n            rowWidget.height = rowWidget.height + HelperMethods.convertPointToPixel(rowWidget.ownerTable.tableFormat.cellSpacing);\n            //Update the table height with the border width to layout the border when the cell spacing is defined..\n            for (var j = 0; j < rowWidget.childWidgets.length; j++) {\n                if (!isNullOrUndefined(rowWidget.childWidgets[j].cellFormat)\n                    && !isNullOrUndefined(rowWidget.childWidgets[j].cellFormat.borders)) {\n                    // tslint:disable-next-line:max-line-length\n                    var width = TableCellWidget.getCellBottomBorder(rowWidget.childWidgets[j]).getLineWidth();\n                    if (width > borderWidth) {\n                        borderWidth = width;\n                    }\n                }\n            }\n            //Maximum border width is calculated and hold it in a variable to add with the padding of the cells.\n            rowWidget.bottomBorderWidth = HelperMethods.convertPointToPixel(borderWidth);\n            if (rowWidget.index > 0 && !isNullOrUndefined(rowWidget.previousWidget)) {\n                var prevRow = rowWidget.previousWidget;\n                borderWidth = 0;\n                for (var i = 0; i < prevRow.childWidgets.length; i++) {\n                    // tslint:disable-next-line:max-line-length\n                    if (!isNullOrUndefined(prevRow.childWidgets[i].cellFormat) && !isNullOrUndefined(prevRow.childWidgets[i].cellFormat.borders)) {\n                        var value = TableCellWidget.getCellBottomBorder(prevRow.childWidgets[i]).getLineWidth();\n                        if (value > borderWidth) {\n                            borderWidth = value;\n                        }\n                    }\n                }\n                //Maximum border width is calculated and hold it in a variable to add with the padding of the cells.\n                rowWidget.topBorderWidth = HelperMethods.convertPointToPixel(borderWidth);\n            }\n        }\n        if (!isNullOrUndefined(rowWidget.childWidgets)) {\n            for (var i = 0; i < rowWidget.childWidgets.length; i++) {\n                // tslint:disable-next-line:max-line-length\n                if (!isNullOrUndefined(rowWidget.childWidgets[i].cellFormat) && !isNullOrUndefined(rowWidget.childWidgets[i].cellFormat.borders)) {\n                    var value = TableCellWidget.getCellTopBorder(rowWidget.childWidgets[i]).getLineWidth();\n                    if (value > borderWidth) {\n                        borderWidth = value;\n                    }\n                }\n            }\n        }\n        //Maximum border width is calculated and hold it in a variable to add with the padding of the cells.\n        rowWidget.topBorderWidth = HelperMethods.convertPointToPixel(borderWidth);\n        //Update the table height of tableWidget when cell spacing has been defined. \n        // tslint:disable-next-line:max-line-length\n        if (!isNullOrUndefined(rowWidget.ownerTable) && !isNullOrUndefined(rowWidget.ownerTable.tableFormat) && rowWidget.ownerTable.tableFormat.cellSpacing <= 0 && rowWidget.rowIndex === rowWidget.ownerTable.childWidgets.length - 1) {\n            // Update the bottom width for last row .\n            for (var i = 0; i < rowWidget.childWidgets.length; i++) {\n                // tslint:disable-next-line:max-line-length\n                if (!isNullOrUndefined(rowWidget.childWidgets[i].cellFormat) && !isNullOrUndefined(rowWidget.childWidgets[i].cellFormat.borders)) {\n                    var value = TableCellWidget.getCellBottomBorder(rowWidget.childWidgets[i]).getLineWidth();\n                    if (value > borderWidth) {\n                        borderWidth = value;\n                    }\n                }\n            }\n            //Maximum border width is calculated and hold it in a variable to add with the padding of the cells.\n            rowWidget.bottomBorderWidth = HelperMethods.convertPointToPixel(borderWidth);\n        }\n        //tableRowWidget.ownerWidget = owner;\n        return rowWidget;\n    };\n    /**\n     * Gets maximum top or bottom cell margin.\n     * @param row\n     * @param topOrBottom\n     */\n    Layout.prototype.getMaxTopOrBottomCellMargin = function (row, topOrBottom) {\n        if (isNullOrUndefined(row.childWidgets)) {\n            return 0;\n        }\n        var value = 0;\n        for (var i = 0; i < row.childWidgets.length; i++) {\n            if (row.childWidgets.length > 0) {\n                var cellFormat = row.childWidgets[i].cellFormat;\n                if (cellFormat.containsMargins()) {\n                    if (topOrBottom === 0 && !isNullOrUndefined(cellFormat.topMargin) &&\n                        HelperMethods.convertPointToPixel(cellFormat.topMargin) > value) {\n                        value = HelperMethods.convertPointToPixel(cellFormat.topMargin);\n                    }\n                    else if (topOrBottom === 1 && !isNullOrUndefined(cellFormat.bottomMargin) &&\n                        HelperMethods.convertPointToPixel(cellFormat.bottomMargin) > value) {\n                        value = HelperMethods.convertPointToPixel(cellFormat.bottomMargin);\n                    }\n                }\n                else {\n                    var tableFormat = row.childWidgets[i].ownerTable.tableFormat;\n                    if (topOrBottom === 0 && HelperMethods.convertPointToPixel(tableFormat.topMargin) > value) {\n                        value = HelperMethods.convertPointToPixel(tableFormat.topMargin);\n                    }\n                    else if (topOrBottom === 1 && HelperMethods.convertPointToPixel(tableFormat.bottomMargin) > value) {\n                        value = HelperMethods.convertPointToPixel(tableFormat.bottomMargin);\n                    }\n                }\n            }\n        }\n        return value;\n    };\n    //#endregion Row\n    //#region cell\n    /**\n     * Layouts cell\n     * @param cell\n     * @param maxCellMarginTop\n     * @param maxCellMarginBottom\n     */\n    Layout.prototype.layoutCell = function (cell, maxCellMarginTop, maxCellMarginBottom, owner) {\n        var viewer = this.viewer;\n        this.addTableCellWidget(cell, viewer.clientActiveArea, maxCellMarginTop, maxCellMarginBottom);\n        viewer.updateClientAreaForCell(cell, true);\n        if (cell.childWidgets.length === 0) {\n            var paragraphWidget = new ParagraphWidget();\n            paragraphWidget.characterFormat = new WCharacterFormat();\n            paragraphWidget.paragraphFormat = new WParagraphFormat();\n            paragraphWidget.index = 0;\n            var lineWidget = new LineWidget(undefined);\n            paragraphWidget.childWidgets.push(lineWidget);\n            cell.childWidgets.push(paragraphWidget);\n        }\n        for (var i = 0; i < cell.childWidgets.length; i++) {\n            var block = cell.childWidgets[i];\n            viewer.updateClientAreaForBlock(block, true);\n            block.containerWidget = cell;\n            this.layoutBlock(block, 0);\n            viewer.updateClientAreaForBlock(block, false);\n        }\n        this.updateWidgetToRow(cell);\n        viewer.updateClientAreaForCell(cell, false);\n    };\n    //endregion cell\n    //#region Shifting\n    /**\n     * @private\n     */\n    Layout.prototype.shiftLayoutedItems = function () {\n        if (isNullOrUndefined(this.viewer.blockToShift) || isNullOrUndefined(this.viewer.blockToShift.containerWidget)) {\n            this.viewer.blockToShift = undefined;\n            return;\n        }\n        var block = this.viewer.blockToShift;\n        var sectionIndex = block.bodyWidget.index;\n        this.reLayoutOrShiftWidgets(block, this.viewer);\n        var updateNextBlockList = true;\n        // If flow layout, then all sections are in single page. Hence need to update till last block of last section.\n        // Todo: For page layout and section break continuous, need to handle the same.\n        var splittedWidget = block.getSplitWidgets();\n        var nextBlock = splittedWidget[splittedWidget.length - 1].nextRenderedWidget;\n        while (nextBlock instanceof BlockWidget && nextBlock.bodyWidget.index === sectionIndex) {\n            var currentWidget = undefined;\n            var blocks = block.getSplitWidgets();\n            currentWidget = blocks[blocks.length - 1];\n            block = nextBlock;\n            updateNextBlockList = false;\n            var nextWidget = undefined;\n            blocks = block.getSplitWidgets();\n            if (block instanceof ParagraphWidget) {\n                nextWidget = blocks[0];\n            }\n            else {\n                if (block instanceof TableWidget) {\n                    nextWidget = blocks[0];\n                }\n            }\n            if (currentWidget.containerWidget === nextWidget.containerWidget\n                && (HelperMethods.round(nextWidget.y, 2) === HelperMethods.round(this.viewer.clientActiveArea.y, 2)) &&\n                isNullOrUndefined(nextWidget.nextWidget)) {\n                break;\n            }\n            updateNextBlockList = true;\n            this.reLayoutOrShiftWidgets(block, this.viewer);\n            splittedWidget = block.getSplitWidgets();\n            nextBlock = splittedWidget[splittedWidget.length - 1].nextRenderedWidget;\n        }\n        if (this.viewer.owner.editorModule) {\n            this.viewer.owner.editorModule.updateListItemsTillEnd(block, updateNextBlockList);\n        }\n        this.viewer.blockToShift = undefined;\n        var viewer = this.viewer;\n        // if (viewer instanceof PageLayoutViewer) {\n        viewer.removeEmptyPages();\n        this.updateFieldElements();\n        viewer.updateScrollBars();\n        // }\n    };\n    /**\n     * @private\n     */\n    Layout.prototype.updateFieldElements = function () {\n        for (var i = 0; i < this.viewer.fields.length; i++) {\n            var fieldBegin = this.viewer.fields[i];\n            if (!isNullOrUndefined(this.viewer.selection)) {\n                var fieldCode = this.viewer.selection.getFieldCode(fieldBegin);\n                if (!isNullOrUndefined(fieldCode) && fieldCode.toLowerCase().match('numpages')) {\n                    var textElement = fieldBegin.fieldSeparator.nextNode;\n                    if (!isNullOrUndefined(textElement)) {\n                        textElement.text = this.viewer.pages.length.toString();\n                        var paragraph = fieldBegin.line.paragraph;\n                        if (!isNullOrUndefined(paragraph.bodyWidget) && !isNullOrUndefined(paragraph.bodyWidget.page)) {\n                            var lineIndex = paragraph.childWidgets.indexOf(fieldBegin.line);\n                            var elementIndex = fieldBegin.line.children.indexOf(textElement);\n                            this.reLayoutParagraph(paragraph, lineIndex, elementIndex);\n                        }\n                    }\n                }\n            }\n        }\n    };\n    Layout.prototype.reLayoutOrShiftWidgets = function (blockAdv, viewer) {\n        var reLayoutItems = false;\n        var block = blockAdv;\n        // if (block instanceof ParagraphWidget) {\n        //     reLayoutItems = viewer.renderedElements.get(block as ParagraphWidget).length === 0;\n        // } else {\n        //     reLayoutItems = viewer.renderedElements.get(block as TableWidget).length === 0;\n        // }\n        // if (reLayoutItems) {\n        //     //Handle layouting the block.\n        //     viewer.updateClientAreaForBlock(block, true);\n        //     this.layoutMod.layoutBlock(block);\n        //     viewer.updateClientAreaForBlock(block, false);\n        // } else {\n        //Handled to check client area and shift layouted widget.\n        this.shiftWidgetsBlock(block, viewer);\n        //Updates the list value of the rendered paragraph.\n        if (this.viewer.owner.editorModule) {\n            this.viewer.owner.editorModule.updateRenderedListItems(block);\n        }\n        // }\n    };\n    Layout.prototype.shiftWidgetsBlock = function (block, viewer) {\n        if (block instanceof ParagraphWidget) {\n            this.shiftWidgetsForPara(block, viewer);\n        }\n        else if (block instanceof TableWidget) {\n            this.shiftWidgetsForTable(block, viewer);\n        }\n    };\n    Layout.prototype.shiftWidgetsForPara = function (paragraph, viewer) {\n        var prevBodyObj = this.getBodyWidgetOfPreviousBlock(paragraph, 0);\n        var prevBodyWidget = prevBodyObj.bodyWidget;\n        var index = prevBodyObj.index;\n        var prevWidget = undefined;\n        for (var i = 0; i < paragraph.getSplitWidgets().length; i++) {\n            var widget = paragraph.getSplitWidgets()[i];\n            if (!isNullOrUndefined(prevWidget)) {\n                var isPageBreak = prevWidget.lastChild ? prevWidget.lastChild.isEndsWithPageBreak : false;\n                this.shiftToPreviousWidget(widget, viewer, prevWidget, isPageBreak);\n                if ((isNullOrUndefined(widget.childWidgets) || widget.childWidgets.length === 0) && !isPageBreak) {\n                    i--;\n                    continue;\n                }\n                prevWidget = undefined;\n                if (prevBodyWidget !== widget.containerWidget) {\n                    prevBodyWidget = widget.containerWidget;\n                    if (isPageBreak) {\n                        viewer.updateClientAreaByWidget(widget);\n                    }\n                }\n            }\n            if (this.isFitInClientArea(widget, viewer)) {\n                //Check whether this widget is moved to previous container widget.\n                prevWidget = widget;\n                widget.y = viewer.clientActiveArea.y;\n                viewer.cutFromTop(viewer.clientActiveArea.y + widget.height);\n                //Moves the paragraph widget to previous body widget.\n                if (!isNullOrUndefined(prevBodyWidget) && prevBodyWidget !== widget.containerWidget) {\n                    index++;\n                    if (!prevBodyWidget.lastChild.isEndsWithPageBreak) {\n                        this.updateContainerWidget(widget, prevBodyWidget, index, true);\n                    }\n                }\n                if (widget.isEndsWithPageBreak) {\n                    var nextBodyWidget = this.createOrGetNextBodyWidget(prevBodyWidget, this.viewer);\n                    nextBodyWidget = this.moveBlocksToNextPage(widget);\n                    viewer.updateClientArea(nextBodyWidget.sectionFormat, nextBodyWidget.page);\n                }\n            }\n            else {\n                var previousBlock = widget.previousRenderedWidget;\n                var isPageBreak = false;\n                if (previousBlock instanceof ParagraphWidget && previousBlock.isEndsWithPageBreak) {\n                    isPageBreak = true;\n                }\n                var isSplittedToNewPage = this.splitWidget(widget, viewer, prevBodyWidget, index + 1, isPageBreak);\n                prevWidget = undefined;\n                if (prevBodyWidget !== widget.containerWidget) {\n                    prevBodyWidget = widget.containerWidget;\n                    i--;\n                }\n                index = prevBodyWidget.childWidgets.indexOf(widget);\n                if (isSplittedToNewPage) {\n                    prevBodyWidget = paragraph.getSplitWidgets()[i + 1].containerWidget;\n                }\n            }\n        }\n    };\n    /**\n     * @private\n     */\n    Layout.prototype.shiftTableWidget = function (table, viewer) {\n        var tables = [table];\n        this.addTableWidget(this.viewer.clientActiveArea, tables);\n        this.viewer.updateClientAreaTopOrLeft(table, true);\n        var row = table.childWidgets[0];\n        while (row) {\n            row = this.shiftRowWidget(tables, row);\n            row = row.nextRow;\n        }\n        this.updateWidgetsToPage(tables, [], table);\n        return tables[tables.length - 1];\n    };\n    /**\n     * @private\n     */\n    Layout.prototype.shiftRowWidget = function (tables, row) {\n        var viewer = this.viewer;\n        var rows = [row];\n        var widget = this.addTableRowWidget(viewer.clientActiveArea, rows);\n        viewer.updateClientAreaForRow(row, true);\n        for (var i = 0; i < row.childWidgets.length; i++) {\n            var cell = row.childWidgets[i];\n            // tslint:disable-next-line:max-line-length\n            this.shiftCellWidget(cell, this.getMaxTopOrBottomCellMargin(row, 0) + row.topBorderWidth, this.getMaxTopOrBottomCellMargin(row, 1) + row.bottomBorderWidth);\n        }\n        viewer.updateClientAreaForRow(row, false);\n        this.updateWidgetsToTable(tables, rows, row);\n        return rows[rows.length - 1];\n    };\n    /**\n     * @private\n     */\n    Layout.prototype.shiftCellWidget = function (cell, maxCellMarginTop, maxCellMarginBottom) {\n        var viewer = this.viewer;\n        this.addTableCellWidget(cell, viewer.clientActiveArea, maxCellMarginTop, maxCellMarginBottom);\n        viewer.updateClientAreaForCell(cell, true);\n        for (var i = 0; i < cell.childWidgets.length; i++) {\n            var block = cell.childWidgets[i];\n            viewer.updateClientAreaForBlock(block, true);\n            if (block instanceof ParagraphWidget) {\n                this.shiftParagraphWidget(block);\n            }\n            else {\n                this.shiftTableWidget(block, viewer);\n            }\n            viewer.updateClientAreaForBlock(block, false);\n        }\n        this.updateWidgetToRow(cell);\n        viewer.updateClientAreaForCell(cell, false);\n    };\n    /**\n     * @private\n     */\n    Layout.prototype.shiftParagraphWidget = function (paragraph) {\n        this.addParagraphWidget(this.viewer.clientActiveArea, paragraph);\n        this.viewer.cutFromTop(this.viewer.clientActiveArea.y + paragraph.height);\n        this.updateWidgetToPage(this.viewer, paragraph);\n    };\n    Layout.prototype.shiftWidgetsForTable = function (table, viewer) {\n        var prevObj = this.getBodyWidgetOfPreviousBlock(table, 0);\n        var prevBodyWidget = prevObj.bodyWidget;\n        var index = prevObj.index;\n        var isPageBreak = prevBodyWidget.lastChild.lastChild.isEndsWithPageBreak;\n        if (prevBodyWidget !== table.containerWidget) {\n            if (!isPageBreak) {\n                this.updateContainerWidget(table, prevBodyWidget, index + 1, true);\n            }\n            else {\n                viewer.updateClientArea(table.bodyWidget.sectionFormat, table.bodyWidget.page);\n            }\n        }\n        if (table.isInHeaderFooter) {\n            table.containerWidget.height -= table.height;\n        }\n        table.y = this.viewer.clientActiveArea.y;\n        this.updateVerticalPositionToTop(table, true);\n        var isPageLayout = viewer instanceof PageLayoutViewer;\n        var combinedTable = table.combineWidget(this.viewer);\n        this.viewer.layout.updateChildLocationForTable(combinedTable.y, combinedTable);\n        this.clearTableWidget(combinedTable, true, false);\n        this.shiftTableWidget(combinedTable, this.viewer);\n        this.updateVerticalPositionToTop(table, false);\n    };\n    Layout.prototype.updateVerticalPositionToTop = function (table, isUpdateTop) {\n        //Iterate the tableWidgets counts\n        for (var i = 0; i < table.getSplitWidgets().length; i++) {\n            var tablewidget = table.getSplitWidgets()[i];\n            //Iterate the tableWidget child items\n            for (var j = 0; j < tablewidget.childWidgets.length; j++) {\n                var rowWidget = tablewidget.childWidgets[j];\n                //Iterate the RowWidgets child items\n                for (var k = 0; k < rowWidget.childWidgets.length; k++) {\n                    var cellWidget = rowWidget.childWidgets[k];\n                    //Iterate the RowWidgets child items\n                    this.viewer.layout.updateCellVerticalPosition(cellWidget, isUpdateTop, false);\n                }\n            }\n        }\n    };\n    // tslint:disable-next-line:max-line-length\n    Layout.prototype.splitWidget = function (paragraphWidget, viewer, previousBodyWidget, index, isPageBreak) {\n        var firstLine = paragraphWidget.childWidgets[0];\n        var maxElementHeight = this.getMaxElementHeight(firstLine, viewer);\n        var paragraphView = paragraphWidget.getSplitWidgets();\n        var nextBodyWidget = paragraphWidget.containerWidget;\n        if (viewer.clientActiveArea.height >= maxElementHeight && !isPageBreak) {\n            var splittedWidget = undefined;\n            var widgetIndex = paragraphView.indexOf(paragraphWidget);\n            if (widgetIndex < (paragraphView.length - 1)) {\n                splittedWidget = paragraphView[widgetIndex + 1];\n                nextBodyWidget = splittedWidget.containerWidget;\n            }\n            else {\n                splittedWidget = new ParagraphWidget();\n                splittedWidget.index = paragraphWidget.index;\n                splittedWidget.characterFormat = paragraphWidget.characterFormat;\n                splittedWidget.paragraphFormat = paragraphWidget.paragraphFormat;\n                splittedWidget.width = paragraphWidget.width;\n                splittedWidget.x = paragraphWidget.x;\n                splittedWidget.y = paragraphWidget.y;\n                paragraphView.push(splittedWidget);\n            }\n            if (previousBodyWidget !== paragraphWidget.containerWidget) {\n                this.updateContainerWidget(paragraphWidget, previousBodyWidget, index, true);\n            }\n            for (var i = paragraphWidget.childWidgets.length - 1; i > 0; i--) {\n                if (this.isFitInClientArea(paragraphWidget, viewer)) {\n                    break;\n                }\n                else {\n                    var line = paragraphWidget.childWidgets[i];\n                    //Moves the line widget to next widget.\n                    this.updateParagraphWidgetInternal(line, splittedWidget, 0);\n                }\n            }\n            if (isNullOrUndefined(splittedWidget.containerWidget) && splittedWidget.childWidgets.length > 0) {\n                var y = viewer.clientActiveArea.y;\n                // tslint:disable-next-line:max-line-length\n                var clientArea = new Rect(viewer.clientArea.x, viewer.clientArea.y, viewer.clientArea.width, viewer.clientArea.height);\n                var activeArea = new Rect(viewer.clientActiveArea.x, viewer.clientActiveArea.y, viewer.clientActiveArea.width, viewer.clientActiveArea.height);\n                //Checks whether next node exists, else adds new page.\n                nextBodyWidget = this.moveBlocksToNextPage(paragraphWidget);\n                // nextBodyWidget = this.createOrGetNextBodyWidget(previousBodyWidget, viewer);\n                nextBodyWidget.childWidgets.splice(0, 0, splittedWidget);\n                nextBodyWidget.height += splittedWidget.height;\n                splittedWidget.containerWidget = nextBodyWidget;\n                if (nextBodyWidget.childWidgets.length === 1 && nextBodyWidget.firstChild instanceof ParagraphWidget &&\n                    nextBodyWidget.firstChild.equals(paragraphWidget)) {\n                    paragraphWidget.x = paragraphWidget.x;\n                    paragraphWidget.y = y;\n                    return true;\n                }\n                else {\n                    //Resetting Client area\n                    viewer.clientArea = clientArea;\n                    viewer.clientActiveArea = activeArea;\n                }\n            }\n        }\n        else {\n            nextBodyWidget = this.createOrGetNextBodyWidget(previousBodyWidget, this.viewer);\n            if (paragraphWidget.containerWidget !== nextBodyWidget) {\n                nextBodyWidget = this.moveBlocksToNextPage(paragraphWidget);\n                this.updateContainerWidget(paragraphWidget, nextBodyWidget, 0, true);\n            }\n        }\n        if (previousBodyWidget === paragraphWidget.containerWidget) {\n            paragraphWidget.y = viewer.clientActiveArea.y;\n            viewer.cutFromTop(viewer.clientActiveArea.y + paragraphWidget.height);\n        }\n        else {\n            //Updates client area based on next body widget.\n            viewer.updateClientArea(nextBodyWidget.sectionFormat, nextBodyWidget.page);\n        }\n        return false;\n    };\n    Layout.prototype.getMaxElementHeight = function (lineWidget, viewer) {\n        var height = 0;\n        // tslint:disable-next-line:max-line-length\n        if (lineWidget.children.length === 0 || ((lineWidget.children.length === 1 && lineWidget.children[0] instanceof ListTextElementBox) || (lineWidget.children.length === 2 && lineWidget.children[0] instanceof ListTextElementBox && lineWidget.children[1] instanceof ListTextElementBox))) {\n            var topMargin = 0;\n            var bottomMargin = 0;\n            height = viewer.selection.getParagraphMarkSize(lineWidget.paragraph, topMargin, bottomMargin).height;\n            height += topMargin;\n            if (lineWidget.children.length > 0) {\n                var element = lineWidget.children[0];\n                if (height < element.margin.top + element.height) {\n                    height = element.margin.top + element.height;\n                }\n            }\n        }\n        else {\n            for (var i = 0; i < lineWidget.children.length; i++) {\n                var element = lineWidget.children[i];\n                if (height < element.margin.top + element.height) {\n                    height = element.margin.top + element.height;\n                }\n            }\n        }\n        return height;\n    };\n    Layout.prototype.createOrGetNextBodyWidget = function (bodyWidget, viewer) {\n        var nextBodyWidget = undefined;\n        var pageIndex = 0;\n        pageIndex = viewer.pages.indexOf(bodyWidget.page);\n        var page = undefined;\n        var index = undefined;\n        index = bodyWidget.index;\n        if (pageIndex === viewer.pages.length - 1\n            || viewer.pages[pageIndex + 1].sectionIndex !== index) {\n            var currentWidget = new BodyWidget();\n            currentWidget.sectionFormat = bodyWidget.sectionFormat;\n            currentWidget.index = bodyWidget.index;\n            page = viewer.createNewPage(currentWidget);\n            if (viewer.pages[pageIndex + 1].sectionIndex !== index) {\n                viewer.insertPage(pageIndex + 1, page);\n            }\n            nextBodyWidget = page.bodyWidgets[0];\n        }\n        else {\n            page = viewer.pages[pageIndex + 1];\n            nextBodyWidget = page.bodyWidgets[0];\n        }\n        return nextBodyWidget;\n    };\n    Layout.prototype.isFitInClientArea = function (paragraphWidget, viewer) {\n        var lastLine = paragraphWidget.childWidgets[paragraphWidget.childWidgets.length - 1];\n        var height = paragraphWidget.height;\n        var maxElementHeight = this.getMaxElementHeight(lastLine, viewer);\n        if (lastLine.height > maxElementHeight) {\n            height -= lastLine.height - maxElementHeight;\n        }\n        return viewer.clientActiveArea.height >= height;\n    };\n    // tslint:disable-next-line:max-line-length\n    Layout.prototype.shiftToPreviousWidget = function (paragraphWidget, viewer, previousWidget, isPageBreak) {\n        for (var i = 0; i < paragraphWidget.childWidgets.length; i++) {\n            var line = paragraphWidget.childWidgets[i];\n            var maxElementHeight = this.getMaxElementHeight(line, viewer);\n            if (viewer.clientActiveArea.height >= maxElementHeight && !isPageBreak) {\n                //Moves the line widget to previous widget.\n                this.updateParagraphWidgetInternal(line, previousWidget, previousWidget.childWidgets.length);\n                i--;\n                viewer.cutFromTop(viewer.clientActiveArea.y + line.height);\n                if (isNullOrUndefined(paragraphWidget.childWidgets)) {\n                    break;\n                }\n            }\n            else {\n                var bodyWidget = previousWidget.containerWidget;\n                var nextBodyWidget = this.createOrGetNextBodyWidget(bodyWidget, viewer);\n                if (paragraphWidget.containerWidget !== nextBodyWidget) {\n                    nextBodyWidget = this.moveBlocksToNextPage(paragraphWidget);\n                }\n                if (bodyWidget !== nextBodyWidget) {\n                    this.updateContainerWidget(paragraphWidget, nextBodyWidget, 0, true);\n                }\n                //Updates client area based on next page.\n                viewer.updateClientArea(nextBodyWidget.sectionFormat, nextBodyWidget.page);\n                break;\n            }\n        }\n    };\n    Layout.prototype.updateParagraphWidgetInternal = function (lineWidget, newParagraphWidget, index) {\n        if (!isNullOrUndefined(lineWidget.paragraph)) {\n            lineWidget.paragraph.childWidgets.splice(lineWidget.paragraph.childWidgets.indexOf(lineWidget), 1);\n            lineWidget.paragraph.height -= lineWidget.height;\n            if (!isNullOrUndefined(lineWidget.paragraph.containerWidget)) {\n                lineWidget.paragraph.containerWidget.height -= lineWidget.height;\n            }\n            // tslint:disable-next-line:max-line-length\n            if (isNullOrUndefined(lineWidget.paragraph.childWidgets) || lineWidget.paragraph.childWidgets.length === 0) {\n                lineWidget.paragraph.destroyInternal(this.viewer);\n            }\n        }\n        newParagraphWidget.childWidgets.splice(index, 0, lineWidget);\n        lineWidget.paragraph = newParagraphWidget;\n        newParagraphWidget.height += lineWidget.height;\n        if (!isNullOrUndefined(newParagraphWidget.containerWidget)) {\n            newParagraphWidget.containerWidget.height += lineWidget.height;\n        }\n    };\n    Layout.prototype.shiftNextWidgets = function (blockAdv) {\n        var block = blockAdv;\n        while (block.nextWidget instanceof BlockWidget) {\n            block = block.nextWidget;\n            this.reLayoutOrShiftWidgets(block, this.viewer);\n        }\n    };\n    /**\n     * @private\n     */\n    Layout.prototype.updateContainerWidget = function (widget, bodyWidget, index, destroyAndScroll) {\n        if (!isNullOrUndefined(widget.containerWidget)) {\n            widget.containerWidget.childWidgets.splice(widget.containerWidget.childWidgets.indexOf(widget), 1);\n            widget.containerWidget.height -= bodyWidget.height;\n            if ((isNullOrUndefined(widget.containerWidget.childWidgets) || widget.containerWidget.childWidgets.length === 0)\n                && widget.containerWidget instanceof BodyWidget && widget.containerWidget !== bodyWidget && destroyAndScroll) {\n                var page = widget.containerWidget.page;\n                if (this.viewer.pages[this.viewer.pages.length - 1] === page &&\n                    this.viewer.visiblePages.indexOf(page) !== -1) {\n                    this.viewer.scrollToBottom();\n                }\n                if (isNullOrUndefined(page.nextPage) || page.nextPage.bodyWidgets[0].index !== widget.containerWidget.index) {\n                    widget.containerWidget.destroyInternal(this.viewer);\n                }\n            }\n        }\n        bodyWidget.childWidgets.splice(index, 0, widget);\n        bodyWidget.height += bodyWidget.height;\n        widget.containerWidget = bodyWidget;\n    };\n    Layout.prototype.getBodyWidgetOfPreviousBlock = function (block, index) {\n        index = 0;\n        var prevBodyWidget = undefined;\n        var previousBlock = block.previousRenderedWidget;\n        prevBodyWidget = (previousBlock && previousBlock.containerWidget.equals(block.containerWidget)) ?\n            previousBlock.containerWidget : block.containerWidget;\n        index = previousBlock && previousBlock.containerWidget.equals(block.containerWidget) ?\n            prevBodyWidget.childWidgets.indexOf(previousBlock) : block.containerWidget.childWidgets.indexOf(block);\n        return { bodyWidget: prevBodyWidget, index: index };\n    };\n    /**\n     * @private\n     */\n    Layout.prototype.moveBlocksToNextPage = function (block) {\n        var body = block.bodyWidget;\n        var page = body.page;\n        var pageIndex = page.index + 1;\n        var nextPage = undefined;\n        var nextBody = undefined;\n        var insertPage = false;\n        if (this.viewer.pages.length > pageIndex) {\n            nextPage = this.viewer.pages[pageIndex];\n            if (nextPage.bodyWidgets.length === 0 || !body.equals(nextPage.bodyWidgets[0])) {\n                nextPage = undefined;\n                insertPage = true;\n            }\n            else {\n                nextBody = nextPage.bodyWidgets[0];\n                this.viewer.updateClientArea(nextBody.sectionFormat, nextBody.page);\n            }\n        }\n        if (isNullOrUndefined(nextPage)) {\n            nextBody = this.createSplitBody(body);\n            nextPage = this.viewer.createNewPage(nextBody, pageIndex);\n            if (insertPage) {\n                this.viewer.insertPage(pageIndex, nextPage);\n            }\n        }\n        //tslint:disable :no-constant-condition\n        do {\n            var lastBlock = body.lastChild;\n            if (block === lastBlock) {\n                break;\n            }\n            body.childWidgets.pop();\n            nextBody.childWidgets.splice(0, 0, lastBlock);\n            lastBlock.containerWidget = nextBody;\n            nextBody.height += lastBlock.height;\n        } while (true);\n        return nextBody;\n    };\n    Layout.prototype.createSplitBody = function (body) {\n        var newBody = this.addBodyWidget(this.viewer.clientActiveArea);\n        newBody.sectionFormat = body.sectionFormat;\n        newBody.index = body.index;\n        return newBody;\n    };\n    //endregion\n    //#region Relayout Parargaph \n    /**\n     * Relayout Paragraph from specified line widget\n     * @param paragraph Paragraph to reLayout\n     * @param lineIndex start line index to reLayout\n     * @private\n     */\n    Layout.prototype.reLayoutLine = function (paragraph, lineIndex) {\n        if (this.viewer.owner.isDocumentLoaded && this.viewer.owner.editorModule) {\n            this.viewer.owner.editorModule.updateWholeListItems(paragraph);\n        }\n        var lineWidget;\n        if (paragraph.paragraphFormat.listFormat && paragraph.paragraphFormat.listFormat.listId !== -1) {\n            lineWidget = paragraph.getSplitWidgets()[0].firstChild;\n        }\n        else {\n            lineWidget = paragraph.childWidgets[lineIndex];\n        }\n        var lineToLayout = lineWidget.previousLine;\n        if (isNullOrUndefined(lineToLayout)) {\n            lineToLayout = lineWidget;\n        }\n        var currentParagraph = lineToLayout.paragraph;\n        var bodyWidget = paragraph.containerWidget;\n        bodyWidget.height -= paragraph.height;\n        if (this.viewer.owner.enableHeaderAndFooter || paragraph.isInHeaderFooter) {\n            // tslint:disable-next-line:max-line-length\n            this.viewer.updateHCFClientAreaWithTop(paragraph.bodyWidget.sectionFormat, this.viewer.isBlockInHeader(paragraph), bodyWidget.page);\n        }\n        else {\n            this.viewer.updateClientArea(bodyWidget.sectionFormat, bodyWidget.page);\n        }\n        this.viewer.updateClientAreaForBlock(paragraph, true);\n        if (lineToLayout.paragraph.isEmpty()) {\n            this.viewer.cutFromTop(paragraph.y);\n            this.layoutParagraph(paragraph, 0);\n        }\n        else {\n            this.updateClientAreaForLine(lineToLayout.paragraph, lineToLayout, 0);\n            this.layoutListItems(lineToLayout.paragraph);\n            if (lineToLayout.isFirstLine() && !isNullOrUndefined(paragraph.paragraphFormat)) {\n                var firstLineIndent = -HelperMethods.convertPointToPixel(paragraph.paragraphFormat.firstLineIndent);\n                this.viewer.updateClientWidth(firstLineIndent);\n            }\n            do {\n                lineToLayout = this.layoutLine(lineToLayout, 0);\n                paragraph = lineToLayout.paragraph;\n                lineToLayout = lineToLayout.nextLine;\n            } while (lineToLayout);\n            this.updateWidgetToPage(this.viewer, paragraph);\n            this.viewer.updateClientAreaForBlock(paragraph, false);\n        }\n        this.layoutNextItemsBlock(paragraph, this.viewer);\n    };\n    return Layout;\n}());\nexport { Layout };\n","import { isNullOrUndefined } from '@syncfusion/ej2-base';\nimport { Rect, ImageElementBox, ParagraphWidget, ListTextElementBox, TableRowWidget, TableWidget, TableCellWidget, FieldElementBox, TabElementBox } from './page';\nimport { Layout } from './layout';\nimport { HelperMethods } from '../editor/editor-helper';\n/**\n * @private\n */\nvar Renderer = /** @class */ (function () {\n    function Renderer(viewer) {\n        this.isPrinting = false;\n        this.pageLeft = 0;\n        this.pageTop = 0;\n        this.isFieldCode = false;\n        this.viewer = viewer;\n    }\n    Object.defineProperty(Renderer.prototype, \"pageCanvas\", {\n        /**\n         * Gets page canvas.\n         * @private\n         */\n        get: function () {\n            if (this.isPrinting) {\n                if (isNullOrUndefined(this.pageCanvasIn)) {\n                    this.pageCanvasIn = document.createElement('canvas');\n                    this.pageCanvasIn.getContext('2d').save();\n                }\n                return this.pageCanvasIn;\n            }\n            return isNullOrUndefined(this.viewer) ? undefined : this.viewer.containerCanvas;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(Renderer.prototype, \"selectionCanvas\", {\n        /**\n         * Gets selection canvas.\n         */\n        get: function () {\n            return isNullOrUndefined(this.viewer) ? undefined : this.viewer.selectionCanvas;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(Renderer.prototype, \"pageContext\", {\n        /**\n         * Gets page context.\n         */\n        get: function () {\n            return this.pageCanvas.getContext('2d');\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(Renderer.prototype, \"selectionContext\", {\n        /**\n         * Gets selection context.\n         */\n        get: function () {\n            return this.selectionCanvas.getContext('2d');\n        },\n        enumerable: true,\n        configurable: true\n    });\n    /**\n     * Gets the color.\n     */\n    Renderer.prototype.getColor = function (color) {\n        if (color.length > 0) {\n            if (color[0] === '#') {\n                if (color.length > 7) {\n                    return color.substr(0, 7);\n                }\n            }\n        }\n        return color;\n    };\n    /**\n     * Renders widgets.\n     * @param {Page} page\n     * @param {number} left\n     * @param {number} top\n     * @param {number} width\n     * @param {number} height\n     * @private\n     */\n    Renderer.prototype.renderWidgets = function (page, left, top, width, height) {\n        if (isNullOrUndefined(this.pageCanvas) || isNullOrUndefined(page)) {\n            return;\n        }\n        this.pageContext.fillStyle = this.getColor(this.viewer.backgroundColor);\n        this.pageContext.beginPath();\n        this.pageContext.fillRect(left, top, width, height);\n        this.pageContext.closePath();\n        this.pageContext.strokeStyle = this.viewer.owner.pageOutline;\n        this.pageContext.strokeRect(left, top, width, height);\n        this.pageLeft = left;\n        this.pageTop = top;\n        if (this.isPrinting) {\n            this.setPageSize(page);\n        }\n        else {\n            this.pageContext.beginPath();\n            this.pageContext.save();\n            this.pageContext.rect(left, top, width, height);\n            this.pageContext.clip();\n        }\n        if (page.headerWidget) {\n            this.renderHFWidgets(page, page.headerWidget, width, true);\n        }\n        if (page.footerWidget) {\n            this.renderHFWidgets(page, page.footerWidget, width, false);\n        }\n        for (var i = 0; i < page.bodyWidgets.length; i++) {\n            this.render(page, page.bodyWidgets[i]);\n        }\n        if (this.viewer.owner.enableHeaderAndFooter && !this.isPrinting) {\n            this.renderHeaderSeparator(page, this.pageLeft, this.pageTop, page.headerWidget);\n        }\n        this.pageLeft = 0;\n        this.pageTop = 0;\n        this.pageContext.restore();\n    };\n    /**\n     * Sets page size.\n     * @param {Page} page\n     */\n    Renderer.prototype.setPageSize = function (page) {\n        this.pageContext.clearRect(0, 0, this.pageCanvas.width, this.pageCanvas.height);\n        this.selectionContext.clearRect(0, 0, this.selectionCanvas.width, this.selectionCanvas.height);\n        this.pageContext.restore();\n        this.selectionContext.restore();\n        var width = page.boundingRectangle.width;\n        var height = page.boundingRectangle.height;\n        var dpr = Math.max(1, window.devicePixelRatio || 1);\n        if (this.pageCanvas.width !== width * dpr || this.pageCanvas.height !== height * dpr) {\n            this.pageCanvas.height = height * dpr;\n            this.pageCanvas.width = width * dpr;\n            this.pageCanvas.style.height = height + 'px';\n            this.pageCanvas.style.width = width + 'px';\n            this.pageContext.globalAlpha = 1;\n            this.pageContext.scale(dpr, dpr);\n        }\n    };\n    /**\n     * Renders header footer widget.\n     * @param {Page} page\n     * @param {HeaderFooterWidget} headFootWidget\n     */\n    Renderer.prototype.renderHFWidgets = function (page, widget, width, isHeader) {\n        this.pageContext.globalAlpha = this.viewer.owner.enableHeaderAndFooter ? 1 : 0.65;\n        var cliped = false;\n        if (isHeader) {\n            var topMargin = HelperMethods.convertPointToPixel(page.bodyWidgets[0].sectionFormat.topMargin);\n            var widgetHeight = Math.max((widget.y + widget.height), topMargin);\n            var headerFooterHeight = page.boundingRectangle.height / 100 * 40;\n            if (widgetHeight > headerFooterHeight) {\n                cliped = true;\n                this.pageContext.beginPath();\n                this.pageContext.save();\n                this.pageContext.rect(this.pageLeft, this.pageTop, width, this.getScaledValue(headerFooterHeight));\n                this.pageContext.clip();\n            }\n        }\n        for (var i = 0; i < widget.childWidgets.length; i++) {\n            var block = widget.childWidgets[i];\n            this.renderWidget(page, block);\n        }\n        if (cliped) {\n            this.pageContext.restore();\n        }\n        this.pageContext.globalAlpha = this.viewer.owner.enableHeaderAndFooter ? 0.65 : 1;\n    };\n    Renderer.prototype.renderHeaderSeparator = function (page, left, top, widget) {\n        //Header Widget\n        var topMargin = HelperMethods.convertPointToPixel(page.bodyWidgets[0].sectionFormat.topMargin);\n        var y = this.getScaledValue(Math.max((widget.y + widget.height), topMargin));\n        var pageWidth = this.getScaledValue(page.boundingRectangle.width);\n        var ctx = this.pageContext;\n        ctx.save();\n        ctx.globalAlpha = 0.65;\n        var headerFooterHeight = (this.getScaledValue(page.boundingRectangle.height) / 100) * 40;\n        //Maximum header height limit       \n        y = Math.min(y, headerFooterHeight);\n        //Dash line Separator\n        this.renderDashLine(ctx, left, top + y, pageWidth);\n        var type = this.getHeaderFooterType(page, true);\n        ctx.font = '9pt Arial';\n        var width = ctx.measureText(type).width;\n        this.renderHeaderFooterMark(ctx, left + 5, top + y, width + 10, 20);\n        this.renderHeaderFooterMarkText(ctx, type, left + 10, y + top + 15);\n        if (page.footerWidget) {\n            //Footer Widget\n            var footerDistance = HelperMethods.convertPointToPixel(page.bodyWidgets[0].sectionFormat.footerDistance);\n            // tslint:disable-next-line:max-line-length\n            var footerHeight = this.getScaledValue(page.boundingRectangle.height) -\n                this.getScaledValue(Math.max(page.footerWidget.height + footerDistance, HelperMethods.convertPointToPixel(page.footerWidget.sectionFormat.bottomMargin)));\n            //Maximum footer height limit     \n            footerHeight = Math.max((this.getScaledValue(page.boundingRectangle.height) - headerFooterHeight), footerHeight);\n            this.renderDashLine(ctx, left, top + footerHeight, pageWidth);\n            type = this.getHeaderFooterType(page, false);\n            width = ctx.measureText(type).width;\n            this.renderHeaderFooterMark(ctx, left + 5, top + footerHeight - 20, width + 10, 20);\n            this.renderHeaderFooterMarkText(ctx, type, left + 10, top + footerHeight - 5);\n            ctx.restore();\n        }\n    };\n    Renderer.prototype.getHeaderFooterType = function (page, isHeader) {\n        var type;\n        type = isHeader ? 'Header' : 'Footer';\n        if (page.bodyWidgets[0].sectionFormat.differentFirstPage && this.viewer.pages.indexOf(page) === 0) {\n            type = isHeader ? 'First Page Header' : 'First Page Footer';\n        }\n        else if (page.bodyWidgets[0].sectionFormat.differentOddAndEvenPages) {\n            if ((this.viewer.pages.indexOf(page) + 1) % 2 === 0) {\n                type = isHeader ? 'Even Page Header' : 'Even Page Footer';\n            }\n            else {\n                type = isHeader ? 'Odd Page Header' : 'Odd Page Footer';\n            }\n        }\n        return type;\n    };\n    Renderer.prototype.renderDashLine = function (ctx, x, y, width) {\n        ctx.beginPath();\n        ctx.strokeStyle = '#000000';\n        ctx.lineWidth = 1;\n        ctx.setLineDash([6, 4]);\n        ctx.moveTo(x, y);\n        ctx.lineTo(x + width, y);\n        ctx.stroke();\n        ctx.setLineDash([]);\n        ctx.closePath();\n    };\n    Renderer.prototype.renderHeaderFooterMark = function (ctx, x, y, w, h) {\n        ctx.beginPath();\n        ctx.fillStyle = 'lightgray';\n        ctx.fillRect(x, y, w, h);\n        ctx.strokeStyle = 'black';\n        ctx.strokeRect(x, y, w, h);\n        ctx.closePath();\n    };\n    Renderer.prototype.renderHeaderFooterMarkText = function (ctx, content, x, y) {\n        ctx.beginPath();\n        ctx.fillStyle = '#000000';\n        ctx.textBaseline = 'alphabetic';\n        ctx.fillText(content, x, y);\n        ctx.closePath();\n    };\n    /**\n     * Renders body widget.\n     * @param {Page} page\n     * @param {BodyWidget} bodyWidget\n     */\n    Renderer.prototype.render = function (page, bodyWidget) {\n        for (var i = 0; i < bodyWidget.childWidgets.length; i++) {\n            var widget = bodyWidget.childWidgets[i];\n            if (i === 0 && bodyWidget.childWidgets[0] instanceof TableWidget && page.repeatHeaderRowTableWidget) {\n                // tslint:disable-next-line:max-line-length\n                this.renderHeader(page, widget, this.viewer.layout.getHeader(bodyWidget.childWidgets[0]));\n            }\n            this.renderWidget(page, widget);\n        }\n    };\n    /**\n     * Renders block widget.\n     * @param {Page} page\n     * @param {Widget} widget\n     */\n    Renderer.prototype.renderWidget = function (page, widget) {\n        if (widget instanceof ParagraphWidget) {\n            this.renderParagraphWidget(page, widget);\n        }\n        else {\n            this.renderTableWidget(page, widget);\n        }\n    };\n    /**\n     * Renders header.\n     * @param {Page} page\n     * @param {TableWidget} widget\n     * @param {WRow} header\n     * @private\n     */\n    Renderer.prototype.renderHeader = function (page, widget, header) {\n        if (isNullOrUndefined(header)) {\n            return;\n        }\n        var top = page.viewer.clientArea.y;\n        for (var i = 0; i <= header.rowIndex; i++) {\n            if (header.ownerTable.getSplitWidgets()[0].childWidgets.length === 0) {\n                return;\n            }\n            var row = header.ownerTable.getSplitWidgets()[0].childWidgets[0];\n            var headerWidget = row.clone();\n            headerWidget.containerWidget = row.containerWidget;\n            // tslint:disable-next-line:max-line-length\n            page.viewer.updateClientAreaLocation(headerWidget, new Rect(page.viewer.clientArea.x, top, headerWidget.width, headerWidget.height));\n            page.viewer.layout.updateChildLocationForRow(top, headerWidget);\n            var cell = undefined;\n            //Renders table cell outline rectangle - Border and background color.\n            for (var j = 0; j < headerWidget.childWidgets.length; j++) {\n                cell = headerWidget.childWidgets[j];\n                this.renderTableCellWidget(page, cell);\n            }\n            top += headerWidget.height;\n        }\n        if (widget.y !== top) {\n            //this.Location.Y = top;\n            page.viewer.layout.updateChildLocationForTable(top, widget);\n        }\n    };\n    /**\n     * Renders paragraph widget.\n     * @param {Page} page\n     * @param {ParagraphWidget} paraWidget\n     */\n    Renderer.prototype.renderParagraphWidget = function (page, paraWidget) {\n        var top = paraWidget.y;\n        var left = paraWidget.x;\n        for (var i = 0; i < paraWidget.childWidgets.length; i++) {\n            var widget = paraWidget.childWidgets[i];\n            this.renderLine(widget, page, left, top);\n            top += widget.height;\n        }\n    };\n    /**\n     * Renders table widget.\n     * @param {Page} page\n     * @param {TableWidget} tableWidget\n     */\n    Renderer.prototype.renderTableWidget = function (page, tableWidget) {\n        for (var i = 0; i < tableWidget.childWidgets.length; i++) {\n            var widget = tableWidget.childWidgets[i];\n            this.renderTableRowWidget(page, widget);\n            if (tableWidget.tableFormat.cellSpacing > 0) {\n                this.renderTableOutline(tableWidget);\n            }\n        }\n    };\n    /**\n     * Renders table row widget.\n     * @param {Page} page\n     * @param {Widget} rowWidget\n     */\n    Renderer.prototype.renderTableRowWidget = function (page, rowWidget) {\n        for (var i = 0; i < rowWidget.childWidgets.length; i++) {\n            var widget = rowWidget.childWidgets[i];\n            this.renderTableCellWidget(page, widget);\n        }\n    };\n    /**\n     * Renders table cell widget.\n     * @param {Page} page\n     * @param {TableCellWidget} cellWidget\n     */\n    Renderer.prototype.renderTableCellWidget = function (page, cellWidget) {\n        if (!this.isPrinting) {\n            if (this.getScaledValue(cellWidget.y, 2) + cellWidget.height * this.viewer.zoomFactor < 0 ||\n                this.getScaledValue(cellWidget.y, 2) > this.viewer.visibleBounds.height) {\n                return;\n            }\n        }\n        var widgetHeight = 0;\n        if (!this.isPrinting && page.viewer.owner.selection && page.viewer.owner.selection.selectedWidgets.length > 0) {\n            page.viewer.owner.selection.addSelectionHighlightTable(this.selectionContext, cellWidget);\n        }\n        this.renderTableCellOutline(page.viewer, cellWidget);\n        for (var i = 0; i < cellWidget.childWidgets.length; i++) {\n            var widget = cellWidget.childWidgets[i];\n            var width = cellWidget.width + cellWidget.margin.left - cellWidget.leftBorderWidth;\n            this.clipRect(cellWidget.x, cellWidget.y, this.getScaledValue(width), this.getScaledValue(cellWidget.height));\n            this.renderWidget(page, widget);\n            this.pageContext.restore();\n        }\n    };\n    /**\n     * Renders line widget.\n     * @param {LineWidget} lineWidget\n     * @param {Page} page\n     * @param {number} left\n     * @param {number} top\n     */\n    Renderer.prototype.renderLine = function (lineWidget, page, left, top) {\n        if (!this.isPrinting && page.viewer.owner.selection && page.viewer.owner.selection.selectedWidgets.length > 0) {\n            page.viewer.owner.selection.addSelectionHighlight(this.selectionContext, lineWidget, top);\n        }\n        if (lineWidget.isFirstLine()) {\n            left += HelperMethods.convertPointToPixel(lineWidget.paragraph.paragraphFormat.firstLineIndent);\n        }\n        if (this.viewer.owner.searchModule) {\n            // tslint:disable-next-line:max-line-length\n            if (!isNullOrUndefined(page.viewer.owner.searchModule.searchHighlighters) && page.viewer.owner.searchModule.searchHighlighters.containsKey(lineWidget)) {\n                var widgetInfo = page.viewer.owner.searchModule.searchHighlighters.get(lineWidget);\n                for (var i = 0; i < widgetInfo.length; i++) {\n                    this.pageContext.fillStyle = '#ffe97f';\n                    // tslint:disable-next-line:max-line-length\n                    this.pageContext.fillRect(this.getScaledValue(widgetInfo[i].left, 1), this.getScaledValue(top, 2), this.getScaledValue(widgetInfo[i].width), this.getScaledValue(lineWidget.height));\n                }\n            }\n        }\n        for (var i = 0; i < lineWidget.children.length; i++) {\n            var elementBox = lineWidget.children[i];\n            if (elementBox instanceof FieldElementBox || this.isFieldCode ||\n                (elementBox.width === 0 && elementBox.height === 0)) {\n                if (this.isFieldCode) {\n                    elementBox.width = 0;\n                }\n                left += elementBox.width + elementBox.margin.left;\n                this.toSkipFieldCode(elementBox);\n                continue;\n            }\n            var underlineY = this.getUnderlineYPosition(lineWidget);\n            if (!this.isPrinting) {\n                if (this.getScaledValue(top + elementBox.margin.top, 2) + elementBox.height * this.viewer.zoomFactor < 0 ||\n                    this.getScaledValue(top + elementBox.margin.top, 2) > this.viewer.visibleBounds.height) {\n                    left += elementBox.width + elementBox.margin.left;\n                    continue;\n                }\n            }\n            if (elementBox instanceof ListTextElementBox) {\n                this.renderListTextElementBox(elementBox, left, top, underlineY);\n            }\n            else if (elementBox instanceof ImageElementBox) {\n                this.renderImageElementBox(elementBox, left, top, underlineY);\n            }\n            else {\n                this.renderTextElementBox(elementBox, left, top, underlineY);\n            }\n            left += elementBox.width + elementBox.margin.left;\n        }\n    };\n    Renderer.prototype.toSkipFieldCode = function (element) {\n        if (element instanceof FieldElementBox) {\n            if (element.fieldType === 0) {\n                if ((!isNullOrUndefined(element.fieldEnd) || element.hasFieldEnd)) {\n                    this.isFieldCode = true;\n                }\n            }\n            else if (element.fieldType === 2 || element.fieldType === 1) {\n                this.isFieldCode = false;\n            }\n        }\n    };\n    /**\n     * Gets underline y position.\n     * @param {LineWidget} lineWidget\n     */\n    Renderer.prototype.getUnderlineYPosition = function (lineWidget) {\n        var height = 0;\n        var lineHeight = 0;\n        for (var i = 0; i < lineWidget.children.length; i++) {\n            if (lineWidget.children[i] instanceof FieldElementBox ||\n                (lineWidget.children[i].width === 0 && lineWidget.children[i].height === 0)) {\n                continue;\n            }\n            if (height < lineWidget.children[i].height + lineWidget.children[i].margin.top) {\n                height = lineWidget.children[i].margin.top + lineWidget.children[i].height;\n                lineHeight = lineWidget.children[i].height / 20;\n            }\n        }\n        return height - 2 * lineHeight;\n    };\n    /**\n     * Renders list element box\n     * @param {ListTextElementBox} elementBox\n     * @param {number} left\n     * @param {number} top\n     * @param {number} underlineY\n     */\n    Renderer.prototype.renderListTextElementBox = function (elementBox, left, top, underlineY) {\n        var topMargin = elementBox.margin.top;\n        var leftMargin = elementBox.margin.left;\n        var format = elementBox.listLevel.characterFormat;\n        var breakCharacterFormat = elementBox.line.paragraph.characterFormat;\n        var color = format.fontColor === '#000000' ? breakCharacterFormat.fontColor : format.fontColor;\n        this.pageContext.textBaseline = 'top';\n        var bold = '';\n        var italic = '';\n        var fontFamily = format.fontFamily === 'Verdana' ? breakCharacterFormat.fontFamily : format.fontFamily;\n        var fontSize = format.fontSize === 11 ? breakCharacterFormat.fontSize : format.fontSize;\n        // tslint:disable-next-line:max-line-length\n        var baselineAlignment = format.baselineAlignment === 'Normal' ? breakCharacterFormat.baselineAlignment : format.baselineAlignment;\n        bold = format.bold ? 'bold' : breakCharacterFormat.bold ? 'bold' : '';\n        italic = format.italic ? 'italic' : breakCharacterFormat.italic ? 'italic' : '';\n        fontSize = fontSize === 0 ? 0.5 : fontSize / (baselineAlignment === 'Normal' ? 1 : 1.5);\n        var strikethrough = format.strikethrough === 'None' ? breakCharacterFormat.strikethrough : format.strikethrough;\n        var highlightColor = format.highlightColor === 'NoColor' ? breakCharacterFormat.highlightColor :\n            format.highlightColor;\n        if (highlightColor !== 'NoColor') {\n            if (highlightColor.substring(0, 1) !== '#') {\n                this.pageContext.fillStyle = HelperMethods.getHighlightColorCode(highlightColor);\n            }\n            else {\n                this.pageContext.fillStyle = this.getColor(highlightColor);\n            }\n            // tslint:disable-next-line:max-line-length\n            this.pageContext.fillRect(this.getScaledValue(left + leftMargin, 1), this.getScaledValue(top + topMargin, 2), this.getScaledValue(elementBox.width), this.getScaledValue(elementBox.height));\n        }\n        this.pageContext.font = bold + ' ' + italic + ' ' + fontSize * this.viewer.zoomFactor + 'pt' + ' ' + fontFamily;\n        if (baselineAlignment === 'Subscript') {\n            topMargin += elementBox.height - elementBox.height / 1.5;\n        }\n        this.pageContext.fillStyle = this.getColor(color);\n        // tslint:disable-next-line:max-line-length\n        this.pageContext.fillText(elementBox.text, this.getScaledValue(left + leftMargin, 1), this.getScaledValue(top + topMargin, 2), this.getScaledValue(elementBox.width));\n        if (format.underline !== 'None' && !isNullOrUndefined(format.underline)) {\n            this.renderUnderline(elementBox, left, top, underlineY, color, format.underline, baselineAlignment);\n        }\n        if (strikethrough !== 'None') {\n            this.renderStrikeThrough(elementBox, left, top, format.strikethrough, color, baselineAlignment);\n        }\n    };\n    /**\n     * Renders text element box.\n     * @param {TextElementBox} elementBox\n     * @param {number} left\n     * @param {number} top\n     * @param {number} underlineY\n     */\n    // tslint:disable-next-line:max-line-length\n    Renderer.prototype.renderTextElementBox = function (elementBox, left, top, underlineY) {\n        var isHeightType = false;\n        var containerWidget = elementBox.line.paragraph.containerWidget;\n        if (containerWidget instanceof TableCellWidget) {\n            isHeightType = (containerWidget.ownerRow.rowFormat.heightType === 'Exactly');\n        }\n        var topMargin = elementBox.margin.top;\n        var leftMargin = elementBox.margin.left;\n        if (isHeightType) {\n            // tslint:disable-next-line:max-line-length\n            this.clipRect(containerWidget.x, containerWidget.y, this.getScaledValue(containerWidget.width), this.getScaledValue(containerWidget.height));\n        }\n        var format = elementBox.characterFormat;\n        if (format.highlightColor !== 'NoColor') {\n            if (format.highlightColor.substring(0, 1) !== '#') {\n                this.pageContext.fillStyle = HelperMethods.getHighlightColorCode(format.highlightColor);\n            }\n            else {\n                this.pageContext.fillStyle = this.getColor(format.highlightColor);\n            }\n            // tslint:disable-next-line:max-line-length\n            this.pageContext.fillRect(this.getScaledValue(left + leftMargin, 1), this.getScaledValue(top + topMargin, 2), this.getScaledValue(elementBox.width), this.getScaledValue(elementBox.height));\n        }\n        var color = format.fontColor;\n        this.pageContext.textBaseline = 'top';\n        var bold = '';\n        var italic = '';\n        var fontSize = 11;\n        bold = format.bold ? 'bold' : '';\n        italic = format.italic ? 'italic' : '';\n        fontSize = format.fontSize === 0 ? 0.5 : format.fontSize / (format.baselineAlignment === 'Normal' ? 1 : 1.5);\n        this.pageContext.font = bold + ' ' + italic + ' ' + fontSize * this.viewer.zoomFactor + 'pt' + ' ' + format.fontFamily;\n        if (format.baselineAlignment === 'Subscript') {\n            topMargin += elementBox.height - elementBox.height / 1.5;\n        }\n        this.pageContext.fillStyle = this.getColor(color);\n        var scaledWidth = this.getScaledValue(elementBox.width);\n        var text = elementBox.text;\n        // tslint:disable-next-line:max-line-length\n        if (elementBox instanceof TabElementBox) {\n            var tabElement = elementBox;\n            if (tabElement.tabText === '' && !isNullOrUndefined(tabElement.tabLeader) && tabElement.tabLeader !== 'None') {\n                text = this.getTabLeader(elementBox);\n                tabElement.tabText = text;\n            }\n            else if (tabElement.tabText !== '') {\n                text = tabElement.tabText;\n            }\n        }\n        // tslint:disable-next-line:max-line-length\n        this.pageContext.fillText(text, this.getScaledValue(left + leftMargin, 1), this.getScaledValue(top + topMargin, 2), scaledWidth);\n        if (format.underline !== 'None' && !isNullOrUndefined(format.underline)) {\n            // tslint:disable-next-line:max-line-length\n            this.renderUnderline(elementBox, left, top, underlineY, color, format.underline, format.baselineAlignment);\n        }\n        if (format.strikethrough !== 'None' && !isNullOrUndefined(format.strikethrough)) {\n            this.renderStrikeThrough(elementBox, left, top, format.strikethrough, color, format.baselineAlignment);\n        }\n        if (isHeightType) {\n            this.pageContext.restore();\n        }\n    };\n    /**\n     * Returns tab leader\n     */\n    Renderer.prototype.getTabLeader = function (elementBox) {\n        var textWidth = 0;\n        var tabString = this.getTabLeaderString(elementBox.tabLeader);\n        var tabText = tabString;\n        textWidth = this.viewer.textHelper.getWidth(tabText, elementBox.characterFormat);\n        var count = Math.floor(elementBox.width / textWidth);\n        for (var i = 0; i <= count; i++) {\n            tabText += tabString;\n        }\n        return tabText.slice(0, -1);\n    };\n    /**\n     * Returns tab leader string.\n     */\n    Renderer.prototype.getTabLeaderString = function (tabLeader) {\n        var tabString = '';\n        switch (tabLeader) {\n            case 'Dot':\n                tabString = '.';\n                break;\n            case 'Hyphen':\n                tabString = '-';\n                break;\n            case 'Underscore':\n                tabString = '_';\n                break;\n        }\n        return tabString;\n    };\n    /**\n     * Clips the rectangle with specified position.\n     * @param {number} xPos\n     * @param {number} yPos\n     * @param {number} width\n     * @param {number} height\n     */\n    Renderer.prototype.clipRect = function (xPos, yPos, width, height) {\n        this.pageContext.beginPath();\n        this.pageContext.save();\n        this.pageContext.rect(this.getScaledValue(xPos, 1), this.getScaledValue(yPos, 2), width, height);\n        this.pageContext.clip();\n    };\n    /**\n     * Renders underline.\n     * @param {ElementBox} elementBox\n     * @param {number} left\n     * @param {number} top\n     * @param {number} underlineY\n     * @param {string} color\n     * @param {Underline} underline\n     * @param {BaselineAlignment} baselineAlignment\n     */\n    // tslint:disable-next-line:max-line-length\n    Renderer.prototype.renderUnderline = function (elementBox, left, top, underlineY, color, underline, baselineAlignment) {\n        var renderedHeight = elementBox.height / (baselineAlignment === 'Normal' ? 1 : 1.5);\n        var topMargin = elementBox.margin.top;\n        var underlineHeight = renderedHeight / 20;\n        var y = 0;\n        if (baselineAlignment === 'Subscript' || elementBox instanceof ListTextElementBox) {\n            y = (renderedHeight - 2 * underlineHeight) + top;\n            topMargin += elementBox.height - renderedHeight;\n            y += topMargin > 0 ? topMargin : 0;\n        }\n        else {\n            y = underlineY + top;\n        }\n        // tslint:disable-next-line:max-line-length\n        this.pageContext.fillRect(this.getScaledValue(left + elementBox.margin.left, 1), this.getScaledValue(y, 2), this.getScaledValue(elementBox.width), this.getScaledValue(underlineHeight));\n    };\n    /**\n     * Renders strike through.\n     * @param {ElementBox} elementBox\n     * @param {number} left\n     * @param {number} top\n     * @param {Strikethrough} strikethrough\n     * @param {string} color\n     * @param {BaselineAlignment} baselineAlignment\n     */\n    // tslint:disable-next-line:max-line-length\n    Renderer.prototype.renderStrikeThrough = function (elementBox, left, top, strikethrough, color, baselineAlignment) {\n        var renderedHeight = elementBox.height / (baselineAlignment === 'Normal' ? 1 : 1.5);\n        var topMargin = elementBox.margin.top;\n        if (baselineAlignment === 'Subscript') {\n            topMargin += elementBox.height - renderedHeight;\n        }\n        top += topMargin > 0 ? topMargin : 0;\n        var lineHeight = renderedHeight / 20;\n        var y = (renderedHeight / 2) + (0.5 * lineHeight);\n        var lineCount = 0;\n        if (strikethrough === 'DoubleStrike') {\n            y -= lineHeight;\n        }\n        while (lineCount < (strikethrough === 'DoubleStrike' ? 2 : 1)) {\n            lineCount++;\n            // tslint:disable-next-line:max-line-length\n            this.pageContext.fillRect(this.getScaledValue(left + elementBox.margin.left, 1), this.getScaledValue(y + top, 2), this.getScaledValue(elementBox.width), this.getScaledValue(lineHeight));\n            y += 2 * lineHeight;\n        }\n    };\n    /**\n     * Renders image element box.\n     * @param {ImageElementBox} elementBox\n     * @param {number} left\n     * @param {number} top\n     * @param {number} underlineY\n     */\n    // tslint:disable-next-line:max-line-length\n    Renderer.prototype.renderImageElementBox = function (elementBox, left, top, underlineY) {\n        var topMargin = elementBox.margin.top;\n        var leftMargin = elementBox.margin.left;\n        var color = 'black';\n        this.pageContext.textBaseline = 'top';\n        var widgetWidth = 0;\n        var isClipped = false;\n        if (topMargin < 0 || elementBox.line.paragraph.width < elementBox.width) {\n            var containerWid = elementBox.line.paragraph.containerWidget;\n            // if (containerWid instanceof BodyWidget) {\n            //     widgetWidth = containerWid.width + containerWid.x;\n            // } else \n            if (containerWid instanceof TableCellWidget) {\n                var leftIndent = 0;\n                if (containerWid.childWidgets[0] instanceof ParagraphWidget) {\n                    var paraAdv = containerWid.childWidgets[0];\n                    leftIndent = paraAdv.paragraphFormat.leftIndent;\n                }\n                widgetWidth = containerWid.width + containerWid.margin.left - containerWid.leftBorderWidth - leftIndent;\n                isClipped = true;\n                // tslint:disable-next-line:max-line-length\n                this.clipRect(left + leftMargin, top + topMargin, this.getScaledValue(widgetWidth), this.getScaledValue(containerWid.height));\n            }\n        }\n        if (elementBox.isMetaFile) {\n            /* tslint:disable:no-empty */\n        }\n        else {\n            // tslint:disable-next-line:max-line-length\n            this.pageContext.drawImage(elementBox.element, this.getScaledValue(left + leftMargin, 1), this.getScaledValue(top + topMargin, 2), this.getScaledValue(elementBox.width), this.getScaledValue(elementBox.height));\n        }\n        if (isClipped) {\n            this.pageContext.restore();\n        }\n    };\n    /**\n     * Renders table outline.\n     * @param {TableWidget} tableWidget\n     */\n    Renderer.prototype.renderTableOutline = function (tableWidget) {\n        var layout = new Layout(this.viewer);\n        var table = tableWidget;\n        tableWidget.width = this.viewer.layout.getTableWidth(table);\n        var border = layout.getTableTopBorder(table.tableFormat.borders);\n        var lineWidth = 0;\n        //ToDo: Need to draw the borders based on the line style.\n        // if (!isNullOrUndefined(border )) {\n        lineWidth = HelperMethods.convertPointToPixel(border.getLineWidth());\n        // tslint:disable-next-line:max-line-length\n        this.renderSingleBorder(border, tableWidget.x - tableWidget.margin.left - lineWidth / 2, tableWidget.y, tableWidget.x - tableWidget.margin.left - lineWidth / 2, tableWidget.y + tableWidget.height, lineWidth);\n        // }\n        border = layout.getTableTopBorder(table.tableFormat.borders);\n        lineWidth = 0;\n        // if (!isNullOrUndefined(border )) {\n        lineWidth = HelperMethods.convertPointToPixel(border.getLineWidth());\n        // tslint:disable-next-line:max-line-length\n        this.renderSingleBorder(border, tableWidget.x - tableWidget.margin.left - lineWidth, tableWidget.y - lineWidth / 2, tableWidget.x + tableWidget.width + lineWidth + tableWidget.margin.right, tableWidget.y - lineWidth / 2, lineWidth);\n        // }\n        border = layout.getTableRightBorder(table.tableFormat.borders);\n        lineWidth = 0;\n        // if (!isNullOrUndefined(border )) {\n        lineWidth = HelperMethods.convertPointToPixel(border.getLineWidth());\n        // tslint:disable-next-line:max-line-length\n        this.renderSingleBorder(border, tableWidget.x + tableWidget.width + tableWidget.margin.right + lineWidth / 2, tableWidget.y, tableWidget.x + tableWidget.width + tableWidget.margin.right + lineWidth / 2, tableWidget.y + tableWidget.height, lineWidth);\n        // }\n        border = layout.getTableBottomBorder(table.tableFormat.borders);\n        lineWidth = 0;\n        // if (!isNullOrUndefined(border )) {\n        lineWidth = HelperMethods.convertPointToPixel(border.getLineWidth());\n        // tslint:disable-next-line:max-line-length\n        this.renderSingleBorder(border, tableWidget.x - tableWidget.margin.left - lineWidth, tableWidget.y + tableWidget.height - lineWidth / 2, tableWidget.x + tableWidget.width + lineWidth + tableWidget.margin.right, tableWidget.y + tableWidget.height - lineWidth / 2, lineWidth);\n        // }\n    };\n    /**\n     * Renders table cell outline.\n     * @param {LayoutViewer} viewer\n     * @param {TableCellWidget} cellWidget\n     */\n    Renderer.prototype.renderTableCellOutline = function (viewer, cellWidget) {\n        var layout = viewer.layout;\n        var borders = undefined;\n        var tableCell = cellWidget;\n        var cellTopMargin = 0;\n        var cellBottomMargin = 0;\n        var cellLeftMargin = 0;\n        var cellRightMargin = 0;\n        var height = 0;\n        borders = tableCell.cellFormat.borders;\n        if (cellWidget.containerWidget instanceof TableRowWidget) {\n            cellBottomMargin = cellWidget.margin.bottom - cellWidget.containerWidget.bottomBorderWidth;\n            cellTopMargin = cellWidget.margin.top - cellWidget.containerWidget.topBorderWidth;\n        }\n        cellLeftMargin = cellWidget.margin.left - cellWidget.leftBorderWidth;\n        cellRightMargin = cellWidget.margin.right - cellWidget.rightBorderWidth;\n        if (!isNullOrUndefined(tableCell.ownerRow) && tableCell.ownerRow.rowFormat.heightType === 'Exactly') {\n            height = HelperMethods.convertPointToPixel(tableCell.ownerRow.rowFormat.height) + cellTopMargin + cellBottomMargin;\n        }\n        else {\n            if (!isNullOrUndefined(tableCell.ownerRow) && [tableCell.ownerRow].length <= 1) {\n                // tslint:disable-next-line:max-line-length\n                height = Math.max(HelperMethods.convertPointToPixel(tableCell.ownerRow.rowFormat.height), cellWidget.height) + cellTopMargin + cellBottomMargin;\n            }\n            else {\n                height = cellWidget.height + cellTopMargin + cellBottomMargin;\n            }\n        }\n        this.renderCellBackground(height, cellWidget);\n        var border = TableCellWidget.getCellLeftBorder(tableCell);\n        var lineWidth = 0;\n        // if (!isNullOrUndefined(border )) {       \n        lineWidth = HelperMethods.convertPointToPixel(border.getLineWidth()); //Renders the cell left border.\n        // tslint:disable-next-line:max-line-length\n        this.renderSingleBorder(border, cellWidget.x - cellLeftMargin - lineWidth, cellWidget.y - cellTopMargin, cellWidget.x - cellLeftMargin - lineWidth, cellWidget.y + cellWidget.height + cellBottomMargin, lineWidth);\n        // }\n        border = TableCellWidget.getCellTopBorder(tableCell);\n        // if (!isNullOrUndefined(border )) { //Renders the cell top border.        \n        lineWidth = HelperMethods.convertPointToPixel(border.getLineWidth());\n        // tslint:disable-next-line:max-line-length\n        this.renderSingleBorder(border, cellWidget.x - cellWidget.margin.left, cellWidget.y - cellWidget.margin.top + lineWidth / 2, cellWidget.x + cellWidget.width + cellWidget.margin.right, cellWidget.y - cellWidget.margin.top + lineWidth / 2, lineWidth);\n        // }\n        if (tableCell.ownerTable.tableFormat.cellSpacing > 0 || tableCell.cellIndex === tableCell.ownerRow.childWidgets.length - 1) {\n            border = TableCellWidget.getCellRightBorder(tableCell);\n            // if (!isNullOrUndefined(border )) { //Renders the cell right border.           \n            lineWidth = HelperMethods.convertPointToPixel(border.getLineWidth());\n            // tslint:disable-next-line:max-line-length\n            this.renderSingleBorder(border, cellWidget.x + cellWidget.width + cellWidget.margin.right - lineWidth / 2, cellWidget.y - cellTopMargin, cellWidget.x + cellWidget.width + cellWidget.margin.right - lineWidth / 2, cellWidget.y + cellWidget.height + cellBottomMargin, lineWidth);\n            // }\n        }\n        var nextRow = tableCell.ownerRow.nextWidget;\n        //Specifies the next row is within the current table widget.\n        //True means current row is not rendered at page end; Otherwise False.\n        var nextRowIsInCurrentTableWidget = false;\n        if (!isNullOrUndefined(nextRow)) {\n            var nextRowWidget = undefined;\n            // if (viewer.renderedElements.containsKey(nextRow) && viewer.renderedElements.get(nextRow).length > 0) {\n            nextRowWidget = nextRow;\n            // }\n            if (nextRowWidget instanceof TableRowWidget) {\n                // tslint:disable-next-line:max-line-length\n                if (cellWidget.containerWidget instanceof TableRowWidget && cellWidget.containerWidget.containerWidget instanceof TableWidget) {\n                    nextRowIsInCurrentTableWidget = cellWidget.containerWidget.containerWidget.childWidgets.indexOf(nextRowWidget) !== -1;\n                }\n            }\n        }\n        if (tableCell.ownerTable.tableFormat.cellSpacing > 0 || tableCell.ownerRow.rowIndex === tableCell.ownerTable.childWidgets.length - 1\n            || (tableCell.cellFormat.rowSpan > 1\n                && tableCell.ownerRow.rowIndex + tableCell.cellFormat.rowSpan === tableCell.ownerTable.childWidgets.length) ||\n            !nextRowIsInCurrentTableWidget) {\n            // tslint:disable-next-line:max-line-length\n            border = (tableCell.cellFormat.rowSpan > 1 && tableCell.ownerRow.rowIndex + tableCell.cellFormat.rowSpan === tableCell.ownerTable.childWidgets.length) ?\n                //true part for vertically merged cells specifically.\n                tableCell.getBorderBasedOnPriority(tableCell.cellFormat.borders.bottom, TableCellWidget.getCellBottomBorder(tableCell))\n                //false part for remaining cases that has been handled inside method. \n                : TableCellWidget.getCellBottomBorder(tableCell);\n            // if (!isNullOrUndefined(border )) {\n            //Renders the cell bottom border.\n            lineWidth = HelperMethods.convertPointToPixel(border.getLineWidth());\n            // tslint:disable-next-line:max-line-length\n            this.renderSingleBorder(border, cellWidget.x - cellWidget.margin.left, cellWidget.y + cellWidget.height + cellBottomMargin + lineWidth / 2, cellWidget.x + cellWidget.width + cellWidget.margin.right, cellWidget.y + cellWidget.height + cellBottomMargin + lineWidth / 2, lineWidth);\n            // }\n        }\n        border = layout.getCellDiagonalUpBorder(tableCell);\n        // if (!isNullOrUndefined(border )) {\n        //Renders the cell diagonal up border.\n        lineWidth = HelperMethods.convertPointToPixel(border.getLineWidth());\n        if (lineWidth > 0) {\n            // tslint:disable-next-line:max-line-length\n            this.renderSingleBorder(border, cellWidget.x - cellLeftMargin, cellWidget.y + cellWidget.height + cellBottomMargin, cellWidget.x + cellWidget.width + cellRightMargin, cellWidget.y - cellTopMargin, lineWidth);\n            // }\n        }\n        border = layout.getCellDiagonalDownBorder(tableCell);\n        // if (!isNullOrUndefined(border )) {\n        //Renders the cell diagonal down border.\n        lineWidth = HelperMethods.convertPointToPixel(border.getLineWidth());\n        if (lineWidth > 0) {\n            // tslint:disable-next-line:max-line-length\n            this.renderSingleBorder(border, cellWidget.x - cellLeftMargin, cellWidget.y - cellTopMargin, cellWidget.x + cellWidget.width + cellRightMargin, cellWidget.y + cellWidget.height + cellBottomMargin, lineWidth);\n        }\n        // }\n    };\n    /**\n     * Renders cell background.\n     * @param {number} height\n     * @param {TableCellWidget} cellWidget\n     */\n    Renderer.prototype.renderCellBackground = function (height, cellWidget) {\n        var cellFormat = cellWidget.cellFormat;\n        var bgColor = cellFormat.shading.backgroundColor === '#ffffff' ?\n            cellWidget.ownerTable.tableFormat.shading.backgroundColor : cellFormat.shading.backgroundColor;\n        this.pageContext.beginPath();\n        if (bgColor !== 'empty') {\n            this.pageContext.fillStyle = this.getColor(bgColor);\n            var left = cellWidget.x - cellWidget.margin.left + cellWidget.leftBorderWidth;\n            var top_1 = cellWidget.y - HelperMethods.convertPointToPixel(cellWidget.topMargin);\n            // tslint:disable-next-line:max-line-length\n            var width = cellWidget.width + cellWidget.margin.left + cellWidget.margin.right - cellWidget.leftBorderWidth - cellWidget.rightBorderWidth;\n            // tslint:disable-next-line:max-line-length\n            this.pageContext.fillRect(this.getScaledValue(left, 1), this.getScaledValue(top_1, 2), this.getScaledValue(width), this.getScaledValue(height));\n            this.pageContext.closePath();\n        }\n    };\n    /**\n     * Renders single border.\n     * @param {WBorder} border\n     * @param {number} startX\n     * @param {number} startY\n     * @param {number} endX\n     * @param {number} endY\n     * @param {number} lineWidth\n     */\n    // tslint:disable-next-line:max-line-length\n    Renderer.prototype.renderSingleBorder = function (border, startX, startY, endX, endY, lineWidth) {\n        this.pageContext.beginPath();\n        this.pageContext.moveTo(this.getScaledValue(startX, 1), this.getScaledValue(startY, 2));\n        this.pageContext.lineTo(this.getScaledValue(endX, 1), this.getScaledValue(endY, 2));\n        this.pageContext.lineWidth = this.getScaledValue(lineWidth);\n        // set line color\n        this.pageContext.strokeStyle = border.color;\n        if (lineWidth > 0) {\n            this.pageContext.stroke();\n        }\n        this.pageContext.closePath();\n    };\n    /**\n     * Gets scaled value.\n     * @param {number} value\n     * @param {number} type\n     * @private\n     */\n    Renderer.prototype.getScaledValue = function (value, type) {\n        if (this.isPrinting) {\n            return value;\n        }\n        if (isNullOrUndefined(type)) {\n            type = 0;\n        }\n        var x = value * this.viewer.zoomFactor;\n        return x + (type === 1 ? this.pageLeft : (type === 2 ? this.pageTop : 0));\n    };\n    /**\n     * Destroys the internal objects which is maintained.\n     */\n    Renderer.prototype.destroy = function () {\n        this.viewer = undefined;\n        if (!isNullOrUndefined(this.pageCanvasIn)) {\n            this.pageCanvasIn.innerHTML = '';\n        }\n        this.pageCanvasIn = undefined;\n    };\n    return Renderer;\n}());\nexport { Renderer };\n","import { isNullOrUndefined } from '@syncfusion/ej2-base';\nimport { WCharacterFormat } from '../index';\nimport { HelperMethods } from '../editor/editor-helper';\n/**\n * @private\n */\nvar TextHelper = /** @class */ (function () {\n    function TextHelper(viewer) {\n        this.owner = viewer;\n        if (!isNullOrUndefined(viewer)) {\n            this.context = viewer.containerContext;\n        }\n    }\n    Object.defineProperty(TextHelper.prototype, \"paragraphMark\", {\n        get: function () {\n            return '¶';\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(TextHelper.prototype, \"lineBreakMark\", {\n        get: function () {\n            return '↲';\n        },\n        enumerable: true,\n        configurable: true\n    });\n    /**\n     * @private\n     */\n    TextHelper.prototype.getParagraphMarkWidth = function (characterFormat) {\n        return this.getWidth(this.paragraphMark, characterFormat);\n    };\n    /**\n     * @private\n     */\n    TextHelper.prototype.getParagraphMarkSize = function (characterFormat) {\n        // Gets the text element's width;\n        var width = this.getWidth(this.paragraphMark, characterFormat);\n        var height = 0;\n        var baselineOffset = 0;\n        // Calculate the text element's height and baseline offset.\n        var textHelper = this.getHeight(characterFormat);\n        return {\n            'Width': width, 'Height': textHelper.Height, 'BaselineOffset': textHelper.BaselineOffset\n        };\n    };\n    /**\n     * @private\n     */\n    TextHelper.prototype.getTextSize = function (elementBox, characterFormat) {\n        // Gets the text element's width;\n        var textTrimEndWidth = 0;\n        textTrimEndWidth = this.getWidth(elementBox.text, characterFormat);\n        elementBox.width = textTrimEndWidth;\n        // Calculate the text element's height and baseline offset.\n        var textHelper = this.getHeight(characterFormat);\n        elementBox.height = textHelper.Height;\n        elementBox.baselineOffset = textHelper.BaselineOffset;\n        if (elementBox.text[elementBox.text.length - 1] === ' ') {\n            textTrimEndWidth = this.getWidth(HelperMethods.trimEnd(elementBox.text), characterFormat);\n        }\n        return textTrimEndWidth;\n    };\n    /**\n     * @private\n     */\n    TextHelper.prototype.getHeight = function (characterFormat) {\n        // Get character format property as  below predefined structure to make it easy to check and retrieve\n        // Predefined static structure `[FontName];[FontSize];bold;italic` to maintain as key in the collection \n        var key = this.getFormatText(characterFormat);\n        if (!isNullOrUndefined(this.owner.heightInfoCollection[key])) {\n            return this.owner.heightInfoCollection[key];\n        }\n        var sizeInfo = this.getHeightInternal(characterFormat);\n        this.owner.heightInfoCollection[key] = sizeInfo;\n        return sizeInfo;\n    };\n    /**\n     * @private\n     */\n    TextHelper.prototype.getFormatText = function (characterFormat) {\n        var formatText = characterFormat.fontFamily.toLocaleLowerCase();\n        formatText += ';' + characterFormat.fontSize;\n        if (characterFormat.bold) {\n            formatText += ';' + 'bold';\n        }\n        if (characterFormat.italic) {\n            formatText += ';' + 'italic';\n        }\n        return formatText;\n    };\n    /**\n     * @private\n     */\n    TextHelper.prototype.getHeightInternal = function (characterFormat) {\n        var textHeight = 0;\n        var baselineOffset = 0;\n        var spanElement = document.createElement('span');\n        spanElement.id = 'tempSpan';\n        spanElement.style.whiteSpace = 'nowrap';\n        spanElement.innerText = 'm';\n        this.applyStyle(spanElement, characterFormat);\n        var body = document.getElementsByTagName('body');\n        var parentDiv = document.createElement('div');\n        parentDiv.style.display = 'inline-block';\n        var tempDiv = document.createElement('div');\n        tempDiv.setAttribute('style', 'display:inline-block;width: 1px; height: 0px;vertical-align: baseline;');\n        parentDiv.appendChild(spanElement);\n        parentDiv.appendChild(tempDiv);\n        document.body.appendChild(parentDiv);\n        // Sets the text element's height.\n        textHeight = spanElement.offsetHeight;\n        // Calculate the text element's baseline offset.\n        var textTopVal = spanElement.offsetTop;\n        var tempDivTopVal = tempDiv.offsetTop;\n        baselineOffset = tempDivTopVal - textTopVal;\n        document.body.removeChild(parentDiv);\n        return { 'Height': textHeight, 'BaselineOffset': baselineOffset };\n    };\n    /**\n     * @private\n     */\n    TextHelper.prototype.measureTextExcludingSpaceAtEnd = function (text, characterFormat) {\n        return this.getWidth(HelperMethods.trimEnd(text), characterFormat);\n    };\n    /**\n     * @private\n     */\n    TextHelper.prototype.getWidth = function (text, characterFormat) {\n        if (text.match('\\v')) {\n            text.replace('\\v', this.lineBreakMark);\n        }\n        var bold = '';\n        var italic = '';\n        var fontFamily = '';\n        var fontSize = characterFormat.fontSize;\n        bold = characterFormat.bold ? 'bold' : '';\n        italic = characterFormat.italic ? 'italic' : '';\n        fontFamily = characterFormat.fontFamily;\n        fontSize = fontSize === 0 ? 0.5 : fontSize / (characterFormat.baselineAlignment === 'Normal' ? 1 : 1.5);\n        this.context.font = bold + ' ' + italic + ' ' + fontSize + 'pt' + ' ' + fontFamily;\n        return this.context.measureText(text).width;\n    };\n    /**\n     * @private\n     */\n    TextHelper.prototype.applyStyle = function (spanElement, characterFormat) {\n        if (!isNullOrUndefined(spanElement) && !isNullOrUndefined(characterFormat)) {\n            if (characterFormat.fontFamily !== '') {\n                spanElement.style.fontFamily = characterFormat.fontFamily;\n            }\n            var fontSize = characterFormat.fontSize;\n            if (fontSize <= 0.5) {\n                fontSize = 0.5;\n            }\n            spanElement.style.fontSize = fontSize.toString() + 'pt';\n            if (characterFormat.bold) {\n                spanElement.style.fontWeight = 'bold';\n            }\n            if (characterFormat.italic) {\n                spanElement.style.fontStyle = 'italic';\n            }\n        }\n    };\n    /**\n     * @private\n     */\n    TextHelper.prototype.measureText = function (text, characterFormat) {\n        // Gets the text element's width;\n        var width = this.getWidth(text, characterFormat);\n        var height = 0;\n        var baselineOffset = 0;\n        // Calculate the text element's height and baseline offset.\n        var textHelper = this.getHeight(characterFormat);\n        return {\n            'Width': width, 'Height': textHelper.Height, 'BaselineOffset': textHelper.BaselineOffset\n        };\n    };\n    /**\n     * @private\n     */\n    TextHelper.prototype.updateTextSize = function (elementBox, paragraph) {\n        var format = new WCharacterFormat(undefined);\n        var listCharacterFormat = elementBox.listLevel.characterFormat;\n        var breakCharacterFormat = paragraph.characterFormat;\n        format.fontSize = listCharacterFormat.fontSize === 11 ? breakCharacterFormat.fontSize : listCharacterFormat.fontSize;\n        format.fontFamily = listCharacterFormat.fontFamily === 'Verdana' ? breakCharacterFormat.fontFamily\n            : listCharacterFormat.fontFamily;\n        var bold = '';\n        var italic = '';\n        var baselineAlignment = listCharacterFormat.baselineAlignment === 'Normal' ?\n            breakCharacterFormat.baselineAlignment : listCharacterFormat.baselineAlignment;\n        bold = listCharacterFormat.bold ? 'bold' : breakCharacterFormat.bold ? 'bold' : '';\n        italic = listCharacterFormat.italic ? 'italic' : breakCharacterFormat.italic ? 'italic' : '';\n        format.baselineAlignment = baselineAlignment;\n        if (bold) {\n            format.bold = true;\n        }\n        if (italic) {\n            format.italic = true;\n        }\n        elementBox.width = this.getWidth(elementBox.text, format);\n        // Calculate the text element's height and baseline offset.\n        var textHelper = this.getHeight(format);\n        elementBox.height = textHelper.Height;\n        elementBox.baselineOffset = textHelper.BaselineOffset;\n    };\n    TextHelper.prototype.destroy = function () {\n        this.owner = undefined;\n        this.context = undefined;\n    };\n    return TextHelper;\n}());\nexport { TextHelper };\n","import { isNullOrUndefined } from '@syncfusion/ej2-base';\n/**\n * @private\n */\nvar Zoom = /** @class */ (function () {\n    function Zoom(viewer) {\n        var _this = this;\n        this.onMouseWheelInternal = function (event) {\n            if (event.ctrlKey === true) {\n                event.preventDefault();\n                var pageX = event.pageX - _this.viewer.viewerContainer.offsetLeft;\n                if (pageX < _this.viewer.pageContainer.offsetWidth) {\n                    var wheel = navigator.userAgent.match('Firefox') ? event.detail < 0 : event.wheelDelta > 0;\n                    var zoomFactor = _this.viewer.zoomFactor;\n                    if (wheel) {\n                        if (zoomFactor <= 4.90) {\n                            zoomFactor += .10;\n                        }\n                        else {\n                            zoomFactor = 5.00;\n                        }\n                    }\n                    else {\n                        if (zoomFactor >= .20) {\n                            zoomFactor -= .10;\n                        }\n                        else {\n                            zoomFactor = 0.10;\n                        }\n                    }\n                    _this.viewer.zoomFactor = zoomFactor;\n                }\n            }\n        };\n        this.viewer = viewer;\n    }\n    Zoom.prototype.setZoomFactor = function (value) {\n        this.onZoomFactorChanged();\n        if (!isNullOrUndefined(this.viewer.selection)) {\n            this.viewer.selection.updateCaretPosition();\n        }\n        this.viewer.updateTouchMarkPosition();\n        if (!isNullOrUndefined(this.viewer.owner.imageResizerModule)) {\n            this.viewer.owner.imageResizerModule.updateImageResizerPosition();\n        }\n        this.viewer.owner.fireZoomFactorChange();\n    };\n    //Zoom Implementation Starts\n    Zoom.prototype.onZoomFactorChanged = function () {\n        if (this.viewer.zoomFactor > 5) {\n            this.viewer.zoomFactor = 5;\n        }\n        else if (this.viewer.zoomFactor < 0.1) {\n            this.viewer.zoomFactor = 0.1;\n        }\n        this.zoom();\n    };\n    Zoom.prototype.zoom = function () {\n        var viewer = this.viewer;\n        viewer.clearContent();\n        viewer.handleZoom();\n        viewer.updateFocus();\n    };\n    return Zoom;\n}());\nexport { Zoom };\n","var __extends = (this && this.__extends) || (function () {\n    var extendStatics = Object.setPrototypeOf ||\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nimport { Dictionary } from '../../base/dictionary';\nimport { WAbstractList } from '../list/abstract-list';\nimport { WLevelOverride } from '../list/level-override';\nimport { WCharacterFormat, WParagraphFormat, WStyles } from '../format/index';\nimport { Layout } from './layout';\nimport { Renderer } from './render';\nimport { createElement, Browser } from '@syncfusion/ej2-base';\nimport { Page, Rect, ListTextElementBox, ParagraphWidget, HeaderFooterWidget } from './page';\nimport { LineWidget, TableWidget } from './page';\nimport { HelperMethods, Point } from '../editor/editor-helper';\nimport { TextHelper } from './text-helper';\nimport { isNullOrUndefined } from '@syncfusion/ej2-base';\nimport { Zoom } from './zooming';\nimport { Dialog } from '@syncfusion/ej2-popups';\n/**\n * @private\n */\nvar LayoutViewer = /** @class */ (function () {\n    //#endregion\n    function LayoutViewer(owner) {\n        var _this = this;\n        /**\n         * @private\n         */\n        this.textWrap = true;\n        /**\n         * @private\n         */\n        this.currentPage = undefined;\n        this.selectionStartPageIn = undefined;\n        this.selectionEndPageIn = undefined;\n        /**\n         * @private\n         */\n        this.fieldStacks = [];\n        /**\n         * @private\n         */\n        this.splittedCellWidgets = [];\n        /**\n         * @private\n         */\n        this.tableLefts = [];\n        this.tapCount = 0;\n        this.timer = -1;\n        this.isTimerStarted = false;\n        /**\n         * @private\n         */\n        this.isFirstLineFitInShiftWidgets = false;\n        /**\n         * @private\n         */\n        this.preZoomFactor = 0;\n        /**\n         * @private\n         */\n        this.preDifference = -1;\n        /**\n         * @private\n         */\n        this.fieldEndParagraph = undefined;\n        /**\n         * @private\n         */\n        this.fieldToLayout = undefined;\n        /**\n         * @private\n         */\n        this.backgroundColor = '#FFFFFF';\n        /**\n         * @private\n         */\n        this.containerTop = 0;\n        /**\n         * @private\n         */\n        this.containerLeft = 0;\n        // Event \n        /**\n         * @private\n         */\n        this.isMouseDown = false;\n        /**\n         * @private\n         */\n        this.isSelectionChangedOnMouseMoved = false;\n        /**\n         * @private\n         */\n        this.isControlPressed = false;\n        /**\n         * @private\n         */\n        this.isTouchInput = false;\n        /**\n         * @private\n         */\n        this.useTouchSelectionMark = false;\n        /**\n         * @private\n         */\n        this.touchDownOnSelectionMark = 0;\n        /**\n         * @private\n         */\n        this.isCompositionStart = false;\n        /**\n         * @private\n         */\n        this.isCompositionUpdated = false;\n        /**\n         * @private\n         */\n        this.isCompositionCanceled = false;\n        /**\n         * @private\n         */\n        this.isCompositionEnd = false;\n        /**\n         * @private\n         */\n        this.prefix = '';\n        /**\n         * @private\n         */\n        this.suffix = '';\n        /**\n         * @private\n         */\n        this.fields = [];\n        /**\n         * @private\n         */\n        this.heightInfoCollection = {};\n        /**\n         * @private\n         */\n        this.defaultTabWidth = 36;\n        /**\n         * @private\n         */\n        this.lists = [];\n        /**\n         * @private\n         */\n        this.abstractLists = [];\n        /**\n         * @private\n         */\n        this.styles = new WStyles();\n        /**\n         * @private\n         */\n        this.preDefinedStyles = undefined;\n        /**\n         * @private\n         */\n        this.isRowOrCellResizing = false;\n        this.isMouseDownInFooterRegion = false;\n        this.pageFitTypeIn = 'None';\n        /**\n         * @private\n         */\n        this.fieldCollection = [];\n        /**\n         * @private\n         */\n        this.isPageField = false;\n        /**\n         * @private\n         */\n        this.mouseDownOffset = new Point(0, 0);\n        this.zoomFactorInternal = 1;\n        /**\n         * Fires when composition starts.\n         * @private\n         */\n        this.compositionStart = function (event) {\n            event.preventDefault();\n            _this.isCompositionStart = true;\n        };\n        /**\n         * Fires on every input during composition.\n         * @private\n         */\n        this.compositionUpdated = function (event) {\n            event.preventDefault();\n            _this.isCompositionUpdated = true;\n        };\n        /**\n         * Fires when user selects a character/word and finalizes the input.\n         * @private\n         */\n        this.compositionEnd = function (event) {\n            event.preventDefault();\n            _this.isCompositionUpdated = false;\n            _this.isCompositionEnd = true;\n        };\n        // tslint:disable:no-any \n        this.onImageResizer = function (args) {\n            if (!isNullOrUndefined(_this.owner.imageResizerModule) && _this.owner.imageResizerModule.isImageResizerVisible\n                && _this.owner.imageResizerModule.isImageResizing) {\n                if (args instanceof MouseEvent) {\n                    _this.onMouseUpInternal(args);\n                }\n                else if (args instanceof TouchEvent) {\n                    _this.onTouchUpInternal(args);\n                }\n            }\n        };\n        // tslint:enable:no-any \n        this.onKeyPressInternal = function (event) {\n            event.preventDefault();\n            if (!isNullOrUndefined(_this.selection)) {\n                var key = event.keyCode || event.charCode;\n                var char = '';\n                if (key) {\n                    char = String.fromCharCode(key);\n                }\n                else if (event.key) {\n                    char = event.key;\n                }\n                // tslint:disable-next-line:max-line-length\n                if (char !== 'Spacebar' && char !== '\\r' && char !== '\\b' && char !== '\\u001B' && !_this.owner.isReadOnlyMode && event.ctrlKey === false) {\n                    _this.owner.editorModule.handleTextInput(char);\n                }\n                else if (char === 'Spacebar') {\n                    _this.owner.editorModule.handleTextInput(' ');\n                }\n            }\n        };\n        this.onTextInputInternal = function (event) {\n            if (!_this.owner.isReadOnlyMode) {\n                _this.owner.editorModule.onTextInputInternal(event);\n            }\n            else {\n                _this.editableDiv.innerText = '';\n            }\n        };\n        /**\n         * Fired on paste.\n         * @param {ClipboardEvent} event\n         * @private\n         */\n        this.onPaste = function (event) {\n            if (!_this.owner.isReadOnlyMode) {\n                _this.owner.editorModule.pasteInternal(event);\n            }\n            _this.editableDiv.innerText = '';\n            event.preventDefault();\n        };\n        /**\n         * Fires when editable div loses focus.\n         * @private\n         */\n        this.onFocusOut = function () {\n            if (!isNullOrUndefined(_this.selection)) {\n                if (_this.owner.contextMenuModule && _this.owner.contextMenuModule.contextMenuInstance &&\n                    _this.owner.contextMenuModule.contextMenuInstance.element.style.display === 'block') {\n                    return;\n                }\n                _this.selection.hideCaret();\n            }\n        };\n        /**\n         * Updates focus to editor area.\n         * @private\n         */\n        this.updateFocus = function () {\n            if (_this.selection) {\n                _this.editableDiv.focus();\n                _this.selection.showCaret();\n            }\n        };\n        /**\n         * Fires on scrolling.\n         */\n        this.scrollHandler = function () {\n            _this.clearContent();\n            _this.updateScrollBars();\n            var vtHeight = _this.containerTop + _this.visibleBounds.height;\n            if (vtHeight > _this.pageContainer.offsetHeight) {\n                _this.viewerContainer.scrollTop = _this.containerTop - (vtHeight - _this.pageContainer.offsetHeight);\n            }\n            var viewer = _this;\n            if (viewer instanceof PageLayoutViewer && !isNullOrUndefined(_this.owner)) {\n                _this.owner.fireViewChange();\n            }\n        };\n        /**\n         * Fires when the window gets resized.\n         * @private\n         */\n        this.onWindowResize = function () {\n            var viewer = _this;\n            var resizeTimer;\n            /* tslint:disable:align */\n            resizeTimer = setTimeout(function () {\n                if (!isNullOrUndefined(viewer.owner) && !isNullOrUndefined(_this.owner.element)) {\n                    viewer.updateViewerSizeInternal(document.getElementById(viewer.owner.element.id));\n                    viewer.updateScrollBars();\n                    if (!isNullOrUndefined(_this.selection)) {\n                        _this.selection.updateCaretPosition();\n                    }\n                    viewer.updateTouchMarkPosition();\n                    if (viewer.owner.contextMenuModule && viewer.owner.contextMenuModule.contextMenuInstance) {\n                        viewer.owner.contextMenuModule.contextMenuInstance.close();\n                    }\n                    if (resizeTimer) {\n                        clearTimeout(resizeTimer);\n                    }\n                }\n            }, 100);\n        };\n        /**\n         * @private\n         */\n        this.onContextMenu = function (event) {\n            if (_this.owner.contextMenuModule) {\n                _this.owner.contextMenuModule.onContextMenuInternal(event);\n            }\n        };\n        /**\n         * Called on mouse down.\n         * @param {MouseEvent} event\n         * @private\n         */\n        this.onMouseDownInternal = function (event) {\n            if (_this.isTouchInput || event.offsetX > (_this.visibleBounds.width - (_this.visibleBounds.width - _this.viewerContainer.clientWidth))\n                || event.offsetY > (_this.visibleBounds.height - (_this.visibleBounds.height - _this.viewerContainer.clientHeight))) {\n                return;\n            }\n            if (!isNullOrUndefined(_this.selection)) {\n                _this.updateCursor(event);\n                // tslint:disable-next-line:max-line-length\n                if (_this.isLeftButtonPressed(event) && !_this.owner.isReadOnlyMode && _this.owner.enableImageResizerMode && !isNullOrUndefined(_this.owner.imageResizerModule.selectedResizeElement)) {\n                    _this.owner.imageResizerModule.isImageResizing = true;\n                }\n                event.preventDefault();\n                if (!_this.isTouchInput) {\n                    _this.selection.hideCaret();\n                }\n                var cursorPoint = new Point(event.offsetX, event.offsetY);\n                var touchPoint = _this.findFocusedPage(cursorPoint, true);\n                _this.mouseDownOffset.x = touchPoint.x;\n                _this.mouseDownOffset.y = touchPoint.y;\n                // tslint:disable-next-line:max-line-length\n                _this.isMouseDownInFooterRegion = _this.selection.isCursorInsidePageRect(cursorPoint, _this.currentPage) && _this.selection.isCursorInFooterRegion(cursorPoint, _this.currentPage);\n                _this.isSelectionChangedOnMouseMoved = false;\n                if (!_this.owner.isReadOnlyMode && (_this.owner.editorModule.tableResize.isInCellResizerArea(touchPoint) ||\n                    _this.owner.editorModule.tableResize.isInRowResizerArea(touchPoint))) {\n                    _this.selection.hideCaret();\n                    _this.isMouseDown = true;\n                    _this.isSelectionChangedOnMouseMoved = false;\n                    if (_this.isLeftButtonPressed(event)) {\n                        _this.owner.editorModule.tableResize.startingPoint.x = touchPoint.x;\n                        _this.owner.editorModule.tableResize.startingPoint.y = touchPoint.y;\n                        _this.owner.editorModule.tableResize.handleResize(touchPoint);\n                    }\n                    return;\n                }\n                if (event.ctrlKey) {\n                    _this.isControlPressed = true;\n                }\n                if (_this.owner.selection.isEmpty) {\n                    _this.useTouchSelectionMark = false;\n                }\n                if (event.which === 3 && !_this.owner.selection.isEmpty\n                    && _this.selection.checkCursorIsInSelection(_this.getLineWidget(touchPoint), touchPoint)) {\n                    event.preventDefault();\n                    return;\n                }\n                _this.isTouchInput = false;\n                _this.isMouseDown = true;\n                _this.updateFocus();\n                /* tslint:disable:align */\n                _this.timer = setTimeout(function () {\n                    _this.tapCount++;\n                    if (_this.tapCount === 4) {\n                        _this.tapCount = 1;\n                    }\n                }, 200);\n            }\n        };\n        /**\n         * Called on mouse move.\n         * @param {MouseEvent} event\n         * @private\n         */\n        this.onMouseMoveInternal = function (event) {\n            event.preventDefault();\n            if (!isNullOrUndefined(_this.selection)) {\n                //For image Resizing\n                if (!_this.owner.isReadOnlyMode && _this.owner.enableImageResizerMode\n                    && _this.owner.imageResizerModule.isImageResizing) {\n                    if (!_this.owner.imageResizerModule.isImageMoveToNextPage) {\n                        _this.owner.imageResizerModule.handleImageResizingOnMouse(event);\n                    }\n                    return;\n                }\n                var cursorPoint = new Point(event.offsetX, event.offsetY);\n                var touchPoint = _this.findFocusedPage(cursorPoint, !_this.owner.enableHeaderAndFooter);\n                if (_this.isMouseDown) {\n                    if (!isNullOrUndefined(_this.currentPage)) {\n                        var xPosition = touchPoint.x;\n                        var yPosition = touchPoint.y;\n                        if (!_this.owner.isReadOnlyMode && _this.isRowOrCellResizing) {\n                            _this.owner.editorModule.tableResize.handleResizing(touchPoint);\n                        }\n                        else {\n                            if (!(_this.isTouchInput || _this.isSelectionChangedOnMouseMoved || _this.touchDownOnSelectionMark > 0)) {\n                                _this.updateTextPositionForSelection(touchPoint, 1);\n                            }\n                            if (_this.isLeftButtonPressed(event)) {\n                                event.preventDefault();\n                                var touchY = yPosition;\n                                var textPosition = _this.owner.selection.end;\n                                var touchPoint_1 = new Point(xPosition, touchY);\n                                if (!_this.owner.enableImageResizerMode || !_this.owner.imageResizerModule.isImageResizerVisible) {\n                                    _this.owner.selection.moveTextPosition(touchPoint_1, textPosition);\n                                }\n                                _this.isSelectionChangedOnMouseMoved = true;\n                            }\n                        }\n                    }\n                    _this.selection.checkForCursorVisibility();\n                }\n                if (!_this.isRowOrCellResizing && !_this.isSelectionChangedOnMouseMoved) {\n                    _this.updateCursor(event);\n                }\n                if (_this.isRowOrCellResizing) {\n                    _this.selection.hideCaret();\n                }\n            }\n        };\n        /**\n         * Fired on double tap.\n         * @param {MouseEvent} event\n         * @private\n         */\n        this.onDoubleTap = function (event) {\n            if (!isNullOrUndefined(_this.selection)) {\n                _this.isTouchInput = false;\n                var cursorPoint = new Point(event.offsetX, event.offsetY);\n                if (_this.selection.checkAndEnableHeaderFooter(cursorPoint, _this.findFocusedPage(cursorPoint, true))) {\n                    return;\n                }\n                // tslint:disable-next-line:max-line-length\n                if (_this.selection.isEmpty && !isNullOrUndefined(_this.currentPage) && !isNullOrUndefined(_this.owner.selection.start)) {\n                    _this.owner.selection.selectCurrentWord();\n                    _this.selection.checkForCursorVisibility();\n                    _this.tapCount = 2;\n                }\n            }\n        };\n        /**\n         * Called on mouse up.\n         * @param {MouseEvent} event\n         * @private\n         */\n        this.onMouseUpInternal = function (event) {\n            event.preventDefault();\n            _this.isListTextSelected = false;\n            var cursorPoint = new Point(event.offsetX, event.offsetY);\n            var touchPoint = _this.findFocusedPage(cursorPoint, true);\n            if (!isNullOrUndefined(_this.selection)) {\n                var tapCount = 1;\n                if (!Browser.isIE) {\n                    if (event.detail > 2) {\n                        tapCount = event.detail;\n                    }\n                }\n                else {\n                    tapCount = _this.tapCount;\n                }\n                if (_this.isRowOrCellResizing) {\n                    _this.owner.editorModule.tableResize.updateResizingHistory(touchPoint);\n                }\n                if (_this.isMouseDown && !_this.isSelectionChangedOnMouseMoved\n                    && !isNullOrUndefined(_this.currentPage) && !isNullOrUndefined(_this.owner.selection.start)\n                    && (!_this.owner.enableImageResizerMode || !_this.owner.imageResizerModule.isImageResizing)) {\n                    if (_this.touchDownOnSelectionMark === 0 && !_this.isRowOrCellResizing) {\n                        _this.updateTextPositionForSelection(touchPoint, tapCount);\n                        if (Browser.isIE && tapCount === 2) {\n                            _this.selection.checkAndEnableHeaderFooter(cursorPoint, touchPoint);\n                        }\n                    }\n                    _this.selection.checkForCursorVisibility();\n                }\n                if (!isNullOrUndefined(_this.currentPage) && !isNullOrUndefined(_this.owner.selection.start)\n                    && (_this.owner.selection.isEmpty || _this.owner.selection.isImageSelected) &&\n                    (((event.ctrlKey && _this.owner.useCtrlClickToFollowHyperlink ||\n                        !_this.owner.useCtrlClickToFollowHyperlink) && _this.isLeftButtonPressed(event) === true))) {\n                    _this.selection.navigateHyperLinkOnEvent(touchPoint, false);\n                }\n                if (!_this.owner.isReadOnlyMode && _this.isSelectionInListText(touchPoint)) {\n                    _this.selection.selectListText();\n                }\n                // tslint:disable-next-line:max-line-length\n                if (!_this.owner.isReadOnlyMode && _this.owner.enableImageResizerMode && _this.owner.imageResizerModule.isImageResizing) {\n                    _this.owner.imageResizerModule.mouseUpInternal();\n                    _this.scrollToPosition(_this.owner.selection.start, _this.owner.selection.end);\n                    _this.owner.imageResizerModule.isImageResizing = false;\n                    _this.owner.imageResizerModule.updateHistoryForImageResizer();\n                }\n                // tslint:disable-next-line:max-line-length\n                if (_this.owner.enableImageResizerMode && _this.owner.imageResizerModule.isImageResizerVisible && !isNullOrUndefined(_this.selection.caret)) {\n                    _this.selection.caret.style.display = 'none';\n                }\n                _this.isMouseDown = false;\n                _this.isSelectionChangedOnMouseMoved = false;\n                _this.isTouchInput = false;\n                _this.useTouchSelectionMark = true;\n                _this.isControlPressed = false;\n                _this.updateFocus();\n                if (_this.isListTextSelected) {\n                    _this.selection.hideCaret();\n                }\n                if (_this.owner.enableImageResizerMode) {\n                    var imageResizer = _this.owner.imageResizerModule;\n                    imageResizer.isImageResizing = false;\n                    imageResizer.isImageMoveToNextPage = false;\n                    imageResizer.leftValue = undefined;\n                    imageResizer.topValue = undefined;\n                }\n                _this.isMouseDownInFooterRegion = false;\n            }\n        };\n        /**\n         * Fired on touch start.\n         * @param {TouchEvent} event\n         * @private\n         */\n        this.onTouchStartInternal = function (event) {\n            if (_this.selection) {\n                _this.isCompositionStart = false;\n                _this.isCompositionEnd = false;\n                _this.isCompositionUpdated = false;\n                _this.isCompositionCanceled = true;\n                _this.isTouchInput = true;\n                if (_this.isTimerStarted) {\n                    if (_this.tapCount === 1) {\n                        _this.tapCount = 2;\n                    }\n                    else {\n                        _this.tapCount = 3;\n                        _this.isTimerStarted = false;\n                    }\n                }\n                else {\n                    _this.isTimerStarted = true;\n                    _this.tapCount = 1;\n                }\n                if (event.touches.length === 1) {\n                    _this.zoomX = event.touches[0].clientX;\n                    _this.zoomY = event.touches[0].clientY;\n                    if (_this.owner.selection.isEmpty) {\n                        _this.useTouchSelectionMark = false;\n                    }\n                    _this.isMouseDown = true;\n                    _this.isSelectionChangedOnMouseMoved = false;\n                    var point = void 0;\n                    if (_this.isMouseDown) {\n                        point = _this.getTouchOffsetValue(event);\n                    }\n                    point = _this.findFocusedPage(point, true);\n                    if (_this.owner.enableImageResizerMode) {\n                        var resizeObj = _this.owner.imageResizerModule.getImagePointOnTouch(point);\n                        _this.owner.imageResizerModule.selectedResizeElement = resizeObj.selectedElement;\n                    }\n                    // tslint:disable-next-line:max-line-length\n                    if (_this.owner.enableImageResizerMode && !isNullOrUndefined(_this.owner.imageResizerModule.selectedResizeElement)) {\n                        _this.owner.imageResizerModule.isImageResizing = true;\n                    }\n                    var x = _this.owner.selection.end.location.x;\n                    var y = _this.selection.getCaretBottom(_this.owner.selection.end, _this.owner.selection.isEmpty) + 9;\n                    //TouchDownOnSelectionMark will be 2 when touch end is pressed\n                    _this.touchDownOnSelectionMark = ((point.y <= y && point.y >= y - 20 || point.y >= y && point.y <= y + 20)\n                        && (point.x <= x && point.x >= x - 20 || point.x >= x && point.x <= x + 20)) ? 1 : 0;\n                    if (!_this.owner.selection.isEmpty && _this.touchDownOnSelectionMark === 0) {\n                        x = _this.owner.selection.start.location.x;\n                        y = _this.selection.getCaretBottom(_this.owner.selection.start, false) + 9;\n                        //TouchDownOnSelectionMark will be 1 when touch start is pressed\n                        _this.touchDownOnSelectionMark = ((point.y <= y && point.y >= y - 20 || point.y >= y && point.y <= y + 20)\n                            && (point.x <= x && point.x >= x - 20 || point.x >= x && point.x <= x + 20)) ? 2 : 0;\n                    }\n                }\n                if (!isNullOrUndefined(_this.owner.contextMenuModule) && _this.owner.contextMenuModule.contextMenuInstance) {\n                    _this.owner.contextMenuModule.contextMenuInstance.close();\n                }\n                if (_this.touchDownOnSelectionMark || event.touches.length > 1) {\n                    event.preventDefault();\n                }\n                _this.timer = setTimeout(function () {\n                    _this.isTimerStarted = false;\n                }, 200);\n            }\n        };\n        /**\n         * Fired on touch move.\n         * @param {TouchEvent} event\n         * @private\n         */\n        this.onTouchMoveInternal = function (event) {\n            var touch = event.touches;\n            var cursorPoint;\n            if (!isNullOrUndefined(_this.selection)) {\n                // tslint:disable-next-line:max-line-length\n                if (_this.owner.editorModule && _this.owner.enableImageResizerMode && _this.owner.imageResizerModule.isImageResizing) {\n                    event.preventDefault();\n                    if (!_this.owner.imageResizerModule.isImageMoveToNextPage) {\n                        _this.owner.imageResizerModule.handleImageResizingOnTouch(event);\n                        _this.selection.caret.style.display = 'none';\n                    }\n                    return;\n                }\n                if (_this.isMouseDown) {\n                    cursorPoint = _this.getTouchOffsetValue(event);\n                    var touchPoint = _this.findFocusedPage(cursorPoint, true);\n                    if (_this.touchDownOnSelectionMark > 0 /*|| !this.useTouchSelectionMark*/) {\n                        event.preventDefault();\n                        var touchY = touchPoint.y;\n                        var textPosition = _this.owner.selection.end;\n                        var touchPointer = void 0;\n                        if (touchPoint.y <= 26) {\n                            touchY -= touchPoint.y < 0 ? 0 : touchPoint.y + 0.5;\n                        }\n                        else {\n                            touchY -= 36.5;\n                        }\n                        textPosition = _this.touchDownOnSelectionMark === 2 ? _this.selection.start : _this.selection.end;\n                        touchPoint = new Point(touchPoint.x, touchY);\n                        _this.owner.selection.moveTextPosition(touchPoint, textPosition);\n                        _this.isSelectionChangedOnMouseMoved = true;\n                    }\n                    _this.selection.checkForCursorVisibility();\n                }\n            }\n            if (touch.length > 1) {\n                event.preventDefault();\n                _this.isMouseDown = false;\n                _this.zoomX = (touch[0].clientX + touch[1].clientX) / 2;\n                _this.zoomY = (touch[0].clientY + touch[1].clientY) / 2;\n                // tslint:disable-next-line:max-line-length\n                var currentDiff = Math.sqrt(Math.pow((touch[0].clientX - touch[1].clientX), 2) + Math.pow((touch[0].clientY - touch[1].clientY), 2));\n                if (_this.preDifference > -1) {\n                    if (currentDiff > _this.preDifference) {\n                        _this.onPinchOutInternal(event);\n                    }\n                    else if (currentDiff < _this.preDifference) {\n                        _this.onPinchInInternal(event);\n                    }\n                }\n                else if (_this.zoomFactor < 2) {\n                    if (_this.preDifference !== -1) {\n                        if (currentDiff > _this.preDifference) {\n                            _this.onPinchInInternal(event);\n                        }\n                    }\n                }\n                else if (_this.preDifference === -1) {\n                    if (_this.zoomFactor > 2) {\n                        if (currentDiff > _this.preDifference) {\n                            _this.onPinchInInternal(event);\n                        }\n                    }\n                }\n                _this.preDifference = currentDiff;\n            }\n        };\n        /**\n         * Fired on touch up.\n         * @param {TouchEvent} event\n         * @private\n         */\n        this.onTouchUpInternal = function (event) {\n            if (!isNullOrUndefined(_this.selection)) {\n                var point = _this.getTouchOffsetValue(event);\n                var touchPoint = _this.findFocusedPage(point, true);\n                if (event.changedTouches.length === 1) {\n                    _this.zoomX = undefined;\n                    _this.zoomY = undefined;\n                    // tslint:disable-next-line:max-line-length\n                    if (_this.isMouseDown && !_this.isSelectionChangedOnMouseMoved && !isNullOrUndefined(_this.currentPage) && !isNullOrUndefined(_this.owner.selection.start)) {\n                        if (_this.touchDownOnSelectionMark === 0) {\n                            _this.updateTextPositionForSelection(new Point(touchPoint.x, touchPoint.y), _this.tapCount);\n                            if (_this.tapCount === 2) {\n                                _this.selection.checkAndEnableHeaderFooter(point, touchPoint);\n                            }\n                        }\n                        if (_this.owner.selection.isEmpty) {\n                            _this.selection.updateCaretPosition();\n                        }\n                        _this.selection.checkForCursorVisibility();\n                    }\n                    if (!isNullOrUndefined(_this.currentPage) && !isNullOrUndefined(_this.selection.start)\n                        && !_this.isSelectionChangedOnMouseMoved && (_this.selection.isEmpty ||\n                        _this.selection.isImageField() && (!_this.owner.enableImageResizerMode ||\n                            _this.owner.enableImageResizerMode && !_this.owner.imageResizerModule.isImageResizing))) {\n                        _this.selection.navigateHyperLinkOnEvent(touchPoint, true);\n                    }\n                    _this.isMouseDown = false;\n                    _this.touchDownOnSelectionMark = 0;\n                    _this.useTouchSelectionMark = true;\n                    _this.isSelectionChangedOnMouseMoved = false;\n                }\n                if (_this.owner.enableImageResizerMode && _this.owner.imageResizerModule.isImageResizing) {\n                    _this.owner.imageResizerModule.mouseUpInternal();\n                    _this.owner.imageResizerModule.isImageResizing = false;\n                    _this.owner.imageResizerModule.isImageMoveToNextPage = false;\n                    _this.scrollToPosition(_this.owner.selection.start, _this.owner.selection.end);\n                    _this.owner.imageResizerModule.updateHistoryForImageResizer();\n                }\n                // tslint:disable-next-line:max-line-length\n                if (_this.owner.enableImageResizerMode && _this.owner.imageResizerModule.isImageResizerVisible && _this.isTouchInput) {\n                    _this.touchStart.style.display = 'none';\n                    _this.touchEnd.style.display = 'none';\n                }\n                // if (!this.owner.isReadOnlyMode && this.isSelectionInListText(touchPoint)) {\n                //     this.selection.selectListText();\n                // }\n                event.preventDefault();\n            }\n            _this.preDifference = -1;\n            _this.isTouchInput = false;\n            if (!_this.isTimerStarted) {\n                _this.tapCount = 1;\n            }\n            if (_this.isListTextSelected) {\n                _this.selection.hideCaret();\n            }\n        };\n        /**\n         * Fired on keyup event.\n         * @private\n         */\n        this.onKeyUpInternal = function (event) {\n            if (Browser.isDevice) {\n                if (window.getSelection().anchorOffset !== _this.prefix.length) {\n                    _this.selection.setEditableDivCaretPosition(_this.editableDiv.innerText.length);\n                }\n            }\n            if (event.ctrlKey || (event.keyCode === 17 || event.which === 17)) {\n                _this.isControlPressed = false;\n            }\n        };\n        /**\n         * Fired on keydown.\n         * @private\n         */\n        this.onKeyDownInternal = function (event) {\n            var isHandled = false;\n            var keyEventArgs = { 'event': event, 'isHandled': false, source: _this.owner };\n            _this.owner.trigger('keyDown', keyEventArgs);\n            if (keyEventArgs.isHandled) {\n                return;\n            }\n            var key = event.which || event.keyCode;\n            var ctrl = (event.ctrlKey || event.metaKey) ? true : ((key === 17) ? true : false); // ctrl detection       \n            var shift = event.shiftKey ? event.shiftKey : ((key === 16) ? true : false); // Shift Key detection        \n            var alt = event.altKey ? event.altKey : ((key === 18) ? true : false); // alt key detection\n            if (ctrl && !shift && !alt) {\n                switch (key) {\n                    case 80:\n                        event.preventDefault();\n                        _this.owner.print();\n                        isHandled = true;\n                        break;\n                    case 83:\n                        event.preventDefault();\n                        _this.owner.save(_this.owner.documentName === '' ? 'sample' : _this.owner.documentName, 'Sfdt');\n                        isHandled = true;\n                        break;\n                }\n            }\n            if (!isHandled && !isNullOrUndefined(_this.selection)) {\n                _this.selection.onKeyDownInternal(event, ctrl, shift, alt);\n            }\n            if (isHandled) {\n                event.preventDefault();\n            }\n        };\n        this.owner = owner;\n        this.pages = [];\n        this.render = new Renderer(this);\n        this.lists = [];\n        this.abstractLists = [];\n        this.characterFormat = new WCharacterFormat(this);\n        this.paragraphFormat = new WParagraphFormat(this);\n        this.renderedLists = new Dictionary();\n        this.headersFooters = [];\n        this.styles = new WStyles();\n        this.preDefinedStyles = new Dictionary();\n        this.initalizeStyles();\n        this.bookmarks = new Dictionary();\n    }\n    Object.defineProperty(LayoutViewer.prototype, \"containerCanvas\", {\n        //#region Properties\n        /**\n         * Gets container canvas.\n         * @private\n         */\n        get: function () {\n            if (isNullOrUndefined(this.containerCanvasIn)) {\n                this.containerCanvasIn = document.createElement('canvas');\n                this.containerCanvasIn.getContext('2d').save();\n            }\n            if (!isNullOrUndefined(this.pageContainer)\n                && this.containerCanvasIn.parentElement !== this.pageContainer) {\n                this.pageContainer.appendChild(this.containerCanvasIn);\n            }\n            return this.containerCanvasIn;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(LayoutViewer.prototype, \"selectionCanvas\", {\n        /**\n         * Gets selection canvas.\n         * @private\n         */\n        get: function () {\n            if (isNullOrUndefined(this.selectionCanvasIn)) {\n                this.selectionCanvasIn = document.createElement('canvas');\n                this.selectionCanvas.getContext('2d').save();\n            }\n            if (!isNullOrUndefined(this.pageContainer)\n                && this.selectionCanvasIn.parentElement !== this.pageContainer) {\n                this.pageContainer.appendChild(this.selectionCanvasIn);\n            }\n            return this.selectionCanvasIn;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(LayoutViewer.prototype, \"containerContext\", {\n        /**\n         * Gets container context.\n         * @private\n         */\n        get: function () {\n            return this.containerCanvas.getContext('2d');\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(LayoutViewer.prototype, \"selectionContext\", {\n        /**\n         * Gets selection context.\n         * @private\n         */\n        get: function () {\n            return this.selectionCanvas.getContext('2d');\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(LayoutViewer.prototype, \"currentRenderingPage\", {\n        /**\n         * Gets the current rendering page.\n         */\n        get: function () {\n            if (this.pages.length === 0) {\n                return undefined;\n            }\n            return this.pages[this.pages.length - 1];\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(LayoutViewer.prototype, \"visibleBounds\", {\n        /**\n         * Gets visible bounds.\n         * @private\n         */\n        get: function () {\n            return this.visibleBoundsIn;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(LayoutViewer.prototype, \"zoomFactor\", {\n        /**\n         * Gets or sets zoom factor.\n         * @private\n         */\n        get: function () {\n            return this.zoomFactorInternal;\n        },\n        set: function (value) {\n            if (this.zoomFactorInternal !== value) {\n                this.preZoomFactor = this.zoomFactor;\n                this.zoomFactorInternal = value;\n                this.zoomModule.setZoomFactor(value);\n                this.owner.zoomFactor = value;\n            }\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(LayoutViewer.prototype, \"selection\", {\n        /**\n         * Gets the selection.\n         * @private\n         */\n        get: function () {\n            return this.owner.selection;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(LayoutViewer.prototype, \"selectionStartPage\", {\n        /**\n         * Gets or sets selection start page.\n         * @private\n         */\n        get: function () {\n            return this.selectionStartPageIn;\n        },\n        set: function (value) {\n            this.selectionStartPageIn = value;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(LayoutViewer.prototype, \"selectionEndPage\", {\n        /**\n         * Gets or sets selection end page.\n         * @private\n         */\n        get: function () {\n            return this.selectionEndPageIn;\n        },\n        set: function (value) {\n            this.selectionEndPageIn = value;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(LayoutViewer.prototype, \"dialog\", {\n        /**\n         * Gets the initialized default dialog.\n         * @private\n         */\n        get: function () {\n            if (!this.dialogInternal) {\n                this.initDialog();\n            }\n            return this.dialogInternal;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(LayoutViewer.prototype, \"dialog2\", {\n        /**\n         * Gets the initialized default dialog.\n         * @private\n         */\n        get: function () {\n            if (!this.dialogInternal2) {\n                this.initDialog2();\n            }\n            return this.dialogInternal2;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(LayoutViewer.prototype, \"pageFitType\", {\n        /**\n         * Gets or sets page fit type.\n         * @private\n         */\n        get: function () {\n            return this.pageFitTypeIn;\n        },\n        set: function (value) {\n            this.pageFitTypeIn = value;\n            this.onPageFitTypeChanged(this.pageFitTypeIn);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    LayoutViewer.prototype.initalizeStyles = function () {\n        /* tslint:disable-next-line:max-line-length */\n        this.preDefinedStyles.add('Normal', '{\"type\":\"Paragraph\",\"name\":\"Normal\",\"next\":\"Normal\"}');\n        /* tslint:disable-next-line:max-line-length */\n        this.preDefinedStyles.add('Heading 1', '{\"type\":\"Paragraph\",\"name\":\"Heading 1\",\"basedOn\":\"Normal\",\"next\":\"Normal\",\"link\":\"Heading 1 Char\",\"characterFormat\":{\"fontSize\":16.0,\"fontFamily\":\"Calibri Light\",\"fontColor\":\"#2F5496\"},\"paragraphFormat\":{\"leftIndent\":0.0,\"rightIndent\":0.0,\"firstLineIndent\":0.0,\"beforeSpacing\":12.0,\"afterSpacing\":0.0,\"lineSpacing\":1.0791666507720947,\"lineSpacingType\":\"Multiple\",\"textAlignment\":\"Left\",\"outlineLevel\":\"Level1\"}}');\n        /* tslint:disable-next-line:max-line-length */\n        this.preDefinedStyles.add('Heading 2', '{\"type\":\"Paragraph\",\"name\":\"Heading 2\",\"basedOn\":\"Normal\",\"next\":\"Normal\",\"link\":\"Heading 2 Char\",\"characterFormat\":{\"fontSize\":13.0,\"fontFamily\":\"Calibri Light\",\"fontColor\":\"#2F5496\"},\"paragraphFormat\":{\"leftIndent\":0.0,\"rightIndent\":0.0,\"firstLineIndent\":0.0,\"beforeSpacing\":2.0,\"afterSpacing\":0.0,\"lineSpacing\":1.0791666507720947,\"lineSpacingType\":\"Multiple\",\"textAlignment\":\"Left\",\"outlineLevel\":\"Level2\"}}');\n        /* tslint:disable-next-line:max-line-length */\n        this.preDefinedStyles.add('Heading 3', '{\"type\":\"Paragraph\",\"name\":\"Heading 3\",\"basedOn\":\"Normal\",\"next\":\"Normal\",\"link\":\"Heading 3 Char\",\"characterFormat\":{\"fontSize\":12.0,\"fontFamily\":\"Calibri Light\",\"fontColor\":\"#1F3763\"},\"paragraphFormat\":{\"leftIndent\":0.0,\"rightIndent\":0.0,\"firstLineIndent\":0.0,\"beforeSpacing\":2.0,\"afterSpacing\":0.0,\"lineSpacing\":1.0791666507720947,\"lineSpacingType\":\"Multiple\",\"textAlignment\":\"Left\",\"outlineLevel\":\"Level3\"}}');\n        /* tslint:disable-next-line:max-line-length */\n        this.preDefinedStyles.add('Heading 4', '{\"type\":\"Paragraph\",\"name\":\"Heading 4\",\"basedOn\":\"Normal\",\"next\":\"Normal\",\"link\":\"Heading 4 Char\",\"characterFormat\":{\"italic\":true,\"fontFamily\":\"Calibri Light\",\"fontColor\":\"#2F5496\"},\"paragraphFormat\":{\"leftIndent\":0.0,\"rightIndent\":0.0,\"firstLineIndent\":0.0,\"beforeSpacing\":2.0,\"afterSpacing\":0.0,\"lineSpacing\":1.0791666507720947,\"lineSpacingType\":\"Multiple\",\"textAlignment\":\"Left\",\"outlineLevel\":\"Level4\"}}');\n        /* tslint:disable-next-line:max-line-length */\n        this.preDefinedStyles.add('Heading 5', '{\"type\":\"Paragraph\",\"name\":\"Heading 5\",\"basedOn\":\"Normal\",\"next\":\"Normal\",\"link\":\"Heading 5 Char\",\"characterFormat\":{\"fontFamily\":\"Calibri Light\",\"fontColor\":\"#2F5496\"},\"paragraphFormat\":{\"leftIndent\":0.0,\"rightIndent\":0.0,\"firstLineIndent\":0.0,\"beforeSpacing\":2.0,\"afterSpacing\":0.0,\"lineSpacing\":1.0791666507720947,\"lineSpacingType\":\"Multiple\",\"textAlignment\":\"Left\",\"outlineLevel\":\"Level5\"}}');\n        /* tslint:disable-next-line:max-line-length */\n        this.preDefinedStyles.add('Heading 6', '{\"type\":\"Paragraph\",\"name\":\"Heading 6\",\"basedOn\":\"Normal\",\"next\":\"Normal\",\"link\":\"Heading 6 Char\",\"characterFormat\":{\"fontFamily\":\"Calibri Light\",\"fontColor\":\"#1F3763\"},\"paragraphFormat\":{\"leftIndent\":0.0,\"rightIndent\":0.0,\"firstLineIndent\":0.0,\"beforeSpacing\":2.0,\"afterSpacing\":0.0,\"lineSpacing\":1.0791666507720947,\"lineSpacingType\":\"Multiple\",\"textAlignment\":\"Left\",\"outlineLevel\":\"Level6\"}}');\n        /* tslint:disable-next-line:max-line-length */\n        this.preDefinedStyles.add('Default Paragraph Font', '{\"type\":\"Character\",\"name\":\"Default Paragraph Font\"}');\n        /* tslint:disable-next-line:max-line-length */\n        this.preDefinedStyles.add('Heading 1 Char', '{\"type\":\"Character\",\"name\":\"Heading 1 Char\",\"basedOn\":\"Default Paragraph Font\",\"characterFormat\":{\"fontSize\":16.0,\"fontFamily\":\"Calibri Light\",\"fontColor\":\"#2F5496\"}}');\n        /* tslint:disable-next-line:max-line-length */\n        this.preDefinedStyles.add('Heading 2 Char', '{\"type\":\"Character\",\"name\":\"Heading 2 Char\",\"basedOn\":\"Default Paragraph Font\",\"characterFormat\":{\"fontSize\":13.0,\"fontFamily\":\"Calibri Light\",\"fontColor\":\"#2F5496\"}}');\n        /* tslint:disable-next-line:max-line-length */\n        this.preDefinedStyles.add('Heading 3 Char', '{\"type\":\"Character\",\"name\":\"Heading 3 Char\",\"basedOn\":\"Default Paragraph Font\",\"characterFormat\":{\"fontSize\":12.0,\"fontFamily\":\"Calibri Light\",\"fontColor\": \"#1F3763\"}}');\n        /* tslint:disable-next-line:max-line-length */\n        this.preDefinedStyles.add('Heading 4 Char', '{\"type\":\"Character\",\"name\":\"Heading 4 Char\",\"basedOn\":\"Default Paragraph Font\",\"characterFormat\":{\"italic\":true,\"fontFamily\":\"Calibri Light\",\"fontColor\":\"#2F5496\"}}');\n        /* tslint:disable-next-line:max-line-length */\n        this.preDefinedStyles.add('Heading 5 Char', '{\"type\":\"Character\",\"name\":\"Heading 5 Char\",\"basedOn\":\"Default Paragraph Font\",\"characterFormat\":{\"fontFamily\":\"Calibri Light\",\"fontColor\":\"#2F5496\"}}');\n        /* tslint:disable-next-line:max-line-length */\n        this.preDefinedStyles.add('Heading 6 Char', '{\"type\":\"Character\",\"name\":\"Heading 6 Char\",\"basedOn\":\"Default Paragraph Font\",\"characterFormat\":{\"fontFamily\":\"Calibri Light\",\"fontColor\":\"#1F3763\"}}');\n        /* tslint:disable-next-line:max-line-length */\n        this.preDefinedStyles.add('Hyperlink', '{\"type\":\"Character\",\"name\":\"Hyperlink\",\"basedOn\":\"Default Paragraph Font\",\"next\":\"Normal\",\"characterFormat\":{\"fontColor\":\"#0563C1\",\"underline\": \"Single\"}}');\n        /* tslint:disable-next-line:max-line-length */\n        this.preDefinedStyles.add('Toc1', '{\"type\":\"Paragraph\",\"name\":\"Toc1\",\"basedOn\":\"Normal\",\"next\":\"Normal\",\"paragraphFormat\":{\"afterSpacing\":5.0}}');\n        /* tslint:disable-next-line:max-line-length */\n        this.preDefinedStyles.add('Toc2', '{\"type\":\"Paragraph\",\"name\":\"Toc2\",\"basedOn\":\"Normal\",\"next\":\"Normal\",\"paragraphFormat\":{\"leftIndent\" :11.0,\"afterSpacing\":5.0}}');\n        /* tslint:disable-next-line:max-line-length */\n        this.preDefinedStyles.add('Toc3', '{\"type\":\"Paragraph\",\"name\":\"Toc3\",\"basedOn\":\"Normal\",\"next\":\"Normal\",\"paragraphFormat\":{\"leftIndent\" :22.0,\"afterSpacing\":5.0}}');\n        /* tslint:disable-next-line:max-line-length */\n        this.preDefinedStyles.add('Toc4', '{\"type\":\"Paragraph\",\"name\":\"Toc4\",\"basedOn\":\"Normal\",\"next\":\"Normal\",\"paragraphFormat\":{\"leftIndent\" :33.0,\"afterSpacing\":5.0}}');\n        /* tslint:disable-next-line:max-line-length */\n        this.preDefinedStyles.add('Toc5', '{\"type\":\"Paragraph\",\"name\":\"Toc5\",\"basedOn\":\"Normal\",\"next\":\"Normal\",\"paragraphFormat\":{\"leftIndent\" :44.0,\"afterSpacing\":5.0}}');\n        /* tslint:disable-next-line:max-line-length */\n        this.preDefinedStyles.add('Toc6', '{\"type\":\"Paragraph\",\"name\":\"Toc6\",\"basedOn\":\"Normal\",\"next\":\"Normal\",\"paragraphFormat\":{\"leftIndent\" :55.0,\"afterSpacing\":5.0}}');\n        /* tslint:disable-next-line:max-line-length */\n        this.preDefinedStyles.add('Toc7', '{\"type\":\"Paragraph\",\"name\":\"Toc7\",\"basedOn\":\"Normal\",\"next\":\"Normal\",\"paragraphFormat\":{\"leftIndent\" :66.0,\"afterSpacing\":5.0}}');\n        /* tslint:disable-next-line:max-line-length */\n        this.preDefinedStyles.add('Toc8', '{\"type\":\"Paragraph\",\"name\":\"Toc8\",\"basedOn\":\"Normal\",\"next\":\"Normal\",\"paragraphFormat\":{\"leftIndent\" :77.0,\"afterSpacing\":5.0}}');\n        /* tslint:disable-next-line:max-line-length */\n        this.preDefinedStyles.add('Toc9', '{\"type\":\"Paragraph\",\"name\":\"Toc9\",\"basedOn\":\"Normal\",\"next\":\"Normal\",\"paragraphFormat\":{\"leftIndent\" :88.0,\"afterSpacing\":5.0}}');\n    };\n    /**\n     * @private\n     */\n    LayoutViewer.prototype.clearDocumentItems = function () {\n        this.headersFooters = [];\n        this.fields = [];\n        this.bookmarks.clear();\n        this.styles.clear();\n        this.characterFormat.clearFormat();\n        this.paragraphFormat.clearFormat();\n    };\n    /**\n     * @private\n     */\n    LayoutViewer.prototype.getAbstractListById = function (id) {\n        if (isNullOrUndefined(this.abstractLists)) {\n            return undefined;\n        }\n        for (var i = 0; i < this.abstractLists.length; i++) {\n            var abstractList = this.abstractLists[i];\n            if (abstractList instanceof WAbstractList && abstractList.abstractListId === id) {\n                return abstractList;\n            }\n        }\n        return undefined;\n    };\n    /**\n     * @private\n     */\n    LayoutViewer.prototype.getListById = function (id) {\n        if (isNullOrUndefined(this.lists)) {\n            return undefined;\n        }\n        for (var i = 0; i < this.lists.length; i++) {\n            if (!isNullOrUndefined(this.lists[i]) && this.lists[i].listId === id) {\n                return this.lists[i];\n            }\n        }\n        return undefined;\n    };\n    /**\n     * @private\n     */\n    LayoutViewer.getListLevelNumber = function (listLevel) {\n        if (listLevel.ownerBase instanceof WLevelOverride) {\n            return listLevel.ownerBase.levelNumber;\n        }\n        else if (listLevel.ownerBase instanceof WAbstractList && !isNullOrUndefined(listLevel.ownerBase.levels)) {\n            return listLevel.ownerBase.levels.indexOf(listLevel);\n        }\n        else {\n            return -1;\n        }\n    };\n    /**\n     * Gets the bookmarks.\n     * @private\n     */\n    LayoutViewer.prototype.getBookmarks = function (includeHidden) {\n        var bookmarks = [];\n        for (var i = 0; i < this.bookmarks.keys.length; i++) {\n            var bookmark = this.bookmarks.keys[i];\n            if (includeHidden || bookmark.indexOf('_') !== 0) {\n                bookmarks.push(bookmark);\n            }\n        }\n        return bookmarks;\n    };\n    /**\n     * Initializes components.\n     * @private\n     */\n    LayoutViewer.prototype.initializeComponents = function () {\n        var element = this.owner.element;\n        if (isNullOrUndefined(element)) {\n            return;\n        }\n        var viewer = this;\n        this.viewerContainer = createElement('div', { id: this.owner.containerId + '_viewerContainer' });\n        this.viewerContainer.style.cssText = 'position:relative;backgroundColor:#FBFBFB;overflow:auto';\n        element.appendChild(this.viewerContainer);\n        this.viewerContainer.tabIndex = 0;\n        this.viewerContainer.style.outline = 'none';\n        this.pageContainer = createElement('div', { id: this.owner.containerId + '_pageContainer', className: 'e-de-background' });\n        this.viewerContainer.appendChild(this.pageContainer);\n        this.pageContainer.style.top = '0px';\n        this.pageContainer.style.left = '0px';\n        this.pageContainer.style.position = 'relative';\n        this.pageContainer.style.pointerEvents = 'none';\n        this.editableDiv = document.createElement('div');\n        this.editableDiv.contentEditable = 'true';\n        this.editableDiv.style.position = 'fixed';\n        this.editableDiv.style.left = '-150em';\n        this.editableDiv.style.width = '100%';\n        this.editableDiv.style.height = '100%';\n        this.editableDiv.id = element.id + '_editableDiv';\n        document.body.appendChild(this.editableDiv);\n        if (this.owner.enableImageResizerMode) {\n            this.owner.imageResizerModule.initializeImageResizer();\n        }\n        this.updateViewerSizeInternal(element);\n        this.layout = new Layout(this);\n        this.textHelper = new TextHelper(this);\n        this.zoomModule = new Zoom(this);\n        // let locale: L10n = new L10n('documenteditor', this.owner.defaultLocale);\n        // locale.setLocale(this.owner.locale);\n        // setCulture(this.owner.locale);\n        this.initTouchEllipse();\n        this.wireEvent();\n    };\n    /**\n     * Wires events and methods.\n     */\n    LayoutViewer.prototype.wireEvent = function () {\n        if (!isNullOrUndefined(this.selection)) {\n            this.selection.initCaret();\n        }\n        this.editableDiv.addEventListener('paste', this.onPaste);\n        if (Browser.isIE) {\n            this.editableDiv.addEventListener('keypress', this.onKeyPressInternal);\n        }\n        else {\n            this.editableDiv.addEventListener('input', this.onTextInputInternal);\n        }\n        this.editableDiv.addEventListener('blur', this.onFocusOut);\n        this.editableDiv.addEventListener('keydown', this.onKeyDownInternal);\n        this.editableDiv.addEventListener('compositionstart', this.compositionStart);\n        this.editableDiv.addEventListener('compositionupdate', this.compositionUpdated);\n        this.editableDiv.addEventListener('compositionend', this.compositionEnd);\n        this.viewerContainer.addEventListener('scroll', this.scrollHandler);\n        this.viewerContainer.addEventListener('mousedown', this.onMouseDownInternal);\n        this.viewerContainer.addEventListener('keydown', this.onKeyDownInternal);\n        this.viewerContainer.addEventListener('mousemove', this.onMouseMoveInternal);\n        this.viewerContainer.addEventListener('contextmenu', this.onContextMenu);\n        this.viewerContainer.addEventListener('dblclick', this.onDoubleTap);\n        this.viewerContainer.addEventListener('mouseup', this.onMouseUpInternal);\n        window.addEventListener('resize', this.onWindowResize);\n        window.addEventListener('keyup', this.onKeyUpInternal);\n        window.addEventListener('mouseup', this.onImageResizer);\n        window.addEventListener('touchend', this.onImageResizer);\n        this.viewerContainer.addEventListener('touchstart', this.onTouchStartInternal);\n        this.viewerContainer.addEventListener('touchmove', this.onTouchMoveInternal);\n        this.viewerContainer.addEventListener('touchend', this.onTouchUpInternal);\n        if (navigator.userAgent.match('Firefox')) {\n            this.viewerContainer.addEventListener('DOMMouseScroll', this.zoomModule.onMouseWheelInternal);\n        }\n        this.viewerContainer.addEventListener('mousewheel', this.zoomModule.onMouseWheelInternal);\n    };\n    /**\n     * Initializes dialog template.\n     */\n    LayoutViewer.prototype.initDialog = function () {\n        if (!this.dialogInternal) {\n            this.dialogTarget = createElement('div', { className: 'e-de-dlg-target' });\n            document.body.appendChild(this.dialogTarget);\n            this.dialogInternal = new Dialog({\n                target: document.body, showCloseIcon: true,\n                allowDragging: true, visible: false, width: '1px', isModal: true, position: { X: 'center', Y: 'center' }, zIndex: 20\n            });\n            this.dialogInternal.open = this.selection.hideCaret;\n            this.dialogInternal.beforeClose = this.updateFocus;\n            this.dialogInternal.appendTo(this.dialogTarget);\n        }\n    };\n    /**\n     * Initializes dialog template.\n     */\n    LayoutViewer.prototype.initDialog2 = function () {\n        if (!this.dialogInternal2) {\n            var target = createElement('div', { className: 'e-de-dlg-target' });\n            document.body.appendChild(target);\n            this.dialogInternal2 = new Dialog({\n                target: document.body, showCloseIcon: true,\n                allowDragging: true, visible: false, width: '1px', isModal: true, position: { X: 'center', Y: 'Top' }, zIndex: 10\n            });\n            this.dialogInternal2.appendTo(target);\n        }\n    };\n    /**\n     * Clears the context.\n     * @private\n     */\n    LayoutViewer.prototype.clearContent = function () {\n        this.containerContext.clearRect(0, 0, this.containerCanvas.width, this.containerCanvas.height);\n        this.selectionContext.clearRect(0, 0, this.selectionCanvas.width, this.selectionCanvas.height);\n    };\n    /**\n     * Fired when the document gets changed.\n     * @param {WordDocument} document\n     */\n    LayoutViewer.prototype.onDocumentChanged = function (sections) {\n        this.clearContent();\n        if (this.owner.editorModule) {\n            this.owner.editorModule.tocStyles = {};\n            this.owner.editorModule.tocBookmarkId = 0;\n        }\n        this.heightInfoCollection = {};\n        this.owner.isDocumentLoaded = false;\n        for (var i = 0; i < this.pages.length; i++) {\n            this.pages[i].bodyWidgets[0].destroy();\n        }\n        this.pages = [];\n        if (!isNullOrUndefined(this.renderedLists)) {\n            this.renderedLists.clear();\n        }\n        if (!isNullOrUndefined(this.owner.editorHistory)) {\n            this.owner.editorHistory.destroy();\n        }\n        this.owner.isDocumentLoaded = true;\n        this.layout.isInitialLoad = true;\n        this.layout.layoutItems(sections);\n        if (this.owner.selection) {\n            this.owner.selection.selectRange(this.owner.documentStart, this.owner.documentStart);\n        }\n        if (this.owner.optionsPaneModule) {\n            this.owner.optionsPaneModule.showHideOptionsPane(false);\n        }\n        this.owner.fireDocumentChange();\n    };\n    /**\n     * Initialize touch ellipse.\n     */\n    LayoutViewer.prototype.initTouchEllipse = function () {\n        var style = 'height: 30px;width: 30px;position: absolute;background-color: transparent;margin: 0px;padding: 0px;z-index:5';\n        // tslint:disable-next-line:max-line-length\n        var ellipse = ' height: 12px;width: 12px;border-radius: 50%;background-color: white;position: absolute;margin: 0px 6px 0px 6px;border-width: 2px;border-style: solid;border-color: #000000;';\n        this.touchStart = createElement('div', { className: 'e-touch-ellipse', styles: style });\n        var start = createElement('div', { styles: ellipse });\n        this.touchEnd = createElement('div', { className: 'e-touch-ellipse', styles: style });\n        this.touchStart.style.display = 'none';\n        var end = createElement('div', { styles: ellipse });\n        this.touchStart.appendChild(start);\n        this.touchEnd.appendChild(end);\n        this.touchEnd.style.display = 'none';\n        this.viewerContainer.appendChild(this.touchStart);\n        this.viewerContainer.appendChild(this.touchEnd);\n    };\n    /**\n     * Updates touch mark position.\n     * @private\n     */\n    LayoutViewer.prototype.updateTouchMarkPosition = function () {\n        if (this.touchStart.style.display !== 'none' && !isNullOrUndefined(this.selection)) {\n            if (!this.selection.isEmpty) {\n                var y = this.selection.getCaretBottom(this.selection.start, false);\n                var page = this.selection.getPage(this.selection.start.paragraph);\n                var viewer = this;\n                // tslint:disable-next-line:max-line-length\n                var pageTop = (page.boundingRectangle.y - viewer.pageGap * (this.pages.indexOf(page) + 1)) * this.zoomFactor + viewer.pageGap * (this.pages.indexOf(page) + 1);\n                // tslint:disable-next-line:max-line-length\n                this.touchStart.style.left = page.boundingRectangle.x + (Math.round(this.selection.start.location.x) * this.zoomFactor - 14) + 'px';\n                this.touchStart.style.top = pageTop + ((y) * this.zoomFactor) + 'px';\n                if (!this.selection.isEmpty) {\n                    y = this.selection.getCaretBottom(this.selection.end, false);\n                    page = this.selection.getPage(this.selection.end.paragraph);\n                }\n                // tslint:disable-next-line:max-line-length\n                this.touchEnd.style.left = page.boundingRectangle.x + (Math.round(this.selection.end.location.x) * this.zoomFactor - 14) + 'px';\n                this.touchEnd.style.top = pageTop + (y * this.zoomFactor) + 'px';\n            }\n            else {\n                this.selection.updateCaretPosition();\n            }\n        }\n    };\n    LayoutViewer.prototype.isSelectionInListText = function (cursorPoint) {\n        var widget = this.getLineWidget(cursorPoint);\n        if (!isNullOrUndefined(widget) && widget.children[0] instanceof ListTextElementBox) {\n            var left = this.getLeftValue(widget);\n            var width = widget.children[0].width;\n            var height = widget.children[0].height;\n            if (this.isInsideRect(left, widget.paragraph.y, width, height, cursorPoint)) {\n                this.selectionLineWidget = widget;\n                return true;\n            }\n        }\n        return false;\n    };\n    /**\n     * Check whether touch point is inside the rectangle or not.\n     * @param x\n     * @param y\n     * @param width\n     * @param height\n     * @param touchPoint\n     * @private\n     */\n    LayoutViewer.prototype.isInsideRect = function (x, y, width, height, touchPoint) {\n        if ((touchPoint.x > x && touchPoint.x <= x + width) && (touchPoint.y > y && touchPoint.y <= y + height)) {\n            return true;\n        }\n        return false;\n    };\n    /**\n     * @private\n     */\n    LayoutViewer.prototype.getLeftValue = function (widget) {\n        var left = widget.paragraph.x;\n        var paragraphFormat = widget.paragraph.paragraphFormat;\n        if (this.selection.isParagraphFirstLine(widget)) {\n            if (paragraphFormat.textAlignment === 'Right') {\n                left -= HelperMethods.convertPointToPixel(paragraphFormat.firstLineIndent);\n                left -= HelperMethods.convertPointToPixel(paragraphFormat.leftIndent);\n            }\n            else {\n                left += HelperMethods.convertPointToPixel(paragraphFormat.firstLineIndent);\n            }\n        }\n        var element = widget.children[0];\n        if (element instanceof ListTextElementBox) {\n            left += element.margin.left;\n        }\n        return left;\n    };\n    /**\n     * Checks whether left mouse button is pressed or not.\n     */\n    LayoutViewer.prototype.isLeftButtonPressed = function (event) {\n        this.isTouchInput = false;\n        var button = event.which || event.button;\n        return button === 1;\n    };\n    /**\n     * Gets touch offset value.\n     */\n    LayoutViewer.prototype.getTouchOffsetValue = function (event) {\n        var targetElement = this.viewerContainer;\n        var offset = targetElement.getBoundingClientRect();\n        var touchOffsetValues = event.touches[0];\n        if (isNullOrUndefined(touchOffsetValues)) {\n            touchOffsetValues = event.changedTouches[0];\n        }\n        var offsetX = touchOffsetValues.pageX - offset.left;\n        var offsetY = touchOffsetValues.pageY - offset.top;\n        return new Point(offsetX, offsetY);\n    };\n    /**\n     * Fired on pinch zoom in.\n     * @param {TouchEvent} event\n     */\n    LayoutViewer.prototype.onPinchInInternal = function (event) {\n        this.preZoomFactor = this.zoomFactor;\n        var updatedZoomFactor = this.zoomFactor - 0.01;\n        if (updatedZoomFactor < 5 && updatedZoomFactor > 2) {\n            updatedZoomFactor = updatedZoomFactor - 0.01;\n        }\n        if (updatedZoomFactor < 0.1) {\n            updatedZoomFactor = 0.1;\n        }\n        this.zoomFactor = updatedZoomFactor;\n    };\n    /**\n     * Fired on pinch zoom out.\n     * @param {TouchEvent} event\n     */\n    LayoutViewer.prototype.onPinchOutInternal = function (event) {\n        this.preZoomFactor = this.zoomFactor;\n        var updatedZoomFactor = this.zoomFactor + 0.01;\n        if (updatedZoomFactor > 2) {\n            updatedZoomFactor = updatedZoomFactor + 0.01;\n        }\n        if (updatedZoomFactor > 5) {\n            updatedZoomFactor = 5;\n        }\n        this.zoomFactor = updatedZoomFactor;\n    };\n    /**\n     * Gets page width.\n     * @private\n     */\n    LayoutViewer.prototype.getPageWidth = function (page) {\n        var width = page.boundingRectangle.width;\n        return width;\n    };\n    /**\n     * Removes specified page.\n     * @private\n     */\n    LayoutViewer.prototype.removePage = function (page) {\n        if (this.currentPage === page) {\n            this.currentPage = undefined;\n        }\n        var index = this.pages.indexOf(page);\n        // if (index > -1) {\n        this.pages.splice(index, 1);\n        // }        \n        //this.removeRenderedPages();\n        var viewer = this;\n        if (!isNullOrUndefined(viewer.visiblePages)) {\n            if ((viewer.visiblePages).indexOf(page) > -1) {\n                var pageIndex = (viewer.visiblePages).indexOf(page);\n                (viewer.visiblePages).splice(pageIndex, 1);\n            }\n        }\n        //(viewer as PageLayoutViewer).visiblePages.remove(page);\n        var height = 0;\n        for (var i = 0; i < this.pages.length; i++) {\n            height = height + this.pages[i].boundingRectangle.height;\n        }\n        //Updates the vertical height.\n        height -= page.boundingRectangle.height + 20;\n        //ToDo:Update horizontal width, if removed page has max width.\n        var top = 20;\n        if (index > 0) {\n            top += this.pages[index - 1].boundingRectangle.bottom;\n        }\n        if (index !== -1) {\n            for (var i = index; i < this.pages.length; i++) {\n                //Update bounding rectangle of next pages in collection.\n                page = this.pages[i];\n                // tslint:disable-next-line:max-line-length\n                page.boundingRectangle = new Rect(page.boundingRectangle.x, top, page.boundingRectangle.width, page.boundingRectangle.height);\n                top = page.boundingRectangle.bottom + 20;\n                page.repeatHeaderRowTableWidget = false;\n            }\n        }\n    };\n    // private removeRenderedPages(): void {\n    //     for (let i: number = 0; i < this.pages.length; i++) {\n    //         this.clearContainer(this.pages[i]);\n    //     }\n    // }\n    /**\n     * Updates viewer size on window resize.\n     * @private\n     */\n    LayoutViewer.prototype.updateViewerSize = function () {\n        var viewer = this;\n        var element = this.owner.getDocumentEditorElement();\n        viewer.updateViewerSizeInternal(element);\n        viewer.updateScrollBars();\n        if (!isNullOrUndefined(this.selection)) {\n            this.selection.updateCaretPosition();\n        }\n    };\n    /**\n     * Updates viewer size.\n     */\n    LayoutViewer.prototype.updateViewerSizeInternal = function (element) {\n        if (!isNullOrUndefined(element)) {\n            var rect = element.getBoundingClientRect();\n            var width = 0;\n            var height = 0;\n            height = rect.height > 0 ? rect.height : 200;\n            if (this.owner.optionsPaneModule && this.owner.optionsPaneModule.isOptionsPaneShow) {\n                var optionsRect = this.owner.optionsPaneModule.optionsPane.getBoundingClientRect();\n                width = (rect.width - optionsRect.width) > 0 ? (rect.width - optionsRect.width) : 200;\n            }\n            else {\n                width = rect.width > 0 ? rect.width : 200;\n            }\n            this.viewerContainer.style.height = height.toString() + 'px';\n            this.viewerContainer.style.width = Math.ceil(width) + 'px';\n            this.visibleBoundsIn = new Rect(0, 0, width, height);\n            this.containerCanvas.width = width;\n            this.containerCanvas.height = height;\n            this.selectionCanvas.width = width;\n            this.selectionCanvas.height = height;\n        }\n    };\n    /**\n     * Updates client area for block.\n     * @private\n     */\n    LayoutViewer.prototype.updateClientAreaForBlock = function (block, beforeLayout, tableCollection) {\n        var leftIndent = HelperMethods.convertPointToPixel(block.leftIndent);\n        var rightIndent = HelperMethods.convertPointToPixel(block.rightIndent);\n        if (beforeLayout) {\n            if (block instanceof TableWidget && tableCollection) {\n                var tableWidget = tableCollection[0];\n                this.clientActiveArea.x = this.clientArea.x = tableWidget.x;\n                this.clientActiveArea.width = this.clientArea.width = tableWidget.width;\n                //Updates the location of last item.\n                tableWidget = tableCollection[tableCollection.length - 1];\n                tableWidget.x = this.clientActiveArea.x;\n                tableWidget.y = this.clientActiveArea.y;\n                this.clientArea = new Rect(this.clientArea.x, this.clientArea.y, this.clientArea.width, this.clientArea.height);\n                // tslint:disable-next-line:max-line-length\n                this.clientActiveArea = new Rect(this.clientActiveArea.x, this.clientActiveArea.y, this.clientActiveArea.width, this.clientActiveArea.height);\n            }\n            else {\n                // tslint:disable-next-line:max-line-length\n                if (block instanceof TableWidget && !isNullOrUndefined(block.tableFormat) && block.tableFormat.tableAlignment !== 'Left') {\n                    if (!block.isGridUpdated) {\n                        block.buildTableColumns();\n                        block.isGridUpdated = true;\n                    }\n                    var tableWidth = block.getMaxRowWidth(block.getTableClientWidth(block.getOwnerWidth(false)));\n                    // Fore resizing table, the tableholder table width taken for updated width. \n                    // Since, the columns will be cleared if we performed resizing.\n                    if (this.owner.editor && this.owner.editor.tableResize.currentResizingTable === block\n                        && this.owner.editor.tableResize.resizerPosition === 0) {\n                        tableWidth = block.tableHolder.tableWidth;\n                    }\n                    tableWidth = HelperMethods.convertPointToPixel(tableWidth);\n                    if (block.tableFormat.tableAlignment === 'Center') {\n                        leftIndent = (this.clientArea.width - tableWidth) / 2;\n                    }\n                    else {\n                        leftIndent = this.clientArea.width - tableWidth;\n                    }\n                    this.tableLefts.push(leftIndent);\n                }\n                this.clientActiveArea.x = this.clientArea.x = this.clientArea.x + leftIndent;\n                var width = this.clientArea.width - (leftIndent + rightIndent);\n                this.clientActiveArea.width = this.clientArea.width = width > 0 ? width : 0;\n                // tslint:disable-next-line:max-line-length\n                this.clientArea = new Rect(this.clientArea.x, this.clientArea.y, this.clientArea.width, this.clientArea.height);\n                // tslint:disable-next-line:max-line-length\n                this.clientActiveArea = new Rect(this.clientActiveArea.x, this.clientActiveArea.y, this.clientActiveArea.width, this.clientActiveArea.height);\n            }\n        }\n        else {\n            // tslint:disable-next-line:max-line-length\n            if (block instanceof TableWidget && block.tableFormat.tableAlignment !== 'Left' && this.tableLefts.length > 0) {\n                leftIndent = this.tableLefts.pop();\n            }\n            this.clientActiveArea.x = this.clientArea.x = this.clientArea.x - leftIndent;\n            var width = this.clientArea.width + leftIndent + rightIndent;\n            this.clientActiveArea.width = this.clientArea.width = width > 0 ? width : 0;\n            this.clientArea = new Rect(this.clientArea.x, this.clientArea.y, this.clientArea.width, this.clientArea.height);\n            // tslint:disable-next-line:max-line-length\n            this.clientActiveArea = new Rect(this.clientActiveArea.x, this.clientActiveArea.y, this.clientActiveArea.width, this.clientActiveArea.height);\n        }\n    };\n    /**\n     * Updates client active area left.\n     * @private\n     */\n    LayoutViewer.prototype.cutFromLeft = function (x) {\n        if (x < this.clientActiveArea.x) {\n            x = this.clientActiveArea.x;\n        }\n        if (x > this.clientActiveArea.right && this.textWrap) {\n            x = this.clientActiveArea.right;\n        }\n        this.clientActiveArea.width = this.clientActiveArea.right > x ? this.clientActiveArea.right - x : 0;\n        this.clientActiveArea.x = x;\n    };\n    /**\n     * Updates client active area top.\n     * @private\n     */\n    LayoutViewer.prototype.cutFromTop = function (y) {\n        if (y < this.clientActiveArea.y) {\n            y = this.clientActiveArea.y;\n        }\n        if (y > this.clientActiveArea.bottom) {\n            y = this.clientActiveArea.bottom;\n        }\n        this.clientActiveArea.height = this.clientActiveArea.bottom - y;\n        this.clientActiveArea.x = this.clientArea.x;\n        this.clientActiveArea.width = this.clientArea.width;\n        this.clientActiveArea.y = y;\n    };\n    /**\n     * Updates client width.\n     * @private\n     */\n    LayoutViewer.prototype.updateClientWidth = function (width) {\n        this.clientActiveArea.x -= width;\n        if (this.clientActiveArea.width + width > 0) {\n            this.clientActiveArea.width += width;\n        }\n        else {\n            this.clientActiveArea.width = 0;\n        }\n    };\n    /**\n     * Inserts page in specified index.\n     * @private\n     */\n    LayoutViewer.prototype.insertPage = function (index, page) {\n        if (this.pages.indexOf(page) > -1) {\n            this.pages.splice(this.pages.indexOf(page), 1);\n        }\n        this.pages.splice(index, 0, page);\n        var top = 20;\n        if (index > 0) {\n            top += this.pages[index - 1].boundingRectangle.bottom;\n        }\n        for (var i = index; i < this.pages.length; i++) {\n            //Update bounding rectangle of next pages in collection.\n            page = this.pages[i];\n            page.boundingRectangle = new Rect(page.boundingRectangle.x, top, page.boundingRectangle.width, page.boundingRectangle.height);\n            top = page.boundingRectangle.bottom + 20;\n        }\n    };\n    /**\n     * Updates client area.\n     * @private\n     */\n    LayoutViewer.prototype.updateClientArea = function (sectionFormat, page) {\n        var top = 0;\n        var headerDistance = 48;\n        var footerDistance = 48;\n        var pageHeight = HelperMethods.convertPointToPixel(sectionFormat.pageHeight);\n        var bottomMargin = HelperMethods.convertPointToPixel(sectionFormat.bottomMargin);\n        if (!isNullOrUndefined(sectionFormat)) {\n            top = HelperMethods.convertPointToPixel(sectionFormat.topMargin);\n            headerDistance = HelperMethods.convertPointToPixel(sectionFormat.headerDistance);\n            footerDistance = HelperMethods.convertPointToPixel(sectionFormat.footerDistance);\n        }\n        if (!isNullOrUndefined(page.headerWidget)) {\n            top = Math.min(Math.max(headerDistance + page.headerWidget.height, top), pageHeight / 100 * 40);\n        }\n        var bottom = 0.667 + bottomMargin;\n        if (!isNullOrUndefined(page.footerWidget)) {\n            bottom = 0.667 + Math.min(pageHeight / 100 * 40, Math.max(footerDistance + page.footerWidget.height, bottomMargin));\n        }\n        var width = 0;\n        var height = 0;\n        if (!isNullOrUndefined(sectionFormat)) {\n            width = HelperMethods.convertPointToPixel(sectionFormat.pageWidth - sectionFormat.leftMargin - sectionFormat.rightMargin);\n            height = pageHeight - top - bottom;\n        }\n        if (width < 0) {\n            width = 0;\n        }\n        this.clientArea = new Rect(HelperMethods.convertPointToPixel(sectionFormat.leftMargin), top, width, pageHeight - top - bottom);\n        this.clientActiveArea = new Rect(this.clientArea.x, this.clientArea.y, this.clientArea.width, this.clientArea.height);\n    };\n    /**\n     * Updates client area left or top position.\n     * @private\n     */\n    LayoutViewer.prototype.updateClientAreaTopOrLeft = function (tableWidget, beforeLayout) {\n        if (beforeLayout) {\n            this.clientActiveArea.y = this.clientActiveArea.y + tableWidget.topBorderWidth;\n            this.clientActiveArea.x = this.clientActiveArea.x + tableWidget.leftBorderWidth;\n        }\n    };\n    /**\n     * Updates client area for table.\n     * @private\n     */\n    LayoutViewer.prototype.updateClientAreaForTable = function (tableWidget) {\n        this.clientActiveArea.x = this.clientArea.x = tableWidget.x;\n        this.clientActiveArea.width = this.clientArea.width = tableWidget.width;\n    };\n    /**\n     * Updates client area for row.\n     * @private\n     */\n    LayoutViewer.prototype.updateClientAreaForRow = function (row, beforeLayout) {\n        // tslint:disable-next-line:max-line-length\n        var tableWidget = row.ownerTable;\n        if (beforeLayout) {\n            //tslint:disable:no-empty\n        }\n        else {\n            this.clientActiveArea.x = this.clientArea.x = tableWidget.x;\n            this.clientActiveArea.width = this.clientArea.width = tableWidget.width;\n            this.clientArea = new Rect(this.clientArea.x, this.clientArea.y, this.clientArea.width, this.clientArea.height);\n            // tslint:disable-next-line:max-line-length\n            this.clientActiveArea = new Rect(this.clientActiveArea.x, this.clientActiveArea.y, this.clientActiveArea.width, this.clientActiveArea.height);\n        }\n    };\n    /**\n     * Updates client area for cell.\n     * @private\n     */\n    LayoutViewer.prototype.updateClientAreaForCell = function (cell, beforeLayout) {\n        // tslint:disable-next-line:max-line-length\n        var rowWidget = cell.ownerRow;\n        var cellWidget = cell;\n        if (beforeLayout) {\n            this.clientActiveArea.x = this.clientArea.x = cellWidget.x;\n            this.clientActiveArea.y = cellWidget.y;\n            this.clientActiveArea.width = this.clientArea.width = cellWidget.width > 0 ? cellWidget.width : 0;\n            if (this instanceof PageLayoutViewer) {\n                this.clientActiveArea.height = Number.POSITIVE_INFINITY;\n            }\n            this.clientArea = new Rect(this.clientArea.x, this.clientArea.y, this.clientArea.width, this.clientArea.height);\n            // tslint:disable-next-line:max-line-length\n            this.clientActiveArea = new Rect(this.clientActiveArea.x, this.clientActiveArea.y, this.clientActiveArea.width, this.clientActiveArea.height);\n        }\n        else {\n            this.clientActiveArea.x = this.clientArea.x = cellWidget.x + cellWidget.width + cellWidget.margin.right;\n            if (rowWidget.x + rowWidget.width - this.clientArea.x < 0) {\n                this.clientActiveArea.width = this.clientArea.width = 0;\n            }\n            else {\n                this.clientActiveArea.width = this.clientArea.width = rowWidget.x + rowWidget.width - this.clientArea.x;\n            }\n            // tslint:disable-next-line:max-line-length\n            this.clientActiveArea.y = cellWidget.y - cellWidget.margin.top - HelperMethods.convertPointToPixel(cell.ownerTable.tableFormat.cellSpacing);\n            if (!cell.ownerTable.isInsideTable) {\n                this.clientActiveArea.height = this.clientArea.bottom - rowWidget.y > 0 ? this.clientArea.bottom - rowWidget.y : 0;\n            }\n            this.clientArea = new Rect(this.clientArea.x, this.clientArea.y, this.clientArea.width, this.clientArea.height);\n            // tslint:disable-next-line:max-line-length\n            this.clientActiveArea = new Rect(this.clientActiveArea.x, this.clientActiveArea.y, this.clientActiveArea.width, this.clientActiveArea.height);\n        }\n    };\n    /**\n     * Updates the client area based on widget.\n     * @private\n     */\n    LayoutViewer.prototype.updateClientAreaByWidget = function (widget) {\n        this.clientArea.x = widget.x;\n        this.clientArea.y = widget.y;\n        this.clientActiveArea.x = widget.x;\n        this.clientActiveArea.y = widget.y;\n    };\n    //Widget\n    /**\n     * Updates client area location.\n     * @param widget\n     * @param area\n     * @private\n     */\n    LayoutViewer.prototype.updateClientAreaLocation = function (widget, area) {\n        widget.x = area.x;\n        widget.y = area.y;\n        widget.width = area.width;\n    };\n    /**\n     * Updates text position for selection.\n     * @param cursorPoint\n     * @param tapCount\n     * @param clearMultiSelection\n     * @private\n     */\n    LayoutViewer.prototype.updateTextPositionForSelection = function (cursorPoint, tapCount) {\n        var widget = this.getLineWidget(cursorPoint);\n        if (!isNullOrUndefined(widget)) {\n            this.selection.updateTextPosition(widget, cursorPoint);\n        }\n        if (tapCount > 1) {\n            this.isMouseDown = false;\n            this.useTouchSelectionMark = false;\n            if (this.pages.length === 0) {\n                return;\n            }\n            //Double tap/triple tap selection\n            if (!isNullOrUndefined(this.currentPage) && !isNullOrUndefined(this.owner.selection.start)) {\n                if (tapCount % 2 === 0) {\n                    this.owner.selection.selectCurrentWord();\n                }\n                else {\n                    this.owner.selection.selectCurrentParagraph();\n                }\n            }\n        }\n    };\n    /**\n     * Scrolls to specified position.\n     * @param startPosition\n     * @param endPosition\n     * @private\n     */\n    LayoutViewer.prototype.scrollToPosition = function (startPosition, endPosition) {\n        if (this.owner.enableImageResizerMode && this.owner.imageResizerModule.isImageResizing\n            || this.isMouseDownInFooterRegion || this.isRowOrCellResizing) {\n            return;\n        }\n        var lineWidget = this.selection.getLineWidgetInternal(endPosition.currentWidget, endPosition.offset, true);\n        if (isNullOrUndefined(lineWidget)) {\n            return;\n        }\n        var top = this.selection.getTop(lineWidget);\n        if (this.isMouseDown) {\n            var prevLineWidget = this.selection.getLineWidgetInternal(endPosition.currentWidget, endPosition.offset, false);\n            var prevTop = this.selection.getTop(prevLineWidget);\n            if (prevLineWidget !== lineWidget && endPosition.location.y >= prevTop) {\n                lineWidget = prevLineWidget;\n            }\n        }\n        var height = lineWidget.height;\n        //Gets current page.\n        var endPage = this.selection.getPage(lineWidget.paragraph);\n        this.currentPage = endPage;\n        var x = 0;\n        var y = 0;\n        var viewer = this;\n        var horizontalWidth = 0;\n        var isPageLayout = viewer instanceof PageLayoutViewer;\n        if (isPageLayout) {\n            var pageLayout = viewer;\n            if (isNullOrUndefined(endPage)) {\n                return;\n            }\n            var pageWidth = endPage.boundingRectangle.width;\n            x = (this.visibleBounds.width - pageWidth * this.zoomFactor) / 2;\n            if (x < 30) {\n                x = 30;\n            }\n            // tslint:disable-next-line:max-line-length\n            y = endPage.boundingRectangle.y * this.zoomFactor + (this.pages.indexOf(endPage) + 1) * viewer.pageGap * (1 - this.zoomFactor);\n        }\n        var scrollTop = this.containerTop;\n        var scrollLeft = this.containerLeft;\n        var pageHeight = this.visibleBounds.height;\n        var caretInfo = this.selection.updateCaretSize(this.owner.selection.end, true);\n        var topMargin = caretInfo.topMargin;\n        var caretHeight = caretInfo.height;\n        x += (endPosition.location.x) * this.zoomFactor;\n        y += (endPosition.location.y + topMargin) * this.zoomFactor;\n        //vertical scroll bar update\n        if ((scrollTop + 20) > y) {\n            this.viewerContainer.scrollTop = (y - 10);\n        }\n        else if (scrollTop + pageHeight < y + caretHeight) {\n            this.viewerContainer.scrollTop = y + caretHeight - pageHeight + 10;\n        }\n        else {\n            this.selection.updateCaretToPage(startPosition, endPage);\n        }\n        this.selection.updateCaretToPage(startPosition, endPage);\n        var scrollBarWidth = this.viewerContainer.offsetWidth - this.viewerContainer.clientWidth;\n        if (scrollLeft > x) {\n            this.viewerContainer.scrollLeft = x - (viewer.pageContainer.offsetWidth / 100) * 20;\n        }\n        else if (scrollLeft + this.visibleBounds.width < x + scrollBarWidth) {\n            this.viewerContainer.scrollLeft = scrollLeft + (viewer.pageContainer.offsetWidth / 100) * 15 + scrollBarWidth;\n        }\n    };\n    /**\n     * Gets line widget using cursor point.\n     * @private\n     */\n    LayoutViewer.prototype.getLineWidget = function (cursorPoint) {\n        return this.getLineWidgetInternal(cursorPoint, false);\n    };\n    /**\n     * Gets line widget.\n     * @private\n     */\n    LayoutViewer.prototype.getLineWidgetInternal = function (cursorPoint, isMouseDragged) {\n        var widget = undefined;\n        if (!isNullOrUndefined(this.currentPage)) {\n            var childWidgets = void 0;\n            if (this.owner.enableHeaderAndFooter) {\n                var page = this.currentPage;\n                var pageTop = this.selection.getPageTop(page);\n                var pageBottom = page.boundingRectangle.height;\n                var headerHeight = Math.max((page.headerWidget.y + page.headerWidget.height), HelperMethods.convertPointToPixel(page.bodyWidgets[0].sectionFormat.topMargin)) * this.zoomFactor;\n                var footerDistance = HelperMethods.convertPointToPixel(page.bodyWidgets[0].sectionFormat.footerDistance);\n                var footerHeight = (page.boundingRectangle.height -\n                    Math.max(page.footerWidget.height + footerDistance, footerDistance * 2));\n                if (isMouseDragged) {\n                    if (this.isBlockInHeader(this.selection.start.paragraph)) {\n                        childWidgets = this.currentPage.headerWidget;\n                    }\n                    else {\n                        childWidgets = this.currentPage.footerWidget;\n                    }\n                }\n                else {\n                    if (cursorPoint.y <= pageBottom && cursorPoint.y >= footerHeight) {\n                        childWidgets = this.currentPage.footerWidget;\n                    }\n                    else if ((cursorPoint.y) >= 0 && (cursorPoint.y) <= headerHeight) {\n                        childWidgets = this.currentPage.headerWidget;\n                    }\n                }\n                if (isNullOrUndefined(childWidgets)) {\n                    return undefined;\n                }\n                return this.selection.getLineWidgetBodyWidget(childWidgets, cursorPoint);\n            }\n            else {\n                for (var i = 0; i < this.currentPage.bodyWidgets.length; i++) {\n                    var bodyWidgets = this.currentPage.bodyWidgets[i];\n                    widget = this.selection.getLineWidgetBodyWidget(bodyWidgets, cursorPoint);\n                    if (!isNullOrUndefined(widget)) {\n                        break;\n                    }\n                }\n            }\n        }\n        return widget;\n    };\n    /**\n     * @private\n     */\n    LayoutViewer.prototype.isBlockInHeader = function (block) {\n        while (!(block.containerWidget instanceof HeaderFooterWidget)) {\n            if (!block.containerWidget) {\n                return false;\n            }\n            block = block.containerWidget;\n        }\n        return block.containerWidget.headerFooterType.indexOf('Header') !== -1;\n    };\n    /**\n     * Clears selection highlight.\n     * @private\n     */\n    LayoutViewer.prototype.clearSelectionHighlight = function () {\n        var canClear = true;\n        canClear = (!this.isControlPressed || !this.isMouseDown);\n        // if (this.owner.selection.selectionRanges.length > 0 && canClear) {\n        if (this.owner.selection.clearSelectionHighlightInSelectedWidgets()) {\n            this.selectionContext.clearRect(0, 0, this.selectionCanvas.width, this.selectionCanvas.height);\n        }\n        // } else if (!isNullOrUndefined(this.owner.selection.currentSelectionRange) && this.isMouseDown) {\n        //     this.owner.selection.currentSelectionRange.clearSelectionHighlight();\n        // }\n        //this.renderVisiblePages();\n    };\n    /**\n     * @private\n     */\n    LayoutViewer.prototype.removeEmptyPages = function () {\n        var scrollToLastPage = false;\n        var viewer = this;\n        for (var j = 0; j < this.pages.length; j++) {\n            var page = this.pages[j];\n            if (page.bodyWidgets.length === 0 || page.bodyWidgets[0].childWidgets.length === 0) {\n                // tslint:disable-next-line:max-line-length\n                if (j === this.pages.length - 1 && viewer instanceof PageLayoutViewer && viewer.visiblePages.indexOf(this.pages[j]) !== -1) {\n                    scrollToLastPage = true;\n                }\n                this.removePage(this.pages[j]);\n                j--;\n            }\n        }\n        if (scrollToLastPage) {\n            this.scrollToBottom();\n        }\n    };\n    /**\n     * @private\n     */\n    LayoutViewer.prototype.scrollToBottom = function () {\n        if (this.selection.start.paragraph && this.selection.start.paragraph.bodyWidget) {\n            var page = this.selection.start.paragraph.bodyWidget.page;\n            var containerHeight = this.visibleBounds.height;\n            this.viewerContainer.scrollTop = page.boundingRectangle.bottom - containerHeight;\n        }\n    };\n    /**\n     * Returns the field code result.\n     * @private\n     */\n    LayoutViewer.prototype.getFieldResult = function (fieldBegin, page) {\n        if (!isNullOrUndefined(page) && !isNullOrUndefined(this.selection)) {\n            var fieldCode = this.selection.getFieldCode(fieldBegin);\n            var fieldCodes = fieldCode.split('\\*');\n            if (fieldCodes.length > 1) {\n                var fieldCategory = fieldCodes[0].replace(/[^\\w\\s]/gi, '').trim().toLowerCase();\n                var fieldPattern = fieldCodes[1].replace(/[^\\w\\s]/gi, '').trim();\n                switch (fieldCategory) {\n                    case 'page':\n                        return this.getFieldText(fieldPattern, (page.index + 1));\n                    case 'numpages':\n                        return this.getFieldText(fieldPattern, page.viewer.pages.length);\n                    default:\n                        break;\n                }\n            }\n        }\n        return '';\n    };\n    /**\n     * Returns field text.\n     */\n    LayoutViewer.prototype.getFieldText = function (pattern, value) {\n        switch (pattern) {\n            case 'ALPHABETIC':\n                return this.layout.getAsLetter(value).toUpperCase();\n            case 'alphabetic':\n                return this.layout.getAsLetter(value).toLowerCase();\n            case 'roman':\n                return this.layout.getAsRoman(value).toLowerCase();\n            case 'ROMAN':\n                return this.layout.getAsRoman(value).toUpperCase();\n            default:\n                return value.toString();\n        }\n    };\n    /**\n     * Destroys the internal objects maintained for control.\n     */\n    LayoutViewer.prototype.destroy = function () {\n        if (!isNullOrUndefined(this.owner)) {\n            this.unWireEvent();\n        }\n        this.pages = [];\n        this.pages = undefined;\n        this.fieldStacks = [];\n        this.fieldStacks = undefined;\n        this.splittedCellWidgets = [];\n        this.splittedCellWidgets = undefined;\n        this.fields = [];\n        this.fields = undefined;\n        if (this.layout) {\n            this.layout.destroy();\n        }\n        this.layout = undefined;\n        if (!isNullOrUndefined(this.render)) {\n            this.render.destroy();\n        }\n        this.render = undefined;\n        if (this.dialogInternal) {\n            this.dialogInternal.destroy();\n        }\n        this.dialogInternal = undefined;\n        if (this.dialogTarget && this.dialogTarget.parentElement) {\n            this.dialogTarget.parentElement.removeChild(this.dialogTarget);\n        }\n        this.dialogTarget = undefined;\n        if (!isNullOrUndefined(this.touchStart)) {\n            this.touchStart.innerHTML = '';\n        }\n        if (this.textHelper) {\n            this.textHelper.destroy();\n        }\n        this.textHelper = undefined;\n        this.touchStart = undefined;\n        if (!isNullOrUndefined(this.touchEnd)) {\n            this.touchEnd.innerHTML = '';\n        }\n        this.touchEnd = undefined;\n        if (!isNullOrUndefined(this.containerCanvasIn)) {\n            this.containerCanvasIn.innerHTML = '';\n        }\n        this.containerCanvasIn = undefined;\n        if (!isNullOrUndefined(this.selectionCanvasIn)) {\n            this.selectionCanvasIn.innerHTML = '';\n        }\n        this.selectionCanvasIn = undefined;\n        if (!isNullOrUndefined(this.editableDiv)) {\n            this.editableDiv.innerHTML = '';\n            this.editableDiv.parentElement.removeChild(this.editableDiv);\n        }\n        this.editableDiv = undefined;\n        if (!isNullOrUndefined(this.pageContainer)) {\n            this.pageContainer.innerHTML = '';\n        }\n        this.pageContainer = undefined;\n        if (!isNullOrUndefined(this.viewerContainer)) {\n            this.viewerContainer.innerHTML = '';\n        }\n        this.viewerContainer = undefined;\n        this.owner = undefined;\n        this.heightInfoCollection = undefined;\n    };\n    /**\n     * Un-Wires events and methods\n     */\n    LayoutViewer.prototype.unWireEvent = function () {\n        this.viewerContainer.removeEventListener('scroll', this.scrollHandler);\n        this.viewerContainer.removeEventListener('mousedown', this.onMouseDownInternal);\n        this.viewerContainer.removeEventListener('mousemove', this.onMouseMoveInternal);\n        if (Browser.isIE) {\n            this.editableDiv.removeEventListener('keypress', this.onKeyPressInternal);\n        }\n        else {\n            this.editableDiv.removeEventListener('input', this.onTextInputInternal);\n        }\n        this.editableDiv.removeEventListener('paste', this.onPaste);\n        this.viewerContainer.removeEventListener('contextmenu', this.onContextMenu);\n        this.editableDiv.removeEventListener('blur', this.onFocusOut);\n        this.editableDiv.removeEventListener('keydown', this.onKeyDownInternal);\n        this.editableDiv.removeEventListener('compositionstart', this.compositionStart);\n        this.editableDiv.removeEventListener('compositionupdate', this.compositionUpdated);\n        this.editableDiv.removeEventListener('compositionend', this.compositionEnd);\n        this.viewerContainer.removeEventListener('mouseup', this.onMouseUpInternal);\n        this.viewerContainer.removeEventListener('dblclick', this.onDoubleTap);\n        window.removeEventListener('resize', this.onWindowResize);\n        window.removeEventListener('keyup', this.onKeyUpInternal);\n        window.removeEventListener('mouseup', this.onImageResizer);\n        window.removeEventListener('touchend', this.onImageResizer);\n    };\n    return LayoutViewer;\n}());\nexport { LayoutViewer };\n/**\n * @private\n */\nvar PageLayoutViewer = /** @class */ (function (_super) {\n    __extends(PageLayoutViewer, _super);\n    /**\n     * Initialize the constructor of PageLayoutViewer\n     */\n    function PageLayoutViewer(owner) {\n        var _this = _super.call(this, owner) || this;\n        _this.pageLeft = 30;\n        /**\n         * @private\n         */\n        _this.pageGap = 20;\n        /**\n         * @private\n         */\n        _this.visiblePages = [];\n        if (isNullOrUndefined(owner) || isNullOrUndefined(owner.element)) {\n            return _this;\n        }\n        return _this;\n    }\n    /**\n     * Creates new page.\n     * @private\n     */\n    PageLayoutViewer.prototype.createNewPage = function (section, index) {\n        var viewer = this;\n        var yPos = this.pageGap;\n        if (this.pages.length > 0) {\n            yPos = this.pages[this.pages.length - 1].boundingRectangle.bottom + this.pageGap;\n        }\n        var page = new Page();\n        page.viewer = this;\n        // tslint:disable-next-line:max-line-length\n        var pageWidth = !isNullOrUndefined(section.sectionFormat) ? HelperMethods.convertPointToPixel(section.sectionFormat.pageWidth) : 816;\n        // tslint:disable-next-line:max-line-length\n        var pageHeight = !isNullOrUndefined(section.sectionFormat) ? HelperMethods.convertPointToPixel(section.sectionFormat.pageHeight) : 1056;\n        var xPos = (this.visibleBounds.width - pageWidth * this.zoomFactor) / 2;\n        if (xPos < this.pageLeft) {\n            xPos = this.pageLeft;\n        }\n        page.boundingRectangle = new Rect(xPos, yPos, pageWidth, pageHeight);\n        if (isNullOrUndefined(index)) {\n            this.pages.push(page);\n        }\n        else {\n            this.pages.splice(index, 0, page);\n        }\n        this.updateClientArea(section.sectionFormat, page);\n        page.bodyWidgets.push(section);\n        page.bodyWidgets[page.bodyWidgets.length - 1].page = page;\n        this.layout.layoutHeaderFooter(section, viewer, page);\n        this.updateClientArea(section.sectionFormat, page);\n        return page;\n    };\n    /**\n     * Updates cursor.\n     */\n    PageLayoutViewer.prototype.updateCursor = function (event) {\n        var hyperlinkField = undefined;\n        var div = this.viewerContainer;\n        var point = new Point(event.offsetX, event.offsetY);\n        var touchPoint = this.findFocusedPage(point, true);\n        var widget = this.getLineWidget(touchPoint);\n        var widgetInfo;\n        var left;\n        var top;\n        var editor = !this.owner.isReadOnlyMode ? this.owner.editorModule : undefined;\n        var isRowResize = editor ? editor.tableResize.isInRowResizerArea(touchPoint) : false;\n        var isCellResize = editor ? editor.tableResize.isInCellResizerArea(touchPoint) : false;\n        var resizePosition = '';\n        if (this.owner.enableImageResizerMode) {\n            var resizeObj = this.owner.imageResizerModule.getImagePoint(touchPoint);\n            this.owner.imageResizerModule.selectedResizeElement = resizeObj.selectedElement;\n            resizePosition = resizeObj.resizePosition;\n        }\n        var lineLeft = 0;\n        if (!isNullOrUndefined(widget)) {\n            lineLeft = this.selection.getLineStartLeft(widget);\n            hyperlinkField = this.selection.getHyperLinkFieldInCurrentSelection(widget, touchPoint);\n            widgetInfo = this.selection.updateTextPositionIn(widget, undefined, 0, touchPoint, true);\n            left = this.selection.getLeft(widget);\n            top = this.selection.getTop(widget);\n            this.selection.setHyperlinkContentToToolTip(hyperlinkField, widget, touchPoint.x);\n        }\n        if (!isNullOrUndefined(hyperlinkField) && (event.ctrlKey &&\n            this.owner.useCtrlClickToFollowHyperlink || !this.owner.useCtrlClickToFollowHyperlink)) {\n            div.style.cursor = 'pointer';\n            return;\n        }\n        else if (touchPoint.x >= lineLeft &&\n            event.offsetX < (this.visibleBounds.width - (this.visibleBounds.width - this.viewerContainer.clientWidth)) &&\n            event.offsetY < (this.visibleBounds.height - (this.visibleBounds.height - this.viewerContainer.clientHeight))) {\n            if (this.selection.isEmpty) {\n                div.style.cursor = 'text';\n            }\n            else {\n                div.style.cursor = this.selection.checkCursorIsInSelection(widget, touchPoint) ? 'default' : 'text';\n            }\n        }\n        else {\n            div.style.cursor = 'default';\n        }\n        if (!isNullOrUndefined(resizePosition) && resizePosition !== '') {\n            div.style.cursor = resizePosition;\n        }\n        else if (!isNullOrUndefined(widgetInfo) && widgetInfo.isImageSelected && left < touchPoint.x && top < touchPoint.y &&\n            left + widget.width > touchPoint.x && top + widget.height > touchPoint.y) {\n            div.style.cursor = 'move';\n        }\n        if (isRowResize) {\n            div.style.cursor = 'row-resize';\n        }\n        else if (isCellResize) {\n            div.style.cursor = 'col-resize';\n        }\n    };\n    /**\n     * Finds focused page.\n     * @private\n     */\n    PageLayoutViewer.prototype.findFocusedPage = function (currentPoint, updateCurrentPage) {\n        var point = new Point(currentPoint.x, currentPoint.y);\n        point.x += this.viewerContainer.scrollLeft;\n        point.y += this.viewerContainer.scrollTop;\n        for (var i = 0; i < this.pages.length; i++) {\n            var page = this.pages[i];\n            var pageTop = (page.boundingRectangle.y - this.pageGap * (i + 1)) * this.zoomFactor + this.pageGap * (i + 1);\n            var pageHeight = (page.boundingRectangle.height * this.zoomFactor) + this.pageGap;\n            var pageLeft = page.boundingRectangle.x;\n            var pageRight = ((page.boundingRectangle.right - pageLeft) * this.zoomFactor) + pageLeft;\n            if (pageTop <= point.y && pageTop + pageHeight >= point.y) {\n                if (updateCurrentPage) {\n                    this.currentPage = page;\n                }\n                point.y = (point.y - (pageTop)) / this.zoomFactor;\n                if (point.x > pageRight) {\n                    point.x = page.boundingRectangle.right;\n                }\n                else if (point.x < pageLeft) {\n                    point.x = 0;\n                }\n                else {\n                    point.x = (point.x - pageLeft) / this.zoomFactor;\n                }\n                return point;\n            }\n        }\n        return point;\n    };\n    /**\n     * Fired when page fit type changed.\n     * @private\n     */\n    PageLayoutViewer.prototype.onPageFitTypeChanged = function (pageFitType) {\n        var width = this.visibleBounds.width;\n        var height = this.visibleBounds.height;\n        var section = this.visiblePages[0].bodyWidgets[0];\n        var pageWidth = HelperMethods.convertPointToPixel(section.sectionFormat.pageWidth);\n        var pageHeight = HelperMethods.convertPointToPixel(section.sectionFormat.pageHeight);\n        switch (pageFitType) {\n            case 'FitOnePage':\n                if (height > 0 && pageHeight > 0) {\n                    var zoomFactor = (this.visibleBounds.height - 2 * this.pageGap - (this.pageGap - 2)) / pageHeight;\n                    if (zoomFactor === this.zoomFactor) {\n                        if (!isNullOrUndefined(this.owner.selection) && !isNullOrUndefined(this.owner.selection.start) &&\n                            !isNullOrUndefined(this.owner.selection.end)) {\n                            this.scrollToPosition(this.owner.selection.start, this.owner.selection.end);\n                        }\n                    }\n                    else {\n                        this.zoomFactor = zoomFactor;\n                    }\n                }\n                break;\n            case 'FitPageWidth':\n                if (width > 0 && pageWidth > 0) {\n                    this.zoomFactor = (this.visibleBounds.width - 80) / pageWidth;\n                }\n                break;\n            default:\n                this.zoomFactor = 100 / 100;\n                break;\n        }\n    };\n    /**\n     * @private\n     */\n    PageLayoutViewer.prototype.handleZoom = function () {\n        var prevScaleFactor = this.preZoomFactor;\n        var page = null;\n        var verticalHeight = 0;\n        var scrollToPosition = false;\n        if (this.selection && isNullOrUndefined(this.zoomX && isNullOrUndefined(this.zoomY))) {\n            var x = 0;\n            var y = 0;\n            var endPage = this.selection.getPage(this.selection.end.currentWidget.paragraph);\n            x = (this.visibleBounds.width - endPage.boundingRectangle.width * prevScaleFactor) / 2;\n            if (x < 30) {\n                x = 30;\n            }\n            // tslint:disable-next-line:max-line-length\n            y = endPage.boundingRectangle.y * prevScaleFactor + (this.pages.indexOf(endPage) + 1) * this.pageGap * (1 - prevScaleFactor);\n            var caretInfo = this.selection.updateCaretSize(this.owner.selection.end, true);\n            var topMargin = caretInfo.topMargin;\n            var caretHeight = caretInfo.height;\n            x += (this.selection.end.location.x) * prevScaleFactor;\n            y += (this.selection.end.location.y + topMargin) * prevScaleFactor;\n            if (x >= this.containerLeft && x <= this.visibleBounds.width &&\n                y >= this.containerTop && y <= this.containerTop + this.visibleBounds.height) {\n                scrollToPosition = true;\n            }\n        }\n        for (var i = 0; i < this.pages.length; i++) {\n            verticalHeight = verticalHeight + this.pages[i].boundingRectangle.height;\n        }\n        var horizontalWidth = 0;\n        for (var i = 0; i < this.pages.length; i++) {\n            if (horizontalWidth < this.pages[i].boundingRectangle.width) {\n                horizontalWidth = this.pages[i].boundingRectangle.width;\n            }\n        }\n        // tslint:disable-next-line:max-line-length\n        var height = (verticalHeight * this.zoomFactor + (this.pages.length + 1) * this.pageGap * (1 - this.zoomFactor)) - this.visibleBounds.height;\n        var horWidth = horizontalWidth * this.zoomFactor - this.visibleBounds.width;\n        if (this.visibleBounds.width - horizontalWidth * this.zoomFactor < 60) {\n            horWidth += 60;\n        }\n        //Update Vertical Scroll bar\n        if (height > 0) {\n            var value = this.containerTop;\n            if (this.visiblePages.length > 0) {\n                page = this.visiblePages[0];\n                // tslint:disable-next-line:max-line-length\n                var prevPageTop = (page.boundingRectangle.y - (page.index + 1) * this.pageGap) * prevScaleFactor + (page.index + 1) * this.pageGap;\n                var zoomY = this.zoomY;\n                if (isNullOrUndefined) {\n                    zoomY = this.visibleBounds.height / 2;\n                }\n                var prevY = value + zoomY;\n                while (prevY > prevPageTop + (page.boundingRectangle.height * prevScaleFactor)) {\n                    var pageIndex = page.index + 1;\n                    if (pageIndex === this.pages.length) {\n                        break;\n                    }\n                    page = this.pages[pageIndex];\n                    // tslint:disable-next-line:max-line-length\n                    prevPageTop = (page.boundingRectangle.y - (page.index + 1) * this.pageGap) * prevScaleFactor + (page.index + 1) * this.pageGap;\n                }\n                // tslint:disable-next-line:max-line-length\n                var currentY = (page.boundingRectangle.y - (page.index + 1) * this.pageGap) * this.zoomFactor + (page.index + 1) * this.pageGap\n                    + ((prevY - prevPageTop) < 0 ? prevY - prevPageTop : (prevY - prevPageTop) * (this.zoomFactor / prevScaleFactor));\n                value = currentY - zoomY;\n                zoomY = this.visibleBounds.height / 2;\n            }\n            this.viewerContainer.scrollTop = value;\n        }\n        else {\n            this.viewerContainer.scrollTop = 0;\n        }\n        // update Horizontal Scroll Bar\n        if (horWidth > 0) {\n            var value = this.containerLeft;\n            if (this.visiblePages.length > 0) {\n                if (page === null) {\n                    page = this.visiblePages[0];\n                }\n                var zoomX = this.zoomX;\n                if (isNullOrUndefined(zoomX)) {\n                    zoomX = this.visibleBounds.width / 2;\n                }\n                var prevValue = (page.boundingRectangle.width * prevScaleFactor) / page.boundingRectangle.width;\n                var prevX = value + zoomX;\n                // tslint:disable-next-line:max-line-length\n                var currentX = page.boundingRectangle.x\n                    + ((prevX - page.boundingRectangle.x) < 0 ? prevX - page.boundingRectangle.x : (prevX - page.boundingRectangle.x) * (this.zoomFactor / prevValue));\n                value = currentX - zoomX;\n                zoomX = this.visibleBounds.width / 2;\n            }\n            this.viewerContainer.scrollLeft = value;\n        }\n        else {\n            this.viewerContainer.scrollLeft = 0;\n        }\n        this.updateScrollBars();\n        if (scrollToPosition) {\n            this.scrollToPosition(this.selection.start, this.selection.end);\n        }\n    };\n    /**\n     * Gets current page header footer.\n     * @private\n     */\n    PageLayoutViewer.prototype.getCurrentPageHeaderFooter = function (section, isHeader) {\n        return this.getCurrentHeaderFooter(this.getHeaderFooterType(section, isHeader), section.index);\n    };\n    /**\n     * Get header footer type\n     * @private\n     */\n    PageLayoutViewer.prototype.getHeaderFooterType = function (section, isHeader) {\n        var type;\n        type = isHeader ? 'OddHeader' : 'OddFooter';\n        // tslint:disable-next-line:max-line-length\n        if (section.sectionFormat.differentFirstPage && (this.pages.length === 1 || this.pages[this.pages.length - 1].bodyWidgets[0].index !== section.index)) {\n            type = isHeader ? 'FirstPageHeader' : 'FirstPageFooter';\n        }\n        else if (section.sectionFormat.differentOddAndEvenPages && this.pages.length % 2 === 0) {\n            type = isHeader ? 'EvenHeader' : 'EvenFooter';\n        }\n        return type;\n    };\n    /**\n     * Gets current header footer.\n     * @param type\n     * @param section\n     * @private\n     */\n    PageLayoutViewer.prototype.getCurrentHeaderFooter = function (type, sectionIndex) {\n        if (this.headersFooters[sectionIndex]) {\n            var index = this.getHeaderFooter(type);\n            var headerFooter = this.headersFooters[sectionIndex][index];\n            if (!headerFooter) {\n                headerFooter = this.createHeaderFooterWidget(type);\n                this.headersFooters[sectionIndex][index] = headerFooter;\n            }\n            return headerFooter;\n        }\n        else if (sectionIndex > 0) {\n            return this.getCurrentHeaderFooter(type, sectionIndex - 1);\n        }\n        return undefined;\n    };\n    PageLayoutViewer.prototype.createHeaderFooterWidget = function (type) {\n        var headerFooter = new HeaderFooterWidget(type);\n        var paragraph = new ParagraphWidget();\n        paragraph.childWidgets.push(new LineWidget(paragraph));\n        return headerFooter;\n    };\n    /**\n     * Gets header footer.\n     * @param type\n     * @private\n     */\n    PageLayoutViewer.prototype.getHeaderFooter = function (type) {\n        switch (type) {\n            case 'OddHeader':\n                return 0;\n            case 'OddFooter':\n                return 1;\n            case 'EvenHeader':\n                return 2;\n            case 'EvenFooter':\n                return 3;\n            case 'FirstPageHeader':\n                return 4;\n            case 'FirstPageFooter':\n                return 5;\n        }\n    };\n    /**\n     * Updates header footer client area.\n     * @private\n     */\n    PageLayoutViewer.prototype.updateHFClientArea = function (sectionFormat, isHeader) {\n        // tslint:disable-next-line:max-line-length\n        var width = HelperMethods.convertPointToPixel(sectionFormat.pageWidth - sectionFormat.leftMargin - sectionFormat.rightMargin);\n        if (width < 0) {\n            width = 0;\n        }\n        if (isHeader) {\n            // tslint:disable-next-line:max-line-length\n            this.clientArea = new Rect(HelperMethods.convertPointToPixel(sectionFormat.leftMargin), HelperMethods.convertPointToPixel(sectionFormat.headerDistance), width, Number.POSITIVE_INFINITY);\n        }\n        else {\n            // tslint:disable-next-line:max-line-length\n            this.clientArea = new Rect(HelperMethods.convertPointToPixel(sectionFormat.leftMargin), HelperMethods.convertPointToPixel(sectionFormat.pageHeight - sectionFormat.footerDistance), width, Number.POSITIVE_INFINITY);\n        }\n        this.clientActiveArea = new Rect(this.clientArea.x, this.clientArea.y, this.clientArea.width, this.clientArea.height);\n    };\n    /**\n     * @private\n     */\n    PageLayoutViewer.prototype.updateHCFClientAreaWithTop = function (sectionFormat, isHeader, page) {\n        this.updateHFClientArea(sectionFormat, isHeader);\n        if (!isHeader) {\n            if (page.footerWidget.y < this.clientActiveArea.y) {\n                this.clientActiveArea.y = page.footerWidget.y;\n                this.clientActiveArea.height = Number.POSITIVE_INFINITY;\n            }\n        }\n    };\n    /**\n     * Scrolls to the specified page\n     * @private\n     */\n    PageLayoutViewer.prototype.scrollToPage = function (pageIndex) {\n        var top = 0;\n        for (var i = 0; i < this.pages.length; i++) {\n            top = this.pages[i].boundingRectangle.y - (this.pageGap / 2);\n            if (i === pageIndex) {\n                break;\n            }\n        }\n        this.viewerContainer.scrollTop = top;\n        this.updateScrollBars();\n    };\n    /**\n     * Updates scroll bars.\n     * @private\n     */\n    PageLayoutViewer.prototype.updateScrollBars = function () {\n        var height = 0;\n        for (var i = 0; i < this.pages.length; i++) {\n            height = height + this.pages[i].boundingRectangle.height;\n        }\n        var width = 0;\n        for (var i = 0; i < this.pages.length; i++) {\n            if (width < this.pages[i].boundingRectangle.width) {\n                width = this.pages[i].boundingRectangle.width;\n            }\n        }\n        var containerWidth = (width * this.zoomFactor) + (this.pageLeft * 2);\n        var containerHeight = (height * this.zoomFactor) + (this.pages.length + 1) * this.pageGap;\n        var viewerWidth = this.visibleBounds.width;\n        var viewerHeight = this.visibleBounds.height;\n        if (this.visibleBounds.width !== this.viewerContainer.clientWidth) {\n            viewerWidth -= (this.visibleBounds.width - this.viewerContainer.clientWidth);\n        }\n        else if (containerHeight > viewerHeight) {\n            viewerWidth -= this.viewerContainer.offsetWidth - this.viewerContainer.clientWidth;\n        }\n        if (containerWidth > viewerWidth) {\n            viewerHeight -= (this.visibleBounds.height - this.viewerContainer.clientHeight);\n        }\n        width = containerWidth > viewerWidth ? containerWidth : viewerWidth;\n        height = containerHeight > viewerHeight ? containerHeight : viewerHeight;\n        if (parseInt(this.pageContainer.style.width.replace('px', ''), 10) !== width ||\n            parseInt(this.pageContainer.style.height.replace('px', ''), 10) !== width) {\n            this.pageContainer.style.width = width.toString() + 'px';\n            this.pageContainer.style.height = height.toString() + 'px';\n        }\n        // if (!isNullOrUndefined(this.selection) && !this.selection.isEmpty) {\n        //     this.selectionContext.clearRect(0, 0, this.selectionCanvas.width, this.selectionCanvas.height);\n        // }\n        var displayPixelRatio = Math.max(1, window.devicePixelRatio || 1);\n        if (this.containerCanvas.width !== Math.floor(viewerWidth * displayPixelRatio)\n            || this.containerCanvas.height !== Math.floor(viewerHeight * displayPixelRatio)) {\n            this.containerCanvas.width = viewerWidth * displayPixelRatio;\n            this.containerCanvas.height = viewerHeight * displayPixelRatio;\n            this.containerCanvas.style.width = viewerWidth + 'px';\n            this.containerCanvas.style.height = viewerHeight + 'px';\n            this.containerContext.scale(displayPixelRatio, displayPixelRatio);\n            this.selectionCanvas.width = viewerWidth * displayPixelRatio;\n            this.selectionCanvas.height = viewerHeight * displayPixelRatio;\n            this.selectionCanvas.style.width = viewerWidth + 'px';\n            this.selectionCanvas.style.height = viewerHeight + 'px';\n            this.selectionContext.scale(displayPixelRatio, displayPixelRatio);\n        }\n        this.containerContext.globalAlpha = 1;\n        this.selectionContext.globalAlpha = 0.4;\n        for (var i = 0; i < this.pages.length; i++) {\n            var left = (width - this.pages[i].boundingRectangle.width * this.zoomFactor) / 2;\n            if (left > this.pageLeft) {\n                // tslint:disable-next-line:max-line-length\n                this.pages[i].boundingRectangle = new Rect(left, this.pages[i].boundingRectangle.y, this.pages[i].boundingRectangle.width, this.pages[i].boundingRectangle.height);\n            }\n            else {\n                // tslint:disable-next-line:max-line-length\n                this.pages[i].boundingRectangle = new Rect(this.pageLeft, this.pages[i].boundingRectangle.y, this.pages[i].boundingRectangle.width, this.pages[i].boundingRectangle.height);\n            }\n        }\n        this.updateScrollBarPosition(containerWidth, containerHeight, viewerWidth, viewerHeight, width, height);\n    };\n    // tslint:disable-next-line:max-line-length\n    PageLayoutViewer.prototype.updateScrollBarPosition = function (containerWidth, containerHeight, viewerWidth, viewerHeight, width, height) {\n        var left = 0;\n        var viewerHeight1 = parseFloat(this.viewerContainer.style.height);\n        var containerHeight1 = parseFloat(this.pageContainer.style.height);\n        this.containerTop = this.viewerContainer.scrollTop;\n        this.containerCanvas.style.position = 'absolute';\n        this.containerCanvas.style.top = this.containerTop.toString() + 'px';\n        this.selectionCanvas.style.position = 'absolute';\n        this.selectionCanvas.style.top = this.containerTop.toString() + 'px';\n        this.containerLeft = this.viewerContainer.scrollLeft;\n        this.containerCanvas.style.left = this.containerLeft + 'px';\n        this.selectionCanvas.style.left = this.containerLeft + 'px';\n        this.updateVisiblePages();\n    };\n    /**\n     * Updates visible pages.\n     * @private\n     */\n    PageLayoutViewer.prototype.updateVisiblePages = function () {\n        var left = 0;\n        var width = 0;\n        // Clears the container first.\n        this.visiblePages = [];\n        var height = this.visibleBounds.height;\n        var vertical = this.viewerContainer.scrollTop;\n        for (var i = 0; i < this.pages.length; i++) {\n            var page = this.pages[i];\n            var y = (page.boundingRectangle.y - this.pageGap * (i + 1)) * this.zoomFactor + this.pageGap * (i + 1);\n            var pageH = page.boundingRectangle.height * this.zoomFactor;\n            var left_1 = page.boundingRectangle.x;\n            var isTopFit = y >= vertical && y <= vertical + height;\n            var isBottomFit = y + pageH >= vertical && y + pageH <= vertical + height;\n            var isMiddleFit = y <= vertical && y + pageH >= vertical + height;\n            //UI Virtualization\n            if (isTopFit || isBottomFit || isMiddleFit) {\n                this.addVisiblePage(page, left_1, y);\n            }\n        }\n    };\n    /**\n     * Adds visible pages.\n     */\n    PageLayoutViewer.prototype.addVisiblePage = function (page, x, y) {\n        var width = page.boundingRectangle.width * this.zoomFactor;\n        var height = page.boundingRectangle.height * this.zoomFactor;\n        // tslint:disable-next-line:max-line-length\n        if (this.owner.enableImageResizerMode && this.owner.imageResizerModule.currentPage !== undefined && this.owner.imageResizerModule.currentPage === page && this.owner.imageResizerModule.isImageResizerVisible) {\n            this.owner.imageResizerModule.setImageResizerPositions(x, y, width, height);\n        }\n        this.visiblePages.push(page);\n        this.renderPage(page, x, y, width, height);\n    };\n    /**\n     * Render specified page widgets.\n     */\n    PageLayoutViewer.prototype.renderPage = function (page, x, y, width, height) {\n        this.render.renderWidgets(page, x - this.containerLeft, y - this.containerTop, width, height);\n    };\n    /**\n     * Renders visible pages.\n     * @private\n     */\n    PageLayoutViewer.prototype.renderVisiblePages = function () {\n        if (isNullOrUndefined(this.visiblePages) || this.visiblePages.length < 1) {\n            return;\n        }\n        this.clearContent();\n        for (var i = 0; i < this.visiblePages.length; i++) {\n            var page = this.visiblePages[i];\n            var width = page.boundingRectangle.width * this.zoomFactor;\n            var height = page.boundingRectangle.height * this.zoomFactor;\n            var x = page.boundingRectangle.x;\n            var y = (page.boundingRectangle.y - this.pageGap * (i + 1)) * this.zoomFactor + this.pageGap * (i + 1);\n            this.renderPage(page, x, y, width, height);\n        }\n    };\n    return PageLayoutViewer;\n}(LayoutViewer));\nexport { PageLayoutViewer };\n","import { isNullOrUndefined } from '@syncfusion/ej2-base';\nimport { WList } from '../list/list';\nimport { WListLevel } from '../list/list-level';\nimport { WAbstractList } from '../list/abstract-list';\nimport { WLevelOverride } from '../list/level-override';\nimport { WCharacterFormat, WListFormat, WParagraphFormat, WCellFormat, WTableFormat, WSectionFormat, WRowFormat } from '../format/index';\nimport { WCharacterStyle, WParagraphStyle, WTabStop } from '../format/index';\nimport { LineWidget, ParagraphWidget, ImageElementBox, BodyWidget, TextElementBox, TableCellWidget, TableRowWidget, TableWidget, FieldElementBox, HeaderFooterWidget, BookmarkElementBox, FieldTextElementBox, TabElementBox } from './page';\nimport { HelperMethods } from '../editor/editor-helper';\n/**\n * @private\n */\nvar SfdtReader = /** @class */ (function () {\n    function SfdtReader(viewer) {\n        /* tslint:disable:no-any */\n        this.viewer = undefined;\n        this.viewer = viewer;\n    }\n    Object.defineProperty(SfdtReader.prototype, \"isPasting\", {\n        get: function () {\n            return this.viewer && this.viewer.owner.isPastingContent;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    /**\n     * @private\n     * @param json\n     */\n    SfdtReader.prototype.convertJsonToDocument = function (json) {\n        var sections = [];\n        var jsonObject = JSON.parse(json);\n        this.parseCharacterFormat(jsonObject.characterFormat, this.viewer.characterFormat);\n        this.parseParagraphFormat(jsonObject.paragraphFormat, this.viewer.paragraphFormat);\n        if (!isNullOrUndefined(jsonObject.background)) {\n            this.viewer.backgroundColor = this.getColor(jsonObject.background.color);\n        }\n        if (!isNullOrUndefined(jsonObject.abstractLists)) {\n            this.parseAbstractList(jsonObject, this.viewer.abstractLists);\n        }\n        if (!isNullOrUndefined(jsonObject.lists)) {\n            this.parseList(jsonObject, this.viewer.lists);\n        }\n        if (!isNullOrUndefined(jsonObject.styles)) {\n            this.parseStyles(jsonObject, this.viewer.styles);\n        }\n        if (!isNullOrUndefined(jsonObject.sections)) {\n            this.parseSections(jsonObject.sections, sections);\n        }\n        return sections;\n    };\n    SfdtReader.prototype.parseStyles = function (data, styles) {\n        for (var i = 0; i < data.styles.length; i++) {\n            if (isNullOrUndefined(this.viewer.styles.findByName(data.styles[i].name))) {\n                this.parseStyle(data, data.styles[i], styles);\n            }\n        }\n    };\n    SfdtReader.prototype.parseStyle = function (data, style, styles) {\n        var wStyle;\n        if (!isNullOrUndefined(style.type)) {\n            if (style.type === 'Paragraph') {\n                wStyle = new WParagraphStyle();\n                wStyle.type = 'Paragraph';\n            }\n            if (style.type === 'Character') {\n                wStyle = new WCharacterStyle();\n                wStyle.type = 'Character';\n            }\n            if (!isNullOrUndefined(style.name)) {\n                wStyle.name = style.name;\n            }\n            styles.push(wStyle);\n            if (!isNullOrUndefined(style.basedOn)) {\n                var basedOn = styles.findByName(style.basedOn);\n                if (!isNullOrUndefined(basedOn)) {\n                    if (basedOn.type === wStyle.type) {\n                        wStyle.basedOn = basedOn;\n                    }\n                }\n                else {\n                    var basedStyle = this.getStyle(style.basedOn, data);\n                    var styleString = void 0;\n                    if (!isNullOrUndefined(basedStyle) && basedStyle.type === wStyle.type) {\n                        styleString = basedStyle;\n                    }\n                    else {\n                        if (wStyle.type === 'Paragraph') {\n                            styleString = JSON.parse('{\"type\":\"Paragraph\",\"name\":\"Normal\",\"next\":\"Normal\"}');\n                        }\n                        else {\n                            styleString = JSON.parse('{\"type\": \"Character\",\"name\": \"Default Paragraph Font\"}');\n                        }\n                    }\n                    this.parseStyle(data, styleString, styles);\n                    wStyle.basedOn = styles.findByName(styleString.name);\n                }\n            }\n            if (!isNullOrUndefined(style.link)) {\n                var link = styles.findByName(style.link);\n                var linkStyle = this.getStyle(style.link, data);\n                var styleString = void 0;\n                if (isNullOrUndefined(link)) {\n                    if (isNullOrUndefined(linkStyle)) {\n                        //Construct the CharacterStyle string\n                        var charaStyle = {};\n                        charaStyle.characterFormat = style.characterFormat;\n                        charaStyle.name = style.name + ' Char';\n                        charaStyle.type = 'Character';\n                        //TODO: Implement basedOn\n                        charaStyle.basedOn = style.basedOn === 'Normal' ? 'Default Paragraph Font' : (style.basedOn + ' Char');\n                        styleString = charaStyle;\n                    }\n                    else {\n                        styleString = linkStyle;\n                    }\n                    this.parseStyle(data, styleString, styles);\n                    wStyle.link = isNullOrUndefined(styles.findByName(styleString.name)) ? style.link : styles.findByName(styleString.name);\n                }\n                else {\n                    wStyle.link = link;\n                }\n            }\n            if (!isNullOrUndefined(style.characterFormat)) {\n                this.parseCharacterFormat(style.characterFormat, wStyle.characterFormat);\n            }\n            if (!isNullOrUndefined(style.paragraphFormat)) {\n                this.parseParagraphFormat(style.paragraphFormat, wStyle.paragraphFormat);\n            }\n            if (!isNullOrUndefined(style.next)) {\n                if (style.next === style.name) {\n                    wStyle.next = wStyle;\n                }\n                else {\n                    var next = styles.findByName(style.next);\n                    if (!isNullOrUndefined(next) && next.type === wStyle.type) {\n                        wStyle.next = next;\n                    }\n                    else {\n                        var nextStyleString = this.getStyle(style.next, data);\n                        if (!isNullOrUndefined(nextStyleString)) {\n                            this.parseStyle(data, nextStyleString, styles);\n                            wStyle.next = styles.findByName(nextStyleString.name);\n                        }\n                        else {\n                            wStyle.next = wStyle;\n                        }\n                    }\n                }\n            }\n        }\n    };\n    SfdtReader.prototype.getStyle = function (name, data) {\n        for (var i = 0; i < data.styles.length; i++) {\n            if (data.styles[i].name === name) {\n                return data.styles[i];\n            }\n        }\n        return undefined;\n    };\n    SfdtReader.prototype.parseAbstractList = function (data, abstractLists) {\n        for (var i = 0; i < data.abstractLists.length; i++) {\n            var abstractList = new WAbstractList();\n            var abstract = data.abstractLists[i];\n            abstractLists.push(abstractList);\n            if (!isNullOrUndefined(abstract)) {\n                if (!isNullOrUndefined(abstract.abstractListId)) {\n                    abstractList.abstractListId = abstract.abstractListId;\n                }\n                if (!isNullOrUndefined(abstract.levels)) {\n                    for (var j = 0; j < abstract.levels.length; j++) {\n                        var level = abstract.levels[j];\n                        if (!isNullOrUndefined(level)) {\n                            var listLevel = this.parseListLevel(level, abstractList);\n                            abstractList.levels.push(listLevel);\n                        }\n                    }\n                }\n            }\n        }\n    };\n    SfdtReader.prototype.parseListLevel = function (data, owner) {\n        var listLevel = new WListLevel(owner);\n        if (data.listLevelPattern === 'Bullet') {\n            listLevel.listLevelPattern = 'Bullet';\n            listLevel.numberFormat = !isNullOrUndefined(data.numberFormat) ? data.numberFormat : '';\n        }\n        else {\n            listLevel.listLevelPattern = data.listLevelPattern;\n            listLevel.startAt = data.startAt;\n            listLevel.numberFormat = !isNullOrUndefined(data.numberFormat) ? data.numberFormat : '';\n            if (data.restartLevel >= 0) {\n                listLevel.restartLevel = data.restartLevel;\n            }\n            else {\n                listLevel.restartLevel = data.levelNumber;\n            }\n        }\n        listLevel.followCharacter = data.followCharacter;\n        this.parseCharacterFormat(data.characterFormat, listLevel.characterFormat);\n        this.parseParagraphFormat(data.paragraphFormat, listLevel.paragraphFormat);\n        return listLevel;\n    };\n    SfdtReader.prototype.parseList = function (data, listCollection) {\n        for (var i = 0; i < data.lists.length; i++) {\n            var list = new WList();\n            var lists = data.lists[i];\n            if (!isNullOrUndefined(lists.abstractListId)) {\n                list.abstractListId = lists.abstractListId;\n                list.abstractList = this.viewer.getAbstractListById(lists.abstractListId);\n            }\n            listCollection.push(list);\n            if (!isNullOrUndefined(lists.listId)) {\n                list.listId = lists.listId;\n            }\n            if (lists.hasOwnProperty('levelOverrides')) {\n                this.parseLevelOverride(lists.levelOverrides, list);\n            }\n        }\n    };\n    SfdtReader.prototype.parseLevelOverride = function (data, list) {\n        if (isNullOrUndefined(data)) {\n            return;\n        }\n        for (var i = 0; i < data.length; i++) {\n            var levelOverrides = new WLevelOverride();\n            var levelOverride = data[i];\n            levelOverrides.startAt = levelOverride.startAt;\n            levelOverrides.levelNumber = levelOverride.levelNumber;\n            if (!isNullOrUndefined(levelOverride.overrideListLevel)) {\n                levelOverrides.overrideListLevel = this.parseListLevel(levelOverride.overrideListLevel, levelOverrides);\n            }\n            list.levelOverrides.push(levelOverrides);\n        }\n    };\n    SfdtReader.prototype.parseSections = function (data, sections) {\n        for (var i = 0; i < data.length; i++) {\n            var section = new BodyWidget();\n            section.sectionFormat = new WSectionFormat(section);\n            section.index = i;\n            var item = data[i];\n            if (!isNullOrUndefined(item.sectionFormat)) {\n                this.parseSectionFormat(item.sectionFormat, section.sectionFormat);\n            }\n            if (isNullOrUndefined(item.headersFooters)) {\n                item.headersFooters = {};\n            }\n            this.viewer.headersFooters.push(this.parseHeaderFooter(item.headersFooters, this.viewer.headersFooters));\n            this.parseTextBody(item.blocks, section);\n            for (var i_1 = 0; i_1 < section.childWidgets.length; i_1++) {\n                section.childWidgets[i_1].containerWidget = section;\n            }\n            sections.push(section);\n        }\n    };\n    /**\n     * @private\n     */\n    SfdtReader.prototype.parseHeaderFooter = function (data, headersFooters) {\n        var hfs = {};\n        if (!isNullOrUndefined(data.header)) {\n            var oddHeader = new HeaderFooterWidget('OddHeader');\n            hfs[0] = oddHeader;\n            this.parseTextBody(data.header.blocks, oddHeader);\n        }\n        if (!isNullOrUndefined(data.footer)) {\n            var oddFooter = new HeaderFooterWidget('OddFooter');\n            hfs[1] = oddFooter;\n            this.parseTextBody(data.footer.blocks, oddFooter);\n        }\n        if (!isNullOrUndefined(data.evenHeader)) {\n            var evenHeader = new HeaderFooterWidget('EvenHeader');\n            hfs[2] = evenHeader;\n            this.parseTextBody(data.evenHeader.blocks, evenHeader);\n        }\n        if (!isNullOrUndefined(data.evenFooter)) {\n            var evenFooter = new HeaderFooterWidget('EvenFooter');\n            hfs[3] = evenFooter;\n            this.parseTextBody(data.evenFooter.blocks, evenFooter);\n        }\n        if (!isNullOrUndefined(data.firstPageHeader)) {\n            var firstPageHeader = new HeaderFooterWidget('FirstPageHeader');\n            hfs[4] = firstPageHeader;\n            this.parseTextBody(data.firstPageHeader.blocks, firstPageHeader);\n        }\n        if (!isNullOrUndefined(data.firstPageFooter)) {\n            var firstPageFooter = new HeaderFooterWidget('FirstPageFooter');\n            hfs[5] = firstPageFooter;\n            this.parseTextBody(data.firstPageFooter.blocks, firstPageFooter);\n        }\n        return hfs;\n    };\n    SfdtReader.prototype.parseTextBody = function (data, section) {\n        this.parseBody(data, section.childWidgets, section);\n    };\n    SfdtReader.prototype.parseBody = function (data, blocks, container) {\n        if (!isNullOrUndefined(data)) {\n            for (var i = 0; i < data.length; i++) {\n                var block = data[i];\n                if (block.hasOwnProperty('inlines')) {\n                    var writeInlineFormat = false;\n                    //writeInlineFormat = this.isPasting && i === data.length - 1;\n                    var paragraph = new ParagraphWidget();\n                    paragraph.characterFormat = new WCharacterFormat(paragraph);\n                    paragraph.paragraphFormat = new WParagraphFormat(paragraph);\n                    this.parseCharacterFormat(block.characterFormat, paragraph.characterFormat);\n                    this.parseParagraphFormat(block.paragraphFormat, paragraph.paragraphFormat);\n                    var styleObj = void 0;\n                    if (!isNullOrUndefined(block.paragraphFormat) && !isNullOrUndefined(block.paragraphFormat.styleName)) {\n                        styleObj = this.viewer.styles.findByName(block.paragraphFormat.styleName, 'Paragraph');\n                        if (!isNullOrUndefined(styleObj)) {\n                            paragraph.paragraphFormat.ApplyStyle(styleObj);\n                        }\n                    }\n                    if (block.inlines.length > 0) {\n                        this.parseParagraph(block.inlines, paragraph, writeInlineFormat);\n                    }\n                    blocks.push(paragraph);\n                    paragraph.index = i;\n                    paragraph.containerWidget = container;\n                }\n                else if (block.hasOwnProperty('rows')) {\n                    this.parseTable(block, blocks, i, container);\n                }\n            }\n        }\n    };\n    SfdtReader.prototype.parseTable = function (block, blocks, index, section) {\n        var table = new TableWidget();\n        table.index = index;\n        table.tableFormat = new WTableFormat(table);\n        if (!isNullOrUndefined(block.tableFormat)) {\n            this.parseTableFormat(block.tableFormat, table.tableFormat);\n        }\n        table.title = block.title;\n        table.description = block.description;\n        for (var i = 0; i < block.rows.length; i++) {\n            var row = new TableRowWidget();\n            row.rowFormat = new WRowFormat(row);\n            var tableRow = block.rows[i];\n            if (tableRow.hasOwnProperty('rowFormat')) {\n                this.parseRowFormat(tableRow.rowFormat, row.rowFormat);\n                this.parseRowGridValues(tableRow, row.rowFormat);\n                this.parseRowGridValues(tableRow.rowFormat, row.rowFormat);\n                row.index = i;\n                for (var j = 0; j < block.rows[i].cells.length; j++) {\n                    var cell = new TableCellWidget();\n                    cell.cellFormat = new WCellFormat(cell);\n                    row.childWidgets.push(cell);\n                    cell.containerWidget = row;\n                    cell.index = j;\n                    cell.rowIndex = i;\n                    if (block.rows[i].cells[j].hasOwnProperty('cellFormat')) {\n                        this.parseCellFormat(block.rows[i].cells[j].cellFormat, cell.cellFormat);\n                    }\n                    this.parseTextBody(block.rows[i].cells[j].blocks, cell);\n                }\n            }\n            table.childWidgets.push(row);\n            row.containerWidget = table;\n        }\n        table.containerWidget = section;\n        blocks.push(table);\n        table.isGridUpdated = false;\n    };\n    SfdtReader.prototype.parseRowGridValues = function (data, rowFormat) {\n        if (!isNullOrUndefined(data.gridBefore)) {\n            rowFormat.gridBefore = data.gridBefore;\n        }\n        if (!isNullOrUndefined(data.gridBeforeWidth)) {\n            rowFormat.gridBeforeWidth = data.gridBeforeWidth;\n        }\n        if (!isNullOrUndefined(data.gridBeforeWidthType)) {\n            rowFormat.gridBeforeWidthType = data.gridBeforeWidthType;\n        }\n        if (!isNullOrUndefined(data.gridAfter)) {\n            rowFormat.gridAfter = data.gridAfter;\n        }\n        if (!isNullOrUndefined(data.gridAfterWidth)) {\n            rowFormat.gridAfterWidth = data.gridAfterWidth;\n        }\n        if (!isNullOrUndefined(data.gridAfterWidthType)) {\n            rowFormat.gridAfterWidthType = data.gridAfterWidthType;\n        }\n    };\n    SfdtReader.prototype.parseParagraph = function (data, paragraph, writeInlineFormat) {\n        var lineWidget = new LineWidget(paragraph);\n        for (var i = 0; i < data.length; i++) {\n            var inline = data[i];\n            if (inline.hasOwnProperty('text')) {\n                var textElement = undefined;\n                if (this.viewer.isPageField) {\n                    textElement = new FieldTextElementBox();\n                    textElement.fieldBegin = this.viewer.fieldStacks[this.viewer.fieldStacks.length - 1];\n                }\n                else if (inline.text === '\\t') {\n                    textElement = new TabElementBox();\n                }\n                else {\n                    textElement = new TextElementBox();\n                }\n                textElement.characterFormat = new WCharacterFormat(textElement);\n                this.parseCharacterFormat(inline.characterFormat, textElement.characterFormat, writeInlineFormat);\n                /*�tslint:disable-next-line:max-line-length */\n                if (!isNullOrUndefined(inline.characterFormat) && !isNullOrUndefined(inline.characterFormat.styleName)) {\n                    var charStyle = this.viewer.styles.findByName(inline.characterFormat.styleName, 'Character');\n                    textElement.characterFormat.ApplyStyle(charStyle);\n                }\n                textElement.text = inline.text;\n                textElement.line = lineWidget;\n                lineWidget.children.push(textElement);\n            }\n            else if (inline.hasOwnProperty('imageString')) {\n                var image = new ImageElementBox(data[i].isInlineImage);\n                image.isMetaFile = data[i].isMetaFile;\n                image.characterFormat = new WCharacterFormat(image);\n                image.line = lineWidget;\n                lineWidget.children.push(image);\n                image.imageString = inline.imageString;\n                image.width = HelperMethods.convertPointToPixel(inline.width);\n                image.height = HelperMethods.convertPointToPixel(inline.height);\n                this.parseCharacterFormat(inline.characterFormat, image.characterFormat);\n            }\n            else if (inline.hasOwnProperty('hasFieldEnd') || (inline.hasOwnProperty('fieldType') && inline.fieldType === 0)) {\n                var fieldBegin = new FieldElementBox(0);\n                fieldBegin.hasFieldEnd = inline.hasFieldEnd;\n                this.viewer.fieldStacks.push(fieldBegin);\n                fieldBegin.line = lineWidget;\n                this.viewer.fields.push(fieldBegin);\n                lineWidget.children.push(fieldBegin);\n            }\n            else if (inline.hasOwnProperty('fieldType')) {\n                var field = undefined;\n                if (inline.fieldType === 2) {\n                    field = new FieldElementBox(2);\n                    this.fieldSeparator = field;\n                    if (this.viewer.fieldStacks.length > 0) {\n                        field.fieldBegin = this.viewer.fieldStacks[this.viewer.fieldStacks.length - 1];\n                        field.fieldBegin.fieldSeparator = field;\n                        //finds the whether the field is page filed or not\n                        var lineWidgetCount = lineWidget.children.length;\n                        if (lineWidgetCount >= 2 && (lineWidget.children[lineWidgetCount - 2] instanceof FieldElementBox)\n                            && lineWidget.children[lineWidgetCount - 2].hasFieldEnd\n                            && (lineWidget.children[lineWidgetCount - 1] instanceof TextElementBox)) {\n                            var fieldElementText = lineWidget.children[lineWidgetCount - 1].text;\n                            if (fieldElementText.match('PAGE')) {\n                                this.viewer.isPageField = true;\n                            }\n                        }\n                    }\n                }\n                else if (inline.fieldType === 1) {\n                    field = new FieldElementBox(1);\n                    //For Field End Updated begin and separator.                                      \n                    if (this.viewer.fieldStacks.length > 0) {\n                        field.fieldBegin = this.viewer.fieldStacks[this.viewer.fieldStacks.length - 1];\n                        field.fieldBegin.fieldEnd = field;\n                    }\n                    if (!isNullOrUndefined(field.fieldBegin) && field.fieldBegin.fieldSeparator) {\n                        field.fieldSeparator = field.fieldBegin.fieldSeparator;\n                        field.fieldBegin.fieldSeparator.fieldEnd = field;\n                    }\n                    //After setting all the property clear the field values\n                    this.viewer.fieldStacks.splice(this.viewer.fieldStacks.length - 1, 1);\n                    this.fieldSeparator = undefined;\n                    this.viewer.isPageField = false;\n                    this.viewer.fieldCollection.push(field.fieldBegin);\n                }\n                field.line = lineWidget;\n                lineWidget.children.push(field);\n            }\n            else if (inline.hasOwnProperty('bookmarkType')) {\n                var bookmark = undefined;\n                bookmark = new BookmarkElementBox(inline.bookmarkType);\n                bookmark.name = inline.name;\n                lineWidget.children.push(bookmark);\n                bookmark.line = lineWidget;\n                if (inline.bookmarkType === 0) {\n                    this.viewer.bookmarks.add(bookmark.name, bookmark);\n                }\n                else if (inline.bookmarkType === 1) {\n                    if (this.viewer.bookmarks.containsKey(bookmark.name)) {\n                        var bookmarkStart = this.viewer.bookmarks.get(bookmark.name);\n                        bookmarkStart.reference = bookmark;\n                        bookmark.reference = bookmarkStart;\n                    }\n                }\n            }\n        }\n        paragraph.childWidgets.push(lineWidget);\n    };\n    SfdtReader.prototype.parseTableFormat = function (sourceFormat, tableFormat) {\n        this.parseBorders(sourceFormat.borders, tableFormat.borders);\n        if (!isNullOrUndefined(sourceFormat.cellSpacing)) {\n            tableFormat.cellSpacing = sourceFormat.cellSpacing;\n        }\n        if (!isNullOrUndefined(sourceFormat.leftMargin)) {\n            tableFormat.leftMargin = sourceFormat.leftMargin;\n        }\n        if (!isNullOrUndefined(sourceFormat.topMargin)) {\n            tableFormat.topMargin = sourceFormat.topMargin;\n        }\n        if (!isNullOrUndefined(sourceFormat.rightMargin)) {\n            tableFormat.rightMargin = sourceFormat.rightMargin;\n        }\n        if (!isNullOrUndefined(sourceFormat.bottomMargin)) {\n            tableFormat.bottomMargin = sourceFormat.bottomMargin;\n        }\n        if (!isNullOrUndefined(sourceFormat.leftIndent)) {\n            tableFormat.leftIndent = sourceFormat.leftIndent;\n        }\n        this.parseShading(sourceFormat.shading, tableFormat.shading);\n        if (!isNullOrUndefined(sourceFormat.tableAlignment)) {\n            tableFormat.tableAlignment = sourceFormat.tableAlignment;\n        }\n        if (!isNullOrUndefined(sourceFormat.preferredWidth)) {\n            tableFormat.preferredWidth = sourceFormat.preferredWidth;\n        }\n        if (!isNullOrUndefined(sourceFormat.preferredWidthType)) {\n            tableFormat.preferredWidthType = sourceFormat.preferredWidthType;\n        }\n    };\n    SfdtReader.prototype.parseCellFormat = function (sourceFormat, cellFormat) {\n        if (!isNullOrUndefined(sourceFormat)) {\n            this.parseBorders(sourceFormat.borders, cellFormat.borders);\n            if (!sourceFormat.isSamePaddingAsTable) {\n                //    cellFormat.ClearMargins();\n                //else\n                this.parseCellMargin(sourceFormat, cellFormat);\n            }\n            if (!isNullOrUndefined(sourceFormat.cellWidth)) {\n                cellFormat.cellWidth = sourceFormat.cellWidth;\n            }\n            if (!isNullOrUndefined(sourceFormat.columnSpan)) {\n                cellFormat.columnSpan = sourceFormat.columnSpan;\n            }\n            if (!isNullOrUndefined(sourceFormat.rowSpan)) {\n                cellFormat.rowSpan = sourceFormat.rowSpan;\n            }\n            this.parseShading(sourceFormat.shading, cellFormat.shading);\n            if (!isNullOrUndefined(sourceFormat.verticalAlignment)) {\n                cellFormat.verticalAlignment = sourceFormat.verticalAlignment;\n            }\n            if (!isNullOrUndefined(sourceFormat.preferredWidthType)) {\n                cellFormat.preferredWidthType = sourceFormat.preferredWidthType;\n            }\n            if (!isNullOrUndefined(sourceFormat.preferredWidth)) {\n                cellFormat.preferredWidth = sourceFormat.preferredWidth;\n            }\n        }\n    };\n    SfdtReader.prototype.parseCellMargin = function (sourceFormat, cellFormat) {\n        if (!isNullOrUndefined(sourceFormat.leftMargin)) {\n            cellFormat.leftMargin = sourceFormat.leftMargin;\n        }\n        if (!isNullOrUndefined(sourceFormat.rightMargin)) {\n            cellFormat.rightMargin = sourceFormat.rightMargin;\n        }\n        if (!isNullOrUndefined(sourceFormat.topMargin)) {\n            cellFormat.topMargin = sourceFormat.topMargin;\n        }\n        if (!isNullOrUndefined(sourceFormat.bottomMargin)) {\n            cellFormat.bottomMargin = sourceFormat.bottomMargin;\n        }\n    };\n    SfdtReader.prototype.parseRowFormat = function (sourceFormat, rowFormat) {\n        if (!isNullOrUndefined(sourceFormat)) {\n            if (!isNullOrUndefined(sourceFormat.allowBreakAcrossPages)) {\n                rowFormat.allowBreakAcrossPages = sourceFormat.allowBreakAcrossPages;\n            }\n            if (!isNullOrUndefined(sourceFormat.isHeader)) {\n                rowFormat.isHeader = sourceFormat.isHeader;\n            }\n            if (!isNullOrUndefined(sourceFormat.heightType)) {\n                rowFormat.heightType = sourceFormat.heightType;\n            }\n            if (!isNullOrUndefined(sourceFormat.height)) {\n                rowFormat.height = sourceFormat.height;\n            }\n            this.parseBorders(sourceFormat.borders, rowFormat.borders);\n        }\n    };\n    SfdtReader.prototype.parseBorders = function (sourceBorders, destBorder) {\n        if (!isNullOrUndefined(sourceBorders)) {\n            this.parseBorder(sourceBorders.left, destBorder.left);\n            this.parseBorder(sourceBorders.right, destBorder.right);\n            this.parseBorder(sourceBorders.top, destBorder.top);\n            this.parseBorder(sourceBorders.bottom, destBorder.bottom);\n            this.parseBorder(sourceBorders.vertical, destBorder.vertical);\n            this.parseBorder(sourceBorders.horizontal, destBorder.horizontal);\n            this.parseBorder(sourceBorders.diagonalDown, destBorder.diagonalDown);\n            this.parseBorder(sourceBorders.diagonalUp, destBorder.diagonalUp);\n        }\n    };\n    SfdtReader.prototype.parseBorder = function (sourceBorder, destBorder) {\n        if (!isNullOrUndefined(sourceBorder)) {\n            if (!isNullOrUndefined(sourceBorder.color)) {\n                destBorder.color = this.getColor(sourceBorder.color);\n            }\n            if (!isNullOrUndefined(sourceBorder.lineStyle)) {\n                destBorder.lineStyle = sourceBorder.lineStyle;\n            }\n            if (!isNullOrUndefined(sourceBorder.lineWidth)) {\n                destBorder.lineWidth = sourceBorder.lineWidth;\n            }\n            if (!isNullOrUndefined(sourceBorder.hasNoneStyle)) {\n                destBorder.hasNoneStyle = sourceBorder.hasNoneStyle;\n            }\n        }\n    };\n    SfdtReader.prototype.parseShading = function (sourceShading, destShading) {\n        if (!isNullOrUndefined(sourceShading)) {\n            if (!isNullOrUndefined(sourceShading.backgroundColor)) {\n                destShading.backgroundColor = this.getColor(sourceShading.backgroundColor);\n            }\n            if (!isNullOrUndefined(sourceShading.foregroundColor)) {\n                destShading.foregroundColor = this.getColor(sourceShading.foregroundColor);\n            }\n            if (!isNullOrUndefined(sourceShading.texture)) {\n                destShading.textureStyle = sourceShading.texture;\n            }\n        }\n    };\n    SfdtReader.prototype.parseCharacterFormat = function (sourceFormat, characterFormat, writeInlineFormat) {\n        if (!isNullOrUndefined(sourceFormat)) {\n            if (writeInlineFormat && sourceFormat.hasOwnProperty('inlineFormat')) {\n                this.parseCharacterFormat(sourceFormat.inlineFormat, characterFormat);\n                return;\n            }\n            if (!isNullOrUndefined(sourceFormat.baselineAlignment)) {\n                characterFormat.baselineAlignment = sourceFormat.baselineAlignment;\n            }\n            if (!isNullOrUndefined(sourceFormat.underline)) {\n                characterFormat.underline = sourceFormat.underline;\n            }\n            if (!isNullOrUndefined(sourceFormat.strikethrough)) {\n                characterFormat.strikethrough = sourceFormat.strikethrough;\n            }\n            if (!isNullOrUndefined(sourceFormat.fontSize)) {\n                characterFormat.fontSize = sourceFormat.fontSize;\n            }\n            if (!isNullOrUndefined(sourceFormat.fontFamily)) {\n                characterFormat.fontFamily = sourceFormat.fontFamily;\n            }\n            if (!isNullOrUndefined(sourceFormat.bold)) {\n                characterFormat.bold = sourceFormat.bold;\n            }\n            if (!isNullOrUndefined(sourceFormat.italic)) {\n                characterFormat.italic = sourceFormat.italic;\n            }\n            if (!isNullOrUndefined(sourceFormat.highlightColor)) {\n                characterFormat.highlightColor = sourceFormat.highlightColor;\n            }\n            if (!isNullOrUndefined(sourceFormat.fontColor)) {\n                characterFormat.fontColor = this.getColor(sourceFormat.fontColor);\n            }\n        }\n    };\n    SfdtReader.prototype.getColor = function (color) {\n        var convertColor = color;\n        return convertColor || '#ffffff';\n    };\n    SfdtReader.prototype.parseParagraphFormat = function (sourceFormat, paragraphFormat) {\n        if (!isNullOrUndefined(sourceFormat)) {\n            if (!isNullOrUndefined(sourceFormat.leftIndent)) {\n                paragraphFormat.leftIndent = sourceFormat.leftIndent;\n            }\n            if (!isNullOrUndefined(sourceFormat.rightIndent)) {\n                paragraphFormat.rightIndent = sourceFormat.rightIndent;\n            }\n            if (!isNullOrUndefined(sourceFormat.firstLineIndent)) {\n                paragraphFormat.firstLineIndent = sourceFormat.firstLineIndent;\n            }\n            if (!isNullOrUndefined(sourceFormat.afterSpacing)) {\n                paragraphFormat.afterSpacing = sourceFormat.afterSpacing;\n            }\n            if (!isNullOrUndefined(sourceFormat.beforeSpacing)) {\n                paragraphFormat.beforeSpacing = sourceFormat.beforeSpacing;\n            }\n            if (!isNullOrUndefined(sourceFormat.lineSpacing)) {\n                paragraphFormat.lineSpacing = sourceFormat.lineSpacing;\n            }\n            if (!isNullOrUndefined(sourceFormat.lineSpacingType)) {\n                paragraphFormat.lineSpacingType = sourceFormat.lineSpacingType;\n            }\n            if (!isNullOrUndefined(sourceFormat.textAlignment)) {\n                paragraphFormat.textAlignment = sourceFormat.textAlignment;\n            }\n            if (!isNullOrUndefined(sourceFormat.outlineLevel)) {\n                paragraphFormat.outlineLevel = sourceFormat.outlineLevel;\n            }\n            paragraphFormat.listFormat = new WListFormat();\n            if (sourceFormat.hasOwnProperty('listFormat')) {\n                this.parseListFormat(sourceFormat, paragraphFormat.listFormat);\n            }\n            if (sourceFormat.hasOwnProperty('tabs')) {\n                this.parseTabStop(sourceFormat.tabs, paragraphFormat.tabs);\n            }\n        }\n    };\n    SfdtReader.prototype.parseListFormat = function (block, listFormat) {\n        if (!isNullOrUndefined(block.listFormat)) {\n            if (!isNullOrUndefined(block.listFormat.listId)) {\n                listFormat.listId = block.listFormat.listId;\n                listFormat.list = this.viewer.getListById(block.listFormat.listId);\n            }\n            if (!isNullOrUndefined(block.listFormat.listLevelNumber)) {\n                listFormat.listLevelNumber = block.listFormat.listLevelNumber;\n            }\n        }\n    };\n    SfdtReader.prototype.parseSectionFormat = function (data, sectionFormat) {\n        if (!isNullOrUndefined(data.pageWidth)) {\n            sectionFormat.pageWidth = data.pageWidth;\n        }\n        if (!isNullOrUndefined(data.pageHeight)) {\n            sectionFormat.pageHeight = data.pageHeight;\n        }\n        if (!isNullOrUndefined(data.leftMargin)) {\n            sectionFormat.leftMargin = data.leftMargin;\n        }\n        if (!isNullOrUndefined(data.topMargin)) {\n            sectionFormat.topMargin = data.topMargin;\n        }\n        if (!isNullOrUndefined(data.rightMargin)) {\n            sectionFormat.rightMargin = data.rightMargin;\n        }\n        if (!isNullOrUndefined(data.bottomMargin)) {\n            sectionFormat.bottomMargin = data.bottomMargin;\n        }\n        if (!isNullOrUndefined(data.headerDistance)) {\n            sectionFormat.headerDistance = data.headerDistance;\n        }\n        if (!isNullOrUndefined(data.footerDistance)) {\n            sectionFormat.footerDistance = data.footerDistance;\n        }\n        if (!isNullOrUndefined(data.differentFirstPage)) {\n            sectionFormat.differentFirstPage = data.differentFirstPage;\n        }\n        if (!isNullOrUndefined(data.differentOddAndEvenPages)) {\n            sectionFormat.differentOddAndEvenPages = data.differentOddAndEvenPages;\n        }\n    };\n    SfdtReader.prototype.parseTabStop = function (wTabs, tabs) {\n        for (var i = 0; i < wTabs.length; i++) {\n            var tabStop = new WTabStop();\n            tabStop.position = wTabs[i].position;\n            tabStop.tabLeader = wTabs[i].tabLeader;\n            tabStop.deletePosition = wTabs[i].deletePosition;\n            tabStop.tabJustification = wTabs[i].tabJustification;\n            tabs.push(tabStop);\n        }\n    };\n    return SfdtReader;\n}());\nexport { SfdtReader };\n","import { WShading } from '../format/index';\nimport { isNullOrUndefined } from '@syncfusion/ej2-base';\nimport { WList } from '../list/list';\nimport { WAbstractList } from '../list/abstract-list';\nimport { WListLevel } from '../list/list-level';\n/**\n * Selection character format implementation\n */\nvar SelectionCharacterFormat = /** @class */ (function () {\n    /**\n     * @private\n     */\n    function SelectionCharacterFormat(selection) {\n        this.boldIn = undefined;\n        this.italicIn = undefined;\n        this.underlineIn = undefined;\n        this.strikeThroughIn = undefined;\n        this.baselineAlignmentIn = undefined;\n        this.highlightColorIn = undefined;\n        this.fontSizeIn = 0;\n        this.fontColorIn = undefined;\n        this.selection = selection;\n    }\n    Object.defineProperty(SelectionCharacterFormat.prototype, \"fontSize\", {\n        /**\n         * Gets or sets the font size of selected contents.\n         */\n        get: function () {\n            return this.fontSizeIn;\n        },\n        set: function (value) {\n            if (value === this.fontSizeIn) {\n                return;\n            }\n            this.fontSizeIn = value;\n            this.notifyPropertyChanged('fontSize');\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(SelectionCharacterFormat.prototype, \"fontFamily\", {\n        /**\n         * Gets or sets the font family of selected contents.\n         */\n        get: function () {\n            return this.fontFamilyIn;\n        },\n        set: function (value) {\n            if (value === this.fontFamilyIn) {\n                return;\n            }\n            this.fontFamilyIn = value;\n            this.notifyPropertyChanged('fontFamily');\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(SelectionCharacterFormat.prototype, \"fontColor\", {\n        /**\n         * Gets or sets the font color of selected contents.\n         */\n        get: function () {\n            return this.fontColorIn;\n        },\n        set: function (value) {\n            if (value === this.fontColorIn) {\n                return;\n            }\n            this.fontColorIn = value;\n            this.notifyPropertyChanged('fontColor');\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(SelectionCharacterFormat.prototype, \"bold\", {\n        /**\n         * Gets or sets the bold formatting of selected contents.\n         */\n        get: function () {\n            return this.boldIn;\n        },\n        set: function (value) {\n            if (value === this.boldIn) {\n                return;\n            }\n            this.boldIn = value;\n            this.notifyPropertyChanged('bold');\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(SelectionCharacterFormat.prototype, \"italic\", {\n        /**\n         * Gets or sets the italic formatting of selected contents.\n         */\n        get: function () {\n            return this.italicIn;\n        },\n        set: function (value) {\n            if (value === this.italic) {\n                return;\n            }\n            this.italicIn = value;\n            this.notifyPropertyChanged('italic');\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(SelectionCharacterFormat.prototype, \"strikethrough\", {\n        /**\n         * Gets or sets the strikethrough property of selected contents.\n         */\n        get: function () {\n            return this.strikeThroughIn;\n        },\n        set: function (value) {\n            if (value === this.strikeThroughIn) {\n                return;\n            }\n            this.strikeThroughIn = value;\n            this.notifyPropertyChanged('strikethrough');\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(SelectionCharacterFormat.prototype, \"baselineAlignment\", {\n        /**\n         * Gets or sets the baseline alignment property of selected contents.\n         */\n        get: function () {\n            return this.baselineAlignmentIn;\n        },\n        set: function (value) {\n            if (value === this.baselineAlignmentIn) {\n                return;\n            }\n            this.baselineAlignmentIn = value;\n            this.notifyPropertyChanged('baselineAlignment');\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(SelectionCharacterFormat.prototype, \"underline\", {\n        /**\n         * Gets or sets the underline style of selected contents.\n         */\n        get: function () {\n            return this.underlineIn;\n        },\n        set: function (value) {\n            if (value === this.underlineIn) {\n                return;\n            }\n            this.underlineIn = value;\n            this.notifyPropertyChanged('underline');\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(SelectionCharacterFormat.prototype, \"highlightColor\", {\n        /**\n         * Gets or sets the highlight color of selected contents.\n         */\n        get: function () {\n            return this.highlightColorIn;\n        },\n        set: function (value) {\n            if (value === this.highlightColorIn) {\n                return;\n            }\n            this.highlightColorIn = value;\n            this.notifyPropertyChanged('highlightColor');\n        },\n        enumerable: true,\n        configurable: true\n    });\n    SelectionCharacterFormat.prototype.getPropertyValue = function (property) {\n        switch (property) {\n            case 'bold':\n                return this.bold;\n            case 'italic':\n                return this.italic;\n            case 'fontSize':\n                if (this.fontSize >= 1) {\n                    return this.fontSize;\n                }\n                return undefined;\n            case 'fontFamily':\n                return this.fontFamily;\n            case 'strikethrough':\n                return this.strikethrough;\n            case 'baselineAlignment':\n                return this.baselineAlignment;\n            case 'highlightColor':\n                return this.highlightColor;\n            case 'underline':\n                return this.underline;\n            case 'fontColor':\n                return this.fontColor;\n            default:\n                return undefined;\n        }\n    };\n    /**\n     * Notifies whenever property gets changed.\n     * @param  {string} propertyName\n     */\n    SelectionCharacterFormat.prototype.notifyPropertyChanged = function (propertyName) {\n        // tslint:disable-next-line:max-line-length\n        if (!isNullOrUndefined(this.selection) && (this.selection.isCleared || this.selection.owner.isReadOnlyMode || !this.selection.owner.isDocumentLoaded || this.selection.owner.isPastingContent) && !this.selection.isRetrieveFormatting) {\n            return;\n        }\n        if (!isNullOrUndefined(this.selection) && !isNullOrUndefined(this.selection.start) && !this.selection.isRetrieveFormatting) {\n            var propertyValue = this.getPropertyValue(propertyName);\n            if (!isNullOrUndefined(propertyValue)) {\n                this.selection.owner.editorModule.onApplyCharacterFormat(propertyName, propertyValue);\n            }\n        }\n    };\n    /**\n     * Copies the source format.\n     * @param  {WCharacterFormat} format\n     * @returns void\n     * @private\n     */\n    SelectionCharacterFormat.prototype.copyFormat = function (format) {\n        this.styleName = !isNullOrUndefined(format.baseCharStyle) ? format.baseCharStyle.name : 'Default Paragraph Font';\n        this.fontSize = format.fontSize;\n        this.fontFamily = format.fontFamily;\n        this.bold = format.bold;\n        this.italic = format.italic;\n        this.baselineAlignment = format.baselineAlignment;\n        this.underline = format.underline;\n        this.fontColor = format.fontColor;\n        this.highlightColor = format.highlightColor;\n        this.strikethrough = format.strikethrough;\n    };\n    /**\n     * Combines the format.\n     * @param  {WCharacterFormat} format\n     * @private\n     */\n    SelectionCharacterFormat.prototype.combineFormat = function (format) {\n        if (!isNullOrUndefined(this.bold) && this.bold !== format.bold) {\n            this.bold = undefined;\n        }\n        if (!isNullOrUndefined(this.italic) && this.italic !== format.italic) {\n            this.italic = undefined;\n        }\n        if (this.fontSize !== 0 && this.fontSize !== format.fontSize) {\n            this.fontSize = 0;\n        }\n        if (!isNullOrUndefined(this.fontFamily) && this.fontFamily !== format.fontFamily) {\n            this.fontFamily = undefined;\n        }\n        if (!isNullOrUndefined(this.highlightColor) && this.highlightColor !== format.highlightColor) {\n            this.highlightColor = undefined;\n        }\n        if (!isNullOrUndefined(this.baselineAlignment) && this.baselineAlignment !== format.baselineAlignment) {\n            this.baselineAlignment = undefined;\n        }\n        if (!isNullOrUndefined(this.fontColor) && (this.fontColor !== format.fontColor)) {\n            this.fontColor = undefined;\n        }\n        if (!isNullOrUndefined(this.underline) && this.underline !== format.underline) {\n            this.underline = undefined;\n        }\n        if (!isNullOrUndefined(this.strikethrough) && this.strikethrough !== format.strikethrough) {\n            this.strikethrough = undefined;\n        }\n    };\n    /**\n     * Clones the format.\n     * @param  {SelectionCharacterFormat} selectionCharacterFormat\n     * @returns void\n     * @private\n     */\n    SelectionCharacterFormat.prototype.cloneFormat = function (selectionCharacterFormat) {\n        this.bold = selectionCharacterFormat.bold;\n        this.italic = selectionCharacterFormat.italic;\n        this.underline = selectionCharacterFormat.underline;\n        this.strikethrough = selectionCharacterFormat.strikethrough;\n        this.baselineAlignment = selectionCharacterFormat.baselineAlignment;\n        this.highlightColor = selectionCharacterFormat.highlightColor;\n        this.fontSize = selectionCharacterFormat.fontSize;\n        this.fontFamily = selectionCharacterFormat.fontFamily;\n        this.fontColor = selectionCharacterFormat.fontColor;\n        this.styleName = selectionCharacterFormat.styleName;\n    };\n    /**\n     * Checks whether current format is equal to the source format or not.\n     * @param  {SelectionCharacterFormat} format\n     * @returns boolean\n     * @private\n     */\n    SelectionCharacterFormat.prototype.isEqualFormat = function (format) {\n        return (this.fontSize === format.fontSize\n            && this.strikethrough === format.strikethrough\n            && this.bold === format.bold\n            && this.fontFamily === format.fontFamily\n            && this.underline === format.underline\n            && this.highlightColor === format.highlightColor\n            && this.italic === format.italic\n            && this.baselineAlignment === format.baselineAlignment\n            && this.fontColor === format.fontColor);\n    };\n    /**\n     * Clears the format.\n     * @returns void\n     * @private\n     */\n    SelectionCharacterFormat.prototype.clearFormat = function () {\n        this.fontSizeIn = 0;\n        this.boldIn = undefined;\n        this.italicIn = undefined;\n        this.fontFamilyIn = undefined;\n        this.fontColorIn = undefined;\n        this.underlineIn = undefined;\n        this.strikeThroughIn = undefined;\n        this.highlightColorIn = undefined;\n        this.baselineAlignmentIn = undefined;\n        this.styleName = undefined;\n    };\n    /**\n     * Destroys the maintained resources.\n     * @returns void\n     * @private\n     */\n    SelectionCharacterFormat.prototype.destroy = function () {\n        this.fontSizeIn = undefined;\n        this.boldIn = undefined;\n        this.italicIn = undefined;\n        this.fontFamilyIn = undefined;\n        this.fontColorIn = undefined;\n        this.underlineIn = undefined;\n        this.strikeThroughIn = undefined;\n        this.baselineAlignmentIn = undefined;\n        this.highlightColorIn = undefined;\n        this.selection = undefined;\n        this.styleName = undefined;\n    };\n    return SelectionCharacterFormat;\n}());\nexport { SelectionCharacterFormat };\n/**\n * Selection paragraph format implementation\n */\nvar SelectionParagraphFormat = /** @class */ (function () {\n    /**\n     * @private\n     */\n    function SelectionParagraphFormat(selection, viewer) {\n        // Declaring the character format properties.\n        this.leftIndentIn = 0;\n        this.rightIndentIn = 0;\n        this.beforeSpacingIn = 0;\n        this.afterSpacingIn = 0;\n        this.textAlignmentIn = undefined;\n        this.firstLineIndentIn = 0;\n        this.lineSpacingIn = 1;\n        this.lineSpacingTypeIn = undefined;\n        this.listLevelNumberIn = -1;\n        this.selection = selection;\n        this.viewer = viewer;\n    }\n    Object.defineProperty(SelectionParagraphFormat.prototype, \"leftIndent\", {\n        /**\n         * Gets or Sets the left indent for selected paragraphs.\n         * @default undefined\n         */\n        get: function () {\n            return this.leftIndentIn;\n        },\n        set: function (value) {\n            if (value === this.leftIndentIn) {\n                return;\n            }\n            this.leftIndentIn = value;\n            this.notifyPropertyChanged('leftIndent');\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(SelectionParagraphFormat.prototype, \"rightIndent\", {\n        /**\n         * Gets or Sets the right indent for selected paragraphs.\n         * @default undefined\n         */\n        get: function () {\n            return this.rightIndentIn;\n        },\n        set: function (value) {\n            if (value === this.rightIndentIn) {\n                return;\n            }\n            this.rightIndentIn = value;\n            this.notifyPropertyChanged('rightIndent');\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(SelectionParagraphFormat.prototype, \"firstLineIndent\", {\n        /**\n         * Gets or Sets the first line indent for selected paragraphs.\n         * @default undefined\n         */\n        get: function () {\n            return this.firstLineIndentIn;\n        },\n        set: function (value) {\n            if (value === this.firstLineIndentIn) {\n                return;\n            }\n            this.firstLineIndentIn = value;\n            this.notifyPropertyChanged('firstLineIndent');\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(SelectionParagraphFormat.prototype, \"textAlignment\", {\n        /**\n         * Gets or Sets the text alignment for selected paragraphs.\n         * @default undefined\n         */\n        get: function () {\n            return this.textAlignmentIn;\n        },\n        set: function (value) {\n            if (value === this.textAlignmentIn) {\n                return;\n            }\n            this.textAlignmentIn = value;\n            this.notifyPropertyChanged('textAlignment');\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(SelectionParagraphFormat.prototype, \"afterSpacing\", {\n        /**\n         * Gets or Sets the after spacing for selected paragraphs.\n         * @default undefined\n         */\n        get: function () {\n            return this.afterSpacingIn;\n        },\n        set: function (value) {\n            if (value === this.afterSpacingIn) {\n                return;\n            }\n            this.afterSpacingIn = value;\n            this.notifyPropertyChanged('afterSpacing');\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(SelectionParagraphFormat.prototype, \"beforeSpacing\", {\n        /**\n         * Gets or Sets the before spacing for selected paragraphs.\n         * @default undefined\n         */\n        get: function () {\n            return this.beforeSpacingIn;\n        },\n        set: function (value) {\n            if (value === this.beforeSpacingIn) {\n                return;\n            }\n            this.beforeSpacingIn = value;\n            this.notifyPropertyChanged('beforeSpacing');\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(SelectionParagraphFormat.prototype, \"lineSpacing\", {\n        /**\n         * Gets or Sets the line spacing for selected paragraphs.\n         * @default undefined\n         */\n        get: function () {\n            return this.lineSpacingIn;\n        },\n        set: function (value) {\n            if (value === this.lineSpacingIn) {\n                return;\n            }\n            this.lineSpacingIn = value;\n            this.notifyPropertyChanged('lineSpacing');\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(SelectionParagraphFormat.prototype, \"lineSpacingType\", {\n        /**\n         * Gets or Sets the line spacing type for selected paragraphs.\n         * @default undefined\n         */\n        get: function () {\n            return this.lineSpacingTypeIn;\n        },\n        set: function (value) {\n            if (value === this.lineSpacingTypeIn) {\n                return;\n            }\n            this.lineSpacingTypeIn = value;\n            this.notifyPropertyChanged('lineSpacingType');\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(SelectionParagraphFormat.prototype, \"listLevelNumber\", {\n        /**\n         * Gets or Sets the list level number for selected paragraphs.\n         * @default undefined\n         */\n        get: function () {\n            return this.listLevelNumberIn;\n        },\n        set: function (value) {\n            if (value === this.listLevelNumberIn) {\n                return;\n            }\n            this.listLevelNumberIn = value;\n            this.notifyPropertyChanged('listLevelNumber');\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(SelectionParagraphFormat.prototype, \"listText\", {\n        /**\n         * Gets the list text for selected paragraphs.\n         */\n        get: function () {\n            var listFormat = undefined;\n            var list = this.viewer.getListById(this.listId);\n            if (list instanceof WList && this.listLevelNumberIn > -1 && this.listLevelNumberIn < 9) {\n                var listLevel = list.getListLevel(this.listLevelNumber);\n                if (listLevel instanceof WListLevel) {\n                    if (listLevel.listLevelPattern === 'Bullet') {\n                        listFormat = listLevel.numberFormat;\n                    }\n                    else {\n                        listFormat = listLevel.numberFormat;\n                        for (var i = 0; i < 9; i++) {\n                            var levelPattern = '%' + (i + 1);\n                            if (listFormat.indexOf(levelPattern) > -1) {\n                                var level = i === this.listLevelNumberIn ? listLevel : list.getListLevel(i);\n                                var listText = this.selection.owner.viewer.layout.getListTextListLevel(level, 1);\n                                listFormat = listFormat.replace(levelPattern, listText);\n                            }\n                        }\n                    }\n                }\n            }\n            return listFormat;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    SelectionParagraphFormat.prototype.getPropertyValue = function (property) {\n        switch (property) {\n            case 'leftIndent':\n                return this.leftIndent;\n            case 'rightIndent':\n                return this.rightIndent;\n            case 'firstLineIndent':\n                return this.firstLineIndent;\n            case 'beforeSpacing':\n                return this.beforeSpacing;\n            case 'afterSpacing':\n                return this.afterSpacing;\n            case 'textAlignment':\n                return this.textAlignment;\n            case 'lineSpacing':\n                return this.lineSpacing;\n            case 'lineSpacingType':\n                return this.lineSpacingType;\n            default:\n                return undefined;\n        }\n    };\n    /**\n     * Notifies whenever the property gets changed.\n     * @param  {string} propertyName\n     */\n    SelectionParagraphFormat.prototype.notifyPropertyChanged = function (propertyName) {\n        if (!isNullOrUndefined(this.selection) &&\n            (this.selection.owner.isReadOnlyMode || !this.selection.owner.isDocumentLoaded)\n            && !this.selection.isRetrieveFormatting) {\n            return;\n        }\n        if (!isNullOrUndefined(this.selection) && !isNullOrUndefined(this.selection.start) && !this.selection.isRetrieveFormatting) {\n            var editorModule = this.selection.owner.editorModule;\n            var value = this.getPropertyValue(propertyName);\n            if ((propertyName === 'leftIndent' || propertyName === 'rightIndent' || propertyName === 'firstLineIndent')\n                && !(value >= -1056 && value < 1056)) {\n                return;\n            }\n            if (propertyName === 'listLevelNumber') {\n                editorModule.onApplyListInternal(this.viewer.getListById(this.listId), this.listLevelNumber);\n            }\n            else {\n                editorModule.onApplyParagraphFormat(propertyName, value, propertyName === 'textAlignment' ? true : false, false);\n            }\n        }\n    };\n    /**\n     * Copies the format.\n     * @param  {WParagraphFormat} format\n     * @returns void\n     * @private\n     */\n    SelectionParagraphFormat.prototype.copyFormat = function (format) {\n        this.styleName = !isNullOrUndefined(format.baseStyle) ? format.baseStyle.name : 'Normal';\n        this.leftIndent = format.leftIndent;\n        this.rightIndent = format.rightIndent;\n        this.firstLineIndent = format.firstLineIndent;\n        this.afterSpacing = format.afterSpacing;\n        this.beforeSpacing = format.beforeSpacing;\n        this.lineSpacing = format.lineSpacing;\n        this.lineSpacingType = format.lineSpacingType;\n        this.textAlignment = format.textAlignment;\n        if (!isNullOrUndefined(format.listFormat) && !isNullOrUndefined(format.listFormat.listId)) {\n            this.listId = format.listFormat.listId;\n            this.listLevelNumber = format.listFormat.listLevelNumber;\n        }\n        else {\n            this.listId = undefined;\n            this.listLevelNumber = 0;\n        }\n    };\n    /**\n     * Copies to format.\n     * @param  {WParagraphFormat} format\n     * @private\n     */\n    SelectionParagraphFormat.prototype.copyToFormat = function (format) {\n        if (isNullOrUndefined(format)) {\n            return;\n        }\n        if (!isNullOrUndefined(this.afterSpacing)) {\n            format.afterSpacing = this.afterSpacing;\n        }\n        if (!isNullOrUndefined(this.beforeSpacing)) {\n            format.beforeSpacing = this.beforeSpacing;\n        }\n        if (!isNullOrUndefined(this.leftIndent)) {\n            format.leftIndent = this.leftIndent;\n        }\n        if (!isNullOrUndefined(this.rightIndent)) {\n            format.rightIndent = this.rightIndent;\n        }\n        if (!isNullOrUndefined(this.textAlignment)) {\n            format.textAlignment = this.textAlignment;\n        }\n        if (!isNullOrUndefined(this.lineSpacing)) {\n            format.lineSpacing = this.lineSpacing;\n        }\n        if (!isNullOrUndefined(this.lineSpacingType)) {\n            format.lineSpacingType = this.lineSpacingType;\n        }\n        if (!isNullOrUndefined(this.firstLineIndent)) {\n            format.firstLineIndent = this.firstLineIndent;\n        }\n    };\n    /**\n     * Combines the format.\n     * @param  {WParagraphFormat} format\n     * @private\n     */\n    SelectionParagraphFormat.prototype.combineFormat = function (format) {\n        if (!isNullOrUndefined(this.leftIndent) && this.leftIndent !== format.leftIndent) {\n            this.leftIndent = undefined;\n        }\n        if (!isNullOrUndefined(this.rightIndent) && this.rightIndent !== format.rightIndent) {\n            this.rightIndent = undefined;\n        }\n        if (!isNullOrUndefined(this.firstLineIndent) && this.firstLineIndent !== format.firstLineIndent) {\n            this.firstLineIndent = undefined;\n        }\n        if (this.lineSpacing !== 0 && this.lineSpacing !== format.lineSpacing) {\n            this.lineSpacing = 0;\n        }\n        if (this.beforeSpacing !== -1 && this.beforeSpacing !== format.beforeSpacing) {\n            this.beforeSpacing = -1;\n        }\n        if (this.afterSpacing !== -1 && this.afterSpacing !== format.afterSpacing) {\n            this.afterSpacing = -1;\n        }\n        if (!isNullOrUndefined(this.lineSpacingType) && this.lineSpacingType !== format.lineSpacingType) {\n            this.lineSpacingType = undefined;\n        }\n        if (!isNullOrUndefined(this.textAlignment) && this.textAlignment !== format.textAlignment) {\n            this.textAlignment = undefined;\n        }\n        // tslint:disable-next-line:max-line-length\n        if (this.listLevelNumber >= 0 && !isNullOrUndefined(this.listId) && (isNullOrUndefined(format.listFormat) || format.listFormat.listLevelNumber !== this.listLevelNumber)) {\n            this.listLevelNumber = -1;\n        }\n        // tslint:disable-next-line:max-line-length\n        if (isNullOrUndefined(format.listFormat) || isNullOrUndefined(format.listFormat.listId) || (!isNullOrUndefined(this.listId) && this.listId !== format.listFormat.listId)) {\n            this.listId = undefined;\n        }\n    };\n    /**\n     * Clears the format.\n     * @returns void\n     * @private\n     */\n    SelectionParagraphFormat.prototype.clearFormat = function () {\n        this.leftIndent = 0;\n        this.rightIndent = 0;\n        this.beforeSpacing = 0;\n        this.afterSpacing = 0;\n        this.firstLineIndent = 0;\n        this.lineSpacing = 1;\n        this.textAlignment = undefined;\n        this.lineSpacingType = undefined;\n        this.listId = undefined;\n        this.listLevelNumber = -1;\n        this.styleName = undefined;\n    };\n    /**\n     * Gets the clone of list at current selection.\n     * @returns WList\n     * @private\n     */\n    SelectionParagraphFormat.prototype.getList = function () {\n        var list = this.viewer.getListById(this.listId);\n        if (!isNullOrUndefined(list)) {\n            var listAdv = new WList();\n            var abstractList = new WAbstractList();\n            var currentAbstractList = this.viewer.getAbstractListById(list.abstractListId);\n            var editor = this.selection.owner.editorModule;\n            if (!isNullOrUndefined(currentAbstractList)) {\n                for (var i = 0; i < currentAbstractList.levels.length; i++) {\n                    var level = editor.cloneListLevel(currentAbstractList.levels[i]);\n                    abstractList.levels.push(level);\n                    level.ownerBase = abstractList;\n                }\n            }\n            else {\n                abstractList.levels.push(new WListLevel(abstractList));\n            }\n            if (!isNullOrUndefined(list.levelOverrides)) {\n                for (var i = 0; i < list.levelOverrides.length; i++) {\n                    var levelOverride = editor.cloneLevelOverride(list.levelOverrides[i]);\n                    listAdv.levelOverrides.push(levelOverride);\n                }\n            }\n            listAdv.abstractList = abstractList;\n            listAdv.abstractListId = abstractList.abstractListId;\n            listAdv.sourceListId = list.listId;\n            return listAdv;\n        }\n        return undefined;\n    };\n    /**\n     * Modifies the list at current selection.\n     * @param  {WList} listAdv\n     * @private\n     */\n    SelectionParagraphFormat.prototype.setList = function (listAdv) {\n        if (this.viewer.owner.isReadOnlyMode || !this.viewer.owner.isDocumentLoaded) {\n            return;\n        }\n        var list = this.viewer.getListById(this.listId);\n        var collection = undefined;\n        var currentAbstractList = listAdv ? this.viewer.getAbstractListById(listAdv.abstractListId) : undefined;\n        if (!isNullOrUndefined(list) && !isNullOrUndefined(listAdv)\n            && !isNullOrUndefined(currentAbstractList) && listAdv.sourceListId === list.listId) {\n            var history_1 = this.viewer.owner.editorHistory;\n            var listLevel = this.viewer.layout.getListLevel(list, 1);\n            this.selection.owner.isLayoutEnabled = false;\n            this.viewer.owner.editorModule.setOffsetValue(this.selection);\n            if (history_1) {\n                collection = history_1.updateListChangesInHistory(currentAbstractList, list);\n            }\n            this.viewer.owner.editorModule.updateListParagraphs();\n            if (history_1) {\n                history_1.applyListChanges(this.selection, collection);\n            }\n            this.selection.owner.isLayoutEnabled = true;\n            this.viewer.renderedLists.clear();\n            // this.viewer.pages = [];\n            this.viewer.owner.editorModule.layoutWholeDocument();\n            this.viewer.owner.editorModule.updateSelectionTextPosition(false);\n            if (history_1 && history_1.currentBaseHistoryInfo) {\n                if (history_1.currentBaseHistoryInfo.modifiedProperties.length > 0) {\n                    history_1.currentBaseHistoryInfo.updateSelection();\n                }\n                history_1.updateHistory();\n            }\n            this.viewer.owner.editorModule.fireContentChange();\n        }\n        else if (!isNullOrUndefined(listAdv)) {\n            this.selection.owner.isLayoutEnabled = false;\n            if (!isNullOrUndefined(currentAbstractList) && this.viewer.abstractLists.indexOf(currentAbstractList) === -1) {\n                this.viewer.abstractLists.push(currentAbstractList);\n            }\n            if (this.viewer.lists.indexOf(listAdv) === -1) {\n                this.viewer.lists.push(listAdv);\n            }\n            //currentAbstractList.listType = 'Numbering';\n            this.selection.owner.isLayoutEnabled = true;\n            this.selection.owner.editorModule.onApplyList(listAdv);\n        }\n        else {\n            this.selection.owner.editorModule.onApplyList(undefined);\n        }\n    };\n    /**\n     * Destroys the managed resources.\n     * @returns void\n     * @private\n     */\n    SelectionParagraphFormat.prototype.destroy = function () {\n        this.leftIndentIn = undefined;\n        this.rightIndentIn = undefined;\n        this.beforeSpacingIn = undefined;\n        this.afterSpacingIn = undefined;\n        this.firstLineIndentIn = undefined;\n        this.lineSpacingIn = undefined;\n        this.textAlignmentIn = undefined;\n        this.lineSpacingTypeIn = undefined;\n        this.listId = undefined;\n        this.listLevelNumberIn = undefined;\n        this.viewer = undefined;\n        this.selection = undefined;\n        this.styleName = undefined;\n    };\n    return SelectionParagraphFormat;\n}());\nexport { SelectionParagraphFormat };\n/**\n * Selection section format implementation\n */\nvar SelectionSectionFormat = /** @class */ (function () {\n    /**\n     * @private\n     */\n    function SelectionSectionFormat(selection) {\n        this.differentFirstPageIn = undefined;\n        this.differentOddAndEvenPagesIn = undefined;\n        this.selection = selection;\n    }\n    Object.defineProperty(SelectionSectionFormat.prototype, \"pageHeight\", {\n        /**\n         * Gets or sets the page height.\n         */\n        get: function () {\n            return this.pageHeightIn;\n        },\n        set: function (value) {\n            this.pageHeightIn = value;\n            this.notifyPropertyChanged('pageHeight');\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(SelectionSectionFormat.prototype, \"pageWidth\", {\n        /**\n         * Gets or sets the page width.\n         */\n        get: function () {\n            return this.pageWidthIn;\n        },\n        set: function (value) {\n            this.pageWidthIn = value;\n            this.notifyPropertyChanged('pageWidth');\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(SelectionSectionFormat.prototype, \"leftMargin\", {\n        /**\n         * Gets or sets the page left margin.\n         */\n        get: function () {\n            return this.leftMarginIn;\n        },\n        set: function (value) {\n            this.leftMarginIn = value;\n            this.notifyPropertyChanged('leftMargin');\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(SelectionSectionFormat.prototype, \"bottomMargin\", {\n        /**\n         * Gets or sets the page bottom margin.\n         */\n        get: function () {\n            return this.bottomMarginIn;\n        },\n        set: function (value) {\n            this.bottomMarginIn = value;\n            this.notifyPropertyChanged('bottomMargin');\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(SelectionSectionFormat.prototype, \"topMargin\", {\n        /**\n         * Gets or sets the page top margin.\n         */\n        get: function () {\n            return this.topMarginIn;\n        },\n        set: function (value) {\n            this.topMarginIn = value;\n            this.notifyPropertyChanged('topMargin');\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(SelectionSectionFormat.prototype, \"rightMargin\", {\n        /**\n         * Gets or sets the page right margin.\n         */\n        get: function () {\n            return this.rightMarginIn;\n        },\n        set: function (value) {\n            this.rightMarginIn = value;\n            this.notifyPropertyChanged('rightMargin');\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(SelectionSectionFormat.prototype, \"headerDistance\", {\n        /**\n         * Gets or sets the header distance.\n         */\n        get: function () {\n            return this.headerDistanceIn;\n        },\n        set: function (value) {\n            this.headerDistanceIn = value;\n            this.notifyPropertyChanged('headerDistance');\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(SelectionSectionFormat.prototype, \"footerDistance\", {\n        /**\n         * Gets or sets the footer distance.\n         */\n        get: function () {\n            return this.footerDistanceIn;\n        },\n        set: function (value) {\n            this.footerDistanceIn = value;\n            this.notifyPropertyChanged('footerDistance');\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(SelectionSectionFormat.prototype, \"differentFirstPage\", {\n        /**\n         * Gets or sets a value indicating whether the section has different first page.\n         */\n        get: function () {\n            return this.differentFirstPageIn;\n        },\n        set: function (value) {\n            this.differentFirstPageIn = value;\n            this.notifyPropertyChanged('differentFirstPage');\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(SelectionSectionFormat.prototype, \"differentOddAndEvenPages\", {\n        /**\n         * Gets or sets a value indicating whether the section has different odd and even page.\n         */\n        get: function () {\n            return this.differentOddAndEvenPagesIn;\n        },\n        set: function (value) {\n            this.differentOddAndEvenPagesIn = value;\n            this.notifyPropertyChanged('differentOddAndEvenPages');\n        },\n        enumerable: true,\n        configurable: true\n    });\n    /**\n     * Copies the format.\n     * @param  {WSectionFormat} format\n     * @returns void\n     * @private\n     */\n    SelectionSectionFormat.prototype.copyFormat = function (format) {\n        this.pageHeight = format.pageHeight;\n        this.pageWidth = format.pageWidth;\n        this.leftMargin = format.leftMargin;\n        this.topMargin = format.topMargin;\n        this.rightMargin = format.rightMargin;\n        this.bottomMargin = format.bottomMargin;\n        this.headerDistance = format.headerDistance;\n        this.footerDistance = format.footerDistance;\n        this.differentFirstPage = format.differentFirstPage;\n        this.differentOddAndEvenPages = format.differentOddAndEvenPages;\n    };\n    SelectionSectionFormat.prototype.notifyPropertyChanged = function (propertyName) {\n        var selection = this.selection;\n        if (!isNullOrUndefined(selection) && (selection.isCleared || selection.owner.isPastingContent\n            || selection.owner.isReadOnlyMode || !selection.owner.isDocumentLoaded)\n            && !selection.isRetrieveFormatting) {\n            return;\n        }\n        if (!isNullOrUndefined(selection) && !isNullOrUndefined(selection.start) && !selection.isRetrieveFormatting) {\n            var value = this.getPropertyvalue(propertyName);\n            if (!isNullOrUndefined(value)) {\n                selection.owner.editorModule.onApplySectionFormat(propertyName, value);\n            }\n        }\n    };\n    SelectionSectionFormat.prototype.getPropertyvalue = function (propertyName) {\n        switch (propertyName) {\n            case 'pageHeight':\n                if (this.pageHeight > 0) {\n                    return this.pageHeight;\n                }\n                return undefined;\n            case 'pageWidth':\n                if (this.pageWidth > 0) {\n                    return this.pageWidth;\n                }\n                return undefined;\n            case 'leftMargin':\n                if (this.leftMargin >= 0) {\n                    return this.leftMargin;\n                }\n                return undefined;\n            case 'rightMargin':\n                if (this.rightMargin >= 0) {\n                    return this.rightMargin;\n                }\n                return undefined;\n            case 'topMargin':\n                if (this.topMargin >= 0) {\n                    return this.topMargin;\n                }\n                return undefined;\n            case 'bottomMargin':\n                if (this.bottomMargin >= 0) {\n                    return this.bottomMargin;\n                }\n                return undefined;\n            case 'differentFirstPage':\n                if (!isNullOrUndefined(this.differentFirstPage)) {\n                    return this.differentFirstPage;\n                }\n                return undefined;\n            case 'differentOddAndEvenPages':\n                if (!isNullOrUndefined(this.differentOddAndEvenPages)) {\n                    return this.differentOddAndEvenPages;\n                }\n                return undefined;\n            case 'headerDistance':\n                return this.headerDistanceIn;\n            case 'footerDistance':\n                return this.footerDistance;\n            default:\n                return undefined;\n        }\n    };\n    /**\n     * Combines the format.\n     * @param  {WSectionFormat} format\n     * @private\n     */\n    SelectionSectionFormat.prototype.combineFormat = function (format) {\n        if (this.pageHeight > 0 && this.pageHeight !== format.pageHeight) {\n            this.pageHeight = 0;\n        }\n        if (this.pageWidth > 0 && this.pageWidth !== format.pageWidth) {\n            this.pageWidth = 0;\n        }\n        if (this.leftMargin > -1 && this.leftMargin !== format.leftMargin) {\n            this.leftMargin = -1;\n        }\n        if (this.topMargin > -1 && this.topMargin !== format.topMargin) {\n            this.topMargin = -1;\n        }\n        if (this.rightMargin > -1 && this.rightMargin !== format.rightMargin) {\n            this.rightMargin = -1;\n        }\n        if (this.bottomMargin > -1 && this.bottomMargin !== format.bottomMargin) {\n            this.bottomMargin = -1;\n        }\n        if (this.headerDistance !== 0 && this.headerDistance !== format.headerDistance) {\n            this.headerDistance = 0;\n        }\n        if (this.footerDistance !== 0 && this.footerDistance !== format.footerDistance) {\n            this.footerDistance = 0;\n        }\n        if (!isNullOrUndefined(this.differentFirstPage) && this.differentFirstPage !== format.differentFirstPage) {\n            this.differentFirstPage = undefined;\n        }\n        if (!isNullOrUndefined(this.differentOddAndEvenPages) && this.differentOddAndEvenPages !== format.differentOddAndEvenPages) {\n            this.differentOddAndEvenPages = undefined;\n        }\n    };\n    /**\n     * Clears the format.\n     * @returns void\n     * @private\n     */\n    SelectionSectionFormat.prototype.clearFormat = function () {\n        this.headerDistance = 0;\n        this.footerDistance = 0;\n        this.pageHeight = 0;\n        this.pageWidth = 0;\n        this.leftMargin = -1;\n        this.rightMargin = -1;\n        this.topMargin = -1;\n        this.bottomMargin = -1;\n        this.differentFirstPage = undefined;\n        this.differentOddAndEvenPages = undefined;\n    };\n    /**\n     * Destroys the managed resources.\n     * @returns void\n     * @private\n     */\n    SelectionSectionFormat.prototype.destroy = function () {\n        this.headerDistanceIn = undefined;\n        this.footerDistanceIn = undefined;\n        this.pageHeightIn = undefined;\n        this.pageWidthIn = undefined;\n        this.leftMarginIn = undefined;\n        this.rightMarginIn = undefined;\n        this.topMarginIn = undefined;\n        this.bottomMarginIn = undefined;\n        this.differentFirstPageIn = undefined;\n        this.differentOddAndEvenPagesIn = undefined;\n        this.selection = undefined;\n    };\n    return SelectionSectionFormat;\n}());\nexport { SelectionSectionFormat };\n/**\n * Selection table format implementation\n */\nvar SelectionTableFormat = /** @class */ (function () {\n    /**\n     * @private\n     */\n    function SelectionTableFormat(selection) {\n        this.leftIndentIn = 0;\n        this.backgroundIn = undefined;\n        this.tableAlignmentIn = undefined;\n        this.cellSpacingIn = 0;\n        this.leftMarginIn = 0;\n        this.rightMarginIn = 0;\n        this.topMarginIn = 0;\n        this.bottomMarginIn = 0;\n        this.preferredWidthIn = 0;\n        this.selection = selection;\n    }\n    Object.defineProperty(SelectionTableFormat.prototype, \"table\", {\n        /**\n         * Gets or sets the table.\n         * @private\n         */\n        get: function () {\n            return this.tableIn;\n        },\n        set: function (value) {\n            this.tableIn = value;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(SelectionTableFormat.prototype, \"leftIndent\", {\n        /**\n         * Gets or Sets the left indent for selected table.\n         * @private\n         */\n        get: function () {\n            return this.leftIndentIn;\n        },\n        set: function (value) {\n            if (value === this.leftIndentIn) {\n                return;\n            }\n            this.leftIndentIn = value;\n            this.notifyPropertyChanged('leftIndent');\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(SelectionTableFormat.prototype, \"topMargin\", {\n        /**\n         * Gets or Sets the default top margin of cell for selected table.\n         * @default undefined\n         */\n        get: function () {\n            return this.topMarginIn;\n        },\n        set: function (value) {\n            if (value === this.topMarginIn) {\n                return;\n            }\n            this.topMarginIn = value;\n            this.notifyPropertyChanged('topMargin');\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(SelectionTableFormat.prototype, \"background\", {\n        /**\n         * Gets or Sets the background for selected table.\n         * @default undefined\n         */\n        get: function () {\n            return this.backgroundIn;\n        },\n        set: function (value) {\n            if (value === this.backgroundIn) {\n                return;\n            }\n            this.backgroundIn = value;\n            this.notifyPropertyChanged('background');\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(SelectionTableFormat.prototype, \"tableAlignment\", {\n        /**\n         * Gets or Sets the table alignment for selected table.\n         * @default undefined\n         */\n        get: function () {\n            return this.tableAlignmentIn;\n        },\n        set: function (value) {\n            if (value === this.tableAlignmentIn) {\n                return;\n            }\n            this.tableAlignmentIn = value;\n            this.notifyPropertyChanged('tableAlignment');\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(SelectionTableFormat.prototype, \"leftMargin\", {\n        /**\n         * Gets or Sets the default left margin of cell for selected table.\n         * @default undefined\n         */\n        get: function () {\n            return this.leftMarginIn;\n        },\n        set: function (value) {\n            if (value === this.leftMarginIn) {\n                return;\n            }\n            this.leftMarginIn = value;\n            this.notifyPropertyChanged('leftMargin');\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(SelectionTableFormat.prototype, \"bottomMargin\", {\n        /**\n         * Gets or Sets the default bottom margin of cell for selected table.\n         * @default undefined\n         */\n        get: function () {\n            return this.bottomMarginIn;\n        },\n        set: function (value) {\n            if (value === this.bottomMarginIn) {\n                return;\n            }\n            this.bottomMarginIn = value;\n            this.notifyPropertyChanged('bottomMargin');\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(SelectionTableFormat.prototype, \"cellSpacing\", {\n        /**\n         * Gets or Sets the cell spacing for selected table.\n         * @default undefined\n         */\n        get: function () {\n            return this.cellSpacingIn;\n        },\n        set: function (value) {\n            if (value === this.cellSpacingIn) {\n                return;\n            }\n            this.cellSpacingIn = value;\n            this.notifyPropertyChanged('cellSpacing');\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(SelectionTableFormat.prototype, \"rightMargin\", {\n        /**\n         * Gets or Sets the default right margin of cell for selected table.\n         * @default undefined\n         */\n        get: function () {\n            return this.rightMarginIn;\n        },\n        set: function (value) {\n            if (value === this.rightMarginIn) {\n                return;\n            }\n            this.rightMarginIn = value;\n            this.notifyPropertyChanged('rightMargin');\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(SelectionTableFormat.prototype, \"preferredWidth\", {\n        /**\n         * Gets or Sets the preferred width for selected table.\n         * @default undefined\n         */\n        get: function () {\n            return this.preferredWidthIn;\n        },\n        set: function (value) {\n            if (value === this.preferredWidthIn) {\n                return;\n            }\n            this.preferredWidthIn = value;\n            this.notifyPropertyChanged('preferredWidth');\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(SelectionTableFormat.prototype, \"preferredWidthType\", {\n        /**\n         * Gets or Sets the preferred width type for selected table.\n         * @default undefined\n         */\n        get: function () {\n            return this.preferredWidthTypeIn;\n        },\n        set: function (value) {\n            if (value === this.preferredWidthTypeIn) {\n                return;\n            }\n            this.preferredWidthTypeIn = value;\n            this.notifyPropertyChanged('preferredWidthType');\n        },\n        enumerable: true,\n        configurable: true\n    });\n    SelectionTableFormat.prototype.getPropertyValue = function (propertyName) {\n        switch (propertyName) {\n            case 'tableAlignment':\n                return this.tableAlignment;\n            case 'leftIndent':\n                return this.leftIndent;\n            case 'cellSpacing':\n                return this.cellSpacing;\n            case 'leftMargin':\n                return this.leftMargin;\n            case 'rightMargin':\n                return this.rightMargin;\n            case 'topMargin':\n                return this.topMargin;\n            case 'bottomMargin':\n                return this.bottomMargin;\n            case 'background':\n                var shading = new WShading();\n                shading.backgroundColor = this.background;\n                return shading;\n            case 'preferredWidth':\n                return this.preferredWidth;\n            case 'preferredWidthType':\n                return this.preferredWidthType;\n            default:\n                return undefined;\n        }\n    };\n    SelectionTableFormat.prototype.notifyPropertyChanged = function (propertyName) {\n        if (!isNullOrUndefined(this.selection) && (this.selection.isCleared\n            || !this.selection.owner.isDocumentLoaded || this.selection.owner.isReadOnlyMode\n            || this.selection.owner.isPastingContent) && !this.selection.isRetrieveFormatting) {\n            return;\n        }\n        if (!isNullOrUndefined(this.selection) && !isNullOrUndefined(this.selection.start) && !this.selection.isRetrieveFormatting) {\n            var value = this.getPropertyValue(propertyName);\n            if (propertyName === 'background') {\n                propertyName = 'shading';\n            }\n            if (!isNullOrUndefined(value)) {\n                this.selection.owner.editorModule.onApplyTableFormat(propertyName, value);\n            }\n        }\n    };\n    /**\n     * Copies the format.\n     * @param  {WTableFormat} format Format to copy.\n     * @returns void\n     * @private\n     */\n    SelectionTableFormat.prototype.copyFormat = function (format) {\n        this.leftIndent = format.leftIndent;\n        this.background = format.shading.backgroundColor;\n        this.tableAlignment = format.tableAlignment;\n        this.leftMargin = format.leftMargin;\n        this.rightMargin = format.rightMargin;\n        this.topMargin = format.topMargin;\n        this.bottomMargin = format.bottomMargin;\n        this.cellSpacing = format.cellSpacing;\n        this.preferredWidth = format.preferredWidth;\n        this.preferredWidthType = format.preferredWidthType;\n    };\n    /**\n     * Clears the format.\n     * @returns void\n     * @private\n     */\n    SelectionTableFormat.prototype.clearFormat = function () {\n        this.table = undefined;\n        this.leftIndent = 0;\n        this.background = undefined;\n        this.leftIndent = 0;\n        this.leftMargin = 0;\n        this.rightMargin = 0;\n        this.topMargin = 0;\n        this.bottomMargin = 0;\n        this.cellSpacing = 0;\n        this.tableAlignment = undefined;\n    };\n    /**\n     * Destroys the managed resources.\n     * @returns void\n     * @private\n     */\n    SelectionTableFormat.prototype.destroy = function () {\n        this.leftIndentIn = undefined;\n        this.backgroundIn = undefined;\n        this.leftIndentIn = undefined;\n        this.leftMarginIn = undefined;\n        this.rightMarginIn = undefined;\n        this.topMarginIn = undefined;\n        this.bottomMarginIn = undefined;\n        this.cellSpacingIn = undefined;\n        this.tableAlignmentIn = undefined;\n        this.tableIn = undefined;\n        this.selection = undefined;\n    };\n    return SelectionTableFormat;\n}());\nexport { SelectionTableFormat };\n/**\n * Selection cell format implementation\n */\nvar SelectionCellFormat = /** @class */ (function () {\n    /**\n     * @private\n     */\n    function SelectionCellFormat(selection) {\n        this.verticalAlignmentIn = undefined;\n        this.leftMarginIn = 0;\n        this.rightMarginIn = 0;\n        this.topMarginIn = 0;\n        this.bottomMarginIn = 0;\n        this.backgroundIn = undefined;\n        this.preferredWidthTypeIn = undefined;\n        this.selection = selection;\n    }\n    Object.defineProperty(SelectionCellFormat.prototype, \"verticalAlignment\", {\n        /**\n         * Gets or sets the vertical alignment of the selected cells.\n         * @default undefined\n         */\n        get: function () {\n            return this.verticalAlignmentIn;\n        },\n        set: function (value) {\n            if (value === this.verticalAlignmentIn) {\n                return;\n            }\n            this.verticalAlignmentIn = value;\n            this.notifyPropertyChanged('verticalAlignment');\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(SelectionCellFormat.prototype, \"leftMargin\", {\n        /**\n         * Gets or Sets the left margin for selected cells.\n         * @default undefined\n         */\n        /* tslint:disable */\n        get: function () {\n            return this.leftMarginIn;\n        },\n        set: function (value) {\n            if (value === this.leftMarginIn) {\n                return;\n            }\n            this.leftMarginIn = value;\n            this.notifyPropertyChanged('leftMargin');\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(SelectionCellFormat.prototype, \"rightMargin\", {\n        /**\n         * Gets or Sets the right margin for selected cells.\n         * @default undefined\n         */\n        get: function () {\n            return this.rightMarginIn;\n        },\n        set: function (value) {\n            if (value === this.rightMarginIn) {\n                return;\n            }\n            this.rightMarginIn = value;\n            this.notifyPropertyChanged('rightMargin');\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(SelectionCellFormat.prototype, \"topMargin\", {\n        /**\n         * Gets or Sets the top margin for selected cells.\n         * @default undefined\n         */\n        get: function () {\n            return this.topMarginIn;\n        },\n        set: function (value) {\n            if (value === this.topMarginIn) {\n                return;\n            }\n            this.topMarginIn = value;\n            this.notifyPropertyChanged('topMargin');\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(SelectionCellFormat.prototype, \"bottomMargin\", {\n        /**\n         * Gets or Sets the bottom margin for selected cells.\n         * @default undefined\n         */\n        get: function () {\n            return this.bottomMarginIn;\n        },\n        set: function (value) {\n            if (value === this.bottomMarginIn) {\n                return;\n            }\n            this.bottomMarginIn = value;\n            this.notifyPropertyChanged('bottomMargin');\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(SelectionCellFormat.prototype, \"background\", {\n        /**\n         * Gets or Sets the background for selected cells.\n         * @default undefined\n         */\n        get: function () {\n            return this.backgroundIn;\n        },\n        /* tslint:enable */\n        set: function (value) {\n            if (value === this.backgroundIn) {\n                return;\n            }\n            this.backgroundIn = value;\n            this.notifyPropertyChanged('background');\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(SelectionCellFormat.prototype, \"preferredWidthType\", {\n        /* tslint:disable */\n        /**\n         * Gets or Sets the preferred width type for selected cells.\n         * @default undefined\n         */\n        get: function () {\n            return this.preferredWidthTypeIn;\n        },\n        set: function (value) {\n            if (value === this.preferredWidthTypeIn) {\n                return;\n            }\n            this.preferredWidthTypeIn = value;\n            this.notifyPropertyChanged('preferredWidthType');\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(SelectionCellFormat.prototype, \"preferredWidth\", {\n        /**\n         * Gets or Sets the preferred width  for selected cells.\n         * @default undefined\n         */\n        get: function () {\n            return this.preferredWidthIn;\n        },\n        set: function (value) {\n            if (value === this.preferredWidthIn) {\n                return;\n            }\n            this.preferredWidthIn = value;\n            this.notifyPropertyChanged('preferredWidth');\n        },\n        enumerable: true,\n        configurable: true\n    });\n    /* tslint:enable */\n    SelectionCellFormat.prototype.notifyPropertyChanged = function (propertyName) {\n        var selection = this.selection;\n        if (!isNullOrUndefined(selection)) {\n            if ((selection.isCleared || !selection.owner.isDocumentLoaded\n                || selection.owner.isReadOnlyMode || selection.owner.isPastingContent) && !selection.isRetrieveFormatting) {\n                return;\n            }\n            if (!isNullOrUndefined(this.selection.start) && !this.selection.isRetrieveFormatting) {\n                var value = this.getPropertyValue(propertyName);\n                if (propertyName === 'background') {\n                    propertyName = 'shading';\n                }\n                if (!isNullOrUndefined(value)) {\n                    this.selection.owner.editorModule.onApplyTableCellFormat(propertyName, value);\n                }\n            }\n        }\n    };\n    SelectionCellFormat.prototype.getPropertyValue = function (propertyName) {\n        switch (propertyName) {\n            case 'verticalAlignment':\n                return this.verticalAlignment;\n            case 'leftMargin':\n                return this.leftMargin;\n            case 'rightMargin':\n                return this.rightMargin;\n            case 'topMargin':\n                return this.topMargin;\n            case 'bottomMargin':\n                return this.bottomMargin;\n            case 'preferredWidth':\n                return this.preferredWidth;\n            case 'preferredWidthType':\n                return this.preferredWidthType;\n            case 'background':\n                var shading = new WShading();\n                shading.backgroundColor = this.background;\n                return shading;\n            default:\n                return undefined;\n        }\n    };\n    /**\n     * Copies the format.\n     * @param  {WCellFormat} format Source Format to copy.\n     * @returns void\n     * @private\n     */\n    SelectionCellFormat.prototype.copyFormat = function (format) {\n        this.leftMargin = format.leftMargin;\n        this.rightMargin = format.rightMargin;\n        this.topMargin = format.topMargin;\n        this.bottomMargin = format.bottomMargin;\n        this.background = format.shading.backgroundColor;\n        this.verticalAlignment = format.verticalAlignment;\n        this.preferredWidth = format.preferredWidth;\n        this.preferredWidthType = format.preferredWidthType;\n    };\n    /**\n     * Clears the format.\n     * @returns void\n     * @private\n     */\n    SelectionCellFormat.prototype.clearCellFormat = function () {\n        this.leftMargin = undefined;\n        this.rightMargin = undefined;\n        this.topMargin = undefined;\n        this.bottomMargin = undefined;\n        this.background = undefined;\n        this.verticalAlignment = undefined;\n    };\n    /**\n     * Combines the format.\n     * @param  {WCellFormat} format\n     * @private\n     */\n    SelectionCellFormat.prototype.combineFormat = function (format) {\n        if (!isNullOrUndefined(this.leftMargin) && this.leftMargin !== format.leftMargin) {\n            this.leftMargin = undefined;\n        }\n        if (!isNullOrUndefined(this.topMargin) && this.topMargin !== format.topMargin) {\n            this.topMargin = undefined;\n        }\n        if (!isNullOrUndefined(this.rightMargin) && this.rightMargin !== format.rightMargin) {\n            this.rightMargin = undefined;\n        }\n        if (!isNullOrUndefined(this.bottomMargin) && this.bottomMargin !== format.bottomMargin) {\n            this.bottomMargin = undefined;\n        }\n        if (!isNullOrUndefined(this.background) && this.background !== format.shading.backgroundColor) {\n            this.background = undefined;\n        }\n        if (!isNullOrUndefined(this.verticalAlignment) && this.verticalAlignment !== format.verticalAlignment) {\n            this.verticalAlignment = undefined;\n        }\n        if (!isNullOrUndefined(this.preferredWidth) && this.preferredWidth !== format.preferredWidth) {\n            this.preferredWidth = undefined;\n        }\n        if (!isNullOrUndefined(this.preferredWidthType) && this.preferredWidthType !== format.preferredWidthType) {\n            this.preferredWidthType = undefined;\n        }\n    };\n    /**\n     * Clears the format.\n     * @returns void\n     * @private\n     */\n    SelectionCellFormat.prototype.clearFormat = function () {\n        this.background = undefined;\n        this.bottomMargin = 0;\n        this.leftMargin = 0;\n        this.rightMargin = 0;\n        this.topMargin = 0;\n        this.verticalAlignment = undefined;\n    };\n    /**\n     * Destroys the manages resources.\n     * @returns void\n     * @private\n     */\n    SelectionCellFormat.prototype.destroy = function () {\n        this.backgroundIn = undefined;\n        this.verticalAlignmentIn = undefined;\n        this.bottomMarginIn = undefined;\n        this.leftMarginIn = undefined;\n        this.rightMarginIn = undefined;\n        this.topMarginIn = undefined;\n        this.selection = undefined;\n    };\n    return SelectionCellFormat;\n}());\nexport { SelectionCellFormat };\n/**\n * Selection row format implementation\n */\nvar SelectionRowFormat = /** @class */ (function () {\n    /**\n     * @private\n     */\n    function SelectionRowFormat(selection) {\n        this.heightIn = undefined;\n        this.heightTypeIn = undefined;\n        this.isHeaderIn = undefined;\n        this.allowRowBreakAcrossPagesIn = undefined;\n        this.selection = selection;\n    }\n    Object.defineProperty(SelectionRowFormat.prototype, \"height\", {\n        /**\n         * Gets or Sets the height for selected rows.\n         * @default undefined\n         */\n        get: function () {\n            return this.heightIn;\n        },\n        set: function (value) {\n            if (value === this.heightIn) {\n                return;\n            }\n            this.heightIn = value;\n            this.notifyPropertyChanged('height');\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(SelectionRowFormat.prototype, \"heightType\", {\n        /**\n         * Gets or Sets the height type for selected rows.\n         * @default undefined\n         */\n        get: function () {\n            return this.heightTypeIn;\n        },\n        set: function (value) {\n            if (value === this.heightTypeIn) {\n                return;\n            }\n            this.heightTypeIn = value;\n            this.notifyPropertyChanged('heightType');\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(SelectionRowFormat.prototype, \"isHeader\", {\n        /**\n         * Gets or Sets a value indicating whether the selected rows are header rows or not.\n         * @default undefined\n         */\n        get: function () {\n            return this.isHeaderIn;\n        },\n        set: function (value) {\n            if (value === this.isHeaderIn) {\n                return;\n            }\n            this.isHeaderIn = value;\n            this.notifyPropertyChanged('isHeader');\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(SelectionRowFormat.prototype, \"allowBreakAcrossPages\", {\n        /**\n         * Gets or Sets a value indicating whether to allow break across pages for selected rows.\n         * @default undefined\n         */\n        get: function () {\n            return this.allowRowBreakAcrossPagesIn;\n        },\n        set: function (value) {\n            if (value === this.allowRowBreakAcrossPagesIn) {\n                return;\n            }\n            this.allowRowBreakAcrossPagesIn = value;\n            this.notifyPropertyChanged('allowBreakAcrossPages');\n        },\n        enumerable: true,\n        configurable: true\n    });\n    SelectionRowFormat.prototype.notifyPropertyChanged = function (propertyName) {\n        var selection = this.selection;\n        if (!isNullOrUndefined(selection) && (selection.isCleared || selection.owner.isReadOnlyMode\n            || !selection.owner.isDocumentLoaded || selection.owner.isPastingContent) && !selection.isRetrieveFormatting) {\n            return;\n        }\n        if (!isNullOrUndefined(selection) && !isNullOrUndefined(selection.start) && !selection.isRetrieveFormatting) {\n            var value = this.getPropertyValue(propertyName);\n            if (!isNullOrUndefined(value)) {\n                selection.owner.editorModule.onApplyTableRowFormat(propertyName, value);\n            }\n        }\n    };\n    SelectionRowFormat.prototype.getPropertyValue = function (propertyName) {\n        switch (propertyName) {\n            case 'height':\n                return this.height;\n            case 'heightType':\n                return this.heightType;\n            case 'isHeader':\n                return this.isHeader;\n            case 'allowBreakAcrossPages':\n                return this.allowBreakAcrossPages;\n            default:\n                return undefined;\n        }\n    };\n    /**\n     * Copies the format.\n     * @param  {WRowFormat} format\n     * @returns void\n     * @private\n     */\n    SelectionRowFormat.prototype.copyFormat = function (format) {\n        this.height = format.height;\n        this.heightType = format.heightType;\n        this.allowBreakAcrossPages = format.allowBreakAcrossPages;\n        this.isHeader = format.isHeader;\n    };\n    /**\n     * Combines the format.\n     * @param  {WRowFormat} format\n     * @private\n     */\n    SelectionRowFormat.prototype.combineFormat = function (format) {\n        if (!isNullOrUndefined(this.height) && this.height !== format.height) {\n            this.height = undefined;\n        }\n        if (!isNullOrUndefined(this.heightType) && this.heightType !== format.heightType) {\n            this.heightType = undefined;\n        }\n        if (!isNullOrUndefined(this.allowBreakAcrossPages) && this.allowBreakAcrossPages !== format.allowBreakAcrossPages) {\n            this.allowBreakAcrossPages = undefined;\n        }\n        if (!isNullOrUndefined(this.isHeader) && this.isHeader !== format.isHeader) {\n            this.isHeader = undefined;\n        }\n    };\n    /**\n     * Clears the row format.\n     * @returns void\n     * @private\n     */\n    SelectionRowFormat.prototype.clearRowFormat = function () {\n        this.height = undefined;\n        this.heightType = undefined;\n        this.allowBreakAcrossPages = undefined;\n        this.isHeader = undefined;\n    };\n    /**\n     * Clears the format.\n     * @returns void\n     * @private\n     */\n    SelectionRowFormat.prototype.clearFormat = function () {\n        this.height = 0;\n        this.heightType = undefined;\n        this.allowBreakAcrossPages = undefined;\n        this.isHeader = undefined;\n    };\n    /**\n     * Destroys the managed resources.\n     * @returns void\n     * @private\n     */\n    SelectionRowFormat.prototype.destroy = function () {\n        this.heightIn = undefined;\n        this.heightTypeIn = undefined;\n        this.allowRowBreakAcrossPagesIn = undefined;\n        this.isHeaderIn = undefined;\n        this.selection = undefined;\n    };\n    return SelectionRowFormat;\n}());\nexport { SelectionRowFormat };\n/**\n * Selection image format implementation\n */\nvar SelectionImageFormat = /** @class */ (function () {\n    /**\n     * @private\n     */\n    function SelectionImageFormat(selection) {\n        this.selection = selection;\n    }\n    Object.defineProperty(SelectionImageFormat.prototype, \"width\", {\n        /**\n         * Gets the width of the image.\n         */\n        get: function () {\n            if (this.image) {\n                return this.image.width;\n            }\n            return 0;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(SelectionImageFormat.prototype, \"height\", {\n        /**\n         * Gets the height of the image.\n         */\n        get: function () {\n            if (this.image) {\n                return this.image.height;\n            }\n            return 0;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    /**\n     * Resizes the image based on given size.\n     * @param width\n     * @param height\n     */\n    SelectionImageFormat.prototype.resize = function (width, height) {\n        this.updateImageFormat(width, height);\n    };\n    /**\n     * Update image width and height\n     * @private\n     */\n    SelectionImageFormat.prototype.updateImageFormat = function (width, height) {\n        if (this.image) {\n            if (this.selection.owner.editorModule) {\n                this.selection.owner.editorModule.onImageFormat(this.image, width, height);\n            }\n        }\n    };\n    /**\n     * @private\n     */\n    SelectionImageFormat.prototype.copyImageFormat = function (image) {\n        this.image = image;\n    };\n    /**\n     * @private\n     */\n    SelectionImageFormat.prototype.clearImageFormat = function () {\n        this.image = undefined;\n    };\n    return SelectionImageFormat;\n}());\nexport { SelectionImageFormat };\n/* tslint:enable */ \n","import { isNullOrUndefined } from '@syncfusion/ej2-base';\nimport { HelperMethods } from '../editor/editor-helper';\n/**\n * @private\n */\nvar HtmlExport = /** @class */ (function () {\n    function HtmlExport() {\n        /* tslint:disable:no-any */\n        this.document = undefined;\n        /* tslint:disable:no-any */\n        /**\n         * @private\n         */\n        this.fieldCheck = 0;\n        /* tslint:enable:no-any */\n    }\n    /* tslint:disable:no-any */\n    /**\n     * @private\n     */\n    HtmlExport.prototype.writeHtml = function (document) {\n        this.document = document;\n        var html = '';\n        for (var i = 0; i < document.sections.length; i++) {\n            html = this.serializeSection(document.sections[i]);\n        }\n        return html;\n    };\n    /**\n     * @private\n     */\n    HtmlExport.prototype.serializeSection = function (section) {\n        var string = '';\n        for (var i = 0; i < section.blocks.length; i++) {\n            var block = section.blocks[i];\n            if (block.hasOwnProperty('inlines')) {\n                string += this.serializeParagraph(block);\n            }\n            else {\n                string += this.serializeTable(block);\n            }\n        }\n        return string;\n    };\n    // Serialize Paragraph \n    /**\n     * @private\n     */\n    HtmlExport.prototype.serializeParagraph = function (paragraph) {\n        var blockStyle = '';\n        var startString = undefined;\n        var isList = false;\n        var tagAttributes = [];\n        tagAttributes.push('style=\"' + this.serializeParagraphStyle(paragraph, '', isList) + '\"');\n        blockStyle += this.createAttributesTag('p', tagAttributes);\n        if (paragraph.inlines.length === 0) {\n            //Handled to preserve non breaking space for empty paragraphs similar to MS Word behavior.\n            blockStyle += '&nbsp;';\n        }\n        else {\n            blockStyle = this.serializeInlines(paragraph, blockStyle);\n        }\n        blockStyle += this.endTag('p');\n        return blockStyle;\n    };\n    //SerializeInlines\n    /**\n     * @private\n     */\n    HtmlExport.prototype.serializeInlines = function (paragraph, blockStyle) {\n        var inline = undefined;\n        var i = 0;\n        while (paragraph.inlines.length > i) {\n            inline = paragraph.inlines[i];\n            if (inline.hasOwnProperty('imageString')) {\n                blockStyle += this.serializeImageContainer(inline);\n            }\n            else if (inline.hasOwnProperty('fieldType')) {\n                if (inline.fieldType === 0) {\n                    this.fieldCheck = 1;\n                    var tagAttributes = [];\n                    tagAttributes.push('style=\"' + this.serializeInlineStyle(inline.characterFormat, '') + '\"');\n                    blockStyle += this.createAttributesTag('a', tagAttributes);\n                }\n                else if (inline.fieldType === 2) {\n                    this.fieldCheck = 2;\n                }\n                else {\n                    blockStyle += this.endTag('a');\n                    this.fieldCheck = 0;\n                }\n            }\n            else {\n                var text = isNullOrUndefined(inline.text) ? '' : inline.text;\n                if (this.fieldCheck === 0) {\n                    blockStyle += this.serializeSpan(text, inline.characterFormat);\n                }\n                if (this.fieldCheck === 1) {\n                    var hyperLink = text.replace('\\\"', '');\n                    blockStyle += ' href= \\\"' + hyperLink.replace('HYPERLINK', '').trim();\n                    blockStyle += '\\\"';\n                    blockStyle += '>';\n                }\n                if (this.fieldCheck === 2) {\n                    blockStyle += text;\n                }\n            }\n            i++;\n        }\n        return blockStyle;\n    };\n    // Serialize Span\n    /**\n     * @private\n     */\n    HtmlExport.prototype.serializeSpan = function (spanText, characterFormat) {\n        var spanClass = '';\n        if (spanText.indexOf('\\v') !== -1) {\n            spanClass += '<br>';\n            return spanClass.toString();\n        }\n        var tagAttributes = [];\n        this.serializeInlineStyle(characterFormat, '');\n        tagAttributes.push('style=\"' + this.serializeInlineStyle(characterFormat, '') + '\"');\n        spanClass += this.createAttributesTag('span', tagAttributes);\n        var ignoreFirstSpace = false;\n        // Todo: Need to handle it.\n        // If the text starts with white-space, need to check whether it is a continuous space.\n        // if (characterFormat.ownerBase instanceof WInline) {\n        //     let inline: WInline = (characterFormat.ownerBase as WInline);\n        //     tslint:disable:max-line-length            \n        //     if (inline instanceof WSpan && !isNullOrUndefined(inline.text) && inline.text !== '' && (inline as WSpan).text[0] === ' ') {\n        //         Check previous inline until, it has valid rendered text.\n        //         do {\n        //             inline = WInline.getPreviousTextInline((inline as WSpan));\n        //         } while (inline instanceof WSpan && !isNullOrUndefined(inline.text));\n        //     } else {\n        //         inline = undefined;\n        //     }\n        //     If current white-space is a continuation of consecutive spaces, this will be set true.\n        //     ignoreFirstSpace = inline instanceof WSpan && !isNullOrUndefined(inline.text)\n        //         && (inline as WSpan).text[(inline as WSpan).text.length - 1] === ' ';\n        // }\n        var text = this.decodeHtmlNames(spanText.toString());\n        spanClass += text;\n        spanClass += this.endTag('span');\n        return spanClass.toString();\n    };\n    //Serialize Image\n    /**\n     * @private\n     */\n    HtmlExport.prototype.serializeImageContainer = function (image) {\n        var imageStyle = '';\n        var tagAttributes = [];\n        this.serializeInlineStyle(image.characterFormat, '');\n        var imageSource = '';\n        if (!isNullOrUndefined(image.imageString)) {\n            imageSource = image.imageString;\n        }\n        var width = HelperMethods.convertPointToPixel(image.width);\n        var height = HelperMethods.convertPointToPixel(image.height);\n        tagAttributes.push('width=\"', width.toString() + '\"');\n        tagAttributes.push('height=\"', height.toString() + '\"');\n        tagAttributes.push('src=\"', imageSource + '\"');\n        imageStyle += this.createAttributesTag('img', tagAttributes);\n        imageStyle += (this.endTag('img'));\n        return imageStyle.toString();\n    };\n    // Serialize Table Cell\n    /**\n     * @private\n     */\n    HtmlExport.prototype.serializeCell = function (cell) {\n        var blockStyle = '';\n        var tagAttributes = [];\n        var cellHtml = '';\n        tagAttributes = [];\n        if (!isNullOrUndefined(cell.cellFormat)) {\n            //if (cell.cellFormat.shading.backgroundColor !== Color.FromArgb(0, 0, 0, 0)) {\n            tagAttributes.push('bgcolor=\"' + cell.cellFormat.shading.backgroundColor + '\"');\n            // }\n            if (cell.cellFormat.columnSpan > 1) {\n                tagAttributes.push('colspan=\"' + cell.cellFormat.columnSpan.toString() + '\"');\n            }\n            if (cell.cellFormat.rowSpan > 1) {\n                tagAttributes.push('rowspan=\"' + cell.cellFormat.rowSpan.toString() + '\"');\n            }\n            if (cell.cellFormat.cellWidth !== 0) {\n                tagAttributes.push('width=\"' + cell.cellFormat.cellWidth.toString() + '\"');\n            }\n            if (cell.cellFormat.verticalAlignment !== 'Top') {\n                tagAttributes.push('valign=\"' + cell.cellFormat.verticalAlignment.toString().toLowerCase() + '\"');\n            }\n            if (!isNullOrUndefined(cell.cellFormat.leftMargin) && cell.cellFormat.leftMargin !== 0) {\n                cellHtml += ('padding-left:' + cell.cellFormat.leftMargin.toString() + 'pt;');\n            }\n            if (!isNullOrUndefined(cell.cellFormat.rightMargin) && cell.cellFormat.rightMargin !== 0) {\n                cellHtml += ('padding-right:' + cell.cellFormat.rightMargin.toString() + 'pt;');\n            }\n            if (!isNullOrUndefined(cell.cellFormat.topMargin) && cell.cellFormat.topMargin !== 0) {\n                cellHtml += ('padding-top:' + cell.cellFormat.topMargin.toString() + 'pt;');\n            }\n            if (!isNullOrUndefined(cell.cellFormat.bottomMargin) && cell.cellFormat.bottomMargin !== 0) {\n                cellHtml += ('padding-bottom:' + cell.cellFormat.bottomMargin.toString() + 'pt;');\n            }\n            if (!isNullOrUndefined(cell.cellFormat.borders)) {\n                cellHtml += this.serializeCellBordersStyle(cell.cellFormat.borders);\n            }\n        }\n        if (cellHtml.length !== 0) {\n            tagAttributes.push('style=\"' + cellHtml + '\"');\n        }\n        blockStyle += (this.createAttributesTag('td', tagAttributes));\n        for (var k = 0; k < cell.blocks.length; k++) {\n            var block = cell.blocks[k];\n            if (block.hasOwnProperty('rows')) {\n                blockStyle += this.serializeTable(block);\n            }\n            else {\n                blockStyle += this.serializeParagraph(block);\n            }\n        }\n        blockStyle += (this.endTag('td'));\n        return blockStyle;\n    };\n    // Serialize Table\n    /**\n     * @private\n     */\n    HtmlExport.prototype.serializeTable = function (table) {\n        var html = '';\n        html += this.createTableStartTag(table);\n        for (var j = 0; j < table.rows.length; j++) {\n            html += this.serializeRow(table.rows[j]);\n        }\n        html += this.createTableEndTag();\n        return html;\n    };\n    // Serialize Row\n    /**\n     * @private\n     */\n    HtmlExport.prototype.serializeRow = function (row) {\n        var html = '';\n        html += this.createRowStartTag(row);\n        for (var k = 0; k < row.cells.length; k++) {\n            html += this.serializeCell(row.cells[k]);\n        }\n        return html;\n    };\n    // Serialize Styles\n    /**\n     * @private\n     */\n    HtmlExport.prototype.serializeParagraphStyle = function (paragraph, className, isList) {\n        var paragraphClass = '';\n        paragraphClass += this.serializeCharacterFormat(paragraph.characterFormat);\n        paragraphClass += this.serializeParagraphFormat(paragraph.paragraphFormat, isList);\n        return paragraphClass;\n    };\n    /**\n     * @private\n     */\n    HtmlExport.prototype.serializeInlineStyle = function (characterFormat, className) {\n        return this.serializeCharacterFormat(characterFormat);\n    };\n    /**\n     * @private\n     */\n    HtmlExport.prototype.serializeTableBorderStyle = function (borders) {\n        var borderStyle = '';\n        borderStyle += ('border-left-style:' + this.convertBorderLineStyle(borders.left.lineStyle));\n        borderStyle += ';';\n        borderStyle += ('border-left-width:' + borders.left.lineWidth.toString() + 'pt');\n        borderStyle += ';';\n        borderStyle += ('border-left-color:' + borders.left.color);\n        borderStyle += ';';\n        borderStyle += ('border-right-style:' + this.convertBorderLineStyle(borders.right.lineStyle));\n        borderStyle += ';';\n        borderStyle += ('border-right-width:' + borders.right.lineWidth.toString() + 'pt');\n        borderStyle += ';';\n        borderStyle += ('border-right-color:' + borders.right.color);\n        borderStyle += ';';\n        borderStyle += ('border-top-style:' + this.convertBorderLineStyle(borders.top.lineStyle));\n        borderStyle += ';';\n        borderStyle += ('border-top-width:' + borders.top.lineWidth.toString() + 'pt');\n        borderStyle += ';';\n        borderStyle += ('border-top-color:' + borders.top.color);\n        borderStyle += ';';\n        borderStyle += ('border-Bottom-style:' + this.convertBorderLineStyle(borders.bottom.lineStyle));\n        borderStyle += ';';\n        borderStyle += ('border-Bottom-width:' + borders.bottom.lineWidth.toString() + 'pt');\n        borderStyle += ';';\n        borderStyle += ('border-Bottom-color:' + borders.bottom.color);\n        borderStyle += ';';\n        return borderStyle;\n    };\n    /**\n     * @private\n     */\n    HtmlExport.prototype.serializeCellBordersStyle = function (borders) {\n        var borderStyle = '';\n        borderStyle = 'border:solid 1px;';\n        // Todo: handle\n        // let border: WBorder = undefined;\n        // //LeftBorder\n        // border = WCell.getCellLeftBorder(WCell.getCellOf(borders));\n        // if (!isNullOrUndefined(border) && border.lineStyle !== 'None') {\n        //     borderStyle += this.serializeBorderStyle(border, 'left');\n        // } else if (!isNullOrUndefined(border) && border.hasNoneStyle) {\n        //     borderStyle += ('border-left-style:none;');\n        // }\n        // //RightBorder\n        // border = WCell.getCellRightBorder(WCell.getCellOf(borders));\n        // if (!isNullOrUndefined(border) && border.lineStyle !== 'None') {\n        //     borderStyle += this.serializeBorderStyle(border, 'right');\n        // } else if (!isNullOrUndefined(border) && border.hasNoneStyle) {\n        //     borderStyle += ('border-right-style:none');\n        // }\n        // //TopBorder\n        // border = WCell.getCellTopBorder(WCell.getCellOf(borders));\n        // if (!isNullOrUndefined(border) && border.lineStyle !== 'None') {\n        //     borderStyle += this.serializeBorderStyle(border, 'top');\n        // } else if (!isNullOrUndefined(border) && border.hasNoneStyle) {\n        //     borderStyle += ('border-top-style:none');\n        // }\n        // //BottomBorder\n        // border = WCell.getCellBottomBorder(WCell.getCellOf(borders));\n        // if (!isNullOrUndefined(border) && border.lineStyle !== 'None') {\n        //     borderStyle += this.serializeBorderStyle(border, 'bottom');\n        // } else if (!isNullOrUndefined(border) && border.hasNoneStyle) {\n        //     borderStyle += ('border-bottom-style:none');\n        // }\n        return borderStyle;\n    };\n    /**\n     * @private\n     */\n    HtmlExport.prototype.serializeBorderStyle = function (border, borderPosition) {\n        var borderStyle = '';\n        borderStyle += ('border-' + borderPosition + '-style:' + this.convertBorderLineStyle(border.lineStyle));\n        borderStyle += ';';\n        if (border.lineWidth > 0) {\n            borderStyle += ('border-' + borderPosition + '-width:' + border.lineWidth.toString() + 'pt;');\n        }\n        //if (border.color !== Color.FromArgb(0, 0, 0, 0))\n        borderStyle += ('border-' + borderPosition + '-color:' + border.color + ';');\n        return borderStyle;\n    };\n    /**\n     * @private\n     */\n    HtmlExport.prototype.convertBorderLineStyle = function (lineStyle) {\n        switch (lineStyle) {\n            case 'None':\n                return 'none';\n            case 'Single':\n                return 'solid';\n            case 'Dot':\n                return 'dotted';\n            case 'DashSmallGap':\n            case 'DashLargeGap':\n            case 'DashDot':\n            case 'DashDotDot':\n                return 'dashed';\n            case 'Double':\n            case 'Triple':\n            case 'ThinThickSmallGap':\n            case 'ThickThinSmallGap':\n            case 'ThinThickThinSmallGap':\n            case 'ThinThickMediumGap':\n            case 'ThickThinMediumGap':\n            case 'ThinThickThinMediumGap':\n            case 'ThinThickLargeGap':\n            case 'ThickThinLargeGap':\n            case 'ThinThickThinLargeGap':\n                return 'double';\n            case 'SingleWavy':\n                return 'solid';\n            case 'DoubleWavy':\n                return 'double';\n            case 'DashDotStroked':\n                return 'solid';\n            case 'Emboss3D':\n                return 'ridge';\n            case 'Engrave3D':\n                return 'groove';\n            case 'Outset':\n                return 'outset';\n            case 'Inset':\n                return 'inset';\n            default:\n                return 'solid';\n        }\n    };\n    // Serialize Format\n    /**\n     * @private\n     */\n    HtmlExport.prototype.serializeCharacterFormat = function (characterFormat) {\n        if (!isNullOrUndefined(characterFormat.inlineFormat)) {\n            return this.serializeCharacterFormat(characterFormat.inlineFormat);\n        }\n        var propertyValue;\n        var charStyle = '';\n        if (characterFormat.bold) {\n            charStyle += 'font-weight';\n            charStyle += ':';\n            charStyle += 'bold';\n            charStyle += ';';\n        }\n        charStyle += 'font-style';\n        charStyle += ':';\n        if (characterFormat.italic) {\n            charStyle += 'italic';\n        }\n        else {\n            charStyle += 'normal';\n        }\n        charStyle += ';';\n        // Double strike through will become Single strike through while saving HTML using MS Word.\n        if (characterFormat.strikethrough === 'SingleStrike' || characterFormat.strikethrough === 'DoubleStrike') {\n            charStyle += 'text-decoration';\n            charStyle += ':';\n            charStyle += 'line-through';\n            charStyle += ';';\n        }\n        //Text Baseline Alignment\n        // tslint:disable-next-line:max-line-length\n        if (characterFormat.baselineAlignment === 'Superscript' || characterFormat.baselineAlignment === 'Subscript') {\n            charStyle += 'vertical-align';\n            charStyle += ':';\n            charStyle += characterFormat.baselineAlignment === 'Superscript' ? 'super' : 'sub';\n            charStyle += ';';\n        }\n        //Text Foreground and Background Color \n        if (!isNullOrUndefined(characterFormat.highlightColor)) {\n            charStyle += 'background-color';\n            charStyle += ':';\n            charStyle += characterFormat.highlightColor.toString();\n            charStyle += ';';\n        }\n        //Font Color\n        propertyValue = characterFormat.fontColor;\n        if (!isNullOrUndefined(propertyValue)) {\n            charStyle += 'color';\n            charStyle += ':';\n            charStyle += propertyValue;\n            charStyle += ';';\n        }\n        if (!isNullOrUndefined(characterFormat.underline) && characterFormat.underline !== 'None') {\n            charStyle += 'text-decoration';\n            charStyle += ':';\n            charStyle += 'underline';\n            charStyle += ';';\n        }\n        propertyValue = characterFormat.fontSize;\n        if (!isNullOrUndefined(propertyValue)) {\n            charStyle += 'font-size';\n            charStyle += ':';\n            charStyle += propertyValue.toString();\n            charStyle += 'pt';\n            charStyle += ';';\n        }\n        propertyValue = characterFormat.fontFamily;\n        if (!isNullOrUndefined(propertyValue)) {\n            charStyle += 'font-family';\n            charStyle += ':';\n            charStyle += propertyValue.toString();\n            charStyle += ';';\n        }\n        return charStyle.toString();\n    };\n    /**\n     * @private\n     */\n    HtmlExport.prototype.serializeParagraphFormat = function (paragraphFormat, isList) {\n        if (!isNullOrUndefined(paragraphFormat.inlineFormat)) {\n            return this.serializeParagraphFormat(paragraphFormat.inlineFormat, isList);\n        }\n        var propertyValue;\n        var paraStyle = '';\n        propertyValue = paragraphFormat.textAlignment;\n        if (!isNullOrUndefined(propertyValue)) {\n            paraStyle += 'text-align:' + propertyValue.toLowerCase() + ';';\n        }\n        propertyValue = paragraphFormat.beforeSpacing;\n        if (!isNullOrUndefined(propertyValue)) {\n            paraStyle += 'margin-top:' + propertyValue.toString() + 'pt; ';\n        }\n        propertyValue = paragraphFormat.rightIndent;\n        if (!isNullOrUndefined(propertyValue)) {\n            paraStyle += 'margin-right:' + propertyValue.toString() + 'pt; ';\n        }\n        propertyValue = paragraphFormat.afterSpacing;\n        if (!isNullOrUndefined(propertyValue)) {\n            paraStyle += 'margin-bottom:' + propertyValue.toString() + 'pt; ';\n        }\n        propertyValue = paragraphFormat.leftIndent;\n        if (isList) {\n            if (isNullOrUndefined(propertyValue)) {\n                propertyValue = -48;\n            }\n            else {\n                propertyValue -= 48;\n            }\n        }\n        if (!isNullOrUndefined(propertyValue)) {\n            paraStyle += 'margin-left:' + propertyValue.toString() + 'pt; ';\n        }\n        propertyValue = paragraphFormat.firstLineIndent;\n        if (isList) {\n            if (isNullOrUndefined(propertyValue)) {\n                propertyValue = 24;\n            }\n            else {\n                propertyValue += 24;\n            }\n        }\n        if (!isNullOrUndefined(propertyValue) && propertyValue !== 0) {\n            paraStyle += 'text-indent:' + propertyValue.toString() + 'pt;';\n        }\n        propertyValue = paragraphFormat.lineSpacing;\n        if (!isNullOrUndefined(propertyValue)) {\n            if (paragraphFormat.lineSpacingType === 'Multiple') {\n                propertyValue = (propertyValue * 100).toString() + '%;';\n            }\n            else {\n                propertyValue = propertyValue.toString() + 'pt;';\n            }\n            paraStyle += 'line-height:' + propertyValue;\n        }\n        return paraStyle.toString();\n    };\n    /**\n     * @private\n     */\n    HtmlExport.prototype.createAttributesTag = function (tagValue, localProperties) {\n        var sb = '';\n        sb += '<';\n        sb += tagValue;\n        for (var i = 0; i < localProperties.length; i++) {\n            sb += ' ';\n            sb += localProperties[i];\n        }\n        if (tagValue !== 'a') {\n            sb += '>';\n        }\n        return sb;\n    };\n    /**\n     * @private\n     */\n    HtmlExport.prototype.createTag = function (tagValue) {\n        var s = '';\n        s += '<';\n        s += tagValue;\n        s += '>';\n        return s;\n    };\n    /**\n     * @private\n     */\n    HtmlExport.prototype.endTag = function (tagValue) {\n        var sb = '';\n        sb += '<';\n        sb += '/';\n        sb += tagValue;\n        sb += '>';\n        return sb;\n    };\n    /**\n     * @private\n     */\n    HtmlExport.prototype.createTableStartTag = function (table) {\n        var blockStyle = '';\n        var tableStyle = '';\n        var tagAttributes = [];\n        tagAttributes.push('border=\"' + '1\"');\n        if (!isNullOrUndefined(table.tableFormat)) {\n            //if (table.tableFormat.shading.backgroundColor !== Color.FromArgb(0, 0, 0, 0)) {\n            tagAttributes.push('bgcolor=\"' + table.tableFormat.shading.backgroundColor + '\"');\n            //}\n            if (table.tableFormat.leftIndent !== 0) {\n                tagAttributes.push('left-indent=\"' + table.tableFormat.leftIndent.toString() + 'pt;');\n            }\n            if (table.tableFormat.cellSpacing > 0) {\n                tagAttributes.push('cellspacing=\"' + (((table.tableFormat.cellSpacing * 72) / 96) * 2).toString() + '\"');\n            }\n            else {\n                tableStyle += ('border-collapse:collapse;');\n            }\n            tagAttributes.push('cellpadding=\"' + '0\"');\n            if (!isNullOrUndefined(table.tableFormat.borders)) {\n                tableStyle += this.serializeTableBorderStyle(table.tableFormat.borders);\n            }\n        }\n        if (tableStyle.length !== 0) {\n            tagAttributes.push('style=\"', tableStyle.toString() + '\"');\n        }\n        return blockStyle += (this.createAttributesTag('table', tagAttributes));\n    };\n    /**\n     * @private\n     */\n    HtmlExport.prototype.createTableEndTag = function () {\n        var blockStyle = '';\n        blockStyle += (this.endTag('table'));\n        return blockStyle;\n    };\n    /**\n     * @private\n     */\n    HtmlExport.prototype.createRowStartTag = function (row) {\n        var blockStyle = '';\n        var tagAttributes = [];\n        if (row.rowFormat.isHeader) {\n            blockStyle += (this.createTag('thead'));\n        }\n        if (row.rowFormat.height > 0) {\n            tagAttributes.push('height=\"' + row.rowFormat.height + '\"');\n        }\n        return blockStyle + this.createAttributesTag('tr', tagAttributes);\n    };\n    /**\n     * @private\n     */\n    HtmlExport.prototype.createRowEndTag = function (row) {\n        var blockStyle = '';\n        blockStyle += (this.endTag('tr'));\n        if (row.rowFormat.isHeader) {\n            blockStyle += (this.endTag('thead'));\n        }\n        return blockStyle;\n    };\n    /**\n     * @private\n     */\n    HtmlExport.prototype.decodeHtmlNames = function (text) {\n        if (text === '\\t') {\n            return '&emsp;';\n        }\n        var splittedText = text.split(' ');\n        var htmlText = '';\n        if (splittedText.length > 0) {\n            htmlText = splittedText[0];\n            for (var i = 0; i < splittedText.length - 1; i++) {\n                htmlText += '&nbsp;' + splittedText[i + 1];\n            }\n        }\n        return htmlText;\n    };\n    return HtmlExport;\n}());\nexport { HtmlExport };\n","import { Widget, TableRowWidget, TableWidget, LineWidget, ElementBox, TextElementBox, ListTextElementBox, ImageElementBox, ParagraphWidget, TableCellWidget, FieldElementBox, BlockContainer, BookmarkElementBox } from '../index';\nimport { HelperMethods } from '../index';\nimport { Point } from '../index';\nimport { isNullOrUndefined } from '@syncfusion/ej2-base';\n/**\n * @private\n */\nvar TextPosition = /** @class */ (function () {\n    function TextPosition(owner) {\n        /**\n         * @private\n         */\n        this.location = new Point(0, 0);\n        /**\n         * @private\n         */\n        this.isUpdateLocation = true;\n        this.owner = owner;\n        this.viewer = this.owner.viewer;\n    }\n    Object.defineProperty(TextPosition.prototype, \"paragraph\", {\n        /**\n         * @private\n         */\n        get: function () {\n            return this.currentWidget.paragraph;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(TextPosition.prototype, \"isAtParagraphStart\", {\n        /**\n         * @private\n         */\n        get: function () {\n            return this.offset === this.owner.selection.getStartOffset(this.paragraph);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(TextPosition.prototype, \"isAtParagraphEnd\", {\n        /**\n         * @private\n         */\n        get: function () {\n            return this.owner.selection.isParagraphLastLine(this.currentWidget)\n                && this.offset === this.owner.selection.getLineLength(this.currentWidget);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(TextPosition.prototype, \"selection\", {\n        /**\n         * @private\n         */\n        get: function () {\n            return this.owner.selection;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(TextPosition.prototype, \"hierarchicalPosition\", {\n        /**\n         * Gets the hierarchical position of logical text position in the document\n         * @returns {string}\n         */\n        get: function () {\n            return this.getHierarchicalIndexInternal();\n        },\n        enumerable: true,\n        configurable: true\n    });\n    /**\n     * Return clone of current text position\n     * @private\n     */\n    TextPosition.prototype.clone = function () {\n        var textPosition = new TextPosition(this.owner);\n        textPosition.currentWidget = this.currentWidget;\n        textPosition.offset = this.offset;\n        textPosition.location = this.location;\n        return textPosition;\n    };\n    /**\n     * Set text position for paragraph and inline\n     * @private\n     */\n    TextPosition.prototype.setPositionForSelection = function (line, element, index, physicalLocation) {\n        //Set the start end position\n        var isParagraphEnd = false;\n        if (isNullOrUndefined(element)) {\n            this.currentWidget = line;\n        }\n        else {\n            this.currentWidget = element.line;\n            if (element.nextNode instanceof FieldElementBox && index > element.length) {\n                isParagraphEnd = this.selection.isLastRenderedInline(element, element.length);\n            }\n        }\n        this.location = physicalLocation;\n        if (isParagraphEnd) {\n            this.offset = this.selection.getParagraphLength(this.currentWidget.paragraph) + 1;\n        }\n        else {\n            this.offset = this.currentWidget.getOffset(element, index);\n        }\n    };\n    /**\n     * Set text position\n     * @private\n     */\n    TextPosition.prototype.setPositionFromLine = function (line, offset, location) {\n        this.currentWidget = line;\n        this.offset = offset;\n        if (location instanceof Point) {\n            this.location.copy(location);\n        }\n    };\n    /**\n     * Set text position\n     * @private\n     */\n    TextPosition.prototype.setPosition = function (line, positionAtStart) {\n        this.currentWidget = line;\n        this.offset = positionAtStart ? this.selection.getStartOffset(line.paragraph)\n            : this.selection.getParagraphLength(line.paragraph) + 1;\n        this.updatePhysicalPosition(true);\n    };\n    /**\n     * Set position for text position\n     * @private\n     */\n    TextPosition.prototype.setPositionInternal = function (textPosition) {\n        this.currentWidget = textPosition.currentWidget;\n        this.offset = textPosition.offset;\n        this.location = textPosition.location;\n    };\n    /**\n     * Set position for current index\n     * @private\n     */\n    TextPosition.prototype.setPositionForCurrentIndex = function (hierarchicalIndex) {\n        var index = { index: hierarchicalIndex };\n        var paragraph = this.getParagraphWidget(index); //ref hierarchicalIndex\n        this.offset = parseFloat(index.index);\n        this.setPositionParagraph(paragraph, this.offset);\n    };\n    /**\n     * Get Page\n     */\n    TextPosition.prototype.getPage = function (position) {\n        var page;\n        var index = position.index.indexOf(';');\n        var newValue = '0';\n        if (index >= 0) {\n            newValue = position.index.substring(0, index);\n            position.index = position.index.substring(index).replace(';', '');\n        }\n        index = parseInt(newValue, 10);\n        page = this.viewer.pages[index];\n        return page;\n    };\n    /**\n     * @private\n     */\n    TextPosition.prototype.getParagraphWidget = function (position) {\n        if (isNullOrUndefined(position.index)) {\n            return undefined;\n        }\n        var page = this.getPage(position);\n        var child = this.getLineWidget(undefined, position, page);\n        return child;\n    };\n    /**\n     * @private\n     */\n    TextPosition.prototype.getLineWidget = function (widget, position, page) {\n        if (isNullOrUndefined(position.index)) {\n            return undefined;\n        }\n        var index = position.index.indexOf(';');\n        var value = '0';\n        if (index >= 0) {\n            value = position.index.substring(0, index);\n            position.index = position.index.substring(index).replace(';', '');\n        }\n        if (value === 'H' || value === 'F') {\n            if (value === 'H') {\n                widget = page.headerWidget;\n            }\n            else {\n                widget = page.footerWidget;\n            }\n        }\n        else if (!isNullOrUndefined(page)) {\n            widget = page.bodyWidgets[0];\n        }\n        index = parseInt(value, 10);\n        if (widget instanceof BlockContainer) {\n            index = position.index.indexOf(';');\n            value = '0';\n            value = position.index.substring(0, index);\n            position.index = position.index.substring(index).replace(';', '');\n            index = parseInt(value, 10);\n        }\n        if (widget instanceof TableRowWidget && index >= widget.childWidgets.length) {\n            position.index = '0;0';\n            index = widget.childWidgets.length - 1;\n        }\n        if (index >= 0 && index < widget.childWidgets.length) {\n            var child = widget.childWidgets[index];\n            if (child instanceof LineWidget) {\n                if (position.index.indexOf(';') > 0) {\n                    position.index = '0';\n                }\n                return child;\n            }\n            if (child instanceof Widget) {\n                if (position.index.indexOf(';') > 0) {\n                    return this.getLineWidget(child, position);\n                }\n                else {\n                    //If table is shifted to previous text position then return the first paragraph within table.\n                    if (child instanceof TableWidget) {\n                        return this.getLineWidget(this.selection.getFirstParagraphInFirstCell(child), position);\n                    }\n                    else if (child instanceof TableRowWidget && position.index.indexOf(';') === -1) {\n                        return this.selection.getFirstParagraphInFirstCell(child.ownerTable).childWidgets[0];\n                    }\n                    return undefined;\n                }\n            }\n        }\n        else if (widget.nextRenderedWidget instanceof Widget) {\n            position.index = '0';\n            if (widget.nextRenderedWidget instanceof TableWidget) {\n                return this.selection.getFirstParagraphInFirstCell(widget.nextRenderedWidget).firstChild;\n            }\n            return this.getLineWidget(widget.nextRenderedWidget, position);\n        }\n        return undefined;\n    };\n    /**\n     * Update physical location of paragraph\n     * @private\n     */\n    TextPosition.prototype.updatePhysicalPosition = function (moveNextLine) {\n        if (this.currentWidget && this.owner.isLayoutEnabled && this.isUpdateLocation) {\n            this.location = this.selection.getPhysicalPositionInternal(this.currentWidget, this.offset, moveNextLine);\n        }\n    };\n    /**\n     * Return true if text position are in same paragraph and offset\n     * @private\n     */\n    TextPosition.prototype.isAtSamePosition = function (textPosition) {\n        return this.currentWidget === textPosition.currentWidget\n            && this.offset === textPosition.offset;\n    };\n    /**\n     * Return true if text position is in same paragraph\n     * @private\n     */\n    TextPosition.prototype.isInSameParagraph = function (textPosition) {\n        if (isNullOrUndefined(textPosition)) {\n            throw new Error('textPosition is undefined.');\n        }\n        return this.paragraph === textPosition.paragraph;\n    };\n    /**\n     * Return true is current text position exist before given text position\n     * @private\n     */\n    TextPosition.prototype.isExistBefore = function (textPosition) {\n        if (isNullOrUndefined(textPosition)) {\n            throw new Error('textPosition is undefined.');\n        }\n        if (this.currentWidget === textPosition.currentWidget) {\n            return this.offset < textPosition.offset;\n        }\n        var currentParagraph = this.currentWidget.paragraph;\n        var paragraph = textPosition.currentWidget.paragraph;\n        if (currentParagraph === paragraph) {\n            return currentParagraph.childWidgets.indexOf(this.currentWidget) < paragraph.childWidgets.indexOf(textPosition.currentWidget);\n        }\n        if (currentParagraph.containerWidget === paragraph.containerWidget) {\n            if (currentParagraph.isInsideTable) {\n                return currentParagraph.associatedCell.childWidgets.indexOf(currentParagraph) <\n                    paragraph.associatedCell.childWidgets.indexOf(paragraph);\n                //handle after header footer implementation\n                // } else if ((this.currentParagraph).owner instanceof WHeaderFooter) {\n                //     return ((this.currentParagraph).owner as WHeaderFooter).blocks.indexOf((this.currentParagraph)) <\n                //         ((textPosition.currentParagraph).owner as WHeaderFooter).blocks.indexOf((textPosition.currentParagraph));\n            }\n            else {\n                return (currentParagraph.containerWidget.childWidgets.indexOf(currentParagraph)) <\n                    (paragraph.containerWidget.childWidgets.indexOf(paragraph));\n            }\n        }\n        return this.owner.selection.isExistBefore(currentParagraph, paragraph);\n    };\n    /**\n     * Return true is current text position exist after given text position\n     * @private\n     */\n    TextPosition.prototype.isExistAfter = function (textPosition) {\n        if (isNullOrUndefined(textPosition)) {\n            throw new Error('textPosition is undefined.');\n        }\n        if (this.currentWidget === textPosition.currentWidget) {\n            return this.offset > textPosition.offset;\n        }\n        if (this.currentWidget.paragraph === textPosition.currentWidget.paragraph) {\n            return this.currentWidget.paragraph.childWidgets.indexOf(this.currentWidget) >\n                textPosition.currentWidget.paragraph.childWidgets.indexOf(textPosition.currentWidget);\n        }\n        var startParagraph = this.currentWidget.paragraph;\n        var endParagraph = textPosition.currentWidget.paragraph;\n        if (startParagraph.containerWidget.index === endParagraph.containerWidget.index) {\n            if (startParagraph.isInsideTable) {\n                return startParagraph.associatedCell.childWidgets.indexOf(startParagraph) >\n                    endParagraph.associatedCell.childWidgets.indexOf(endParagraph);\n                // } else if ((this.currentParagraph).owner instanceof WHeaderFooter) {\n                //     return ((this.currentParagraph).owner as WHeaderFooter).blocks.indexOf((this.currentParagraph)) >\n                //         ((textPosition.currentParagraph).owner as WHeaderFooter).blocks.indexOf((textPosition.currentParagraph));\n            }\n            else {\n                return (startParagraph.containerWidget.childWidgets.indexOf(startParagraph) >\n                    (endParagraph.containerWidget.childWidgets.indexOf(endParagraph)));\n            }\n        }\n        return this.owner.selection.isExistAfter(startParagraph, endParagraph);\n    };\n    /**\n     * Return hierarchical index of current text position\n     * @private\n     */\n    TextPosition.prototype.getHierarchicalIndexInternal = function () {\n        return this.getHierarchicalIndex(this.currentWidget, this.offset.toString());\n    };\n    /**\n     * @private\n     */\n    TextPosition.prototype.getHierarchicalIndex = function (line, hierarchicalIndex) {\n        var node = line;\n        if (node) {\n            return node.getHierarchicalIndex(hierarchicalIndex);\n        }\n        return hierarchicalIndex;\n    };\n    /**\n     * @private\n     */\n    TextPosition.prototype.setPositionParagraph = function (line, offsetInLine) {\n        this.currentWidget = line;\n        this.offset = offsetInLine;\n        this.updatePhysicalPosition(true);\n    };\n    /**\n     * @private\n     */\n    TextPosition.prototype.setPositionForLineWidget = function (lineWidget, offset) {\n        var lineLength = this.selection.getLineLength(lineWidget);\n        var lineIndex = lineWidget.paragraph.childWidgets.indexOf(lineWidget);\n        if (offset > lineLength + 1) {\n            var nextLineWidget = void 0;\n            if (lineIndex >= lineWidget.paragraph.childWidgets.length - 1) {\n                var nextBlock = this.selection.getNextRenderedBlock(lineWidget.paragraph);\n                if (nextBlock && nextBlock.index === lineWidget.paragraph.index) {\n                    nextLineWidget = nextBlock.firstChild;\n                }\n            }\n            else {\n                nextLineWidget = lineWidget.paragraph.childWidgets[lineIndex + 1];\n            }\n            this.setPositionForLineWidget(nextLineWidget, offset - lineLength);\n            return;\n        }\n        else if (offset < 0) {\n            var prevLine = lineWidget.paragraph.childWidgets[lineIndex - 1];\n            var curretOffSet = this.selection.getLineLength(prevLine) + offset;\n            this.setPositionForLineWidget(prevLine, curretOffSet);\n            return;\n        }\n        else {\n            this.currentWidget = lineWidget;\n            this.offset = offset;\n        }\n        this.updatePhysicalPosition(true);\n    };\n    /**\n     * move to next text position\n     * @private\n     */\n    TextPosition.prototype.moveNextPosition = function (isNavigate) {\n        if (isNullOrUndefined(isNavigate)) {\n            isNavigate = true;\n        }\n        var inline = this.selection.getNextStartInline(this.currentWidget, this.offset);\n        if (inline instanceof FieldElementBox && inline.fieldType === 0 && !isNullOrUndefined(inline.fieldEnd)) {\n            if (isNavigate) {\n                this.moveNextPositionInternal(inline);\n                this.moveNextPosition();\n                return;\n            }\n            else {\n                var line = inline.fieldEnd.line;\n                var fieldEnd = inline.fieldEnd;\n                var fieldEndOffset = line.getOffset(fieldEnd, 1);\n                var fieldEndIndex = this.getHierarchicalIndex(line, fieldEndOffset.toString());\n                if (TextPosition.isForwardSelection(this.selection.end.getHierarchicalIndexInternal(), fieldEndIndex)) {\n                    //If field end is after selection end, extend selection end to field end.\n                    this.selection.end.moveToInline(inline.fieldEnd, 1);\n                    return;\n                }\n                this.moveToInline(inline.fieldEnd, 1);\n            }\n        }\n        var nextOffset = this.selection.getNextValidOffset(this.currentWidget, this.offset);\n        var lineIndex = this.paragraph.childWidgets.indexOf(this.currentWidget);\n        var index = 0;\n        if (nextOffset > this.offset) {\n            this.offset = nextOffset;\n            var info = this.currentWidget.getInline(this.offset, index);\n            inline = info.element;\n            index = info.index;\n            if (!isNullOrUndefined(inline) && index === inline.length && inline.nextNode instanceof FieldElementBox) {\n                var nextValidInline = this.selection.getNextValidElement(inline.nextNode);\n                //Moves to field end mark.\n                if (nextValidInline instanceof FieldElementBox && nextValidInline.fieldType === 1) {\n                    inline = nextValidInline;\n                    this.offset = this.currentWidget.getOffset(inline, 1);\n                }\n            }\n        }\n        else if (lineIndex + 1 < this.paragraph.childWidgets.length) {\n            var nextLineWidget = this.paragraph.childWidgets[lineIndex + 1];\n            if (nextLineWidget) {\n                this.currentWidget = nextLineWidget;\n                this.offset = this.selection.getStartLineOffset(this.currentWidget);\n            }\n            var inlineObj = this.currentWidget.getInline(this.offset, index);\n            inline = inlineObj.element;\n            index = inlineObj.index;\n            if (inline instanceof FieldElementBox && inline.fieldType === 0) {\n                this.offset++;\n            }\n        }\n        else {\n            this.updateOffsetToNextParagraph(index, false);\n        }\n        //Gets physical position in current page.\n        this.updatePhysicalPosition(true);\n    };\n    /**\n     * Move text position to previous paragraph inside table\n     * @private\n     */\n    TextPosition.prototype.moveToPreviousParagraphInTable = function (selection) {\n        var previousParagraph;\n        var currentPara = this.currentWidget.paragraph;\n        if (currentPara.isInsideTable) {\n            previousParagraph = selection.getPreviousSelectionCell(currentPara.associatedCell);\n        }\n        else {\n            previousParagraph = selection.getPreviousParagraphBlock(currentPara);\n        }\n        if (isNullOrUndefined(previousParagraph)) {\n            return;\n        }\n        this.currentWidget = previousParagraph.childWidgets[previousParagraph.childWidgets.length - 1];\n        this.offset = this.currentWidget.getEndOffset() + 1;\n    };\n    TextPosition.prototype.updateOffsetToNextParagraph = function (indexInInline, isHighlight) {\n        //Moves to owner and get next paragraph.\n        var inline;\n        var positionAtStart = false;\n        var nextParagraph = undefined;\n        var lineIndex = this.paragraph.childWidgets.indexOf(this.currentWidget);\n        if (!isHighlight) {\n            nextParagraph = this.selection.getNextParagraphBlock(this.paragraph);\n        }\n        else if (lineIndex + 1 < this.paragraph.childWidgets.length) {\n            var nextLineWidget = this.paragraph.childWidgets[lineIndex + 1];\n            if (nextLineWidget) {\n                this.currentWidget = nextLineWidget;\n                this.offset = 0;\n            }\n        }\n        else {\n            nextParagraph = this.selection.getNextSelectionBlock(this.paragraph);\n            if (!isNullOrUndefined(nextParagraph)) {\n                if (nextParagraph.containerWidget instanceof TableCellWidget) {\n                    if (this.selection.start.paragraph.isInsideTable) {\n                        // tslint:disable-next-line:max-line-length\n                        var containerCell = this.selection.getContainerCellOf(this.selection.start.paragraph.associatedCell, nextParagraph.associatedCell);\n                        positionAtStart = !containerCell.ownerTable.contains(nextParagraph.associatedCell);\n                    }\n                    else {\n                        positionAtStart = true;\n                    }\n                }\n            }\n        }\n        if (!isNullOrUndefined(nextParagraph) && nextParagraph.childWidgets.length > 0) {\n            if (!positionAtStart) {\n                this.currentWidget = nextParagraph.firstChild;\n                this.offset = isHighlight ? 1 : this.selection.getStartLineOffset(this.currentWidget);\n            }\n            else {\n                this.currentWidget = nextParagraph.childWidgets[nextParagraph.childWidgets.length - 1];\n                this.offset = this.selection.getLineLength(this.currentWidget) + 1;\n            }\n        }\n        var inlineObj = this.currentWidget.getInline(this.offset, indexInInline);\n        inline = inlineObj.element;\n        indexInInline = inlineObj.index;\n        if (inline instanceof FieldElementBox && inline.fieldType === 0) {\n            this.offset++;\n        }\n    };\n    TextPosition.prototype.updateOffsetToPrevPosition = function (index, isHighlight) {\n        var inlineInfo;\n        var inline;\n        var lineIndex = this.paragraph.childWidgets.indexOf(this.currentWidget);\n        var prevOffset = this.selection.getPreviousValidOffset(this.currentWidget.paragraph, this.offset);\n        if (this.offset > prevOffset) {\n            this.offset = prevOffset;\n        }\n        else if (lineIndex > 0) {\n            var prevLineWidget = this.paragraph.childWidgets[lineIndex - 1];\n            if (prevLineWidget) {\n                this.currentWidget = prevLineWidget;\n                this.offset = this.currentWidget.getEndOffset();\n            }\n        }\n        else {\n            //Moves to owner and get previous paragraph.\n            var previousParagraph = undefined;\n            var positionAtStart = false;\n            if (!isHighlight) {\n                previousParagraph = this.selection.getPreviousParagraphBlock(this.paragraph);\n            }\n            else {\n                previousParagraph = this.selection.getPreviousSelectionBlock(this.paragraph);\n                if (!isNullOrUndefined(previousParagraph)) {\n                    if (previousParagraph.containerWidget instanceof TableCellWidget) {\n                        if (this.selection.start.paragraph.isInsideTable) {\n                            // tslint:disable-next-line:max-line-length\n                            var containerCell = this.selection.getContainerCellOf(this.selection.start.paragraph.associatedCell, previousParagraph.associatedCell);\n                            positionAtStart = !containerCell.ownerTable.contains(previousParagraph.associatedCell);\n                        }\n                        else {\n                            positionAtStart = true;\n                        }\n                    }\n                }\n            }\n            if (!isNullOrUndefined(previousParagraph)) {\n                if (!positionAtStart) {\n                    this.currentWidget = previousParagraph.childWidgets[previousParagraph.childWidgets.length - 1];\n                    this.offset = this.currentWidget.getEndOffset();\n                }\n                else {\n                    this.currentWidget = previousParagraph.firstChild;\n                    this.offset = this.selection.getStartLineOffset(this.currentWidget);\n                }\n            }\n        }\n        index = 0;\n        inlineInfo = this.currentWidget.getInline(this.offset, index);\n        inline = inlineInfo.element;\n        index = inlineInfo.index;\n        if (inline instanceof FieldElementBox && inline.fieldType === 0) {\n            this.offset++;\n        }\n        if (inline instanceof FieldElementBox) {\n            //Checks if field character is part of rendered field, otherwise moves to previous rendered content.\n            var previousInline = this.selection.getPreviousValidElement(inline);\n            if (!isNullOrUndefined(previousInline)) {\n                inline = previousInline;\n                this.currentWidget = inline.line;\n                this.offset = this.currentWidget.getOffset(inline, inline.length);\n                if (inline instanceof FieldElementBox && inline.fieldType === 0) {\n                    this.offset--;\n                }\n            }\n        }\n        //Gets physical position in current page.\n        this.updatePhysicalPosition(true);\n    };\n    /**\n     * Moves the text position to start of the next paragraph.\n     */\n    TextPosition.prototype.moveToNextParagraphStartInternal = function () {\n        var paragraph = this.currentWidget.paragraph;\n        if (!isNullOrUndefined(this.selection.getNextParagraphBlock(paragraph))) {\n            // tslint:disable-next-line:max-line-length\n            this.currentWidget = this.selection.getNextParagraphBlock(paragraph).firstChild;\n            this.offset = this.selection.getStartOffset(paragraph);\n            this.updatePhysicalPosition(true);\n        }\n    };\n    /**\n     * Move to previous position\n     * @private\n     */\n    TextPosition.prototype.movePreviousPosition = function () {\n        var index = 0;\n        var inlineInfo = this.currentWidget.getInline(this.offset, index);\n        var inline = inlineInfo.element;\n        index = inlineInfo.index;\n        var lineIndex = this.paragraph.childWidgets.indexOf(this.currentWidget);\n        if (inline instanceof FieldElementBox && inline.fieldType === 1 && !isNullOrUndefined(inline.fieldBegin)) {\n            this.movePreviousPositionInternal(inline);\n        }\n        this.updateOffsetToPrevPosition(index, false);\n    };\n    /**\n     * Move to next position\n     * @private\n     */\n    TextPosition.prototype.moveNextPositionInternal = function (fieldBegin) {\n        var inline;\n        if (isNullOrUndefined(fieldBegin.fieldSeparator)) {\n            inline = fieldBegin.fieldEnd;\n        }\n        else {\n            inline = fieldBegin.fieldSeparator;\n            this.currentWidget = inline.line;\n            // tslint:disable-next-line:max-line-length\n            if (this.currentWidget === fieldBegin.fieldEnd.line && !this.selection.hasValidInline(this.paragraph, inline, fieldBegin.fieldEnd)) {\n                inline = fieldBegin.fieldEnd;\n            }\n        }\n        this.currentWidget = inline.line;\n        this.offset = this.currentWidget.getOffset(inline, 1);\n    };\n    /**\n     * Move text position backward\n     * @private\n     */\n    TextPosition.prototype.moveBackward = function () {\n        var indexInInline = 0;\n        var inlineObj = this.currentWidget.getInline(this.offset, indexInInline);\n        var inline = inlineObj.element;\n        indexInInline = inlineObj.index;\n        if (!this.owner.selection.isEmpty && !isNullOrUndefined(inline)) {\n            var nextInline = this.selection.getNextRenderedElementBox(inline, indexInInline);\n            if (nextInline instanceof FieldElementBox && nextInline.fieldType === 0) {\n                var hierarchicalIndex = this.owner.selection.start.getHierarchicalIndexInternal();\n                // tslint:disable-next-line:max-line-length\n                var fieldEndOffset = nextInline.fieldEnd.line.getOffset(nextInline.fieldEnd, 1);\n                // tslint:disable-next-line:max-line-length\n                var fieldEndIndex = this.getHierarchicalIndex(nextInline.fieldEnd.line, fieldEndOffset.toString());\n                if (!TextPosition.isForwardSelection(fieldEndIndex, hierarchicalIndex)) {\n                    //If field end is after selection start, move selection start to field end.\n                    // tslint:disable-next-line:max-line-length\n                    this.owner.selection.start.setPositionParagraph(nextInline.fieldEnd.line, fieldEndOffset);\n                    return;\n                }\n            }\n        }\n        if (inline instanceof FieldElementBox && inline.fieldType === 1 && !isNullOrUndefined(inline.fieldBegin)) {\n            var hierarchicalIndex = this.owner.selection.start.getHierarchicalIndexInternal();\n            var fieldEndOffset = inline.line.getOffset(inline, 1);\n            var fieldEndIndex = this.getHierarchicalIndex(inline.line, fieldEndOffset.toString());\n            if (!TextPosition.isForwardSelection(hierarchicalIndex, fieldEndIndex)) {\n                //If field end is after selection start, extend selection end to field begin.\n                // tslint:disable-next-line:max-line-length\n                var fieldBeginOffset = inline.fieldBegin.line.getOffset(inline.fieldBegin, 0);\n                this.currentWidget = inline.fieldBegin.line;\n                this.offset = fieldBeginOffset;\n                //Updates physical position in current page.\n                this.updatePhysicalPosition(true);\n                return;\n            }\n            this.movePreviousPositionInternal(inline);\n        }\n        this.updateOffsetToPrevPosition(indexInInline, true);\n    };\n    /**\n     * Move text position forward\n     * @private\n     */\n    TextPosition.prototype.moveForward = function () {\n        var indexInInline = 0;\n        var inlineObj = this.currentWidget.getInline(this.offset, indexInInline);\n        var inline = inlineObj.element;\n        indexInInline = inlineObj.index;\n        if (!isNullOrUndefined(inline)) {\n            if (!this.owner.selection.isEmpty && indexInInline === inline.length && inline instanceof FieldElementBox\n                && inline.fieldType === 1) {\n                var hierarchicalIndex = this.owner.selection.start.getHierarchicalIndexInternal();\n                // tslint:disable-next-line:max-line-length\n                var fieldBeginOffset = inline.fieldBegin.line.getOffset(inline.fieldBegin, 0);\n                // tslint:disable-next-line:max-line-length\n                var fieldBeginIndex = this.getHierarchicalIndex(inline.fieldBegin.line, fieldBeginOffset.toString());\n                if (!TextPosition.isForwardSelection(hierarchicalIndex, fieldBeginIndex)) {\n                    //If field begin is before selection start, move selection start to field begin.\n                    // tslint:disable-next-line:max-line-length\n                    this.owner.selection.start.setPositionParagraph(inline.fieldBegin.line, fieldBeginOffset);\n                    return;\n                }\n            }\n            inline = this.selection.getNextRenderedElementBox(inline, indexInInline);\n        }\n        if (inline instanceof FieldElementBox && !isNullOrUndefined(inline.fieldEnd)) {\n            var selectionStartParagraph = this.owner.selection.start.paragraph;\n            var selectionStartIndex = 0;\n            // tslint:disable-next-line:max-line-length\n            var selectionStartInlineObj = selectionStartParagraph.getInline(this.owner.selection.start.offset, selectionStartIndex);\n            var selectionStartInline = selectionStartInlineObj.element;\n            selectionStartIndex = selectionStartInlineObj.index;\n            var nextRenderInline = this.selection.getNextRenderedElementBox(selectionStartInline, selectionStartIndex);\n            if (nextRenderInline === inline) {\n                this.moveNextPositionInternal(inline);\n            }\n            else {\n                //If selection start is before field begin, extend selection end to field end.\n                inline = inline.fieldEnd;\n                this.currentWidget = inline.line;\n                this.offset = this.currentWidget.getOffset(inline, 1);\n                //Updates physical position in current page.\n                this.updatePhysicalPosition(true);\n                return;\n            }\n        }\n        else if ((inline instanceof FieldElementBox)\n            && (inline.fieldType === 0 || inline.fieldType === 1)) {\n            this.currentWidget = inline.line;\n            this.offset = this.currentWidget.getOffset(inline, 1);\n        }\n        indexInInline = 0;\n        var nextOffset = this.selection.getNextValidOffset(this.currentWidget, this.offset);\n        var length = this.selection.getLineLength(this.currentWidget);\n        var isParagraphEnd = this.selection.isParagraphLastLine(this.currentWidget);\n        if (this.offset < nextOffset) {\n            this.offset = nextOffset;\n            var inlineObj_1 = this.currentWidget.getInline(this.offset, indexInInline);\n            inline = inlineObj_1.element;\n            indexInInline = inlineObj_1.index;\n            if (!isNullOrUndefined(inline) && indexInInline === inline.length && inline.nextNode instanceof FieldElementBox) {\n                var nextValidInline = this.selection.getNextValidElement(inline.nextNode);\n                //Moves to field end mark.\n                if (nextValidInline instanceof FieldElementBox && nextValidInline.fieldType === 1) {\n                    inline = nextValidInline;\n                    this.offset = this.currentWidget.getOffset(inline, 1);\n                }\n            }\n        }\n        else if (this.offset === nextOffset && this.offset < length + 1 && isParagraphEnd) {\n            this.offset = length + 1;\n        }\n        else {\n            this.updateOffsetToNextParagraph(indexInInline, true);\n        }\n        //Gets physical position in current page.\n        this.updatePhysicalPosition(true);\n    };\n    /**\n     * Move to given inline\n     * @private\n     */\n    TextPosition.prototype.moveToInline = function (inline, index) {\n        this.currentWidget = inline.line;\n        this.offset = this.currentWidget.getOffset(inline, index);\n        //Updates physical position in current page.\n        this.updatePhysicalPosition(true);\n    };\n    /**\n     * Return true is start element exist before end element\n     * @private\n     */\n    TextPosition.isForwardSelection = function (start, end) {\n        if (start === end) {\n            return true;\n        }\n        start = start.replace(/C;/g, '');\n        end = end.replace(/C;/g, '');\n        start = start.replace(/H;/g, '');\n        end = end.replace(/H;/g, '');\n        start = start.replace(/F;/g, '');\n        end = end.replace(/F;/g, '');\n        var selectionStart = start.split(';');\n        var selectionEnd = end.split(';');\n        var length = selectionStart.length;\n        if (length > selectionEnd.length) {\n            length = selectionEnd.length - 1;\n        }\n        for (var i = 0; i < length; i++) {\n            var startOffset = parseFloat(selectionStart[i]);\n            var endOffset = parseFloat(selectionEnd[i]);\n            if (startOffset !== endOffset) {\n                return startOffset < endOffset;\n            }\n        }\n        return false;\n    };\n    /**\n     * Move to previous position offset\n     * @private\n     */\n    TextPosition.prototype.movePreviousPositionInternal = function (fieldEnd) {\n        var inline;\n        if (isNullOrUndefined(fieldEnd.fieldSeparator)) {\n            inline = this.selection.getPreviousValidElement(fieldEnd.fieldBegin);\n        }\n        else {\n            inline = this.selection.getPreviousValidElement(fieldEnd);\n        }\n        this.currentWidget = inline.line;\n        this.offset = this.currentWidget.getOffset(inline, inline instanceof FieldElementBox ? 0 : inline.length);\n    };\n    /**\n     * Moves the text position to start of the word.\n     * @private\n     */\n    TextPosition.prototype.moveToWordStartInternal = function (type) {\n        var endOffset = this.currentWidget.getEndOffset();\n        var currentPara = this.currentWidget.paragraph;\n        var selection = this.selection;\n        if (type === 2 && (this.offset === endOffset || this.offset === endOffset + 1)) {\n            return;\n        }\n        if (this.offset === endOffset + 1) {\n            this.offset = endOffset;\n        }\n        else if (this.offset === selection.getStartOffset(currentPara) && this.currentWidget === currentPara.childWidgets[0]) {\n            var previousParagraph = selection.getPreviousParagraphBlock(currentPara);\n            if (isNullOrUndefined(previousParagraph)) {\n                return;\n            }\n            this.currentWidget = previousParagraph.childWidgets[previousParagraph.childWidgets.length - 1];\n            this.offset = this.currentWidget.getEndOffset();\n        }\n        else {\n            if (this.offset === selection.getStartLineOffset(this.currentWidget)) {\n                var lineIndex = currentPara.childWidgets.indexOf(this.currentWidget);\n                if (lineIndex - 1 >= 0) {\n                    this.currentWidget = currentPara.childWidgets[lineIndex - 1];\n                    this.offset = this.currentWidget.getEndOffset();\n                }\n            }\n            var isStarted = false;\n            var endSelection = false;\n            var indexInInline = 0;\n            var inlineObj = this.currentWidget.getInline(this.offset, indexInInline);\n            var inline = inlineObj.element;\n            indexInInline = inlineObj.index;\n            // tslint:disable-next-line:max-line-length           \n            this.getPreviousWordOffset(inline, selection, indexInInline, type, (inline instanceof FieldElementBox && inline.fieldType === 1), isStarted, endSelection, this);\n        }\n        if (type === 1) {\n            this.calculateOffset();\n        }\n        this.updatePhysicalPosition(true);\n    };\n    /**\n     * Get next word offset\n     * @private\n     */\n    // tslint:disable-next-line:max-line-length\n    TextPosition.prototype.getNextWordOffset = function (inline, indexInInline, type, isInField, endSelection, endPosition, excludeSpace) {\n        if (inline instanceof TextElementBox) {\n            this.getNextWordOffsetSpan(inline, indexInInline, type, isInField, endSelection, endPosition, excludeSpace);\n        }\n        else if (inline instanceof ImageElementBox) {\n            // tslint:disable-next-line:max-line-length\n            this.getNextWordOffsetImage(inline, indexInInline, type, isInField, endSelection, endPosition, excludeSpace);\n        }\n        else if (inline instanceof FieldElementBox && inline.fieldType === 0) {\n            // tslint:disable-next-line:max-line-length\n            this.getNextWordOffsetFieldBegin(inline, indexInInline, type, isInField, endSelection, endPosition, excludeSpace);\n        }\n        else if (inline instanceof FieldElementBox && inline.fieldType === 2 || inline instanceof BookmarkElementBox) {\n            // tslint:disable-next-line:max-line-length\n            this.getNextWordOffsetFieldSeperator(inline, indexInInline, type, isInField, endSelection, endPosition, excludeSpace);\n        }\n        else if (inline instanceof FieldElementBox && inline.fieldType === 1) {\n            // tslint:disable-next-line:max-line-length\n            this.getNextWordOffsetFieldEnd(inline, indexInInline, type, isInField, endSelection, endPosition, excludeSpace);\n        }\n    };\n    /**\n     * get next word offset from field begin\n     * @private\n     */\n    // tslint:disable-next-line:max-line-length\n    TextPosition.prototype.getNextWordOffsetFieldBegin = function (fieldBegin, indexInInline, type, isInField, endSelection, endPosition, excludeSpace) {\n        var startOffset = fieldBegin.line.getOffset(fieldBegin, 0);\n        var endOffset = startOffset + fieldBegin.length;\n        if (isNullOrUndefined(fieldBegin.fieldSeparator)) {\n            this.getNextWordOffsetFieldEnd(fieldBegin.fieldEnd, 0, type, isInField, endSelection, endPosition, excludeSpace);\n        }\n        else if (type === 0) {\n            // tslint:disable-next-line:max-line-length\n            this.getNextWordOffsetFieldSeperator(fieldBegin.fieldSeparator, 0, type, isInField, endSelection, endPosition, excludeSpace);\n        }\n        else if (!isNullOrUndefined(fieldBegin.fieldEnd)) {\n            var inline = fieldBegin.fieldSeparator;\n            // tslint:disable-next-line:max-line-length\n            if (inline.line.paragraph === fieldBegin.fieldEnd.line.paragraph && !this.selection.hasValidInline(inline.line.paragraph, inline, fieldBegin.fieldEnd)) {\n                inline = fieldBegin.fieldEnd;\n            }\n            // tslint:disable-next-line:max-line-length\n            this.getNextWordOffset(inline, 0, type, !(endPosition.paragraph === fieldBegin.line.paragraph && endPosition.offset === startOffset), endSelection, endPosition, excludeSpace);\n            // tslint:disable-next-line:max-line-length\n            if (endSelection && !isNullOrUndefined(fieldBegin.fieldSeparator) && (endPosition.paragraph === fieldBegin.line.paragraph) && (endPosition.offset === fieldBegin.fieldSeparator.line.getOffset(fieldBegin.fieldSeparator, fieldBegin.fieldSeparator.length))) {\n                endPosition.setPositionParagraph(fieldBegin.line, startOffset);\n                return;\n            }\n            if (!endSelection) {\n                // tslint:disable-next-line:max-line-length\n                endPosition.setPositionParagraph(fieldBegin.fieldEnd.line, fieldBegin.fieldEnd.line.getOffset(fieldBegin.fieldEnd, fieldBegin.fieldEnd.length));\n            }\n        }\n    };\n    /**\n     * get next word offset from image\n     * @private\n     */\n    // tslint:disable-next-line:max-line-length\n    TextPosition.prototype.getNextWordOffsetImage = function (image, indexInInline, type, isInField, endSelection, endPosition, excludeSpace) {\n        if (isInField) {\n            endPosition.setPositionParagraph(image.line, image.line.getOffset(image, indexInInline));\n            endSelection = false;\n            return;\n        }\n        if (indexInInline === 0) {\n            var startOffset = image.line.getOffset(image, 0);\n            endSelection = true;\n            if (endPosition.offset === startOffset) {\n                if (isNullOrUndefined(image.nextNode)) {\n                    endPosition.setPositionParagraph(image.line, startOffset + image.length);\n                }\n                else {\n                    this.getNextWordOffset(image.nextNode, 0, type, isInField, endSelection, endPosition, excludeSpace);\n                }\n            }\n            else {\n                endPosition.setPositionParagraph(image.line, startOffset);\n            }\n        }\n        else if (!isNullOrUndefined(image.nextNode)) {\n            this.getNextWordOffset(image.nextNode, 0, type, isInField, endSelection, endPosition, excludeSpace);\n        }\n    };\n    /**\n     * get next word offset from span\n     */\n    // tslint:disable-next-line:max-line-length\n    TextPosition.prototype.getNextWordOffsetSpan = function (span, indexInInline, type, isInField, endSelection, endPosition, excludeSpace) {\n        if (span.text === '\\t' || span.text === '\\v') {\n            if (isInField) {\n                endPosition.setPositionParagraph(span.line, span.line.getOffset(span, indexInInline));\n                endSelection = false;\n                return;\n            }\n            if (indexInInline === 0) {\n                endSelection = true;\n                var startOffset = span.line.getOffset(span, 0);\n                if (endPosition.offset === startOffset) {\n                    endPosition.setPositionParagraph(span.line, startOffset + span.length);\n                }\n                else {\n                    endPosition.setPositionParagraph(span.line, startOffset);\n                }\n            }\n            else if (!isNullOrUndefined(span.nextNode)) {\n                this.getNextWordOffset(span.nextNode, 0, type, isInField, endSelection, endPosition, excludeSpace);\n            }\n        }\n        else {\n            var wordEndIndex = 0;\n            if (indexInInline === 0 && endSelection && (HelperMethods.wordSplitCharacters.indexOf(span.text[0]) === -1)) {\n                endPosition.setPositionParagraph(span.line, span.line.getOffset(span, indexInInline));\n                if (isInField) {\n                    return;\n                }\n            }\n            else if (indexInInline < span.length) {\n                // tslint:disable-next-line:max-line-length\n                var txt = indexInInline > 0 && span.text.length - 1 >= indexInInline ? span.text.slice(indexInInline, span.length) : span.text;\n                wordEndIndex = HelperMethods.indexOfAny(txt, HelperMethods.wordSplitCharacters);\n                if (wordEndIndex !== -1) {\n                    if (isInField) {\n                        endSelection = false;\n                        return;\n                    }\n                    var offset = span.line.getOffset(span, wordEndIndex + indexInInline);\n                    // tslint:disable-next-line:max-line-length\n                    if ((excludeSpace || txt[wordEndIndex] !== ' ') && !endSelection && span.line.paragraph === endPosition.paragraph && offset !== endPosition.offset) {\n                        endSelection = true;\n                        endPosition.setPositionParagraph(span.line, offset);\n                        return;\n                    }\n                    wordEndIndex++;\n                    while (wordEndIndex < txt.length && HelperMethods.wordSplitCharacters.indexOf(txt[wordEndIndex]) !== -1) {\n                        if (txt[wordEndIndex] !== ' ' && txt[wordEndIndex] !== '　') {\n                            break;\n                        }\n                        wordEndIndex++;\n                    }\n                    endSelection = true;\n                    if (wordEndIndex < txt.length) {\n                        // tslint:disable-next-line:max-line-length\n                        endPosition.setPositionParagraph(span.line, span.line.getOffset(span, wordEndIndex + indexInInline));\n                    }\n                    else if (!isNullOrUndefined(span.nextNode)) {\n                        // tslint:disable-next-line:max-line-length\n                        this.getNextWordOffset(span.nextNode, 0, type, isInField, endSelection, endPosition, excludeSpace);\n                    }\n                    else {\n                        // tslint:disable-next-line:max-line-length\n                        endPosition.setPositionParagraph(span.line, span.line.getOffset(span, wordEndIndex + indexInInline));\n                    }\n                }\n                else if (!isNullOrUndefined(span.nextNode)) {\n                    this.getNextWordOffset(span.nextNode, 0, type, isInField, endSelection, endPosition, excludeSpace);\n                }\n                else {\n                    endPosition.setPositionParagraph(span.line, span.line.getEndOffset());\n                }\n            }\n            else if (!isNullOrUndefined(span.nextNode)) {\n                this.getNextWordOffset(span.nextNode, 0, type, isInField, endSelection, endPosition, excludeSpace);\n            }\n        }\n    };\n    /**\n     * get next word offset from field separator\n     * @private\n     */\n    // tslint:disable-next-line:max-line-length\n    TextPosition.prototype.getNextWordOffsetFieldSeperator = function (fieldSeparator, indexInInline, type, isInField, endSelection, endPosition, excludeSpace) {\n        if (!isNullOrUndefined(fieldSeparator.nextNode)) {\n            this.getNextWordOffset(fieldSeparator.nextNode, 0, type, isInField, endSelection, endPosition, excludeSpace);\n        }\n    };\n    /**\n     * get next word offset from field end\n     * @private\n     */\n    // tslint:disable-next-line:max-line-length\n    TextPosition.prototype.getNextWordOffsetFieldEnd = function (fieldEnd, indexInInline, type, isInField, endSelection, endPosition, excludeSpace) {\n        var startOffset = fieldEnd.line.getOffset(fieldEnd, 0);\n        var endOffset = startOffset + fieldEnd.length;\n        if (endPosition.offset === startOffset) {\n            endPosition.setPositionParagraph(fieldEnd.line, endOffset);\n            if (isNullOrUndefined(fieldEnd.nextNode)) {\n                return;\n            }\n        }\n        if (!isNullOrUndefined(fieldEnd.nextNode)) {\n            this.getNextWordOffset(fieldEnd.nextNode, 0, type, false, endSelection, endPosition, excludeSpace);\n            if (endPosition.offset === endOffset) {\n                endPosition.setPositionParagraph(fieldEnd.line, startOffset);\n            }\n        }\n        else {\n            endPosition.setPositionParagraph(fieldEnd.line, startOffset);\n        }\n        endSelection = true;\n    };\n    /**\n     * Get previous word offset\n     * @private\n     */\n    // tslint:disable-next-line:max-line-length\n    TextPosition.prototype.getPreviousWordOffset = function (inline, selection, indexInInline, type, isInField, isStarted, endSelection, endPosition) {\n        if (inline instanceof TextElementBox) {\n            // tslint:disable-next-line:max-line-length\n            this.getPreviousWordOffsetSpan(inline, selection, indexInInline, type, isInField, isStarted, endSelection, endPosition);\n        }\n        else if (inline instanceof ImageElementBox) {\n            // tslint:disable-next-line:max-line-length\n            this.getPreviousWordOffsetImage(inline, selection, indexInInline, type, isInField, isStarted, endSelection, endPosition);\n        }\n        else if (inline instanceof FieldElementBox && inline.fieldType === 0) {\n            // tslint:disable-next-line:max-line-length\n            this.getPreviousWordOffsetFieldBegin(inline, selection, indexInInline, type, isInField, isStarted, endSelection, endPosition);\n        }\n        else if (inline instanceof FieldElementBox && inline.fieldType === 2) {\n            // tslint:disable-next-line:max-line-length\n            this.getPreviousWordOffsetFieldSeparator(inline, selection, indexInInline, type, isInField, isStarted, endSelection, endPosition);\n        }\n        else if (inline instanceof FieldElementBox && inline.fieldType === 1) {\n            // tslint:disable-next-line:max-line-length\n            this.getPreviousWordOffsetFieldEnd(inline, selection, indexInInline, type, isInField, isStarted, endSelection, endPosition);\n        }\n        else if (inline instanceof BookmarkElementBox) {\n            this.getPreviousWordOffsetBookMark(inline, selection, indexInInline, type, isInField, isStarted, endSelection, endPosition);\n        }\n        else if (inline instanceof ListTextElementBox && inline.previousNode) {\n            // tslint:disable-next-line:max-line-length\n            this.getPreviousWordOffsetSpan(inline.previousNode, selection, indexInInline, type, isInField, isStarted, endSelection, endPosition);\n        }\n    };\n    // tslint:disable-next-line:max-line-length\n    TextPosition.prototype.getPreviousWordOffsetBookMark = function (bookmark, selection, indexInInline, type, isInField, isStarted, endSelection, endPosition) {\n        if (bookmark.previousNode) {\n            if (bookmark.previousNode instanceof TextElementBox) {\n                var inline = bookmark.previousNode;\n                if (HelperMethods.lastIndexOfAny(inline.text, HelperMethods.wordSplitCharacters) !== inline.text.length - 1) {\n                    this.getPreviousWordOffset(inline, selection, indexInInline, type, isInField, isStarted, endSelection, endPosition);\n                }\n                else {\n                    endPosition.setPositionParagraph(bookmark.line, bookmark.line.getOffset(bookmark, 0));\n                }\n            }\n        }\n        else {\n            endPosition.setPositionParagraph(bookmark.line, selection.getStartLineOffset(bookmark.line));\n        }\n    };\n    /**\n     * get previous word offset from field end\n     * @private\n     */\n    // tslint:disable-next-line:max-line-length\n    TextPosition.prototype.getPreviousWordOffsetFieldEnd = function (fieldEnd, selection, indexInInline, type, isInField, isStarted, endSelection, endPosition) {\n        var startOffset = fieldEnd.line.getOffset(fieldEnd, 0);\n        var endOffset = startOffset + fieldEnd.length;\n        if (isNullOrUndefined(fieldEnd.fieldSeparator)) {\n            this.getPreviousWordOffsetFieldBegin(fieldEnd.fieldBegin, selection, 0, type, isInField, isStarted, endSelection, endPosition);\n        }\n        else if (type === 0 && !isNullOrUndefined(fieldEnd.previousNode)) {\n            var inline = fieldEnd.previousNode;\n            // tslint:disable-next-line:max-line-length\n            this.getPreviousWordOffset(inline, selection, inline.length, type, (inline instanceof FieldElementBox && inline.fieldType === 1), isStarted, endSelection, endPosition);\n        }\n        else if (!isNullOrUndefined(fieldEnd.fieldBegin) && type !== 0) {\n            var inline = fieldEnd.previousNode;\n            // tslint:disable-next-line:max-line-length\n            if (isNullOrUndefined(inline) || (inline.line.paragraph === fieldEnd.fieldBegin.line.paragraph && !selection.hasValidInline(inline.line.paragraph, inline, fieldEnd.fieldBegin))) {\n                inline = fieldEnd.fieldBegin;\n            }\n            // tslint:disable-next-line:max-line-length\n            this.getPreviousWordOffset(inline, selection, inline.length, type, !(endPosition.paragraph === fieldEnd.line.paragraph && endPosition.offset === endOffset), isStarted, endSelection, endPosition);\n            if (endSelection && endPosition.paragraph === fieldEnd.line.paragraph\n                && endPosition.offset === startOffset) {\n                endPosition.setPositionParagraph(fieldEnd.line, endOffset);\n                return;\n            }\n            if (!endSelection) {\n                // tslint:disable-next-line:max-line-length\n                endPosition.setPositionParagraph(fieldEnd.fieldBegin.line, fieldEnd.fieldBegin.line.getOffset(fieldEnd.fieldBegin, 0));\n            }\n        }\n    };\n    /**\n     * get previous word offset from field separator\n     * @private\n     */\n    // tslint:disable-next-line:max-line-length\n    TextPosition.prototype.getPreviousWordOffsetFieldSeparator = function (fieldSeparator, selection, indexInInline, type, isInField, isStarted, endSelection, endPosition) {\n        this.getPreviousWordOffsetFieldBegin(fieldSeparator.fieldBegin, selection, fieldSeparator.fieldBegin.length, type, isInField, isStarted, endSelection, endPosition);\n    };\n    /**\n     * get previous word offset from field begin\n     * @private\n     */\n    // tslint:disable-next-line:max-line-length\n    TextPosition.prototype.getPreviousWordOffsetFieldBegin = function (fieldBegin, selection, indexInInline, type, isInField, isStarted, endSelection, endPosition) {\n        var startOffset = fieldBegin.line.getOffset(fieldBegin, 0);\n        var endOffset = startOffset + fieldBegin.length;\n        if (endPosition.offset === endOffset) {\n            endPosition.setPositionParagraph(fieldBegin.line, startOffset);\n        }\n        if (!isNullOrUndefined(fieldBegin.previousNode)) {\n            // tslint:disable-next-line:max-line-length\n            this.getPreviousWordOffset(fieldBegin.previousNode, selection, fieldBegin.previousNode.length, type, false, isStarted, endSelection, endPosition);\n            if (endPosition.offset === startOffset) {\n                if (type !== 0 && !isNullOrUndefined(fieldBegin.fieldSeparator)) {\n                    // tslint:disable-next-line:max-line-length\n                    endPosition.setPositionParagraph(fieldBegin.line, fieldBegin.fieldSeparator.line.getOffset(fieldBegin.fieldSeparator, fieldBegin.fieldSeparator.length));\n                }\n            }\n        }\n        else {\n            endPosition.setPositionParagraph(fieldBegin.line, selection.getStartLineOffset(fieldBegin.line));\n        }\n    };\n    /**\n     * get previous word offset from image\n     * @private\n     */\n    // tslint:disable-next-line:max-line-length\n    TextPosition.prototype.getPreviousWordOffsetImage = function (image, selection, indexInInline, type, isInField, isStarted, endSelection, endPosition) {\n        if (isInField) {\n            endPosition.setPositionParagraph(image.line, image.line.getOffset(image, indexInInline));\n            endSelection = false;\n            return;\n        }\n        if (indexInInline === image.length) {\n            var endOffset = image.line.getOffset(image, image.length);\n            if (endOffset === endPosition.offset) {\n                endPosition.setPositionParagraph(image.line, endOffset - image.length);\n            }\n            else {\n                endPosition.setPositionParagraph(image.line, endOffset);\n            }\n        }\n        else if (!isNullOrUndefined(image.previousNode)) {\n            // tslint:disable-next-line:max-line-length\n            this.getPreviousWordOffset(image.previousNode, selection, image.previousNode.length, type, isInField, isStarted, endSelection, endPosition);\n        }\n    };\n    /**\n     * Get previous word offset from span\n     * @private\n     */\n    // tslint:disable-next-line:max-line-length   \n    TextPosition.prototype.getPreviousWordOffsetSpan = function (span, selection, indexInInline, type, isInField, isStarted, endSelection, endPosition) {\n        if (span.text === '\\t' || span.text === '\\v') {\n            if (isInField) {\n                endSelection = false;\n                return;\n            }\n            if (indexInInline === span.length) {\n                endSelection = true;\n                var endOffset = span.line.getOffset(span, span.length);\n                if (endOffset === endPosition.offset) {\n                    endPosition.setPositionParagraph(span.line, endOffset - span.length);\n                }\n                else {\n                    endPosition.setPositionParagraph(span.line, endOffset);\n                }\n            }\n            else if (!isNullOrUndefined(span.previousNode)) {\n                // tslint:disable-next-line:max-line-length\n                this.getPreviousWordOffset(span.previousNode, selection, span.previousNode.length, type, isInField, isStarted, endSelection, endPosition);\n            }\n        }\n        else {\n            var wordStartIndex = 0;\n            if (!isStarted) {\n                while (indexInInline > 0 && span.text[indexInInline - 1] === ' ') {\n                    indexInInline--;\n                }\n                endPosition.setPositionParagraph(span.line, span.line.getOffset(span, indexInInline));\n            }\n            if (indexInInline > 0) {\n                isStarted = true;\n                if (indexInInline === 0 && endSelection && (HelperMethods.wordSplitCharacters.indexOf(span.text[0])) === -1) {\n                    endPosition.setPositionParagraph(span.line, span.line.getOffset(span, indexInInline));\n                    endSelection = true;\n                    return;\n                }\n                var txt = span.text.length > indexInInline ? span.text.slice(0, indexInInline) : span.text;\n                wordStartIndex = HelperMethods.lastIndexOfAny(txt, HelperMethods.wordSplitCharacters);\n                if (wordStartIndex !== -1) {\n                    if (isInField) {\n                        endSelection = false;\n                        return;\n                    }\n                    while (wordStartIndex > 0 && endSelection && txt[wordStartIndex] !== ' '\n                        && (HelperMethods.wordSplitCharacters.indexOf(txt[wordStartIndex - 1])) !== -1) {\n                        wordStartIndex--;\n                    }\n                    if (txt[wordStartIndex] === ' ' || txt[wordStartIndex] === '　' || !endSelection) {\n                        wordStartIndex++;\n                    }\n                    endSelection = true;\n                    if (wordStartIndex > 0) {\n                        var offset = span.line.getOffset(span, wordStartIndex);\n                        if (span.line.paragraph === endPosition.paragraph && offset === endPosition.offset) {\n                            // tslint:disable-next-line:max-line-length\n                            this.getPreviousWordOffsetSpan(span, selection, indexInInline, type, isInField, isStarted, endSelection, endPosition);\n                        }\n                        else {\n                            endPosition.setPositionParagraph(span.line, offset);\n                        }\n                    }\n                    else if (span.previousNode instanceof TextElementBox) {\n                        // tslint:disable-next-line:max-line-length\n                        this.getPreviousWordOffset(span.previousNode, selection, span.previousNode.length, type, isInField, isStarted, endSelection, endPosition);\n                    }\n                    else {\n                        endPosition.setPositionParagraph(span.line, span.line.getOffset(span, 0));\n                    }\n                }\n                else {\n                    this.setPreviousWordOffset(span, selection, indexInInline, type, isInField, isStarted, endSelection, endPosition);\n                }\n            }\n            else {\n                this.setPreviousWordOffset(span, selection, indexInInline, type, isInField, isStarted, endSelection, endPosition);\n            }\n        }\n    };\n    /**\n     * set previous word offset in span\n     * @private\n     */\n    // tslint:disable-next-line:max-line-length\n    TextPosition.prototype.setPreviousWordOffset = function (span, selection, indexInInline, type, isInField, isStarted, endSelection, endPosition) {\n        if (span.previousNode instanceof ElementBox && span.line === span.previousNode.line) {\n            // tslint:disable-next-line:max-line-length\n            this.getPreviousWordOffset(span.previousNode, selection, span.previousNode.length, type, isInField, isStarted, endSelection, endPosition);\n        }\n        else {\n            endPosition.setPositionParagraph(span.line, selection.getStartLineOffset(span.line));\n        }\n    };\n    /**\n     * Validate if text position is in field forward\n     * @private\n     */\n    TextPosition.prototype.validateForwardFieldSelection = function (currentIndex, selectionEndIndex) {\n        var textPosition = new TextPosition(this.owner);\n        textPosition.setPositionForCurrentIndex(currentIndex);\n        textPosition.isUpdateLocation = false;\n        var isPositionMoved = false;\n        while (currentIndex !== selectionEndIndex && TextPosition.isForwardSelection(currentIndex, selectionEndIndex)) {\n            if (!isPositionMoved) {\n                textPosition.moveNextPosition(false);\n                var nextIndex = textPosition.getHierarchicalIndexInternal();\n                //Handled specifically to break infinite looping, if selection ends at last paragraph mark.\n                if (currentIndex === nextIndex) {\n                    break;\n                }\n            }\n            var indexInInline = 0;\n            var inlineObj = textPosition.currentWidget.getInline(textPosition.offset, indexInInline);\n            var inline = inlineObj.element;\n            indexInInline = inlineObj.index;\n            if (!isNullOrUndefined(inline)) {\n                var selectionStartIndex = this.selection.start.getHierarchicalIndexInternal();\n                if (indexInInline === inline.length && inline instanceof FieldElementBox && inline.fieldType === 1) {\n                    if (inline.line.getOffset(inline, 0) === this.offset) {\n                        return;\n                    }\n                    var lineWidget = inline.fieldBegin.line;\n                    var fieldBeginOffset = lineWidget.getOffset(inline.fieldBegin, 0);\n                    var fieldBeginIndex = this.getHierarchicalIndex(lineWidget, fieldBeginOffset.toString());\n                    if (!TextPosition.isForwardSelection(selectionStartIndex, fieldBeginIndex)) {\n                        this.selection.start.setPositionParagraph(lineWidget, fieldBeginOffset);\n                    }\n                }\n                var nextInline = this.selection.getNextRenderedElementBox(inline, indexInInline);\n                if (!isNullOrUndefined(nextInline) && nextInline instanceof ElementBox) {\n                    inline = nextInline;\n                }\n            }\n            isPositionMoved = (inline instanceof FieldElementBox && inline.fieldType === 0 && !isNullOrUndefined(inline.fieldEnd));\n            if (isPositionMoved) {\n                if (inline.line.getOffset(inline, 0) === this.offset) {\n                    return;\n                }\n                var fieldEnd = inline.fieldEnd;\n                var paragraph = fieldEnd.line.paragraph;\n                var fieldEndOffset = fieldEnd.line.getOffset(fieldEnd, 1);\n                var fieldEndIndex = this.getHierarchicalIndex(fieldEnd.line, fieldEndOffset.toString());\n                if (!TextPosition.isForwardSelection(fieldEndIndex, selectionEndIndex)) {\n                    //If selection end is after field begin, extend selection end to field end.\n                    this.moveToInline(inline.fieldEnd, 1);\n                    return;\n                }\n                textPosition.moveToInline(inline.fieldEnd, 1);\n            }\n            currentIndex = textPosition.getHierarchicalIndexInternal();\n        }\n    };\n    /**\n     * Validate if text position is in field backward\n     * @private\n     */\n    TextPosition.prototype.validateBackwardFieldSelection = function (currentIndex, selectionEndIndex) {\n        var textPosition = new TextPosition(this.owner);\n        textPosition.setPositionForCurrentIndex(currentIndex);\n        textPosition.isUpdateLocation = false;\n        var selectionStartIndex = this.selection.start.getHierarchicalIndexInternal();\n        while (currentIndex !== selectionEndIndex && TextPosition.isForwardSelection(selectionEndIndex, currentIndex)) {\n            var indexInInline = 0;\n            var inlineObj = textPosition.currentWidget.getInline(textPosition.offset, indexInInline);\n            var inline = inlineObj.element;\n            indexInInline = inlineObj.index;\n            if (!isNullOrUndefined(inline)) {\n                var nextInline = this.selection.getNextRenderedElementBox(inline, indexInInline);\n                if (nextInline instanceof FieldElementBox && nextInline.fieldType === 0) {\n                    var paragraph = nextInline.fieldEnd.line;\n                    var fieldEndOffset = paragraph.getOffset(nextInline.fieldEnd, 1);\n                    var fieldEndIndex = this.getHierarchicalIndex(paragraph, fieldEndOffset.toString());\n                    if (!TextPosition.isForwardSelection(fieldEndIndex, selectionStartIndex)) {\n                        this.selection.start.setPositionParagraph(paragraph, fieldEndOffset);\n                        selectionStartIndex = fieldEndIndex;\n                    }\n                }\n            }\n            if (inline instanceof FieldElementBox && inline.fieldType === 1 && !isNullOrUndefined(inline.fieldBegin)) {\n                var line = inline.fieldBegin.line;\n                var fieldBegin = inline.fieldBegin;\n                var fieldBeginOffset = line.getOffset(fieldBegin, 0);\n                var fieldBeginIndex = this.getHierarchicalIndex(line, fieldBeginOffset.toString());\n                if (!TextPosition.isForwardSelection(selectionEndIndex, fieldBeginIndex)) {\n                    //If field begin is before selection end, extend selection end to field begin.\n                    this.moveToInline(inline.fieldBegin, 0);\n                    return;\n                }\n                textPosition.moveToInline(inline.fieldBegin, 0);\n            }\n            else {\n                textPosition.movePreviousPosition();\n            }\n            currentIndex = textPosition.getHierarchicalIndexInternal();\n        }\n    };\n    /**\n     * @private\n     */\n    TextPosition.prototype.paragraphStartInternal = function (selection, moveToPreviousParagraph) {\n        var offset = selection.getStartLineOffset(this.currentWidget);\n        if (this.offset === offset && moveToPreviousParagraph) {\n            var startParagraph = this.moveToNextParagraphInTableCheck();\n            if (startParagraph) {\n                this.moveToPreviousParagraphInTable(selection);\n            }\n            else if (!isNullOrUndefined(selection.getPreviousParagraphBlock(this.currentWidget.paragraph))) {\n                var paragraphValue = selection.getPreviousParagraphBlock(this.currentWidget.paragraph);\n                this.currentWidget = paragraphValue.childWidgets[0];\n                this.offset = selection.getStartLineOffset(this.currentWidget);\n            }\n        }\n        else {\n            this.currentWidget = this.currentWidget.paragraph.getSplitWidgets()[0].childWidgets[0];\n            this.offset = offset;\n        }\n        this.calculateOffset();\n    };\n    /**\n     * @private\n     */\n    TextPosition.prototype.calculateOffset = function () {\n        var selectionStartIndex = this.owner.selection.start.getHierarchicalIndexInternal();\n        var selectionEndIndex = this.getHierarchicalIndexInternal();\n        if (selectionStartIndex !== selectionEndIndex) {\n            this.validateBackwardFieldSelection(selectionStartIndex, selectionEndIndex);\n        }\n        this.updatePhysicalPosition(true);\n    };\n    /**\n     * Moves the text position to start of the paragraph.\n     * @private\n     */\n    TextPosition.prototype.moveToParagraphStartInternal = function (selection, moveToPreviousParagraph) {\n        var startOffset = selection.getStartOffset(this.paragraph);\n        if (this.offset === startOffset && moveToPreviousParagraph) {\n            var paragraphstart = this.moveToNextParagraphInTableCheck();\n            if (paragraphstart) {\n                this.moveToPreviousParagraphInTable(selection);\n            }\n            else if (!isNullOrUndefined(selection.getPreviousParagraphBlock(this.paragraph))) {\n                this.currentWidget = selection.getPreviousParagraphBlock(this.paragraph).firstChild;\n                this.offset = selection.getStartOffset(this.paragraph);\n            }\n        }\n        else {\n            this.currentWidget = this.paragraph.firstChild;\n            this.offset = selection.getStartLineOffset(this.currentWidget);\n        }\n        var selectionStartIndex = this.owner.selection.start.getHierarchicalIndexInternal();\n        var selectionEndIndex = this.getHierarchicalIndexInternal();\n        if (selectionStartIndex !== selectionEndIndex) {\n            this.validateBackwardFieldSelection(selectionStartIndex, selectionEndIndex);\n        }\n        this.updatePhysicalPosition(false);\n    };\n    /**\n     * Moves the text position to end of the paragraph.\n     * @private\n     */\n    TextPosition.prototype.moveToParagraphEndInternal = function (selection, moveToNextParagraph) {\n        // tslint:disable-next-line:max-line-length\n        var splittedParagraph = this.currentWidget.paragraph;\n        while (splittedParagraph.nextSplitWidget) {\n            splittedParagraph = splittedParagraph.nextSplitWidget;\n        }\n        this.currentWidget = splittedParagraph.childWidgets[splittedParagraph.childWidgets.length - 1];\n        var endOffset = this.currentWidget.getEndOffset() + 1;\n        if (this.offset === endOffset && moveToNextParagraph) {\n            var paragraphEnd = this.moveToNextParagraphInTableCheck();\n            if (paragraphEnd) {\n                this.moveToNextParagraphInTable();\n            }\n            else if (!isNullOrUndefined(selection.getNextParagraphBlock(this.currentWidget.paragraph))) {\n                var endParagraph = selection.getNextParagraphBlock(this.currentWidget.paragraph);\n                this.currentWidget = endParagraph.childWidgets[endParagraph.childWidgets.length - 1];\n                this.offset = this.currentWidget.getEndOffset() + 1;\n            }\n        }\n        else {\n            this.offset = endOffset;\n        }\n        this.calculateOffset();\n    };\n    /**\n     * @private\n     */\n    TextPosition.prototype.moveUp = function (selection, left) {\n        var paragraph = this.currentWidget.paragraph;\n        //Moves text position to start of line.\n        this.moveToLineStartInternal(selection, true);\n        //Moves previous line starting.\n        this.movePreviousPosition();\n        var prevLine = undefined;\n        var currentParagraph = this.currentWidget.paragraph;\n        if (paragraph.isInsideTable && paragraph !== currentParagraph && paragraph.associatedCell !== currentParagraph.associatedCell\n            // tslint:disable-next-line:max-line-length\n            && (!isNullOrUndefined(currentParagraph.associatedCell) && (paragraph.associatedCell.ownerRow === currentParagraph.associatedCell.ownerRow))) {\n            var ownerRow = currentParagraph.associatedCell.ownerRow;\n            if (ownerRow.previousRenderedWidget instanceof TableRowWidget) {\n                // tslint:disable-next-line:max-line-length\n                var cell = selection.getFirstCellInRegion(ownerRow.previousRenderedWidget, currentParagraph.associatedCell, left, true);\n                var lastParagraph = selection.getLastParagraph(cell);\n                this.setPosition(lastParagraph.childWidgets[lastParagraph.childWidgets.length - 1], false);\n            }\n            else {\n                var prevBlock = ownerRow.ownerTable.previousRenderedWidget;\n                do {\n                    if (prevBlock instanceof TableWidget) {\n                        prevBlock = selection.getLastBlockInLastCell(prevBlock);\n                    }\n                } while (prevBlock instanceof TableWidget);\n                if (prevBlock instanceof ParagraphWidget) {\n                    this.setPosition(prevBlock.childWidgets[prevBlock.childWidgets.length - 1], false);\n                }\n            }\n            prevLine = selection.getLineWidgetParagraph(this.offset, this.currentWidget);\n        }\n        else {\n            if (!paragraph.isInsideTable && this.currentWidget.paragraph.isInsideTable) {\n                // tslint:disable-next-line:max-line-length\n                var cell = selection.getFirstCellInRegion(this.currentWidget.paragraph.associatedCell.ownerRow, this.currentWidget.paragraph.associatedCell, this.owner.selection.upDownSelectionLength, true);\n                var lastParagraph = selection.getLastParagraph(cell);\n                this.setPosition(lastParagraph.childWidgets[lastParagraph.childWidgets.length - 1], false);\n                // tslint:disable-next-line:max-line-length\n            }\n            else if (paragraph.isInsideTable && (!isNullOrUndefined(this.currentWidget.paragraph.associatedCell) && paragraph.associatedCell.ownerRow.previousRenderedWidget !== paragraph.associatedCell.ownerRow.previousSplitWidget &&\n                paragraph.associatedCell.ownerRow.previousRenderedWidget === this.currentWidget.paragraph.associatedCell.ownerRow)) {\n                // tslint:disable-next-line:max-line-length\n                var cell = selection.getLastCellInRegion(this.currentWidget.paragraph.associatedCell.ownerRow, this.currentWidget.paragraph.associatedCell, this.owner.selection.upDownSelectionLength, true);\n                var lastParagraph = selection.getLastParagraph(cell);\n                this.setPosition(lastParagraph.childWidgets[lastParagraph.childWidgets.length - 1], false);\n            }\n            prevLine = selection.getLineWidgetParagraph(this.offset, this.currentWidget);\n        }\n        //Moves till the Up/Down selection width.\n        var top = selection.getTop(prevLine);\n        selection.updateTextPositionWidget(prevLine, new Point(left, top), this, false);\n    };\n    /**\n     * @private\n     */\n    TextPosition.prototype.moveDown = function (selection, left) {\n        //Moves text position to end of line.\n        var prevParagraph = this.currentWidget.paragraph;\n        var prevOffset = this.offset;\n        this.moveToLineEndInternal(selection, true);\n        var length = this.selection.getParagraphLength(this.currentWidget.paragraph);\n        if (this.offset > length) {\n            this.offset = length;\n        }\n        //Moves next line starting.\n        this.moveNextPosition();\n        var nextLine = undefined;\n        // tslint:disable-next-line:max-line-length\n        if (prevParagraph.isInsideTable && prevParagraph !== this.currentWidget.paragraph && prevParagraph.associatedCell !== this.currentWidget.paragraph.associatedCell && (!isNullOrUndefined(this.currentWidget.paragraph.associatedCell) && prevParagraph.associatedCell.ownerRow === this.currentWidget.paragraph.associatedCell.ownerRow)) {\n            var ownerRow = this.currentWidget.paragraph.associatedCell.ownerRow;\n            // tslint:disable-next-line:max-line-length\n            if (prevParagraph.isInsideTable && this.currentWidget.paragraph.isInsideTable && prevParagraph.associatedCell.cellFormat.rowSpan > 1 && prevParagraph.associatedCell.cellFormat.rowSpan + prevParagraph.associatedCell.ownerRow.rowIndex === prevParagraph.associatedCell.ownerTable.childWidgets.length) {\n                //If the prevParagraph  owner cell is Verically merged upto the last row, then theposition moved to next column. the position moved to out of the current tabel so owner row is assigned to last row.\n                // tslint:disable-next-line:max-line-length\n                ownerRow = this.currentWidget.paragraph.associatedCell.ownerTable.childWidgets[this.currentWidget.paragraph.associatedCell.ownerTable.childWidgets.length - 1];\n            }\n            if (ownerRow.nextRenderedWidget instanceof TableRowWidget) {\n                // tslint:disable-next-line:max-line-length\n                var cell = this.selection.getLastCellInRegion(ownerRow.nextRenderedWidget, this.currentWidget.paragraph.associatedCell, left, false);\n                this.setPosition(this.selection.getFirstParagraph(cell).childWidgets[0], true);\n            }\n            else {\n                var nextBlock = this.selection.getNextRenderedBlock(ownerRow.ownerTable);\n                do {\n                    if (nextBlock instanceof TableWidget) {\n                        nextBlock = this.selection.getFirstBlockInFirstCell(nextBlock);\n                    }\n                } while (nextBlock instanceof TableWidget);\n                if (nextBlock instanceof ParagraphWidget) {\n                    this.setPosition(nextBlock.childWidgets[0], true);\n                }\n            }\n            nextLine = selection.getLineWidgetParagraph(this.offset, this.currentWidget);\n        }\n        else {\n            if (!prevParagraph.isInsideTable && this.currentWidget.paragraph.isInsideTable) {\n                // tslint:disable-next-line:max-line-length\n                var cell = this.selection.getLastCellInRegion(this.currentWidget.paragraph.associatedCell.ownerRow, this.currentWidget.paragraph.associatedCell, this.owner.selection.upDownSelectionLength, false);\n                this.setPosition(this.selection.getFirstParagraph(cell).childWidgets[0], true);\n                // tslint:disable-next-line:max-line-length\n            }\n            else if (prevParagraph.isInsideTable && (!isNullOrUndefined(this.currentWidget.paragraph.associatedCell) && prevParagraph.associatedCell.ownerRow.nextRenderedWidget !== prevParagraph.associatedCell.ownerRow.nextSplitWidget\n                && prevParagraph.associatedCell.ownerRow.nextRenderedWidget === this.currentWidget.paragraph.associatedCell.ownerRow)) {\n                // tslint:disable-next-line:max-line-length\n                var cell = selection.getLastCellInRegion(this.currentWidget.paragraph.associatedCell.ownerRow, this.currentWidget.paragraph.associatedCell, this.owner.selection.upDownSelectionLength, true);\n                this.setPosition(selection.getFirstParagraph(cell).childWidgets[0], false);\n            }\n            nextLine = selection.getLineWidgetParagraph(this.offset, this.currentWidget);\n        }\n        //Moves till the Up/Down selection width.\n        var top = this.selection.getTop(nextLine);\n        this.selection.updateTextPositionWidget(nextLine, new Point(left, top), this, false);\n    };\n    /**\n     * Moves the text position to start of the line.\n     * @private\n     */\n    TextPosition.prototype.moveToLineStartInternal = function (selection, moveToPreviousLine) {\n        if (this.location.x > this.viewer.clientActiveArea.right) {\n            this.offset = this.offset - 1;\n        }\n        var currentLine = selection.getLineWidgetInternal(this.currentWidget, this.offset, moveToPreviousLine);\n        var firstElement = selection.getFirstElementInternal(currentLine);\n        var startOffset = selection.getStartOffset(this.currentWidget.paragraph);\n        if (isNullOrUndefined(firstElement) && this.offset > startOffset) {\n            var index = 0;\n            var inlineObj = this.currentWidget.getInline(this.offset, index);\n            var inline = inlineObj.element;\n            index = inlineObj.index;\n            if (inline instanceof TextElementBox && inline.text !== '\\v') {\n                this.offset = startOffset;\n            }\n        }\n        else if (!isNullOrUndefined(firstElement)) {\n            var indexInInline = selection.getIndexInInline(firstElement);\n            this.currentWidget = firstElement.line;\n            this.offset = this.currentWidget.getOffset(firstElement, indexInInline);\n            indexInInline = 0;\n            var inlineObj = this.currentWidget.getInline(this.offset, indexInInline);\n            var inline = inlineObj.element;\n            indexInInline = inlineObj.index;\n            if (inline instanceof FieldElementBox) {\n                //Checks if field character is part of rendered field, otherwise moves to previous rendered content.\n                var prevInline = selection.getPreviousValidElement(inline);\n                if (!isNullOrUndefined(prevInline)) {\n                    inline = prevInline;\n                    this.currentWidget = inline.line;\n                    this.offset = this.currentWidget.getOffset(inline, inline.length);\n                    if (inline instanceof FieldElementBox) {\n                        this.offset--;\n                    }\n                }\n            }\n        }\n        this.updatePhysicalPosition(true);\n    };\n    /**\n     * Check paragraph is inside table\n     * @private\n     */\n    TextPosition.prototype.moveToNextParagraphInTableCheck = function () {\n        if ((this.selection.start.paragraph.isInsideTable || this.paragraph.isInsideTable)\n            && (this.selection.start.paragraph.associatedCell !== this.paragraph.associatedCell\n                || this.selection.isCellSelected(this.selection.start.paragraph.associatedCell, this.selection.start, this))) {\n            return true;\n        }\n        return false;\n    };\n    /**\n     * Moves the text position to end of the word.\n     * @private\n     */\n    TextPosition.prototype.moveToWordEndInternal = function (type, excludeSpace) {\n        // type === 0 -------->CTRL+ARROW Navigation\n        // type === 1 -------->CTRL+SHIFT+ARROW Selection\n        // type === 2 -------->Double-tap Word Selection\n        var incrementValue = 0;\n        var endOffset = this.currentWidget.getEndOffset();\n        if (this.selection.isParagraphFirstLine(this.currentWidget)) {\n            if (this.currentWidget.children[0] instanceof ListTextElementBox) {\n                incrementValue = 1;\n            }\n            if (this.currentWidget.children[1] instanceof ListTextElementBox) {\n                incrementValue = 2;\n            }\n        }\n        if (this.offset + incrementValue === endOffset || this.offset === endOffset + 1) {\n            if (this.offset === endOffset && type !== 0) {\n                this.setPositionParagraph(this.currentWidget, endOffset + 1);\n            }\n            else {\n                var nextParagraph = this.selection.getNextParagraphBlock(this.currentWidget.paragraph);\n                if (isNullOrUndefined(nextParagraph)) {\n                    return;\n                }\n                this.currentWidget = nextParagraph.childWidgets[0];\n                this.offset = this.selection.getStartLineOffset(this.currentWidget);\n                if (type === 1) {\n                    // tslint:disable-next-line:max-line-length\n                    var nextWord = this.moveToNextParagraphInTableCheck();\n                    if (nextWord) {\n                        this.moveToNextParagraphInTable();\n                    }\n                    else {\n                        this.moveToWordEndInternal(type, excludeSpace);\n                    }\n                }\n            }\n        }\n        else {\n            var indexInInline = 0;\n            var endSelection = false;\n            var inlineObj = this.currentWidget.getInline(this.offset, indexInInline);\n            var inline = inlineObj.element;\n            indexInInline = inlineObj.index;\n            this.getNextWordOffset(inline, indexInInline, type, false, endSelection, this, excludeSpace);\n        }\n        if (type !== 0) {\n            var selectionStartIndex = this.owner.selection.start.getHierarchicalIndexInternal();\n            var selectionEndIndex = this.getHierarchicalIndexInternal();\n            if (selectionStartIndex !== selectionEndIndex) {\n                this.validateForwardFieldSelection(selectionStartIndex, selectionEndIndex);\n            }\n        }\n        this.updatePhysicalPosition(true);\n    };\n    /**\n     * move text position to next paragraph inside table\n     * @private\n     */\n    TextPosition.prototype.moveToNextParagraphInTable = function () {\n        var paragraph = this.currentWidget.paragraph;\n        var nextParagraph = (paragraph.isInsideTable) ? this.selection.getNextSelectionCell(paragraph.associatedCell) :\n            this.selection.getNextParagraphBlock(paragraph);\n        if (isNullOrUndefined(nextParagraph)) {\n            return;\n        }\n        this.currentWidget = nextParagraph.childWidgets[nextParagraph.childWidgets.length - 1];\n        this.offset = this.currentWidget.getEndOffset() + 1;\n    };\n    /**\n     * Moves the text position to start of the previous paragraph.\n     */\n    TextPosition.prototype.moveToPreviousParagraph = function (selection) {\n        var startOffset = selection.getStartOffset(this.currentWidget.paragraph);\n        // tslint:disable-next-line:max-line-length\n        if (this.offset === startOffset && !isNullOrUndefined(selection.getPreviousParagraphBlock(this.currentWidget.paragraph))) {\n            var previousParagraph = selection.getPreviousParagraphBlock(this.currentWidget.paragraph);\n            this.currentWidget = previousParagraph.childWidgets[0];\n            this.offset = selection.getStartOffset(this.currentWidget.paragraph);\n        }\n        else {\n            this.offset = selection.getStartOffset(this.currentWidget.paragraph);\n        }\n        this.updatePhysicalPosition(true);\n    };\n    /**\n     * Move to previous line from current position\n     * @private\n     */\n    TextPosition.prototype.moveToPreviousLine = function (selection, left) {\n        var currentIndex = this.getHierarchicalIndexInternal();\n        var currentLine = selection.getLineWidgetParagraph(this.offset, this.currentWidget);\n        //Moves text position to start of line.\n        this.moveToLineStartInternal(selection, true);\n        if (this.currentWidget.paragraph.isInsideTable) {\n            this.moveUpInTable(selection);\n        }\n        else {\n            this.moveBackward();\n        }\n        var prevLine = selection.getLineWidgetParagraph(this.offset, this.currentWidget);\n        var lineStart = selection.getLeft(prevLine);\n        var lineWidth = selection.getWidth(prevLine, true);\n        //Moves till the Up/Down selection width.\n        if (lineWidth + lineStart >= left && currentLine !== prevLine) {\n            var top_1 = selection.getTop(prevLine);\n            var point = new Point(left, top_1);\n            selection.updateTextPositionWidget(prevLine, point, this, true);\n        }\n        //Checks if the current position is between field result, then move to field begin.\n        var selectionEndIndex = this.getHierarchicalIndexInternal();\n        this.validateBackwardFieldSelection(currentIndex, selectionEndIndex);\n    };\n    /**\n     * @private\n     */\n    TextPosition.prototype.moveToLineEndInternal = function (selection, moveToNextLine) {\n        if (this.location.x > this.viewer.clientActiveArea.right) {\n            this.offset = this.offset - 1;\n        }\n        var currentLine = selection.getLineWidgetParagraph(this.offset, this.currentWidget);\n        var firstElement = selection.getFirstElementInternal(currentLine);\n        if (isNullOrUndefined(firstElement) && this.offset === selection.getStartLineOffset(this.currentWidget)) {\n            this.offset = selection.getParagraphLength(this.paragraph) + 1;\n            this.updatePhysicalPosition(true);\n        }\n        else if (!isNullOrUndefined(firstElement)) {\n            var lastElement = currentLine.children[currentLine.children.length - 1];\n            var index = 0;\n            index += lastElement instanceof TextElementBox ? lastElement.length : 1;\n            this.currentWidget = lastElement.line;\n            if (index === lastElement.length\n                && isNullOrUndefined(lastElement.nextNode) && selection.isParagraphLastLine(this.currentWidget)) {\n                var length_1 = selection.getLineLength(this.currentWidget);\n                this.offset = moveToNextLine ? length_1 + 1 : length_1;\n            }\n            else {\n                var inline = lastElement;\n                while (!isNullOrUndefined(inline) && inline.length === index && inline.nextNode instanceof FieldElementBox) {\n                    var nextInline = selection.getNextValidElement(inline.nextNode);\n                    if (inline !== nextInline) {\n                        inline = nextInline;\n                        index = 0;\n                    }\n                    if (inline instanceof FieldElementBox && inline.fieldType === 0\n                        && !isNullOrUndefined(inline.fieldEnd)) {\n                        var fieldBegin = inline;\n                        if (isNullOrUndefined(fieldBegin.fieldSeparator)) {\n                            inline = fieldBegin.fieldEnd;\n                        }\n                        else {\n                            inline = fieldBegin.fieldSeparator;\n                            this.currentWidget = inline.line;\n                            if (this.currentWidget === fieldBegin.fieldEnd.line\n                                && !selection.hasValidInline(this.currentWidget.paragraph, inline, fieldBegin.fieldEnd)) {\n                                inline = fieldBegin.fieldEnd;\n                            }\n                        }\n                        this.currentWidget = inline.line;\n                    }\n                    if (inline instanceof FieldElementBox) {\n                        index = 1;\n                    }\n                }\n                if (index === inline.length && isNullOrUndefined(inline.nextNode)) {\n                    index++;\n                }\n                if (!moveToNextLine && inline instanceof ElementBox && inline.text === '\\v') {\n                    index--;\n                }\n                this.offset = this.currentWidget.getOffset(inline, index);\n            }\n            this.updatePhysicalPosition(moveToNextLine);\n        }\n    };\n    /**\n     * Move to next line\n     * @private\n     */\n    TextPosition.prototype.moveToNextLine = function (left) {\n        var selection = this.selection;\n        var textPosition = new TextPosition(this.owner);\n        textPosition.setPositionInternal(this);\n        var currentIndex = this.getHierarchicalIndexInternal();\n        var currentLine = selection.getLineWidgetParagraph(this.offset, this.currentWidget);\n        var isAtLineStart = this.offset === 0 ? true : false;\n        //Moves text position to end of line.\n        this.moveToLineEndInternal(selection, true);\n        var isMoveToLineEnd = !textPosition.isAtSamePosition(this);\n        textPosition.setPositionInternal(this);\n        if (this.currentWidget.paragraph.isInsideTable) {\n            this.moveDownInTable(selection);\n        }\n        else {\n            this.moveNextPosition();\n            this.moveForward();\n        }\n        var nextLine = selection.getLineWidgetParagraph(this.offset, this.currentWidget);\n        var lineStart = selection.getLeft(nextLine);\n        var firstElement = selection.getFirstElementInternal(nextLine);\n        // tslint:disable-next-line:max-line-length\n        var firstItemWidth = isNullOrUndefined(firstElement) ? selection.getWidth(nextLine, true) : selection.getLeftInternal(nextLine, firstElement, 1) - lineStart;\n        //Moves till the Up/Down selection width.\n        if (lineStart < left && (firstItemWidth / 2 < left - lineStart)) {\n            var top_2 = selection.getTop(nextLine);\n            var point = new Point(left, top_2);\n            selection.updateTextPositionWidget(nextLine, point, this, true);\n            var width = selection.getWidth(nextLine, true);\n            if (width < left - lineStart) {\n                this.moveToLineEndInternal(selection, true);\n            }\n        }\n        else if (isMoveToLineEnd && this.currentWidget.paragraph.isInsideTable\n            && this.currentWidget === this.owner.selection.start.currentWidget) {\n            this.setPositionInternal(textPosition);\n        }\n        else if (!isMoveToLineEnd) {\n            this.moveToLineEndInternal(selection, true);\n        }\n        //Checks if the current position is between field result, then move to field end.\n        var selectionEndIndex = this.getHierarchicalIndexInternal();\n        this.validateForwardFieldSelection(currentIndex, selectionEndIndex);\n    };\n    /**\n     * Move upward in table\n     * @private\n     */\n    TextPosition.prototype.moveUpInTable = function (selection) {\n        var isPositionUpdated = false;\n        var end = this.owner.selection.end;\n        var isBackwardSelection = !this.owner.selection.isEmpty;\n        isPositionUpdated = end.paragraph.isInsideTable;\n        if (isPositionUpdated) {\n            var startCell = this.currentWidget.paragraph.associatedCell;\n            var endCell = end.paragraph.associatedCell;\n            var containerCell = selection.getContainerCellOf(endCell, startCell);\n            isPositionUpdated = containerCell.ownerTable.contains(startCell);\n            if (isPositionUpdated) {\n                endCell = selection.getSelectedCell(endCell, containerCell);\n                startCell = selection.getSelectedCell(startCell, containerCell);\n                // tslint:disable-next-line:max-line-length\n                var isInContainerCell = selection.containsCell(containerCell, this.currentWidget.paragraph.associatedCell);\n                var isContainerCellSelected = selection.isCellSelected(containerCell, this, end);\n                if (!isContainerCellSelected) {\n                    // tslint:disable-next-line:max-line-length\n                    isContainerCellSelected = this.currentWidget.paragraph === selection.getFirstParagraph(containerCell) && this.isAtParagraphStart;\n                }\n                if ((isInContainerCell && isContainerCellSelected\n                    || !isInContainerCell) && !isNullOrUndefined(startCell.ownerRow.previousRenderedWidget)) {\n                    //Moves to cell in previous row.\n                    var row = startCell.ownerRow.previousRenderedWidget;\n                    // tslint:disable-next-line:max-line-length\n                    var cell = selection.getFirstCellInRegion(row, containerCell, this.owner.selection.upDownSelectionLength, true);\n                    var previousParagraph = selection.getLastParagraph(cell);\n                    this.setPosition(previousParagraph.childWidgets[0], true);\n                    return;\n                }\n                else if (isInContainerCell && isContainerCellSelected\n                    && isNullOrUndefined(startCell.ownerRow.previousRenderedWidget) || !isInContainerCell) {\n                    if (isBackwardSelection) {\n                        //Moves to first cell of row.\n                        startCell = startCell.ownerRow.childWidgets[0];\n                        var previousParagraph = selection.getFirstParagraph(startCell);\n                        this.setPosition(previousParagraph.childWidgets[0], true);\n                    }\n                    else {\n                        //Moves to last cell of row.\n                        startCell = startCell.ownerRow.childWidgets[startCell.ownerRow.childWidgets.length - 1];\n                        var previousParagraph = selection.getLastParagraph(startCell);\n                        this.setPosition(previousParagraph.childWidgets[0], false);\n                    }\n                }\n            }\n        }\n        if (!isPositionUpdated) {\n            //Moves to previous row / previous block.\n            var cell = selection.getContainerCell(this.currentWidget.paragraph.associatedCell);\n            if (isBackwardSelection) {\n                //Moves to first cell of row.\n                cell = cell.ownerRow.childWidgets[0];\n                var previousParagraph = selection.getFirstParagraph(cell);\n                this.setPosition(previousParagraph.childWidgets[0], true);\n            }\n            else {\n                //Moves to end of row.\n                cell = cell.ownerRow.childWidgets[cell.ownerRow.childWidgets.length - 1];\n                var previousParagraph = selection.getLastParagraph(cell);\n                this.setPosition(previousParagraph.childWidgets[0], false);\n            }\n        }\n        //Moves to previous row / previous block.\n        this.moveBackward();\n    };\n    /**\n     * Move down inside table\n     * @private\n     */\n    TextPosition.prototype.moveDownInTable = function (selection) {\n        var isPositionUpdated = false;\n        var isForwardSelection = this.owner.selection.isEmpty || this.owner.selection.isForward;\n        isPositionUpdated = this.owner.selection.start.paragraph.isInsideTable;\n        if (isPositionUpdated) {\n            var startCell = this.owner.selection.start.paragraph.associatedCell;\n            var endCell = this.currentWidget.paragraph.associatedCell;\n            var containerCell = selection.getContainerCellOf(startCell, endCell);\n            isPositionUpdated = containerCell.ownerTable.contains(endCell);\n            if (isPositionUpdated) {\n                startCell = selection.getSelectedCell(startCell, containerCell);\n                endCell = selection.getSelectedCell(endCell, containerCell);\n                // tslint:disable-next-line:max-line-length\n                var isInContainerCell = selection.containsCell(containerCell, this.currentWidget.paragraph.associatedCell);\n                var isContainerCellSelected = selection.isCellSelected(containerCell, this.owner.selection.start, this);\n                if ((isInContainerCell && isContainerCellSelected\n                    || !isInContainerCell) && !isNullOrUndefined(endCell.ownerRow.nextRenderedWidget)) {\n                    //Moves to cell in next row.\n                    var row = endCell.ownerRow.nextRenderedWidget;\n                    // tslint:disable-next-line:max-line-length\n                    var cell = selection.getLastCellInRegion(row, containerCell, this.owner.selection.upDownSelectionLength, false);\n                    var lastParagraph = selection.getLastParagraph(cell);\n                    this.setPosition(lastParagraph.childWidgets[lastParagraph.childWidgets.length - 1], false);\n                    return;\n                }\n                else if (isInContainerCell && isContainerCellSelected\n                    && isNullOrUndefined(endCell.ownerRow.nextRenderedWidget) || !isInContainerCell) {\n                    if (isForwardSelection) {\n                        //Moves to last cell of row.\n                        endCell = endCell.ownerRow.childWidgets[endCell.ownerRow.childWidgets.length - 1];\n                        var lastParagraph = selection.getLastParagraph(endCell);\n                        this.setPosition(lastParagraph.childWidgets[lastParagraph.childWidgets.length - 1], false);\n                    }\n                    else {\n                        //Moves to first cell of row.\n                        endCell = endCell.ownerRow.childWidgets[0];\n                        var lastParagraph = selection.getFirstParagraph(endCell);\n                        this.setPosition(lastParagraph.childWidgets[lastParagraph.childWidgets.length - 1], true);\n                    }\n                }\n            }\n        }\n        if (!isPositionUpdated) {\n            //Moves to next row / next block.\n            var cell = selection.getContainerCell(this.currentWidget.paragraph.associatedCell);\n            if (isForwardSelection) {\n                //Moves to end of row.\n                cell = cell.ownerRow.childWidgets[cell.ownerRow.childWidgets.length - 1];\n                var lastParagraph = selection.getLastParagraph(cell);\n                this.setPosition(lastParagraph.childWidgets[lastParagraph.childWidgets.length - 1], false);\n            }\n            else if (cell.ownerRow.nextRenderedWidget) {\n                //Moves to first cell of row.\n                cell = cell.ownerRow.nextRenderedWidget.childWidgets[0];\n                var lastParagraph = selection.getFirstParagraph(cell);\n                this.setPosition(lastParagraph.childWidgets[lastParagraph.childWidgets.length - 1], true);\n            }\n        }\n        //Moves to next row / next block.\n        this.moveForward();\n    };\n    /**\n     * @private\n     */\n    TextPosition.prototype.destroy = function () {\n        this.offset = undefined;\n        this.isUpdateLocation = undefined;\n        if (!isNullOrUndefined(this.location)) {\n            this.location.destroy();\n        }\n        this.location = undefined;\n        this.currentWidget = undefined;\n        this.owner = undefined;\n        this.viewer = undefined;\n    };\n    return TextPosition;\n}());\nexport { TextPosition };\n/**\n * @private\n */\nvar SelectionWidgetInfo = /** @class */ (function () {\n    function SelectionWidgetInfo(left, width) {\n        this.leftIn = 0;\n        this.widthIn = 0;\n        this.leftIn = left;\n        this.widthIn = width;\n    }\n    Object.defineProperty(SelectionWidgetInfo.prototype, \"left\", {\n        /**\n         * @private\n         */\n        get: function () {\n            return this.leftIn;\n        },\n        /**\n         * @private\n         */\n        set: function (value) {\n            this.leftIn = value;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(SelectionWidgetInfo.prototype, \"width\", {\n        /**\n         * @private\n         */\n        get: function () {\n            return this.widthIn;\n        },\n        /**\n         * @private\n         */\n        set: function (value) {\n            this.widthIn = value;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    /**\n     * @private\n     */\n    SelectionWidgetInfo.prototype.destroy = function () {\n        this.widthIn = undefined;\n        this.leftIn = undefined;\n    };\n    return SelectionWidgetInfo;\n}());\nexport { SelectionWidgetInfo };\n/**\n * @private\n */\nvar Hyperlink = /** @class */ (function () {\n    function Hyperlink(fieldBeginAdv, selection) {\n        this.linkInternal = '';\n        this.localRef = '';\n        this.opensNewWindow = false;\n        var fieldCode = selection.getFieldCode(fieldBeginAdv);\n        var lowercase = fieldCode.toLowerCase();\n        if (lowercase.substring(0, 9) === 'hyperlink') {\n            this.parseFieldValues(fieldCode.substring(9).trim(), selection);\n        }\n    }\n    Object.defineProperty(Hyperlink.prototype, \"navigationLink\", {\n        /**\n         * Gets navigation link.\n         * @returns string\n         * @private\n         */\n        get: function () {\n            return this.linkInternal;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(Hyperlink.prototype, \"localReference\", {\n        /**\n         * Gets the local reference if any.\n         * @returns string\n         * @private\n         */\n        get: function () {\n            return this.localRef;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(Hyperlink.prototype, \"linkType\", {\n        /**\n         * Gets hyper link type.\n         * @returns HyperLinkType\n         * @private\n         */\n        get: function () {\n            return this.typeInternal;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    /**\n     * Parse field values\n     * @param  {string} value\n     * @returns Void\n     */\n    Hyperlink.prototype.parseFieldValues = function (value, selection) {\n        var codes = value.split(' ');\n        var isLocalRef = false;\n        for (var i = 0; i < codes.length; i++) {\n            var code = codes[i];\n            if (code.length < 1) {\n                continue;\n            }\n            if (code === '\\\\t' || code === '\\\\l') {\n                isLocalRef = true;\n            }\n            else if (code === '\\\\n') {\n                this.opensNewWindow = true;\n            }\n            else {\n                code = this.parseFieldValue(code, code[0] === '\\\"' ? '\\\"' : undefined);\n                if (isLocalRef) {\n                    this.localRef = code;\n                    isLocalRef = false;\n                }\n                else {\n                    this.linkInternal = code;\n                }\n            }\n        }\n        this.setLinkType();\n    };\n    Hyperlink.prototype.parseFieldValue = function (value, endChar) {\n        value = value.substring(1);\n        var endIndex = endChar ? value.indexOf(endChar) : -1;\n        if (endIndex < 0) {\n            endIndex = value.length;\n        }\n        return value.substring(0, endIndex).trim();\n    };\n    Hyperlink.prototype.setLinkType = function () {\n        // If only local reference.\n        if (isNullOrUndefined(this.linkInternal) || this.linkInternal.length < 1) {\n            this.typeInternal = 'Bookmark';\n            return;\n        }\n        // Validates link.\n        if (this.linkInternal.substring(0, 4) === ('www.')) {\n            this.linkInternal = 'http://' + this.navigationLink;\n        }\n        else if (this.linkInternal[0] === '@') {\n            this.linkInternal = 'mailto:' + this.navigationLink;\n        }\n        // Finds proper link type.\n        if (this.linkInternal.substring(0, 7) === 'http://'\n            || this.linkInternal.substring(0, 8) === 'https://') {\n            this.typeInternal = 'WebPage';\n        }\n        else if (this.linkInternal.substring(0, 7) === 'mailto:') {\n            this.typeInternal = 'Email';\n        }\n        else {\n            this.typeInternal = 'File';\n        }\n    };\n    /**\n     * @private\n     */\n    Hyperlink.prototype.destroy = function () {\n        this.linkInternal = undefined;\n        this.localRef = undefined;\n        this.typeInternal = undefined;\n        this.opensNewWindow = undefined;\n    };\n    return Hyperlink;\n}());\nexport { Hyperlink };\n/**\n * @private\n */\nvar ImageFormat = /** @class */ (function () {\n    /**\n     * Constructor for image format class\n     * @param imageContainer - Specifies for image width and height values.\n     */\n    function ImageFormat(imageContainer) {\n        /**\n         * @private\n         */\n        this.width = 0;\n        /**\n         * @private\n         */\n        this.height = 0;\n        this.width = imageContainer.width;\n        this.height = imageContainer.height;\n    }\n    /**\n     * Dispose the internal objects which are maintained.\n     * @private\n     */\n    ImageFormat.prototype.destroy = function () {\n        this.width = undefined;\n        this.height = undefined;\n    };\n    return ImageFormat;\n}());\nexport { ImageFormat };\n","import { Widget, BodyWidget, TableRowWidget, TableWidget, LineWidget, ElementBox, TextElementBox, ListTextElementBox, ImageElementBox, ParagraphWidget, TableCellWidget, FieldElementBox, BlockWidget, HeaderFooterWidget, BlockContainer, BookmarkElementBox } from '../viewer/page';\nimport { HelperMethods } from '../editor/editor-helper';\nimport { SelectionCharacterFormat, SelectionCellFormat, SelectionParagraphFormat, SelectionRowFormat, SelectionSectionFormat, SelectionTableFormat, SelectionImageFormat } from './selection-format';\nimport { Point } from '../editor/editor-helper';\nimport { isNullOrUndefined, createElement, L10n } from '@syncfusion/ej2-base';\nimport { Dictionary } from '../../base/dictionary';\nimport { WParagraphFormat, WParagraphStyle } from '../index';\nimport { HtmlExport } from '../writer/html-export';\nimport { Popup } from '@syncfusion/ej2-popups';\nimport { TextPosition, SelectionWidgetInfo, Hyperlink } from './selection-helper';\n/**\n * Selection\n */\nvar Selection = /** @class */ (function () {\n    /**\n     * @private\n     */\n    function Selection(documentEditor) {\n        var _this = this;\n        /**\n         * @private\n         */\n        this.upDownSelectionLength = 0;\n        /**\n         * @private\n         */\n        this.isSkipLayouting = false;\n        /**\n         * @private\n         */\n        this.isImageSelected = false;\n        this.contextTypeInternal = undefined;\n        /**\n         * @private\n         */\n        this.caret = undefined;\n        //Format Retrieval Field\n        /**\n         * @private\n         */\n        this.isRetrieveFormatting = false;\n        /**\n         * @private\n         */\n        this.skipFormatRetrieval = false;\n        this.isMoveDownOrMoveUp = false;\n        /**\n         * @private\n         */\n        this.selectedWidgets = undefined;\n        /**\n         * Hides caret.\n         * @private\n         */\n        this.hideCaret = function () {\n            _this.caret.style.display = 'none';\n        };\n        this.owner = documentEditor;\n        this.viewer = this.owner.viewer;\n        this.start = new TextPosition(this.owner);\n        this.end = new TextPosition(this.owner);\n        this.selectedWidgets = new Dictionary();\n        this.characterFormatIn = new SelectionCharacterFormat(this);\n        this.paragraphFormatIn = new SelectionParagraphFormat(this, this.viewer);\n        this.sectionFormatIn = new SelectionSectionFormat(this);\n        this.rowFormatIn = new SelectionRowFormat(this);\n        this.cellFormatIn = new SelectionCellFormat(this);\n        this.tableFormatIn = new SelectionTableFormat(this);\n        this.imageFormatInternal = new SelectionImageFormat(this);\n    }\n    Object.defineProperty(Selection.prototype, \"htmlWriter\", {\n        /**\n         * @private\n         */\n        get: function () {\n            if (isNullOrUndefined(this.htmlWriterIn)) {\n                this.htmlWriterIn = new HtmlExport();\n            }\n            return this.htmlWriterIn;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(Selection.prototype, \"start\", {\n        /**\n         * Gets the start text position of last range in the selection\n         * @returns {TextPosition}\n         * @private\n         */\n        get: function () {\n            if (!isNullOrUndefined(this.owner) && !isNullOrUndefined(this.viewer)) {\n                if (isNullOrUndefined(this.startInternal)) {\n                    this.startInternal = this.owner.documentStart;\n                }\n                return this.startInternal;\n            }\n            return undefined;\n        },\n        /**\n         * @private\n         */\n        set: function (value) {\n            this.startInternal = value;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(Selection.prototype, \"characterFormat\", {\n        //Format retrieval properties\n        /**\n         * Gets the instance of selection character format.\n         * @default undefined\n         * @return {SelectionCharacterFormat}\n         */\n        get: function () {\n            return this.characterFormatIn;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(Selection.prototype, \"paragraphFormat\", {\n        /**\n         * Gets the instance of selection paragraph format.\n         * @default undefined\n         * @return {SelectionParagraphFormat}\n         */\n        get: function () {\n            return this.paragraphFormatIn;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(Selection.prototype, \"sectionFormat\", {\n        /**\n         * Gets the instance of selection section format.\n         * @default undefined\n         * @return {SelectionSectionFormat}\n         */\n        get: function () {\n            return this.sectionFormatIn;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(Selection.prototype, \"tableFormat\", {\n        /**\n         * Gets the instance of selection table format.\n         * @default undefined\n         * @return {SelectionTableFormat}\n         */\n        get: function () {\n            return this.tableFormatIn;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(Selection.prototype, \"cellFormat\", {\n        /**\n         * Gets the instance of selection cell format.\n         * @default undefined\n         * @return {SelectionCellFormat}\n         */\n        get: function () {\n            return this.cellFormatIn;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(Selection.prototype, \"rowFormat\", {\n        /**\n         * Gets the instance of selection row format.\n         * @default undefined\n         * @returns SelectionRowFormat\n         */\n        get: function () {\n            return this.rowFormatIn;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(Selection.prototype, \"imageFormat\", {\n        /**\n         * Gets the instance of selection image format.\n         * @default undefined\n         * @returns SelectionImageFormat\n         */\n        get: function () {\n            return this.imageFormatInternal;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(Selection.prototype, \"end\", {\n        /**\n         * Gets the start text position of selection range.\n         * @private\n         */\n        get: function () {\n            return this.endInternal;\n        },\n        /**\n         * For internal use\n         * @private\n         */\n        set: function (value) {\n            this.endInternal = value;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(Selection.prototype, \"startPage\", {\n        /**\n         * Gets the page number where the selection ends.\n         * @private\n         */\n        get: function () {\n            if (!this.owner.isDocumentLoaded || isNullOrUndefined(this.viewer)\n                || isNullOrUndefined(this.viewer.selectionStartPage)) {\n                return 1;\n            }\n            return this.viewer.pages.indexOf(this.viewer.selectionStartPage) + 1;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(Selection.prototype, \"endPage\", {\n        /**\n         * Gets the page number where the selection ends.\n         * @private\n         */\n        get: function () {\n            if (!this.owner.isDocumentLoaded || isNullOrUndefined(this.viewer)\n                || isNullOrUndefined(this.viewer.selectionEndPage)) {\n                return 1;\n            }\n            return this.viewer.pages.indexOf(this.viewer.selectionEndPage) + 1;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(Selection.prototype, \"isForward\", {\n        /**\n         * Determines whether the selection direction is forward or not.\n         * @default false\n         * @returns {boolean}\n         * @private\n         */\n        get: function () {\n            return this.start.isExistBefore(this.end);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(Selection.prototype, \"isEmpty\", {\n        /**\n         * Determines whether the start and end positions are same or not.\n         * @default false\n         * @returns {boolean}\n         * @private\n         */\n        get: function () {\n            if (isNullOrUndefined(this.start)) {\n                return true;\n            }\n            return this.start.isAtSamePosition(this.end);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(Selection.prototype, \"text\", {\n        /**\n         * Gets the text within selection.\n         * @default ''\n         * @returns {string}\n         */\n        get: function () {\n            return this.getText(false);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(Selection.prototype, \"contextType\", {\n        /**\n         * Gets the context type of the selection.\n         */\n        get: function () {\n            return this.contextTypeInternal;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(Selection.prototype, \"isCleared\", {\n        /**\n         * @private\n         */\n        get: function () {\n            return isNullOrUndefined(this.end);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Selection.prototype.getModuleName = function () {\n        return 'Selection';\n    };\n    //Public API\n    /**\n     * Moves the selection to the header of current page.\n     */\n    Selection.prototype.goToHeader = function () {\n        this.owner.enableHeaderAndFooter = true;\n        this.enableHeadersFootersRegion(this.start.paragraph.bodyWidget.page.headerWidget);\n    };\n    /**\n     * Moves the selection to the footer of current page.\n     */\n    Selection.prototype.goToFooter = function () {\n        this.owner.enableHeaderAndFooter = true;\n        this.enableHeadersFootersRegion(this.start.paragraph.bodyWidget.page.footerWidget);\n    };\n    /**\n     * Closes the header and footer region.\n     */\n    Selection.prototype.closeHeaderFooter = function () {\n        this.disableHeaderFooter();\n    };\n    /**\n     * Moves the selection to the start of specified page number.\n     */\n    Selection.prototype.goToPage = function (pageNumber) {\n        if (pageNumber >= 1 && pageNumber <= this.viewer.pages.length) {\n            var page = this.viewer.pages[pageNumber - 1];\n            this.updateTextPositionForBlockContainer(page.bodyWidgets[0]);\n        }\n    };\n    /**\n     * Selects the entire table if the context is within table.\n     */\n    Selection.prototype.selectTable = function () {\n        if (!this.owner.enableSelection) {\n            return;\n        }\n        this.selectTableInternal();\n    };\n    /**\n     * Selects the entire row if the context is within table.\n     */\n    Selection.prototype.selectRow = function () {\n        if (!this.owner.enableSelection) {\n            return;\n        }\n        this.selectTableRow();\n    };\n    /**\n     * Selects the entire column if the context is within table.\n     */\n    Selection.prototype.selectColumn = function () {\n        if (!this.owner.enableSelection) {\n            return;\n        }\n        this.selectColumnInternal();\n    };\n    /**\n     * Selects the entire cell if the context is within table.\n     */\n    Selection.prototype.selectCell = function () {\n        if (!this.owner.enableSelection) {\n            return;\n        }\n        this.selectTableCell();\n    };\n    /**\n     * Select content based on selection settings\n     */\n    Selection.prototype.select = function (selectionSettings) {\n        var point = new Point(selectionSettings.x, selectionSettings.y);\n        var pageCoordinates = this.viewer.findFocusedPage(point, true);\n        if (selectionSettings.extend) {\n            this.moveTextPosition(pageCoordinates, this.end);\n        }\n        else {\n            this.viewer.updateTextPositionForSelection(pageCoordinates, 1);\n        }\n    };\n    /**\n     * Toggles the bold property of selected contents.\n     * @private\n     */\n    Selection.prototype.toggleBold = function () {\n        if (this.owner.editorModule) {\n            this.owner.editorModule.toggleBold();\n        }\n    };\n    /**\n     * Toggles the italic property of selected contents.\n     * @private\n     */\n    Selection.prototype.toggleItalic = function () {\n        if (this.owner.editorModule) {\n            this.owner.editorModule.toggleItalic();\n        }\n    };\n    /**\n     * Toggles the underline property of selected contents.\n     * @param underline Default value of ‘underline’ parameter is Single.\n     * @private\n     */\n    Selection.prototype.toggleUnderline = function (underline) {\n        if (this.owner.editor) {\n            this.owner.editor.toggleUnderline(underline);\n        }\n    };\n    /**\n     * Toggles the strike through property of selected contents.\n     * @param {Strikethrough} strikethrough Default value of strikethrough parameter is SingleStrike.\n     * @private\n     */\n    Selection.prototype.toggleStrikethrough = function (strikethrough) {\n        if (this.owner.editor) {\n            this.owner.editor.toggleStrikethrough(strikethrough);\n        }\n    };\n    /**\n     * Toggles the highlight color property of selected contents.\n     * @param {HighlightColor} highlightColor Default value of ‘underline’ parameter is Yellow.\n     * @private\n     */\n    Selection.prototype.toggleHighlightColor = function (highlightColor) {\n        if (this.owner.editor) {\n            this.owner.editor.toggleHighlightColor(highlightColor);\n        }\n    };\n    /**\n     * Toggles the subscript formatting of selected contents.\n     * @private\n     */\n    Selection.prototype.toggleSubscript = function () {\n        if (this.owner.editor) {\n            this.owner.editor.toggleSubscript();\n        }\n    };\n    /**\n     * Toggles the superscript formatting of selected contents.\n     * @private\n     */\n    Selection.prototype.toggleSuperscript = function () {\n        if (this.owner.editor) {\n            this.owner.editor.toggleSuperscript();\n        }\n    };\n    /**\n     * Toggles the text alignment property of selected contents.\n     * @param {TextAlignment} textAlignment Default value of ‘textAlignment parameter is TextAlignment.Left.\n     * @private\n     */\n    Selection.prototype.toggleTextAlignment = function (textAlignment) {\n        if (this.owner.editor) {\n            this.owner.editor.toggleTextAlignment(textAlignment);\n        }\n    };\n    /**\n     * Increases the left indent of selected paragraphs to a factor of 36 points.\n     * @private\n     */\n    Selection.prototype.increaseIndent = function () {\n        if (this.owner.editor) {\n            this.owner.editor.increaseIndent();\n        }\n    };\n    /**\n     * Decreases the left indent of selected paragraphs to a factor of 36 points.\n     * @private\n     */\n    Selection.prototype.decreaseIndent = function () {\n        if (this.owner.editor) {\n            this.owner.editor.decreaseIndent();\n        }\n    };\n    /**\n     * Fires the `requestNavigate` event if current selection context is in hyperlink.\n     */\n    Selection.prototype.navigateHyperlink = function () {\n        var fieldBegin = this.getHyperlinkField();\n        if (fieldBegin) {\n            this.fireRequestNavigate(fieldBegin);\n        }\n    };\n    /**\n     * Navigate Hyperlink\n     * @param fieldBegin\n     * @private\n     */\n    Selection.prototype.fireRequestNavigate = function (fieldBegin) {\n        var hyperlink = new Hyperlink(fieldBegin, this);\n        var eventArgs = {\n            isHandled: false,\n            navigationLink: hyperlink.navigationLink,\n            linkType: hyperlink.linkType,\n            localReference: hyperlink.localReference,\n            source: this.owner\n        };\n        this.owner.trigger('requestNavigate', eventArgs);\n        if (!eventArgs.isHandled) {\n            this.viewer.selection.navigateBookmark(hyperlink.localReference, true);\n        }\n    };\n    /**\n     * Copies the hyperlink URL if the context is within hyperlink.\n     */\n    Selection.prototype.copyHyperlink = function () {\n        var hyperLinkField = this.getHyperlinkField();\n        var linkText = this.getLinkText(hyperLinkField);\n        this.copyToClipboard(linkText);\n    };\n    //Selection add, Highlight, remove API starts\n    /**\n     * @private\n     */\n    Selection.prototype.highlightSelection = function (isSelectionChanged) {\n        if (this.owner.enableImageResizerMode) {\n            this.owner.imageResizerModule.hideImageResizer();\n        }\n        if (this.isEmpty) {\n            this.updateCaretPosition();\n        }\n        else {\n            if (this.isForward) {\n                this.highlightSelectedContent(this.start, this.end);\n            }\n            else {\n                this.highlightSelectedContent(this.end, this.start);\n            }\n        }\n        this.viewer.updateTouchMarkPosition();\n        if (isSelectionChanged) {\n            this.viewer.scrollToPosition(this.start, this.end);\n        }\n    };\n    /**\n     * @private\n     */\n    Selection.prototype.createHighlightBorder = function (lineWidget, width, left, top) {\n        if (width < 0) {\n            width = 0;\n        }\n        var page = this.getPage(lineWidget.paragraph);\n        var height = lineWidget.height;\n        var selectionWidget = undefined;\n        if (!this.selectedWidgets.containsKey(lineWidget)) {\n            selectionWidget = new SelectionWidgetInfo(left, width);\n            this.selectedWidgets.add(lineWidget, selectionWidget);\n        }\n        var viewer = this.viewer;\n        var pageTop = this.getPageTop(page);\n        var pageLeft = page.boundingRectangle.x;\n        if (viewer.containerTop <= pageTop\n            || pageTop < viewer.containerTop + viewer.selectionCanvas.height) {\n            viewer.selectionContext.fillStyle = 'gray';\n            viewer.selectionContext.globalAlpha = 0.4;\n            var zoomFactor = viewer.zoomFactor;\n            this.clipSelection(page, pageTop);\n            // tslint:disable-next-line:max-line-length\n            viewer.selectionContext.fillRect((pageLeft + (left * zoomFactor)) - viewer.containerLeft, (pageTop + (top * zoomFactor)) - viewer.containerTop, width * zoomFactor, height * zoomFactor);\n            viewer.selectionContext.restore();\n        }\n    };\n    /**\n     * Create selection highlight inside table\n     * @private\n     */\n    Selection.prototype.createHighlightBorderInsideTable = function (cellWidget) {\n        var page = this.getPage(cellWidget);\n        var selectionWidget = undefined;\n        var left = cellWidget.x - cellWidget.margin.left + cellWidget.leftBorderWidth;\n        var width = cellWidget.width + cellWidget.margin.left\n            + cellWidget.margin.right - cellWidget.leftBorderWidth - cellWidget.rightBorderWidth;\n        var top = cellWidget.y;\n        var height = cellWidget.height;\n        var pageTop = this.getPageTop(page);\n        var pageLeft = page.boundingRectangle.x;\n        var isVisiblePage = this.viewer.containerTop <= pageTop\n            || pageTop < this.viewer.containerTop + this.viewer.selectionCanvas.height;\n        if (this.selectedWidgets.containsKey(cellWidget)) {\n            selectionWidget = this.selectedWidgets.get(cellWidget);\n            if (isVisiblePage) {\n                // tslint:disable-next-line:max-line-length\n                this.viewer.selectionContext.clearRect((pageLeft + (selectionWidget.left * this.viewer.zoomFactor) - this.viewer.containerLeft), (pageTop + (top * this.viewer.zoomFactor)) - this.viewer.containerTop, selectionWidget.width * this.viewer.zoomFactor, height * this.viewer.zoomFactor);\n            }\n        }\n        selectionWidget = new SelectionWidgetInfo(left, width);\n        this.selectedWidgets.add(cellWidget, selectionWidget);\n        if (isVisiblePage) {\n            this.viewer.selectionContext.fillStyle = 'gray';\n            this.viewer.selectionContext.globalAlpha = 0.4;\n            var zoomFactor = this.viewer.zoomFactor;\n            this.clipSelection(page, pageTop);\n            // tslint:disable-next-line:max-line-length\n            this.viewer.selectionContext.fillRect((pageLeft + (left * zoomFactor)) - this.viewer.containerLeft, (pageTop + (top * zoomFactor)) - this.viewer.containerTop, width * zoomFactor, height * zoomFactor);\n            this.viewer.selectionContext.restore();\n        }\n    };\n    /**\n     * @private\n     */\n    Selection.prototype.clipSelection = function (page, pageTop) {\n        var viewer = this.viewer;\n        var width = page.boundingRectangle.width * viewer.zoomFactor;\n        var height = page.boundingRectangle.height * viewer.zoomFactor;\n        var left = page.boundingRectangle.x;\n        viewer.selectionContext.beginPath();\n        viewer.selectionContext.save();\n        viewer.selectionContext.rect(left - viewer.containerLeft, pageTop - viewer.containerTop, width, height);\n        viewer.selectionContext.clip();\n    };\n    /**\n     * Add selection highlight\n     * @private\n     */\n    Selection.prototype.addSelectionHighlight = function (canvasContext, widget, top) {\n        if (this.selectedWidgets.containsKey(widget)) {\n            var height = this.viewer.render.getScaledValue(widget.height);\n            var widgetInfo = this.selectedWidgets.get(widget);\n            var width = this.viewer.render.getScaledValue(widgetInfo.width);\n            var left = this.viewer.render.getScaledValue(widgetInfo.left, 1);\n            canvasContext.fillStyle = 'gray';\n            var page = this.owner.selection.getPage(widget.paragraph);\n            this.owner.selection.clipSelection(page, this.owner.selection.getPageTop(page));\n            canvasContext.fillRect(left, this.viewer.render.getScaledValue(top, 2), width, height);\n            canvasContext.restore();\n        }\n    };\n    /**\n     * Add Selection highlight inside table\n     * @private\n     */\n    Selection.prototype.addSelectionHighlightTable = function (canvasContext, tableCellWidget) {\n        if (this.selectedWidgets.containsKey(tableCellWidget)) {\n            var selectionWidget = this.selectedWidgets.get(tableCellWidget);\n            var left = this.viewer.render.getScaledValue(selectionWidget.left, 1);\n            var top_1 = this.viewer.render.getScaledValue(tableCellWidget.y, 2);\n            var width = this.viewer.render.getScaledValue(selectionWidget.width);\n            var height = this.viewer.render.getScaledValue(tableCellWidget.height);\n            canvasContext.fillStyle = 'gray';\n            var page = this.owner.selection.getPage(tableCellWidget);\n            this.owner.selection.clipSelection(page, this.owner.selection.getPageTop(page));\n            canvasContext.fillRect(left, top_1, width, height);\n            canvasContext.restore();\n        }\n    };\n    /**\n     * Remove Selection highlight\n     * @private\n     */\n    Selection.prototype.removeSelectionHighlight = function (widget) {\n        var left = 0;\n        var top = 0;\n        var width = 0;\n        var height = 0;\n        var page = undefined;\n        if (widget instanceof LineWidget) {\n            var lineWidget = widget;\n            var currentParaWidget = lineWidget.paragraph;\n            page = !isNullOrUndefined(currentParaWidget) ?\n                this.getPage((lineWidget.paragraph)) : undefined;\n            if (isNullOrUndefined(page)) {\n                return;\n            }\n            top = this.getTop(lineWidget);\n            height = lineWidget.height;\n        }\n        else if (widget instanceof TableCellWidget) {\n            page = !isNullOrUndefined(widget) ?\n                this.getPage(widget) : undefined;\n            if (isNullOrUndefined(page)) {\n                return;\n            }\n            top = widget.y;\n            height = widget.height;\n        }\n        if (isNullOrUndefined(page)) {\n            return;\n        }\n        var widgetInfo = this.selectedWidgets.get(widget);\n        width = widgetInfo.width;\n        left = widgetInfo.left;\n        var pageRect = page.boundingRectangle;\n        var pageIndex = this.viewer.pages.indexOf(page);\n        var pageGap = this.viewer.pageGap;\n        var pageTop = (pageRect.y - pageGap * (pageIndex + 1)) * this.viewer.zoomFactor + pageGap * (pageIndex + 1);\n        var pageLeft = pageRect.x;\n        var zoomFactor = this.viewer.zoomFactor;\n        if (this.viewer.containerTop <= pageTop\n            || pageTop < this.viewer.containerTop + this.viewer.selectionCanvas.height) {\n            // tslint:disable-next-line:max-line-length\n            this.viewer.selectionContext.clearRect((pageLeft + (left * zoomFactor) - this.viewer.containerLeft) - 0.5, (pageTop + (top * zoomFactor)) - this.viewer.containerTop - 0.5, width * zoomFactor + 0.5, height * zoomFactor + 0.5);\n        }\n    };\n    /**\n     * Select Current word\n     * @private\n     */\n    Selection.prototype.selectCurrentWord = function () {\n        var startPosition = this.start.clone();\n        var endPosition = this.end.clone();\n        this.selectCurrentWordRange(startPosition, endPosition, false);\n        this.selectRange(startPosition, endPosition);\n    };\n    /**\n     * Select current paragraph\n     * @private\n     */\n    Selection.prototype.selectCurrentParagraph = function () {\n        if (!isNullOrUndefined(this.start)) {\n            this.start.paragraphStartInternal(this, false);\n            this.end.moveToParagraphEndInternal(this, false);\n            this.upDownSelectionLength = this.end.location.x;\n            this.fireSelectionChanged(true);\n        }\n    };\n    /**\n     * Select current word range\n     * @private\n     */\n    Selection.prototype.selectCurrentWordRange = function (startPosition, endPosition, excludeSpace) {\n        if (!isNullOrUndefined(startPosition)) {\n            if (startPosition.offset > 0) {\n                var wordStart = startPosition.clone();\n                var indexInInline = 0;\n                var inlineObj = startPosition.currentWidget.getInline(startPosition.offset, indexInInline);\n                var inline = inlineObj.element;\n                indexInInline = inlineObj.index;\n                if (!isNullOrUndefined(inline) && inline instanceof FieldElementBox && inline.fieldType === 1) {\n                    // tslint:disable-next-line:max-line-length\n                    if (startPosition.offset > 2 && (!isNullOrUndefined(inline.fieldSeparator) || isNullOrUndefined(inline.fieldBegin))) {\n                        wordStart.setPositionParagraph(wordStart.currentWidget, startPosition.offset - 2);\n                        wordStart.moveToWordEndInternal(0, false);\n                        if (!(wordStart.paragraph === startPosition.paragraph && wordStart.offset === startPosition.offset - 1)) {\n                            startPosition.moveToWordStartInternal(2);\n                        }\n                    }\n                    else if (startPosition.offset > 3 && isNullOrUndefined(inline.fieldSeparator)) {\n                        wordStart.setPositionParagraph(wordStart.currentWidget, startPosition.offset - 3);\n                        wordStart.moveToWordEndInternal(0, false);\n                        if (!(wordStart.paragraph === startPosition.paragraph && wordStart.offset === startPosition.offset)) {\n                            startPosition.moveToWordStartInternal(2);\n                        }\n                    }\n                }\n                else {\n                    wordStart.setPositionParagraph(wordStart.currentWidget, startPosition.offset - 1);\n                    wordStart.moveToWordEndInternal(0, false);\n                    if (!(wordStart.paragraph === startPosition.paragraph && wordStart.offset === startPosition.offset)) {\n                        startPosition.moveToWordStartInternal(2);\n                    }\n                }\n            }\n            endPosition.moveToWordEndInternal(2, excludeSpace);\n        }\n    };\n    /**\n     * Extend selection to paragraph start\n     * @private\n     */\n    Selection.prototype.extendToParagraphStart = function () {\n        if (isNullOrUndefined(this.start)) {\n            return;\n        }\n        this.end.paragraphStartInternal(this, true);\n        this.upDownSelectionLength = this.end.location.x;\n        this.fireSelectionChanged(true);\n    };\n    /**\n     * Extend selection to paragraph end\n     * @private\n     */\n    Selection.prototype.extendToParagraphEnd = function () {\n        if (isNullOrUndefined(this.start)) {\n            return;\n        }\n        this.end.moveToParagraphEndInternal(this, true);\n        this.upDownSelectionLength = this.end.location.x;\n        this.fireSelectionChanged(true);\n    };\n    /**\n     * Move to next text position\n     * @private\n     */\n    Selection.prototype.moveNextPosition = function () {\n        if (isNullOrUndefined(this.start)) {\n            return;\n        }\n        if (this.isEmpty) {\n            this.start.moveNextPosition();\n            this.end.setPositionInternal(this.start);\n        }\n        this.updateForwardSelection();\n        this.upDownSelectionLength = this.start.location.x;\n        this.fireSelectionChanged(true);\n    };\n    /**\n     * Move to next paragraph\n     * @private\n     */\n    Selection.prototype.moveToNextParagraph = function () {\n        if (isNullOrUndefined(this.start)) {\n            return;\n        }\n        this.end.moveToNextParagraphStartInternal();\n        this.start.setPositionInternal(this.end);\n        this.upDownSelectionLength = this.end.location.x;\n        this.fireSelectionChanged(true);\n    };\n    /**\n     * Move to previous text position\n     * @private\n     */\n    Selection.prototype.movePreviousPosition = function () {\n        if (isNullOrUndefined(this.start)) {\n            return;\n        }\n        if (this.isEmpty) {\n            this.start.movePreviousPosition();\n            this.end.setPositionInternal(this.start);\n        }\n        this.updateBackwardSelection();\n        this.upDownSelectionLength = this.start.location.x;\n        this.fireSelectionChanged(true);\n    };\n    /**\n     * Move to previous paragraph\n     * @private\n     */\n    Selection.prototype.moveToPreviousParagraph = function () {\n        if (isNullOrUndefined(this.start)) {\n            return;\n        }\n        this.end.moveToPreviousParagraph(this);\n        this.start.setPositionInternal(this.end);\n        this.upDownSelectionLength = this.end.location.x;\n        this.fireSelectionChanged(true);\n    };\n    /**\n     * Extend selection to previous line\n     * @private\n     */\n    Selection.prototype.extendToPreviousLine = function () {\n        if (isNullOrUndefined(this.start)) {\n            return;\n        }\n        this.end.moveToPreviousLine(this, this.upDownSelectionLength);\n        this.fireSelectionChanged(true);\n    };\n    /**\n     * Extend selection to line end\n     * @private\n     */\n    Selection.prototype.extendToLineEnd = function () {\n        if (isNullOrUndefined(this.start)) {\n            return;\n        }\n        this.end.moveToLineEndInternal(this, true);\n        this.upDownSelectionLength = this.end.location.x;\n        this.fireSelectionChanged(true);\n    };\n    /**\n     * Extend to line start\n     * @private\n     */\n    Selection.prototype.extendToLineStart = function () {\n        if (isNullOrUndefined(this.start)) {\n            return;\n        }\n        this.end.moveToLineStartInternal(this, true);\n        this.upDownSelectionLength = this.end.location.x;\n        this.fireSelectionChanged(true);\n    };\n    /**\n     * @private\n     */\n    Selection.prototype.moveUp = function () {\n        if (isNullOrUndefined(this.start)) {\n            return;\n        }\n        if (!this.isEmpty) {\n            if (this.isForward) {\n                this.end.setPositionInternal(this.start);\n            }\n            else {\n                this.start.setPositionInternal(this.end);\n            }\n            this.upDownSelectionLength = this.start.location.x;\n        }\n        this.upDownSelectionLength = this.start.location.x;\n        this.start.moveUp(this, this.upDownSelectionLength);\n        this.end.setPositionInternal(this.start);\n        this.fireSelectionChanged(true);\n    };\n    /**\n     * @private\n     */\n    Selection.prototype.moveDown = function () {\n        if (isNullOrUndefined(this.start)) {\n            return;\n        }\n        if (!this.isEmpty) {\n            if (this.isForward) {\n                this.start.setPositionInternal(this.end);\n            }\n            else {\n                this.end.setPositionInternal(this.start);\n            }\n            this.upDownSelectionLength = this.start.location.x;\n        }\n        this.start.moveDown(this, this.upDownSelectionLength);\n        this.end.setPositionInternal(this.start);\n        this.fireSelectionChanged(true);\n    };\n    Selection.prototype.updateForwardSelection = function () {\n        if (!this.isEmpty) {\n            if (this.isForward) {\n                this.start.setPositionInternal(this.end);\n            }\n            else {\n                this.end.setPositionInternal(this.start);\n            }\n        }\n    };\n    Selection.prototype.updateBackwardSelection = function () {\n        if (!this.isEmpty) {\n            if (this.isForward) {\n                this.end.setPositionInternal(this.start);\n            }\n            else {\n                this.start.setPositionInternal(this.end);\n            }\n        }\n    };\n    /**\n     * @private\n     */\n    Selection.prototype.getFirstBlockInFirstCell = function (table) {\n        if (table.childWidgets.length > 0) {\n            var firstrow = table.childWidgets[0];\n            if (firstrow.childWidgets.length > 0) {\n                var firstcell = firstrow.childWidgets[0];\n                if (firstcell.childWidgets.length === 0) {\n                    return undefined;\n                }\n                return firstcell.childWidgets[0];\n            }\n        }\n        return undefined;\n    };\n    /**\n     * @private\n     */\n    // tslint:disable-next-line:max-line-length\n    Selection.prototype.getFirstCellInRegion = function (row, startCell, selectionLength, isMovePrevious) {\n        var cellStart = this.getCellLeft(row, startCell);\n        var cellEnd = cellStart + startCell.cellFormat.cellWidth;\n        var flag = true;\n        if (cellStart <= selectionLength && selectionLength < cellEnd) {\n            for (var k = 0; k < row.childWidgets.length; k++) {\n                var left = this.getCellLeft(row, row.childWidgets[k]);\n                if (HelperMethods.round(cellStart, 2) <= HelperMethods.round(left, 2) &&\n                    HelperMethods.round(left, 2) < HelperMethods.round(cellEnd, 2)) {\n                    flag = false;\n                    return row.childWidgets[k];\n                }\n            }\n        }\n        else {\n            for (var j = 0; j < row.childWidgets.length; j++) {\n                var cellLeft = this.getCellLeft(row, row.childWidgets[j]);\n                if (cellLeft <= selectionLength && cellLeft +\n                    row.childWidgets[j].cellFormat.cellWidth > selectionLength) {\n                    flag = false;\n                    return row.childWidgets[j];\n                }\n            }\n        }\n        if (flag) {\n            if (!isNullOrUndefined(row.previousRenderedWidget) && isMovePrevious) {\n                var previousWidget = row.previousRenderedWidget;\n                return this.getFirstCellInRegion(previousWidget, startCell, selectionLength, isMovePrevious);\n            }\n            else if (!isNullOrUndefined(row.nextRenderedWidget) && !isMovePrevious) {\n                return this.getFirstCellInRegion(row.nextRenderedWidget, startCell, selectionLength, isMovePrevious);\n            }\n        }\n        return row.childWidgets[0];\n    };\n    /**\n     * @private\n     */\n    Selection.prototype.getFirstParagraph = function (tableCell) {\n        while (tableCell.previousSplitWidget) {\n            tableCell = tableCell.previousSplitWidget;\n        }\n        var firstBlock = tableCell.firstChild;\n        return this.getFirstParagraphBlock(firstBlock);\n    };\n    /**\n     * Get last block in last cell\n     * @private\n     */\n    //Table\n    Selection.prototype.getLastBlockInLastCell = function (table) {\n        if (table.childWidgets.length > 0) {\n            var lastrow = table.childWidgets[table.childWidgets.length - 1];\n            var lastcell = lastrow.childWidgets[lastrow.childWidgets.length - 1];\n            return lastcell.childWidgets[lastcell.childWidgets.length - 1];\n        }\n        return undefined;\n    };\n    /**\n     * Move to line start\n     * @private\n     */\n    Selection.prototype.moveToLineStart = function () {\n        if (isNullOrUndefined(this.start)) {\n            return;\n        }\n        this.updateBackwardSelection();\n        this.start.moveToLineStartInternal(this, false);\n        this.end.setPositionInternal(this.start);\n        this.upDownSelectionLength = this.start.location.x;\n        this.fireSelectionChanged(true);\n    };\n    /**\n     * Move to line end\n     * @private\n     */\n    Selection.prototype.moveToLineEnd = function () {\n        if (isNullOrUndefined(this.start)) {\n            return;\n        }\n        this.updateForwardSelection();\n        this.start.moveToLineEndInternal(this, false);\n        this.end.setPositionInternal(this.start);\n        this.upDownSelectionLength = this.start.location.x;\n        this.fireSelectionChanged(true);\n    };\n    /**\n     * Get Page top\n     * @private\n     */\n    Selection.prototype.getPageTop = function (page) {\n        // tslint:disable-next-line:max-line-length\n        return (page.boundingRectangle.y - this.viewer.pageGap * (this.viewer.pages.indexOf(page) + 1)) * this.viewer.zoomFactor + this.viewer.pageGap * (this.viewer.pages.indexOf(page) + 1);\n    };\n    /**\n     * Move text position to cursor point\n     * @private\n     */\n    Selection.prototype.moveTextPosition = function (cursorPoint, textPosition) {\n        if (isNullOrUndefined(this.start)) {\n            return;\n        }\n        //Updates the text position based on the cursor position.\n        var widget = this.viewer.getLineWidgetInternal(cursorPoint, true);\n        if (!isNullOrUndefined(widget)) {\n            this.updateTextPositionWidget(widget, cursorPoint, textPosition, true);\n        }\n        this.upDownSelectionLength = textPosition.location.x;\n        var selectionStartIndex = this.start.getHierarchicalIndexInternal();\n        var selectionEndIndex = this.end.getHierarchicalIndexInternal();\n        if (selectionStartIndex !== selectionEndIndex) {\n            // Extends selection end to field begin or field end.\n            if (TextPosition.isForwardSelection(selectionStartIndex, selectionEndIndex)) {\n                textPosition.validateForwardFieldSelection(selectionStartIndex, selectionEndIndex);\n            }\n            else {\n                textPosition.validateBackwardFieldSelection(selectionStartIndex, selectionEndIndex);\n            }\n        }\n        this.fireSelectionChanged(true);\n    };\n    //Helper Method Implementation \n    //Document\n    /**\n     * Get document start position\n     * @private\n     */\n    Selection.prototype.getDocumentStart = function () {\n        var textPosition = undefined;\n        var block = this.viewer.pages[0].bodyWidgets[0].childWidgets[0];\n        return this.setPositionForBlock(block, true);\n    };\n    /**\n     * Get document end position\n     * @private\n     */\n    Selection.prototype.getDocumentEnd = function () {\n        var textPosition = undefined;\n        var documentStart = this.owner.documentStart;\n        var lastPage = this.viewer.pages[this.viewer.pages.length - 1];\n        if (!isNullOrUndefined(documentStart) && lastPage.bodyWidgets[0].childWidgets.length > 0) {\n            var block = undefined;\n            var section = lastPage.bodyWidgets[0];\n            var blocks = section.childWidgets;\n            var lastBlkItem = blocks.length - 1;\n            var lastBlock = blocks[lastBlkItem];\n            if (lastBlock instanceof BlockWidget) {\n                block = lastBlock;\n            }\n            textPosition = this.setPositionForBlock(block, false);\n        }\n        return textPosition;\n    };\n    //Keyboard shortcut internal API\n    /**\n     * @private\n     * Handles control end key.\n     */\n    Selection.prototype.handleControlEndKey = function () {\n        var documentEnd = undefined;\n        if (!isNullOrUndefined(this.owner.documentEnd)) {\n            documentEnd = this.owner.documentEnd;\n        }\n        if (!isNullOrUndefined(documentEnd)) {\n            this.owner.selection.selectContent(documentEnd, true);\n        }\n        this.checkForCursorVisibility();\n    };\n    /**\n     * @private\n     * Handles control home key.\n     */\n    Selection.prototype.handleControlHomeKey = function () {\n        var documentStart = undefined;\n        if (!isNullOrUndefined(this.owner.documentStart)) {\n            documentStart = this.owner.documentStart;\n        }\n        if (!isNullOrUndefined(documentStart)) {\n            this.owner.selection.selectContent(documentStart, true);\n        }\n        this.checkForCursorVisibility();\n    };\n    /**\n     * @private\n     * Handles control left key.\n     */\n    Selection.prototype.handleControlLeftKey = function () {\n        this.extendToWordStart(true);\n        this.checkForCursorVisibility();\n    };\n    /**\n     * @private\n     * Handles control right key.\n     */\n    Selection.prototype.handleControlRightKey = function () {\n        this.extendToWordEnd(true);\n        this.checkForCursorVisibility();\n    };\n    /**\n     * Handles control down key.\n     * @private\n     */\n    Selection.prototype.handleControlDownKey = function () {\n        this.moveToNextParagraph();\n        this.checkForCursorVisibility();\n    };\n    /**\n     * Handles control up key.\n     * @private\n     */\n    Selection.prototype.handleControlUpKey = function () {\n        this.moveToPreviousParagraph();\n        this.checkForCursorVisibility();\n    };\n    /**\n     * @private\n     * Handles shift left key.\n     */\n    Selection.prototype.handleShiftLeftKey = function () {\n        this.extendBackward();\n        this.checkForCursorVisibility();\n    };\n    /**\n     * Handles shift up key.\n     * @private\n     */\n    Selection.prototype.handleShiftUpKey = function () {\n        this.extendToPreviousLine();\n        this.checkForCursorVisibility();\n    };\n    /**\n     * Handles shift right key.\n     * @private\n     */\n    Selection.prototype.handleShiftRightKey = function () {\n        this.extendForward();\n        this.checkForCursorVisibility();\n    };\n    /**\n     * Handles shift down key.\n     * @private\n     */\n    Selection.prototype.handleShiftDownKey = function () {\n        this.extendToNextLine();\n        this.checkForCursorVisibility();\n    };\n    /**\n     * @private\n     * Handles control shift left key.\n     */\n    Selection.prototype.handleControlShiftLeftKey = function () {\n        this.extendToWordStart(false);\n        this.checkForCursorVisibility();\n    };\n    /**\n     * Handles control shift up key.\n     * @private\n     */\n    Selection.prototype.handleControlShiftUpKey = function () {\n        this.extendToParagraphStart();\n        this.checkForCursorVisibility();\n    };\n    /**\n     * Handles control shift right key\n     * @private\n     */\n    Selection.prototype.handleControlShiftRightKey = function () {\n        this.extendToWordEnd(false);\n        this.checkForCursorVisibility();\n    };\n    /**\n     * Handles control shift down key.\n     * @private\n     */\n    Selection.prototype.handleControlShiftDownKey = function () {\n        this.extendToParagraphEnd();\n        this.checkForCursorVisibility();\n    };\n    /**\n     * Handles left key.\n     * @private\n     */\n    Selection.prototype.handleLeftKey = function () {\n        this.movePreviousPosition();\n        this.checkForCursorVisibility();\n    };\n    /**\n     * Handles up key.\n     * @private\n     */\n    Selection.prototype.handleUpKey = function () {\n        this.isMoveDownOrMoveUp = true;\n        this.moveUp();\n        this.isMoveDownOrMoveUp = false;\n        this.checkForCursorVisibility();\n    };\n    /**\n     * Handles right key.\n     * @private\n     */\n    Selection.prototype.handleRightKey = function () {\n        this.moveNextPosition();\n        this.checkForCursorVisibility();\n    };\n    /**\n     * Handles end key.\n     * @private\n     */\n    Selection.prototype.handleEndKey = function () {\n        this.moveToLineEnd();\n        this.checkForCursorVisibility();\n    };\n    /**\n     * Handles home key.\n     * @private\n     */\n    Selection.prototype.handleHomeKey = function () {\n        this.moveToLineStart();\n        this.checkForCursorVisibility();\n    };\n    /**\n     * Handles down key.\n     * @private\n     */\n    Selection.prototype.handleDownKey = function () {\n        this.isMoveDownOrMoveUp = true;\n        this.moveDown();\n        this.isMoveDownOrMoveUp = false;\n        this.checkForCursorVisibility();\n    };\n    /**\n     * Handles shift end key.\n     * @private\n     */\n    Selection.prototype.handleShiftEndKey = function () {\n        this.extendToLineEnd();\n        this.checkForCursorVisibility();\n    };\n    /**\n     * Handles shift home key.\n     * @private\n     */\n    Selection.prototype.handleShiftHomeKey = function () {\n        this.extendToLineStart();\n        this.checkForCursorVisibility();\n    };\n    /**\n     * Handles control shift end key.\n     * @private\n     */\n    Selection.prototype.handleControlShiftEndKey = function () {\n        var documentEnd = undefined;\n        if (!isNullOrUndefined(this.owner.documentEnd)) {\n            documentEnd = this.owner.documentEnd;\n        }\n        if (!isNullOrUndefined(documentEnd)) {\n            this.end.setPosition(documentEnd.currentWidget, false);\n            this.fireSelectionChanged(true);\n        }\n        this.checkForCursorVisibility();\n    };\n    /**\n     * Handles control shift home key.\n     * @private\n     */\n    Selection.prototype.handleControlShiftHomeKey = function () {\n        var documentStart = undefined;\n        if (!isNullOrUndefined(this.owner.documentStart)) {\n            documentStart = this.owner.documentStart;\n        }\n        if (!isNullOrUndefined(documentStart)) {\n            this.end.setPositionInternal(documentStart);\n            this.fireSelectionChanged(true);\n        }\n        this.checkForCursorVisibility();\n    };\n    /**\n     * Handles tab key.\n     * @param isNavigateInCell\n     * @param isShiftTab\n     * @private\n     */\n    Selection.prototype.handleTabKey = function (isNavigateInCell, isShiftTab) {\n        var start = this.start;\n        if (isNullOrUndefined(start)) {\n            return;\n        }\n        if (start.paragraph.isInsideTable && this.end.paragraph.isInsideTable && (isNavigateInCell || isShiftTab)) {\n            //Perform tab navigation\n            if (isShiftTab) {\n                this.selectPreviousCell();\n            }\n            else {\n                this.selectNextCell();\n            }\n        }\n        else if ((isNavigateInCell || isShiftTab) && !isNullOrUndefined(start) && start.offset === this.getStartOffset(start.paragraph)\n            && !isNullOrUndefined(start.paragraph.paragraphFormat) && !isNullOrUndefined(start.paragraph.paragraphFormat.listFormat)\n            && start.paragraph.paragraphFormat.listFormat.listId !== -1 && !this.owner.isReadOnlyMode) {\n            this.owner.editorModule.updateListLevel(isShiftTab ? false : true);\n        }\n        else if (!this.owner.isReadOnlyMode) {\n            this.owner.editorModule.handleTextInput('\\t');\n        }\n        this.checkForCursorVisibility();\n    };\n    Selection.prototype.selectPreviousCell = function () {\n        var tableCell = this.start.paragraph.associatedCell;\n        var tableRow = tableCell.ownerRow;\n        var tableAdv = tableRow.ownerTable;\n        if (isNullOrUndefined(tableCell.previousWidget)) {\n            if (!isNullOrUndefined(tableRow.previousRenderedWidget)) {\n                //Move text selection or cursor to previous row's last cell\n                var prevRow = undefined;\n                if (tableRow.previousRenderedWidget instanceof TableRowWidget) {\n                    prevRow = tableRow.previousRenderedWidget;\n                }\n                this.selectTableCellInternal(prevRow.childWidgets[prevRow.childWidgets.length - 1], true);\n            }\n        }\n        else {\n            //Move text selection or cursor to next cell in current row\n            var prevCell = undefined;\n            if (tableCell.previousWidget instanceof TableCellWidget) {\n                prevCell = tableCell.previousWidget;\n            }\n            this.selectTableCellInternal(prevCell, true);\n        }\n    };\n    Selection.prototype.selectNextCell = function () {\n        var tableCell = this.start.paragraph.associatedCell;\n        var tableRow = tableCell.ownerRow;\n        var tableAdv = tableRow.ownerTable;\n        if (isNullOrUndefined(tableCell.nextWidget)) {\n            if (isNullOrUndefined(tableRow.nextRenderedWidget) && !this.owner.isReadOnlyMode) {\n                //Insert new row below                  \n                this.owner.editorModule.insertRow(false);\n            }\n            else {\n                //Move text selection or cursor to next row's first cell\n                var nextRow = undefined;\n                if (tableRow.nextRenderedWidget instanceof TableRowWidget) {\n                    nextRow = tableRow.nextRenderedWidget;\n                }\n                this.selectTableCellInternal(nextRow.childWidgets[0], true);\n            }\n            // }\n        }\n        else {\n            //Move text selection or cursor to next cell in current row\n            var nextCell = undefined;\n            if (tableCell.nextRenderedWidget instanceof TableCellWidget) {\n                nextCell = tableCell.nextRenderedWidget;\n            }\n            this.selectTableCellInternal(nextCell, true);\n        }\n    };\n    /**\n     * Select given table cell\n     * @private\n     */\n    Selection.prototype.selectTableCellInternal = function (tableCell, clearMultiSelection) {\n        var firstParagraph = this.getFirstParagraph(tableCell);\n        var lastParagraph = this.getLastParagraph(tableCell);\n        if (firstParagraph === lastParagraph && lastParagraph.isEmpty()) {\n            this.selectParagraph(lastParagraph, true);\n        }\n        else {\n            var firstLineWidget = lastParagraph.childWidgets[0];\n            this.start.setPosition(firstParagraph.childWidgets[0], true);\n            this.end.setPositionParagraph(firstLineWidget, firstLineWidget.getEndOffset());\n            this.fireSelectionChanged(true);\n        }\n    };\n    /**\n     * Select while table\n     * @private\n     */\n    Selection.prototype.selectTableInternal = function () {\n        var start = this.start;\n        var end = this.end;\n        if (!this.isForward) {\n            start = this.end;\n            end = this.start;\n        }\n        if (!isNullOrUndefined(start) && !isNullOrUndefined(end) && !isNullOrUndefined(this.getTable(start, end))) {\n            var containerCell = this.getContainerCellOf(start.paragraph.associatedCell, end.paragraph.associatedCell);\n            var table = containerCell.ownerTable;\n            var firstPara = this.getFirstParagraphBlock(table);\n            var lastPara = this.getLastParagraphBlock(table);\n            var offset = lastPara.lastChild.getEndOffset();\n            this.start.setPosition(firstPara.childWidgets[0], true);\n            this.end.setPositionParagraph(lastPara.lastChild, offset + 1);\n        }\n        this.selectPosition(this.start, this.end);\n    };\n    /**\n     * Select single column\n     * @private\n     */\n    Selection.prototype.selectColumnInternal = function () {\n        var startTextPos = this.start;\n        var endTextPos = this.end;\n        if (!this.isForward) {\n            startTextPos = this.end;\n            endTextPos = this.start;\n        }\n        // tslint:disable-next-line:max-line-length\n        if (!isNullOrUndefined(startTextPos) && !isNullOrUndefined(endTextPos) && !isNullOrUndefined(this.getTable(startTextPos, endTextPos))) {\n            var containerCell = this.getContainerCellOf(startTextPos.paragraph.associatedCell, endTextPos.paragraph.associatedCell);\n            if (containerCell.ownerTable.contains(endTextPos.paragraph.associatedCell)) {\n                var startCell = this.getSelectedCell(startTextPos.paragraph.associatedCell, containerCell);\n                var endCell = this.getSelectedCell(endTextPos.paragraph.associatedCell, containerCell);\n                if (this.containsCell(containerCell, endTextPos.paragraph.associatedCell)) {\n                    var row = startCell.ownerRow;\n                    var columnCells = containerCell.ownerTable.getColumnCellsForSelection(containerCell, containerCell);\n                    if (columnCells.length > 0) {\n                        var firstPara = this.getFirstParagraph(columnCells[0]);\n                        var lastPara = this.getLastParagraph(columnCells[columnCells.length - 1]);\n                        this.start.setPosition(firstPara.firstChild, true);\n                        var lastLine = lastPara.lastChild;\n                        this.end.setPositionParagraph(lastLine, lastLine.getEndOffset() + 1);\n                    }\n                }\n                else {\n                    var startCellColumnCells = containerCell.ownerTable.getColumnCellsForSelection(startCell, startCell);\n                    var endCellColumnCells = containerCell.ownerTable.getColumnCellsForSelection(endCell, endCell);\n                    if (startCellColumnCells.length > 0 && endCellColumnCells.length > 0) {\n                        var firstPara = this.getFirstParagraph(startCellColumnCells[0]);\n                        // tslint:disable-next-line:max-line-length\n                        var lastPara = this.getLastParagraph(endCellColumnCells[endCellColumnCells.length - 1]);\n                        this.start.setPosition(firstPara.firstChild, true);\n                        var lastLine = lastPara.lastChild;\n                        this.end.setPositionParagraph(lastLine, lastLine.getEndOffset() + 1);\n                    }\n                }\n            }\n        }\n        this.selectPosition(this.start, this.end);\n    };\n    /**\n     * Select single row\n     * @private\n     */\n    Selection.prototype.selectTableRow = function () {\n        var startPos = this.start;\n        var endPos = this.end;\n        if (!this.isForward) {\n            startPos = this.end;\n            endPos = this.start;\n        }\n        if (!isNullOrUndefined(startPos) && !isNullOrUndefined(endPos) && !isNullOrUndefined(this.getTable(startPos, endPos))) {\n            var containerCell = void 0;\n            containerCell = this.getContainerCellOf(startPos.paragraph.associatedCell, endPos.paragraph.associatedCell);\n            if (containerCell.ownerTable.contains(endPos.paragraph.associatedCell)) {\n                var startCell = this.getSelectedCell(startPos.paragraph.associatedCell, containerCell);\n                var endCell = this.getSelectedCell(endPos.paragraph.associatedCell, containerCell);\n                if (this.containsCell(containerCell, endPos.paragraph.associatedCell)) {\n                    var row = startCell.ownerRow;\n                    var firstPara = this.getFirstParagraph(row.childWidgets[0]);\n                    var lastPara = this.getLastParagraph(row.childWidgets[row.childWidgets.length - 1]);\n                    this.start.setPosition(firstPara.firstChild, true);\n                    this.end.setPositionParagraph(lastPara.lastChild, lastPara.lastChild.getEndOffset() + 1);\n                }\n                else {\n                    var firstPara = this.getFirstParagraph(startCell.ownerRow.childWidgets[0]);\n                    var lastPara = void 0;\n                    // tslint:disable-next-line:max-line-length\n                    lastPara = this.getLastParagraph(endCell.ownerRow.childWidgets[endCell.ownerRow.childWidgets.length - 1]);\n                    this.start.setPosition(firstPara.firstChild, true);\n                    this.end.setPositionParagraph(lastPara.lastChild, lastPara.lastChild.getEndOffset() + 1);\n                }\n            }\n        }\n        this.selectPosition(this.start, this.end);\n    };\n    /**\n     * Select single cell\n     * @private\n     */\n    Selection.prototype.selectTableCell = function () {\n        var start = this.start;\n        var end = this.end;\n        if (!this.isForward) {\n            start = this.end;\n            end = this.start;\n        }\n        if (isNullOrUndefined(this.getTable(start, end))) {\n            return;\n        }\n        if (this.isEmpty) {\n            if (start.paragraph.isInsideTable && !isNullOrUndefined(start.paragraph.associatedCell)) {\n                var firstPara = this.getFirstParagraph(start.paragraph.associatedCell);\n                var lastPara = this.getLastParagraph(end.paragraph.associatedCell);\n                if (firstPara === lastPara) {\n                    this.start.setPosition(lastPara.firstChild, true);\n                    this.end.setPositionParagraph(lastPara.lastChild, lastPara.lastChild.getEndOffset() + 1);\n                }\n                else {\n                    this.start.setPosition(firstPara.firstChild, true);\n                    this.end.setPositionParagraph(lastPara.lastChild, lastPara.lastChild.getEndOffset() + 1);\n                }\n            }\n        }\n        else {\n            var containerCell = this.getContainerCell(start.paragraph.associatedCell);\n            // tslint:disable-next-line:max-line-length\n            if (this.containsCell(containerCell, start.paragraph.associatedCell) && this.containsCell(containerCell, end.paragraph.associatedCell)) {\n                var firstPara = this.getFirstParagraph(containerCell);\n                var lastPara = this.getLastParagraph(containerCell);\n                if (!isNullOrUndefined(firstPara) && !isNullOrUndefined(lastPara)) {\n                    this.start.setPosition(firstPara.firstChild, true);\n                    this.end.setPositionParagraph(lastPara.lastChild, lastPara.lastChild.getEndOffset() + 1);\n                }\n            }\n        }\n        this.selectPosition(this.start, this.end);\n    };\n    /**\n     * @private\n     * Selects the entire document.\n     */\n    Selection.prototype.selectAll = function () {\n        var documentStart;\n        var documentEnd;\n        if (this.owner.enableHeaderAndFooter) {\n            var headerFooter = this.getContainerWidget(this.start.paragraph);\n            documentStart = this.setPositionForBlock(headerFooter.firstChild, true);\n            documentEnd = this.setPositionForBlock(headerFooter.lastChild, false);\n        }\n        else {\n            documentStart = this.owner.documentStart;\n            documentEnd = this.owner.documentEnd;\n        }\n        //Selects the entire document.        \n        if (!isNullOrUndefined(documentStart)) {\n            this.start.setPositionInternal(documentStart);\n            this.end.setPositionParagraph(documentEnd.currentWidget, documentEnd.offset + 1);\n            this.upDownSelectionLength = this.end.location.x;\n            this.fireSelectionChanged(true);\n        }\n    };\n    /**\n     * Extend selection backward\n     * @private\n     */\n    Selection.prototype.extendBackward = function () {\n        if (isNullOrUndefined(this.start)) {\n            return;\n        }\n        this.end.moveBackward();\n        this.upDownSelectionLength = this.end.location.x;\n        this.fireSelectionChanged(true);\n    };\n    /**\n     * Extent selection forward\n     * @private\n     */\n    Selection.prototype.extendForward = function () {\n        if (isNullOrUndefined(this.start)) {\n            return;\n        }\n        this.end.moveForward();\n        this.upDownSelectionLength = this.end.location.x;\n        this.fireSelectionChanged(true);\n    };\n    /**\n     * Extend selection to word start and end\n     * @private\n     */\n    Selection.prototype.extendToWordStartEnd = function () {\n        if ((this.start.paragraph.isInsideTable || this.end.paragraph.isInsideTable)\n            && (this.start.paragraph.associatedCell !== this.end.paragraph.associatedCell\n                || this.isCellSelected(this.start.paragraph.associatedCell, this.start, this.end))) {\n            return true;\n        }\n        return false;\n    };\n    /**\n     * Extend selection to word start\n     * @private\n     */\n    Selection.prototype.extendToWordStart = function (isNavigation) {\n        if (isNullOrUndefined(this.start)) {\n            return;\n        }\n        var isCellSelected = this.extendToWordStartEnd();\n        if (isCellSelected) {\n            this.end.moveToPreviousParagraphInTable(this);\n        }\n        else {\n            this.end.moveToWordStartInternal(isNavigation ? 0 : 1);\n        }\n        if (isNavigation) {\n            this.start.setPositionInternal(this.end);\n        }\n        this.upDownSelectionLength = this.end.location.x;\n        this.fireSelectionChanged(true);\n    };\n    /**\n     * Extent selection to word end\n     * @private\n     */\n    Selection.prototype.extendToWordEnd = function (isNavigation) {\n        if (isNullOrUndefined(this.start)) {\n            return;\n        }\n        var isCellSelect = this.extendToWordStartEnd();\n        if (isCellSelect) {\n            this.end.moveToNextParagraphInTable();\n        }\n        else {\n            this.end.moveToWordEndInternal(isNavigation ? 0 : 1, false);\n        }\n        if (isNavigation) {\n            this.start.setPositionInternal(this.end);\n        }\n        this.upDownSelectionLength = this.end.location.x;\n        this.fireSelectionChanged(true);\n    };\n    /**\n     * Extend selection to next line\n     * @private\n     */\n    Selection.prototype.extendToNextLine = function () {\n        if (isNullOrUndefined(this.start)) {\n            return;\n        }\n        this.end.moveToNextLine(this.upDownSelectionLength);\n        this.fireSelectionChanged(true);\n    };\n    //Selection Text get API\n    //Selection add, Highlight, remove API enda\n    Selection.prototype.getTextPosition = function (hierarchicalIndex) {\n        var textPosition = new TextPosition(this.owner);\n        textPosition.setPositionForCurrentIndex(hierarchicalIndex);\n        return textPosition;\n    };\n    /**\n     * Get Selected text\n     * @private\n     */\n    Selection.prototype.getText = function (includeObject) {\n        if (isNullOrUndefined(this.start) || isNullOrUndefined(this.end)\n            || isNullOrUndefined(this.start.paragraph) || isNullOrUndefined(this.end.paragraph)) {\n            return undefined;\n        }\n        var startPosition = this.start;\n        var endPosition = this.end;\n        if (startPosition.isAtSamePosition(endPosition)) {\n            return '';\n        }\n        return this.getTextInternal(startPosition, endPosition, includeObject);\n    };\n    /**\n     * Get selected text\n     * @private\n     */\n    Selection.prototype.getTextInternal = function (start, end, includeObject) {\n        if (start.isExistAfter(end)) {\n            var temp = end;\n            end = start;\n            start = temp;\n        }\n        var startPosition = start;\n        var endPosition = end;\n        // tslint:disable-next-line:max-line-length\n        if (!isNullOrUndefined(start) && !isNullOrUndefined(end) && !isNullOrUndefined(start.paragraph) && !isNullOrUndefined(end.paragraph)) {\n            var startIndex = 0;\n            var endIndex = 0;\n            var startOffset = start.offset;\n            var endOffset = end.offset;\n            var startInlineObj = start.currentWidget.getInline(startOffset, startIndex);\n            startIndex = startInlineObj.index;\n            var inline = startInlineObj.element;\n            // If the start position is at the beginning of field begin that has field end, then field code should be skipped.\n            if (inline instanceof FieldElementBox && !isNullOrUndefined(inline.fieldEnd)) {\n                var elementInfo = this.getRenderedInline(inline, startIndex);\n                inline = elementInfo.element;\n                startIndex = elementInfo.index;\n            }\n            var endInlineObj = end.currentWidget.getInline(endOffset, endIndex);\n            var endInline = endInlineObj.element;\n            endIndex = endInlineObj.index;\n            var text = '';\n            // Retrieves the text from start inline.\n            if (inline instanceof ImageElementBox && includeObject && startIndex === 0) {\n                text = ElementBox.objectCharacter;\n            }\n            else if (inline instanceof TextElementBox) {\n                // tslint:disable-next-line:max-line-length\n                text = ((isNullOrUndefined(inline.text)) || (inline.text) === '') || inline.text.length < startIndex ? text : inline.text.substring(startIndex);\n            }\n            if (startPosition.paragraph === endPosition.paragraph) {\n                if (inline instanceof ElementBox) {\n                    if (inline === endInline && inline instanceof TextElementBox) {\n                        text = text.length < endIndex - startIndex ? text : text.substring(0, endIndex - startIndex);\n                    }\n                    else if (inline.nextNode instanceof ElementBox) {\n                        // tslint:disable-next-line:max-line-length\n                        text = text + this.getTextInline(inline.nextNode, endPosition.paragraph, endInline, endIndex, includeObject);\n                    }\n                }\n            }\n            else {\n                if (inline instanceof ElementBox && inline.nextNode instanceof ElementBox) {\n                    text = text + this.getTextInline(inline.nextNode, endPosition.paragraph, undefined, 0, includeObject);\n                }\n                else {\n                    // tslint:disable-next-line:max-line-length\n                    var nextParagraphWidget = this.viewer.selection.getNextParagraphBlock(startPosition.paragraph);\n                    text = text + '\\r';\n                    while (!isNullOrUndefined(nextParagraphWidget) && nextParagraphWidget.isEmpty()) {\n                        text = text + '\\r';\n                        if (nextParagraphWidget === endPosition.paragraph) {\n                            return text;\n                        }\n                        nextParagraphWidget = this.viewer.selection.getNextParagraphBlock(nextParagraphWidget);\n                    }\n                    if (!isNullOrUndefined(nextParagraphWidget) && !nextParagraphWidget.isEmpty()) {\n                        // tslint:disable-next-line:max-line-length\n                        text = text + this.getTextInline(nextParagraphWidget.childWidgets[0].children[0], endPosition.paragraph, endInline, endIndex, includeObject);\n                    }\n                }\n            }\n            // If the selection includes end paragraph mark.\n            if (endOffset === (endPosition.currentWidget).getEndOffset() + 1) {\n                text = text + '\\r';\n            }\n            return text;\n        }\n        return undefined;\n    };\n    /**\n     * @private\n     */\n    // tslint:disable-next-line:max-line-length\n    Selection.prototype.getTextInline = function (inlineElement, endParagraphWidget, endInline, endIndex, includeObject) {\n        var text = '';\n        do {\n            if (inlineElement === endInline) {\n                if (inlineElement instanceof TextElementBox) {\n                    var span = inlineElement;\n                    if (!(isNullOrUndefined(span.text) || span.text === '')) {\n                        if (span.text.length < endIndex) {\n                            text = text + span.text;\n                        }\n                        else {\n                            text = text + span.text.substring(0, endIndex);\n                        }\n                    }\n                    // tslint:disable-next-line:max-line-length\n                }\n                else if (inlineElement instanceof ImageElementBox && includeObject && endIndex === inlineElement.length) {\n                    text = text + ElementBox.objectCharacter;\n                }\n                return text;\n            }\n            if (inlineElement instanceof TextElementBox) {\n                text = text + inlineElement.text;\n            }\n            else if (inlineElement instanceof ImageElementBox && includeObject) {\n                text = text + ElementBox.objectCharacter;\n            }\n            else if (inlineElement instanceof FieldElementBox && !isNullOrUndefined(inlineElement.fieldEnd)) {\n                if (!isNullOrUndefined(inlineElement.fieldSeparator)) {\n                    inlineElement = inlineElement.fieldSeparator;\n                }\n                else {\n                    inlineElement = inlineElement.fieldEnd;\n                }\n            }\n            if (isNullOrUndefined(inlineElement.nextNode)) {\n                break;\n            }\n            inlineElement = inlineElement.nextNode;\n        } while (!isNullOrUndefined(inlineElement));\n        if (endParagraphWidget === inlineElement.line.paragraph) {\n            return text;\n        }\n        // tslint:disable-next-line:max-line-length\n        var nextParagraphWidget = this.viewer.selection.getNextParagraphBlock(inlineElement.line.paragraph);\n        while (!isNullOrUndefined(nextParagraphWidget) && nextParagraphWidget.isEmpty()) {\n            text = text + '\\r';\n            if (nextParagraphWidget === endParagraphWidget) {\n                return text;\n            }\n            nextParagraphWidget = this.viewer.selection.getNextParagraphBlock(nextParagraphWidget);\n        }\n        if (!isNullOrUndefined(nextParagraphWidget) && !nextParagraphWidget.isEmpty()) {\n            var lineWidget = nextParagraphWidget.childWidgets[0];\n            // tslint:disable-next-line:max-line-length\n            text = text + '\\r' + this.getTextInline(lineWidget.children[0], endParagraphWidget, endInline, endIndex, includeObject);\n        }\n        return text;\n    };\n    /**\n     * Returns field code.\n     * @private\n     * @param fieldBegin\n     */\n    Selection.prototype.getFieldCode = function (fieldBegin) {\n        var fieldCode = '';\n        if (!(fieldBegin.fieldEnd instanceof FieldElementBox)) {\n            return fieldCode;\n        }\n        var paragraph = fieldBegin.paragraph;\n        var endParagraph = fieldBegin.fieldEnd.paragraph;\n        if (fieldBegin.fieldSeparator instanceof FieldElementBox) {\n            endParagraph = fieldBegin.fieldSeparator.paragraph;\n        }\n        var startLineIndex = fieldBegin.line.indexInOwner;\n        var startIndex = fieldBegin.indexInOwner;\n        do {\n            fieldCode += this.getFieldCodeInternal(paragraph, startLineIndex, startIndex);\n            if (paragraph === endParagraph) {\n                break;\n            }\n            paragraph = this.getNextParagraphBlock(paragraph);\n            startLineIndex = 0;\n            startIndex = 0;\n        } while (paragraph instanceof ParagraphWidget);\n        return fieldCode.trim();\n    };\n    Selection.prototype.getFieldCodeInternal = function (paragraph, startLineIndex, inlineIndex) {\n        var fieldCode = '';\n        for (var i = startLineIndex; i < paragraph.childWidgets.length; i++) {\n            var line = paragraph.childWidgets[i];\n            for (var i_1 = inlineIndex; i_1 < line.children.length; i_1++) {\n                var element = line.children[i_1];\n                if (element instanceof TextElementBox) {\n                    fieldCode += element.text;\n                }\n                if (element instanceof FieldElementBox\n                    && (element.fieldType === 2 || element.fieldType === 1)) {\n                    return fieldCode;\n                }\n            }\n            inlineIndex = 0;\n        }\n        return fieldCode;\n    };\n    /**\n     * @private\n     */\n    Selection.prototype.getTocFieldInternal = function () {\n        var paragraph = this.start.paragraph;\n        if (!this.isEmpty && !this.isForward) {\n            paragraph = this.end.paragraph;\n        }\n        while (paragraph instanceof ParagraphWidget && paragraph.childWidgets.length > 0) {\n            var line = paragraph.firstChild;\n            if (line.children.length > 0) {\n                var element = line.children[0];\n                var nextElement = element.nextNode;\n                if (element instanceof FieldElementBox && element.fieldType === 0 && nextElement instanceof TextElementBox\n                    && nextElement.text.trim().toLowerCase().indexOf('toc') === 0) {\n                    return element;\n                }\n            }\n            paragraph = paragraph.previousRenderedWidget;\n        }\n        return undefined;\n    };\n    /**\n     * Get next paragraph in bodyWidget\n     * @private\n     */\n    Selection.prototype.getNextParagraph = function (section) {\n        if (section.nextRenderedWidget instanceof BodyWidget) {\n            var block = section.nextRenderedWidget.childWidgets[0];\n            return this.getFirstParagraphBlock(block);\n        }\n        return undefined;\n    };\n    /**\n     * @private\n     */\n    Selection.prototype.getPreviousParagraph = function (section) {\n        if (section.previousRenderedWidget instanceof BodyWidget) {\n            var bodyWidget = section.previousRenderedWidget;\n            var block = bodyWidget.childWidgets[bodyWidget.childWidgets.length - 1];\n            return this.getLastParagraphBlock(block);\n        }\n        return undefined;\n    };\n    /**\n     * Get first paragraph in cell\n     * @private\n     */\n    Selection.prototype.getFirstParagraphInCell = function (cell) {\n        var firstBlock = cell.childWidgets[0];\n        if (firstBlock instanceof ParagraphWidget) {\n            return firstBlock;\n        }\n        else {\n            return this.getFirstParagraphInFirstCell(firstBlock);\n        }\n    };\n    /**\n     * Get first paragraph in first cell\n     * @private\n     */\n    Selection.prototype.getFirstParagraphInFirstCell = function (table) {\n        if (table.childWidgets.length > 0) {\n            var firstRow = table.childWidgets[0];\n            var cell = firstRow.childWidgets[0];\n            var block = cell.childWidgets[0];\n            return this.getFirstParagraphBlock(block);\n        }\n        return undefined;\n    };\n    /**\n     * Get last paragraph in last cell\n     * @private\n     */\n    Selection.prototype.getLastParagraphInLastCell = function (table) {\n        if (table.childWidgets.length > 0) {\n            var lastrow = table.lastChild;\n            var lastcell = lastrow.lastChild;\n            var lastBlock = lastcell.lastChild;\n            return this.getLastParagraphBlock(lastBlock);\n        }\n        return undefined;\n    };\n    /**\n     * Get last paragraph in first row\n     * @private\n     */\n    Selection.prototype.getLastParagraphInFirstRow = function (table) {\n        if (table.childWidgets.length > 0) {\n            var row = table.firstChild;\n            var lastcell = row.lastChild;\n            var lastBlock = lastcell.lastChild;\n            return this.getLastParagraphBlock(lastBlock);\n        }\n        return undefined;\n    };\n    /**\n     * Get Next start inline\n     * @private\n     */\n    Selection.prototype.getNextStartInline = function (line, offset) {\n        var indexInInline = 0;\n        var inlineObj = line.getInline(offset, indexInInline);\n        var inline = inlineObj.element;\n        indexInInline = inlineObj.index;\n        if (!isNullOrUndefined(inline) && indexInInline === inline.length && inline.nextNode instanceof FieldElementBox) {\n            var nextValidInline = this.getNextValidElement(inline.nextNode);\n            if (nextValidInline instanceof FieldElementBox && nextValidInline.fieldType === 0) {\n                inline = nextValidInline;\n            }\n        }\n        return inline;\n    };\n    /**\n     * Get previous text inline\n     * @private\n     */\n    Selection.prototype.getPreviousTextInline = function (inline) {\n        if (inline.previousNode instanceof TextElementBox) {\n            return inline.previousNode;\n        }\n        if (inline.previousNode instanceof FieldElementBox && HelperMethods.isLinkedFieldCharacter(inline.previousNode)) {\n            if (inline.previousNode.fieldType === 0 || inline.previousNode.fieldType === 1) {\n                return inline.previousNode;\n            }\n            return inline.previousNode.fieldBegin;\n        }\n        if (!isNullOrUndefined(inline.previousNode)) {\n            return this.getPreviousTextInline((inline.previousNode));\n        }\n        return undefined;\n    };\n    /**\n     * Get next text inline\n     * @private\n     */\n    Selection.prototype.getNextTextInline = function (inline) {\n        if (inline.nextNode instanceof TextElementBox) {\n            return inline.nextNode;\n        }\n        if (inline.nextNode instanceof FieldElementBox && (HelperMethods.isLinkedFieldCharacter(inline.nextNode))) {\n            if (inline.nextNode.fieldType === 1 || inline.nextNode.fieldType === 0) {\n                return inline.nextNode;\n            }\n            return inline.nextNode.fieldEnd;\n        }\n        if (!isNullOrUndefined(inline.nextNode)) {\n            return this.getNextTextInline((inline.nextNode));\n        }\n        return undefined;\n    };\n    /**\n     * Get container table\n     * @private\n     */\n    Selection.prototype.getContainerTable = function (block) {\n        if (block.isInsideTable) {\n            if (block.associatedCell.ownerTable.isInsideTable) {\n                block = this.getContainerTable(block.associatedCell.ownerTable);\n            }\n            else {\n                block = block.associatedCell.ownerTable;\n            }\n        }\n        if (block instanceof TableWidget) {\n            return block;\n        }\n        return undefined;\n    };\n    /**\n     * @private\n     */\n    Selection.prototype.isExistBefore = function (start, block) {\n        if (start.isInsideTable) {\n            var cell1 = start.associatedCell;\n            if (block.isInsideTable) {\n                var cell2 = block.associatedCell;\n                if (cell1 === cell2) {\n                    return cell1.childWidgets.indexOf(start) < cell1.childWidgets.indexOf(block);\n                }\n                if (cell1.ownerRow === cell2.ownerRow) {\n                    return cell1.cellIndex < cell2.cellIndex;\n                }\n                if (cell1.ownerTable === cell2.ownerTable) {\n                    return cell1.ownerRow.rowIndex < cell2.ownerRow.rowIndex;\n                }\n                //Checks if current block exists before the block.\n                var containerCell = this.getContainerCellOf(cell1, cell2);\n                if (containerCell.ownerTable.contains(cell2)) {\n                    cell1 = this.getSelectedCell(cell1, containerCell);\n                    cell2 = this.getSelectedCell(cell2, containerCell);\n                    if (cell1 === containerCell) {\n                        return this.isExistBefore(start, cell2.ownerTable);\n                    }\n                    if (cell2 === containerCell) {\n                        return this.isExistBefore(cell1.ownerTable, block);\n                    }\n                    if (containerCell.ownerRow === cell2.ownerRow) {\n                        return containerCell.cellIndex < cell2.cellIndex;\n                    }\n                    if (containerCell.ownerTable === cell2.ownerTable) {\n                        return containerCell.ownerRow.rowIndex < cell2.ownerRow.rowIndex;\n                    }\n                    return this.isExistBefore(cell1.ownerTable, cell2.ownerTable);\n                }\n                return this.isExistBefore(containerCell.ownerTable, this.getContainerTable(cell2.ownerTable));\n            }\n            else {\n                var ownerTable = this.getContainerTable(start);\n                return this.isExistBefore(ownerTable, block);\n            }\n        }\n        else if (block.isInsideTable) {\n            var ownerTable = this.getContainerTable(block);\n            return this.isExistBefore(start, ownerTable);\n        }\n        else {\n            {\n                if (start.containerWidget === block.containerWidget) {\n                    return start.index <\n                        block.index;\n                }\n                if (start.containerWidget instanceof BodyWidget && block.containerWidget instanceof BodyWidget) {\n                    //Splitted blocks                     \n                    var startPage = this.viewer.pages.indexOf(start.containerWidget.page);\n                    var endPage = this.viewer.pages.indexOf(block.containerWidget.page);\n                    return startPage < endPage;\n                }\n            }\n        }\n        return false;\n    };\n    /**\n     * @private\n     */\n    Selection.prototype.isExistAfter = function (start, block) {\n        if (start.isInsideTable) {\n            var cell1 = start.associatedCell;\n            //Current paragraph in cell, paragraph in cell\n            if (block.isInsideTable) {\n                var cell2 = block.associatedCell;\n                if (cell1 === cell2) {\n                    return cell1.childWidgets.indexOf(start) > cell1.childWidgets.indexOf(block);\n                }\n                if (cell1.ownerRow === cell2.ownerRow) {\n                    return cell1.cellIndex > cell2.cellIndex;\n                }\n                if (cell1.ownerTable === cell2.ownerTable) {\n                    return cell1.ownerRow.rowIndex > cell2.ownerRow.rowIndex;\n                }\n                //Checks if this block exists before block.\n                var containerCell = this.getContainerCellOf(cell1, cell2);\n                if (containerCell.ownerTable.contains(cell2)) {\n                    cell1 = this.getSelectedCell(cell1, containerCell);\n                    cell2 = this.getSelectedCell(cell2, containerCell);\n                    if (cell1 === containerCell) {\n                        return this.isExistAfter(start, cell2.ownerTable);\n                    }\n                    if (cell2 === containerCell) {\n                        return this.isExistAfter(cell1.ownerTable, block);\n                    }\n                    if (containerCell.ownerRow === cell2.ownerRow) {\n                        return containerCell.cellIndex > cell2.cellIndex;\n                    }\n                    if (containerCell.ownerTable === cell2.ownerTable) {\n                        return containerCell.ownerRow.rowIndex > cell2.ownerRow.rowIndex;\n                    }\n                    return this.isExistAfter(cell1.ownerTable, cell2.ownerTable);\n                }\n                return this.isExistAfter(containerCell.ownerTable, this.getContainerTable(cell2.ownerTable));\n            }\n            else {\n                var ownerTable = this.getContainerTable(start);\n                return this.isExistAfter(ownerTable, block);\n            }\n        }\n        else if (block.isInsideTable) {\n            var ownerTable = this.getContainerTable(block);\n            return this.isExistAfter(start, ownerTable);\n        }\n        else {\n            if (start.containerWidget === block.containerWidget) {\n                return start.index >\n                    block.index;\n            }\n            if (start.containerWidget instanceof BodyWidget && block.containerWidget instanceof BodyWidget) {\n                //Splitted blocks                     \n                var startPage = this.viewer.pages.indexOf(start.containerWidget.page);\n                var endPage = this.viewer.pages.indexOf(block.containerWidget.page);\n                return startPage > endPage;\n            }\n            //     if (start.owner instanceof WHeaderFooter) {\n            //         return (start.owner as WHeaderFooter).childWidgets.indexOf(start) \n            // > (block.owner as WHeaderFooter).childWidgets.indexOf(block);\n            //     } else if (start.section === block.section && start.section instanceof WSection) {\n            //         return (start.section as WSection).childWidgets.indexOf(start)\n            //  > (start.section as WSection).childWidgets.indexOf(block);\n            //     } else if (start.wordDocument instanceof WordDocument) {\n            // tslint:disable-next-line:max-line-length\n            //         return (start.wordDocument as WordDocument).sections.indexOf(start.section as WSection) > (start.wordDocument as WordDocument).sections.indexOf(block.section as WSection);\n        }\n        return false;\n    };\n    /**\n     * Return true if current inline in exist before inline\n     * @private\n     */\n    Selection.prototype.isExistBeforeInline = function (currentInline, inline) {\n        if (currentInline.line === inline.line) {\n            return currentInline.line.children.indexOf(currentInline) <\n                inline.line.children.indexOf(inline);\n        }\n        if (currentInline.line.paragraph === inline.line.paragraph) {\n            return currentInline.line.paragraph.childWidgets.indexOf(currentInline.line)\n                < inline.line.paragraph.childWidgets.indexOf(inline.line);\n        }\n        var startParagraph = currentInline.line.paragraph;\n        var endParagraph = inline.line.paragraph;\n        if (startParagraph.containerWidget === endParagraph.containerWidget) {\n            if (startParagraph.isInsideTable) {\n                return startParagraph.associatedCell.childWidgets.indexOf(startParagraph) <\n                    endParagraph.associatedCell.childWidgets.indexOf(endParagraph);\n            }\n            else if (startParagraph.containerWidget instanceof HeaderFooterWidget) {\n                // return ((currentInline.owner as WParagraph).owner as WHeaderFooter).blocks.indexOf(currentInline.owner as WParagraph) <\n                //     ((inline.owner as WParagraph).owner as WHeaderFooter).blocks.indexOf(inline.owner as WParagraph);\n            }\n            else {\n                return startParagraph.containerWidget.childWidgets.indexOf(startParagraph) <\n                    endParagraph.containerWidget.childWidgets.indexOf(endParagraph);\n            }\n        }\n        return this.isExistBefore(startParagraph, endParagraph);\n    };\n    /**\n     * Return true id current inline is exist after inline\n     * @private\n     */\n    Selection.prototype.isExistAfterInline = function (currentInline, inline) {\n        if (currentInline.line === inline.line) {\n            return currentInline.line.children.indexOf(currentInline) >\n                inline.line.children.indexOf(inline);\n        }\n        if (currentInline.line.paragraph === inline.line.paragraph) {\n            return currentInline.line.paragraph.childWidgets.indexOf(currentInline.line)\n                > inline.line.paragraph.childWidgets.indexOf(inline.line);\n        }\n        var startParagraph = currentInline.line.paragraph;\n        var endParagraph = inline.line.paragraph;\n        if (startParagraph.containerWidget === endParagraph.containerWidget) {\n            if (startParagraph.isInsideTable) {\n                return startParagraph.associatedCell.childWidgets.indexOf(startParagraph) >\n                    endParagraph.associatedCell.childWidgets.indexOf(endParagraph);\n            }\n            else if (startParagraph.containerWidget instanceof HeaderFooterWidget) {\n                // return ((currentInline.owner as WParagraph).owner as WHeaderFooter).blocks.indexOf(currentInline.owner as WParagraph) <\n                //     ((inline.owner as WParagraph).owner as WHeaderFooter).blocks.indexOf(inline.owner as WParagraph);\n            }\n            else {\n                return startParagraph.containerWidget.childWidgets.indexOf(startParagraph) >\n                    endParagraph.containerWidget.childWidgets.indexOf(endParagraph);\n            }\n        }\n        return this.isExistAfter(startParagraph, endParagraph);\n    };\n    /**\n     * Get next rendered block\n     * @private\n     */\n    Selection.prototype.getNextRenderedBlock = function (block) {\n        if (isNullOrUndefined(block.nextWidget)) {\n            return block.nextRenderedWidget;\n        }\n        return block.nextWidget;\n    };\n    /**\n     * Get next rendered block\n     * @private\n     */\n    Selection.prototype.getPreviousRenderedBlock = function (block) {\n        if (isNullOrUndefined(block.previousWidget)) {\n            return block.previousRenderedWidget;\n        }\n        return block.previousWidget;\n    };\n    /**\n     * Get Next paragraph in block\n     * @private\n     */\n    Selection.prototype.getNextParagraphBlock = function (block) {\n        if (block.nextRenderedWidget instanceof ParagraphWidget) {\n            return block.nextRenderedWidget;\n        }\n        else if (block.nextRenderedWidget instanceof TableWidget) {\n            return this.getFirstParagraphInFirstCell(block.nextRenderedWidget);\n        }\n        if (block.containerWidget instanceof TableCellWidget) {\n            return this.getNextParagraphCell(block.containerWidget);\n        }\n        else if (block.containerWidget instanceof BodyWidget) {\n            var bodyWidget = block.containerWidget;\n            return this.getNextParagraph(block.containerWidget);\n        }\n        else if (block.containerWidget instanceof HeaderFooterWidget && this.isMoveDownOrMoveUp) {\n            return this.getFirstBlockInNextHeaderFooter(block);\n        }\n        return undefined;\n    };\n    /**\n     * @private\n     */\n    Selection.prototype.getFirstBlockInNextHeaderFooter = function (block) {\n        var headerFooter = block.containerWidget;\n        var nextBlock;\n        if (headerFooter.headerFooterType.indexOf('Header') !== -1) {\n            nextBlock = headerFooter.page.footerWidget.firstChild;\n        }\n        else if (headerFooter.page.nextPage) {\n            nextBlock = headerFooter.page.nextPage.headerWidget.firstChild;\n        }\n        else {\n            return undefined;\n        }\n        if (nextBlock instanceof ParagraphWidget) {\n            return nextBlock;\n        }\n        else {\n            return this.getFirstBlockInFirstCell(nextBlock);\n        }\n    };\n    /**\n     * @private\n     */\n    Selection.prototype.getLastBlockInPreviousHeaderFooter = function (block) {\n        var headerFooter = block.containerWidget;\n        var previousBlock;\n        if (headerFooter.headerFooterType.indexOf('Footer') !== -1) {\n            previousBlock = headerFooter.page.headerWidget.lastChild;\n        }\n        else if (headerFooter.page.previousPage) {\n            previousBlock = headerFooter.page.previousPage.footerWidget.lastChild;\n        }\n        else {\n            return undefined;\n        }\n        if (previousBlock instanceof ParagraphWidget) {\n            return previousBlock;\n        }\n        else {\n            return this.getFirstBlockInFirstCell(previousBlock);\n        }\n    };\n    /**\n     * Get previous paragraph in block\n     * @private\n     */\n    Selection.prototype.getPreviousParagraphBlock = function (block) {\n        if (block.previousRenderedWidget instanceof ParagraphWidget) {\n            return block.previousRenderedWidget;\n        }\n        else if (block.previousRenderedWidget instanceof TableWidget) {\n            return this.getLastParagraphInLastCell((block.previousRenderedWidget));\n        }\n        if (block.containerWidget instanceof TableCellWidget) {\n            return this.getPreviousParagraphCell((block.containerWidget));\n        }\n        else if (block.containerWidget instanceof BodyWidget) {\n            return this.getPreviousParagraph(block.containerWidget);\n        }\n        else if (block.containerWidget instanceof HeaderFooterWidget && this.isMoveDownOrMoveUp) {\n            return this.getLastBlockInPreviousHeaderFooter(block);\n        }\n        return undefined;\n    };\n    /**\n     * Get first paragraph in block\n     * @private\n     */\n    Selection.prototype.getFirstParagraphBlock = function (block) {\n        if (block instanceof ParagraphWidget) {\n            return block;\n        }\n        else if (block instanceof TableWidget) {\n            return this.getFirstParagraphInFirstCell(block);\n        }\n        return undefined;\n    };\n    /**\n     * Get last paragraph in block\n     * @private\n     */\n    Selection.prototype.getLastParagraphBlock = function (block) {\n        if (block instanceof ParagraphWidget) {\n            return block;\n        }\n        else if (block instanceof TableWidget) {\n            return this.getLastParagraphInLastCell(block);\n        }\n        return undefined;\n    };\n    /**\n     * Return true if paragraph has valid inline\n     * @private\n     */\n    Selection.prototype.hasValidInline = function (paragraph, start, end) {\n        var index = paragraph.childWidgets.indexOf(start.line);\n        for (var i = index; i < paragraph.childWidgets.length; i++) {\n            for (var j = 0; j < paragraph.childWidgets[i].children.length; j++) {\n                var inline = paragraph.childWidgets[i].children[j];\n                if (inline.length === 0) {\n                    continue;\n                }\n                if (inline === end) {\n                    return false;\n                }\n                if (inline instanceof TextElementBox || inline instanceof ImageElementBox\n                    || (inline instanceof FieldElementBox && HelperMethods.isLinkedFieldCharacter(inline))) {\n                    return true;\n                }\n            }\n        }\n        return false;\n    };\n    /**\n     * Get paragraph length\n     * @private\n     */\n    Selection.prototype.getParagraphLength = function (paragraph, endLine, elementInfo) {\n        var length = 0;\n        for (var j = 0; j < paragraph.childWidgets.length; j++) {\n            var line = paragraph.childWidgets[j];\n            if (endLine instanceof LineWidget && endLine === line) {\n                if (elementInfo) {\n                    length += this.getLineLength(line, elementInfo);\n                }\n                break;\n            }\n            length += this.getLineLength(line);\n        }\n        return length;\n    };\n    /**\n     * Get Line length\n     * @private\n     */\n    Selection.prototype.getLineLength = function (line, elementInfo) {\n        var length = 0;\n        for (var i = 0; i < line.children.length; i++) {\n            var element = line.children[i];\n            if (element instanceof ListTextElementBox) {\n                continue;\n            }\n            if (elementInfo && elementInfo.element instanceof ElementBox && elementInfo.element === element) {\n                length += elementInfo.index;\n                break;\n            }\n            length += element.length;\n        }\n        return length;\n    };\n    /**\n     * Get line information\n     * @private\n     */\n    Selection.prototype.getLineInfo = function (paragraph, offset) {\n        var line = undefined;\n        var length = 0;\n        var childLength = paragraph.childWidgets.length;\n        for (var j = 0; j < childLength; j++) {\n            line = paragraph.childWidgets[j];\n            length = this.getLineLength(line);\n            if (offset <= length || j === childLength - 1) {\n                break;\n            }\n            else {\n                offset = offset - length;\n            }\n        }\n        return { 'line': line, 'offset': offset };\n    };\n    /**\n     * @private\n     */\n    Selection.prototype.getElementInfo = function (line, offset) {\n        var index = 0;\n        var element = undefined;\n        for (var i = 0; i < line.children.length; i++) {\n            element = line.children[i];\n            if (element instanceof ListTextElementBox) {\n                continue;\n            }\n            if (offset > element.length\n                && (!(offset === element.length + 1 && isNullOrUndefined(element.nextNode)))) {\n                offset = offset - element.length;\n            }\n            else {\n                break;\n            }\n        }\n        return { 'element': element, 'index': offset };\n    };\n    /**\n     * Get paragraph start offset\n     * @private\n     */\n    Selection.prototype.getStartOffset = function (paragraph) {\n        var startOffset = 0;\n        if (paragraph.childWidgets.length > 0) {\n            var childWidgets = paragraph.childWidgets[0];\n            return this.getStartLineOffset(childWidgets);\n        }\n        return startOffset;\n    };\n    /**\n     * @private\n     */\n    Selection.prototype.getStartLineOffset = function (line) {\n        var startOffset = 0;\n        for (var i = 0; i < line.children.length; i++) {\n            var inline = line.children[i];\n            if (inline.length === 0) {\n                continue;\n            }\n            if (inline instanceof TextElementBox || inline instanceof ImageElementBox || inline instanceof BookmarkElementBox\n                || (inline instanceof FieldElementBox && HelperMethods.isLinkedFieldCharacter(inline))) {\n                return startOffset;\n            }\n            if (inline instanceof ListTextElementBox) {\n                continue;\n            }\n            startOffset += inline.length;\n        }\n        return startOffset;\n    };\n    /**\n     * Get previous paragraph from selection\n     * @private\n     */\n    Selection.prototype.getPreviousSelectionCell = function (cell) {\n        if (!isNullOrUndefined(cell.previousRenderedWidget)) {\n            if (!this.isForward) {\n                var block = cell.previousRenderedWidget.childWidgets[0];\n                if (block instanceof ParagraphWidget) {\n                    return block;\n                }\n                else {\n                    return this.getFirstParagraphInLastRow(block);\n                }\n            }\n            else {\n                var widgets = cell.previousRenderedWidget.childWidgets;\n                var block = widgets[widgets.length - 1];\n                if (block instanceof ParagraphWidget) {\n                    return block;\n                }\n                else {\n                    // tslint:disable-next-line:max-line-length\n                    return this.getPreviousParagraphSelection(block.childWidgets[block.childWidgets.length - 1]);\n                }\n            }\n        }\n        return this.getPreviousSelectionRow(cell.ownerRow);\n    };\n    /**\n     * Get previous paragraph selection in selection\n     * @private\n     */\n    Selection.prototype.getPreviousSelectionRow = function (row) {\n        if (!isNullOrUndefined(row.previousRenderedWidget)) {\n            if (!this.isForward) {\n                var cell = row.previousRenderedWidget.childWidgets[0];\n                var block = cell.childWidgets[0];\n                return this.getFirstParagraphBlock(block);\n            }\n            else {\n                return this.getPreviousParagraphSelection(row.previousRenderedWidget);\n            }\n        }\n        return this.getPreviousSelectionBlock(row.ownerTable);\n    };\n    /**\n     * @private\n     */\n    Selection.prototype.getNextSelectionBlock = function (block) {\n        if (block.nextRenderedWidget instanceof ParagraphWidget) {\n            return block.nextRenderedWidget;\n        }\n        else if (block.nextRenderedWidget instanceof TableWidget) {\n            if (this.isEmpty || this.isForward) {\n                return this.getLastParagraphInFirstRow(block.nextRenderedWidget);\n            }\n            else {\n                return this.getNextParagraphSelection(block.nextRenderedWidget.childWidgets[0]);\n            }\n        }\n        if (block.containerWidget instanceof TableCellWidget) {\n            return this.getNextSelectionCell(block.containerWidget);\n        }\n        else if (block.containerWidget instanceof BodyWidget) {\n            return this.getNextSelection(block.containerWidget);\n        }\n        return undefined;\n    };\n    /**\n     * Get next paragraph from selected cell\n     * @private\n     */\n    Selection.prototype.getNextSelectionCell = function (cell) {\n        if (!isNullOrUndefined(cell.nextRenderedWidget)) {\n            if (this.isEmpty || this.isForward) {\n                // tslint:disable-next-line:max-line-length\n                var block = cell.nextRenderedWidget.childWidgets[cell.nextRenderedWidget.childWidgets.length - 1];\n                return this.getLastParagraphBlock(block);\n            }\n            else {\n                //Return first paragraph in cell. \n                var block = cell.nextRenderedWidget.childWidgets[0];\n                if (block instanceof ParagraphWidget) {\n                    return block;\n                }\n                else {\n                    return this.getNextParagraphSelection(block.childWidgets[0]);\n                }\n            }\n        }\n        return this.getNextSelectionRow(cell.ownerRow);\n    };\n    /**\n     * Get next paragraph in selection\n     * @private\n     */\n    Selection.prototype.getNextSelectionRow = function (row) {\n        if (!isNullOrUndefined(row.nextRenderedWidget)) {\n            var isForwardSelection = this.isEmpty || this.isForward;\n            if (isForwardSelection) {\n                // tslint:disable-next-line:max-line-length\n                var cell = row.nextRenderedWidget.childWidgets[row.nextRenderedWidget.childWidgets.length - 1];\n                var block = cell.childWidgets[cell.childWidgets.length - 1];\n                return this.getLastParagraphBlock(block);\n            }\n            else {\n                return this.getNextParagraphSelection(row.nextRenderedWidget);\n            }\n        }\n        return this.getNextSelectionBlock(row.ownerTable);\n    };\n    /**\n     * Get next block with selection\n     * @private\n     */\n    Selection.prototype.getNextSelection = function (section) {\n        if (section.nextRenderedWidget instanceof BodyWidget) {\n            var block = section.nextRenderedWidget.childWidgets[0];\n            if (block instanceof ParagraphWidget) {\n                return block;\n            }\n            else {\n                if (this.isEmpty || this.isForward) {\n                    return this.getLastParagraphInFirstRow(block);\n                }\n                else {\n                    return this.getNextParagraphSelection(block.childWidgets[0]);\n                }\n            }\n        }\n        return undefined;\n    };\n    /**\n     * @private\n     */\n    Selection.prototype.getNextParagraphSelection = function (row) {\n        //Iterate the exact cell based on UP/Down selection length.\n        var cell = row.childWidgets[0];\n        if (this.start.paragraph.isInsideTable\n            && row.ownerTable.contains(this.start.paragraph.associatedCell)) {\n            var startCell = this.getCellInTable(row.ownerTable, this.start.paragraph.associatedCell);\n            cell = this.getFirstCellInRegion(row, startCell, this.upDownSelectionLength, false);\n        }\n        var block = cell.childWidgets[0];\n        return this.getFirstParagraphBlock(block);\n    };\n    /**\n     * @private\n     */\n    Selection.prototype.getPreviousSelectionBlock = function (block) {\n        if (block.previousRenderedWidget instanceof ParagraphWidget) {\n            return block.previousRenderedWidget;\n        }\n        else if (block.previousRenderedWidget instanceof TableWidget) {\n            if (!this.isForward) {\n                return this.getFirstParagraphInLastRow(block.previousRenderedWidget);\n            }\n            else {\n                // tslint:disable-next-line:max-line-length\n                return this.getPreviousParagraphSelection(block.previousRenderedWidget.childWidgets[block.previousRenderedWidget.childWidgets.length - 1]);\n            }\n        }\n        if (block.containerWidget instanceof TableCellWidget) {\n            return this.getPreviousSelectionCell(block.containerWidget);\n        }\n        else if (block.containerWidget instanceof BodyWidget) {\n            return this.getPreviousSelection(block.containerWidget);\n        }\n        return undefined;\n    };\n    /**\n     * Get previous paragraph in selection\n     * @private\n     */\n    Selection.prototype.getPreviousSelection = function (section) {\n        if (section.previousRenderedWidget instanceof BodyWidget) {\n            var prevBodyWidget = section.previousRenderedWidget;\n            var block = prevBodyWidget.childWidgets[prevBodyWidget.childWidgets.length - 1];\n            if (block instanceof ParagraphWidget) {\n                return block;\n            }\n            else {\n                if (!this.isForward) {\n                    return this.getFirstParagraphInLastRow(block);\n                }\n                else {\n                    var tableWidget = block;\n                    // tslint:disable-next-line:max-line-length\n                    return this.getPreviousParagraphSelection(tableWidget.childWidgets[tableWidget.childWidgets.length - 1]);\n                }\n            }\n        }\n        return undefined;\n    };\n    /**\n     * @private\n     */\n    Selection.prototype.getPreviousParagraphSelection = function (row) {\n        //Iterate the exact cell based on UP/Down selection length.\n        var cell = row.childWidgets[row.childWidgets.length - 1];\n        if (this.start.paragraph.isInsideTable\n            && row.ownerTable.contains(this.start.paragraph.associatedCell)) {\n            var startCell = this.getCellInTable(row.ownerTable, this.start.paragraph.associatedCell);\n            cell = this.getLastCellInRegion(row, startCell, this.upDownSelectionLength, true);\n        }\n        var block = cell.childWidgets[cell.childWidgets.length - 1];\n        return this.getLastParagraphBlock(block);\n    };\n    /**\n     * Get last cell in the selected region\n     * @private\n     */\n    Selection.prototype.getLastCellInRegion = function (row, startCell, selLength, isMovePrev) {\n        var start = this.getCellLeft(row, startCell);\n        var end = start + startCell.cellFormat.cellWidth;\n        var flag = true;\n        if (start <= selLength && selLength < end) {\n            for (var i = row.childWidgets.length - 1; i >= 0; i--) {\n                var left = this.getCellLeft(row, row.childWidgets[i]);\n                if (HelperMethods.round(start, 2) <= HelperMethods.round(left, 2) &&\n                    HelperMethods.round(left, 2) < HelperMethods.round(end, 2)) {\n                    flag = false;\n                    return row.childWidgets[i];\n                }\n            }\n        }\n        else {\n            for (var i = row.childWidgets.length - 1; i >= 0; i--) {\n                var left = this.getCellLeft(row, row.childWidgets[i]);\n                if (left <= selLength && left + row.childWidgets[i].cellFormat.cellWidth > selLength) {\n                    flag = false;\n                    return row.childWidgets[i];\n                }\n            }\n        }\n        if (flag) {\n            if (!isNullOrUndefined(row.previousRenderedWidget) && isMovePrev) {\n                return this.getLastCellInRegion(row.previousRenderedWidget, startCell, selLength, isMovePrev);\n            }\n            else if (!isNullOrUndefined(row.nextRenderedWidget) && !isMovePrev) {\n                return this.getLastCellInRegion(row.nextRenderedWidget, startCell, selLength, isMovePrev);\n            }\n        }\n        return row.childWidgets[row.childWidgets.length - 1];\n    };\n    /**\n     * Get Container table\n     * @private\n     */\n    Selection.prototype.getCellInTable = function (table, tableCell) {\n        while (tableCell.ownerTable.isInsideTable) {\n            if (table.equals(tableCell.ownerTable)) {\n                return tableCell;\n            }\n            tableCell = tableCell.ownerTable.associatedCell;\n        }\n        return tableCell;\n    };\n    /**\n     * Get first paragraph in last row\n     * @private\n     */\n    Selection.prototype.getFirstParagraphInLastRow = function (table) {\n        if (table.childWidgets.length > 0) {\n            var lastRow = table.childWidgets[table.childWidgets.length - 1];\n            var lastCell = lastRow.childWidgets[0];\n            var lastBlock = lastCell.childWidgets[0];\n            return this.getFirstParagraphBlock(lastBlock);\n        }\n        return undefined;\n    };\n    /**\n     * Get previous valid offset\n     * @private\n     */\n    Selection.prototype.getPreviousValidOffset = function (paragraph, offset) {\n        if (offset === 0) {\n            return 0;\n        }\n        var validOffset = 0;\n        var count = 0;\n        for (var i = 0; i < paragraph.childWidgets.length; i++) {\n            var lineWidget = paragraph.childWidgets[i];\n            for (var j = 0; j < lineWidget.children.length; j++) {\n                var inline = lineWidget.children[j];\n                if (inline.length === 0) {\n                    continue;\n                }\n                if (offset <= count + inline.length) {\n                    return offset - 1 === count ? validOffset : offset - 1;\n                }\n                if (inline instanceof TextElementBox || inline instanceof ImageElementBox\n                    || (inline instanceof FieldElementBox && HelperMethods.isLinkedFieldCharacter(inline))) {\n                    validOffset = count + inline.length;\n                }\n                count += inline.length;\n            }\n        }\n        return offset - 1 === count ? validOffset : offset - 1;\n    };\n    /**\n     * Get next valid offset\n     * @private\n     */\n    Selection.prototype.getNextValidOffset = function (line, offset) {\n        var count = 0;\n        for (var i = 0; i < line.children.length; i++) {\n            var inline = line.children[i];\n            if (inline.length === 0 || inline instanceof ListTextElementBox) {\n                continue;\n            }\n            if (offset < count + inline.length) {\n                if (inline instanceof TextElementBox || inline instanceof ImageElementBox\n                    || (inline instanceof FieldElementBox && HelperMethods.isLinkedFieldCharacter(inline))) {\n                    return (offset > count ? offset : count) + 1;\n                }\n            }\n            count += inline.length;\n        }\n        return offset;\n    };\n    /**\n     * Get paragraph mark size info\n     * @private\n     */\n    Selection.prototype.getParagraphMarkSize = function (paragraph, topMargin, bottomMargin) {\n        var size = this.viewer.textHelper.getParagraphMarkSize(paragraph.characterFormat);\n        var baselineOffset = size.BaselineOffset;\n        var maxHeight = size.Height;\n        var maxBaselineOffset = baselineOffset;\n        if (paragraph instanceof ParagraphWidget) {\n            // let paragraphWidget: ParagraphWidget[] = paragraph.renderedElement() as ParagraphWidget[];\n            if (paragraph.childWidgets.length > 0) {\n                var lineWidget = paragraph.childWidgets[0];\n            }\n            //Gets line spacing.\n            var lineSpacing = this.viewer.layout.getLineSpacing(paragraph, maxHeight);\n            var beforeSpacing = this.viewer.layout.getBeforeSpacing(paragraph);\n            topMargin = maxBaselineOffset - baselineOffset;\n            bottomMargin = maxHeight - maxBaselineOffset - (size.Height - baselineOffset);\n            //Updates line spacing, paragraph after/ before spacing and aligns the text to base line offset.\n            var lineSpacingType = paragraph.paragraphFormat.lineSpacingType;\n            if (lineSpacingType === 'Multiple') {\n                if (lineSpacing > maxHeight) {\n                    bottomMargin += lineSpacing - maxHeight;\n                }\n                else {\n                    topMargin += lineSpacing - maxHeight;\n                }\n            }\n            else if (lineSpacingType === 'Exactly') {\n                topMargin += lineSpacing - (topMargin + size.Height + bottomMargin);\n            }\n            else if (lineSpacing > topMargin + size.Height + bottomMargin) {\n                topMargin += lineSpacing - (topMargin + size.Height + bottomMargin);\n            }\n            topMargin += beforeSpacing;\n            bottomMargin += paragraph.paragraphFormat.afterSpacing;\n        }\n        return { 'width': size.Width, 'height': size.Height, 'topMargin': topMargin, 'bottomMargin': bottomMargin };\n    };\n    /**\n     * @private\n     */\n    Selection.prototype.getPhysicalPositionInternal = function (line, offset, moveNextLine) {\n        if (line.paragraph.isEmpty()) {\n            var paragraphWidget = line.paragraph;\n            var left = paragraphWidget.x;\n            if (paragraphWidget.childWidgets.length > 0) {\n                var lineWidget = paragraphWidget.childWidgets[0];\n                left = this.getLeft(lineWidget);\n            }\n            var topMargin = 0;\n            var bottomMargin = 0;\n            var size = this.getParagraphMarkSize(line.paragraph, topMargin, bottomMargin);\n            if (offset > 0) {\n                left += size.width;\n            }\n            return new Point(left, paragraphWidget.y + topMargin);\n        }\n        else {\n            var indexInInline = 0;\n            var inlineObj = line.getInline(offset, indexInInline);\n            var inline = inlineObj.element; //return indexInInline must\n            indexInInline = inlineObj.index;\n            // tslint:disable-next-line:max-line-length\n            // if (inline.length === indexInInline && !isNullOrUndefined(inline.nextNode) && this.viewer.renderedElements.containsKey(inline) &&\n            //     this.viewer.renderedElements.get(inline).length > 0 && this.viewer.renderedElements.containsKey(inline.nextNode as WInline)\n            //     && this.viewer.renderedElements.get(inline.nextNode as WInline).length > 0 &&\n            // tslint:disable-next-line:max-line-length\n            //     (this.viewer.renderedElements.get(inline)[this.viewer.renderedElements.get(inline).length - 1] as ElementBox).line !== (this.viewer.renderedElements.get(inline.nextNode as WInline)[0] as ElementBox).line) {\n            //     //Handled specifically to move the cursor at start of next line.\n            //     inline = inline.nextNode as WInline;\n            //     indexInInline = 0;\n            // }\n            return this.getPhysicalPositionInline(inline, indexInInline, moveNextLine);\n        }\n    };\n    /**\n     * Highlight selected content\n     * @private\n     */\n    Selection.prototype.highlightSelectedContent = function (start, end) {\n        if (start.paragraph.isInsideTable && (!end.paragraph.isInsideTable\n            || (!start.paragraph.associatedCell.equals(end.paragraph.associatedCell))\n            || this.isCellSelected(start.paragraph.associatedCell, start, end))) {\n            this.highlightCell(start.paragraph.associatedCell, this, start, end);\n        }\n        else {\n            var inline = undefined;\n            var index = 0;\n            if (!this.owner.isReadOnlyMode && start.paragraph === end.paragraph) {\n                if (start.offset + 1 === end.offset) {\n                    var inlineObj = end.currentWidget.getInline(end.offset, index);\n                    inline = inlineObj.element; // return index value\n                    index = inlineObj.index;\n                    if (inline instanceof ImageElementBox) {\n                        var startOffset = start.currentWidget.getOffset(inline, 0);\n                        if (startOffset !== start.offset) {\n                            inline = undefined;\n                        }\n                    }\n                }\n                else {\n                    var indexInInline = 0;\n                    var startInlineObj = start.currentWidget.getInline(start.offset, indexInInline);\n                    var startInline = startInlineObj.element; //return indexInInline\n                    indexInInline = startInlineObj.index;\n                    if (indexInInline === startInline.length) {\n                        startInline = this.getNextRenderedElementBox(startInline, indexInInline);\n                    }\n                    var endInlineObj = end.currentWidget.getInline(end.offset, indexInInline);\n                    var endInline = endInlineObj.element; //return indexInInline\n                    indexInInline = endInlineObj.index;\n                    // tslint:disable-next-line:max-line-length\n                    if (startInline instanceof FieldElementBox && endInline instanceof FieldElementBox && !isNullOrUndefined(startInline.fieldSeparator)) {\n                        var fieldValue = startInline.fieldSeparator.nextNode;\n                        if (fieldValue instanceof ImageElementBox && fieldValue.nextNode === endInline) {\n                            inline = fieldValue;\n                        }\n                    }\n                }\n            }\n            if (!this.owner.isReadOnlyMode && inline instanceof ImageElementBox && this.owner.isDocumentLoaded) {\n                var elementBoxObj = this.getElementBoxInternal(inline, index);\n                var elementBox = elementBoxObj.element; //return index \n                index = elementBoxObj.index;\n                if (this.owner.enableImageResizerMode) {\n                    this.owner.imageResizerModule.positionImageResizer(elementBox);\n                    this.owner.imageResizerModule.showImageResizer();\n                }\n                if (this.viewer.isTouchInput) {\n                    this.viewer.touchStart.style.display = 'none';\n                    this.viewer.touchEnd.style.display = 'none';\n                }\n            }\n            else {\n                this.highlight(start.paragraph, start, end);\n            }\n        }\n    };\n    /**\n     * @private\n     */\n    Selection.prototype.highlight = function (paragraph, start, end) {\n        var selectionStartIndex = 0;\n        var selectionEndIndex = 0;\n        var startElement = undefined;\n        var endElement = undefined;\n        var startLineWidget = undefined;\n        var endLineWidget = undefined;\n        //return start Element and selection start index\n        var startLineObj = this.getStartLineWidget(paragraph, start, startElement, selectionStartIndex);\n        startElement = startLineObj.element;\n        if (isNullOrUndefined(startElement)) {\n            startLineWidget = paragraph.childWidgets[0];\n        }\n        else {\n            startLineWidget = startElement.line;\n        }\n        selectionStartIndex = startLineObj.index;\n        var endLineObj = this.getEndLineWidget(end, endElement, selectionEndIndex);\n        endElement = endLineObj.element;\n        if (endElement) {\n            endLineWidget = endElement.line;\n        }\n        else {\n            endLineWidget = end.paragraph.childWidgets[end.paragraph.childWidgets.length - 1];\n        }\n        selectionEndIndex = endLineObj.index;\n        var top = 0;\n        var left = 0;\n        if (!isNullOrUndefined(startLineWidget)) {\n            top = this.getTop(startLineWidget);\n            left = this.getLeftInternal(startLineWidget, startElement, selectionStartIndex);\n        }\n        if (!isNullOrUndefined(startLineWidget) && startLineWidget === endLineWidget) {\n            //Selection ends in current line.\n            var right = this.getLeftInternal(endLineWidget, endElement, selectionEndIndex);\n            this.createHighlightBorder(startLineWidget, right - left, left, top);\n        }\n        else {\n            if (!isNullOrUndefined(startLineWidget)) {\n                var x = startLineWidget.paragraph.x;\n                this.createHighlightBorder(startLineWidget, this.getWidth(startLineWidget, true) - (left - x), left, top);\n                var lineIndex = startLineWidget.paragraph.childWidgets.indexOf(startLineWidget);\n                //Iterates to last item of paragraph or selection end.                                             \n                this.highlightParagraph(paragraph, lineIndex + 1, endLineWidget, endElement, selectionEndIndex);\n                if (paragraph.childWidgets.indexOf(end.currentWidget) !== -1) {\n                    return;\n                }\n            }\n            this.highlightNextBlock(paragraph, start, end);\n        }\n    };\n    Selection.prototype.highlightNextBlock = function (paragraph, start, end) {\n        var block = paragraph.nextRenderedWidget;\n        if (!isNullOrUndefined(block)) {\n            if (block instanceof ParagraphWidget) {\n                this.highlight(block, start, end);\n            }\n            else {\n                this.highlightTable(block, start, end);\n            }\n        }\n    };\n    /**\n     * Get start line widget\n     * @private\n     */\n    // tslint:disable-next-line:max-line-length\n    Selection.prototype.getStartLineWidget = function (paragraph, start, startElement, selectionStartIndex) {\n        var offset = paragraph === start.paragraph ? start.offset : this.getStartOffset(paragraph);\n        var startInlineObj = undefined;\n        if (paragraph === start.paragraph) {\n            startInlineObj = start.currentWidget.getInline(offset, selectionStartIndex);\n        }\n        else {\n            startInlineObj = paragraph.firstChild.getInline(offset, selectionStartIndex);\n        }\n        startElement = startInlineObj.element; //return selectionStartIndex\n        selectionStartIndex = startInlineObj.index;\n        if (startElement instanceof FieldElementBox) {\n            var inlineInfo = this.getRenderedInline(startElement, selectionStartIndex);\n            startElement = inlineInfo.element;\n            selectionStartIndex = inlineInfo.index;\n        }\n        if (offset === this.getParagraphLength(start.paragraph) + 1) {\n            selectionStartIndex++;\n        }\n        return {\n            'index': selectionStartIndex, 'element': startElement\n        };\n    };\n    /**\n     * Get end line widget\n     * @private\n     */\n    Selection.prototype.getEndLineWidget = function (end, endElement, selectionEndIndex) {\n        var endInlineObj = end.currentWidget.getInline(end.offset, selectionEndIndex);\n        endElement = endInlineObj.element; //return selection end index\n        selectionEndIndex = endInlineObj.index;\n        if (endElement instanceof FieldElementBox) {\n            var inlineInfo = this.getRenderedInline(endElement, selectionEndIndex);\n            endElement = inlineInfo.element;\n            selectionEndIndex = inlineInfo.index;\n        }\n        var lineIndex = end.paragraph.childWidgets.indexOf(end.currentWidget);\n        if (lineIndex === end.paragraph.childWidgets.length - 1 && end.offset === this.getLineLength(end.currentWidget) + 1) {\n            selectionEndIndex = endElement ? endElement.length + 1 : 1;\n        }\n        return { 'index': selectionEndIndex, 'element': endElement };\n    };\n    /**\n     * Get line widget\n     * @private\n     */\n    Selection.prototype.getLineWidgetInternal = function (line, offset, moveToNextLine) {\n        var lineWidget = undefined;\n        if (line.children.length === 0 && line instanceof LineWidget) {\n            lineWidget = line;\n        }\n        else {\n            var indexInInline = 0;\n            var inlineInfo = line.getInline(offset, indexInInline);\n            var inline = inlineInfo.element;\n            indexInInline = inlineInfo.index;\n            lineWidget = inline instanceof ElementBox ? inline.line\n                : this.getLineWidgetInternalInline(inline, indexInInline, moveToNextLine);\n        }\n        return lineWidget;\n    };\n    /**\n     * Get last line widget\n     * @private\n     */\n    Selection.prototype.getLineWidgetParagraph = function (offset, line) {\n        var linewidget = undefined;\n        if (line.children.length === 0) {\n            linewidget = line;\n        }\n        else {\n            var indexInInline = 0;\n            var inlineInfo = line.getInline(offset, indexInInline);\n            var inline = inlineInfo.element;\n            indexInInline = inlineInfo.index;\n            linewidget = this.getLineWidget(inline, indexInInline);\n        }\n        return linewidget;\n    };\n    /**\n     * Highlight selected cell\n     * @private\n     */\n    /* tslint:disable */\n    // tslint:disable-next-line:max-line-length    \n    Selection.prototype.highlightCells = function (table, startCell, endCell) {\n        var start = this.getCellLeft(startCell.ownerRow, startCell);\n        var end = start + startCell.cellFormat.cellWidth;\n        var endCellLeft = this.getCellLeft(endCell.ownerRow, endCell);\n        var endCellRight = endCellLeft + endCell.cellFormat.cellWidth;\n        if (start > endCellLeft) {\n            start = endCellLeft;\n        }\n        if (end < endCellRight) {\n            end = endCellRight;\n        }\n        if (start > this.upDownSelectionLength) {\n            start = this.upDownSelectionLength;\n        }\n        if (end < this.upDownSelectionLength) {\n            end = this.upDownSelectionLength;\n        }\n        var tableWidgetCollection = table.getSplitWidgets();\n        var startTableIndex = tableWidgetCollection.indexOf(startCell.ownerRow.ownerTable);\n        var endTableIndex = tableWidgetCollection.indexOf(endCell.ownerRow.ownerTable);\n        if (startTableIndex === endTableIndex) {\n            var count = table.childWidgets.indexOf(endCell.ownerRow);\n            for (var i = table.childWidgets.indexOf(startCell.ownerRow); i <= count; i++) {\n                this.highlightRow(table.childWidgets[i], start, end);\n            }\n        }\n        else {\n            var startRowIndex = 0;\n            var endRowIndex = 0;\n            for (var i = startTableIndex; i <= endTableIndex; i++) {\n                table = tableWidgetCollection[i];\n                if (i === startTableIndex) {\n                    startRowIndex = table.childWidgets.indexOf(startCell.ownerRow);\n                }\n                else {\n                    startRowIndex = 0;\n                }\n                if (i === endTableIndex) {\n                    endRowIndex = table.childWidgets.indexOf(endCell.ownerRow);\n                }\n                else {\n                    endRowIndex = table.childWidgets.length - 1;\n                }\n                for (var j = startRowIndex; j <= endRowIndex; j++) {\n                    this.highlightRow(table.childWidgets[j], start, end);\n                }\n            }\n        }\n    };\n    /* tslint:enable */\n    /**\n     * highlight selected table\n     * @private\n     */\n    Selection.prototype.highlightTable = function (table, start, end) {\n        this.highlightInternal(table.childWidgets[0], start, end);\n        if (!end.paragraph.isInsideTable //Selection end is outside the table cell.\n            || !table.contains(end.paragraph.associatedCell)) {\n            this.highlightNextBlock(table, start, end);\n        }\n    };\n    /**\n     * Get cell left\n     * @private\n     */\n    Selection.prototype.getCellLeft = function (row, cell) {\n        var left = 0;\n        left += cell.x - cell.margin.left;\n        return left;\n    };\n    /**\n     * Get next paragraph for row\n     * @private\n     */\n    Selection.prototype.getNextParagraphRow = function (row) {\n        if (!isNullOrUndefined(row.nextRenderedWidget)) {\n            var cell = row.nextRenderedWidget.childWidgets[0];\n            var block = cell.childWidgets[0];\n            return this.getFirstParagraphBlock(block);\n        }\n        return this.getNextParagraphBlock(row.ownerTable);\n    };\n    /**\n     * Get previous paragraph from row\n     * @private\n     */\n    Selection.prototype.getPreviousParagraphRow = function (row) {\n        if (!isNullOrUndefined(row.previousRenderedWidget)) {\n            // tslint:disable-next-line:max-line-length\n            var cell = row.previousRenderedWidget.lastChild;\n            var block = cell.lastChild ? cell.lastChild : (cell.previousSplitWidget).lastChild;\n            return this.getLastParagraphBlock(block);\n        }\n        return this.getPreviousParagraphBlock(row.ownerTable);\n    };\n    /**\n     * Return true if row contain cell\n     * @private\n     */\n    Selection.prototype.containsRow = function (row, tableCell) {\n        if (row.childWidgets.indexOf(tableCell) !== -1) {\n            return true;\n        }\n        while (tableCell.ownerTable.isInsideTable) {\n            if (row.childWidgets.indexOf(tableCell) !== -1) {\n                return true;\n            }\n            tableCell = tableCell.ownerTable.associatedCell;\n        }\n        return row.childWidgets.indexOf(tableCell) !== -1;\n    };\n    /**\n     * Highlight selected row\n     * @private\n     */\n    Selection.prototype.highlightRow = function (row, start, end) {\n        for (var i = 0; i < row.childWidgets.length; i++) {\n            var left = this.getCellLeft(row, row.childWidgets[i]);\n            if (HelperMethods.round(start, 2) <= HelperMethods.round(left, 2) &&\n                HelperMethods.round(left, 2) < HelperMethods.round(end, 2)) {\n                this.highlightCellWidget(row.childWidgets[i]);\n            }\n        }\n    };\n    /**\n     * @private\n     */\n    // tslint:disable-next-line:max-line-length\n    Selection.prototype.highlightInternal = function (row, start, end) {\n        for (var i = 0; i < row.childWidgets.length; i++) {\n            this.highlightCellWidget(row.childWidgets[i]);\n        }\n        if (end.paragraph.isInsideTable && this.containsRow(row, end.paragraph.associatedCell)) {\n            return;\n        }\n        else if (row.nextRenderedWidget instanceof TableRowWidget) {\n            this.highlightInternal(row.nextRenderedWidget, start, end);\n        }\n    };\n    /**\n     * Get last paragraph in cell\n     * @private\n     */\n    Selection.prototype.getLastParagraph = function (cell) {\n        while (cell.nextSplitWidget) {\n            if (cell.nextSplitWidget.childWidgets.length > 0) {\n                cell = cell.nextSplitWidget;\n            }\n            else {\n                break;\n            }\n        }\n        var lastBlock;\n        if (cell.childWidgets.length > 0) {\n            lastBlock = cell.lastChild;\n        }\n        else {\n            lastBlock = cell.previousSplitWidget.lastChild;\n        }\n        return this.getLastParagraphBlock(lastBlock);\n    };\n    /**\n     * Return true is source cell contain cell\n     * @private\n     */\n    Selection.prototype.containsCell = function (sourceCell, cell) {\n        if (sourceCell.equals(cell)) {\n            return true;\n        }\n        while (cell.ownerTable.isInsideTable) {\n            if (sourceCell.equals(cell.ownerTable.associatedCell)) {\n                return true;\n            }\n            cell = cell.ownerTable.associatedCell;\n        }\n        return false;\n    };\n    /**\n     * Return true if cell is selected\n     * @private\n     */\n    Selection.prototype.isCellSelected = function (cell, startPosition, endPosition) {\n        var lastParagraph = this.getLastParagraph(cell);\n        // tslint:disable-next-line:max-line-length\n        var isAtCellEnd = lastParagraph === endPosition.paragraph && endPosition.offset === this.getParagraphLength(lastParagraph) + 1;\n        return isAtCellEnd || (!this.containsCell(cell, startPosition.paragraph.associatedCell) ||\n            !this.containsCell(cell, endPosition.paragraph.associatedCell));\n    };\n    /**\n     * Return Container cell\n     * @private\n     */\n    Selection.prototype.getContainerCellOf = function (cell, tableCell) {\n        while (cell.ownerTable.isInsideTable) {\n            if (cell.ownerTable.contains(tableCell)) {\n                return cell;\n            }\n            cell = cell.ownerTable.associatedCell;\n        }\n        return cell;\n    };\n    /**\n     * Get Selected cell\n     * @private\n     */\n    Selection.prototype.getSelectedCell = function (cell, containerCell) {\n        if (cell.ownerTable.equals(containerCell.ownerTable)) {\n            return cell;\n        }\n        while (cell.ownerTable.isInsideTable) {\n            if (cell.ownerTable.associatedCell.equals(containerCell)) {\n                return cell;\n            }\n            cell = cell.ownerTable.associatedCell;\n        }\n        return cell;\n    };\n    /**\n     * @private\n     */\n    Selection.prototype.getSelectedCells = function () {\n        var cells = [];\n        for (var i = 0; i < this.selectedWidgets.keys.length; i++) {\n            var widget = this.selectedWidgets.keys[i];\n            if (widget instanceof TableCellWidget) {\n                cells.push(widget);\n            }\n        }\n        return cells;\n    };\n    /**\n     * Get Next paragraph from cell\n     * @private\n     */\n    Selection.prototype.getNextParagraphCell = function (cell) {\n        if (cell.nextRenderedWidget && cell.nextRenderedWidget instanceof TableCellWidget) {\n            //Return first paragraph in cell.            \n            cell = cell.nextRenderedWidget;\n            var block = cell.firstChild;\n            if (block) {\n                return this.getFirstParagraphBlock(block);\n            }\n            else {\n                return this.getNextParagraphCell(cell);\n            }\n        }\n        return this.getNextParagraphRow(cell.containerWidget);\n    };\n    /**\n     * Get previous paragraph from cell\n     * @private\n     */\n    Selection.prototype.getPreviousParagraphCell = function (cell) {\n        if (!isNullOrUndefined(cell.previousRenderedWidget) && cell.previousRenderedWidget instanceof TableCellWidget) {\n            cell = cell.previousRenderedWidget;\n            var block = cell.lastChild;\n            return this.getLastParagraphBlock(block);\n        }\n        return this.getPreviousParagraphRow(cell.ownerRow);\n    };\n    /**\n     * Get cell's container cell\n     * @private\n     */\n    Selection.prototype.getContainerCell = function (cell) {\n        while (!isNullOrUndefined(cell.ownerTable) && cell.ownerTable.isInsideTable) {\n            cell = cell.ownerTable.associatedCell;\n        }\n        return cell;\n    };\n    /**\n     * Highlight selected cell\n     * @private\n     */\n    /* tslint:disable */\n    Selection.prototype.highlightCell = function (cell, selection, start, end) {\n        if (end.paragraph.isInsideTable) {\n            var containerCell = this.getContainerCellOf(cell, end.paragraph.associatedCell);\n            if (containerCell.ownerTable.contains(end.paragraph.associatedCell)) {\n                var startCell = this.getSelectedCell(cell, containerCell);\n                var endCell = this.getSelectedCell(end.paragraph.associatedCell, containerCell);\n                if (this.containsCell(containerCell, end.paragraph.associatedCell)) {\n                    /* tslint:enable */\n                    //Selection end is in container cell.\n                    if (this.isCellSelected(containerCell, start, end)) {\n                        this.highlightCellWidget(containerCell);\n                    }\n                    else {\n                        if (startCell === containerCell) {\n                            this.highlight(start.paragraph, start, end);\n                        }\n                        else {\n                            this.highlightContainer(startCell, start, end);\n                        }\n                    }\n                }\n                else {\n                    //Selection end is not in container cell.\n                    this.highlightCellWidget(containerCell);\n                    if (containerCell.ownerRow.equals(endCell.ownerRow)) {\n                        //Highlight other selected cells in current row.\n                        startCell = containerCell;\n                        while (!isNullOrUndefined(startCell.nextRenderedWidget)) {\n                            startCell = startCell.nextRenderedWidget;\n                            this.highlightCellWidget(startCell);\n                            if (startCell === endCell) {\n                                break;\n                            }\n                        }\n                    }\n                    else {\n                        this.highlightCells(containerCell.ownerTable, containerCell, endCell);\n                    }\n                }\n            }\n            else {\n                this.highlightContainer(containerCell, start, end);\n            }\n        }\n        else {\n            var cell1 = this.getContainerCell(cell);\n            this.highlightContainer(cell1, start, end);\n        }\n    };\n    /**\n     * @private\n     */\n    Selection.prototype.highlightContainer = function (cell, start, end) {\n        this.highlightInternal(cell.containerWidget, start, end);\n        this.highlightNextBlock(cell.ownerTable, start, end);\n    };\n    /**\n     * Get previous valid element\n     * @private\n     */\n    Selection.prototype.getPreviousValidElement = function (inline) {\n        var previousValidInline = undefined;\n        while (inline instanceof FieldElementBox) {\n            if (HelperMethods.isLinkedFieldCharacter(inline)) {\n                if (inline instanceof FieldElementBox && inline.fieldType === 0) {\n                    previousValidInline = inline;\n                }\n                else if (inline instanceof FieldElementBox && inline.fieldType === 1) {\n                    previousValidInline = inline;\n                    if (isNullOrUndefined(inline.fieldSeparator)) {\n                        inline = inline.fieldBegin;\n                        previousValidInline = inline;\n                    }\n                }\n                else {\n                    inline = inline.fieldBegin;\n                    previousValidInline = inline;\n                }\n            }\n            inline = inline.previousNode;\n        }\n        return isNullOrUndefined(previousValidInline) ? inline : previousValidInline;\n    };\n    /**\n     * Get next valid element\n     * @private\n     */\n    Selection.prototype.getNextValidElement = function (inline) {\n        var nextValidInline = undefined;\n        while (inline instanceof FieldElementBox) {\n            if (inline.fieldType === 0 && !isNullOrUndefined(inline.fieldEnd)) {\n                return isNullOrUndefined(nextValidInline) ? inline : nextValidInline;\n            }\n            else if (inline.fieldType === 1 && !isNullOrUndefined(inline.fieldBegin)) {\n                nextValidInline = inline;\n            }\n            inline = inline.nextNode;\n        }\n        return (isNullOrUndefined(nextValidInline) ? inline : nextValidInline);\n    };\n    /**\n     * Return next valid inline with index\n     * @private\n     */\n    Selection.prototype.validateTextPosition = function (inline, index) {\n        if (inline.length === index && inline.nextNode instanceof FieldElementBox) {\n            //If inline is last item within field, then set field end as text position.\n            var nextInline = this.getNextValidElement(inline.nextNode);\n            if (nextInline instanceof FieldElementBox && nextInline.fieldType === 1) {\n                inline = nextInline;\n                index = 1;\n            }\n        }\n        else if (index === 0 && inline.previousNode instanceof FieldElementBox) {\n            var prevInline = this.getPreviousValidElement(inline.previousNode);\n            inline = prevInline;\n            index = inline instanceof FieldElementBox ? 0 : inline.length;\n            if (inline instanceof FieldElementBox && inline.fieldType === 1) {\n                index++;\n            }\n        }\n        return { 'element': inline, 'index': index };\n    };\n    /**\n     * Get inline physical location\n     * @private\n     */\n    Selection.prototype.getPhysicalPositionInline = function (inline, index, moveNextLine) {\n        var element = undefined;\n        element = this.getElementBox(inline, index, moveNextLine).element;\n        var lineWidget = undefined;\n        if (isNullOrUndefined(element) || isNullOrUndefined(element.line)) {\n            if (inline instanceof FieldElementBox || inline instanceof BookmarkElementBox) {\n                return this.getFieldCharacterPosition(inline);\n            }\n            return new Point(0, 0);\n        }\n        var margin = element.margin;\n        var top = 0;\n        var left = 0;\n        if (element instanceof TextElementBox && element.text === '\\v' && isNullOrUndefined(inline.nextNode)) {\n            lineWidget = this.getNextLineWidget(element.line.paragraph, element);\n            index = 0;\n        }\n        else {\n            lineWidget = element.line;\n        }\n        top = this.getTop(lineWidget);\n        if (element instanceof ImageElementBox) {\n            var format = element.line.paragraph.characterFormat;\n            var previousInline = this.getPreviousTextElement(inline);\n            if (!isNullOrUndefined(previousInline)) {\n                format = previousInline.characterFormat;\n            }\n            else {\n                var nextInline = this.getNextTextElement(inline);\n                if (!isNullOrUndefined(nextInline)) {\n                    format = nextInline.characterFormat;\n                }\n            }\n            var measureObj = this.viewer.textHelper.getHeight(format);\n            if (element.margin.top + element.height - measureObj.BaselineOffset > 0) {\n                top += element.margin.top + element.height - measureObj.BaselineOffset;\n            }\n        }\n        else if (!(element instanceof FieldElementBox)) {\n            top += margin.top > 0 ? margin.top : 0;\n        }\n        left = (isNullOrUndefined(element) || isNullOrUndefined(lineWidget)) ? 0 : this.getLeftInternal(lineWidget, element, index);\n        return new Point(left, top);\n    };\n    /**\n     * Get field character position\n     * @private\n     */\n    Selection.prototype.getFieldCharacterPosition = function (firstInline) {\n        var nextValidInline = this.getNextValidElementForField(firstInline);\n        //If field separator/end exists at end of paragraph, then move to next paragraph.\n        if (isNullOrUndefined(nextValidInline)) {\n            var nextParagraph = firstInline.line.paragraph;\n            return this.getEndPosition(nextParagraph);\n        }\n        else {\n            return this.getPhysicalPositionInline(nextValidInline, 0, true);\n        }\n    };\n    /**\n     * @private\n     */\n    Selection.prototype.getNextValidElementForField = function (firstInline) {\n        if (firstInline instanceof FieldElementBox && firstInline.fieldType === 0\n            && HelperMethods.isLinkedFieldCharacter(firstInline)) {\n            var fieldBegin = firstInline;\n            if (isNullOrUndefined(fieldBegin.fieldSeparator)) {\n                firstInline = fieldBegin.fieldEnd;\n            }\n            else {\n                firstInline = fieldBegin.fieldSeparator;\n            }\n        }\n        var nextValidInline = undefined;\n        if (!isNullOrUndefined(firstInline.nextNode)) {\n            nextValidInline = this.getNextValidElement(firstInline.nextNode);\n        }\n        return nextValidInline;\n    };\n    /**\n     * Get paragraph end position\n     * @private\n     */\n    Selection.prototype.getEndPosition = function (widget) {\n        var left = widget.x;\n        var top = widget.y;\n        var lineWidget = undefined;\n        if (widget.childWidgets.length > 0) {\n            lineWidget = widget.childWidgets[widget.childWidgets.length - 1];\n            left += this.getWidth(lineWidget, false);\n        }\n        if (!isNullOrUndefined(lineWidget)) {\n            top = this.getTop(lineWidget);\n        }\n        var topMargin = 0;\n        var bottomMargin = 0;\n        var size = this.getParagraphMarkSize(widget, topMargin, bottomMargin);\n        return new Point(left, top + size.topMargin);\n    };\n    /**\n     * Get element box\n     * @private\n     */\n    Selection.prototype.getElementBox = function (currentInline, index, moveToNextLine) {\n        var elementBox = undefined;\n        if (!(currentInline instanceof FieldElementBox || currentInline instanceof BookmarkElementBox)) {\n            elementBox = currentInline;\n        }\n        return { 'element': elementBox, 'index': index };\n    };\n    /**\n     * @private\n     */\n    Selection.prototype.getPreviousTextElement = function (inline) {\n        if (inline.previousNode instanceof TextElementBox) {\n            return inline.previousNode;\n        }\n        if (!isNullOrUndefined(inline.previousNode)) {\n            return this.getPreviousTextElement(inline.previousNode);\n        }\n        return undefined;\n    };\n    /**\n     * Get next text inline\n     * @private\n     */\n    Selection.prototype.getNextTextElement = function (inline) {\n        if (inline.nextNode instanceof TextElementBox) {\n            return inline.nextNode;\n        }\n        if (!isNullOrUndefined(inline.nextNode)) {\n            return this.getNextTextElement(inline.nextNode);\n        }\n        return undefined;\n    };\n    /**\n     * @private\n     */\n    Selection.prototype.getNextRenderedElementBox = function (inline, indexInInline) {\n        if (inline instanceof FieldElementBox) {\n            var fieldBegin = inline;\n            if (fieldBegin.fieldType === 0) {\n                inline = this.getRenderedField(fieldBegin);\n                if (fieldBegin === inline) {\n                    return fieldBegin;\n                }\n            }\n            indexInInline = 1;\n        }\n        while (!isNullOrUndefined(inline) && indexInInline === inline.length && inline.nextNode instanceof FieldElementBox) {\n            var nextValidInline = this.getNextValidElement((inline.nextNode));\n            if (nextValidInline instanceof FieldElementBox && nextValidInline.fieldType === 0) {\n                var fieldBegin = nextValidInline;\n                inline = this.getRenderedField(fieldBegin);\n                if (!isNullOrUndefined(inline) && fieldBegin === inline) {\n                    return fieldBegin;\n                }\n                indexInInline = 1;\n            }\n            else {\n                inline = nextValidInline;\n            }\n        }\n        return inline;\n    };\n    /**\n     * @private\n     */\n    Selection.prototype.getElementBoxInternal = function (inline, index) {\n        var element = undefined;\n        element = inline;\n        return {\n            'element': element, 'index': index\n        };\n    };\n    /**\n     * Get Line widget\n     * @private\n     */\n    Selection.prototype.getLineWidget = function (inline, index) {\n        return this.getLineWidgetInternalInline(inline, index, true);\n    };\n    /**\n     * @private\n     */\n    Selection.prototype.getLineWidgetInternalInline = function (inline, index, moveToNextLine) {\n        var elementObj = this.getElementBox(inline, index, moveToNextLine);\n        var element = elementObj.element; //return index\n        index = elementObj.index;\n        if (!isNullOrUndefined(element)) {\n            if (moveToNextLine && element instanceof TextElementBox && element.text === '\\v' && index === 1) {\n                return this.getNextLineWidget(element.line.paragraph, element);\n            }\n            else {\n                return element.line;\n            }\n        }\n        var startInline = inline;\n        //ToDo: Check previous inline here.\n        var nextValidInline = this.getNextValidElementForField(startInline);\n        //If field separator/end exists at end of paragraph, then move to next paragraph.\n        if (isNullOrUndefined(nextValidInline)) {\n            var lineWidget = undefined;\n            var widget = startInline.line.paragraph;\n            if (widget.childWidgets.length > 0) {\n                lineWidget = widget.childWidgets[widget.childWidgets.length - 1];\n            }\n            return lineWidget;\n        }\n        else {\n            return this.getLineWidget(nextValidInline, 0);\n        }\n    };\n    /**\n     * Get next line widget\n     * @private\n     */\n    Selection.prototype.getNextLineWidget = function (paragraph, element) {\n        var lineWidget = undefined;\n        var widget = paragraph;\n        if (widget.childWidgets.length > 0) {\n            var widgetIndex = widget.childWidgets.indexOf(element.line);\n            if (widgetIndex === widget.childWidgets.length - 1) {\n                widget = paragraph;\n                // widget = paragraph.leafWidgets[paragraph.leafWidgets.length - 1];\n                widgetIndex = -1;\n            }\n            else if (widgetIndex > widget.childWidgets.length - 1) {\n                widget = this.getNextParagraphBlock(paragraph);\n                widgetIndex = -1;\n            }\n            else if (widgetIndex < 0) {\n                // widget = paragraph.leafWidgets[paragraph.leafWidgets.length - 1];\n                widget = paragraph;\n                widgetIndex = widget.childWidgets.indexOf(element.line);\n            }\n            lineWidget = widget.childWidgets[widgetIndex + 1];\n        }\n        return lineWidget;\n    };\n    /**\n     * Get Caret height\n     * @private\n     */\n    // tslint:disable-next-line:max-line-length\n    Selection.prototype.getCaretHeight = function (inline, index, format, isEmptySelection, topMargin, isItalic) {\n        var elementBoxInfo = this.getElementBox(inline, index, false);\n        var element = elementBoxInfo.element;\n        var currentInline = inline;\n        if (isNullOrUndefined(element)) {\n            if (currentInline instanceof FieldElementBox) {\n                return this.getFieldCharacterHeight(currentInline, format, isEmptySelection, topMargin, isItalic);\n            }\n            return { 'height': this.viewer.textHelper.getHeight(format).Height, 'topMargin': topMargin, 'isItalic': isItalic };\n        }\n        var margin = element.margin;\n        var heightElement = element.height;\n        var maxLineHeight = 0;\n        if (element instanceof ImageElementBox) {\n            var previousInline = this.getPreviousTextElement(inline);\n            var nextInline = this.getNextTextElement(inline);\n            if (isNullOrUndefined(previousInline) && isNullOrUndefined(nextInline)) {\n                var top_2 = 0;\n                var bottom = 0;\n                var paragarph = inline.line.paragraph;\n                var sizeInfo = this.getParagraphMarkSize(paragarph, top_2, bottom);\n                top_2 = sizeInfo.topMargin;\n                bottom = sizeInfo.bottomMargin;\n                maxLineHeight = sizeInfo.height;\n                isItalic = paragarph.characterFormat.italic;\n                if (!isEmptySelection) {\n                    maxLineHeight += paragarph.paragraphFormat.afterSpacing;\n                }\n            }\n            else if (isNullOrUndefined(previousInline)) {\n                isItalic = nextInline.characterFormat.italic;\n                return this.getCaretHeight(nextInline, 0, nextInline.characterFormat, isEmptySelection, topMargin, isItalic);\n            }\n            else {\n                if (!isNullOrUndefined(nextInline) && element instanceof ImageElementBox) {\n                    //Calculates the caret size using image character format.\n                    var textSizeInfo = this.viewer.textHelper.getHeight(element.characterFormat);\n                    var charHeight = textSizeInfo.Height;\n                    var baselineOffset = textSizeInfo.BaselineOffset;\n                    // tslint:disable-next-line:max-line-length\n                    maxLineHeight = (element.margin.top < 0 && baselineOffset > element.margin.top + element.height) ? element.margin.top + element.height + charHeight - baselineOffset : charHeight;\n                    if (!isEmptySelection) {\n                        maxLineHeight += element.margin.bottom;\n                    }\n                }\n                else {\n                    isItalic = previousInline.characterFormat.italic;\n                    // tslint:disable-next-line:max-line-length\n                    return this.getCaretHeight(previousInline, previousInline.length, previousInline.characterFormat, isEmptySelection, topMargin, isItalic);\n                }\n            }\n        }\n        else {\n            var baselineAlignment = format.baselineAlignment;\n            var elementHeight = heightElement;\n            if (baselineAlignment !== 'Normal' && isEmptySelection) {\n                //Set the caret height as sub/super script text height and updates the top margin for sub script text.\n                elementHeight = elementHeight / 1.5;\n                if (baselineAlignment === 'Subscript') {\n                    topMargin = heightElement - elementHeight;\n                }\n            }\n            maxLineHeight = (margin.top < 0 ? margin.top : 0) + elementHeight;\n            if (!isEmptySelection) {\n                maxLineHeight += margin.bottom;\n            }\n        }\n        if (!isEmptySelection) {\n            return { 'height': maxLineHeight, 'topMargin': topMargin, 'isItalic': isItalic };\n        }\n        var height = this.viewer.textHelper.getHeight(format).Height;\n        if (height > maxLineHeight) {\n            height = maxLineHeight;\n        }\n        return { 'height': height, 'topMargin': topMargin, 'isItalic': isItalic };\n    };\n    /**\n     * Get field characters height\n     * @private\n     */\n    // tslint:disable-next-line:max-line-length\n    Selection.prototype.getFieldCharacterHeight = function (startInline, format, isEmptySelection, topMargin, isItalic) {\n        var nextValidInline = this.getNextValidElementForField(startInline);\n        //If field separator/end exists at end of paragraph, then move to next paragraph.\n        if (isNullOrUndefined(nextValidInline)) {\n            var nextParagraph = startInline.line.paragraph;\n            var height = this.viewer.textHelper.getParagraphMarkSize(format).Height;\n            var top_3 = 0;\n            var bottom = 0;\n            var sizeInfo = this.getParagraphMarkSize(nextParagraph, top_3, bottom);\n            var maxLineHeight = sizeInfo.height;\n            top_3 = sizeInfo.topMargin;\n            bottom = sizeInfo.bottomMargin;\n            if (!isEmptySelection) {\n                maxLineHeight += bottom;\n                return { 'height': maxLineHeight, 'topMargin': topMargin, 'isItalic': isItalic };\n            }\n            if (height > maxLineHeight) {\n                height = maxLineHeight;\n            }\n            return { 'height': height, 'topMargin': topMargin, 'isItalic': isItalic };\n        }\n        else {\n            return this.getCaretHeight(nextValidInline, 0, format, isEmptySelection, topMargin, isItalic);\n        }\n    };\n    /**\n     * Get rendered inline\n     * @private\n     */\n    //FieldCharacter\n    Selection.prototype.getRenderedInline = function (inline, inlineIndex) {\n        var prevInline = this.getPreviousValidElement(inline);\n        while (prevInline instanceof FieldElementBox) {\n            prevInline = this.getPreviousTextElement(prevInline);\n            if (prevInline instanceof FieldElementBox) {\n                prevInline = prevInline.previousNode;\n            }\n        }\n        if (!isNullOrUndefined(prevInline)) {\n            inlineIndex = prevInline.length;\n            return { 'element': prevInline, 'index': inlineIndex };\n        }\n        inlineIndex = 0;\n        var nextInline = this.getNextRenderedElementBox(inline, 0);\n        if (nextInline instanceof FieldElementBox && nextInline.fieldType === 0) {\n            nextInline = nextInline.fieldSeparator;\n            nextInline = nextInline.nextNode;\n            while (nextInline instanceof FieldElementBox) {\n                if (nextInline instanceof FieldElementBox && nextInline.fieldType === 0\n                    && HelperMethods.isLinkedFieldCharacter(nextInline)) {\n                    if (isNullOrUndefined(nextInline.fieldSeparator)) {\n                        nextInline = nextInline.fieldEnd;\n                    }\n                    else {\n                        nextInline = nextInline.fieldSeparator;\n                    }\n                }\n                nextInline = nextInline.nextNode;\n            }\n        }\n        return { 'element': nextInline, 'index': inlineIndex };\n    };\n    //Field Begin\n    /**\n     * Get rendered field\n     * @private\n     */\n    Selection.prototype.getRenderedField = function (fieldBegin) {\n        var inline = fieldBegin;\n        if (isNullOrUndefined(fieldBegin.fieldSeparator)) {\n            inline = fieldBegin.fieldEnd;\n        }\n        else {\n            inline = fieldBegin.fieldSeparator;\n            var paragraph = inline.line.paragraph;\n            if (paragraph === fieldBegin.fieldEnd.line.paragraph\n                && !this.hasValidInline(paragraph, inline, fieldBegin.fieldEnd)) {\n                inline = fieldBegin.fieldEnd;\n            }\n            else {\n                return inline;\n            }\n        }\n        return inline;\n    };\n    /**\n     * Return true is inline is tha last inline\n     * @private\n     */\n    Selection.prototype.isLastRenderedInline = function (inline, index) {\n        while (index === inline.length && inline.nextNode instanceof FieldElementBox) {\n            var nextValidInline = this.getNextValidElement(inline.nextNode);\n            index = 0;\n            if (nextValidInline instanceof FieldElementBox && nextValidInline.fieldType === 0) {\n                inline = nextValidInline;\n            }\n            if (inline instanceof FieldElementBox && inline.fieldType === 0 && !isNullOrUndefined(inline.fieldEnd)) {\n                var fieldBegin = inline;\n                if (isNullOrUndefined(fieldBegin.fieldSeparator)) {\n                    inline = fieldBegin.fieldEnd;\n                    index = 1;\n                }\n                else {\n                    inline = fieldBegin.fieldSeparator;\n                    var paragraph = inline.line.paragraph;\n                    index = 1;\n                    if (paragraph === fieldBegin.fieldEnd.line.paragraph\n                        && !this.hasValidInline(paragraph, inline, fieldBegin.fieldEnd)) {\n                        inline = fieldBegin.fieldEnd;\n                    }\n                    else {\n                        break;\n                    }\n                }\n            }\n        }\n        return index === inline.length && isNullOrUndefined(inline.nextNode);\n    };\n    /**\n     * Get page\n     * @private\n     */\n    Selection.prototype.getPage = function (widget) {\n        var page = undefined;\n        if (widget.containerWidget instanceof BlockContainer) {\n            var bodyWidget = widget.containerWidget;\n            page = widget.containerWidget.page;\n        }\n        else if (!isNullOrUndefined(widget.containerWidget)) {\n            page = this.getPage(widget.containerWidget);\n        }\n        return page;\n    };\n    /**\n     * Clear Selection highlight\n     * @private\n     */\n    Selection.prototype.clearSelectionHighlightInSelectedWidgets = function () {\n        var isNonEmptySelection = false;\n        var widgets = this.selectedWidgets.keys;\n        for (var i = 0; i < widgets.length; i++) {\n            this.removeSelectionHighlight(widgets[i]);\n            isNonEmptySelection = true;\n        }\n        this.selectedWidgets.clear();\n        return isNonEmptySelection;\n    };\n    /**\n     * Clear selection highlight\n     * @private\n     */\n    Selection.prototype.clearChildSelectionHighlight = function (widget) {\n        for (var i = 0; i < widget.childWidgets.length; i++) {\n            if (widget.childWidgets[i] instanceof LineWidget) {\n                this.clearSelectionHighlightLineWidget(widget.childWidgets[i]);\n            }\n            else if (widget.childWidgets[i] instanceof TableCellWidget) {\n                this.clearSelectionHighlight(widget.childWidgets[i]);\n            }\n            else if (widget.childWidgets[i] instanceof Widget) {\n                this.clearChildSelectionHighlight(widget.childWidgets[i]);\n            }\n        }\n    };\n    /**\n     * Get line widget from paragraph widget\n     * @private\n     */\n    //Body Widget\n    Selection.prototype.getLineWidgetBodyWidget = function (widget, point) {\n        for (var i = 0; i < widget.childWidgets.length; i++) {\n            var childWidget = widget.childWidgets[i];\n            if (childWidget instanceof Widget && childWidget.y <= point.y\n                && (childWidget.y + childWidget.height) >= point.y) {\n                if (childWidget instanceof ParagraphWidget) {\n                    return this.getLineWidgetParaWidget(childWidget, point);\n                }\n                else {\n                    return this.getLineWidgetTableWidget(childWidget, point);\n                }\n            }\n        }\n        var line = undefined;\n        if (widget.childWidgets.length > 0) {\n            var firstChild = widget.childWidgets[0];\n            if (firstChild instanceof Widget && firstChild.y <= point.y) {\n                if (widget.childWidgets[widget.childWidgets.length - 1] instanceof ParagraphWidget) {\n                    // tslint:disable-next-line:max-line-length\n                    line = this.getLineWidgetParaWidget(widget.childWidgets[widget.childWidgets.length - 1], point);\n                }\n                else {\n                    // tslint:disable-next-line:max-line-length\n                    line = this.getLineWidgetTableWidget(widget.childWidgets[widget.childWidgets.length - 1], point);\n                }\n            }\n            else {\n                var childWidget = undefined;\n                if (firstChild instanceof Widget) {\n                    childWidget = firstChild;\n                }\n                if (!isNullOrUndefined(childWidget)) {\n                    if (childWidget instanceof ParagraphWidget) {\n                        line = this.getLineWidgetParaWidget(firstChild, point);\n                    }\n                    else {\n                        line = this.getLineWidgetTableWidget(firstChild, point);\n                    }\n                }\n            }\n        }\n        return line;\n    };\n    //ParagraphWidget\n    /**\n     * Get line widget from paragraph widget\n     * @private\n     */\n    Selection.prototype.getLineWidgetParaWidget = function (widget, point) {\n        var childWidgets = widget.childWidgets;\n        var top = widget.y;\n        for (var i = 0; i < childWidgets.length; i++) {\n            if (top <= point.y\n                && (top + childWidgets[i].height) >= point.y) {\n                return childWidgets[i];\n            }\n            top += childWidgets[i].height;\n        }\n        var lineWidget = undefined;\n        if (childWidgets.length > 0) {\n            if (widget.y <= point.y) {\n                lineWidget = childWidgets[childWidgets.length - 1];\n            }\n            else {\n                lineWidget = childWidgets[0];\n            }\n        }\n        return lineWidget;\n    };\n    /**\n     * highlight paragraph widget\n     * @private\n     */\n    // tslint:disable-next-line:max-line-length\n    Selection.prototype.highlightParagraph = function (widget, startIndex, endLine, endElement, endIndex) {\n        var top = 0;\n        for (var i = startIndex; i < widget.childWidgets.length; i++) {\n            var line = widget.childWidgets[i];\n            if (i === startIndex) {\n                top = this.getTop(line);\n            }\n            var left = this.getLeft(line);\n            if (line === endLine) {\n                //Selection ends in current line.\n                var right = this.getLeftInternal(endLine, endElement, endIndex);\n                this.createHighlightBorder(line, right - left, left, top);\n                return;\n            }\n            this.createHighlightBorder(line, this.getWidth(line, true) - (left - widget.x), left, top);\n            top += line.height;\n        }\n    };\n    //Table Widget\n    /**\n     * Get line widget form table widget\n     * @private\n     */\n    Selection.prototype.getLineWidgetTableWidget = function (widget, point) {\n        var lineWidget = undefined;\n        for (var i = 0; i < widget.childWidgets.length; i++) {\n            //Removed the height condition check to handle the vertically merged cells.\n            var childWidget = widget.childWidgets[i];\n            if (childWidget instanceof TableRowWidget && childWidget.y <= point.y) {\n                lineWidget = this.getLineWidgetRowWidget(childWidget, point);\n                var cellWidget = undefined;\n                if (!isNullOrUndefined(lineWidget) && lineWidget.paragraph.containerWidget instanceof TableCellWidget) {\n                    cellWidget = lineWidget.paragraph.containerWidget;\n                }\n                var cellSpacing = 0;\n                var rowSpan = 0;\n                if (!isNullOrUndefined(cellWidget)) {\n                    var tableWidget = cellWidget.ownerRow.containerWidget;\n                    cellSpacing = HelperMethods.convertPointToPixel(tableWidget.tableFormat.cellSpacing);\n                    rowSpan = cellWidget.cellFormat.rowSpan;\n                }\n                var leftCellSpacing = 0;\n                var rightCellSpacing = 0;\n                var topCellSpacing = 0;\n                var bottomCellSpacing = 0;\n                if (cellSpacing > 0) {\n                    leftCellSpacing = cellWidget.cellIndex === 0 ? cellSpacing : cellSpacing / 2;\n                    // tslint:disable-next-line:max-line-length\n                    rightCellSpacing = cellWidget.cellIndex === cellWidget.ownerRow.childWidgets.length - 1 ? cellSpacing : cellSpacing / 2;\n                    var rowWidget = undefined;\n                    if (cellWidget.containerWidget instanceof TableRowWidget) {\n                        rowWidget = cellWidget.containerWidget;\n                    }\n                    var tableWidget = undefined;\n                    if (cellWidget.containerWidget.containerWidget instanceof TableWidget) {\n                        tableWidget = cellWidget.containerWidget.containerWidget;\n                    }\n                    if (!isNullOrUndefined(rowWidget) && !isNullOrUndefined(tableWidget)) {\n                        topCellSpacing = cellWidget.ownerRow.rowIndex === 0 ? cellSpacing : cellSpacing / 2;\n                        if (cellWidget.ownerRow.rowIndex + rowSpan === cellWidget.ownerTable.childWidgets.length) {\n                            bottomCellSpacing = cellSpacing;\n                        }\n                        else {\n                            bottomCellSpacing = cellSpacing / 2;\n                        }\n                    }\n                }\n                if ((!isNullOrUndefined(lineWidget) && lineWidget.paragraph.x <= point.x\n                    && lineWidget.paragraph.x + lineWidget.width >= point.x\n                    && lineWidget.paragraph.y <= point.y && this.getTop(lineWidget) + lineWidget.height >= point.y)\n                    || (!isNullOrUndefined(cellWidget) && cellWidget.x - cellWidget.margin.left - leftCellSpacing <= point.x\n                        && cellWidget.x + cellWidget.width + cellWidget.margin.right + rightCellSpacing >= point.x\n                        && cellWidget.y - cellWidget.margin.top - topCellSpacing <= point.y\n                        && cellWidget.y + cellWidget.height + cellWidget.margin.bottom + bottomCellSpacing >= point.y)) {\n                    break;\n                }\n            }\n        }\n        return lineWidget;\n    };\n    //TableRowWidget\n    /**\n     * Get line widget fom row\n     * @private\n     */\n    Selection.prototype.getLineWidgetRowWidget = function (widget, point) {\n        for (var i = 0; i < widget.childWidgets.length; i++) {\n            var cellSpacing = 0;\n            cellSpacing = HelperMethods.convertPointToPixel(widget.ownerTable.tableFormat.cellSpacing);\n            var leftCellSpacing = 0;\n            var rightCellSpacing = 0;\n            if (cellSpacing > 0) {\n                leftCellSpacing = widget.childWidgets[i].columnIndex === 0 ? cellSpacing : cellSpacing / 2;\n                // tslint:disable-next-line:max-line-length\n                rightCellSpacing = widget.childWidgets[i].cellIndex === widget.childWidgets[i].ownerRow.childWidgets.length - 1 ? cellSpacing : cellSpacing / 2;\n            }\n            if (widget.childWidgets[i].x -\n                // tslint:disable-next-line:max-line-length\n                widget.childWidgets[i].margin.left - leftCellSpacing <= point.x && (widget.childWidgets[i].x +\n                // tslint:disable-next-line:max-line-length\n                widget.childWidgets[i].width) + widget.childWidgets[i].margin.right + rightCellSpacing >= point.x) {\n                return this.getLineWidgetCellWidget(widget.childWidgets[i], point);\n            }\n        }\n        var lineWidget = undefined;\n        if (widget.childWidgets.length > 0) {\n            if (widget.childWidgets[0].x <= point.x) {\n                lineWidget = this.getLineWidgetCellWidget(widget.childWidgets[widget.childWidgets.length - 1], point);\n            }\n            else {\n                lineWidget = this.getLineWidgetCellWidget(widget.childWidgets[0], point);\n            }\n        }\n        return lineWidget;\n    };\n    /**\n     * @private\n     */\n    Selection.prototype.getFirstBlock = function (cell) {\n        if (cell.childWidgets.length > 0) {\n            return cell.childWidgets[0];\n        }\n        return undefined;\n    };\n    //Table Cell Widget\n    /**\n     * Highlight selected cell widget\n     * @private\n     */\n    Selection.prototype.highlightCellWidget = function (widget) {\n        var widgets = [];\n        if (widget.previousSplitWidget || widget.nextSplitWidget) {\n            widgets = widget.getSplitWidgets();\n        }\n        else {\n            widgets.push(widget);\n        }\n        for (var i = 0; i < widgets.length; i++) {\n            widget = widgets[i];\n            //Clears Selection highlight of the child widgets.\n            this.clearChildSelectionHighlight(widget);\n            //Highlights the entire cell.\n            this.createHighlightBorderInsideTable(widget);\n        }\n    };\n    /**\n     * Clear selection highlight\n     * @private\n     */\n    Selection.prototype.clearSelectionHighlight = function (widget) {\n        if (this.selectedWidgets.containsKey(widget)) {\n            this.removeSelectionHighlight(widget);\n            this.selectedWidgets.remove(widget);\n        }\n    };\n    /**\n     * Get line widget from cell widget\n     * @private\n     */\n    Selection.prototype.getLineWidgetCellWidget = function (widget, point) {\n        for (var i = 0; i < widget.childWidgets.length; i++) {\n            if (widget.childWidgets[i].y <= point.y\n                && (widget.childWidgets[i].y + widget.childWidgets[i].height) >= point.y) {\n                if (widget.childWidgets[i] instanceof ParagraphWidget) {\n                    return this.getLineWidgetParaWidget(widget.childWidgets[i], point);\n                }\n                else {\n                    return this.getLineWidgetTableWidget(widget.childWidgets[i], point);\n                }\n            }\n        }\n        var lineWidget = undefined;\n        if (widget.childWidgets.length > 0) {\n            if (widget.childWidgets[0].y <= point.y) {\n                if (widget.childWidgets[widget.childWidgets.length - 1] instanceof ParagraphWidget) {\n                    // tslint:disable-next-line:max-line-length\n                    lineWidget = this.getLineWidgetParaWidget(widget.childWidgets[widget.childWidgets.length - 1], point);\n                }\n                else {\n                    lineWidget = this.getLineWidgetTableWidget(widget.childWidgets[0], point);\n                }\n            }\n        }\n        return lineWidget;\n    };\n    //LineWidget\n    /**\n     * update text position\n     * @private\n     */\n    Selection.prototype.updateTextPosition = function (widget, point) {\n        var caretPosition = point;\n        var element = undefined;\n        var index = 0;\n        var isImageSelected = false;\n        var isImageSelectedObj = this.updateTextPositionIn(widget, element, index, point, false);\n        if (!isNullOrUndefined(isImageSelectedObj)) {\n            element = isImageSelectedObj.element;\n            index = isImageSelectedObj.index;\n            caretPosition = isImageSelectedObj.caretPosition;\n            isImageSelected = isImageSelectedObj.isImageSelected;\n            this.isImageSelected = isImageSelected;\n        }\n        if (isImageSelected) {\n            this.selectInternal(widget, element, index, caretPosition);\n            if (index === 0) {\n                this.extendForward();\n            }\n            else {\n                this.extendBackward();\n            }\n        }\n        else {\n            this.selectInternal(widget, element, index, caretPosition);\n        }\n    };\n    /**\n     * @private\n     */\n    /* tslint:disable */\n    Selection.prototype.updateTextPositionIn = function (widget, inline, index, caretPosition, includeParagraphMark) {\n        var isImageSelected = false;\n        var top = this.getTop(widget);\n        var left = widget.paragraph.x;\n        var elementValues = this.getFirstElement(widget, left);\n        var element = elementValues.element;\n        left = elementValues.left;\n        if (isNullOrUndefined(element)) {\n            var topMargin = 0;\n            var bottomMargin = 0;\n            var size = this.getParagraphMarkSize(widget.paragraph, topMargin, bottomMargin);\n            topMargin = size.topMargin;\n            bottomMargin = size.bottomMargin;\n            var selectParaMark = this.viewer.mouseDownOffset.y >= top && this.viewer.mouseDownOffset.y < top + widget.height ? (this.viewer.mouseDownOffset.x < left + size.width) : true;\n            if (selectParaMark && includeParagraphMark && caretPosition.x > left + size.width / 2) {\n                left += size.width;\n                if (widget.children.length > 0) {\n                    inline = widget.children[widget.children.length - 1];\n                    index = inline.length;\n                }\n                index++;\n            }\n            caretPosition = new Point(left, topMargin > 0 ? top + topMargin : top);\n        }\n        else {\n            if (!isNullOrUndefined(element)) {\n                if (caretPosition.x > left + element.margin.left) {\n                    for (var i = widget.children.indexOf(element); i < widget.children.length; i++) {\n                        element = widget.children[i];\n                        if (caretPosition.x < left + element.margin.left + element.width || i === widget.children.length - 1) {\n                            break;\n                        }\n                        left += element.margin.left + element.width;\n                    }\n                    if (caretPosition.x > left + element.margin.left + element.width) {\n                        //Line End\n                        index = element instanceof TextElementBox ? element.length : 1;\n                        left += element.margin.left + element.width;\n                    }\n                    else if (element instanceof TextElementBox) {\n                        var x = caretPosition.x - left - element.margin.left;\n                        left += element.margin.left;\n                        var prevWidth = 0;\n                        var charIndex = 0;\n                        for (var i = 1; i <= element.length; i++) {\n                            var width = 0;\n                            if (i === element.length) {\n                                width = element.width;\n                            }\n                            else {\n                                width = this.viewer.textHelper.getWidth(element.text.substr(0, i), element.characterFormat);\n                            }\n                            if (x < width || i === element.length) {\n                                //Updates exact left position of the caret.\n                                var charWidth = width - prevWidth;\n                                if (x - prevWidth > charWidth / 2) {\n                                    left += width;\n                                    charIndex = i;\n                                }\n                                else {\n                                    left += prevWidth;\n                                    charIndex = i - 1;\n                                    if (i === 1 && element !== widget.children[0]) {\n                                        var curIndex = widget.children.indexOf(element);\n                                        if (!(widget.children[curIndex - 1] instanceof ListTextElementBox)) {\n                                            element = widget.children[curIndex - 1];\n                                            charIndex = element instanceof TextElementBox ? element.length : 1;\n                                        }\n                                    }\n                                }\n                                break;\n                            }\n                            prevWidth = width;\n                        }\n                        index = charIndex;\n                    }\n                    else {\n                        isImageSelected = element instanceof ImageElementBox;\n                        if (caretPosition.x - left - element.margin.left > element.width / 2) {\n                            index = 1;\n                            left += element.margin.left + element.width;\n                        }\n                        else if (element !== widget.children[0] && !isImageSelected) {\n                            var curIndex = widget.children.indexOf(element);\n                            if (!(widget.children[curIndex - 1] instanceof ListTextElementBox)) {\n                                element = widget.children[curIndex - 1];\n                                index = element instanceof TextElementBox ? element.length : 1;\n                            }\n                        }\n                    }\n                    if (element instanceof TextElementBox && element.text === '\\v') {\n                        index = 0;\n                    }\n                }\n                else {\n                    left += element.margin.left;\n                }\n                if (element instanceof TextElementBox) {\n                    top += element.margin.top > 0 ? element.margin.top : 0;\n                }\n                else {\n                    var textMetrics = this.viewer.textHelper.getHeight(element.characterFormat); //for ascent and descent\n                    var height = element.height;\n                    if (element instanceof BookmarkElementBox) {\n                        height = textMetrics.Height; //after text helper class\n                    }\n                    top += element.margin.top + height - textMetrics.BaselineOffset;\n                }\n                inline = element;\n                var inlineObj = this.validateTextPosition(inline, index);\n                inline = inlineObj.element;\n                index = inlineObj.index;\n                var isParagraphEnd = isNullOrUndefined(inline.nextNode) && index === inline.length;\n                var isLineEnd = isNullOrUndefined(inline.nextNode)\n                    && inline instanceof TextElementBox && inline.text === '\\v';\n                if (includeParagraphMark && inline.nextNode instanceof FieldElementBox && index === inline.length) {\n                    isParagraphEnd = this.isLastRenderedInline(inline, index);\n                }\n                if (includeParagraphMark && isParagraphEnd || isLineEnd) {\n                    var width = 0;\n                    //Include width of Paragraph mark.\n                    if (isParagraphEnd) {\n                        width = this.viewer.textHelper.getParagraphMarkWidth(widget.paragraph.characterFormat);\n                        var selectParaMark = this.viewer.mouseDownOffset.y >= top && this.viewer.mouseDownOffset.y < top + widget.height ? (this.viewer.mouseDownOffset.x < left + width) : true;\n                        if (selectParaMark && caretPosition.x > left + width / 2) {\n                            left += width;\n                            index = inline.length + 1;\n                        }\n                        //Include width of line break mark.\n                    }\n                    else if (isLineEnd) {\n                        width = element.width;\n                        left += width;\n                        index = inline.length;\n                    }\n                }\n                caretPosition = new Point(left, top);\n            }\n        }\n        return {\n            'element': inline,\n            'index': index,\n            'caretPosition': caretPosition,\n            'isImageSelected': isImageSelected\n        };\n    };\n    /* tslint:enable */\n    /**\n     * Get text length if the line widget\n     * @private\n     */\n    // public getTextLength(viewer: LayoutViewer, widget: LineWidget, element: ElementBox): number {\n    //     let length: number = 0;\n    //     let count: number = widget.children.indexOf(element);\n    //     if (widget.children.length > 0 && widget.children[0] instanceof ListTextElementBox) {\n    //         if (widget.children[1] instanceof ListTextElementBox) {\n    //             count -= 2;\n    //         } else {\n    //             count -= 1;\n    //         }\n    //     }\n    //     for (let i: number = 1; i < count; i++) {\n    //         length += widget.children[i].length;\n    //     }\n    //     return length;\n    // }\n    /**\n     * Get Line widget left\n     * @private\n     */\n    Selection.prototype.getLeft = function (widget) {\n        var left = widget.paragraph.x;\n        var paragraphFormat = widget.paragraph.paragraphFormat;\n        if (this.isParagraphFirstLine(widget) && !(paragraphFormat.textAlignment === 'Right')) {\n            left += HelperMethods.convertPointToPixel(paragraphFormat.firstLineIndent);\n        }\n        for (var i = 0; i < widget.children.length; i++) {\n            var element = widget.children[i];\n            if (element instanceof ListTextElementBox) {\n                if (i === 0) {\n                    left += element.margin.left + element.width;\n                }\n                else {\n                    left += element.width;\n                }\n            }\n            else {\n                left += element.margin.left;\n                break;\n            }\n        }\n        return left;\n    };\n    /**\n     * Get line widget top\n     * @private\n     */\n    Selection.prototype.getTop = function (widget) {\n        var top = widget.paragraph.y;\n        var count = widget.paragraph.childWidgets.indexOf(widget);\n        for (var i = 0; i < count; i++) {\n            top += widget.paragraph.childWidgets[i].height;\n        }\n        return top;\n    };\n    /**\n     * Get first element the widget\n     * @private\n     */\n    Selection.prototype.getFirstElement = function (widget, left) {\n        var firstLineIndent = 0;\n        if (this.isParagraphFirstLine(widget)) {\n            firstLineIndent = HelperMethods.convertPointToPixel(widget.paragraph.paragraphFormat.firstLineIndent);\n        }\n        left += firstLineIndent;\n        var element = undefined;\n        for (var i = 0; i < widget.children.length; i++) {\n            element = widget.children[i];\n            if (element instanceof ListTextElementBox) {\n                left += element.margin.left + element.width;\n                element = undefined;\n                // }\n                //  else if (element instanceof FieldElementBox || element instanceof BookmarkElementBox\n                //     || (element.nextNode instanceof FieldElementBox && ((element.nextNode as FieldElementBox).fieldType === 2))) {\n                //     element = undefined;\n            }\n            else {\n                break;\n            }\n        }\n        return { 'element': element, 'left': left };\n    };\n    /**\n     * Return inline index\n     * @private\n     */\n    //ElementBox\n    Selection.prototype.getIndexInInline = function (elementBox) {\n        var indexInInline = 0;\n        if (elementBox instanceof TextElementBox) {\n            var count = elementBox.line.children.indexOf(elementBox);\n            for (var i = 0; i < count; i++) {\n                var element = elementBox.line.children[i];\n                if (element instanceof FieldElementBox || element instanceof ListTextElementBox) {\n                    continue;\n                }\n                indexInInline += element.length;\n            }\n        }\n        return indexInInline;\n    };\n    /**\n     * Return true if widget is first inline of paragraph\n     * @private\n     */\n    Selection.prototype.isParagraphFirstLine = function (widget) {\n        if (isNullOrUndefined(widget.paragraph.previousSplitWidget) &&\n            widget === widget.paragraph.firstChild) {\n            return true;\n        }\n        return false;\n    };\n    /**\n     * @private\n     */\n    Selection.prototype.isParagraphLastLine = function (widget) {\n        if (isNullOrUndefined(widget.paragraph.nextSplitWidget)\n            && widget === widget.paragraph.lastChild) {\n            return true;\n        }\n        return false;\n    };\n    /**\n     * Return line widget width\n     * @private\n     */\n    Selection.prototype.getWidth = function (widget, includeParagraphMark) {\n        var width = 0;\n        if (this.isParagraphFirstLine(widget)) {\n            width += HelperMethods.convertPointToPixel(widget.paragraph.paragraphFormat.firstLineIndent);\n        }\n        for (var i = 0; i < widget.children.length; i++) {\n            width += widget.children[i].margin.left + widget.children[i].width;\n        }\n        if (includeParagraphMark && widget.paragraph.childWidgets.indexOf(widget) === widget.paragraph.childWidgets.length - 1\n            && isNullOrUndefined(widget.paragraph.nextSplitWidget)) {\n            width += this.viewer.textHelper.getParagraphMarkWidth(widget.paragraph.characterFormat);\n        }\n        return width;\n    };\n    /**\n     * Return line widget left\n     * @private\n     */\n    Selection.prototype.getLeftInternal = function (widget, elementBox, index) {\n        var left = widget.paragraph.x;\n        if (this.isParagraphFirstLine(widget)) {\n            // tslint:disable-next-line:max-line-length\n            left += HelperMethods.convertPointToPixel(widget.paragraph.paragraphFormat.firstLineIndent);\n        }\n        var count = widget.children.indexOf(elementBox);\n        if ((widget.children.length === 1 && widget.children[0] instanceof ListTextElementBox) || (widget.children.length === 2\n            && widget.children[0] instanceof ListTextElementBox && widget.children[1] instanceof ListTextElementBox)) {\n            count = widget.children.length;\n        }\n        for (var i = 0; i < count; i++) {\n            var widgetInternal = widget.children[i];\n            // if (widgetInternal instanceof FieldElementBox) {\n            //     continue;\n            // }\n            if (i === 1 && widget.children[i] instanceof ListTextElementBox) {\n                left += widget.children[i].width;\n            }\n            else {\n                left += widget.children[i].margin.left + widget.children[i].width;\n            }\n        }\n        if (!isNullOrUndefined(elementBox)) {\n            left += elementBox.margin.left;\n        }\n        if (elementBox instanceof TextElementBox) {\n            if (index === elementBox.length) {\n                left += elementBox.width;\n            }\n            else if (index > elementBox.length) {\n                // tslint:disable-next-line:max-line-length\n                left += elementBox.width + this.viewer.textHelper.getParagraphMarkWidth(elementBox.line.paragraph.characterFormat);\n            }\n            else {\n                // tslint:disable-next-line:max-line-length\n                left += this.viewer.textHelper.getWidth(elementBox.text.substr(0, index), elementBox.characterFormat);\n            }\n        }\n        else if (index > 0) {\n            if (!isNullOrUndefined(elementBox) && !(elementBox instanceof ListTextElementBox)) {\n                left += elementBox.width;\n                if (index === 2) {\n                    var paragraph = elementBox.line.paragraph;\n                    left += this.viewer.textHelper.getParagraphMarkWidth(paragraph.characterFormat);\n                }\n            }\n            else {\n                left += this.viewer.textHelper.getParagraphMarkWidth(widget.paragraph.characterFormat);\n            }\n        }\n        return left;\n    };\n    /**\n     * Return line widget start offset\n     * @private\n     */\n    Selection.prototype.getLineStartLeft = function (widget) {\n        var left = widget.paragraph.x;\n        if (this.isParagraphFirstLine(widget)) {\n            left += HelperMethods.convertPointToPixel(widget.paragraph.paragraphFormat.firstLineIndent);\n        }\n        if (widget.children.length > 0) {\n            left += widget.children[0].margin.left;\n        }\n        return left;\n    };\n    /**\n     * Update text position\n     * @private\n     */\n    Selection.prototype.updateTextPositionWidget = function (widget, point, textPosition, includeParagraphMark) {\n        var caretPosition = point;\n        var inline = undefined;\n        var index = 0;\n        var updatePositionObj;\n        updatePositionObj = this.updateTextPositionIn(widget, inline, index, caretPosition, includeParagraphMark);\n        inline = updatePositionObj.element;\n        index = updatePositionObj.index;\n        caretPosition = updatePositionObj.caretPosition;\n        textPosition.setPositionForSelection(widget, inline, index, caretPosition);\n    };\n    /**\n     * Clear selection highlight\n     * @private\n     */\n    Selection.prototype.clearSelectionHighlightLineWidget = function (widget) {\n        if (!isNullOrUndefined(this.owner) && this.selectedWidgets.length > 0) {\n            this.clearSelectionHighlight(this);\n        }\n    };\n    /**\n     * Return first element from line widget\n     * @private\n     */\n    Selection.prototype.getFirstElementInternal = function (widget) {\n        var element = undefined;\n        for (var i = 0; i < widget.children.length; i++) {\n            element = widget.children[i];\n            if (element instanceof ListTextElementBox) {\n                element = undefined;\n            }\n            else {\n                break;\n            }\n        }\n        return element;\n    };\n    //Selection API    \n    /**\n     * Select content between given range\n     * @private\n     */\n    Selection.prototype.selectRange = function (startPosition, endPosition) {\n        this.start.setPositionInternal(startPosition);\n        this.end.setPositionInternal(endPosition);\n        this.upDownSelectionLength = this.end.location.x;\n        this.fireSelectionChanged(true);\n    };\n    /**\n     * Selects current paragraph\n     * @private\n     */\n    Selection.prototype.selectParagraph = function (paragraph, positionAtStart) {\n        var line = paragraph.firstChild;\n        if (positionAtStart) {\n            this.start.setPosition(line, positionAtStart);\n        }\n        else {\n            var endOffset = line.getEndOffset();\n            this.start.setPositionParagraph(line, endOffset);\n        }\n        this.end.setPositionInternal(this.start);\n        this.upDownSelectionLength = this.start.location.x;\n        this.fireSelectionChanged(true);\n    };\n    /**\n     * @private\n     */\n    Selection.prototype.setPositionForBlock = function (block, selectFirstBlock) {\n        var position;\n        if (block instanceof TableWidget) {\n            if (selectFirstBlock) {\n                block = this.getFirstParagraphInFirstCell(block);\n            }\n            else {\n                block = this.getLastParagraphInLastCell(block);\n            }\n        }\n        if (block instanceof ParagraphWidget) {\n            position = new TextPosition(this.owner);\n            if (selectFirstBlock) {\n                position.setPosition(block.firstChild, true);\n            }\n            else {\n                var line = block.lastChild;\n                position.setPositionParagraph(line, line.getEndOffset());\n            }\n        }\n        return position;\n    };\n    /**\n     * Select content in given text position\n     * @private\n     */\n    Selection.prototype.selectContent = function (textPosition, clearMultiSelection) {\n        if (isNullOrUndefined(textPosition)) {\n            throw new Error('textPosition is undefined.');\n        }\n        this.start.setPositionInternal(textPosition);\n        this.end.setPositionInternal(textPosition);\n        this.upDownSelectionLength = this.end.location.x;\n        this.fireSelectionChanged(true);\n    };\n    /**\n     * Select paragraph\n     * @private\n     */\n    Selection.prototype.selectInternal = function (lineWidget, element, index, physicalLocation) {\n        this.start.setPositionForSelection(lineWidget, element, index, physicalLocation);\n        this.end.setPositionInternal(this.start);\n        this.upDownSelectionLength = physicalLocation.x;\n        this.fireSelectionChanged(true);\n    };\n    /**\n     * @private\n     */\n    Selection.prototype.selects = function (lineWidget, offset, skipSelectionChange) {\n        this.viewer.clearSelectionHighlight();\n        this.start.setPositionForLineWidget(lineWidget, offset);\n        this.end.setPositionInternal(this.start);\n        if (!skipSelectionChange) {\n            this.fireSelectionChanged(true);\n        }\n    };\n    /**\n     * Select content between start and end position\n     * @private\n     */\n    Selection.prototype.selectPosition = function (startPosition, endPosition) {\n        if (isNullOrUndefined(startPosition) || isNullOrUndefined(endPosition)) {\n            throw new Error('TextPosition cannot be undefined');\n        }\n        if (isNullOrUndefined(startPosition.paragraph)\n            || startPosition.offset > this.getParagraphLength(startPosition.paragraph) + 1) {\n            throw new Error('Start TextPosition is not valid.');\n        }\n        if (isNullOrUndefined(endPosition.paragraph)\n            || endPosition.offset > this.getParagraphLength(endPosition.paragraph) + 1) {\n            throw new Error('End TextPosition is not valid.');\n        }\n        if (startPosition.isAtSamePosition(endPosition)) {\n            // Select start position.\n            this.selectRange(startPosition, startPosition);\n        }\n        else {\n            // If both text position exists within same comment or outside comment, and not at same position.\n            if (startPosition.isExistBefore(endPosition)) {\n                // tslint:disable-next-line:max-line-length\n                endPosition.validateForwardFieldSelection(startPosition.getHierarchicalIndexInternal(), endPosition.getHierarchicalIndexInternal());\n            }\n            else {\n                // tslint:disable-next-line:max-line-length\n                startPosition.validateForwardFieldSelection(endPosition.getHierarchicalIndexInternal(), startPosition.getHierarchicalIndexInternal());\n            }\n            this.selectRange(startPosition, endPosition);\n        }\n    };\n    /**\n     * Notify selection change event\n     * @private\n     */\n    Selection.prototype.fireSelectionChanged = function (isSelectionChanged) {\n        if (!this.isEmpty) {\n            if (this.isForward) {\n                this.start.updatePhysicalPosition(true);\n                this.end.updatePhysicalPosition(false);\n            }\n            else {\n                this.start.updatePhysicalPosition(false);\n                this.end.updatePhysicalPosition(true);\n            }\n        }\n        if (!this.skipFormatRetrieval) {\n            this.retrieveCurrentFormatProperties();\n        }\n        this.viewer.clearSelectionHighlight();\n        this.hideToolTip();\n        if (this.owner.isLayoutEnabled && !this.owner.isShiftingEnabled) {\n            this.highlightSelection(true);\n        }\n        if (isSelectionChanged) {\n            if (this.start.paragraph.isInHeaderFooter && !this.owner.enableHeaderAndFooter) {\n                this.owner.enableHeaderAndFooter = true;\n            }\n            else if (!this.start.paragraph.isInHeaderFooter && this.owner.enableHeaderAndFooter) {\n                this.owner.enableHeaderAndFooter = false;\n            }\n            this.owner.fireSelectionChange();\n        }\n        this.viewer.updateFocus();\n    };\n    //Formats Retrieval\n    /**\n     * Retrieve all current selection format\n     * @private\n     */\n    Selection.prototype.retrieveCurrentFormatProperties = function () {\n        this.isRetrieveFormatting = true;\n        var startPosition = this.start;\n        var endPosition = this.end;\n        if (!this.isForward) {\n            startPosition = this.end;\n            endPosition = this.start;\n        }\n        this.retrieveImageFormat(startPosition, endPosition);\n        this.retrieveCharacterFormat(startPosition, endPosition);\n        this.retrieveParagraphFormat(startPosition, endPosition);\n        this.retrieveSectionFormat(startPosition, endPosition);\n        this.retrieveTableFormat(startPosition, endPosition);\n        if (!this.isImageSelected) {\n            this.imageFormat.clearImageFormat();\n        }\n        this.isRetrieveFormatting = false;\n        this.setCurrentContextType();\n    };\n    /**\n     * @private\n     */\n    Selection.prototype.retrieveImageFormat = function (start, end) {\n        var image;\n        if (start.currentWidget === end.currentWidget && start.offset + 1 === end.offset) {\n            var elementInfo = end.currentWidget.getInline(end.offset, 0);\n            image = elementInfo.element;\n            var index = elementInfo.index;\n            if (image instanceof ImageElementBox) {\n                var startOffset = start.currentWidget.getOffset(image, 0);\n                if (startOffset !== start.offset) {\n                    image = undefined;\n                }\n            }\n        }\n        if (image instanceof ImageElementBox) {\n            this.imageFormat.copyImageFormat(image);\n        }\n        else {\n            this.imageFormat.clearImageFormat();\n        }\n    };\n    Selection.prototype.setCurrentContextType = function () {\n        var contextIsinImage = this.imageFormat.image ? true : false;\n        var contextIsinTable = (isNullOrUndefined(this.tableFormat) || isNullOrUndefined(this.tableFormat.table)) ? false : true;\n        var style = this.start.paragraph.paragraphFormat.baseStyle;\n        if (style instanceof WParagraphStyle && style.name.toLowerCase().indexOf('toc') === 0) {\n            var tocField = this.getTocFieldInternal();\n            if (!isNullOrUndefined(tocField)) {\n                this.contextTypeInternal = 'TableOfContents';\n                return;\n            }\n        }\n        if (this.start.paragraph.isInHeaderFooter) {\n            var isInHeader = this.start.paragraph.bodyWidget.headerFooterType.indexOf('Header') !== -1;\n            if (contextIsinTable) {\n                if (contextIsinImage) {\n                    this.contextTypeInternal = isInHeader ? 'HeaderTableImage' : 'FooterTableImage';\n                }\n                else {\n                    this.contextTypeInternal = isInHeader ? 'HeaderTableText' : 'FooterTableText';\n                }\n            }\n            else {\n                if (contextIsinImage) {\n                    this.contextTypeInternal = isInHeader ? 'HeaderImage' : 'FooterImage';\n                }\n                else {\n                    this.contextTypeInternal = isInHeader ? 'HeaderText' : 'FooterText';\n                }\n            }\n        }\n        else {\n            if (contextIsinTable) {\n                this.contextTypeInternal = contextIsinImage ? 'TableImage' : 'TableText';\n            }\n            else {\n                this.contextTypeInternal = contextIsinImage ? 'Image' : 'Text';\n            }\n        }\n    };\n    //Table Format retrieval starts\n    /**\n     * Retrieve selection table format\n     * @private\n     */\n    Selection.prototype.retrieveTableFormat = function (start, end) {\n        var tableAdv = this.getTable(start, end);\n        if (!isNullOrUndefined(tableAdv)) {\n            this.tableFormat.copyFormat(tableAdv.tableFormat);\n            this.tableFormat.table = tableAdv;\n            this.retrieveCellFormat(start, end);\n            this.retrieveRowFormat(start, end);\n        }\n        else {\n            //When the selection is out of table\n            this.tableFormat.clearFormat();\n        }\n    };\n    /**\n     * Retrieve selection cell format\n     * @private\n     */\n    Selection.prototype.retrieveCellFormat = function (start, end) {\n        if (start.paragraph.isInsideTable && end.paragraph.isInsideTable) {\n            this.cellFormat.copyFormat(start.paragraph.associatedCell.cellFormat);\n            this.getCellFormat(start.paragraph.associatedCell.ownerTable, start, end);\n        }\n        else {\n            //When the selection is out of table\n            this.cellFormat.clearCellFormat();\n        }\n    };\n    /**\n     * Retrieve selection row format\n     * @private\n     */\n    Selection.prototype.retrieveRowFormat = function (start, end) {\n        if (start.paragraph.isInsideTable && end.paragraph.isInsideTable) {\n            this.rowFormat.copyFormat(start.paragraph.associatedCell.ownerRow.rowFormat);\n            this.getRowFormat(start.paragraph.associatedCell.ownerTable, start, end);\n        }\n        else {\n            //When the selection is out of table\n            this.rowFormat.clearRowFormat();\n        }\n    };\n    /**\n     * Get selected cell format\n     * @private\n     */\n    Selection.prototype.getCellFormat = function (table, start, end) {\n        if (start.paragraph.associatedCell.equals(end.paragraph.associatedCell)) {\n            return;\n        }\n        var isStarted = false;\n        for (var i = 0; i < table.childWidgets.length; i++) {\n            var row = table.childWidgets[i];\n            if (row === start.paragraph.associatedCell.ownerRow) {\n                isStarted = true;\n            }\n            if (isStarted) {\n                for (var j = 0; j < row.childWidgets.length; j++) {\n                    var cell = row.childWidgets[j];\n                    if (this.isCellSelected(cell, start, end)) {\n                        this.cellFormat.combineFormat(cell.cellFormat);\n                    }\n                    if (cell === end.paragraph.associatedCell) {\n                        this.cellFormat.combineFormat(cell.cellFormat);\n                        return;\n                    }\n                }\n            }\n        }\n    };\n    /**\n     * Get selected row format\n     * @private\n     */\n    Selection.prototype.getRowFormat = function (table, start, end) {\n        var tableRow = start.paragraph.associatedCell.ownerRow;\n        if (tableRow === end.paragraph.associatedCell.ownerRow) {\n            return;\n        }\n        for (var i = table.childWidgets.indexOf(tableRow) + 1; i < table.childWidgets.length; i++) {\n            var tempTableRow = table.childWidgets[i];\n            this.rowFormat.combineFormat(tempTableRow.rowFormat);\n            if (tempTableRow === end.paragraph.associatedCell.ownerRow) {\n                return;\n            }\n        }\n    };\n    /**\n     * Return table with given text position\n     * @private\n     */\n    Selection.prototype.getTable = function (startPosition, endPosition) {\n        if (!isNullOrUndefined(startPosition.paragraph.associatedCell) && !isNullOrUndefined(endPosition.paragraph.associatedCell)) {\n            var startTable = startPosition.paragraph.associatedCell.ownerTable;\n            var endTable = startPosition.paragraph.associatedCell.ownerTable;\n            if (startTable === endTable) {\n                return startTable;\n            }\n            else {\n                if (startTable.contains(startPosition.paragraph.associatedCell)) {\n                    return startTable;\n                }\n                else if (endTable.contains(startPosition.paragraph.associatedCell)) {\n                    return endTable;\n                }\n                else if (!startTable.isInsideTable || !endTable.isInsideTable) {\n                    return undefined;\n                }\n                else {\n                    do {\n                        startTable = startTable.associatedCell.ownerTable;\n                        if (startTable === endTable || startTable.contains(endTable.associatedCell)) {\n                            return startTable;\n                        }\n                        else if (endTable.contains(startTable.associatedCell)) {\n                            return endTable;\n                        }\n                    } while (!isNullOrUndefined(startTable.associatedCell));\n                }\n            }\n        }\n        return undefined;\n    };\n    Selection.prototype.getContainerWidget = function (block) {\n        var bodyWidget;\n        if (block.containerWidget instanceof BlockContainer) {\n            bodyWidget = block.containerWidget;\n        }\n        else {\n            bodyWidget = block.containerWidget;\n            while (!(bodyWidget instanceof BlockContainer)) {\n                bodyWidget = bodyWidget.containerWidget;\n            }\n        }\n        return bodyWidget;\n    };\n    //Table format retrieval ends\n    //Section format retrieval starts\n    /**\n     * Retrieve selection section format\n     * @private\n     */\n    Selection.prototype.retrieveSectionFormat = function (start, end) {\n        var startParaSection = this.getContainerWidget(start.paragraph);\n        var endParaSection = this.getContainerWidget(end.paragraph);\n        if (!isNullOrUndefined(startParaSection)) {\n            this.sectionFormat.copyFormat(startParaSection.sectionFormat);\n            var startPageIndex = this.viewer.pages.indexOf(startParaSection.page);\n            var endPageIndex = this.viewer.pages.indexOf(endParaSection.page);\n            for (var i = startPageIndex + 1; i <= endPageIndex; i++) {\n                this.sectionFormat.combineFormat(this.viewer.pages[i].bodyWidgets[0].sectionFormat);\n            }\n        }\n    };\n    //section format retrieval ends.\n    //Paragraph format retrieval implementation starts.\n    /**\n     * Retrieve selection paragraph format\n     * @private\n     */\n    Selection.prototype.retrieveParagraphFormat = function (start, end) {\n        this.getParagraphFormatForSelection(start.paragraph, this, start, end);\n    };\n    /**\n     * @private\n     */\n    Selection.prototype.getParagraphFormatForSelection = function (paragraph, selection, start, end) {\n        //Selection start in cell.\n        if (start.paragraph.isInsideTable && (!end.paragraph.isInsideTable\n            || start.paragraph.associatedCell !== end.paragraph.associatedCell\n            || this.isCellSelected(start.paragraph.associatedCell, start, end))) {\n            this.getParagraphFormatInternalInCell(start.paragraph.associatedCell, start, end);\n        }\n        else {\n            this.getParagraphFormatInternalInParagraph(paragraph, start, end);\n        }\n    };\n    /**\n     * @private\n     */\n    // tslint:disable-next-line:max-line-length\n    Selection.prototype.getParagraphFormatInternalInParagraph = function (paragraph, start, end) {\n        if (start.paragraph === paragraph) {\n            this.paragraphFormat.copyFormat(paragraph.paragraphFormat);\n        }\n        else {\n            this.paragraphFormat.combineFormat(paragraph.paragraphFormat);\n        }\n        if (end.paragraph === paragraph) {\n            return;\n        }\n        var block = this.getNextRenderedBlock(paragraph);\n        if (!isNullOrUndefined(block)) {\n            this.getParagraphFormatInternalInBlock(block, start, end);\n        }\n    };\n    /**\n     * @private\n     */\n    Selection.prototype.getParagraphFormatInternalInBlock = function (block, start, end) {\n        if (block instanceof ParagraphWidget) {\n            this.getParagraphFormatInternalInParagraph(block, start, end);\n        }\n        else {\n            this.getParagraphFormatInternalInTable(block, start, end);\n        }\n    };\n    /**\n     * @private\n     */\n    Selection.prototype.getParagraphFormatInternalInTable = function (table, start, end) {\n        for (var i = 0; i < table.childWidgets.length; i++) {\n            var tableRow = table.childWidgets[i];\n            for (var j = 0; j < tableRow.childWidgets.length; j++) {\n                this.getParagraphFormatInCell(tableRow.childWidgets[j]);\n            }\n            if (end.paragraph.isInsideTable && this.containsRow(tableRow, end.paragraph.associatedCell)) {\n                return;\n            }\n        }\n        var block = this.getNextRenderedBlock(table);\n        //Goto the next block.\n        this.getParagraphFormatInternalInBlock(block, start, end);\n    };\n    /**\n     * Get paragraph format in cell\n     * @private\n     */\n    Selection.prototype.getParagraphFormatInCell = function (cell) {\n        for (var i = 0; i < cell.childWidgets.length; i++) {\n            this.getParagraphFormatInBlock(cell.childWidgets[i]);\n        }\n    };\n    /**\n     * @private\n     */\n    Selection.prototype.getParagraphFormatInBlock = function (block) {\n        if (block instanceof ParagraphWidget) {\n            this.getParagraphFormatInParagraph(block);\n        }\n        else {\n            this.getParagraphFormatInTable(block);\n        }\n    };\n    /**\n     * @private\n     */\n    Selection.prototype.getParagraphFormatInTable = function (tableAdv) {\n        for (var i = 0; i < tableAdv.childWidgets.length; i++) {\n            var tableRow = tableAdv.childWidgets[i];\n            for (var j = 0; j < tableRow.childWidgets.length; j++) {\n                this.getParagraphFormatInCell(tableRow.childWidgets[j]);\n            }\n        }\n    };\n    /**\n     * @private\n     */\n    Selection.prototype.getParagraphFormatInParagraph = function (paragraph) {\n        this.paragraphFormat.combineFormat(paragraph.paragraphFormat);\n    };\n    /**\n     * Get paragraph format in cell\n     * @private\n     */\n    Selection.prototype.getParagraphFormatInternalInCell = function (cellAdv, start, end) {\n        if (end.paragraph.isInsideTable) {\n            var containerCell = this.getContainerCellOf(cellAdv, end.paragraph.associatedCell);\n            if (containerCell.ownerTable.contains(end.paragraph.associatedCell)) {\n                var startCell = this.getSelectedCell(cellAdv, containerCell);\n                var endCell = this.getSelectedCell(end.paragraph.associatedCell, containerCell);\n                if (this.containsCell(containerCell, end.paragraph.associatedCell)) {\n                    //Selection end is in container cell.\n                    if (this.isCellSelected(containerCell, start, end)) {\n                        this.getParagraphFormatInCell(containerCell);\n                    }\n                    else {\n                        if (startCell === containerCell) {\n                            this.getParagraphFormatInternalInParagraph(start.paragraph, start, end);\n                        }\n                        else {\n                            this.getParagraphFormatInRow(startCell.ownerRow, start, end);\n                        }\n                    }\n                }\n                else {\n                    //Format other selected cells in current table.\n                    this.getParaFormatForCell(containerCell.ownerTable, containerCell, endCell);\n                }\n            }\n            else {\n                this.getParagraphFormatInRow(containerCell.ownerRow, start, end);\n            }\n        }\n        else {\n            var cell = this.getContainerCell(cellAdv);\n            this.getParagraphFormatInRow(cell.ownerRow, start, end);\n        }\n    };\n    /**\n     * @private\n     */\n    Selection.prototype.getParaFormatForCell = function (table, startCell, endCell) {\n        var startCellIn = this.getCellLeft(startCell.ownerRow, startCell);\n        var endCellIn = startCellIn + startCell.cellFormat.cellWidth;\n        var endCellLeft = this.getCellLeft(endCell.ownerRow, endCell);\n        var endCellRight = endCellLeft + endCell.cellFormat.cellWidth;\n        if (startCellIn > endCellLeft) {\n            startCellIn = endCellLeft;\n        }\n        if (endCellIn < endCellRight) {\n            endCellIn = endCellRight;\n        }\n        if (startCellIn > this.upDownSelectionLength) {\n            startCellIn = this.upDownSelectionLength;\n        }\n        if (startCellIn < this.upDownSelectionLength) {\n            startCellIn = this.upDownSelectionLength;\n        }\n        var count = table.childWidgets.indexOf(endCell.ownerRow);\n        for (var i = table.childWidgets.indexOf(startCell.ownerRow); i <= count; i++) {\n            var tableRow = table.childWidgets[i];\n            for (var j = 0; j < tableRow.childWidgets.length; j++) {\n                var cell = tableRow.childWidgets[j];\n                var left = this.getCellLeft(tableRow, cell);\n                if (HelperMethods.round(startCellIn, 2) <= HelperMethods.round(left, 2)\n                    && HelperMethods.round(left, 2) < HelperMethods.round(endCellIn, 2)) {\n                    this.getParagraphFormatInCell(cell);\n                }\n            }\n        }\n    };\n    /**\n     * Get paragraph format ins row\n     * @private\n     */\n    Selection.prototype.getParagraphFormatInRow = function (tableRow, start, end) {\n        for (var i = tableRow.rowIndex; i < tableRow.ownerTable.childWidgets.length; i++) {\n            var row = tableRow.ownerTable.childWidgets[i];\n            for (var j = 0; j < row.childWidgets.length; j++) {\n                this.getParagraphFormatInCell(row.childWidgets[j]);\n            }\n            if (end.paragraph.isInsideTable && this.containsRow(row, end.paragraph.associatedCell)) {\n                return;\n            }\n        }\n        var block = this.getNextRenderedBlock(tableRow.ownerTable);\n        //Goto the next block.\n        this.getParagraphFormatInternalInBlock(block, start, end);\n    };\n    // paragraph format retrieval implementation ends\n    // Character format retrieval implementation starts.\n    /**\n     * Retrieve Selection character format\n     * @private\n     */\n    Selection.prototype.retrieveCharacterFormat = function (start, end) {\n        this.characterFormat.copyFormat(start.paragraph.characterFormat);\n        if (start.paragraph === end.paragraph && start.currentWidget.isLastLine()\n            && start.offset === this.getLineLength(start.currentWidget) && start.offset + 1 === end.offset) {\n            return;\n        }\n        var para = start.paragraph;\n        if (start.offset === this.getParagraphLength(para) && !this.isEmpty) {\n            para = this.getNextParagraphBlock(para);\n        }\n        while (!isNullOrUndefined(para) && para !== end.paragraph && para.isEmpty()) {\n            para = this.getNextParagraphBlock(para);\n        }\n        var offset = para === start.paragraph ? start.offset : 0;\n        var indexInInline = 0;\n        if (!isNullOrUndefined(para) && !para.isEmpty()) {\n            var position = new TextPosition(this.owner);\n            var elemInfo = start.currentWidget.getInline(offset, indexInInline);\n            var physicalLocation = this.getPhysicalPositionInternal(start.currentWidget, offset, true);\n            position.setPositionForSelection(start.currentWidget, elemInfo.element, elemInfo.index, physicalLocation);\n            this.getCharacterFormatForSelection(para, this, position, end);\n        }\n    };\n    /**\n     * @private\n     */\n    // tslint:disable-next-line:max-line-length\n    Selection.prototype.getCharacterFormatForSelection = function (paragraph, selection, startPosition, endPosition) {\n        //Selection start in cell.\n        if (startPosition.paragraph instanceof ParagraphWidget && startPosition.paragraph.isInsideTable\n            && (!endPosition.paragraph.isInsideTable\n                || startPosition.paragraph.associatedCell !== endPosition.paragraph.associatedCell\n                || this.isCellSelected(startPosition.paragraph.associatedCell, startPosition, endPosition))) {\n            this.getCharacterFormatInTableCell(startPosition.paragraph.associatedCell, selection, startPosition, endPosition);\n        }\n        else {\n            this.getCharacterFormat(paragraph, startPosition, endPosition);\n        }\n    };\n    /**\n     * Get Character format\n     * @private\n     */\n    //Format Retrieval\n    Selection.prototype.getCharacterFormatForTableRow = function (tableRowAdv, start, end) {\n        for (var i = tableRowAdv.rowIndex; i < tableRowAdv.ownerTable.childWidgets.length; i++) {\n            var tableRow = tableRowAdv.ownerTable.childWidgets[i];\n            for (var j = 0; j < tableRow.childWidgets.length; j++) {\n                this.getCharacterFormatForSelectionCell(tableRow.childWidgets[j], start, end);\n            }\n            if (end.paragraph.isInsideTable && this.containsRow(tableRow, end.paragraph.associatedCell)) {\n                return;\n            }\n        }\n        var block = this.getNextRenderedBlock(tableRowAdv.ownerTable);\n        // //Goto the next block.\n        this.getCharacterFormatForBlock(block, start, end);\n    };\n    /**\n     * Get Character format in table\n     * @private\n     */\n    Selection.prototype.getCharacterFormatInTableCell = function (tableCell, selection, start, end) {\n        if (end.paragraph.isInsideTable) {\n            var containerCell = this.getContainerCellOf(tableCell, end.paragraph.associatedCell);\n            if (containerCell.ownerTable.contains(end.paragraph.associatedCell)) {\n                var startCell = this.getSelectedCell(tableCell, containerCell);\n                var endCell = this.getSelectedCell(end.paragraph.associatedCell, containerCell);\n                if (this.containsCell(containerCell, end.paragraph.associatedCell)) {\n                    //Selection end is in container cell.\n                    if (this.isCellSelected(containerCell, start, end)) {\n                        this.getCharacterFormatForSelectionCell(containerCell, start, end);\n                    }\n                    else {\n                        if (startCell === containerCell) {\n                            this.getCharacterFormat(start.paragraph, start, end);\n                        }\n                        else {\n                            this.getCharacterFormatForTableRow(startCell.ownerRow, start, end);\n                        }\n                    }\n                }\n                else {\n                    //Format other selected cells in current table.\n                    this.getCharacterFormatInternalInTable(containerCell.ownerTable, containerCell, endCell, start, end);\n                }\n            }\n            else {\n                this.getCharacterFormatForTableRow(containerCell.ownerRow, start, end);\n            }\n        }\n        else {\n            var cell = this.getContainerCell(tableCell);\n            this.getCharacterFormatForTableRow(cell.ownerRow, start, end);\n        }\n    };\n    /**\n     * @private\n     */\n    // tslint:disable-next-line:max-line-length\n    Selection.prototype.getCharacterFormatInternalInTable = function (table, startCell, endCell, startPosition, endPosition) {\n        var startIn = this.getCellLeft(startCell.ownerRow, startCell);\n        var endIn = startIn + startCell.cellFormat.cellWidth;\n        var endCellLeft = this.getCellLeft(endCell.ownerRow, endCell);\n        var endCellRight = endCellLeft + endCell.cellFormat.cellWidth;\n        if (startIn > endCellLeft) {\n            startIn = endCellLeft;\n        }\n        if (endIn < endCellRight) {\n            endIn = endCellRight;\n        }\n        if (startIn > this.upDownSelectionLength) {\n            startIn = this.upDownSelectionLength;\n        }\n        if (endIn < this.upDownSelectionLength) {\n            endIn = this.upDownSelectionLength;\n        }\n        var count = table.childWidgets.indexOf(endCell.ownerRow);\n        for (var i = table.childWidgets.indexOf(startCell.ownerRow); i <= count; i++) {\n            var row = table.childWidgets[i];\n            for (var j = 0; j < row.childWidgets.length; j++) {\n                var cell = row.childWidgets[j];\n                var left = this.getCellLeft(row, cell);\n                if (HelperMethods.round(startIn, 2) <= HelperMethods.round(left, 2) &&\n                    HelperMethods.round(left, 2) < HelperMethods.round(endIn, 2)) {\n                    this.getCharacterFormatForSelectionCell(cell, startPosition, endPosition);\n                }\n            }\n        }\n    };\n    /**\n     * Get character format with in selection\n     * @private\n     */\n    Selection.prototype.getCharacterFormat = function (paragraph, start, end) {\n        if (paragraph !== start.paragraph && paragraph !== end.paragraph) {\n            this.getCharacterFormatInternal(paragraph, this);\n            return;\n        }\n        if (end.paragraph === paragraph && start.paragraph !== paragraph && end.offset === 0) {\n            return;\n        }\n        var startOffset = 0;\n        var length = this.getParagraphLength(paragraph);\n        if (paragraph === start.paragraph) {\n            startOffset = start.offset;\n            //Sets selection character format.            \n            var isUpdated = this.setCharacterFormat(paragraph, start, end, length);\n            if (isUpdated) {\n                return;\n            }\n        }\n        var startLineWidget = paragraph.childWidgets.indexOf(start.currentWidget) !== -1 ?\n            paragraph.childWidgets.indexOf(start.currentWidget) : 0;\n        var endLineWidget = paragraph.childWidgets.indexOf(end.currentWidget) !== -1 ?\n            paragraph.childWidgets.indexOf(end.currentWidget) : paragraph.childWidgets.length - 1;\n        var endOffset = end.offset;\n        if (paragraph !== end.paragraph) {\n            endOffset = length;\n        }\n        var isFieldStartSelected = false;\n        for (var i = startLineWidget; i <= endLineWidget; i++) {\n            var lineWidget = paragraph.childWidgets[i];\n            if (i !== startLineWidget) {\n                startOffset = this.getStartLineOffset(lineWidget);\n            }\n            if (lineWidget === end.currentWidget) {\n                endOffset = end.offset;\n            }\n            else {\n                endOffset = this.getLineLength(lineWidget);\n            }\n            var count = 0;\n            for (var j = 0; j < lineWidget.children.length; j++) {\n                var inline = lineWidget.children[j];\n                if (startOffset >= count + inline.length) {\n                    count += inline.length;\n                    continue;\n                }\n                if (inline instanceof FieldElementBox && inline.fieldType === 0\n                    && HelperMethods.isLinkedFieldCharacter(inline)) {\n                    var nextInline = isNullOrUndefined(inline.fieldSeparator) ?\n                        inline.fieldEnd : inline.fieldSeparator;\n                    do {\n                        count += inline.length;\n                        inline = inline.nextNode;\n                        i++;\n                    } while (!isNullOrUndefined(inline) && inline !== nextInline);\n                    isFieldStartSelected = true;\n                }\n                if (inline instanceof FieldElementBox && inline.fieldType === 1\n                    && HelperMethods.isLinkedFieldCharacter(inline) && isFieldStartSelected) {\n                    var fieldInline = inline.fieldBegin;\n                    do {\n                        this.characterFormat.combineFormat(fieldInline.characterFormat);\n                        fieldInline = fieldInline.nextNode;\n                    } while (!(fieldInline instanceof FieldElementBox));\n                }\n                if (inline instanceof TextElementBox) {\n                    this.characterFormat.combineFormat(inline.characterFormat);\n                }\n                if (isNullOrUndefined(inline) || endOffset <= count + inline.length) {\n                    break;\n                }\n                count += inline.length;\n            }\n        }\n        if (end.paragraph === paragraph) {\n            return;\n        }\n        var block = this.getNextRenderedBlock(paragraph);\n        if (!isNullOrUndefined(block)) {\n            this.getCharacterFormatForBlock(block, start, end);\n        }\n    };\n    Selection.prototype.setCharacterFormat = function (para, startPos, endPos, length) {\n        var index = 0;\n        var startOffset = startPos.offset;\n        var inlineAndIndex = startPos.currentWidget.getInline(startOffset, index);\n        index = inlineAndIndex.index;\n        var inline = inlineAndIndex.element;\n        if (isNullOrUndefined(inline)) {\n            var currentLineIndex = startPos.paragraph.childWidgets.indexOf(startPos.currentWidget);\n            if (startPos.currentWidget.previousLine) {\n                inline = startPos.currentWidget.previousLine.children[startPos.currentWidget.previousLine.children.length - 1];\n                this.characterFormat.copyFormat(inline.characterFormat);\n                return true;\n            }\n        }\n        if (startOffset < length) {\n            if (this.isEmpty) {\n                if (inline instanceof TextElementBox || (inline instanceof FieldElementBox\n                    && (inline.fieldType === 0 || inline.fieldType === 1))) {\n                    var previousNode = this.getPreviousTextElement(inline);\n                    if (startOffset === 0 && previousNode) {\n                        inline = previousNode;\n                    }\n                    this.characterFormat.copyFormat(inline.characterFormat);\n                }\n                else {\n                    if (!isNullOrUndefined(this.getPreviousTextElement(inline))) {\n                        this.characterFormat.copyFormat(this.getPreviousTextElement(inline).characterFormat);\n                    }\n                    else if (!isNullOrUndefined(this.getNextTextElement(inline))) {\n                        this.characterFormat.copyFormat(this.getNextTextElement(inline).characterFormat);\n                    }\n                    else {\n                        this.characterFormat.copyFormat(para.characterFormat);\n                    }\n                }\n                return true;\n            }\n            else {\n                if (index === inline.length && !isNullOrUndefined(inline.nextNode)) {\n                    this.characterFormat.copyFormat(this.getNextValidCharacterFormat(inline));\n                }\n                else if (inline instanceof TextElementBox) {\n                    this.characterFormat.copyFormat(inline.characterFormat);\n                }\n                else if (inline instanceof FieldElementBox) {\n                    this.characterFormat.copyFormat(this.getNextValidCharacterFormatOfField(inline));\n                }\n            }\n        }\n        else {\n            if (length === endPos.offset) {\n                if (inline instanceof TextElementBox || inline instanceof FieldElementBox) {\n                    this.characterFormat.copyFormat(inline.characterFormat);\n                }\n                else if (!isNullOrUndefined(inline)) {\n                    inline = this.getPreviousTextElement(inline);\n                    if (!isNullOrUndefined(inline)) {\n                        this.characterFormat.copyFormat(inline.characterFormat);\n                    }\n                }\n                else {\n                    this.characterFormat.copyFormat(para.characterFormat);\n                }\n                return true;\n            }\n        }\n        return false;\n    };\n    /**\n     * @private\n     */\n    Selection.prototype.getCharacterFormatForBlock = function (block, start, end) {\n        if (block instanceof ParagraphWidget) {\n            this.getCharacterFormat(block, start, end);\n        }\n        else {\n            this.getCharacterFormatInTable(block, start, end);\n        }\n    };\n    /**\n     * @private\n     */\n    Selection.prototype.getCharacterFormatInTable = function (table, start, end) {\n        for (var i = 0; i < table.childWidgets.length; i++) {\n            var row = table.childWidgets[i];\n            for (var j = 0; j < row.childWidgets.length; j++) {\n                this.getCharacterFormatForSelectionCell(row.childWidgets[j], start, end);\n            }\n            if (end.paragraph.isInsideTable && this.containsRow(row, end.paragraph.associatedCell)) {\n                return;\n            }\n        }\n        var blockAdv = this.getNextRenderedBlock(table);\n        // //Goto the next block.\n        this.getCharacterFormatForBlock(blockAdv, start, end);\n    };\n    /**\n     * Get character format in selection\n     * @private\n     */\n    Selection.prototype.getCharacterFormatForSelectionCell = function (cell, start, end) {\n        for (var i = 0; i < cell.childWidgets.length; i++) {\n            this.getCharacterFormatForBlock(cell.childWidgets[i], start, end);\n        }\n    };\n    /**\n     * @private\n     */\n    Selection.prototype.getCharacterFormatInternal = function (paragraph, selection) {\n        for (var i = 0; i < paragraph.childWidgets.length; i++) {\n            var linewidget = paragraph.childWidgets[i];\n            for (var j = 0; j < linewidget.children.length; j++) {\n                var element = linewidget.children[j];\n                if (!(element instanceof ImageElementBox || element instanceof FieldElementBox)) {\n                    selection.characterFormat.combineFormat(element.characterFormat);\n                }\n            }\n        }\n    };\n    /**\n     * Get next valid character format from inline\n     * @private\n     */\n    Selection.prototype.getNextValidCharacterFormat = function (inline) {\n        var startInline = this.getNextTextElement(inline);\n        if (isNullOrUndefined(startInline)) {\n            return inline.characterFormat;\n        }\n        var fieldBegin = undefined;\n        if (startInline instanceof FieldElementBox) {\n            if (fieldBegin.fieldType === 0) {\n                fieldBegin = startInline;\n            }\n        }\n        if (isNullOrUndefined(fieldBegin)) {\n            return startInline.characterFormat;\n        }\n        else {\n            return this.getNextValidCharacterFormatOfField(fieldBegin);\n        }\n    };\n    /**\n     * Get next valid paragraph format from field\n     * @private\n     */\n    Selection.prototype.getNextValidCharacterFormatOfField = function (fieldBegin) {\n        var startInline = fieldBegin;\n        if (HelperMethods.isLinkedFieldCharacter(fieldBegin)) {\n            if (isNullOrUndefined(fieldBegin.fieldSeparator)) {\n                startInline = fieldBegin.fieldEnd;\n            }\n            else {\n                startInline = fieldBegin.fieldSeparator;\n            }\n        }\n        var nextValidInline = undefined;\n        if (!isNullOrUndefined(startInline.nextNode)) {\n            //Check the next node is a valid and returns inline.\n            nextValidInline = this.getNextValidElement(startInline.nextNode);\n        }\n        //If field separator/end exists at end of paragraph, then move to next paragraph.\n        if (isNullOrUndefined(nextValidInline)) {\n            return startInline.characterFormat;\n        }\n        return nextValidInline.characterFormat;\n    };\n    /**\n     * Return true if cursor point with in selection range\n     * @private\n     */\n    Selection.prototype.checkCursorIsInSelection = function (widget, point) {\n        if (isNullOrUndefined(this.start) || this.isEmpty || isNullOrUndefined(widget)) {\n            return false;\n        }\n        var isSelected = false;\n        do {\n            if (this.selectedWidgets.containsKey(widget)) {\n                var top_4 = void 0;\n                var left = void 0;\n                if (widget instanceof LineWidget) {\n                    top_4 = this.owner.selection.getTop(widget);\n                    left = this.owner.selection.getLeft(widget);\n                }\n                else {\n                    top_4 = widget.y;\n                    left = widget.x;\n                }\n                var widgetInfo = this.selectedWidgets.get(widget);\n                isSelected = widgetInfo.left <= point.x && top_4 <= point.y &&\n                    top_4 + widget.height >= point.y && widgetInfo.left + widgetInfo.width >= point.x;\n            }\n            widget = (widget instanceof LineWidget) ? widget.paragraph : widget.containerWidget;\n        } while (!isNullOrUndefined(widget) && !isSelected);\n        return isSelected;\n    };\n    /**\n     * Copy paragraph for to selection paragraph format\n     * @private\n     */\n    Selection.prototype.copySelectionParagraphFormat = function () {\n        var format = new WParagraphFormat();\n        this.paragraphFormat.copyToFormat(format);\n        return format;\n    };\n    /**\n     * Get hyperlink display text\n     * @private\n     */\n    // tslint:disable-next-line\n    Selection.prototype.getHyperlinkDisplayText = function (paragraph, fieldSeparator, fieldEnd, isNestedField, format) {\n        var para = paragraph;\n        if (para !== fieldEnd.line.paragraph) {\n            isNestedField = true;\n            return { displayText: '<<Selection in Document>>', 'isNestedField': isNestedField, 'format': format };\n        }\n        var displayText = '';\n        var lineIndex = para.childWidgets.indexOf(fieldSeparator.line);\n        var index = para.childWidgets[lineIndex].children.indexOf(fieldSeparator);\n        for (var j = lineIndex; j < para.childWidgets.length; j++) {\n            var lineWidget = para.childWidgets[j];\n            if (j !== lineIndex) {\n                index = -1;\n            }\n            for (var i = index + 1; i < lineWidget.children.length; i++) {\n                var inline = lineWidget.children[i];\n                if (inline === fieldEnd) {\n                    return { 'displayText': displayText, 'isNestedField': isNestedField, 'format': format };\n                }\n                if (inline instanceof TextElementBox) {\n                    displayText += inline.text;\n                    format = inline.characterFormat;\n                }\n                else if (inline instanceof FieldElementBox) {\n                    if (inline instanceof FieldElementBox && inline.fieldType === 0\n                        && !isNullOrUndefined(inline.fieldEnd)) {\n                        if (isNullOrUndefined(inline.fieldSeparator)) {\n                            index = lineWidget.children.indexOf(inline.fieldEnd);\n                        }\n                        else {\n                            index = lineWidget.children.indexOf(inline.fieldSeparator);\n                        }\n                    }\n                }\n                else {\n                    isNestedField = true;\n                    return { 'displayText': '<<Selection in Document>>', 'isNestedField': isNestedField, 'format': format };\n                }\n            }\n        }\n        return { 'displayText': displayText, 'isNestedField': isNestedField, 'format': format };\n    };\n    /**\n     * Navigates hyperlink on mouse Event.\n     * @private\n     */\n    Selection.prototype.navigateHyperLinkOnEvent = function (cursorPoint, isTouchInput) {\n        var _this = this;\n        var widget = this.viewer.getLineWidget(cursorPoint);\n        if (!isNullOrUndefined(widget)) {\n            var hyperLinkField = this.getHyperLinkFieldInCurrentSelection(widget, cursorPoint);\n            //Invokes Hyperlink navigation events.\n            if (!isNullOrUndefined(hyperLinkField)) {\n                this.viewer.updateTextPositionForSelection(cursorPoint, 1);\n                this.fireRequestNavigate(hyperLinkField);\n                setTimeout(function () {\n                    if (_this.viewer) {\n                        _this.viewer.isTouchInput = isTouchInput;\n                        _this.viewer.updateFocus();\n                        _this.viewer.isTouchInput = false;\n                    }\n                });\n            }\n        }\n    };\n    /**\n     * @private\n     */\n    Selection.prototype.getLinkText = function (fieldBegin) {\n        var hyperlink = new Hyperlink(fieldBegin, this);\n        var link = hyperlink.navigationLink;\n        if (hyperlink.localReference.length > 0) {\n            if (hyperlink.localReference[0] === '_' && (isNullOrUndefined(link) || link.length === 0)) {\n                link = 'Current Document';\n            }\n            else {\n                link += '#' + hyperlink.localReference;\n            }\n        }\n        hyperlink.destroy();\n        return link;\n    };\n    /**\n     * Set Hyperlink content to tool tip element\n     * @private\n     */\n    Selection.prototype.setHyperlinkContentToToolTip = function (fieldBegin, widget, xPos) {\n        if (fieldBegin) {\n            if (this.owner.contextMenuModule &&\n                this.owner.contextMenuModule.contextMenuInstance.element.style.display === 'block') {\n                return;\n            }\n            if (!this.toolTipElement) {\n                this.toolTipElement = createElement('div', { className: 'e-de-tooltip' });\n                this.viewer.viewerContainer.appendChild(this.toolTipElement);\n            }\n            this.toolTipElement.style.display = 'block';\n            var l10n = new L10n('documenteditor', this.owner.defaultLocale);\n            l10n.setLocale(this.owner.locale);\n            var toolTipText = l10n.getConstant('Click to follow link');\n            if (this.owner.useCtrlClickToFollowHyperlink) {\n                toolTipText = 'Ctrl+' + toolTipText;\n            }\n            var linkText = this.getLinkText(fieldBegin);\n            this.toolTipElement.innerHTML = linkText + '</br><b>' + toolTipText + '</b>';\n            var widgetTop = this.getTop(widget) * this.viewer.zoomFactor;\n            var page = this.getPage(widget.paragraph);\n            var containerWidth = this.viewer.viewerContainer.getBoundingClientRect().width + this.viewer.viewerContainer.scrollLeft;\n            var left = page.boundingRectangle.x + xPos * this.viewer.zoomFactor;\n            if ((left + this.toolTipElement.clientWidth + 10) > containerWidth) {\n                left = left - ((this.toolTipElement.clientWidth - (containerWidth - left)) + 15);\n            }\n            var top_5 = this.getPageTop(page) + (widgetTop - this.toolTipElement.offsetHeight);\n            top_5 = top_5 > this.viewer.viewerContainer.scrollTop ? top_5 : top_5 + widget.height + this.toolTipElement.offsetHeight;\n            this.showToolTip(left, top_5);\n            if (!isNullOrUndefined(this.toolTipField) && fieldBegin !== this.toolTipField) {\n                this.toolTipObject.position = { X: left, Y: top_5 };\n            }\n            this.toolTipObject.show();\n            this.toolTipField = fieldBegin;\n        }\n        else {\n            this.hideToolTip();\n        }\n    };\n    /**\n     * Show hyperlink tooltip\n     * @private\n     */\n    Selection.prototype.showToolTip = function (x, y) {\n        if (!this.toolTipObject) {\n            this.toolTipObject = new Popup(this.toolTipElement, {\n                height: 'auto',\n                width: 'auto',\n                relateTo: this.viewer.viewerContainer.parentElement,\n                position: { X: x, Y: y }\n            });\n        }\n    };\n    /**\n     * Hide tooltip object\n     * @private\n     */\n    Selection.prototype.hideToolTip = function () {\n        this.toolTipField = undefined;\n        if (this.toolTipObject) {\n            this.toolTipObject.hide();\n            this.toolTipObject.destroy();\n            this.toolTipObject = undefined;\n            this.toolTipElement.style.display = 'none';\n        }\n    };\n    /**\n     * Return hyperlink field\n     * @private\n     */\n    Selection.prototype.getHyperLinkFieldInCurrentSelection = function (widget, cursorPosition) {\n        var inline = undefined;\n        var top = this.getTop(widget);\n        var lineStartLeft = this.getLineStartLeft(widget);\n        if (cursorPosition.y < top || cursorPosition.y > top + widget.height\n            || cursorPosition.x < lineStartLeft || cursorPosition.x > lineStartLeft + widget.paragraph.width) {\n            return undefined;\n        }\n        var left = widget.paragraph.x;\n        var elementValues = this.getFirstElement(widget, left);\n        left = elementValues.left;\n        var element = elementValues.element;\n        if (isNullOrUndefined(element)) {\n            var width = this.viewer.textHelper.getParagraphMarkWidth(widget.paragraph.characterFormat);\n            if (cursorPosition.x <= lineStartLeft + width || cursorPosition.x >= lineStartLeft + width) {\n                //Check if paragraph is within a field result.\n                var checkedFields = [];\n                var field = this.getHyperLinkFields(widget.paragraph, checkedFields);\n                checkedFields = [];\n                checkedFields = undefined;\n                return field;\n            }\n        }\n        else {\n            if (cursorPosition.x > left + element.margin.left) {\n                for (var i = widget.children.indexOf(element); i < widget.children.length; i++) {\n                    element = widget.children[i];\n                    if (cursorPosition.x < left + element.margin.left + element.width || i === widget.children.length - 1) {\n                        break;\n                    }\n                    left += element.margin.left + element.width;\n                }\n            }\n            inline = element;\n            var width = element.margin.left + element.width;\n            if (isNullOrUndefined(inline.nextNode)) {\n                //Include width of Paragraph mark.\n                width += this.viewer.textHelper.getParagraphMarkWidth(inline.line.paragraph.characterFormat);\n            }\n            if (cursorPosition.x <= left + width) {\n                //Check if inline is within a field result.\n                var checkedFields = [];\n                var field = this.getHyperLinkFieldInternal(inline.line.paragraph, inline, checkedFields);\n                checkedFields = [];\n                checkedFields = undefined;\n                return field;\n            }\n        }\n        return undefined;\n    };\n    /**\n     * Return field if paragraph contain hyperlink field\n     * @private\n     */\n    Selection.prototype.getHyperlinkField = function () {\n        if (isNullOrUndefined(this.end)) {\n            return undefined;\n        }\n        var index = 0;\n        var currentInline = this.end.currentWidget.getInline(this.end.offset, index);\n        index = currentInline.index;\n        var inline = currentInline.element;\n        var checkedFields = [];\n        var field = undefined;\n        if (isNullOrUndefined(inline)) {\n            field = this.getHyperLinkFields(this.end.paragraph, checkedFields);\n        }\n        else {\n            var paragraph = inline.line.paragraph;\n            field = this.getHyperLinkFieldInternal(paragraph, inline, checkedFields);\n        }\n        checkedFields = [];\n        return field;\n    };\n    /**\n     * @private\n     */\n    Selection.prototype.getHyperLinkFields = function (paragraph, checkedFields) {\n        for (var i = 0; i < this.viewer.fields.length; i++) {\n            if (checkedFields.indexOf(this.viewer.fields[i]) !== -1 || isNullOrUndefined(this.viewer.fields[i].fieldSeparator)) {\n                continue;\n            }\n            else {\n                checkedFields.push(this.viewer.fields[i]);\n            }\n            var field = this.getFieldCode(this.viewer.fields[i]);\n            field = field.trim().toLowerCase();\n            if (field.match('hyperlink ') && this.paragraphIsInFieldResult(this.viewer.fields[i], paragraph)) {\n                return this.viewer.fields[i];\n            }\n        }\n        // if (paragraph.containerWidget instanceof BodyWidget && !(paragraph instanceof WHeaderFooter)) {\n        //     return this.getHyperLinkFields((paragraph.con as WCompositeNode), checkedFields);\n        // }\n        return undefined;\n    };\n    /**\n     * @private\n     */\n    Selection.prototype.getHyperLinkFieldInternal = function (paragraph, inline, fields) {\n        for (var i = 0; i < this.viewer.fields.length; i++) {\n            if (fields.indexOf(this.viewer.fields[i]) !== -1 || isNullOrUndefined(this.viewer.fields[i].fieldSeparator)) {\n                continue;\n            }\n            else {\n                fields.push(this.viewer.fields[i]);\n            }\n            var fieldCode = this.getFieldCode(this.viewer.fields[i]);\n            fieldCode = fieldCode.trim().toLowerCase();\n            if (fieldCode.match('hyperlink ') && (this.inlineIsInFieldResult(this.viewer.fields[i], inline) || this.isImageField())) {\n                return this.viewer.fields[i];\n            }\n        }\n        if (paragraph.containerWidget instanceof BodyWidget && !(paragraph instanceof HeaderFooterWidget)) {\n            return this.getHyperLinkFieldInternal(paragraph.containerWidget, inline, fields);\n        }\n        return undefined;\n    };\n    /**\n     * @private\n     */\n    Selection.prototype.getBlock = function (currentIndex) {\n        if (currentIndex === '' || isNullOrUndefined(currentIndex)) {\n            return undefined;\n        }\n        var index = { index: currentIndex };\n        var page = this.start.getPage(index);\n        var bodyIndex = index.index.indexOf(';');\n        var value = index.index.substring(0, bodyIndex);\n        index.index = index.index.substring(bodyIndex).replace(';', '');\n        var bodyWidget = page.bodyWidgets[parseInt(value, 10)];\n        return this.getBlockInternal(bodyWidget, index.index);\n    };\n    /**\n     * Return Block relative to position\n     * @private\n     */\n    Selection.prototype.getBlockInternal = function (widget, position) {\n        if (position === '' || isNullOrUndefined(position)) {\n            return undefined;\n        }\n        var index = position.indexOf(';');\n        var value = position.substring(0, index);\n        position = position.substring(index).replace(';', '');\n        var node = widget;\n        // if (node instanceof Widget && value === 'HF') {\n        //     //Gets the block in Header footers.\n        //     let blockObj: BlockInfo = this.getBlock((node as WSection).headersFooters, position);\n        // tslint:disable-next-line:max-line-length\n        //     return { 'node': (!isNullOrUndefined(blockObj)) ? blockObj.node : undefined, 'position': (!isNullOrUndefined(blockObj)) ? blockObj.position : undefined };\n        // }\n        index = parseInt(value, 10);\n        if (index >= 0 && index < widget.childWidgets.length) {\n            var child = widget.childWidgets[(index)];\n            if (position.indexOf(';') >= 0) {\n                if (child instanceof ParagraphWidget) {\n                    if (position.indexOf(';') >= 0) {\n                        position = '0';\n                    }\n                    return child;\n                }\n                if (child instanceof BlockWidget) {\n                    var blockObj = this.getBlockInternal(child, position);\n                    return blockObj;\n                }\n            }\n            else {\n                return child;\n            }\n        }\n        else {\n            return node;\n        }\n        return node;\n    };\n    /**\n     * Return true if inline is in field result\n     * @private\n     */\n    Selection.prototype.inlineIsInFieldResult = function (fieldBegin, inline) {\n        if (!isNullOrUndefined(fieldBegin.fieldEnd) && !isNullOrUndefined(fieldBegin.fieldSeparator)) {\n            if (this.isExistBeforeInline(fieldBegin.fieldSeparator, inline)) {\n                return this.isExistAfterInline(fieldBegin.fieldEnd, inline);\n            }\n        }\n        return false;\n    };\n    /**\n     * Retrieve true if paragraph is in field result\n     * @private\n     */\n    Selection.prototype.paragraphIsInFieldResult = function (fieldBegin, paragraph) {\n        if (!isNullOrUndefined(fieldBegin.fieldEnd) && !isNullOrUndefined(fieldBegin.fieldSeparator)) {\n            var fieldParagraph = fieldBegin.fieldSeparator.line.paragraph;\n            if (fieldBegin.fieldSeparator.line.paragraph === paragraph\n                || this.isExistBefore(fieldParagraph, paragraph)) {\n                var currentParagraph = fieldBegin.fieldEnd.line.paragraph;\n                return (currentParagraph !== paragraph && this.isExistAfter(fieldParagraph, paragraph));\n            }\n        }\n        return false;\n    };\n    /**\n     * Return true if image is In field\n     * @private\n     */\n    Selection.prototype.isImageField = function () {\n        if (this.start.paragraph.isEmpty() || this.end.paragraph.isEmpty()) {\n            return false;\n        }\n        var startPosition = this.start;\n        var endPosition = this.end;\n        if (!this.isForward) {\n            startPosition = this.end;\n            endPosition = this.start;\n        }\n        var indexInInline = 0;\n        var inlineInfo = startPosition.paragraph.getInline(startPosition.offset, indexInInline);\n        var inline = inlineInfo.element;\n        indexInInline = inlineInfo.index;\n        if (indexInInline === inline.length) {\n            inline = this.getNextRenderedElementBox(inline, indexInInline);\n        }\n        inlineInfo = endPosition.paragraph.getInline(endPosition.offset, indexInInline);\n        var endInline = inlineInfo.element;\n        indexInInline = inlineInfo.index;\n        if (inline instanceof FieldElementBox && inline.fieldType === 0\n            && endInline instanceof FieldElementBox && endInline.fieldType === 1 && inline.fieldSeparator) {\n            var fieldValue = inline.fieldSeparator.nextNode;\n            if (fieldValue instanceof ImageElementBox && fieldValue.nextNode === endInline) {\n                return true;\n            }\n        }\n        return false;\n    };\n    /**\n     * Select List Text\n     * @private\n     */\n    Selection.prototype.selectListText = function () {\n        var lineWidget = this.viewer.selectionLineWidget;\n        var endOffset = '0';\n        var selectionIndex = lineWidget.getHierarchicalIndex(endOffset);\n        var startPosition = this.getTextPosition(selectionIndex);\n        var endPosition = this.getTextPosition(selectionIndex);\n        this.selectRange(startPosition, endPosition);\n        this.highlightListText(this.viewer.selectionLineWidget);\n        this.contextTypeInternal = 'List';\n    };\n    /**\n     * Manually select the list text\n     * @private\n     */\n    Selection.prototype.highlightListText = function (linewidget) {\n        var width = linewidget.children[0].width;\n        var left = this.viewer.getLeftValue(linewidget);\n        var top = linewidget.paragraph.y;\n        this.createHighlightBorder(linewidget, width, left, top);\n        this.viewer.isListTextSelected = true;\n    };\n    /**\n     * @private\n     */\n    Selection.prototype.updateImageSize = function (imageFormat) {\n        this.owner.isShiftingEnabled = true;\n        var startPosition = this.start;\n        var endPosition = this.end;\n        if (!this.isForward) {\n            startPosition = this.end;\n            endPosition = this.start;\n        }\n        var inline = null;\n        var index = 0;\n        var paragraph = startPosition.paragraph;\n        if (paragraph === endPosition.paragraph\n            && startPosition.offset + 1 === endPosition.offset) {\n            var inlineObj = paragraph.getInline(endPosition.offset, index);\n            inline = inlineObj.element;\n            index = inlineObj.index;\n        }\n        if (inline instanceof ImageElementBox) {\n            var width = inline.width;\n            var height = inline.height;\n            inline.width = imageFormat.width;\n            inline.height = imageFormat.height;\n            imageFormat.width = width;\n            imageFormat.height = height;\n            if (paragraph != null && paragraph.containerWidget != null && this.owner.editorModule) {\n                var lineIndex = paragraph.childWidgets.indexOf(inline.line);\n                var elementIndex = inline.line.children.indexOf(inline);\n                this.viewer.layout.reLayoutParagraph(paragraph, lineIndex, elementIndex);\n                this.highlightSelection(false);\n            }\n        }\n    };\n    /**\n     * Gets selected table content\n     * @private\n     */\n    Selection.prototype.getSelectedCellsInTable = function (table, startCell, endCell) {\n        var startColumnIndex = startCell.columnIndex;\n        var endColumnIndex = endCell.columnIndex + endCell.cellFormat.columnSpan - 1;\n        var startRowindex = startCell.ownerRow.index;\n        var endRowIndex = endCell.ownerRow.index;\n        var cells = [];\n        for (var i = 0; i < table.childWidgets.length; i++) {\n            var row = table.childWidgets[i];\n            if (row.index >= startRowindex && row.index <= endRowIndex) {\n                for (var j = 0; j < row.childWidgets.length; j++) {\n                    var cell = row.childWidgets[j];\n                    if (cell.columnIndex >= startColumnIndex && cell.columnIndex <= endColumnIndex) {\n                        cells.push(cell);\n                    }\n                }\n            }\n            if (row.index > endRowIndex) {\n                break;\n            }\n        }\n        return cells;\n        // return html;\n    };\n    /**\n     * Copies the selected content to clipboard.\n     */\n    Selection.prototype.copy = function () {\n        if (this.isEmpty) {\n            return;\n        }\n        this.copySelectedContent(false);\n    };\n    /**\n     * @private\n     */\n    Selection.prototype.copySelectedContent = function (isCut) {\n        if (isNullOrUndefined(this.owner.sfdtExportModule)) {\n            return;\n        }\n        var startPosition = this.start;\n        var endPosition = this.end;\n        if (!this.isForward) {\n            startPosition = this.end;\n            endPosition = this.start;\n        }\n        /* tslint:disable:no-any */\n        // tslint:disable-next-line:max-line-length\n        var document = this.owner.sfdtExportModule.write(startPosition.currentWidget, startPosition.offset, endPosition.currentWidget, endPosition.offset, true);\n        /* tslint:enable:no-any */\n        if (this.owner.editorModule) {\n            this.owner.editorModule.copiedData = JSON.stringify(document);\n        }\n        var html = this.htmlWriter.writeHtml(document);\n        this.copyToClipboard(html);\n        if (isCut && this.owner.editorModule) {\n            this.owner.editorModule.handleCut(this);\n        }\n        this.viewer.updateFocus();\n    };\n    /**\n     * Copy content to clipboard\n     * @private\n     */\n    Selection.prototype.copyToClipboard = function (htmlContent) {\n        window.getSelection().removeAllRanges();\n        var div = document.createElement('div');\n        div.style.left = '-10000px';\n        div.style.top = '-10000px';\n        div.innerHTML = htmlContent;\n        document.body.appendChild(div);\n        var range = document.createRange();\n        range.selectNodeContents(div);\n        window.getSelection().addRange(range);\n        var copySuccess = false;\n        try {\n            copySuccess = document.execCommand('copy');\n        }\n        catch (e) {\n            // Copying data to Clipboard can potentially fail - for example, if another application is holding Clipboard open.\n        }\n        finally {\n            window.getSelection().removeAllRanges();\n            div.parentNode.removeChild(div);\n            this.viewer.viewerContainer.focus();\n        }\n        return copySuccess;\n    };\n    // Caret implementation starts\n    /**\n     * Shows caret in current selection position.\n     * @private\n     */\n    Selection.prototype.showCaret = function () {\n        // tslint:disable-next-line:max-line-length\n        var page = !isNullOrUndefined(this.viewer.currentPage) ? this.viewer.currentPage : this.viewer.currentRenderingPage;\n        if (isNullOrUndefined(page) || this.viewer.isRowOrCellResizing || this.owner.enableImageResizerMode && this.owner.imageResizerModule.isImageResizerVisible) {\n            return;\n        }\n        var left = page.boundingRectangle.x;\n        var right = page.boundingRectangle.width * this.viewer.zoomFactor + left;\n        if (!this.owner.enableImageResizerMode || !this.owner.imageResizerModule.isImageResizerVisible) {\n            // tslint:disable-next-line:max-line-length\n            if (this.isEmpty && (!this.owner.isReadOnlyMode || this.owner.enableCursorOnReadOnly)) {\n                var caretLeft = parseInt(this.caret.style.left.replace('px', ''), 10);\n                if (caretLeft < left || caretLeft > right) {\n                    this.caret.style.display = 'none';\n                }\n                else {\n                    this.caret.style.display = 'block';\n                }\n            }\n            else if (this.isImageSelected && !this.owner.enableImageResizerMode) {\n                this.caret.style.display = 'block';\n            }\n            else {\n                if (this.caret.style.display === 'block' || isNullOrUndefined(this)) {\n                    this.caret.style.display = 'none';\n                }\n            }\n        }\n        if (!isNullOrUndefined(this) && this.viewer.isTouchInput && !this.owner.isReadOnlyMode) {\n            var caretStartLeft = parseInt(this.viewer.touchStart.style.left.replace('px', ''), 10) + 14;\n            var caretEndLeft = parseInt(this.viewer.touchEnd.style.left.replace('px', ''), 10) + 14;\n            var page_1 = this.getSelectionPage(this.start);\n            if (page_1) {\n                if (caretEndLeft < left || caretEndLeft > right) {\n                    this.viewer.touchEnd.style.display = 'none';\n                }\n                else {\n                    this.viewer.touchEnd.style.display = 'block';\n                }\n                if (!this.isEmpty) {\n                    left = page_1.boundingRectangle.x;\n                    right = page_1.boundingRectangle.width * this.viewer.zoomFactor + left;\n                }\n                if (caretStartLeft < left || caretStartLeft > right) {\n                    this.viewer.touchStart.style.display = 'none';\n                }\n                else {\n                    this.viewer.touchStart.style.display = 'block';\n                }\n            }\n        }\n        else {\n            this.viewer.touchStart.style.display = 'none';\n            this.viewer.touchEnd.style.display = 'none';\n        }\n    };\n    /**\n     * To set the editable div caret position\n     * @private\n     */\n    Selection.prototype.setEditableDivCaretPosition = function (index) {\n        this.viewer.editableDiv.focus();\n        var child = this.viewer.editableDiv.childNodes[this.viewer.editableDiv.childNodes.length - 1];\n        if (child) {\n            var range = document.createRange();\n            range.setStart(child, index);\n            range.collapse(true);\n            window.getSelection().removeAllRanges();\n            window.getSelection().addRange(range);\n        }\n    };\n    /**\n     * Initializes caret.\n     * @private\n     */\n    Selection.prototype.initCaret = function () {\n        this.caret = createElement('div', {\n            styles: 'position:absolute',\n            className: 'e-de-blink-cursor e-de-cursor-animation'\n        });\n        this.viewer.viewerContainer.appendChild(this.caret);\n    };\n    /**\n     * Updates caret position.\n     * @private\n     */\n    Selection.prototype.updateCaretPosition = function () {\n        var caretPosition = this.end.location;\n        var page = this.getSelectionPage(this.end);\n        if (page) {\n            this.caret.style.left = page.boundingRectangle.x + (Math.round(caretPosition.x) * this.viewer.zoomFactor) + 'px';\n            var caretInfo = this.updateCaretSize(this.owner.selection.end);\n            var topMargin = caretInfo.topMargin;\n            var caretHeight = caretInfo.height;\n            var viewer = this.viewer;\n            // tslint:disable-next-line:max-line-length\n            var pageTop = (page.boundingRectangle.y - viewer.pageGap * (this.viewer.pages.indexOf(page) + 1)) * this.viewer.zoomFactor + viewer.pageGap * (this.viewer.pages.indexOf(page) + 1);\n            this.caret.style.top = pageTop + (Math.round(caretPosition.y + topMargin) * this.viewer.zoomFactor) + 'px';\n            if (this.owner.selection.characterFormat.baselineAlignment === 'Subscript') {\n                this.caret.style.top = parseFloat(this.caret.style.top) + (parseFloat(this.caret.style.height) / 2) + 'px';\n            }\n            if (this.viewer.isTouchInput || this.viewer.touchStart.style.display !== 'none') {\n                // tslint:disable-next-line:max-line-length\n                this.viewer.touchStart.style.left = page.boundingRectangle.x + (Math.round(caretPosition.x) * this.viewer.zoomFactor - 14) + 'px';\n                this.viewer.touchStart.style.top = pageTop + ((caretPosition.y + caretInfo.height) * this.viewer.zoomFactor) + 'px';\n                // tslint:disable-next-line:max-line-length\n                this.viewer.touchEnd.style.left = page.boundingRectangle.x + (Math.round(caretPosition.x) * this.viewer.zoomFactor - 14) + 'px';\n                this.viewer.touchEnd.style.top = pageTop + ((caretPosition.y + caretInfo.height) * this.viewer.zoomFactor) + 'px';\n            }\n        }\n    };\n    /**\n     * Gets current selected page\n     */\n    Selection.prototype.getSelectionPage = function (position) {\n        var lineWidget = this.getLineWidgetInternal(position.currentWidget, position.offset, true);\n        if (lineWidget) {\n            return this.getPage(lineWidget.paragraph);\n        }\n        return undefined;\n    };\n    /**\n     * Updates caret size.\n     * @private\n     */\n    Selection.prototype.updateCaretSize = function (textPosition, skipUpdate) {\n        var topMargin = 0;\n        var isItalic = false;\n        var caret;\n        var index = 0;\n        var caretHeight = 0;\n        if (this.characterFormat.italic) {\n            isItalic = this.characterFormat.italic;\n        }\n        if (textPosition.paragraph.isEmpty()) {\n            var paragraph = textPosition.paragraph;\n            var bottomMargin = 0;\n            var paragraphInfo = this.getParagraphMarkSize(paragraph, topMargin, bottomMargin);\n            topMargin = paragraphInfo.topMargin;\n            bottomMargin = paragraphInfo.bottomMargin;\n            var height = paragraphInfo.height;\n            caretHeight = topMargin < 0 ? topMargin + height : height;\n            if (!skipUpdate) {\n                this.caret.style.height = caretHeight * this.viewer.zoomFactor + 'px';\n            }\n            topMargin = 0;\n        }\n        else {\n            var inlineInfo = textPosition.currentWidget.getInline(textPosition.offset, index);\n            index = inlineInfo.index;\n            var inline = inlineInfo.element;\n            if (!isNullOrUndefined(inline)) {\n                caret = this.getCaretHeight(inline, index, inline.characterFormat, true, topMargin, isItalic);\n                caretHeight = caret.height;\n                if (!skipUpdate) {\n                    this.caret.style.height = caret.height * this.viewer.zoomFactor + 'px';\n                }\n            }\n        }\n        if (!skipUpdate) {\n            if (isItalic) {\n                this.caret.style.transform = 'rotate(13deg)';\n            }\n            else {\n                this.caret.style.transform = '';\n            }\n        }\n        return {\n            'topMargin': topMargin,\n            'height': caretHeight\n        };\n    };\n    /**\n     * Updates caret to page.\n     * @private\n     */\n    Selection.prototype.updateCaretToPage = function (startPosition, endPage) {\n        if (!isNullOrUndefined(endPage)) {\n            this.viewer.selectionEndPage = endPage;\n            if (this.owner.selection.isEmpty) {\n                this.viewer.selectionStartPage = endPage;\n            }\n            else {\n                // tslint:disable-next-line:max-line-length\n                var startLineWidget = this.getLineWidgetParagraph(startPosition.offset, startPosition.paragraph.childWidgets[0]);\n                //Gets start page.\n                var startPage = this.getPage(startLineWidget.paragraph);\n                if (!isNullOrUndefined(startPage)) {\n                    this.viewer.selectionStartPage = startPage;\n                }\n            }\n        }\n        this.checkForCursorVisibility();\n    };\n    /**\n     * Gets caret bottom position.\n     * @private\n     */\n    Selection.prototype.getCaretBottom = function (textPosition, isEmptySelection) {\n        var bottom = textPosition.location.y;\n        if (textPosition.paragraph.isEmpty()) {\n            var paragraph = textPosition.paragraph;\n            var topMargin = 0;\n            var bottomMargin = 0;\n            var sizeInfo = this.getParagraphMarkSize(paragraph, topMargin, bottomMargin);\n            topMargin = sizeInfo.topMargin;\n            bottomMargin = sizeInfo.bottomMargin;\n            bottom += sizeInfo.height;\n            bottom += topMargin;\n            if (!isEmptySelection) {\n                bottom += bottomMargin;\n            }\n        }\n        else {\n            var index = 0;\n            var inlineInfo = textPosition.paragraph.getInline(textPosition.offset, index);\n            var inline = inlineInfo.element;\n            index = inlineInfo.index;\n            var topMargin = 0;\n            var isItalic = false;\n            // tslint:disable-next-line:max-line-length\n            var caretHeightInfo = this.getCaretHeight(inline, index, inline.characterFormat, false, topMargin, isItalic);\n            topMargin = caretHeightInfo.topMargin;\n            isItalic = caretHeightInfo.isItalic;\n            bottom += caretHeightInfo.height;\n            if (isEmptySelection) {\n                bottom -= HelperMethods.convertPointToPixel(textPosition.paragraph.paragraphFormat.afterSpacing);\n            }\n        }\n        return bottom;\n    };\n    /**\n     * Checks for cursor visibility.\n     * @param isTouch\n     * @private\n     */\n    Selection.prototype.checkForCursorVisibility = function () {\n        this.showCaret();\n    };\n    // caret implementation ends\n    /**\n     * Keyboard shortcuts\n     * @private\n     */\n    // tslint:disable:max-func-body-length\n    Selection.prototype.onKeyDownInternal = function (event, ctrl, shift, alt) {\n        var key = event.which || event.keyCode;\n        if (ctrl && !shift && !alt) {\n            this.viewer.isControlPressed = true;\n            switch (key) {\n                // case 9:\n                //     event.preventDefault();\n                //     if (this.owner.acceptTab) {\n                //         this.selection.handleTabKey(false, false);\n                //     }\n                //     break;\n                case 35:\n                    this.handleControlEndKey();\n                    break;\n                case 36:\n                    this.handleControlHomeKey();\n                    break;\n                case 37:\n                    this.handleControlLeftKey();\n                    break;\n                case 38:\n                    this.handleControlUpKey();\n                    break;\n                case 39:\n                    this.handleControlRightKey();\n                    break;\n                case 40:\n                    this.handleControlDownKey();\n                    break;\n                case 65:\n                    this.owner.selection.selectAll();\n                    break;\n                case 67:\n                    event.preventDefault();\n                    this.copy();\n                    break;\n                case 70:\n                    event.preventDefault();\n                    if (!isNullOrUndefined(this.owner.optionsPaneModule)) {\n                        this.owner.optionsPaneModule.showHideOptionsPane(true);\n                    }\n                    break;\n            }\n        }\n        else if (shift && !ctrl && !alt) {\n            switch (key) {\n                case 35:\n                    this.handleShiftEndKey();\n                    event.preventDefault();\n                    break;\n                case 36:\n                    this.handleShiftHomeKey();\n                    event.preventDefault();\n                    break;\n                case 37:\n                    this.handleShiftLeftKey();\n                    event.preventDefault();\n                    break;\n                case 38:\n                    this.handleShiftUpKey();\n                    event.preventDefault();\n                    break;\n                case 39:\n                    this.handleShiftRightKey();\n                    event.preventDefault();\n                    break;\n                case 40:\n                    this.handleShiftDownKey();\n                    event.preventDefault();\n                    break;\n            }\n        }\n        else if (shift && ctrl && !alt) {\n            switch (key) {\n                case 35:\n                    this.handleControlShiftEndKey();\n                    break;\n                case 36:\n                    this.handleControlShiftHomeKey();\n                    break;\n                case 37:\n                    this.handleControlShiftLeftKey();\n                    break;\n                case 38:\n                    this.handleControlShiftUpKey();\n                    break;\n                case 39:\n                    this.handleControlShiftRightKey();\n                    break;\n                case 40:\n                    this.handleControlShiftDownKey();\n                    break;\n            }\n        }\n        else {\n            switch (key) {\n                // case 9:\n                //     event.preventDefault();\n                //     if (this.owner.acceptTab) {\n                //         this.handleTabKey(true, false);\n                //     }\n                //     break;             \n                case 33:\n                    event.preventDefault();\n                    this.viewer.viewerContainer.scrollTop -= this.viewer.visibleBounds.height;\n                    break;\n                case 34:\n                    event.preventDefault();\n                    this.viewer.viewerContainer.scrollTop += this.viewer.visibleBounds.height;\n                    break;\n                case 35:\n                    this.handleEndKey();\n                    event.preventDefault();\n                    break;\n                case 36:\n                    this.handleHomeKey();\n                    event.preventDefault();\n                    break;\n                case 37:\n                    this.handleLeftKey();\n                    event.preventDefault();\n                    break;\n                case 38:\n                    this.handleUpKey();\n                    event.preventDefault();\n                    break;\n                case 39:\n                    this.handleRightKey();\n                    event.preventDefault();\n                    break;\n                case 40:\n                    this.handleDownKey();\n                    event.preventDefault();\n                    break;\n            }\n        }\n        if (!this.owner.isReadOnlyMode) {\n            this.owner.editorModule.onKeyDownInternal(event, ctrl, shift, alt);\n        }\n        if (this.owner.searchModule) {\n            // tslint:disable-next-line:max-line-length\n            if (!isNullOrUndefined(this.owner.searchModule.searchHighlighters) && this.owner.searchModule.searchHighlighters.length > 0) {\n                this.owner.searchModule.searchResults.clear();\n            }\n        }\n        if (event.keyCode === 27 || event.which === 27) {\n            if (!isNullOrUndefined(this.owner.optionsPaneModule)) {\n                this.owner.optionsPaneModule.showHideOptionsPane(false);\n            }\n            if (this.owner.enableHeaderAndFooter) {\n                this.disableHeaderFooter();\n            }\n        }\n    };\n    //#region Enable or disable Header Footer\n    /**\n     * @private\n     */\n    Selection.prototype.checkAndEnableHeaderFooter = function (point, pagePoint) {\n        var page = this.viewer.currentPage;\n        if (this.isCursorInsidePageRect(point, page)) {\n            if (this.isCursorInHeaderRegion(point, page)) {\n                if (this.owner.enableHeaderAndFooter) {\n                    return false;\n                }\n                return this.enableHeadersFootersRegion(page.headerWidget);\n            }\n            if (this.isCursorInFooterRegion(point, page)) {\n                if (this.owner.enableHeaderAndFooter) {\n                    return false;\n                }\n                return this.enableHeadersFootersRegion(page.footerWidget);\n            }\n        }\n        if (this.owner.enableHeaderAndFooter) {\n            this.owner.enableHeaderAndFooter = false;\n            this.viewer.updateTextPositionForSelection(pagePoint, 1);\n            return true;\n        }\n        return false;\n    };\n    /**\n     * @private\n     */\n    Selection.prototype.isCursorInsidePageRect = function (point, page) {\n        if ((this.viewer.containerLeft + point.x) >= page.boundingRectangle.x &&\n            (this.viewer.containerLeft + point.x) <= (page.boundingRectangle.x + (page.boundingRectangle.width * this.viewer.zoomFactor))) {\n            return true;\n        }\n        return false;\n    };\n    /**\n     * @private\n     */\n    Selection.prototype.isCursorInHeaderRegion = function (point, page) {\n        var pageTop = this.getPageTop(page);\n        var headerHeight = 0;\n        if (page.headerWidget) {\n            headerHeight = (page.headerWidget.y + page.headerWidget.height);\n        }\n        var height = Math.max(headerHeight, HelperMethods.convertPointToPixel(page.bodyWidgets[0].sectionFormat.topMargin))\n            * this.viewer.zoomFactor;\n        if ((this.viewer.containerTop + point.y) >= pageTop && (this.viewer.containerTop + point.y) <= pageTop + height) {\n            return true;\n        }\n        return false;\n    };\n    /**\n     * @private\n     */\n    Selection.prototype.isCursorInFooterRegion = function (point, page) {\n        var pageRect = page.boundingRectangle;\n        var pageTop = this.getPageTop(page);\n        var pageBottom = pageTop + (pageRect.height * this.viewer.zoomFactor);\n        var footerDistance = HelperMethods.convertPointToPixel(page.bodyWidgets[0].sectionFormat.footerDistance);\n        var footerHeight = 0;\n        if (page.footerWidget) {\n            footerHeight = page.footerWidget.height;\n        }\n        // tslint:disable-next-line:max-line-length\n        var height = (pageRect.height -\n            Math.max(footerHeight + footerDistance, HelperMethods.convertPointToPixel(page.bodyWidgets[0].sectionFormat.bottomMargin))) * this.viewer.zoomFactor;\n        if ((this.viewer.containerTop + point.y) <= pageBottom && (this.viewer.containerTop + point.y) >= pageTop + height) {\n            return true;\n        }\n        return false;\n    };\n    /**\n     * @private\n     */\n    Selection.prototype.enableHeadersFootersRegion = function (widget) {\n        this.owner.enableHeaderAndFooter = true;\n        this.updateTextPositionForBlockContainer(widget);\n        return true;\n    };\n    /**\n     * @private\n     */\n    Selection.prototype.updateTextPositionForBlockContainer = function (widget) {\n        var block = widget.firstChild;\n        if (block instanceof TableWidget) {\n            block = this.getFirstBlockInFirstCell(block);\n        }\n        this.selectParagraph(block, true);\n    };\n    /**\n     * Disable Header footer\n     * @private\n     */\n    Selection.prototype.disableHeaderFooter = function () {\n        var page = this.getPage(this.start.paragraph);\n        this.updateTextPositionForBlockContainer(page.bodyWidgets[0]);\n        this.owner.enableHeaderAndFooter = false;\n    };\n    //#endregion\n    /**\n     * @private\n     */\n    Selection.prototype.destroy = function () {\n        if (!isNullOrUndefined(this.contextTypeInternal)) {\n            this.contextTypeInternal = undefined;\n        }\n        this.caret = undefined;\n        this.contextTypeInternal = undefined;\n        this.upDownSelectionLength = undefined;\n        this.viewer = undefined;\n        this.owner = undefined;\n    };\n    /**\n     * Navigates to the specified bookmark.\n     * @param name\n     * @param moveToStart\n     * @private\n     */\n    Selection.prototype.navigateBookmark = function (name, moveToStart) {\n        var bookmarks = this.viewer.bookmarks;\n        if (bookmarks.containsKey(name)) {\n            //bookmark start element\n            var bookmrkElmnt = bookmarks.get(name);\n            var offset = bookmrkElmnt.line.getOffset(bookmrkElmnt, 1);\n            var startPosition = new TextPosition(this.viewer.owner);\n            startPosition.setPositionParagraph(bookmrkElmnt.line, offset);\n            if (moveToStart) {\n                this.viewer.selection.selectRange(startPosition, startPosition);\n            }\n            else {\n                //bookmark end element\n                var bookmrkEnd = bookmrkElmnt.reference;\n                var endoffset = bookmrkEnd.line.getOffset(bookmrkEnd, 0);\n                var endPosition = new TextPosition(this.viewer.owner);\n                endPosition.setPositionParagraph(bookmrkEnd.line, endoffset);\n                //selects the bookmark range\n                this.viewer.selection.selectRange(startPosition, endPosition);\n            }\n        }\n    };\n    /**\n     * Selects the specified bookmark.\n     * @param name\n     */\n    Selection.prototype.selectBookmark = function (name) {\n        this.navigateBookmark(name);\n    };\n    /**\n     * Returns the toc field from the selection.\n     * @private\n     */\n    Selection.prototype.getTocField = function () {\n        var paragraph = this.start.paragraph;\n        var tocPara = undefined;\n        while ((paragraph !== undefined && this.isTocStyle(paragraph))) {\n            tocPara = paragraph;\n            paragraph = paragraph.previousRenderedWidget;\n        }\n        if (tocPara !== undefined) {\n            var lineWidget = tocPara.childWidgets[0];\n            if (lineWidget !== undefined) {\n                return lineWidget.children[0];\n            }\n        }\n        return undefined;\n    };\n    /**\n     * Returns true if the paragraph has toc style.\n     */\n    Selection.prototype.isTocStyle = function (paragraph) {\n        var style = paragraph.paragraphFormat.baseStyle;\n        return (style !== undefined && (style.name.toLowerCase().indexOf('toc') !== -1));\n    };\n    return Selection;\n}());\nexport { Selection };\n","import { Dictionary } from '../../base/dictionary';\nimport { isNullOrUndefined } from '@syncfusion/ej2-base';\nimport { TextPosition } from '../selection/selection-helper';\nimport { TextElementBox, ParagraphWidget, ListTextElementBox, FieldElementBox } from '../viewer/page';\n/**\n * @private\n */\nvar TextSearch = /** @class */ (function () {\n    function TextSearch(owner) {\n        this.wordBefore = '\\\\b';\n        this.wordAfter = '\\\\b';\n        this.isHeader = false;\n        this.isFooter = false;\n        this.owner = owner;\n    }\n    Object.defineProperty(TextSearch.prototype, \"viewer\", {\n        get: function () {\n            return this.owner.viewer;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    TextSearch.prototype.find = function (pattern, findOption) {\n        return this.findNext(pattern, findOption, '0;0;0');\n    };\n    // tslint:disable-next-line:max-line-length   \n    TextSearch.prototype.findNext = function (pattern, findOption, hierarchicalPosition) {\n        if (typeof pattern === 'string') {\n            pattern = this.stringToRegex(pattern, findOption);\n        }\n        if (hierarchicalPosition === undefined) {\n            hierarchicalPosition = '0;0;0';\n        }\n        this.owner.searchModule.textSearchResults.clearResults();\n        var results = this.owner.searchModule.textSearchResults;\n        this.findDocument(results, pattern, true, findOption, hierarchicalPosition);\n        return results.length > 0, results.currentSearchResult;\n    };\n    TextSearch.prototype.stringToRegex = function (textToFind, option) {\n        if (textToFind.indexOf('\\\\') > -1) {\n            textToFind = textToFind.split('\\\\').join('\\\\\\\\');\n        }\n        if (textToFind.indexOf('.') > -1) {\n            textToFind = '\\\\' + textToFind;\n        }\n        if (option === 'WholeWord' || option === 'CaseSensitiveWholeWord') {\n            textToFind = this.wordBefore + textToFind + this.wordAfter;\n        }\n        return new RegExp(textToFind, (option === 'CaseSensitive' || option === 'CaseSensitiveWholeWord') ? 'g' : 'ig');\n    };\n    TextSearch.prototype.isPatternEmpty = function (pattern) {\n        var wordEmpty = this.wordBefore + this.wordAfter;\n        var patternRegExp = pattern.toString();\n        return (patternRegExp.length === 0 || patternRegExp === wordEmpty);\n    };\n    // tslint:disable-next-line:max-line-length     \n    TextSearch.prototype.findAll = function (pattern, findOption, hierarchicalPosition) {\n        if (typeof pattern === 'string') {\n            pattern = this.stringToRegex(pattern, findOption);\n        }\n        if (hierarchicalPosition === undefined) {\n            hierarchicalPosition = '0;0;0';\n        }\n        this.owner.searchModule.textSearchResults.clearResults();\n        var results = this.owner.searchModule.textSearchResults;\n        this.findDocument(results, pattern, false, findOption, hierarchicalPosition);\n        if (results.length > 0 && results.currentIndex < 0) {\n            results.currentIndex = 0;\n        }\n        if (!isNullOrUndefined(results.currentSearchResult)) {\n            var eventArgs = { source: this.viewer.owner };\n            this.viewer.owner.trigger('searchResultsChange', eventArgs);\n            return results;\n        }\n        return undefined;\n    };\n    // tslint:disable-next-line:max-line-length     \n    TextSearch.prototype.findDocument = function (results, pattern, isFirstMatch, findOption, hierachicalPosition) {\n        if (this.isPatternEmpty(pattern)) {\n            return;\n        }\n        if (findOption === undefined) {\n            findOption = 'None';\n        }\n        var inline = undefined;\n        var selectionEnd = undefined;\n        if (hierachicalPosition !== undefined) {\n            selectionEnd = this.owner.selection.end;\n        }\n        if (hierachicalPosition !== undefined && isFirstMatch && selectionEnd !== undefined && selectionEnd.paragraph !== undefined) {\n            if (selectionEnd.paragraph instanceof ParagraphWidget) {\n                var indexInInline = 0;\n                // tslint:disable-next-line:max-line-length \n                // IndexInInline Handled specifically for simple find operation to start from starting point\n                var inlineElement = selectionEnd.currentWidget.getInline(this.owner.selection.start.offset, indexInInline);\n                inline = inlineElement.element;\n                indexInInline = inlineElement.index;\n                if (!isNullOrUndefined(inline)) {\n                    var nextParagraphWidget = undefined;\n                    // tslint:disable-next-line:max-line-length  \n                    nextParagraphWidget = this.findInline(inline, pattern, findOption, indexInInline, isFirstMatch, results, selectionEnd);\n                    while (results.length === 0 && !isNullOrUndefined(nextParagraphWidget)) {\n                        while (!isNullOrUndefined(nextParagraphWidget) && nextParagraphWidget.childWidgets.length === 0) {\n                            // tslint:disable-next-line:max-line-length \n                            nextParagraphWidget = this.owner.selection.getNextParagraph(nextParagraphWidget.containerWidget);\n                        }\n                        if (isNullOrUndefined(nextParagraphWidget)) {\n                            break;\n                        }\n                        var lineWidget = nextParagraphWidget.childWidgets[0];\n                        if (lineWidget.children[0] instanceof ListTextElementBox) {\n                            inline = (lineWidget.children[2] instanceof TextElementBox) ? lineWidget.children[2] : undefined;\n                        }\n                        else {\n                            inline = lineWidget.children[0];\n                        }\n                        if (isNullOrUndefined(inline)) {\n                            break;\n                        }\n                        // tslint:disable-next-line:max-line-length  \n                        nextParagraphWidget = this.findInline(inline, pattern, findOption, 0, isFirstMatch, results, selectionEnd);\n                    }\n                    if (results.length > 0) {\n                        return;\n                    }\n                }\n            }\n        }\n        var section;\n        section = this.viewer.pages[0].bodyWidgets[0];\n        while (!isNullOrUndefined(section) && section.childWidgets.length === 0) {\n            section = section.nextWidget;\n        }\n        if (isNullOrUndefined(section) || section.childWidgets.length === 0) {\n            return;\n        }\n        this.isHeader = false;\n        this.isFooter = false;\n        this.findInlineText(section, pattern, findOption, isFirstMatch, results, selectionEnd);\n        for (var i = 0; i < this.viewer.pages.length; i++) {\n            var headerWidget = this.viewer.pages[i].headerWidget;\n            if (!isNullOrUndefined(headerWidget)) {\n                this.isHeader = true;\n                this.isFooter = false;\n                this.findInlineText(headerWidget, pattern, findOption, isFirstMatch, results, selectionEnd);\n            }\n        }\n        for (var i = 0; i < this.viewer.pages.length; i++) {\n            var footerWidget = this.viewer.pages[i].footerWidget;\n            if (!isNullOrUndefined(footerWidget)) {\n                this.isHeader = false;\n                this.isFooter = true;\n                this.findInlineText(footerWidget, pattern, findOption, isFirstMatch, results, selectionEnd);\n            }\n        }\n        if (isFirstMatch && !isNullOrUndefined(results) && results.length > 0) {\n            return;\n        }\n    };\n    // tslint:disable-next-line:max-line-length\n    TextSearch.prototype.findInlineText = function (section, pattern, findOption, isFirstMatch, results, selectionEnd) {\n        var paragraphWidget = this.owner.selection.getFirstParagraphBlock(section.childWidgets[0]);\n        // tslint:disable-next-line:max-line-length \n        while (!isNullOrUndefined(paragraphWidget) && paragraphWidget.childWidgets.length === 1 && paragraphWidget.childWidgets[0].children.length === 0) {\n            paragraphWidget = this.owner.selection.getNextParagraphBlock(paragraphWidget);\n        }\n        while (!isNullOrUndefined(paragraphWidget) && paragraphWidget.childWidgets.length > 0) {\n            var inlineElement = paragraphWidget.childWidgets[0];\n            var inlineEle = inlineElement.children[0];\n            if (isNullOrUndefined(inlineEle)) {\n                break;\n            }\n            this.findInline(inlineEle, pattern, findOption, 0, isFirstMatch, results, selectionEnd);\n            paragraphWidget = this.owner.selection.getNextParagraphBlock(paragraphWidget);\n            // tslint:disable-next-line:max-line-length \n            while (!isNullOrUndefined(paragraphWidget) && (paragraphWidget.childWidgets.length === 1) && paragraphWidget.childWidgets[0].children.length === 0) {\n                paragraphWidget = this.owner.selection.getNextParagraphBlock(paragraphWidget);\n            }\n        }\n        if (isFirstMatch && !isNullOrUndefined(results) && results.length > 0) {\n            return;\n        }\n    };\n    // tslint:disable-next-line:max-line-length     \n    TextSearch.prototype.findInline = function (inlineElement, pattern, option, indexInInline, isFirstMatch, results, selectionEnd) {\n        var inlines = inlineElement;\n        var stringBuilder = '';\n        var spans = new Dictionary();\n        //tslint:disable no-constant-condition\n        do {\n            // tslint:disable-next-line:max-line-length \n            if (inlineElement instanceof TextElementBox && (!isNullOrUndefined(inlineElement.text) && inlineElement.text !== '')) {\n                spans.add(inlineElement, stringBuilder.length);\n                // IndexInInline Handled specifically for simple find operation to start from starting point\n                if (inlineElement === inlines) {\n                    stringBuilder = stringBuilder + (inlineElement.text.substring(indexInInline));\n                }\n                else {\n                    stringBuilder = stringBuilder + (inlineElement.text);\n                }\n            }\n            else if (inlineElement instanceof FieldElementBox) {\n                var fieldBegin = inlineElement;\n                if (!isNullOrUndefined(fieldBegin.fieldEnd)) {\n                    // tslint:disable-next-line:max-line-length \n                    inlineElement = isNullOrUndefined(fieldBegin.fieldSeparator) ? fieldBegin.fieldEnd : fieldBegin.fieldSeparator;\n                }\n            }\n            if (!isNullOrUndefined(inlineElement) && isNullOrUndefined(inlineElement.nextNode)) {\n                break;\n            }\n            if (!isNullOrUndefined(inlineElement)) {\n                inlineElement = inlineElement.nextNode;\n            }\n        } while (true);\n        var text = stringBuilder.toString();\n        var matches = [];\n        var matchObject;\n        //tslint:disable no-conditional-assignment\n        while (!isNullOrUndefined(matchObject = pattern.exec(text))) {\n            matches.push(matchObject);\n        }\n        for (var i = 0; i < matches.length; i++) {\n            var match = matches[i];\n            var result = results.addResult();\n            var spanKeys = spans.keys;\n            for (var i_1 = 0; i_1 < spanKeys.length; i_1++) {\n                var span = spanKeys[i_1];\n                var startIndex = spans.get(span);\n                var spanLength = span.length;\n                // IndexInInline Handled specifically for simple find operation to start from starting point\n                if (span === inlines) {\n                    spanLength -= indexInInline;\n                }\n                if (isNullOrUndefined(result.start) && match.index < startIndex + spanLength) {\n                    var index = match.index - startIndex;\n                    // IndexInInline Handled specifically for simple find operation to start from starting point\n                    if (span === inlines) {\n                        index += indexInInline;\n                    }\n                    var offset = (span.line).getOffset(span, index);\n                    result.start = this.getTextPosition(span.line, offset.toString());\n                    result.start.location = this.owner.selection.getPhysicalPositionInternal(span.line, offset, true);\n                    result.start.setPositionParagraph(span.line, offset);\n                }\n                if (match.index + match[0].length <= startIndex + spanLength) {\n                    var index = (match.index + match[0].length) - startIndex;\n                    // IndexInInline Handled specifically for simple find operation to start from starting point\n                    if (span === inlines) {\n                        index += indexInInline;\n                    }\n                    var offset = (span.line).getOffset(span, index);\n                    result.end = this.getTextPosition(span.line, offset.toString());\n                    result.end.location = this.owner.selection.getPhysicalPositionInternal(span.line, offset, true);\n                    result.end.setPositionParagraph(span.line, offset);\n                    break;\n                }\n            }\n            result.isHeader = this.isHeader;\n            result.isFooter = this.isFooter;\n            if (isFirstMatch) {\n                results.currentIndex = 0;\n                return undefined;\n            }\n            else if (results.currentIndex < 0 && selectionEnd.isExistBefore(result.start)) {\n                results.currentIndex = results.indexOf(result);\n            }\n        }\n        // tslint:disable-next-line:max-line-length\n        var paragraphWidget = this.owner.selection.getNextParagraphBlock(inlineElement.line.paragraph);\n        return paragraphWidget;\n    };\n    TextSearch.prototype.getTextPosition = function (lineWidget, hierarchicalIndex) {\n        var textPosition = new TextPosition(this.owner);\n        var index = textPosition.getHierarchicalIndex(lineWidget, hierarchicalIndex);\n        textPosition.setPositionForCurrentIndex(index);\n        return textPosition;\n    };\n    return TextSearch;\n}());\nexport { TextSearch };\n/**\n * @private\n */\nvar SearchWidgetInfo = /** @class */ (function () {\n    function SearchWidgetInfo(left, width) {\n        this.leftInternal = 0;\n        this.widthInternal = 0;\n        this.leftInternal = left;\n        this.widthInternal = width;\n    }\n    Object.defineProperty(SearchWidgetInfo.prototype, \"left\", {\n        get: function () {\n            return this.leftInternal;\n        },\n        set: function (value) {\n            this.leftInternal = value;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(SearchWidgetInfo.prototype, \"width\", {\n        get: function () {\n            return this.widthInternal;\n        },\n        set: function (value) {\n            this.widthInternal = value;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    return SearchWidgetInfo;\n}());\nexport { SearchWidgetInfo };\n","/**\n * @private\n */\nvar TextSearchResult = /** @class */ (function () {\n    function TextSearchResult(owner) {\n        this.startIn = undefined;\n        this.endIn = undefined;\n        this.owner = owner;\n    }\n    Object.defineProperty(TextSearchResult.prototype, \"viewer\", {\n        get: function () {\n            return this.owner.viewer;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(TextSearchResult.prototype, \"start\", {\n        get: function () {\n            return this.startIn;\n        },\n        set: function (value) {\n            this.startIn = value;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(TextSearchResult.prototype, \"end\", {\n        get: function () {\n            return this.endIn;\n        },\n        set: function (value) {\n            this.endIn = value;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(TextSearchResult.prototype, \"text\", {\n        get: function () {\n            return this.viewer.selection.getTextInternal(this.start, this.end, false);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    TextSearchResult.prototype.destroy = function () {\n        this.start = undefined;\n        this.end = undefined;\n    };\n    return TextSearchResult;\n}());\nexport { TextSearchResult };\n","import { isNullOrUndefined } from '@syncfusion/ej2-base';\nimport { TextSearchResult } from './text-search-result';\n/**\n * @private\n */\nvar TextSearchResults = /** @class */ (function () {\n    function TextSearchResults(owner) {\n        this.currentIndex = -1;\n        this.owner = owner;\n    }\n    Object.defineProperty(TextSearchResults.prototype, \"length\", {\n        get: function () {\n            if (this.innerList === undefined) {\n                return 0;\n            }\n            return this.innerList.length;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(TextSearchResults.prototype, \"currentSearchResult\", {\n        get: function () {\n            if (this.innerList === undefined || this.currentIndex < 0 || this.currentIndex >= this.length) {\n                return undefined;\n            }\n            return this.innerList[this.currentIndex];\n        },\n        enumerable: true,\n        configurable: true\n    });\n    TextSearchResults.prototype.addResult = function () {\n        var textSearchResult = new TextSearchResult(this.owner);\n        if (isNullOrUndefined(this.innerList)) {\n            this.innerList = [];\n        }\n        this.innerList.push(textSearchResult);\n        return textSearchResult;\n    };\n    TextSearchResults.prototype.clearResults = function () {\n        this.currentIndex = -1;\n        if (!isNullOrUndefined(this.innerList)) {\n            for (var i = this.innerList.length - 1; i >= 0; i--) {\n                this.innerList[i].destroy();\n                this.innerList.splice(i, 1);\n            }\n        }\n    };\n    TextSearchResults.prototype.indexOf = function (result) {\n        if (isNullOrUndefined(this.innerList)) {\n            return -1;\n        }\n        return this.innerList.indexOf(result);\n    };\n    TextSearchResults.prototype.destroy = function () {\n        if (!isNullOrUndefined(this.innerList)) {\n            this.clearResults();\n        }\n        this.innerList = undefined;\n    };\n    return TextSearchResults;\n}());\nexport { TextSearchResults };\n","/**\n * Search Result info\n */\nvar SearchResults = /** @class */ (function () {\n    /**\n     * @private\n     */\n    function SearchResults(search) {\n        this.searchModule = search;\n    }\n    Object.defineProperty(SearchResults.prototype, \"length\", {\n        /**\n         * Gets the length of search results.\n         */\n        get: function () {\n            return this.searchModule.textSearchResults.length;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(SearchResults.prototype, \"index\", {\n        /**\n         * Gets the index of current search result.\n         */\n        get: function () {\n            return this.searchModule.textSearchResults.currentIndex;\n        },\n        /**\n         * Set the index of current search result.\n         */\n        set: function (value) {\n            if (this.length === 0 || value < 0 || value > this.searchModule.textSearchResults.length - 1) {\n                return;\n            }\n            this.searchModule.textSearchResults.currentIndex = value;\n            this.navigate(value);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    /**\n     * Replace text in current search result.\n     * @param textToReplace text to replace\n     * @private\n     */\n    SearchResults.prototype.replace = function (textToReplace) {\n        if (this.index === -1) {\n            return;\n        }\n        this.searchModule.replaceInternal(textToReplace);\n    };\n    /**\n     * Replace all the instance of search result.\n     * @param textToReplace text to replace\n     */\n    SearchResults.prototype.replaceAll = function (textToReplace) {\n        if (this.index === -1) {\n            return;\n        }\n        this.searchModule.replaceAllInternal(textToReplace);\n    };\n    /**\n     * @private\n     */\n    SearchResults.prototype.navigate = function (index) {\n        this.searchModule.navigate(this.searchModule.textSearchResults.currentSearchResult);\n        this.searchModule.highlight(this.searchModule.textSearchResults);\n    };\n    /**\n     * Clears all the instance of search result.\n     */\n    SearchResults.prototype.clear = function () {\n        this.searchModule.textSearchResults.clearResults();\n        this.searchModule.clearSearchHighlight();\n        this.searchModule.viewer.renderVisiblePages();\n    };\n    return SearchResults;\n}());\nexport { SearchResults };\n","import { Dictionary } from '../../base/dictionary';\nimport { isNullOrUndefined } from '@syncfusion/ej2-base';\nimport { TextPosition } from '../selection/selection-helper';\nimport { TextElementBox, FieldElementBox } from '../viewer/page';\nimport { SearchWidgetInfo } from './text-search';\nimport { TextSearch } from '../search/text-search';\nimport { TextSearchResults } from '../search/text-search-results';\nimport { SearchResults } from './search-results';\n/**\n * Search module\n */\nvar Search = /** @class */ (function () {\n    /**\n     * @private\n     */\n    function Search(owner) {\n        /**\n         * @private\n         */\n        this.searchHighlighters = undefined;\n        this.isHandledOddPageHeader = undefined;\n        this.isHandledEvenPageHeader = undefined;\n        this.isHandledOddPageFooter = undefined;\n        this.isHandledEvenPageFooter = undefined;\n        this.owner = owner;\n        this.searchHighlighters = new Dictionary();\n        this.textSearch = new TextSearch(this.owner);\n        this.textSearchResults = new TextSearchResults(this.owner);\n        this.searchResultsInternal = new SearchResults(this);\n    }\n    Object.defineProperty(Search.prototype, \"viewer\", {\n        /**\n         * @private\n         */\n        get: function () {\n            return this.owner.viewer;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(Search.prototype, \"searchResults\", {\n        /**\n         * Gets the search results object.\n         */\n        get: function () {\n            return this.searchResultsInternal;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    /**\n     * Get the module name.\n     */\n    Search.prototype.getModuleName = function () {\n        return 'Search';\n    };\n    //#region Find & Find All\n    /**\n     * Finds the immediate occurrence of specified text from cursor position in the document.\n     * @param  {string} text\n     * @param  {FindOption} findOption? - Default value of ‘findOptions’ parameter is 'None'.\n     * @private\n     */\n    Search.prototype.find = function (text, findOptions) {\n        if (isNullOrUndefined(findOptions)) {\n            findOptions = 'None';\n        }\n        var result = this.textSearch.find(text, findOptions);\n        if (!isNullOrUndefined(result)) {\n            this.navigate(result);\n        }\n    };\n    /**\n     * Finds all occurrence of specified text in the document.\n     * @param  {string} text\n     * @param  {FindOption} findOption? - Default value of ‘findOptions’ parameter is 'None'.\n     */\n    Search.prototype.findAll = function (text, findOptions) {\n        if (isNullOrUndefined(text || text === '')) {\n            return;\n        }\n        if (isNullOrUndefined(findOptions)) {\n            findOptions = 'None';\n        }\n        var results = this.textSearch.findAll(text, findOptions);\n        if (!isNullOrUndefined(results) && results.length > 0) {\n            this.navigate(results.innerList[results.currentIndex]);\n            this.highlight(results);\n        }\n    };\n    //#endregion\n    //#region Replace and Replace All   \n    /**\n     * Replace the searched string with specified string\n     * @param  {string} replaceText\n     * @param  {TextSearchResult} result\n     * @param  {TextSearchResults} results\n     * @private\n     */\n    Search.prototype.replace = function (replaceText, result, results) {\n        if (isNullOrUndefined(this.viewer.owner) || this.viewer.owner.isReadOnlyMode || isNullOrUndefined(results)) {\n            return 0;\n        }\n        if (!isNullOrUndefined(this.viewer)) {\n            this.clearSearchHighlight();\n        }\n        this.navigate(result);\n        var endPosition = this.viewer.selection.start;\n        var index = results.indexOf(result);\n        if (index < 0) {\n            return 0;\n        }\n        this.owner.editorModule.insertText(replaceText, true);\n        var endTextPosition = result.end;\n        var startPosition = new TextPosition(this.viewer.owner);\n        startPosition.setPositionParagraph(endTextPosition.currentWidget, endPosition.offset - replaceText.length);\n        this.viewer.selection.selectRange(endPosition, startPosition);\n        var eventArgs = { source: this.viewer.owner };\n        this.viewer.owner.trigger('searchResultsChange', eventArgs);\n        return 1;\n    };\n    /**\n     * Find the textToFind string in current document and replace the specified string.\n     * @param  {string} textToFind\n     * @param  {string} textToReplace\n     * @param  {FindOption} findOptions? - Default value of ‘findOptions’ parameter is FindOption.None.\n     * @private\n     */\n    Search.prototype.replaceInternal = function (textToReplace, findOptions) {\n        if ((textToReplace === '' || isNullOrUndefined(textToReplace))) {\n            return;\n        }\n        if (isNullOrUndefined(findOptions)) {\n            findOptions = 'None';\n        }\n        var textToFind = this.textSearchResults.currentSearchResult.text;\n        var pattern = this.viewer.owner.searchModule.textSearch.stringToRegex(textToFind, findOptions);\n        var index = this.owner.selection.end.getHierarchicalIndexInternal();\n        var result = this.viewer.owner.searchModule.textSearch.findNext(pattern, findOptions, index);\n        if (!isNullOrUndefined(result)) {\n            this.navigate(result);\n            this.textSearchResults.addResult();\n            this.textSearchResults.innerList[0] = result;\n            this.replace(textToReplace, result, this.textSearchResults);\n            index = this.owner.selection.end.getHierarchicalIndexInternal();\n            result = this.textSearch.findNext(textToFind, findOptions, index);\n            if (result) {\n                this.textSearchResults.addResult();\n                this.textSearchResults.innerList[0] = result;\n                this.navigate(result);\n            }\n        }\n    };\n    /**\n     * Replace all the searched string with specified string\n     * @param  {string} replaceText\n     * @param  {TextSearchResults} results\n     * @private\n     */\n    Search.prototype.replaceAll = function (replaceText, results) {\n        if (isNullOrUndefined(this.viewer.owner) || this.viewer.owner.isReadOnlyMode || isNullOrUndefined(results)) {\n            return 0;\n        }\n        if (this.owner.editorHistory) {\n            this.owner.editorHistory.initComplexHistory(this.owner.selection, 'ReplaceAll');\n        }\n        var count = results.length;\n        this.viewer.owner.isLayoutEnabled = false;\n        for (var i = count - 1; i >= 0; i--) {\n            this.navigate(results.innerList[i]);\n            this.owner.editorModule.insertText(replaceText, true);\n            results.innerList[i].destroy();\n        }\n        if (this.owner.editorHistory && !isNullOrUndefined(this.owner.editorHistory.currentHistoryInfo)) {\n            this.owner.editorHistory.updateComplexHistory();\n        }\n        else {\n            this.owner.editorModule.updateComplexWithoutHistory(2);\n        }\n        this.searchResults.clear();\n        return count;\n    };\n    /**\n     * Find the textToFind string in current document and replace the specified string.\n     * @param  {string} textToFind\n     * @param  {string} textToReplace\n     * @param  {FindOption} findOptions? - Default value of ‘findOptions’ parameter is FindOption.None.\n     * @private\n     */\n    Search.prototype.replaceAllInternal = function (textToReplace, findOptions) {\n        if ((textToReplace === '' || isNullOrUndefined(textToReplace))) {\n            return;\n        }\n        if (isNullOrUndefined(findOptions)) {\n            findOptions = 'None';\n        }\n        if (this.textSearchResults.length > 0) {\n            this.navigate(this.textSearchResults.innerList[this.textSearchResults.currentIndex]);\n            this.highlight(this.textSearchResults);\n            this.replaceAll(textToReplace, this.textSearchResults);\n        }\n    };\n    //#endregion\n    //#region Highlight Search Result\n    /**\n     * @private\n     */\n    Search.prototype.navigate = function (textSearchResult) {\n        if (textSearchResult) {\n            var start = textSearchResult.start;\n            var end = textSearchResult.end;\n            if (!isNullOrUndefined(this.owner) && !isNullOrUndefined(this.owner.selection) && !isNullOrUndefined(start) &&\n                !isNullOrUndefined(end) && !isNullOrUndefined(start.paragraph) && !isNullOrUndefined(end.paragraph)) {\n                this.owner.selection.selectRange(start, end);\n            }\n        }\n    };\n    /**\n     * @private\n     */\n    Search.prototype.highlight = function (textSearchResults) {\n        this.searchHighlighters = new Dictionary();\n        for (var i = 0; i < textSearchResults.innerList.length; i++) {\n            var result = textSearchResults.innerList[i];\n            this.highlightResult(result);\n        }\n        this.viewer.renderVisiblePages();\n    };\n    /**\n     * @private\n     */\n    Search.prototype.highlightResult = function (result) {\n        this.highlightSearchResult(result.start.paragraph, result.start, result.end);\n    };\n    /**\n     * Highlight search result\n     * @private\n     */\n    Search.prototype.highlightSearchResult = function (paragraph, start, end) {\n        var selectionStartIndex = 0;\n        var selectionEndIndex = 0;\n        var startElement = null;\n        var endElement = null;\n        // tslint:disable-next-line:max-line-length\n        var lineWidget = this.viewer.selection.getStartLineWidget(paragraph, start, startElement, selectionStartIndex);\n        selectionStartIndex = lineWidget.index;\n        startElement = lineWidget.element;\n        var startLineWidget = startElement ? startElement.line : paragraph.childWidgets[0];\n        var endLine = this.viewer.selection.getEndLineWidget(end, endElement, selectionEndIndex);\n        selectionEndIndex = endLine.index;\n        endElement = endLine.element;\n        var endLineWidget = endElement ? endElement.line :\n            end.paragraph.childWidgets[end.paragraph.childWidgets.length - 1];\n        var top = this.viewer.selection.getTop(startLineWidget);\n        var left = this.viewer.selection.getLeftInternal(startLineWidget, startElement, selectionStartIndex);\n        if (!isNullOrUndefined(startLineWidget) && startLineWidget === endLineWidget) {\n            //find result ends in current line.\n            var right = this.viewer.selection.getLeftInternal(endLineWidget, endElement, selectionEndIndex);\n            this.createHighlightBorder(startLineWidget, right - left, left, top);\n        }\n        else {\n            if (!isNullOrUndefined(startLineWidget)) {\n                if (paragraph !== startLineWidget.paragraph) {\n                    paragraph = startLineWidget.paragraph;\n                }\n                // tslint:disable-next-line:max-line-length\n                this.createHighlightBorder(startLineWidget, this.viewer.selection.getWidth(startLineWidget, true) - (left - startLineWidget.paragraph.x), left, top);\n                var lineIndex = startLineWidget.paragraph.childWidgets.indexOf(startLineWidget);\n                //Iterates to last item of paragraph or search result end.\n                var startParagraphWidget = void 0;\n                for (var i = 0; i < paragraph.childWidgets.length; i++) {\n                    if (paragraph === startLineWidget.paragraph) {\n                        lineIndex += 1;\n                    }\n                    this.highlightSearchResultParaWidget(paragraph, lineIndex, endLineWidget, endElement, selectionEndIndex);\n                    if (paragraph === endLineWidget.paragraph) {\n                        return;\n                    }\n                    else {\n                        lineIndex = 0;\n                    }\n                }\n            }\n        }\n    };\n    /**\n     * @private\n     */\n    Search.prototype.createHighlightBorder = function (lineWidget, width, left, top) {\n        var findHighLight = this.addSearchHighlightBorder(lineWidget);\n        var page = this.viewer.owner.selection.getPage(lineWidget.paragraph);\n        var pageTop = page.boundingRectangle.y;\n        var pageLeft = page.boundingRectangle.x;\n        findHighLight.left = Math.ceil(left);\n        top = Math.ceil(top);\n        findHighLight.width = Math.floor(width);\n        var height = Math.floor(lineWidget.height);\n        var context = this.viewer.containerContext;\n    };\n    /**\n     * Adds search highlight border.\n     * @private\n     */\n    Search.prototype.addSearchHighlightBorder = function (lineWidget) {\n        var highlighters = undefined;\n        if (this.searchHighlighters.containsKey(lineWidget)) {\n            highlighters = this.searchHighlighters.get(lineWidget);\n        }\n        else {\n            highlighters = [];\n            this.searchHighlighters.add(lineWidget, highlighters);\n        }\n        var searchHighlight = new SearchWidgetInfo(0, 0);\n        highlighters.push(searchHighlight);\n        return searchHighlight;\n    };\n    /**\n     * @private\n     */\n    // tslint:disable-next-line:max-line-length\n    Search.prototype.highlightSearchResultParaWidget = function (widget, startIndex, endLine, endElement, endIndex) {\n        var top = 0;\n        for (var j = startIndex; j < widget.childWidgets.length; j++) {\n            var lineWidget = widget.childWidgets[j];\n            if (j === startIndex) {\n                top = this.viewer.selection.getTop(lineWidget);\n            }\n            var left = this.viewer.selection.getLeft(lineWidget);\n            if (lineWidget === endLine) {\n                //Search result ends in current line.\n                var right = this.viewer.selection.getLeftInternal(endLine, endElement, endIndex);\n                this.createHighlightBorder(lineWidget, right - left, left, top);\n                return;\n            }\n            this.createHighlightBorder(lineWidget, this.viewer.selection.getWidth(lineWidget, true) - (left - widget.x), left, top);\n            top += lineWidget.height;\n        }\n    };\n    //#endregion\n    //#region Get find result view\n    /**\n     * @private\n     */\n    Search.prototype.addSearchResultItems = function (result) {\n        if (isNullOrUndefined(result) || result === '') {\n            return;\n        }\n        if (isNullOrUndefined(this.owner.findResultsList)) {\n            this.owner.findResultsList = [];\n        }\n        this.owner.findResultsList.push(result);\n    };\n    /**\n     * @private\n     */\n    Search.prototype.addFindResultView = function (textSearchResults) {\n        for (var i = 0; i < textSearchResults.innerList.length; i++) {\n            var result = textSearchResults.innerList[i];\n            this.addFindResultViewForSearch(result);\n        }\n        this.isHandledOddPageHeader = true;\n        this.isHandledOddPageFooter = true;\n        this.isHandledEvenPageHeader = true;\n        this.isHandledEvenPageFooter = true;\n    };\n    /**\n     * @private\n     */\n    // tslint:disable:max-func-body-length\n    Search.prototype.addFindResultViewForSearch = function (result) {\n        if (result.start != null && result.end != null && result.start.paragraph != null && result.end.paragraph != null) {\n            var prefixText = void 0;\n            var suffixtext = void 0;\n            var currentText = void 0;\n            var startIndex = 0;\n            var inlineObj = result.start.currentWidget.getInline(result.start.offset, startIndex);\n            var inline = inlineObj.element;\n            startIndex = inlineObj.index;\n            var prefix = '';\n            var lastIndex = 0;\n            if (inline instanceof FieldElementBox) {\n                var elementInfo = this.owner.selection.getRenderedInline(inline, startIndex);\n                if (elementInfo.element.nextNode instanceof TextElementBox) {\n                    inline = elementInfo.element.nextNode;\n                    startIndex = elementInfo.index;\n                }\n                else {\n                    inline = elementInfo.element;\n                    startIndex = elementInfo.index;\n                }\n            }\n            var boxObj = this.owner.selection.getElementBoxInternal(inline, startIndex);\n            var box = boxObj.element;\n            startIndex = boxObj.index;\n            if (box != null) {\n                if (box instanceof TextElementBox && startIndex > 0) {\n                    prefix = box.text.substring(0, startIndex);\n                }\n                var boxIndex = box.line.children.indexOf(box);\n                // tslint:disable-next-line:max-line-length\n                lastIndex = prefix.lastIndexOf(' ');\n                while (lastIndex < 0 && boxIndex > 0 && box.line.children[boxIndex - 1] instanceof TextElementBox) {\n                    prefix = box.line.children[boxIndex - 1].text + prefix;\n                    boxIndex--;\n                    lastIndex = prefix.lastIndexOf(' ');\n                }\n            }\n            var shiftIndex = prefix.lastIndexOf('\\v');\n            if (shiftIndex > 0) {\n                prefix = prefix.substring(0, shiftIndex);\n            }\n            else {\n                lastIndex = prefix.lastIndexOf(' ');\n                prefixText = lastIndex < 0 ? prefix : prefix.substring(lastIndex + 1);\n            }\n            currentText = result.text;\n            var endIndex = 0;\n            var endInlineObj = result.end.currentWidget.getInline(result.end.offset, endIndex);\n            var endInline = endInlineObj.element;\n            endIndex = endInlineObj.index;\n            suffixtext = '';\n            //Checks prefix element box is empty\n            if (boxObj != null) {\n                // Gets the element box using endIndex of the text and set as suffix\n                boxObj = this.owner.selection.getElementBoxInternal(endInline, endIndex);\n                box = boxObj.element;\n                endIndex = boxObj.index;\n            }\n            //Checks suffix element box is empty.\n            if (box != null) {\n                if (box instanceof TextElementBox && endIndex < box.length) {\n                    suffixtext = box.text.substring(endIndex);\n                }\n                var boxIndex = box.line.children.indexOf(box);\n                // tslint:disable-next-line:max-line-length\n                while (boxIndex + 1 < box.line.children.length && (box.line.children[boxIndex + 1] instanceof TextElementBox) || (box.line.children[boxIndex + 1] instanceof FieldElementBox)) {\n                    if (box.line.children[boxIndex + 1] instanceof FieldElementBox) {\n                        boxIndex = boxIndex + 2;\n                    }\n                    else {\n                        suffixtext = suffixtext + box.line.children[boxIndex + 1].text;\n                        boxIndex = boxIndex + 1;\n                    }\n                }\n            }\n            lastIndex = suffixtext.lastIndexOf(' ');\n            suffixtext = suffixtext === '\\v' ? suffixtext = '' : suffixtext;\n            var headerFooterString = '';\n            if (result.isHeader) {\n                headerFooterString = '<span class=\"e-de-header-footer-list\">' + 'Header' + ': ' + '</span>';\n            }\n            else if (result.isFooter) {\n                headerFooterString = '<span class=\"e-de-header-footer-list\">' + 'Footer' + ': ' + '</span>';\n            }\n            else {\n                headerFooterString = '';\n                headerFooterString = '';\n                this.isHandledOddPageHeader = true;\n                this.isHandledEvenPageHeader = true;\n                this.isHandledOddPageFooter = true;\n                this.isHandledEvenPageFooter = true;\n            }\n            var listElement = '';\n            var page = result.viewer.selection.getPage(result.start.paragraph);\n            if (isNullOrUndefined(this.isHandledEvenPageHeader) && isNullOrUndefined(this.isHandledEvenPageFooter)) {\n                this.isHandledEvenPageHeader = true;\n                this.isHandledEvenPageFooter = true;\n            }\n            else if (isNullOrUndefined(this.isHandledOddPageHeader) && isNullOrUndefined(this.isHandledOddPageFooter)) {\n                this.isHandledOddPageHeader = true;\n                this.isHandledOddPageFooter = true;\n            }\n            if (result.isHeader) {\n                if (page.headerWidget.headerFooterType === 'FirstPageHeader' && page.bodyWidgets[0].sectionFormat.differentFirstPage) {\n                    // tslint:disable-next-line:max-line-length\n                    listElement = '<li tabindex=0 class=\"e-de-search-result-item e-de-op-search-txt\">' + headerFooterString + prefix + '<span class=\"e-de-op-search-word\" style=\"pointer-events:none\">' + result.text + '</span>' + suffixtext + '</li>';\n                }\n                else if (page.headerWidget.headerFooterType === 'EvenHeader' && this.isHandledEvenPageHeader) {\n                    // tslint:disable-next-line:max-line-length\n                    listElement = '<li tabindex=0 class=\"e-de-search-result-item e-de-op-search-txt\">' + headerFooterString + prefix + '<span class=\"e-de-op-search-word\" style=\"pointer-events:none\">' + result.text + '</span>' + suffixtext + '</li>';\n                    this.isHandledEvenPageHeader = false;\n                    // tslint:disable-next-line:max-line-length\n                }\n                else if (page.headerWidget.headerFooterType === 'OddHeader' && this.isHandledOddPageHeader) {\n                    listElement = '<li tabindex=0 class=\"e-de-search-result-item e-de-op-search-txt\">' + headerFooterString + prefix + '<span class=\"e-de-op-search-word\" style=\"pointer-events:none\">' + result.text + '</span>' + suffixtext + '</li>';\n                    this.isHandledOddPageHeader = false;\n                }\n            }\n            else if (result.isFooter) {\n                if (page.footerWidget.headerFooterType === 'FirstPageFooter' && page.bodyWidgets[0].sectionFormat.differentFirstPage) {\n                    // tslint:disable-next-line:max-line-length\n                    listElement = '<li tabindex=0 class=\"e-de-search-result-item e-de-op-search-txt\">' + headerFooterString + prefix + '<span class=\"e-de-op-search-word\" style=\"pointer-events:none\">' + result.text + '</span>' + suffixtext + '</li>';\n                }\n                else if (page.footerWidget.headerFooterType === 'EvenFooter' && this.isHandledEvenPageFooter) {\n                    // tslint:disable-next-line:max-line-length\n                    listElement = '<li tabindex=0 class=\"e-de-search-result-item e-de-op-search-txt\">' + headerFooterString + prefix + '<span class=\"e-de-op-search-word\" style=\"pointer-events:none\">' + result.text + '</span>' + suffixtext + '</li>';\n                    this.isHandledEvenPageFooter = false;\n                    // tslint:disable-next-line:max-line-length\n                }\n                else if (page.footerWidget.headerFooterType === 'OddFooter' && this.isHandledOddPageFooter) {\n                    listElement = '<li tabindex=0 class=\"e-de-search-result-item e-de-op-search-txt\">' + headerFooterString + prefix + '<span class=\"e-de-op-search-word\" style=\"pointer-events:none\">' + result.text + '</span>' + suffixtext + '</li>';\n                    this.isHandledOddPageFooter = false;\n                }\n                // tslint:disable-next-line:max-line-length\n            }\n            else if (!result.isHeader && !result.isFooter) {\n                listElement = '<li tabindex=0 class=\"e-de-search-result-item e-de-op-search-txt\">' + headerFooterString + prefix + '<span class=\"e-de-op-search-word\" style=\"pointer-events:none\">' + result.text + '</span>' + suffixtext + '</li>';\n            }\n            this.addSearchResultItems(listElement);\n        }\n    };\n    //#endregion\n    /**\n     * Clears search highlight.\n     * @private\n     */\n    Search.prototype.clearSearchHighlight = function () {\n        if (!isNullOrUndefined(this.searchHighlighters)) {\n            this.searchHighlighters.clear();\n            this.searchHighlighters = undefined;\n        }\n        var eventArgs = { source: this.viewer.owner };\n        this.viewer.owner.trigger('searchResultsChange', eventArgs);\n    };\n    /**\n     * @private\n     */\n    Search.prototype.destroy = function () {\n        if (this.textSearchResults) {\n            this.textSearchResults.destroy();\n        }\n    };\n    return Search;\n}());\nexport { Search };\n","import { createElement, isNullOrUndefined, L10n, setCulture } from '@syncfusion/ej2-base';\nimport { HelperMethods } from '../editor/editor-helper';\nimport { CheckBox } from '@syncfusion/ej2-buttons';\nimport { Tab } from '@syncfusion/ej2-navigations';\n/**\n * Options Pane class.\n */\nvar OptionsPane = /** @class */ (function () {\n    /**\n     * Constructor for Options pane module\n     * @param {LayoutViewer} layoutViewer\n     * @private\n     */\n    function OptionsPane(layoutViewer) {\n        var _this = this;\n        /**\n         * @private\n         */\n        this.isOptionsPaneShow = false;\n        this.findOption = 'None';\n        this.matchCase = undefined;\n        this.wholeWord = undefined;\n        // private regular: CheckBox = undefined;\n        this.searchText = 'Navigation';\n        this.resultsText = 'Results';\n        this.messageDivText = 'No matches';\n        this.replaceButtonText = 'Replace';\n        this.replaceAllButtonText = 'Replace All';\n        this.focusedIndex = -1;\n        this.focusedElement = [];\n        this.isOptionsPane = true;\n        this.replacePaneText = 'Replace';\n        this.findPaneText = 'Find';\n        this.matchDivReplaceText = 'No matches';\n        /**\n         * @private\n         */\n        this.tabInstance = undefined;\n        /**\n         * @private\n         */\n        this.isReplace = false;\n        /**\n         * Gets selected tab item which tab is selected.\n         * @param {SelectEventArgs} args - Specifies which tab will be opened.\n         * @private\n         */\n        this.selectedTabItem = function (args) {\n            if (args.previousIndex !== args.selectedIndex) {\n                var previousTab = document.querySelector('#e-content_' + args.previousIndex);\n                var nextTab = document.querySelector('#e-content_' + args.selectedIndex);\n                nextTab.insertBefore(previousTab.firstElementChild, nextTab.firstChild);\n            }\n            if (args.selectedIndex === 0 && !isNullOrUndefined(document.querySelector('#e-content_' + args.selectedIndex))) {\n                _this.isOptionsPane = true;\n                _this.onFindPane();\n            }\n            if (args.selectedIndex === 1 && !isNullOrUndefined(document.querySelector('#e-content_' + args.selectedIndex))) {\n                _this.isOptionsPane = false;\n                _this.onReplacePane();\n            }\n        };\n        this.searchOptionChange = function () {\n            _this.clearSearchResultItems();\n            _this.viewer.owner.searchModule.clearSearchHighlight();\n            var inputText = _this.searchInput.value;\n            if (inputText === '') {\n                return;\n            }\n            var pattern = _this.viewer.owner.searchModule.textSearch.stringToRegex(inputText, _this.findOption);\n            var endSelection = _this.viewer.selection.end;\n            var selectionIndex = endSelection.getHierarchicalIndexInternal();\n            _this.results = _this.viewer.owner.searchModule.textSearch.findAll(pattern, _this.findOption, selectionIndex);\n            if (_this.results != null && _this.results.length > 0) {\n                _this.navigateSearchResult();\n            }\n            else {\n                _this.viewer.renderVisiblePages();\n                _this.messageDiv.innerHTML = _this.localeValue.getConstant('No matches');\n                _this.resultContainer.style.display = 'block';\n                _this.resultsListBlock.style.display = 'none';\n                _this.clearFocusElement();\n                _this.resultsListBlock.innerHTML = '';\n            }\n        };\n        /**\n         * Apply find option based on whole words value.\n         * @param {ChangeEventArgs} args - Specifies the search options value.\n         * @private\n         */\n        this.wholeWordsChange = function (args) {\n            if (_this.matchInput.checked && _this.wholeInput.checked) {\n                _this.findOption = 'CaseSensitiveWholeWord';\n            }\n            else if (_this.matchInput.checked && !(_this.wholeInput.checked)) {\n                _this.findOption = 'CaseSensitive';\n            }\n            else if (!(_this.matchInput.checked) && _this.wholeInput.checked) {\n                _this.findOption = 'WholeWord';\n            }\n            else {\n                _this.findOption = 'None';\n            }\n            _this.searchOptionChange();\n        };\n        /**\n         * Apply find option based on match value.\n         * @param {ChangeEventArgs} args - Specifies the search options value.\n         * @private\n         */\n        this.matchChange = function (args) {\n            if (_this.matchInput.checked && _this.wholeInput.checked) {\n                _this.findOption = 'CaseSensitiveWholeWord';\n            }\n            else if (!(_this.matchInput.checked) && _this.wholeInput.checked) {\n                _this.findOption = 'WholeWord';\n            }\n            else if (_this.matchInput.checked && !(_this.wholeInput.checked)) {\n                _this.findOption = 'CaseSensitive';\n            }\n            else {\n                _this.findOption = 'None';\n            }\n            _this.searchOptionChange();\n        };\n        /**\n         * Apply find options based on regular value.\n         * @param {ChangeEventArgs} args - Specifies the search options value.\n         * @private\n         */\n        // public regularChange = (args: ChangeEventArgs): void => {\n        //     if (args.checked) {\n        //         this.matchCase.element.parentElement.parentElement.classList.add('e-checkbox-disabled');\n        //         this.wholeWord.element.parentElement.parentElement.classList.add('e-checkbox-disabled');\n        //         this.matchCase.checked = false;\n        //         this.wholeWord.checked = false;\n        //         this.findOption = 'None';\n        //         this.onKeyDownInternal();\n        //     } else {\n        //         this.matchCase.element.parentElement.parentElement.classList.remove('e-checkbox-disabled');\n        //         this.wholeWord.element.parentElement.parentElement.classList.remove('e-checkbox-disabled');\n        //     }\n        // }\n        // tslint:enable:no-any \n        /**\n         * Binding events from the element when optins pane creation.\n         * @private\n         */\n        this.onWireEvents = function () {\n            _this.searchIcon.addEventListener('click', _this.searchIconClickInternal);\n            _this.navigateToNextResult.addEventListener('click', _this.navigateNextResultButtonClick);\n            _this.navigateToPreviousResult.addEventListener('click', _this.navigatePreviousResultButtonClick);\n            _this.searchInput.addEventListener('keydown', _this.onKeyDown);\n            _this.searchInput.addEventListener('keyup', _this.onEnableDisableReplaceButton);\n            _this.resultsListBlock.addEventListener('click', _this.resultListBlockClick);\n            _this.closeButton.addEventListener('click', _this.close);\n            _this.replaceButton.addEventListener('click', _this.onReplaceButtonClick);\n            _this.replaceAllButton.addEventListener('click', _this.onReplaceAllButtonClick);\n        };\n        /**\n         * Enable find pane only.\n         * @private\n         */\n        this.onFindPane = function () {\n            _this.replaceDiv.style.display = 'none';\n            _this.occurrenceDiv.style.display = 'none';\n            if (!isNullOrUndefined(_this.results) && _this.results.length === 0) {\n                _this.resultsListBlock.innerHTML = '';\n                _this.resultsListBlock.style.display = 'none';\n                _this.messageDiv.innerHTML = _this.localeValue.getConstant('No matches');\n            }\n            _this.resultsListBlock.style.height = _this.resultsListBlock.offsetHeight + _this.replaceTabContentDiv.offsetHeight + 'px';\n            _this.replaceTabContentDiv.style.display = 'none';\n            _this.findDiv.style.display = 'block';\n            _this.messageDiv.style.display = 'block';\n            _this.focusedElement = [];\n            // tslint:disable-next-line:max-line-length\n            _this.focusedElement.push(_this.closeButton, _this.findTabButtonHeader, _this.replaceTabButtonHeader, _this.searchInput, _this.searchIcon, _this.navigateToPreviousResult, _this.navigateToNextResult, _this.matchInput, _this.wholeInput);\n            _this.focusedIndex = 3;\n            _this.searchInput.select();\n            _this.getMessageDivHeight();\n        };\n        this.onEnableDisableReplaceButton = function () {\n            if (_this.searchInput.value.length !== 0) {\n                _this.replaceButton.disabled = false;\n                _this.replaceAllButton.disabled = false;\n            }\n            else {\n                _this.replaceButton.disabled = true;\n                _this.replaceAllButton.disabled = true;\n            }\n        };\n        /**\n         * Enable replace pane only.\n         * @private\n         */\n        this.onReplacePane = function () {\n            _this.findDiv.style.display = 'block';\n            _this.replaceDiv.style.display = 'block';\n            _this.replaceTabContentDiv.style.display = 'block';\n            _this.resultsListBlock.style.height = _this.resultsListBlock.offsetHeight - _this.replaceTabContentDiv.offsetHeight + 'px';\n            _this.isOptionsPane = false;\n            if (_this.searchInput.value.length !== 0) {\n                _this.replaceButton.disabled = false;\n                _this.replaceAllButton.disabled = false;\n            }\n            else {\n                _this.replaceButton.disabled = true;\n                _this.replaceAllButton.disabled = true;\n            }\n            _this.focusedElement = [];\n            // tslint:disable-next-line:max-line-length\n            _this.focusedElement.push(_this.closeButton, _this.findTabButtonHeader, _this.replaceTabButtonHeader, _this.searchInput, _this.searchIcon, _this.navigateToPreviousResult, _this.navigateToNextResult, _this.matchInput, _this.wholeInput, _this.replaceWith, _this.replaceButton, _this.replaceAllButton);\n            _this.focusedIndex = 9;\n            if (_this.searchInput.value === '') {\n                _this.searchInput.select();\n            }\n            else {\n                _this.replaceWith.select();\n            }\n            _this.getMessageDivHeight();\n        };\n        /**\n         * Fires on key down on options pane.\n         * @param {KeyboardEvent} event - Specifies the focus of current element.\n         * @private\n         */\n        this.onKeyDownOnOptionPane = function (event) {\n            // if (event.keyCode === 70) {\n            //     event.preventDefault();\n            //     return;\n            // }\n            if (event.keyCode === 9) {\n                event.preventDefault();\n                var focusIndex = undefined;\n                if (event.shiftKey) {\n                    focusIndex = (_this.focusedIndex === 0 || isNullOrUndefined(_this.focusedIndex)) ?\n                        _this.focusedElement.length - 1 : _this.focusedIndex - 1;\n                }\n                else {\n                    focusIndex = (_this.focusedElement.length - 1 === _this.focusedIndex || isNullOrUndefined(_this.focusedIndex)) ?\n                        0 : _this.focusedIndex + 1;\n                }\n                var element = _this.focusedElement[focusIndex];\n                element.focus();\n                if (element instanceof HTMLInputElement) {\n                    element.select();\n                }\n                _this.focusedIndex = focusIndex;\n                if (element instanceof HTMLLIElement) {\n                    _this.scrollToPosition(element);\n                }\n            }\n            else if (event.keyCode === 13) {\n                // tslint:disable-next-line:max-line-length\n                if (event.target !== _this.searchInput && event.target !== _this.closeButton) {\n                    event.preventDefault();\n                    var index = _this.focusedElement.indexOf(event.target);\n                    if (index !== -1) {\n                        var list = _this.focusedElement[index];\n                        list.click();\n                        list.focus();\n                        _this.focusedIndex = index;\n                    }\n                }\n            }\n            else if (event.keyCode === 40 || event.keyCode === 38) {\n                if (_this.resultsListBlock.style.display !== 'none') {\n                    var index = void 0;\n                    var element = void 0;\n                    if (event.keyCode === 40) {\n                        if (_this.focusedIndex > 7) {\n                            if (_this.focusedIndex + 1 < _this.focusedElement.length) {\n                                element = _this.focusedElement[_this.focusedIndex + 1];\n                                element.focus();\n                                _this.focusedIndex = _this.focusedIndex + 1;\n                            }\n                        }\n                        else {\n                            index = (_this.focusedElement.length - _this.resultsListBlock.children.length) + _this.results.currentIndex + 1;\n                            if (index < _this.focusedElement.length) {\n                                element = _this.focusedElement[index];\n                                element.focus();\n                                _this.focusedIndex = index;\n                            }\n                        }\n                    }\n                    else {\n                        if (_this.focusedIndex > 8) {\n                            index = _this.focusedIndex - 1;\n                            element = _this.focusedElement[index];\n                            element.focus();\n                            _this.focusedIndex = index;\n                        }\n                    }\n                }\n            }\n        };\n        /**\n         * Fires on replace.\n         * @private\n         */\n        this.onReplaceButtonClick = function () {\n            var optionsPane = _this.optionsPane;\n            var findText = _this.searchInput.value;\n            var replaceText = _this.replaceWith.value;\n            var results = _this.viewer.owner.searchModule.textSearchResults;\n            if (findText !== '' && !isNullOrUndefined(findText)) {\n                if (_this.viewer.owner.selection != null) {\n                    var selectionText = _this.viewer.owner.selection.text;\n                    if (!_this.viewer.owner.selection.isEmpty) {\n                        if (_this.viewer.owner.selection.isForward) {\n                            _this.viewer.owner.selection.selectContent(_this.viewer.owner.selection.start, true);\n                        }\n                        else {\n                            _this.viewer.owner.selection.selectContent(_this.viewer.owner.selection.end, true);\n                        }\n                    }\n                    if (!isNullOrUndefined(results) && !isNullOrUndefined(results.currentSearchResult)) {\n                        var result = results.currentSearchResult;\n                        _this.viewer.owner.searchModule.navigate(result);\n                        if (result.text === selectionText) {\n                            var replace = isNullOrUndefined(replaceText) ? '' : replaceText;\n                            _this.viewer.owner.searchModule.replace(replace, result, results);\n                            var pattern = _this.viewer.owner.searchModule.textSearch.stringToRegex(findText, _this.findOption);\n                            var endSelection = _this.viewer.selection.end;\n                            var index = endSelection.getHierarchicalIndexInternal();\n                            // tslint:disable-next-line:max-line-length\n                            _this.viewer.owner.searchModule.textSearchResults = _this.viewer.owner.searchModule.textSearch.findAll(pattern, _this.findOption, index);\n                            _this.results = _this.viewer.owner.searchModule.textSearchResults;\n                            if (!isNullOrUndefined(_this.results) && !isNullOrUndefined(_this.results.currentSearchResult)) {\n                                _this.viewer.owner.searchModule.navigate(_this.results.currentSearchResult);\n                            }\n                            else {\n                                _this.messageDiv.style.display = 'block';\n                                _this.messageDiv.innerHTML = _this.localeValue.getConstant(_this.matchDivReplaceText);\n                            }\n                            _this.viewer.owner.findResultsList = [];\n                            if (!isNullOrUndefined(_this.results) && _this.results.innerList.length > 0) {\n                                _this.navigateSearchResult();\n                            }\n                            else {\n                                _this.resultsListBlock.innerHTML = '';\n                            }\n                        }\n                    }\n                    else {\n                        _this.messageDiv.style.display = 'block';\n                        _this.messageDiv.innerHTML = _this.localeValue.getConstant(_this.matchDivReplaceText);\n                    }\n                }\n            }\n        };\n        /**\n         * Fires on replace all.\n         * @private\n         */\n        this.onReplaceAllButtonClick = function () {\n            _this.replaceAll();\n            _this.resultsListBlock.style.display = 'none';\n            _this.messageDiv.innerHTML = '';\n        };\n        /**\n         * Fires on search icon.\n         * @private\n         */\n        this.searchIconClickInternal = function () {\n            // tslint:disable:no-any \n            var inputElement = document.getElementById(_this.viewer.owner.containerId + '_option_search_text_box');\n            // tslint:enable:no-any\n            var text = inputElement.value;\n            if (text === '') {\n                return;\n            }\n            if (_this.searchIcon.classList.contains('e-de-op-search-close-icon')) {\n                _this.searchIcon.classList.add('e-de-op-search-icon');\n                _this.searchIcon.classList.remove('e-de-op-search-close-icon');\n                inputElement.value = '';\n                _this.messageDiv.innerHTML = _this.localeValue.getConstant('No matches');\n                _this.resultContainer.style.display = 'block';\n                _this.resultsListBlock.style.display = 'none';\n                _this.matchDiv.style.display = 'none';\n                _this.occurrenceDiv.style.display = 'none';\n                _this.onEnableDisableReplaceButton();\n                _this.clearFocusElement();\n                _this.resultsListBlock.innerHTML = '';\n                _this.clearSearchResultItems();\n                _this.viewer.owner.searchModule.clearSearchHighlight();\n                _this.viewer.renderVisiblePages();\n                return;\n            }\n            if (_this.searchIcon.classList.contains('e-de-op-search-icon') && text.length >= 1) {\n                _this.searchIcon.classList.add('e-de-op-search-close-icon');\n                _this.searchIcon.classList.remove('e-de-op-search-icon');\n                _this.onEnableDisableReplaceButton();\n            }\n            _this.clearSearchResultItems();\n            _this.viewer.owner.searchModule.clearSearchHighlight();\n            var patterns = _this.viewer.owner.searchModule.textSearch.stringToRegex(text, _this.findOption);\n            var endSelection = _this.viewer.selection.end;\n            var index = endSelection.getHierarchicalIndexInternal();\n            _this.results = _this.viewer.owner.searchModule.textSearch.findAll(patterns, _this.findOption, index);\n            if (_this.results != null && _this.results.length > 0) {\n                _this.navigateSearchResult();\n                _this.getMessageDivHeight();\n                var resultsContainerHeight = _this.viewer.owner.getDocumentEditorElement().offsetHeight - 215;\n                _this.resultsListBlock.style.height = resultsContainerHeight + 'px';\n            }\n            else {\n                _this.messageDiv.innerHTML = _this.localeValue.getConstant('No matches');\n                _this.resultContainer.style.display = 'block';\n                _this.resultsListBlock.style.display = 'none';\n                _this.clearFocusElement();\n                _this.resultsListBlock.innerHTML = '';\n            }\n        };\n        /**\n         * Fires on getting next results.\n         * @private\n         */\n        this.navigateNextResultButtonClick = function () {\n            if (document.getElementById(_this.viewer.owner.containerId + '_list_box_container') != null &&\n                document.getElementById(_this.viewer.owner.containerId + '_list_box_container').style.display !== 'none') {\n                if (_this.results.currentIndex < _this.results.length - 1) {\n                    _this.results.currentIndex = _this.results.currentIndex + 1;\n                    var currentelement = _this.results.innerList[_this.results.currentIndex];\n                    // tslint:disable-next-line:max-line-length\n                    _this.messageDiv.innerHTML = _this.localeValue.getConstant('Result') + ' ' + (_this.results.currentIndex + 1) + ' ' + _this.localeValue.getConstant('of') + ' ' + _this.resultsListBlock.children.length;\n                    for (var i = 0; i < _this.resultsListBlock.children.length; i++) {\n                        var list = _this.resultsListBlock.children[i];\n                        if (list.classList.contains('e-de-search-result-hglt')) {\n                            list.classList.remove('e-de-search-result-hglt');\n                            list.children[0].classList.remove('e-de-op-search-word-text');\n                            list.classList.add('e-de-search-result-item');\n                        }\n                    }\n                    var listElement = _this.resultsListBlock.children[_this.results.currentIndex];\n                    if (listElement.classList.contains('e-de-search-result-item')) {\n                        listElement.classList.remove('e-de-search-result-item');\n                        listElement.classList.add('e-de-search-result-hglt');\n                        listElement.children[0].classList.add('e-de-op-search-word-text');\n                        _this.scrollToPosition(listElement);\n                    }\n                    _this.viewer.owner.searchModule.navigate(currentelement);\n                    _this.viewer.owner.searchModule.highlight(_this.results);\n                }\n                else {\n                    var currentelement = _this.results.innerList[0];\n                    _this.results.currentIndex = 0;\n                    // tslint:disable-next-line:max-line-length\n                    _this.messageDiv.innerHTML = _this.localeValue.getConstant('Result') + ' ' + (_this.results.currentIndex + 1) + ' ' + _this.localeValue.getConstant('of') + ' ' + _this.resultsListBlock.children.length;\n                    for (var j = 0; j < _this.resultsListBlock.children.length; j++) {\n                        var lists = _this.resultsListBlock.children[j];\n                        if (lists.classList.contains('e-de-search-result-hglt')) {\n                            lists.classList.remove('e-de-search-result-hglt');\n                            lists.children[0].classList.remove('e-de-op-search-word-text');\n                            lists.classList.add('e-de-search-result-item');\n                        }\n                    }\n                    var listElementsDiv = _this.resultsListBlock.children[_this.results.currentIndex];\n                    if (listElementsDiv.classList.contains('e-de-search-result-item')) {\n                        listElementsDiv.classList.remove('e-de-search-result-item');\n                        listElementsDiv.classList.add('e-de-search-result-hglt');\n                        listElementsDiv.children[0].classList.add('e-de-op-search-word-text');\n                        _this.scrollToPosition(listElementsDiv);\n                    }\n                    _this.viewer.owner.searchModule.navigate(currentelement);\n                    _this.viewer.owner.searchModule.highlight(_this.results);\n                }\n                _this.focusedIndex = _this.focusedElement.indexOf(_this.navigateToNextResult);\n            }\n        };\n        /**\n         * Fires on getting previous results.\n         * @private\n         */\n        this.navigatePreviousResultButtonClick = function () {\n            if (document.getElementById(_this.viewer.owner.containerId + '_list_box_container') != null &&\n                document.getElementById(_this.viewer.owner.containerId + '_list_box_container').style.display !== 'none') {\n                if (_this.results.currentIndex === 0) {\n                    _this.results.currentIndex = _this.results.length - 1;\n                    // tslint:disable-next-line:max-line-length\n                    _this.messageDiv.innerHTML = _this.localeValue.getConstant('Result') + ' ' + (_this.results.length) + ' ' + _this.localeValue.getConstant('of') + ' ' + _this.resultsListBlock.children.length;\n                    for (var index = 0; index < _this.resultsListBlock.children.length; index++) {\n                        var list = _this.resultsListBlock.children[index];\n                        if (list.classList.contains('e-de-search-result-hglt')) {\n                            list.classList.remove('e-de-search-result-hglt');\n                            list.children[0].classList.remove('e-de-op-search-word-text');\n                            list.classList.add('e-de-search-result-item');\n                        }\n                    }\n                    var liElement = _this.resultsListBlock.children[_this.results.currentIndex];\n                    if (liElement.classList.contains('e-de-search-result-item')) {\n                        liElement.classList.remove('e-de-search-result-item');\n                        liElement.classList.add('e-de-search-result-hglt');\n                        liElement.children[0].classList.add('e-de-op-search-word-text');\n                        _this.scrollToPosition(liElement);\n                    }\n                    var currentelement = _this.results.innerList[_this.results.currentIndex];\n                    _this.viewer.owner.searchModule.navigate(currentelement);\n                    _this.viewer.owner.searchModule.highlight(_this.results);\n                }\n                else {\n                    // tslint:disable-next-line:max-line-length\n                    _this.messageDiv.innerHTML = _this.localeValue.getConstant('Result') + ' ' + (_this.results.currentIndex) + ' ' + _this.localeValue.getConstant('of') + ' ' + _this.resultsListBlock.children.length;\n                    _this.results.currentIndex = _this.results.currentIndex - 1;\n                    for (var j = 0; j < _this.resultsListBlock.children.length; j++) {\n                        var list = _this.resultsListBlock.children[j];\n                        if (list.classList.contains('e-de-search-result-hglt')) {\n                            list.classList.remove('e-de-search-result-hglt');\n                            list.children[0].classList.remove('e-de-op-search-word-text');\n                            list.classList.add('e-de-search-result-item');\n                        }\n                    }\n                    var listElements = _this.resultsListBlock.children[_this.results.currentIndex];\n                    if (listElements.classList.contains('e-de-search-result-item')) {\n                        listElements.classList.remove('e-de-search-result-item');\n                        listElements.classList.add('e-de-search-result-hglt');\n                        listElements.children[0].classList.add('e-de-op-search-word-text');\n                        _this.scrollToPosition(listElements);\n                    }\n                    var currentelement = _this.results.innerList[_this.results.currentIndex];\n                    _this.viewer.owner.searchModule.navigate(currentelement);\n                    _this.viewer.owner.searchModule.highlight(_this.results);\n                }\n                _this.focusedIndex = _this.focusedElement.indexOf(_this.navigateToPreviousResult);\n            }\n        };\n        /**\n         * Fires on key down\n         * @param {KeyboardEvent} event - Speficies key down actions.\n         * @private\n         */\n        this.onKeyDown = function (event) {\n            var code = event.which || event.keyCode;\n            if (code === 13 && event.keyCode !== 9 && event.keyCode !== 40) {\n                event.preventDefault();\n                _this.findDiv.style.height = '';\n                _this.onKeyDownInternal();\n            }\n            else if (code === 8 && (_this.searchInput.value.length === 0)) {\n                _this.resultContainer.style.display = 'block';\n            }\n            else if (event.keyCode !== 9 && event.keyCode !== 40 && event.keyCode !== 27) {\n                _this.viewer.owner.searchModule.clearSearchHighlight();\n                _this.clearSearchResultItems();\n                _this.viewer.renderVisiblePages();\n                _this.resultsListBlock.style.display = 'none';\n                _this.messageDiv.innerHTML = _this.localeValue.getConstant('No matches');\n                _this.resultContainer.style.display = 'none';\n                _this.clearFocusElement();\n                _this.resultsListBlock.innerHTML = '';\n                if (_this.searchIcon.classList.contains('e-de-op-search-close-icon')) {\n                    _this.searchIcon.classList.add('e-de-op-search-icon');\n                    _this.searchIcon.classList.remove('e-de-op-search-close-icon');\n                }\n            }\n            else if (code === 27 && event.keyCode === 27) {\n                _this.showHideOptionsPane(false);\n            }\n        };\n        /**\n         * Close the optios pane.\n         * @private\n         */\n        this.close = function () {\n            _this.clearFocusElement();\n            _this.showHideOptionsPane(false);\n            _this.resultsListBlock.innerHTML = '';\n            _this.focusedIndex = 1;\n            _this.isOptionsPane = true;\n        };\n        /**\n         * Fires on results list block.\n         * @param {MouseEvent} args - Specifies which list was clicked.\n         * @private\n         */\n        this.resultListBlockClick = function (args) {\n            var currentlist = args.target;\n            var element = _this.resultsListBlock.children;\n            var index = 0;\n            for (var i = 0; i < element.length; i++) {\n                var list_1 = element[i];\n                if (list_1.classList.contains('e-de-search-result-hglt')) {\n                    list_1.classList.remove('e-de-search-result-hglt');\n                    list_1.children[0].classList.remove('e-de-op-search-word-text');\n                    list_1.classList.add('e-de-search-result-item');\n                }\n            }\n            var list;\n            for (var i = 0; i < element.length; i++) {\n                if (currentlist === element[i]) {\n                    index = i;\n                    list = element[i];\n                    if (list.classList.contains('e-de-search-result-item')) {\n                        list.classList.remove('e-de-search-result-item');\n                        list.classList.add('e-de-search-result-hglt');\n                        list.children[0].classList.add('e-de-op-search-word-text');\n                        _this.focusedIndex = _this.focusedElement.indexOf(list);\n                    }\n                }\n            }\n            var currentelement = _this.results.innerList[index];\n            _this.results.currentIndex = index;\n            // tslint:disable-next-line:max-line-length\n            _this.messageDiv.innerHTML = _this.localeValue.getConstant('Result') + ' ' + (index + 1) + ' ' + _this.localeValue.getConstant('of') + ' ' + _this.resultsListBlock.children.length;\n            _this.viewer.owner.searchModule.navigate(currentelement);\n            _this.viewer.owner.searchModule.highlight(_this.results);\n            list.focus();\n        };\n        this.viewer = layoutViewer;\n    }\n    /**\n     * Get the module name.\n     */\n    OptionsPane.prototype.getModuleName = function () {\n        return 'OptionsPane';\n    };\n    /**\n     * Initialize the options pane.\n     * @param {L10n} localeValue - Specifies the localization based on culture.\n     * @private\n     */\n    // tslint:disable:max-func-body-length\n    OptionsPane.prototype.initOptionsPane = function (localeValue) {\n        var viewer = this.viewer;\n        this.localeValue = localeValue;\n        this.optionsPane = createElement('div', { className: 'e-de-op', styles: 'display:none;' });\n        this.optionsPane.addEventListener('keydown', this.onKeyDownOnOptionPane);\n        this.searchDiv = createElement('div', {\n            className: this.viewer.owner.containerId + '_searchDiv e-de-op-header',\n            innerHTML: localeValue.getConstant(this.searchText)\n        });\n        this.optionsPane.appendChild(this.searchDiv);\n        // tslint:disable-next-line:max-line-length\n        this.closeButton = createElement('button', { className: 'e-de-op-close-button e-de-op-icon-btn e-btn e-flat e-icon-btn', id: 'close' });\n        this.optionsPane.appendChild(this.closeButton);\n        var closeSpan = createElement('span', { className: 'e-de-op-close-icon e-btn-icon e-icons' });\n        this.closeButton.appendChild(closeSpan);\n        this.focusedElement.push(this.closeButton);\n        this.findTab = createElement('div', { id: this.viewer.owner.containerId + '_findTabDiv', className: 'e-de-op-tab' });\n        this.optionsPane.appendChild(this.findTab);\n        var tabHeader = createElement('div', { className: 'e-tab-header' });\n        this.findTab.appendChild(tabHeader);\n        this.findTabButton = createElement('div', { innerHTML: localeValue.getConstant(this.findPaneText) });\n        this.focusedElement.push(this.findTabButtonHeader);\n        tabHeader.appendChild(this.findTabButton);\n        this.replaceTabButton = createElement('div', { innerHTML: localeValue.getConstant(this.replacePaneText) });\n        this.focusedElement.push(this.replaceTabButtonHeader);\n        tabHeader.appendChild(this.replaceTabButton);\n        var tabContent = createElement('div', { className: 'e-content' });\n        var findTabContent = createElement('div', { id: 'findTabContent' });\n        tabContent.appendChild(findTabContent);\n        this.findTabContentDiv = createElement('div', { className: 'e-de-search-tab-content' });\n        this.searchTextBoxContainer = createElement('div', { className: 'e-input-group e-de-op-input-group' });\n        this.findTabContentDiv.appendChild(this.searchTextBoxContainer);\n        // tslint:disable-next-line:max-line-length\n        this.searchInput = createElement('input', { className: 'e-input e-de-search-input', id: this.viewer.owner.containerId + '_option_search_text_box', attrs: { placeholder: 'Search for' }, styles: 'font-size:14px;' });\n        this.searchTextBoxContainer.appendChild(this.searchInput);\n        this.searchIcon = createElement('span', {\n            className: 'e-de-op-icon e-de-op-search-icon e-input-group-icon e-icon',\n            id: this.viewer.owner.containerId + '_search-icon'\n        });\n        this.searchIcon.tabIndex = 0;\n        this.searchTextBoxContainer.appendChild(this.searchIcon);\n        this.focusedElement.push(this.searchIcon);\n        // tslint:disable-next-line:max-line-length\n        this.navigateToPreviousResult = createElement('span', { className: 'e-de-op-icon e-de-op-nav-btn e-arrow-up e-spin-up e-btn-icon e-icon e-input-group-icon' });\n        this.navigateToPreviousResult.tabIndex = 0;\n        this.searchTextBoxContainer.appendChild(this.navigateToPreviousResult);\n        this.focusedElement.push(this.navigateToPreviousResult);\n        // tslint:disable-next-line:max-line-length\n        this.navigateToNextResult = createElement('span', { className: 'e-de-op-icon e-de-op-nav-btn e-arrow-down e-spin-down e-btn-icon e-icon e-input-group-icon' });\n        this.navigateToNextResult.tabIndex = 0;\n        this.searchTextBoxContainer.appendChild(this.navigateToNextResult);\n        this.focusedElement.push(this.navigateToNextResult);\n        var div = createElement('div', { className: 'e-de-op-more-less' });\n        this.matchInput = createElement('input', {\n            attrs: { type: 'checkbox' },\n            id: this.viewer.owner.containerId + '_matchCase'\n        });\n        div.appendChild(this.matchInput);\n        this.matchCase = new CheckBox({ label: 'Match case', checked: false, change: this.matchChange });\n        this.matchCase.appendTo(this.matchInput);\n        this.focusedElement.push(this.matchInput);\n        this.matchInput.tabIndex = 0;\n        this.wholeInput = createElement('input', {\n            attrs: { type: 'checkbox' },\n            id: this.viewer.owner.containerId + '_wholeWord',\n        });\n        div.appendChild(this.wholeInput);\n        this.wholeWord = new CheckBox({ label: 'Whole words', checked: false, change: this.wholeWordsChange });\n        this.wholeWord.appendTo(this.wholeInput);\n        this.focusedElement.push(this.wholeInput);\n        this.wholeInput.tabIndex = 0;\n        this.findTabContentDiv.appendChild(div);\n        var replaceTabContent = createElement('div');\n        tabContent.appendChild(replaceTabContent);\n        this.replaceTabContentDiv = createElement('div', { className: 'e-de-op-replacetabcontentdiv', styles: 'display:none;' });\n        tabContent.appendChild(this.replaceTabContentDiv);\n        this.findTabContentDiv.appendChild(this.replaceTabContentDiv);\n        this.createReplacePane();\n        this.findDiv = createElement('div', { className: 'findDiv', styles: 'height:250px;display:block;' });\n        findTabContent.appendChild(this.findTabContentDiv);\n        this.resultContainer = createElement('div', { styles: 'width:85%;display:block;', className: 'e-de-op-result-container' });\n        this.findDiv.appendChild(this.resultContainer);\n        // tslint:disable-next-line:max-line-length\n        this.messageDiv = createElement('div', { className: this.viewer.owner.containerId + '_messageDiv e-de-op-msg', innerHTML: this.localeValue.getConstant(this.messageDivText), id: this.viewer.owner.containerId + '_search_status' });\n        this.resultContainer.appendChild(this.messageDiv);\n        // tslint:disable-next-line:max-line-length\n        this.resultsListBlock = createElement('div', { id: this.viewer.owner.containerId + '_list_box_container', styles: 'display:none;width:270px;list-style:none;padding-right:5px;overflow:auto;', className: 'e-de-result-list-block' });\n        this.findDiv.appendChild(this.resultsListBlock);\n        this.findTabContentDiv.appendChild(this.findDiv);\n        this.findTab.appendChild(tabContent);\n        this.tabInstance = new Tab({ selected: this.selectedTabItem });\n        this.tabInstance.appendTo(this.findTab);\n        var findHeader = this.tabInstance.element.getElementsByClassName('e-item e-toolbar-item')[0];\n        this.findTabButtonHeader = findHeader.getElementsByClassName('e-tab-wrap')[0];\n        this.findTabButtonHeader.classList.add('e-de-op-find-tab-header');\n        this.findTabButtonHeader.tabIndex = 0;\n        var replaceHeader = this.tabInstance.element.getElementsByClassName('e-item e-toolbar-item')[1];\n        this.replaceTabButtonHeader = replaceHeader.getElementsByClassName('e-tab-wrap')[0];\n        this.replaceTabButtonHeader.classList.add('e-de-op-replace-tab-header');\n        this.replaceTabButtonHeader.tabIndex = 0;\n        this.onWireEvents();\n    };\n    /**\n     * Create replace pane instances.\n     */\n    OptionsPane.prototype.createReplacePane = function () {\n        this.replaceDiv = createElement('div');\n        this.replaceTabContentDiv.appendChild(this.replaceDiv);\n        this.replaceWith = createElement('input', {\n            className: 'e-de-op-replacewith e-input', styles: 'font-size:14px;',\n            attrs: { placeholder: 'Replace with' }\n        });\n        this.replaceDiv.appendChild(this.replaceWith);\n        var replaceButtonDiv = createElement('div', { styles: 'text-align:right;', className: 'e-de-op-dlg-footer' });\n        this.replaceDiv.appendChild(replaceButtonDiv);\n        this.replaceButton = createElement('button', {\n            className: 'e-control e-btn e-flat e-replace',\n            styles: 'font-size:12px;margin-right:10px;',\n            innerHTML: this.localeValue.getConstant(this.replaceButtonText)\n        });\n        replaceButtonDiv.appendChild(this.replaceButton);\n        this.replaceAllButton = createElement('button', {\n            className: 'e-control e-btn e-flat e-replaceall',\n            styles: 'font-size:12px;',\n            innerHTML: this.localeValue.getConstant(this.replaceAllButtonText)\n        });\n        replaceButtonDiv.appendChild(this.replaceAllButton);\n        this.matchDiv = createElement('div', { styles: 'display:none;padding-top:10px;' });\n        this.replaceDiv.appendChild(this.matchDiv);\n        var emptyDiv6 = createElement('div', { className: 'e-de-op-search-replacediv' });\n        this.replaceDiv.appendChild(emptyDiv6);\n        this.occurrenceDiv = createElement('div', { styles: 'display:none;' });\n        this.replaceDiv.appendChild(this.occurrenceDiv);\n    };\n    OptionsPane.prototype.navigateSearchResult = function () {\n        this.viewer.owner.searchModule.navigate(this.results.innerList[this.results.currentIndex]);\n        this.viewer.owner.searchModule.highlight(this.results);\n        this.viewer.owner.searchModule.addFindResultView(this.results);\n        this.resultsListBlock.style.display = 'block';\n        this.resultContainer.style.display = 'block';\n        var lists = this.viewer.owner.findResultsList;\n        var text = '';\n        for (var i = 0; i < lists.length; i++) {\n            text += lists[i];\n        }\n        this.clearFocusElement();\n        this.resultsListBlock.innerHTML = text;\n        for (var i = 0; i < this.resultsListBlock.children.length; i++) {\n            this.focusedElement.push(this.resultsListBlock.children[i]);\n        }\n        var currentIndexValue = this.results.currentIndex;\n        // tslint:disable-next-line:max-line-length\n        this.messageDiv.innerHTML = this.localeValue.getConstant('Result') + ' ' + (currentIndexValue + 1) + ' ' + this.localeValue.getConstant('of') + ' ' + this.resultsListBlock.children.length;\n        var listElement = this.resultsListBlock.children[currentIndexValue];\n        if (listElement.classList.contains('e-de-search-result-item')) {\n            listElement.classList.remove('e-de-search-result-item');\n            listElement.classList.add('e-de-search-result-hglt');\n            listElement.children[0].classList.add('e-de-op-search-word-text');\n            this.scrollToPosition(listElement);\n        }\n    };\n    /**\n     * Fires on key down actions done.\n     * @private\n     */\n    OptionsPane.prototype.onKeyDownInternal = function () {\n        // tslint:disable-next-line:max-line-length\n        var inputElement = document.getElementById(this.viewer.owner.containerId + '_option_search_text_box');\n        inputElement.blur();\n        var text = inputElement.value;\n        if (text === '') {\n            return;\n        }\n        if (text.length >= 1 && this.searchIcon.classList.contains('e-de-op-search-icon')) {\n            this.searchIcon.classList.add('e-de-op-search-close-icon');\n            this.searchIcon.classList.remove('e-de-op-search-icon');\n        }\n        var resultsContainerHeight = this.viewer.owner.getDocumentEditorElement().offsetHeight - 215;\n        this.clearSearchResultItems();\n        this.viewer.owner.searchModule.clearSearchHighlight();\n        var pattern = this.viewer.owner.searchModule.textSearch.stringToRegex(text, this.findOption);\n        var endSelection = this.viewer.selection.end;\n        var index = endSelection.getHierarchicalIndexInternal();\n        this.results = this.viewer.owner.searchModule.textSearch.findAll(pattern, this.findOption, index);\n        var results = this.results;\n        if (isNullOrUndefined(results)) {\n            this.viewer.renderVisiblePages();\n        }\n        if (results != null && results.length > 0) {\n            if ((this.focusedElement.indexOf(this.navigateToPreviousResult) === -1) && this.isOptionsPane) {\n                this.focusedElement.push(this.navigateToPreviousResult);\n            }\n            if ((this.focusedElement.indexOf(this.navigateToNextResult) === -1) && this.isOptionsPane) {\n                this.focusedElement.push(this.navigateToNextResult);\n            }\n            this.viewer.owner.searchModule.navigate(this.results.innerList[this.results.currentIndex]);\n            this.viewer.owner.searchModule.highlight(results);\n            this.viewer.owner.searchModule.addFindResultView(results);\n            // if (this.isOptionsPane) {\n            this.resultsListBlock.style.display = 'block';\n            this.resultsListBlock.style.height = resultsContainerHeight + 'px';\n            this.resultContainer.style.display = 'block';\n            var list = this.viewer.owner.findResultsList;\n            var text_1 = '';\n            this.clearFocusElement();\n            this.resultsListBlock.innerHTML = '';\n            for (var i = 0; i < list.length; i++) {\n                text_1 += list[i];\n            }\n            this.resultsListBlock.innerHTML = text_1;\n            for (var i = 0; i < this.resultsListBlock.children.length; i++) {\n                this.focusedElement.push(this.resultsListBlock.children[i]);\n            }\n            var lists = this.resultsListBlock.children;\n            var currentIndex = this.results.currentIndex;\n            // tslint:disable-next-line:max-line-length\n            this.messageDiv.innerHTML = this.localeValue.getConstant('Result') + ' ' + (currentIndex + 1) + ' ' + this.localeValue.getConstant('of') + ' ' + this.resultsListBlock.children.length;\n            var listElement = this.resultsListBlock.children[currentIndex];\n            if (listElement.classList.contains('e-de-search-result-item')) {\n                listElement.classList.remove('e-de-search-result-item');\n                listElement.classList.add('e-de-search-result-hglt');\n                listElement.children[0].classList.add('e-de-op-search-word-text');\n            }\n            this.navigateToNextResult.focus();\n            this.focusedIndex = 6;\n            this.getMessageDivHeight();\n            // } else {\n            //this.focusedIndex = 4;\n            // }\n        }\n        else {\n            this.messageDiv.innerHTML = this.localeValue.getConstant('No matches');\n            this.resultContainer.style.display = 'block';\n            this.resultsListBlock.style.display = 'none';\n            this.clearFocusElement();\n            this.resultsListBlock.innerHTML = '';\n        }\n    };\n    OptionsPane.prototype.getMessageDivHeight = function () {\n        if (!this.isOptionsPane && this.messageDiv.classList.contains('e-de-op-msg')) {\n            this.messageDiv.classList.add('e-de-op-replace-messagediv');\n            this.messageDiv.classList.remove('e-de-op-msg');\n        }\n        else if (this.isOptionsPane && this.messageDiv.classList.contains('e-de-op-replace-messagediv')) {\n            this.messageDiv.classList.add('e-de-op-msg');\n            this.messageDiv.classList.remove('e-de-op-replace-messagediv');\n        }\n    };\n    /**\n     * Replace all.\n     * @private\n     */\n    OptionsPane.prototype.replaceAll = function () {\n        var optionsPane = this.optionsPane;\n        var findText = this.searchInput.value;\n        var replaceText = this.replaceWith.value;\n        if (findText !== '' && !isNullOrUndefined(findText)) {\n            var pattern = this.viewer.owner.searchModule.textSearch.stringToRegex(findText, this.findOption);\n            var endSelection = this.viewer.selection.end;\n            var index = endSelection.getHierarchicalIndexInternal();\n            var results = this.viewer.owner.searchModule.textSearch.findAll(pattern, this.findOption, index);\n            var replace = isNullOrUndefined(replaceText) ? '' : replaceText;\n            var count = isNullOrUndefined(results) ? 0 : results.length;\n            this.viewer.owner.searchModule.replaceAll(replace, results);\n            this.matchDiv.style.display = 'block';\n            this.matchDiv.innerHTML = this.localeValue.getConstant('All Done') + '!';\n            this.occurrenceDiv.style.display = 'block';\n            // tslint:disable-next-line:max-line-length\n            this.occurrenceDiv.innerHTML = this.localeValue.getConstant('We replaced all') + ' ' + count + ' ' + this.localeValue.getConstant('instances') + ' ' + this.localeValue.getConstant('of') + ' \"' + findText + '\" ' + this.localeValue.getConstant('with') + ' \"' + replaceText + '\" ';\n        }\n    };\n    /**\n     * Scrolls to position.\n     * @param {HTMLElement} list - Specifies the list element.\n     * @private\n     */\n    OptionsPane.prototype.scrollToPosition = function (list) {\n        var rect = list.getBoundingClientRect();\n        var top;\n        if (rect.top > 0) {\n            top = rect.top - list.parentElement.getBoundingClientRect().top;\n            if ((list.parentElement.offsetHeight - top) <= list.offsetHeight) {\n                if (Math.ceil(top + list.offsetHeight) === list.parentElement.scrollHeight) {\n                    list.parentElement.scrollTop = top;\n                }\n                list.parentElement.scrollTop = list.parentElement.scrollTop + (list.parentElement.offsetHeight / 100) * 30;\n            }\n            else if (top < 0) {\n                list.parentElement.scrollTop = list.parentElement.scrollTop - (list.parentElement.offsetHeight / 100) * 30;\n            }\n        }\n        else {\n            list.parentElement.scrollTop = 0;\n        }\n    };\n    /**\n     * Clear the focus elements.\n     * @private\n     */\n    OptionsPane.prototype.clearFocusElement = function () {\n        for (var i = 0; i < this.resultsListBlock.children.length; i++) {\n            var index = this.focusedElement.indexOf(this.resultsListBlock.children[i]);\n            if (index !== -1) {\n                this.focusedElement.splice(index, 1);\n            }\n        }\n        this.focusedIndex = 0;\n    };\n    /**\n     * Show or hide option pane based on boolean value.\n     * @param {boolean} show - Specifies showing or hiding the options pane.\n     * @private\n     */\n    OptionsPane.prototype.showHideOptionsPane = function (show) {\n        if (!isNullOrUndefined(this.viewer.owner.selectionModule)) {\n            if (show) {\n                this.localeValue = new L10n('documenteditor', this.viewer.owner.defaultLocale);\n                this.localeValue.setLocale(this.viewer.owner.locale);\n                setCulture(this.viewer.owner.locale);\n                if (isNullOrUndefined(this.optionsPane)) {\n                    this.initOptionsPane(this.localeValue);\n                    //Add Option Pane\n                    var element = document.getElementById(this.viewer.owner.element.id);\n                    var optionPaneContainer = document.createElement('div');\n                    optionPaneContainer.className = 'e-documenteditor-optionspane';\n                    optionPaneContainer.setAttribute('style', 'display:inline-flex');\n                    optionPaneContainer.appendChild(this.viewer.owner.optionsPaneModule.optionsPane);\n                    this.viewer.owner.getDocumentEditorElement().appendChild(optionPaneContainer);\n                    optionPaneContainer.appendChild(this.viewer.viewerContainer);\n                    element.appendChild(optionPaneContainer);\n                }\n                this.optionsPane.style.display = 'block';\n                if (this.viewer.owner.isReadOnlyMode) {\n                    this.tabInstance.hideTab(1);\n                }\n                else {\n                    this.tabInstance.hideTab(1, false);\n                }\n                if (this.isReplace && !this.viewer.owner.isReadOnlyMode) {\n                    this.tabInstance.select(1);\n                    this.isReplace = false;\n                    this.isOptionsPane = false;\n                }\n                else {\n                    this.tabInstance.select(0);\n                }\n                this.searchDiv.innerHTML = this.localeValue.getConstant(this.searchText);\n                this.isOptionsPaneShow = true;\n                // tslint:disable-next-line:max-line-length\n                var textBox = document.getElementById(this.viewer.owner.getDocumentEditorElement().id + '_option_search_text_box');\n                var selectedText = this.viewer.owner.selection.text;\n                if (!isNullOrUndefined(selectedText)) {\n                    var char = ['\\v', '\\r'];\n                    var index = HelperMethods.indexOfAny(selectedText, char);\n                    selectedText = index < 0 ? selectedText : selectedText.substring(0, index);\n                }\n                textBox.value = selectedText;\n                textBox.select();\n                this.messageDiv.innerHTML = '';\n                if (this.searchIcon.classList.contains('e-de-op-search-close-icon')) {\n                    this.searchIcon.classList.add('e-de-op-search-icon');\n                    this.searchIcon.classList.remove('e-de-op-search-close-icon');\n                }\n                this.viewer.selection.caret.style.display = 'none';\n                this.focusedIndex = 3;\n                this.focusedElement = [];\n                if (this.isOptionsPane) {\n                    // tslint:disable-next-line:max-line-length\n                    this.focusedElement.push(this.closeButton, this.findTabButtonHeader, this.replaceTabButtonHeader, this.searchInput, this.searchIcon, this.navigateToPreviousResult, this.navigateToNextResult, this.matchInput, this.wholeInput);\n                }\n                else {\n                    // tslint:disable-next-line:max-line-length\n                    this.focusedElement.push(this.closeButton, this.findTabButtonHeader, this.replaceTabButtonHeader, this.searchInput, this.searchIcon, this.navigateToPreviousResult, this.navigateToNextResult, this.matchInput, this.wholeInput, this.replaceWith, this.replaceButton, this.replaceAllButton);\n                }\n                this.viewer.updateViewerSize();\n            }\n            else {\n                if (!isNullOrUndefined(this.optionsPane)) {\n                    this.clearSearchResultItems();\n                    this.viewer.owner.searchModule.clearSearchHighlight();\n                    this.isOptionsPaneShow = false;\n                    var resultListBox = document.getElementById(this.viewer.owner.containerId + '_list_box_container');\n                    var message = document.getElementById(this.viewer.owner.containerId + '_search_status');\n                    if (!isNullOrUndefined(resultListBox) && !isNullOrUndefined(message)) {\n                        resultListBox.style.display = 'none';\n                        this.clearFocusElement();\n                        resultListBox.innerHTML = '';\n                        message.innerHTML = this.localeValue.getConstant('No matches');\n                    }\n                }\n                this.viewer.updateViewerSize();\n                if (!isNullOrUndefined(this.optionsPane)) {\n                    if (this.optionsPane.style.display !== 'none') {\n                        this.viewer.selection.updateCaretPosition();\n                        this.optionsPane.style.display = 'none';\n                    }\n                }\n                this.viewer.updateFocus();\n                this.viewer.selection.caret.style.display = 'block';\n            }\n        }\n    };\n    /**\n     * Clears search results.\n     * @private\n     */\n    OptionsPane.prototype.clearSearchResultItems = function () {\n        if (!isNullOrUndefined(this.viewer.owner.findResultsList)) {\n            this.viewer.owner.findResultsList = [];\n        }\n    };\n    /**\n     * Dispose the internal objects which are maintained.\n     * @private\n     */\n    OptionsPane.prototype.destroy = function () {\n        if (this.optionsPane) {\n            this.optionsPane.innerHTML = '';\n            this.optionsPane = undefined;\n        }\n        if (this.resultsListBlock) {\n            this.resultsListBlock.innerHTML = '';\n            this.resultsListBlock = undefined;\n        }\n        if (this.messageDiv) {\n            this.messageDiv.innerHTML = '';\n            this.messageDiv = undefined;\n        }\n        if (this.resultContainer) {\n            this.resultContainer.innerHTML = '';\n        }\n        this.resultContainer = undefined;\n        if (this.searchInput) {\n            this.searchInput.value = '';\n            this.searchInput = undefined;\n        }\n        if (this.searchDiv) {\n            this.searchDiv.innerHTML = '';\n            this.searchDiv = undefined;\n        }\n        if (this.searchTextBoxContainer) {\n            this.searchTextBoxContainer.innerHTML = '';\n            this.searchTextBoxContainer = undefined;\n        }\n        if (this.replaceWith) {\n            this.replaceWith.innerHTML = '';\n            this.replaceWith = undefined;\n        }\n        if (this.findDiv) {\n            this.findDiv.innerHTML = '';\n            this.findDiv = undefined;\n        }\n        if (this.replaceButton) {\n            this.replaceButton.innerHTML = '';\n            this.replaceButton = undefined;\n        }\n        if (this.replaceAllButton) {\n            this.replaceAllButton.innerHTML = '';\n            this.replaceAllButton = undefined;\n        }\n        if (this.matchInput) {\n            this.matchInput.innerHTML = '';\n            this.matchCase = undefined;\n        }\n        if (this.wholeInput) {\n            this.wholeInput.innerHTML = '';\n            this.wholeWord = undefined;\n        }\n        // if (this.regularInput) {\n        //     this.regularInput.innerHTML = '';\n        //     this.regular = undefined;\n        // }\n        if (!isNullOrUndefined(this.results)) {\n            this.results.destroy();\n        }\n        if (this.focusedElement) {\n            this.focusedElement = [];\n        }\n        this.focusedElement = undefined;\n        this.destroyInternal();\n    };\n    /**\n     * Dispose the internal objects which are maintained.\n     */\n    OptionsPane.prototype.destroyInternal = function () {\n        if (this.searchText) {\n            this.searchText = undefined;\n        }\n        if (this.resultsText) {\n            this.resultsText = undefined;\n        }\n        if (this.messageDivText) {\n            this.messageDivText = undefined;\n        }\n        if (this.replaceButtonText) {\n            this.replaceButtonText = undefined;\n        }\n        if (this.replaceAllButtonText) {\n            this.replaceAllButtonText = undefined;\n        }\n    };\n    return OptionsPane;\n}());\nexport { OptionsPane };\n","import { TableWidget } from '../index';\nimport { isNullOrUndefined } from '@syncfusion/ej2-base';\nimport { Point, HelperMethods } from './editor-helper';\n/**\n * @private\n */\nvar TableResizer = /** @class */ (function () {\n    /**\n     * @private\n     */\n    function TableResizer(node) {\n        this.resizeNode = 0;\n        this.resizerPosition = 0;\n        this.currentResizingTable = undefined;\n        this.owner = node;\n        this.startingPoint = new Point(0, 0);\n    }\n    Object.defineProperty(TableResizer.prototype, \"viewer\", {\n        /**\n         * @private\n         */\n        get: function () {\n            return this.owner.viewer;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    /**\n     * Gets module name.\n     */\n    TableResizer.prototype.getModuleName = function () {\n        return 'TableResizer';\n    };\n    /**\n     * @private\n     */\n    TableResizer.prototype.updateResizingHistory = function (touchPoint) {\n        if (this.owner.editorHistory) {\n            this.owner.editorHistory.updateResizingHistory(touchPoint, this);\n        }\n        this.viewer.isRowOrCellResizing = false;\n        this.resizerPosition = -1;\n    };\n    TableResizer.prototype.handleResize = function (point) {\n        this.owner.viewer.isRowOrCellResizing = true;\n        this.startingPoint.x = point.x;\n        this.startingPoint.y = point.y;\n        //Initialize resizing history.\n        this.owner.editorHistory.initResizingHistory(point, this);\n    };\n    //Table Resizing implementation starts\n    /**\n     * @private\n     */\n    TableResizer.prototype.isInRowResizerArea = function (touchPoint) {\n        var position = this.getRowReSizerPosition(undefined, touchPoint);\n        if (position === -1) {\n            return false;\n        }\n        else {\n            this.resizeNode = 1;\n            this.resizerPosition = position;\n            return true;\n        }\n    };\n    TableResizer.prototype.isInCellResizerArea = function (touchPoint) {\n        var position = this.getCellReSizerPosition(touchPoint);\n        if (position === -1) {\n            return false;\n        }\n        else {\n            this.resizeNode = 0;\n            this.resizerPosition = position;\n            return true;\n        }\n    };\n    /**\n     * Gets cell resizer position.\n     * @param {Point} point\n     * @private\n     */\n    TableResizer.prototype.getCellReSizerPosition = function (touchPoint) {\n        var position = -1;\n        var resizerBoundaryWidth = 2;\n        var tableWidget = this.getTableWidget(touchPoint);\n        var cellWidget = this.getTableCellWidget(touchPoint);\n        var cellSpacing = isNullOrUndefined(tableWidget) ? 0 : tableWidget.tableFormat.cellSpacing;\n        if (tableWidget && cellSpacing > 0) {\n            this.currentResizingTable = tableWidget;\n            // tslint:disable-next-line:max-line-length\n            if (this.viewer.isInsideRect(tableWidget.x - HelperMethods.convertPointToPixel(tableWidget.leftBorderWidth) - 0.25, tableWidget.y, HelperMethods.convertPointToPixel(tableWidget.leftBorderWidth) + 0.5, tableWidget.height, touchPoint)) {\n                return position = 0;\n            }\n            var startingPointX = tableWidget.x;\n            for (var i = 0; i < tableWidget.tableHolder.columns.length; i++) {\n                var preferredWidth = HelperMethods.convertPointToPixel(tableWidget.tableHolder.columns[i].preferredWidth);\n                // tslint:disable-next-line:max-line-length\n                if ((this.viewer.isInsideRect(startingPointX - 1, tableWidget.y, tableWidget.leftBorderWidth + resizerBoundaryWidth, tableWidget.height, touchPoint))) {\n                    return position = i > 0 ? i : 0;\n                    // tslint:disable-next-line:max-line-length\n                }\n                else if (i > 0 && (this.viewer.isInsideRect(startingPointX + preferredWidth - resizerBoundaryWidth / 2, tableWidget.y, resizerBoundaryWidth, tableWidget.height, touchPoint))) {\n                    return position = (i + 1);\n                }\n                startingPointX = startingPointX + preferredWidth;\n            }\n        }\n        else {\n            if (!isNullOrUndefined(cellWidget)) {\n                this.currentResizingTable = cellWidget.ownerTable;\n                // tslint:disable-next-line:max-line-length\n                if (this.viewer.isInsideRect(cellWidget.x - cellWidget.margin.left - resizerBoundaryWidth / 2, cellWidget.y - cellWidget.margin.top, resizerBoundaryWidth, cellWidget.height, touchPoint)) {\n                    return position = cellWidget.columnIndex;\n                    // tslint:disable-next-line:max-line-length\n                }\n                else if (isNullOrUndefined(cellWidget.nextRenderedWidget)\n                    && this.viewer.isInsideRect(cellWidget.x + cellWidget.margin.right + cellWidget.width - resizerBoundaryWidth / 2, cellWidget.y - cellWidget.margin.top, resizerBoundaryWidth, cellWidget.height, touchPoint)) {\n                    return position = (cellWidget.columnIndex + cellWidget.cellFormat.columnSpan);\n                }\n                else if (cellWidget.childWidgets.length > 0) {\n                    return this.getCellReSizerPositionInternal(cellWidget, touchPoint); // Gets the nested table resizer position.\n                }\n            }\n        }\n        return position;\n    };\n    /**\n     * Gets cell resizer position.\n     * @param {TableCellWidget} cellWidget\n     * @param {Point} touchPoint\n     */\n    TableResizer.prototype.getCellReSizerPositionInternal = function (cellWidget, touchPoint) {\n        var position = -1;\n        var childTableWidget = this.getTableWidgetFromWidget(touchPoint, cellWidget);\n        var childCellWidget = undefined;\n        if (!isNullOrUndefined(childTableWidget) && childTableWidget.tableFormat.cellSpacing > 0) {\n            this.currentResizingTable = childTableWidget;\n            // tslint:disable-next-line:max-line-length\n            if (this.viewer.isInsideRect(childTableWidget.x - childTableWidget.leftBorderWidth - 0.25, childTableWidget.y, childTableWidget.leftBorderWidth + 0.5, childTableWidget.height, touchPoint)) {\n                return position = 0;\n            }\n            var startingPointX = childTableWidget.x;\n            for (var i = 0; i < childTableWidget.tableHolder.columns.length; i++) {\n                // tslint:disable-next-line:max-line-length\n                var preferredWidth = HelperMethods.convertPointToPixel(childTableWidget.tableHolder.columns[i].preferredWidth);\n                // tslint:disable-next-line:max-line-length\n                if ((this.viewer.isInsideRect(startingPointX - 1, childTableWidget.y, childTableWidget.leftBorderWidth + 2, childTableWidget.height, touchPoint))) {\n                    return position = i > 0 ? i : 0;\n                    // tslint:disable-next-line:max-line-length\n                }\n                else if (i > 0 && (this.viewer.isInsideRect(startingPointX + preferredWidth - 1, childTableWidget.y, 2, childTableWidget.height, touchPoint))) {\n                    return position = (i + 1);\n                }\n                startingPointX = startingPointX + preferredWidth;\n            }\n        }\n        else {\n            if (!isNullOrUndefined(childTableWidget)) {\n                childCellWidget = childTableWidget.getTableCellWidget(touchPoint);\n            }\n            if (!isNullOrUndefined(childCellWidget)) {\n                this.currentResizingTable = childCellWidget.ownerTable;\n                // tslint:disable-next-line:max-line-length\n                if (this.viewer.isInsideRect(childCellWidget.x - childCellWidget.margin.left - 1, childCellWidget.y - childCellWidget.margin.top, 2, childCellWidget.height, touchPoint)) {\n                    return position = childCellWidget.columnIndex;\n                }\n                else if (isNullOrUndefined(childCellWidget.nextRenderedWidget)\n                    // tslint:disable-next-line:max-line-length\n                    && this.viewer.isInsideRect(childCellWidget.x + childCellWidget.margin.right + childCellWidget.width - 1, childCellWidget.y - childCellWidget.margin.top, 2, childCellWidget.height, touchPoint)) {\n                    return position = (childCellWidget.columnIndex + childCellWidget.cellFormat.columnSpan);\n                }\n                else if (childCellWidget.childWidgets.length > 0) {\n                    return this.getCellReSizerPositionInternal(childCellWidget, touchPoint);\n                }\n            }\n        }\n        return position;\n    };\n    TableResizer.prototype.getRowReSizerPosition = function (widget, touchPoint) {\n        var tableWidget = undefined;\n        var cellWidget = undefined;\n        if (isNullOrUndefined(widget)) {\n            tableWidget = this.getTableWidget(touchPoint);\n            cellWidget = this.getTableCellWidget(touchPoint);\n        }\n        else {\n            tableWidget = this.getTableWidgetFromWidget(touchPoint, widget);\n        }\n        var cellSpacing = isNullOrUndefined(tableWidget) ? 0 : tableWidget.tableFormat.cellSpacing;\n        if (tableWidget && cellSpacing > 0) {\n            this.currentResizingTable = tableWidget;\n            // tslint:disable-next-line:max-line-length\n            if (this.owner.viewer.isInsideRect(tableWidget.x, tableWidget.y + tableWidget.height - cellSpacing, this.getActualWidth(tableWidget.lastChild), (isNullOrUndefined(tableWidget.nextSplitWidget) ? tableWidget.bottomBorderWidth + cellSpacing : 0), touchPoint)) {\n                return tableWidget.lastChild.rowIndex;\n            }\n            for (var i = 0; i < tableWidget.childWidgets.length; i++) {\n                //Need to consider for splitted widgets\n                var rowWidget = tableWidget.childWidgets[i];\n                if (tableWidget.childWidgets.indexOf(rowWidget) > -1\n                    // tslint:disable-next-line:max-line-length\n                    && (this.owner.viewer.isInsideRect(rowWidget.x, rowWidget.y + rowWidget.height + cellSpacing / 2, this.getActualWidth(rowWidget), cellSpacing / 2, touchPoint))) {\n                    return rowWidget.rowIndex;\n                }\n            }\n        }\n        else {\n            if (tableWidget && cellWidget) {\n                cellWidget = this.getTableCellWidget(touchPoint);\n            }\n            if (cellWidget) {\n                var rowWidget = cellWidget.containerWidget;\n                var height = 0;\n                if (rowWidget.rowIndex === rowWidget.ownerTable.childWidgets.length - 1) {\n                    height = rowWidget.bottomBorderWidth + 2;\n                }\n                else {\n                    height = rowWidget.nextRenderedWidget.topBorderWidth + 2;\n                }\n                // tslint:disable-next-line:max-line-length\n                if (this.owner.viewer.isInsideRect(rowWidget.x, rowWidget.y + rowWidget.height - height, rowWidget.width, height * 2, touchPoint)) {\n                    this.currentResizingTable = rowWidget.ownerTable;\n                    return rowWidget.rowIndex;\n                }\n                else {\n                    if (cellWidget.childWidgets.length > 0) {\n                        return this.getRowReSizerPosition(cellWidget, touchPoint);\n                    }\n                }\n            }\n        }\n        return -1;\n    };\n    /**\n     * To handle Table Row and cell resize\n     * @param touchPoint\n     * @private\n     */\n    TableResizer.prototype.handleResizing = function (touchPoint) {\n        var dragValue = 0;\n        if (this.resizeNode === 0) {\n            dragValue = touchPoint.x - this.startingPoint.x;\n            this.resizeTableCellColumn(dragValue);\n        }\n        else {\n            dragValue = touchPoint.y - this.startingPoint.y;\n            this.resizeTableRow(dragValue);\n        }\n    };\n    TableResizer.prototype.resizeTableRow = function (dragValue) {\n        var table = this.currentResizingTable;\n        if (isNullOrUndefined(table) || dragValue === 0) {\n            return;\n        }\n        var selection = this.owner.selection;\n        if (table.isInsideTable) {\n            this.owner.isLayoutEnabled = false; //Layouting is disabled to skip the child table layouting. \n        }\n        if (this.resizerPosition > -1) {\n            var row = table.childWidgets[this.resizerPosition];\n            this.updateRowHeight(row, dragValue);\n            selection.selectPosition(selection.start, selection.end);\n        }\n        if (table.isInsideTable) {\n            var parentTable = this.owner.viewer.layout.getParentTable(table);\n            this.owner.isLayoutEnabled = true; //layouting is enabled to layout the parent table of the nested table.\n            table = parentTable;\n        }\n        this.startingPoint.y += HelperMethods.convertPointToPixel(dragValue);\n        this.owner.viewer.layout.reLayoutTable(table);\n        this.owner.editorModule.reLayout(this.owner.selection);\n    };\n    /**\n     * Gets the table widget from given cursor point\n     * @param cursorPoint\n     */\n    TableResizer.prototype.getTableWidget = function (cursorPoint) {\n        var widget = undefined;\n        var currentPage = this.owner.viewer.currentPage;\n        if (!isNullOrUndefined(currentPage)) {\n            for (var i = 0; i < currentPage.bodyWidgets.length; i++) {\n                var bodyWidget = currentPage.bodyWidgets[i];\n                widget = this.getTableWidgetFromWidget(cursorPoint, bodyWidget);\n                if (!isNullOrUndefined(widget)) {\n                    break;\n                }\n            }\n        }\n        return widget;\n    };\n    TableResizer.prototype.getTableWidgetFromWidget = function (point, widget) {\n        for (var j = 0; j < widget.childWidgets.length; j++) {\n            if (widget.childWidgets[j] instanceof TableWidget) {\n                var childWidget = widget.childWidgets[j];\n                if (childWidget.y <= point.y && (childWidget.y + childWidget.height) >= point.y) {\n                    return childWidget;\n                }\n            }\n        }\n        return undefined;\n    };\n    /**\n     * Return the table cell widget from the given cursor point\n     * @param cursorPoint\n     * @private\n     */\n    TableResizer.prototype.getTableCellWidget = function (cursorPoint) {\n        var widget = undefined;\n        var currentPage = this.owner.viewer.currentPage;\n        if (!isNullOrUndefined(currentPage)) {\n            for (var i = 0; i < currentPage.bodyWidgets.length; i++) {\n                var bodyWidget = currentPage.bodyWidgets[i];\n                widget = bodyWidget.getTableCellWidget(cursorPoint);\n                if (!isNullOrUndefined(widget)) {\n                    break;\n                }\n            }\n        }\n        return widget;\n    };\n    TableResizer.prototype.updateRowHeight = function (row, dragValue) {\n        var rowFormat = row.rowFormat;\n        if (rowFormat.heightType === 'Auto') {\n            rowFormat.heightType = 'AtLeast';\n            var row_1 = rowFormat.ownerBase;\n            var currentHeight = this.owner.viewer.layout.getRowHeight(row_1, [row_1]);\n            //the minimum height of the Row in MS word is 2.7 points which is equal to 3.6 pixel.\n            if (currentHeight + dragValue >= 2.7 && rowFormat.height !== currentHeight + dragValue) {\n                rowFormat.height = currentHeight + dragValue;\n            }\n        }\n        else {\n            //the minimum height of the Row in MS word is 2.7 points which is equal to 3.6 pixel.\n            if (rowFormat.height + dragValue >= 2.7 && rowFormat.height !== rowFormat.height + dragValue) {\n                rowFormat.height = rowFormat.height + dragValue;\n            }\n        }\n    };\n    //Resize Table cell\n    TableResizer.prototype.resizeTableCellColumn = function (dragValue) {\n        var table = this.currentResizingTable;\n        if (isNullOrUndefined(table) || dragValue === 0 || isNullOrUndefined(table.childWidgets)) {\n            return;\n        }\n        var selectionFlag = true;\n        var selection = this.owner.selection;\n        this.owner.editor.setOffsetValue(selection);\n        table = table.combineWidget(this.viewer);\n        this.owner.isLayoutEnabled = false;\n        // table.PreserveGrid = true;\n        this.setPreferredWidth(table);\n        var containerWidth = table.getOwnerWidth(true);\n        var newIndent = table.leftIndent;\n        var tableAlignment = table.tableFormat.tableAlignment;\n        if (!selection.isEmpty) {\n            selectionFlag = this.resizeColumnWithSelection(selection, table, dragValue);\n        }\n        if (!selectionFlag) {\n            this.owner.isLayoutEnabled = true;\n            return;\n        }\n        if (this.resizerPosition === 0) {\n            // Todo: need to handle the resizing of first column and table indent.\n            var columnIndex = this.resizerPosition;\n            var rightColumn = table.tableHolder.columns[columnIndex];\n            var width = rightColumn.preferredWidth;\n            if (dragValue > 0) {\n                var prevDragValue = dragValue;\n                do {\n                    var newWidth = HelperMethods.round(rightColumn.preferredWidth - dragValue, 1);\n                    if (newWidth >= rightColumn.minWidth) {\n                        rightColumn.preferredWidth = newWidth;\n                        newIndent = table.leftIndent + dragValue;\n                        newIndent = newIndent >= -1440 ? (newIndent <= 1440 ? newIndent : 1440) : -1440;\n                        break;\n                    }\n                    else {\n                        prevDragValue = dragValue;\n                        dragValue += newWidth - rightColumn.minWidth;\n                    }\n                } while (dragValue !== prevDragValue);\n            }\n            else {\n                var prevDragValue = dragValue;\n                do {\n                    var newWidth = HelperMethods.round(rightColumn.preferredWidth - dragValue, 1);\n                    if (newWidth <= 2112) {\n                        rightColumn.preferredWidth = newWidth;\n                        newIndent = table.leftIndent + dragValue;\n                        newIndent = newIndent >= -1440 ? (newIndent <= 1440 ? newIndent : 1440) : -1440;\n                        break;\n                    }\n                    else {\n                        prevDragValue = dragValue;\n                        dragValue -= newWidth - 2112;\n                    }\n                } while (dragValue !== prevDragValue);\n            }\n            var dragOffset = dragValue;\n            // tslint:disable-next-line:max-line-length\n            if (tableAlignment !== 'Left' && (table.tableHolder.getTotalWidth() > containerWidth) && table.tableFormat.preferredWidthType === 'Auto') {\n                if (table.tableHolder.isFitColumns(containerWidth, table.tableHolder.tableWidth, table.tableFormat.preferredWidthType === 'Auto')) {\n                    // tslint:disable-next-line:max-line-length\n                    table.tableHolder.fitColumns(containerWidth, table.tableHolder.tableWidth, table.tableFormat.preferredWidthType === 'Auto');\n                }\n                else {\n                    rightColumn.preferredWidth = width;\n                }\n                dragOffset = 0;\n            }\n            if (tableAlignment === 'Center'\n                && (table.tableHolder.getTotalWidth() < containerWidth || table.tableFormat.preferredWidthType !== 'Auto')) {\n                dragOffset = dragOffset / 2;\n            }\n            table.tableFormat.leftIndent = tableAlignment === 'Left' ? newIndent : 0;\n            table.tableHolder.tableWidth = table.tableHolder.getTotalWidth();\n            this.updateCellPreferredWidths(table);\n            this.updateGridValue(table, true, dragOffset);\n        }\n        else if (table !== null && this.resizerPosition === table.tableHolder.columns.length) {\n            // Todo: need to handle the resizing of last column and table width.\n            this.resizeColumnAtLastColumnIndex(table, dragValue, containerWidth);\n        }\n        else {\n            if (this.resizerPosition === -1) {\n                this.owner.isLayoutEnabled = true;\n                return;\n            }\n            this.resizeCellAtMiddle(table, dragValue);\n        }\n        // table.PreserveGrid = false;\n        this.owner.isLayoutEnabled = true;\n        selection.selectPosition(selection.start, selection.end);\n    };\n    /**\n     * Resize Selected Cells\n     */\n    TableResizer.prototype.resizeColumnWithSelection = function (selection, table, dragValue) {\n        var newIndent = table.leftIndent;\n        var cellwidget = this.getTableCellWidget(this.startingPoint);\n        if (cellwidget && (selection.selectedWidgets.containsKey(cellwidget) || (cellwidget.previousWidget\n            && selection.selectedWidgets.containsKey((cellwidget.previousWidget))))) {\n            var selectedCells = selection.getSelectedCells();\n            if (this.resizerPosition === 0) {\n                this.resizeColumnAtStart(table, dragValue, selectedCells);\n            }\n            else if (table !== null && this.resizerPosition === table.tableHolder.columns.length) {\n                var leftColumnCollection = this.getColumnCells(table, this.resizerPosition, true);\n                for (var i = 0; i < leftColumnCollection.length; i++) {\n                    var cell = leftColumnCollection[i];\n                    if (selectedCells.indexOf(cell) !== -1) {\n                        this.increaseOrDecreaseWidth(cell, dragValue, true);\n                    }\n                }\n                //Updates the grid after value for all the rows.\n                this.updateRowsGridAfterWidth(table);\n                table.updateWidth(dragValue);\n                this.updateGridValue(table, true, dragValue);\n            }\n            else {\n                if (this.resizerPosition === -1) {\n                    return false;\n                }\n                var columnIndex = this.resizerPosition;\n                var leftColumnCollection = this.getColumnCells(table, columnIndex, true);\n                var rightColumnCollection = this.getColumnCells(table, columnIndex, false);\n                var isColumnResizing = this.isColumnSelected(table, columnIndex);\n                if (leftColumnCollection.length > 0 && !isColumnResizing) {\n                    for (var i = 0; i < leftColumnCollection.length; i++) {\n                        if (selectedCells.indexOf(leftColumnCollection[i]) === -1) {\n                            leftColumnCollection.splice(i, 1);\n                            i--;\n                        }\n                    }\n                }\n                if (rightColumnCollection.length > 0 && !isColumnResizing) {\n                    for (var i = 0; i < rightColumnCollection.length; i++) {\n                        if (selectedCells.indexOf(rightColumnCollection[i]) === -1) {\n                            rightColumnCollection.splice(i, 1);\n                            i--;\n                        }\n                    }\n                }\n                //Getting the adjacent cell collections for left side selected cells in the right column collection.\n                if (leftColumnCollection.length === 0 && rightColumnCollection.length > 0) {\n                    for (var i = 0; i < rightColumnCollection.length; i++) {\n                        var cell = rightColumnCollection[i];\n                        if (cell.previousWidget) {\n                            leftColumnCollection.push(cell.previousWidget);\n                        }\n                    }\n                }\n                else if (rightColumnCollection.length === 0 && leftColumnCollection.length > 0) {\n                    for (var i = 0; i < leftColumnCollection.length; i++) {\n                        var cell = leftColumnCollection[i];\n                        if (cell.nextWidget) {\n                            rightColumnCollection.push(cell.nextWidget);\n                        }\n                    }\n                }\n                this.changeWidthOfCells(table, leftColumnCollection, rightColumnCollection, dragValue, true);\n                this.updateGridValue(table, true, dragValue);\n            }\n            selection.selectPosition(selection.start, selection.end);\n        }\n        return false;\n    };\n    /**\n     * Resize selected cells at resizer position 0\n     */\n    TableResizer.prototype.resizeColumnAtStart = function (table, dragValue, selectedCells) {\n        var newIndent = table.leftIndent;\n        var rightColumnCollection = this.getColumnCells(table, this.resizerPosition, false);\n        var offset = 0;\n        var selectedRow = selectedCells[0].ownerRow;\n        var rowFormat = selectedRow.rowFormat;\n        if (rowFormat.beforeWidth > 0) {\n            var newGridBefore = rowFormat.beforeWidth + dragValue;\n            if (newGridBefore > 0) {\n                this.updateGridBefore(selectedRow, dragValue);\n            }\n            else {\n                var leastGridBefore = this.getLeastGridBefore(table, selectedRow);\n                if (newGridBefore < leastGridBefore && offset !== newGridBefore) {\n                    newIndent = table.leftIndent + newGridBefore;\n                    table.tableFormat.leftIndent = newIndent >= -1440 ? (newIndent <= 1440 ? newIndent : 1440) : -1440;\n                    for (var i = 0; i < table.childWidgets.length; i++) {\n                        var tableRow = table.childWidgets[i];\n                        if (selectedRow !== tableRow) {\n                            this.updateGridBefore(tableRow, -newGridBefore);\n                        }\n                    }\n                }\n            }\n        }\n        else {\n            if (dragValue < 0) {\n                newIndent = table.leftIndent + dragValue;\n                table.tableFormat.leftIndent = newIndent >= -1440 ? (newIndent <= 1440 ? newIndent : 1440) : -1440;\n                this.updateWidthForCells(table, selectedCells, dragValue);\n            }\n            else {\n                var leastGridBefore = this.getLeastGridBefore(table, selectedRow);\n                var currentTableIndent = table.tableFormat.leftIndent;\n                if (currentTableIndent === 0) {\n                    for (var i = 0; i < table.childWidgets.length; i++) {\n                        var tableRow = table.childWidgets[i];\n                        if (selectedCells.indexOf(tableRow.childWidgets[0]) !== -1) {\n                            this.updateGridBefore(tableRow, dragValue);\n                            this.increaseOrDecreaseWidth(tableRow.childWidgets[0], dragValue, false);\n                        }\n                    }\n                }\n                else {\n                    var difference = leastGridBefore - dragValue;\n                    if (difference > 0) {\n                        newIndent = table.leftIndent + dragValue;\n                        table.tableFormat.leftIndent = newIndent >= -1440 ? (newIndent <= 1440 ? newIndent : 1440) : -1440;\n                        this.updateWidthForCells(table, selectedCells, dragValue);\n                    }\n                    else {\n                        newIndent = table.leftIndent + leastGridBefore;\n                        table.tableFormat.leftIndent = newIndent >= -1440 ? (newIndent <= 1440 ? newIndent : 1440) : -1440;\n                        for (var i = 0; i < table.childWidgets.length; i++) {\n                            var tableRow = table.childWidgets[i];\n                            if (selectedCells.indexOf(tableRow.childWidgets[0]) !== -1) {\n                                this.increaseOrDecreaseWidth(tableRow.childWidgets[0], dragValue, false);\n                                this.updateGridBefore(tableRow, dragValue - leastGridBefore);\n                            }\n                            else {\n                                this.updateGridBefore(tableRow, -leastGridBefore);\n                            }\n                        }\n                    }\n                }\n            }\n        }\n        this.updateGridValue(table, true, dragValue);\n    };\n    TableResizer.prototype.updateWidthForCells = function (table, selectedCells, dragValue) {\n        for (var i = 0; i < table.childWidgets.length; i++) {\n            var tableRow = table.childWidgets[i];\n            if (selectedCells.indexOf(tableRow.childWidgets[0]) !== -1) {\n                this.increaseOrDecreaseWidth(tableRow.childWidgets[0], dragValue, false);\n            }\n            else {\n                this.updateGridBefore(tableRow, -dragValue);\n            }\n        }\n    };\n    /**\n     * Resize selected cells at last column\n     */\n    TableResizer.prototype.resizeColumnAtLastColumnIndex = function (table, dragValue, containerWidth) {\n        var tableAlignment = table.tableFormat.tableAlignment;\n        var preferredWidth = table.tableFormat.preferredWidth;\n        var hasTableWidth = preferredWidth;\n        var columnIndex = this.resizerPosition;\n        var leftColumn = table.tableHolder.columns[columnIndex - 1];\n        var prevDragValue = 0;\n        while (dragValue !== prevDragValue) {\n            var newWidth = HelperMethods.round(leftColumn.preferredWidth + dragValue, 1);\n            if (newWidth >= leftColumn.minWidth) {\n                leftColumn.preferredWidth = newWidth;\n                prevDragValue = dragValue;\n            }\n            else {\n                prevDragValue = dragValue;\n                dragValue -= newWidth - leftColumn.minWidth;\n            }\n        }\n        this.updateCellPreferredWidths(table);\n        if (hasTableWidth || table.tableHolder.getTotalWidth() > containerWidth) {\n            table.updateWidth(dragValue);\n            table.tableHolder.tableWidth = table.tableHolder.getTotalWidth();\n        }\n        var dragOffset = dragValue;\n        if (tableAlignment === 'Right') {\n            dragOffset = 0;\n        }\n        else if (tableAlignment === 'Center') {\n            dragOffset = dragOffset / 2;\n        }\n        this.updateGridValue(table, true, dragOffset);\n    };\n    /**\n     *  Resize selected cells at middle column\n     */\n    TableResizer.prototype.resizeCellAtMiddle = function (table, dragValue) {\n        var columnIndex = this.resizerPosition;\n        var leftColumn = table.tableHolder.columns[columnIndex - 1];\n        var rightColumn = table.tableHolder.columns[columnIndex];\n        if (dragValue > 0) {\n            var isContinue = true;\n            while (isContinue) {\n                var newWidth = HelperMethods.round(rightColumn.preferredWidth - dragValue, 1);\n                if (newWidth >= rightColumn.minWidth) {\n                    rightColumn.preferredWidth = newWidth;\n                    leftColumn.preferredWidth = leftColumn.preferredWidth + dragValue;\n                    isContinue = false;\n                }\n                else {\n                    dragValue += newWidth - rightColumn.minWidth;\n                }\n            }\n        }\n        else {\n            var isContinue = true;\n            while (isContinue) {\n                var newWidth = HelperMethods.round(leftColumn.preferredWidth + dragValue, 1);\n                if (newWidth >= leftColumn.minWidth) {\n                    leftColumn.preferredWidth = newWidth;\n                    rightColumn.preferredWidth = rightColumn.preferredWidth - dragValue;\n                    isContinue = false;\n                }\n                else {\n                    dragValue -= newWidth - leftColumn.minWidth;\n                }\n            }\n        }\n        // Update the cell widths based on the columns preferred width\n        this.updateCellPreferredWidths(table);\n        // table.tableFormat.AllowAutoFit = false;\n        table.tableHolder.tableWidth = table.tableHolder.getTotalWidth();\n        this.updateGridValue(table, false, dragValue);\n    };\n    TableResizer.prototype.updateGridValue = function (table, isUpdate, dragValue) {\n        if (isUpdate) {\n            table.calculateGrid();\n            table.isGridUpdated = false;\n        }\n        table.buildTableColumns();\n        table.isGridUpdated = true;\n        this.viewer.owner.isLayoutEnabled = true;\n        if (table.isInsideTable) {\n            var parentTable = this.viewer.layout.getParentTable(table);\n            this.viewer.layout.reLayoutTable(parentTable); // Need to optmize this.\n        }\n        else {\n            this.viewer.layout.reLayoutTable(table);\n        }\n        this.owner.editor.getOffsetValue(this.viewer.selection);\n        this.owner.editorModule.reLayout(this.owner.selection);\n        if (dragValue) {\n            this.startingPoint.x += HelperMethods.convertPointToPixel(dragValue);\n            this.resizerPosition = this.getCellReSizerPosition(this.startingPoint);\n        }\n    };\n    TableResizer.prototype.getColumnCells = function (table, columnIndex, isLeftSideCollection) {\n        var cells = [];\n        for (var i = 0; i < table.childWidgets.length; i++) {\n            var row = table.childWidgets[i];\n            for (var j = 0; j < row.childWidgets.length; j++) {\n                var cell = row.childWidgets[j];\n                if (isLeftSideCollection) {\n                    if (cell.columnIndex + cell.cellFormat.columnSpan === columnIndex) {\n                        cells.push(cell);\n                    }\n                }\n                else {\n                    if (cell.columnIndex === columnIndex) {\n                        cells.push(cell);\n                    }\n                }\n            }\n        }\n        return cells;\n    };\n    TableResizer.prototype.updateGridBefore = function (row, offset) {\n        if (row.rowFormat.beforeWidth + offset !== row.rowFormat.beforeWidth) {\n            row.rowFormat.beforeWidth = row.rowFormat.beforeWidth + offset;\n            row.rowFormat.gridBeforeWidth = row.rowFormat.beforeWidth;\n        }\n    };\n    TableResizer.prototype.getLeastGridBefore = function (table, ignoreRow) {\n        var gridBefore = 0;\n        var flag = 0;\n        for (var i = 0; i < table.childWidgets.length; i++) {\n            var row = table.childWidgets[i];\n            if (row !== ignoreRow) {\n                if (flag === 0) {\n                    gridBefore = row.rowFormat.beforeWidth;\n                    flag++;\n                }\n                if (row.rowFormat.beforeWidth <= gridBefore) {\n                    gridBefore = row.rowFormat.beforeWidth;\n                }\n            }\n        }\n        return gridBefore;\n    };\n    TableResizer.prototype.increaseOrDecreaseWidth = function (cell, dragValue, isIncrease) {\n        var preferredWidth = cell.cellFormat.preferredWidth;\n        if (cell.cellFormat.preferredWidthType === 'Auto') {\n            preferredWidth = cell.cellFormat.cellWidth;\n            cell.cellFormat.preferredWidthType = 'Point';\n        }\n        var minimumWidth = cell.ownerColumn.minWidth;\n        if (cell.cellFormat.preferredWidthType === 'Percent') {\n            minimumWidth = cell.convertPointToPercent(minimumWidth);\n        }\n        // Margins properties usedd for internal purpose.\n        if (isIncrease) {\n            cell.cellFormat.preferredWidth = preferredWidth + dragValue > minimumWidth ? preferredWidth + dragValue : minimumWidth;\n        }\n        else {\n            cell.cellFormat.preferredWidth = preferredWidth - dragValue > minimumWidth ? preferredWidth - dragValue : minimumWidth;\n        }\n    };\n    // tslint:disable-next-line:max-line-length\n    TableResizer.prototype.changeWidthOfCells = function (table, leftColumnCollection, rightColumnCollection, dragValue, isSelection) {\n        if (leftColumnCollection.length > 0) {\n            var flag = false;\n            for (var i = 0; i < leftColumnCollection.length; i++) {\n                var cell = leftColumnCollection[i];\n                this.increaseOrDecreaseWidth(cell, dragValue, true);\n                if (cell.cellIndex === cell.ownerRow.childWidgets.length - 1) {\n                    flag = true;\n                }\n            }\n            if (flag) {\n                this.updateRowsGridAfterWidth(table);\n            }\n        }\n        if (rightColumnCollection.length > 0) {\n            var diff = 0;\n            for (var i = 0; i < rightColumnCollection.length; i++) {\n                var cell = rightColumnCollection[i];\n                if (cell.cellIndex === 0) {\n                    var newGridBefore = cell.ownerRow.rowFormat.beforeWidth + dragValue;\n                    if (newGridBefore >= 0) {\n                        this.updateGridBefore(cell.ownerRow, dragValue);\n                    }\n                    else {\n                        if (diff !== newGridBefore) {\n                            diff = newGridBefore;\n                        }\n                        cell.ownerRow.rowFormat.gridBeforeWidth = 0;\n                        cell.ownerRow.rowFormat.gridBeforeWidthType = 'Auto';\n                    }\n                }\n                this.increaseOrDecreaseWidth(cell, dragValue, false);\n            }\n            if (diff !== 0) {\n                var newIndent = table.leftIndent + diff;\n                table.tableFormat.leftIndent = newIndent >= -1440 ? (newIndent <= 1440 ? newIndent : 1440) : -1440;\n                for (var j = 0; j < table.childWidgets.length; j++) {\n                    var row = table.childWidgets[j];\n                    if (rightColumnCollection.indexOf(row.childWidgets[0]) === -1) {\n                        this.updateGridBefore(row, diff > 0 ? diff : -diff);\n                    }\n                }\n            }\n        }\n    };\n    TableResizer.prototype.updateRowsGridAfterWidth = function (table) {\n        var maxRowWidth = this.getMaxRowWidth(table, true);\n        for (var i = 0; i < table.childWidgets.length; i++) {\n            var row = table.childWidgets[i];\n            var currentRowWidth = this.getRowWidth(row, true);\n            if (maxRowWidth >= currentRowWidth && row.rowFormat.afterWidth !== maxRowWidth - currentRowWidth) {\n                var value = maxRowWidth - currentRowWidth;\n                row.rowFormat.gridAfterWidth = value;\n                row.rowFormat.afterWidth = value;\n            }\n        }\n    };\n    TableResizer.prototype.getRowWidth = function (row, toUpdateGridAfter) {\n        var rowWidth = 0;\n        if (toUpdateGridAfter) {\n            rowWidth = rowWidth + row.rowFormat.beforeWidth;\n        }\n        for (var i = 0; i < row.childWidgets.length; i++) {\n            var cell = row.childWidgets[i];\n            rowWidth += cell.cellFormat.cellWidth;\n        }\n        return rowWidth;\n    };\n    TableResizer.prototype.getMaxRowWidth = function (table, toUpdateGridAfter) {\n        var width = 0;\n        for (var i = 0; i < table.childWidgets.length; i++) {\n            var row = table.childWidgets[i];\n            var rowWidth = 0;\n            if (toUpdateGridAfter) {\n                rowWidth = rowWidth + row.rowFormat.beforeWidth;\n            }\n            for (var i_1 = 0; i_1 < row.childWidgets.length; i_1++) {\n                var cell = row.childWidgets[i_1];\n                rowWidth += cell.cellFormat.cellWidth;\n            }\n            if (width < rowWidth) {\n                width = rowWidth;\n            }\n        }\n        return width;\n    };\n    TableResizer.prototype.isColumnSelected = function (table, columnIndex) {\n        var selection = this.owner.selection;\n        var selectedCells = selection.getSelectedCells();\n        var leftColumnCells = this.getColumnCells(table, columnIndex, true);\n        var rightColumnCells = this.getColumnCells(table, columnIndex, false);\n        var isColumnSelected = false;\n        for (var i = 0; i < leftColumnCells.length; i++) {\n            var columnCell = leftColumnCells[i];\n            isColumnSelected = selectedCells.indexOf(columnCell) !== -1 ? true : false;\n        }\n        if (!isColumnSelected) {\n            for (var i = 0; i < rightColumnCells.length; i++) {\n                var columnCell = rightColumnCells[i];\n                isColumnSelected = selectedCells.indexOf(columnCell) !== -1 ? true : false;\n            }\n        }\n        return isColumnSelected;\n    };\n    TableResizer.prototype.applyProperties = function (table, tableHistoryInfo) {\n        if (isNullOrUndefined(tableHistoryInfo)) {\n            return;\n        }\n        table = table;\n        // PreserveGrid = true;\n        if (tableHistoryInfo.tableHolder) {\n            table.tableHolder = tableHistoryInfo.tableHolder.clone();\n        }\n        if (tableHistoryInfo.tableFormat !== null) {\n            table.tableFormat.leftIndent = tableHistoryInfo.tableFormat.leftIndent;\n            table.tableFormat.preferredWidth = tableHistoryInfo.tableFormat.preferredWidth;\n            table.tableFormat.preferredWidthType = tableHistoryInfo.tableFormat.preferredWidthType;\n        }\n        for (var i = 0; i < table.childWidgets.length; i++) {\n            var row = table.childWidgets[i];\n            var rowFormat = tableHistoryInfo.rows[i];\n            row.rowFormat.gridBefore = rowFormat.gridBefore;\n            row.rowFormat.gridBeforeWidth = rowFormat.gridBeforeWidth;\n            row.rowFormat.gridBeforeWidthType = rowFormat.gridBeforeWidthType;\n            row.rowFormat.gridAfter = rowFormat.gridAfter;\n            row.rowFormat.gridAfterWidth = rowFormat.gridAfterWidth;\n            row.rowFormat.gridAfterWidthType = rowFormat.gridAfterWidthType;\n            for (var j = 0; j < row.childWidgets.length; j++) {\n                var cell = row.childWidgets[j];\n                var cellFormat = rowFormat.cells[j];\n                cell.columnIndex = cellFormat.columnIndex;\n                cell.cellFormat.columnSpan = cellFormat.columnSpan;\n                cell.cellFormat.preferredWidth = cellFormat.preferredWidth;\n                cell.cellFormat.preferredWidthType = cellFormat.preferredWidthType;\n            }\n        }\n        var containerWidth = table.getOwnerWidth(true);\n        var tableWidth = table.getTableClientWidth(containerWidth);\n        //Sets the width to cells\n        table.setWidthToCells(tableWidth, table.tableFormat.preferredWidthType === 'Auto');\n        // PreserveGrid = false;\n    };\n    /**\n     * Return table row width\n     */\n    TableResizer.prototype.getActualWidth = function (row) {\n        var width = 0;\n        if (row.childWidgets.length > 0) {\n            for (var i = 0; i < row.childWidgets.length; i++) {\n                width += row.childWidgets[i].cellFormat.cellWidth;\n            }\n        }\n        return width;\n    };\n    TableResizer.prototype.setPreferredWidth = function (table) {\n        for (var i = 0; i < table.childWidgets.length; i++) {\n            var rw = table.childWidgets[i];\n            var rowFormat = rw.rowFormat;\n            if (rowFormat.gridBefore > 0) {\n                rowFormat.gridBeforeWidth = rowFormat.beforeWidth;\n                rowFormat.gridBeforeWidthType = 'Point';\n            }\n            for (var j = 0; j < rw.childWidgets.length; j++) {\n                var cell = rw.childWidgets[j];\n                cell.cellFormat.preferredWidth = cell.cellFormat.cellWidth;\n                cell.cellFormat.preferredWidthType = 'Point';\n            }\n            if (rowFormat.gridAfter > 0) {\n                rowFormat.gridAfterWidth = rowFormat.afterWidth;\n                rowFormat.gridAfterWidthType = 'Point';\n            }\n        }\n    };\n    TableResizer.prototype.updateCellPreferredWidths = function (table) {\n        var tableWidth = table.tableHolder.tableWidth;\n        var isAutoFit = table.tableFormat.preferredWidthType === 'Auto';\n        for (var i = 0; i < table.childWidgets.length; i++) {\n            var row = table.childWidgets[i];\n            if (row.rowFormat.gridBefore > 0) {\n                var width = table.tableHolder.getCellWidth(0, row.rowFormat.gridBefore, tableWidth, isAutoFit);\n                this.updateGridBeforeWidth(width, row);\n            }\n            for (var j = 0; j < row.childWidgets.length; j++) {\n                var cell = row.childWidgets[j];\n                cell.updateWidth(table.tableHolder.getCellWidth(cell.columnIndex, cell.cellFormat.columnSpan, tableWidth, isAutoFit));\n            }\n            if (row.rowFormat.gridAfter > 0) {\n                // tslint:disable-next-line:max-line-length\n                this.updateGridAfterWidth(table.tableHolder.getCellWidth(row.childWidgets.length, row.rowFormat.gridAfter, tableWidth, isAutoFit), row);\n            }\n        }\n    };\n    /**\n     * Update grid before width value\n     */\n    TableResizer.prototype.updateGridBeforeWidth = function (width, row) {\n        var rowFormat = row.rowFormat;\n        if (width !== rowFormat.beforeWidth) {\n            rowFormat.beforeWidth = width;\n            if (rowFormat.gridBeforeWidthType === 'Auto') {\n                rowFormat.gridBeforeWidthType = 'Point';\n            }\n            if (rowFormat.gridBeforeWidthType === 'Point') {\n                rowFormat.gridBeforeWidth = rowFormat.beforeWidth;\n            }\n            else {\n                // The value is calculated from the pixel values hence, its converted to percent using method. \n                var ownerWidth = row.ownerTable.getTableClientWidth(row.ownerTable.getOwnerWidth(true));\n                var value = row.ownerTable.convertPointToPercent(rowFormat.beforeWidth, ownerWidth);\n                rowFormat.gridBeforeWidth = value;\n            }\n        }\n    };\n    /**\n     * Update grid after width value\n     */\n    TableResizer.prototype.updateGridAfterWidth = function (width, row) {\n        var rowFormat = row.rowFormat;\n        if (width !== rowFormat.afterWidth) {\n            rowFormat.afterWidth = width;\n        }\n        if (rowFormat.gridAfterWidthType === 'Auto') {\n            rowFormat.gridAfterWidthType = 'Point';\n        }\n        if (rowFormat.gridAfterWidthType === 'Point') {\n            rowFormat.gridAfterWidth = rowFormat.afterWidth;\n        }\n        else {\n            // The value is calculated from the pixel values hence, its converted to percent using method. \n            var ownerWidth = row.ownerTable.getTableClientWidth(row.ownerTable.getOwnerWidth(true));\n            var value = row.ownerTable.convertPointToPercent(rowFormat.afterWidth, ownerWidth);\n            rowFormat.gridAfterWidth = value;\n        }\n    };\n    return TableResizer;\n}());\nexport { TableResizer };\n","import { TextPosition, ImageFormat } from '../selection/selection-helper';\nimport { ParagraphWidget, LineWidget, ElementBox, TextElementBox, Margin, ImageElementBox, BlockWidget, BlockContainer, BodyWidget, TableWidget, TableCellWidget, TableRowWidget, Widget, ListTextElementBox, BookmarkElementBox, HeaderFooterWidget, FieldTextElementBox, TabElementBox } from '../viewer/page';\nimport { WCharacterFormat } from '../format/character-format';\nimport { HelperMethods } from './editor-helper';\nimport { isNullOrUndefined, Browser, classList } from '@syncfusion/ej2-base';\nimport { WParagraphFormat, WSectionFormat, WListFormat, WTableFormat, WRowFormat, WCellFormat, WBorder, WBorders, WTabStop } from '../index';\nimport { WList } from '../list/list';\nimport { WAbstractList } from '../list/abstract-list';\nimport { WListLevel } from '../list/list-level';\nimport { WLevelOverride } from '../list/level-override';\nimport { FieldElementBox } from '../viewer/page';\nimport { WCharacterStyle } from '../format/style';\nimport { TableResizer } from './table-resizer';\nimport { WParagraphStyle } from '../format/style';\n/**\n * Editor module\n */\nvar Editor = /** @class */ (function () {\n    /**\n     * Initialize the editor module\n     * @param  {LayoutViewer} viewer\n     * @private\n     */\n    function Editor(viewer) {\n        var _this = this;\n        this.nodes = [];\n        this.editHyperlinkInternal = false;\n        this.startParagraph = undefined;\n        this.endParagraph = undefined;\n        /**\n         * @private\n         */\n        this.isHandledComplex = false;\n        /**\n         * @private\n         */\n        this.tableResize = undefined;\n        /**\n         * @private\n         */\n        this.tocStyles = {};\n        this.refListNumber = undefined;\n        this.incrementListNumber = -1;\n        this.removedBookmarkElements = [];\n        /**\n         * @private\n         */\n        this.tocBookmarkId = 0;\n        /**\n         * @private\n         */\n        this.copiedData = undefined;\n        this.pageRefFields = {};\n        /**\n         * @private\n         */\n        this.isInsertingTOC = false;\n        /**\n         * @private\n         */\n        this.isBordersAndShadingDialog = false;\n        /**\n         * @private\n         */\n        this.onTextInputInternal = function (event) {\n            if (Browser.isDevice) {\n                var viewer = _this.viewer;\n                var nbsp = new RegExp(String.fromCharCode(160), 'g');\n                var lineFeed = new RegExp(String.fromCharCode(10), 'g');\n                viewer.prefix = viewer.prefix.replace(nbsp, ' ').replace(lineFeed, ' ');\n                var text = viewer.editableDiv.textContent.replace(nbsp, ' ').replace(lineFeed, ' ');\n                var textBoxText = text.substring(2);\n                if (viewer.isCompositionStart && viewer.isCompositionUpdated) {\n                    viewer.isCompositionUpdated = false;\n                    if (!viewer.owner.isReadOnlyMode && viewer.owner.isDocumentLoaded) {\n                        if (viewer.prefix.substring(2) !== textBoxText) {\n                            if (_this.selection.isEmpty) {\n                                // tslint:disable-next-line:max-line-length\n                                _this.selection.start.setPositionForLineWidget(viewer.selection.start.currentWidget, _this.selection.start.offset - (viewer.prefix.length - 2));\n                                _this.handleTextInput(textBoxText);\n                                viewer.prefix = '@' + String.fromCharCode(160) + textBoxText;\n                            }\n                            else {\n                                _this.handleTextInput(textBoxText);\n                                viewer.prefix = '@' + String.fromCharCode(160) + textBoxText;\n                            }\n                        }\n                    }\n                    return;\n                }\n                else if (viewer.isCompositionStart && viewer.isCompositionEnd && viewer.suffix === '') {\n                    if (viewer.prefix.substring(2) !== textBoxText) {\n                        if (_this.selection.isEmpty && viewer.isCompositionStart) {\n                            viewer.isCompositionStart = false;\n                            // tslint:disable-next-line:max-line-length\n                            _this.selection.start.setPositionForLineWidget(viewer.selection.start.currentWidget, _this.selection.start.offset - viewer.prefix.substring(2).length);\n                            _this.selection.retrieveCurrentFormatProperties();\n                            if (viewer.suffix === '' || textBoxText === '') {\n                                _this.handleTextInput(textBoxText);\n                            }\n                        }\n                        else if (!_this.selection.isEmpty) {\n                            viewer.isCompositionStart = false;\n                            _this.handleTextInput(textBoxText);\n                        }\n                    }\n                    else if (textBoxText === '') {\n                        viewer.isCompositionStart = false;\n                        _this.handleBackKey();\n                    }\n                    else if (viewer.prefix.substring(2) === textBoxText && viewer.suffix === '') {\n                        viewer.isCompositionStart = false;\n                        _this.handleTextInput(' ');\n                    }\n                    viewer.isCompositionEnd = false;\n                    return;\n                }\n                else if (viewer.isCompositionEnd || viewer.isCompositionStart && !viewer.compositionUpdated) {\n                    if (textBoxText.length < viewer.prefix.length &&\n                        textBoxText === viewer.prefix.substring(2, viewer.prefix.length - 1) || viewer.editableDiv.innerText.length < 2) {\n                        _this.handleBackKey();\n                        return;\n                    }\n                    else if (viewer.suffix !== '' &&\n                        viewer.editableDiv.innerText[viewer.editableDiv.innerText.length - 1] !== String.fromCharCode(160)) {\n                        viewer.isCompositionStart = false;\n                        //When cursor is placed in between a word and chosen a word from predicted words.\n                        // tslint:disable-next-line:max-line-length\n                        _this.selection.start.setPositionForLineWidget(viewer.selection.start.currentWidget, _this.selection.start.offset - (viewer.prefix.length - 2));\n                        _this.selection.end.setPositionForLineWidget(viewer.selection.end.currentWidget, _this.selection.end.offset + viewer.suffix.length);\n                        //Retrieve the character format properties. Since the selection was changed manually.\n                        _this.selection.retrieveCurrentFormatProperties();\n                        _this.handleTextInput(textBoxText);\n                        return;\n                    }\n                }\n                // tslint:disable-next-line:max-line-length\n                if (text !== '\\r' && text !== '\\b' && text !== '\\u001B' && !viewer.owner.isReadOnlyMode && viewer.isControlPressed === false) {\n                    if (text === '@' || text[0] !== '@' || text === '' || text.length < viewer.prefix.length &&\n                        textBoxText === viewer.prefix.substring(2, viewer.prefix.length - 1)) {\n                        _this.handleBackKey();\n                        if (viewer.editableDiv.innerText.length < 2) {\n                            _this.predictText();\n                        }\n                    }\n                    else if (text.indexOf(viewer.prefix) === 0 && text.length > viewer.prefix.length) {\n                        _this.handleTextInput(text.substring(viewer.prefix.length));\n                    }\n                    else if (text.indexOf(viewer.prefix) === -1 && text[text.length - 1] !== String.fromCharCode(160)\n                        && text[text.length - 1] !== ' ') {\n                        if ((textBoxText.charAt(0).toLowerCase() + textBoxText.slice(1)) === viewer.prefix.substring(2)) {\n                            // tslint:disable-next-line:max-line-length\n                            _this.selection.start.setPositionParagraph(viewer.selection.start.currentWidget, _this.selection.start.offset - (viewer.prefix.length - 2));\n                        }\n                        _this.handleTextInput(textBoxText);\n                    }\n                    else if (text.length !== 2) {\n                        _this.handleTextInput(' ');\n                    }\n                }\n            }\n            else {\n                var text = _this.viewer.editableDiv.innerText;\n                if (text !== String.fromCharCode(160)) {\n                    // tslint:disable-next-line:max-line-length\n                    if (text !== '\\r' && text !== '\\b' && text !== '\\u001B' && !_this.owner.isReadOnlyMode && _this.viewer.isControlPressed === false) {\n                        _this.handleTextInput(text);\n                    }\n                }\n                else {\n                    _this.handleTextInput(' ');\n                }\n                _this.viewer.editableDiv.innerText = '';\n            }\n        };\n        /**\n         * Fired on paste.\n         * @param {ClipboardEvent} event\n         * @private\n         */\n        this.onPaste = function (event) {\n            if (!_this.owner.isReadOnlyMode) {\n                _this.pasteInternal(event);\n            }\n            event.preventDefault();\n        };\n        this.viewer = viewer;\n        this.tableResize = new TableResizer(this.viewer.owner);\n    }\n    Object.defineProperty(Editor.prototype, \"editorHistory\", {\n        get: function () {\n            return this.viewer.owner.editorHistory;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(Editor.prototype, \"selection\", {\n        get: function () {\n            if (this.viewer) {\n                return this.viewer.selection;\n            }\n            return undefined;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(Editor.prototype, \"owner\", {\n        get: function () {\n            return this.viewer.owner;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Editor.prototype.getModuleName = function () {\n        return 'Editor';\n    };\n    Editor.prototype.insertField = function (code, result) {\n        var fieldCode = code;\n        if (isNullOrUndefined(result)) {\n            fieldCode = HelperMethods.trimStart(fieldCode);\n            if (fieldCode.substring(0, 10) === 'MERGEFIELD') {\n                fieldCode = fieldCode.substring(10).trim();\n                var index = fieldCode.indexOf('\\\\*');\n                result = '«' + fieldCode.substring(0, index).trim() + '»';\n            }\n        }\n        var paragraph = new ParagraphWidget();\n        var line = new LineWidget(paragraph);\n        var fieldBegin = new FieldElementBox(0);\n        line.children.push(fieldBegin);\n        var fieldCodeSpan = new TextElementBox();\n        fieldCodeSpan.text = code;\n        line.children.push(fieldCodeSpan);\n        var fieldSeparator = new FieldElementBox(2);\n        fieldSeparator.fieldBegin = fieldBegin;\n        fieldBegin.fieldSeparator = fieldSeparator;\n        line.children.push(fieldSeparator);\n        var fieldResultSpan = new TextElementBox();\n        fieldResultSpan.text = result;\n        line.children.push(fieldResultSpan);\n        var fieldEnd = new FieldElementBox(1);\n        fieldEnd.fieldSeparator = fieldSeparator;\n        fieldEnd.fieldBegin = fieldBegin;\n        fieldBegin.fieldEnd = fieldEnd;\n        fieldSeparator.fieldEnd = fieldEnd;\n        line.children.push(fieldEnd);\n        fieldBegin.line = line;\n        paragraph.childWidgets.push(line);\n        this.viewer.fields.push(fieldBegin);\n        var widgets = [];\n        widgets.push(paragraph);\n        this.pasteContentsInternal(widgets);\n    };\n    /**\n     * To update style for paragraph\n     * @param style - style name\n     * @param clearDirectFormatting - Removes manual formatting (formatting not applied using a style)\n     * from the selected text, to match the formatting of the applied style. Default value is false.\n     */\n    Editor.prototype.applyStyle = function (style, clearDirectFormatting) {\n        clearDirectFormatting = isNullOrUndefined(clearDirectFormatting) ? false : clearDirectFormatting;\n        if (clearDirectFormatting) {\n            this.initComplexHistory('ApplyStyle');\n            this.clearFormatting();\n        }\n        var styleObj = this.viewer.styles.findByName(style);\n        if (styleObj !== undefined) {\n            this.onApplyParagraphFormat('styleName', styleObj, false, true);\n        }\n        else {\n            // tslint:disable-next-line:max-line-length\n            this.viewer.owner.parser.parseStyle(JSON.parse(this.getCompleteStyles()), JSON.parse(this.viewer.preDefinedStyles.get(style)), this.viewer.styles);\n            this.applyStyle(style);\n        }\n        if (this.editorHistory && this.editorHistory.currentHistoryInfo && this.editorHistory.currentHistoryInfo.action === 'ApplyStyle') {\n            this.editorHistory.updateComplexHistory();\n        }\n    };\n    // Public Implementation Starts\n    /**\n     * Moves the selected content in the document editor control to clipboard.\n     */\n    Editor.prototype.cut = function () {\n        if (this.owner.isReadOnlyMode || this.selection.isEmpty) {\n            return;\n        }\n        this.selection.copySelectedContent(true);\n    };\n    /**\n     * Notify content change event\n     * @private\n     */\n    Editor.prototype.fireContentChange = function () {\n        if (this.viewer.owner.isLayoutEnabled && !this.viewer.owner.isShiftingEnabled) {\n            this.viewer.owner.fireContentChange();\n        }\n    };\n    /**\n     * Update physical location for text position\n     * @private\n     */\n    Editor.prototype.updateSelectionTextPosition = function (isSelectionChanged) {\n        this.getOffsetValue(this.selection);\n        this.selection.start.updatePhysicalPosition(true);\n        if (this.selection.isEmpty) {\n            this.selection.end.setPositionInternal(this.selection.start);\n        }\n        else {\n            this.selection.end.updatePhysicalPosition(true);\n        }\n        this.selection.upDownSelectionLength = this.selection.end.location.x;\n        this.selection.fireSelectionChanged(isSelectionChanged);\n    };\n    /**\n     * Predict text\n     * @private\n     */\n    Editor.prototype.predictText = function () {\n        this.viewer.suffix = '';\n        if (this.selection.start.paragraph.isEmpty() || this.selection.start.offset === 0 &&\n            this.selection.start.currentWidget.isFirstLine() || this.selection.end.offset === 0 &&\n            this.selection.end.currentWidget.isFirstLine()) {\n            this.viewer.prefix = '';\n        }\n        else {\n            this.getPrefixAndSuffix();\n        }\n        this.viewer.prefix = '@' + String.fromCharCode(160) + this.viewer.prefix; // &nbsp;\n        this.viewer.editableDiv.innerText = this.viewer.prefix;\n        this.viewer.selection.setEditableDivCaretPosition(this.viewer.prefix.length);\n    };\n    /**\n     * Gets prefix and suffix.\n     * @private\n     */\n    /* tslint:disable:max-func-body-length */\n    Editor.prototype.getPrefixAndSuffix = function () {\n        var viewer = this.viewer;\n        if (this.selection.text !== '') {\n            viewer.prefix = '';\n            return;\n        }\n        else {\n            var startIndex = 0;\n            var inlineInfo = this.selection.start.currentWidget.getInline(this.selection.start.offset, startIndex);\n            var inline = inlineInfo.element;\n            startIndex = inlineInfo.index;\n            if (inline !== undefined) {\n                var boxInfo = this.selection.getElementBoxInternal(inline, startIndex);\n                var box = boxInfo.element;\n                startIndex = boxInfo.index;\n                var spaceIndex = 0;\n                if (!isNullOrUndefined(box)) {\n                    var prefixAdded = false;\n                    if (box instanceof TextElementBox && startIndex > 0 && box.line.isFirstLine()) {\n                        viewer.prefix = '';\n                    }\n                    if (!(inline instanceof TextElementBox)) {\n                        inline = this.selection.getPreviousTextElement(inline);\n                    }\n                    /* tslint:disable:no-conditional-assignment */\n                    while ((spaceIndex = viewer.prefix.lastIndexOf(' ')) < 0 && inline instanceof TextElementBox) {\n                        if (inline.previousNode instanceof TextElementBox && viewer.prefix.indexOf(' ') === -1) {\n                            if (!prefixAdded) {\n                                viewer.prefix = inline.text.substring(0, startIndex);\n                                prefixAdded = true;\n                            }\n                            else {\n                                viewer.prefix = inline.text + viewer.prefix;\n                            }\n                            inline = inline.previousNode;\n                            // If the line has no elements then break the loop to avoid the exception.\n                            if (inline instanceof ListTextElementBox) {\n                                break;\n                            }\n                            if (!(inline instanceof TextElementBox)) {\n                                inline = this.selection.getPreviousTextElement(inline);\n                            }\n                        }\n                        else if (!(inline.previousNode instanceof TextElementBox)) {\n                            if (!prefixAdded) {\n                                viewer.prefix = inline.text.substring(0, startIndex);\n                                prefixAdded = true;\n                            }\n                            else {\n                                viewer.prefix = inline.text + viewer.prefix;\n                            }\n                            break;\n                        }\n                    }\n                    if (!(viewer.prefix.length > 1 && viewer.prefix[viewer.prefix.length - 1] === ' ' &&\n                        viewer.prefix[viewer.prefix.length - 2] === '.')) {\n                        spaceIndex = viewer.prefix.lastIndexOf(' ');\n                    }\n                    else {\n                        spaceIndex = -1;\n                        viewer.prefix = '';\n                    }\n                    viewer.prefix = spaceIndex < 0 ? viewer.prefix : viewer.prefix.substring(spaceIndex);\n                    if (viewer.prefix.indexOf(' ') === 0 && viewer.prefix.length >= 1) {\n                        viewer.prefix = viewer.prefix.substring(1);\n                    }\n                    // suffix text prediction\n                    var endIndex = 0;\n                    var endInlineInfo = this.selection.end.currentWidget.getInline(this.selection.end.offset, endIndex);\n                    var endInline = endInlineInfo.element;\n                    endIndex = endInlineInfo.index;\n                    boxInfo = this.selection.getElementBoxInternal(endInline, endIndex);\n                    box = boxInfo.element;\n                    endIndex = boxInfo.index;\n                    if (box) {\n                        var suffixAdded = false;\n                        if (box instanceof TextElementBox && endIndex < box.length) {\n                            viewer.suffix = '';\n                        }\n                        // boxIndex = renderedElements.get(endInline).indexOf(box);\n                        while ((spaceIndex = viewer.suffix.indexOf(' ')) < 0 && endInline instanceof TextElementBox) {\n                            if (endInline.nextNode instanceof TextElementBox && viewer.suffix.indexOf(' ') === -1) {\n                                if (!suffixAdded) {\n                                    viewer.suffix = box.text.substring(endIndex);\n                                    suffixAdded = true;\n                                }\n                                else {\n                                    viewer.suffix = viewer.suffix + endInline.text;\n                                }\n                                endInline = endInline.nextNode;\n                            }\n                            else if (!(endInline.nextNode instanceof TextElementBox)) {\n                                if (!suffixAdded) {\n                                    viewer.suffix = box.text.substring(endIndex);\n                                    suffixAdded = true;\n                                }\n                                else {\n                                    viewer.suffix = viewer.suffix + endInline.text;\n                                }\n                                break;\n                            }\n                        }\n                        spaceIndex = viewer.suffix.indexOf(' ');\n                        viewer.suffix = spaceIndex < 0 ? viewer.suffix : viewer.suffix.substring(0, spaceIndex);\n                    }\n                }\n            }\n        }\n    };\n    /**\n     * key action\n     * @private\n     */\n    // tslint:disable:max-func-body-length\n    Editor.prototype.onKeyDownInternal = function (event, ctrl, shift, alt) {\n        var key = event.which || event.keyCode;\n        if (ctrl && !shift && !alt) {\n            this.viewer.isControlPressed = true;\n            switch (key) {\n                case 9:\n                    event.preventDefault();\n                    if (this.owner.acceptTab) {\n                        this.selection.handleTabKey(false, false);\n                    }\n                    break;\n                case 13:\n                    event.preventDefault();\n                    this.insertPageBreak();\n                    break;\n                case 48:\n                    event.preventDefault();\n                    this.onApplyParagraphFormat('beforeSpacing', 0, false, false);\n                    break;\n                case 49:\n                    event.preventDefault();\n                    if (!this.owner.isReadOnlyMode) {\n                        this.onApplyParagraphFormat('lineSpacing', 1, false, false);\n                    }\n                    break;\n                case 50:\n                    event.preventDefault();\n                    if (!this.owner.isReadOnlyMode) {\n                        this.onApplyParagraphFormat('lineSpacing', 2, false, false);\n                    }\n                    break;\n                case 53:\n                    event.preventDefault();\n                    if (!this.owner.isReadOnlyMode) {\n                        this.onApplyParagraphFormat('lineSpacing', 1.5, false, false);\n                    }\n                    break;\n                case 66:\n                    event.preventDefault();\n                    if (!this.owner.isReadOnlyMode) {\n                        this.toggleBold();\n                    }\n                    break;\n                case 68:\n                    event.preventDefault();\n                    if (!this.owner.isReadOnlyMode && this.owner.fontDialogModule) {\n                        this.owner.fontDialogModule.showFontDialog();\n                    }\n                    break;\n                case 69:\n                    if (!this.owner.isReadOnlyMode) {\n                        this.toggleTextAlignment('Center');\n                    }\n                    event.preventDefault();\n                    break;\n                case 72:\n                    event.preventDefault();\n                    if (!this.owner.isReadOnly && this.owner.optionsPaneModule) {\n                        this.owner.optionsPaneModule.isReplace = true;\n                        this.owner.optionsPaneModule.showHideOptionsPane(true);\n                    }\n                    break;\n                case 73:\n                    event.preventDefault();\n                    if (!this.owner.isReadOnlyMode) {\n                        this.toggleItalic();\n                    }\n                    break;\n                case 74:\n                    if (!this.owner.isReadOnlyMode) {\n                        this.toggleTextAlignment('Justify');\n                    }\n                    event.preventDefault();\n                    break;\n                case 75:\n                    event.preventDefault();\n                    if (this.owner.hyperlinkDialogModule && !this.owner.isReadOnlyMode) {\n                        this.owner.hyperlinkDialogModule.show();\n                    }\n                    break;\n                case 76:\n                    if (!this.owner.isReadOnlyMode) {\n                        this.toggleTextAlignment('Left');\n                    }\n                    event.preventDefault();\n                    break;\n                case 77:\n                    if (!this.owner.isReadOnlyMode) {\n                        this.owner.selection.increaseIndent();\n                    }\n                    event.preventDefault();\n                    break;\n                case 78:\n                    event.preventDefault();\n                    if (!this.owner.isReadOnlyMode) {\n                        this.owner.openBlank();\n                    }\n                    break;\n                case 82:\n                    if (!this.owner.isReadOnlyMode) {\n                        this.toggleTextAlignment('Right');\n                    }\n                    event.preventDefault();\n                    break;\n                case 85:\n                    event.preventDefault();\n                    if (!this.owner.isReadOnlyMode) {\n                        this.owner.selection.toggleUnderline('Single');\n                    }\n                    break;\n                case 88:\n                    event.preventDefault();\n                    if (!this.owner.isReadOnlyMode) {\n                        this.owner.editor.cut();\n                    }\n                    break;\n                case 89:\n                    if (this.owner.enableEditorHistory) {\n                        this.editorHistory.redo();\n                        event.preventDefault();\n                    }\n                    break;\n                case 90:\n                    if (this.owner.enableEditorHistory) {\n                        this.editorHistory.undo();\n                        event.preventDefault();\n                    }\n                    break;\n                case 219:\n                    event.preventDefault();\n                    if (!this.owner.isReadOnlyMode) {\n                        this.onApplyCharacterFormat('fontSize', 'decrement', true);\n                    }\n                    break;\n                case 221:\n                    event.preventDefault();\n                    if (!this.owner.isReadOnlyMode) {\n                        this.onApplyCharacterFormat('fontSize', 'increment', true);\n                    }\n                    break;\n                case 187:\n                    event.preventDefault();\n                    if (!this.owner.isReadOnlyMode) {\n                        this.toggleBaselineAlignment('Subscript');\n                    }\n                    break;\n            }\n        }\n        else if (shift && !ctrl && !alt) {\n            switch (key) {\n                case 9:\n                    event.preventDefault();\n                    if (this.owner.acceptTab) {\n                        this.selection.handleTabKey(false, true);\n                    }\n                    break;\n                case 13:\n                    this.handleShiftEnter();\n                    event.preventDefault();\n                    break;\n            }\n        }\n        else if (shift && ctrl && !alt) {\n            switch (key) {\n                case 68:\n                    if (!this.owner.isReadOnlyMode) {\n                        this.owner.selection.toggleUnderline('Double');\n                    }\n                    break;\n                case 77:\n                    if (!this.owner.isReadOnlyMode) {\n                        this.owner.selection.decreaseIndent();\n                    }\n                    event.preventDefault();\n                    break;\n                case 188:\n                    event.preventDefault();\n                    if (!this.owner.isReadOnlyMode) {\n                        this.onApplyCharacterFormat('fontSize', 'decrement', true);\n                    }\n                    break;\n                case 190:\n                    event.preventDefault();\n                    if (!this.owner.isReadOnlyMode) {\n                        this.onApplyCharacterFormat('fontSize', 'increment', true);\n                    }\n                    break;\n                case 187:\n                    event.preventDefault();\n                    if (!this.owner.isReadOnlyMode) {\n                        this.toggleBaselineAlignment('Superscript');\n                    }\n            }\n        }\n        else if (!shift && ctrl && alt) {\n            switch (key) {\n                case 72:\n                    event.preventDefault();\n                    if (!this.owner.isReadOnlyMode && this.owner.isDocumentLoaded) {\n                        this.toggleHighlightColor();\n                    }\n                    break;\n            }\n        }\n        else {\n            switch (key) {\n                case 8:\n                    event.preventDefault();\n                    this.handleBackKey();\n                    break;\n                case 9:\n                    event.preventDefault();\n                    if (this.owner.acceptTab) {\n                        this.selection.handleTabKey(true, false);\n                    }\n                    break;\n                case 13:\n                    event.preventDefault();\n                    this.handleEnterKey();\n                    break;\n                case 46:\n                    this.handleDelete();\n                    event.preventDefault();\n                    break;\n            }\n        }\n    };\n    /**\n     * @private\n     */\n    Editor.prototype.handleShiftEnter = function () {\n        if (!this.owner.isReadOnlyMode) {\n            this.handleTextInput('\\v');\n        }\n        this.selection.checkForCursorVisibility();\n    };\n    /**\n     * Handles back key.\n     * @private\n     */\n    Editor.prototype.handleBackKey = function () {\n        if (!this.owner.isReadOnlyMode) {\n            this.owner.editorModule.onBackSpace();\n        }\n        this.selection.checkForCursorVisibility();\n    };\n    /**\n     * Handles delete\n     * @private\n     */\n    Editor.prototype.handleDelete = function () {\n        if (!this.owner.isReadOnlyMode) {\n            this.owner.editorModule.onDelete();\n        }\n        this.selection.checkForCursorVisibility();\n    };\n    /**\n     * Handles enter key.\n     * @private\n     */\n    Editor.prototype.handleEnterKey = function () {\n        if (!this.owner.isReadOnlyMode) {\n            if (Browser.isDevice) {\n                this.viewer.isCompositionStart = false;\n            }\n            this.owner.editorModule.onEnter();\n        }\n        this.selection.checkForCursorVisibility();\n    };\n    /**\n     * @private\n     */\n    Editor.prototype.handleTextInput = function (text) {\n        var _this = this;\n        if (!this.owner.isReadOnlyMode) {\n            if (this.animationTimer) {\n                clearTimeout(this.animationTimer);\n            }\n            classList(this.selection.caret, [], ['e-de-cursor-animation']);\n            this.owner.editorModule.insertText(text, false);\n            /* tslint:disable:align */\n            this.animationTimer = setTimeout(function () {\n                if (_this.animationTimer) {\n                    clearTimeout(_this.animationTimer);\n                }\n                if (_this.selection && _this.selection.caret) {\n                    classList(_this.selection.caret, ['e-de-cursor-animation'], []);\n                }\n            }, 600);\n        }\n        this.selection.checkForCursorVisibility();\n    };\n    /**\n     * Copies to format.\n     * @param  {WCharacterFormat} format\n     * @private\n     */\n    Editor.prototype.copyInsertFormat = function (format, copy) {\n        var insertFormat = new WCharacterFormat();\n        var sFormat = this.selection.characterFormat;\n        if (copy) {\n            insertFormat.copyFormat(format);\n        }\n        if (!isNullOrUndefined(sFormat.bold) && format.bold !== sFormat.bold) {\n            insertFormat.bold = sFormat.bold;\n        }\n        if (!isNullOrUndefined(sFormat.italic) && format.italic !== sFormat.italic) {\n            insertFormat.italic = sFormat.italic;\n        }\n        if (sFormat.fontSize > 0 && format.fontSize !== sFormat.fontSize) {\n            insertFormat.fontSize = sFormat.fontSize;\n        }\n        if (!isNullOrUndefined(sFormat.fontFamily) && format.fontFamily !== sFormat.fontFamily) {\n            insertFormat.fontFamily = sFormat.fontFamily;\n        }\n        if (!isNullOrUndefined(sFormat.highlightColor) && format.highlightColor !== sFormat.highlightColor) {\n            insertFormat.highlightColor = sFormat.highlightColor;\n        }\n        if (!isNullOrUndefined(sFormat.baselineAlignment) && format.baselineAlignment !== sFormat.baselineAlignment) {\n            insertFormat.baselineAlignment = sFormat.baselineAlignment;\n        }\n        if (!isNullOrUndefined(sFormat.fontColor) && format.fontColor !== sFormat.fontColor) {\n            insertFormat.fontColor = sFormat.fontColor;\n        }\n        if (!isNullOrUndefined(sFormat.underline) && format.underline !== sFormat.underline) {\n            insertFormat.underline = sFormat.underline;\n        }\n        if (!isNullOrUndefined(sFormat.strikethrough) && format.strikethrough !== sFormat.strikethrough) {\n            insertFormat.strikethrough = sFormat.strikethrough;\n        }\n        return insertFormat;\n    };\n    /**\n     * Inserts the specified text at cursor position\n     * @param  {string} text\n     * @param  {boolean} isReplace\n     * @private\n     */\n    //tslint:disable: max-func-body-length\n    Editor.prototype.insertText = function (text, isReplace) {\n        var selection = this.viewer.selection;\n        var insertPosition;\n        var isRemoved = true;\n        this.isListTextSelected();\n        this.initHistory('Insert');\n        var paragraphInfo = this.getParagraphInfo(selection.start);\n        this.viewer.selection.editPosition = this.getHierarchicalIndex(paragraphInfo.paragraph, paragraphInfo.offset.toString());\n        if ((!selection.isEmpty && !this.viewer.selection.isImageSelected) ||\n            this.viewer.isListTextSelected && selection.contextType === 'List') {\n            selection.isSkipLayouting = true;\n            selection.skipFormatRetrieval = true;\n            isRemoved = this.removeSelectedContents(selection);\n            selection.skipFormatRetrieval = false;\n            selection.isSkipLayouting = false;\n        }\n        paragraphInfo = this.getParagraphInfo(selection.start);\n        if (isRemoved) {\n            selection.owner.isShiftingEnabled = true;\n            this.updateInsertPosition();\n            insertPosition = selection.start;\n            if (insertPosition.paragraph.isEmpty()) {\n                var span = new TextElementBox();\n                var insertFormat = this.copyInsertFormat(insertPosition.paragraph.characterFormat, true);\n                span.characterFormat.copyFormat(insertFormat);\n                span.text = text;\n                span.line = insertPosition.paragraph.childWidgets[0];\n                span.margin = new Margin(0, 0, 0, 0);\n                span.line.children.push(span);\n                if ((insertPosition.paragraph.paragraphFormat.textAlignment === 'Center'\n                    || insertPosition.paragraph.paragraphFormat.textAlignment === 'Right') &&\n                    insertPosition.paragraph.paragraphFormat.listFormat.listId === -1) {\n                    insertPosition.paragraph.x = this.viewer.clientActiveArea.x;\n                }\n                this.viewer.layout.reLayoutParagraph(insertPosition.paragraph, 0, 0);\n            }\n            else {\n                var indexInInline = 0;\n                var inlineObj = insertPosition.currentWidget.getInline(insertPosition.offset, indexInInline);\n                var inline = inlineObj.element;\n                indexInInline = inlineObj.index;\n                // Todo: compare selection format\n                var insertFormat = this.copyInsertFormat(inline.characterFormat, true);\n                if (insertFormat.isSameFormat(inline.characterFormat)) {\n                    this.insertTextInline(inline, selection, text, indexInInline);\n                }\n                else {\n                    var tempSpan = new TextElementBox();\n                    tempSpan.text = text;\n                    tempSpan.line = inline.line;\n                    tempSpan.characterFormat.copyFormat(insertFormat);\n                    var insertIndex = inline.indexInOwner;\n                    if (indexInInline === inline.length) {\n                        inline.line.children.splice(insertIndex + 1, 0, tempSpan);\n                    }\n                    else if (indexInInline === 0) {\n                        inline.line.children.splice(insertIndex, 0, tempSpan);\n                    }\n                    else {\n                        if (inline instanceof TextElementBox) {\n                            var splittedSpan = new TextElementBox();\n                            splittedSpan.line = inline.line;\n                            splittedSpan.characterFormat.copyFormat(inline.characterFormat);\n                            splittedSpan.text = inline.text.substring(indexInInline);\n                            inline.text = inline.text.slice(0, indexInInline);\n                            inline.line.children.splice(insertIndex + 1, 0, splittedSpan);\n                        }\n                        inline.line.children.splice(insertIndex + 1, 0, tempSpan);\n                    }\n                    this.viewer.layout.reLayoutParagraph(insertPosition.paragraph, inline.line.indexInOwner, 0);\n                }\n            }\n            this.setPositionParagraph(paragraphInfo.paragraph, paragraphInfo.offset + text.length, true);\n            this.updateEndPosition();\n            // tslint:disable-next-line:max-line-length\n            if (!isNullOrUndefined(this.editorHistory) && !isNullOrUndefined(this.editorHistory.currentHistoryInfo) && (this.editorHistory.currentHistoryInfo.action === 'ListSelect') &&\n                this.viewer.isListTextSelected) {\n                this.editorHistory.updateHistory();\n                this.editorHistory.updateComplexHistory();\n            }\n            // if (!isNullOrUndefined(selection.currentHistoryInfo) && (selection.currentHistoryInfo.action === 'MultiSelection')) {\n            //     this.updateComplexHistory();\n            // } else {           \n            this.reLayout(selection);\n            // }\n        }\n        else {\n            // selection.selectContent(selection.start, true);\n        }\n        // insertFormat.destroy();\n        if (!isReplace && isRemoved && (text === ' ' || text === '\\t' || text === '\\v')) {\n            var hyperlinkField = selection.getHyperlinkField();\n            var isSelectionOnHyperlink = !isNullOrUndefined(hyperlinkField);\n            var isList = false;\n            if (!(text === '\\v')) {\n                isList = this.checkAndConvertList(selection, text === '\\t');\n            }\n            if (isSelectionOnHyperlink) {\n                return;\n            }\n            if (!isList) {\n                //Checks if the previous text is URL, then it is auto formatted to hyperlink.\n                this.checkAndConvertToHyperlink(selection, false);\n            }\n        }\n    };\n    /**\n     * Insert Section break at cursor position\n     */\n    Editor.prototype.insertSectionBreak = function () {\n        var selection = this.viewer.selection;\n        if (isNullOrUndefined(selection) || this.owner.isReadOnlyMode || selection.start.paragraph.isInHeaderFooter) {\n            return;\n        }\n        this.initHistory('SectionBreak');\n        if (!selection.isEmpty) {\n            selection.selectContent(selection.isForward ? selection.start : selection.end, true);\n        }\n        this.viewer.owner.isShiftingEnabled = true;\n        this.updateInsertPosition();\n        this.insertSection(selection, true);\n        this.updateEndPosition();\n        this.reLayout(selection, true);\n    };\n    /**\n     * @private\n     */\n    Editor.prototype.insertSection = function (selection, selectFirstBlock) {\n        var newSectionFormat = this.selection.start.paragraph.bodyWidget.sectionFormat.cloneFormat();\n        var lastBlock;\n        var firstBlock;\n        if (selection.start.paragraph.isInsideTable) {\n            var table = this.viewer.layout.getParentTable(selection.start.paragraph);\n            table = table.combineWidget(this.viewer);\n            var insertBefore = false;\n            if (selection.start.paragraph.associatedCell.rowIndex === 0) {\n                insertBefore = true;\n            }\n            var newParagraph = new ParagraphWidget();\n            var previousBlock = table.previousRenderedWidget;\n            if (!insertBefore) {\n                lastBlock = this.splitTable(table, selection.start.paragraph.associatedCell.ownerRow);\n                this.viewer.layout.layoutBodyWidgetCollection(lastBlock.index, lastBlock.containerWidget, lastBlock, false);\n                lastBlock = lastBlock.getSplitWidgets().pop();\n            }\n            else {\n                lastBlock = table;\n            }\n            var insertIndex = 0;\n            if ((isNullOrUndefined(previousBlock) || !previousBlock.bodyWidget.equals(lastBlock.bodyWidget)) && insertBefore) {\n                insertIndex = 0;\n                newParagraph.index = 0;\n            }\n            else {\n                insertIndex = lastBlock.indexInOwner + 1;\n                newParagraph.index = lastBlock.index + 1;\n            }\n            lastBlock.containerWidget.childWidgets.splice(insertIndex, 0, newParagraph);\n            newParagraph.containerWidget = lastBlock.containerWidget;\n            this.updateNextBlocksIndex(newParagraph, true);\n            this.viewer.layout.layoutBodyWidgetCollection(newParagraph.index, newParagraph.containerWidget, newParagraph, false);\n            lastBlock = newParagraph;\n        }\n        else {\n            var paragraphInfo = this.getParagraphInfo(selection.start);\n            var selectionStart = this.getHierarchicalIndex(paragraphInfo.paragraph, paragraphInfo.offset.toString());\n            //Split Paragraph\n            this.splitParagraphInternal(selection, selection.start.paragraph, selection.start.currentWidget, selection.start.offset);\n            this.setPositionForCurrentIndex(selection.start, selectionStart);\n            lastBlock = selection.start.paragraph.getSplitWidgets().pop();\n        }\n        //Split body widget\n        firstBlock = this.splitBodyWidget(lastBlock.bodyWidget, newSectionFormat, lastBlock).firstChild;\n        if (firstBlock instanceof TableWidget) {\n            firstBlock.updateRowIndex(0);\n        }\n        this.viewer.layout.layoutBodyWidgetCollection(firstBlock.index, firstBlock.containerWidget, firstBlock, false);\n        if (firstBlock instanceof TableWidget) {\n            firstBlock = selection.getFirstParagraphInFirstCell(firstBlock);\n        }\n        if (selectFirstBlock) {\n            selection.selectParagraph(firstBlock, true);\n        }\n        return firstBlock;\n    };\n    Editor.prototype.splitBodyWidget = function (bodyWidget, sectionFormat, startBlock) {\n        var sectionIndex;\n        //Move blocks after the start block to next body widget\n        var newBodyWidget = this.viewer.layout.moveBlocksToNextPage(startBlock);\n        //Update SectionIndex for splitted body widget\n        this.updateSectionIndex(sectionFormat, newBodyWidget, true);\n        // insert New header footer widget in to section index \n        this.insertRemoveHeaderFooter(newBodyWidget.sectionIndex, true);\n        //update header and footer for splitted widget\n        this.viewer.layout.layoutHeaderFooter(newBodyWidget, this.viewer, newBodyWidget.page);\n        //Update Child item index from 0 for new Section\n        this.updateBlockIndex(0, newBodyWidget.firstChild);\n        // Start sinfting from first block\n        this.viewer.updateClientArea(newBodyWidget.sectionFormat, newBodyWidget.page);\n        return newBodyWidget;\n    };\n    Editor.prototype.insertRemoveHeaderFooter = function (sectionIndex, insert) {\n        if (this.viewer.headersFooters[sectionIndex]) {\n            // Need to handle further\n        }\n        else {\n            this.viewer.headersFooters[sectionIndex] = {};\n        }\n    };\n    Editor.prototype.updateBlockIndex = function (blockIndex, block) {\n        var blocks;\n        var sectionIndex = block.bodyWidget.sectionIndex;\n        do {\n            blocks = block.getSplitWidgets();\n            for (var i = 0; i < blocks.length; i++) {\n                blocks[i].index = blockIndex;\n            }\n            blockIndex++;\n            block = blocks.pop().nextRenderedWidget;\n        } while (!isNullOrUndefined(block) && block.bodyWidget.sectionIndex === sectionIndex);\n    };\n    Editor.prototype.updateSectionIndex = function (sectionFormat, startBodyWidget, increaseIndex) {\n        var currentSectionIndex = startBodyWidget.sectionIndex;\n        var blockIndex = 0;\n        var bodyWidget = startBodyWidget;\n        do {\n            if (bodyWidget.index === currentSectionIndex && sectionFormat) {\n                bodyWidget.sectionFormat = sectionFormat;\n            }\n            if (increaseIndex) {\n                bodyWidget.index++;\n            }\n            else {\n                bodyWidget.index--;\n            }\n            bodyWidget = bodyWidget.nextRenderedWidget;\n        } while (bodyWidget);\n    };\n    //Auto convert List\n    Editor.prototype.checkAndConvertList = function (selection, isTab) {\n        var list = selection.paragraphFormat.getList();\n        if (!isNullOrUndefined(list)) {\n            return false;\n        }\n        var convertList = false;\n        var isLeadingZero = false;\n        var indexInInline = 0;\n        var inlineObj = selection.start.currentWidget.getInline(selection.start.offset - 1, indexInInline);\n        var inline = inlineObj.element;\n        indexInInline = inlineObj.index;\n        if (!(inline instanceof TextElementBox)) {\n            return false;\n        }\n        var span = inline;\n        var text = span.text.substring(0, indexInInline);\n        var tabValue = 0;\n        var length = 0;\n        while (!isNullOrUndefined(span.previousNode)) {\n            // tslint:disable-next-line:max-line-length\n            if (span.previousNode instanceof TextElementBox && (span.previousNode.text === '\\t' || span.previousNode.text.trim().length === 0)) {\n                (span.previousNode.text === '\\t') ? tabValue += 36 : length = span.previousNode.text.length * 2.5;\n                span = span.previousNode;\n                continue;\n            }\n            return false;\n        }\n        span = inline;\n        var index = 0;\n        var tabIndex = text.lastIndexOf('\\t');\n        index = (tabIndex >= 0) ? tabIndex + 1 : text.lastIndexOf(' ') + 1;\n        while (span.previousNode instanceof TextElementBox && index === 0) {\n            span = span.previousNode;\n            var previousText = span.text;\n            tabIndex = previousText.lastIndexOf('\\t');\n            index = (tabIndex >= 0) ? tabIndex + 1 : previousText.lastIndexOf(' ') + 1;\n            text = span.text + text;\n            text = text.substring(index);\n        }\n        text = HelperMethods.trimStart(text);\n        var numberFormat = text.substring(1, 2);\n        var listLevelPattern = this.getListLevelPattern(text.substring(0, 1));\n        if (listLevelPattern !== 'None' && this.checkNumberFormat(numberFormat, listLevelPattern === 'Bullet', text)) {\n            convertList = true;\n        }\n        else if (this.checkLeadingZero(text)) {\n            isLeadingZero = true;\n            convertList = true;\n        }\n        if (convertList) {\n            this.initComplexHistory('AutoList');\n            var paragraph = inline.paragraph;\n            // tslint:disable-next-line:max-line-length\n            selection.start.setPositionParagraph(paragraph.childWidgets[0], paragraph.childWidgets[0].getOffset(inline, indexInInline + 1));\n            selection.end.setPositionParagraph(paragraph.childWidgets[0], 0);\n            this.initHistory('Delete');\n            this.deleteSelectedContents(selection, false);\n            this.reLayout(selection, false);\n            var followCharacter = isTab ? 'Tab' : 'Space';\n            numberFormat = !isLeadingZero ? '%1' + numberFormat : '%1' + text.substring(text.length - 1, text.length);\n            var leadingZeroText = text.substring(text.length - 3, text.length - 1);\n            listLevelPattern = !isLeadingZero ? listLevelPattern : this.getListLevelPattern(leadingZeroText);\n            var listLevel = new WListLevel(undefined);\n            listLevel.listLevelPattern = listLevelPattern;\n            if (listLevelPattern === 'Bullet') {\n                if (text === '*') {\n                    listLevel.numberFormat = '\\uf0b7';\n                    listLevel.characterFormat.fontFamily = 'Symbol';\n                }\n                else if (text === '-') {\n                    listLevel.numberFormat = '-';\n                }\n            }\n            else {\n                listLevel.numberFormat = numberFormat;\n            }\n            listLevel.followCharacter = followCharacter;\n            var leftIndent = selection.paragraphFormat.leftIndent;\n            if (tabValue !== 0 || length !== 0) {\n                listLevel.paragraphFormat.leftIndent = leftIndent + 18 + tabValue + length;\n            }\n            else if (indexInInline > 2) {\n                listLevel.paragraphFormat.leftIndent = leftIndent + (indexInInline - 2) * 2.5 + 18;\n            }\n            else if (leftIndent > 0) {\n                listLevel.paragraphFormat.leftIndent = leftIndent + 18;\n            }\n            else {\n                listLevel.paragraphFormat.leftIndent = 36;\n            }\n            listLevel.paragraphFormat.firstLineIndent = -18;\n            if ((!isLeadingZero && text.substring(0, 1) === '0') || leadingZeroText === '00') {\n                listLevel.startAt = 0;\n            }\n            else {\n                listLevel.startAt = 1;\n            }\n            this.autoConvertList(selection, listLevel);\n            if (this.editorHistory && !isNullOrUndefined(this.editorHistory.currentHistoryInfo)) {\n                this.editorHistory.updateComplexHistory();\n            }\n            else {\n                this.reLayout(selection);\n            }\n        }\n        return convertList;\n    };\n    Editor.prototype.getListLevelPattern = function (value) {\n        switch (value) {\n            case '0':\n            case '1':\n                return 'Arabic';\n            case 'I':\n                return 'UpRoman';\n            case 'i':\n                return 'LowRoman';\n            case 'A':\n                return 'UpLetter';\n            case 'a':\n                return 'LowLetter';\n            case '*':\n            case '-':\n                return 'Bullet';\n            case '00':\n            case '01':\n                return 'LeadingZero';\n            default:\n                return 'None';\n        }\n    };\n    Editor.prototype.autoConvertList = function (selection, listLevel) {\n        var start = selection.start;\n        if (!selection.isForward) {\n            start = selection.end;\n        }\n        var newList = new WList();\n        if (this.viewer.lists.length > 0) {\n            newList.listId = this.viewer.lists[this.viewer.lists.length - 1].listId + 1;\n        }\n        else {\n            newList.listId = 0;\n        }\n        var newAbstractList = new WAbstractList();\n        var layout = this.viewer;\n        if (layout.abstractLists.length > 0) {\n            newAbstractList.abstractListId = layout.abstractLists[layout.abstractLists.length - 1].abstractListId + 1;\n        }\n        else {\n            newAbstractList.abstractListId = 0;\n        }\n        newList.abstractListId = newAbstractList.abstractListId;\n        layout.abstractLists.push(newAbstractList);\n        newAbstractList.levels.push(listLevel);\n        listLevel.ownerBase = newAbstractList;\n        selection.paragraphFormat.setList(newList);\n        selection.paragraphFormat.listLevelNumber = 0;\n    };\n    Editor.prototype.checkNumberFormat = function (numberFormat, isBullet, text) {\n        if (isBullet) {\n            return numberFormat === '';\n        }\n        else {\n            var index = text.indexOf(numberFormat);\n            return (numberFormat === '.' || numberFormat === ')'\n                || numberFormat === '>' || numberFormat === '-') && text.substring(index, text.length - 1) === '';\n        }\n    };\n    Editor.prototype.checkLeadingZero = function (text) {\n        var j;\n        var isZero = false;\n        for (var i = 0; i <= text.length - 1; i++) {\n            if (text.charAt(i) === '0') {\n                isZero = true;\n                continue;\n            }\n            j = i;\n            break;\n        }\n        var numberFormat = undefined;\n        if (text.charAt(j) === '1') {\n            numberFormat = text.charAt(j + 1);\n        }\n        else {\n            numberFormat = text.charAt(j);\n        }\n        return isZero && this.checkNumberFormat(numberFormat, false, text);\n    };\n    Editor.prototype.getPageFromBlockWidget = function (block) {\n        var page = undefined;\n        if (block.containerWidget instanceof BodyWidget) {\n            page = block.containerWidget.page;\n        }\n        else if (block.containerWidget instanceof HeaderFooterWidget) {\n            page = block.containerWidget.page;\n        }\n        else if (block.containerWidget instanceof TableCellWidget) {\n            page = block.containerWidget.bodyWidget.page;\n        }\n        return page;\n    };\n    /**\n     * @private\n     */\n    Editor.prototype.insertTextInline = function (element, selection, text, index) {\n        if (element instanceof TextElementBox) {\n            element.text = HelperMethods.insert(element.text, index, text);\n            var paragraph = element.line.paragraph;\n            var lineIndex = paragraph.childWidgets.indexOf(element.line);\n            var elementIndex = element.line.children.indexOf(element);\n            this.viewer.layout.reLayoutParagraph(paragraph, lineIndex, elementIndex);\n        }\n        else if (element instanceof ImageElementBox) {\n            this.insertImageText(element, selection, text, index);\n        }\n        else if (element instanceof FieldElementBox) {\n            if (element.fieldType === 0) {\n                this.insertFieldBeginText(element, selection, text, index);\n            }\n            else if (element.fieldType === 2) {\n                this.insertFieldSeparatorText(element, selection, text, index);\n            }\n            else {\n                this.insertFieldEndText(element, selection, text, index);\n            }\n        }\n        else if (element instanceof BookmarkElementBox) {\n            this.insertBookMarkText(element, selection, text, index);\n        }\n    };\n    Editor.prototype.insertFieldBeginText = function (fieldBegin, selection, text, index) {\n        var spanObj = new TextElementBox();\n        spanObj.text = text;\n        var lineIndex = fieldBegin.line.paragraph.childWidgets.indexOf(fieldBegin.line);\n        var spanIndex = fieldBegin.line.children.indexOf(fieldBegin);\n        spanObj.characterFormat.copyFormat(fieldBegin.characterFormat);\n        fieldBegin.line.children.splice(spanIndex, 0, spanObj);\n        spanObj.line = fieldBegin.line;\n        this.viewer.layout.reLayoutParagraph(fieldBegin.line.paragraph, lineIndex, spanIndex);\n    };\n    Editor.prototype.insertBookMarkText = function (element, selection, text, index) {\n        var spanObj = new TextElementBox();\n        spanObj.text = text;\n        var lineIndex = element.line.paragraph.childWidgets.indexOf(element.line);\n        var spanIndex = element.line.children.indexOf(element);\n        spanObj.characterFormat.copyFormat(element.characterFormat);\n        element.line.children.splice(spanIndex, 0, spanObj);\n        spanObj.line = element.line;\n        this.viewer.layout.reLayoutParagraph(element.line.paragraph, lineIndex, spanIndex);\n    };\n    Editor.prototype.insertFieldSeparatorText = function (fieldSeparator, selection, text, index) {\n        var previousInline = selection.getPreviousTextInline(fieldSeparator);\n        var nextInline = selection.getNextTextInline(fieldSeparator);\n        var span = new TextElementBox();\n        span.text = text;\n        var spanIndex = fieldSeparator.line.children.indexOf(fieldSeparator);\n        if (index === fieldSeparator.length) {\n            spanIndex++;\n        }\n        if (isNullOrUndefined(previousInline) && isNullOrUndefined(nextInline)) {\n            span.characterFormat.copyFormat(fieldSeparator.line.paragraph.characterFormat);\n        }\n        else if (isNullOrUndefined(previousInline)) {\n            span.characterFormat.copyFormat(nextInline.characterFormat);\n        }\n        else {\n            span.characterFormat.copyFormat(previousInline.characterFormat);\n        }\n        fieldSeparator.line.children.splice(spanIndex, 0, span);\n        span.line = fieldSeparator.line;\n        var lineIndex = fieldSeparator.line.paragraph.childWidgets.indexOf(fieldSeparator.line);\n        this.viewer.layout.reLayoutParagraph(fieldSeparator.line.paragraph, lineIndex, spanIndex);\n    };\n    Editor.prototype.insertFieldEndText = function (fieldEnd, selection, text, index) {\n        var span = new TextElementBox();\n        span.text = text;\n        var spanIndex = fieldEnd.line.children.indexOf(fieldEnd);\n        span.characterFormat.copyFormat(fieldEnd.characterFormat);\n        fieldEnd.line.children.splice(spanIndex + 1, 0, span);\n        span.line = fieldEnd.line;\n        var lineIndex = fieldEnd.line.paragraph.childWidgets.indexOf(fieldEnd.line);\n        this.viewer.layout.reLayoutParagraph(fieldEnd.line.paragraph, lineIndex, spanIndex);\n    };\n    Editor.prototype.insertImageText = function (image, selection, text, index) {\n        var previousInlineObj = selection.getPreviousTextInline(image);\n        var nextInlineObj = selection.getNextTextInline(image);\n        var line = image.line;\n        var element = new TextElementBox();\n        var paragraph = line.paragraph;\n        var lineIndex = paragraph.childWidgets.indexOf(line);\n        element.text = text;\n        var spanIndex = line.children.indexOf(image);\n        if (index === image.length) {\n            spanIndex++;\n        }\n        if (isNullOrUndefined(previousInlineObj) && isNullOrUndefined(nextInlineObj)) {\n            element.characterFormat.copyFormat(paragraph.characterFormat);\n        }\n        else if (isNullOrUndefined(previousInlineObj)) {\n            element.characterFormat.copyFormat(nextInlineObj.characterFormat);\n        }\n        else {\n            element.characterFormat.copyFormat(previousInlineObj.characterFormat);\n        }\n        line.children.splice(spanIndex, 0, element);\n        element.line = line;\n        this.viewer.layout.reLayoutParagraph(paragraph, lineIndex, spanIndex);\n    };\n    /**\n     * @private\n     */\n    Editor.prototype.isListTextSelected = function () {\n        if (this.viewer.isListTextSelected) {\n            this.initComplexHistory('ListSelect');\n            // tslint:disable-next-line:max-line-length\n            if (this.viewer.selection.start.paragraph.paragraphFormat.listFormat && this.viewer.selection.start.paragraph.paragraphFormat.listFormat.listId !== -1) {\n                this.onApplyList(undefined);\n            }\n        }\n    };\n    //Auto Format and insert Hyperlink Implementation starts\n    Editor.prototype.checkAndConvertToHyperlink = function (selection, isEnter, paragraph) {\n        var text;\n        var span;\n        if (isEnter) {\n            span = paragraph.lastChild.children[paragraph.lastChild.children.length - 1];\n            text = span.text;\n        }\n        else {\n            var indexInInline = 0;\n            var inlineObj = selection.start.currentWidget.getInline(selection.start.offset - 1, indexInInline);\n            var inline = inlineObj.element;\n            indexInInline = inlineObj.index;\n            if (!(inline instanceof TextElementBox)) {\n                return;\n            }\n            span = inline;\n            text = span.text.substring(0, indexInInline);\n        }\n        var index = 0;\n        var tabCharIndex = text.lastIndexOf('\\t');\n        index = (tabCharIndex >= 0) ? tabCharIndex + 1 : text.lastIndexOf(' ') + 1;\n        while (span.previousNode instanceof TextElementBox && index === 0) {\n            span = span.previousNode;\n            var previousText = span.text;\n            tabCharIndex = previousText.lastIndexOf('\\t');\n            index = (tabCharIndex >= 0) ? tabCharIndex + 1 : previousText.lastIndexOf(' ') + 1;\n            text = span.text + text;\n        }\n        text = text.substring(index);\n        var lowerCaseText = text.toLowerCase();\n        var containsURL = false;\n        if (lowerCaseText.substring(0, 8) === 'file:///'\n            || (lowerCaseText.substring(0, 7) === 'http://' && lowerCaseText.length > 7)\n            || (lowerCaseText.substring(0, 8) === 'https://' && lowerCaseText.length > 8)\n            || (lowerCaseText.substring(0, 4) === 'www.' && lowerCaseText.length > 4)\n            || (lowerCaseText.substring(0, 3) === '\\\\' && lowerCaseText.length > 3)\n            || (lowerCaseText.substring(0, 7) === 'mailto:' && lowerCaseText.length > 7)) {\n            containsURL = true;\n            if (lowerCaseText.substring(0, 4) === 'www.' && lowerCaseText.length > 4) {\n                text = 'http://' + text;\n            }\n        }\n        else {\n            var atIndex = text.indexOf('@');\n            var dotIndex = text.indexOf('.');\n            if (atIndex > 0 && atIndex < dotIndex && dotIndex < text.length - 1) {\n                containsURL = true;\n                text = 'mailto:' + text;\n            }\n        }\n        if (containsURL) {\n            var startPos = new TextPosition(this.viewer.owner);\n            startPos.setPositionParagraph(span.line, span.line.getOffset(span, index));\n            var endPos = new TextPosition(this.viewer.owner);\n            if (isEnter) {\n                endPos.setPositionParagraph(span.line, span.line.getEndOffset());\n            }\n            else {\n                if (selection.end.currentWidget.children.length === 0 && selection.end.offset === 0) {\n                    var prevLine = selection.end.currentWidget.previousLine;\n                    endPos.setPositionParagraph(prevLine, prevLine.getEndOffset());\n                }\n                else {\n                    endPos.setPositionParagraph(selection.end.currentWidget, selection.end.offset - 1);\n                }\n            }\n            this.autoFormatHyperlink(selection, text, startPos, endPos);\n        }\n    };\n    Editor.prototype.autoFormatHyperlink = function (selection, url, startPosition, endPosition) {\n        this.initComplexHistory('AutoFormatHyperlink');\n        var blockInfo = this.getParagraphInfo(startPosition);\n        var start = this.getHierarchicalIndex(blockInfo.paragraph, blockInfo.offset.toString());\n        if (this.editorHistory && this.editorHistory.currentHistoryInfo) {\n            this.editorHistory.currentHistoryInfo.insertPosition = start;\n        }\n        // Moves the selection to URL text start and end position.\n        selection.start.setPositionInternal(startPosition);\n        selection.end.setPositionInternal(endPosition);\n        // Preserves the character format for hyperlink field.\n        var temp = this.getCharacterFormat(selection);\n        var format = new WCharacterFormat();\n        format.copyFormat(temp);\n        var fieldEnd = this.createHyperlinkElement(url, startPosition, endPosition, format);\n        // Moves the selection to the end of field end position.\n        selection.start.setPositionParagraph(fieldEnd.line, (fieldEnd.line).getOffset(fieldEnd, 1));\n        // Moves to next text position. (To achieve common behavior for space and enter).\n        selection.start.moveNextPosition();\n        selection.end.setPositionInternal(selection.start);\n        blockInfo = this.getParagraphInfo(selection.end);\n        var end = this.getHierarchicalIndex(blockInfo.paragraph, blockInfo.offset.toString());\n        if (this.editorHistory && this.editorHistory.currentHistoryInfo) {\n            this.editorHistory.currentHistoryInfo.endPosition = end;\n            this.editorHistory.updateComplexHistory();\n            this.reLayout(selection);\n        }\n        else {\n            this.updateComplexWithoutHistory(0, start, end);\n        }\n    };\n    Editor.prototype.appylingHyperlinkFormat = function (selection) {\n        this.initHistory('Underline');\n        this.updateCharacterFormatWithUpdate(selection, 'underline', 'Single', false);\n        if (this.editorHistory) {\n            this.editorHistory.updateHistory();\n        }\n        this.reLayout(selection, false);\n        // Applies font color for field result.\n        this.initHistory('FontColor');\n        this.updateCharacterFormatWithUpdate(selection, 'fontColor', '#0563c1', false);\n        if (this.editorHistory) {\n            this.editorHistory.updateHistory();\n        }\n        this.reLayout(selection, false);\n    };\n    // tslint:disable-next-line:max-line-length\n    Editor.prototype.createHyperlinkElement = function (url, startPosition, endPosition, format) {\n        var selection = this.selection;\n        this.viewer.layout.allowLayout = false;\n        this.appylingHyperlinkFormat(selection);\n        this.viewer.layout.allowLayout = true;\n        // Adds the field end at the URL text end position.\n        var fieldEnd = new FieldElementBox(1);\n        fieldEnd.characterFormat.copyFormat(format);\n        fieldEnd.line = selection.end.currentWidget;\n        selection.start.setPositionInternal(selection.end);\n        // this.insertElementInCurrentLine(selection, fieldEnd, true);\n        this.initInsertInline(fieldEnd);\n        // Moves the selection to URL text start position.        \n        selection.start.setPositionInternal(startPosition);\n        selection.end.setPositionInternal(selection.start);\n        // Adds field begin, field code and field separator at the URL text start position.\n        var begin = this.insertHyperlinkfield(selection, format, url);\n        var lineIndex = selection.start.paragraph.childWidgets.indexOf(begin.line);\n        var index = begin.line.children.indexOf(begin);\n        fieldEnd.linkFieldCharacter(this.viewer);\n        this.viewer.layout.reLayoutParagraph(selection.start.paragraph, lineIndex, index);\n        return fieldEnd;\n    };\n    Editor.prototype.insertHyperlinkfield = function (selection, format, url, isBookmark) {\n        // Adds field begin, field code and field separator at the URL text start position.\n        var begin = new FieldElementBox(0);\n        begin.characterFormat.copyFormat(format);\n        begin.line = selection.start.currentWidget;\n        this.initInsertInline(begin);\n        var span = new TextElementBox();\n        span.characterFormat.copyFormat(format);\n        if (isBookmark) {\n            span.text = ' HYPERLINK \\\\l \\\"' + url + '\\\" ';\n        }\n        else {\n            span.text = ' HYPERLINK \\\"' + url + '\\\" ';\n        }\n        span.line = selection.start.currentWidget;\n        this.initInsertInline(span);\n        var separator = new FieldElementBox(2);\n        separator.characterFormat.copyFormat(format);\n        separator.line = selection.start.currentWidget;\n        this.initInsertInline(separator);\n        return begin;\n    };\n    Editor.prototype.unLinkFieldCharacter = function (inline) {\n        if (inline instanceof FieldElementBox && inline.fieldType === 0) {\n            if (inline.fieldEnd) {\n                if (this.viewer) {\n                    this.viewer.fieldToLayout = inline;\n                    this.viewer.fieldEndParagraph = inline.line.paragraph;\n                }\n                // inline.line.paragraph.addFieldCharacter(inline.fieldEnd);\n                inline.fieldEnd = undefined;\n            }\n        }\n        if (inline instanceof FieldElementBox && inline.fieldType === 2) {\n            if (!isNullOrUndefined(inline.fieldEnd)) {\n                if (this.viewer) {\n                    this.viewer.fieldToLayout = inline.fieldBegin;\n                    this.viewer.fieldEndParagraph = inline.line.paragraph;\n                }\n                inline.fieldBegin.fieldSeparator = undefined;\n                inline.fieldEnd.fieldSeparator = undefined;\n            }\n        }\n        else if (inline instanceof FieldElementBox && inline.fieldType === 1) {\n            if (inline.fieldBegin) {\n                if (!isNullOrUndefined(this.viewer)) {\n                    this.viewer.fieldToLayout = inline.fieldBegin;\n                    this.viewer.fieldEndParagraph = inline.line.paragraph;\n                }\n                var fieldIndex = this.viewer.fields.indexOf(inline.fieldBegin);\n                if (fieldIndex !== -1) {\n                    this.viewer.fields.splice(fieldIndex, 1);\n                }\n                inline.fieldBegin = undefined;\n            }\n        }\n    };\n    Editor.prototype.getCharacterFormat = function (selection) {\n        if (selection.start.paragraph.isEmpty()) {\n            return selection.start.paragraph.characterFormat;\n        }\n        else {\n            var info = selection.start.currentWidget.getInline(selection.start.offset, 0);\n            return info.element.characterFormat;\n        }\n    };\n    /**\n     * Insert Hyperlink\n     * @param  {string} url\n     * @param  {string} displayText\n     * @param  {boolean} remove\n     * @private\n     */\n    Editor.prototype.insertHyperlink = function (url, displayText, remove, isBookmark) {\n        var selection = this.viewer.selection;\n        if (selection.start.paragraph.associatedCell !== selection.end.paragraph.associatedCell) {\n            return;\n        }\n        if (remove) {\n            //Empty selection Hyperlink insert\n            this.insertHyperlinkInternal(selection, url, displayText, isBookmark);\n        }\n        else {\n            //Non-Empty Selection- change the selected text to Field       \n            // this.preservedFontCol = this.getFontColor();\n            var startPosition = selection.start;\n            var endPosition = selection.end;\n            if (!selection.isForward) {\n                startPosition = selection.end;\n                endPosition = selection.start;\n            }\n            var fieldStartPosition = new TextPosition(this.viewer.owner);\n            fieldStartPosition.setPositionInternal(startPosition);\n            var temp = this.getCharacterFormat(selection);\n            var format = new WCharacterFormat(undefined);\n            format.copyFormat(temp);\n            this.initComplexHistory('InsertHyperlink');\n            var blockInfo = this.getParagraphInfo(startPosition);\n            var start = this.getHierarchicalIndex(blockInfo.paragraph, blockInfo.offset.toString());\n            if (this.editorHistory && this.editorHistory.currentHistoryInfo) {\n                // tslint:disable-next-line:max-line-length\n                this.editorHistory.currentHistoryInfo.insertPosition = this.getHierarchicalIndex(blockInfo.paragraph, blockInfo.offset.toString());\n            }\n            this.appylingHyperlinkFormat(selection);\n            this.viewer.layout.allowLayout = true;\n            startPosition.setPositionInternal(endPosition);\n            // Adds the field end at the URL text end position.\n            var fieldEnd = new FieldElementBox(1);\n            fieldEnd.characterFormat.copyFormat(format);\n            fieldEnd.line = selection.end.currentWidget;\n            startPosition.setPositionInternal(endPosition);\n            // this.insertElementInCurrentLine(selection, fieldEnd, true);\n            this.initInsertInline(fieldEnd);\n            // Moves the selection to URL text start position.        \n            startPosition.setPositionInternal(fieldStartPosition);\n            endPosition.setPositionInternal(startPosition);\n            // Adds field begin, field code and field separator at the URL text start position.\n            var begin = this.insertHyperlinkfield(selection, format, url, isBookmark);\n            fieldEnd.linkFieldCharacter(this.viewer);\n            var lineIndex = selection.start.paragraph.childWidgets.indexOf(begin.line);\n            var index = begin.line.children.indexOf(begin);\n            this.viewer.layout.reLayoutParagraph(selection.start.paragraph, lineIndex, index);\n            var lineWidget = fieldEnd.line;\n            selection.selects(lineWidget, lineWidget.getOffset(fieldEnd, fieldEnd.length), true);\n            blockInfo = this.getParagraphInfo(endPosition);\n            var end = this.getHierarchicalIndex(blockInfo.paragraph, blockInfo.offset.toString());\n            if (this.editorHistory && this.editorHistory.currentHistoryInfo) {\n                // tslint:disable-next-line:max-line-length\n                this.editorHistory.currentHistoryInfo.endPosition = this.getHierarchicalIndex(blockInfo.paragraph, blockInfo.offset.toString());\n                this.editorHistory.updateComplexHistory();\n            }\n            else {\n                this.updateComplexWithoutHistory(1, start, end);\n            }\n        }\n    };\n    Editor.prototype.insertHyperlinkInternal = function (selection, url, displayText, isBookmark) {\n        if (isNullOrUndefined(selection.start)) {\n            return;\n        }\n        if (this.editHyperlink(selection, url, displayText)) {\n            return;\n        }\n        this.initHistory('InsertHyperlink');\n        var isRemoved = true;\n        if (!selection.isEmpty) {\n            isRemoved = this.removeSelectedContents(selection);\n        }\n        if (isRemoved) {\n            // Preserves the character format for hyperlink field.\n            var temp = this.getCharacterFormat(selection);\n            var format = new WCharacterFormat();\n            format.copyFormat(temp);\n            this.insertHyperlinkByFormat(selection, url, displayText, format, isBookmark);\n        }\n        //else\n        //    this.Select(Start, true);\n    };\n    // tslint:disable-next-line:max-line-length\n    Editor.prototype.insertHyperlinkByFormat = function (selection, url, displayText, format, isBookmark) {\n        this.updateInsertPosition();\n        selection.owner.isShiftingEnabled = true;\n        var indexInInline = 0;\n        var initial = indexInInline;\n        var element = [];\n        var fieldBegin = new FieldElementBox(0);\n        element.push(fieldBegin);\n        var span = new TextElementBox();\n        if (isBookmark) {\n            span.text = ' HYPERLINK \\\\l \\\"' + url + '\\\" ';\n        }\n        else {\n            span.text = ' HYPERLINK \\\"' + url + '\\\" ';\n        }\n        element.push(span);\n        var fieldSeparator = new FieldElementBox(2);\n        element.push(fieldSeparator);\n        if (!isNullOrUndefined(displayText) && displayText !== '') {\n            span = new TextElementBox();\n            span.characterFormat.underline = 'Single';\n            span.characterFormat.fontColor = '#0563c1';\n            span.text = displayText;\n            element.push(span);\n        }\n        var fieldEnd = new FieldElementBox(1);\n        element.push(fieldEnd);\n        this.insertElement(element);\n        var paragraph = selection.start.paragraph;\n        fieldEnd.linkFieldCharacter(this.viewer);\n        if (this.viewer.fields.indexOf(fieldBegin) === -1) {\n            this.viewer.fields.push(fieldBegin);\n        }\n        var offset = fieldEnd.line.getOffset(fieldEnd, 1);\n        selection.selects(fieldEnd.line, fieldEnd.line.getOffset(fieldEnd, fieldEnd.length), true);\n        this.updateEndPosition();\n        this.reLayout(selection, true);\n    };\n    Editor.prototype.initInsertInline = function (element, insertHyperlink) {\n        this.initHistory('InsertInline');\n        this.insertInlineInSelection(this.viewer.selection, element);\n        if (this.editorHistory) {\n            this.editorHistory.updateHistory();\n        }\n    };\n    /**\n     * @private\n     */\n    Editor.prototype.insertElementInCurrentLine = function (selection, inline, isReLayout) {\n        if (this.checkIsNotRedoing()) {\n            selection.owner.isShiftingEnabled = true;\n        }\n        if (!selection.isEmpty) {\n            this.removeSelectedContents(selection);\n        }\n        this.updateInsertPosition();\n        this.insertElement([inline]);\n        if (this.checkEndPosition(selection)) {\n            this.updateHistoryPosition(selection.start, false);\n        }\n        this.fireContentChange();\n    };\n    /**\n     * Edit Hyperlink\n     * @param  {Selection} selection\n     * @param  {string} url\n     * @param  {string} displayText\n     * @private\n     */\n    Editor.prototype.editHyperlink = function (selection, url, displayText, isBookmark) {\n        var fieldBegin = selection.getHyperlinkField();\n        if (isNullOrUndefined(fieldBegin)) {\n            return false;\n        }\n        this.initHistory('InsertHyperlink');\n        this.editHyperlinkInternal = isNullOrUndefined(this.editorHistory)\n            || (this.editorHistory && isNullOrUndefined(this.editorHistory.currentBaseHistoryInfo));\n        var fieldResult = '';\n        var isNestedField = false;\n        // Preserves the character format for hyperlink field.\n        var temp = this.getCharacterFormat(selection);\n        var format = new WCharacterFormat();\n        format.copyFormat(temp);\n        var fieldSeparator = undefined;\n        if (!isNullOrUndefined(fieldBegin.fieldSeparator)) {\n            fieldSeparator = fieldBegin.fieldSeparator;\n            // tslint:disable-next-line:max-line-length\n            var fieldObj = selection.getHyperlinkDisplayText(fieldBegin.fieldSeparator.line.paragraph, fieldBegin.fieldSeparator, fieldBegin.fieldEnd, isNestedField, format);\n            fieldResult = fieldObj.displayText;\n            isNestedField = fieldObj.isNestedField;\n            format = fieldObj.format;\n        }\n        var offset = fieldBegin.line.getOffset(fieldBegin, 0);\n        selection.start.setPositionParagraph(fieldBegin.line, offset);\n        offset = fieldBegin.fieldEnd.line.getOffset(fieldBegin.fieldEnd, 1);\n        selection.end.setPositionParagraph(fieldBegin.fieldEnd.line, offset);\n        this.deleteSelectedContents(selection, false);\n        if (!isNestedField && fieldResult !== displayText || isNullOrUndefined(fieldSeparator)) {\n            this.insertHyperlinkByFormat(selection, url, displayText, format, isBookmark);\n        }\n        else {\n            //Modify the new hyperlink url. Inserts field begin, url and field separator.\n            this.updateInsertPosition();\n            var newFieldBegin = new FieldElementBox(0);\n            newFieldBegin.characterFormat.copyFormat(fieldBegin.characterFormat);\n            newFieldBegin.line = selection.start.currentWidget;\n            this.insertInlineInternal(newFieldBegin);\n            var span = new TextElementBox();\n            span.characterFormat.copyFormat(fieldBegin.characterFormat);\n            if (isBookmark) {\n                span.text = ' HYPERLINK \\\\l \\\"' + url + '\\\" ';\n            }\n            else {\n                span.text = ' HYPERLINK \\\"' + url + '\\\" ';\n            }\n            span.line = selection.start.currentWidget;\n            this.insertInlineInternal(span);\n            var nodes = this.editorHistory && this.editorHistory.currentBaseHistoryInfo ?\n                this.editorHistory.currentBaseHistoryInfo.removedNodes : this.nodes;\n            this.insertClonedFieldResult(selection, nodes, fieldSeparator);\n            var fieldEnd = selection.end.currentWidget.getInline(selection.end.offset, 0).element;\n            fieldEnd.linkFieldCharacter(this.viewer);\n            var paragraph = newFieldBegin.line.paragraph;\n            var lineIndex = newFieldBegin.line.paragraph.childWidgets.indexOf(newFieldBegin.line);\n            var elementIndex = newFieldBegin.line.children.indexOf(newFieldBegin);\n            this.viewer.layout.reLayoutParagraph(paragraph, lineIndex, elementIndex);\n            selection.selects(newFieldBegin.fieldEnd.line, offset, true);\n            this.updateEndPosition();\n            this.reLayout(selection, true);\n        }\n        this.editHyperlinkInternal = false;\n        this.nodes = [];\n        return true;\n    };\n    /* tslint:disable:no-any */\n    Editor.prototype.insertClonedFieldResult = function (selection, nodes, fieldSeparator) {\n        var fieldEnd;\n        var isStarted = false;\n        for (var i = nodes.length - 1; i > -1; i--) {\n            var node = nodes[i];\n            /* tslint:enable:no-any */\n            if (!isStarted) {\n                if (fieldSeparator === node) {\n                    isStarted = true;\n                }\n                else {\n                    if (node instanceof ParagraphWidget && node === fieldSeparator.line.paragraph) {\n                        isStarted = true;\n                        var paragraph = undefined;\n                        if (i === nodes.length - 1) {\n                            paragraph = selection.start.paragraph;\n                            var fieldParagraph = fieldSeparator.line.paragraph;\n                            this.getClonedFieldResultWithSel(fieldParagraph, selection, fieldSeparator);\n                        }\n                        else {\n                            paragraph = this.getClonedFieldResult(fieldSeparator.line.paragraph, fieldSeparator);\n                            this.insertParagraph(paragraph, true);\n                        }\n                        selection.selectParagraph(selection.getNextParagraphBlock(paragraph), true);\n                    }\n                    continue;\n                }\n            }\n            if (node instanceof ElementBox) {\n                this.insertInlineInternal(node.clone());\n            }\n            else if (node instanceof BlockWidget) {\n                this.insertBlock(node.clone());\n            }\n            // else if (node instanceof WSection)\n            //     editor.insertSection((node as WSection)._Clone());\n        }\n    };\n    Editor.prototype.getClonedFieldResultWithSel = function (paragraph, selection, fieldSeparator) {\n        var lineIndex = paragraph.childWidgets.indexOf(fieldSeparator.line);\n        var elementIndex = paragraph.childWidgets[lineIndex].children.indexOf(fieldSeparator);\n        for (var j = lineIndex; j < paragraph.childWidgets.length; j++) {\n            var lineWidget = paragraph.childWidgets[j];\n            if (j !== lineIndex) {\n                elementIndex = 0;\n            }\n            for (var i = elementIndex; i < lineWidget.children.length; i++) {\n                this.insertInlineInternal(lineWidget.children[i].clone());\n            }\n        }\n    };\n    Editor.prototype.getClonedFieldResult = function (curParagraph, fieldSeparator) {\n        var paragraph = new ParagraphWidget();\n        paragraph.characterFormat.copyFormat(curParagraph.characterFormat);\n        paragraph.paragraphFormat.copyFormat(curParagraph.paragraphFormat);\n        var lineIndex = curParagraph.childWidgets.indexOf(fieldSeparator.line);\n        var elementIndex = curParagraph.childWidgets[lineIndex].children.indexOf(fieldSeparator);\n        for (var j = lineIndex; j < curParagraph.childWidgets.length; j++) {\n            var lineWidget = curParagraph.childWidgets[j];\n            if (j !== lineIndex) {\n                elementIndex = 0;\n            }\n            for (var i = elementIndex; i < lineWidget.children.length; i++) {\n                paragraph.childWidgets[0].children.push(lineWidget.children[i]);\n            }\n        }\n        return paragraph;\n    };\n    /**\n     * Removes the hyperlink if selection is within hyperlink.\n     */\n    Editor.prototype.removeHyperlink = function () {\n        if (this.owner.isReadOnlyMode) {\n            return;\n        }\n        var selection = this.selection;\n        var fieldBegin = selection.getHyperlinkField();\n        if (isNullOrUndefined(fieldBegin)) {\n            return;\n        }\n        var fieldEnd = fieldBegin.fieldEnd;\n        var fieldSeparator = fieldBegin.fieldSeparator;\n        var fieldStartPosition = new TextPosition(selection.owner);\n        // tslint:disable-next-line:max-line-length\n        fieldStartPosition.setPositionParagraph(fieldBegin.line, (fieldBegin.line).getOffset(fieldBegin, 0));\n        var fieldSeparatorPosition = new TextPosition(selection.owner);\n        // tslint:disable-next-line:max-line-length\n        fieldSeparatorPosition.setPositionParagraph(fieldSeparator.line, (fieldSeparator.line).getOffset(fieldSeparator, fieldSeparator.length));\n        this.initComplexHistory('RemoveHyperlink');\n        selection.start.setPositionParagraph(fieldEnd.line, (fieldEnd.line).getOffset(fieldEnd, 0));\n        selection.end.setPositionInternal(selection.start);\n        this.onDelete();\n        selection.start.setPositionInternal(fieldSeparatorPosition);\n        this.initHistory('Underline');\n        this.updateCharacterFormatWithUpdate(selection, 'underline', 'None', false);\n        if (this.editorHistory) {\n            this.editorHistory.updateHistory();\n        }\n        // Applies font color for field result.\n        this.initHistory('FontColor');\n        this.updateCharacterFormatWithUpdate(selection, 'fontColor', undefined, false);\n        if (this.editorHistory) {\n            this.editorHistory.updateHistory();\n        }\n        this.reLayout(selection, false);\n        selection.end.setPositionInternal(selection.start);\n        selection.start.setPositionInternal(fieldStartPosition);\n        this.initHistory('Delete');\n        this.deleteSelectedContents(selection, false);\n        this.reLayout(selection, true);\n        if (this.editorHistory && !isNullOrUndefined(this.editorHistory.currentHistoryInfo)) {\n            this.editorHistory.updateComplexHistory();\n        }\n    };\n    //Paste Implementation starts\n    /**\n     * Paste copied clipboard content on Paste event\n     * @param  {ClipboardEvent} event\n     * @param  {any} pasteWindow?\n     * @private\n     */\n    /* tslint:disable:no-any */\n    Editor.prototype.pasteInternal = function (event, pasteWindow) {\n        if (this.viewer.owner.enableLocalPaste) {\n            this.pasteLocal();\n        }\n        else {\n            if (isNullOrUndefined(pasteWindow)) {\n                pasteWindow = window;\n            }\n            /* tslint:enable:no-any */\n            var textContent = '';\n            var clipbordData = pasteWindow.clipboardData ? pasteWindow.clipboardData : event.clipboardData;\n            textContent = clipbordData.getData('Text');\n            if (textContent !== '') {\n                this.pasteContents(textContent);\n                this.viewer.editableDiv.innerHTML = '';\n            }\n        }\n        this.viewer.updateFocus();\n    };\n    /**\n     * Pastes the data present in local clipboard if any.\n     */\n    Editor.prototype.pasteLocal = function () {\n        /* tslint:disable:no-any */\n        if (this.copiedData && this.owner.enableLocalPaste) {\n            var document_1 = JSON.parse(this.copiedData);\n            this.pasteContents(document_1);\n        }\n    };\n    Editor.prototype.getBlocks = function (pasteContent) {\n        var widgets = [];\n        if (typeof (pasteContent) === 'string') {\n            var startParagraph = this.selection.start.paragraph;\n            if (!this.selection.isForward) {\n                startParagraph = this.selection.end.paragraph;\n            }\n            var arr = [];\n            var txt = pasteContent;\n            txt = txt.replace(/\\r\\n/g, '\\r');\n            arr = txt.split('\\r');\n            for (var i = 0; i < arr.length; i++) {\n                var insertFormat = this.copyInsertFormat(startParagraph.characterFormat, false);\n                var insertParaFormat = this.viewer.selection.copySelectionParagraphFormat();\n                var paragraph = new ParagraphWidget();\n                paragraph.paragraphFormat.copyFormat(insertParaFormat);\n                var line = new LineWidget(paragraph);\n                if (arr[i].length > 0) {\n                    var textElement = new TextElementBox();\n                    textElement.characterFormat.copyFormat(insertFormat);\n                    textElement.text = arr[i];\n                    line.children.push(textElement);\n                    textElement.line = line;\n                }\n                paragraph.childWidgets.push(line);\n                widgets.push(paragraph);\n            }\n        }\n        else {\n            for (var i = 0; i < pasteContent.sections.length; i++) {\n                this.viewer.owner.parser.parseBody(pasteContent.sections[i].blocks, widgets);\n            }\n        }\n        return widgets;\n    };\n    Editor.prototype.pasteContents = function (content) {\n        this.pasteContentsInternal(this.getBlocks(content));\n    };\n    Editor.prototype.pasteContentsInternal = function (widgets) {\n        /* tslint:enable:no-any */\n        var selection = this.viewer.selection;\n        var isRemoved = true;\n        this.initComplexHistory('Paste');\n        if (this.viewer.isListTextSelected) {\n            var paragraph = selection.start.paragraph;\n            if (paragraph.paragraphFormat.listFormat && paragraph.paragraphFormat.listFormat.listId !== -1) {\n                this.onApplyList(undefined);\n            }\n        }\n        this.initHistory('Paste');\n        if (!selection.isEmpty || this.viewer.isListTextSelected) {\n            isRemoved = this.removeSelectedContentInternal(selection, selection.start, selection.end);\n        }\n        if (isRemoved) {\n            this.pasteContent(widgets);\n        }\n        else if (this.editorHistory) {\n            this.editorHistory.currentBaseHistoryInfo = undefined;\n        }\n        if (this.editorHistory && this.editorHistory.currentHistoryInfo) {\n            this.editorHistory.updateHistory();\n            this.editorHistory.updateComplexHistory();\n        }\n        else {\n            this.reLayout(selection, selection.isEmpty);\n        }\n    };\n    /* tslint:disable:no-any */\n    Editor.prototype.pasteContent = function (widgets) {\n        /* tslint:enable:no-any */\n        this.viewer.owner.isShiftingEnabled = true;\n        this.updateInsertPosition();\n        this.viewer.owner.isLayoutEnabled = true;\n        this.viewer.owner.isPastingContent = true;\n        this.pasteCopiedData(widgets);\n        this.updateEndPosition();\n        this.viewer.owner.isPastingContent = false;\n        this.viewer.selection.fireSelectionChanged(true);\n    };\n    Editor.prototype.pasteCopiedData = function (widgets) {\n        for (var j = 0; j < widgets.length; j++) {\n            var widget = widgets[j];\n            if (widget instanceof ParagraphWidget && widget.childWidgets.length === 0) {\n                widget.childWidgets[0] = new LineWidget(widget);\n            }\n            if (j === widgets.length - 1 && widget instanceof ParagraphWidget) {\n                var newParagraph = widget;\n                if (newParagraph.childWidgets.length > 0\n                    && newParagraph.childWidgets[0].children.length > 0) {\n                    this.insertElement(newParagraph.childWidgets[0].children);\n                }\n            }\n            else if (widget instanceof BlockWidget) {\n                var startParagraph = this.selection.start.paragraph;\n                if (widget instanceof TableWidget && startParagraph.isInsideTable) {\n                    var table = widget;\n                    //Handled to resize table based on parent cell width.\n                    var clientWidth = startParagraph.getContainerWidth();\n                    table.fitCellsToClientArea(clientWidth);\n                }\n                if (widget instanceof TableWidget && startParagraph.isEmpty()\n                    && startParagraph.previousWidget instanceof TableWidget) {\n                    this.insertTableRows(widget, startParagraph.previousWidget);\n                }\n                else {\n                    this.insertBlockInternal(widget);\n                }\n            }\n        }\n    };\n    /**\n     * Insert Table on undo\n     * @param  {WTable} table\n     * @param  {WTable} newTable\n     * @param  {boolean} moveRows\n     * @private\n     */\n    Editor.prototype.insertTableInternal = function (table, newTable, moveRows) {\n        //Gets the index of current table.\n        var insertIndex = table.getIndex();\n        if (moveRows) {\n            //Moves the rows to table.\n            for (var i = 0, index = 0; i < table.childWidgets.length; i++, index++) {\n                var row = table.childWidgets[i];\n                newTable.childWidgets.splice(index, 0, row);\n                row.containerWidget = newTable;\n                table.childWidgets.splice(i, 1);\n                i--;\n            }\n        }\n        var owner = table.containerWidget;\n        this.removeBlock(table);\n        //Inserts table in the current table position.        \n        var blockAdvCollection = owner.childWidgets;\n        blockAdvCollection.splice(insertIndex, 0, newTable);\n        newTable.index = table.index;\n        table.containerWidget = undefined;\n        newTable.containerWidget = owner;\n        newTable.isGridUpdated = false;\n        newTable.buildTableColumns();\n        newTable.isGridUpdated = true;\n        this.viewer.layout.clearTableWidget(newTable, true, true);\n        this.updateNextBlocksIndex(newTable, true);\n        this.viewer.layout.linkFieldInTable(newTable);\n        this.viewer.layout.layoutBodyWidgetCollection(newTable.index, owner, newTable, false);\n    };\n    /**\n     * Insert Table on undo\n     * @param  {Selection} selection\n     * @param  {WBlock} block\n     * @param  {WTable} table\n     * @private\n     */\n    Editor.prototype.insertBlockTable = function (selection, block, table) {\n        var offset = selection.start.offset;\n        var lineIndex = selection.start.paragraph.childWidgets.indexOf(selection.start.currentWidget);\n        if (block instanceof ParagraphWidget && offset > 0) {\n            //Moves the inline items before selection start to the inserted paragraph.\n            // tslint:disable-next-line:max-line-length\n            this.moveInlines(selection.start.paragraph, block, 0, 0, selection.start.paragraph.firstChild, offset, selection.start.currentWidget);\n            selection.selectParagraph(selection.start.paragraph, true);\n            if (this.checkInsertPosition(selection)) {\n                this.updateHistoryPosition(this.getHierarchicalIndex(block, offset.toString()), true);\n            }\n        }\n        if (offset > 0 && this.checkInsertPosition(selection)) {\n            this.updateHistoryPosition(selection.start, true);\n        }\n        var index = table.indexInOwner;\n        table.containerWidget.childWidgets.splice(index, 0, block);\n        block.containerWidget = table.containerWidget;\n        block.index = table.index;\n        this.updateNextBlocksIndex(block, true);\n        this.viewer.layout.layoutBodyWidgetCollection(block.index, block.containerWidget, block, false);\n        if (this.checkInsertPosition(selection)) {\n            var paragraph = undefined;\n            if (block instanceof ParagraphWidget) {\n                paragraph = block;\n            }\n            if (block instanceof TableWidget) {\n                paragraph = selection.getFirstParagraphInFirstCell(block);\n            }\n            this.updateHistoryPosition(this.getHierarchicalIndex(paragraph, '0'), true);\n        }\n    };\n    /**\n     * On cut handle selected content remove and relayout\n     * @param  {Selection} selection\n     * @param  {TextPosition} startPosition\n     * @param  {TextPosition} endPosition\n     * @private\n     */\n    Editor.prototype.handleCut = function (selection) {\n        var startPosition = selection.start;\n        var endPosition = selection.end;\n        if (!selection.isForward) {\n            startPosition = selection.end;\n            endPosition = selection.start;\n        }\n        // this.owner.isShiftingEnabled = true;\n        var blockInfo = this.getParagraphInfo(startPosition);\n        selection.editPosition = this.getHierarchicalIndex(blockInfo.paragraph, blockInfo.offset.toString());\n        var image = undefined;\n        if (startPosition.paragraph === endPosition.paragraph && startPosition.offset + 1 === endPosition.offset) {\n            //Gets selected image and copy image to clipboard.\n            var index = 0;\n            var currentInline = startPosition.paragraph.getInline(endPosition.offset, index);\n            var inline = currentInline.element;\n            image = inline;\n        }\n        this.initHistory('Cut');\n        selection.owner.isShiftingEnabled = true;\n        if (this.editorHistory && this.editorHistory.currentBaseHistoryInfo) {\n            if (this.checkInsertPosition(selection)) {\n                this.updateHistoryPosition(selection.editPosition, true);\n            }\n        }\n        this.deleteSelectedContent(endPosition.paragraph, selection, startPosition, endPosition, 3);\n        var textPosition = new TextPosition(selection.owner);\n        this.setPositionForCurrentIndex(textPosition, selection.editPosition);\n        selection.selectContent(textPosition, true);\n        if (this.editorHistory && this.editorHistory.currentBaseHistoryInfo) {\n            if (this.checkEndPosition(selection)) {\n                this.updateHistoryPosition(selection.end, false);\n            }\n        }\n        this.reLayout(selection);\n    };\n    Editor.prototype.insertInlineInternal = function (element) {\n        var selection = this.selection;\n        var length = element.length;\n        var paragraphInfo = this.getParagraphInfo(selection.start);\n        if (selection.start.paragraph.isEmpty()) {\n            var paragraph = selection.start.paragraph;\n            if ((paragraph.paragraphFormat.textAlignment === 'Center' || paragraph.paragraphFormat.textAlignment === 'Right')\n                && paragraph.paragraphFormat.listFormat.listId === -1) {\n                paragraph.x = this.viewer.clientActiveArea.x;\n            }\n            paragraph.childWidgets[0].children.push(element);\n            element.line = paragraph.childWidgets[0];\n            element.linkFieldCharacter(this.viewer);\n            this.viewer.layout.reLayoutParagraph(paragraph, 0, 0);\n        }\n        else {\n            var indexInInline = 0;\n            var inlineObj = selection.start.currentWidget.getInline(selection.start.offset, indexInInline);\n            var curInline = inlineObj.element;\n            indexInInline = inlineObj.index;\n            this.insertElementInternal(curInline, element, indexInInline, true);\n        }\n        this.setPositionParagraph(paragraphInfo.paragraph, paragraphInfo.offset + length, true);\n    };\n    Editor.prototype.insertElement = function (element) {\n        var selection = this.selection;\n        var length = 0;\n        var paragraph = undefined;\n        var lineIndex = -1;\n        var lineWidget = undefined;\n        var insertIndex = 0;\n        var paragraphInfo = this.getParagraphInfo(selection.start);\n        if (selection.start.paragraph.isEmpty()) {\n            paragraph = selection.start.paragraph;\n            lineWidget = paragraph.childWidgets[0];\n            lineIndex = 0;\n        }\n        else {\n            var indexInInline = 0;\n            var inlineObj = selection.start.currentWidget.getInline(selection.start.offset, indexInInline);\n            var curInline = inlineObj.element;\n            indexInInline = inlineObj.index;\n            paragraph = curInline.line.paragraph;\n            lineIndex = paragraph.childWidgets.indexOf(curInline.line);\n            insertIndex = curInline.indexInOwner;\n            lineWidget = curInline.line;\n            if (indexInInline === curInline.length) {\n                insertIndex++;\n            }\n            else if (indexInInline === 0) {\n                if (isNullOrUndefined(curInline.previousNode)) {\n                    insertIndex = 0;\n                }\n            }\n            else {\n                insertIndex++;\n                var prevElement = new TextElementBox();\n                prevElement.characterFormat.copyFormat(curInline.characterFormat);\n                prevElement.text = curInline.text.substring(indexInInline);\n                curInline.text = curInline.text.substr(0, indexInInline);\n                lineWidget.children.splice(insertIndex, 0, prevElement);\n                prevElement.line = curInline.line;\n            }\n        }\n        for (var i = 0; i < element.length; i++) {\n            length += element[i].length;\n            lineWidget.children.splice(insertIndex, 0, element[i]);\n            element[i].line = lineWidget;\n            element[i].linkFieldCharacter(this.viewer);\n            insertIndex++;\n        }\n        this.viewer.layout.reLayoutParagraph(paragraph, lineIndex, 0);\n        this.setPositionParagraph(paragraphInfo.paragraph, paragraphInfo.offset + length, true);\n    };\n    Editor.prototype.insertElementInternal = function (element, newElement, index, relayout) {\n        var line = element.line;\n        var paragraph = line.paragraph;\n        var lineIndex = line.indexInOwner;\n        var insertIndex = element.indexInOwner;\n        if (index === element.length) {\n            insertIndex++;\n            line.children.splice(insertIndex, 0, newElement);\n        }\n        else if (index === 0) {\n            if (isNullOrUndefined(element.previousNode)) {\n                element.line.children.splice(0, 0, newElement);\n                insertIndex = 0;\n            }\n            else {\n                element.line.children.splice(insertIndex, 0, newElement);\n            }\n        }\n        else {\n            insertIndex++;\n            var textElement = new TextElementBox();\n            textElement.characterFormat.copyFormat(element.characterFormat);\n            textElement.text = element.text.substring(index);\n            element.text = element.text.substr(0, index);\n            line.children.splice(insertIndex, 0, textElement);\n            textElement.line = element.line;\n            //Inserts the new inline.\n            line.children.splice(insertIndex, 0, newElement);\n            insertIndex -= 1;\n        }\n        newElement.line = element.line;\n        newElement.linkFieldCharacter(this.viewer);\n        if (relayout) {\n            this.viewer.layout.reLayoutParagraph(paragraph, lineIndex, insertIndex);\n        }\n    };\n    /**\n     * Insert Block on undo\n     * @param  {Selection} selection\n     * @param  {WBlock} block\n     * @private\n     */\n    Editor.prototype.insertBlock = function (block) {\n        var isRemoved = true;\n        var selection = this.selection;\n        if (!selection.isEmpty) {\n            isRemoved = this.removeSelectedContents(selection);\n        }\n        if (!isRemoved) {\n            selection.selectContent(selection.start, false);\n        }\n        this.insertBlockInternal(block);\n        if (this.checkInsertPosition(selection)) {\n            var paragraph = undefined;\n            if (block instanceof ParagraphWidget) {\n                paragraph = block;\n            }\n            else {\n                paragraph = this.selection.getFirstParagraphInFirstCell(block);\n            }\n            // tslint:disable-next-line:max-line-length\n            this.updateHistoryPosition(this.getHierarchicalIndex(paragraph, '0'), true);\n        }\n        this.fireContentChange();\n    };\n    /**\n     * Insert new Block on specific index\n     * @param  {Selection} selection\n     * @param  {BlockWidget} block\n     * @private\n     */\n    Editor.prototype.insertBlockInternal = function (block) {\n        var selection = this.selection;\n        var isRemoved = true;\n        var startPara = this.selection.start.paragraph;\n        if (!selection.start.isAtParagraphStart) {\n            if (block instanceof ParagraphWidget) {\n                this.insertNewParagraphWidget(block, false);\n                return;\n            }\n            this.updateInsertPosition();\n            startPara = startPara.combineWidget(this.viewer);\n            // tslint:disable-next-line:max-line-length\n            this.splitParagraph(startPara, startPara.firstChild, 0, selection.start.currentWidget, selection.start.offset, false);\n            selection.selectParagraph(this.selection.start.paragraph, true);\n        }\n        var bodyWidget = selection.start.paragraph.containerWidget;\n        var blockIndex = selection.start.paragraph.index;\n        var insertIndex = bodyWidget.childWidgets.indexOf(selection.start.paragraph);\n        if (!isNullOrUndefined(bodyWidget)) {\n            bodyWidget.childWidgets.splice(insertIndex, 0, block);\n            block.containerWidget = bodyWidget;\n            block.index = blockIndex;\n            block.height = 0;\n            if (block instanceof TableWidget) {\n                block.isGridUpdated = false;\n                block.buildTableColumns();\n                block.isGridUpdated = true;\n            }\n            this.updateNextBlocksIndex(block, true);\n            this.viewer.layout.layoutBodyWidgetCollection(blockIndex, bodyWidget, block, false);\n        }\n    };\n    /**\n     * Inserts the image with specified size at cursor position in the document editor.\n     * @param {string} imageString  Base64 string, web URL or file URL.\n     * @param {number} width? Image width\n     * @param {number} height? Image height\n     */\n    Editor.prototype.insertImage = function (imageString, width, height) {\n        if (this.owner.isReadOnlyMode) {\n            return;\n        }\n        if (isNullOrUndefined(width)) {\n            width = 100;\n        }\n        if (isNullOrUndefined(height)) {\n            height = 100;\n        }\n        this.insertPicture(imageString, width, height);\n    };\n    /**\n     * Inserts a table of specified size at cursor position\n     *  in the document editor.\n     * @param {number} rows Default value of ‘rows’ parameter is 1.\n     * @param {number} columns Default value of ‘columns’ parameter is 1.\n     */\n    Editor.prototype.insertTable = function (rows, columns) {\n        var startPos = this.selection.start;\n        if (this.owner.isReadOnlyMode) {\n            return;\n        }\n        rows = rows || 1;\n        columns = columns || 1;\n        var table = this.createTable(rows, columns);\n        var clientWidth = startPos.paragraph.getContainerWidth();\n        table.splitWidthToTableCells(clientWidth);\n        var prevBlock = startPos.paragraph.previousWidget;\n        if (startPos.currentWidget.isFirstLine() && startPos.offset === 0 && prevBlock instanceof TableWidget) {\n            this.insertTableRows(table, prevBlock);\n            table.destroy();\n            return;\n        }\n        else {\n            this.initHistory('InsertTable');\n            this.viewer.owner.isShiftingEnabled = true;\n            this.insertBlock(table);\n        }\n        var startLine = this.selection.getFirstParagraphInFirstCell(table).childWidgets[0];\n        startPos.setPosition(startLine, true);\n        this.selection.end.setPositionInternal(startPos);\n        var lastParagraph = this.selection.getLastParagraphInLastCell(table);\n        var endOffset = lastParagraph.getLength() + 1;\n        if (this.editorHistory && this.editorHistory.currentBaseHistoryInfo) {\n            // tslint:disable-next-line:max-line-length\n            this.editorHistory.currentBaseHistoryInfo.endPosition = this.getHierarchicalIndex(lastParagraph, endOffset.toString());\n        }\n        this.reLayout(this.selection);\n    };\n    /**\n     * Inserts the specified number of rows to the table above or below to the row at cursor position.\n     * @param {boolean} above The above parameter is optional and if omitted,\n     * it takes the value as false and inserts below the row at cursor position.\n     * @param {number} count The count parameter is optional and if omitted, it takes the value as 1.\n     */\n    Editor.prototype.insertRow = function (above, count) {\n        var rowPlacement = above ? 'Above' : 'Below';\n        if (this.owner.isReadOnlyMode) {\n            return;\n        }\n        var startPos = this.selection.isForward ? this.selection.start : this.selection.end;\n        var endPos = this.selection.isForward ? this.selection.end : this.selection.start;\n        if (startPos.paragraph.isInsideTable) {\n            if (this.checkIsNotRedoing()) {\n                this.initHistory(rowPlacement === 'Above' ? 'InsertRowAbove' : 'InsertRowBelow');\n            }\n            this.viewer.owner.isShiftingEnabled = true;\n            var startCell = this.getOwnerCell(this.selection.isForward).getSplitWidgets()[0];\n            var endCell = this.getOwnerCell(!this.selection.isForward).getSplitWidgets()[0];\n            var table = startCell.ownerTable.combineWidget(this.viewer);\n            var row = rowPlacement === 'Below' ? endCell.ownerRow : startCell.ownerRow;\n            if (this.editorHistory) {\n                var clonedTable = this.cloneTableToHistoryInfo(table);\n            }\n            var rowCount = count ? count : this.getRowCountToInsert();\n            var rows = [];\n            var index = row.rowIndex;\n            if (rowPlacement === 'Below') {\n                index++;\n                var isAffectedByRowSpannedCell = isNullOrUndefined(endCell.previousWidget)\n                    || endCell.columnIndex === endCell.previousWidget.columnIndex + 1;\n                var isRowSpanEnd = endCell.cellIndex !== endCell.columnIndex && isAffectedByRowSpannedCell\n                    && row.rowIndex + startCell.cellFormat.rowSpan - 1 === endCell.ownerRow.rowIndex;\n                if (!isRowSpanEnd) {\n                    if (endCell.cellFormat.rowSpan > 1) {\n                        if (!isNullOrUndefined(row.nextWidget) && row.nextWidget instanceof TableRowWidget) {\n                            endCell.cellFormat.rowSpan += rowCount;\n                            row = row.nextWidget;\n                        }\n                    }\n                }\n            }\n            for (var i = 0; i < rowCount; i++) {\n                var cellCountInfo = this.updateRowspan(row, rowPlacement === 'Below' ? endCell : startCell, rowPlacement);\n                var newRow = this.createRowAndColumn(cellCountInfo.count, i);\n                newRow.rowFormat.copyFormat(row.rowFormat);\n                this.updateCellFormatForInsertedRow(newRow, cellCountInfo.cellFormats);\n                rows.push(newRow);\n            }\n            table.insertTableRowsInternal(rows, index);\n            var cell = undefined;\n            var paragraph = undefined;\n            if ((table.childWidgets[index] instanceof TableRowWidget)) {\n                cell = table.childWidgets[index].firstChild;\n                paragraph = this.selection.getFirstParagraph(cell);\n            }\n            else {\n                var widget = undefined;\n                while (!(widget instanceof TableWidget)) {\n                    widget = table.nextRenderedWidget;\n                }\n                paragraph = this.selection.getFirstParagraphInFirstCell(widget);\n            }\n            this.viewer.layout.reLayoutTable(table);\n            this.selection.selectParagraph(paragraph, true);\n        }\n        this.reLayout(this.selection, true);\n    };\n    Editor.prototype.updateCellFormatForInsertedRow = function (newRow, cellFormats) {\n        for (var i = 0; i < newRow.childWidgets.length; i++) {\n            newRow.childWidgets[i].cellFormat.copyFormat(cellFormats[i]);\n            newRow.childWidgets[i].cellFormat.rowSpan = 1;\n        }\n    };\n    Editor.prototype.updateRowspan = function (row, startCell, rowPlacement) {\n        var spannedCells = row.getPreviousRowSpannedCells(true);\n        var count = 0;\n        var cellFormats = [];\n        for (var i = 0; i < row.childWidgets.length; i++) {\n            var cell = row.childWidgets[i];\n            var isCellIncluded = false;\n            // Need to check with all the row spanned cells. if the start cell contains rowspan greater than 1, \n            // and when inserting below, need to increment rowspan for all row spanned cells by 1 except\n            // if the spanned cells is placed in the same column or cell to be cloned has the same row index of cloned cell row index.\n            // and when inserting above, if cloned cell placed in the same row of start cell or\n            // if the cloned cell has equal column index, need to skip updating rowspan value of cloned cell.\n            // else update row span value for spanned cell except \n            // if the spanned cells is placed in the same column or cell to be cloned has the same row index of cloned cell row index.\n            var isRowSpanned = (isNullOrUndefined(cell.previousWidget)\n                || cell.columnIndex !== cell.previousWidget.columnIndex + 1);\n            for (var j = 0; j < spannedCells.length; j++) {\n                if (isRowSpanned) {\n                    var spannedCell = spannedCells[j];\n                    var clonedRowIndex = spannedCell.ownerRow.rowIndex + spannedCell.cellFormat.rowSpan - 1;\n                    if (cell.columnIndex < spannedCell.columnIndex && cell.cellIndex !== cell.columnIndex) {\n                        isCellIncluded = true;\n                        count++;\n                        cellFormats.push(cell.cellFormat);\n                    }\n                    if (startCell.cellFormat.rowSpan === 1) {\n                        // Need to check whether cell is affected by a row spanned cell. if cell is placed on the row where it is affected \n                        // by row spanned cell, then if we are inserting row below, need to add new cell with spanned cell width\n                        // or if we are inserting above, need to update row span value of the spanned cell.\n                        // if cell is placed inbetween the spanned cell , \n                        // then if we are inserting below, need to update row span value of spanned cell or\n                        // if we are inserting above, need to skip updating row span value except\n                        // if start cell is placed on the same row of spanned cell or if start cell placed in the same column.\n                        if (clonedRowIndex > cell.ownerRow.rowIndex) {\n                            if (rowPlacement === 'Above'\n                                && spannedCell.ownerRow === startCell.ownerRow) {\n                                continue;\n                            }\n                            else {\n                                spannedCell.cellFormat.rowSpan += 1;\n                                spannedCells.splice(j, 1);\n                                j--;\n                            }\n                        }\n                        else if (cell.cellIndex !== cell.columnIndex && isRowSpanned && clonedRowIndex === cell.ownerRow.rowIndex) {\n                            if (rowPlacement === 'Above') {\n                                spannedCell.cellFormat.rowSpan += 1;\n                                spannedCells.splice(j, 1);\n                                j--;\n                            }\n                            else {\n                                count++;\n                                cellFormats.push(spannedCell.cellFormat);\n                                spannedCells.splice(j, 1);\n                                j--;\n                            }\n                        }\n                    }\n                    else {\n                        if (spannedCell !== startCell) {\n                            if (rowPlacement === 'Above'\n                                && (spannedCell.ownerRow === startCell.ownerRow || spannedCell.columnIndex === startCell.columnIndex)) {\n                                continue;\n                            }\n                            else {\n                                if (spannedCell.columnIndex !== startCell.columnIndex\n                                    && spannedCell.ownerRow.rowIndex !== cell.ownerRow.rowIndex\n                                    && (clonedRowIndex > startCell.ownerRow.rowIndex\n                                        || (rowPlacement === 'Above' && clonedRowIndex === startCell.ownerRow.rowIndex))) {\n                                    spannedCell.cellFormat.rowSpan += 1;\n                                    spannedCells.splice(j, 1);\n                                    j--;\n                                }\n                            }\n                        }\n                    }\n                }\n            }\n            if (spannedCells.indexOf(cell) === -1 && cell.cellFormat.rowSpan > 1) {\n                isCellIncluded = true;\n            }\n            if (!isCellIncluded) {\n                count++;\n                cellFormats.push(cell.cellFormat);\n            }\n        }\n        return { count: count, cellFormats: cellFormats };\n    };\n    Editor.prototype.insertTableRows = function (table, prevBlock) {\n        this.initHistory('InsertRowBelow');\n        table.containerWidget = prevBlock.containerWidget;\n        prevBlock = prevBlock.combineWidget(this.viewer);\n        if (this.editorHistory) {\n            var clonedTable = this.cloneTableToHistoryInfo(prevBlock);\n        }\n        var row = prevBlock.childWidgets[prevBlock.childWidgets.length - 1];\n        prevBlock.insertTableRowsInternal(table.childWidgets, prevBlock.childWidgets.length);\n        var paragraph = this.selection.getFirstParagraph(row.nextWidget.childWidgets[0]);\n        this.viewer.layout.reLayoutTable(prevBlock);\n        this.selection.selectParagraph(paragraph, true);\n        if (this.editorHistory && this.editorHistory.currentBaseHistoryInfo) {\n            this.updateHistoryPosition(this.selection.start, true);\n            this.updateHistoryPosition(this.selection.end, false);\n        }\n        this.reLayout(this.selection);\n    };\n    /**\n     * Inserts the specified number of columns to the table left or right to the column at cursor position.\n     * @param {number} left The left parameter is optional and if omitted, it takes the value as false and\n     * inserts to the right of column at cursor position.\n     * @param {number} count The count parameter is optional and if omitted, it takes the value as 1.\n     */\n    Editor.prototype.insertColumn = function (left, count) {\n        if (this.owner.isReadOnlyMode) {\n            return;\n        }\n        var columnPlacement = left ? 'Left' : 'Right';\n        if (this.selection.start.paragraph.isInsideTable) {\n            if (this.checkIsNotRedoing()) {\n                this.initHistory(columnPlacement === 'Left' ? 'InsertColumnLeft' : 'InsertColumnRight');\n            }\n            this.selection.owner.isShiftingEnabled = true;\n            var startCell = this.getOwnerCell(this.selection.isForward);\n            var endCell = this.getOwnerCell(!this.selection.isForward);\n            var table = startCell.ownerRow.ownerTable.combineWidget(this.viewer);\n            if (this.editorHistory) {\n                //Clones the entire table to preserve in history.\n                var clonedTable = this.cloneTableToHistoryInfo(table);\n            }\n            this.selection.owner.isLayoutEnabled = false;\n            var cellIndex = startCell.columnIndex;\n            if (columnPlacement === 'Right') {\n                cellIndex = endCell.columnIndex + endCell.cellFormat.columnSpan;\n            }\n            var startParagraph = undefined;\n            var newCell = undefined;\n            var columnCount = count ? count : this.getColumnCountToInsert();\n            var rowSpannedCells = [];\n            var rowSpanCellIndex = cellIndex;\n            for (var i = 0; i < columnCount; i++) {\n                for (var j = 0; j < table.childWidgets.length; j++) {\n                    var row = table.childWidgets[j];\n                    newCell = this.createColumn(this.selection.getLastParagraph(startCell));\n                    newCell.index = j;\n                    newCell.rowIndex = row.rowIndex;\n                    newCell.containerWidget = row;\n                    newCell.cellFormat.copyFormat(startCell.cellFormat);\n                    newCell.cellFormat.rowSpan = 1;\n                    if (isNullOrUndefined(startParagraph)) {\n                        startParagraph = this.selection.getFirstParagraph(newCell);\n                    }\n                    if (cellIndex === 0) {\n                        row.childWidgets.splice(cellIndex, 0, newCell);\n                    }\n                    else {\n                        var isCellInserted = false;\n                        for (var j_1 = 0; j_1 < row.childWidgets.length; j_1++) {\n                            var rowCell = row.childWidgets[j_1];\n                            // Add the row spanned cells to colection for adding column before / after row spnned cells.\n                            if (rowCell.cellFormat.rowSpan > 1) {\n                                rowSpannedCells.push(rowCell);\n                            }\n                            if (rowCell.columnIndex + rowCell.cellFormat.columnSpan === cellIndex) {\n                                row.childWidgets.splice(rowCell.cellIndex + 1, 0, newCell);\n                                isCellInserted = true;\n                            }\n                            else if (cellIndex > rowCell.columnIndex && rowCell.columnIndex + rowCell.cellFormat.columnSpan > cellIndex\n                                && cellIndex < rowCell.columnIndex + rowCell.cellFormat.columnSpan) {\n                                row.childWidgets.splice(rowCell.cellIndex, 0, newCell);\n                                isCellInserted = true;\n                            }\n                            if (isCellInserted) {\n                                break;\n                            }\n                        }\n                        // If the cell is not inserted for row, then check for row spanned cells.\n                        if (!isCellInserted) {\n                            if (rowSpannedCells.length > 0) {\n                                for (var k = 0; k < rowSpannedCells.length; k++) {\n                                    var rowSpannedCell = rowSpannedCells[k];\n                                    if (rowSpannedCell.ownerRow !== row\n                                        && row.rowIndex <= rowSpannedCell.ownerRow.rowIndex + rowSpannedCell.cellFormat.rowSpan - 1) {\n                                        if (rowSpannedCell.columnIndex + rowSpannedCell.cellFormat.columnSpan === cellIndex) {\n                                            if (rowSpannedCell.cellIndex > row.childWidgets.length) {\n                                                row.childWidgets.push(newCell);\n                                            }\n                                            else {\n                                                row.childWidgets.splice(rowSpannedCell.cellIndex, 0, newCell);\n                                            }\n                                            isCellInserted = true;\n                                        }\n                                        else if (cellIndex > rowSpannedCell.columnIndex &&\n                                            rowSpannedCell.columnIndex + rowSpannedCell.cellFormat.columnSpan > cellIndex\n                                            && cellIndex < rowSpannedCell.columnIndex + rowSpannedCell.cellFormat.columnSpan) {\n                                            row.childWidgets.splice(rowSpannedCell.columnIndex, 0, newCell);\n                                            isCellInserted = true;\n                                        }\n                                    }\n                                    if (isCellInserted) {\n                                        break;\n                                    }\n                                }\n                            }\n                        }\n                    }\n                }\n            }\n            table.updateRowIndex(0);\n            var parentTable = this.viewer.layout.getParentTable(table);\n            if (parentTable) {\n                parentTable.fitChildToClientArea();\n            }\n            else {\n                table.fitChildToClientArea();\n            }\n            this.selection.owner.isLayoutEnabled = true;\n            table.isGridUpdated = false;\n            table.buildTableColumns();\n            table.isGridUpdated = true;\n            this.viewer.layout.reLayoutTable(table);\n            this.selection.start.setPosition(startParagraph.firstChild, true);\n            this.selection.end.setPosition(this.selection.getLastParagraph(newCell).firstChild, false);\n            if (this.checkIsNotRedoing() || isNullOrUndefined(this.editorHistory)) {\n                this.reLayout(this.selection);\n            }\n        }\n    };\n    /**\n     * Creates table with specified rows and columns.\n     * @private\n     */\n    Editor.prototype.createTable = function (rows, columns) {\n        var startPara = this.selection.start.paragraph;\n        var table = new TableWidget();\n        table.tableFormat = new WTableFormat(table);\n        table.tableFormat.preferredWidthType = 'Auto';\n        table.tableFormat.initializeTableBorders();\n        var index = 0;\n        while (index < rows) {\n            var tableRow = this.createRowAndColumn(columns, index);\n            tableRow.rowFormat.heightType = 'Auto';\n            tableRow.containerWidget = table;\n            table.childWidgets.push(tableRow);\n            index++;\n        }\n        return table;\n    };\n    Editor.prototype.createRowAndColumn = function (columns, rowIndex) {\n        var startPara = this.selection.start.paragraph;\n        var tableRow = new TableRowWidget();\n        tableRow.rowFormat = new WRowFormat(tableRow);\n        tableRow.index = rowIndex;\n        for (var i = 0; i < columns; i++) {\n            var tableCell = this.createColumn(startPara);\n            tableCell.index = i;\n            tableCell.rowIndex = rowIndex;\n            tableCell.containerWidget = tableRow;\n            tableRow.childWidgets.push(tableCell);\n        }\n        return tableRow;\n    };\n    Editor.prototype.createColumn = function (paragraph) {\n        var tableCell = new TableCellWidget();\n        var para = new ParagraphWidget();\n        para.paragraphFormat.copyFormat(paragraph.paragraphFormat);\n        para.characterFormat.copyFormat(paragraph.characterFormat);\n        para.containerWidget = tableCell;\n        tableCell.childWidgets.push(para);\n        tableCell.cellFormat = new WCellFormat(tableCell);\n        return tableCell;\n    };\n    Editor.prototype.getColumnCountToInsert = function () {\n        var count = 1;\n        var start = this.selection.start;\n        var end = this.selection.end;\n        if (!this.selection.isForward) {\n            start = this.selection.end;\n            end = this.selection.start;\n        }\n        if (start && end && this.selection.getTable(start, end)) {\n            if (start.paragraph.associatedCell === end.paragraph.associatedCell) {\n                return count = 1;\n            }\n            if (start.paragraph.associatedCell.ownerRow === end.paragraph.associatedCell.ownerRow) {\n                return count = count + end.paragraph.associatedCell.cellIndex - start.paragraph.associatedCell.cellIndex;\n            }\n            else {\n                count = 0;\n                // tslint:disable-next-line:max-line-length\n                var selectedCells = start.paragraph.associatedCell.ownerTable.getColumnCellsForSelection(start.paragraph.associatedCell, end.paragraph.associatedCell);\n                for (var i = 0; i < selectedCells.length; i++) {\n                    if (start.paragraph.associatedCell.ownerRow === selectedCells[i].ownerRow) {\n                        count++;\n                    }\n                }\n            }\n        }\n        return count === 0 ? 1 : count;\n    };\n    Editor.prototype.getRowCountToInsert = function () {\n        var count = 1;\n        var start = this.selection.start;\n        var end = this.selection.end;\n        if (!this.selection.isForward) {\n            start = this.selection.end;\n            end = this.selection.start;\n        }\n        if (!isNullOrUndefined(start) && !isNullOrUndefined(end) && !isNullOrUndefined(this.selection.getTable(start, end))) {\n            if (start.paragraph.associatedCell === end.paragraph.associatedCell ||\n                start.paragraph.associatedCell.ownerRow === end.paragraph.associatedCell.ownerRow) {\n                return count = 1;\n            }\n            else {\n                return count = count +\n                    this.getOwnerRow(!this.selection.isForward).rowIndex - this.getOwnerRow(this.selection.isForward).rowIndex;\n            }\n        }\n        return count === 0 ? 1 : count;\n    };\n    Editor.prototype.getOwnerCell = function (isStart) {\n        var cell = undefined;\n        var startCell = isStart ? this.selection.start.paragraph.associatedCell\n            : this.selection.end.paragraph.associatedCell;\n        var endCell = isStart ? this.selection.end.paragraph.associatedCell\n            : this.selection.start.paragraph.associatedCell;\n        cell = startCell;\n        var owner = cell.ownerTable;\n        while (!isNullOrUndefined(owner) && owner.containerWidget instanceof TableCellWidget && owner !== endCell.ownerTable) {\n            cell = owner.containerWidget;\n            owner = cell.ownerTable;\n        }\n        return cell;\n    };\n    Editor.prototype.getOwnerRow = function (isStart) {\n        var row;\n        var startRow = isStart ? this.selection.start.paragraph.associatedCell.ownerRow\n            : this.selection.end.paragraph.associatedCell.ownerRow;\n        var endRow = isStart ? this.selection.end.paragraph.associatedCell.ownerRow\n            : this.selection.start.paragraph.associatedCell.ownerRow;\n        row = startRow;\n        var owner = row.ownerTable;\n        while (!isNullOrUndefined(owner) && owner.containerWidget instanceof TableCellWidget && owner !== endRow.ownerTable) {\n            row = owner.containerWidget.ownerRow;\n            owner = row.ownerTable;\n        }\n        return row;\n    };\n    Editor.prototype.getOwnerTable = function (isStart) {\n        var table = undefined;\n        var startTable = this.selection.start.paragraph.associatedCell.ownerTable;\n        var endTable = this.selection.end.paragraph.associatedCell.ownerTable;\n        table = isStart ? startTable : endTable;\n        while (table.containerWidget instanceof TableCellWidget && table !== (isStart ? endTable : startTable)) {\n            table = table.containerWidget.ownerTable;\n        }\n        return table;\n    };\n    /**\n     * Merge Selected cells\n     * @private\n     */\n    Editor.prototype.mergeSelectedCellsInTable = function () {\n        if (!this.canMergeCells()) {\n            return;\n        }\n        if (this.checkIsNotRedoing()) {\n            this.initHistory('MergeCells');\n        }\n        this.selection.owner.isShiftingEnabled = true;\n        var startPosition = this.selection.start;\n        var endPosition = this.selection.end;\n        if (!this.selection.isForward) {\n            startPosition = this.selection.end;\n            endPosition = this.selection.start;\n        }\n        var startOwnerCell = this.getOwnerCell(this.selection.isForward);\n        var endOwnerCell = this.getOwnerCell(!this.selection.isForward);\n        var containerCell = this.selection.getContainerCellOf(startOwnerCell, endOwnerCell);\n        if (containerCell.ownerTable.contains(endOwnerCell)) {\n            if (!this.selection.containsCell(containerCell, endOwnerCell)) {\n                //Start and End are in different cells.               \n                var table = startOwnerCell.ownerTable.combineWidget(this.viewer);\n                startOwnerCell = this.selection.getSelectedCell(startOwnerCell, containerCell);\n                endOwnerCell = this.selection.getSelectedCell(endOwnerCell, containerCell);\n                //Merges the selected cells.               \n                var mergedCell = this.mergeSelectedCells(table, startOwnerCell, endOwnerCell);\n                var lastParagraph = this.selection.getLastParagraph(mergedCell);\n                endPosition.setPosition(lastParagraph.lastChild, false);\n            }\n        }\n        if (this.checkIsNotRedoing() || isNullOrUndefined(this.editorHistory)) {\n            this.reLayout(this.selection, false);\n        }\n    };\n    Editor.prototype.mergeSelectedCells = function (table, startCell, endCell) {\n        //Clones the entire table to preserve in history.\n        var clonedTable = this.cloneTableToHistoryInfo(table);\n        this.selection.owner.isLayoutEnabled = false;\n        //Merges the selected cells.\n        var start = this.selection.getCellLeft(startCell.ownerRow, startCell);\n        var end = start + startCell.cellFormat.cellWidth;\n        var endCellLeft = this.selection.getCellLeft(endCell.ownerRow, endCell);\n        var endCellRight = endCellLeft + endCell.cellFormat.cellWidth;\n        var cellInfo = this.updateSelectedCellsInTable(start, end, endCellLeft, endCellRight);\n        start = cellInfo.start;\n        end = cellInfo.end;\n        var count = table.childWidgets.indexOf(endCell.ownerRow);\n        var rowStartIndex = table.childWidgets.indexOf(startCell.ownerRow);\n        var mergedCell = undefined;\n        for (var i = rowStartIndex; i <= count; i++) {\n            var row = table.childWidgets[i];\n            for (var j = 0; j < row.childWidgets.length; j++) {\n                var cell = row.childWidgets[j];\n                var cellStart = this.selection.getCellLeft(row, cell);\n                if (HelperMethods.round(start, 2) <= HelperMethods.round(cellStart, 2)\n                    && HelperMethods.round(cellStart, 2) < HelperMethods.round(end, 2)) {\n                    if (isNullOrUndefined(mergedCell)) {\n                        mergedCell = cell;\n                    }\n                    else {\n                        if (i === rowStartIndex) {\n                            mergedCell.cellFormat.preferredWidth += cell.cellFormat.preferredWidth;\n                            mergedCell.cellFormat.columnSpan += cell.cellFormat.columnSpan;\n                            this.mergeBorders(mergedCell, cell);\n                        }\n                        for (var k = 0; k < cell.childWidgets.length; k++) {\n                            var block = cell.childWidgets[k];\n                            if (cell.childWidgets.length === 1 && block instanceof ParagraphWidget\n                                && block.childWidgets.length === 0) {\n                                break;\n                            }\n                            mergedCell.childWidgets.push(block.clone());\n                        }\n                        row.childWidgets.splice(j, 1);\n                        cell.destroy();\n                        j--;\n                    }\n                }\n            }\n            if (row.childWidgets.length === 0) {\n                var rowIndex = table.childWidgets.indexOf(row);\n                row.updateRowBySpannedCells();\n                table.childWidgets.splice(rowIndex, 1);\n                row.destroy();\n                count--;\n                i--;\n            }\n        }\n        if (!isNullOrUndefined(mergedCell) && rowStartIndex < count) {\n            mergedCell.cellFormat.rowSpan = count - rowStartIndex + 1;\n        }\n        this.updateBlockIndexAfterMerge(mergedCell);\n        table.updateRowIndex(0);\n        table.calculateGrid();\n        table.isGridUpdated = false;\n        table.buildTableColumns();\n        table.isGridUpdated = true;\n        this.viewer.layout.reLayoutTable(table);\n        //Layouts the table after merging cells.\n        this.selection.owner.isLayoutEnabled = true;\n        return mergedCell;\n    };\n    Editor.prototype.mergeBorders = function (mergedCell, tableCell) {\n        var mergedCellborders = undefined;\n        var cellBorders = null;\n        if (!isNullOrUndefined(mergedCell.cellFormat.borders)) {\n            mergedCellborders = mergedCell.cellFormat.borders;\n        }\n        if (!isNullOrUndefined(tableCell.cellFormat.borders)) {\n            cellBorders = tableCell.cellFormat.borders;\n        }\n        if (isNullOrUndefined(mergedCellborders) && isNullOrUndefined(cellBorders)) {\n            return;\n        }\n        if (isNullOrUndefined(mergedCellborders)) {\n            mergedCellborders = new WBorders(mergedCell.cellFormat);\n            mergedCellborders.copyFormat(cellBorders);\n        }\n        else if (isNullOrUndefined(cellBorders)) {\n            return;\n        }\n        else {\n            if (mergedCell.ownerRow.rowIndex === tableCell.ownerRow.rowIndex) {\n                mergedCellborders.top = mergedCell.getBorderBasedOnPriority(mergedCellborders.top, cellBorders.bottom);\n                mergedCellborders.bottom = mergedCell.getBorderBasedOnPriority(mergedCellborders.bottom, cellBorders.bottom);\n            }\n        }\n    };\n    Editor.prototype.updateBlockIndexAfterMerge = function (cell) {\n        for (var i = 0; i < cell.childWidgets.length; i++) {\n            cell.childWidgets[i].index = i;\n        }\n    };\n    /**\n     * Determines whether merge cell operation can be done.\n     */\n    Editor.prototype.canMergeCells = function () {\n        if (this.selection.isEmpty || !this.selection.start.paragraph.isInsideTable || !this.selection.end.paragraph.isInsideTable) {\n            return false;\n        }\n        var startPos = this.selection.start;\n        var endPos = this.selection.end;\n        if (!this.selection.isForward) {\n            startPos = this.selection.end;\n            endPos = this.selection.start;\n        }\n        var startCell = this.getOwnerCell(this.selection.isForward);\n        var endCell = this.getOwnerCell(!this.selection.isForward);\n        var containerCell = this.selection.getContainerCellOf(startCell, endCell);\n        if (containerCell.ownerTable.contains(endCell)) {\n            if (!this.selection.containsCell(containerCell, endCell)) {\n                startCell = this.selection.getSelectedCell(startCell, containerCell);\n                endCell = this.selection.getSelectedCell(endCell, containerCell);\n                var rowSpan = 1;\n                if (startCell.ownerRow === endCell.ownerRow) {\n                    var startCellIndex = startCell.ownerRow.childWidgets.indexOf(startCell);\n                    for (var i = startCellIndex; i <= startCell.ownerRow.childWidgets.indexOf(endCell); i++) {\n                        var cell = startCell.ownerRow.childWidgets[i];\n                        var prevCell = cell.previousWidget;\n                        if (i !== startCellIndex) {\n                            if (cell.cellFormat.rowSpan !== rowSpan) {\n                                return false;\n                            }\n                            if (!isNullOrUndefined(prevCell)\n                                && cell.columnIndex !== (prevCell.cellFormat.columnSpan + prevCell.columnIndex)) {\n                                return false;\n                            }\n                        }\n                        rowSpan = cell.cellFormat.rowSpan;\n                    }\n                    return true;\n                }\n                return this.canMergeSelectedCellsInTable(startCell.ownerTable, startCell, endCell);\n            }\n        }\n        return false;\n    };\n    Editor.prototype.canMergeSelectedCellsInTable = function (table, startCell, endCell) {\n        var count = table.childWidgets.indexOf(endCell.ownerRow);\n        var rowStartIndex = table.childWidgets.indexOf(startCell.ownerRow);\n        var startLeft = this.selection.getCellLeft(startCell.ownerRow, startCell);\n        var endLeft = startLeft + startCell.cellFormat.cellWidth;\n        var endCellLeft = this.selection.getCellLeft(endCell.ownerRow, endCell);\n        var endCellRight = endCellLeft + endCell.cellFormat.cellWidth;\n        var cellInfo = this.updateSelectedCellsInTable(startLeft, endLeft, endCellLeft, endCellRight);\n        startLeft = cellInfo.start;\n        endLeft = cellInfo.end;\n        var selectionLeft = 0;\n        var selectionRight = 0;\n        var isRowLeftWithinSel = false;\n        var isRowRightWithinSel = false;\n        var rowSpannedCells = [];\n        for (var i = rowStartIndex; i <= count; i++) {\n            var row = table.childWidgets[i];\n            var rowLeft = 0;\n            var rowRight = 0;\n            var isStarted = false;\n            for (var j = 0; j < row.childWidgets.length; j++) {\n                var cell = row.childWidgets[j];\n                var cellStart = this.selection.getCellLeft(row, cell);\n                if (this.checkCellWithInSelection(startLeft, endLeft, cellStart)) {\n                    isRowLeftWithinSel = false;\n                    isRowRightWithinSel = false;\n                    if (cell.cellFormat.rowSpan > 1) {\n                        rowSpannedCells.push(cell);\n                    }\n                    if (!isStarted) {\n                        rowLeft = cellStart;\n                        rowRight = cellStart;\n                        isStarted = true;\n                    }\n                    var prevCell = cell.previousWidget;\n                    if (rowRight !== 0 && HelperMethods.round(rowRight, 0) !== HelperMethods.round(cellStart, 0)) {\n                        rowRight = cellStart;\n                    }\n                    rowRight += HelperMethods.convertPointToPixel(cell.cellFormat.cellWidth);\n                    var isPrevCellWithinSel = this.checkPrevOrNextCellIsWithinSel(startLeft, endLeft, cell, true);\n                    var isNextCellWithinSel = this.checkPrevOrNextCellIsWithinSel(startLeft, endLeft, cell, false);\n                    // When selected cell not having row spanned cells and column index is not having immediate cell index value,\n                    // then returned false.\n                    var isNoRowSpan = rowSpannedCells.length === 0 || rowSpannedCells.length === 1 && rowSpannedCells[0] === cell;\n                    // checks whether current cell is with in selection.\n                    var isCellWithInSel = this.checkCurrentCell(rowSpannedCells, cell, isPrevCellWithinSel, isNextCellWithinSel);\n                    // when last selected row not having equal row span then returned false.\n                    if (i === count && !isNullOrUndefined(prevCell) && cell.cellFormat.rowSpan > prevCell.cellFormat.rowSpan\n                        && !isCellWithInSel) {\n                        return false;\n                    }\n                    if (i !== rowStartIndex) {\n                        for (var m = 0; m < rowSpannedCells.length; m++) {\n                            {\n                                var rowSpan = (rowSpannedCells[m].ownerRow.rowIndex + rowSpannedCells[m].cellFormat.rowSpan) - 1;\n                                if (rowSpan >= row.rowIndex) {\n                                    if (rowSpannedCells[m].columnIndex > cell.columnIndex) {\n                                        isRowRightWithinSel = true;\n                                    }\n                                    else {\n                                        isRowLeftWithinSel = true;\n                                    }\n                                    if (i === count && rowSpannedCells[m] !== cell\n                                        && rowSpan > (cell.ownerRow.rowIndex + cell.cellFormat.rowSpan - 1)) {\n                                        return false;\n                                    }\n                                    if (rowSpan === row.rowIndex && !this.checkPrevOrNextCellIsWithinSel(startLeft, endLeft, cell, false)) {\n                                        rowSpannedCells.splice(rowSpannedCells.indexOf(rowSpannedCells[m]), 1);\n                                    }\n                                }\n                            }\n                        }\n                    }\n                    if (isPrevCellWithinSel && !isNullOrUndefined(prevCell)\n                        && isNoRowSpan\n                        && (cell.columnIndex !== prevCell.columnIndex + 1 && this.checkCellWidth(cell))) {\n                        return false;\n                    }\n                }\n            }\n            if (i === rowStartIndex) {\n                selectionLeft = rowLeft;\n                selectionRight = rowRight;\n            }\n            else {\n                if (rowRight > 0 && rowLeft > 0) {\n                    if (!((isRowLeftWithinSel || Math.round(selectionLeft) === Math.round(rowLeft))\n                        && (isRowRightWithinSel || Math.round(selectionRight) === Math.round(rowRight)))) {\n                        return false;\n                    }\n                }\n                if (i === count) {\n                    return true;\n                }\n            }\n        }\n        return false;\n    };\n    Editor.prototype.checkCellWidth = function (cell) {\n        var prevCell = cell.previousWidget;\n        var cellLeft = this.viewer.selection.getCellLeft(cell.ownerRow, cell);\n        var prevCellLeft = this.viewer.selection.getCellLeft(cell.ownerRow, prevCell);\n        var left = prevCellLeft + HelperMethods.convertPointToPixel(prevCell.cellFormat.cellWidth);\n        if (HelperMethods.round(left, 2) !== HelperMethods.round(cellLeft, 2)) {\n            return true;\n        }\n        return false;\n    };\n    ;\n    Editor.prototype.checkCellWithInSelection = function (startLeft, endLeft, cellStart) {\n        if (HelperMethods.round(startLeft, 2) <= HelperMethods.round(cellStart, 2)\n            && HelperMethods.round(cellStart, 2) < HelperMethods.round(endLeft, 2)) {\n            return true;\n        }\n        return false;\n    };\n    ;\n    Editor.prototype.checkPrevOrNextCellIsWithinSel = function (startLeft, endLeft, cell, isPrev) {\n        var prevOrNextCell = isPrev ? cell.previousWidget : cell.nextWidget;\n        var cellStart = 0;\n        if (isNullOrUndefined(prevOrNextCell)) {\n            return false;\n        }\n        cellStart = this.viewer.selection.getCellLeft(prevOrNextCell.ownerRow, prevOrNextCell);\n        return this.checkCellWithInSelection(startLeft, endLeft, cellStart);\n    };\n    // tslint:disable-next-line:max-line-length\n    Editor.prototype.checkCurrentCell = function (rowSpannedCells, cell, isPrevCellWithInSel, isNextCellWithinSel) {\n        var cellOwner = cell.ownerRow;\n        if (rowSpannedCells.length > 0) {\n            for (var i = 0; i < rowSpannedCells.length; i++) {\n                var spannedCellOwner = rowSpannedCells[i].ownerRow;\n                var rowSpan = (spannedCellOwner.rowIndex + rowSpannedCells[i].cellFormat.rowSpan) - 1;\n                if (rowSpannedCells[i] === cell && (rowSpannedCells.length === 1 || this.checkRowSpannedCells(rowSpannedCells, cell))\n                    && !(isNextCellWithinSel || isPrevCellWithInSel)) {\n                    return true;\n                }\n                if (rowSpannedCells[i] !== cell && spannedCellOwner.rowIndex < cellOwner.rowIndex\n                    && rowSpan === (cellOwner.rowIndex + cell.cellFormat.rowSpan - 1)) {\n                    return true;\n                }\n            }\n        }\n        return false;\n    };\n    Editor.prototype.checkRowSpannedCells = function (rowSpannedCells, cell) {\n        for (var i = 0; i < rowSpannedCells.length; i++) {\n            if (rowSpannedCells[i] !== cell && rowSpannedCells[i].columnIndex === cell.columnIndex) {\n                return true;\n            }\n        }\n        return false;\n    };\n    /**\n     * @private\n     */\n    Editor.prototype.insertNewParagraphWidget = function (newParagraph, insertAfter) {\n        this.updateInsertPosition();\n        this.insertParagraph(newParagraph, insertAfter);\n        if (!insertAfter) {\n            var nextParagraph = void 0;\n            var currentParagraph = newParagraph;\n            do {\n                nextParagraph = this.selection.getNextParagraphBlock(currentParagraph);\n                currentParagraph = nextParagraph;\n            } while (nextParagraph && nextParagraph.equals(newParagraph));\n            if (!isNullOrUndefined(nextParagraph)) {\n                this.selection.selectParagraph(nextParagraph, true);\n            }\n            else {\n                this.selection.selectParagraph(newParagraph, true);\n            }\n        }\n        this.fireContentChange();\n    };\n    Editor.prototype.insertParagraph = function (newParagraph, insertAfter) {\n        var lineWidget = this.selection.start.currentWidget;\n        var offset = this.selection.start.offset;\n        var currentParagraph = this.selection.start.paragraph;\n        currentParagraph = currentParagraph.combineWidget(this.viewer);\n        if (insertAfter) {\n            // tslint:disable-next-line:max-line-length\n            var length_1 = this.selection.getLineLength(currentParagraph.lastChild);\n            var insertIndex_1 = newParagraph.firstChild ? newParagraph.firstChild.children.length : 0;\n            // tslint:disable-next-line:max-line-length\n            this.moveInlines(currentParagraph, newParagraph, insertIndex_1, offset, lineWidget, length_1, currentParagraph.lastChild);\n        }\n        else if (offset > 0) {\n            this.moveInlines(currentParagraph, newParagraph, 0, 0, currentParagraph.firstChild, offset, lineWidget);\n        }\n        var splittedWidget = currentParagraph.getSplitWidgets();\n        currentParagraph = insertAfter ? splittedWidget[splittedWidget.length - 1] : splittedWidget[0];\n        var insertIndex = currentParagraph.containerWidget.childWidgets.indexOf(currentParagraph);\n        if (insertAfter) {\n            insertIndex++;\n        }\n        var bodyWidget = currentParagraph.containerWidget;\n        newParagraph.index = currentParagraph.index;\n        newParagraph.containerWidget = bodyWidget;\n        bodyWidget.childWidgets.splice(insertIndex, 0, newParagraph);\n        this.updateNextBlocksIndex(insertAfter ? currentParagraph : newParagraph, true);\n        newParagraph.height = 0;\n        this.viewer.layout.layoutBodyWidgetCollection(newParagraph.index, bodyWidget, newParagraph, false);\n    };\n    // tslint:disable-next-line:max-line-length\n    Editor.prototype.moveInlines = function (currentParagraph, newParagraph, insertIndex, startOffset, startLine, endOffset, endLine) {\n        if (newParagraph.childWidgets.length === 0) {\n            var line = new LineWidget(newParagraph);\n            newParagraph.childWidgets.push(line);\n        }\n        var isMoved = false;\n        this.viewer.layout.clearListElementBox(currentParagraph);\n        this.viewer.layout.clearListElementBox(newParagraph);\n        for (var j = 0; j < currentParagraph.childWidgets.length; j++) {\n            var lineWidget = currentParagraph.childWidgets[j];\n            if (startLine === lineWidget && endLine === lineWidget) {\n                insertIndex = this.moveContent(lineWidget, startOffset, endOffset, insertIndex, newParagraph);\n                break;\n            }\n            if (endLine === lineWidget) {\n                insertIndex = this.moveContent(lineWidget, 0, endOffset, insertIndex, newParagraph);\n                break;\n            }\n            else if (startLine === lineWidget) {\n                isMoved = true;\n                // tslint:disable-next-line:max-line-length\n                insertIndex = this.moveContent(lineWidget, startOffset, this.viewer.selection.getLineLength(lineWidget), insertIndex, newParagraph);\n            }\n            else if (isMoved) {\n                insertIndex = this.moveContent(lineWidget, 0, this.viewer.selection.getLineLength(lineWidget), insertIndex, newParagraph);\n            }\n        }\n        this.removeEmptyLine(currentParagraph);\n        if (!currentParagraph.isInsideTable) {\n            this.viewer.layout.reLayoutParagraph(currentParagraph, 0, 0);\n        }\n    };\n    /**\n     * @private\n     */\n    //tslint:disable-next-line:max-line-length\n    Editor.prototype.moveContent = function (lineWidget, startOffset, endOffset, insertIndex, paragraph) {\n        var count = 0;\n        var lineIndex = lineWidget.paragraph.childWidgets.indexOf(lineWidget);\n        for (var i = 0; i < lineWidget.children.length; i++) {\n            var inline = lineWidget.children[i];\n            if (startOffset >= count + inline.length || inline instanceof ListTextElementBox) {\n                if (!(inline instanceof ListTextElementBox)) {\n                    count += inline.length;\n                }\n                continue;\n            }\n            var startIndex = 0;\n            if (startOffset > count) {\n                startIndex = startOffset - count;\n            }\n            var endIndex = endOffset - count;\n            if (endIndex > inline.length) {\n                endIndex = inline.length;\n            }\n            if (startIndex > 0) {\n                count += startIndex;\n            }\n            if (startIndex === 0 && endIndex === inline.length) {\n                paragraph.firstChild.children.splice(insertIndex, 0, inline);\n                inline.line = paragraph.firstChild;\n                insertIndex++;\n                // if (editAction < 4) {\n                // this.unLinkFieldCharacter(inline);\n                lineWidget.children.splice(i, 1);\n                i--;\n                // }\n            }\n            else if (inline instanceof TextElementBox) {\n                // if (editAction < 4) {\n                var span = new TextElementBox();\n                span.characterFormat.copyFormat(inline.characterFormat);\n                span.text = inline.text.substr(startIndex, endIndex - startIndex);\n                paragraph.firstChild.children.splice(insertIndex, 0, span);\n                span.line = paragraph.firstChild;\n                insertIndex++;\n                inline.text = inline.text.slice(0, startIndex) + inline.text.slice(endIndex);\n            }\n            if (endOffset <= count + endIndex - startIndex) {\n                break;\n            }\n            count += endIndex - startIndex;\n        }\n        return insertIndex;\n    };\n    /**\n     * update complex changes when history is not preserved\n     * @param  {number} action?\n     * @param  {string} start?\n     * @param  {string} end?\n     * @private\n     */\n    Editor.prototype.updateComplexWithoutHistory = function (action, start, end) {\n        var selection = this.viewer.selection;\n        if (action === 0) {\n            var startPosition = new TextPosition(selection.owner);\n            this.setPositionForCurrentIndex(startPosition, start);\n            this.viewer.layout.reLayoutParagraph(startPosition.paragraph, 0, 0);\n            this.setPositionForCurrentIndex(selection.start, end);\n            this.setPositionForCurrentIndex(selection.end, end);\n        }\n        if (action === 1) {\n            var startPosition = new TextPosition(selection.owner);\n            this.setPositionForCurrentIndex(startPosition, start);\n            var endPosition = new TextPosition(selection.owner);\n            this.setPositionForCurrentIndex(endPosition, end);\n            this.viewer.layout.reLayoutParagraph(startPosition.paragraph, 0, 0);\n            if (endPosition.paragraph !== startPosition.paragraph) {\n                this.viewer.layout.reLayoutParagraph(endPosition.paragraph, 0, 0);\n            }\n        }\n        if (selection.owner.isShiftingEnabled) {\n            this.viewer.layout.shiftLayoutedItems();\n            if (this.viewer.owner.enableHeaderAndFooter) {\n                this.updateHeaderFooterWidget();\n            }\n        }\n        selection.owner.isShiftingEnabled = false;\n        selection.start.updatePhysicalPosition(true);\n        if (selection.isEmpty) {\n            selection.end.setPositionInternal(selection.start);\n        }\n        else {\n            selection.end.updatePhysicalPosition(true);\n        }\n        selection.upDownSelectionLength = selection.end.location.x;\n        selection.fireSelectionChanged(true);\n        this.viewer.updateFocus();\n        this.viewer.updateScrollBars();\n        this.fireContentChange();\n        this.isHandledComplex = true;\n    };\n    /**\n     * reLayout\n     * @param selection\n     * @param isSelectionChanged\n     * @private\n     */\n    Editor.prototype.reLayout = function (selection, isSelectionChanged) {\n        if (this.editorHistory && this.editorHistory.isHandledComplexHistory()) {\n            if (isNullOrUndefined(this.editorHistory.currentBaseHistoryInfo)\n                || (this.editorHistory.currentBaseHistoryInfo\n                    && !(this.editorHistory.currentBaseHistoryInfo.action === 'ClearCharacterFormat'\n                        || this.editorHistory.currentBaseHistoryInfo.action === 'ClearParagraphFormat'))) {\n                this.startParagraph = undefined;\n                this.endParagraph = undefined;\n            }\n            this.isHandledComplex = false;\n            return;\n        }\n        if (isNullOrUndefined(this.viewer.blockToShift)) {\n            this.viewer.removeEmptyPages();\n            this.viewer.layout.updateFieldElements();\n            this.viewer.updateScrollBars();\n            if (!selection.owner.isShiftingEnabled) {\n                selection.fireSelectionChanged(true);\n                this.startParagraph = undefined;\n                this.endParagraph = undefined;\n            }\n        }\n        if (isNullOrUndefined(isSelectionChanged)) {\n            isSelectionChanged = selection.isEmpty;\n        }\n        if (selection.owner.isShiftingEnabled) {\n            selection.owner.isShiftingEnabled = false;\n            selection.owner.isLayoutEnabled = true;\n            this.viewer.layout.shiftLayoutedItems();\n            if (this.viewer.owner.enableHeaderAndFooter) {\n                this.updateHeaderFooterWidget();\n            }\n            this.getOffsetValue(selection);\n            selection.upDownSelectionLength = selection.end.location.x;\n            selection.fireSelectionChanged(true);\n            this.viewer.updateFocus();\n            this.startParagraph = undefined;\n            this.endParagraph = undefined;\n            this.viewer.layout.allowLayout = true;\n        }\n        if (this.editorHistory && this.editorHistory.currentBaseHistoryInfo &&\n            ((this.editorHistory.currentBaseHistoryInfo.action !== 'RowResizing'\n                && this.editorHistory.currentBaseHistoryInfo.action !== 'CellResizing')\n                || (this.editorHistory.isUndoing || this.editorHistory.isRedoing))) {\n            if (this.editorHistory.currentBaseHistoryInfo.modifiedProperties.length > 0) {\n                this.editorHistory.currentBaseHistoryInfo.updateSelection();\n            }\n            this.editorHistory.updateHistory();\n        }\n        this.fireContentChange();\n    };\n    /**\n     * @private\n     */\n    Editor.prototype.updateHeaderFooterWidget = function () {\n        this.updateHeaderFooterWidgetToPage(this.selection.start.paragraph.bodyWidget);\n        this.shiftPageContent(this.selection.start.paragraph.bodyWidget);\n    };\n    /**\n     * @private\n     */\n    Editor.prototype.updateHeaderFooterWidgetToPage = function (node) {\n        var currentPage = node.page;\n        node = this.viewer.layout.updateHeaderFooterToParent(node);\n        var isEvenPage = (node.headerFooterType === 'EvenHeader' || node.headerFooterType === 'EvenFooter');\n        for (var i = 0; i < this.viewer.pages.length; i++) {\n            var page = this.viewer.pages[i];\n            if ((i + 1 === 1) && page.bodyWidgets[0].sectionFormat.differentFirstPage &&\n                node.headerFooterType.indexOf('FirstPage') !== -1) {\n                return;\n            }\n            if (page.index === 0 && page.bodyWidgets[0].sectionFormat.differentFirstPage &&\n                node.headerFooterType.indexOf('FirstPage') === -1) {\n                continue;\n            }\n            if (currentPage !== page) {\n                if (page.bodyWidgets[0].sectionFormat.differentOddAndEvenPages) {\n                    if (isEvenPage && (i + 1) % 2 === 0) {\n                        this.updateHeaderFooterWidgetToPageInternal(page, node, node.headerFooterType.indexOf('Header') !== -1);\n                    }\n                    else if ((!isEvenPage && (i + 1) % 2 !== 0)) {\n                        if (page.bodyWidgets[0].sectionFormat.differentFirstPage && (i + 1 !== 1)) {\n                            this.updateHeaderFooterWidgetToPageInternal(page, node, node.headerFooterType.indexOf('Header') !== -1);\n                        }\n                    }\n                }\n                else {\n                    this.updateHeaderFooterWidgetToPageInternal(page, node, node.headerFooterType.indexOf('Header') !== -1);\n                }\n            }\n        }\n    };\n    /**\n     * @private\n     */\n    Editor.prototype.updateHeaderFooterWidgetToPageInternal = function (page, widget, isHeader) {\n        if (widget.page !== page) {\n            var hfWidget = widget.clone();\n            hfWidget.page = page;\n            this.viewer.updateHFClientArea(hfWidget.sectionFormat, isHeader);\n            hfWidget = this.viewer.layout.layoutHeaderFooterItems(this.viewer, hfWidget);\n            var headerOrFooter = void 0;\n            if (isHeader) {\n                headerOrFooter = page.headerWidget;\n                page.headerWidget = hfWidget;\n            }\n            else {\n                headerOrFooter = page.footerWidget;\n                page.footerWidget = hfWidget;\n            }\n            this.removeFieldInWidget(headerOrFooter);\n            headerOrFooter.destroy();\n        }\n    };\n    /**\n     * @private\n     */\n    Editor.prototype.removeFieldInWidget = function (widget) {\n        for (var i = 0; i < widget.childWidgets.length; i++) {\n            this.removeFieldInBlock(widget.childWidgets[i]);\n        }\n    };\n    /**\n     * @private\n     */\n    Editor.prototype.removeFieldInBlock = function (block) {\n        if (block instanceof TableWidget) {\n            this.removeFieldTable(block);\n        }\n        else {\n            this.removeField(block);\n        }\n    };\n    /**\n     * @private\n     */\n    Editor.prototype.removeFieldTable = function (table) {\n        for (var i = 0; i < table.childWidgets.length; i++) {\n            var row = table.childWidgets[i];\n            for (var j = 0; j < row.childWidgets.length; j++) {\n                this.removeFieldInWidget(row.childWidgets[j]);\n            }\n        }\n    };\n    /**\n     * @private\n     */\n    Editor.prototype.shiftPageContent = function (headerFooter) {\n        var type = headerFooter.headerFooterType;\n        var pageIndex;\n        if (type === 'FirstPageHeader' || type === 'FirstPageFooter') {\n            pageIndex = 0;\n        }\n        else if (headerFooter.sectionFormat.differentOddAndEvenPages) {\n            if (headerFooter.sectionFormat.differentFirstPage) {\n                pageIndex = (type === 'EvenHeader' || type === 'EvenFooter') ? 1 : 2;\n            }\n            else {\n                pageIndex = (type.indexOf('Even') === -1) ? 0 : 1;\n            }\n        }\n        else {\n            pageIndex = headerFooter.sectionFormat.differentFirstPage ? 1 : 0;\n            if (pageIndex === 1 && this.viewer.pages.length === 1) {\n                pageIndex = 0;\n            }\n        }\n        var page = this.viewer.pages[pageIndex];\n        if (type.indexOf('Header') !== -1) {\n            var firstBlock = page.bodyWidgets[0].firstChild;\n            var top_1 = HelperMethods.convertPointToPixel(headerFooter.sectionFormat.topMargin);\n            var headerDistance = HelperMethods.convertPointToPixel(headerFooter.sectionFormat.headerDistance);\n            top_1 = Math.max(headerDistance + page.headerWidget.height, top_1);\n            if (firstBlock.y !== top_1) {\n                this.viewer.updateClientArea(page.bodyWidgets[0].sectionFormat, page);\n                firstBlock = firstBlock.combineWidget(this.viewer);\n                var prevWidget = firstBlock.previousRenderedWidget;\n                if (prevWidget) {\n                    this.viewer.cutFromTop(prevWidget.y + prevWidget.height);\n                    if (firstBlock.containerWidget !== prevWidget.containerWidget) {\n                        // tslint:disable-next-line:max-line-length\n                        this.viewer.layout.updateContainerWidget(firstBlock, prevWidget.containerWidget, prevWidget.indexInOwner + 1, false);\n                    }\n                }\n                this.viewer.blockToShift = firstBlock;\n            }\n        }\n        else {\n            this.checkAndShiftFromBottom(page, headerFooter);\n        }\n        if (this.viewer.blockToShift) {\n            this.viewer.renderedLists.clear();\n            this.viewer.layout.shiftLayoutedItems();\n        }\n    };\n    /**\n     * @private\n     */\n    Editor.prototype.checkAndShiftFromBottom = function (page, footerWidget) {\n        var bodyWidget = page.bodyWidgets[0];\n        var blockToShift;\n        for (var i = 0; i < bodyWidget.childWidgets.length; i++) {\n            var block = bodyWidget.childWidgets[i];\n            if (block.y + block.height > footerWidget.y) {\n                blockToShift = block;\n                break;\n            }\n            if (bodyWidget.childWidgets.length - 1 === i && block.y + block.height < footerWidget.y) {\n                blockToShift = block;\n                break;\n            }\n        }\n        this.viewer.updateClientArea(bodyWidget.sectionFormat, page);\n        this.viewer.cutFromTop(blockToShift.y);\n        this.viewer.blockToShift = blockToShift;\n    };\n    //Paste Implementation ends\n    //Character Format apply implementation starts\n    /**\n     * Change HighlightColor\n     * @param  {HighlightColor} highlightColor\n     * Applies character format for selection.\n     * @param {string} property\n     * @param {Object} value\n     * @param {boolean} update\n     * @private\n     */\n    Editor.prototype.onApplyCharacterFormat = function (property, value, update) {\n        var selection = this.viewer.selection;\n        if (selection.owner.isReadOnlyMode || !selection.owner.isDocumentLoaded) {\n            return;\n        }\n        update = isNullOrUndefined(update) ? false : update;\n        var action = (property[0].toUpperCase() + property.slice(1));\n        var paragraph = selection.start.paragraph;\n        var lastLine = paragraph.childWidgets[paragraph.childWidgets.length - 1];\n        if (selection.isEmpty && selection.contextType !== 'List') {\n            selection.skipFormatRetrieval = true;\n            if (selection.end.isAtParagraphEnd) {\n                this.initHistory(action);\n                this.viewer.owner.isShiftingEnabled = true;\n                this.applyCharFormatValue(paragraph.characterFormat, property, value, update);\n                this.reLayout(this.viewer.selection);\n                this.viewer.updateFocus();\n            }\n            else {\n                selection.fireSelectionChanged(true);\n            }\n            selection.skipFormatRetrieval = false;\n            return;\n        }\n        this.setOffsetValue(selection);\n        this.initHistory(action);\n        // Todo: Complete Microsoft Word behavior on apply formatting in empty selection\n        // if (selection.isEmpty) {\n        //     this.viewer.owner.isShiftingEnabled = true;\n        //     this.applyCharFormatValue(paragraph.characterFormat, property, value, update);\n        //     this.reLayout(this.viewer.selection);\n        //     this.viewer.updateFocus();\n        //     return;\n        // }\n        if (selection.contextType === 'List') {\n            // this.updateCharacterFormatForListText(selection, action, value, update);\n            this.applyCharacterFormatForListText(selection, property, value, update);\n        }\n        else {\n            //Iterate and update format.\n            this.updateSelectionCharacterFormatting(property, value, update);\n        }\n    };\n    /**\n     * @private\n     */\n    // tslint:disable-next-line:max-line-length\n    Editor.prototype.applyCharacterFormatForListText = function (selection, property, values, update) {\n        var listLevel = this.getListLevel(selection.start.paragraph);\n        if (isNullOrUndefined(listLevel)) {\n            return;\n        }\n        var characterFormat = listLevel.characterFormat;\n        switch (property) {\n            case 'bold':\n                this.applyListCharacterFormatByValue(selection, characterFormat, 'bold', !(characterFormat.bold));\n                break;\n            case 'italic':\n                this.applyListCharacterFormatByValue(selection, characterFormat, 'italic', !(characterFormat.italic));\n                break;\n            case 'fontColor':\n                this.applyListCharacterFormatByValue(selection, characterFormat, 'fontColor', values);\n                break;\n            case 'fontFamily':\n                this.applyListCharacterFormatByValue(selection, characterFormat, 'fontFamily', values);\n                break;\n            case 'fontSize':\n                this.applyListCharacterFormatByValue(selection, characterFormat, 'fontSize', values);\n                break;\n            case 'highlightColor':\n                this.applyListCharacterFormatByValue(selection, characterFormat, 'highlightColor', values);\n                break;\n            case 'baselineAlignment':\n                if (characterFormat.baselineAlignment === values) {\n                    values = 'Normal';\n                }\n                this.applyListCharacterFormatByValue(selection, characterFormat, 'baselineAlignment', values);\n                break;\n            case 'strikethrough':\n                if (characterFormat.strikethrough === values) {\n                    values = 'None';\n                }\n                this.applyListCharacterFormatByValue(selection, characterFormat, 'strikethrough', values);\n                break;\n            case 'underline':\n                if (characterFormat.underline === values) {\n                    values = 'None';\n                }\n                this.applyListCharacterFormatByValue(selection, characterFormat, 'underline', values);\n                break;\n            case 'characterFormat':\n                this.applyListCharacterFormatByValue(selection, characterFormat, undefined, values);\n                break;\n        }\n    };\n    Editor.prototype.applyListCharacterFormatByValue = function (selection, format, property, value) {\n        this.initHistory('ListCharacterFormat');\n        this.applyCharFormatValue(format, property, value, false);\n        this.editorHistory.updateHistory();\n        this.reLayout(selection);\n        this.fireContentChange();\n    };\n    /**\n     * @private\n     */\n    Editor.prototype.updateListCharacterFormat = function (selection, property, value) {\n        this.updateListTextSelRange(selection, property, value, false);\n    };\n    Editor.prototype.updateListTextSelRange = function (selection, property, value, update) {\n        this.viewer.owner.isShiftingEnabled = true;\n        var startPositionInternal = selection.start;\n        var endPositionInternal = selection.end;\n        if (!selection.isForward) {\n            startPositionInternal = selection.end;\n            endPositionInternal = selection.start;\n        }\n        this.initHistoryPosition(selection, startPositionInternal);\n        var listLevel = this.getListLevel(selection.start.paragraph);\n        this.applyCharFormatValue(listLevel.characterFormat, property, value, update);\n        this.startSelectionReLayouting(startPositionInternal.paragraph, selection, startPositionInternal, endPositionInternal);\n    };\n    /**\n     * @private\n     */\n    Editor.prototype.getListLevel = function (paragraph) {\n        var currentList = undefined;\n        var listLevelNumber = 0;\n        if (!isNullOrUndefined(paragraph.paragraphFormat) && !isNullOrUndefined(paragraph.paragraphFormat.listFormat)) {\n            currentList = this.viewer.getListById(paragraph.paragraphFormat.listFormat.listId);\n            listLevelNumber = paragraph.paragraphFormat.listFormat.listLevelNumber;\n        }\n        if (!isNullOrUndefined(currentList) &&\n            !isNullOrUndefined(this.viewer.getAbstractListById(currentList.abstractListId))\n            // && !isNullOrUndefined(this.viewer.getAbstractListById(currentList.abstractListId).levels.getItem(listLevelNumber))) {\n            && !isNullOrUndefined(this.viewer.getAbstractListById(currentList.abstractListId).levels)) {\n            return this.viewer.layout.getListLevel(currentList, listLevelNumber);\n        }\n        return undefined;\n    };\n    Editor.prototype.updateInsertPosition = function () {\n        var selection = this.viewer.selection;\n        var position = selection.start;\n        if (!selection.isForward) {\n            position = selection.end;\n        }\n        if (this.editorHistory && !isNullOrUndefined(this.editorHistory.currentBaseHistoryInfo)\n            && !isNullOrUndefined(position)) {\n            if (isNullOrUndefined(this.editorHistory.currentBaseHistoryInfo.insertPosition)) {\n                this.updateHistoryPosition(position, true);\n            }\n        }\n    };\n    /**\n     * preserve paragraph and offset value for selection\n     * @private\n     */\n    Editor.prototype.setOffsetValue = function (selection) {\n        var info = this.getParagraphInfo(selection.start);\n        this.startParagraph = info.paragraph;\n        this.startOffset = info.offset;\n        info = this.getParagraphInfo(selection.end);\n        this.endParagraph = info.paragraph;\n        this.endOffset = info.offset;\n    };\n    /**\n     * Toggles the highlight color property of selected contents.\n     * @param {HighlightColor} highlightColor Default value of ‘underline’ parameter is Yellow.\n     */\n    Editor.prototype.toggleHighlightColor = function (highlightColor) {\n        var selection = this.viewer.selection;\n        if (isNullOrUndefined(highlightColor) || highlightColor === 'NoColor') {\n            highlightColor = 'Yellow';\n        }\n        //In Ms Word the highlight color is took from the ribbon. So we Have given yellow as constant.\n        if (selection.characterFormat.highlightColor === highlightColor) {\n            highlightColor = 'NoColor';\n        }\n        this.selection.characterFormat.highlightColor = highlightColor;\n    };\n    /**\n     * Toggles the subscript formatting of selected contents.\n     */\n    Editor.prototype.toggleSubscript = function () {\n        if (!this.owner.isReadOnlyMode) {\n            var value = this.selection.characterFormat.baselineAlignment === 'Subscript' ? 'Normal' : 'Subscript';\n            this.selection.characterFormat.baselineAlignment = value;\n        }\n    };\n    /**\n     * Toggles the superscript formatting of selected contents.\n     */\n    Editor.prototype.toggleSuperscript = function () {\n        if (!this.owner.isReadOnlyMode) {\n            var value = this.selection.characterFormat.baselineAlignment === 'Superscript' ? 'Normal' : 'Superscript';\n            this.selection.characterFormat.baselineAlignment = value;\n        }\n    };\n    /**\n     * Toggles the text alignment property of selected contents.\n     * @param {TextAlignment} textAlignment Default value of ‘textAlignment parameter is TextAlignment.Left.\n     */\n    /**\n     * Increases the left indent of selected paragraphs to a factor of 36 points.\n     */\n    Editor.prototype.increaseIndent = function () {\n        if (!this.owner.isReadOnlyMode) {\n            this.onApplyParagraphFormat('leftIndent', this.viewer.defaultTabWidth, true, false);\n        }\n    };\n    /**\n     * Decreases the left indent of selected paragraphs to a factor of 36 points.\n     */\n    Editor.prototype.decreaseIndent = function () {\n        if (!this.owner.isReadOnlyMode) {\n            this.onApplyParagraphFormat('leftIndent', -this.viewer.defaultTabWidth, true, false);\n        }\n    };\n    /**\n     * Clears the list format for selected paragraphs.\n     */\n    Editor.prototype.clearList = function () {\n        this.selection.owner.editorModule.onApplyList(undefined);\n    };\n    /**\n     * Applies the bullet list to selected paragraphs.\n     * @param {string} bullet Bullet character\n     * @param {string} fontFamily Bullet font family\n     */\n    Editor.prototype.applyBullet = function (bullet, fontFamily) {\n        if (!this.owner.isReadOnlyMode) {\n            this.applyBulletOrNumbering(bullet, 'Bullet', fontFamily);\n        }\n    };\n    /**\n     * Applies the numbering list to selected paragraphs.\n     * @param numberFormat  “%n” representations in ‘numberFormat’ parameter will be replaced by respective list level’s value.\n     * `“%1)” will be displayed as “1)” `\n     * @param listLevelPattern  Default value of ‘listLevelPattern’ parameter is ListLevelPattern.Arabic\n     */\n    Editor.prototype.applyNumbering = function (numberFormat, listLevelPattern) {\n        if (!this.owner.isReadOnlyMode) {\n            this.applyBulletOrNumbering(numberFormat, listLevelPattern, 'Verdana');\n        }\n    };\n    /**\n     * Toggles the baseline alignment property of selected contents.\n     * @param  {Selection} selection\n     * @param  {BaselineAlignment} baseAlignment\n     */\n    Editor.prototype.toggleBaselineAlignment = function (baseAlignment) {\n        this.updateProperty(2, baseAlignment);\n    };\n    /**\n     * Clears the formatting.\n     */\n    Editor.prototype.clearFormatting = function () {\n        var selection = this.viewer.selection;\n        this.initComplexHistory('ClearFormat');\n        // let startIndex: string = selection.start.getHierarchicalIndexInternal();\n        // let endIndex: string = selection.end.getHierarchicalIndexInternal();\n        if (selection.isEmpty) {\n            selection.start.moveToParagraphStartInternal(selection, false);\n            selection.end.moveToParagraphEndInternal(selection, false);\n        }\n        this.setOffsetValue(selection);\n        if (this.editorHistory) {\n            this.editorHistory.initializeHistory('ClearCharacterFormat');\n        }\n        this.updateSelectionCharacterFormatting('ClearCharacterFormat', undefined, false);\n        this.getOffsetValue(selection);\n        if (this.editorHistory) {\n            this.editorHistory.updateHistory();\n        }\n        this.setOffsetValue(selection);\n        if (this.editorHistory) {\n            this.editorHistory.initializeHistory('ClearParagraphFormat');\n        }\n        this.updateParagraphFormatInternal('ClearParagraphFormat', undefined, false);\n        if (this.editorHistory) {\n            this.editorHistory.updateHistory();\n        }\n        this.getOffsetValue(selection);\n        if (this.editorHistory && !isNullOrUndefined(this.editorHistory.currentHistoryInfo)) {\n            this.editorHistory.updateComplexHistory();\n        }\n        this.startParagraph = undefined;\n        this.endParagraph = undefined;\n        // else {\n        //     this.checkAndUpdatedSelection(startIndex, endIndex);\n        // }\n    };\n    /**\n     * Toggles the specified property. If property is assigned already. Then property will be changed\n     * @param  {Selection} selection\n     * @param  {number} type\n     * @param  {Object} value\n     * @private\n     */\n    Editor.prototype.updateProperty = function (type, value) {\n        var selection = this.selection;\n        if (selection.owner.isReadOnlyMode || !selection.owner.isDocumentLoaded) {\n            return;\n        }\n        var startPosition = selection.start;\n        var endPosition = selection.end;\n        if (!selection.isForward) {\n            startPosition = selection.end;\n            endPosition = selection.start;\n        }\n        var indexInInline = 0;\n        var inlineObj = startPosition.currentWidget.getInline(startPosition.offset, indexInInline);\n        var inline = inlineObj.element;\n        indexInInline = inlineObj.index;\n        var paragraph = startPosition.paragraph;\n        if (!isNullOrUndefined(inline) && inline.length === indexInInline && !this.selection.isEmpty) {\n            inline = inline.nextNode;\n        }\n        if (type === 1) {\n            var currentUnderline = 'None';\n            if (!isNullOrUndefined(inline)) {\n                currentUnderline = inline.characterFormat.underline;\n            }\n            else if (!isNullOrUndefined(paragraph)) {\n                currentUnderline = paragraph.characterFormat.underline;\n            }\n            this.selection.characterFormat.underline = value === currentUnderline ? 'None' : value;\n        }\n        else {\n            var script = 'Normal';\n            if (!isNullOrUndefined(inline)) {\n                script = inline.characterFormat.baselineAlignment;\n            }\n            else if (!isNullOrUndefined(paragraph)) {\n                script = paragraph.characterFormat.baselineAlignment;\n            }\n            if (script === value) {\n                value = 'Normal';\n            }\n            this.selection.characterFormat.baselineAlignment = value;\n        }\n    };\n    Editor.prototype.getCompleteStyles = function () {\n        var completeStylesString = '{\"styles\":[';\n        for (var _i = 0, _a = this.viewer.preDefinedStyles.getItem(); _i < _a.length; _i++) {\n            var name_1 = _a[_i];\n            completeStylesString += (this.viewer.preDefinedStyles.get(name_1) + ',');\n        }\n        return completeStylesString.slice(0, -1) + ']}';\n    };\n    /**\n     * Initialize default styles\n     * @private\n     */\n    Editor.prototype.intializeDefaultStyles = function () {\n        var existingStyles = this.owner.getStyleNames('Paragraph');\n        var defaultStyleNames = ['Normal', 'Heading 1', 'Heading 2', 'Heading 3', 'Heading 4', 'Heading 5', 'Heading 6'];\n        var styleNames = defaultStyleNames.filter(function (val) {\n            return existingStyles.indexOf(val) === -1;\n        });\n        for (var _i = 0, styleNames_1 = styleNames; _i < styleNames_1.length; _i++) {\n            var name_2 = styleNames_1[_i];\n            this.createStyle(this.viewer.preDefinedStyles.get(name_2));\n        }\n    };\n    /**\n     * Creates a new instance of Style.\n     */\n    Editor.prototype.createStyle = function (styleString) {\n        this.createStyleIn(styleString);\n    };\n    /**\n     * Create a Style.\n     * @private\n     */\n    Editor.prototype.createStyleIn = function (styleString) {\n        /* tslint:disable:no-any */\n        var style = JSON.parse(styleString);\n        var styleObj = this.viewer.styles.findByName(style.name);\n        if (styleObj !== undefined) {\n            //Create a new style with new name and add it to collection.\n            style.name = this.getUniqueStyleName(style.name);\n        }\n        this.viewer.owner.parser.parseStyle(JSON.parse(this.getCompleteStyles()), style, this.viewer.styles);\n        return this.viewer.styles.findByName(style.name);\n    };\n    /**\n     * @private\n     */\n    Editor.prototype.getUniqueStyleName = function (name) {\n        var uniqueName = this.getUniqueName(name);\n        var style = this.viewer.styles.findByName(uniqueName);\n        while (!isNullOrUndefined(style)) {\n            uniqueName = this.getUniqueStyleName(style.name);\n            style = this.viewer.styles.findByName(uniqueName);\n        }\n        return uniqueName;\n    };\n    Editor.prototype.getUniqueName = function (name) {\n        var matchArray = name.match(/\\d+$/);\n        var returnName;\n        if (!isNullOrUndefined(matchArray) && matchArray.length > 0) {\n            return name.replace(matchArray[0], (parseInt(matchArray[0], 10) + 1).toString());\n        }\n        else {\n            return name + '_1';\n        }\n    };\n    /**\n     * Update Character format for selection\n     * @private\n     */\n    Editor.prototype.updateSelectionCharacterFormatting = function (property, values, update) {\n        if (isNullOrUndefined(property)) {\n            property = 'CharacterFormat';\n        }\n        switch (property) {\n            case 'bold':\n                this.updateCharacterFormat('bold', values);\n                break;\n            case 'italic':\n                this.updateCharacterFormat('italic', values);\n                break;\n            case 'fontColor':\n                this.updateCharacterFormat('fontColor', values);\n                break;\n            case 'fontFamily':\n                this.updateCharacterFormat('fontFamily', values);\n                break;\n            case 'fontSize':\n                this.updateCharacterFormatWithUpdate(this.viewer.selection, 'fontSize', values, update);\n                break;\n            case 'highlightColor':\n                this.updateCharacterFormat('highlightColor', values);\n                break;\n            case 'baselineAlignment':\n                this.updateCharacterFormat('baselineAlignment', values);\n                break;\n            case 'strikethrough':\n                this.updateCharacterFormat('strikethrough', values);\n                break;\n            case 'underline':\n                this.updateCharacterFormat('underline', values);\n                break;\n            case 'styleName':\n                this.updateCharacterFormatWithUpdate(this.viewer.selection, 'styleName', values, true);\n                break;\n            case 'CharacterFormat':\n                this.updateCharacterFormat(undefined, values);\n                break;\n            case 'ClearCharacterFormat':\n                this.updateCharacterFormat(undefined, values);\n                break;\n        }\n        this.reLayout(this.viewer.selection);\n    };\n    /**\n     * Update character format for selection range\n     * @param  {SelectionRange} selectionRange\n     * @param  {string} property\n     * @param  {Object} value\n     * @returns void\n     * @private\n     */\n    Editor.prototype.updateCharacterFormat = function (property, value) {\n        this.updateCharacterFormatWithUpdate(this.viewer.selection, property, value, false);\n    };\n    Editor.prototype.updateCharacterFormatWithUpdate = function (selection, property, value, update) {\n        this.viewer.owner.isShiftingEnabled = true;\n        var startPosition = selection.start;\n        var endPosition = selection.end;\n        if (!selection.isForward) {\n            startPosition = selection.end;\n            endPosition = selection.start;\n        }\n        this.applyCharFormatSelectedContent(startPosition.paragraph, selection, startPosition, endPosition, property, value, update);\n    };\n    // tslint:disable-next-line:max-line-length\n    Editor.prototype.applyCharFormatSelectedContent = function (paragraph, selection, start, end, property, value, update) {\n        //Selection start in cell.\n        if (start.paragraph.isInsideTable && (!end.paragraph.isInsideTable\n            || start.paragraph.associatedCell !== end.paragraph.associatedCell\n            || selection.isCellSelected(start.paragraph.associatedCell, start, end))) {\n            var cell = void 0;\n            start.paragraph.associatedCell.ownerTable.combineWidget(this.viewer);\n            if (this.checkInsertPosition(selection)) {\n                this.updateHistoryPosition(start, true);\n            }\n            cell = start.paragraph.associatedCell;\n            this.applyCharFormatCell(cell, selection, start, end, property, value, update);\n            var table = cell.ownerTable;\n            // tslint:disable-next-line:max-line-length\n            this.viewer.layout.layoutBodyWidgetCollection(table.index, table.containerWidget, table, false);\n        }\n        else {\n            this.applyCharFormat(paragraph, selection, start, end, property, value, update);\n        }\n    };\n    // tslint:disable-next-line:max-line-length\n    Editor.prototype.applyCharFormatForSelectedPara = function (paragraph, selection, property, value, update) {\n        for (var i = 0; i < paragraph.childWidgets.length; i++) {\n            var line = paragraph.childWidgets[i];\n            for (var j = 0; j < line.children.length; j++) {\n                var element = line.children[j];\n                this.applyCharFormatValue(element.characterFormat, property, value, update);\n            }\n        }\n        this.applyCharFormatValue(paragraph.characterFormat, property, value, update);\n    };\n    Editor.prototype.splittedLastParagraph = function (paragraph) {\n        var splittedWidets = paragraph.getSplitWidgets();\n        return splittedWidets[splittedWidets.length - 1];\n    };\n    // tslint:disable-next-line:max-line-length\n    Editor.prototype.getNextParagraphForCharacterFormatting = function (block, start, end, property, value, update) {\n        var widgetCollection = block.getSplitWidgets();\n        block = widgetCollection[widgetCollection.length - 1];\n        block = this.viewer.selection.getNextRenderedBlock(block);\n        if (!isNullOrUndefined(block)) {\n            if (block instanceof ParagraphWidget) {\n                this.applyCharFormat(block, this.viewer.selection, start, end, property, value, update);\n            }\n            else {\n                this.applyCharFormatForTable(0, block, this.viewer.selection, start, end, property, value, update);\n            }\n        }\n    };\n    // tslint:disable-next-line:max-line-length\n    Editor.prototype.applyCharFormat = function (paragraph, selection, start, end, property, value, update) {\n        paragraph = paragraph.combineWidget(this.viewer);\n        var startOffset = 0;\n        var length = selection.getParagraphLength(paragraph);\n        var startLineWidget = paragraph.childWidgets.indexOf(start.currentWidget) !== -1 ?\n            paragraph.childWidgets.indexOf(start.currentWidget) : 0;\n        var endOffset = end.offset;\n        var endLineWidget = paragraph.childWidgets.indexOf(end.currentWidget) !== -1 ?\n            paragraph.childWidgets.indexOf(end.currentWidget) : paragraph.childWidgets.length - 1;\n        if (!isNullOrUndefined(selection)) {\n            if (paragraph === start.paragraph) {\n                startOffset = start.offset;\n            }\n        }\n        if (!paragraph.equals(end.paragraph)) {\n            this.applyCharFormatValue(paragraph.characterFormat, property, value, update);\n            endOffset = length;\n        }\n        else {\n            var lastLine = paragraph.childWidgets[paragraph.childWidgets.length - 1];\n            if (selection.isParagraphLastLine(lastLine) && end.currentWidget === lastLine\n                && ((endOffset === selection.getLineLength(lastLine) + 1) || (selection.isEmpty && selection.end.isAtParagraphEnd))) {\n                this.applyCharFormatValue(paragraph.characterFormat, property, value, update);\n            }\n        }\n        // let count: number = 0;\n        for (var i = startLineWidget; i <= endLineWidget; i++) {\n            var line = paragraph.childWidgets[i];\n            if (i !== startLineWidget) {\n                startOffset = selection.getStartLineOffset(line);\n            }\n            if (line === end.currentWidget) {\n                endOffset = end.offset;\n            }\n            else {\n                endOffset = selection.getLineLength(line);\n            }\n            var count = 0;\n            for (var j = 0; j < line.children.length; j++) {\n                var inlineObj = line.children[j];\n                if (inlineObj instanceof ListTextElementBox) {\n                    continue;\n                }\n                if (startOffset >= count + inlineObj.length) {\n                    count += inlineObj.length;\n                    continue;\n                }\n                var startIndex = 0;\n                if (startOffset > count) {\n                    startIndex = startOffset - count;\n                }\n                var endIndex = endOffset - count;\n                var inlineLength = inlineObj.length;\n                if (endIndex > inlineLength) {\n                    endIndex = inlineLength;\n                }\n                j += this.applyCharFormatInline(inlineObj, selection, startIndex, endIndex, property, value, update);\n                if (endOffset <= count + inlineLength) {\n                    break;\n                }\n                count += inlineLength;\n            }\n        }\n        var endParagraph = end.paragraph;\n        this.viewer.layout.reLayoutParagraph(paragraph, startLineWidget, 0);\n        if (paragraph.equals(endParagraph)) {\n            return;\n        }\n        this.getNextParagraphForCharacterFormatting(paragraph, start, end, property, value, update);\n    };\n    /**\n     * Toggles the bold property of selected contents.\n     */\n    Editor.prototype.toggleBold = function () {\n        if (this.viewer.owner.isReadOnlyMode) {\n            return;\n        }\n        var value = this.getCurrentSelectionValue('bold');\n        this.selection.characterFormat.bold = value;\n    };\n    /**\n     * Toggles the bold property of selected contents.\n     */\n    Editor.prototype.toggleItalic = function () {\n        if (this.viewer.owner.isReadOnlyMode) {\n            return;\n        }\n        var value = this.getCurrentSelectionValue('italic');\n        this.selection.characterFormat.italic = value;\n    };\n    Editor.prototype.getCurrentSelectionValue = function (property) {\n        var value = false;\n        if ((property === 'bold' || property === 'italic')) {\n            var index = 0;\n            var start = this.selection.start;\n            if (!this.selection.isForward) {\n                start = this.selection.end;\n            }\n            var lineWidget = start.currentWidget;\n            var inlineObj = lineWidget.getInline(start.offset, index);\n            var inline = inlineObj.element;\n            // inline.ownerBase\n            index = inlineObj.index;\n            var characterFormat = lineWidget.paragraph.characterFormat;\n            if (!isNullOrUndefined(inline)) {\n                if (!this.selection.isEmpty && index === inline.length) {\n                    characterFormat = isNullOrUndefined(inline.nextNode) ? lineWidget.paragraph.characterFormat\n                        : inline.nextNode.characterFormat;\n                }\n                else {\n                    characterFormat = inline.characterFormat;\n                }\n            }\n            if (property === 'bold') {\n                value = !(characterFormat.bold);\n            }\n            if (property === 'italic') {\n                value = !(characterFormat.italic);\n            }\n        }\n        return value;\n    };\n    /**\n     * Toggles the underline property of selected contents.\n     * @param underline Default value of ‘underline’ parameter is Single.\n     */\n    Editor.prototype.toggleUnderline = function (underline) {\n        if (!this.owner.isReadOnlyMode) {\n            this.updateProperty(1, underline);\n        }\n    };\n    /**\n     * Toggles the strike through property of selected contents.\n     * @param {Strikethrough} strikethrough Default value of strikethrough parameter is SingleStrike.\n     */\n    Editor.prototype.toggleStrikethrough = function (strikethrough) {\n        if (!this.owner.isReadOnlyMode) {\n            var value = void 0;\n            if (isNullOrUndefined(strikethrough)) {\n                value = this.selection.characterFormat.strikethrough === 'SingleStrike' ? 'None' : 'SingleStrike';\n            }\n            else {\n                value = strikethrough;\n            }\n            this.selection.characterFormat.strikethrough = value;\n        }\n    };\n    Editor.prototype.updateFontSize = function (format, value) {\n        if (typeof (value) === 'number' && !(value < 0 && format.fontSize === 1)) {\n            return format.fontSize + value;\n        }\n        var fontsizeCollection = [8, 9, 10, 11, 12, 14, 16, 18, 20, 24, 26, 28, 36, 48, 72];\n        if (typeof (value) === 'string' && value === 'increment') {\n            if (format.fontSize < 8) {\n                return format.fontSize + 1;\n            }\n            else if (format.fontSize >= 72 && format.fontSize < 80) {\n                return 80;\n            }\n            else if (format.fontSize >= 80) {\n                return format.fontSize + 10;\n            }\n            else {\n                for (var i = 0; i < fontsizeCollection.length; i++) {\n                    if (format.fontSize < fontsizeCollection[i]) {\n                        return fontsizeCollection[i];\n                    }\n                }\n            }\n        }\n        else if (typeof (value) === 'string' && value === 'decrement' && format.fontSize > 1) {\n            if (format.fontSize <= 8) {\n                return format.fontSize - 1;\n            }\n            else if (format.fontSize > 72 && format.fontSize <= 80) {\n                return 72;\n            }\n            else if (format.fontSize > 80) {\n                return format.fontSize - 10;\n            }\n            else {\n                for (var i = 0; i < fontsizeCollection.length; i++) {\n                    if (format.fontSize <= fontsizeCollection[i]) {\n                        return fontsizeCollection[i - 1];\n                    }\n                }\n            }\n        }\n        return format.fontSize;\n    };\n    // Inline\n    // tslint:disable-next-line:max-line-length\n    Editor.prototype.applyCharFormatInline = function (inline, selection, startIndex, endIndex, property, value, update) {\n        if (startIndex === 0 && endIndex === inline.length) {\n            this.applyCharFormatValue(inline.characterFormat, property, value, update);\n            return 0;\n        }\n        else if (inline instanceof TextElementBox) {\n            return this.formatInline(inline, selection, startIndex, endIndex, property, value, update);\n        }\n        return 0;\n    };\n    // tslint:disable-next-line:max-line-length\n    Editor.prototype.formatInline = function (inline, selection, startIndex, endIndex, property, value, update) {\n        var x = 0;\n        var node = inline;\n        var index = inline.line.children.indexOf(node);\n        var paragraph = inline.paragraph;\n        var lineIndex = paragraph.childWidgets.indexOf(inline.line);\n        var textElement;\n        if (startIndex > 0) {\n            textElement = new TextElementBox();\n            textElement.characterFormat.copyFormat(inline.characterFormat);\n            textElement.line = inline.line;\n            textElement.text = inline.text.substr(startIndex, endIndex - startIndex);\n            this.applyCharFormatValue(textElement.characterFormat, property, value, update);\n            index++;\n            node.line.children.splice(index, 0, textElement);\n            x++;\n            // this.addToLinkedFields(span);                      \n        }\n        if (endIndex < node.length) {\n            textElement = new TextElementBox();\n            textElement.characterFormat.copyFormat(inline.characterFormat);\n            textElement.text = node.text.substring(endIndex);\n            textElement.line = inline.line;\n            index++;\n            node.line.children.splice(index, 0, textElement);\n            x++;\n            // this.addToLinkedFields(span);                       \n        }\n        if (startIndex === 0) {\n            inline.text = inline.text.substr(0, endIndex);\n            this.applyCharFormatValue(inline.characterFormat, property, value, update);\n        }\n        else {\n            inline.text = inline.text.substr(0, startIndex);\n        }\n        return x;\n    };\n    // Cell\n    // tslint:disable-next-line:max-line-length\n    Editor.prototype.applyCharFormatCell = function (cell, selection, start, end, property, value, update) {\n        if (end.paragraph.isInsideTable) {\n            var containerCell = selection.getContainerCellOf(cell, end.paragraph.associatedCell);\n            if (containerCell.ownerTable.contains(end.paragraph.associatedCell)) {\n                var startCell = selection.getSelectedCell(cell, containerCell);\n                var endCell = selection.getSelectedCell(end.paragraph.associatedCell, containerCell);\n                if (selection.containsCell(containerCell, end.paragraph.associatedCell)) {\n                    //Selection end is in container cell.\n                    if (selection.isCellSelected(containerCell, start, end)) {\n                        value = this.getCharacterFormatValueOfCell(cell, selection, value, property);\n                        this.applyCharFormatForSelectedCell(containerCell, selection, property, value, update);\n                    }\n                    else {\n                        if (startCell === containerCell) {\n                            this.applyCharFormat(start.paragraph, selection, start, end, property, value, update);\n                        }\n                        else {\n                            this.applyCharFormatRow(startCell.ownerRow, selection, start, end, property, value, update);\n                        }\n                    }\n                }\n                else {\n                    this.applyCharFormatForTableCell(containerCell.ownerTable, selection, containerCell, endCell, property, value, update);\n                }\n            }\n            else {\n                this.applyCharFormatRow(containerCell.ownerRow, selection, start, end, property, value, update);\n            }\n        }\n        else {\n            var tableCell = selection.getContainerCell(cell);\n            this.applyCharFormatRow(tableCell.ownerRow, selection, start, end, property, value, update);\n        }\n    };\n    // tslint:disable-next-line:max-line-length\n    Editor.prototype.applyCharFormatForSelectedCell = function (cell, selection, property, value, update) {\n        for (var i = 0; i < cell.childWidgets.length; i++) {\n            var block = cell.childWidgets[i];\n            if (block instanceof ParagraphWidget) {\n                this.applyCharFormatForSelectedPara(block, selection, property, value, update);\n            }\n            else {\n                this.applyCharFormatForSelTable(block, selection, property, value, update);\n            }\n        }\n    };\n    // Row\n    // tslint:disable-next-line:max-line-length\n    Editor.prototype.applyCharFormatRow = function (row, selection, start, end, property, value, update) {\n        value = this.getCharacterFormatValueOfCell(row.childWidgets[0], selection, value, property);\n        this.applyCharFormatForTable(row.rowIndex, row.ownerTable, selection, start, end, property, value, update);\n    };\n    // Table\n    // tslint:disable-next-line:max-line-length\n    Editor.prototype.applyCharFormatForTable = function (index, table, selection, start, end, property, value, update) {\n        table = table.combineWidget(this.viewer);\n        for (var i = index; i < table.childWidgets.length; i++) {\n            var row = table.childWidgets[i];\n            for (var j = 0; j < row.childWidgets.length; j++) {\n                this.applyCharFormatForSelectedCell(row.childWidgets[j], selection, property, value, update);\n            }\n            if (end.paragraph.isInsideTable && selection.containsRow(row, end.paragraph.associatedCell)) {\n                this.viewer.layout.layoutBodyWidgetCollection(table.index, table.containerWidget, table, false);\n                return;\n            }\n        }\n        this.viewer.layout.layoutBodyWidgetCollection(table.index, table.containerWidget, table, false);\n        this.getNextParagraphForCharacterFormatting(table, start, end, property, value, update);\n    };\n    // tslint:disable-next-line:max-line-length\n    Editor.prototype.applyCharFormatForSelTable = function (tableWidget, selection, property, value, update) {\n        for (var i = 0; i < tableWidget.childWidgets.length; i++) {\n            var row = tableWidget.childWidgets[i];\n            for (var j = 0; j < row.childWidgets.length; j++) {\n                this.applyCharFormatForSelectedCell(row.childWidgets[j], selection, property, value, update);\n            }\n        }\n    };\n    // tslint:disable-next-line:max-line-length\n    Editor.prototype.applyCharFormatForTableCell = function (table, selection, startCell, endCell, property, value, update) {\n        var startCellLeft = selection.getCellLeft(startCell.ownerRow, startCell);\n        var startCellRight = startCellLeft + startCell.cellFormat.cellWidth;\n        var endCellLeft = selection.getCellLeft(endCell.ownerRow, endCell);\n        var endCellRight = endCellLeft + endCell.cellFormat.cellWidth;\n        var cellInfo = this.updateSelectedCellsInTable(startCellLeft, startCellRight, endCellLeft, endCellRight);\n        startCellLeft = cellInfo.start;\n        startCellRight = cellInfo.end;\n        var count = table.childWidgets.indexOf(endCell.ownerRow);\n        var isStarted = false;\n        for (var i = table.childWidgets.indexOf(startCell.ownerRow); i <= count; i++) {\n            var row = table.childWidgets[i];\n            for (var j = 0; j < row.childWidgets.length; j++) {\n                var left = selection.getCellLeft(row, row.childWidgets[j]);\n                if (HelperMethods.round(startCellLeft, 2) <= HelperMethods.round(left, 2) &&\n                    HelperMethods.round(left, 2) < HelperMethods.round(startCellRight, 2)) {\n                    if (!isStarted) {\n                        value = this.getCharacterFormatValueOfCell(row.childWidgets[j], selection, value, property);\n                        isStarted = true;\n                    }\n                    this.applyCharFormatForSelectedCell(row.childWidgets[j], selection, property, value, update);\n                }\n            }\n        }\n    };\n    Editor.prototype.updateSelectedCellsInTable = function (start, end, endCellLeft, endCellRight) {\n        var selection = this.viewer.selection;\n        if (start > endCellLeft) {\n            start = endCellLeft;\n        }\n        if (end < endCellRight) {\n            end = endCellRight;\n        }\n        if (start > selection.upDownSelectionLength) {\n            start = selection.upDownSelectionLength;\n        }\n        if (end < selection.upDownSelectionLength) {\n            end = selection.upDownSelectionLength;\n        }\n        return { start: start, end: end };\n    };\n    Editor.prototype.getCharacterFormatValueOfCell = function (cell, selection, value, property) {\n        if (typeof (value) === 'boolean' || (value === undefined && (property === 'bold' || property === 'italic'))) {\n            var firstParagraph = selection.getFirstParagraph(cell);\n            var format = firstParagraph.characterFormat;\n            if (firstParagraph.childWidgets.length > 0 && firstParagraph.childWidgets[0].children.length > 0) {\n                format = firstParagraph.childWidgets[0].children[0].characterFormat;\n            }\n            value = !format.getPropertyValue(property);\n        }\n        return value;\n    };\n    /**\n     * Apply Character format for selection\n     * @private\n     */\n    Editor.prototype.applyCharFormatValueInternal = function (selection, format, property, value) {\n        this.applyCharFormatValue(format, property, value, false);\n    };\n    Editor.prototype.copyInlineCharacterFormat = function (sourceFormat, destFormat) {\n        destFormat.uniqueCharacterFormat = sourceFormat.uniqueCharacterFormat;\n        destFormat.baseCharStyle = sourceFormat.baseCharStyle;\n    };\n    Editor.prototype.applyCharFormatValue = function (format, property, value, update) {\n        if (update && property === 'fontSize') {\n            value = this.updateFontSize(format, value);\n        }\n        if (this.editorHistory && !isNullOrUndefined(this.editorHistory.currentBaseHistoryInfo)) {\n            value = this.editorHistory.currentBaseHistoryInfo.addModifiedProperties(format, property, value);\n        }\n        if (value instanceof WCharacterFormat) {\n            if (this.editorHistory && (this.editorHistory.isUndoing || this.editorHistory.isRedoing)) {\n                this.copyInlineCharacterFormat(value, format);\n            }\n            else {\n                format.copyFormat(value);\n            }\n            return;\n        }\n        if (isNullOrUndefined(value)) {\n            format.clearFormat();\n            return;\n        }\n        if (property === 'bold') {\n            format.bold = value;\n        }\n        else if (property === 'italic') {\n            format.italic = value;\n        }\n        else if (property === 'fontColor') {\n            format.fontColor = value;\n        }\n        else if (property === 'fontFamily') {\n            format.fontFamily = value;\n        }\n        else if (property === 'fontSize') {\n            format.fontSize = value;\n        }\n        else if (property === 'highlightColor') {\n            format.highlightColor = value;\n        }\n        else if (property === 'baselineAlignment') {\n            format.baselineAlignment = value;\n        }\n        else if (property === 'strikethrough') {\n            format.strikethrough = value;\n        }\n        else if (property === 'underline') {\n            format.underline = value;\n        }\n        else if (property === 'styleName') {\n            format.baseCharStyle = value;\n        }\n    };\n    /**\n     * @private\n     */\n    Editor.prototype.onImageFormat = function (elementBox, width, height) {\n        var modifiedFormat = new ImageFormat(elementBox);\n        if (this.editorHistory) {\n            this.editorHistory.initializeHistory('ImageResizing');\n            this.editorHistory.currentBaseHistoryInfo.modifiedProperties.push(modifiedFormat);\n        }\n        this.setOffsetValue(this.selection);\n        elementBox.width = width;\n        elementBox.height = height;\n        // tslint:disable-next-line:max-line-length\n        this.viewer.layout.reLayoutParagraph(elementBox.line.paragraph, elementBox.line.indexInOwner, 0);\n        this.reLayout(this.selection, false);\n        if (this.viewer.owner.imageResizerModule) {\n            this.viewer.owner.imageResizerModule.positionImageResizer(elementBox);\n        }\n    };\n    /**\n     * Toggles the text alignment of selected paragraphs.\n     * @param  {TextAlignment} textAlignment\n     */\n    Editor.prototype.toggleTextAlignment = function (textAlignment) {\n        if (this.viewer.owner.isReadOnlyMode || !this.viewer.owner.isDocumentLoaded) {\n            return;\n        }\n        // Toggle performed based on current selection format similar to MS word behavior.\n        // tslint:disable-next-line:max-line-length\n        if (!isNullOrUndefined(this.viewer.selection.paragraphFormat.textAlignment) && this.viewer.selection.paragraphFormat.textAlignment === textAlignment) {\n            if (textAlignment === 'Left') {\n                this.onApplyParagraphFormat('textAlignment', 'Justify', false, true);\n            }\n            else {\n                this.onApplyParagraphFormat('textAlignment', 'Left', false, true);\n            }\n        }\n        else {\n            this.onApplyParagraphFormat('textAlignment', textAlignment, false, true);\n        }\n    };\n    /**\n     * Applies paragraph format for the selection ranges.\n     * @param {string} property\n     * @param {Object} value\n     * @param {boolean} update\n     * @param {boolean} isSelectionChanged\n     * @private\n     */\n    Editor.prototype.onApplyParagraphFormat = function (property, value, update, isSelectionChanged) {\n        var action = (property[0].toUpperCase() + property.slice(1));\n        this.viewer.owner.isShiftingEnabled = true;\n        var selection = this.viewer.selection;\n        this.initHistory(action);\n        if (this.viewer.owner.isReadOnlyMode || !this.viewer.owner.isDocumentLoaded) {\n            return;\n        }\n        if (property === 'leftIndent') {\n            if (selection.paragraphFormat.listId !== -1 && update) {\n                this.updateListLevel(value > 0);\n                return;\n            }\n        }\n        if (selection.isEmpty) {\n            this.setOffsetValue(selection);\n            if (update && property === 'leftIndent') {\n                value = this.getIndentIncrementValue(selection.start.paragraph, value);\n            }\n            var para = selection.start.paragraph.combineWidget(this.viewer);\n            this.applyParaFormatProperty(para, property, value, update);\n            this.layoutItemBlock(para, false);\n        }\n        else {\n            //Iterate and update formatting's.      \n            this.setOffsetValue(selection);\n            this.updateSelectionParagraphFormatting(property, value, update);\n        }\n        this.reLayout(selection);\n    };\n    /**\n     * Update the list level\n     * @param  {boolean} increaseLevel\n     * @private\n     */\n    Editor.prototype.updateListLevel = function (increaseLevel) {\n        // Increment or Decrement list level for Multilevel lists.\n        var viewer = this.viewer;\n        var listFormat = this.viewer.selection.start.paragraph.paragraphFormat.listFormat;\n        var paragraphFormat = this.viewer.selection.start.paragraph.paragraphFormat;\n        var list = viewer.getListById(paragraphFormat.listFormat.listId);\n        var listLevel = viewer.layout.getListLevel(list, paragraphFormat.listFormat.listLevelNumber);\n        var levelNumber;\n        if (increaseLevel) {\n            levelNumber = paragraphFormat.listFormat.listLevelNumber + 1;\n        }\n        else {\n            levelNumber = paragraphFormat.listFormat.listLevelNumber - 1;\n        }\n        var nextListLevel = viewer.layout.getListLevel(list, levelNumber);\n        if (!isNullOrUndefined(nextListLevel)) {\n            this.onApplyListInternal(list, levelNumber);\n            viewer.selection.start.updatePhysicalPosition(true);\n            viewer.selection.end.updatePhysicalPosition(true);\n            viewer.selection.updateCaretPosition();\n        }\n    };\n    /**\n     * Applies list\n     * @param  {WList} list\n     * @param  {number} listLevelNumber\n     * @private\n     */\n    Editor.prototype.onApplyListInternal = function (list, listLevelNumber) {\n        var selection = this.viewer.selection;\n        var listFormat = new WListFormat();\n        if (!isNullOrUndefined(list) && listLevelNumber >= 0 && listLevelNumber < 9) {\n            listFormat.listId = list.listId;\n            listFormat.listLevelNumber = listLevelNumber;\n        }\n        this.onApplyParagraphFormat('listFormat', listFormat, false, false);\n    };\n    /**\n     * Apply paragraph format to selection range\n     * @private\n     */\n    Editor.prototype.updateSelectionParagraphFormatting = function (property, value, update) {\n        var selection = this.viewer.selection;\n        if (property === 'leftIndent' && update) {\n            if (!isNullOrUndefined(selection.start) && selection.start.isExistBefore(selection.end)) {\n                value = this.getIndentIncrementValue(selection.start.paragraph, value);\n            }\n            else {\n                value = this.getIndentIncrementValue(selection.end.paragraph, value);\n            }\n        }\n        this.updateParagraphFormatInternal(property, value, update);\n    };\n    Editor.prototype.getIndentIncrementValue = function (currentParagraph, incrementFactor) {\n        var currentParagraphIndent = currentParagraph.paragraphFormat.leftIndent;\n        if (currentParagraphIndent < 0) {\n            // In MS Word, if the current paragraph left indent is lesser that or equal to 0\n            // then performing decrement indent will set left indent to 0. \n            if (incrementFactor < 0 || currentParagraphIndent + incrementFactor >= 0) {\n                return -currentParagraphIndent;\n            }\n            else {\n                var incrementValue = -this.getIndentIncrementValueInternal(-currentParagraphIndent, -incrementFactor);\n                return incrementValue % incrementFactor === 0 ? incrementValue : incrementValue + incrementFactor;\n            }\n        }\n        else {\n            return this.getIndentIncrementValueInternal(currentParagraphIndent, incrementFactor);\n        }\n    };\n    Editor.prototype.getIndentIncrementValueInternal = function (position, incrementFactor) {\n        var tabValue = Math.abs(incrementFactor);\n        if (position === 0 || tabValue === 0) {\n            return incrementFactor > 0 ? tabValue : 0;\n        }\n        else {\n            var diff = ((Math.round(position) * 100) % (Math.round(tabValue) * 100)) / 100;\n            var cnt = (Math.round(position) - diff) / Math.round(tabValue);\n            var fPosition = cnt * tabValue;\n            if (incrementFactor > 0) {\n                fPosition += tabValue;\n            }\n            return (fPosition - position) === 0 ? incrementFactor : fPosition - position;\n        }\n    };\n    Editor.prototype.updateParagraphFormatInternal = function (property, value, update) {\n        if (isNullOrUndefined(property)) {\n            property = 'ParagraphFormat';\n        }\n        switch (property) {\n            case 'afterSpacing':\n                this.updateParagraphFormat('afterSpacing', value, false);\n                break;\n            case 'beforeSpacing':\n                this.updateParagraphFormat('beforeSpacing', value, false);\n                break;\n            case 'rightIndent':\n                this.updateParagraphFormat('rightIndent', value, false);\n                break;\n            case 'leftIndent':\n                this.updateParagraphFormat('leftIndent', value, update);\n                break;\n            case 'firstLineIndent':\n                this.updateParagraphFormat('firstLineIndent', value, false);\n                break;\n            case 'lineSpacing':\n                this.updateParagraphFormat('lineSpacing', value, false);\n                break;\n            case 'lineSpacingType':\n                this.updateParagraphFormat('lineSpacingType', value, false);\n                break;\n            case 'textAlignment':\n                this.updateParagraphFormat('textAlignment', value, false);\n                break;\n            case 'listFormat':\n                this.updateParagraphFormat('listFormat', value, false);\n                break;\n            case 'ParagraphFormat':\n                this.updateParagraphFormat(undefined, value, false);\n                break;\n            case 'styleName':\n                this.updateParagraphFormat('styleName', value, false);\n                break;\n            case 'ClearParagraphFormat':\n                // this.initializeHistory('ClearParagraphFormat', selectionRange);\n                this.updateParagraphFormat(undefined, value, false);\n                break;\n        }\n    };\n    /**\n     * Update paragraph format on undo\n     * @param  {SelectionRange} selectionRange\n     * @param  {string} property\n     * @param  {Object} value\n     * @param  {boolean} update\n     * @private\n     */\n    Editor.prototype.updateParagraphFormat = function (property, value, update) {\n        var selection = this.viewer.selection;\n        var startPosition = selection.start;\n        var endPosition = selection.end;\n        if (!selection.isForward) {\n            startPosition = selection.end;\n            endPosition = selection.start;\n        }\n        // this.updateInsertPosition(selection, startPosition);\n        this.applyParaFormatSelectedContent(startPosition, endPosition, property, value, update);\n        // this.startSelectionReLayouting(startPosition.paragraph, selection, startPosition, endPosition);\n    };\n    Editor.prototype.applyParaFormatSelectedContent = function (start, end, property, value, update) {\n        var selection = this.viewer.selection;\n        if (start.paragraph.isInsideTable && (!end.paragraph.isInsideTable\n            || start.paragraph.associatedCell !== end.paragraph.associatedCell\n            || selection.isCellSelected(start.paragraph.associatedCell, start, end))) {\n            var cell = void 0;\n            start.paragraph.associatedCell.ownerTable.combineWidget(this.viewer);\n            if (this.checkInsertPosition(selection)) {\n                this.updateHistoryPosition(start, true);\n            }\n            cell = start.paragraph.associatedCell;\n            this.applyParaFormatInCell(cell, start, end, property, value, update);\n            var table = cell.ownerTable;\n            this.viewer.layout.layoutBodyWidgetCollection(table.index, table.containerWidget, table, false);\n        }\n        else {\n            // tslint:disable-next-line:max-line-length\n            if (!isNullOrUndefined(value) && !this.selection.isEmpty && property === 'styleName' && this.applyCharacterStyle(start.paragraph, start, end, property, value, update)) {\n                return;\n            }\n            else {\n                this.applyParaFormat(start.paragraph, start, end, property, value, update);\n            }\n        }\n    };\n    /**\n     * Apply Paragraph format\n     * @private\n     */\n    Editor.prototype.applyParaFormatProperty = function (paragraph, property, value, update) {\n        var format = paragraph.paragraphFormat;\n        if (update && property === 'leftIndent') {\n            value = format.leftIndent + value;\n        }\n        if (property === 'listFormat' && value instanceof WListFormat) {\n            var listFormat = value;\n            if (!listFormat.hasValue('listLevelNumber')) {\n                listFormat.listLevelNumber = format.listFormat.listLevelNumber;\n            }\n        }\n        if (this.editorHistory && !isNullOrUndefined(this.editorHistory.currentBaseHistoryInfo)) {\n            value = this.editorHistory.currentBaseHistoryInfo.addModifiedPropertiesForParagraphFormat(format, property, value);\n        }\n        if (value instanceof WParagraphFormat) {\n            if (isNullOrUndefined(property)) {\n                if (this.editorHistory && (this.editorHistory.isUndoing || this.editorHistory.isRedoing)) {\n                    this.copyParagraphFormat(value, format);\n                }\n                else {\n                    format.copyFormat(value);\n                }\n            }\n            else if (property === 'listFormat') {\n                format.listFormat = value.listFormat;\n                // this.handleListFormat(format, value as WParagraphFormat);\n            }\n        }\n        if (isNullOrUndefined(value)) {\n            format.clearFormat();\n            this.viewer.layout.reLayoutParagraph(format.ownerBase, 0, 0);\n            return;\n        }\n        if (property === 'afterSpacing') {\n            format.afterSpacing = value;\n        }\n        else if (property === 'beforeSpacing') {\n            format.beforeSpacing = value;\n        }\n        else if (property === 'leftIndent') {\n            format.leftIndent = value;\n        }\n        else if (property === 'lineSpacingType') {\n            format.lineSpacingType = value;\n        }\n        else if (property === 'lineSpacing') {\n            format.lineSpacing = value;\n        }\n        else if (property === 'rightIndent') {\n            format.rightIndent = value;\n        }\n        else if (property === 'firstLineIndent') {\n            format.firstLineIndent = value;\n        }\n        else if (property === 'textAlignment') {\n            format.textAlignment = value;\n            this.viewer.layout.allowLayout = false;\n        }\n        else if (property === 'styleName') {\n            if (typeof (value) === 'string') {\n                value = this.viewer.styles.findByName(value);\n            }\n            format.ApplyStyle(value);\n        }\n        else if (property === 'listFormat') {\n            if (value instanceof WParagraphFormat) {\n                this.copyFromListLevelParagraphFormat(format, value);\n                value = value.listFormat;\n            }\n            format.listFormat.copyFormat(value);\n            this.viewer.layout.clearListElementBox(format.ownerBase);\n            this.onListFormatChange(format.ownerBase, value, format);\n            this.layoutItemBlock(format.ownerBase, false);\n            return;\n        }\n    };\n    Editor.prototype.copyParagraphFormat = function (sourceFormat, destFormat) {\n        destFormat.uniqueParagraphFormat = sourceFormat.uniqueParagraphFormat;\n        destFormat.listFormat = sourceFormat.listFormat;\n        destFormat.baseStyle = sourceFormat.baseStyle;\n    };\n    Editor.prototype.onListFormatChange = function (paragraph, listFormat, paraFormat) {\n        if (listFormat instanceof WListFormat) {\n            var currentFormat = listFormat;\n            // currentFormat.setOwnerBase(paraFormat);\n            this.updateListParagraphFormat(paragraph, listFormat);\n        }\n    };\n    Editor.prototype.updateListParagraphFormat = function (paragraph, listFormat) {\n        var list = this.viewer.getListById(listFormat.listId);\n        var listlevel = undefined;\n        if (!isNullOrUndefined(list)) {\n            listlevel = this.viewer.layout.getListLevel(list, listFormat.listLevelNumber);\n        }\n        var isUpdateIndent = !this.editorHistory || (this.editorHistory && !this.editorHistory.isUndoing);\n        if (isUpdateIndent) {\n            if (paragraph instanceof ParagraphWidget && !isNullOrUndefined(listlevel)\n                && !isNullOrUndefined(listlevel.paragraphFormat) && !isNullOrUndefined(paragraph.containerWidget)) {\n                this.copyFromListLevelParagraphFormat(paragraph.paragraphFormat, listlevel.paragraphFormat);\n            }\n            else if (isNullOrUndefined(list)) {\n                paragraph.paragraphFormat.leftIndent = undefined;\n                paragraph.paragraphFormat.firstLineIndent = undefined;\n            }\n        }\n    };\n    /**\n     * Copies list level paragraph format\n     * @param  {WParagraphFormat} oldFormat\n     * @param  {WParagraphFormat} newFormat\n     * @private\n     */\n    Editor.prototype.copyFromListLevelParagraphFormat = function (oldFormat, newFormat) {\n        if (!isNullOrUndefined(newFormat.leftIndent)) {\n            oldFormat.leftIndent = newFormat.leftIndent;\n        }\n        if (!isNullOrUndefined(newFormat.firstLineIndent)) {\n            oldFormat.firstLineIndent = newFormat.firstLineIndent;\n        }\n    };\n    /**\n     * @private\n     */\n    Editor.prototype.applyContinueNumbering = function (selection) {\n        this.editorHistory.initializeHistory('ContinueNumbering');\n        this.applyContinueNumberingInternal(selection);\n    };\n    /**\n     * @private\n     */\n    Editor.prototype.applyContinueNumberingInternal = function (selection) {\n        var paragraph = selection.start.paragraph;\n        var numberingInfo = this.getContinueNumberingInfo(paragraph);\n        var paraFormat = this.getParagraphFormat(paragraph, numberingInfo.listLevelNumber, numberingInfo.listPattern);\n        this.changeListId(numberingInfo.currentList, paragraph, paraFormat, numberingInfo.listLevelNumber, numberingInfo.listPattern);\n        this.reLayout(selection, false);\n        if (this.editorHistory && !isNullOrUndefined(this.editorHistory.currentBaseHistoryInfo)) {\n            this.editorHistory.updateHistory();\n        }\n        this.viewer.updateFocus();\n    };\n    /**\n     * @private\n     */\n    Editor.prototype.getContinueNumberingInfo = function (paragraph) {\n        var currentList = undefined;\n        var listLevelNumber = 0;\n        var listPattern = 'None';\n        if (!isNullOrUndefined(paragraph.paragraphFormat)\n            && !isNullOrUndefined(paragraph.paragraphFormat.listFormat)) {\n            currentList = this.viewer.getListById(paragraph.paragraphFormat.listFormat.listId);\n            listLevelNumber = paragraph.paragraphFormat.listFormat.listLevelNumber;\n        }\n        var viewer = this.viewer;\n        if (listLevelNumber !== 0 && !isNullOrUndefined(currentList) &&\n            !isNullOrUndefined(viewer.getAbstractListById(currentList.abstractListId))\n            && !isNullOrUndefined(viewer.getAbstractListById(currentList.abstractListId).levels[listLevelNumber])) {\n            var listLevel = this.viewer.layout.getListLevel(currentList, listLevelNumber);\n            if (!isNullOrUndefined(listLevel)) {\n                listPattern = listLevel.listLevelPattern;\n            }\n        }\n        return {\n            currentList: currentList,\n            listLevelNumber: listLevelNumber,\n            listPattern: listPattern\n        };\n    };\n    /**\n     * @private\n     */\n    Editor.prototype.revertContinueNumbering = function (selection, format) {\n        var paragraph = selection.start.paragraph;\n        var numberingInfo = this.getContinueNumberingInfo(paragraph);\n        this.changeListId(numberingInfo.currentList, paragraph, format, numberingInfo.listLevelNumber, numberingInfo.listPattern);\n        this.reLayout(selection, false);\n        if (!isNullOrUndefined(this.editorHistory.currentBaseHistoryInfo)) {\n            this.editorHistory.updateHistory();\n        }\n    };\n    Editor.prototype.changeListId = function (list, block, format, levelNum, listType) {\n        if (isNullOrUndefined(block)) {\n            return;\n        }\n        if (block instanceof ParagraphWidget) {\n            if (list.listId === block.paragraphFormat.listFormat.listId\n                && levelNum === block.paragraphFormat.listFormat.listLevelNumber) {\n                var baseHistoryInfo = this.editorHistory.currentBaseHistoryInfo;\n                if (!isNullOrUndefined(baseHistoryInfo)) {\n                    format = baseHistoryInfo.addModifiedPropertiesForContinueNumbering(block.paragraphFormat, format);\n                }\n                block.paragraphFormat.copyFormat(format);\n                this.viewer.layout.reLayoutParagraph(block, 0, 0);\n            }\n        }\n        return this.changeListId(list, block.nextRenderedWidget, format, levelNum, listType);\n    };\n    Editor.prototype.getParagraphFormat = function (paragraph, levelNumber, listType) {\n        if (!isNullOrUndefined(paragraph.previousRenderedWidget)) {\n            if (paragraph.previousRenderedWidget instanceof ParagraphWidget) {\n                if (!isNullOrUndefined(paragraph.previousRenderedWidget.paragraphFormat.listFormat)\n                    && paragraph.previousRenderedWidget.paragraphFormat.listFormat.listId !== -1) {\n                    var listLevel = this.getListLevel(paragraph.previousRenderedWidget);\n                    if (levelNumber === 0) {\n                        return paragraph.previousRenderedWidget.paragraphFormat;\n                    }\n                    else if (listType === listLevel.listLevelPattern\n                        || this.checkNumberArabic(listType, listLevel.listLevelPattern)) {\n                        return paragraph.previousRenderedWidget.paragraphFormat;\n                    }\n                    else {\n                        return this.getParagraphFormat(paragraph.previousRenderedWidget, levelNumber, listType);\n                    }\n                }\n                else {\n                    return this.getParagraphFormat(paragraph.previousRenderedWidget, levelNumber, listType);\n                }\n            }\n        }\n        return undefined;\n    };\n    Editor.prototype.checkNumberArabic = function (listType, levelPattern) {\n        if ((listType === 'Number' && levelPattern === 'Arabic')\n            || (levelPattern === 'Number' && listType === 'Arabic')) {\n            return true;\n        }\n        return false;\n    };\n    /**\n     * @private\n     */\n    Editor.prototype.applyRestartNumbering = function (selection) {\n        this.editorHistory.initializeHistory('RestartNumbering');\n        this.restartListAt(selection);\n    };\n    /**\n     * @private\n     */\n    Editor.prototype.restartListAt = function (selection) {\n        var currentListLevel = this.getListLevel(selection.start.paragraph);\n        var list = new WList();\n        list.listId = this.viewer.lists[(this.viewer.lists.length - 1)].listId + 1;\n        var abstractList = new WAbstractList();\n        abstractList.abstractListId = this.viewer.abstractLists[(this.viewer.abstractLists.length - 1)].abstractListId + 1;\n        list.abstractListId = abstractList.abstractListId;\n        this.viewer.abstractLists.push(abstractList);\n        this.createListLevels(abstractList, currentListLevel, list);\n        this.viewer.lists.push(list);\n        this.restartListAtInternal(selection, list.listId);\n    };\n    /**\n     * @private\n     */\n    Editor.prototype.restartListAtInternal = function (selection, listId) {\n        var numberingInfo = this.getContinueNumberingInfo(selection.start.paragraph);\n        this.changeRestartNumbering(numberingInfo.currentList, selection.start.paragraph, listId);\n        this.reLayout(selection, false);\n        if (this.editorHistory && !isNullOrUndefined(this.editorHistory.currentBaseHistoryInfo)) {\n            this.editorHistory.updateHistory();\n        }\n        this.incrementListNumber = -1;\n        this.refListNumber = undefined;\n        this.viewer.updateFocus();\n    };\n    Editor.prototype.changeRestartNumbering = function (list, block, listId) {\n        if (isNullOrUndefined(block)) {\n            return;\n        }\n        if (block instanceof ParagraphWidget) {\n            if (list.listId === block.paragraphFormat.listFormat.listId) {\n                var baseHistoryInfo = this.editorHistory.currentBaseHistoryInfo;\n                if (!isNullOrUndefined(baseHistoryInfo)) {\n                    listId = baseHistoryInfo.addModifiedPropertiesForRestartNumbering(block.paragraphFormat.listFormat, listId);\n                }\n                block.paragraphFormat.listFormat.listId = listId;\n                if (this.refListNumber !== block.paragraphFormat.listFormat.listLevelNumber) {\n                    this.incrementListNumber += 1;\n                    this.refListNumber = block.paragraphFormat.listFormat.listLevelNumber;\n                }\n                block.paragraphFormat.listFormat.listLevelNumber = this.incrementListNumber;\n                this.viewer.layout.reLayoutParagraph(block, 0, 0);\n            }\n        }\n        return this.changeRestartNumbering(list, block.nextRenderedWidget, listId);\n    };\n    Editor.prototype.createListLevels = function (abstractList, currentListLevel, list) {\n        var levelPattern = currentListLevel.listLevelPattern;\n        var levelPatterns = [];\n        var currentAbstractList = currentListLevel.ownerBase;\n        for (var i = 0; i < 3; i++) {\n            var listLevel = currentAbstractList.levels[i];\n            if (!isNullOrUndefined(listLevel)) {\n                levelPatterns.push(listLevel.listLevelPattern);\n            }\n        }\n        var indexOfLevelPattern = levelPatterns.indexOf(levelPattern) === -1 ? 0 : levelPatterns.indexOf(levelPattern);\n        for (var i = 0; i < currentAbstractList.levels.length; i++) {\n            var listLevel = new WListLevel(abstractList);\n            if (i === 0) {\n                listLevel.listLevelPattern = levelPattern;\n            }\n            else {\n                if (indexOfLevelPattern === 0 || indexOfLevelPattern < levelPatterns.length - 1) {\n                    indexOfLevelPattern++;\n                }\n                else {\n                    indexOfLevelPattern = 0;\n                }\n                listLevel.listLevelPattern = levelPatterns[indexOfLevelPattern];\n            }\n            listLevel.numberFormat = '%' + (i + 1) + '.';\n            listLevel.startAt = 1;\n            listLevel.characterFormat.copyFormat(currentListLevel.characterFormat);\n            listLevel.paragraphFormat.copyFormat(currentListLevel.paragraphFormat);\n            listLevel.restartLevel = i;\n            abstractList.levels.push(listLevel);\n        }\n    };\n    // tslint:disable-next-line:max-line-length\n    Editor.prototype.applyParaFormat = function (paragraph, start, end, property, value, update) {\n        this.setOffsetValue(this.selection);\n        paragraph = paragraph.combineWidget(this.viewer);\n        //Apply Paragraph Format for spitted paragraph\n        this.applyParaFormatProperty(paragraph, property, value, update);\n        this.layoutItemBlock(paragraph, false);\n        this.getOffsetValue(this.selection);\n        if (paragraph.equals(end.paragraph)) {\n            return;\n        }\n        this.getNextParagraphForFormatting(paragraph, start, end, property, value, update);\n    };\n    /* tslint:disable-next-line:max-line-length */\n    Editor.prototype.applyCharacterStyle = function (paragraph, start, end, property, value, update) {\n        var paragraphWidget = paragraph.getSplitWidgets();\n        if ((end.paragraph === paragraph || paragraphWidget.indexOf(end.paragraph) !== -1)) {\n            if (((value.type === 'Paragraph') && ((value.link) instanceof WCharacterStyle)) || (value.type === 'Character')) {\n                var obj = (value.type === 'Character') ? value : value.link;\n                this.updateSelectionCharacterFormatting(property, obj, update);\n                return true;\n            }\n        }\n        return false;\n    };\n    // Cell\n    // tslint:disable-next-line:max-line-length\n    Editor.prototype.applyParaFormatInCell = function (cell, start, end, property, value, update) {\n        var selection = this.viewer.selection;\n        if (end.paragraph.isInsideTable) {\n            var cellContainer = selection.getContainerCellOf(cell, end.paragraph.associatedCell);\n            if (cellContainer.ownerTable.contains(end.paragraph.associatedCell)) {\n                var startCell = selection.getSelectedCell(cell, cellContainer);\n                var endCell = selection.getSelectedCell(end.paragraph.associatedCell, cellContainer);\n                if (selection.containsCell(cellContainer, end.paragraph.associatedCell)) {\n                    //Selection end is in container cell.\n                    if (selection.isCellSelected(cellContainer, start, end)) {\n                        value = this.getParaFormatValueInCell(cellContainer, property, value);\n                        this.applyParaFormatCellInternal(cellContainer, property, value, update);\n                    }\n                    else {\n                        if (startCell === cellContainer) {\n                            this.applyParaFormat(start.paragraph, start, end, property, value, update);\n                        }\n                        else {\n                            this.applyParagraphFormatRow(startCell.ownerRow, start, end, property, value, update);\n                        }\n                    }\n                }\n                else {\n                    //Format other selected cells in current table.\n                    this.applyParaFormatTableCell(cellContainer.ownerTable, cellContainer, endCell, property, value, update);\n                }\n            }\n            else {\n                this.applyParagraphFormatRow(cellContainer.ownerRow, start, end, property, value, update);\n            }\n        }\n        else {\n            var wCell = selection.getContainerCell(cell);\n            this.applyParagraphFormatRow(wCell.ownerRow, start, end, property, value, update);\n        }\n    };\n    Editor.prototype.applyParaFormatCellInternal = function (cell, property, value, update) {\n        for (var i = 0; i < cell.childWidgets.length; i++) {\n            var block = cell.childWidgets[i];\n            if (block instanceof ParagraphWidget) {\n                this.applyParaFormatProperty(block, property, value, update);\n            }\n            else {\n                this.applyParagraphFormatTableInternal(block, property, value, update);\n            }\n        }\n    };\n    Editor.prototype.getParaFormatValueInCell = function (cell, property, value) {\n        if (typeof value === 'boolean') {\n            var firstPara = this.viewer.selection.getFirstParagraph(cell);\n            value = !firstPara.paragraphFormat.getPropertyValue(property);\n        }\n        return value;\n    };\n    // Row\n    // tslint:disable-next-line:max-line-length\n    Editor.prototype.applyParagraphFormatRow = function (wRow, start, end, property, value, update) {\n        value = this.getParaFormatValueInCell(wRow.childWidgets[0], property, value);\n        for (var i = wRow.rowIndex; i < wRow.ownerTable.childWidgets.length; i++) {\n            var row = wRow.ownerTable.childWidgets[i];\n            for (var j = 0; j < row.childWidgets.length; j++) {\n                this.applyParaFormatCellInternal(row.childWidgets[j], property, value, update);\n            }\n            if (end.paragraph.isInsideTable && this.viewer.selection.containsRow(row, end.paragraph.associatedCell)) {\n                return;\n            }\n        }\n        this.getNextParagraphForFormatting(wRow.ownerTable, start, end, property, value, update);\n    };\n    // Table\n    // tslint:disable-next-line:max-line-length\n    Editor.prototype.applyParaFormatTableCell = function (table, startCell, endCell, property, value, update) {\n        var selection = this.viewer.selection;\n        var startValue = selection.getCellLeft(startCell.ownerRow, startCell);\n        var endValue = startValue + startCell.cellFormat.cellWidth;\n        var endCellLeft = selection.getCellLeft(endCell.ownerRow, endCell);\n        var endCellRight = endCellLeft + endCell.cellFormat.cellWidth;\n        var cellInfo = this.updateSelectedCellsInTable(startValue, endValue, endCellLeft, endCellRight);\n        startValue = cellInfo.start;\n        endValue = cellInfo.end;\n        var count = table.childWidgets.indexOf(endCell.ownerRow);\n        var isStarted = false;\n        for (var m = table.childWidgets.indexOf(startCell.ownerRow); m <= count; m++) {\n            var row = table.childWidgets[m];\n            for (var j = 0; j < row.childWidgets.length; j++) {\n                var left = selection.getCellLeft(row, row.childWidgets[j]);\n                if (Math.round(startValue) <= Math.round(left) && Math.round(left) < Math.round(endValue)) {\n                    if (!isStarted) {\n                        value = this.getParaFormatValueInCell(row.childWidgets[j], property, value);\n                        isStarted = true;\n                    }\n                    this.applyParaFormatCellInternal(row.childWidgets[j], property, value, update);\n                }\n            }\n        }\n    };\n    // tslint:disable-next-line:max-line-length\n    Editor.prototype.applyParaFormatTable = function (table, start, end, property, value, update) {\n        table = table.combineWidget(this.viewer);\n        var selection = this.viewer.selection;\n        for (var m = 0; m < table.childWidgets.length; m++) {\n            var tableRow = table.childWidgets[m];\n            for (var k = 0; k < tableRow.childWidgets.length; k++) {\n                this.applyParaFormatCellInternal(tableRow.childWidgets[k], property, value, update);\n            }\n            if (end.paragraph.isInsideTable && selection.containsRow(tableRow, end.paragraph.associatedCell)) {\n                this.viewer.layout.layoutBodyWidgetCollection(table.index, table.containerWidget, table, false);\n                return;\n            }\n        }\n        this.viewer.layout.layoutBodyWidgetCollection(table.index, table.containerWidget, table, false);\n        this.getNextParagraphForFormatting(table, start, end, property, value, update);\n    };\n    // tslint:disable-next-line:max-line-length\n    Editor.prototype.getNextParagraphForFormatting = function (block, start, end, property, value, update) {\n        var widgetCollection = block.getSplitWidgets();\n        block = widgetCollection[widgetCollection.length - 1];\n        block = this.viewer.selection.getNextRenderedBlock(block);\n        if (!isNullOrUndefined(block)) {\n            if (block instanceof ParagraphWidget) {\n                this.applyParaFormat(block, start, end, property, value, update);\n            }\n            else {\n                this.applyParaFormatTable(block, start, end, property, value, update);\n            }\n        }\n    };\n    Editor.prototype.applyParagraphFormatTableInternal = function (table, property, value, update) {\n        for (var x = 0; x < table.childWidgets.length; x++) {\n            var row = table.childWidgets[x];\n            for (var y = 0; y < row.childWidgets.length; y++) {\n                this.applyParaFormatCellInternal(row.childWidgets[y], property, value, update);\n            }\n        }\n    };\n    //Paragraph Format apply implementation Ends\n    // Apply Selection Section Format Option Implementation Starts\n    /**\n     * Apply section format selection changes\n     * @param  {string} property\n     * @param  {Object} value\n     * @private\n     */\n    Editor.prototype.onApplySectionFormat = function (property, value) {\n        if (!isNullOrUndefined(property)) {\n            var action = (property[0].toUpperCase() + property.slice(1));\n            this.initHistory(action);\n        }\n        else {\n            this.initHistory('SectionFormat');\n        }\n        this.updateSectionFormat(property, value);\n    };\n    /**\n     * Update section format\n     * @param  {string} property\n     * @param  {Object} value\n     * @returns TextPosition\n     * @private\n     */\n    Editor.prototype.updateSectionFormat = function (property, value) {\n        var selection = this.viewer.selection;\n        selection.owner.isShiftingEnabled = true;\n        var startPosition = selection.start;\n        var endPosition = selection.end;\n        if (!selection.isForward) {\n            startPosition = selection.end;\n            endPosition = selection.start;\n        }\n        var startPageIndex;\n        var endPageIndex;\n        this.viewer.clearContent();\n        var startSectionIndex = startPosition.paragraph.containerWidget.index;\n        var endSectionIndex = endPosition.paragraph.containerWidget.index;\n        for (var i = 0; i < this.viewer.pages.length; i++) {\n            if (this.viewer.pages[i].bodyWidgets[0].index === startSectionIndex) {\n                startPageIndex = i;\n                break;\n            }\n        }\n        for (var i = startPageIndex; i < this.viewer.pages.length; i++) {\n            var bodyWidget = this.viewer.pages[i].bodyWidgets[0];\n            endPageIndex = i;\n            if ((bodyWidget.index === startSectionIndex)) {\n                continue;\n            }\n            else if ((bodyWidget.index >= startSectionIndex) && bodyWidget.index <= endSectionIndex) {\n                continue;\n            }\n            else {\n                endPageIndex = i - 1;\n                break;\n            }\n        }\n        // let startPageIndex: number = this.viewer.pages.indexOf((selection.start.paragraph.containerWidget as BodyWidget).page);\n        // let endPageIndex: number = this.viewer.pages.indexOf((selection.end.paragraph.containerWidget as BodyWidget).page);\n        var update = true;\n        var index = 0;\n        for (var i = startPageIndex; i <= endPageIndex; i++) {\n            if (index !== this.viewer.pages[i].bodyWidgets[0].index && !update) {\n                update = true;\n            }\n            this.applyPropertyValueForSection(this.viewer.pages[i].bodyWidgets[0].sectionFormat, property, value, update);\n            index = this.viewer.pages[i].bodyWidgets[0].index;\n            update = false;\n        }\n        this.layoutWholeDocument();\n        this.fireContentChange();\n    };\n    //Apply Selection Table Format option implementation starts\n    /**\n     * Apply table format property changes\n     * @param  {string} property\n     * @param  {Object} value\n     * @private\n     */\n    Editor.prototype.onApplyTableFormat = function (property, value) {\n        var action = this.getTableFormatAction(property);\n        this.viewer.owner.isShiftingEnabled = true;\n        var selection = this.viewer.selection;\n        var table = selection.start.paragraph.associatedCell.ownerTable;\n        table = table.combineWidget(this.viewer);\n        if (selection.isEmpty) {\n            this.initHistory(action);\n            this.applyTablePropertyValue(selection, property, value, table);\n        }\n        else {\n            this.updateSelectionTableFormat(this.selection, action, value);\n        }\n        table.calculateGrid();\n        this.selection.owner.isLayoutEnabled = true;\n        this.viewer.layout.reLayoutTable(table);\n        this.reLayout(selection, false);\n    };\n    Editor.prototype.getTableFormatAction = function (property) {\n        switch (property) {\n            case 'tableAlignment':\n                return 'TableAlignment';\n            case 'leftIndent':\n                return 'TableLeftIndent';\n            case 'leftMargin':\n                return 'DefaultCellLeftMargin';\n            case 'rightMargin':\n                return 'DefaultCellRightMargin';\n            case 'bottomMargin':\n                return 'DefaultCellBottomMargin';\n            case 'topMargin':\n                return 'DefaultCellTopMargin';\n            case 'preferredWidth':\n                return 'TablePreferredWidth';\n            case 'preferredWidthType':\n                return 'TablePreferredWidthType';\n            case 'shading':\n                return 'Shading';\n            default:\n                return 'DefaultCellSpacing';\n        }\n    };\n    // Apply Selection Row Format Option Implementation Starts\n    /**\n     * Apply table row format property changes\n     * @param  {string} property\n     * @param  {Object} value\n     * @private\n     */\n    Editor.prototype.onApplyTableRowFormat = function (property, value) {\n        var action = this.getRowAction(property);\n        this.viewer.owner.isShiftingEnabled = true;\n        var selection = this.viewer.selection;\n        if (selection.isEmpty) {\n            this.initHistory(action);\n            var table = selection.start.paragraph.associatedCell.ownerRow.ownerTable;\n            this.applyRowPropertyValue(selection, property, value, selection.start.paragraph.associatedCell.ownerRow);\n        }\n        else {\n            this.updateSelectionTableFormat(this.selection, action, value);\n        }\n        this.reLayout(selection, false);\n    };\n    Editor.prototype.getRowAction = function (property) {\n        switch (property) {\n            case 'height':\n                return 'RowHeight';\n            case 'heightType':\n                return 'RowHeightType';\n            case 'isHeader':\n                return 'RowHeader';\n            default:\n                return 'AllowBreakAcrossPages';\n        }\n    };\n    /**\n     * Apply table cell property changes\n     * @param  {string} property\n     * @param  {Object} value\n     * @private\n     */\n    Editor.prototype.onApplyTableCellFormat = function (property, value) {\n        var action = this.getTableCellAction(property);\n        this.viewer.owner.isShiftingEnabled = true;\n        var selection = this.viewer.selection;\n        var table = selection.start.paragraph.associatedCell.ownerTable;\n        table = table.combineWidget(this.viewer);\n        if (selection.isEmpty) {\n            this.initHistory(action);\n            this.applyCellPropertyValue(selection, property, value, selection.start.paragraph.associatedCell.cellFormat);\n            table.calculateGrid();\n            this.selection.owner.isLayoutEnabled = true;\n            this.viewer.layout.reLayoutTable(table);\n        }\n        else {\n            this.updateSelectionTableFormat(this.selection, action, value);\n        }\n        this.reLayout(selection, false);\n    };\n    Editor.prototype.getTableCellAction = function (property) {\n        switch (property) {\n            case 'verticalAlignment':\n                return 'CellContentVerticalAlignment';\n            case 'leftMargin':\n                return 'CellLeftMargin';\n            case 'rightMargin':\n                return 'CellRightMargin';\n            case 'bottomMargin':\n                return 'CellBottomMargin';\n            case 'topMargin':\n                return 'CellTopMargin';\n            case 'preferredWidth':\n                return 'CellPreferredWidth';\n            case 'shading':\n                return 'Shading';\n            default:\n                return 'CellPreferredWidthType';\n        }\n    };\n    Editor.prototype.applyPropertyValueForSection = function (sectionFormat, property, value, update) {\n        var selection = this.viewer.selection;\n        if (update && this.editorHistory && !isNullOrUndefined(this.editorHistory.currentBaseHistoryInfo)) {\n            value = this.editorHistory.currentBaseHistoryInfo.addModifiedPropertiesForSection(sectionFormat, property, value);\n        }\n        if (isNullOrUndefined(value)) {\n            return;\n        }\n        if (value instanceof WSectionFormat) {\n            if (isNullOrUndefined(property)) {\n                sectionFormat.copyFormat(value, this.editorHistory);\n            }\n            return;\n        }\n        if (property === 'pageHeight') {\n            sectionFormat.pageHeight = value;\n        }\n        else if (property === 'pageWidth') {\n            sectionFormat.pageWidth = value;\n        }\n        else if (property === 'leftMargin') {\n            sectionFormat.leftMargin = value;\n        }\n        else if (property === 'rightMargin') {\n            sectionFormat.rightMargin = value;\n        }\n        else if (property === 'topMargin') {\n            sectionFormat.topMargin = value;\n        }\n        else if (property === 'bottomMargin') {\n            sectionFormat.bottomMargin = value;\n        }\n        else if (property === 'differentFirstPage') {\n            sectionFormat.differentFirstPage = value;\n        }\n        else if (property === 'differentOddAndEvenPages') {\n            sectionFormat.differentOddAndEvenPages = value;\n        }\n        else if (property === 'headerDistance') {\n            sectionFormat.headerDistance = value;\n        }\n        else if (property === 'footerDistance') {\n            sectionFormat.footerDistance = value;\n        }\n    };\n    /**\n     * @private\n     */\n    Editor.prototype.layoutWholeDocument = function () {\n        var startPosition = this.viewer.selection.start;\n        var endPosition = this.viewer.selection.end;\n        if (startPosition.isExistAfter(endPosition)) {\n            startPosition = this.viewer.selection.end;\n            endPosition = this.viewer.selection.start;\n        }\n        var startInfo = this.getParagraphInfo(startPosition);\n        var endInfo = this.getParagraphInfo(startPosition);\n        var startIndex = this.getHierarchicalIndex(startInfo.paragraph, startInfo.offset.toString());\n        var endIndex = this.getHierarchicalIndex(endInfo.paragraph, endInfo.offset.toString());\n        this.viewer.renderedLists.clear();\n        // this.viewer.owner.isLayoutEnabled = true;\n        var sections = this.combineSection();\n        this.viewer.clearContent();\n        this.viewer.layout.layoutItems(sections);\n        this.viewer.owner.isShiftingEnabled = false;\n        this.setPositionForCurrentIndex(startPosition, startIndex);\n        this.setPositionForCurrentIndex(endPosition, endIndex);\n        this.viewer.selection.selectPosition(startPosition, endPosition);\n        this.reLayout(this.viewer.selection);\n    };\n    Editor.prototype.combineSection = function () {\n        var sections = [];\n        var nextSection = this.viewer.pages[0].bodyWidgets[0];\n        do {\n            nextSection = this.combineSectionChild(nextSection, sections);\n        } while (nextSection);\n        return sections;\n    };\n    Editor.prototype.combineSectionChild = function (bodyWidget, sections) {\n        var previousBodyWidget = bodyWidget;\n        var temp = new BodyWidget();\n        temp.sectionFormat = bodyWidget.sectionFormat;\n        temp.index = previousBodyWidget.index;\n        do {\n            previousBodyWidget = bodyWidget;\n            if (bodyWidget.lastChild) {\n                bodyWidget.lastChild.combineWidget(this.viewer);\n            }\n            bodyWidget = bodyWidget.nextRenderedWidget;\n            for (var j = 0; j < previousBodyWidget.childWidgets.length; j++) {\n                var block = previousBodyWidget.childWidgets[j];\n                if (block instanceof TableWidget) {\n                    this.viewer.layout.clearTableWidget(block, true, true);\n                }\n                else {\n                    block.x = 0;\n                    block.y = 0;\n                    block.width = 0;\n                    block.height = 0;\n                }\n                temp.childWidgets.push(block);\n                previousBodyWidget.childWidgets.splice(j, 1);\n                j--;\n                block.containerWidget = temp;\n            }\n            previousBodyWidget.page.destroy();\n            // this.viewer.pages.splice(previousBodyWidget.page.index, 1);\n        } while (bodyWidget && previousBodyWidget.equals(bodyWidget));\n        sections.push(temp);\n        return bodyWidget;\n    };\n    Editor.prototype.updateSelectionTableFormat = function (selection, action, value) {\n        switch (action) {\n            case 'TableAlignment':\n                this.editorHistory.initializeHistory('TableAlignment');\n                this.updateTableFormat(selection, 'tableAlignment', value);\n                break;\n            case 'TableLeftIndent':\n                this.editorHistory.initializeHistory('TableLeftIndent');\n                this.updateTableFormat(selection, 'leftIndent', value);\n                break;\n            case 'DefaultCellSpacing':\n                this.editorHistory.initializeHistory('DefaultCellSpacing');\n                this.updateTableFormat(selection, 'cellSpacing', value);\n                break;\n            case 'DefaultCellLeftMargin':\n                this.editorHistory.initializeHistory('DefaultCellLeftMargin');\n                this.updateTableFormat(selection, 'leftMargin', value);\n                break;\n            case 'DefaultCellRightMargin':\n                this.editorHistory.initializeHistory('DefaultCellRightMargin');\n                this.updateTableFormat(selection, 'rightMargin', value);\n                break;\n            case 'DefaultCellTopMargin':\n                this.editorHistory.initializeHistory('DefaultCellTopMargin');\n                this.updateTableFormat(selection, 'topMargin', value);\n                break;\n            case 'TablePreferredWidth':\n                this.editorHistory.initializeHistory('TablePreferredWidth');\n                this.updateTableFormat(selection, 'preferredWidth', value);\n                break;\n            case 'TablePreferredWidthType':\n                this.editorHistory.initializeHistory('TablePreferredWidthType');\n                this.updateTableFormat(selection, 'preferredWidthType', value);\n                break;\n            case 'DefaultCellBottomMargin':\n                this.editorHistory.initializeHistory('DefaultCellBottomMargin');\n                this.updateTableFormat(selection, 'bottomMargin', value);\n                break;\n            case 'CellContentVerticalAlignment':\n                this.editorHistory.initializeHistory('CellContentVerticalAlignment');\n                this.updateCellFormat(selection, 'verticalAlignment', value);\n                break;\n            case 'CellLeftMargin':\n                this.editorHistory.initializeHistory('CellLeftMargin');\n                this.updateCellFormat(selection, 'leftMargin', value);\n                break;\n            case 'CellRightMargin':\n                this.editorHistory.initializeHistory('CellRightMargin');\n                this.updateCellFormat(selection, 'rightMargin', value);\n                break;\n            case 'CellTopMargin':\n                this.editorHistory.initializeHistory('CellTopMargin');\n                this.updateCellFormat(selection, 'topMargin', value);\n                break;\n            case 'CellBottomMargin':\n                this.editorHistory.initializeHistory('CellBottomMargin');\n                this.updateCellFormat(selection, 'bottomMargin', value);\n                break;\n            case 'CellPreferredWidth':\n                this.editorHistory.initializeHistory('CellPreferredWidth');\n                this.updateCellFormat(selection, 'preferredWidth', value);\n                break;\n            case 'CellPreferredWidthType':\n                this.editorHistory.initializeHistory('CellPreferredWidthType');\n                this.updateCellFormat(selection, 'preferredWidthType', value);\n                break;\n            case 'Shading':\n                this.editorHistory.initializeHistory('Shading');\n                this.updateCellFormat(selection, 'shading', value);\n                break;\n            case 'RowHeight':\n                this.editorHistory.initializeHistory('RowHeight');\n                this.updateRowFormat(selection, 'height', value);\n                break;\n            case 'RowHeightType':\n                this.editorHistory.initializeHistory('RowHeightType');\n                this.updateRowFormat(selection, 'heightType', value);\n                break;\n            case 'RowHeader':\n                this.editorHistory.initializeHistory('RowHeader');\n                this.updateRowFormat(selection, 'isHeader', value);\n                break;\n            case 'AllowBreakAcrossPages':\n                this.editorHistory.initializeHistory('AllowBreakAcrossPages');\n                this.updateRowFormat(selection, 'allowBreakAcrossPages', value);\n                break;\n        }\n    };\n    // Update Table Properties\n    /**\n     * Update Table Format on undo\n     * @param  {Selection} selection\n     * @param  {SelectionRange} selectionRange\n     * @param  {string} property\n     * @param  {object} value\n     * @private\n     */\n    Editor.prototype.updateTableFormat = function (selection, property, value) {\n        var tableStartPosition = selection.start;\n        var tableEndPosition = selection.end;\n        if (!selection.isForward) {\n            tableStartPosition = selection.end;\n            tableEndPosition = selection.start;\n        }\n        this.initHistoryPosition(selection, tableStartPosition);\n        // tslint:disable-next-line:max-line-length\n        this.applyTablePropertyValue(selection, property, value, tableStartPosition.paragraph.associatedCell.ownerTable);\n    };\n    /**\n     * update cell format on undo\n     * @param  {Selection} selection\n     * @param  {SelectionRange} selectionRange\n     * @param  {string} property\n     * @param  {Object} value\n     * @private\n     */\n    Editor.prototype.updateCellFormat = function (selection, property, value) {\n        selection.owner.isShiftingEnabled = true;\n        var newStartPosition = selection.start;\n        var newEndPosition = selection.end;\n        if (!selection.isForward) {\n            newStartPosition = selection.end;\n            newEndPosition = selection.start;\n        }\n        this.initHistoryPosition(selection, newStartPosition);\n        this.updateFormatForCell(selection, property, value);\n    };\n    /**\n     * update row format on undo\n     * @param  {Selection} selection\n     * @param  {SelectionRange} selectionRange\n     * @param  {string} property\n     * @param  {Object} value\n     * @private\n     */\n    Editor.prototype.updateRowFormat = function (selection, property, value) {\n        var rowStartPosition = selection.start;\n        var rowEndPosition = selection.end;\n        if (!selection.isForward) {\n            rowStartPosition = selection.end;\n            rowEndPosition = selection.start;\n        }\n        this.initHistoryPosition(selection, rowStartPosition);\n        // tslint:disable-next-line:max-line-length\n        this.applyRowFormat(rowStartPosition.paragraph.associatedCell.ownerRow, rowStartPosition, rowEndPosition, property, value);\n    };\n    Editor.prototype.initHistoryPosition = function (selection, position) {\n        if (this.viewer.owner.editorHistoryModule && !isNullOrUndefined(this.editorHistory.currentBaseHistoryInfo)) {\n            if (!isNullOrUndefined(position)) {\n                if (isNullOrUndefined(this.editorHistory.currentBaseHistoryInfo.insertPosition)) {\n                    this.editorHistory.currentBaseHistoryInfo.insertPosition = position.getHierarchicalIndexInternal();\n                }\n            }\n            else if (isNullOrUndefined(this.editorHistory.currentBaseHistoryInfo.insertPosition)) {\n                this.editorHistory.currentBaseHistoryInfo.insertPosition = selection.start.getHierarchicalIndexInternal();\n            }\n        }\n    };\n    Editor.prototype.startSelectionReLayouting = function (paragraph, selection, start, end) {\n        selection.owner.isLayoutEnabled = true;\n        if (start.paragraph.isInsideTable) {\n            var table = start.paragraph.associatedCell.ownerTable;\n            while (table.isInsideTable) {\n                table = table.associatedCell.ownerTable;\n            }\n            this.reLayoutSelectionOfTable(table, selection, start, end);\n        }\n        else {\n            this.reLayoutSelection(paragraph, selection, start, end);\n        }\n    };\n    Editor.prototype.reLayoutSelectionOfTable = function (table, selection, start, end) {\n        var isEnded = false;\n        this.viewer.layout.layoutBodyWidgetCollection(table.index, table.containerWidget, table, false);\n        // If the selection ends in the current table, need to stop relayouting.\n        if (!isNullOrUndefined(end.paragraph.associatedCell) && table.contains(end.paragraph.associatedCell)) {\n            return true;\n        }\n        var block = selection.getNextRenderedBlock(table);\n        // Relayout the next block.\n        if (!isNullOrUndefined(block)) {\n            isEnded = this.reLayoutSelectionOfBlock(block, selection, start, end);\n        }\n        return isEnded;\n    };\n    Editor.prototype.reLayoutSelection = function (paragraph, selection, start, end) {\n        if (start.paragraph === paragraph) {\n            var startOffset = start.offset;\n            var length_2 = selection.getParagraphLength(paragraph);\n            var indexInInline = 0;\n            var index = 0;\n            var inlineObj = paragraph.getInline(start.offset, indexInInline);\n            var inline = inlineObj.element;\n            indexInInline = inlineObj.index;\n            if (!isNullOrUndefined(inline)) {\n                if (indexInInline === inline.length && !isNullOrUndefined(inline.nextNode)) {\n                    inline = inline.nextNode;\n                }\n                index = inline.line.children.indexOf(inline);\n            }\n            var lineIndex = 0;\n            if (start.currentWidget.paragraph === paragraph) {\n                lineIndex = paragraph.childWidgets.indexOf(start.currentWidget);\n                index = start.currentWidget.children.indexOf(inline);\n            }\n            // If selection start inline is at new inline, need to relayout from the previous inline.\n            if (inline instanceof TextElementBox && !inline.line && index > 0) {\n                this.viewer.layout.reLayoutParagraph(paragraph, lineIndex, index - 1);\n            }\n            else {\n                this.viewer.layout.reLayoutParagraph(paragraph, lineIndex, index);\n            }\n        }\n        else {\n            this.viewer.layout.reLayoutParagraph(paragraph, 0, 0);\n        }\n        // If the selection ends at the current paragraph, need to stop relayouting.\n        if (end.paragraph === paragraph) {\n            return true;\n        }\n        // _Relayout the next block.\n        var block = selection.getNextRenderedBlock(paragraph);\n        if (!isNullOrUndefined(block)) {\n            return this.reLayoutSelectionOfBlock(block, selection, start, end);\n        }\n        return false;\n    };\n    //Relayouting Start    \n    Editor.prototype.reLayoutSelectionOfBlock = function (block, selection, start, end) {\n        if (block instanceof ParagraphWidget) {\n            return this.reLayoutSelection(block, selection, start, end);\n        }\n        else {\n            return undefined;\n            // return this.reLayoutSelectionOfTable(block as TableWidget, selection, start, end);\n        }\n    };\n    /**\n     * @private\n     */\n    Editor.prototype.layoutItemBlock = function (block, shiftNextWidget) {\n        var section = undefined;\n        if (block.containerWidget instanceof BlockContainer) {\n            section = block.containerWidget;\n            var index = section.childWidgets.indexOf(block);\n            if (!isNullOrUndefined(this.viewer.owner)\n                && this.viewer.owner.isLayoutEnabled) {\n                // tslint:disable-next-line:max-line-length\n                this.viewer.layout.layoutBodyWidgetCollection(block.index, section, block, false);\n            }\n        }\n        else if (block.containerWidget instanceof TableCellWidget) {\n            var cell = block.containerWidget;\n            cell = this.viewer.selection.getContainerCell(cell);\n            if (!isNullOrUndefined(this.viewer.owner)\n                && this.viewer.owner.isLayoutEnabled) {\n                this.viewer.layout.reLayoutTable(block);\n            }\n        }\n    };\n    /**\n     * @private\n     */\n    Editor.prototype.removeSelectedContents = function (selection) {\n        return this.removeSelectedContentInternal(selection, selection.start, selection.end);\n    };\n    Editor.prototype.removeSelectedContentInternal = function (selection, startPosition, endPosition) {\n        var startPos = startPosition;\n        var endPos = endPosition;\n        if (!startPosition.isExistBefore(endPosition)) {\n            startPos = endPosition;\n            endPos = startPosition;\n        }\n        // tslint:disable-next-line:max-line-length\n        if (startPos.paragraph === endPos.paragraph && startPos.paragraph.childWidgets.indexOf(startPos.currentWidget) === startPos.paragraph.childWidgets.length - 1 &&\n            startPos.offset === selection.getParagraphLength(startPos.paragraph) && startPos.offset + 1 === endPos.offset) {\n            selection.owner.isShiftingEnabled = true;\n            selection.selectContent(startPos, true);\n            return true;\n        }\n        var paragraphInfo = this.getParagraphInfo(startPos);\n        selection.editPosition = this.getHierarchicalIndex(paragraphInfo.paragraph, paragraphInfo.offset.toString());\n        var isRemoved = this.removeSelectedContent(endPos.paragraph, selection, startPos, endPos);\n        var textPosition = new TextPosition(selection.owner);\n        this.setPositionForCurrentIndex(textPosition, selection.editPosition);\n        selection.selectContent(textPosition, true);\n        return isRemoved;\n    };\n    Editor.prototype.removeSelectedContent = function (paragraph, selection, start, end) {\n        //If end is not table end and start is outside the table, then skip removing the contents and move caret to start position.\n        if (end.paragraph.isInsideTable\n            && end.paragraph !== selection.getLastParagraphInLastCell(end.paragraph.associatedCell.ownerTable)\n            && (!start.paragraph.isInsideTable || start.paragraph.associatedCell.ownerTable !== end.paragraph.associatedCell.ownerTable)) {\n            return false;\n        }\n        selection.owner.isShiftingEnabled = true;\n        this.deleteSelectedContent(paragraph, selection, start, end, 2);\n        return true;\n    };\n    // tslint:disable-next-line:max-line-length\n    Editor.prototype.deleteSelectedContent = function (paragraph, selection, start, end, editAction) {\n        var indexInInline = 0;\n        var inlineObj = start.currentWidget.getInline(start.offset, indexInInline);\n        var inline = inlineObj.element;\n        indexInInline = inlineObj.index;\n        // if (!isNullOrUndefined(inline)) {\n        //     inline = selection.getNextRenderedInline(inline, indexInInline);\n        // }\n        // if (inline instanceof WFieldBegin && !isNullOrUndefined((inline as WFieldBegin).fieldEnd)) {\n        // tslint:disable-next-line:max-line-length\n        //     let fieldEndOffset: number = ((inline as WFieldBegin).fieldEnd.owner as WParagraph).getOffset((inline as WFieldBegin).fieldEnd, 1);\n        //     let fieldEndIndex: string = WordDocument.getHierarchicalIndexOf((inline as WFieldBegin).fieldEnd.owner as WParagraph, fieldEndOffset.toString());\n        //     let selectionEndIndex: string = end.getHierarchicalIndexInternal();\n        //     if (!TextPosition.isForwardSelection(fieldEndIndex, selectionEndIndex)) {\n        //         //If selection end is after field begin, moves selection start to field separator.\n        //         start.moveToInline((inline as WFieldBegin).fieldSeparator, 1);\n        //         selection.editPosition = start.getHierarchicalIndexInternal();\n        //         if (!isNullOrUndefined(selection.currentBaseHistoryInfo)) {\n        //             selection.currentBaseHistoryInfo.insertPosition = selection.editPosition;\n        //         }\n        //     }\n        // }\n        indexInInline = 0;\n        inlineObj = end.currentWidget.getInline(end.offset, indexInInline);\n        inline = inlineObj.element;\n        indexInInline = inlineObj.index;\n        // if (!isNullOrUndefined(inline)) {\n        //     inline = selection.getNextRenderedInline(inline, indexInInline);\n        // }\n        // if (inline instanceof WFieldEnd && !isNullOrUndefined((inline as WFieldEnd).fieldBegin)) {\n        // tslint:disable-next-line:max-line-length\n        //     let fieldBeginOffset: number = ((inline as WFieldEnd).fieldBegin.owner as WParagraph).getOffset((inline as WFieldEnd).fieldBegin, 0);\n        //     let fieldBeginIndex: string = WordDocument.getHierarchicalIndexOf((inline as WFieldEnd).fieldBegin.owner as WParagraph, fieldBeginOffset.toString());\n        //     let selectionStartIndex: string = start.getHierarchicalIndexInternal();\n        //     if (!TextPosition.isForwardSelection(selectionStartIndex, fieldBeginIndex)) {\n        //         //If field begin is before selection start, move selection end to inline item before field end.\n        //         let prevInline: WInline = selection.getPreviousTextInline(inline);\n        //         if (isNullOrUndefined(prevInline)) {\n        //             end.moveBackward();\n        //         } else {\n        //             end.moveToInline(prevInline, prevInline.length);\n        //         }\n        //     }\n        // }\n        if (end.paragraph !== paragraph) {\n            this.deleteSelectedContent(end.paragraph, selection, start, end, editAction);\n            return;\n        }\n        //  Selection start in cell.\n        if (end.paragraph.isInsideTable && (!start.paragraph.isInsideTable\n            || start.paragraph.associatedCell !== end.paragraph.associatedCell\n            || selection.isCellSelected(end.paragraph.associatedCell, start, end))) {\n            end.paragraph.associatedCell.ownerTable.combineWidget(this.viewer);\n            this.deleteTableCell(end.paragraph.associatedCell, selection, start, end, editAction);\n        }\n        else {\n            this.deletePara(paragraph, start, end, editAction);\n        }\n    };\n    /**\n     * Merge the selected cells.\n     */\n    Editor.prototype.mergeCells = function () {\n        if (this.owner.isReadOnlyMode || !this.owner.isDocumentLoaded) {\n            return;\n        }\n        if (!isNullOrUndefined(this.viewer) && !this.selection.isEmpty) {\n            this.mergeSelectedCellsInTable();\n        }\n    };\n    /**\n     * Deletes the entire table at selection.\n     */\n    Editor.prototype.deleteTable = function () {\n        if (this.owner.isReadOnlyMode) {\n            return;\n        }\n        var startPos = this.selection.isForward ? this.selection.start : this.selection.end;\n        if (startPos.paragraph.isInsideTable) {\n            var table = this.getOwnerTable(this.selection.isForward).combineWidget(this.viewer);\n            this.selection.owner.isShiftingEnabled = true;\n            if (this.checkIsNotRedoing()) {\n                this.initHistory('DeleteTable');\n                //Sets the insert position in history info as current table.    \n                this.updateHistoryPosition(startPos, true);\n            }\n            var paragraph = this.getParagraphForSelection(table);\n            if (this.editorHistory && this.editorHistory.currentBaseHistoryInfo) {\n                this.editorHistory.currentBaseHistoryInfo.removedNodes.push(table.clone());\n            }\n            this.removeBlock(table);\n            this.selection.selectParagraph(paragraph, true);\n            if (this.checkIsNotRedoing() || isNullOrUndefined(this.editorHistory)) {\n                this.reLayout(this.selection);\n            }\n        }\n    };\n    /**\n     * Deletes the selected column(s).\n     */\n    Editor.prototype.deleteColumn = function () {\n        if (this.owner.isReadOnlyMode) {\n            return;\n        }\n        var startPos = this.selection.isForward ? this.selection.start : this.selection.end;\n        var endPos = this.selection.isForward ? this.selection.end : this.selection.start;\n        if (startPos.paragraph.isInsideTable) {\n            this.selection.owner.isShiftingEnabled = true;\n            if (this.checkIsNotRedoing()) {\n                this.initHistory('DeleteColumn');\n            }\n            var startCell = this.getOwnerCell(this.selection.isForward);\n            var endCell = this.getOwnerCell(!this.selection.isForward);\n            var table = startCell.ownerTable.combineWidget(this.viewer);\n            if (this.editorHistory && this.editorHistory.currentBaseHistoryInfo) {\n                this.cloneTableToHistoryInfo(table);\n            }\n            var paragraph = undefined;\n            if (endCell.nextWidget) {\n                var nextCell = endCell.nextWidget;\n                paragraph = this.selection.getFirstParagraph(nextCell);\n            }\n            else if (startCell.previousWidget) {\n                var previousCell = startCell.previousWidget;\n                paragraph = this.selection.getFirstParagraph(previousCell);\n            }\n            if (isNullOrUndefined(paragraph)) {\n                paragraph = this.getParagraphForSelection(table);\n            }\n            //retrieve the cell collection based on start and end cell to remove. \n            var deleteCells = table.getColumnCellsForSelection(startCell, endCell);\n            for (var i = 0; i < table.childWidgets.length; i++) {\n                var row = table.childWidgets[i];\n                if (row.childWidgets.length === 1) {\n                    if (deleteCells.indexOf(row.childWidgets[0]) >= 0) {\n                        table.childWidgets.splice(table.childWidgets.indexOf(row), 1);\n                        row.destroy();\n                        i--;\n                    }\n                }\n                else {\n                    for (var j = 0; j < row.childWidgets.length; j++) {\n                        var tableCell = row.childWidgets[j];\n                        if (deleteCells.indexOf(tableCell) >= 0) {\n                            row.childWidgets.splice(j, 1);\n                            tableCell.destroy();\n                            j--;\n                        }\n                    }\n                    if (row.childWidgets.length === 0) {\n                        table.childWidgets.splice(table.childWidgets.indexOf(row), 1);\n                        row.destroy();\n                        i--;\n                    }\n                }\n            }\n            if (table.childWidgets.length === 0) {\n                // Before disposing table reset the paragrph.\n                paragraph = this.getParagraphForSelection(table);\n                this.removeBlock(table);\n                if (this.editorHistory && this.editorHistory.currentBaseHistoryInfo) {\n                    this.editorHistory.currentBaseHistoryInfo.action = 'DeleteTable';\n                }\n                table.destroy();\n            }\n            else {\n                table.isGridUpdated = false;\n                table.buildTableColumns();\n                table.isGridUpdated = true;\n                this.viewer.layout.reLayoutTable(table);\n            }\n            this.selection.selectParagraph(paragraph, true);\n            if (isNullOrUndefined(this.editorHistory) || this.checkIsNotRedoing()) {\n                this.reLayout(this.selection, true);\n            }\n        }\n    };\n    /**\n     * Deletes the selected row(s).\n     */\n    Editor.prototype.deleteRow = function () {\n        if (this.owner.isReadOnlyMode) {\n            return;\n        }\n        var startPos = !this.selection.isForward ? this.selection.end : this.selection.start;\n        var endPos = !this.selection.isForward ? this.selection.start : this.selection.end;\n        if (startPos.paragraph.isInsideTable) {\n            var startCell = this.getOwnerCell(this.selection.isForward);\n            var endCell = this.getOwnerCell(!this.selection.isForward);\n            if (this.checkIsNotRedoing()) {\n                this.initHistory('DeleteRow');\n            }\n            this.selection.owner.isShiftingEnabled = true;\n            var table = startCell.ownerTable.combineWidget(this.viewer);\n            var row = this.getOwnerRow(true);\n            if (this.editorHistory && this.editorHistory.currentBaseHistoryInfo) {\n                this.cloneTableToHistoryInfo(table);\n            }\n            var paragraph = undefined;\n            if (row.nextWidget) {\n                var nextCell = row.nextWidget.childWidgets[0];\n                paragraph = this.selection.getFirstParagraph(nextCell);\n            }\n            if (isNullOrUndefined(paragraph)) {\n                paragraph = this.getParagraphForSelection(table);\n            }\n            if (!this.selection.isEmpty) {\n                //tslint:disable-next-line:max-line-length\n                var containerCell = this.selection.getContainerCellOf(startCell, endCell);\n                if (containerCell.ownerTable.contains(endCell)) {\n                    startCell = this.selection.getSelectedCell(startCell, containerCell);\n                    endCell = this.selection.getSelectedCell(endCell, containerCell);\n                    if (this.selection.containsCell(containerCell, endCell)) {\n                        row = startCell.ownerRow;\n                        this.removeRow(row);\n                    }\n                    else {\n                        row = startCell.ownerRow;\n                        var endRow = endCell.ownerRow;\n                        //Update the selection paragraph.\n                        paragraph = undefined;\n                        if (endRow.nextWidget) {\n                            var nextCell = endRow.nextWidget.childWidgets[0];\n                            paragraph = this.selection.getFirstParagraph(nextCell);\n                        }\n                        if (isNullOrUndefined(paragraph)) {\n                            paragraph = this.getParagraphForSelection(table);\n                        }\n                        for (var i = 0; i < table.childWidgets.length; i++) {\n                            var tableRow = table.childWidgets[i];\n                            if (tableRow.rowIndex >= row.rowIndex && tableRow.rowIndex <= endRow.rowIndex) {\n                                table.childWidgets.splice(i, 1);\n                                tableRow.destroy();\n                                i--;\n                            }\n                        }\n                        if (table.childWidgets.length === 0) {\n                            this.removeBlock(table);\n                            if (this.editorHistory && this.editorHistory.currentBaseHistoryInfo) {\n                                this.editorHistory.currentBaseHistoryInfo.action = 'DeleteTable';\n                            }\n                            table.destroy();\n                        }\n                        else {\n                            this.updateTable(table);\n                        }\n                    }\n                }\n            }\n            else {\n                this.removeRow(row);\n            }\n            this.selection.selectParagraph(paragraph, true);\n            if (isNullOrUndefined(this.editorHistory) || this.checkIsNotRedoing()) {\n                this.reLayout(this.selection, true);\n            }\n        }\n    };\n    Editor.prototype.removeRow = function (row) {\n        var table = row.ownerTable;\n        if (table.childWidgets.length === 1) {\n            this.removeBlock(table);\n            if (this.editorHistory && this.editorHistory.currentBaseHistoryInfo) {\n                this.editorHistory.currentBaseHistoryInfo.action = 'Delete';\n            }\n            table.destroy();\n        }\n        else {\n            table.childWidgets.splice(table.childWidgets.indexOf(row), 1);\n            row.destroy();\n            this.updateTable(table);\n        }\n    };\n    Editor.prototype.updateTable = function (table) {\n        table.updateRowIndex(0);\n        table.isGridUpdated = false;\n        table.buildTableColumns();\n        table.isGridUpdated = true;\n        this.viewer.layout.reLayoutTable(table);\n    };\n    Editor.prototype.getParagraphForSelection = function (table) {\n        var paragraph = undefined;\n        var nextWidget = table.nextWidget ? table.nextWidget : table.nextRenderedWidget;\n        var previousWidget = table.previousWidget ? table.previousWidget : table.previousRenderedWidget;\n        if (nextWidget) {\n            paragraph = nextWidget instanceof ParagraphWidget ? nextWidget\n                : this.selection.getFirstParagraphInFirstCell(nextWidget);\n        }\n        else if (previousWidget) {\n            paragraph = previousWidget instanceof ParagraphWidget ? previousWidget\n                : this.selection.getLastParagraphInLastCell(previousWidget);\n        }\n        return paragraph;\n    };\n    Editor.prototype.deletePara = function (paragraph, start, end, editAction) {\n        paragraph = paragraph.combineWidget(this.viewer);\n        var selection = this.viewer.selection;\n        var paragraphStart = selection.getStartOffset(paragraph);\n        var endParagraphStartOffset = selection.getStartOffset(end.paragraph);\n        var startOffset = paragraphStart;\n        var endOffset = 0;\n        var isCombineNextParagraph = false;\n        var lastLinelength = this.selection.getLineLength(paragraph.lastChild);\n        var currentParagraph = paragraph;\n        var section = paragraph.bodyWidget instanceof BodyWidget ? paragraph.bodyWidget : undefined;\n        var startLine = undefined;\n        var endLineWidget = undefined;\n        if (paragraph === start.paragraph) {\n            startOffset = start.offset;\n            startLine = start.currentWidget;\n            if (end.paragraph.isInsideTable) {\n                isCombineNextParagraph = this.isEndInAdjacentTable(paragraph, end.paragraph);\n            }\n        }\n        else {\n            startLine = paragraph.firstChild;\n        }\n        if (paragraph !== start.paragraph && selection.isSkipLayouting) {\n            selection.isSkipLayouting = false;\n        }\n        if (paragraph === end.paragraph) {\n            endLineWidget = end.currentWidget;\n            endOffset = end.offset;\n        }\n        else {\n            endLineWidget = paragraph.lastChild;\n            endOffset = this.viewer.selection.getLineLength(paragraph.lastChild);\n        }\n        var block = paragraph.previousRenderedWidget;\n        if (startOffset > paragraphStart && start.currentWidget === paragraph.lastChild &&\n            startOffset === lastLinelength && (paragraph === end.paragraph && end.offset === startOffset + 1 ||\n            paragraph.nextRenderedWidget === end.paragraph && end.offset === endParagraphStartOffset) ||\n            (this.editorHistory && this.editorHistory.isUndoing && this.editorHistory.currentHistoryInfo &&\n                this.editorHistory.currentHistoryInfo.action === 'PageBreak' && block && block.isPageBreak())) {\n            isCombineNextParagraph = true;\n        }\n        if (end.paragraph === paragraph && end.currentWidget !== paragraph.lastChild ||\n            (end.currentWidget === paragraph.lastChild && end.offset <= selection.getLineLength(paragraph.lastChild))) {\n            var isStartParagraph = start.paragraph === paragraph;\n            if (end.currentWidget.isFirstLine() && end.offset > paragraphStart || !end.currentWidget.isFirstLine()) {\n                //If selection end with this paragraph and selection doesnot include paragraph mark.               \n                this.removeInlines(paragraph, startLine, startOffset, endLineWidget, endOffset, editAction);\n                //Removes the splitted paragraph.\n            }\n            if (!isNullOrUndefined(block) && !isStartParagraph) {\n                var nextSection = block.bodyWidget instanceof BodyWidget ? block.bodyWidget : undefined;\n                if (nextSection && !section.equals(nextSection) && section.index !== nextSection.index) {\n                    this.deleteSection(selection, nextSection, section, editAction);\n                }\n                this.deleteBlock(block, selection, start, end, editAction);\n            }\n        }\n        else if (start.paragraph === paragraph && (start.currentWidget !== paragraph.firstChild ||\n            (start.currentWidget === paragraph.firstChild && startOffset > paragraphStart))) {\n            // If selection start is after paragraph start\n            //And selection does not end with this paragraph Or selection include paragraph mark.\n            if (editAction === 4) {\n                return;\n            }\n            else {\n                currentParagraph = this.splitParagraph(paragraph, paragraph.firstChild, 0, startLine, startOffset, true);\n                this.insertParagraphPaste(paragraph, currentParagraph, start, end, isCombineNextParagraph, editAction);\n                this.addRemovedNodes(paragraph);\n                return;\n            }\n        }\n        else {\n            var newParagraph = undefined;\n            var previousBlock = paragraph.previousWidget;\n            var prevParagraph = (previousBlock instanceof ParagraphWidget) ? previousBlock : undefined;\n            var nextWidget = paragraph.nextRenderedWidget;\n            if (editAction < 4) {\n                //Checks whether this is last paragraph of owner text body and previousBlock is not paragraph.\n                newParagraph = this.checkAndInsertBlock(paragraph, start, end, editAction, prevParagraph);\n                this.removeBlock(paragraph);\n                if (this.viewer.blockToShift === paragraph) {\n                    this.viewer.blockToShift = undefined;\n                }\n                this.addRemovedNodes(paragraph);\n                if (!isNullOrUndefined(newParagraph)) {\n                    selection.editPosition = this.getHierarchicalIndex(newParagraph, '0');\n                    var offset = selection.getParagraphLength(newParagraph) + 1;\n                    if (this.editorHistory && !isNullOrUndefined(this.editorHistory.currentBaseHistoryInfo)) {\n                        //tslint:disable-next-line:max-line-length\n                        this.editorHistory.currentBaseHistoryInfo.endPosition = this.getHierarchicalIndex(newParagraph, offset.toString());\n                    }\n                }\n                else if (paragraph === start.paragraph && isNullOrUndefined(nextWidget) && !isNullOrUndefined(prevParagraph)) {\n                    var offset = this.selection.getParagraphLength(prevParagraph);\n                    // if (isNullOrUndefined(block)) {\n                    selection.editPosition = this.getHierarchicalIndex(prevParagraph, offset.toString());\n                    if (this.editorHistory && !isNullOrUndefined(this.editorHistory.currentBaseHistoryInfo)) {\n                        this.updateHistoryPosition(selection.editPosition, true);\n                        this.editorHistory.currentBaseHistoryInfo.endPosition = selection.editPosition;\n                    }\n                    // } else {\n                    //     let offset: number = selection.getParagraphLength(paragraph) + 1;\n                    //     if (block instanceof ParagraphWidget) {\n                    //         prevParagraph = block as ParagraphWidget;\n                    //     }\n                    //     // if (block instanceof WTable) {\n                    //     //     prevParagraph = (block as WTable).getFirstParagraphInFirstCell();\n                    //     // }\n                    //     selection.editPosition = prevLineWidget.getHierarchicalIndex('0');\n                    // }\n                }\n            }\n            if (start.paragraph !== paragraph && !isNullOrUndefined(block)) {\n                var nextSection = block.bodyWidget instanceof BodyWidget ? block.bodyWidget : undefined;\n                // if (section !== nextSection) {\n                //     this.deleteSection(selection, section, nextSection, editAction);\n                // }\n                this.deleteBlock(block, selection, start, end, editAction);\n            }\n        }\n        this.insertParagraphPaste(paragraph, currentParagraph, start, end, isCombineNextParagraph, editAction);\n    };\n    Editor.prototype.deleteSection = function (selection, section, nextSection, editAction) {\n        if (editAction < 4) {\n            this.combineSectionInternal(selection, section, nextSection);\n        }\n        //Copies the section properties, if this is last paragraph of section.\n        if (editAction > 2) {\n            section.sectionFormat.copyFormat(nextSection.sectionFormat);\n        }\n    };\n    Editor.prototype.combineSectionInternal = function (selection, section, nextSection) {\n        // if (section.sectionFormat.isEqualFormat(nextSection.sectionFormat)) {\n        // } else {\n        var bodyWidget = section.getSplitWidgets()[0];\n        var currentSection = [];\n        this.combineSectionChild(bodyWidget, currentSection);\n        bodyWidget = currentSection[0];\n        var lastBlockIndex = bodyWidget.lastChild.index;\n        this.updateBlockIndex(lastBlockIndex + 1, nextSection.firstChild);\n        var insertIndex = 0;\n        var containerWidget = nextSection;\n        for (var i = 0; i < bodyWidget.childWidgets.length; i++) {\n            var block = bodyWidget.childWidgets.splice(i, 1)[0];\n            containerWidget.childWidgets.splice(insertIndex, 0, block);\n            block.containerWidget = containerWidget;\n            this.viewer.layout.layoutBodyWidgetCollection(block.index, block.bodyWidget, block, false);\n            block = block.getSplitWidgets().pop();\n            containerWidget = block.containerWidget;\n            insertIndex = block.indexInOwner + 1;\n            i--;\n        }\n        this.updateSectionIndex(undefined, nextSection, false);\n        this.addRemovedNodes(bodyWidget);\n        // this.insert\n        // }\n    };\n    //tslint:disable:max-line-length\n    /**\n     * @private\n     */\n    Editor.prototype.checkAndInsertBlock = function (block, start, end, editAction, previousParagraph) {\n        if (block instanceof ParagraphWidget && block === start.paragraph || block instanceof TableWidget) {\n            var newParagraph = void 0; //Adds an empty paragraph, to ensure minimal content.\n            if (isNullOrUndefined(block.nextWidget) && (isNullOrUndefined(previousParagraph) || previousParagraph.nextRenderedWidget instanceof TableWidget)) {\n                newParagraph = new ParagraphWidget();\n                if (editAction === 1 && block instanceof ParagraphWidget) {\n                    newParagraph.characterFormat.copyFormat(block.characterFormat);\n                    newParagraph.paragraphFormat.copyFormat(block.paragraphFormat);\n                }\n                newParagraph.index = block.index + 1;\n                newParagraph.containerWidget = block.containerWidget;\n                this.viewer.layout.layoutBodyWidgetCollection(newParagraph.index, newParagraph.bodyWidget, newParagraph, false);\n                if (block.containerWidget instanceof Widget) {\n                    block.containerWidget.childWidgets.push(newParagraph);\n                }\n            }\n            return newParagraph;\n        }\n        return undefined;\n    };\n    // tslint:disable-next-line:max-line-length\n    Editor.prototype.splitParagraph = function (paragraphAdv, startLine, startOffset, endLine, endOffset, removeBlock) {\n        var paragraph = new ParagraphWidget();\n        paragraph.paragraphFormat = new WParagraphFormat(paragraph);\n        paragraph.characterFormat = new WCharacterFormat(paragraph);\n        paragraph.paragraphFormat.copyFormat(paragraphAdv.paragraphFormat);\n        paragraph.characterFormat.copyFormat(paragraphAdv.characterFormat);\n        var lineWidget = new LineWidget(paragraph);\n        paragraph.childWidgets.push(lineWidget);\n        var blockIndex = paragraphAdv.index;\n        var insertIndex = paragraphAdv.indexInOwner;\n        this.moveInlines(paragraphAdv, paragraph, 0, startOffset, startLine, endOffset, endLine);\n        //Inserts new paragraph in the current text position.\n        paragraphAdv.containerWidget.childWidgets.splice(insertIndex, 0, paragraph);\n        paragraph.index = blockIndex;\n        paragraph.containerWidget = paragraphAdv.containerWidget;\n        this.updateNextBlocksIndex(paragraph, true);\n        if (removeBlock) {\n            this.removeBlock(paragraphAdv);\n        }\n        // tslint:disable-next-line:max-line-length\n        this.viewer.layout.layoutBodyWidgetCollection(blockIndex, paragraph.containerWidget, paragraph, false);\n        return paragraph;\n    };\n    /**\n     * @private\n     */\n    Editor.prototype.removeBlock = function (block) {\n        var index;\n        var blockCollection;\n        var containerWidget;\n        this.removeFieldInBlock(block);\n        if (block.isInsideTable) {\n            containerWidget = block.associatedCell;\n            index = block.associatedCell.childWidgets.indexOf(block);\n            blockCollection = block.associatedCell.childWidgets;\n            this.updateNextBlocksIndex(block, false);\n            block.associatedCell.childWidgets.splice(index, 1);\n            block.containerWidget = undefined;\n            this.viewer.layout.layoutBodyWidgetCollection(block.index, containerWidget, block, false);\n        }\n        else {\n            containerWidget = block.containerWidget;\n            index = containerWidget.childWidgets.indexOf(block);\n            blockCollection = containerWidget.childWidgets;\n            this.updateNextBlocksIndex(block, false);\n            containerWidget.childWidgets.splice(index, 1);\n            block.containerWidget = undefined;\n            containerWidget.height -= block.height;\n            this.viewer.layout.layoutBodyWidgetCollection(block.index, containerWidget, block, false);\n        }\n    };\n    Editor.prototype.removeField = function (block) {\n        for (var i = 0; i < this.viewer.fields.length; i++) {\n            var field = this.viewer.fields[i];\n            if (field.line.paragraph === block) {\n                this.viewer.fields.splice(i, 1);\n                i--;\n            }\n        }\n    };\n    Editor.prototype.addRemovedNodes = function (node) {\n        if (node instanceof FieldElementBox && node.fieldType === 0) {\n            if (this.viewer.fields.indexOf(node) !== -1) {\n                this.viewer.fields.splice(this.viewer.fields.indexOf(node), 1);\n            }\n        }\n        if (this.editorHistory && !isNullOrUndefined(this.editorHistory.currentBaseHistoryInfo)) {\n            this.editorHistory.currentBaseHistoryInfo.removedNodes.push(node);\n        }\n        else if (this.editHyperlinkInternal) {\n            this.nodes.push(node);\n        }\n    };\n    Editor.prototype.deleteBlock = function (block, selection, start, end, editAction) {\n        if (block instanceof ParagraphWidget) {\n            this.deletePara(block, start, end, editAction);\n        }\n        else {\n            this.deleteTableBlock(block, selection, start, end, editAction);\n        }\n    };\n    // tslint:disable-next-line:max-line-length\n    Editor.prototype.deleteTableCell = function (cellAdv, selection, start, end, editAction) {\n        var deletePreviousBlock = !(start.paragraph.isInsideTable && cellAdv.ownerTable.contains(start.paragraph.associatedCell));\n        var previousBlock = cellAdv.ownerTable.previousRenderedWidget;\n        if (start.paragraph.isInsideTable) {\n            var containerCell = selection.getContainerCellOf(cellAdv, start.paragraph.associatedCell);\n            if (containerCell.ownerTable.contains(start.paragraph.associatedCell)) {\n                var startCell = selection.getSelectedCell(cellAdv, containerCell);\n                var endCell = selection.getSelectedCell(start.paragraph.associatedCell, containerCell);\n                if (selection.containsCell(containerCell, start.paragraph.associatedCell)) {\n                    //Selection end is in container cell.\n                    if (selection.isCellSelected(containerCell, start, end)) {\n                        //Container cell is completely selected.\n                        this.updateEditPosition(containerCell, selection);\n                        if (editAction === 1) {\n                            //Specifically handled for backspace. Delete selected cell in current table.\n                            this.deleteCellsInTable(cellAdv.ownerRow.ownerTable, selection, start, end, editAction);\n                        }\n                        else {\n                            //Delete contents within table cell or Copy contents within table cell to clipboard.\n                            var isCellCleared = this.deleteCell(containerCell, selection, editAction, true);\n                            if (!isCellCleared && editAction !== 2 && this.editorHistory) {\n                                this.editorHistory.currentBaseHistoryInfo = undefined;\n                            }\n                        }\n                    }\n                    else {\n                        if (startCell === containerCell) {\n                            this.deletePara(end.paragraph, start, end, editAction);\n                        }\n                        else {\n                            this.deleteContainer(startCell, selection, start, end, editAction);\n                        }\n                    }\n                }\n                else {\n                    if (editAction === 2) {\n                        //Delete contents within table cell.\n                        this.deleteCell(cellAdv, selection, 2, false);\n                    }\n                    else {\n                        //Delete other selected cells in current table.\n                        this.deleteCellsInTable(containerCell.ownerTable, selection, start, end, editAction);\n                    }\n                }\n            }\n            else {\n                //Selection end is different table.\n                this.deleteContainer(containerCell, selection, start, end, editAction);\n            }\n        }\n        else {\n            //Selection end is outside table.\n            var cell = selection.getContainerCell(cellAdv);\n            this.deleteContainer(cell, selection, start, end, editAction);\n        }\n        if (deletePreviousBlock) {\n            var sectionAdv = previousBlock.bodyWidget instanceof BodyWidget ? previousBlock.bodyWidget : undefined;\n            // this.deleteContent(cellAdv.ownerTable, selection, editAction);\n            if (!isNullOrUndefined(previousBlock)) {\n                // let nextSection: WSection = blockAdv.section instanceof WSection ? blockAdv.section as WSection : undefined;\n                // if (sectionAdv !== nextSection) {\n                //     this.deleteSection(selection, sectionAdv, nextSection, editAction);\n                // }\n                //Goto the next block.\n                this.deleteBlock(previousBlock, selection, start, end, editAction);\n            }\n        }\n    };\n    // tslint:disable-next-line:max-line-length\n    Editor.prototype.deleteCellsInTable = function (table, selection, start, end, editAction) {\n        var clonedTable = undefined;\n        var isDeleteCells = false;\n        var action = 'Delete';\n        var startCell = start.paragraph.associatedCell;\n        var endCell = end.paragraph.associatedCell;\n        if (this.editorHistory && !isNullOrUndefined(this.editorHistory.currentBaseHistoryInfo)) {\n            action = this.editorHistory.currentBaseHistoryInfo.action;\n            //tslint:disable-next-line:max-line-length\n            isDeleteCells = this.editorHistory.currentBaseHistoryInfo.action === 'BackSpace' || this.editorHistory.currentBaseHistoryInfo.action === 'DeleteCells'\n                || this.editorHistory.currentBaseHistoryInfo.action === 'InsertTable' || (isNullOrUndefined(startCell.ownerRow.previousWidget)\n                && isNullOrUndefined(endCell.ownerRow.nextWidget) && this.editorHistory.currentBaseHistoryInfo.action === 'Cut');\n            this.editorHistory.currentBaseHistoryInfo.action = isDeleteCells ? 'DeleteCells' : 'ClearCells';\n            clonedTable = this.cloneTableToHistoryInfo(table);\n            selection.owner.isLayoutEnabled = false;\n        }\n        var startColumnIndex = startCell.columnIndex;\n        var endColumnIndex = endCell.columnIndex + endCell.cellFormat.columnSpan - 1;\n        var startRowIndex = startCell.rowIndex;\n        var endRowIndex = endCell.rowIndex;\n        var cells = [];\n        var isStarted = false;\n        var isCellCleared = false;\n        for (var i = 0; i < table.childWidgets.length; i++) {\n            var row = table.childWidgets[i];\n            if (row.index >= startRowIndex && row.index <= endRowIndex) {\n                for (var j = 0; j < row.childWidgets.length; j++) {\n                    var cell = row.childWidgets[j];\n                    if (cell.columnIndex >= startColumnIndex && cell.columnIndex <= endColumnIndex) {\n                        if (!isStarted) {\n                            this.updateEditPosition(cell, selection);\n                            isStarted = true;\n                        }\n                        if (isDeleteCells) {\n                            //Specific for Backspace and Cut if selection includes all rows.\n                            var cell_1 = row.childWidgets[j];\n                            this.updateNextBlocksIndex(cell_1, false);\n                            row.childWidgets.splice(j, 1);\n                            j--;\n                        }\n                        else if (editAction < 4) {\n                            isCellCleared = this.deleteCell(cell, selection, editAction, false);\n                        }\n                    }\n                }\n                if (row.childWidgets.length === 0) {\n                    this.updateNextBlocksIndex(table.childWidgets[i], false);\n                    table.childWidgets.splice(i, 1);\n                    i--;\n                    endRowIndex--;\n                }\n            }\n        }\n        //Layouts the table after delete cells.\n        selection.owner.isLayoutEnabled = true;\n        if (table.childWidgets.length === 0) {\n            selection.editPosition = this.getHierarchicalIndex(table, '0');\n            this.setActionInternal(selection, action);\n            this.removeBlock(table);\n        }\n        else {\n            // Before lay outing need to update table grid.\n            table.isGridUpdated = false;\n            table.buildTableColumns();\n            table.isGridUpdated = true;\n            this.viewer.layout.reLayoutTable(table);\n        }\n    };\n    Editor.prototype.deleteCell = function (cell, selection, editAction, copyChildToClipboard) {\n        //Checks whether this is last paragraph of owner textbody.\n        var block = cell.childWidgets[0];\n        if (cell.childWidgets.length === 1 && block instanceof ParagraphWidget && block.isEmpty()) {\n            return false;\n        }\n        for (var i = 0; i < cell.childWidgets.length; i++) {\n            block = cell.childWidgets[i];\n            if (editAction < 4) {\n                //Checks whether this is last paragraph of owner textbody.\n                if (block instanceof ParagraphWidget && cell.childWidgets.length === 1) {\n                    //Preserves empty paragraph, to ensure minimal content.\n                    var paragraph = block;\n                    //Removes all the inlines in the paragraph.\n                    for (var j = 0; j < paragraph.childWidgets.length; j++) {\n                        var inline = paragraph.childWidgets[j];\n                        for (var k = 0; k < inline.children.length; k++) {\n                            var element = inline.children[k];\n                            this.unLinkFieldCharacter(element);\n                            inline.children.splice(k, 1);\n                            // this.layoutInlineCollection(true, paragraph.inlines.indexOf(inline), paragraph.inlines, inline);\n                            k--;\n                            if (this.checkClearCells(selection)) {\n                                this.addRemovedNodes(element);\n                            }\n                        }\n                        if (paragraph.childWidgets.length > 1) {\n                            paragraph.childWidgets.splice(j, 1);\n                            j--;\n                        }\n                    }\n                    if (this.checkClearCells(selection)) {\n                        //Add Index for line Widget\n                        selection.editPosition = this.getHierarchicalIndex(paragraph, '0');\n                        this.updateHistoryPosition(selection.editPosition, true);\n                    }\n                    break;\n                }\n                this.removeBlock(block);\n                i--;\n                if (this.checkClearCells(selection)) {\n                    this.addRemovedNodes(block);\n                }\n            }\n        }\n        return true;\n    };\n    Editor.prototype.deleteContainer = function (cell, selection, start, end, editAction) {\n        var ownerTable = cell.ownerTable;\n        if (selection.containsRow(ownerTable.lastChild, end.paragraph.associatedCell)) {\n            this.deleteContent(ownerTable, selection, editAction);\n        }\n        else {\n            for (var i = 0; i < ownerTable.childWidgets.length; i++) {\n                var row = ownerTable.childWidgets[i];\n                if (editAction < 4) {\n                    this.updateNextBlocksIndex(row, false);\n                    ownerTable.childWidgets.splice(i, 1);\n                    this.addRemovedNodes(row);\n                    i--;\n                }\n                if (end.paragraph.isInsideTable && selection.containsRow(row, end.paragraph.associatedCell)) {\n                    this.viewer.layout.reLayoutTable(ownerTable);\n                    return;\n                }\n            }\n        }\n    };\n    Editor.prototype.deleteTableBlock = function (table, selection, start, end, editAction) {\n        table = table.combineWidget(this.viewer);\n        if (start.paragraph.isInsideTable && table.contains(start.paragraph.associatedCell)) {\n            var block = table.previousRenderedWidget;\n            // tslint:disable-next-line:max-line-length\n            var previousBlock = this.checkAndInsertBlock(table, start, end, editAction, block instanceof ParagraphWidget ? block : undefined);\n            if (selection.containsRow(table.firstChild, start.paragraph.associatedCell)) {\n                this.deleteContent(table, selection, editAction);\n            }\n            else {\n                var newTable = this.splitTable(table, start.paragraph.associatedCell.ownerRow);\n                this.deleteContent(table, selection, editAction);\n                this.viewer.layout.layoutBodyWidgetCollection(newTable.index, newTable.containerWidget, newTable, false);\n            }\n            if (!isNullOrUndefined(previousBlock)) {\n                selection.editPosition = this.getHierarchicalIndex(previousBlock, '0');\n                if (this.editorHistory && !isNullOrUndefined(this.editorHistory.currentBaseHistoryInfo)) {\n                    this.editorHistory.currentBaseHistoryInfo.endPosition = selection.editPosition;\n                }\n            }\n        }\n        else {\n            var blockAdv = table.previousRenderedWidget;\n            var sectionAdv = table.bodyWidget instanceof BodyWidget ? table.bodyWidget : undefined;\n            this.deleteContent(table, selection, editAction);\n            if (!isNullOrUndefined(blockAdv)) {\n                // let nextSection: WSection = blockAdv.section instanceof WSection ? blockAdv.section as WSection : undefined;\n                // if (sectionAdv !== nextSection) {\n                //     this.deleteSection(selection, sectionAdv, nextSection, editAction);\n                // }\n                //Goto the next block.\n                this.deleteBlock(blockAdv, selection, start, end, editAction);\n            }\n        }\n    };\n    Editor.prototype.splitTable = function (table, splitEndRow) {\n        var newTable = new TableWidget();\n        newTable.tableFormat.copyFormat(table.tableFormat);\n        newTable.index = table.index;\n        //Moves the rows to new table.\n        for (var i = 0; i < table.childWidgets.length; i++) {\n            var row = table.childWidgets[i];\n            if (row === splitEndRow) {\n                break;\n            }\n            newTable.childWidgets.push(row);\n            row.containerWidget = newTable;\n            table.childWidgets.splice(i, 1);\n            i--;\n        }\n        //Inserts new table in the current text position.\n        var insertIndex = table.getIndex();\n        table.containerWidget.childWidgets.splice(insertIndex, 0, newTable);\n        newTable.containerWidget = table.containerWidget;\n        this.updateNextBlocksIndex(newTable, true);\n        return newTable;\n    };\n    Editor.prototype.updateEditPosition = function (cell, selection) {\n        var firstParagraph = selection.getFirstParagraphInCell(cell);\n        selection.editPosition = this.getHierarchicalIndex(firstParagraph, '0');\n    };\n    /**\n     * @private\n     */\n    Editor.prototype.deleteContent = function (table, selection, editAction) {\n        if (editAction < 4) {\n            this.removeBlock(table);\n            this.addRemovedNodes(table);\n        }\n    };\n    Editor.prototype.setActionInternal = function (selection, action) {\n        if (this.viewer.owner.enableHistoryMode && !isNullOrUndefined(this.editorHistory.currentBaseHistoryInfo)) {\n            this.editorHistory.currentBaseHistoryInfo.action = action;\n        }\n    };\n    Editor.prototype.checkClearCells = function (selection) {\n        // tslint:disable-next-line:max-line-length\n        return this.editorHistory && this.editorHistory.currentBaseHistoryInfo && this.editorHistory.currentBaseHistoryInfo.action !== 'ClearCells';\n    };\n    Editor.prototype.isEndInAdjacentTable = function (paragraph, endParagraph) {\n        var start = this.getHierarchicalIndex(paragraph, '');\n        var end = this.getHierarchicalIndex(endParagraph, '');\n        var selectionStart = start.split(';');\n        var selectionEnd = end.split(';');\n        return selectionStart.length < selectionEnd.length;\n    };\n    Editor.prototype.cloneTableToHistoryInfo = function (table) {\n        if (this.editorHistory && !isNullOrUndefined(this.editorHistory.currentBaseHistoryInfo)) {\n            //Clones the entire table to preserve in history.\n            var clonedTable = table.clone();\n            //Preserves the cloned table in history info, for future undo operation.\n            this.editorHistory.currentBaseHistoryInfo.removedNodes.push(clonedTable);\n            //Sets the insert position in history info as current table.\n            if (this.viewer.selection.start.paragraph.isInsideTable &&\n                this.viewer.selection.start.paragraph.associatedCell.ownerTable === table) {\n                this.updateHistoryPosition(this.getHierarchicalIndex(table, '0'), true);\n            }\n            return clonedTable;\n        }\n        return undefined;\n    };\n    // tslint:disable-next-line:max-line-length\n    Editor.prototype.insertParagraphPaste = function (paragraph, currentParagraph, start, end, isCombineNextParagraph, editAction) {\n        if (this.editorHistory && (this.editorHistory.isUndoing || this.editorHistory.isRedoing) && this.editorHistory.currentBaseHistoryInfo.action === 'Paste') {\n            var nextParagraph = this.selection.getNextParagraphBlock(currentParagraph);\n            if (nextParagraph) {\n                if (start.offset > 0 && nextParagraph === end.paragraph && paragraph === start.paragraph\n                    && this.editorHistory.currentBaseHistoryInfo.action === 'Paste') {\n                    //Combines the current paragraph with end paragraph specific for undo/redo paste action.\n                    var insertIndex = 0;\n                    this.removeBlock(currentParagraph);\n                    this.viewer.layout.clearListElementBox(nextParagraph);\n                    this.viewer.layout.clearListElementBox(currentParagraph);\n                    for (var i = 0; i < currentParagraph.childWidgets.length; i++) {\n                        var line = currentParagraph.childWidgets[i];\n                        nextParagraph.childWidgets.splice(insertIndex, 0, line);\n                        currentParagraph.childWidgets.splice(i, 1);\n                        i--;\n                        insertIndex++;\n                        line.paragraph = nextParagraph;\n                    }\n                    this.viewer.layout.reLayoutParagraph(nextParagraph, 0, 0);\n                    isCombineNextParagraph = false;\n                    var offset = this.selection.editPosition.substring(this.selection.editPosition.lastIndexOf(';') + 1);\n                    this.selection.editPosition = this.getHierarchicalIndex(nextParagraph, offset);\n                }\n            }\n        }\n        if (isCombineNextParagraph) {\n            this.deleteParagraphMark(currentParagraph, this.selection, editAction);\n        }\n    };\n    // tslint:disable-next-line:max-line-length\n    Editor.prototype.removeInlines = function (paragraph, startLine, startOffset, endLine, endOffset, editAction) {\n        var isRemoved = false;\n        this.viewer.layout.clearListElementBox(paragraph);\n        var startIndex = paragraph.childWidgets.indexOf(startLine);\n        for (var i = paragraph.childWidgets.length - 1; i >= 0; i--) {\n            var lineWidget = paragraph.childWidgets[i];\n            if (startLine === lineWidget && endLine === lineWidget) {\n                this.removeContent(lineWidget, startOffset, endOffset);\n                isRemoved = true;\n                break;\n            }\n            if (endLine === lineWidget) {\n                isRemoved = true;\n                this.removeContent(lineWidget, 0, endOffset);\n            }\n            else if (startLine === lineWidget) {\n                this.removeContent(lineWidget, startOffset, this.viewer.selection.getLineLength(lineWidget));\n                break;\n            }\n            else if (isRemoved) {\n                this.removeContent(lineWidget, 0, this.viewer.selection.getLineLength(lineWidget));\n            }\n        }\n        if (isRemoved) {\n            this.removeEmptyLine(paragraph);\n            this.viewer.layout.reLayoutParagraph(paragraph, 0, 0);\n        }\n    };\n    /**\n     * @private\n     */\n    Editor.prototype.removeContent = function (lineWidget, startOffset, endOffset) {\n        var count = this.selection.getLineLength(lineWidget);\n        for (var i = lineWidget.children.length - 1; i >= 0; i--) {\n            var inline = lineWidget.children[i];\n            if (endOffset <= count - inline.length) {\n                count -= inline.length;\n                continue;\n            }\n            var endIndex = inline.length;\n            if (count > endOffset && (count - endIndex < endOffset)) {\n                endIndex = endOffset - (count - inline.length);\n            }\n            var startIndex = 0;\n            if (count - inline.length < startOffset) {\n                startIndex = startOffset - (count - inline.length);\n            }\n            if (count > endOffset) {\n                count -= (inline.length - endIndex);\n            }\n            if (startIndex === 0 && endIndex === inline.length) {\n                if (!(this.editorHistory && (this.editorHistory.isUndoing || this.editorHistory.isRedoing))) {\n                    if (inline instanceof BookmarkElementBox) {\n                        this.removedBookmarkElements.push(inline);\n                    }\n                }\n                // if (editAction < 4) {\n                this.unLinkFieldCharacter(inline);\n                this.addRemovedNodes(lineWidget.children[i]);\n                lineWidget.children.splice(i, 1);\n                // }\n            }\n            else if (inline instanceof TextElementBox) {\n                // if (editAction < 4) {\n                var span = new TextElementBox();\n                span.characterFormat.copyFormat(inline.characterFormat);\n                span.text = inline.text.substr(startIndex, endIndex - startIndex);\n                this.addRemovedNodes(span);\n                inline.text = inline.text.slice(0, startIndex) + inline.text.slice(endIndex);\n            }\n            if (startOffset >= count - (endIndex - startIndex)) {\n                break;\n            }\n            count -= (endIndex - startIndex);\n        }\n    };\n    /**\n     * @private\n     */\n    Editor.prototype.removeEmptyLine = function (paragraph) {\n        if (paragraph.childWidgets.length > 1) {\n            for (var i = 0; i < paragraph.childWidgets.length; i++) {\n                var lineWidget = paragraph.childWidgets[i];\n                if (lineWidget.children.length === 0 && paragraph.childWidgets.length > 1) {\n                    paragraph.childWidgets.splice(i, 1);\n                    i--;\n                }\n            }\n        }\n    };\n    //#endregion\n    /**\n     * clone the list level\n     * @param  {WListLevel} source\n     * @private\n     */\n    Editor.prototype.cloneListLevel = function (source) {\n        var listLevel = new WListLevel(undefined);\n        this.copyListLevel(listLevel, source);\n        return listLevel;\n    };\n    /**\n     * Copies the list level\n     * @param  {WListLevel} destination\n     * @param  {WListLevel} listLevel\n     * @private\n     */\n    Editor.prototype.copyListLevel = function (destination, listLevel) {\n        if (!isNullOrUndefined(listLevel.paragraphFormat)) {\n            destination.paragraphFormat = new WParagraphFormat(destination);\n            destination.paragraphFormat.copyFormat(listLevel.paragraphFormat);\n        }\n        if (!isNullOrUndefined(listLevel.characterFormat)) {\n            destination.characterFormat = new WCharacterFormat(destination);\n            destination.characterFormat.copyFormat(listLevel.characterFormat);\n        }\n        if (!isNullOrUndefined(listLevel.followCharacter)) {\n            destination.followCharacter = listLevel.followCharacter;\n        }\n        if (!isNullOrUndefined(listLevel.listLevelPattern)) {\n            destination.listLevelPattern = listLevel.listLevelPattern;\n        }\n        if (!isNullOrUndefined(listLevel.numberFormat)) {\n            destination.numberFormat = listLevel.numberFormat;\n        }\n        if (!isNullOrUndefined(listLevel.restartLevel)) {\n            destination.restartLevel = listLevel.restartLevel;\n        }\n        if (!isNullOrUndefined(listLevel.startAt)) {\n            destination.startAt = listLevel.startAt;\n        }\n    };\n    /**\n     * Clone level override\n     * @param  {WLevelOverride} source\n     * @private\n     */\n    Editor.prototype.cloneLevelOverride = function (source) {\n        var levelOverride = new WLevelOverride();\n        if (!isNullOrUndefined(source.startAt)) {\n            levelOverride.startAt = source.startAt;\n        }\n        if (!isNullOrUndefined(source.overrideListLevel)) {\n            levelOverride.overrideListLevel = source.overrideListLevel;\n        }\n        if (!isNullOrUndefined(source.levelNumber)) {\n            levelOverride.levelNumber = source.levelNumber;\n        }\n        return levelOverride;\n    };\n    /**\n     * Update List Paragraph\n     * @private\n     */\n    Editor.prototype.updateListParagraphs = function () {\n        this.viewer.listParagraphs = [];\n        for (var j = 0; j < this.viewer.pages.length; j++) {\n            var bodyWidget = this.viewer.pages[j].bodyWidgets[0];\n            for (var i = 0; i < bodyWidget.childWidgets.length; i++) {\n                this.updateListParagraphsInBlock(bodyWidget.childWidgets[i]);\n            }\n        }\n    };\n    /**\n     * @private\n     */\n    Editor.prototype.updateListParagraphsInBlock = function (block) {\n        if (block instanceof ParagraphWidget) {\n            if (!isNullOrUndefined(block.paragraphFormat)\n                && !isNullOrUndefined(block.paragraphFormat.listFormat)\n                && !isNullOrUndefined(block.paragraphFormat.listFormat.listId)) {\n                if (isNullOrUndefined(this.viewer.listParagraphs)) {\n                    this.viewer.listParagraphs = [];\n                }\n                this.viewer.listParagraphs.push(block);\n            }\n        }\n        else if (block instanceof TableWidget) {\n            for (var i = 0; i < block.childWidgets.length; i++) {\n                for (var j = 0; j < block.childWidgets[i].childWidgets.length; j++) {\n                    var cell = block.childWidgets[i].childWidgets[j];\n                    for (var k = 0; k < cell.childWidgets.length; k++) {\n                        this.updateListParagraphsInBlock(cell.childWidgets[k]);\n                    }\n                }\n            }\n        }\n    };\n    /**\n     * Applies list format\n     * @param  {WList} list\n     * @private\n     */\n    Editor.prototype.onApplyList = function (list) {\n        var selection = this.viewer.selection;\n        this.setOffsetValue(this.viewer.selection);\n        this.initHistory('ListFormat');\n        var format = new WListFormat();\n        if (!isNullOrUndefined(list)) {\n            format.listId = list.listId;\n        }\n        this.viewer.owner.isShiftingEnabled = true;\n        if (selection.isEmpty) {\n            this.applyParaFormatProperty(selection.start.paragraph, 'listFormat', format, false);\n            this.layoutItemBlock(selection.start.paragraph, false);\n        }\n        else {\n            this.updateSelectionParagraphFormatting('listFormat', format, false);\n        }\n        this.reLayout(selection);\n    };\n    /**\n     * Applies bullets or numbering list\n     * @param  {string} format\n     * @param  {ListLevelPattern} listLevelPattern\n     * @param  {string} fontFamily\n     * @private\n     */\n    Editor.prototype.applyBulletOrNumbering = function (format, listLevelPattern, fontFamily) {\n        var selection = this.viewer.selection;\n        var list = selection.paragraphFormat.getList();\n        var isUpdate = false;\n        var start = selection.start;\n        if (!selection.isForward) {\n            start = selection.end;\n        }\n        var currentParagraph = start.paragraph;\n        if (isNullOrUndefined(list)) {\n            while (!isNullOrUndefined(currentParagraph.previousWidget) && currentParagraph.previousWidget instanceof ParagraphWidget\n                && currentParagraph.previousWidget.isEmpty() && currentParagraph.previousWidget.paragraphFormat.listFormat.listId === -1) {\n                currentParagraph = currentParagraph.previousWidget;\n            }\n            if (currentParagraph.previousWidget && currentParagraph.previousWidget instanceof ParagraphWidget\n                && currentParagraph.previousWidget.paragraphFormat.listFormat.listId !== -1) {\n                currentParagraph = currentParagraph.previousWidget;\n                list = this.viewer.getListById(currentParagraph.paragraphFormat.listFormat.listId);\n                isUpdate = true;\n            }\n        }\n        var startListLevel = undefined;\n        if (!isNullOrUndefined(list)) {\n            var tempList = this.viewer.getListById(currentParagraph.paragraphFormat.listFormat.listId);\n            startListLevel = this.viewer.layout.getListLevel(tempList, currentParagraph.paragraphFormat.listFormat.listLevelNumber);\n        }\n        if (isNullOrUndefined(list) || (!isNullOrUndefined(list) && ((startListLevel.listLevelPattern !== listLevelPattern) ||\n            startListLevel.numberFormat !== format || (startListLevel.characterFormat.fontFamily !== fontFamily\n            && startListLevel.listLevelPattern === 'Bullet')))) {\n            isUpdate = false;\n            list = new WList();\n            if (this.viewer.lists.length > 0) {\n                list.listId = this.viewer.lists[this.viewer.lists.length - 1].listId + 1;\n            }\n            else {\n                list.listId = 0;\n            }\n            var abstractList = new WAbstractList();\n            if (this.viewer.abstractLists.length > 0) {\n                abstractList.abstractListId = this.viewer.abstractLists[this.viewer.abstractLists.length - 1].abstractListId + 1;\n            }\n            else {\n                abstractList.abstractListId = 0;\n            }\n            list.abstractListId = abstractList.abstractListId;\n            list.abstractList = abstractList;\n            this.viewer.abstractLists.push(abstractList);\n            if (format === 'bullet' || format === 'multiLevel' || format === 'numbering') {\n                this.addListLevels(abstractList, format, selection);\n            }\n            else {\n                var listLevel = new WListLevel(abstractList);\n                listLevel.listLevelPattern = listLevelPattern;\n                listLevel.numberFormat = format;\n                if (listLevelPattern !== 'Bullet') {\n                    listLevel.startAt = 1;\n                }\n                else {\n                    listLevel.characterFormat.fontFamily = fontFamily;\n                }\n                listLevel.paragraphFormat.leftIndent = 36;\n                listLevel.paragraphFormat.firstLineIndent = -18;\n                abstractList.levels.push(listLevel);\n                selection.paragraphFormat.listLevelNumber = 0;\n            }\n            selection.paragraphFormat.setList(list);\n        }\n        else if (!isNullOrUndefined(list) && isUpdate) {\n            selection.paragraphFormat.setList(list);\n        }\n        else {\n            selection.paragraphFormat.setList(undefined);\n        }\n    };\n    Editor.prototype.addListLevels = function (abstractListAdv, listName, selection) {\n        var bulletCharacters = ['\\uf076', '\\uf0d8', '\\uf0a7', '\\uf0b7', '\\uf0a8'];\n        for (var i = abstractListAdv.levels.length; i < 9; i++) {\n            var listLevel = new WListLevel(abstractListAdv);\n            if (listName.match('bullet')) {\n                listLevel.listLevelPattern = 'Bullet';\n                listLevel.numberFormat = bulletCharacters[i < 5 ? i % 5 : i % 5 + 1];\n                listLevel.characterFormat.fontFamily = i < 3 || i === 5 ? 'Wingdings' : 'Symbol';\n            }\n            else {\n                if (listName.match('multiLevel')) {\n                    for (var j = 0; j < i + 1; j++) {\n                        listLevel.numberFormat += '%' + (j + 1).toString() + '.';\n                    }\n                    listLevel.listLevelPattern = 'Number';\n                }\n                else {\n                    listLevel.numberFormat = '%' + (i + 1).toString() + ')';\n                    listLevel.listLevelPattern = i % 3 === 0 ? 'Number'\n                        : i % 3 === 1 ? 'LowLetter' : 'LowRoman';\n                }\n                listLevel.startAt = 1;\n                listLevel.restartLevel = i;\n            }\n            if (i === 0) {\n                listLevel.paragraphFormat.leftIndent = 36;\n            }\n            else {\n                listLevel.paragraphFormat.leftIndent = 36 * i;\n            }\n            listLevel.paragraphFormat.firstLineIndent = -18;\n            abstractListAdv.levels.push(listLevel);\n            selection.paragraphFormat.listLevelNumber = i;\n        }\n    };\n    /**\n     * Insert page break at cursor position\n     */\n    Editor.prototype.insertPageBreak = function () {\n        if (!this.owner.isReadOnlyMode) {\n            if (this.viewer.selection.start.paragraph.isInsideTable ||\n                this.viewer.selection.start.paragraph.isInHeaderFooter) {\n                return;\n            }\n            this.initComplexHistory('PageBreak');\n            this.onEnter(true);\n            if (this.editorHistory && this.editorHistory.currentHistoryInfo != null) {\n                this.editorHistory.updateComplexHistory();\n            }\n            this.selection.checkForCursorVisibility();\n        }\n    };\n    /**\n     * @private\n     */\n    Editor.prototype.onEnter = function (isInsertPageBreak) {\n        var selection = this.viewer.selection;\n        if (selection.isEmpty) {\n            //ToDo: Need to handle the CTRL + Enter (Page Break) and SHIFT + Enter (Line Break) behavior.\n            var hyperlinkField = selection.getHyperlinkField();\n            var isSelectionOnHyperlink = !isNullOrUndefined(hyperlinkField);\n            if (isSelectionOnHyperlink) {\n                selection.fireRequestNavigate(hyperlinkField);\n                return;\n            }\n            var paragraph = selection.start.paragraph;\n            if (paragraph.isEmpty() && paragraph.paragraphFormat.listFormat.listId !== -1) {\n                // tslint:disable-next-line:max-line-length\n                this.onApplyListInternal(this.viewer.getListById(paragraph.paragraphFormat.listFormat.listId), paragraph.paragraphFormat.listFormat.listLevelNumber - 1);\n                return;\n            }\n        }\n        this.initHistory('Enter');\n        var isRemoved = true;\n        if (!selection.isEmpty) {\n            // this.initHistoryWithSelection(selection, 'Enter');\n            isRemoved = this.removeSelectedContents(selection);\n        }\n        if (isRemoved) {\n            selection.owner.isShiftingEnabled = true;\n            this.updateInsertPosition();\n            var blockInfo = this.getParagraphInfo(selection.start);\n            var initialStart = this.getHierarchicalIndex(blockInfo.paragraph, blockInfo.offset.toString());\n            this.splitParagraphInternal(selection, selection.start.paragraph, selection.start.currentWidget, selection.start.offset);\n            this.setPositionForCurrentIndex(selection.start, initialStart);\n            if (isInsertPageBreak) {\n                var currentParagraph = selection.start.paragraph;\n                var breakParagraph = new ParagraphWidget();\n                breakParagraph.characterFormat.copyFormat(currentParagraph.characterFormat);\n                breakParagraph.paragraphFormat.copyFormat(currentParagraph.paragraphFormat);\n                var pageBreak = new TextElementBox();\n                pageBreak.text = '\\f';\n                var line = new LineWidget(breakParagraph);\n                line.children.push(pageBreak);\n                pageBreak.line = line;\n                breakParagraph.childWidgets.push(line);\n                this.insertParagraph(breakParagraph, true);\n                selection.selectParagraph(breakParagraph, true);\n            }\n            var nextNode = selection.start.paragraph.nextWidget;\n            if (isNullOrUndefined(nextNode)) {\n                nextNode = selection.getNextRenderedBlock(selection.start.paragraph);\n            }\n            selection.selectParagraph(nextNode, true);\n            this.updateEndPosition();\n            if (isInsertPageBreak && this.editorHistory) {\n                this.owner.editorHistory.updateHistory();\n            }\n            // if (!isNullOrUndefined(selection.currentHistoryInfo)) {\n            //     this.updateComplexHistory();\n            // } else {\n            this.reLayout(selection);\n            // }\n            var paragraph = selection.start.paragraph.previousWidget;\n            if (!isNullOrUndefined(paragraph) && !paragraph.isEmpty() &&\n                // tslint:disable-next-line:max-line-length\n                paragraph.lastChild.children[paragraph.lastChild.children.length - 1] instanceof TextElementBox) {\n                this.checkAndConvertToHyperlink(selection, true, paragraph);\n            }\n        }\n    };\n    Editor.prototype.splitParagraphInternal = function (selection, paragraphAdv, currentLine, offset) {\n        var insertIndex = 0;\n        var blockIndex = paragraphAdv.index;\n        var paragraph = new ParagraphWidget();\n        var lineWidget = new LineWidget(paragraph);\n        paragraph.childWidgets.push(lineWidget);\n        //Copies the format to new paragraph.\n        paragraph.paragraphFormat.ownerBase = paragraph;\n        if (currentLine === paragraphAdv.lastChild && offset === selection.getLineLength(currentLine)) {\n            // tslint:disable-next-line:max-line-length\n            if (paragraphAdv.paragraphFormat.baseStyle\n                && paragraphAdv.paragraphFormat.baseStyle.name !== 'Normal' && paragraphAdv.paragraphFormat.baseStyle.next instanceof WParagraphStyle) {\n                if (paragraphAdv.paragraphFormat.baseStyle.name === paragraphAdv.paragraphFormat.baseStyle.next.name) {\n                    paragraph.paragraphFormat.copyFormat(paragraphAdv.paragraphFormat);\n                    paragraph.characterFormat.copyFormat(paragraphAdv.characterFormat);\n                }\n                else {\n                    paragraph.paragraphFormat.baseStyle = paragraphAdv.paragraphFormat.baseStyle.next;\n                }\n                this.selection.skipFormatRetrieval = false;\n            }\n            else {\n                paragraph.paragraphFormat.copyFormat(paragraphAdv.paragraphFormat);\n                paragraph.characterFormat.copyFormat(paragraphAdv.characterFormat);\n            }\n            //ToDo in future: Need to skip copying formattings to new paragraph, if the style for following paragraph is same style.\n            insertIndex++;\n            blockIndex++;\n        }\n        else {\n            paragraph.paragraphFormat.copyFormat(paragraphAdv.paragraphFormat);\n            paragraph.characterFormat.copyFormat(paragraphAdv.characterFormat);\n            if (offset > 0 || !currentLine.isFirstLine()) {\n                paragraphAdv = paragraphAdv.combineWidget(this.viewer);\n                this.moveInlines(paragraphAdv, paragraph, 0, 0, paragraphAdv.firstChild, offset, currentLine);\n            }\n            paragraphAdv = paragraphAdv.getSplitWidgets()[0];\n        }\n        insertIndex += paragraphAdv.getIndex();\n        var container = paragraphAdv.containerWidget;\n        var childNodes = container.childWidgets;\n        childNodes.splice(insertIndex, 0, paragraph);\n        paragraph.containerWidget = container;\n        paragraph.index = blockIndex;\n        this.updateNextBlocksIndex(paragraph, true);\n        // tslint:disable-next-line:max-line-length\n        this.viewer.layout.layoutBodyWidgetCollection(blockIndex, container, paragraph, false);\n    };\n    /**\n     * @private\n     */\n    Editor.prototype.updateNextBlocksIndex = function (block, increaseIndex) {\n        var nextIndex = block.containerWidget.childWidgets.indexOf(block) + 1;\n        if (block.containerWidget instanceof BodyWidget) {\n            var currentSectionIndex = block.containerWidget.index;\n            for (var j = this.viewer.pages.indexOf(block.containerWidget.page); j < this.viewer.pages.length; j++) {\n                var page = this.viewer.pages[j];\n                if (page.bodyWidgets[0].index === currentSectionIndex) {\n                    for (var k = nextIndex; k < page.bodyWidgets[0].childWidgets.length; k++) {\n                        var childWidget = page.bodyWidgets[0].childWidgets[k];\n                        this.updateIndex(childWidget, increaseIndex);\n                    }\n                    nextIndex = 0;\n                }\n                else {\n                    return;\n                }\n            }\n        }\n        else if (block.containerWidget instanceof TableCellWidget) {\n            var cells = block.containerWidget.getSplitWidgets();\n            var currentCellIndex = cells.indexOf(block.containerWidget);\n            for (var x = currentCellIndex; x < cells.length; x++) {\n                var blocks = cells[x].childWidgets;\n                for (var y = nextIndex; y < blocks.length; y++) {\n                    this.updateIndex(blocks[y], increaseIndex);\n                }\n                currentCellIndex = 0;\n                nextIndex = 0;\n            }\n        }\n        else if (block.containerWidget instanceof TableRowWidget) {\n            for (var i = nextIndex; i < block.containerWidget.childWidgets.length; i++) {\n                var cell = block.containerWidget.childWidgets[i];\n                if (cell.rowIndex === block.containerWidget.index) {\n                    this.updateIndex(cell, increaseIndex);\n                }\n            }\n        }\n        else if (block.containerWidget instanceof TableWidget) {\n            for (var i = nextIndex; i < block.containerWidget.childWidgets.length; i++) {\n                var row = block.containerWidget.childWidgets[i];\n                this.updateIndex(row, increaseIndex);\n                for (var j = 0; j < row.childWidgets.length; j++) {\n                    row.childWidgets[j].rowIndex = row.index;\n                }\n            }\n            //update Row index of all the cell\n        }\n        else if (block.containerWidget instanceof HeaderFooterWidget) {\n            for (var i = nextIndex; i < block.containerWidget.childWidgets.length; i++) {\n                var nextBlock = block.containerWidget.childWidgets[i];\n                this.updateIndex(nextBlock, increaseIndex);\n            }\n        }\n    };\n    Editor.prototype.updateIndex = function (widget, increment) {\n        if (increment) {\n            widget.index++;\n        }\n        else {\n            widget.index--;\n        }\n    };\n    Editor.prototype.updateEndPosition = function () {\n        var selection = this.viewer.selection;\n        if (this.editorHistory && !isNullOrUndefined(this.editorHistory.currentBaseHistoryInfo)) {\n            this.updateHistoryPosition(selection.start, false);\n        }\n    };\n    /**\n     * @private\n     */\n    Editor.prototype.onBackSpace = function () {\n        var selection = this.viewer.selection;\n        if (selection.isEmpty) {\n            this.singleBackspace(selection, false);\n        }\n        else {\n            this.initHistory('BackSpace');\n            var skipBackSpace = this.deleteSelectedContents(selection, true);\n            if (this.editorHistory && this.editorHistory.currentBaseHistoryInfo) {\n                if (skipBackSpace) {\n                    this.editorHistory.currentBaseHistoryInfo = undefined;\n                }\n                else {\n                    if (this.checkEndPosition(selection)) {\n                        this.updateHistoryPosition(selection.end, false);\n                    }\n                    this.reLayout(selection);\n                }\n            }\n        }\n    };\n    /**\n     * @private\n     */\n    Editor.prototype.insertRemoveBookMarkElements = function () {\n        var isHandledComplexHistory = false;\n        for (var i = 0; i < this.removedBookmarkElements.length; i++) {\n            var bookMark = this.removedBookmarkElements[i];\n            if (bookMark.bookmarkType === 0) {\n                var bookMarkStart = bookMark;\n                if (bookMarkStart && bookMarkStart.reference && this.removedBookmarkElements.indexOf(bookMarkStart.reference) !== -1) {\n                    var endIndex = this.removedBookmarkElements.indexOf(bookMarkStart.reference);\n                    var startIndex = this.removedBookmarkElements.indexOf(bookMarkStart);\n                    this.removedBookmarkElements.splice(endIndex, 1);\n                    this.removedBookmarkElements.splice(startIndex, 1);\n                }\n                else {\n                    this.initComplexHistory(this.editorHistory.currentBaseHistoryInfo.action);\n                    this.editorHistory.updateHistory();\n                    this.initInsertInline(bookMarkStart.clone());\n                    this.editorHistory.updateComplexHistory();\n                    isHandledComplexHistory = true;\n                }\n            }\n            else {\n                var bookMarkEnd = bookMark;\n                if (bookMarkEnd && bookMarkEnd.reference && this.removedBookmarkElements.indexOf(bookMarkEnd.reference) !== -1) {\n                    var endIndex = this.removedBookmarkElements.indexOf(bookMarkEnd.reference);\n                    var startIndex = this.removedBookmarkElements.indexOf(bookMarkEnd);\n                    this.removedBookmarkElements.splice(endIndex, 1);\n                    this.removedBookmarkElements.splice(startIndex, 1);\n                }\n                else {\n                    this.initComplexHistory(this.editorHistory.currentBaseHistoryInfo.action);\n                    this.editorHistory.updateHistory();\n                    this.initInsertInline(bookMarkEnd.clone());\n                    this.editorHistory.updateComplexHistory();\n                    isHandledComplexHistory = true;\n                }\n            }\n        }\n        this.removedBookmarkElements = [];\n        return isHandledComplexHistory;\n    };\n    /**\n     * @private\n     */\n    Editor.prototype.deleteSelectedContents = function (selection, isBackSpace) {\n        var skipBackSpace = this.deleteSelectedContentInternal(selection, isBackSpace, selection.start, selection.end);\n        var textPosition = new TextPosition(selection.owner);\n        var blockInfo = this.getParagraph({ index: selection.editPosition });\n        var lineInfo = this.getLineInfo(blockInfo.paragraph, blockInfo.offset);\n        textPosition.setPositionForLineWidget(lineInfo.line, lineInfo.offset);\n        selection.selectContent(textPosition, true);\n        return skipBackSpace;\n    };\n    /**\n     * @private\n     */\n    Editor.prototype.singleBackspace = function (selection, isRedoing) {\n        var history = this.editorHistory;\n        // If backspace is pressed after auto format to hyperlink is done, need to undo auto format.\n        if (history && !isRedoing && !history.canRedo() && history.canUndo()) {\n            var historyInfo = history.undoStack[history.undoStack.length - 1];\n            var startBlockInfo = this.getParagraphInfo(selection.start);\n            var endBlockInfo = this.getParagraphInfo(selection.end);\n            // tslint:disable-next-line:max-line-length\n            if (historyInfo.action === 'AutoFormatHyperlink' && historyInfo.insertPosition === this.getHierarchicalIndex(startBlockInfo.paragraph, startBlockInfo.offset.toString()) &&\n                historyInfo.endPosition === this.getHierarchicalIndex(endBlockInfo.paragraph, endBlockInfo.offset.toString())) {\n                history.undo();\n                return;\n            }\n        }\n        var paragraph = selection.start.paragraph;\n        var currentLineWidget = selection.start.currentWidget;\n        var offset = selection.start.offset;\n        var indexInInline = 0;\n        var inlineObj = currentLineWidget.getInline(offset, indexInInline);\n        var inline = inlineObj.element;\n        indexInInline = inlineObj.index;\n        var previousInline = inline;\n        if (inline instanceof FieldElementBox && inline.fieldType === 2) {\n            if (HelperMethods.isLinkedFieldCharacter(inline)) {\n                var begin = inline.fieldBegin;\n                var end = inline.fieldEnd;\n                selection.start.setPositionParagraph(begin.line, begin.line.getOffset(begin, 0));\n                selection.end.setPositionParagraph(end.line, end.line.getOffset(end, 0) + 1);\n                selection.fireSelectionChanged(true);\n                return;\n            }\n        }\n        if (inline instanceof FieldElementBox && inline.fieldType === 1) {\n            var prevInline = selection.getPreviousValidElement(inline);\n            if (prevInline instanceof FieldElementBox) {\n                inline = prevInline.fieldBegin;\n                paragraph = inline.line.paragraph;\n                offset = inline.line.getOffset(inline, 0);\n                selection.end.setPositionParagraph(inline.line, offset); //Selects the entire field.\n                selection.fireSelectionChanged(true);\n                return;\n            }\n            else if (prevInline !== inline) {\n                inline = prevInline; //Updates the offset to delete next content.\n                paragraph = inline.line.paragraph;\n                offset = inline.line.getOffset(inline, inline.length);\n            }\n        }\n        if (inline && (inline instanceof BookmarkElementBox && inline.bookmarkType === 1\n            || inline.previousNode instanceof BookmarkElementBox)) {\n            if (inline instanceof BookmarkElementBox) {\n                inline = inline.previousNode;\n                paragraph = inline.line.paragraph;\n                offset = inline.line.getOffset(inline, inline.length);\n            }\n            if (inline.length === 1 && inline.nextNode instanceof BookmarkElementBox && inline.previousNode instanceof BookmarkElementBox) {\n                var begin = inline.previousNode;\n                var end = inline.nextNode;\n                selection.start.setPositionParagraph(begin.line, begin.line.getOffset(begin, 0));\n                selection.end.setPositionParagraph(end.line, end.line.getOffset(end, 0) + 1);\n                this.initHistory('BackSpace');\n                this.deleteSelectedContents(selection, true);\n                if (this.checkEndPosition(selection)) {\n                    this.updateHistoryPosition(selection.end, false);\n                }\n                this.reLayout(selection);\n                return;\n            }\n        }\n        if (!isRedoing) {\n            this.initHistory('BackSpace');\n        }\n        if (offset === selection.getStartOffset(paragraph) && selection.start.currentWidget.isFirstLine()) {\n            if (paragraph.paragraphFormat.listFormat && paragraph.paragraphFormat.listFormat.listId !== -1) {\n                this.onApplyList(undefined);\n                return;\n            }\n            if (paragraph.paragraphFormat.firstLineIndent !== 0) {\n                this.onApplyParagraphFormat('firstLineIndent', 0, false, false);\n                return;\n            }\n            if (paragraph.paragraphFormat.leftIndent !== 0) {\n                this.onApplyParagraphFormat('leftIndent', 0, false, false);\n                return;\n            }\n            if (paragraph.paragraphFormat.textAlignment !== 'Left') {\n                this.onApplyParagraphFormat('textAlignment', 'Left', false, true);\n                return;\n            }\n            if (paragraph.previousRenderedWidget instanceof ParagraphWidget) {\n                selection.owner.isShiftingEnabled = true;\n                var previousParagraph = paragraph.previousRenderedWidget;\n                // if (isNullOrUndefined(previousParagraph)) {\n                //     previousParagraph = this.viewer.selection.getPreviousBlock(paragraph) as ParagraphWidget;\n                // }\n                if (previousParagraph.isEmpty()) {\n                    this.removeBlock(previousParagraph);\n                    this.addRemovedNodes(previousParagraph);\n                }\n                else {\n                    this.removeBlock(paragraph);\n                    var endOffset = this.viewer.selection.getLineLength(previousParagraph.lastChild);\n                    var previousIndex = previousParagraph.childWidgets.length - 1;\n                    var lineWidget = void 0;\n                    if (!paragraph.isEmpty()) {\n                        for (var i = 0; i < paragraph.childWidgets.length; i++) {\n                            lineWidget = paragraph.childWidgets[i];\n                            previousParagraph.childWidgets.push(lineWidget);\n                            paragraph.childWidgets.splice(i, 1);\n                            i--;\n                            lineWidget.paragraph = previousParagraph;\n                        }\n                    }\n                    this.viewer.layout.reLayoutParagraph(previousParagraph, previousIndex, 0);\n                    selection.selects(previousParagraph.childWidgets[previousIndex], endOffset, true);\n                    this.addRemovedNodes(paragraph);\n                }\n                this.setPositionForHistory();\n                // if (!isRedoing) {\n                this.reLayout(selection);\n                // }\n            }\n            else {\n                if (this.editorHistory) {\n                    this.editorHistory.currentBaseHistoryInfo = undefined;\n                }\n            }\n        }\n        else {\n            if (!isRedoing) {\n                selection.owner.isShiftingEnabled = true;\n            }\n            var paragraphInfo = this.getParagraphInfo(selection.start);\n            var lineWidget = selection.start.currentWidget;\n            var removeOffset = offset - 1;\n            if (removeOffset < 0) {\n                lineWidget = lineWidget.previousLine;\n                removeOffset = this.viewer.selection.getLineLength(lineWidget) + removeOffset;\n            }\n            this.removeAtOffset(lineWidget, selection, removeOffset);\n            this.setPositionParagraph(paragraphInfo.paragraph, paragraphInfo.offset - 1, false);\n            this.setPositionForHistory();\n            if (!isRedoing) {\n                this.reLayout(selection);\n            }\n            else {\n                this.fireContentChange();\n            }\n        }\n    };\n    Editor.prototype.setPositionForHistory = function (editPosition) {\n        var selection = this.viewer.selection;\n        if (this.editorHistory && !isNullOrUndefined(this.editorHistory.currentBaseHistoryInfo)) {\n            if (isNullOrUndefined(editPosition)) {\n                this.updateHistoryPosition(selection.start, true);\n                this.editorHistory.currentBaseHistoryInfo.endPosition = this.editorHistory.currentBaseHistoryInfo.insertPosition;\n            }\n            else {\n                this.editorHistory.currentBaseHistoryInfo.insertPosition = editPosition;\n                this.editorHistory.currentBaseHistoryInfo.endPosition = editPosition;\n            }\n        }\n    };\n    Editor.prototype.removeAtOffset = function (lineWidget, selection, offset) {\n        var count = 0;\n        var lineIndex = lineWidget.paragraph.childWidgets.indexOf(lineWidget);\n        for (var i = 0; i < lineWidget.children.length; i++) {\n            var inline = lineWidget.children[i];\n            if (inline instanceof ListTextElementBox) {\n                continue;\n            }\n            if (offset < count + inline.length) {\n                var indexInInline = offset - count;\n                if (offset === count && inline.length === 1) {\n                    this.unLinkFieldCharacter(inline);\n                    lineWidget.children.splice(i, 1);\n                    this.viewer.layout.reLayoutParagraph(lineWidget.paragraph, lineIndex, i);\n                    this.addRemovedNodes(inline);\n                }\n                else {\n                    var span = new TextElementBox();\n                    span.characterFormat.copyFormat(inline.characterFormat);\n                    span.text = inline.text.substr(indexInInline, 1);\n                    inline.text = HelperMethods.remove(inline.text, indexInInline, 1);\n                    this.viewer.layout.reLayoutParagraph(lineWidget.paragraph, lineIndex, i);\n                    this.addRemovedNodes(span);\n                }\n                break;\n            }\n            count += inline.length;\n        }\n    };\n    /**\n     * @private\n     */\n    Editor.prototype.onDelete = function () {\n        var selection = this.viewer.selection;\n        if (selection.isEmpty) {\n            this.singleDelete(selection, false);\n        }\n        else {\n            // this.initComplexHistory('MultiSelection');\n            // for (let i: number = 0; i < selection.selectionRanges.length; i++) {\n            // let selectionRange: SelectionRange = selection.selectionRanges.getRange(i);\n            this.initHistory('Delete');\n            this.deleteSelectedContentInternal(selection, false, selection.start, selection.end);\n            var textPosition = new TextPosition(selection.owner);\n            this.setPositionForCurrentIndex(textPosition, selection.editPosition);\n            selection.selectContent(textPosition, true);\n            // if (this.viewer.owner.enableEditorHistory) {\n            this.reLayout(selection);\n            // }\n            // this.updateSelectionRangeOffSet(selection.start, selection.end);\n            // }\n            // let textPosition: TextPosition = new TextPosition(selection.owner, this.viewer);\n            // this.setPositionForCurrentIndex(textPosition,selection.editPosition);\n            // selection.selectContent(textPosition, true);\n            // if (!isNullOrUndefined(selection.currentHistoryInfo)) {\n            //     this.updateComplexHistory();\n            // } else {\n            //     this.updateComplexWithoutHistory();\n            // }\n        }\n    };\n    /**\n     * Remove single character on right of cursor position\n     * @param  {Selection} selection\n     * @param  {boolean} isRedoing\n     * @private\n     */\n    Editor.prototype.singleDelete = function (selection, isRedoing) {\n        // tslint:disable-next-line:max-line-length\n        var paragraph = selection.start.paragraph;\n        var offset = selection.start.offset;\n        var indexInInline = 0;\n        var inlineObj = paragraph.getInline(selection.start.offset, indexInInline);\n        var inline = inlineObj.element;\n        indexInInline = inlineObj.index;\n        if (paragraph.paragraphFormat.listFormat && paragraph.paragraphFormat.listFormat.listId !== -1 &&\n            this.viewer.isListTextSelected && selection.contextType === 'List') {\n            this.onApplyList(undefined);\n            return;\n        }\n        if (!isNullOrUndefined(inline) && indexInInline === inline.length && !isNullOrUndefined(inline.nextNode)) {\n            inline = inline.nextNode;\n            indexInInline = 0;\n        }\n        if (!isNullOrUndefined(inline)) {\n            var nextRenderedInline = undefined;\n            var nextInline = selection.getNextValidElement(inline);\n            if (nextInline instanceof ElementBox) {\n                nextRenderedInline = nextInline;\n            }\n            if (!isNullOrUndefined(nextRenderedInline) && nextRenderedInline instanceof FieldElementBox\n                && nextRenderedInline.fieldType === 0) {\n                inline = nextRenderedInline.fieldEnd;\n                paragraph = inline.line.paragraph;\n                offset = inline.line.getOffset(inline, 1);\n                selection.end.setPositionParagraph(inline.line, offset);\n                selection.fireSelectionChanged(true);\n                return;\n            }\n            else if (inline !== nextRenderedInline) {\n                inline = nextRenderedInline;\n                paragraph = inline.line.paragraph;\n                offset = inline.line.getOffset(inline, 0);\n                if (inline instanceof FieldElementBox && inline.fieldType === 1) {\n                    offset++;\n                }\n            }\n        }\n        if (inline && (inline instanceof BookmarkElementBox && inline.bookmarkType === 0\n            || inline.nextNode instanceof BookmarkElementBox)) {\n            if (inline instanceof BookmarkElementBox) {\n                inline = inline.nextNode;\n                paragraph = inline.line.paragraph;\n                offset = inline.line.getOffset(inline, 0);\n            }\n            if (inline.length === 1 && inline.nextNode instanceof BookmarkElementBox\n                && inline.previousNode instanceof BookmarkElementBox) {\n                var bookMarkBegin = inline.previousNode;\n                var bookMarkEnd = inline.nextNode;\n                selection.start.setPositionParagraph(bookMarkBegin.line, bookMarkBegin.line.getOffset(bookMarkBegin, 0));\n                selection.end.setPositionParagraph(bookMarkEnd.line, bookMarkEnd.line.getOffset(bookMarkEnd, 0) + 1);\n                this.initHistory('Delete');\n                this.deleteSelectedContentInternal(selection, false, selection.start, selection.end);\n                var textPosition = new TextPosition(selection.owner);\n                this.setPositionForCurrentIndex(textPosition, selection.editPosition);\n                selection.selectContent(textPosition, true);\n                this.reLayout(selection);\n                return;\n            }\n        }\n        if (selection.start.currentWidget.isLastLine() && offset === this.viewer.selection.getLineLength(selection.start.currentWidget)) {\n            if (paragraph.isInsideTable && isNullOrUndefined(paragraph.nextWidget)) {\n                return;\n            }\n            var previousParagraph = undefined;\n            var newParagraph = undefined;\n            var nextParagraph = selection.getNextParagraphBlock(paragraph);\n            if (isNullOrUndefined(nextParagraph)) {\n                if (offset > 0) {\n                    return;\n                }\n                else {\n                    if (paragraph.previousWidget instanceof ParagraphWidget) {\n                        previousParagraph = paragraph.previousWidget;\n                    }\n                    if (paragraph.previousWidget instanceof TableWidget) {\n                        return;\n                    }\n                    if (isNullOrUndefined(previousParagraph)) {\n                        return;\n                        //Adds an empty paragraph, to ensure minimal content.\n                    }\n                }\n            }\n            if (!isRedoing) {\n                this.initHistory('Delete');\n            }\n            var blockInfo = this.getParagraphInfo(selection.start);\n            selection.editPosition = this.getHierarchicalIndex(blockInfo.paragraph, blockInfo.offset.toString());\n            if (this.checkInsertPosition(selection)) {\n                this.setPositionForHistory(selection.editPosition);\n            }\n            selection.owner.isShiftingEnabled = true;\n            if (paragraph.isEmpty()) {\n                this.removeBlock(paragraph);\n                this.addRemovedNodes(paragraph);\n                if (isNullOrUndefined(nextParagraph)) {\n                    if (isNullOrUndefined(previousParagraph)) {\n                        // selection.selectParagraph(newParagraph, true, true);\n                        var paraEndOffset = selection.getParagraphLength(newParagraph) + 1;\n                        if (this.editorHistory && !isNullOrUndefined(this.editorHistory.currentBaseHistoryInfo)) {\n                            this.updateHistoryPosition(selection.start, true);\n                            //tslint:disable-next-line:max-line-length\n                            this.editorHistory.currentBaseHistoryInfo.endPosition = this.getHierarchicalIndex(newParagraph, paraEndOffset.toString());\n                        }\n                    }\n                    else {\n                        selection.selectParagraph(previousParagraph, false);\n                        this.setPositionForHistory();\n                    }\n                }\n                else {\n                    selection.selectParagraph(nextParagraph, true);\n                }\n            }\n            else {\n                paragraph = paragraph.combineWidget(this.viewer);\n                // tslint:disable-next-line:max-line-length\n                var currentParagraph = this.splitParagraph(paragraph, paragraph.firstChild, 0, selection.start.currentWidget, selection.start.offset, true);\n                this.deleteParagraphMark(currentParagraph, selection, 0);\n                this.addRemovedNodes(paragraph);\n                this.setPositionForCurrentIndex(selection.start, selection.editPosition);\n                selection.selectContent(selection.start, true);\n            }\n            // if (!isRedoing) {\n            this.reLayout(selection);\n            // }\n        }\n        else {\n            this.singleDeleteInternal(selection, isRedoing, paragraph);\n        }\n    };\n    Editor.prototype.singleDeleteInternal = function (selection, isRedoing, paragraph) {\n        if (!isRedoing) {\n            selection.owner.isShiftingEnabled = true;\n            this.initHistory('Delete');\n        }\n        if (this.checkInsertPosition(selection)) {\n            this.updateHistoryPosition(selection.start, true);\n            this.editorHistory.currentBaseHistoryInfo.endPosition = this.editorHistory.currentBaseHistoryInfo.insertPosition;\n        }\n        var paragraphInfo = this.getParagraphInfo(selection.start);\n        var lineWidget = selection.start.currentWidget;\n        var removeOffset = selection.start.offset;\n        var lineLength = selection.getLineLength(selection.start.currentWidget);\n        if (removeOffset >= lineLength) {\n            lineWidget = lineWidget.nextLine;\n            removeOffset = removeOffset - lineLength;\n        }\n        this.removeAtOffset(lineWidget, selection, removeOffset);\n        this.setPositionParagraph(paragraphInfo.paragraph, paragraphInfo.offset, false);\n        if (!isRedoing) {\n            this.reLayout(selection);\n        }\n        else {\n            this.fireContentChange();\n        }\n    };\n    Editor.prototype.deleteParagraphMark = function (paragraph, selection, editAction) {\n        if (isNullOrUndefined(paragraph.containerWidget)) {\n            return;\n        }\n        paragraph = paragraph.combineWidget(this.viewer);\n        var nextParagraph = selection.getNextParagraphBlock(paragraph);\n        if (paragraph.isInsideTable && isNullOrUndefined(paragraph.nextWidget) || isNullOrUndefined(nextParagraph)) {\n            return;\n        }\n        //BodyWidget\n        var section = paragraph.containerWidget instanceof BodyWidget ? paragraph.containerWidget : undefined;\n        var table = undefined;\n        if (selection.getNextRenderedBlock(paragraph) instanceof TableWidget) {\n            table = selection.getNextRenderedBlock(paragraph);\n        }\n        else {\n            table = undefined;\n        }\n        if (nextParagraph.isInsideTable && !isNullOrUndefined(table) && table.contains(nextParagraph.associatedCell)) {\n            if (editAction < 4) {\n                // let nextSection: BodyWidget = table.containerWidget instanceof BodyWidget ? table.containerWidget : undefined;\n                // if (section !== nextSection) {\n                //     this.combineSection(section, selection, nextSection);\n                // }\n                var offset = 0;\n                this.removeBlock(paragraph);\n                this.viewer.layout.clearListElementBox(nextParagraph);\n                this.viewer.layout.clearListElementBox(paragraph);\n                for (var i = paragraph.childWidgets.length - 1; i >= 0; i--) {\n                    var line = paragraph.childWidgets[i];\n                    for (var j = line.children.length - 1; j >= 0; j--) {\n                        var element = line.children[j];\n                        offset += element.length;\n                        nextParagraph.firstChild.children.unshift(element);\n                        element.line = nextParagraph.firstChild;\n                        // this.layoutInlineCollection(false, 0, nextParagraph.inlines, inline);\n                    }\n                }\n                this.viewer.layout.reLayoutParagraph(nextParagraph, 0, 0);\n                if (offset > 0) {\n                    selection.editPosition = this.getHierarchicalIndex(nextParagraph, offset.toString());\n                }\n            }\n        }\n        else {\n            if (editAction < 4) {\n                // let nextSection: WSection = nextParagraph.section instanceof WSection ? nextParagraph.section as WSection : undefined;\n                // if (section !== nextSection) {\n                //     this.combineSection(section, selection, nextSection);\n                // }\n                var prevLength = paragraph.childWidgets.length - 1;\n                var nextPara = nextParagraph.getSplitWidgets();\n                nextParagraph = nextParagraph.combineWidget(this.viewer);\n                this.viewer.layout.clearListElementBox(nextParagraph);\n                this.viewer.layout.clearListElementBox(paragraph);\n                this.updateEditPositionOnMerge(paragraph, nextParagraph);\n                for (var i = 0; i < nextParagraph.childWidgets.length; i++) {\n                    var inline = nextParagraph.childWidgets[i];\n                    nextParagraph.childWidgets.splice(i, 1);\n                    paragraph.childWidgets.push(inline);\n                    inline.paragraph = paragraph;\n                    i--;\n                }\n                if (nextParagraph.childWidgets.length === 0) {\n                    nextParagraph.childWidgets.push(new LineWidget(nextParagraph));\n                }\n                this.removeBlock(nextParagraph);\n                this.viewer.layout.reLayoutParagraph(paragraph, 0, 0);\n                this.addRemovedNodes(nextParagraph);\n            }\n        }\n    };\n    Editor.prototype.updateEditPositionOnMerge = function (currentParagraph, nextParagraph) {\n        if (this.viewer.selection.editPosition === this.getHierarchicalIndex(nextParagraph, '0') &&\n            nextParagraph.nextRenderedWidget === undefined) {\n            // tslint:disable-next-line:max-line-length\n            this.viewer.selection.editPosition = this.getHierarchicalIndex(currentParagraph, this.viewer.selection.getLineLength(currentParagraph.lastChild).toString());\n        }\n    };\n    Editor.prototype.checkEndPosition = function (selection) {\n        return (this.editorHistory && !isNullOrUndefined(this.editorHistory.currentBaseHistoryInfo)\n            && isNullOrUndefined(this.editorHistory.currentBaseHistoryInfo.endPosition));\n    };\n    Editor.prototype.checkInsertPosition = function (selection) {\n        return (this.editorHistory && !isNullOrUndefined(this.editorHistory.currentBaseHistoryInfo)\n            && isNullOrUndefined(this.editorHistory.currentBaseHistoryInfo.insertPosition));\n    };\n    Editor.prototype.checkIsNotRedoing = function () {\n        return this.viewer.owner.enableHistoryMode && !this.editorHistory.isRedoing;\n    };\n    // tslint:disable-next-line:max-line-length\n    Editor.prototype.deleteSelectedContentInternal = function (selection, isBackSpace, startPosition, endPosition) {\n        var startPos = startPosition;\n        var endPos = endPosition;\n        if (!startPosition.isExistBefore(endPosition)) {\n            startPos = endPosition;\n            endPos = startPosition;\n        }\n        var blockInfo = this.getParagraphInfo(startPos);\n        selection.editPosition = this.getHierarchicalIndex(blockInfo.paragraph, blockInfo.offset.toString());\n        var skipBackSpace = false;\n        if (isBackSpace && startPos.isInSameParagraph(endPos)) {\n            //Handled specifically to skip removal of contents, if selection is only paragraph mark and next rendered block is table.\n            if (startPos.offset < endPos.offset && startPos.offset === selection.getParagraphLength(endPos.paragraph)) {\n                var nextBlock = selection.getNextRenderedBlock(startPos.paragraph);\n                skipBackSpace = nextBlock instanceof TableWidget;\n            }\n            //Handled specifically to remove paragraph completely (Delete behavior), if the selected paragraph is empty.\n            if (endPos.offset === 1 && endPos.offset > selection.getParagraphLength(endPos.paragraph)\n                && !(endPos.paragraph.isInsideTable && isNullOrUndefined(endPos.paragraph.nextWidget))) {\n                isBackSpace = false;\n            }\n        }\n        if (!skipBackSpace) {\n            selection.owner.isShiftingEnabled = true;\n            if (this.checkInsertPosition(selection)) {\n                this.editorHistory.currentBaseHistoryInfo.insertPosition = selection.editPosition;\n            }\n            var editAction = (isBackSpace ? 1 : 0);\n            this.deleteSelectedContent(endPos.paragraph, selection, startPos, endPos, editAction);\n        }\n        return skipBackSpace;\n    };\n    /**\n     * Init EditorHistory\n     * @private\n     */\n    Editor.prototype.initHistory = function (action) {\n        if (this.viewer.owner.enableHistoryMode) {\n            this.editorHistory.initializeHistory(action);\n        }\n    };\n    /**\n     * Init Complex EditorHistory\n     * @private\n     */\n    Editor.prototype.initComplexHistory = function (action) {\n        if (this.viewer.owner.enableHistoryMode) {\n            this.editorHistory.initComplexHistory(this.viewer.selection, action);\n        }\n    };\n    //Insert Picture implementation starts\n    /**\n     * Insert image\n     * @param  {string} base64String\n     * @param  {number} width\n     * @param  {number} height\n     * @private\n     */\n    Editor.prototype.insertPicture = function (base64String, width, height) {\n        var imageElementBox = new ImageElementBox(true);\n        imageElementBox.imageString = base64String;\n        imageElementBox.width = width;\n        imageElementBox.height = height;\n        this.insertPictureInternal(imageElementBox);\n    };\n    Editor.prototype.insertPictureInternal = function (imageElementBox) {\n        var selection = this.viewer.selection;\n        this.initHistory('InsertInline');\n        this.fitImageToPage(selection, imageElementBox);\n        this.insertInlineInSelection(selection, imageElementBox);\n        this.reLayout(selection);\n    };\n    Editor.prototype.fitImageToPage = function (selection, imageElementBox) {\n        var section = selection.start.paragraph.bodyWidget;\n        var pageWidth = section.sectionFormat.pageWidth - section.sectionFormat.leftMargin - section.sectionFormat.rightMargin;\n        var pageHeight = section.sectionFormat.pageHeight - section.sectionFormat.topMargin - section.sectionFormat.topMargin;\n        //Resizes image to page size.\n        if (imageElementBox.width > pageWidth) {\n            imageElementBox.height = imageElementBox.height * pageWidth / imageElementBox.width;\n            imageElementBox.width = pageWidth;\n        }\n        if (imageElementBox.height > pageHeight) {\n            imageElementBox.width = imageElementBox.width * pageHeight / imageElementBox.height;\n            imageElementBox.height = pageHeight;\n        }\n    };\n    //Insert Picture implementation ends\n    /**\n     * @private\n     */\n    Editor.prototype.insertInlineInSelection = function (selection, elementBox) {\n        if (this.checkIsNotRedoing()) {\n            selection.owner.isShiftingEnabled = true;\n        }\n        if (!selection.isEmpty) {\n            this.removeSelectedContents(selection);\n        }\n        this.updateInsertPosition();\n        this.insertInlineInternal(elementBox);\n        if (this.checkEndPosition(selection)) {\n            this.updateHistoryPosition(selection.start, false);\n        }\n        this.fireContentChange();\n    };\n    /**\n     * @private\n     */\n    Editor.prototype.onPortrait = function () {\n        var sectionFormat = new WSectionFormat();\n        var width = this.viewer.selection.sectionFormat.pageWidth;\n        var height = this.viewer.selection.sectionFormat.pageHeight;\n        if (width > height) {\n            sectionFormat.pageWidth = height;\n            sectionFormat.pageHeight = width;\n        }\n        this.onApplySectionFormat(undefined, sectionFormat);\n    };\n    /**\n     * @private\n     */\n    Editor.prototype.onLandscape = function () {\n        var sectionFormat = new WSectionFormat();\n        var width = this.viewer.selection.sectionFormat.pageWidth;\n        var height = this.viewer.selection.sectionFormat.pageHeight;\n        if (width < height) {\n            sectionFormat.pageWidth = height;\n            sectionFormat.pageHeight = width;\n        }\n        this.onApplySectionFormat(undefined, sectionFormat);\n    };\n    Editor.prototype.copyValues = function () {\n        var format = new WSectionFormat();\n        format.bottomMargin = this.viewer.selection.sectionFormat.bottomMargin;\n        format.topMargin = this.viewer.selection.sectionFormat.topMargin;\n        format.leftMargin = this.viewer.selection.sectionFormat.leftMargin;\n        format.rightMargin = this.viewer.selection.sectionFormat.rightMargin;\n        format.pageHeight = this.viewer.selection.sectionFormat.pageHeight;\n        format.pageWidth = this.viewer.selection.sectionFormat.pageWidth;\n        format.footerDistance = this.viewer.selection.sectionFormat.footerDistance;\n        format.headerDistance = this.viewer.selection.sectionFormat.headerDistance;\n        return format;\n    };\n    /**\n     * @private\n     */\n    Editor.prototype.changeMarginValue = function (property) {\n        var sectionFormat = this.copyValues();\n        if (property === 'lastCustomSetting' || property === 'normal') {\n            sectionFormat.topMargin = 72;\n            sectionFormat.bottomMargin = 72;\n            sectionFormat.leftMargin = 72;\n            sectionFormat.rightMargin = 72;\n        }\n        else if (property === 'narrow') {\n            sectionFormat.topMargin = 36;\n            sectionFormat.bottomMargin = 36;\n            sectionFormat.leftMargin = 36;\n            sectionFormat.rightMargin = 36;\n        }\n        else if (property === 'moderate') {\n            sectionFormat.topMargin = 72;\n            sectionFormat.bottomMargin = 72;\n            sectionFormat.leftMargin = 54;\n            sectionFormat.rightMargin = 54;\n        }\n        else if (property === 'wide') {\n            sectionFormat.topMargin = 72;\n            sectionFormat.bottomMargin = 72;\n            sectionFormat.leftMargin = 144;\n            sectionFormat.rightMargin = 144;\n        }\n        else if (property === 'mirrored') {\n            sectionFormat.topMargin = 72;\n            sectionFormat.bottomMargin = 72;\n            sectionFormat.leftMargin = 90;\n            sectionFormat.rightMargin = 72;\n        }\n        else if (property === 'office2003Default') {\n            sectionFormat.topMargin = 72;\n            sectionFormat.bottomMargin = 72;\n            sectionFormat.leftMargin = 90;\n            sectionFormat.rightMargin = 90;\n        }\n        this.onApplySectionFormat(undefined, sectionFormat);\n    };\n    /**\n     * @private\n     */\n    Editor.prototype.onPaperSize = function (property) {\n        var sectionFormat = this.copyValues();\n        var width = this.viewer.selection.sectionFormat.pageWidth;\n        var height = this.viewer.selection.sectionFormat.pageHeight;\n        if (property === 'letter') {\n            if (width < height) {\n                sectionFormat.pageWidth = 611.9;\n                sectionFormat.pageHeight = 791.9;\n            }\n            else {\n                sectionFormat.pageWidth = 791.9;\n                sectionFormat.pageHeight = 611.9;\n            }\n        }\n        else if (property === 'tabloid') {\n            if (width < height) {\n                sectionFormat.pageWidth = 791.9;\n                sectionFormat.pageHeight = 1223.9;\n            }\n            else {\n                sectionFormat.pageWidth = 1223.9;\n                sectionFormat.pageHeight = 791.9;\n            }\n        }\n        else if (property === 'legal') {\n            if (width < height) {\n                sectionFormat.pageWidth = 611.9;\n                sectionFormat.pageHeight = 1007.9;\n            }\n            else {\n                sectionFormat.pageWidth = 1007.9;\n                sectionFormat.pageHeight = 611.9;\n            }\n        }\n        else if (property === 'statement') {\n            if (width < height) {\n                sectionFormat.pageWidth = 396;\n                sectionFormat.pageHeight = 611.9;\n            }\n            else {\n                sectionFormat.pageWidth = 611.9;\n                sectionFormat.pageHeight = 396;\n            }\n        }\n        else if (property === 'executive') {\n            if (width < height) {\n                sectionFormat.pageWidth = 521.9;\n                sectionFormat.pageHeight = 755.9;\n            }\n            else {\n                sectionFormat.pageWidth = 755.9;\n                sectionFormat.pageHeight = 521.9;\n            }\n        }\n        else if (property === 'a3') {\n            if (width < height) {\n                sectionFormat.pageWidth = 841.8;\n                sectionFormat.pageHeight = 1190.4;\n            }\n            else {\n                sectionFormat.pageWidth = 1190.4;\n                sectionFormat.pageHeight = 841.8;\n            }\n        }\n        else if (property === 'a4') {\n            if (width < height) {\n                sectionFormat.pageWidth = 595.2;\n                sectionFormat.pageHeight = 841.8;\n            }\n            else {\n                sectionFormat.pageWidth = 841.8;\n                sectionFormat.pageHeight = 595.2;\n            }\n        }\n        else if (property === 'a5') {\n            if (width < height) {\n                sectionFormat.pageWidth = 419.5;\n                sectionFormat.pageHeight = 595.2;\n            }\n            else {\n                sectionFormat.pageWidth = 595.2;\n                sectionFormat.pageHeight = 419.5;\n            }\n        }\n        else if (property === 'b4') {\n            if (width < height) {\n                sectionFormat.pageWidth = 728.4;\n                sectionFormat.pageHeight = 1031.7;\n            }\n            else {\n                sectionFormat.pageWidth = 1031.7;\n                sectionFormat.pageHeight = 728.4;\n            }\n        }\n        else if (property === 'b5') {\n            if (width < height) {\n                sectionFormat.pageWidth = 515.8;\n                sectionFormat.pageHeight = 728.4;\n            }\n            else {\n                sectionFormat.pageWidth = 728.4;\n                sectionFormat.pageHeight = 515.8;\n            }\n        }\n        this.onApplySectionFormat(undefined, sectionFormat);\n    };\n    //Update List Items\n    /**\n     * @private\n     */\n    Editor.prototype.updateListItemsTillEnd = function (blockAdv, updateNextBlockList) {\n        var block = updateNextBlockList ? this.viewer.selection.getNextRenderedBlock(blockAdv) : blockAdv;\n        while (!isNullOrUndefined(block)) {\n            //Updates the list value of the rendered paragraph. \n            this.updateRenderedListItems(block);\n            block = block.getSplitWidgets().pop().nextRenderedWidget;\n        }\n    };\n    /**\n     * @private\n     */\n    Editor.prototype.updateWholeListItems = function (block) {\n        this.viewer.renderedLists.clear();\n        var sectionIndex = block.bodyWidget.index;\n        var currentBlock;\n        for (var j = 0; j < this.viewer.pages.length; j++) {\n            var page = this.viewer.pages[j];\n            if (page.bodyWidgets[0].index === sectionIndex) {\n                currentBlock = page.bodyWidgets[0].firstChild;\n                break;\n            }\n        }\n        var isListUpdated = false;\n        do {\n            isListUpdated = this.updateListItems(currentBlock, block);\n            if (isListUpdated) {\n                break;\n            }\n            currentBlock = currentBlock.getSplitWidgets().pop().nextRenderedWidget;\n        } while (currentBlock);\n    };\n    Editor.prototype.updateListItems = function (blockAdv, block) {\n        var isListUpdated = false;\n        if (blockAdv instanceof ParagraphWidget) {\n            isListUpdated = this.updateListItemsForPara(blockAdv, block);\n        }\n        else {\n            isListUpdated = this.updateListItemsForTable(blockAdv, block);\n        }\n        return isListUpdated;\n    };\n    Editor.prototype.updateListItemsForTable = function (table, block) {\n        if (block instanceof TableWidget && table.equals(block)) {\n            return true;\n        }\n        var row = table.firstChild;\n        do {\n            var isListUpdated = this.updateListItemsForRow(row, block);\n            if (isListUpdated) {\n                return true;\n            }\n            row = row.getSplitWidgets().pop().nextRenderedWidget;\n        } while (row);\n        return false;\n    };\n    Editor.prototype.updateListItemsForRow = function (row, block) {\n        if (block.isInsideTable && row.childWidgets.indexOf(this.viewer.selection.getContainerCell(block.associatedCell)) !== -1) {\n            //Returns as list updated, inorder to start list numbering from first list paragraph of this row.\n            return true;\n        }\n        var cell = row.firstChild;\n        do {\n            this.updateListItemsForCell(cell, block);\n            cell = cell.nextRenderedWidget;\n        } while (cell);\n        return false;\n    };\n    Editor.prototype.updateListItemsForCell = function (cell, block) {\n        if (cell.childWidgets.length === 0) {\n            return;\n        }\n        var currentBlock = cell.firstChild;\n        do {\n            this.updateListItems(currentBlock, block);\n            currentBlock = currentBlock.getSplitWidgets().pop().nextRenderedWidget;\n        } while (currentBlock);\n    };\n    // public abstract updateListParagraphs(): void;\n    /**\n     * @private\n     */\n    Editor.prototype.updateRenderedListItems = function (block) {\n        if (block instanceof ParagraphWidget) {\n            this.updateRenderedListItemsForPara(block);\n        }\n        else {\n            this.updateRenderedListItemsForTable(block);\n        }\n    };\n    Editor.prototype.updateRenderedListItemsForTable = function (table) {\n        var row = table.firstChild;\n        do {\n            this.updateRenderedListItemsForRow(row);\n            row = row.getSplitWidgets().pop().nextRenderedWidget;\n        } while (row);\n    };\n    Editor.prototype.updateRenderedListItemsForRow = function (row) {\n        var cell = row.firstChild;\n        do {\n            this.updateRenderedListItemsForCell(cell);\n            cell = cell.nextRenderedWidget;\n        } while (cell);\n    };\n    Editor.prototype.updateRenderedListItemsForCell = function (cell) {\n        if (cell.childWidgets.length === 0) {\n            return;\n        }\n        var currentBlock = cell.firstChild;\n        do {\n            this.updateRenderedListItems(currentBlock);\n            currentBlock = currentBlock.getSplitWidgets().pop().nextRenderedWidget;\n        } while (currentBlock);\n    };\n    Editor.prototype.updateListItemsForPara = function (paragraph, block) {\n        if (paragraph.equals(block)) {\n            return true;\n        }\n        else {\n            var currentList = undefined;\n            var listLevelNumber = 0;\n            if (!isNullOrUndefined(paragraph.paragraphFormat) && !isNullOrUndefined(paragraph.paragraphFormat.listFormat)) {\n                currentList = this.viewer.getListById(paragraph.paragraphFormat.listFormat.listId);\n                listLevelNumber = paragraph.paragraphFormat.listFormat.listLevelNumber;\n            }\n            // tslint:disable-next-line:max-line-length\n            if (!isNullOrUndefined(currentList) && !isNullOrUndefined(this.viewer.getAbstractListById(currentList.abstractListId))\n                // tslint:disable-next-line:max-line-length\n                && !isNullOrUndefined(this.viewer.getAbstractListById(currentList.abstractListId).levels[listLevelNumber])) {\n                var currentListLevel = this.viewer.layout.getListLevel(currentList, listLevelNumber);\n                //Updates the list numbering from document start for reLayouting.\n                if (currentListLevel.listLevelPattern !== 'Bullet') {\n                    this.viewer.layout.getListNumber(paragraph.paragraphFormat.listFormat);\n                }\n            }\n        }\n        return false;\n    };\n    Editor.prototype.updateRenderedListItemsForPara = function (paragraph) {\n        if (!isNullOrUndefined(this.viewer.getListById(paragraph.paragraphFormat.listFormat.listId))) {\n            var currentList = this.viewer.getListById(paragraph.paragraphFormat.listFormat.listId);\n            var listLevelNumber = paragraph.paragraphFormat.listFormat.listLevelNumber;\n            if (!isNullOrUndefined(currentList) && !isNullOrUndefined(this.viewer.getAbstractListById(currentList.abstractListId))\n                // tslint:disable-next-line:max-line-length\n                && !isNullOrUndefined(this.viewer.getAbstractListById(currentList.abstractListId).levels[paragraph.paragraphFormat.listFormat.listLevelNumber])) {\n                var currentListLevel = this.viewer.layout.getListLevel(currentList, listLevelNumber);\n                //Updates the list numbering from document start for reLayouting.\n                if (currentListLevel.listLevelPattern !== 'Bullet') {\n                    var element = undefined;\n                    if (paragraph.childWidgets.length > 0) {\n                        var lineWidget = paragraph.childWidgets[0];\n                        if (lineWidget.children.length > 0) {\n                            element = lineWidget.children[0];\n                        }\n                    }\n                    if (!isNullOrUndefined(element)) {\n                        element.text = this.viewer.layout.getListNumber(paragraph.paragraphFormat.listFormat);\n                    }\n                }\n            }\n        }\n    };\n    /**\n     * Get logical offset of paragraph.\n     * @private\n     */\n    Editor.prototype.getParagraphInfo = function (position) {\n        return this.getParagraphInfoInternal(position.currentWidget, position.offset);\n    };\n    /**\n     * @private\n     */\n    Editor.prototype.getParagraphInfoInternal = function (line, lineOffset) {\n        var paragraph = line.paragraph;\n        var offset = this.selection.getParagraphLength(paragraph, line) + lineOffset;\n        var previous = paragraph.previousSplitWidget;\n        while (previous instanceof ParagraphWidget) {\n            paragraph = previous;\n            offset += this.viewer.selection.getParagraphLength(paragraph);\n            previous = paragraph.previousSplitWidget;\n        }\n        return { 'paragraph': paragraph, 'offset': offset };\n    };\n    /**\n     * Get offset value to update in selection\n     * @private\n     */\n    Editor.prototype.getOffsetValue = function (selection) {\n        if (this.startParagraph) {\n            var lineInfo = this.getLineInfo(this.startParagraph, this.startOffset);\n            selection.start.setPositionFromLine(lineInfo.line, lineInfo.offset);\n        }\n        selection.start.updatePhysicalPosition(true);\n        if (selection.isEmpty) {\n            selection.end.setPositionInternal(selection.start);\n        }\n        else {\n            if (this.endParagraph) {\n                var lineInfo = this.getLineInfo(this.endParagraph, this.endOffset);\n                selection.end.setPositionFromLine(lineInfo.line, lineInfo.offset);\n            }\n            selection.end.updatePhysicalPosition(true);\n        }\n    };\n    /**\n     * Get offset value to update in selection\n     * @private\n     */\n    Editor.prototype.getLineInfo = function (paragraph, offset) {\n        var position = undefined;\n        var element = undefined;\n        var length = this.selection.getParagraphLength(paragraph);\n        var next = paragraph.nextSplitWidget;\n        if (offset > length + 1 && isNullOrUndefined(next)) {\n            offset = length;\n        }\n        while (offset > length && next instanceof ParagraphWidget) {\n            offset -= length;\n            paragraph = next;\n            length = this.selection.getParagraphLength(paragraph);\n            next = paragraph.nextSplitWidget;\n        }\n        return this.selection.getLineInfo(paragraph, offset);\n    };\n    /**\n     * @private\n     */\n    Editor.prototype.setPositionParagraph = function (paragraph, offset, skipSelectionChange) {\n        var selection = this.viewer.selection;\n        var lineInfo = this.getLineInfo(paragraph, offset);\n        selection.start.setPositionFromLine(lineInfo.line, lineInfo.offset);\n        selection.end.setPositionInternal(selection.start);\n        if (!skipSelectionChange) {\n            selection.fireSelectionChanged(true);\n        }\n    };\n    /**\n     * @private\n     */\n    Editor.prototype.setPositionForCurrentIndex = function (textPosition, editPosition) {\n        var blockInfo = this.getParagraph({ index: editPosition });\n        var lineInfo = this.getLineInfo(blockInfo.paragraph, blockInfo.offset);\n        textPosition.setPositionForLineWidget(lineInfo.line, lineInfo.offset);\n    };\n    /**\n     * @private\n     */\n    Editor.prototype.insertPageNumber = function (numberFormat) {\n        if (isNullOrUndefined(numberFormat)) {\n            numberFormat = '';\n        }\n        else {\n            numberFormat = ' \\\\*' + numberFormat;\n        }\n        var fieldCode = 'PAGE ' + numberFormat + ' \\\\* MERGEFORMAT';\n        this.createFields(fieldCode);\n    };\n    /**\n     * @private\n     */\n    Editor.prototype.insertPageCount = function (numberFormat) {\n        if (isNullOrUndefined(numberFormat)) {\n            numberFormat = '';\n        }\n        else {\n            numberFormat = ' \\*' + numberFormat;\n        }\n        var fieldCode = 'NUMPAGES ' + numberFormat + ' \\* MERGEFORMAT';\n        this.createFields(fieldCode);\n    };\n    Editor.prototype.createFields = function (fieldCode) {\n        var paragraph = new ParagraphWidget();\n        var line = new LineWidget(paragraph);\n        var fieldBegin = new FieldElementBox(0);\n        line.children.push(fieldBegin);\n        var fieldtext = new FieldTextElementBox();\n        fieldtext.fieldBegin = fieldBegin;\n        fieldtext.text = '1';\n        var text = new TextElementBox();\n        text.text = fieldCode;\n        line.children.push(text);\n        var fieldSeparator = new FieldElementBox(2);\n        fieldSeparator.fieldBegin = fieldBegin;\n        fieldBegin.fieldSeparator = fieldSeparator;\n        line.children.push(fieldSeparator);\n        line.children.push(fieldtext);\n        var fieldEnd = new FieldElementBox(1);\n        fieldEnd.fieldBegin = fieldBegin;\n        fieldEnd.fieldSeparator = fieldSeparator;\n        fieldSeparator.fieldEnd = fieldEnd;\n        fieldBegin.fieldEnd = fieldEnd;\n        line.children.push(fieldEnd);\n        fieldBegin.line = line;\n        paragraph.childWidgets.push(line);\n        var widgets = [];\n        widgets.push(paragraph);\n        this.viewer.fields.push(fieldBegin);\n        this.pasteContentsInternal(widgets);\n    };\n    /**\n     * @private\n     */\n    Editor.prototype.insertBookmark = function (name) {\n        var bookmark = new BookmarkElementBox(0);\n        bookmark.name = name;\n        var bookmarkEnd = new BookmarkElementBox(1);\n        bookmarkEnd.name = name;\n        bookmark.reference = bookmarkEnd;\n        bookmarkEnd.reference = bookmark;\n        this.viewer.bookmarks.add(name, bookmark);\n        this.initComplexHistory('InsertBookmark');\n        this.insertElements([bookmarkEnd], [bookmark]);\n        if (this.editorHistory) {\n            this.editorHistory.updateComplexHistoryInternal();\n        }\n        this.selection.start.setPositionForSelection(bookmark.line, bookmark, 1, this.selection.start.location);\n        this.selection.end.setPositionForSelection(bookmarkEnd.line, bookmarkEnd, 0, this.selection.end.location);\n        this.selection.fireSelectionChanged(true);\n        this.fireContentChange();\n    };\n    /**\n     * @private\n     */\n    Editor.prototype.deleteBookmark = function (bookmarkName) {\n        var bookmarks = this.viewer.bookmarks;\n        var bookmark = bookmarks.get(bookmarkName);\n        if (bookmark instanceof BookmarkElementBox) {\n            var bookmarkEnd = bookmark.reference;\n            this.initHistory('DeleteBookmark');\n            if (this.editorHistory) {\n                this.editorHistory.currentBaseHistoryInfo.setBookmarkInfo(bookmark);\n                this.editorHistory.updateHistory();\n            }\n            this.deleteBookmarkInternal(bookmark);\n        }\n        this.fireContentChange();\n    };\n    /**\n     * @private\n     */\n    Editor.prototype.deleteBookmarkInternal = function (bookmark) {\n        this.viewer.bookmarks.remove(bookmark.name);\n        bookmark.line.children.splice(bookmark.indexInOwner, 1);\n        bookmark.reference.line.children.splice(bookmark.reference.indexInOwner, 1);\n    };\n    /**\n     * @private\n     */\n    Editor.prototype.getSelectionInfo = function () {\n        var start = this.selection.start;\n        var end = this.selection.end;\n        var isEmpty = this.selection.isEmpty;\n        if (!this.selection.isForward) {\n            start = this.selection.end;\n            end = this.selection.start;\n        }\n        var startElementInfo = start.currentWidget.getInline(start.offset, 0);\n        var endElementInfo = end.currentWidget.getInline(end.offset, 0);\n        // tslint:disable-next-line:max-line-length\n        return { 'start': start.clone(), 'end': end.clone(), 'startElementInfo': startElementInfo, 'endElementInfo': endElementInfo, 'isEmpty': isEmpty };\n    };\n    /**\n     * @private\n     */\n    Editor.prototype.insertElements = function (endElements, startElements) {\n        var info = this.getSelectionInfo();\n        if (!isNullOrUndefined(startElements)) {\n            this.insertElementsInternal(info.start, startElements);\n        }\n        if (!isNullOrUndefined(endElements)) {\n            this.insertElementsInternal(info.end, endElements);\n        }\n    };\n    /**\n     * @private\n     */\n    Editor.prototype.insertElementsInternal = function (position, elements) {\n        this.selection.selectPosition(position, position);\n        this.initHistory('InsertElements');\n        this.updateInsertPosition();\n        var indexInInline = 0;\n        var paragraphInfo = this.getParagraphInfo(this.selection.start);\n        if (this.selection.start.paragraph.isEmpty()) {\n            var paragraph = this.selection.start.paragraph;\n            paragraph.childWidgets[0].children.push(elements[0]);\n            elements[0].line = paragraph.childWidgets[0];\n            elements[0].linkFieldCharacter(this.viewer);\n            this.viewer.layout.reLayoutParagraph(paragraph, 0, 0);\n            this.setPositionParagraph(paragraphInfo.paragraph, paragraphInfo.offset + length, true);\n            position.setPositionForSelection(elements[0].line, elements[0], elements[0].length, this.selection.start.location);\n            this.selection.selectPosition(position, position);\n        }\n        else {\n            var inlineObj = this.selection.start.currentWidget.getInline(this.viewer.selection.start.offset, indexInInline);\n            var curInline = inlineObj.element;\n            indexInInline = inlineObj.index;\n            var firstElement = elements[0];\n            this.insertElementInternal(curInline, firstElement, indexInInline, true);\n            var index = firstElement.indexInOwner;\n            var lastElement = firstElement;\n            for (var i = 1; i < elements.length; i++) {\n                lastElement = elements[i];\n                firstElement.line.children.splice(index + i, 0, lastElement);\n            }\n            position.setPositionForSelection(lastElement.line, lastElement, lastElement.length, this.selection.start.location);\n            this.selection.selectPosition(position, position);\n        }\n        if (this.editorHistory) {\n            if (this.checkEndPosition()) {\n                this.updateHistoryPosition(this.selection.start, false);\n            }\n            this.editorHistory.updateHistory();\n        }\n    };\n    /**\n     * @private\n     */\n    Editor.prototype.getHierarchicalIndex = function (block, offset) {\n        var index;\n        if (block) {\n            if (block instanceof HeaderFooterWidget) {\n                var hfString = block.headerFooterType.indexOf('Header') !== -1 ? 'H' : 'F';\n                var pageIndex = block.page.index.toString();\n                var headerFooterIndex = this.viewer.getHeaderFooter(block.headerFooterType).toString();\n                var sectionIndex = block.page.sectionIndex;\n                index = sectionIndex + ';' + hfString + ';' + pageIndex + ';' + offset;\n            }\n            else {\n                index = block.index + ';' + offset;\n            }\n            if (block.containerWidget) {\n                if (block instanceof TableCellWidget && block.rowIndex !== block.containerWidget.index) {\n                    index = block.rowIndex + ';' + index;\n                    block = block.containerWidget;\n                }\n                return this.getHierarchicalIndex(block.containerWidget, index);\n            }\n        }\n        return index;\n    };\n    /**\n     * @private\n     */\n    Editor.prototype.getBlock = function (position) {\n        var bodyWidget = this.getBodyWidget(position);\n        return this.getBlockInternal(bodyWidget, position);\n    };\n    /**\n     * Return Block relative to position\n     * @private\n     */\n    Editor.prototype.getBlockInternal = function (widget, position) {\n        if (position.index === '' || isNullOrUndefined(position)) {\n            return undefined;\n        }\n        var index = position.index.indexOf(';');\n        var value = position.index.substring(0, index);\n        position.index = position.index.substring(index).replace(';', '');\n        var node = widget;\n        // if (node instanceof WSection && value === 'HF') {\n        //     //Gets the block in Header footers.\n        //     let blockObj: BlockInfo = this.getBlock((node as WSection).headerFooters, position);\n        // tslint:disable-next-line:max-line-length\n        //     return { 'node': (!isNullOrUndefined(blockObj)) ? blockObj.node : undefined, 'position': (!isNullOrUndefined(blockObj)) ? blockObj.position : undefined };\n        // }\n        index = parseInt(value, 10);\n        var childWidget = this.getBlockByIndex(widget, index);\n        if (childWidget) {\n            var child = childWidget;\n            if (position.index.indexOf(';') >= 0) {\n                if (child instanceof ParagraphWidget) {\n                    if (position.index.indexOf(';') >= 0) {\n                        position.index = '0';\n                    }\n                    return { 'node': child, 'position': position };\n                }\n                if (child instanceof Widget) {\n                    var blockObj = this.getBlockInternal(child, position);\n                    // tslint:disable-next-line:max-line-length\n                    return { 'node': (!isNullOrUndefined(blockObj)) ? blockObj.node : undefined, 'position': (!isNullOrUndefined(blockObj)) ? blockObj.position : undefined };\n                }\n            }\n            else {\n                return { 'node': child, 'position': position };\n            }\n        }\n        else {\n            return { 'node': node, 'position': position };\n        }\n        return { 'node': node, 'position': position };\n    };\n    /**\n     * @private\n     */\n    Editor.prototype.getParagraph = function (position) {\n        var paragraph = this.getParagraphInternal(this.getBodyWidget(position), position);\n        return { paragraph: paragraph, offset: parseInt(position.index, 10) };\n    };\n    /**\n     * Get paragraph relative to position\n     * @private\n     */\n    Editor.prototype.getParagraphInternal = function (container, position) {\n        if (isNullOrUndefined(position.index)) {\n            return undefined;\n        }\n        // let ins: Widget = container;\n        var index = position.index.indexOf(';');\n        var value = '0';\n        if (index >= 0) {\n            value = position.index.substring(0, index);\n            position.index = position.index.substring(index).replace(';', '');\n        }\n        // if (container instanceof BodyWidget && value === 'HF') {\n        //     return this.getParagraph(container.headerFooters, position);\n        // }\n        index = parseInt(value, 10);\n        if (container instanceof TableRowWidget && index >= container.childWidgets.length) {\n            position.index = '0;0';\n            index = container.childWidgets.length - 1;\n        }\n        var childWidget = this.getBlockByIndex(container, index);\n        if (childWidget) {\n            var child = childWidget;\n            if (child instanceof ParagraphWidget) {\n                if (position.index.indexOf(';') > 0) {\n                    position.index = '0';\n                }\n                return child;\n            }\n            if (child instanceof Widget) {\n                if (position.index.indexOf(';') > 0) {\n                    return this.getParagraphInternal(child, position);\n                }\n                else {\n                    //If table is shifted to previous text position then return the first paragraph within table.\n                    if (child instanceof TableWidget) {\n                        return this.viewer.selection.getFirstParagraphInFirstCell(child);\n                    }\n                    return undefined;\n                }\n            }\n        }\n        else if (container) {\n            var nextWidget = container.getSplitWidgets().pop().nextRenderedWidget;\n            if (nextWidget instanceof Widget) {\n                position.index = '0';\n                if (nextWidget instanceof TableWidget) {\n                    return this.viewer.selection.getFirstParagraphInFirstCell(nextWidget);\n                }\n                return nextWidget;\n            }\n        }\n        return undefined;\n    };\n    Editor.prototype.getBodyWidget = function (position) {\n        var index = position.index.indexOf(';');\n        var value = position.index.substring(0, index);\n        position.index = position.index.substring(index).replace(';', '');\n        var sectionIndex = parseInt(value, 10);\n        index = parseInt(value, 10);\n        index = position.index.indexOf(';');\n        value = position.index.substring(0, index);\n        // position = position.substring(index).replace(';', '');\n        if (value === 'H' || value === 'F') {\n            return this.getHeaderFooterWidget(position);\n        }\n        index = parseInt(value, 10);\n        return this.getBodyWidgetInternal(sectionIndex, index);\n    };\n    Editor.prototype.getHeaderFooterWidget = function (position) {\n        //HEADER OR FOOTER WIDGET\n        var index = position.index.indexOf(';');\n        var value = position.index.substring(0, index);\n        position.index = position.index.substring(index).replace(';', '');\n        var isHeader = value === 'H';\n        index = position.index.indexOf(';');\n        value = position.index.substring(0, index);\n        position.index = position.index.substring(index).replace(';', '');\n        index = parseInt(value, 10);\n        var page = this.viewer.pages[index];\n        if (isHeader) {\n            return page.headerWidget;\n        }\n        else {\n            return page.footerWidget;\n        }\n    };\n    Editor.prototype.getBodyWidgetInternal = function (sectionIndex, blockIndex) {\n        for (var i = 0; i < this.viewer.pages.length; i++) {\n            var bodyWidget = this.viewer.pages[i].bodyWidgets[0];\n            if (bodyWidget.index === sectionIndex) {\n                if (bodyWidget.firstChild.index <= blockIndex && bodyWidget.lastChild.index >= blockIndex) {\n                    return bodyWidget;\n                }\n            }\n            if (bodyWidget.index > sectionIndex) {\n                break;\n            }\n        }\n        return undefined;\n    };\n    /**\n     * @private\n     */\n    Editor.prototype.getBlockByIndex = function (container, blockIndex) {\n        var childWidget;\n        if (container) {\n            for (var j = 0; j < container.childWidgets.length; j++) {\n                if (container.childWidgets[j].index === blockIndex) {\n                    childWidget = container.childWidgets[j];\n                    break;\n                }\n            }\n            if (!childWidget && !(container instanceof HeaderFooterWidget)) {\n                return this.getBlockByIndex(container.nextSplitWidget, blockIndex);\n            }\n        }\n        return childWidget;\n    };\n    /**\n     * @private\n     */\n    Editor.prototype.updateHistoryPosition = function (position, isInsertPosition) {\n        if (this.editorHistory && !isNullOrUndefined(this.editorHistory.currentBaseHistoryInfo)) {\n            var hierarchicalIndex = void 0;\n            if (position instanceof TextPosition) {\n                var blockInfo = this.getParagraphInfo(position);\n                hierarchicalIndex = this.getHierarchicalIndex(blockInfo.paragraph, blockInfo.offset.toString());\n            }\n            else {\n                hierarchicalIndex = position;\n            }\n            if (isInsertPosition) {\n                this.editorHistory.currentBaseHistoryInfo.insertPosition = hierarchicalIndex;\n            }\n            else {\n                this.editorHistory.currentBaseHistoryInfo.endPosition = hierarchicalIndex;\n            }\n        }\n    };\n    /**\n     * Applies the borders based on given settings.\n     * @param {BorderSettings} settings\n     */\n    Editor.prototype.applyBorders = function (settings) {\n        this.initHistory('Borders');\n        var startPos = this.selection.isForward ? this.selection.start : this.selection.end;\n        var endPos = this.selection.isForward ? this.selection.end : this.selection.start;\n        var table = startPos.paragraph.associatedCell.ownerTable;\n        table = table.combineWidget(this.viewer);\n        if (this.editorHistory) {\n            var clonedTable = this.cloneTableToHistoryInfo(table);\n        }\n        var startCell = startPos.paragraph.associatedCell;\n        var endCell = endPos.paragraph.associatedCell;\n        var cells;\n        var border = this.getBorder(settings.borderColor, settings.lineWidth, settings.borderStyle);\n        if (this.selection.isEmpty) {\n            //Apply borders for current selected cell initially.                    \n            if (settings.type === 'OutsideBorders' || settings.type === 'AllBorders' ||\n                settings.type === 'LeftBorder') {\n                endCell.cellFormat.borders.left.copyFormat(border);\n            }\n            if (settings.type === 'OutsideBorders' || settings.type === 'AllBorders' ||\n                settings.type === 'TopBorder') {\n                endCell.cellFormat.borders.top.copyFormat(border);\n            }\n            if (settings.type === 'OutsideBorders' || settings.type === 'AllBorders' ||\n                settings.type === 'RightBorder') {\n                endCell.cellFormat.borders.right.copyFormat(border);\n            }\n            if (settings.type === 'OutsideBorders' || settings.type === 'AllBorders' ||\n                settings.type === 'BottomBorder') {\n                endCell.cellFormat.borders.bottom.copyFormat(border);\n            }\n            if (settings.type === 'AllBorders' || settings.type === 'InsideBorders'\n                || settings.type === 'InsideVerticalBorder') {\n                endCell.cellFormat.borders.vertical.copyFormat(border);\n            }\n            if (settings.type === 'AllBorders' || settings.type === 'InsideBorders'\n                || settings.type === 'InsideHorizontalBorder') {\n                endCell.cellFormat.borders.horizontal.copyFormat(border);\n            }\n            if (settings.type === 'NoBorder') {\n                this.clearAllBorderValues(endCell.cellFormat.borders);\n            }\n        }\n        else {\n            if (settings.type === 'OutsideBorders' || settings.type === 'TopBorder') {\n                var selectedCell = this.getTopBorderCellsOnSelection();\n                for (var i = 0; i < selectedCell.length; i++) {\n                    selectedCell[i].cellFormat.borders.top.copyFormat(border);\n                }\n            }\n            if (settings.type === 'OutsideBorders' || settings.type === 'LeftBorder') {\n                var selectedCell = this.getLeftBorderCellsOnSelection();\n                for (var i = 0; i < selectedCell.length; i++) {\n                    selectedCell[i].cellFormat.borders.left.copyFormat(border);\n                }\n            }\n            if (settings.type === 'OutsideBorders' || settings.type === 'RightBorder') {\n                var selectedCell = this.getRightBorderCellsOnSelection();\n                for (var i = 0; i < selectedCell.length; i++) {\n                    selectedCell[i].cellFormat.borders.right.copyFormat(border);\n                }\n            }\n            if (settings.type === 'OutsideBorders' || settings.type === 'BottomBorder') {\n                var selectedCell = this.getBottomBorderCellsOnSelection();\n                for (var i = 0; i < selectedCell.length; i++) {\n                    selectedCell[i].cellFormat.borders.bottom.copyFormat(border);\n                }\n            }\n        }\n        //Apply Only borders property to selected cells      \n        if (settings.type === 'BottomBorder' || settings.type === 'AllBorders' || settings.type === 'OutsideBorders'\n            || settings.type === 'NoBorder') {\n            cells = this.getAdjacentCellToApplyBottomBorder();\n            for (var i = 0; i < cells.length; i++) {\n                var cell = cells[i];\n                if (settings.type === 'NoBorder') {\n                    cell.cellFormat.borders.top.copyFormat(this.clearBorder());\n                }\n                else {\n                    cell.cellFormat.borders.top.copyFormat(border);\n                }\n            }\n        }\n        if (settings.type === 'AllBorders' || settings.type === 'OutsideBorders' || settings.type === 'RightBorder'\n            || settings.type === 'NoBorder') {\n            cells = this.getAdjacentCellToApplyRightBorder();\n            for (var i = 0; i < cells.length; i++) {\n                var cell = cells[i];\n                if (settings.type === 'NoBorder') {\n                    cell.cellFormat.borders.left.copyFormat(this.clearBorder());\n                }\n                else {\n                    cell.cellFormat.borders.left.copyFormat(border);\n                }\n            }\n        }\n        if (settings.type === 'AllBorders' || settings.type === 'NoBorder') {\n            this.applyAllBorders(border, settings.type);\n        }\n        if (settings.type === 'InsideBorders' || settings.type === 'InsideVerticalBorder'\n            || settings.type === 'InsideHorizontalBorder' || settings.type === 'NoBorder') {\n            this.applyInsideBorders(border, settings.type, table);\n        }\n        this.updateGridForTableDialog(table, false);\n        this.reLayout(this.selection, false);\n        this.editorHistory.updateHistory();\n    };\n    Editor.prototype.applyAllBorders = function (border, borderType) {\n        var cells = this.selection.getSelectedCells();\n        for (var i = 0; i < cells.length; i++) {\n            if (borderType === 'NoBorder') {\n                cells[i].cellFormat.borders.left.copyFormat(this.clearBorder());\n                cells[i].cellFormat.borders.right.copyFormat(this.clearBorder());\n                cells[i].cellFormat.borders.top.copyFormat(this.clearBorder());\n                cells[i].cellFormat.borders.bottom.copyFormat(this.clearBorder());\n            }\n            else {\n                cells[i].cellFormat.borders.left.copyFormat(border);\n                cells[i].cellFormat.borders.right.copyFormat(border);\n                cells[i].cellFormat.borders.top.copyFormat(border);\n                cells[i].cellFormat.borders.bottom.copyFormat(border);\n            }\n        }\n    };\n    Editor.prototype.applyInsideBorders = function (border, borderType, table) {\n        var cells = this.selection.getSelectedCells();\n        for (var i = 0; i < cells.length; i++) {\n            var cell = cells[i];\n            var isLastSelectedRow = cell.ownerRow === cells[cells.length - 1].ownerRow;\n            var isLastRightCell = (cell.columnIndex + cell.cellFormat.columnSpan - 1) === cells[cells.length - 1].columnIndex;\n            if (borderType === 'NoBorder') {\n                cell.cellFormat.borders.right.copyFormat(this.clearBorder());\n                cell.cellFormat.borders.bottom.copyFormat(this.clearBorder());\n            }\n            else {\n                if (!isLastRightCell && borderType !== 'InsideHorizontalBorder') {\n                    cell.cellFormat.borders.right.copyFormat(border);\n                }\n                if (!isLastSelectedRow && borderType !== 'InsideVerticalBorder') {\n                    cell.cellFormat.borders.bottom.copyFormat(border);\n                }\n            }\n            if (!isLastSelectedRow && borderType !== 'InsideVerticalBorder') {\n                // Apply adjacent bottom borders.\n                var nextRowIndex = cell.ownerRow.rowIndex + cell.cellFormat.rowSpan;\n                var nextRow = table.childWidgets[nextRowIndex];\n                if (nextRow) {\n                    var selectedCells = this.getAdjacentBottomBorderOnEmptyCells(nextRow, cell, true);\n                    for (var j = 0; j < selectedCells.length; j++) {\n                        if (borderType === 'NoBorder') {\n                            selectedCells[j].cellFormat.borders.top.copyFormat(this.clearBorder());\n                        }\n                        else {\n                            selectedCells[j].cellFormat.borders.top.copyFormat(border);\n                        }\n                    }\n                }\n            }\n            if (!isLastRightCell && borderType !== 'InsideHorizontalBorder') {\n                // Apply adjacent right borders.\n                var rightBorderCells = this.getSelectedCellsNextWidgets(cell, table);\n                for (var k = 0; k < rightBorderCells.length; k++) {\n                    if (borderType === 'NoBorder') {\n                        rightBorderCells[k].cellFormat.borders.left.copyFormat(this.clearBorder());\n                    }\n                    else {\n                        rightBorderCells[k].cellFormat.borders.left.copyFormat(border);\n                    }\n                }\n            }\n        }\n    };\n    /**\n     * @private\n     */\n    Editor.prototype.getTopBorderCellsOnSelection = function () {\n        var startPos = this.selection.isForward ? this.selection.start : this.selection.end;\n        var startCell = startPos.paragraph.associatedCell;\n        var topBorderCells = [];\n        var cells = this.selection.getSelectedCells();\n        for (var i = 0; i < cells.length; i++) {\n            if (cells[i].ownerRow === startCell.ownerRow) {\n                topBorderCells.push(cells[i]);\n            }\n        }\n        return topBorderCells;\n    };\n    /**\n     * @private\n     */\n    Editor.prototype.getLeftBorderCellsOnSelection = function () {\n        var startPos = this.selection.isForward ? this.selection.start : this.selection.end;\n        var startCell = startPos.paragraph.associatedCell;\n        var cells = this.selection.getSelectedCells();\n        var leftBorderCells = [];\n        for (var i = 0; i < cells.length; i++) {\n            if (cells[i].columnIndex === startCell.columnIndex) {\n                leftBorderCells.push(cells[i]);\n            }\n        }\n        return leftBorderCells;\n    };\n    /**\n     * @private\n     */\n    Editor.prototype.getRightBorderCellsOnSelection = function () {\n        var cells = this.selection.getSelectedCells();\n        var rightBorderCells = [];\n        for (var i = 0; i < cells.length; i++) {\n            if ((cells[i].columnIndex + cells[i].cellFormat.columnSpan - 1) === cells[cells.length - 1].columnIndex) {\n                rightBorderCells.push(cells[i]);\n            }\n        }\n        return rightBorderCells;\n    };\n    /**\n     * @private\n     */\n    Editor.prototype.getBottomBorderCellsOnSelection = function () {\n        var endPos = this.selection.isForward ? this.selection.end : this.selection.start;\n        var endCell = endPos.paragraph.associatedCell;\n        var cells = this.selection.getSelectedCells();\n        var bottomBorderCells = [];\n        for (var i = 0; i < cells.length; i++) {\n            if (cells[i].ownerRow === endCell.ownerRow) {\n                bottomBorderCells.push(cells[i]);\n            }\n        }\n        return bottomBorderCells;\n    };\n    /**\n     * @private\n     */\n    Editor.prototype.clearAllBorderValues = function (borders) {\n        var border = this.clearBorder();\n        borders.bottom.copyFormat(border);\n        borders.left.copyFormat(border);\n        borders.right.copyFormat(border);\n        borders.top.copyFormat(border);\n        borders.vertical.copyFormat(border);\n        borders.horizontal.copyFormat(border);\n    };\n    Editor.prototype.clearBorder = function () {\n        var border = new WBorder();\n        border.lineStyle = 'Cleared';\n        return border;\n    };\n    /**\n     * @private\n     */\n    Editor.prototype.getAdjacentCellToApplyBottomBorder = function () {\n        var cells = [];\n        var startPos = this.selection.start;\n        var endPos = this.selection.end;\n        if (!this.selection.isForward) {\n            startPos = this.selection.end;\n            endPos = this.selection.start;\n        }\n        var table = startPos.paragraph.associatedCell.ownerTable;\n        table = table.combineWidget(this.viewer);\n        var startCell = startPos.paragraph.associatedCell;\n        var endCell = endPos.paragraph.associatedCell;\n        var nextRowIndex = endCell.ownerRow.rowIndex + endCell.cellFormat.rowSpan;\n        var nextRow = table.childWidgets[nextRowIndex];\n        if (nextRow) {\n            if (endCell.cellFormat.columnSpan > 1) {\n                for (var i = endCell.columnIndex; i < endCell.columnIndex + endCell.cellFormat.columnSpan; i++) {\n                    cells.push(nextRow.childWidgets[i]);\n                }\n            }\n            else {\n                cells = this.getAdjacentBottomBorderOnEmptyCells(nextRow, endCell);\n                if (!this.selection.isEmpty) {\n                    for (var i = 0; i < nextRow.childWidgets.length; i++) {\n                        var nextCellColIndex = nextRow.childWidgets[i].columnIndex;\n                        if (nextCellColIndex >= startCell.columnIndex && nextCellColIndex <= endCell.columnIndex) {\n                            cells.push(nextRow.childWidgets[i]);\n                        }\n                    }\n                }\n            }\n        }\n        return cells;\n    };\n    Editor.prototype.getAdjacentBottomBorderOnEmptyCells = function (nextRow, cell, isSingleCell) {\n        var cells = [];\n        if (cell.cellFormat.columnSpan > 1) {\n            for (var i = cell.columnIndex; i < cell.columnIndex + cell.cellFormat.columnSpan; i++) {\n                cells.push(nextRow.childWidgets[i]);\n            }\n        }\n        else {\n            if (this.selection.isEmpty || isSingleCell) {\n                for (var i = 0; i < nextRow.childWidgets.length; i++) {\n                    if (nextRow.childWidgets[i].columnIndex === cell.columnIndex) {\n                        cells.push(nextRow.childWidgets[i]);\n                    }\n                }\n            }\n        }\n        return cells;\n    };\n    /**\n     * @private\n     */\n    Editor.prototype.getAdjacentCellToApplyRightBorder = function () {\n        var cells = [];\n        var startPosIn = this.selection.start;\n        var endPosIn = this.selection.end;\n        if (!this.selection.isForward) {\n            startPosIn = this.selection.end;\n            endPosIn = this.selection.start;\n        }\n        var table = startPosIn.paragraph.associatedCell.ownerTable;\n        table = table.combineWidget(this.viewer);\n        var startCell = startPosIn.paragraph.associatedCell;\n        var endCell = endPosIn.paragraph.associatedCell;\n        if (this.selection.isEmpty) {\n            var selectedCell = startPosIn.paragraph.associatedCell;\n            cells = this.getSelectedCellsNextWidgets(selectedCell, table);\n        }\n        else {\n            // tslint:disable-next-line:max-line-length\n            var selectedCells = this.getRightBorderCellsOnSelection();\n            for (var i = 0; i < selectedCells.length; i++) {\n                var cell = selectedCells[i];\n                cells = cells.concat(this.getSelectedCellsNextWidgets(cell, table));\n            }\n        }\n        return cells;\n    };\n    Editor.prototype.getSelectedCellsNextWidgets = function (selectedCell, table) {\n        var cells = [];\n        if (selectedCell.nextWidget) {\n            cells.push(selectedCell.nextWidget);\n        }\n        if (selectedCell.cellFormat.rowSpan > 1) {\n            var nextRowIndex = selectedCell.ownerRow.rowIndex + selectedCell.cellFormat.rowSpan;\n            for (var i = selectedCell.ownerRow.rowIndex + 1; i < nextRowIndex; i++) {\n                var nextRow = table.childWidgets[i];\n                if (nextRow) {\n                    for (var j = 0; j < nextRow.childWidgets.length; j++) {\n                        if (nextRow.childWidgets[j].columnIndex ===\n                            selectedCell.nextWidget.columnIndex) {\n                            cells.push(nextRow.childWidgets[j]);\n                        }\n                    }\n                }\n            }\n        }\n        return cells;\n    };\n    /**\n     * @private\n     */\n    Editor.prototype.getBorder = function (borderColor, lineWidth, borderStyle) {\n        var border = new WBorder();\n        border.color = borderColor || '#000000';\n        border.lineWidth = lineWidth || 1;\n        border.lineStyle = borderStyle || 'Single';\n        return border;\n    };\n    /**\n     * Applies borders\n     * @param  {WBorders} sourceBorders\n     * @param  {WBorders} applyBorders\n     * @private\n     */\n    Editor.prototype.applyBordersInternal = function (sourceBorders, applyBorders) {\n        if (!isNullOrUndefined(sourceBorders) && !isNullOrUndefined(sourceBorders)) {\n            if (!isNullOrUndefined(sourceBorders.top)) {\n                this.applyBorder(sourceBorders.top, applyBorders.top);\n            }\n            if (!isNullOrUndefined(sourceBorders.bottom)) {\n                this.applyBorder(sourceBorders.bottom, applyBorders.bottom);\n            }\n            if (!isNullOrUndefined(sourceBorders.left)) {\n                this.applyBorder(sourceBorders.left, applyBorders.left);\n            }\n            if (!isNullOrUndefined(sourceBorders.right)) {\n                this.applyBorder(sourceBorders.right, applyBorders.right);\n            }\n            if (!isNullOrUndefined(sourceBorders.horizontal)) {\n                this.applyBorder(sourceBorders.horizontal, applyBorders.horizontal);\n            }\n            if (!isNullOrUndefined(sourceBorders.vertical)) {\n                this.applyBorder(sourceBorders.vertical, applyBorders.vertical);\n            }\n            if (!isNullOrUndefined(sourceBorders.diagonalUp)) {\n                this.applyBorder(sourceBorders.diagonalUp, applyBorders.diagonalUp);\n            }\n            if (!isNullOrUndefined(sourceBorders.diagonalDown)) {\n                this.applyBorder(sourceBorders.diagonalDown, applyBorders.diagonalDown);\n            }\n        }\n    };\n    /**\n     * Apply shading to table\n     * @param  {WShading} sourceShading\n     * @param  {WShading} applyShading\n     * @private\n     */\n    Editor.prototype.applyShading = function (sourceShading, applyShading) {\n        if (!isNullOrUndefined(applyShading) && !isNullOrUndefined(sourceShading)) {\n            if (!isNullOrUndefined(applyShading.backgroundColor)\n                && sourceShading.backgroundColor !== applyShading.backgroundColor) {\n                sourceShading.backgroundColor = applyShading.backgroundColor;\n            }\n            if (!isNullOrUndefined(applyShading.foregroundColor)\n                && sourceShading.foregroundColor !== applyShading.foregroundColor) {\n                sourceShading.foregroundColor = applyShading.foregroundColor;\n            }\n            if (!isNullOrUndefined(applyShading.textureStyle)\n                && sourceShading.textureStyle !== applyShading.textureStyle) {\n                sourceShading.textureStyle = applyShading.textureStyle;\n            }\n        }\n    };\n    Editor.prototype.applyBorder = function (sourceBorder, applyBorder) {\n        if (!isNullOrUndefined(sourceBorder) && !isNullOrUndefined(applyBorder)) {\n            if (!isNullOrUndefined(applyBorder.color)\n                && sourceBorder.color !== applyBorder.color) {\n                sourceBorder.color = applyBorder.color;\n            }\n            if (!isNullOrUndefined(applyBorder.lineStyle)\n                && sourceBorder.lineStyle !== applyBorder.lineStyle) {\n                sourceBorder.lineStyle = applyBorder.lineStyle;\n            }\n            if (!isNullOrUndefined(applyBorder.lineWidth)\n                && sourceBorder.lineWidth !== applyBorder.lineWidth) {\n                sourceBorder.lineWidth = applyBorder.lineWidth;\n            }\n            if (!isNullOrUndefined(applyBorder.shadow)\n                && sourceBorder.shadow !== applyBorder.shadow) {\n                sourceBorder.shadow = applyBorder.shadow;\n            }\n            if (!isNullOrUndefined(applyBorder.space)\n                && sourceBorder.space !== applyBorder.space) {\n                sourceBorder.space = applyBorder.space;\n            }\n        }\n    };\n    /**\n     * Apply Table Format changes\n     * @param  {Selection} selection\n     * @param  {WTableFormat} format\n     * @private\n     */\n    Editor.prototype.onTableFormat = function (format) {\n        if (!isNullOrUndefined(this.selection.tableFormat)) {\n            this.viewer.owner.isShiftingEnabled = true;\n            this.editorHistory.initializeHistory('TableFormat');\n            var table = this.selection.start.paragraph.associatedCell.ownerTable.combineWidget(this.viewer);\n            this.applyTableFormat(table, undefined, format);\n            this.reLayout(this.selection, false);\n        }\n    };\n    /**\n     * @private\n     */\n    Editor.prototype.applyTableFormat = function (table, property, value) {\n        this.applyTablePropertyValue(this.viewer.selection, undefined, value, table);\n    };\n    // tslint:disable-next-line:max-line-length\n    Editor.prototype.applyTablePropertyValue = function (selection, property, value, table) {\n        var sourceFormat = table.tableFormat;\n        if (!isNullOrUndefined(this.editorHistory.currentBaseHistoryInfo)) {\n            value = this.editorHistory.currentBaseHistoryInfo.addModifiedTableProperties(sourceFormat, property, value);\n        }\n        if (value instanceof WTableFormat) {\n            if (isNullOrUndefined(property)) {\n                this.handleTableFormat(sourceFormat, value);\n            }\n            return;\n        }\n        if (property === 'preferredWidth') {\n            sourceFormat.preferredWidth = value;\n        }\n        else if (property === 'leftIndent') {\n            sourceFormat.leftIndent = value;\n        }\n        else if (property === 'tableAlignment') {\n            sourceFormat.tableAlignment = value;\n        }\n        else if (property === 'cellSpacing') {\n            sourceFormat.cellSpacing = value;\n        }\n        else if (property === 'leftMargin') {\n            sourceFormat.leftMargin = value;\n        }\n        else if (property === 'rightMargin') {\n            sourceFormat.rightMargin = value;\n        }\n        else if (property === 'topMargin') {\n            sourceFormat.topMargin = value;\n        }\n        else if (property === 'bottomMargin') {\n            sourceFormat.bottomMargin = value;\n        }\n        else if (property === 'preferredWidthType') {\n            sourceFormat.preferredWidthType = value;\n        }\n        if (property === 'shading') {\n            sourceFormat.shading = value;\n        }\n        else if (property === 'borders') {\n            sourceFormat.borders = value;\n        }\n        // if (!isNullOrUndefined(table)) {\n        //     this.layoutItemBlock(table, true);\n        // }\n    };\n    Editor.prototype.handleTableFormat = function (tableFormat, applyFormat) {\n        if (this.isBordersAndShadingDialog || this.editorHistory.isUndoing\n            || this.editorHistory.isRedoing) {\n            if (!isNullOrUndefined(tableFormat.borders)) {\n                this.applyBordersInternal(tableFormat.borders, applyFormat.borders);\n            }\n            if (!isNullOrUndefined(tableFormat.shading)) {\n                this.applyShading(tableFormat.shading, applyFormat.shading);\n            }\n        }\n        if (!this.isBordersAndShadingDialog) {\n            if (applyFormat.hasValue('preferredWidth') && applyFormat.preferredWidth !== tableFormat.preferredWidth) {\n                tableFormat.preferredWidth = applyFormat.preferredWidth;\n            }\n            if (applyFormat.hasValue('preferredWidthType') && applyFormat.preferredWidthType !== tableFormat.preferredWidthType) {\n                tableFormat.preferredWidthType = applyFormat.preferredWidthType;\n            }\n            if (applyFormat.hasValue('tableAlignment') && applyFormat.tableAlignment !== tableFormat.tableAlignment) {\n                tableFormat.tableAlignment = applyFormat.tableAlignment;\n            }\n            if (applyFormat.hasValue('leftIndent') && applyFormat.leftIndent !== tableFormat.leftIndent) {\n                tableFormat.leftIndent = applyFormat.leftIndent;\n            }\n        }\n        this.updateGridForTableDialog(tableFormat.ownerBase, false);\n    };\n    Editor.prototype.updateGridForTableDialog = function (table, shiftNextItem) {\n        if (table.tableHolder) {\n            table.updateRowIndex(0);\n            table.calculateGrid();\n            table.isGridUpdated = false;\n        }\n        this.viewer.layout.reLayoutTable(table);\n    };\n    /**\n     * Applies Row Format Changes\n     * @param  {Selection} selection\n     * @param  {WRowFormat} format\n     * @param  {WRow} row\n     * @private\n     */\n    Editor.prototype.onRowFormat = function (format) {\n        if (isNullOrUndefined(this.selection) || isNullOrUndefined(format)) {\n            return;\n        }\n        this.editorHistory.initializeHistory('RowFormat');\n        this.viewer.owner.isShiftingEnabled = true;\n        var rowStartPos = this.selection.isForward ? this.selection.start : this.selection.end;\n        var rowEndPos = this.selection.isForward ? this.selection.end : this.selection.start;\n        var table = rowStartPos.paragraph.associatedCell.ownerTable.combineWidget(this.viewer);\n        this.applyRowFormat(rowStartPos.paragraph.associatedCell.ownerRow, rowStartPos, rowEndPos, undefined, format);\n        this.reLayout(this.selection, false);\n    };\n    Editor.prototype.applyRowFormat = function (row, start, end, property, value) {\n        this.applyRowPropertyValue(this.viewer.selection, property, value, row);\n        if (end.paragraph.associatedCell.ownerRow === row) {\n            return;\n        }\n        var newRow = row.nextWidget;\n        if (!isNullOrUndefined(newRow)) {\n            this.applyRowFormat(newRow, start, end, property, value);\n        }\n    };\n    Editor.prototype.applyRowPropertyValue = function (selection, property, value, row) {\n        var applyFormat = row.rowFormat;\n        if (!isNullOrUndefined(this.editorHistory.currentBaseHistoryInfo)) {\n            value = this.editorHistory.currentBaseHistoryInfo.addModifiedRowProperties(applyFormat, property, value);\n        }\n        if (value instanceof WRowFormat) {\n            if (isNullOrUndefined(property)) {\n                this.handleRowFormat(value, applyFormat);\n            }\n            return;\n        }\n        if (property === 'heightType') {\n            applyFormat.heightType = value;\n        }\n        else if (property === 'height') {\n            applyFormat.height = value;\n        }\n        else if (property === 'isHeader') {\n            applyFormat.isHeader = value;\n        }\n        else if (property === 'allowBreakAcrossPages') {\n            applyFormat.allowBreakAcrossPages = value;\n        }\n        if (!isNullOrUndefined(row.ownerTable)) {\n            this.layoutItemBlock(row.ownerTable, true);\n        }\n    };\n    Editor.prototype.handleRowFormat = function (format, applyFormat) {\n        if (format.hasValue('allowBreakAcrossPages') && format.allowBreakAcrossPages !== applyFormat.allowBreakAcrossPages) {\n            applyFormat.allowBreakAcrossPages = format.allowBreakAcrossPages;\n        }\n        if (format.hasValue('isHeader') && format.isHeader !== applyFormat.isHeader) {\n            applyFormat.isHeader = format.isHeader;\n        }\n        if (format.hasValue('heightType') && format.heightType !== applyFormat.heightType) {\n            applyFormat.heightType = format.heightType;\n        }\n        if (format.hasValue('height') && format.height !== applyFormat.height) {\n            applyFormat.height = format.height;\n        }\n        this.updateGridForTableDialog(applyFormat.ownerBase.ownerTable, true);\n    };\n    /**\n     * Applies Cell Format changes\n     * @param  {Selection} selection\n     * @param  {WCellFormat} format\n     * @param  {WCell} cell\n     * @private\n     */\n    Editor.prototype.onCellFormat = function (format) {\n        if (isNullOrUndefined(this.selection) || isNullOrUndefined(format)) {\n            return;\n        }\n        this.editorHistory.initializeHistory('CellFormat');\n        this.updateFormatForCell(this.selection, undefined, format);\n        this.reLayout(this.selection, false);\n    };\n    /**\n     * @private\n     */\n    Editor.prototype.updateCellMargins = function (selection, value) {\n        var cellStartPosition = selection.start;\n        var cellEndPosition = selection.end;\n        if (!selection.isForward) {\n            cellStartPosition = selection.end;\n            cellEndPosition = selection.start;\n        }\n        this.initHistoryPosition(selection, cellStartPosition);\n        // tslint:disable-next-line:max-line-length\n        this.viewer.owner.cellOptionsDialogModule.applyCellmarginsValue(cellStartPosition.paragraph.associatedCell.ownerRow, cellStartPosition, cellEndPosition, value);\n    };\n    /**\n     * @private\n     */\n    Editor.prototype.updateFormatForCell = function (selection, property, value) {\n        var start = selection.start;\n        var end = selection.end;\n        if (!selection.isForward) {\n            start = selection.end;\n            end = selection.start;\n        }\n        var startCell = start.paragraph.associatedCell;\n        var endCell = end.paragraph.associatedCell;\n        var cells;\n        var table = startCell.ownerTable.combineWidget(this.viewer);\n        var appliedFormat;\n        for (var k = startCell.columnIndex; k <= endCell.columnIndex; k++) {\n            cells = this.getSelectedCellInColumn(startCell.ownerTable, startCell.ownerRow.rowIndex, k, endCell.ownerRow.rowIndex);\n            for (var i = 0; i < cells.length; i++) {\n                appliedFormat = this.applyCellPropertyValue(this.viewer.selection, property, value, cells[i].cellFormat);\n            }\n        }\n        this.updateGridForTableDialog(table, false);\n    };\n    /**\n     * @private\n     */\n    Editor.prototype.getSelectedCellInColumn = function (table, rowStartIndex, columnIndex, rowEndIndex) {\n        var cells = [];\n        for (var i = rowStartIndex; i <= rowEndIndex; i++) {\n            var row = table.childWidgets[i];\n            for (var j = 0; j < row.childWidgets.length; j++) {\n                if (row.childWidgets[j].columnIndex === columnIndex) {\n                    cells.push(row.childWidgets[j]);\n                }\n            }\n        }\n        return cells;\n    };\n    Editor.prototype.getColumnCells = function (table, columnIndex, isLeftSideCollection) {\n        var cells = [];\n        for (var k = 0; k < table.childWidgets.length; k++) {\n            var row = table.childWidgets[k];\n            for (var i = 0; i < row.childWidgets.length; i++) {\n                var cell = row.childWidgets[i];\n                if (isLeftSideCollection) {\n                    if (cell.columnIndex + cell.cellFormat.columnSpan === columnIndex) {\n                        cells.push(cell);\n                    }\n                }\n                else {\n                    if (cell.columnIndex === columnIndex) {\n                        cells.push(cell);\n                    }\n                }\n            }\n        }\n        return cells;\n    };\n    /**\n     * @private\n     */\n    Editor.prototype.getTableWidth = function (table) {\n        if (table.tableFormat.preferredWidth !== 0 || table.tableFormat.preferredWidthType === 'Percent') {\n            if (table.tableFormat.preferredWidthType === 'Auto' || table.tableFormat.preferredWidthType === 'Point') {\n                return table.tableFormat.preferredWidth;\n            }\n            else {\n                if (table.tableFormat.preferredWidth === 0) {\n                    return 0;\n                }\n                else {\n                    return HelperMethods.convertPixelToPoint(this.viewer.clientArea.width) / 100 * table.tableFormat.preferredWidth;\n                }\n            }\n        }\n        return HelperMethods.convertPixelToPoint(this.viewer.layout.getTableWidth(table));\n    };\n    Editor.prototype.applyCellPropertyValue = function (selection, property, value, applyFormat) {\n        if (!isNullOrUndefined(this.editorHistory.currentBaseHistoryInfo)) {\n            value = this.editorHistory.currentBaseHistoryInfo.addModifiedCellProperties(applyFormat, property, value);\n        }\n        if (value instanceof WCellFormat) {\n            if (isNullOrUndefined(property)) {\n                this.handleCellFormat(value, applyFormat);\n            }\n            return value;\n        }\n        if (property === 'leftMargin') {\n            applyFormat.leftMargin = value;\n        }\n        else if (property === 'topMargin') {\n            applyFormat.topMargin = value;\n        }\n        else if (property === 'rightMargin') {\n            applyFormat.rightMargin = value;\n        }\n        else if (property === 'bottomMargin') {\n            applyFormat.bottomMargin = value;\n        }\n        else if (property === 'preferredWidth') {\n            applyFormat.preferredWidth = value;\n            applyFormat.cellWidth = value;\n        }\n        else if (property === 'cellWidth') {\n            applyFormat.cellWidth = value;\n        }\n        else if (property === 'columnSpan') {\n            applyFormat.columnSpan = value;\n        }\n        else if (property === 'rowSpan') {\n            applyFormat.rowSpan = value;\n        }\n        else if (property === 'preferredWidthType') {\n            applyFormat.preferredWidthType = value;\n        }\n        else if (property === 'verticalAlignment') {\n            applyFormat.verticalAlignment = value;\n        }\n        if (property === 'shading') {\n            applyFormat.shading = value;\n        }\n        else if (property === 'borders') {\n            applyFormat.borders = value;\n        }\n        return undefined;\n    };\n    Editor.prototype.handleCellFormat = function (cellFormat, applyFormat) {\n        if (!isNullOrUndefined(cellFormat) && !isNullOrUndefined(applyFormat)) {\n            if (this.isBordersAndShadingDialog) {\n                if (!isNullOrUndefined(cellFormat.borders)) {\n                    this.applyBordersInternal(applyFormat.borders, cellFormat.borders);\n                }\n                if (!isNullOrUndefined(cellFormat.shading)) {\n                    this.applyShading(applyFormat.shading, cellFormat.shading);\n                }\n                // this.layoutRow((applyFormat.ownerBase as TableCellWidget).ownerRow, this.viewer, false);\n            }\n            else {\n                if (cellFormat.hasValue('preferredWidth') && applyFormat.preferredWidth !== cellFormat.preferredWidth) {\n                    applyFormat.preferredWidth = cellFormat.preferredWidth;\n                }\n                if (cellFormat.hasValue('preferredWidthType') && applyFormat.preferredWidthType !== cellFormat.preferredWidthType) {\n                    applyFormat.preferredWidthType = cellFormat.preferredWidthType;\n                }\n                if (cellFormat.hasValue('verticalAlignment') && applyFormat.verticalAlignment !== cellFormat.verticalAlignment) {\n                    applyFormat.verticalAlignment = cellFormat.verticalAlignment;\n                }\n            }\n        }\n    };\n    /**\n     * @private\n     */\n    Editor.prototype.destroy = function () {\n        this.viewer = undefined;\n        this.nodes = [];\n    };\n    Editor.prototype.isTocField = function (element) {\n        if (element instanceof FieldElementBox) {\n            var nextElement = element.nextNode;\n            if (element instanceof FieldElementBox && element.fieldType === 0 && nextElement instanceof TextElementBox\n                && nextElement.text.trim().toLowerCase().indexOf('toc') === 0) {\n                return true;\n            }\n        }\n        return false;\n    };\n    /**\n     * Updates the table of contents.\n     * @private\n     */\n    Editor.prototype.updateToc = function (tocField) {\n        if (isNullOrUndefined(tocField)) {\n            tocField = this.selection.getTocFieldInternal();\n        }\n        if (!this.isTocField(tocField)) {\n            return;\n        }\n        // Decode field code to get parameters\n        var code = this.selection.getFieldCode(tocField);\n        if (code.toLocaleLowerCase().indexOf('toc') !== -1) {\n            this.insertTableOfContents(this.validateTocSettings(this.getTocSettings(code, tocField)));\n        }\n    };\n    Editor.prototype.getTocSettings = function (code, tocField) {\n        var tocSettings = {};\n        tocSettings.includePageNumber = true;\n        tocSettings.rightAlign = true;\n        // Decode field code to get parameters\n        if (code.toLowerCase() === 'toc \\\\mergeformat') {\n            tocSettings.startLevel = 1;\n            tocSettings.endLevel = 3;\n        }\n        else {\n            var swtiches = code.split('\\\\');\n            for (var i = 0; i < swtiches.length; i++) {\n                var swtch = swtiches[i];\n                if (swtch.length === 0) {\n                    continue;\n                }\n                switch (swtch[0]) {\n                    case 'o':\n                        if (!isNullOrUndefined(swtch.match(/\\d+/g))) {\n                            var levels = swtch.match(/\\d+/g).map(Number);\n                            tocSettings.startLevel = levels[0];\n                            tocSettings.endLevel = levels[1];\n                        }\n                        else {\n                            tocSettings.startLevel = 1;\n                            tocSettings.endLevel = 9;\n                        }\n                        break;\n                    case 'h':\n                        tocSettings.includeHyperlink = true;\n                        break;\n                    case 'n':\n                        tocSettings.includePageNumber = false;\n                        break;\n                    case 'p':\n                        tocSettings.rightAlign = false;\n                        break;\n                    case 'u':\n                        tocSettings.includeOutlineLevels = true;\n                        break;\n                    case 't':\n                        this.decodeTSwitch(tocSettings, swtch);\n                        break;\n                }\n            }\n        }\n        //assigns tab leader.\n        var tabs = tocField.paragraph.paragraphFormat.getUpdatedTabs();\n        if (tabs.length > 0) {\n            tocSettings.tabLeader = tabs[tabs.length - 1].tabLeader;\n        }\n        if (tocSettings.rightAlign && isNullOrUndefined(tocSettings.tabLeader)) {\n            tocSettings.tabLeader = 'Dot';\n        }\n        return tocSettings;\n    };\n    Editor.prototype.decodeTSwitch = function (tocSettings, tSwitch) {\n        tocSettings.levelSettings = {};\n        tSwitch = tSwitch.replace('t', '');\n        tSwitch = tSwitch.replace('\"', '');\n        tSwitch = tSwitch.replace('\"', '');\n        tSwitch = tSwitch.trim();\n        var levels = tSwitch.split(',');\n        for (var index = 0; index < levels.length; index++) {\n            tocSettings.levelSettings[levels[index]] = parseInt(levels[index + 1], 10);\n            index++;\n        }\n    };\n    /**\n     * Inserts, modifies or updates the table of contents based on given settings.\n     * @param {TableOfContentsSettings} tableOfContentsSettings\n     */\n    Editor.prototype.insertTableOfContents = function (tableOfContentsSettings) {\n        this.isInsertingTOC = true;\n        this.initComplexHistory('TOC');\n        if (isNullOrUndefined(tableOfContentsSettings)) {\n            //Initializes with default value.\n            tableOfContentsSettings = {};\n            tableOfContentsSettings.startLevel = 1;\n            tableOfContentsSettings.endLevel = 3;\n            tableOfContentsSettings.includeHyperlink = true;\n            tableOfContentsSettings.includeOutlineLevels = true;\n            tableOfContentsSettings.includePageNumber = true;\n            tableOfContentsSettings.rightAlign = true;\n            tableOfContentsSettings.tabLeader = 'Dot';\n        }\n        var tocField = undefined;\n        var code = undefined;\n        if (this.selection.contextType === 'TableOfContents') {\n            tocField = this.selection.getTocFieldInternal();\n        }\n        if (tocField instanceof FieldElementBox) {\n            this.selection.start.setPositionForSelection(tocField.line, tocField, 0, this.selection.start.location);\n            this.selection.end.setPositionForSelection(tocField.fieldEnd.line, tocField.fieldEnd, 2, this.selection.end.location);\n            this.onDelete();\n        }\n        // Build TOC field code based on parameter\n        code = this.constructTocFieldCode(tableOfContentsSettings);\n        var isStartParagraph = this.selection.start.isAtParagraphStart;\n        var blockInfo = this.getParagraphInfo(this.selection.start);\n        var initialStart = this.getHierarchicalIndex(blockInfo.paragraph, blockInfo.offset.toString());\n        // Build TOC fields\n        // tslint:disable-next-line:max-line-length\n        var widgets = this.buildToc(this.validateTocSettings(tableOfContentsSettings), code, true, isStartParagraph);\n        if (widgets.length > 0) {\n            var tocLastPara = new ParagraphWidget();\n            var tocLastLine = new LineWidget(tocLastPara);\n            tocLastPara.childWidgets.push(tocLastLine);\n            var index = 0;\n            if (!isStartParagraph) {\n                index = 1;\n            }\n            var line = widgets[index].childWidgets[0];\n            var fieldBegin = line.children[0];\n            this.appendEndField(fieldBegin, tocLastLine);\n            widgets.push(tocLastPara);\n            this.appendEmptyPara(widgets);\n        }\n        this.setPositionForCurrentIndex(this.selection.start, initialStart);\n        this.selection.end.setPositionInternal(this.selection.start);\n        this.pasteContentsInternal(widgets);\n        this.isInsertingTOC = false;\n        this.updatePageRef();\n        if (this.editorHistory) {\n            this.editorHistory.updateComplexHistoryInternal();\n        }\n    };\n    Editor.prototype.appendEmptyPara = function (widgets) {\n        var emptyPara = new ParagraphWidget();\n        var emptyLine = new LineWidget(emptyPara);\n        emptyPara.childWidgets.push(emptyLine);\n        widgets.push(emptyPara);\n    };\n    Editor.prototype.constructTocFieldCode = function (tocSettings) {\n        var tocFieldCode = 'TOC';\n        //appends styles level\n        // tslint:disable-next-line:max-line-length\n        if (!isNullOrUndefined(tocSettings.startLevel) && tocSettings.startLevel !== 0 && !isNullOrUndefined(tocSettings.endLevel) && tocSettings.endLevel !== 0) {\n            tocFieldCode = tocFieldCode + ' \\\\o \"' + tocSettings.startLevel + '-' + tocSettings.endLevel + '\"';\n        }\n        if (tocSettings.includePageNumber && !tocSettings.rightAlign) {\n            tocFieldCode = tocFieldCode + ' \\\\p \" \"';\n        }\n        if (!tocSettings.includePageNumber) {\n            tocFieldCode = tocFieldCode + ' \\\\n';\n        }\n        if (tocSettings.includeHyperlink) {\n            tocFieldCode = tocFieldCode + ' \\\\h \\\\z';\n        }\n        if (tocSettings.includeOutlineLevels) {\n            tocFieldCode = tocFieldCode + ' \\\\u';\n        }\n        var tSwitch = this.constructTSwitch(tocSettings);\n        if (tSwitch.length > 6) {\n            tocFieldCode = tocFieldCode + tSwitch;\n        }\n        return tocFieldCode;\n    };\n    Editor.prototype.constructTSwitch = function (tocSettings) {\n        var tSwitch = '';\n        var prefix = ' \\\\t ';\n        if (!isNullOrUndefined(tocSettings.levelSettings)) {\n            for (var _i = 0, _a = Object.keys(tocSettings.levelSettings); _i < _a.length; _i++) {\n                var key = _a[_i];\n                tSwitch = tSwitch + key + ',' + tocSettings.levelSettings[key].toString() + ',';\n            }\n        }\n        tSwitch = tSwitch.slice(0, -1);\n        tSwitch = prefix + '\"' + tSwitch + '\"';\n        return tSwitch;\n    };\n    /**\n     * Appends the end filed to the given line.\n     */\n    Editor.prototype.appendEndField = function (fieldBegin, lineWidget) {\n        var fieldEnd = new FieldElementBox(1);\n        fieldEnd.fieldSeparator = fieldBegin.fieldSeparator;\n        fieldBegin.fieldSeparator.fieldEnd = fieldEnd;\n        fieldEnd.fieldBegin = fieldBegin;\n        fieldEnd.fieldBegin.fieldEnd = fieldEnd;\n        fieldEnd.line = lineWidget;\n        lineWidget.children.push(fieldEnd);\n    };\n    Editor.prototype.validateTocSettings = function (tocSettings) {\n        if (isNullOrUndefined(tocSettings.startLevel) || tocSettings.startLevel < 1) {\n            tocSettings.startLevel = 1;\n        }\n        if (isNullOrUndefined(tocSettings.endLevel) || tocSettings.endLevel < tocSettings.endLevel) {\n            tocSettings.endLevel = tocSettings.startLevel > 3 ? tocSettings.startLevel : 3;\n        }\n        if (isNullOrUndefined(tocSettings.includeHyperlink)) {\n            tocSettings.includeHyperlink = false;\n        }\n        if (isNullOrUndefined(tocSettings.includePageNumber)) {\n            tocSettings.includePageNumber = false;\n        }\n        if (isNullOrUndefined(tocSettings.rightAlign)) {\n            tocSettings.rightAlign = false;\n        }\n        if (isNullOrUndefined(tocSettings.levelSettings)) {\n            tocSettings.levelSettings = {};\n        }\n        return tocSettings;\n    };\n    /**\n     * Builds the TOC\n     * @private\n     */\n    // tslint:disable-next-line:max-line-length\n    Editor.prototype.buildToc = function (tocSettings, fieldCode, isFirstPara, isStartParagraph) {\n        var tocDomBody = this.viewer.pages[0].bodyWidgets[0];\n        var widgets = [];\n        this.createHeadingLevels(tocSettings);\n        if (tocSettings.includeOutlineLevels) {\n            this.createOutlineLevels(tocSettings);\n        }\n        var widget = tocDomBody.childWidgets[0];\n        while (widget !== undefined) {\n            // tslint:disable-next-line:max-line-length\n            if (widget instanceof ParagraphWidget && (this.isHeadingStyle(widget) || (tocSettings.includeOutlineLevels && this.isOutlineLevelStyle(widget)))) {\n                var bookmarkName = this.insertTocBookmark(widget);\n                // tslint:disable-next-line:max-line-length\n                this.createTOCWidgets(widget, widgets, fieldCode, bookmarkName, tocSettings, isFirstPara, isStartParagraph);\n                isFirstPara = false;\n            }\n            widget = this.selection.getNextParagraphBlock(widget);\n        }\n        this.tocStyles = {};\n        return widgets;\n    };\n    Editor.prototype.createOutlineLevels = function (settings) {\n        for (var i = settings.startLevel; i <= settings.endLevel; i++) {\n            var levelStyle = 'Level' + i.toString();\n            if (isNullOrUndefined(this.tocStyles[levelStyle])) {\n                this.tocStyles[levelStyle] = i;\n            }\n        }\n    };\n    /**\n     * Creates TOC heading styles\n     * @param start - lower heading level\n     * @param end - higher heading level\n     */\n    Editor.prototype.createHeadingLevels = function (settings) {\n        var normalStyle = 'Normal';\n        for (var i = settings.startLevel; i <= settings.endLevel; i++) {\n            var headingStyle = 'Heading ' + i.toString();\n            if (isNullOrUndefined(this.tocStyles[headingStyle])) {\n                this.tocStyles[headingStyle] = i;\n            }\n        }\n        if (!isNullOrUndefined(settings.levelSettings)) {\n            for (var _i = 0, _a = Object.keys(settings.levelSettings); _i < _a.length; _i++) {\n                var key = _a[_i];\n                this.tocStyles[key] = settings.levelSettings[key];\n            }\n        }\n    };\n    /**\n     * Checks the current style is heading style.\n     */\n    Editor.prototype.isHeadingStyle = function (para) {\n        var style = para.paragraphFormat.baseStyle;\n        if (style !== undefined) {\n            return isNullOrUndefined(this.tocStyles[style.name]) ? false : true;\n        }\n        return false;\n    };\n    Editor.prototype.isOutlineLevelStyle = function (para) {\n        var styleName = para.paragraphFormat.outlineLevel;\n        return isNullOrUndefined(this.tocStyles[styleName]) ? false : true;\n    };\n    /**\n     * Creates TOC field element.\n     */\n    Editor.prototype.createTocFieldElement = function (lineWidget, fieldCode) {\n        //begin\n        var fieldBegin = new FieldElementBox(0);\n        fieldBegin.hasFieldEnd = true;\n        fieldBegin.line = lineWidget;\n        lineWidget.children.push(fieldBegin);\n        //format toc\n        var textElement = new TextElementBox();\n        textElement.text = fieldCode;\n        textElement.line = lineWidget;\n        lineWidget.children.push(textElement);\n        //field separator\n        var fieldSeparator = new FieldElementBox(2);\n        fieldSeparator.fieldBegin = fieldBegin;\n        fieldSeparator.fieldBegin.fieldSeparator = fieldSeparator;\n        fieldSeparator.line = lineWidget;\n        lineWidget.children.push(fieldSeparator);\n        return fieldBegin;\n    };\n    /**\n     * Updates TOC para\n     */\n    // tslint:disable-next-line:max-line-length\n    Editor.prototype.createTOCWidgets = function (widget, widgets, fieldCode, bookmarkName, tocSettings, isFirstPara, isStartParagraph) {\n        var fieldBegin = undefined;\n        var tocPara = undefined;\n        var tocLine = undefined;\n        // tslint:disable-next-line:max-line-length\n        if (widgets.length === 1 && widgets[0].childWidgets[0].children.length === 3 && !isNullOrUndefined(isFirstPara) && !isFirstPara) {\n            tocLine = widgets[0].childWidgets[0];\n        }\n        else {\n            tocPara = new ParagraphWidget();\n            var styleName = undefined;\n            //Adds toc syles into paragraph\n            var headingStyleName = widget.paragraphFormat.baseStyle.name;\n            if (tocSettings.includeOutlineLevels && isNullOrUndefined(this.tocStyles[headingStyleName])) {\n                styleName = widget.paragraphFormat.outlineLevel;\n            }\n            else {\n                styleName = headingStyleName;\n            }\n            var tocStyleName = 'Toc' + this.tocStyles[styleName];\n            var paraStyle = this.viewer.styles.findByName(tocStyleName, 'Paragraph');\n            if (isNullOrUndefined(paraStyle)) {\n                // tslint:disable-next-line:max-line-length\n                this.viewer.owner.parser.parseStyle(JSON.parse(this.getCompleteStyles()), JSON.parse(this.viewer.preDefinedStyles.get(tocStyleName)), this.viewer.styles);\n                paraStyle = this.viewer.styles.findByName(tocStyleName, 'Paragraph');\n            }\n            tocPara.paragraphFormat.ApplyStyle(paraStyle);\n            //Creates right tab for page number.\n            if (tocSettings.rightAlign && tocSettings.includePageNumber) {\n                var tabStop = new WTabStop();\n                tabStop.position = HelperMethods.convertPixelToPoint(this.viewer.clientArea.width);\n                tabStop.tabLeader = tocSettings.tabLeader;\n                tabStop.deletePosition = 0;\n                tabStop.tabJustification = 'Right';\n                tocPara.paragraphFormat.tabs.push(tabStop);\n            }\n            tocLine = new LineWidget(tocPara);\n            tocPara.childWidgets.push(tocLine);\n        }\n        //creates toc field element if it is insert\n        if ((isFirstPara !== undefined) && isFirstPara) {\n            if (!isNullOrUndefined(isStartParagraph) && !isStartParagraph) {\n                this.appendEmptyPara(widgets);\n            }\n            this.createTocFieldElement(tocLine, fieldCode);\n        }\n        var text = '';\n        for (var lineIndex = 0; lineIndex < widget.childWidgets.length; lineIndex++) {\n            var lineWidget = widget.childWidgets[lineIndex];\n            for (var elementIndex = 0; elementIndex < lineWidget.children.length; elementIndex++) {\n                var element = lineWidget.children[elementIndex];\n                if (element instanceof TextElementBox || element instanceof ListTextElementBox) {\n                    var temp = element.text;\n                    var tabChar = '\\t';\n                    if (temp.indexOf(tabChar) !== -1) {\n                        temp = temp.replace(new RegExp(tabChar, 'g'), ' ');\n                    }\n                    text = text + temp;\n                }\n            }\n        }\n        if (text !== '') {\n            // inserts hyperlink\n            if (tocSettings.includeHyperlink && (bookmarkName !== undefined)) {\n                fieldBegin = this.insertTocHyperlink(tocLine, bookmarkName, text);\n            }\n            else {\n                var span = new TextElementBox();\n                span.text = text;\n                span.line = tocLine;\n                tocLine.children.push(span);\n            }\n            //inserts page number\n            if (tocSettings.includePageNumber && (bookmarkName !== undefined)) {\n                if (tocSettings.rightAlign) {\n                    var tabText = new TabElementBox();\n                    tabText.text = '\\t';\n                    tabText.line = tocLine;\n                    tocLine.children.push(tabText);\n                }\n                var pageField = this.insertTocPageNumber(bookmarkName, tocLine, tocSettings.rightAlign, widget);\n                this.appendEndField(pageField, tocLine);\n            }\n            if (tocSettings.includeHyperlink && fieldBegin !== undefined) {\n                this.appendEndField(fieldBegin, tocLine);\n            }\n        }\n        if (!isNullOrUndefined(tocPara) && (text !== '' || isFirstPara)) {\n            widgets.push(tocPara);\n        }\n    };\n    /**\n     * Inserts toc hyperlink.\n     */\n    Editor.prototype.insertTocHyperlink = function (lineWidget, bookmarkName, text) {\n        var fieldCode = ' HYPERLINK \\\\l \\\"' + bookmarkName + '\\\" ';\n        var fieldBegin = this.createTocFieldElement(lineWidget, fieldCode);\n        //text element.\n        var span = new TextElementBox();\n        span.text = text;\n        span.line = lineWidget;\n        lineWidget.children.push(span);\n        return fieldBegin;\n    };\n    /**\n     * Inserts toc page number.\n     */\n    // tslint:disable-next-line:max-line-length\n    Editor.prototype.insertTocPageNumber = function (bookMarkname, lineWidget, isRightAlign, widget) {\n        var fieldCode = ' PAGEREF' + bookMarkname + ' \\\\h ';\n        var fieldBegin = this.createTocFieldElement(lineWidget, fieldCode);\n        var text = (this.viewer.pages.indexOf(widget.bodyWidget.page) + 1).toString();\n        //text element.\n        var span = new FieldTextElementBox();\n        span.fieldBegin = fieldBegin;\n        if (!isRightAlign) {\n            text = ' ' + text;\n        }\n        span.text = text;\n        span.line = lineWidget;\n        lineWidget.children.push(span);\n        this.pageRefFields[bookMarkname] = span;\n        return fieldBegin;\n    };\n    Editor.prototype.updatePageRef = function () {\n        for (var _i = 0, _a = Object.keys(this.pageRefFields); _i < _a.length; _i++) {\n            var key = _a[_i];\n            var bookmark = this.viewer.bookmarks.get(key);\n            var pageRef = (bookmark.paragraph.bodyWidget.page.index + 1).toString();\n            var span = this.pageRefFields[key];\n            if (pageRef !== span.text) {\n                span.text = pageRef;\n                var paragraph = span.paragraph;\n                var lineIndex = paragraph.childWidgets.indexOf(span.line);\n                var elementIndex = span.line.children.indexOf(span);\n                this.viewer.layout.reLayoutParagraph(paragraph, lineIndex, elementIndex);\n            }\n        }\n    };\n    /**\n     * Inserts toc bookmark.\n     */\n    Editor.prototype.insertTocBookmark = function (widget) {\n        var bookmarkName = undefined;\n        var lineLength = widget.childWidgets.length;\n        if (lineLength > 0) {\n            var startLine = widget.childWidgets[0];\n            var endLine = widget.childWidgets[lineLength - 1];\n            if ((startLine !== undefined) && (endLine !== undefined)) {\n                var startElement = startLine.children[0];\n                //Returns the bookmark if already present for paragraph.\n                // tslint:disable-next-line:max-line-length\n                if (!isNullOrUndefined(startElement) && startElement instanceof BookmarkElementBox && startElement.bookmarkType === 0 && (startElement.name.toLowerCase().match('^_toc'))) {\n                    return startElement.name;\n                }\n                var endElement = endLine.children[endLine.children.length - 1];\n                if ((startElement !== undefined) && (endElement !== undefined)) {\n                    this.selection.start.setPositionForSelection(startLine, startElement, 0, this.selection.start.location);\n                    this.selection.end.setPositionForSelection(endLine, endElement, endElement.length, this.selection.end.location);\n                    bookmarkName = this.generateBookmarkName();\n                    this.insertBookmark(bookmarkName);\n                }\n            }\n        }\n        return bookmarkName;\n    };\n    /**\n     * Generates bookmark id.\n     */\n    Editor.prototype.generateBookmarkName = function () {\n        this.tocBookmarkId++;\n        var count = 10 - this.tocBookmarkId.toString().length;\n        var formatString = '';\n        while (count - 1 > 0) {\n            formatString = '0' + formatString;\n            count--;\n        }\n        var bookmarkName = '_Toc' + formatString + this.tocBookmarkId;\n        return bookmarkName;\n    };\n    /**\n     * Change cell content alignment\n     * @private\n     */\n    Editor.prototype.onCellContentAlignment = function (verticalAlignment, textAlignment) {\n        this.owner.isShiftingEnabled = true;\n        var selection = this.owner.selection;\n        if (selection.isEmpty && selection.start.paragraph.isInsideTable) {\n            if (this.owner.editorHistory) {\n                this.owner.editorHistory.initComplexHistory(selection, 'MultiSelection');\n            }\n            //Selecting the table cell to update the all the paragraph format.\n            selection.selectTableCell();\n            this.initHistory('CellContentVerticalAlignment');\n            var cellFormat = selection.start.paragraph.associatedCell.cellFormat;\n            this.applyCellPropertyValue(selection, 'verticalAlignment', verticalAlignment, cellFormat);\n            this.reLayout(selection, false);\n            this.initHistory('TextAlignment');\n            this.updateParagraphFormat('textAlignment', textAlignment, false);\n            this.reLayout(this.owner.selection, false);\n            if (this.owner.editorHistory) {\n                this.owner.editorHistory.updateComplexHistory();\n            }\n        }\n        else {\n            if (this.owner.editorHistory) {\n                this.owner.editorHistory.initComplexHistory(selection, 'MultiSelection');\n            }\n            if (!isNullOrUndefined(selection.getTable(selection.start, selection.end))) {\n                //Table cell vertical alignment.\n                this.updateSelectionTableFormat(selection, 'CellContentVerticalAlignment', verticalAlignment);\n                this.reLayout(this.owner.selection, false);\n                this.initHistory('TextAlignment');\n                //Paragraph text alignment.\n                this.updateSelectionParagraphFormatting('textAlignment', textAlignment, false);\n                this.reLayout(selection, false);\n            }\n            if (this.owner.editorHistory) {\n                this.owner.editorHistory.updateComplexHistory();\n            }\n        }\n    };\n    return Editor;\n}());\nexport { Editor };\n","import { WTableHolder } from '../viewer/page';\n/**\n * @private\n */\nvar ModifiedLevel = /** @class */ (function () {\n    function ModifiedLevel(owner, modified) {\n        this.ownerListLevelIn = undefined;\n        this.modifiedListLevelIn = undefined;\n        this.ownerListLevel = owner;\n        this.modifiedListLevel = modified;\n    }\n    Object.defineProperty(ModifiedLevel.prototype, \"ownerListLevel\", {\n        /**\n         * @private\n         */\n        get: function () {\n            return this.ownerListLevelIn;\n        },\n        /**\n         * @private\n         */\n        set: function (value) {\n            this.ownerListLevelIn = value;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(ModifiedLevel.prototype, \"modifiedListLevel\", {\n        /**\n         * @private\n         */\n        get: function () {\n            return this.modifiedListLevelIn;\n        },\n        /**\n         * @private\n         */\n        set: function (value) {\n            this.modifiedListLevelIn = value;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    /**\n     * @private\n     */\n    ModifiedLevel.prototype.destroy = function () {\n        this.ownerListLevel = undefined;\n        this.modifiedListLevel = undefined;\n    };\n    return ModifiedLevel;\n}());\nexport { ModifiedLevel };\n/**\n * @private\n */\nvar ModifiedParagraphFormat = /** @class */ (function () {\n    function ModifiedParagraphFormat(ownerFormat, modifiedFormat) {\n        this.ownerFormatIn = undefined;\n        this.modifiedFormatIn = undefined;\n        this.ownerFormat = ownerFormat;\n        this.modifiedFormat = modifiedFormat;\n    }\n    Object.defineProperty(ModifiedParagraphFormat.prototype, \"ownerFormat\", {\n        /**\n         * @private\n         */\n        get: function () {\n            return this.ownerFormatIn;\n        },\n        /**\n         * @private\n         */\n        set: function (value) {\n            this.ownerFormatIn = value;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(ModifiedParagraphFormat.prototype, \"modifiedFormat\", {\n        /**\n         * hidden\n         */\n        get: function () {\n            return this.modifiedFormatIn;\n        },\n        /**\n         * @private\n         */\n        set: function (value) {\n            this.modifiedFormatIn = value;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    /**\n     * @private\n     */\n    ModifiedParagraphFormat.prototype.destroy = function () {\n        this.ownerFormat = undefined;\n        this.modifiedFormat.destroy();\n        this.modifiedFormat = undefined;\n    };\n    return ModifiedParagraphFormat;\n}());\nexport { ModifiedParagraphFormat };\n/**\n * @private\n */\nvar RowHistoryFormat = /** @class */ (function () {\n    function RowHistoryFormat(startingPoint, rowFormat) {\n        this.startingPoint = startingPoint;\n        this.rowFormat = rowFormat;\n        this.rowHeightType = rowFormat.heightType;\n    }\n    RowHistoryFormat.prototype.revertChanges = function (isRedo, owner) {\n        //backup current format values.\n        var currentRowHeightType = this.rowFormat.heightType;\n        //Restore old values.\n        owner.editorModule.tableResize.updateRowHeight(this.rowFormat.ownerBase, isRedo ? this.displacement : (-this.displacement));\n        owner.viewer.layout.reLayoutTable(this.rowFormat.ownerBase.ownerTable);\n        if (this.rowFormat.heightType !== this.rowHeightType) {\n            this.rowFormat.heightType = this.rowHeightType;\n        }\n        //backup the current format values for redo.\n        this.rowHeightType = currentRowHeightType;\n    };\n    return RowHistoryFormat;\n}());\nexport { RowHistoryFormat };\n/**\n * @private\n */\nvar TableHistoryInfo = /** @class */ (function () {\n    function TableHistoryInfo(table, owner) {\n        this.tableHolder = new WTableHolder();\n        this.tableFormat = new TableFormatHistoryInfo();\n        this.rows = [];\n        this.owner = owner;\n        this.copyProperties(table);\n    }\n    TableHistoryInfo.prototype.copyProperties = function (table) {\n        if (table.tableHolder) {\n            this.tableHolder = table.tableHolder.clone();\n        }\n        if (table.tableFormat) {\n            this.tableFormat.leftIndent = table.tableFormat.leftIndent;\n            this.tableFormat.preferredWidth = table.tableFormat.preferredWidth;\n            this.tableFormat.preferredWidthType = table.tableFormat.preferredWidthType;\n        }\n        for (var i = 0; i < table.childWidgets.length; i++) {\n            var row = table.childWidgets[i];\n            var rowFormat = new RowFormatHistoryInfo();\n            rowFormat.gridBefore = row.rowFormat.gridBefore;\n            rowFormat.gridBeforeWidth = row.rowFormat.gridBeforeWidth;\n            rowFormat.gridBeforeWidthType = row.rowFormat.gridBeforeWidthType;\n            rowFormat.gridAfter = row.rowFormat.gridAfter;\n            rowFormat.gridAfterWidth = row.rowFormat.gridAfterWidth;\n            rowFormat.gridAfterWidthType = row.rowFormat.gridAfterWidthType;\n            for (var j = 0; j < row.childWidgets.length; j++) {\n                var cell = row.childWidgets[j];\n                var cellFormat = new CellFormatHistoryInfo();\n                cellFormat.columnIndex = cell.columnIndex;\n                cellFormat.columnSpan = cell.cellFormat.columnSpan;\n                cellFormat.preferredWidth = cell.cellFormat.preferredWidth;\n                cellFormat.preferredWidthType = cell.cellFormat.preferredWidthType;\n                rowFormat.cells.push(cellFormat);\n            }\n            this.rows.push(rowFormat);\n        }\n        this.tableHierarchicalIndex = this.owner.editorModule.getHierarchicalIndex(table, '0');\n    };\n    TableHistoryInfo.prototype.destroy = function () {\n        this.tableHierarchicalIndex = undefined;\n        if (this.tableHolder) {\n            this.tableHolder.destroy();\n            this.tableHolder = undefined;\n        }\n        if (this.tableFormat) {\n            this.tableFormat = null;\n        }\n        if (this.rows) {\n            this.rows = [];\n            this.rows = undefined;\n        }\n    };\n    return TableHistoryInfo;\n}());\nexport { TableHistoryInfo };\n/**\n * @private\n */\nvar TableFormatHistoryInfo = /** @class */ (function () {\n    function TableFormatHistoryInfo() {\n        /* tslint:disable:no-empty */\n    }\n    return TableFormatHistoryInfo;\n}());\nexport { TableFormatHistoryInfo };\n/**\n * @private\n */\nvar RowFormatHistoryInfo = /** @class */ (function () {\n    function RowFormatHistoryInfo() {\n        this.cells = [];\n    }\n    return RowFormatHistoryInfo;\n}());\nexport { RowFormatHistoryInfo };\n/**\n * @private\n */\nvar CellFormatHistoryInfo = /** @class */ (function () {\n    function CellFormatHistoryInfo() {\n        /* tslint:disable:no-empty */\n    }\n    return CellFormatHistoryInfo;\n}());\nexport { CellFormatHistoryInfo };\n/**\n * @private\n */\nvar CellHistoryFormat = /** @class */ (function () {\n    function CellHistoryFormat(point) {\n        this.startingPoint = point; // starting point preserved to calculate the displacement on after cell resizing finished.\n    }\n    return CellHistoryFormat;\n}());\nexport { CellHistoryFormat };\n","import { WParagraphFormat } from '../format/paragraph-format';\nimport { WSectionFormat } from '../format/section-format';\nimport { WCharacterFormat } from '../format/character-format';\nimport { WListFormat } from '../format/list-format';\nimport { ModifiedLevel, RowHistoryFormat, TableHistoryInfo } from './history-helper';\nimport { BlockWidget, ParagraphWidget, BodyWidget, TableCellWidget, TableWidget, TableRowWidget, HeaderFooterWidget } from '../viewer/page';\nimport { Dictionary } from '../../base/dictionary';\nimport { TextPosition, ImageFormat } from '../index';\nimport { isNullOrUndefined } from '@syncfusion/ej2-base';\nimport { ElementBox } from '../viewer/page';\nimport { WTableFormat, WRowFormat, WCellFormat, WParagraphStyle } from '../format/index';\n/**\n * @private\n */\nvar BaseHistoryInfo = /** @class */ (function () {\n    function BaseHistoryInfo(node) {\n        this.ownerIn = node;\n        this.viewer = node.viewer;\n        this.modifiedPropertiesIn = [];\n        this.modifiedNodeLength = [];\n        this.removedNodesIn = [];\n    }\n    Object.defineProperty(BaseHistoryInfo.prototype, \"owner\", {\n        //Properties\n        //gets owner control\n        /**\n         * gets the owner control\n         * @private\n         */\n        get: function () { return this.ownerIn; },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(BaseHistoryInfo.prototype, \"editorHistory\", {\n        /**\n         * gets or sets action\n         * @private\n         */\n        get: function () {\n            return this.owner.editorHistory;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(BaseHistoryInfo.prototype, \"action\", {\n        /**\n         * gets or sets action\n         * @private\n         */\n        get: function () { return this.actionIn; },\n        set: function (value) { this.actionIn = value; },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(BaseHistoryInfo.prototype, \"modifiedProperties\", {\n        /**\n         * gets modified properties\n         * @returns Object\n         * @private\n         */\n        get: function () { return this.modifiedPropertiesIn; },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(BaseHistoryInfo.prototype, \"removedNodes\", {\n        /**\n         * @private\n         */\n        get: function () {\n            return this.removedNodesIn;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(BaseHistoryInfo.prototype, \"selectionStart\", {\n        /**\n         * Gets or Sets the selection start\n         * @private\n         */\n        //gets or sets selection start\n        get: function () { return this.selectionStartIn; },\n        set: function (value) { this.selectionStartIn = value; },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(BaseHistoryInfo.prototype, \"selectionEnd\", {\n        /**\n         * Gets or Sets the selection end\n         * @private\n         */\n        get: function () { return this.selectionEndIn; },\n        set: function (value) { this.selectionEndIn = value; },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(BaseHistoryInfo.prototype, \"insertPosition\", {\n        /**\n         * Gets or sets the insert position\n         * @private\n         */\n        get: function () { return this.insertPositionIn; },\n        set: function (value) { this.insertPositionIn = value; },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(BaseHistoryInfo.prototype, \"endPosition\", {\n        /**\n         * Gets or sets end position\n         * @private\n         */\n        get: function () { return this.endPositionIn; },\n        set: function (value) { this.endPositionIn = value; },\n        enumerable: true,\n        configurable: true\n    });\n    /**\n     * Update the selection\n     * @param selection\n     * @private\n     */\n    BaseHistoryInfo.prototype.updateSelection = function () {\n        var blockInfo = this.owner.editorModule.getParagraphInfo(this.owner.selection.start);\n        this.selectionStart = this.owner.editorModule.getHierarchicalIndex(blockInfo.paragraph, blockInfo.offset.toString());\n        blockInfo = this.owner.editorModule.getParagraphInfo(this.owner.selection.end);\n        this.selectionEnd = this.owner.editorModule.getHierarchicalIndex(blockInfo.paragraph, blockInfo.offset.toString());\n    };\n    BaseHistoryInfo.prototype.setBookmarkInfo = function (bookmark) {\n        this.removedNodes.push({ 'bookmark': bookmark, 'startIndex': bookmark.indexInOwner, 'endIndex': bookmark.reference.indexInOwner });\n    };\n    BaseHistoryInfo.prototype.revertBookmark = function () {\n        var bookmarkInfo = this.removedNodes[0];\n        var bookmark = bookmarkInfo.bookmark;\n        if (this.editorHistory.isUndoing) {\n            this.viewer.bookmarks.add(bookmark.name, bookmark);\n            bookmark.line.children.splice(bookmarkInfo.startIndex, 0, bookmark);\n            bookmark.reference.line.children.splice(bookmarkInfo.endIndex, 0, bookmark.reference);\n            this.editorHistory.recordChanges(this);\n        }\n        else {\n            this.owner.editorModule.deleteBookmarkInternal(bookmark);\n            this.editorHistory.undoStack.push(this);\n        }\n    };\n    /**\n     * Reverts this instance\n     * @private\n     */\n    // tslint:disable: max-func-body-length\n    BaseHistoryInfo.prototype.revert = function () {\n        if (this.action === 'DeleteBookmark') {\n            this.revertBookmark();\n            return;\n        }\n        this.owner.isShiftingEnabled = true;\n        var selectionStartTextPosition = undefined;\n        var selectionEndTextPosition = undefined;\n        var start = this.selectionStart;\n        var end = this.selectionEnd;\n        var isForwardSelection = TextPosition.isForwardSelection(start, end);\n        if (this.modifiedProperties.length > 0 || this.action === 'Selection' || this.action === 'ClearCharacterFormat'\n            || this.action === 'ClearParagraphFormat') {\n            selectionStartTextPosition = this.getTextPosition(start);\n            selectionEndTextPosition = this.getTextPosition(end);\n            this.revertModifiedProperties(selectionStartTextPosition, selectionEndTextPosition);\n        }\n        else {\n            var deletedNodes = this.removedNodes;\n            this.removedNodesIn = [];\n            var isForward = TextPosition.isForwardSelection(this.insertPosition, this.endPosition);\n            var insertTextPosition = this.getTextPosition(isForward ? this.insertPosition : this.endPosition);\n            var endTextPosition = this.getTextPosition(isForward ? this.endPosition : this.insertPosition);\n            if (insertTextPosition.isAtSamePosition(endTextPosition)) {\n                this.owner.selection.selectContent(insertTextPosition, true);\n            }\n            else {\n                this.owner.selection.selectPosition(insertTextPosition, endTextPosition);\n            }\n            if (this.action === 'InsertHyperlink' && this.editorHistory.isRedoing) {\n                var fieldBegin = this.owner.selection.getHyperlinkField();\n                if (!isNullOrUndefined(fieldBegin)) {\n                    var offset = (fieldBegin.line).getOffset(fieldBegin, 0);\n                    insertTextPosition.setPositionParagraph(fieldBegin.line, offset);\n                    this.owner.selection.start.setPositionInternal(insertTextPosition);\n                    offset = fieldBegin.fieldEnd.line.getOffset(fieldBegin.fieldEnd, 1);\n                    endTextPosition.setPositionParagraph(fieldBegin.fieldEnd.line, offset);\n                }\n            }\n            this.editorHistory.currentBaseHistoryInfo = this;\n            this.selectionStart = this.insertPosition;\n            this.insertPosition = undefined;\n            this.selectionEnd = this.endPosition;\n            this.endPosition = undefined;\n            var isRemoveContent = false;\n            if (!insertTextPosition.isAtSamePosition(endTextPosition)) {\n                isRemoveContent = this.action === 'BackSpace' || this.action === 'Delete' || this.action === 'ClearCells'\n                    || this.action === 'DeleteCells';\n                if (!(isRemoveContent) && this.action !== 'MergeCells' && this.action !== 'InsertRowAbove'\n                    && this.action !== 'InsertRowBelow' && this.action !== 'InsertColumnLeft'\n                    && this.action !== 'InsertColumnRight' && this.action !== 'Borders'\n                    && this.action !== 'DeleteTable' && this.action !== 'DeleteColumn' && this.action !== 'DeleteRow') {\n                    this.owner.selection.end.setPositionInternal(endTextPosition);\n                    if (!this.owner.selection.isEmpty) {\n                        if (this.editorHistory.isRedoing) {\n                            this.owner.editorModule.removeSelectedContents(this.owner.selection);\n                        }\n                        else {\n                            this.owner.editorModule.deleteSelectedContents(this.owner.selection, true);\n                        }\n                    }\n                }\n            }\n            var isRedoAction = this.editorHistory.isRedoing && !isRemoveContent;\n            this.revertModifiedNodes(deletedNodes, isRedoAction, isForwardSelection ? start : end, start === end);\n            if (isRemoveContent) {\n                this.removeContent(insertTextPosition, endTextPosition);\n            }\n            //this.owner.editorModule.reLayout(this.viewer.selection);\n        }\n        var isSelectionChanged = false;\n        if ((this.editorHistory.isUndoing && isNullOrUndefined(this.editorHistory.currentHistoryInfo)) ||\n            ((this.action === 'InsertRowAbove' || this.action === 'Borders' || this.action === 'InsertRowBelow'\n                || this.action === 'InsertColumnLeft'\n                || this.action === 'InsertColumnRight') && (this.editorHistory.isRedoing\n                || this.editorHistory.currentHistoryInfo.action === 'Paste'))) {\n            selectionStartTextPosition = this.getTextPosition(start);\n            selectionEndTextPosition = this.getTextPosition(end);\n            this.owner.selection.selectRange(selectionStartTextPosition, selectionEndTextPosition);\n            isSelectionChanged = true;\n        }\n        // Updates insert position of history info instance.\n        this.insertPosition = start;\n        this.endPosition = end;\n        this.owner.editorModule.reLayout(this.owner.selection, this.owner.selection.isEmpty);\n        if (isSelectionChanged) {\n            this.viewer.scrollToPosition(this.owner.selection.start, this.owner.selection.end);\n        }\n        this.highlightListText();\n    };\n    BaseHistoryInfo.prototype.highlightListText = function () {\n        if (!isNullOrUndefined(this.editorHistory.currentHistoryInfo)) {\n            // tslint:disable-next-line:max-line-length\n            if (this.action === 'ListCharacterFormat' || (this.editorHistory.currentHistoryInfo.action === 'ListSelect' && this.action === 'ListFormat')) {\n                var selectionStartTextPosition = this.getTextPosition(this.selectionStart);\n                var widget = selectionStartTextPosition.currentWidget;\n                this.viewer.selection.highlightListText(widget);\n            }\n        }\n    };\n    BaseHistoryInfo.prototype.removeContent = function (insertTextPosition, endTextPosition) {\n        //If the base parent of the insert text position and end text position is null \n        //then the paragraphs already removed.\n        //Example scenario: In table editing that is delete cells operation \n        // we will backed up the entire table ad it will be replaced on undo operation.\n        //At that time if the positions are in table \n        //which is already replaced in undo (revert modified nodes method) then the base parent of the paragraph will be null.\n        //So again, selecting the content and deleting is unnecessary\n        // and it will cause improper position updates and null reference exceptions. \n        if ((!isNullOrUndefined(insertTextPosition.paragraph.containerWidget) &&\n            insertTextPosition.paragraph.containerWidget instanceof BodyWidget &&\n            (!isNullOrUndefined(endTextPosition.paragraph.containerWidget)\n                && endTextPosition.paragraph.containerWidget instanceof BodyWidget))\n            || (!isNullOrUndefined(insertTextPosition.paragraph.containerWidget)\n                && !isNullOrUndefined(endTextPosition.paragraph.containerWidget)\n                && insertTextPosition.paragraph.containerWidget instanceof TableCellWidget\n                && endTextPosition.paragraph.containerWidget instanceof TableCellWidget\n                && !isNullOrUndefined(insertTextPosition.paragraph.bodyWidget))) {\n            //Removes if any empty paragraph is added while delete.\n            this.owner.selection.selectRange(insertTextPosition, endTextPosition);\n            var isDelete = (this.action === 'BackSpace') ? true : false;\n            this.owner.editorModule.deleteSelectedContents(this.owner.selection, isDelete);\n        }\n    };\n    BaseHistoryInfo.prototype.revertModifiedProperties = function (start, end) {\n        if (this.action === 'CellFormat' || this.action === 'CellOptions' || this.action === 'TableOptions') {\n            this.owner.isShiftingEnabled = false;\n        }\n        this.owner.selection.selectRange(start, end);\n        if (this.action === 'RowResizing' || this.action === 'CellResizing') {\n            this.revertResizing();\n        }\n        else if (this.action === 'CellOptions' || this.action === 'TableOptions') {\n            this.revertTableDialogProperties(this.action);\n        }\n        else if (this.action !== 'Selection') {\n            this.revertProperties();\n        }\n    };\n    // Redoes the Action\n    BaseHistoryInfo.prototype.redoAction = function () {\n        var editor = this.owner.editorModule;\n        switch (this.action) {\n            case 'BackSpace':\n                editor.singleBackspace(this.owner.selection, true);\n                break;\n            case 'Delete':\n                editor.singleDelete(this.owner.selection, true);\n                break;\n            case 'DeleteTable':\n                editor.deleteTable();\n                break;\n            case 'DeleteColumn':\n                editor.deleteColumn();\n                break;\n            case 'DeleteRow':\n                editor.deleteRow();\n                break;\n            case 'MergeCells':\n                editor.mergeSelectedCellsInTable();\n                break;\n            case 'InsertRowAbove':\n                editor.insertRow(true);\n                break;\n            case 'InsertRowBelow':\n                editor.insertRow(false);\n                break;\n            case 'InsertColumnLeft':\n                editor.insertColumn(true);\n                break;\n            case 'InsertColumnRight':\n                editor.insertColumn(true);\n                break;\n            case 'SectionBreak':\n                editor.insertSection(this.owner.selection, true);\n                break;\n        }\n    };\n    /**\n     * Revert the modified nodes\n     * @param  {WNode[]} deletedNodes\n     * @param  {boolean} isRedoAction\n     * @param  {string} start\n     * @param  {boolean} isEmptySelection\n     */\n    BaseHistoryInfo.prototype.revertModifiedNodes = function (deletedNodes, isRedoAction, start, isEmptySelection) {\n        if (isRedoAction && (this.action === 'BackSpace' || this.action === 'Delete' || this.action === 'DeleteTable'\n            || this.action === 'DeleteColumn' || this.action === 'DeleteRow' || this.action === 'InsertRowAbove' ||\n            this.action === 'InsertRowBelow' || this.action === 'InsertColumnLeft' || this.action === 'InsertColumnRight'\n            || this.action === 'MergeCells' || this.action === 'SectionBreak')) {\n            this.redoAction();\n            if (this.action === 'SectionBreak') {\n                return;\n            }\n        }\n        if (deletedNodes.length > 0) {\n            if ((this.editorHistory.isUndoing && (this.action === 'DeleteCells' || this.action === 'DeleteColumn'\n                || this.action === 'DeleteRow' || this.action === 'MergeCells'))\n                || (this.action === 'InsertRowAbove' || this.action === 'InsertRowBelow' || this.action === 'InsertColumnLeft'\n                    || this.action === 'ClearCells' || this.action === 'InsertColumnRight' || this.action === 'Borders')) {\n                var insertIndex = this.selectionStart;\n                var block = this.owner.editorModule.getBlock({ index: insertIndex }).node;\n                var lastNode = deletedNodes[deletedNodes.length - 1];\n                if ((block instanceof TableWidget || block.previousRenderedWidget instanceof TableWidget || block.isInsideTable)\n                    && lastNode instanceof TableWidget) {\n                    if (block instanceof ParagraphWidget && !block.isInsideTable) {\n                        block = block.previousRenderedWidget;\n                    }\n                    block = block.combineWidget(this.viewer);\n                    this.owner.editorModule.insertTableInternal(block, lastNode, false);\n                    deletedNodes.splice(deletedNodes.indexOf(lastNode), 1);\n                }\n                else if (lastNode instanceof TableWidget) {\n                    this.owner.editorModule.insertBlock(lastNode);\n                }\n            }\n            else {\n                var initialStart = start;\n                var block = this.owner.editorModule.getBlock({ index: initialStart }).node;\n                // initialStart = blockObj.position;\n                if (deletedNodes.length > 0 && (this.action === 'BackSpace' && isEmptySelection\n                    || (!(block instanceof TableWidget) && !(block instanceof HeaderFooterWidget)))) {\n                    var lastNode = deletedNodes[0];\n                    if (this.action === 'SectionBreak' && lastNode instanceof BodyWidget ||\n                        !isNullOrUndefined(this.editorHistory.currentHistoryInfo) &&\n                            this.editorHistory.currentHistoryInfo.action === 'PageBreak') {\n                        lastNode = deletedNodes[1];\n                    }\n                    if (lastNode instanceof ParagraphWidget && this.owner.selection.start.offset > 0) {\n                        this.owner.editorModule.insertNewParagraphWidget(lastNode, true);\n                        deletedNodes.splice(deletedNodes.indexOf(lastNode), 1);\n                        if (isNullOrUndefined(block)) {\n                            // tslint:disable-next-line:max-line-length\n                            var nextBlock = this.viewer.selection.getNextParagraphBlock(lastNode.getSplitWidgets().pop());\n                            this.owner.selection.getNextRenderedBlock(lastNode);\n                            if (isNullOrUndefined(nextBlock)) {\n                                //Sets the selection as starting of last paragraph.\n                                this.owner.selection.selectParagraph(lastNode, true);\n                            }\n                        }\n                    }\n                    if (lastNode instanceof TableWidget && this.owner.selection.start.offset > 0) {\n                        var firstBlock = deletedNodes[deletedNodes.length - 1];\n                        if (firstBlock instanceof ParagraphWidget) {\n                            this.owner.editorModule.insertNewParagraphWidget(firstBlock, true);\n                            deletedNodes.splice(deletedNodes.indexOf(firstBlock), 1);\n                            if (isNullOrUndefined(block)) {\n                                // tslint:disable-next-line:max-line-length\n                                var nextBlock = this.viewer.selection.getNextParagraphBlock(firstBlock.getSplitWidgets().pop());\n                                if (isNullOrUndefined(nextBlock)) {\n                                    //Sets the selection as starting of last paragraph.\n                                    this.owner.selection.selectParagraph(firstBlock, true);\n                                }\n                            }\n                        }\n                    }\n                }\n                if (deletedNodes.length > 0) {\n                    var firstNode = deletedNodes[deletedNodes.length - 1];\n                    if (block instanceof TableWidget) {\n                        block = block.combineWidget(this.viewer);\n                        if (firstNode instanceof TableWidget) {\n                            this.owner.editorModule.insertTableInternal(block, firstNode, true);\n                            deletedNodes.splice(deletedNodes.indexOf(firstNode), 1);\n                            this.insertPosition = start;\n                            var nextWidget = firstNode.getSplitWidgets().pop();\n                            if (nextWidget.nextRenderedWidget instanceof TableWidget) {\n                                block = nextWidget.nextRenderedWidget;\n                            }\n                            else {\n                                initialStart = start;\n                                block = this.owner.editorModule.getBlock({ index: initialStart }).node;\n                            }\n                        }\n                    }\n                    //Checks if first node is paragraph and current insert position is paragraph end.\n                    // tslint:disable-next-line:max-line-length\n                    if (firstNode instanceof ParagraphWidget && this.owner.selection.start.offset > 0\n                        && this.owner.selection.start.offset === this.owner.selection.getLineLength(this.owner.selection.start.paragraph.lastChild)) {\n                        var editor = this.owner.editorModule;\n                        editor.insertNewParagraphWidget(firstNode, false);\n                        deletedNodes.splice(deletedNodes.indexOf(firstNode), 1);\n                        //Removes the intermediate empty paragraph instance.\n                        if (this.action !== 'Paste') {\n                            editor.removeBlock(this.owner.selection.start.paragraph);\n                        }\n                        // tslint:disable-next-line:max-line-length\n                        var paragraph = this.viewer.selection.getNextParagraphBlock(firstNode.getSplitWidgets().pop());\n                        if (!isNullOrUndefined(paragraph)) {\n                            this.owner.selection.selectParagraph(paragraph, true);\n                        }\n                    }\n                    else if (deletedNodes[0] instanceof TableWidget && deletedNodes.length !== 1) {\n                        var nextNode = deletedNodes[1];\n                        if (nextNode instanceof ParagraphWidget && nextNode.isEmpty()) {\n                            deletedNodes.splice(deletedNodes.indexOf(nextNode), 1);\n                        }\n                    }\n                }\n                if (deletedNodes.length > 0) {\n                    if (block instanceof TableWidget) {\n                        block = block.combineWidget(this.viewer);\n                    }\n                    this.insertRemovedNodes(deletedNodes, block);\n                }\n            }\n        }\n    };\n    BaseHistoryInfo.prototype.insertRemovedNodes = function (deletedNodes, block) {\n        for (var i = deletedNodes.length - 1, index = 0; i > -1; i--) {\n            var node = deletedNodes[i];\n            if (node instanceof ElementBox) {\n                this.owner.editorModule.insertInlineInSelection(this.owner.selection, node);\n            }\n            else if (node instanceof BlockWidget) {\n                if (node instanceof TableRowWidget) {\n                    if (block instanceof TableWidget) {\n                        block.childWidgets.splice(index, 0, node);\n                        this.owner.editorModule.updateNextBlocksIndex(node, true);\n                        if (i === 0 || !(deletedNodes[i - 1] instanceof TableRowWidget)) {\n                            // tslint:disable-next-line:max-line-length\n                            this.viewer.layout.layoutBodyWidgetCollection(block.index, block.containerWidget, block, false);\n                        }\n                    }\n                }\n                else if (block instanceof TableWidget) {\n                    this.owner.editorModule.insertBlockTable(this.owner.selection, node, block);\n                }\n                else {\n                    this.owner.editorModule.insertBlock(node);\n                }\n            }\n            else if (node instanceof BodyWidget) {\n                this.owner.editorModule.insertSection(this.owner.selection, false);\n            }\n        }\n        deletedNodes = [];\n    };\n    BaseHistoryInfo.prototype.revertResizing = function () {\n        this.editorHistory.currentBaseHistoryInfo = this;\n        if (this.action === 'RowResizing') {\n            if (this.modifiedProperties[0] instanceof RowHistoryFormat) {\n                // tslint:disable-next-line:max-line-length\n                this.modifiedProperties[0].revertChanges(this.editorHistory.isRedoing, this.owner);\n            }\n        }\n        else {\n            if (this.modifiedProperties[0] instanceof TableHistoryInfo) {\n                //selected cell resizing the condition checks done based on the selected widgets only. so need to highlight the selection.\n                if (this.owner.selection.selectedWidgets.length === 0) {\n                    this.owner.selection.highlightSelection(true);\n                }\n                var prevTableHistoryInfo = this.modifiedProperties[0];\n                var position = prevTableHistoryInfo.tableHierarchicalIndex;\n                var block = this.owner.editorModule.getBlock({ index: position }).node;\n                if (block instanceof TableWidget) {\n                    var tableResize = this.owner.editorModule.tableResize;\n                    this.owner.editor.setOffsetValue(this.owner.selection);\n                    block = block.combineWidget(this.owner.viewer);\n                    tableResize.currentResizingTable = block;\n                    this.modifiedProperties.splice(0, 1);\n                    if (this.editorHistory.isUndoing || this.editorHistory.isRedoing) {\n                        var tableHistoryInfoCurrent = new TableHistoryInfo(block, this.owner);\n                        this.modifiedProperties.splice(0, 0, tableHistoryInfoCurrent);\n                        this.owner.isLayoutEnabled = false;\n                        tableResize.applyProperties(tableResize.currentResizingTable, prevTableHistoryInfo);\n                        tableResize.currentResizingTable.isGridUpdated = true;\n                        this.owner.isLayoutEnabled = true;\n                        tableResize.updateGridValue(tableResize.currentResizingTable, false);\n                        prevTableHistoryInfo.destroy();\n                        prevTableHistoryInfo = undefined;\n                    }\n                }\n            }\n        }\n    };\n    BaseHistoryInfo.prototype.revertTableDialogProperties = function (action) {\n        this.owner.isShiftingEnabled = false;\n        this.editorHistory.currentBaseHistoryInfo = this;\n        this.currentPropertyIndex = 0;\n        if (action === 'CellOptions') {\n            var selection = this.owner.selection;\n            var cellFormat = this.modifiedProperties[0];\n            this.owner.editorModule.updateCellMargins(selection, cellFormat);\n        }\n        else if (action === 'TableOptions') {\n            this.owner.tableOptionsDialogModule.applyTableOptionsHelper(this.modifiedProperties[0]);\n        }\n        this.currentPropertyIndex = 0;\n        this.owner.isShiftingEnabled = true;\n    };\n    BaseHistoryInfo.prototype.getTextPosition = function (hierarchicalIndex) {\n        var textPosition = new TextPosition(this.owner);\n        var blockInfo = this.owner.editorModule.getParagraph({ index: hierarchicalIndex });\n        var lineInfo = this.owner.editorModule.getLineInfo(blockInfo.paragraph, blockInfo.offset);\n        textPosition.setPositionForLineWidget(lineInfo.line, lineInfo.offset);\n        return textPosition;\n    };\n    /**\n     * Add modified properties for section format\n     * @param  {WSectionFormat} format\n     * @param  {string} property\n     * @param  {Object} value\n     * @private\n     */\n    BaseHistoryInfo.prototype.addModifiedPropertiesForSection = function (format, property, value) {\n        if (this.editorHistory.isUndoing || this.editorHistory.isRedoing) {\n            var modifiedProperties = this.modifiedProperties;\n            var previousFormat = (this.currentPropertyIndex < modifiedProperties.length ?\n                modifiedProperties[this.currentPropertyIndex] : modifiedProperties[modifiedProperties.length - 1]);\n            if (isNullOrUndefined(property)) {\n                value = previousFormat;\n                if (this.currentPropertyIndex < this.modifiedProperties.length) {\n                    this.modifiedProperties[this.currentPropertyIndex] = format.cloneFormat();\n                }\n                else {\n                    this.modifiedProperties[this.modifiedProperties.length - 1] = format.cloneFormat();\n                }\n            }\n            else {\n                value = previousFormat.getPropertyValue(property);\n                previousFormat.copyFormat(format);\n            }\n            this.currentPropertyIndex++;\n        }\n        else {\n            if (isNullOrUndefined(property)) {\n                this.modifiedProperties.push(format.cloneFormat());\n            }\n            else {\n                var currentFormat = new WSectionFormat();\n                currentFormat.copyFormat(format);\n                this.modifiedProperties.push(currentFormat);\n            }\n        }\n        return value;\n    };\n    /**\n     * Add the modified properties for character format\n     * @param  {WCharacterFormat} format\n     * @param  {string} property\n     * @param  {Object} value\n     * @private\n     */\n    BaseHistoryInfo.prototype.addModifiedProperties = function (format, property, value) {\n        if (this.editorHistory.isUndoing || this.editorHistory.isRedoing) {\n            // tslint:disable-next-line:max-line-length           \n            var previousFormat = (this.currentPropertyIndex < this.modifiedProperties.length ? this.modifiedProperties[this.currentPropertyIndex] : this.modifiedProperties[this.modifiedProperties.length - 1]);\n            var skipRemove = false;\n            if (format.ownerBase instanceof ElementBox) {\n                var prevLength = this.modifiedNodeLength[this.currentPropertyIndex];\n                if (format.ownerBase.length < prevLength) {\n                    skipRemove = true;\n                    this.modifiedNodeLength[this.currentPropertyIndex] = format.ownerBase.length;\n                    this.modifiedNodeLength.splice(this.currentPropertyIndex + 1, 0, prevLength - format.ownerBase.length);\n                    //Adds a copy of character format at next position for splitted inline.\n                    var nextFormat = new WCharacterFormat(undefined);\n                    nextFormat.copyFormat(previousFormat);\n                    this.modifiedProperties.splice(this.currentPropertyIndex + 1, 0, nextFormat);\n                }\n            }\n            if (this.action === 'ClearCharacterFormat') {\n                if (this.editorHistory.isUndoing) {\n                    value = previousFormat;\n                    if (!skipRemove) {\n                        this.modifiedProperties.splice(this.currentPropertyIndex, 1);\n                        this.currentPropertyIndex--;\n                    }\n                }\n                else {\n                    this.modifiedProperties.push(format.cloneFormat());\n                }\n            }\n            else {\n                value = previousFormat;\n                if (this.currentPropertyIndex < this.modifiedProperties.length) {\n                    this.modifiedProperties[this.currentPropertyIndex] = format.cloneFormat();\n                }\n                else {\n                    this.modifiedProperties[this.modifiedProperties.length - 1] = format.cloneFormat();\n                }\n            }\n            this.currentPropertyIndex++;\n        }\n        else {\n            if (isNullOrUndefined(property)) {\n                this.modifiedProperties.push(format.cloneFormat());\n            }\n            else {\n                var currentFormat = new WCharacterFormat(undefined);\n                currentFormat.copyFormat(format);\n                this.modifiedProperties.push(currentFormat);\n            }\n            if (format.ownerBase instanceof ElementBox) {\n                this.modifiedNodeLength.push(format.ownerBase.length);\n            }\n            else {\n                this.modifiedNodeLength.push(0);\n            }\n        }\n        return value;\n    };\n    /**\n     * Add the modified properties for paragraph format\n     * @param  {WParagraphFormat} format\n     * @param  {string} property\n     * @param  {Object} value\n     * @private\n     */\n    BaseHistoryInfo.prototype.addModifiedPropertiesForParagraphFormat = function (format, property, value) {\n        if (this.editorHistory.isUndoing || this.editorHistory.isRedoing) {\n            // tslint:disable-next-line:max-line-length\n            var previousFormat = (this.currentPropertyIndex < this.modifiedProperties.length ? this.modifiedProperties[this.currentPropertyIndex] : this.modifiedProperties[this.modifiedProperties.length - 1]);\n            if (this.action === 'ClearParagraphFormat') {\n                if (this.editorHistory.isUndoing) {\n                    value = previousFormat;\n                    this.modifiedProperties.splice(this.currentPropertyIndex, 1);\n                    this.currentPropertyIndex--;\n                }\n                else {\n                    this.modifiedProperties.push(format.cloneFormat());\n                }\n                this.currentPropertyIndex++;\n                return value;\n            }\n            if (isNullOrUndefined(property)) {\n                value = previousFormat;\n                if (this.currentPropertyIndex < this.modifiedProperties.length) {\n                    this.modifiedProperties[this.currentPropertyIndex] = format.cloneFormat();\n                }\n                else {\n                    this.modifiedProperties[this.modifiedProperties.length - 1] = format.cloneFormat();\n                }\n                this.currentPropertyIndex++;\n                return value;\n            }\n            if (property === 'listFormat') {\n                value = new WParagraphFormat(undefined);\n                value.copyFormat(previousFormat);\n                previousFormat.listFormat = new WListFormat();\n                previousFormat.listFormat.copyFormat(format.listFormat);\n                this.currentPropertyIndex++;\n                return value;\n            }\n            if (property === 'styleName') {\n                if (!isNullOrUndefined(previousFormat.baseStyle)) {\n                    value = new WParagraphStyle();\n                    value.copyStyle(previousFormat.baseStyle);\n                    this.currentPropertyIndex++;\n                    return value;\n                }\n                else {\n                    return undefined;\n                }\n            }\n            value = previousFormat.getPropertyValue(property);\n            previousFormat.copyFormat(format);\n            this.currentPropertyIndex++;\n        }\n        else {\n            if (isNullOrUndefined(property)) {\n                this.modifiedProperties.push(format.cloneFormat());\n            }\n            else {\n                var currentFormat = new WParagraphFormat(undefined);\n                currentFormat.copyFormat(format);\n                this.modifiedProperties.push(currentFormat);\n            }\n        }\n        return value;\n    };\n    /**\n     * @private\n     */\n    BaseHistoryInfo.prototype.addModifiedPropertiesForContinueNumbering = function (paragraphFormat, value) {\n        if (this.editorHistory.isUndoing || this.editorHistory.isRedoing) {\n            // tslint:disable-next-line:max-line-length\n            var previousFormat = (this.currentPropertyIndex < this.modifiedProperties.length ? this.modifiedProperties[this.currentPropertyIndex] : this.modifiedProperties[this.modifiedProperties.length - 1]);\n            value = previousFormat;\n            if (this.currentPropertyIndex < this.modifiedProperties.length) {\n                this.modifiedProperties[this.currentPropertyIndex] = paragraphFormat.cloneFormat();\n            }\n            else {\n                this.modifiedProperties[this.modifiedProperties.length - 1] = paragraphFormat.cloneFormat();\n            }\n            this.currentPropertyIndex++;\n            return value;\n        }\n        else {\n            var currentFormat = new WParagraphFormat();\n            currentFormat.copyFormat(paragraphFormat);\n            this.modifiedProperties.push(currentFormat);\n        }\n        return value;\n    };\n    /**\n     * @param listFormat\n     * @param value\n     * @private\n     */\n    BaseHistoryInfo.prototype.addModifiedPropertiesForRestartNumbering = function (listFormat, value) {\n        if (this.editorHistory.isUndoing || this.editorHistory.isRedoing) {\n            // tslint:disable-next-line:max-line-length\n            var listId = (this.currentPropertyIndex < this.modifiedProperties.length ? this.modifiedProperties[this.currentPropertyIndex] : this.modifiedProperties[this.modifiedProperties.length - 1]);\n            value = listId;\n            if (this.currentPropertyIndex < this.modifiedProperties.length) {\n                this.modifiedProperties[this.currentPropertyIndex] = listFormat.listId;\n            }\n            else {\n                this.modifiedProperties[this.modifiedProperties.length - 1] = listFormat.listId;\n            }\n            this.currentPropertyIndex++;\n            return value;\n        }\n        else {\n            this.modifiedProperties.push(listFormat.listId);\n        }\n        return value;\n    };\n    /**\n     * Add modified properties for list format\n     * @param  {WListLevel} listLevel\n     * @private\n     */\n    BaseHistoryInfo.prototype.addModifiedPropertiesForList = function (listLevel) {\n        var value;\n        if (this.editorHistory.isUndoing || this.editorHistory.isRedoing) {\n            // tslint:disable-next-line:max-line-length\n            var previousLevel = (this.currentPropertyIndex < this.modifiedProperties.length ? this.modifiedProperties[this.currentPropertyIndex] : this.modifiedProperties[this.modifiedProperties.length - 1]);\n            value = previousLevel;\n            previousLevel = new ModifiedLevel(listLevel, this.owner.editorModule.cloneListLevel(listLevel));\n            if (this.currentPropertyIndex < this.modifiedProperties.length) {\n                this.modifiedProperties[this.currentPropertyIndex] = previousLevel;\n            }\n            else {\n                this.modifiedProperties[this.modifiedProperties.length - 1] = previousLevel;\n            }\n            this.currentPropertyIndex++;\n        }\n        else {\n            this.modifiedProperties.push(new ModifiedLevel(listLevel, this.owner.editorModule.cloneListLevel(listLevel)));\n            value = listLevel;\n        }\n        return value;\n    };\n    /**\n     * Revert the properties\n     * @param  {SelectionRange} selectionRange\n     */\n    BaseHistoryInfo.prototype.revertProperties = function () {\n        this.editorHistory.currentBaseHistoryInfo = this;\n        this.currentPropertyIndex = 0;\n        var property = this.getProperty();\n        this.viewer.owner.editorModule.setOffsetValue(this.viewer.selection);\n        if (this.action === 'ClearCharacterFormat' || this.modifiedProperties[0] instanceof WCharacterFormat) {\n            if (this.action === 'ListCharacterFormat') {\n                this.owner.editorModule.updateListCharacterFormat(this.viewer.selection, property, undefined);\n                return;\n            }\n            this.owner.editorModule.updateSelectionCharacterFormatting(property, undefined, false);\n        }\n        else if (this.action === 'ClearParagraphFormat' || this.modifiedProperties[0] instanceof WParagraphFormat) {\n            if (this.action === 'ContinueNumbering') {\n                // tslint:disable-next-line:max-line-length\n                this.owner.editorModule.revertContinueNumbering(this.owner.selection, this.modifiedProperties[0]);\n                return;\n            }\n            if (this.action === 'StyleName' && this.modifiedProperties[0] instanceof WParagraphFormat) {\n                // tslint:disable-next-line:max-line-length\n                this.owner.editorModule.updateSelectionParagraphFormatting(property, this.modifiedProperties[0].baseStyle, false);\n                return;\n            }\n            this.owner.editorModule.updateSelectionParagraphFormatting(property, undefined, false);\n        }\n        else if (this.modifiedProperties[0] instanceof WSectionFormat) {\n            this.owner.editorModule.updateSectionFormat(property, undefined);\n        }\n        else if (this.action === 'RestartNumbering') {\n            this.owner.editorModule.restartListAtInternal(this.owner.selection, this.modifiedProperties[0]);\n            return;\n        }\n        else if (this.modifiedProperties[0] instanceof ImageFormat) {\n            this.owner.selection.updateImageSize(this.modifiedProperties[0]);\n        }\n        else if (this.modifiedProperties[0] instanceof ModifiedLevel) {\n            var modified = new Dictionary();\n            for (var i = 0; i < this.modifiedProperties.length; i++) {\n                var modifiedLevel = this.modifiedProperties[i];\n                // modified.modifiedLevels.add(modifiedLevel.ownerListLevel.levelNumber, modifiedLevel);\n                modified.add(i, modifiedLevel);\n            }\n            this.editorHistory.updateListChanges(modified);\n            modified.destroy();\n            modified = undefined;\n        }\n        else if (this.modifiedProperties[0] instanceof WTableFormat) {\n            this.owner.editorModule.updateTableFormat(this.owner.selection, property, undefined);\n        }\n        else if (this.modifiedProperties[0] instanceof WCellFormat) {\n            this.owner.isShiftingEnabled = true;\n            this.owner.editorModule.updateCellFormat(this.owner.selection, property, undefined);\n        }\n        else if (this.modifiedProperties[0] instanceof WRowFormat) {\n            this.owner.editorModule.updateRowFormat(this.owner.selection, property, undefined);\n        }\n        this.currentPropertyIndex = 0;\n        if (this.action === 'ClearCharacterFormat' || this.action === 'ClearParagraphFormat') {\n            this.owner.editorModule.getOffsetValue(this.viewer.selection);\n        }\n    };\n    /**\n     * Add modified properties for cell options dialog\n     * @param  {WCellFormat} format\n     * @param  {WTable} table\n     * @private\n     */\n    BaseHistoryInfo.prototype.addModifiedCellOptions = function (applyFormat, format, table) {\n        var currentFormat;\n        if (isNullOrUndefined(applyFormat.bottomMargin) && isNullOrUndefined(applyFormat.topMargin)\n            && isNullOrUndefined(applyFormat.rightMargin) && isNullOrUndefined(applyFormat.leftMargin)) {\n            currentFormat = this.copyCellOptions(table.tableFormat);\n        }\n        else {\n            currentFormat = this.copyCellOptions(applyFormat);\n        }\n        if (this.editorHistory.isUndoing || this.editorHistory.isRedoing) {\n            // tslint:disable-next-line:max-line-length\n            var previousFormat = (this.currentPropertyIndex < this.modifiedProperties.length ? this.modifiedProperties[this.currentPropertyIndex] : this.modifiedProperties[this.modifiedProperties.length - 1]);\n            format = previousFormat;\n            if (this.currentPropertyIndex < this.modifiedProperties.length) {\n                this.modifiedProperties[this.currentPropertyIndex] = this.copyCellOptions(applyFormat);\n            }\n            else {\n                this.modifiedProperties[this.modifiedProperties.length - 1] = this.copyCellOptions(applyFormat);\n            }\n            this.currentPropertyIndex++;\n            return format;\n        }\n        else {\n            this.modifiedProperties.push(currentFormat);\n        }\n        return format;\n    };\n    BaseHistoryInfo.prototype.copyCellOptions = function (format) {\n        var cellFormat = new WCellFormat();\n        cellFormat.topMargin = format.topMargin;\n        cellFormat.rightMargin = format.rightMargin;\n        cellFormat.bottomMargin = format.bottomMargin;\n        cellFormat.leftMargin = format.leftMargin;\n        return cellFormat;\n    };\n    /**\n     * Add modified properties for cell options dialog\n     * @param  {WTableFormat} format\n     * @private\n     */\n    BaseHistoryInfo.prototype.addModifiedTableOptions = function (format) {\n        var currentFormat = this.copyTableOptions(format);\n        if (this.editorHistory.isUndoing || this.editorHistory.isRedoing) {\n            // tslint:disable-next-line:max-line-length           \n            var previousFormat = (this.currentPropertyIndex < this.modifiedProperties.length ? this.modifiedProperties[this.currentPropertyIndex] : this.modifiedProperties[this.modifiedProperties.length - 1]);\n            if (this.currentPropertyIndex < this.modifiedProperties.length) {\n                this.modifiedProperties.splice(this.currentPropertyIndex, 1, currentFormat);\n            }\n            else {\n                this.modifiedProperties.splice(this.modifiedProperties.length - 1, 1, currentFormat);\n            }\n            this.currentPropertyIndex++;\n        }\n        else {\n            this.modifiedProperties.push(currentFormat);\n        }\n    };\n    BaseHistoryInfo.prototype.copyTableOptions = function (format) {\n        var tableFormat = new WTableFormat();\n        tableFormat.topMargin = format.topMargin;\n        tableFormat.rightMargin = format.rightMargin;\n        tableFormat.bottomMargin = format.bottomMargin;\n        tableFormat.leftMargin = format.leftMargin;\n        tableFormat.cellSpacing = format.cellSpacing;\n        return tableFormat;\n    };\n    BaseHistoryInfo.prototype.getProperty = function () {\n        switch (this.action) {\n            case 'Bold':\n                return 'bold';\n            case 'Italic':\n                return 'italic';\n            case 'FontColor':\n                return 'fontColor';\n            case 'FontFamily':\n                return 'fontFamily';\n            case 'FontSize':\n                return 'fontSize';\n            case 'HighlightColor':\n                return 'highlightColor';\n            case 'BaselineAlignment':\n                return 'baselineAlignment';\n            case 'Strikethrough':\n                return 'strikethrough';\n            case 'Underline':\n                return 'underline';\n            case 'AfterSpacing':\n                return 'afterSpacing';\n            case 'BeforeSpacing':\n                return 'beforeSpacing';\n            case 'LeftIndent':\n                return 'leftIndent';\n            case 'RightIndent':\n                return 'rightIndent';\n            case 'FirstLineIndent':\n                return 'firstLineIndent';\n            case 'LineSpacingType':\n                return 'lineSpacingType';\n            case 'LineSpacing':\n                return 'lineSpacing';\n            case 'TextAlignment':\n                return 'textAlignment';\n            case 'ListFormat':\n                return 'listFormat';\n            case 'PageHeight':\n                return 'pageHeight';\n            case 'PageWidth':\n                return 'pageWidth';\n            case 'TableAlignment':\n                return 'tableAlignment';\n            case 'TableLeftIndent':\n                return 'leftIndent';\n            case 'DefaultCellSpacing':\n                return 'cellSpacing';\n            case 'LeftMargin':\n            case 'CellLeftMargin':\n            case 'DefaultCellLeftMargin':\n                return 'leftMargin';\n            case 'RightMargin':\n            case 'CellRightMargin':\n            case 'DefaultCellRightMargin':\n                return 'rightMargin';\n            case 'TopMargin':\n            case 'CellTopMargin':\n            case 'DefaultCellTopMargin':\n                return 'topMargin';\n            case 'BottomMargin':\n            case 'CellBottomMargin':\n            case 'DefaultCellBottomMargin':\n                return 'bottomMargin';\n            case 'CellContentVerticalAlignment':\n                return 'verticalAlignment';\n            case 'RowHeight':\n                return 'height';\n            case 'RowHeightType':\n                return 'heightType';\n            case 'RowHeader':\n                return 'isHeader';\n            case 'AllowBreakAcrossPages':\n                return 'allowBreakAcrossPages';\n            case 'TablePreferredWidth':\n            case 'CellPreferredWidth':\n                return 'preferredWidth';\n            case 'TablePreferredWidthType':\n            case 'CellPreferredWidthType':\n                return 'preferredWidthType';\n            case 'Shading':\n                return 'shading';\n            case 'StyleName':\n                return 'styleName';\n        }\n        return undefined;\n    };\n    BaseHistoryInfo.prototype.getCharacterPropertyValue = function (property, modifiedProperty) {\n        var value;\n        if (property === 'bold') {\n            value = modifiedProperty.bold;\n        }\n        else if (property === 'italic') {\n            value = modifiedProperty.italic;\n        }\n        else if (property === 'fontColor') {\n            value = modifiedProperty.fontColor;\n        }\n        else if (property === 'fontFamily') {\n            value = modifiedProperty.fontFamily;\n        }\n        else if (property === 'fontSize') {\n            value = modifiedProperty.fontSize;\n        }\n        else if (property === 'highlightColor') {\n            value = modifiedProperty.highlightColor;\n        }\n        else if (property === 'baselineAlignment') {\n            value = modifiedProperty.baselineAlignment;\n        }\n        else if (property === 'strikethrough') {\n            value = modifiedProperty.strikethrough;\n        }\n        else if (property === 'underline') {\n            value = modifiedProperty.underline;\n        }\n        return value;\n    };\n    /**\n     * Add modified properties for table format\n     * @param  {WTableFormat} format\n     * @param  {string} property\n     * @param  {Object} value\n     * @private\n     */\n    BaseHistoryInfo.prototype.addModifiedTableProperties = function (format, property, value) {\n        if (this.editorHistory.isUndoing || this.editorHistory.isRedoing) {\n            // tslint:disable-next-line:max-line-length\n            var previousTableFormat = (this.currentPropertyIndex < this.modifiedProperties.length ? this.modifiedProperties[this.currentPropertyIndex] : this.modifiedProperties[this.modifiedProperties.length - 1]);\n            if (isNullOrUndefined(property)) {\n                value = previousTableFormat;\n                if (this.currentPropertyIndex < this.modifiedProperties.length) {\n                    this.modifiedProperties[this.currentPropertyIndex] = format.cloneFormat();\n                }\n                else {\n                    this.modifiedProperties[this.modifiedProperties.length - 1] = format.cloneFormat();\n                }\n                this.currentPropertyIndex++;\n                return value;\n            }\n            if (property === 'shading') {\n                value = previousTableFormat.shading;\n            }\n            else {\n                value = previousTableFormat.getPropertyValue(property);\n            }\n            previousTableFormat.copyFormat(format);\n            this.currentPropertyIndex++;\n        }\n        else {\n            var currentFormat = new WTableFormat();\n            currentFormat.copyFormat(format);\n            this.modifiedProperties.push(currentFormat);\n        }\n        return value;\n    };\n    /**\n     * Add modified properties for row format\n     * @param  {WRowFormat} rowFormat\n     * @param  {string} property\n     * @param  {Object} value\n     * @private\n     */\n    BaseHistoryInfo.prototype.addModifiedRowProperties = function (rowFormat, property, value) {\n        if (this.editorHistory.isUndoing || this.editorHistory.isRedoing) {\n            // tslint:disable-next-line:max-line-length\n            var previousFormat = (this.currentPropertyIndex < this.modifiedProperties.length ? this.modifiedProperties[this.currentPropertyIndex] : this.modifiedProperties[this.modifiedProperties.length - 1]);\n            if (isNullOrUndefined(property)) {\n                value = previousFormat;\n                if (this.currentPropertyIndex < this.modifiedProperties.length) {\n                    this.modifiedProperties[this.currentPropertyIndex] = rowFormat.cloneFormat();\n                }\n                else {\n                    this.modifiedProperties[this.modifiedProperties.length - 1] = rowFormat.cloneFormat();\n                }\n                this.currentPropertyIndex++;\n                return value;\n            }\n            value = previousFormat.getPropertyValue(property);\n            previousFormat.copyFormat(rowFormat);\n            this.currentPropertyIndex++;\n        }\n        else {\n            var currentFormat = new WRowFormat();\n            currentFormat.copyFormat(rowFormat);\n            this.modifiedProperties.push(currentFormat);\n        }\n        return value;\n    };\n    /**\n     * Add modified properties for cell format\n     * @param  {WCellFormat} cellFormat\n     * @param  {string} property\n     * @param  {Object} value\n     * @private\n     */\n    BaseHistoryInfo.prototype.addModifiedCellProperties = function (cellFormat, property, value) {\n        if (this.editorHistory.isUndoing || this.editorHistory.isRedoing) {\n            // tslint:disable-next-line:max-line-length\n            var previousFormat = (this.currentPropertyIndex < this.modifiedProperties.length ? this.modifiedProperties[this.currentPropertyIndex] : this.modifiedProperties[this.modifiedProperties.length - 1]);\n            if (isNullOrUndefined(property)) {\n                value = previousFormat;\n                if (this.currentPropertyIndex < this.modifiedProperties.length) {\n                    this.modifiedProperties[this.currentPropertyIndex] = cellFormat.cloneFormat();\n                }\n                else {\n                    this.modifiedProperties[this.modifiedProperties.length - 1] = cellFormat.cloneFormat();\n                }\n                this.currentPropertyIndex++;\n                return value;\n            }\n            if (property === 'shading') {\n                value = previousFormat.shading;\n            }\n            else {\n                value = previousFormat.getPropertyValue(property);\n            }\n            previousFormat.copyFormat(cellFormat);\n            this.currentPropertyIndex++;\n        }\n        else {\n            var currentFormat = new WCellFormat();\n            currentFormat.copyFormat(cellFormat);\n            this.modifiedProperties.push(currentFormat);\n        }\n        return value;\n    };\n    /**\n     * @private\n     */\n    BaseHistoryInfo.prototype.destroy = function () {\n        this.selectionStart = undefined;\n        this.selectionEnd = undefined;\n        this.insertPosition = undefined;\n        this.endPosition = undefined;\n        if (!isNullOrUndefined(this.modifiedNodeLength)) {\n            this.modifiedNodeLength = [];\n            this.modifiedNodeLength = undefined;\n        }\n        if (!isNullOrUndefined(this.modifiedProperties)) {\n            for (var i = 0; i < this.modifiedProperties.length; i++) {\n                var property = this.modifiedProperties[i];\n                if (property instanceof WCharacterFormat) {\n                    property.destroy();\n                }\n                else if (property instanceof WParagraphFormat) {\n                    property.destroy();\n                }\n                else if (property instanceof WSectionFormat) {\n                    property.destroy();\n                }\n                else if (property instanceof ModifiedLevel) {\n                    property.destroy();\n                }\n                this.modifiedProperties.splice(this.modifiedProperties.indexOf(property), 1);\n                i--;\n            }\n            this.modifiedPropertiesIn = undefined;\n        }\n        if (!isNullOrUndefined(this.removedNodes)) {\n            for (var i = 0; i < this.removedNodes.length; i++) {\n                var node = this.removedNodes[i];\n                if (node instanceof ParagraphWidget) {\n                    node.destroyInternal(this.viewer);\n                }\n                else if (node instanceof ElementBox) {\n                    node.destroy();\n                }\n                this.removedNodes.splice(this.removedNodes.indexOf(node), 1);\n                i--;\n            }\n            this.removedNodesIn = undefined;\n        }\n        this.ownerIn = undefined;\n    };\n    return BaseHistoryInfo;\n}());\nexport { BaseHistoryInfo };\n","import { isNullOrUndefined } from '@syncfusion/ej2-base';\nimport { PageLayoutViewer } from '../index';\nimport { Dictionary } from '../../base/dictionary';\nimport { ImageFormat } from '../selection/selection-helper';\nimport { Point, HelperMethods } from './editor-helper';\nimport { BaseHistoryInfo } from '../editor-history/base-history-info';\n/**\n * Image resizer implementation.\n */\nvar ImageResizer = /** @class */ (function () {\n    /**\n     * Constructor for image resizer module.\n     * @param {DocumentEditor} node\n     * @param {LayoutViewer} viewer\n     * @private\n     */\n    function ImageResizer(node, viewer) {\n        /**\n         * @private\n         */\n        this.resizeContainerDiv = undefined;\n        /**\n         * @private\n         */\n        this.topLeftRect = undefined;\n        /**\n         * @private\n         */\n        this.topMiddleRect = undefined;\n        /**\n         * @private\n         */\n        this.topRightRect = undefined;\n        /**\n         * @private\n         */\n        this.bottomLeftRect = undefined;\n        /**\n         * @private\n         */\n        this.bottomMiddleRect = undefined;\n        /**\n         * @private\n         */\n        this.bottomRightRect = undefined;\n        /**\n         * @private\n         */\n        this.leftMiddleRect = undefined;\n        /**\n         * @private\n         */\n        this.rightMiddleRect = undefined;\n        /**\n         * @private\n         */\n        this.topLeftRectParent = undefined;\n        /**\n         * @private\n         */\n        this.topMiddleRectParent = undefined;\n        /**\n         * @private\n         */\n        this.topRightRectParent = undefined;\n        /**\n         * @private\n         */\n        this.bottomLeftRectParent = undefined;\n        /**\n         * @private\n         */\n        this.bottomMiddleRectParent = undefined;\n        /**\n         * @private\n         */\n        this.bottomRightRectParent = undefined;\n        /**\n         * @private\n         */\n        this.leftMiddleRectParent = undefined;\n        /**\n         * @private\n         */\n        this.rightMiddleRectParent = undefined;\n        /**\n         * @private\n         */\n        this.resizeMarkSizeIn = 7;\n        /**\n         * @private\n         */\n        this.selectedImageWidget = undefined;\n        /**\n         * @private\n         */\n        this.baseHistoryInfo = undefined;\n        /**\n         * @private\n         */\n        this.isImageResizing = false;\n        /**\n         * @private\n         */\n        this.isImageResizerVisible = false;\n        /**\n         * @private\n         */\n        this.isImageMoveToNextPage = false;\n        /**\n         * @private\n         */\n        this.selectedResizeElement = undefined;\n        /**\n         * @private\n         */\n        this.topValue = undefined;\n        /**\n         * @private\n         */\n        this.leftValue = undefined;\n        this.owner = node;\n        this.selectedImageWidget = new Dictionary();\n        this.viewer = viewer;\n        this.imageResizerPoints = new ImageResizingPoints();\n        if (isNullOrUndefined(this.imageResizerDiv) && this.viewer && this.viewer.pageContainer) {\n            this.initializeImageResizer();\n        }\n    }\n    Object.defineProperty(ImageResizer.prototype, \"currentImageElementBox\", {\n        /**\n         * Gets or Sets the current image element box.\n         * @private\n         */\n        get: function () {\n            return this.currentImageElementBoxIn;\n        },\n        /**\n         * @private\n         */\n        set: function (value) {\n            this.currentImageElementBoxIn = value;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(ImageResizer.prototype, \"resizeMarkSize\", {\n        /**\n         * Gets or Sets the resize mark size.\n         * @private\n         */\n        get: function () {\n            return this.resizeMarkSizeIn;\n        },\n        /**\n         * @private\n         */\n        set: function (value) {\n            this.resizeMarkSizeIn = value;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    /**\n     * Gets module name.\n     */\n    ImageResizer.prototype.getModuleName = function () {\n        return 'ImageResizer';\n    };\n    //Image Resizing Methods\n    /**\n     * Sets image resizer position.\n     * @param {number} x - Specifies for image resizer left value.\n     * @param {number} y - Specifies for image resizer top value.\n     * @param {number} width - Specifies for image resizer width value.\n     * @param {number} height - Specifies for image resizer height value.\n     * @private\n     */\n    ImageResizer.prototype.setImageResizerPositions = function (x, y, width, height) {\n        this.imageResizerDivElement.style.top = y.toString() + 'px';\n        this.imageResizerDivElement.style.left = x.toString() + 'px';\n        this.imageResizerDivElement.style.borderWidth = '0px';\n        this.imageResizerDivElement.style.height = height + 'px';\n        this.imageResizerDivElement.style.width = width + 'px';\n        this.imageResizerDivElement.style.backgroundColor = 'transparent';\n        this.imageResizerDivElement.style.overflow = 'hidden';\n        this.imageResizerDivElement.style.position = 'absolute';\n    };\n    /**\n     * Creates image resizer DOM element.\n     * @private\n     */\n    ImageResizer.prototype.initializeImageResizer = function () {\n        this.imageResizerDivElement = document.createElement('div');\n        this.imageResizerDivElement.style.zIndex = '1';\n        this.imageResizerDivElement.style.display = 'none';\n        this.viewer.pageContainer.appendChild(this.imageResizerDivElement);\n    };\n    /**\n     * Position an image resizer\n     * @param {ImageElementBox} elementBox - Specifies the image position.\n     * @private\n     */\n    ImageResizer.prototype.positionImageResizer = function (elementBox) {\n        this.selectedImageWidget.clear();\n        // Initializes the image resizer on demand, i.e at the time of selecting an image for the first time.\n        var resizeDiv;\n        if (!isNullOrUndefined(this.viewer.currentPage)) {\n            resizeDiv = this.imageResizerDivElement;\n        }\n        if (!isNullOrUndefined(resizeDiv) && !resizeDiv.contains(this.imageResizerDiv)) {\n            this.imageResizerDiv = this.initResizeMarks(resizeDiv, this);\n        }\n        this.imageResizerDiv.style.width = (elementBox.width) + 'px';\n        this.imageResizerDiv.style.height = (elementBox.height) + 'px';\n        this.currentImageElementBox = elementBox;\n        var lineWidget = elementBox.line;\n        var top = this.viewer.selection.getTop(lineWidget) + elementBox.margin.top;\n        var left = this.viewer.selection.getLeftInternal(lineWidget, elementBox, 0);\n        var page = this.viewer.selection.getPage(lineWidget.paragraph);\n        this.currentPage = page;\n        var x = 0;\n        var y = 0;\n        if (!isNullOrUndefined(resizeDiv)) {\n            this.imageResizerDivElement.style.display = 'block';\n            resizeDiv.style.width = page.boundingRectangle.width + 'px';\n            resizeDiv.style.height = page.boundingRectangle.height + 'px';\n            resizeDiv.style.left = page.boundingRectangle.x + 'px';\n            resizeDiv.style.top = page.boundingRectangle.y + 'px';\n            resizeDiv.style.borderWidth = '0px';\n            resizeDiv.style.backgroundColor = 'transparent';\n            resizeDiv.style.overflow = 'hidden';\n            resizeDiv.style.position = 'absolute';\n        }\n        var horizontalWidth = 0;\n        var pageWidth = this.viewer.getPageWidth(page);\n        var pagelayout = this.viewer;\n        // tslint:disable-next-line:max-line-length\n        horizontalWidth = parseFloat(this.imageResizerDivElement.style.width);\n        x = (this.viewer.visibleBounds.width - horizontalWidth * this.viewer.zoomFactor) / 2;\n        if (x < 30) {\n            x = 30;\n        }\n        if (pageWidth < horizontalWidth) {\n            x += (horizontalWidth - pageWidth) * this.viewer.zoomFactor / 2;\n        }\n        // tslint:disable-next-line:max-line-length           \n        y = page.boundingRectangle.y * this.viewer.zoomFactor + (this.viewer.pages.indexOf(page) + 1) * 20 * (1 - this.viewer.zoomFactor);\n        var currentPageDiv = this.imageResizerDivElement;\n        var currentPageDivWidth = parseFloat(currentPageDiv.style.width);\n        var currentPageDivHeight = parseFloat(currentPageDiv.style.height);\n        var imageResizerDivWidth = parseFloat(this.imageResizerDiv.style.width);\n        var imageResizerDivHeight = parseFloat(this.imageResizerDiv.style.height);\n        var margin = (this.resizeMarkSize - 1) / 2;\n        var width = imageResizerDivWidth + 2 * margin;\n        var height = imageResizerDivHeight + 2 * margin;\n        if (width > (currentPageDivWidth - left) * this.viewer.zoomFactor + margin) {\n            width = (currentPageDivWidth - left) * this.viewer.zoomFactor;\n        }\n        if (height > (currentPageDivHeight - top) * this.viewer.zoomFactor + margin) {\n            height = (currentPageDivHeight - top) * this.viewer.zoomFactor;\n        }\n        // if (width < imageResizerDivHeight + margin || height < imageResizerDivHeight + margin) {\n        // }\n        // tslint:disable-next-line:max-line-length\n        this.imageResizerDivElement.style.width = parseInt(this.imageResizerDivElement.style.width.replace('px', ''), 10) * this.viewer.zoomFactor + 'px';\n        this.imageResizerDivElement.style.height = parseInt(this.imageResizerDivElement.style.height.replace('px', ''), 10) * this.viewer.zoomFactor + 'px';\n        height = this.viewer.render.getScaledValue(elementBox.height);\n        width = this.viewer.render.getScaledValue(elementBox.width);\n        left = this.viewer.render.getScaledValue(left);\n        top = this.viewer.render.getScaledValue(top);\n        this.setImageResizerPosition(left, top, width, height, this);\n        if (!this.selectedImageWidget.containsKey(lineWidget)) {\n            var selectedImageInfo = new SelectedImageInfo(elementBox.height, elementBox.width);\n            this.selectedImageWidget.add(lineWidget, selectedImageInfo);\n        }\n    };\n    /**\n     * Shows the image resizer.\n     * @private\n     */\n    ImageResizer.prototype.showImageResizer = function () {\n        if (!isNullOrUndefined(this.imageResizerDivElement)) {\n            this.imageResizerDivElement.style.display = '';\n        }\n        if (!isNullOrUndefined(this.resizeContainerDiv)) {\n            this.resizeContainerDiv.style.display = '';\n        }\n        if (!isNullOrUndefined(this.bottomLeftRect)) {\n            this.bottomLeftRect.style.display = '';\n            this.bottomLeftRectParent.style.display = '';\n        }\n        if (!isNullOrUndefined(this.bottomRightRect)) {\n            this.bottomRightRect.style.display = '';\n            this.bottomRightRectParent.style.display = '';\n        }\n        if (!isNullOrUndefined(this.bottomMiddleRect)) {\n            this.bottomMiddleRect.style.display = '';\n            this.bottomMiddleRectParent.style.display = '';\n        }\n        if (!isNullOrUndefined(this.rightMiddleRect)) {\n            this.rightMiddleRect.style.display = '';\n            this.rightMiddleRectParent.style.display = '';\n        }\n        if (!isNullOrUndefined(this.topRightRect)) {\n            this.topRightRect.style.display = '';\n            this.topRightRectParent.style.display = '';\n        }\n        if (!isNullOrUndefined(this.topLeftRect)) {\n            this.topLeftRect.style.display = '';\n            this.topLeftRectParent.style.display = '';\n        }\n        if (!isNullOrUndefined(this.leftMiddleRect)) {\n            this.leftMiddleRect.style.display = '';\n            this.leftMiddleRectParent.style.display = '';\n        }\n        if (!isNullOrUndefined(this.topMiddleRect)) {\n            this.topMiddleRect.style.display = '';\n            this.topMiddleRectParent.style.display = '';\n        }\n        this.isImageResizerVisible = true;\n    };\n    /**\n     * Hides the image resizer.\n     * @private\n     */\n    ImageResizer.prototype.hideImageResizer = function () {\n        if (!isNullOrUndefined(this.imageResizerDivElement)) {\n            this.imageResizerDivElement.style.display = 'none';\n        }\n        if (!isNullOrUndefined(this.resizeContainerDiv)) {\n            this.resizeContainerDiv.style.display = 'none';\n        }\n        if (!isNullOrUndefined(this.bottomLeftRect)) {\n            this.bottomLeftRect.style.display = 'none';\n            this.bottomLeftRectParent.style.display = 'none';\n        }\n        if (!isNullOrUndefined(this.bottomRightRect)) {\n            this.bottomRightRect.style.display = 'none';\n            this.bottomRightRectParent.style.display = 'none';\n        }\n        if (!isNullOrUndefined(this.bottomMiddleRect)) {\n            this.bottomMiddleRect.style.display = 'none';\n            this.bottomMiddleRectParent.style.display = 'none';\n        }\n        if (!isNullOrUndefined(this.rightMiddleRect)) {\n            this.rightMiddleRect.style.display = 'none';\n            this.rightMiddleRectParent.style.display = 'none';\n        }\n        if (!isNullOrUndefined(this.topRightRect)) {\n            this.topRightRect.style.display = 'none';\n            this.topRightRectParent.style.display = 'none';\n        }\n        if (!isNullOrUndefined(this.topLeftRect)) {\n            this.topLeftRect.style.display = 'none';\n            this.topLeftRectParent.style.display = 'none';\n        }\n        if (!isNullOrUndefined(this.leftMiddleRect)) {\n            this.leftMiddleRect.style.display = 'none';\n            this.leftMiddleRectParent.style.display = 'none';\n        }\n        if (!isNullOrUndefined(this.topMiddleRect)) {\n            this.topMiddleRect.style.display = 'none';\n            this.topMiddleRectParent.style.display = 'none';\n        }\n        this.isImageResizerVisible = false;\n        this.currentPage = undefined;\n    };\n    /**\n     * Initialize the resize marks.\n     * @param {HTMLElement} resizeDiv - Specifies to appending resizer container div element.\n     * @param {ImageResizer} imageResizer - Specifies to creating div element of each position.\n     * @private\n     */\n    // tslint:disable:max-func-body-length\n    ImageResizer.prototype.initResizeMarks = function (resizeDiv, imageResizer) {\n        this.initResizeContainerDiv(imageResizer);\n        resizeDiv.appendChild(imageResizer.resizeContainerDiv);\n        imageResizer.topRightRectParent = document.createElement('div');\n        imageResizer.topRightRectParent.style.cursor = 'ne-resize';\n        imageResizer.topRightRectParent.id = this.viewer.owner.containerId + '_TopRightRectParent';\n        this.applyProperties(imageResizer.topRightRectParent);\n        imageResizer.topRightRectParent.style.width = !this.viewer.isTouchInput ? '14px' : '30px';\n        imageResizer.topRightRectParent.style.height = !this.viewer.isTouchInput ? '14px' : '30px';\n        imageResizer.topRightRectParent.style.opacity = '-1';\n        resizeDiv.appendChild(imageResizer.topRightRectParent);\n        imageResizer.topRightRect = document.createElement('div');\n        imageResizer.topRightRect.id = this.viewer.owner.containerId + '_TopRightRect';\n        imageResizer.topRightRect.style.cursor = 'ne-resize';\n        this.applyProperties(imageResizer.topRightRect);\n        resizeDiv.appendChild(imageResizer.topRightRect);\n        imageResizer.topLeftRectParent = document.createElement('div');\n        imageResizer.topLeftRectParent.style.cursor = 'nw-resize';\n        imageResizer.topLeftRectParent.id = this.viewer.owner.containerId + '_TopLeftRectParent';\n        this.applyProperties(imageResizer.topLeftRectParent);\n        imageResizer.topLeftRectParent.style.width = !this.viewer.isTouchInput ? '14px' : '30px';\n        imageResizer.topLeftRectParent.style.height = !this.viewer.isTouchInput ? '14px' : '30px';\n        imageResizer.topLeftRectParent.style.opacity = '-1';\n        resizeDiv.appendChild(imageResizer.topLeftRectParent);\n        imageResizer.topLeftRect = document.createElement('div');\n        imageResizer.topLeftRect.id = this.viewer.owner.containerId + '_TopLeftRect';\n        imageResizer.topLeftRect.style.cursor = 'nw-resize';\n        this.applyProperties(imageResizer.topLeftRect);\n        resizeDiv.appendChild(imageResizer.topLeftRect);\n        imageResizer.topMiddleRectParent = document.createElement('div');\n        imageResizer.topMiddleRectParent.style.cursor = 'n-resize';\n        imageResizer.topMiddleRectParent.id = this.viewer.owner.containerId + '_TopMiddleRectParent';\n        this.applyProperties(imageResizer.topMiddleRectParent);\n        imageResizer.topMiddleRectParent.style.width = !this.viewer.isTouchInput ? '14px' : '30px';\n        imageResizer.topMiddleRectParent.style.height = !this.viewer.isTouchInput ? '14px' : '30px';\n        imageResizer.topMiddleRectParent.style.opacity = '-1';\n        resizeDiv.appendChild(imageResizer.topMiddleRectParent);\n        imageResizer.topMiddleRect = document.createElement('div');\n        imageResizer.topMiddleRect.id = this.viewer.owner.containerId + '_TopMiddleRect';\n        imageResizer.topMiddleRect.style.cursor = 'n-resize';\n        this.applyProperties(imageResizer.topMiddleRect);\n        resizeDiv.appendChild(imageResizer.topMiddleRect);\n        imageResizer.bottomRightRectParent = document.createElement('div');\n        imageResizer.bottomRightRectParent.style.cursor = 'se-resize';\n        imageResizer.bottomRightRectParent.id = this.viewer.owner.containerId + '_BottomRightRectParent';\n        this.applyProperties(imageResizer.bottomRightRectParent);\n        imageResizer.bottomRightRectParent.style.width = !this.viewer.isTouchInput ? '14px' : '30px';\n        imageResizer.bottomRightRectParent.style.height = !this.viewer.isTouchInput ? '14px' : '30px';\n        imageResizer.bottomRightRectParent.style.opacity = '-1';\n        resizeDiv.appendChild(imageResizer.bottomRightRectParent);\n        imageResizer.bottomRightRect = document.createElement('div');\n        imageResizer.bottomRightRect.id = this.viewer.owner.containerId + '_BottomRightRect';\n        imageResizer.bottomRightRect.style.cursor = 'se-resize';\n        this.applyProperties(imageResizer.bottomRightRect);\n        resizeDiv.appendChild(imageResizer.bottomRightRect);\n        imageResizer.bottomLeftRectParent = document.createElement('div');\n        imageResizer.bottomLeftRectParent.style.cursor = 'sw-resize';\n        imageResizer.bottomLeftRectParent.id = this.viewer.owner.containerId + '_BottomLeftRectParent';\n        this.applyProperties(imageResizer.bottomLeftRectParent);\n        imageResizer.bottomLeftRectParent.style.width = !this.viewer.isTouchInput ? '14px' : '30px';\n        imageResizer.bottomLeftRectParent.style.height = !this.viewer.isTouchInput ? '14px' : '30px';\n        imageResizer.bottomLeftRectParent.style.opacity = '-1';\n        resizeDiv.appendChild(imageResizer.bottomLeftRectParent);\n        imageResizer.bottomLeftRect = document.createElement('div');\n        imageResizer.bottomLeftRect.id = this.viewer.owner.containerId + '_BottomLeftRect';\n        imageResizer.bottomLeftRect.style.cursor = 'sw-resize';\n        this.applyProperties(imageResizer.bottomLeftRect);\n        resizeDiv.appendChild(imageResizer.bottomLeftRect);\n        imageResizer.bottomMiddleRectParent = document.createElement('div');\n        imageResizer.bottomMiddleRectParent.style.cursor = 's-resize';\n        imageResizer.bottomMiddleRectParent.id = this.viewer.owner.containerId + '_BottomMiddleRectParent';\n        this.applyProperties(imageResizer.bottomMiddleRectParent);\n        imageResizer.bottomMiddleRectParent.style.width = !this.viewer.isTouchInput ? '14px' : '30px';\n        imageResizer.bottomMiddleRectParent.style.height = !this.viewer.isTouchInput ? '14px' : '30px';\n        imageResizer.bottomMiddleRectParent.style.opacity = '-1';\n        resizeDiv.appendChild(imageResizer.bottomMiddleRectParent);\n        imageResizer.bottomMiddleRect = document.createElement('div');\n        imageResizer.bottomMiddleRect.id = this.viewer.owner.containerId + '_BottomMiddleRect';\n        imageResizer.bottomMiddleRect.style.cursor = 's-resize';\n        this.applyProperties(imageResizer.bottomMiddleRect);\n        resizeDiv.appendChild(imageResizer.bottomMiddleRect);\n        imageResizer.rightMiddleRectParent = document.createElement('div');\n        imageResizer.rightMiddleRectParent.style.cursor = 'e-resize';\n        imageResizer.rightMiddleRectParent.id = this.viewer.owner.containerId + '_RightMiddleRectParent';\n        this.applyProperties(imageResizer.rightMiddleRectParent);\n        imageResizer.rightMiddleRectParent.style.width = !this.viewer.isTouchInput ? '14px' : '30px';\n        imageResizer.rightMiddleRectParent.style.height = !this.viewer.isTouchInput ? '14px' : '30px';\n        imageResizer.rightMiddleRectParent.style.opacity = '-1';\n        resizeDiv.appendChild(imageResizer.rightMiddleRectParent);\n        imageResizer.rightMiddleRect = document.createElement('div');\n        imageResizer.rightMiddleRect.id = this.viewer.owner.containerId + '_RightMiddleRect';\n        imageResizer.rightMiddleRect.style.cursor = 'e-resize';\n        this.applyProperties(imageResizer.rightMiddleRect);\n        resizeDiv.appendChild(imageResizer.rightMiddleRect);\n        imageResizer.leftMiddleRectParent = document.createElement('div');\n        imageResizer.leftMiddleRectParent.style.cursor = 'w-resize';\n        imageResizer.leftMiddleRectParent.id = this.viewer.owner.containerId + '_LeftMiddleRectParent';\n        this.applyProperties(imageResizer.leftMiddleRectParent);\n        imageResizer.leftMiddleRectParent.style.width = !this.viewer.isTouchInput ? '14px' : '30px';\n        imageResizer.leftMiddleRectParent.style.height = !this.viewer.isTouchInput ? '14px' : '30px';\n        imageResizer.leftMiddleRectParent.style.opacity = '-1';\n        resizeDiv.appendChild(imageResizer.leftMiddleRectParent);\n        imageResizer.leftMiddleRect = document.createElement('div');\n        imageResizer.leftMiddleRect.id = this.viewer.owner.containerId + '_LeftMiddleRect';\n        imageResizer.leftMiddleRect.style.cursor = 'w-resize';\n        this.applyProperties(imageResizer.leftMiddleRect);\n        resizeDiv.appendChild(imageResizer.leftMiddleRect);\n        return imageResizer.resizeContainerDiv;\n    };\n    /**\n     * Sets the image resizer position.\n     * @param {number} left - Specifies for image resizer left value.\n     * @param {number} top - Specifies for image resizer top value.\n     * @param {number} width - Specifies for image resizer width value.\n     * @param {number} height - Specifies for image resizer height value.\n     * @param {ImageResizer} imageResizer - Specifies for image resizer.\n     * @private\n     */\n    ImageResizer.prototype.setImageResizerPosition = function (left, top, width, height, imageResizer) {\n        //Positions Updating For Image Resize Div\n        imageResizer.resizeContainerDiv.style.width = width + 'px';\n        imageResizer.resizeContainerDiv.style.height = height + 'px';\n        imageResizer.resizeContainerDiv.style.left = left - 1 + 'px';\n        imageResizer.resizeContainerDiv.style.top = top + 'px';\n        //Positions Updating For Image Resizing Points\n        imageResizer.topRightRect.style.left = ((left + width) - 5) + 'px';\n        imageResizer.topRightRect.style.top = (top - 4) + 'px';\n        imageResizer.topLeftRect.style.left = (left - 5) + 'px';\n        imageResizer.topLeftRect.style.top = (top - 4) + 'px';\n        imageResizer.topMiddleRect.style.left = ((parseFloat(imageResizer.topLeftRect.style.left) + (width / 2)) - 4) + 'px';\n        imageResizer.topMiddleRect.style.top = (top - 4) + 'px';\n        imageResizer.bottomRightRect.style.left = imageResizer.topRightRect.style.left;\n        imageResizer.bottomRightRect.style.top = (parseFloat(imageResizer.topRightRect.style.top) + height) + 'px';\n        imageResizer.bottomLeftRect.style.left = imageResizer.topLeftRect.style.left;\n        imageResizer.bottomLeftRect.style.top = (parseFloat(imageResizer.topLeftRect.style.top) + height) + 'px';\n        imageResizer.bottomMiddleRect.style.left = imageResizer.topMiddleRect.style.left;\n        imageResizer.bottomMiddleRect.style.top = (parseFloat(imageResizer.topMiddleRect.style.top) + height) + 'px';\n        imageResizer.rightMiddleRect.style.left = ((left + width) - 4) + 'px';\n        imageResizer.rightMiddleRect.style.top = (parseFloat(imageResizer.topRightRect.style.top) + (height / 2)) + 'px';\n        imageResizer.leftMiddleRect.style.left = imageResizer.topLeftRect.style.left;\n        imageResizer.leftMiddleRect.style.top = (parseFloat(imageResizer.topLeftRect.style.top) + (height / 2)) + 'px';\n        imageResizer.topRightRectParent.style.left = !this.viewer.isTouchInput ? ((left + width) - 8) + 'px' : ((left + width) - 15) + 'px';\n        imageResizer.topRightRectParent.style.top = !this.viewer.isTouchInput ? (top - 7) + 'px' : (top - 15) + 'px';\n        imageResizer.topLeftRectParent.style.left = !this.viewer.isTouchInput ? (left - 8) + 'px' : (left - 15) + 'px';\n        imageResizer.topLeftRectParent.style.top = !this.viewer.isTouchInput ? (top - 7) + 'px' : (top - 15) + 'px';\n        imageResizer.topMiddleRectParent.style.left = ((parseFloat(imageResizer.topLeftRectParent.style.left) + (width / 2)) - 4) + 'px';\n        imageResizer.topMiddleRectParent.style.top = !this.viewer.isTouchInput ? (top - 7) + 'px' : (top - 15) + 'px';\n        imageResizer.bottomRightRectParent.style.left = imageResizer.topRightRectParent.style.left;\n        imageResizer.bottomRightRectParent.style.top = (parseFloat(imageResizer.topRightRectParent.style.top) + height) + 'px';\n        imageResizer.bottomLeftRectParent.style.left = imageResizer.topLeftRectParent.style.left;\n        imageResizer.bottomLeftRectParent.style.top = (parseFloat(imageResizer.topLeftRectParent.style.top) + height) + 'px';\n        imageResizer.bottomMiddleRectParent.style.left = imageResizer.topMiddleRectParent.style.left;\n        imageResizer.bottomMiddleRectParent.style.top = (parseFloat(imageResizer.topMiddleRectParent.style.top) + height) + 'px';\n        // tslint:disable-next-line:max-line-length \n        imageResizer.rightMiddleRectParent.style.left = !this.viewer.isTouchInput ? ((left + width) - 7) + 'px' : ((left + width) - 15) + 'px';\n        imageResizer.rightMiddleRectParent.style.top = (parseFloat(imageResizer.topRightRectParent.style.top) + (height / 2)) + 'px';\n        imageResizer.leftMiddleRectParent.style.left = imageResizer.topLeftRectParent.style.left;\n        imageResizer.leftMiddleRectParent.style.top = (parseFloat(imageResizer.topLeftRectParent.style.top) + (height / 2)) + 'px';\n        this.setImageResizingPoints(imageResizer);\n        if (this.viewer.isTouchInput) {\n            this.applyPropertiesForTouch();\n        }\n        else {\n            this.applyPropertiesForMouse();\n        }\n    };\n    /**\n     * Sets the image resizing points.\n     * @param {ImageResizer} imageResizer - Specifies for position of each resizing elements.\n     * @private\n     */\n    ImageResizer.prototype.setImageResizingPoints = function (imageResizer) {\n        this.imageResizerPoints.resizeContainerDiv.x = parseFloat(imageResizer.resizeContainerDiv.style.left);\n        this.imageResizerPoints.resizeContainerDiv.y = parseFloat(imageResizer.resizeContainerDiv.style.top);\n        this.imageResizerPoints.bottomLeftRectParent.x = parseFloat(imageResizer.bottomLeftRectParent.style.left);\n        this.imageResizerPoints.bottomLeftRectParent.y = parseFloat(imageResizer.bottomLeftRectParent.style.top);\n        this.imageResizerPoints.bottomRightRectParent.x = parseFloat(imageResizer.bottomRightRectParent.style.left);\n        this.imageResizerPoints.bottomRightRectParent.y = parseFloat(imageResizer.bottomRightRectParent.style.top);\n        this.imageResizerPoints.bottomMiddleRectParent.x = parseFloat(imageResizer.bottomMiddleRectParent.style.left);\n        this.imageResizerPoints.bottomMiddleRectParent.y = parseFloat(imageResizer.bottomMiddleRectParent.style.top);\n        this.imageResizerPoints.topLeftRectParent.x = parseFloat(imageResizer.topLeftRectParent.style.left);\n        this.imageResizerPoints.topLeftRectParent.y = parseFloat(imageResizer.topLeftRectParent.style.top);\n        this.imageResizerPoints.topRightRectParent.x = parseFloat(imageResizer.topRightRectParent.style.left);\n        this.imageResizerPoints.topRightRectParent.y = parseFloat(imageResizer.topRightRectParent.style.top);\n        this.imageResizerPoints.topMiddleRectParent.x = parseFloat(imageResizer.topMiddleRectParent.style.left);\n        this.imageResizerPoints.topMiddleRectParent.y = parseFloat(imageResizer.topMiddleRectParent.style.top);\n        this.imageResizerPoints.leftMiddleRectParent.x = parseFloat(imageResizer.leftMiddleRectParent.style.left);\n        this.imageResizerPoints.leftMiddleRectParent.y = parseFloat(imageResizer.leftMiddleRectParent.style.top);\n        this.imageResizerPoints.rightMiddleRectParent.x = parseFloat(imageResizer.rightMiddleRectParent.style.left);\n        this.imageResizerPoints.rightMiddleRectParent.y = parseFloat(imageResizer.rightMiddleRectParent.style.top);\n    };\n    /**\n     * Initialize the resize container div element.\n     * @param {ImageResizer} imageResizer - Specifies for creating resize container div element.\n     * @private\n     */\n    ImageResizer.prototype.initResizeContainerDiv = function (imageResizer) {\n        imageResizer.resizeContainerDiv = document.createElement('div');\n        imageResizer.resizeContainerDiv.id = this.viewer.owner.containerId + '_ResizeDivElement';\n        imageResizer.resizeContainerDiv.style.position = 'absolute';\n        imageResizer.resizeContainerDiv.style.border = '1px solid #bfbfbf';\n        imageResizer.resizeContainerDiv.style.zIndex = '30';\n        imageResizer.resizeContainerDiv.style.backgroundColor = 'transparent';\n        imageResizer.resizeContainerDiv.style.display = 'block';\n    };\n    /**\n     * Apply the properties of each resize rectangle element.\n     * @param {HTMLDivElement} resizeRectElement - Specifies for applying properties to resize rectangle element.\n     * @private\n     */\n    ImageResizer.prototype.applyProperties = function (resizeRectElement) {\n        resizeRectElement.style.position = 'absolute';\n        resizeRectElement.style.width = '8px';\n        resizeRectElement.style.height = '8px';\n        resizeRectElement.style.fontSize = '0px';\n        resizeRectElement.style.zIndex = ' 551';\n        resizeRectElement.style.backgroundColor = '#ffffff';\n        resizeRectElement.style.border = '1px solid #bfbfbf';\n        resizeRectElement.style.boxShadow = '0 1px 2px 0 #bfbfbf 0.35';\n        resizeRectElement.style.color = '#000000';\n    };\n    /**\n     * Handles an image resizing.\n     * @param {number} x  - Specifies for left value while resizing.\n     * @param {number} y - Specifies for top value while resizing.\n     */\n    ImageResizer.prototype.handleImageResizing = function (touchPoint, prevX, prevY) {\n        prevX = prevX / this.viewer.zoomFactor;\n        prevY = prevY / this.viewer.zoomFactor;\n        this.leftValue = isNullOrUndefined(this.leftValue) ? prevX : this.leftValue;\n        this.topValue = isNullOrUndefined(this.topValue) ? prevY : this.topValue;\n        var points;\n        switch (this.selectedResizeElement.id.split('_')[1]) {\n            case 'TopRightRectParent':\n                points = this.topRightResizing(touchPoint);\n                prevX = points.left;\n                prevY = points.top;\n                break;\n            case 'TopLeftRectParent':\n                points = this.topLeftResizing(touchPoint);\n                prevX = -points.left;\n                prevY = -points.top;\n                break;\n            case 'TopMiddleRectParent':\n                prevX = 0;\n                prevY = this.topMiddleResizing(touchPoint);\n                break;\n            case 'BottomRightRectParent':\n                points = this.bottomRightResizing(touchPoint);\n                prevX = points.left;\n                prevY = points.top;\n                break;\n            case 'BottomLeftRectParent':\n                points = this.bottomLeftResizing(touchPoint);\n                prevX = -points.left;\n                prevY = -points.top;\n                break;\n            case 'BottomMiddleRectParent':\n                prevY = touchPoint.y - prevY;\n                prevX = 0;\n                break;\n            case 'RightMiddleRectParent':\n                prevX = touchPoint.x - prevX;\n                prevY = 0;\n                break;\n            case 'LeftMiddleRectParent':\n                prevX = this.leftMiddleResizing(touchPoint);\n                prevY = 0;\n                break;\n            default:\n                break;\n        }\n        if (prevX !== 0 || prevY !== 0) {\n            var widget = this.currentImageElementBox.line.paragraph;\n            var image = this.currentImageElementBox;\n            if (!isNullOrUndefined(widget) && widget.isInsideTable) {\n                var cellWidget = widget.containerWidget;\n                if (!isNullOrUndefined(cellWidget)) {\n                    var rowWidget = cellWidget.containerWidget;\n                    var imageHeight = HelperMethods.convertPointToPixel(image.height);\n                    var widgetHeight = rowWidget.height - imageHeight;\n                    if (prevY > 0 && rowWidget.y + widgetHeight + imageHeight + prevY > this.viewer.clientArea.bottom) {\n                        this.isImageMoveToNextPage = true;\n                    }\n                }\n            }\n            // tslint:disable-next-line:max-line-length \n            if (this.owner.enableHistoryMode) {\n                this.initHistoryForImageResizer(this.currentImageElementBox);\n            }\n            if (!isNullOrUndefined(this.currentImageElementBox)) {\n                // tslint:disable-next-line:max-line-length   \n                var width = this.currentImageElementBox.width + prevX > 10 ? this.currentImageElementBox.width + prevX : 10;\n                // tslint:disable-next-line:max-line-length \n                var height = this.currentImageElementBox.height + prevY > 10 ? this.currentImageElementBox.height + prevY : 10;\n                if (this.selectedResizeElement.id.split('_')[1] === 'BottomRightRectParent'\n                    || this.selectedResizeElement.id.split('_')[1] === 'TopRightRectParent'\n                    || this.selectedResizeElement.id.split('_')[1] === 'BottomLeftRectParent'\n                    || this.selectedResizeElement.id.split('_')[1] === 'TopLeftRectParent') {\n                    height = this.currentImageElementBox.height / this.currentImageElementBox.width * width;\n                    width = this.currentImageElementBox.width / this.currentImageElementBox.height * height;\n                }\n                this.currentImageElementBox.width = width;\n                this.currentImageElementBox.height = height;\n                var owner = this.currentImageElementBox.line.paragraph;\n                this.positionImageResizer(this.currentImageElementBox);\n            }\n            this.isImageResizing = true;\n        }\n    };\n    /**\n     * Handles image resizing on mouse.\n     * @param {MouseEvent} event - Specifies for image resizing using mouse event.\n     * @private\n     */\n    ImageResizer.prototype.handleImageResizingOnMouse = function (event) {\n        if (!isNullOrUndefined(this.selectedResizeElement)) {\n            var prevX = parseFloat(this.selectedResizeElement.style.left);\n            var prevY = parseFloat(this.selectedResizeElement.style.top);\n            var cursorPoint = new Point(event.offsetX, event.offsetY);\n            var touchPoint = this.viewer.findFocusedPage(cursorPoint, true);\n            this.handleImageResizing(touchPoint, prevX, prevY);\n        }\n    };\n    ImageResizer.prototype.topMiddleResizing = function (touchPoint) {\n        var prevY;\n        if (this.topValue >= touchPoint.y) {\n            prevY = this.topValue / touchPoint.y;\n            this.topValue = touchPoint.y;\n            if (this.viewer instanceof PageLayoutViewer) {\n                if (this.topValue <= this.viewer.pageGap) {\n                    prevY = 1;\n                }\n            }\n        }\n        else {\n            prevY = -(touchPoint.y / this.topValue);\n            this.topValue = touchPoint.y;\n            if (this.topValue === 0) {\n                prevY = -1;\n            }\n        }\n        return prevY;\n    };\n    ImageResizer.prototype.leftMiddleResizing = function (touchPoint) {\n        var prevX;\n        if (this.leftValue >= touchPoint.x) {\n            prevX = this.leftValue / touchPoint.x;\n            this.leftValue = touchPoint.x;\n            if (this.leftValue === 0) {\n                prevX = 1;\n                this.leftValue = parseFloat(this.selectedResizeElement.style.left);\n            }\n        }\n        else {\n            prevX = -(touchPoint.x / this.leftValue);\n            this.leftValue = touchPoint.x;\n        }\n        return prevX;\n    };\n    ImageResizer.prototype.topRightResizing = function (touchPoint) {\n        var points;\n        if (this.leftValue <= touchPoint.x && this.topValue >= touchPoint.y) {\n            points = this.getOuterResizingPoint(touchPoint);\n        }\n        else {\n            points = this.getInnerResizingPoint(touchPoint);\n        }\n        return points;\n    };\n    ImageResizer.prototype.topLeftResizing = function (touchPoint) {\n        var points;\n        if (this.leftValue >= touchPoint.x && this.topValue >= touchPoint.y) {\n            points = this.getOuterResizingPoint(touchPoint);\n        }\n        else {\n            points = this.getInnerResizingPoint(touchPoint);\n        }\n        return points;\n    };\n    ImageResizer.prototype.bottomRightResizing = function (touchPoint) {\n        var points;\n        if (this.leftValue <= touchPoint.x && this.topValue <= touchPoint.y) {\n            points = this.getOuterResizingPoint(touchPoint);\n        }\n        else {\n            points = this.getInnerResizingPoint(touchPoint);\n        }\n        return points;\n    };\n    ImageResizer.prototype.bottomLeftResizing = function (touchPoint) {\n        var points;\n        if (this.leftValue >= touchPoint.x && this.topValue <= touchPoint.y) {\n            points = this.getOuterResizingPoint(touchPoint);\n        }\n        else {\n            points = this.getInnerResizingPoint(touchPoint);\n        }\n        return points;\n    };\n    ImageResizer.prototype.getOuterResizingPoint = function (touchPoint) {\n        var prevX;\n        var prevY;\n        prevX = touchPoint.x - this.leftValue;\n        this.leftValue = touchPoint.x;\n        prevY = touchPoint.y - this.topValue;\n        this.topValue = touchPoint.y;\n        return { left: prevX, top: prevY };\n    };\n    ImageResizer.prototype.getInnerResizingPoint = function (touchPoint) {\n        var prevX;\n        var prevY;\n        prevX = -(this.leftValue - touchPoint.x);\n        this.leftValue = touchPoint.x;\n        prevY = -(this.topValue - touchPoint.y);\n        this.topValue = touchPoint.y;\n        return { left: prevX, top: prevY };\n    };\n    /**\n     * Handles image resizing on touch.\n     * @param {TouchEvent} touchEvent - Specifies for image resizing using touch event.\n     * @private\n     */\n    ImageResizer.prototype.handleImageResizingOnTouch = function (touchEvent) {\n        if (!isNullOrUndefined(this.selectedResizeElement)) {\n            var prevX = parseFloat(this.selectedResizeElement.style.left) + 24;\n            var prevY = parseFloat(this.selectedResizeElement.style.top) + 24;\n            var touch = touchEvent.touches;\n            var cursorPoint = new Point(touch[0].clientX, touch[0].clientY);\n            var touchPoint = this.viewer.findFocusedPage(cursorPoint, true);\n            if (isNullOrUndefined(this.currentImageElementBox) || isNullOrUndefined(this.currentImageElementBox)) {\n                return;\n            }\n            this.handleImageResizing(touchPoint, prevX, prevY);\n        }\n    };\n    /**\n     * Gets the image point of mouse.\n     * @param {Point} touchPoint - Specifies for resizer cursor position.\n     * @private\n     */\n    ImageResizer.prototype.getImagePoint = function (touchPoint) {\n        var x = this.viewer.render.getScaledValue(touchPoint.x, 1);\n        var y = this.viewer.render.getScaledValue(touchPoint.y, 2);\n        touchPoint = new Point(x, y);\n        var imageResizingPoints = this.imageResizerPoints;\n        var resizePosition = '';\n        var selectedElement = undefined;\n        var bottomMiddle = imageResizingPoints.bottomMiddleRectParent;\n        var bottomRight = imageResizingPoints.bottomRightRectParent;\n        var bottomLeft = imageResizingPoints.bottomLeftRectParent;\n        var topMiddle = imageResizingPoints.topMiddleRectParent;\n        var topRight = imageResizingPoints.topRightRectParent;\n        var topLeft = imageResizingPoints.topLeftRectParent;\n        var rightMiddle = imageResizingPoints.rightMiddleRectParent;\n        var leftMiddle = imageResizingPoints.leftMiddleRectParent;\n        if (!isNullOrUndefined(this.bottomMiddleRectParent) && this.bottomMiddleRectParent.style.display !== 'none') {\n            // tslint:disable-next-line:max-line-length   \n            if ((touchPoint.x > bottomMiddle.x && touchPoint.x <= bottomMiddle.x + 15) && (touchPoint.y > bottomMiddle.y && touchPoint.y <= bottomMiddle.y + 15)) {\n                selectedElement = this.bottomMiddleRectParent;\n                resizePosition = 's-resize';\n                // tslint:disable-next-line:max-line-length   \n            }\n            else if ((touchPoint.x > bottomRight.x && touchPoint.x <= bottomRight.x + 15) && (touchPoint.y > bottomRight.y && touchPoint.y <= bottomRight.y + 15)) {\n                selectedElement = this.bottomRightRectParent;\n                resizePosition = 'se-resize';\n                // tslint:disable-next-line:max-line-length   \n            }\n            else if ((touchPoint.x > bottomLeft.x && touchPoint.x <= bottomLeft.x + 15) && (touchPoint.y > bottomLeft.y && touchPoint.y <= bottomLeft.y + 15)) {\n                selectedElement = this.bottomLeftRectParent;\n                resizePosition = 'sw-resize';\n                // tslint:disable-next-line:max-line-length   \n            }\n            else if ((touchPoint.x > topMiddle.x && touchPoint.x <= topMiddle.x + 15) && (touchPoint.y > topMiddle.y && touchPoint.y <= topMiddle.y + 15)) {\n                selectedElement = this.topMiddleRectParent;\n                resizePosition = 'n-resize';\n                // tslint:disable-next-line:max-line-length   \n            }\n            else if ((touchPoint.x > topRight.x && touchPoint.x <= topRight.x + 15) && (touchPoint.y > topRight.y && touchPoint.y <= topRight.y + 15)) {\n                selectedElement = this.topRightRectParent;\n                resizePosition = 'ne-resize';\n                // tslint:disable-next-line:max-line-length   \n            }\n            else if ((touchPoint.x > topLeft.x && touchPoint.x <= topLeft.x + 15) && (touchPoint.y > topLeft.y && touchPoint.y <= topLeft.y + 15)) {\n                selectedElement = this.topLeftRectParent;\n                resizePosition = 'nw-resize';\n                // tslint:disable-next-line:max-line-length   \n            }\n            else if ((touchPoint.x > leftMiddle.x && touchPoint.x <= leftMiddle.x + 15) && (touchPoint.y > leftMiddle.y && touchPoint.y <= leftMiddle.y + 15)) {\n                selectedElement = this.leftMiddleRectParent;\n                resizePosition = 'w-resize';\n                // tslint:disable-next-line:max-line-length   \n            }\n            else if ((touchPoint.x > rightMiddle.x && touchPoint.x <= rightMiddle.x + 15) && (touchPoint.y > rightMiddle.y && touchPoint.y <= rightMiddle.y + 15)) {\n                selectedElement = this.rightMiddleRectParent;\n                resizePosition = 'e-resize';\n                // tslint:disable-next-line:max-line-length   \n            }\n            else if (!isNullOrUndefined(this.resizeContainerDiv) && (touchPoint.x > parseFloat(this.resizeContainerDiv.style.left)\n                && touchPoint.x <= (parseFloat(this.resizeContainerDiv.style.left) + parseFloat(this.resizeContainerDiv.style.width)))\n                && (touchPoint.y > parseFloat(this.resizeContainerDiv.style.top)\n                    // tslint:disable-next-line:max-line-length \n                    && touchPoint.y <= (parseFloat(this.resizeContainerDiv.style.top) + parseFloat(this.resizeContainerDiv.style.height)))) {\n                resizePosition = 'move';\n            }\n        }\n        return { 'selectedElement': selectedElement, 'resizePosition': resizePosition };\n    };\n    ImageResizer.prototype.applyPropertiesForMouse = function () {\n        if (!isNullOrUndefined(this.bottomLeftRectParent)) {\n            this.bottomMiddleRectParent.style.width = '14px';\n            this.bottomMiddleRectParent.style.height = '14px';\n            this.bottomRightRectParent.style.width = '14px';\n            this.bottomRightRectParent.style.height = '14px';\n            this.bottomLeftRectParent.style.width = '14px';\n            this.bottomLeftRectParent.style.height = '14px';\n            this.topMiddleRectParent.style.width = '14px';\n            this.topMiddleRectParent.style.height = '14px';\n            this.topRightRectParent.style.width = '14px';\n            this.topRightRectParent.style.height = '14px';\n            this.topLeftRectParent.style.width = '14px';\n            this.topLeftRectParent.style.height = '14px';\n            this.leftMiddleRectParent.style.width = '14px';\n            this.leftMiddleRectParent.style.height = '14px';\n            this.rightMiddleRectParent.style.width = '14px';\n            this.rightMiddleRectParent.style.height = '14px';\n        }\n    };\n    /**\n     * Gets the image point of touch.\n     * @param {Point} touchPoints - Specifies for resizer cursor position.\n     * @private\n     */\n    ImageResizer.prototype.getImagePointOnTouch = function (touchPoints) {\n        var x = this.viewer.render.getScaledValue(touchPoints.x, 1);\n        var y = this.viewer.render.getScaledValue(touchPoints.y, 2);\n        touchPoints = new Point(x, y);\n        var imageResizingPointsOnTouch = this.imageResizerPoints;\n        var resizePosition = '';\n        var selectedElements = undefined;\n        var bottomMiddle = imageResizingPointsOnTouch.bottomMiddleRectParent;\n        var bottomRight = imageResizingPointsOnTouch.bottomRightRectParent;\n        var bottomLeft = imageResizingPointsOnTouch.bottomLeftRectParent;\n        var topMiddle = imageResizingPointsOnTouch.topMiddleRectParent;\n        var topRight = imageResizingPointsOnTouch.topRightRectParent;\n        var topLeft = imageResizingPointsOnTouch.topLeftRectParent;\n        var rightMiddle = imageResizingPointsOnTouch.rightMiddleRectParent;\n        var leftMiddle = imageResizingPointsOnTouch.leftMiddleRectParent;\n        if (!isNullOrUndefined(this.bottomMiddleRectParent) && this.bottomMiddleRectParent.style.display !== 'none') {\n            // tslint:disable-next-line:max-line-length   \n            if ((touchPoints.x > bottomMiddle.x && touchPoints.x <= bottomMiddle.x + 25) && (touchPoints.y > bottomMiddle.y && touchPoints.y <= bottomMiddle.y + 25)) {\n                selectedElements = this.bottomMiddleRectParent;\n                resizePosition = 's-resize';\n                // tslint:disable-next-line:max-line-length   \n            }\n            else if ((touchPoints.x > bottomRight.x && touchPoints.x <= bottomRight.x + 25) && (touchPoints.y > bottomRight.y && touchPoints.y <= bottomRight.y + 25)) {\n                selectedElements = this.bottomRightRectParent;\n                resizePosition = 'se-resize';\n                // tslint:disable-next-line:max-line-length   \n            }\n            else if ((touchPoints.x > bottomLeft.x && touchPoints.x <= bottomLeft.x + 25) && (touchPoints.y > bottomLeft.y && touchPoints.y <= bottomLeft.y + 25)) {\n                selectedElements = this.bottomLeftRectParent;\n                resizePosition = 'sw-resize';\n                // tslint:disable-next-line:max-line-length   \n            }\n            else if ((touchPoints.x > topMiddle.x && touchPoints.x <= topMiddle.x + 25) && (touchPoints.y > topMiddle.y && touchPoints.y <= topMiddle.y + 25)) {\n                selectedElements = this.topMiddleRectParent;\n                resizePosition = 'n-resize';\n                // tslint:disable-next-line:max-line-length   \n            }\n            else if ((touchPoints.x > topRight.x && touchPoints.x <= topRight.x + 25) && (touchPoints.y > topRight.y && touchPoints.y <= topRight.y + 25)) {\n                selectedElements = this.topRightRectParent;\n                resizePosition = 'ne-resize';\n                // tslint:disable-next-line:max-line-length   \n            }\n            else if ((touchPoints.x > topLeft.x && touchPoints.x <= topLeft.x + 25) && (touchPoints.y > topLeft.y && touchPoints.y <= topLeft.y + 25)) {\n                selectedElements = this.topLeftRectParent;\n                resizePosition = 'nw-resize';\n                // tslint:disable-next-line:max-line-length   \n            }\n            else if ((touchPoints.x > leftMiddle.x && touchPoints.x <= leftMiddle.x + 25) && (touchPoints.y > leftMiddle.y && touchPoints.y <= leftMiddle.y + 25)) {\n                selectedElements = this.leftMiddleRectParent;\n                resizePosition = 'w-resize';\n                // tslint:disable-next-line:max-line-length   \n            }\n            else if ((touchPoints.x > rightMiddle.x && touchPoints.x <= rightMiddle.x + 25) && (touchPoints.y > rightMiddle.y && touchPoints.y <= rightMiddle.y + 25)) {\n                selectedElements = this.rightMiddleRectParent;\n                resizePosition = 'e-resize';\n                // tslint:disable-next-line:max-line-length   \n            }\n            else if (!isNullOrUndefined(this.resizeContainerDiv) && (touchPoints.x > parseFloat(this.resizeContainerDiv.style.left)\n                && touchPoints.x <= (parseFloat(this.resizeContainerDiv.style.left) + parseFloat(this.resizeContainerDiv.style.width)))\n                && (touchPoints.y > parseFloat(this.resizeContainerDiv.style.top)\n                    // tslint:disable-next-line:max-line-length \n                    && touchPoints.y <= (parseFloat(this.resizeContainerDiv.style.top) + parseFloat(this.resizeContainerDiv.style.height)))) {\n                resizePosition = 'move';\n            }\n        }\n        return { 'selectedElement': selectedElements, 'resizePosition': resizePosition };\n    };\n    ImageResizer.prototype.applyPropertiesForTouch = function () {\n        if (!isNullOrUndefined(this.bottomLeftRectParent)) {\n            this.bottomMiddleRectParent.style.width = '30px';\n            this.bottomMiddleRectParent.style.height = '30px';\n            this.bottomRightRectParent.style.width = '30px';\n            this.bottomRightRectParent.style.height = '30px';\n            this.bottomLeftRectParent.style.width = '30px';\n            this.bottomLeftRectParent.style.height = '30px';\n            this.topMiddleRectParent.style.width = '30px';\n            this.topMiddleRectParent.style.height = '30px';\n            this.topRightRectParent.style.width = '30px';\n            this.topRightRectParent.style.height = '30px';\n            this.topLeftRectParent.style.width = '30px';\n            this.topLeftRectParent.style.height = '30px';\n            this.leftMiddleRectParent.style.width = '30px';\n            this.leftMiddleRectParent.style.height = '30px';\n            this.rightMiddleRectParent.style.width = '30px';\n            this.rightMiddleRectParent.style.height = '30px';\n        }\n    };\n    /**\n     * @private\n     */\n    ImageResizer.prototype.mouseUpInternal = function () {\n        this.currentImageElementBox.width = parseFloat(this.imageResizerDiv.style.width) / this.viewer.zoomFactor;\n        this.currentImageElementBox.height = parseFloat(this.imageResizerDiv.style.height) / this.viewer.zoomFactor;\n        this.owner.isShiftingEnabled = true;\n        this.owner.editorModule.setOffsetValue(this.owner.selection);\n        this.viewer.layout.reLayoutParagraph(this.currentImageElementBox.line.paragraph, 0, 0);\n        this.owner.editorModule.reLayout(this.owner.selection, true);\n        this.viewer.updateScrollBars();\n    };\n    /**\n     * Initialize history for image resizer.\n     * @param {ImageResizer} imageResizer - Specifies for image resizer.\n     * @param {WImage} imageContainer - Specifies for an image.\n     * @private\n     */\n    ImageResizer.prototype.initHistoryForImageResizer = function (imageContainer) {\n        if (!isNullOrUndefined(this.owner) && isNullOrUndefined(this.baseHistoryInfo)) {\n            this.baseHistoryInfo = new BaseHistoryInfo(this.owner);\n            this.baseHistoryInfo.action = 'ImageResizing';\n            this.baseHistoryInfo.updateSelection();\n            this.baseHistoryInfo.modifiedProperties.push(new ImageFormat(imageContainer));\n        }\n    };\n    /**\n     * Updates histroy for image resizer.\n     * @private\n     */\n    ImageResizer.prototype.updateHistoryForImageResizer = function () {\n        if (!isNullOrUndefined(this.owner) && !isNullOrUndefined(this.baseHistoryInfo)) {\n            var imageFormat = this.baseHistoryInfo.modifiedProperties[0];\n            if (this.currentImageElementBox.width === imageFormat.width\n                && this.currentImageElementBox.height === imageFormat.height) {\n                this.baseHistoryInfo.modifiedProperties.pop();\n            }\n            else {\n                //Records the image size modifications\n                this.owner.editorHistory.recordChanges(this.baseHistoryInfo);\n            }\n            //Fires the content changed event for the image size modifications\n            this.baseHistoryInfo = undefined;\n        }\n    };\n    /**\n     * Updates image resize container when applying zooming\n     * @private\n     */\n    ImageResizer.prototype.updateImageResizerPosition = function () {\n        if (!isNullOrUndefined(this.currentImageElementBox)) {\n            var elementBox = this.currentImageElementBox;\n            var lineWidget = elementBox.line;\n            var top_1 = this.viewer.selection.getTop(lineWidget) + elementBox.margin.top;\n            var left = this.viewer.selection.getLeftInternal(lineWidget, elementBox, 0);\n            var topValue = top_1 * this.viewer.zoomFactor;\n            var leftValue = left * this.viewer.zoomFactor;\n            var height = this.viewer.render.getScaledValue(elementBox.height, 2);\n            var width = this.viewer.render.getScaledValue(elementBox.width, 1);\n            this.setImageResizerPosition(leftValue, topValue, width, height, this);\n        }\n    };\n    /**\n     * Dispose the internal objects which are maintained.\n     * @private\n     */\n    ImageResizer.prototype.destroy = function () {\n        if (!isNullOrUndefined(this.resizeContainerDiv)) {\n            this.resizeContainerDiv.innerHTML = '';\n        }\n        if (!isNullOrUndefined(this.topLeftRect)) {\n            this.topLeftRect.innerHTML = '';\n        }\n        if (!isNullOrUndefined(this.topMiddleRect)) {\n            this.topMiddleRect.innerHTML = '';\n        }\n        if (!isNullOrUndefined(this.topRightRect)) {\n            this.topRightRect.innerHTML = '';\n        }\n        if (!isNullOrUndefined(this.bottomLeftRect)) {\n            this.bottomLeftRect.innerHTML = '';\n        }\n        if (!isNullOrUndefined(this.bottomMiddleRect)) {\n            this.bottomMiddleRect.innerHTML = '';\n        }\n        if (!isNullOrUndefined(this.bottomRightRect)) {\n            this.bottomRightRect.innerHTML = '';\n        }\n        if (!isNullOrUndefined(this.leftMiddleRect)) {\n            this.leftMiddleRect.innerHTML = '';\n        }\n        if (!isNullOrUndefined(this.rightMiddleRect)) {\n            this.rightMiddleRect.innerHTML = '';\n        }\n        if (!isNullOrUndefined(this.imageResizerDiv)) {\n            this.imageResizerDiv.innerHTML = '';\n        }\n        if (!isNullOrUndefined(this.selectedImageWidget)) {\n            this.selectedImageWidget.destroy();\n        }\n        if (!isNullOrUndefined(this.imageResizerDivElement)) {\n            this.imageResizerDivElement.innerHTML = '';\n        }\n        this.imageResizerDivElement = undefined;\n        this.resizeContainerDiv = undefined;\n        this.topLeftRect = undefined;\n        this.topMiddleRect = undefined;\n        this.topRightRect = undefined;\n        this.bottomLeftRect = undefined;\n        this.bottomMiddleRect = undefined;\n        this.bottomRightRect = undefined;\n        this.leftMiddleRect = undefined;\n        this.rightMiddleRect = undefined;\n        this.imageResizerDiv = undefined;\n        this.selectedImageWidget = undefined;\n        this.isImageResizing = false;\n        this.isImageResizerVisible = false;\n        this.currentImageElementBoxIn = undefined;\n        //this.baseHistoryInfo = undefined;\n        this.resizeMarkSizeIn = undefined;\n        this.viewer = undefined;\n        this.owner = undefined;\n    };\n    return ImageResizer;\n}());\nexport { ImageResizer };\n/**\n * @private\n */\nvar ImageResizingPoints = /** @class */ (function () {\n    /**\n     * Constructor for image resizing points class.\n     */\n    function ImageResizingPoints() {\n        /**\n         * @private\n         */ this.resizeContainerDiv = new Point(0, 0);\n        /**\n         * @private\n         */\n        this.topLeftRectParent = new Point(0, 0);\n        /**\n         * @private\n         */\n        this.topMiddleRectParent = new Point(0, 0);\n        /**\n         * @private\n         */\n        this.topRightRectParent = new Point(0, 0);\n        /**\n         * @private\n         */\n        this.bottomLeftRectParent = new Point(0, 0);\n        /**\n         * @private\n         */\n        this.bottomMiddleRectParent = new Point(0, 0);\n        /**\n         * @private\n         */\n        this.bottomRightRectParent = new Point(0, 0);\n        /**\n         * @private\n         */\n        this.leftMiddleRectParent = new Point(0, 0);\n        /**\n         * @private\n         */\n        this.rightMiddleRectParent = new Point(0, 0);\n        var text = 'DocumentEditor';\n    }\n    return ImageResizingPoints;\n}());\nexport { ImageResizingPoints };\n/**\n * @private\n */\nvar SelectedImageInfo = /** @class */ (function () {\n    /**\n     * Constructor for selected image info class.\n     * @param {number} height - Specifies for height value.\n     * @param {number} width - Specifies for width value.\n     */\n    function SelectedImageInfo(height, width) {\n        this.heightIn = 0;\n        this.widthIn = 0;\n        this.heightIn = height;\n        this.widthIn = width;\n    }\n    Object.defineProperty(SelectedImageInfo.prototype, \"height\", {\n        /**\n         * Gets or Sets the height value.\n         * @private\n         */\n        get: function () {\n            return this.heightIn;\n        },\n        /**\n         * @private\n         */\n        set: function (value) {\n            this.heightIn = value;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(SelectedImageInfo.prototype, \"width\", {\n        /**\n         * Gets or Sets the width value.\n         * @private\n         */\n        get: function () {\n            return this.widthIn;\n        },\n        /**\n         * @private\n         */\n        set: function (value) {\n            this.widthIn = value;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    return SelectedImageInfo;\n}());\nexport { SelectedImageInfo };\n","var __extends = (this && this.__extends) || (function () {\n    var extendStatics = Object.setPrototypeOf ||\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nimport { isNullOrUndefined } from '@syncfusion/ej2-base';\nimport { BaseHistoryInfo } from './base-history-info';\n/**\n * EditorHistory preservation class\n */\n/**\n * @private\n */\nvar HistoryInfo = /** @class */ (function (_super) {\n    __extends(HistoryInfo, _super);\n    function HistoryInfo(node, isChild) {\n        var _this = _super.call(this, node) || this;\n        _this.isChildHistoryInfo = false;\n        _this.isChildHistoryInfo = isChild;\n        return _this;\n    }\n    Object.defineProperty(HistoryInfo.prototype, \"hasAction\", {\n        /**\n         * @private\n         */\n        get: function () {\n            return !isNullOrUndefined(this.modifiedActions);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    /**\n     * Adds the modified actions\n     * @param  {BaseHistoryInfo} baseHistoryInfo\n     * @private\n     */\n    HistoryInfo.prototype.addModifiedAction = function (baseHistoryInfo) {\n        // For complex actions such as Replace text, Insert/Remove Hyperlink etc.\n        if (!(this.editorHistory.isUndoing || this.editorHistory.isRedoing)) {\n            if (isNullOrUndefined(this.modifiedActions)) {\n                this.modifiedActions = [];\n            }\n            this.modifiedActions.push(baseHistoryInfo);\n        }\n    };\n    /**\n     * Reverts this instance\n     * @private\n     */\n    HistoryInfo.prototype.revert = function () {\n        this.editorHistory.currentHistoryInfo = this;\n        if (this.action === 'BordersAndShading') {\n            this.owner.editorModule.isBordersAndShadingDialog = true;\n        }\n        if (!isNullOrUndefined(this.modifiedActions)) {\n            if (this.editorHistory.isUndoing) {\n                var i = this.modifiedActions.length;\n                while (i > 0) {\n                    var baseHistoryInfo = this.modifiedActions[i - 1];\n                    baseHistoryInfo.revert();\n                    i = i - 1;\n                }\n            }\n            else {\n                var i = 0;\n                while (i < this.modifiedActions.length) {\n                    var baseHistoryInfo = this.modifiedActions[i];\n                    baseHistoryInfo.revert();\n                    i = i + 1;\n                }\n            }\n        }\n        if (!this.isChildHistoryInfo) {\n            this.editorHistory.updateComplexHistory();\n        }\n        else {\n            this.editorHistory.updateComplexHistoryInternal();\n        }\n    };\n    /**\n     * @private\n     */\n    HistoryInfo.prototype.destroy = function () {\n        if (!isNullOrUndefined(this.modifiedActions)) {\n            while (this.modifiedActions.length > 0) {\n                var baseHistoryInfo = this.modifiedActions[this.modifiedActions.length - 1];\n                baseHistoryInfo.destroy();\n                this.modifiedActions.splice(this.modifiedActions.indexOf(baseHistoryInfo), 1);\n            }\n            this.modifiedActions = undefined;\n        }\n        _super.prototype.destroy.call(this);\n    };\n    return HistoryInfo;\n}(BaseHistoryInfo));\nexport { HistoryInfo };\n","import { Dictionary } from '../../base/dictionary';\nimport { TextPosition } from '../selection/selection-helper';\nimport { isNullOrUndefined } from '@syncfusion/ej2-base';\nimport { BaseHistoryInfo, } from './base-history-info';\nimport { ModifiedParagraphFormat, ModifiedLevel, RowHistoryFormat, TableHistoryInfo } from './history-helper';\nimport { HistoryInfo } from './history-info';\nimport { WParagraphFormat } from '../format/paragraph-format';\nimport { HelperMethods } from '../editor/editor-helper';\n/**\n *  `EditorHistory` Module class is used to handle history preservation\n */\nvar EditorHistory = /** @class */ (function () {\n    /**\n     * @private\n     */\n    function EditorHistory(node) {\n        //Fields\n        this.undoStackIn = [];\n        this.redoStackIn = [];\n        this.historyInfoStack = [];\n        /**\n         * @private\n         */\n        this.isUndoing = false;\n        /**\n         * @private\n         */\n        this.isRedoing = false;\n        this.owner = node;\n        this.viewer = node.viewer;\n        this.modifiedParaFormats = new Dictionary();\n        this.undoLimitIn = 500;\n        this.redoLimitIn = 500;\n    }\n    Object.defineProperty(EditorHistory.prototype, \"currentHistoryInfo\", {\n        /**\n         * @private\n         */\n        get: function () {\n            return this.historyInfoStack && this.historyInfoStack.length > 0 ?\n                this.historyInfoStack[this.historyInfoStack.length - 1] : undefined;\n        },\n        set: function (value) {\n            if (value instanceof HistoryInfo) {\n                this.historyInfoStack.push(value);\n            }\n            else {\n                this.historyInfoStack.pop();\n            }\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(EditorHistory.prototype, \"undoStack\", {\n        //Properties\n        /**\n         * gets undo stack\n         * @private\n         */\n        get: function () { return this.undoStackIn; },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(EditorHistory.prototype, \"redoStack\", {\n        /**\n         * gets redo stack\n         * @private\n         */\n        get: function () { return this.redoStackIn; },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(EditorHistory.prototype, \"undoLimit\", {\n        /**\n         * Gets or Sets the limit of undo operations can be done.\n         */\n        get: function () {\n            return isNullOrUndefined(this.undoLimitIn) ? 0 : this.undoLimitIn;\n        },\n        set: function (value) {\n            if (value < 0) {\n                throw new Error('The limit should be greater than or equal to zero.');\n            }\n            this.undoLimitIn = value;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(EditorHistory.prototype, \"redoLimit\", {\n        /**\n         * Gets or Sets the limit of redo operations can be done.\n         */\n        get: function () {\n            return isNullOrUndefined(this.redoLimitIn) ? 0 : this.redoLimitIn;\n        },\n        set: function (value) {\n            if (value < 0) {\n                throw new Error('The limit should be greater than or equal to zero.');\n            }\n            this.redoLimitIn = value;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    /**\n     * @private\n     */\n    EditorHistory.prototype.getModuleName = function () {\n        return 'EditorHistory';\n    };\n    /**\n     * Determines whether undo operation can be done.\n     * @returns boolean\n     */\n    EditorHistory.prototype.canUndo = function () {\n        return !isNullOrUndefined(this.undoStack) && this.undoStack.length > 0;\n    };\n    /**\n     * Determines whether redo operation can be done.\n     * @returns boolean\n     */\n    EditorHistory.prototype.canRedo = function () {\n        return !isNullOrUndefined(this.redoStack) && this.redoStack.length > 0;\n    };\n    //EditorHistory Initialization    \n    /**\n     * initialize EditorHistory\n     * @param  {Selection} selection\n     * @param  {Action} action\n     * @param  {SelectionRange} selectionRange\n     * @private\n     */\n    EditorHistory.prototype.initializeHistory = function (action) {\n        this.currentBaseHistoryInfo = new BaseHistoryInfo(this.owner);\n        this.currentBaseHistoryInfo.action = action;\n        this.currentBaseHistoryInfo.updateSelection();\n    };\n    /**\n     * Initialize complex history\n     * @param  {Selection} selection\n     * @param  {Action} action\n     * @private\n     */\n    EditorHistory.prototype.initComplexHistory = function (selection, action) {\n        this.currentHistoryInfo = new HistoryInfo(selection.owner, !isNullOrUndefined(this.currentHistoryInfo));\n        this.currentHistoryInfo.action = action;\n        this.currentHistoryInfo.updateSelection();\n    };\n    /**\n     * @private\n     */\n    EditorHistory.prototype.initResizingHistory = function (startingPoint, tableResize) {\n        if (tableResize.resizeNode === 1) {\n            this.initializeHistory('RowResizing');\n            if (!isNullOrUndefined(this.currentBaseHistoryInfo)) {\n                // tslint:disable-next-line:max-line-length\n                this.currentBaseHistoryInfo.modifiedProperties.push(new RowHistoryFormat(startingPoint, tableResize.currentResizingTable.childWidgets[tableResize.resizerPosition].rowFormat));\n            }\n        }\n        else {\n            this.initializeHistory('CellResizing');\n            if (this.currentBaseHistoryInfo) {\n                tableResize.currentResizingTable = tableResize.currentResizingTable.combineWidget(this.viewer);\n                var tableHistoryInfo = new TableHistoryInfo(tableResize.currentResizingTable, this.owner);\n                tableHistoryInfo.startingPoint = startingPoint;\n                this.currentBaseHistoryInfo.modifiedProperties.push(tableHistoryInfo);\n            }\n        }\n    };\n    /**\n     * Update resizing history\n     * @param  {Point} point\n     * @param  {Selection} selection\n     * @private\n     */\n    EditorHistory.prototype.updateResizingHistory = function (point, tableResize) {\n        if (tableResize.resizeNode === 1) {\n            if (!isNullOrUndefined(this.currentBaseHistoryInfo)) {\n                var rowHistoryFormat = this.currentBaseHistoryInfo.modifiedProperties[0];\n                if (rowHistoryFormat.startingPoint.y === point.y) {\n                    this.currentBaseHistoryInfo.modifiedProperties.length = 0;\n                }\n                else {\n                    rowHistoryFormat.displacement = HelperMethods.convertPixelToPoint(point.y - rowHistoryFormat.startingPoint.y);\n                    this.recordChanges(this.currentBaseHistoryInfo);\n                    this.currentBaseHistoryInfo = undefined;\n                }\n            }\n        }\n        else {\n            if (!isNullOrUndefined(this.currentBaseHistoryInfo)) {\n                var cellHistoryFormat = this.currentBaseHistoryInfo.modifiedProperties[0];\n                if (cellHistoryFormat.startingPoint.x === point.x) {\n                    this.currentBaseHistoryInfo.modifiedProperties.length = 0;\n                }\n                else {\n                    cellHistoryFormat.displacement = HelperMethods.convertPixelToPoint(point.x - cellHistoryFormat.startingPoint.x);\n                    cellHistoryFormat.endIndex = tableResize.getCellReSizerPosition(point);\n                    this.owner.editorHistory.recordChanges(this.currentBaseHistoryInfo);\n                    this.currentBaseHistoryInfo = undefined;\n                }\n            }\n        }\n    };\n    /**\n     * Record the changes\n     * @param  {BaseHistoryInfo} baseHistoryInfo\n     * @private\n     */\n    EditorHistory.prototype.recordChanges = function (baseHistoryInfo) {\n        if (!this.owner.enableHistoryMode) {\n            return;\n        }\n        if (this.isUndoing) {\n            if (isNullOrUndefined(this.redoStack)) {\n                this.redoStackIn = [];\n            }\n            if (this.redoStack.length === this.redoLimit && this.redoLimit > 0) {\n                var count = this.undoLimit > 20 ? 10 : 1;\n                this.redoStackIn.splice(0, count);\n            }\n            if (this.redoStack.length < this.redoLimit) {\n                this.redoStack.push(baseHistoryInfo);\n            }\n        }\n        else {\n            if (!this.isRedoing) {\n                this.clearRedoStack();\n            }\n            if (isNullOrUndefined(this.undoStack)) {\n                this.undoStackIn = [];\n            }\n            if (this.undoStack.length === this.undoLimit && this.undoLimit > 0) {\n                var count = this.undoLimit > 20 ? 10 : 1;\n                this.undoStackIn.splice(0, count);\n            }\n            if (this.undoStack.length < this.undoLimit) {\n                this.undoStackIn.push(baseHistoryInfo);\n            }\n        }\n    };\n    /**\n     * update EditorHistory\n     * @private\n     */\n    EditorHistory.prototype.updateHistory = function () {\n        if (this.viewer.owner.enableHistoryMode && !isNullOrUndefined(this.currentBaseHistoryInfo)) {\n            //Updates the current end position\n            if (!isNullOrUndefined(this.currentBaseHistoryInfo)\n                && isNullOrUndefined(this.currentBaseHistoryInfo.endPosition)) {\n                this.currentBaseHistoryInfo.endPosition = this.currentBaseHistoryInfo.insertPosition;\n            }\n            if (!isNullOrUndefined(this.currentHistoryInfo)) {\n                this.currentHistoryInfo.addModifiedAction(this.currentBaseHistoryInfo);\n            }\n            else {\n                this.recordChanges(this.currentBaseHistoryInfo);\n            }\n            this.currentBaseHistoryInfo = undefined;\n        }\n    };\n    /**\n     * @private\n     */\n    EditorHistory.prototype.isHandledComplexHistory = function () {\n        var isHandledComplexHistory = false;\n        if (!(this.isUndoing || this.isRedoing)) {\n            isHandledComplexHistory = this.owner.editorModule.insertRemoveBookMarkElements();\n        }\n        if (this.viewer.owner.enableHistoryMode && !isNullOrUndefined(this.currentHistoryInfo)) {\n            this.updateHistory();\n            isHandledComplexHistory = true;\n        }\n        else if (this.owner.editorModule.isHandledComplex) {\n            isHandledComplexHistory = true;\n        }\n        return isHandledComplexHistory;\n    };\n    /**\n     * Update complex history\n     * @private\n     */\n    EditorHistory.prototype.updateComplexHistory = function () {\n        var selection = this.viewer.selection;\n        if (this.currentHistoryInfo.hasAction) {\n            if (this.currentHistoryInfo.action === 'AutoFormatHyperlink') {\n                var startPosition = new TextPosition(selection.owner);\n                this.owner.editorModule.setPositionForCurrentIndex(startPosition, this.currentHistoryInfo.insertPosition);\n                // this.reLayoutParagraph(startPosition.paragraph, 0);\n                if (selection.owner.editorHistory.isUndoing) {\n                    this.owner.editorModule.setPositionForCurrentIndex(selection.start, this.currentHistoryInfo.selectionStart);\n                    this.owner.editorModule.setPositionForCurrentIndex(selection.end, this.currentHistoryInfo.selectionEnd);\n                }\n                else {\n                    this.owner.editorModule.setPositionForCurrentIndex(selection.start, this.currentHistoryInfo.endPosition);\n                    this.owner.editorModule.setPositionForCurrentIndex(selection.end, this.currentHistoryInfo.endPosition);\n                }\n            }\n            if (this.currentHistoryInfo.action === 'InsertHyperlink') {\n                var startPosition = new TextPosition(selection.owner);\n                this.owner.editorModule.setPositionForCurrentIndex(startPosition, this.currentHistoryInfo.insertPosition);\n                var endPosition = new TextPosition(selection.owner);\n                this.owner.editorModule.setPositionForCurrentIndex(endPosition, this.currentHistoryInfo.endPosition);\n                this.viewer.layout.reLayoutParagraph(startPosition.paragraph, 0, 0);\n                if (endPosition.paragraph !== startPosition.paragraph) {\n                    this.viewer.layout.reLayoutParagraph(endPosition.paragraph, 0, 0);\n                }\n            }\n            if (this.currentHistoryInfo.action === 'ReplaceAll') {\n                this.owner.editorModule.layoutWholeDocument();\n            }\n            else if (selection.owner.isShiftingEnabled) {\n                this.viewer.layout.shiftLayoutedItems();\n                if (this.owner.enableHeaderAndFooter) {\n                    this.owner.editorModule.updateHeaderFooterWidget();\n                }\n                this.viewer.removeEmptyPages();\n            }\n        }\n        selection.owner.isShiftingEnabled = false;\n        selection.owner.isLayoutEnabled = true;\n        // // selection.addMultipleSelectionRanges();\n        selection.start.updatePhysicalPosition(true);\n        if (selection.isEmpty) {\n            selection.end.setPositionInternal(selection.start);\n        }\n        else {\n            selection.end.updatePhysicalPosition(true);\n        }\n        selection.upDownSelectionLength = selection.end.location.x;\n        this.viewer.updateScrollBars();\n        selection.fireSelectionChanged(true);\n        this.viewer.updateFocus();\n        this.updateComplexHistoryInternal();\n        this.owner.editorModule.fireContentChange();\n    };\n    /**\n     * @private\n     */\n    EditorHistory.prototype.updateComplexHistoryInternal = function () {\n        if (!isNullOrUndefined(this.currentHistoryInfo)) {\n            //Updates the current end position\n            if (isNullOrUndefined(this.currentHistoryInfo.endPosition)) {\n                this.currentHistoryInfo.endPosition = this.currentHistoryInfo.insertPosition;\n            }\n            if (this.historyInfoStack.length > 1) {\n                var historyInfo = this.historyInfoStack[this.historyInfoStack.length - 2];\n                historyInfo.addModifiedAction(this.currentHistoryInfo);\n            }\n            else {\n                this.recordChanges(this.currentHistoryInfo);\n            }\n            this.currentHistoryInfo = undefined;\n        }\n    };\n    //List history preservation undo API\n    /**\n     * update list changes for history preservation\n     * @param  {Selection} selection\n     * @param  {WAbstractList} currentAbstractList\n     * @param  {WList} list\n     * @private\n     */\n    EditorHistory.prototype.updateListChangesInHistory = function (currentAbstractList, list) {\n        this.currentBaseHistoryInfo = new BaseHistoryInfo(this.viewer.owner);\n        this.currentBaseHistoryInfo.action = 'List';\n        this.currentBaseHistoryInfo.updateSelection();\n        var collection = new Dictionary();\n        for (var i = 0; i < currentAbstractList.levels.length; i++) {\n            var levels = this.viewer.getAbstractListById(list.abstractListId).levels[i];\n            var value = this.currentBaseHistoryInfo.addModifiedPropertiesForList(levels);\n            var modifiedLevel = new ModifiedLevel(levels, currentAbstractList.levels[i]);\n            if (!isNullOrUndefined(levels)) {\n                this.viewer.owner.editorModule.copyListLevel(levels, currentAbstractList.levels[i]);\n            }\n            collection.add(i, modifiedLevel);\n        }\n        return collection;\n    };\n    /**\n     * Apply list changes\n     * @param  {Selection} selection\n     * @param  {Dictionary<number, ModifiedLevel>} modifiedLevelsInternal\n     * @private\n     */\n    EditorHistory.prototype.applyListChanges = function (selection, modifiedLevelsInternal) {\n        if (isNullOrUndefined(this.modifiedParaFormats)) {\n            this.modifiedParaFormats = new Dictionary();\n        }\n        var collection = [];\n        for (var i = 0; i < this.viewer.listParagraphs.length; i++) {\n            var paragraph = this.viewer.listParagraphs[i];\n            var paraFormat = paragraph.paragraphFormat;\n            var currentList = this.viewer.getListById(paraFormat.listFormat.listId);\n            var listLevel = this.viewer.layout.getListLevel(currentList, paraFormat.listFormat.listLevelNumber);\n            // tslint:disable-next-line:max-line-length\n            if (modifiedLevelsInternal.containsKey(paraFormat.listFormat.listLevelNumber)\n                && modifiedLevelsInternal.get(paraFormat.listFormat.listLevelNumber).ownerListLevel === listLevel) {\n                var modifiedFormat = new WParagraphFormat(null);\n                modifiedFormat.leftIndent = paraFormat.leftIndent;\n                modifiedFormat.firstLineIndent = paraFormat.firstLineIndent;\n                var modified = new ModifiedParagraphFormat(paraFormat, modifiedFormat);\n                collection.push(modified);\n                this.owner.editorModule.copyFromListLevelParagraphFormat(paraFormat, listLevel.paragraphFormat);\n            }\n        }\n        this.modifiedParaFormats.add(this.currentBaseHistoryInfo, collection);\n    };\n    /**\n     * Update list changes\n     * @param  {Dictionary<number, ModifiedLevel>} modifiedCollection\n     * @param  {Selection} selection\n     * @private\n     */\n    EditorHistory.prototype.updateListChanges = function (modifiedCollection) {\n        this.viewer.owner.isLayoutEnabled = false;\n        this.owner.editorModule.updateListParagraphs();\n        for (var i = 0; i < modifiedCollection.keys.length; i++) {\n            var levelNumber = modifiedCollection.keys[0];\n            var modifiedLevel = modifiedCollection.get(levelNumber);\n            if (!isNullOrUndefined(this.currentBaseHistoryInfo)) {\n                // tslint:disable-next-line:max-line-length\n                modifiedLevel = this.currentBaseHistoryInfo.addModifiedPropertiesForList(modifiedLevel.ownerListLevel);\n            }\n            this.owner.editorModule.copyListLevel(modifiedLevel.ownerListLevel, modifiedLevel.modifiedListLevel);\n        }\n        this.revertListChanges();\n        this.viewer.owner.isLayoutEnabled = true;\n        this.viewer.renderedLists.clear();\n        this.viewer.pages = [];\n        this.viewer.layout.layout();\n        var selection = this.viewer.selection;\n        selection.start.updatePhysicalPosition(true);\n        if (selection.isEmpty) {\n            selection.end.setPositionInternal(selection.start);\n        }\n        else {\n            selection.end.updatePhysicalPosition(true);\n        }\n        selection.upDownSelectionLength = selection.end.location.x;\n        selection.fireSelectionChanged(false);\n        this.updateHistory();\n    };\n    /**\n     * Revert list changes\n     * @param  {Selection} selection\n     */\n    EditorHistory.prototype.revertListChanges = function () {\n        // tslint:disable-next-line:max-line-length\n        if (!isNullOrUndefined(this.currentBaseHistoryInfo)\n            && this.viewer.owner.editorHistory.modifiedParaFormats.containsKey(this.currentBaseHistoryInfo)) {\n            // tslint:disable-next-line:max-line-length\n            var collection = this.modifiedParaFormats.get(this.currentBaseHistoryInfo);\n            for (var i = 0; i < collection.length; i++) {\n                var modified = new WParagraphFormat(null);\n                modified.leftIndent = collection[i].ownerFormat.leftIndent;\n                modified.firstLineIndent = collection[i].ownerFormat.firstLineIndent;\n                collection[i].ownerFormat.copyFormat(collection[i].modifiedFormat);\n                collection[i].modifiedFormat.leftIndent = modified.leftIndent;\n                collection[i].modifiedFormat.firstLineIndent = modified.firstLineIndent;\n            }\n        }\n    };\n    /**\n     * Reverts the last editing action.\n     */\n    EditorHistory.prototype.undo = function () {\n        if (this.owner.isReadOnlyMode || !this.canUndo() || !this.owner.enableHistoryMode) {\n            return;\n        }\n        //this.owner.ClearTextSearchResults();\n        var historyInfo = this.undoStack.pop();\n        this.isUndoing = true;\n        historyInfo.revert();\n        this.isUndoing = false;\n        this.owner.selection.checkForCursorVisibility();\n        this.owner.editorModule.isBordersAndShadingDialog = false;\n    };\n    /**\n     * Performs the last reverted action.\n     */\n    EditorHistory.prototype.redo = function () {\n        if (this.owner.isReadOnlyMode || !this.canRedo() || !this.owner.enableHistoryMode) {\n            return;\n        }\n        //this.owner.ClearTextSearchResults();\n        var historyInfo = this.redoStack.pop();\n        if (historyInfo.action === 'BordersAndShading') {\n            this.owner.editorModule.isBordersAndShadingDialog = true;\n        }\n        this.isRedoing = true;\n        historyInfo.revert();\n        this.isRedoing = false;\n        this.owner.selection.checkForCursorVisibility();\n        this.owner.editorModule.isBordersAndShadingDialog = false;\n    };\n    /**\n     * @private\n     */\n    EditorHistory.prototype.destroy = function () {\n        this.clearHistory();\n        this.undoStackIn = undefined;\n        this.redoStackIn = undefined;\n    };\n    EditorHistory.prototype.clearHistory = function () {\n        this.clearUndoStack();\n        this.clearRedoStack();\n    };\n    EditorHistory.prototype.clearUndoStack = function () {\n        if (this.canUndo()) {\n            while (this.undoStack.length > 0) {\n                var historyInfo = this.undoStack.pop();\n                historyInfo.destroy();\n                historyInfo = undefined;\n            }\n        }\n    };\n    EditorHistory.prototype.clearRedoStack = function () {\n        if (this.canRedo()) {\n            while (this.redoStack.length > 0) {\n                var historyInfo = this.redoStack.pop();\n                historyInfo.destroy();\n                historyInfo = undefined;\n            }\n        }\n    };\n    return EditorHistory;\n}());\nexport { EditorHistory };\n","import { ZipArchive, ZipArchiveItem } from '@syncfusion/ej2-compression';\nimport { XmlWriter } from '@syncfusion/ej2-file-utils';\nimport { isNullOrUndefined } from '@syncfusion/ej2-base';\nimport { Dictionary } from '../../index';\n/**\n * Exports the document to Word format.\n */\nvar WordExport = /** @class */ (function () {\n    function WordExport() {\n        //Part path\n        this.documentPath = 'word/document.xml';\n        this.stylePath = 'word/styles.xml';\n        this.numberingPath = 'word/numbering.xml';\n        this.settingsPath = 'word/settings.xml';\n        this.headerPath = 'word/header';\n        this.footerPath = 'word/footer';\n        //private commentsPath: string = 'word/comments.xml';\n        this.imagePath = 'word/media/image';\n        // private footnotesPath: string = 'word/footnotes.xml';\n        // private endnotesPath: string = 'word/endnotes.xml';\n        this.appPath = 'docProps/app.xml';\n        this.corePath = 'docProps/core.xml';\n        // private CustomPath: string = 'docProps/custom.xml';\n        // private FontTablePath: string = 'word/fontTable.xml';\n        this.contentTypesPath = '[Content_Types].xml';\n        // private ChartsPath: string = 'word/charts/';\n        // private DefaultEmbeddingPath: string = 'word/embeddings/';\n        // private EmbeddingPath:string = 'word\\embeddings\\';\n        // private DrawingPath:string = 'word\\drawings\\';\n        // private ThemePath: string = 'word/theme/theme1.xml';\n        // private FontsPath:string = 'word\\fonts\\';\n        // private DiagramPath:string = \"word/diagrams/';\n        // private ControlPath:string = \"word/activeX/';\n        // private VbaProject: string = 'vbaProject.bin';\n        // private VbaData: string = 'vbaData.xml';\n        // private VbaProjectPath: string = 'word/vbaProject.bin';\n        // private VbaDataPath: string = 'word/vbaData.xml';\n        // private CustomXMLPath:string = 'customXml\\';\n        //Relationship path\n        this.generalRelationPath = '_rels/.rels';\n        this.wordRelationPath = 'word/_rels/document.xml.rels';\n        // private FontRelationPath: string = 'word/_rels/fontTable.xml.rels';\n        // private CommentsRelationPath: string = 'word/_rels/comments.xml.rels';\n        // private FootnotesRelationPath: string = 'word/_rels/footnotes.xml.rels';\n        // private EndnotesRelationPath: string = 'word/_rels/endnotes.xml.rels';\n        // private NumberingRelationPath: string = 'word/_rels/numbering.xml.rels';\n        this.headerRelationPath = 'word/_rels/header';\n        this.footerRelationPath = 'word/_rels/footer';\n        // private SettingsRelationpath: string = 'word/_rels/settings.xml.rels';\n        // private VbaProjectRelsPath: string = 'word/_rels/vbaProject.bin.rels';\n        //Content type of the parts\n        this.xmlContentType = 'application/xml';\n        this.fontContentType = 'application/vnd.openxmlformats-officedocument.obfuscatedFont';\n        this.documentContentType = 'application/vnd.openxmlformats-officedocument.wordprocessingml.document.main+xml';\n        // private TemplateContentType: string = 'application/vnd.openxmlformats-officedocument.wordprocessingml.template.main+xml';\n        // private CommentsContentType: string = 'application/vnd.openxmlformats-officedocument.wordprocessingml.comments+xml';\n        this.settingsContentType = 'application/vnd.openxmlformats-officedocument.wordprocessingml.settings+xml';\n        // private EndnoteContentType: string = 'application/vnd.openxmlformats-officedocument.wordprocessingml.endnotes+xml';\n        // private FontTableContentType: string = 'application/vnd.openxmlformats-officedocument.wordprocessingml.fontTable+xml';\n        this.footerContentType = 'application/vnd.openxmlformats-officedocument.wordprocessingml.footer+xml';\n        // private FootnoteContentType: string = 'application/vnd.openxmlformats-officedocument.wordprocessingml.footnotes+xml';\n        // private GlossaryDocumentContentType: string = 'application/vnd.openxmlformats-officedocument.wordprocessingml.document.glossary+xml';\n        this.headerContentType = 'application/vnd.openxmlformats-officedocument.wordprocessingml.header+xml';\n        this.numberingContentType = 'application/vnd.openxmlformats-officedocument.wordprocessingml.numbering+xml';\n        this.stylesContentType = 'application/vnd.openxmlformats-officedocument.wordprocessingml.styles+xml';\n        this.webSettingsContentType = 'application/vnd.openxmlformats-officedocument.wordprocessingml.webSettings+xml';\n        this.appContentType = 'application/vnd.openxmlformats-officedocument.extended-properties+xml';\n        this.coreContentType = 'application/vnd.openxmlformats-package.core-properties+xml';\n        this.customContentType = 'application/vnd.openxmlformats-officedocument.custom-properties+xml';\n        this.customXmlContentType = 'application/vnd.openxmlformats-officedocument.customXmlProperties+xml';\n        this.relationContentType = 'application/vnd.openxmlformats-package.relationships+xml';\n        // private DiagramColor: string = 'application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml';\n        // private DiagramData: string = 'application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml';\n        // private DiagramLayout: string = 'application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml';\n        // private DiagramStyle: string = 'application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml';\n        // private ChartsContentType: string = 'application/vnd.openxmlformats-officedocument.drawingml.chart+xml';\n        // private ThemeContentType: string = 'application/vnd.openxmlformats-officedocument.theme+xml';\n        // private ChartDrawingContentType: string = 'application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml';\n        // private ActiveXContentType: string = 'application/vnd.ms-office.activeX+xml';\n        // private ActiveXBinContentType: string = 'application/vnd.ms-office.activeX';\n        this.tableStyleContentType = 'application/vnd.openxmlformats-officedocument.presentationml.tableStyles+xml';\n        // private ChartStyleContentType: string = 'application/vnd.ms-office.chartstyle+xml';\n        // private ChartColorStyleContentType: string = 'application/vnd.ms-office.chartcolorstyle+xml';\n        // private VbaProjectContentType: string = 'application/vnd.ms-office.vbaProject';\n        // private VbaDataContentType: string = 'application/vnd.ms-word.vbaData+xml';\n        // private MacroDocumentContentType: string = 'application/vnd.ms-word.document.macroEnabled.main+xml';\n        // private MacroTemplateContentType: string = 'application/vnd.ms-word.template.macroEnabledTemplate.main+xml';\n        // private OleObjectContentType: string = 'application/vnd.openxmlformats-officedocument.oleObject';\n        // Relationship types of document parts\n        // private AltChunkRelType: string = 'http://schemas.openxmlformats.org/officeDocument/2006/relationships/aFChunk';\n        // private CommentsRelType: string = 'http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments';\n        this.settingsRelType = 'http://schemas.openxmlformats.org/officeDocument/2006/relationships/settings';\n        // private EndnoteRelType: string = 'http://schemas.openxmlformats.org/officeDocument/2006/relationships/endnotes';\n        // private FontTableRelType: string = 'http://schemas.openxmlformats.org/officeDocument/2006/relationships/fontTable';\n        this.footerRelType = 'http://schemas.openxmlformats.org/officeDocument/2006/relationships/footer';\n        // private FootnoteRelType: string = 'http://schemas.openxmlformats.org/officeDocument/2006/relationships/footnotes';\n        this.headerRelType = 'http://schemas.openxmlformats.org/officeDocument/2006/relationships/header';\n        this.documentRelType = 'http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument';\n        this.numberingRelType = 'http://schemas.openxmlformats.org/officeDocument/2006/relationships/numbering';\n        this.stylesRelType = 'http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles';\n        // private OleObjectRelType: string = 'http://schemas.openxmlformats.org/officeDocument/2006/relationships/oleObject';\n        // private ChartRelType: string = 'http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart';\n        // private ThemeRelType: string = 'http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme';\n        this.fontRelType = 'http://schemas.openxmlformats.org/officeDocument/2006/relationships/font';\n        this.tableStyleRelType = 'http://schemas.openxmlformats.org/officeDocument/2006/relationships/tableStyles';\n        this.coreRelType = 'http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties';\n        this.appRelType = 'http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties';\n        this.customRelType = 'http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties';\n        this.imageRelType = 'http://schemas.openxmlformats.org/officeDocument/2006/relationships/image';\n        this.hyperlinkRelType = 'http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink';\n        this.controlRelType = 'http://schemas.openxmlformats.org/officeDocument/2006/relationships/control';\n        this.packageRelType = 'http://schemas.openxmlformats.org/officeDocument/2006/relationships/package';\n        // private VbaProjectRelType: string = 'http://schemas.microsoft.com/office/2006/relationships/vbaProject';\n        // private VbaDataRelType: string = 'http://schemas.microsoft.com/office/2006/relationships/wordVbaData';\n        this.customXmlRelType = 'http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml';\n        this.customUIRelType = 'http://schemas.microsoft.com/office/2006/relationships/ui/extensibility';\n        this.attachedTemplateRelType = 'http://schemas.openxmlformats.org/officeDocument/2006/relationships/attachedTemplate';\n        // private ChartColorStyleRelType: string = 'http://schemas.microsoft.com/office/2011/relationships/chartColorStyle';\n        // private ChartStyleRelType: string = 'http://schemas.microsoft.com/office/2011/relationships/chartStyle';\n        // private ChartUserShapesRelType: string = 'http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartUserShapes';\n        // private ChartContentType: string = 'http://schemas.openxmlformats.org/officeDocument/2006/relationships/package';\n        // Namespaces\n        // private PKG_namespace: string = 'http://schemas.microsoft.com/office/2006/xmlPackage';\n        this.wNamespace = 'http://schemas.openxmlformats.org/wordprocessingml/2006/main';\n        this.wpNamespace = 'http://schemas.openxmlformats.org/drawingml/2006/wordprocessingDrawing';\n        this.pictureNamespace = 'http://schemas.openxmlformats.org/drawingml/2006/picture';\n        this.aNamespace = 'http://schemas.openxmlformats.org/drawingml/2006/main';\n        this.a14Namespace = 'http://schemas.microsoft.com/office/drawing/2010/main';\n        // private SVG_namespace: string = 'http://schemas.microsoft.com/office/drawing/2016/SVG/main';\n        this.rNamespace = 'http://schemas.openxmlformats.org/officeDocument/2006/relationships';\n        this.rpNamespace = 'http://schemas.openxmlformats.org/package/2006/relationships';\n        this.vNamespace = 'urn:schemas-microsoft-com:vml';\n        this.oNamespace = 'urn:schemas-microsoft-com:office:office';\n        this.xmlNamespace = 'http://www.w3.org/XML/1998/namespace';\n        this.w10Namespace = 'urn:schemas-microsoft-com:office:word';\n        this.cpNamespace = 'http://schemas.openxmlformats.org/package/2006/metadata/core-properties';\n        this.dcNamespace = 'http://purl.org/dc/elements/1.1/';\n        // private DCTERMS_namespace: string = 'http://purl.org/dc/terms/';\n        // private XSI_namespace: string = 'http://www.w3.org/2001/XMLSchema-instance';\n        this.docPropsNamespace = 'http://schemas.openxmlformats.org/officeDocument/2006/extended-properties';\n        this.veNamespace = 'http://schemas.openxmlformats.org/markup-compatibility/2006';\n        this.mNamespace = 'http://schemas.openxmlformats.org/officeDocument/2006/math';\n        this.wneNamespace = 'http://schemas.microsoft.com/office/word/2006/wordml';\n        // private DCMI_namespace: string = 'http://purl.org/dc/dcmitype/';\n        this.customPropsNamespace = 'http://schemas.openxmlformats.org/officeDocument/2006/custom-properties';\n        this.vtNamespace = 'http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes';\n        this.chartNamespace = 'http://schemas.openxmlformats.org/drawingml/2006/chart';\n        this.slNamespace = 'http://schemas.openxmlformats.org/schemaLibrary/2006/main';\n        //2003WML namespace\n        // private amlNamespace: string = 'http://schemas.microsoft.com/aml/2001/core';\n        this.dtNamespace = 'uuid:C2F41010-65B3-11d1-A29F-00AA00C14882';\n        this.wmlNamespace = 'http://schemas.microsoft.com/office/word/2003/wordml';\n        //2010 namespaces\n        this.w14Namespace = 'http://schemas.microsoft.com/office/word/2010/wordml';\n        this.wpCanvasNamespace = 'http://schemas.microsoft.com/office/word/2010/wordprocessingCanvas';\n        this.wpDrawingNamespace = 'http://schemas.microsoft.com/office/word/2010/wordprocessingDrawing';\n        this.wpGroupNamespace = 'http://schemas.microsoft.com/office/word/2010/wordprocessingGroup';\n        this.wpInkNamespace = 'http://schemas.microsoft.com/office/word/2010/wordprocessingInk';\n        this.wpShapeNamespace = 'http://schemas.microsoft.com/office/word/2010/wordprocessingShape';\n        //2013 namespaces\n        this.w15Namespace = 'http://schemas.microsoft.com/office/word/2012/wordml';\n        this.diagramNamespace = 'http://schemas.openxmlformats.org/drawingml/2006/diagram';\n        //Encryption namespaces\n        this.eNamespace = 'http://schemas.microsoft.com/office/2006/encryption';\n        this.pNamespace = 'http://schemas.microsoft.com/office/2006/keyEncryptor/password';\n        this.certNamespace = 'http://schemas.microsoft.com/office/2006/keyEncryptor/certificate';\n        // Dls xml tags\n        this.cRelationshipsTag = 'Relationships';\n        this.cRelationshipTag = 'Relationship';\n        this.cIdTag = 'Id';\n        this.cTypeTag = 'Type';\n        this.cTargetTag = 'Target';\n        this.cUserShapesTag = 'userShapes';\n        this.cExternalData = 'externalData';\n        this.twipsInOnePoint = 20;\n        this.twentiethOfPoint = 20;\n        this.borderMultiplier = 8;\n        this.percentageFactor = 50;\n        this.emusPerPoint = 12700;\n        // private const TOC_SYMBOL:string = (char)0x01;\n        // private const FOOTNOTE_SYMBOL:string = (char)0x02;\n        // private const PAGENUMBER_SYMBOL:string = (char)0xB;\n        // private DEF_FIT_TEXT_TO_SHAPE: string = 'mso-fit-shape-to-text:t';\n        // Document tags\n        this.cConditionalTableStyleTag = 'tblStylePr';\n        this.cTableFormatTag = 'tblPr';\n        this.cTowFormatTag = 'trPr';\n        this.cCellFormatTag = 'tcPr';\n        this.cParagraphFormatTag = 'pPr';\n        this.cCharacterFormatTag = 'rPr';\n        this.packageType = 'http://schemas.microsoft.com/office/2006/xmlPackage';\n        this.relsPartPath = '/_rels/.rels';\n        this.documentRelsPartPath = '/word/_rels/document.xml.rels';\n        this.webSettingsPath = '/word/webSettings.xml';\n        this.wordMLDocumentPath = '/word/document.xml';\n        this.wordMLStylePath = '/word/styles.xml';\n        this.wordMLNumberingPath = '/word/numbering.xml';\n        this.wordMLSettingsPath = '/word/settings.xml';\n        this.wordMLHeaderPath = '/word/header';\n        this.wordMLFooterPath = '/word/footer';\n        this.wordMLCommentsPath = '/word/comments.xml';\n        this.wordMLImagePath = '/word/media/image';\n        this.wordMLFootnotesPath = '/word/footnotes.xml';\n        this.wordMLEndnotesPath = '/word/endnotes.xml';\n        this.wordMLAppPath = '/docProps/app.xml';\n        this.wordMLCorePath = '/docProps/core.xml';\n        this.wordMLCustomPath = '/docProps/custom.xml';\n        this.wordMLFontTablePath = '/word/fontTable.xml';\n        this.wordMLChartsPath = '/word/charts/';\n        this.wordMLDefaultEmbeddingPath = '/word/embeddings/';\n        this.wordMLEmbeddingPath = '/word/embeddings/';\n        this.wordMLDrawingPath = '/word/drawings/';\n        this.wordMLThemePath = '/word/theme/theme1.xml';\n        this.wordMLFontsPath = '/word/fonts/';\n        this.wordMLDiagramPath = '/word/diagrams/';\n        this.wordMLControlPath = '/word/activeX/';\n        this.wordMLVbaProject = '/vbaProject.bin';\n        this.wordMLVbaData = '/vbaData.xml';\n        this.wordMLVbaProjectPath = '/word/vbaProject.bin';\n        this.wordMLVbaDataPath = '/word/vbaData.xml';\n        // private WordMLCustomXMLPath: string = '/customXml/';\n        this.wordMLWebSettingsPath = '/word/webSettings.xml';\n        this.wordMLCustomItemProp1Path = '/customXml/itemProps1.xml';\n        // private WordMLCustomXMLRelPath: string = '/customXml/_rels/item1.xml.rels';\n        this.wordMLFootnoteRelPath = '/word/_rels/footnotes.xml.rels';\n        this.wordMLEndnoteRelPath = '/word/_rels/endnotes.xml.rels';\n        this.wordMLSettingsRelPath = '/word/_rels/settings.xml.rels';\n        this.wordMLNumberingRelPath = '/word/_rels/numbering.xml.rels';\n        this.wordMLFontTableRelPath = '/word/_rels/fontTable.xml.rels';\n        this.wordMLCustomXmlPropsRelType = 'http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps';\n        this.wordMLControlRelType = 'http://schemas.microsoft.com/office/2006/relationships/activeXControlBinary';\n        this.wordMLDiagramContentType = 'application/vnd.ms-office.drawingml.diagramDrawing+xml';\n        this.lastSection = false;\n        this.mRelationShipID = 0;\n        this.mDocPrID = 0;\n        this.mDifferentFirstPage = false;\n        this.mBookmarks = undefined;\n        /* tslint:enable:no-any */\n    }\n    WordExport.prototype.getModuleName = function () {\n        return 'WordExport';\n    };\n    Object.defineProperty(WordExport.prototype, \"bookmarks\", {\n        // Gets the bookmark name\n        get: function () {\n            if (isNullOrUndefined(this.mBookmarks)) {\n                this.mBookmarks = [];\n            }\n            return this.mBookmarks;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(WordExport.prototype, \"documentImages\", {\n        // Gets the collection of images present in the document body\n        get: function () {\n            if (this.mDocumentImages === undefined) {\n                this.mDocumentImages = new Dictionary();\n            }\n            return this.mDocumentImages;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(WordExport.prototype, \"externalImages\", {\n        // Gets the collection of images present in the document body\n        get: function () {\n            if (this.mExternalLinkImages === undefined) {\n                this.mExternalLinkImages = new Dictionary();\n            }\n            return this.mExternalLinkImages;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(WordExport.prototype, \"headerFooterImages\", {\n        // Gets the collections of images present in the HeaderFooters\n        get: function () {\n            if (this.mHeaderFooterImages === undefined) {\n                this.mHeaderFooterImages = new Dictionary();\n            }\n            return this.mHeaderFooterImages;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(WordExport.prototype, \"headersFooters\", {\n        /// Gets the HeaderFooter Collection\n        get: function () {\n            if (this.mHeaderFooterColl === undefined) {\n                this.mHeaderFooterColl = new Dictionary();\n            }\n            return this.mHeaderFooterColl;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    /**\n     * @private\n     */\n    WordExport.prototype.save = function (viewer, fileName) {\n        this.serialize(viewer);\n        this.mArchive.save(fileName + '.docx').then(function (mArchive) {\n            mArchive.destroy();\n        });\n        this.close();\n    };\n    /**\n     * @private\n     */\n    WordExport.prototype.saveAsBlob = function (viewer) {\n        var _this = this;\n        this.serialize(viewer);\n        return new Promise(function (resolve, reject) {\n            _this.mArchive.saveAsBlob().then(function (blob) {\n                _this.mArchive.destroy();\n                blob = new Blob([blob], { type: 'application/vnd.openxmlformats-officedocument.wordprocessingml.document' });\n                resolve(blob);\n            });\n        });\n    };\n    /**\n     * @private\n     */\n    WordExport.prototype.destroy = function () {\n        this.clearDocument();\n        this.mRelationShipID = undefined;\n        this.mDocPrID = undefined;\n        this.mDifferentFirstPage = undefined;\n        if (this.mArchive) {\n            this.mArchive.destroy();\n            this.mArchive = undefined;\n        }\n    };\n    // Saves the word document in the stream\n    WordExport.prototype.serialize = function (viewer) {\n        /* tslint:disable:no-any */\n        var document = viewer.owner.sfdtExportModule.write();\n        this.setDocument(document);\n        this.mArchive = new ZipArchive();\n        this.mArchive.compressionLevel = 'Normal';\n        this.mVerticalMerge = new Dictionary();\n        this.mGridSpans = new Dictionary();\n        var contenttype;\n        //document.xml\n        this.serializeDocument();\n        //Styles.xml\n        this.serializeStyles();\n        //numbering.xml\n        this.serializeNumberings();\n        //theme.xml\n        // if (m_document.DocHasThemes && !isNullOrUndefined(m_document.Themes))\n        //     SerializeThemes();\n        // else\n        // this.serializeDefaultThemes();\n        //settings.xml\n        this.serializeSettings();\n        //core.xml\n        this.serializeCoreProperties();\n        //app.xml\n        this.serializeAppProperties();\n        //fontTable.xml\n        this.serializeFontTable(contenttype);\n        //custom.xml\n        // if (!isNullOrUndefined(this.wordDocument.CustomDocumentProperties) && m_document.CustomDocumentProperties.length > 0) {\n        //     SerializeCustomProperties();\n        // }\n        //Settings Relations\n        this.serializeSettingsRelation();\n        //Numbering relation if the document has picture bullet\n        // if (PictureBullets.length > 0) {\n        //     SerializeNumberingsRelation();\n        // }\n        this.serializeHeaderFooters();\n        //document relations\n        this.serializeDocumentRelations();\n        // // Add controls to archieve.\n        // if (ControlsPathNames.length > 0) {\n        //     AddControlsToZip(m_document.DocxPackage);\n        // }\n        // if (!isNullOrUndefined(m_document.CustomUIPartContainer))\n        //     AddPartContainerToArchive(m_document.CustomUIPartContainer);\n        // if (!isNullOrUndefined(m_document.CustomXMLContainer))\n        //     AddPartContainerToArchive(m_document.CustomXMLContainer);\n        //general relations\n        this.serializeGeneralRelations();\n        //[ContentTypes].xml\n        this.serializeContentTypes(contenttype);\n        // Clears the internal fields maintained for serializing.\n        this.clearDocument();\n    };\n    // Sets the document\n    WordExport.prototype.setDocument = function (document) {\n        this.document = document;\n        this.mSections = document.sections;\n        this.mLists = document.lists;\n        this.mAbstractLists = document.abstractLists;\n        this.defCharacterFormat = document.characterFormat;\n        this.defParagraphFormat = document.paragraphFormat;\n        this.defaultTabWidthValue = document.defaultTabWidth;\n        this.mStyles = document.styles;\n    };\n    // Clears the document\n    WordExport.prototype.clearDocument = function () {\n        // Owner Nodes\n        this.section = undefined;\n        this.lastSection = undefined;\n        this.blockOwner = undefined;\n        this.paragraph = undefined;\n        this.table = undefined;\n        this.row = undefined;\n        this.headerFooter = undefined;\n        this.document = undefined;\n        this.mSections = undefined;\n        this.mLists = undefined;\n        this.mAbstractLists = undefined;\n        this.defCharacterFormat = undefined;\n        this.defParagraphFormat = undefined;\n        this.defaultTabWidthValue = undefined;\n        this.mRelationShipID = 0;\n        this.mDocPrID = 0;\n        this.mDifferentFirstPage = false;\n        if (this.mHeaderFooterColl) {\n            this.mHeaderFooterColl.destroy();\n            this.mHeaderFooterColl = undefined;\n        }\n        if (this.mVerticalMerge) {\n            this.mVerticalMerge.destroy();\n            this.mVerticalMerge = undefined;\n        }\n        if (this.mGridSpans) {\n            this.mGridSpans.destroy();\n            this.mGridSpans = undefined;\n        }\n        if (this.mDocumentImages) {\n            this.mDocumentImages.destroy();\n            this.mDocumentImages = undefined;\n        }\n        if (this.mExternalLinkImages) {\n            this.mExternalLinkImages.destroy();\n            this.mExternalLinkImages = undefined;\n        }\n        if (this.mHeaderFooterImages) {\n            this.mHeaderFooterImages.destroy();\n            this.mHeaderFooterImages = undefined;\n        }\n    };\n    // Serializes the document elements (document.xml)\n    WordExport.prototype.serializeDocument = function () {\n        var writer = new XmlWriter();\n        writer.writeStartElement('w', 'document', this.wNamespace);\n        this.writeCommonAttributeStrings(writer);\n        this.serializeDocumentBody(writer);\n        writer.writeEndElement(); //end of document tag\n        var archiveItem = new ZipArchiveItem(writer.buffer, this.documentPath);\n        this.mArchive.addItem(archiveItem);\n    };\n    WordExport.prototype.writeCommonAttributeStrings = function (writer) {\n        writer.writeAttributeString('xmlns', 'wpc', undefined, this.wpCanvasNamespace);\n        this.writeCustom(writer);\n        writer.writeAttributeString('xmlns', 'wp14', undefined, this.wpDrawingNamespace);\n        writer.writeAttributeString('xmlns', 'wp', undefined, this.wpNamespace);\n        writer.writeAttributeString('xmlns', 'w10', undefined, this.w10Namespace);\n        writer.writeAttributeString('xmlns', 'w', undefined, this.wNamespace);\n        this.writeDup(writer);\n        writer.writeAttributeString('xmlns', 'wne', undefined, this.wneNamespace);\n        writer.writeAttributeString('xmlns', 'wps', undefined, this.wpShapeNamespace);\n        writer.writeAttributeString('mc', 'Ignorable', undefined, 'w14 w15 wp14');\n    };\n    WordExport.prototype.writeDup = function (writer) {\n        writer.writeAttributeString('xmlns', 'w14', undefined, this.w14Namespace);\n        writer.writeAttributeString('xmlns', 'w15', undefined, this.w15Namespace);\n        writer.writeAttributeString('xmlns', 'wpg', undefined, this.wpGroupNamespace);\n        writer.writeAttributeString('xmlns', 'wpi', undefined, this.wpInkNamespace);\n    };\n    WordExport.prototype.writeCustom = function (writer) {\n        writer.writeAttributeString('xmlns', 'mc', undefined, this.veNamespace);\n        writer.writeAttributeString('xmlns', 'o', undefined, this.oNamespace);\n        writer.writeAttributeString('xmlns', 'r', undefined, this.rNamespace);\n        writer.writeAttributeString('xmlns', 'm', undefined, this.mNamespace);\n        writer.writeAttributeString('xmlns', 'v', undefined, this.vNamespace);\n    };\n    // Serializes the document body\n    WordExport.prototype.serializeDocumentBody = function (writer) {\n        writer.writeStartElement(undefined, 'body', this.wNamespace);\n        var count = this.document.sections.length;\n        for (var i = 0; i < count; i++) {\n            this.section = this.document.sections[i];\n            this.lastSection = i === count - 1;\n            this.serializeSection(writer, this.section, i === count - 1);\n            this.section = undefined;\n        }\n        writer.writeEndElement();\n    };\n    // Serializes the Section.\n    WordExport.prototype.serializeSection = function (writer, section, last) {\n        this.blockOwner = section;\n        this.serializeBodyItems(writer, section.blocks, last);\n        if (last) {\n            this.serializeSectionProperties(writer, section);\n        }\n        this.blockOwner = undefined;\n    };\n    // Serialize the section properties.\n    WordExport.prototype.serializeSectionProperties = function (writer, section) {\n        writer.writeStartElement('w', 'sectPr', this.wNamespace);\n        if (section.headersFooters) {\n            this.serializeHFReference(writer, section.headersFooters);\n        }\n        // if (IsNeedToSerializeSectionFootNoteProperties(section))\n        //     SerializeFootnoteProperties(section);\n        // if (IsNeedToSerializeSectionEndNoteProperties(section))\n        //     SerializeEndnoteProperties(section);\n        this.serializeSectionType(writer, 'nextPage');\n        this.serializePageSetup(writer, section.sectionFormat);\n        this.serializeColumns(writer, section);\n        // this.serializeSectionProtection(section);\n        // if (section.PageSetup.VerticalAlignment !== PageAlignment.Top) {\n        //     writer.writeStartElement('vAlign', this.wNamespace);\n        //     switch (section.PageSetup.VerticalAlignment) {\n        //         case PageAlignment.Top:\n        //             writer.WriteAttributeString('val', this.wNamespace, 'top');\n        //             break;\n        //         case PageAlignment.Middle:\n        //             writer.WriteAttributeString('val', this.wNamespace, 'center');\n        //             break;\n        //         case PageAlignment.Justified:\n        //             writer.WriteAttributeString('val', this.wNamespace, 'both');\n        //             break;\n        //         case PageAlignment.Bottom:\n        //             writer.WriteAttributeString('val', this.wNamespace, 'bottom');\n        //             break;\n        //     }\n        //     writer.WriteEndElement();\n        // }\n        if (section.sectionFormat !== undefined && section.sectionFormat.differentFirstPage) {\n            writer.writeStartElement(undefined, 'titlePg', this.wNamespace);\n            writer.writeEndElement();\n        }\n        // SerializeTextDirection(section);\n        // if (section.PageSetup.Bidi) {\n        //     writer.WriteStartElement('bidi', this.wNamespace);\n        //     writer.WriteEndElement();\n        // }\n        //rtlGutter\n        // SerializeDocGrid(section);\n        //printerSettings\n        writer.writeEndElement(); //end of sectPr tag\n    };\n    // Serialize the column properties of section.\n    WordExport.prototype.serializeColumns = function (writer, section) {\n        writer.writeStartElement(undefined, 'cols', this.wNamespace);\n        writer.writeAttributeString(undefined, 'equalWidth', this.wNamespace, '1');\n        writer.writeAttributeString(undefined, 'space', this.wNamespace, '0');\n        writer.writeEndElement();\n        // ColumnCollection columns = section.Columns;\n        // writer.WriteStartElement('cols', this.wNamespace);\n        // if (columns.length > 0)\n        // {\n        //     writer.WriteAttributeString('num', this.wNamespace, columns.length.ToString());\n        // }\n        // if (section.PageSetup.DrawLinesBetweenCols)\n        //     writer.WriteAttributeString('sep', this.wNamespace, '1');\n        // if (columns.OwnerSection.PageSetup.EqualColumnWidth)\n        // {\n        //     writer.WriteAttributeString('equalWidth', this.wNamespace, '1');\n        //     //When the column count is negative, MS word just reset the column's count to zero\n        //     //To avoid index out of exception, checked the columns count\n        // tslint:disable-next-line:max-line-length\n        //     writer.WriteAttributeString('space', this.wNamespace, ToString(columns.length > 0 ? columns[0].Space * this.TwentiethOfPoint : 0));\n        // }\n        // else if (columns.length > 0)\n        // {\n        //     writer.WriteAttributeString('equalWidth', this.wNamespace, '0');\n        //     foreach (Column column in columns)\n        //     {\n        //         writer.WriteStartElement('col', this.wNamespace);\n        //         writer.WriteAttributeString('w', this.wNamespace, ToString(column.Width * this.TwentiethOfPoint));\n        // tslint:disable-next-line:max-line-length\n        //         writer.WriteAttributeString('space', this.wNamespace, ToString(column.Space * this.TwentiethOfPoint));\n        //         writer.WriteEndElement();\n        //     }\n        // }\n        // writer.WriteEndElement();\n    };\n    // Serialize the page setup properties.\n    WordExport.prototype.serializePageSetup = function (writer, pageSetup) {\n        if (pageSetup !== undefined) {\n            this.serializePageSize(writer, pageSetup);\n            this.serializePageMargins(writer, pageSetup);\n        }\n        // // StartElement paperSrc (if any)\n        // if (pageSetup.FirstPageTray > 0 || pageSetup.OtherPagesTray > 0) {\n        //     writer.WriteStartElement('paperSrc', this.wNamespace);\n        //     if (pageSetup.FirstPageTray > 0) {\n        //         writer.WriteAttributeString('first', this.wNamespace, pageSetup.FirstPageTray.ToString());\n        //     }\n        //     if (pageSetup.OtherPagesTray > 0) {\n        //         writer.WriteAttributeString('other', this.wNamespace, pageSetup.OtherPagesTray.ToString());\n        //     }\n        //     writer.WriteEndElement();\n        // }\n        writer.writeStartElement(undefined, 'pgBorders', this.wNamespace);\n        // //zOrder\n        // if (pageSetup.PageBordersApplyType === PageBordersApplyType.FirstPage)\n        //     writer.WriteAttributeString('display', this.wNamespace, 'firstPage');\n        // else if (pageSetup.PageBordersApplyType === PageBordersApplyType.AllExceptFirstPage)\n        //     writer.WriteAttributeString('display', this.wNamespace, 'notFirstPage');\n        // if (pageSetup.PageBorderOffsetFrom === PageBorderOffsetFrom.PageEdge) {\n        //     writer.WriteAttributeString('offsetFrom', this.wNamespace, 'page');\n        // }\n        // //Serializing zOrder of the front page border\n        // if (!pageSetup.IsFrontPageBorder) {\n        //     writer.WriteAttributeString('zOrder', this.wNamespace, 'back');\n        // }\n        // SerializePageBorders(pageSetup.Borders);\n        writer.writeEndElement();\n        // this.serializeLineNumberType(writer, pageSetup);\n        //this.serializePageNumberType(writer, pageSetup);\n    };\n    // serialize the page size\n    WordExport.prototype.serializePageSize = function (writer, pageSetup) {\n        writer.writeStartElement(undefined, 'pgSz', this.wNamespace);\n        // tslint:disable-next-line:max-line-length\n        writer.writeAttributeString(undefined, 'w', this.wNamespace, this.roundToTwoDecimal(pageSetup.pageWidth * this.twentiethOfPoint).toString());\n        // tslint:disable-next-line:max-line-length\n        writer.writeAttributeString(undefined, 'h', this.wNamespace, this.roundToTwoDecimal(pageSetup.pageHeight * this.twentiethOfPoint).toString());\n        // if (pageSetup.Orientation === PageOrientation.Landscape)\n        // {\n        //     writer.WriteAttributeString('orient', this.wNamespace, 'landscape');\n        // }\n        writer.writeEndElement();\n    };\n    // Serialize the border.\n    WordExport.prototype.serializePageMargins = function (writer, pageSetup) {\n        writer.writeStartElement(undefined, 'pgMar', this.wNamespace);\n        var marginValue = Math.round(pageSetup.topMargin * this.twentiethOfPoint);\n        writer.writeAttributeString(undefined, 'top', this.wNamespace, marginValue.toString());\n        marginValue = Math.round(pageSetup.rightMargin * this.twentiethOfPoint);\n        writer.writeAttributeString(undefined, 'right', this.wNamespace, marginValue.toString());\n        marginValue = Math.round(pageSetup.bottomMargin * this.twentiethOfPoint);\n        writer.writeAttributeString(undefined, 'bottom', this.wNamespace, marginValue.toString());\n        marginValue = Math.round(pageSetup.leftMargin * this.twentiethOfPoint);\n        writer.writeAttributeString(undefined, 'left', this.wNamespace, marginValue.toString());\n        // tslint:disable-next-line:max-line-length\n        writer.writeAttributeString(undefined, 'header', this.wNamespace, this.roundToTwoDecimal(pageSetup.headerDistance * this.twentiethOfPoint).toString());\n        // tslint:disable-next-line:max-line-length\n        writer.writeAttributeString(undefined, 'footer', this.wNamespace, this.roundToTwoDecimal(pageSetup.footerDistance * this.twentiethOfPoint).toString());\n        writer.writeAttributeString(undefined, 'gutter', this.wNamespace, '0');\n        writer.writeEndElement();\n    };\n    // Serialize the section type.\n    WordExport.prototype.serializeSectionType = function (writer, sectionBreakCode) {\n        writer.writeStartElement('w', 'type', this.wNamespace);\n        writer.writeAttributeString('w', 'val', this.wNamespace, sectionBreakCode); //GetSectionBreakCode(sectionBreakCode));\n        writer.writeEndElement();\n    };\n    // Serialize the heeader/footer reference.\n    WordExport.prototype.serializeHFReference = function (writer, headersFooters) {\n        var hfId = '';\n        if (headersFooters !== undefined) {\n            this.mDifferentFirstPage = this.section.sectionFormat.differentOddAndEvenPages;\n            var hf = headersFooters.firstPageHeader;\n            if (hf && hf.blocks && hf.blocks.length > 0) {\n                writer.writeStartElement(undefined, 'headerReference', this.wNamespace);\n                writer.writeAttributeString(undefined, 'type', this.wNamespace, 'first');\n                hfId = this.getNextRelationShipID();\n                writer.writeAttributeString(undefined, 'id', this.rNamespace, hfId);\n                this.addHeaderFooter(hf, 'FirstPageHeader', hfId);\n                writer.writeEndElement();\n            }\n            hf = headersFooters.firstPageFooter;\n            if (hf && hf.blocks && hf.blocks.length > 0) {\n                writer.writeStartElement(undefined, 'footerReference', this.wNamespace);\n                writer.writeAttributeString(undefined, 'type', this.wNamespace, 'first');\n                hfId = this.getNextRelationShipID();\n                writer.writeAttributeString(undefined, 'id', this.rNamespace, hfId);\n                this.addHeaderFooter(hf, 'FirstPageFooter', hfId);\n                writer.writeEndElement();\n            }\n            hf = headersFooters.evenHeader;\n            if (hf && hf.blocks && hf.blocks.length > 0) {\n                writer.writeStartElement(undefined, 'headerReference', this.wNamespace);\n                writer.writeAttributeString(undefined, 'type', this.wNamespace, 'even');\n                hfId = this.getNextRelationShipID();\n                writer.writeAttributeString(undefined, 'id', this.rNamespace, hfId);\n                this.addHeaderFooter(hf, 'EvenHeader', hfId);\n                writer.writeEndElement();\n            }\n            hf = headersFooters.evenFooter;\n            if (hf && hf.blocks && hf.blocks.length > 0) {\n                writer.writeStartElement(undefined, 'footerReference', this.wNamespace);\n                writer.writeAttributeString(undefined, 'type', this.wNamespace, 'even');\n                hfId = this.getNextRelationShipID();\n                writer.writeAttributeString(undefined, 'id', this.rNamespace, hfId);\n                this.addHeaderFooter(hf, 'EvenFooter', hfId);\n                writer.writeEndElement();\n            }\n            hf = headersFooters.header;\n            if (hf && hf.blocks && hf.blocks.length > 0) {\n                writer.writeStartElement(undefined, 'headerReference', this.wNamespace);\n                writer.writeAttributeString(undefined, 'type', this.wNamespace, 'default');\n                hfId = this.getNextRelationShipID();\n                writer.writeAttributeString(undefined, 'id', this.rNamespace, hfId);\n                this.addHeaderFooter(hf, 'OddHeader', hfId);\n                writer.writeEndElement();\n            }\n            hf = headersFooters.footer;\n            if (hf && hf.blocks && hf.blocks.length > 0) {\n                writer.writeStartElement(undefined, 'footerReference', this.wNamespace);\n                writer.writeAttributeString(undefined, 'type', this.wNamespace, 'default');\n                hfId = this.getNextRelationShipID();\n                writer.writeAttributeString(undefined, 'id', this.rNamespace, hfId);\n                this.addHeaderFooter(hf, 'OddFooter', hfId);\n                writer.writeEndElement();\n            }\n        }\n    };\n    // Adds the header footer details to the collection.\n    WordExport.prototype.addHeaderFooter = function (hf, hfType, id) {\n        var hfColl = new Dictionary();\n        this.headersFooters.add(hfType, hfColl);\n        this.headersFooters.get(hfType).add(id, hf);\n    };\n    // Serializes the bodyItems\n    WordExport.prototype.serializeBodyItems = function (writer, blockCollection, isLastSection) {\n        for (var i = 0; i < blockCollection.length; i++) {\n            this.serializeBodyItem(writer, blockCollection[i], isLastSection);\n        }\n    };\n    // Serialize the TextBody item\n    WordExport.prototype.serializeBodyItem = function (writer, item, isLastSection) {\n        if (isNullOrUndefined(item)) {\n            throw new Error('BodyItem should not be undefined');\n        }\n        if (item.hasOwnProperty('inlines')) {\n            this.paragraph = item;\n            this.serializeParagraph(writer, item, isLastSection);\n            this.paragraph = undefined;\n        }\n        else {\n            var table = item;\n            for (var i = 0; i < table.rows.length; i++) {\n                if (table.rows[i].cells.length > 0) {\n                    this.serializeTable(writer, table);\n                    break;\n                }\n            }\n        }\n    };\n    // Serialize the paragraph\n    WordExport.prototype.serializeParagraph = function (writer, paragraph, isLastSection) {\n        if (isNullOrUndefined(paragraph)) {\n            throw new Error('Paragraph should not be undefined');\n        }\n        var sec = this.blockOwner;\n        //Need to write the Section Properties if the Paragraph is last item in the section\n        if (!isLastSection && sec.hasOwnProperty('sectionFormat')\n            && sec.blocks.indexOf(paragraph) === sec.blocks.length - 1) {\n            writer.writeStartElement('w', 'p', this.wNamespace);\n            writer.writeStartElement(undefined, 'pPr', this.wNamespace);\n            this.serializeSectionProperties(writer, sec);\n            writer.writeEndElement();\n            writer.writeEndElement();\n        }\n        // if (paragraph.ParagraphFormat.PageBreakAfter && !IsPageBreakNeedToBeSkipped(paragraph as Entity))\n        //     paragraph.InsertBreak(BreakType.PageBreak);\n        // if (paragraph.ParagraphFormat.ColumnBreakAfter && !IsPageBreakNeedToBeSkipped(paragraph as Entity))\n        //     paragraph.InsertBreak(BreakType.ColumnBreak);\n        //Splits the paragraph based on the newline character\n        // paragraph.SplitTextRange();\n        writer.writeStartElement('w', 'p', this.wNamespace);\n        writer.writeStartElement(undefined, 'pPr', this.wNamespace);\n        this.serializeParagraphFormat(writer, paragraph.paragraphFormat, paragraph);\n        writer.writeEndElement(); //end of pPr\n        // Serialize watermark if paragraph is the first item of Header document.\n        // EnsureWatermark(paragraph);\n        this.serializeParagraphItems(writer, paragraph.inlines);\n        writer.writeEndElement(); //end of paragraph tag.\n    };\n    // Serialize the paragraph items\n    WordExport.prototype.serializeParagraphItems = function (writer, paraItems) {\n        var previousNode = undefined;\n        for (var i = 0; i < paraItems.length; i++) {\n            var item = paraItems[i];\n            if (item.hasOwnProperty('fieldType')) {\n                this.serializeFieldCharacter(writer, item);\n            }\n            else if (item.hasOwnProperty('imageString')) {\n                this.serializePicture(writer, item);\n            }\n            else if (item.hasOwnProperty('bookmarkType')) {\n                this.serializeBookMark(writer, item);\n            }\n            else {\n                this.serializeTextRange(writer, item, previousNode);\n            }\n            previousNode = item;\n        }\n    };\n    // Serialize the book mark\n    WordExport.prototype.serializeBookMark = function (writer, bookmark) {\n        var bookmarkId = this.getBookmarkId(bookmark.name);\n        var bookmarkName = bookmark.name;\n        if (bookmark.bookmarkType === 0) {\n            writer.writeStartElement('w', 'bookmarkStart', this.wNamespace);\n            writer.writeAttributeString('w', 'name', this.wNamespace, bookmarkName);\n        }\n        else if (bookmark.bookmarkType === 1) {\n            writer.writeStartElement('w', 'bookmarkEnd', this.wNamespace);\n        }\n        writer.writeAttributeString('w', 'id', this.wNamespace, bookmarkId.toString());\n        writer.writeEndElement();\n    };\n    WordExport.prototype.getBookmarkId = function (name) {\n        var index = this.bookmarks.indexOf(name);\n        if (index < 0) {\n            index = this.bookmarks.length;\n            this.bookmarks.push(name);\n        }\n        return index;\n    };\n    // Serialize the picture.\n    WordExport.prototype.serializePicture = function (writer, image) {\n        if (image.width >= 0 && image.height >= 0) {\n            writer.writeStartElement(undefined, 'r', this.wNamespace);\n            this.serializeCharacterFormat(writer, image.characterFormat);\n            this.serializeDrawing(writer, image);\n            writer.writeEndElement(); //end of run element\n        }\n    };\n    // Serialize the drawing element.\n    WordExport.prototype.serializeDrawing = function (writer, image) {\n        writer.writeStartElement(undefined, 'drawing', this.wNamespace);\n        this.serializeInlinePicture(writer, image);\n        writer.writeEndElement();\n    };\n    // Serialize the inline picture.\n    WordExport.prototype.serializeInlinePicture = function (writer, image) {\n        writer.writeStartElement(undefined, 'inline', this.wpNamespace);\n        writer.writeStartElement(undefined, 'extent', this.wpNamespace);\n        var cx = Math.round(image.width * this.emusPerPoint);\n        writer.writeAttributeString(undefined, 'cx', undefined, cx.toString());\n        var cy = Math.round(image.height * this.emusPerPoint);\n        writer.writeAttributeString(undefined, 'cy', undefined, cy.toString());\n        writer.writeEndElement();\n        // double borderWidth = (double)picture.PictureShape.PictureDescriptor.BorderLeft.LineWidth / DLSConstants.BorderLineFactor;\n        // if (borderWidth > 0 && picture.DocxProps.length === 0) {\n        //     long leftTop = 0, rightBottom = 0;\n        //     picture.PictureShape.GetEffectExtent(borderWidth, ref leftTop, ref rightBottom);\n        //     m_writer.WriteStartElement('effectExtent', WP_namespace);\n        //     m_writer.WriteAttributeString('l', leftTop.ToString(CultureInfo.InvariantCulture));\n        //     m_writer.WriteAttributeString('t', leftTop.ToString(CultureInfo.InvariantCulture));\n        //     m_writer.WriteAttributeString('r', rightBottom.ToString(CultureInfo.InvariantCulture));\n        //     m_writer.WriteAttributeString('b', rightBottom.ToString(CultureInfo.InvariantCulture));\n        //     m_writer.WriteEndElement();\n        // }\n        //this.serializePicProperties(writer, image);\n        this.serializeDrawingGraphics(writer, image);\n        writer.writeEndElement();\n    };\n    WordExport.prototype.startsWith = function (sourceString, startString) {\n        return startString.length > 0 && sourceString.substring(0, startString.length) === startString;\n    };\n    // Serialize the graphics element for pictures.\n    WordExport.prototype.serializeDrawingGraphics = function (writer, picture) {\n        var id = '';\n        id = this.updateShapeId(picture);\n        // picture.ShapeId = this.getNextDocPrID();\n        // Processing picture\n        writer.writeStartElement('wp', 'docPr', this.wpNamespace);\n        writer.writeAttributeString(undefined, 'id', undefined, (this.mDocPrID++).toString());\n        // if (!isNullOrUndefined(picture.AlternativeText))\n        //     m_writer.WriteAttributeString('descr', picture.AlternativeText);\n        writer.writeAttributeString(undefined, 'name', undefined, '1'.toString());\n        // if (!string.IsNullOrEmpty(picture.Title))\n        //     m_writer.WriteAttributeString('title', picture.Title);\n        // else\n        writer.writeAttributeString(undefined, 'title', undefined, '');\n        // if (!picture.Visible)\n        //     m_writer.WriteAttributeString('hidden', '1');\n        // SerializePictureHyperlink(picture);\n        writer.writeEndElement();\n        writer.writeStartElement('a', 'graphic', this.aNamespace);\n        writer.writeStartElement('a', 'graphicData', this.aNamespace);\n        writer.writeAttributeString(undefined, 'uri', undefined, this.pictureNamespace);\n        writer.writeStartElement('pic', 'pic', this.pictureNamespace);\n        writer.writeStartElement('pic', 'nvPicPr', this.pictureNamespace);\n        writer.writeStartElement('pic', 'cNvPr', this.pictureNamespace);\n        writer.writeAttributeString(undefined, 'id', undefined, '0');\n        writer.writeAttributeString(undefined, 'name', undefined, '');\n        writer.writeAttributeString(undefined, 'descr', undefined, '');\n        writer.writeEndElement();\n        writer.writeStartElement('pic', 'cNvPicPr', this.pictureNamespace);\n        writer.writeStartElement('a', 'picLocks', this.aNamespace);\n        writer.writeAttributeString(undefined, 'noChangeAspect', undefined, '1');\n        writer.writeAttributeString(undefined, 'noChangeArrowheads', undefined, '1');\n        writer.writeEndElement();\n        writer.writeEndElement();\n        writer.writeEndElement();\n        writer.writeStartElement('pic', 'blipFill', this.pictureNamespace);\n        writer.writeStartElement('a', 'blip', this.aNamespace);\n        if (this.startsWith(picture.imageString, 'data:image')) {\n            writer.writeAttributeString('r', 'embed', this.rNamespace, id);\n        }\n        else {\n            if (this.documentImages.containsKey(id)) {\n                //Remove the image document images collection for this particular key\n                //If the picture image data has href means MS Word contains the image in media folder as well as \n                //it is having external relationship id\n                // if (!this.startsWith(picture.imageString, 'data:image')) {\n                this.documentImages.remove(id);\n                this.externalImages.add(id, picture.imageString);\n                writer.writeAttributeString(undefined, 'link', this.rNamespace, id);\n            }\n        }\n        //End Element Blip\n        writer.writeEndElement();\n        writer.writeStartElement('a', 'srcRect', this.aNamespace);\n        writer.writeEndElement();\n        writer.writeStartElement('a', 'stretch', this.aNamespace);\n        writer.writeStartElement('a', 'fillRect', this.aNamespace);\n        writer.writeEndElement();\n        writer.writeEndElement();\n        writer.writeEndElement();\n        writer.writeStartElement('pic', 'spPr', this.pictureNamespace);\n        writer.writeAttributeString(undefined, 'bwMode', undefined, 'auto');\n        writer.writeStartElement('a', 'xfrm', this.aNamespace);\n        // if (picture.Rotation !== 0)\n        //     m_writer.WriteAttributeString('rot', picture.Rotation.ToString());\n        writer.writeStartElement('a', 'off', this.aNamespace);\n        writer.writeAttributeString(undefined, 'x', undefined, '0');\n        writer.writeAttributeString(undefined, 'y', undefined, '0');\n        writer.writeEndElement();\n        writer.writeStartElement('a', 'ext', this.aNamespace);\n        var cx = Math.round((picture.width * this.emusPerPoint));\n        writer.writeAttributeString(undefined, 'cx', undefined, cx.toString());\n        var cy = Math.round((picture.height * this.emusPerPoint));\n        writer.writeAttributeString(undefined, 'cy', undefined, cy.toString());\n        writer.writeEndElement();\n        writer.writeEndElement();\n        writer.writeStartElement('a', 'prstGeom', this.aNamespace);\n        writer.writeAttributeString(undefined, 'prst', undefined, 'rect');\n        writer.writeStartElement('a', 'avLst', this.aNamespace);\n        writer.writeEndElement();\n        writer.writeEndElement();\n        //When the picture border has been added next to effect list\n        //if not, Picture border has not been preserved\n        // if (picture.HasBorder)\n        // {\n        //     if (picture.TextWrappingStyle === TextWrappingStyle.Inline && picture.IsShape)\n        //         SerializeInlineShapeLine(picture.PictureShape);\n        //     else\n        //         SerializeShapeLine(picture.PictureShape);\n        // }\n        // if (picture.DocxProps.length > 0)\n        //     SerializeDocxProps(picture.DocxProps, 'effectLst');\n        writer.writeEndElement();\n        writer.writeEndElement();\n        writer.writeEndElement();\n        writer.writeEndElement();\n    };\n    /// Update the shape id.\n    WordExport.prototype.updateShapeId = function (picture) {\n        var id = '';\n        var tOwner = this.paragraph;\n        // Adding picture byte data to the corresponding picture collection \n        // depending on its owner subdocument\n        if (this.headerFooter) {\n            id = this.updateHFImageRels(this.headerFooter, picture);\n        }\n        else {\n            if (id === '') {\n                if (tOwner.hasOwnProperty('sectionFormat') || tOwner.hasOwnProperty('inlines')) {\n                    id = this.addImageRelation(this.documentImages, picture);\n                    // if (owner is WFootnote)\n                    // {\n                    //     if ((owner as WFootnote).FootnoteType === FootnoteType.Footnote)\n                    //         id = AddImageRelation(FootnoteImages, picture.ImageRecord);\n                    //     else\n                    //         id = AddImageRelation(EndnoteImages, picture.ImageRecord);\n                    // }\n                    // if (owner is WComment)\n                    //     id = AddImageRelation(CommentImages, picture.ImageRecord);\n                }\n            }\n        }\n        return id;\n    };\n    // Adds the image relation.\n    WordExport.prototype.addImageRelation = function (imageCollection, image) {\n        var relationId = '';\n        // if (imageCollection.ContainsValue(imageRecord)) {\n        //     foreach(string key in imageCollection.keys)\n        //     {\n        //         if (imageRecord === imageCollection[key]) {\n        //             relationId = key;\n        //             break;\n        //         }\n        //     }\n        // }\n        // else {\n        relationId = this.getNextRelationShipID();\n        imageCollection.add(relationId, image);\n        // }\n        return relationId;\n    };\n    // Update the HeaderFooter image relations.\n    WordExport.prototype.updateHFImageRels = function (hf, image) {\n        var id = '';\n        // UpdateImages(image);\n        var headerId = '';\n        var types = this.headersFooters.keys;\n        for (var i = 0; i < types.length; i++) {\n            var hfColl = this.headersFooters.get(types[i]);\n            var hfKeys = hfColl.keys;\n            for (var j = 0; j < hfKeys.length; j++) {\n                if (hfColl.get(hfKeys[j]) === hf) {\n                    headerId = hfKeys[j];\n                    var headerImages = void 0;\n                    if (this.headerFooterImages.containsKey(headerId)) {\n                        headerImages = this.headerFooterImages.get(headerId);\n                        id = this.addImageRelation(headerImages, image);\n                    }\n                    else {\n                        headerImages = new Dictionary();\n                        id = this.addImageRelation(headerImages, image);\n                        this.headerFooterImages.add(headerId, headerImages);\n                    }\n                }\n            }\n        }\n        return id;\n    };\n    // Serialize the table\n    WordExport.prototype.serializeTable = function (writer, table) {\n        if (table.rows.length <= 0) {\n            return;\n        }\n        var owner = this.table;\n        this.table = table;\n        writer.writeStartElement(undefined, 'tbl', this.wNamespace);\n        var tableFormat = table.rows[0].rowFormat;\n        this.serializeTableFormat(writer, tableFormat, table);\n        this.serializeTableGrid(writer, table);\n        this.serializeTableRows(writer, table.rows);\n        writer.writeEndElement();\n        this.table = owner;\n    };\n    // Serialize the table grid\n    WordExport.prototype.serializeTableGrid = function (writer, table) {\n        writer.writeStartElement(undefined, 'tblGrid', this.wNamespace);\n        if (table.grid.length !== 0) {\n            this.serializeGridColumns(writer, table.grid);\n        }\n        writer.writeEndElement();\n    };\n    // Serialize the table rows\n    WordExport.prototype.serializeTableRows = function (writer, rows) {\n        if (rows.length > 0) {\n            for (var i = 0; i < rows.length; i++) {\n                var row = rows[i];\n                if (row.cells.length > 0) {\n                    this.serializeRow(writer, row);\n                }\n            }\n        }\n    };\n    // Serialize the table row\n    WordExport.prototype.serializeRow = function (writer, row) {\n        var owner = this.row;\n        this.row = row;\n        writer.writeStartElement(undefined, 'tr', this.wNamespace);\n        this.serializeRowFormat(writer, row);\n        this.serializeCells(writer, row.cells);\n        writer.writeEndElement(); //end od table row 'tr'\n        this.row = owner;\n    };\n    // Serialize the row format\n    WordExport.prototype.serializeRowFormat = function (writer, row) {\n        writer.writeStartElement(undefined, 'trPr', this.wNamespace);\n        //Serialize Row Height\n        if (row.rowFormat.height > 0) {\n            writer.writeStartElement(undefined, 'trHeight', this.wNamespace);\n            if (row.rowFormat.heightType === 'Exactly') {\n                writer.writeAttributeString('w', 'hRule', this.wNamespace, 'exact');\n            }\n            else if (row.rowFormat.heightType === 'AtLeast') {\n                writer.writeAttributeString('w', 'hRule', this.wNamespace, 'atLeast');\n            }\n            var height = this.roundToTwoDecimal(row.rowFormat.height * this.twentiethOfPoint).toString();\n            writer.writeAttributeString('w', 'val', this.wNamespace, height);\n            writer.writeEndElement();\n        }\n        var rowFormat = row.rowFormat;\n        // //Serialize 'gridBefore' element\n        var gridBefore = rowFormat.gridBefore;\n        if (gridBefore > 0) {\n            writer.writeStartElement(undefined, 'gridBefore', this.wNamespace);\n            writer.writeAttributeString('w', 'val', this.wNamespace, gridBefore.toString());\n            writer.writeEndElement();\n        }\n        // //Serialize 'gridAfter' element\n        var gridAfter = rowFormat.gridAfter;\n        if (gridAfter > 0) {\n            writer.writeStartElement(undefined, 'gridAfter', this.wNamespace);\n            writer.writeAttributeString('w', 'val', this.wNamespace, gridAfter.toString());\n            writer.writeEndElement();\n        }\n        // //Serialize 'wBefore' element \n        if (gridBefore > 0) {\n            writer.writeStartElement(undefined, 'wBefore', this.wNamespace);\n            switch (rowFormat.gridBeforeWidthType) {\n                case 'Percent':\n                    var width = this.roundToTwoDecimal(rowFormat.gridBeforeWidth * this.percentageFactor).toString();\n                    writer.writeAttributeString('w', 'val', this.wNamespace, width);\n                    writer.writeAttributeString('w', 'type', this.wNamespace, 'pct');\n                    break;\n                case 'Point':\n                    var pointWidth = this.roundToTwoDecimal(rowFormat.gridBeforeWidth * this.twipsInOnePoint).toString();\n                    writer.writeAttributeString('w', 'val', this.wNamespace, pointWidth);\n                    writer.writeAttributeString('w', 'type', this.wNamespace, 'dxa');\n                    break;\n            }\n            writer.writeEndElement();\n        }\n        //Serialize 'wAfter' element\n        if (gridAfter > 0) {\n            writer.writeStartElement(undefined, 'wAfter', this.wNamespace);\n            switch (rowFormat.gridAfterWidthType) {\n                case 'Percent':\n                    var width = this.roundToTwoDecimal(rowFormat.gridAfterWidth * this.percentageFactor).toString();\n                    writer.writeAttributeString('w', 'val', this.wNamespace, width);\n                    writer.writeAttributeString('w', 'type', this.wNamespace, 'pct');\n                    break;\n                case 'Point':\n                    var pointWidth = this.roundToTwoDecimal(rowFormat.gridAfterWidth * this.twipsInOnePoint).toString();\n                    writer.writeAttributeString('w', 'val', this.wNamespace, pointWidth);\n                    writer.writeAttributeString('w', 'type', this.wNamespace, 'dxa');\n                    break;\n            }\n            writer.writeEndElement();\n        }\n        //Serialize 'cantSplit' element \n        if (!rowFormat.allowBreakAcrossPages) {\n            writer.writeStartElement(undefined, 'cantSplit', this.wNamespace);\n            writer.writeEndElement();\n        }\n        // //Serialize 'tblHeader' element \n        if (rowFormat.isHeader) {\n            writer.writeStartElement(undefined, 'tblHeader', this.wNamespace);\n            writer.writeEndElement();\n        }\n        writer.writeEndElement();\n    };\n    // serialize the table cells\n    WordExport.prototype.serializeCells = function (writer, cells) {\n        for (var i = 0; i < cells.length; i++) {\n            this.serializeCell(writer, cells[i]);\n        }\n    };\n    // Serialize the table cell\n    WordExport.prototype.serializeCell = function (writer, cell) {\n        var owner = this.blockOwner;\n        this.blockOwner = cell;\n        writer.writeStartElement(undefined, 'tc', this.wNamespace);\n        this.serializeCellFormat(writer, cell.cellFormat);\n        if (cell.blocks.length > 0) {\n            var itemIndex = 0;\n            var item = undefined;\n            while (itemIndex < cell.blocks.length) {\n                item = cell.blocks[itemIndex];\n                this.serializeBodyItem(writer, item, false);\n                itemIndex += 1;\n            }\n        }\n        else {\n            writer.writeStartElement(undefined, 'p', this.wNamespace);\n            writer.writeStartElement(undefined, 'pPr', this.wNamespace);\n            writer.writeStartElement(undefined, 'pStyle', this.wNamespace);\n            writer.writeAttributeString('w', 'val', this.wNamespace, 'Normal');\n            writer.writeEndElement(); //end of pStyle\n            writer.writeEndElement(); //end of pPr\n            writer.writeEndElement(); //end of P\n        }\n        writer.writeEndElement(); //end of table cell 'tc'        \n        this.blockOwner = owner;\n    };\n    // Serialize the cell formatting\n    WordExport.prototype.serializeCellFormat = function (writer, cellFormat) {\n        var cell = this.blockOwner;\n        //Get the table fomat\n        var tf = this.table.tableFormat;\n        //Get the row format\n        var rf = this.row.rowFormat;\n        writer.writeStartElement(undefined, 'tcPr', this.wNamespace);\n        //w:cnfStyle -   Table Cell Conditional Formatting\n        // SerializeCnfStyleElement(cell);\n        //w:tcW -    Preferred Table Cell Width\n        this.serializeCellWidth(writer, cell);\n        //w:hMerge -    Horizontally Merged Cell and w:vMerge -    Vertically Merged Cell\n        this.serializeCellMerge(writer, cellFormat);\n        //w:gridSpan -   Grid Columns Spanned by Current Table Cell\n        this.serializeGridSpan(writer, cell);\n        //w:tcBorders -    Table Cell Borders\n        writer.writeStartElement(undefined, 'tcBorders', this.wNamespace);\n        this.serializeBorders(writer, cellFormat.borders, 8);\n        writer.writeEndElement();\n        //w:shd -  Table Cell Shading\n        this.serializeShading(writer, cell.cellFormat.shading);\n        // //w:noWrap -   Don't Wrap Cell Content\n        // if (cellFormat.HasValue(CellFormat.TextWrapKey)) {\n        //     m_writer.WriteStartElement('noWrap', W_namespace);\n        //     if (cellFormat.TextWrap)\n        //         m_writer.WriteAttributeString('w', 'val', W_namespace, 'false');\n        //     m_writer.WriteEndElement();\n        // }\n        // //w:tcMar -  Single Table Cell Margins\n        // if (!cellFormat.SamePaddingsAsTable) {\n        //     m_writer.WriteStartElement('tcMar', W_namespace);\n        //     SerializePaddings(cellFormat.Paddings);\n        //     m_writer.WriteEndElement();\n        // }\n        //w:textDirection -   Table Cell Text Flow Direction\n        this.serializeTableCellDirection(writer, cellFormat);\n        // //w:tcFitText -  Fit Text Within Cell\n        // if (cellFormat.FitText) {\n        //     m_writer.WriteStartElement('tcFitText', W_namespace);\n        //     m_writer.WriteEndElement();\n        // }\n        // //w:hideMark \n        // if (cellFormat.HideMark) {\n        //     m_writer.WriteStartElement('hideMark', W_namespace);\n        //     m_writer.WriteEndElement();\n        // }\n        //w:vAlign -  Table Cell Vertical Alignment\n        // if (cellFormat.HasValue(CellFormat.VrAlignmentKey))\n        this.serializeCellVerticalAlign(writer, cellFormat.verticalAlignment);\n        // //w:hideMark -   Ignore End Of Cell Marker In Row Height Calculation\n        // SerializeDocxProps(tempDocxProps, 'hideMark');\n        // //w:cellIns -    Table Cell Insertion\n        // SerializeDocxProps(tempDocxProps, 'cellIns');\n        // //w:cellDel -    Table Cell Deletion\n        // SerializeDocxProps(tempDocxProps, 'cellDel');\n        // //w:cellMerge -   Vertically Merged/Split Table Cells\n        // SerializeDocxProps(tempDocxProps, 'cellMerge');\n        // if (cellFormat.OldPropertiesHash.length > 0 && !m_isAlternativeCellFormat) {\n        //     m_isAlternativeCellFormat = true;\n        //     SerializeTrackChangeProps('tcPrChange', cellFormat.FormatChangeAuthorName, cellFormat.FormatChangeDateTime);\n        //     Dictionary < int, object > oldPropertyHash = new Dictionary<int, object>(cellFormat.OldPropertiesHash);\n        //     Dictionary < int, object > propertyHash = new Dictionary<int, object>(cellFormat.PropertiesHash);\n        //     cellFormat.PropertiesHash.Clear();\n        //     cellFormat.OldPropertiesHash.Clear();\n        //     foreach(KeyValuePair < int, object > keyValue in oldPropertyHash)\n        //     cellFormat.PropertiesHash[keyValue.Key] = keyValue.Value;\n        //     SerializeCellFormat(cellFormat);\n        //     cellFormat.PropertiesHash.Clear();\n        //     foreach(KeyValuePair < int, object > keyValue in propertyHash)\n        //     cellFormat.PropertiesHash[keyValue.Key] = keyValue.Value;\n        //     foreach(KeyValuePair < int, object > keyValue in oldPropertyHash)\n        //     cellFormat.OldPropertiesHash[keyValue.Key] = keyValue.Value;\n        //     m_writer.WriteEndElement();\n        //     m_isAlternativeCellFormat = false;\n        // }\n        writer.writeEndElement();\n    };\n    // Serialize the cell width\n    WordExport.prototype.serializeCellWidth = function (writer, cell) {\n        var cf = cell.cellFormat;\n        writer.writeStartElement(undefined, 'tcW', this.wNamespace);\n        if (cf.preferredWidthType === 'Percent') {\n            writer.writeAttributeString(undefined, 'type', this.wNamespace, 'pct');\n            // tslint:disable-next-line:max-line-length\n            writer.writeAttributeString(undefined, 'w', this.wNamespace, this.roundToTwoDecimal(cf.preferredWidth * this.percentageFactor).toString());\n        }\n        else if (cf.preferredWidthType === 'Point') {\n            // tslint:disable-next-line:max-line-length\n            writer.writeAttributeString(undefined, 'w', this.wNamespace, this.roundToTwoDecimal(cf.preferredWidth * this.twipsInOnePoint).toString());\n            writer.writeAttributeString(undefined, 'type', this.wNamespace, 'dxa');\n        }\n        else {\n            writer.writeAttributeString(undefined, 'type', this.wNamespace, 'auto');\n            writer.writeAttributeString(undefined, 'w', this.wNamespace, '0');\n        }\n        writer.writeEndElement();\n    };\n    // Serialize cell merge\n    WordExport.prototype.serializeCellMerge = function (writer, cellFormat) {\n        var cell = this.blockOwner;\n        var isserialized = false;\n        var collKey;\n        var currentIndex = cell.columnIndex;\n        var cellIndex = this.row.cells.indexOf(cell);\n        var prevIndex = cellIndex > 0 ? this.row.cells[cellIndex - 1].columnIndex : cell.columnIndex;\n        if (cell.columnIndex === cellIndex) {\n            collKey = cell.columnIndex;\n            isserialized = true;\n        }\n        else {\n            isserialized = false;\n        }\n        if (!isserialized) {\n            if (cellIndex === 0) {\n                currentIndex = cell.columnIndex;\n                prevIndex = -1;\n            }\n            for (var i = prevIndex; i < currentIndex; i++) {\n                collKey = prevIndex + 1;\n                prevIndex += 1;\n                if (this.mVerticalMerge.containsKey(collKey)) {\n                    this.createMerge(writer, collKey, cell);\n                }\n            }\n        }\n        if (cellFormat.rowSpan > 1) {\n            writer.writeStartElement(undefined, 'vMerge', this.wNamespace);\n            this.mVerticalMerge.add(collKey, cellFormat.rowSpan - 1);\n            if (cellFormat.columnSpan > 1) {\n                this.mGridSpans.add(collKey, cellFormat.columnSpan);\n            }\n            writer.writeAttributeString('w', 'val', this.wNamespace, 'restart');\n            writer.writeEndElement();\n        }\n        else if (this.mVerticalMerge.containsKey(collKey) && isserialized) {\n            this.createMerge(writer, collKey, cell);\n        }\n        else if (this.mVerticalMerge.containsKey(cellIndex + 1) && isserialized && cell.nextNode === undefined) {\n            collKey = cell.columnIndex + 1;\n            writer.writeEndElement();\n            writer.writeStartElement('w', 'p', this.wNamespace);\n            writer.writeEndElement();\n            writer.writeEndElement();\n            writer.writeStartElement(undefined, 'tc', this.wNamespace);\n            writer.writeStartElement(undefined, 'tcPr', this.wNamespace);\n            this.serializeColumnSpan(collKey, writer);\n            writer.writeStartElement(undefined, 'vMerge', this.wNamespace);\n            writer.writeAttributeString('w', 'val', this.wNamespace, 'continue');\n            writer.writeEndElement();\n            this.checkMergeCell(collKey);\n        }\n    };\n    WordExport.prototype.createMerge = function (writer, collKey, cell) {\n        this.serializeColumnSpan(collKey, writer);\n        writer.writeStartElement(undefined, 'vMerge', this.wNamespace);\n        writer.writeAttributeString('w', 'val', this.wNamespace, 'continue');\n        writer.writeEndElement();\n        writer.writeEndElement(); //end tcPr\n        writer.writeStartElement('w', 'p', this.wNamespace);\n        writer.writeEndElement();\n        writer.writeEndElement(); //end tc\n        writer.writeStartElement(undefined, 'tc', this.wNamespace);\n        writer.writeStartElement(undefined, 'tcPr', this.wNamespace);\n        this.serializeCellWidth(writer, cell);\n        this.checkMergeCell(collKey);\n    };\n    WordExport.prototype.serializeColumnSpan = function (collKey, writer) {\n        if (this.mGridSpans.keys.length > 0 && this.mGridSpans.containsKey(collKey)) {\n            writer.writeStartElement(undefined, 'gridSpan', this.wNamespace);\n            writer.writeAttributeString('w', 'val', this.wNamespace, this.mGridSpans.get(collKey).toString());\n            writer.writeEndElement();\n        }\n    };\n    WordExport.prototype.checkMergeCell = function (collKey) {\n        if ((this.mVerticalMerge.get(collKey) - 1) === 0) {\n            this.mVerticalMerge.remove(collKey);\n            if (this.mGridSpans.keys.length > 0 && this.mGridSpans.containsKey(collKey)) {\n                this.mGridSpans.remove(collKey);\n            }\n        }\n        else {\n            this.mVerticalMerge.set(collKey, this.mVerticalMerge.get(collKey) - 1);\n        }\n    };\n    // Serialize the grid span element of cell.\n    WordExport.prototype.serializeGridSpan = function (writer, cell) {\n        // int gridSpan = cell.cellFormat.GridSpan;\n        if (cell.cellFormat.columnSpan > 1) {\n            var num = cell.cellFormat.columnSpan;\n            writer.writeStartElement(undefined, 'gridSpan', this.wNamespace);\n            writer.writeAttributeString('w', 'val', this.wNamespace, num.toString());\n            writer.writeEndElement();\n        }\n    };\n    // Serialize the table cell direction\n    WordExport.prototype.serializeTableCellDirection = function (writer, cellFormat) {\n        // if (cellFormat..textDirection !== TextDirection.Horizontal)\n        // {\n        //     m_writer.WriteStartElement('textDirection', W_namespace);\n        //     switch (cellFormat.TextDirection)\n        //     {\n        //         case TextDirection.Horizontal:\n        //             m_writer.WriteAttributeString('w', 'val', W_namespace, 'lrTb');\n        //             break;\n        //         case TextDirection.VerticalBottomToTop:\n        //             m_writer.WriteAttributeString('w', 'val', W_namespace, 'btLr');\n        //             break;\n        //         case TextDirection.VerticalTopToBottom:\n        //             m_writer.WriteAttributeString('w', 'val', W_namespace, 'tbRl');\n        //             break;\n        //         case TextDirection.HorizontalFarEast:\n        //             m_writer.WriteAttributeString('w', 'val', W_namespace, 'lrTbV');\n        //             break;\n        //         case TextDirection.Vertical:\n        //             m_writer.WriteAttributeString('w', 'val', W_namespace, 'tbLrV');\n        //             break;\n        //         case TextDirection.VerticalFarEast:\n        //             m_writer.WriteAttributeString('w', 'val', W_namespace, 'tbRlV');\n        //             break;\n        //     }\n        //     m_writer.WriteEndElement();\n        // }\n    };\n    // Serialize the cell vertical alignment\n    WordExport.prototype.serializeCellVerticalAlign = function (writer, alignment) {\n        writer.writeStartElement(undefined, 'vAlign', this.wNamespace);\n        switch (alignment) {\n            case 'Top':\n                writer.writeAttributeString('w', 'val', this.wNamespace, 'top');\n                break;\n            case 'Center':\n                writer.writeAttributeString('w', 'val', this.wNamespace, 'center');\n                break;\n            default:\n                writer.writeAttributeString('w', 'val', this.wNamespace, 'bottom');\n                break;\n        }\n        writer.writeEndElement();\n    };\n    // Serialize the table grid columns.\n    WordExport.prototype.serializeGridColumns = function (writer, grid) {\n        for (var i = 1, count = grid.length; i < count; i++) {\n            var gridValue = Math.round(grid[i] * 20);\n            writer.writeStartElement(undefined, 'gridCol', this.wNamespace);\n            writer.writeAttributeString(undefined, 'w', this.wNamespace, gridValue.toString());\n            writer.writeEndElement();\n        }\n    };\n    // Serialize the row formattings.\n    // Table parameter is passed for serializing table format and undefined for serializing row format.\n    WordExport.prototype.serializeTableFormat = function (writer, format, table) {\n        // if (!isNullOrUndefined(table))\n        // {\n        //     List<Stream> tempDocxProps = new List<Stream>();\n        //     for (int i = 0, cnt = table.DocxTableFormat.NodeArray.length; i < cnt; i++)\n        //         tempDocxProps.Add(table.DocxTableFormat.NodeArray[i]);\n        writer.writeStartElement(undefined, 'tblPr', this.wNamespace);\n        //     SerializeTableStlye(format);\n        //     if (format.WrapTextAround &&!((table.OwnerTextBody.Owner is WTextBox) || \n        //(table.OwnerTextBody.Owner is WComment) || (table.OwnerTextBody.Owner is WFootnote)))\n        //     {\n        //         SerializeTablePositioning(format.Positioning);\n        //         if (!format.Positioning.AllowOverlap)\n        //         {\n        //             m_writer.WriteStartElement('tblOverlap', W_namespace);\n        //             m_writer.WriteAttributeString('val', W_namespace, 'never');\n        //             m_writer.WriteEndElement();\n        //         }\n        //     }\n        //     if (format.Bidi)\n        //     {\n        //         m_writer.WriteStartElement('bidiVisual', W_namespace);\n        //         m_writer.WriteEndElement();\n        //     }\n        //     SerializeDocxProps(tempDocxProps, 'tblStyleRowBandSize');\n        //     SerializeDocxProps(tempDocxProps, 'tblStyleColBandSize');\n        this.serializeTableWidth(writer, table);\n        this.serializeTableAlignment(writer, table.tableFormat);\n        this.serializeCellSpacing(writer, table.tableFormat);\n        this.serializeTableIndentation(writer, table.tableFormat);\n        this.serializeTableBorders(writer, table.tableFormat);\n        this.serializeShading(writer, table.tableFormat.shading);\n        this.serializeTblLayout(writer, table.tableFormat);\n        // this.serializeTableCellMargin(writer, table.tableFormat);\n        //     SerializeTableLook(table);\n        //         if (!isNullOrUndefined(table.Title))\n        //             SerializeTableTitle(table);\n        //         if (!isNullOrUndefined(table.Description))\n        //             SerializeTableDescription(table);\n        // }\n        // else\n        // {\n        //     SerializeCellSpacing(format);\n        //     SerializeTableIndentation(format);\n        //     SerializeTableBorders(format);\n        //     SerializeTableShading(format);\n        //     SerializeTblLayout(format);\n        //     SerializeTableCellMargin(format);\n        // }\n        // if (!isNullOrUndefined(format.OwnerBase) && format.OwnerBase is WTable\n        //   && format.OldPropertiesHash.length > 0 && !m_isAlternativeTableFormat)\n        // {\n        //     m_isAlternativeTableFormat = true;\n        //     SerializeTrackChangeProps('tblPrChange', format.FormatChangeAuthorName, format.FormatChangeDateTime);\n        //     SerializeTableTrackChanges(format, format.OwnerBase as WTable);\n        //     m_writer.WriteEndElement();\n        //     m_isAlternativeTableFormat = false;\n        // }\n        // if (!isNullOrUndefined(format.OwnerRow) && format.OldPropertiesHash.length > 0)\n        // {\n        //     SerializeTrackChangeProps('tblPrExChange', format.FormatChangeAuthorName, format.FormatChangeDateTime);\n        //     SerializeTableTrackChanges(format, undefined);\n        //     m_writer.WriteEndElement();\n        // }\n        // SerializeTblTrackChanges(format);\n        if (!isNullOrUndefined(table)) {\n            writer.writeEndElement(); //end of tblPr\n        }\n    };\n    // Serialize the table borders\n    WordExport.prototype.serializeShading = function (writer, format) {\n        // if (format.textureStyle !== 'TextureNone') {\n        writer.writeStartElement(undefined, 'shd', this.wNamespace);\n        writer.writeAttributeString(undefined, 'fill', this.wNamespace, this.getColor(format.backgroundColor));\n        if (format.foregroundColor === 'empty') {\n            writer.writeAttributeString(undefined, 'color', this.wNamespace, 'auto');\n        }\n        else {\n            writer.writeAttributeString(undefined, 'color', this.wNamespace, this.getColor(format.foregroundColor));\n        }\n        writer.writeAttributeString('w', 'val', this.wNamespace, this.getTextureStyle(format.textureStyle));\n        writer.writeEndElement();\n        // }\n    };\n    WordExport.prototype.getTextureStyle = function (textureStyle) {\n        switch (textureStyle) {\n            case 'Texture5Percent':\n            case 'Texture2Pt5Percent':\n            case 'Texture7Pt5Percent':\n                return 'pct5';\n            case 'Texture10Percent':\n                return 'pct10';\n            case 'Texture12Pt5Percent':\n                return 'pct12';\n            case 'Texture15Percent':\n            case 'Texture17Pt5Percent':\n                return 'pct15';\n            case 'Texture20Percent':\n            case 'Texture22Pt5Percent':\n                return 'pct20';\n            case 'Texture25Percent':\n            case 'Texture27Pt5Percent':\n                return 'pct25';\n            case 'Texture30Percent':\n            case 'Texture32Pt5Percent':\n                return 'pct30';\n            case 'Texture35Percent':\n                return 'pct35';\n            case 'Texture37Pt5Percent':\n                return 'pct37';\n            case 'Texture40Percent':\n            case 'Texture42Pt5Percent':\n                return 'pct40';\n            case 'Texture45Percent':\n            case 'Texture47Pt5Percent':\n                return 'pct45';\n            case 'Texture50Percent':\n            case 'Texture52Pt5Percent':\n                return 'pct50';\n            case 'Texture55Percent':\n            case 'Texture57Pt5Percent':\n                return 'pct55';\n            case 'Texture60Percent':\n                return 'pct60';\n            case 'Texture62Pt5Percent':\n                return 'pct62';\n            case 'Texture65Percent':\n            case 'Texture67Pt5Percent':\n                return 'pct65';\n            case 'Texture70Percent':\n            case 'Texture72Pt5Percent':\n                return 'pct70';\n            case 'Texture75Percent':\n            case 'Texture77Pt5Percent':\n                return 'pct75';\n            case 'Texture80Percent':\n            case 'Texture82Pt5Percent':\n                return 'pct80';\n            case 'Texture85Percent':\n                return 'pct85';\n            case 'Texture87Pt5Percent':\n                return 'pct87';\n            case 'Texture90Percent':\n            case 'Texture92Pt5Percent':\n                return 'pct90';\n            case 'Texture95Percent':\n            case 'Texture97Pt5Percent':\n                return 'pct95';\n            case 'TextureCross':\n                return 'thinHorzCross';\n            case 'TextureDarkCross':\n                return 'horzCross';\n            case 'TextureDarkDiagonalCross':\n                return 'diagCross';\n            case 'TextureDarkDiagonalDown':\n                return 'reverseDiagStripe';\n            case 'TextureDarkDiagonalUp':\n                return 'diagStripe';\n            case 'TextureDarkHorizontal':\n                return 'horzStripe';\n            case 'TextureDarkVertical':\n                return 'vertStripe';\n            case 'TextureDiagonalCross':\n                return 'thinDiagCross';\n            case 'TextureDiagonalDown':\n                return 'thinReverseDiagStripe';\n            case 'TextureDiagonalUp':\n                return 'thinDiagStripe';\n            case 'TextureHorizontal':\n                return 'thinHorzStripe';\n            case 'TextureSolid':\n                return 'solid';\n            case 'TextureVertical':\n                return 'thinVertStripe';\n            default:\n                return 'clear';\n        }\n    };\n    // Serialize the table borders\n    WordExport.prototype.serializeTableBorders = function (writer, format) {\n        var borders = format.borders;\n        // if (IsNoneBorder(borders))\n        //     return;\n        writer.writeStartElement(undefined, 'tblBorders', this.wNamespace);\n        this.serializeBorders(writer, format.borders, 8);\n        writer.writeEndElement();\n    };\n    // Serialize the borders.\n    WordExport.prototype.serializeBorders = function (writer, borders, multipler) {\n        this.serializeBorder(writer, borders.top, 'top', multipler);\n        this.serializeBorder(writer, borders.left, 'left', multipler);\n        this.serializeBorder(writer, borders.bottom, 'bottom', multipler);\n        this.serializeBorder(writer, borders.right, 'right', multipler);\n        this.serializeBorder(writer, borders.horizontal, 'insideH', multipler);\n        this.serializeBorder(writer, borders.vertical, 'insideV', multipler);\n        this.serializeBorder(writer, borders.diagonalDown, 'tl2br', multipler);\n        this.serializeBorder(writer, borders.diagonalUp, 'tr2bl', multipler);\n    };\n    // Serialize the table layout element\n    WordExport.prototype.serializeTblLayout = function (writer, format) {\n        //TODO: AUTO size property is not mapped yet\n        // if (!format.IsAutoResized)\n        // {\n        //     writer.writeStartElement(undefined, 'tblLayout', this.wNamespace);\n        //     writer.writeAttributeString(undefined, 'type', this.wNamespace, 'fixed');\n        //     writer.writeEndElement();\n        // }\n    };\n    // Serializes the Border\n    WordExport.prototype.serializeBorder = function (writer, border, tagName, multiplier) {\n        var borderStyle = border.lineStyle;\n        var sz = (border.lineWidth * multiplier);\n        var space = border.space;\n        if (borderStyle === 'Cleared') {\n            writer.writeStartElement(undefined, tagName, this.wNamespace);\n            writer.writeAttributeString('w', 'val', this.wNamespace, 'nil');\n            writer.writeEndElement();\n            return;\n        }\n        else if ((borderStyle === 'None' && !border.hasNoneStyle) || sz <= 0) {\n            return;\n        }\n        writer.writeStartElement(undefined, tagName, this.wNamespace);\n        writer.writeAttributeString('w', 'val', this.wNamespace, this.getBorderStyle(borderStyle));\n        // if (border.color === '#000000')\n        // {\n        //     writer.writeAttributeString(undefined, 'color', this.wNamespace, 'auto');\n        // }\n        // else\n        // {\n        writer.writeAttributeString(undefined, 'color', this.wNamespace, this.getColor(border.color));\n        // }\n        writer.writeAttributeString(undefined, 'sz', this.wNamespace, this.roundToTwoDecimal(sz).toString());\n        writer.writeAttributeString(undefined, 'space', this.wNamespace, space.toString());\n        if (border.shadow) {\n            writer.writeAttributeString(undefined, 'shadow', this.wNamespace, 'on');\n        }\n        writer.writeEndElement();\n    };\n    // Get the border style as string\n    WordExport.prototype.getBorderStyle = function (borderStyle) {\n        switch (borderStyle) {\n            case 'Cleared':\n                return 'cleared';\n            case 'DashSmallGap':\n                return 'dashSmallGap';\n            case 'Triple':\n                return 'triple';\n            case 'Dot':\n                return 'dotted';\n            case 'DashDot':\n                return 'dotDash';\n            case 'DashLargeGap':\n                return 'dashed';\n            case 'DashDotDot':\n                return 'dotDotDash';\n            case 'Double':\n                return 'double';\n            case 'ThinThickSmallGap':\n                return 'thinThickSmallGap';\n            case 'ThickThinSmallGap':\n                return 'thickThinSmallGap';\n            case 'ThinThickThinSmallGap':\n                return 'thinThickThinSmallGap';\n            case 'ThickThinMediumGap':\n                return 'thickThinMediumGap';\n            case 'ThinThickMediumGap':\n                return 'thinThickMediumGap';\n            case 'ThinThickThinMediumGap':\n                return 'thinThickThinMediumGap';\n            case 'ThickThinLargeGap':\n                return 'thickThinLargeGap';\n            case 'ThinThickLargeGap':\n                return 'thinThickLargeGap';\n            case 'ThinThickThinLargeGap':\n                return 'thinThickThinLargeGap';\n            case 'Thick':\n                return 'thick';\n            case 'SingleWavy':\n                return 'wave';\n            case 'DoubleWavy':\n                return 'doubleWave';\n            case 'DashDotStroked':\n                return 'dashDotStroked';\n            case 'Engrave3D':\n                return 'threeDEngrave';\n            case 'Emboss3D':\n                return 'threeDEmboss';\n            case 'Outset':\n                return 'outset';\n            case 'Inset':\n                return 'inset';\n            // case 'None':\n            //     return 'none';\n            default:\n                return 'single';\n        }\n    };\n    // Serialize the table indentation.\n    WordExport.prototype.serializeTableIndentation = function (writer, format) {\n        writer.writeStartElement(undefined, 'tblInd', this.wNamespace);\n        var tableIndent = Math.round(format.leftIndent * this.twipsInOnePoint);\n        writer.writeAttributeString(undefined, 'w', this.wNamespace, tableIndent.toString());\n        writer.writeAttributeString(undefined, 'type', this.wNamespace, 'dxa');\n        writer.writeEndElement();\n    };\n    // Serialize the cell spacing.\n    WordExport.prototype.serializeCellSpacing = function (writer, format) {\n        if (!isNullOrUndefined(format.cellSpacing) && format.cellSpacing >= 0) {\n            writer.writeStartElement(undefined, 'tblCellSpacing', this.wNamespace);\n            // tslint:disable-next-line:max-line-length\n            writer.writeAttributeString(undefined, 'w', this.wNamespace, this.roundToTwoDecimal(format.cellSpacing * this.twentiethOfPoint).toString());\n            writer.writeAttributeString(undefined, 'type', this.wNamespace, 'dxa');\n            writer.writeEndElement();\n        }\n    };\n    // Serialize the table width\n    WordExport.prototype.serializeTableWidth = function (writer, table) {\n        writer.writeStartElement(undefined, 'tblW', this.wNamespace);\n        if (table.tableFormat.preferredWidthType === 'Percent') {\n            // tslint:disable-next-line:max-line-length\n            writer.writeAttributeString(undefined, 'w', this.wNamespace, (table.tableFormat.preferredWidth * this.percentageFactor).toString());\n            writer.writeAttributeString(undefined, 'type', this.wNamespace, 'pct');\n        }\n        else if (table.tableFormat.preferredWidthType === 'Point') {\n            var tableWidth = Math.round(table.tableFormat.preferredWidth * this.twipsInOnePoint);\n            writer.writeAttributeString(undefined, 'w', this.wNamespace, tableWidth.toString());\n            writer.writeAttributeString(undefined, 'type', this.wNamespace, 'dxa');\n        }\n        else {\n            writer.writeAttributeString(undefined, 'w', this.wNamespace, '0');\n            writer.writeAttributeString(undefined, 'type', this.wNamespace, 'auto');\n        }\n        writer.writeEndElement();\n    };\n    // Serialize the table alignment\n    WordExport.prototype.serializeTableAlignment = function (writer, format) {\n        writer.writeStartElement(undefined, 'jc', this.wNamespace);\n        switch (format.tableAlignment) {\n            case 'Right':\n                writer.writeAttributeString('w', 'val', this.wNamespace, 'right');\n                break;\n            case 'Center':\n                writer.writeAttributeString('w', 'val', this.wNamespace, 'center');\n                break;\n            default:\n                writer.writeAttributeString('w', 'val', this.wNamespace, 'left');\n                break;\n        }\n        writer.writeEndElement();\n    };\n    // Serialize the field\n    WordExport.prototype.serializeFieldCharacter = function (writer, field) {\n        writer.writeStartElement(undefined, 'r', this.wNamespace);\n        this.serializeCharacterFormat(writer, field.characterFormat);\n        writer.writeStartElement(undefined, 'fldChar', this.wNamespace);\n        var type = field.fieldType === 0 ? 'begin'\n            : field.fieldType === 1 ? 'end' : 'separate';\n        writer.writeAttributeString(undefined, 'fldCharType', this.wNamespace, type);\n        writer.writeEndElement();\n        writer.writeEndElement();\n    };\n    // Serialize the text range.\n    WordExport.prototype.serializeTextRange = function (writer, span, previousNode) {\n        writer.writeStartElement('w', 'r', this.wNamespace);\n        this.serializeCharacterFormat(writer, span.characterFormat);\n        if (span.text === '\\t') {\n            writer.writeElementString(undefined, 'tab', this.wNamespace, undefined);\n        }\n        else if (span.text === '\\v') {\n            writer.writeElementString(undefined, 'br', this.wNamespace, undefined);\n        }\n        else if (span.text === '\\f') {\n            writer.writeStartElement(undefined, 'br', this.wNamespace);\n            writer.writeAttributeString('w', 'type', this.wNamespace, 'page');\n            writer.writeEndElement();\n        }\n        else {\n            var isField = !isNullOrUndefined(previousNode)\n                && previousNode.hasOwnProperty('fieldType') && previousNode.fieldType !== 2;\n            writer.writeStartElement(undefined, isField ? 'instrText' : 't', this.wNamespace);\n            writer.writeAttributeString('xml', 'space', this.xmlNamespace, 'preserve');\n            writer.writeString(span.text);\n            writer.writeEndElement();\n        }\n        writer.writeEndElement();\n    };\n    // Serializes the paragraph format\n    WordExport.prototype.serializeParagraphFormat = function (writer, paragraphFormat, paragraph) {\n        if (!isNullOrUndefined(paragraphFormat.styleName)) {\n            writer.writeStartElement(undefined, 'pStyle', this.wNamespace);\n            writer.writeAttributeString('w', 'val', this.wNamespace, paragraphFormat.styleName);\n            writer.writeEndElement(); //end of pStyle\n        }\n        if (!isNullOrUndefined(paragraph)) {\n            this.serializeListFormat(writer, paragraph.paragraphFormat.listFormat);\n        }\n        else {\n            this.serializeListFormat(writer, paragraphFormat.listFormat);\n        }\n        this.serializeParagraphSpacing(writer, paragraphFormat);\n        this.serializeIndentation(writer, paragraphFormat);\n        this.serializeParagraphAlignment(writer, paragraphFormat.textAlignment);\n        if (!isNullOrUndefined(paragraphFormat.tabs) && paragraphFormat.tabs.length > 0) {\n            this.serializeTabs(writer, paragraphFormat.tabs);\n        }\n    };\n    // Serialize Tabs\n    WordExport.prototype.serializeTabs = function (writer, tabStops) {\n        writer.writeStartElement('w', 'tabs', this.wNamespace);\n        for (var i = 0; i < tabStops.length; i++) {\n            this.serializeTab(writer, tabStops[i]);\n        }\n        writer.writeEndElement();\n    };\n    WordExport.prototype.serializeTab = function (writer, tabStop) {\n        var position = 0;\n        writer.writeStartElement('w', 'tab', this.wNamespace);\n        if (tabStop.position === 0 && tabStop.deletePosition !== 0) {\n            position = tabStop.deletePosition * this.twentiethOfPoint;\n            writer.writeAttributeString('w', 'val', this.wNamespace, 'clear');\n        }\n        else {\n            position = tabStop.position * this.twentiethOfPoint;\n            writer.writeAttributeString('w', 'val', this.wNamespace, this.getTabJustification(tabStop.tabJustification));\n        }\n        if (!isNullOrUndefined(tabStop.tabLeader) && (tabStop.tabLeader !== 'None')) {\n            writer.writeAttributeString('w', 'leader', this.wNamespace, this.getTabLeader(tabStop.tabLeader));\n        }\n        writer.writeAttributeString('w', 'pos', this.wNamespace, position.toString() + '');\n        writer.writeEndElement();\n    };\n    WordExport.prototype.getTabLeader = function (tabLeader) {\n        switch (tabLeader) {\n            case 'Dot':\n                return 'dot';\n            case 'Hyphen':\n                return 'hyphen';\n            case 'Underscore':\n                return 'underscore';\n            default:\n                return 'none';\n        }\n    };\n    WordExport.prototype.getTabJustification = function (tabJustification) {\n        switch (tabJustification) {\n            case 'Bar':\n                return 'bar';\n            case 'Center':\n                return 'center';\n            case 'Decimal':\n                return 'decimal';\n            case 'Left':\n                return 'left';\n            case 'List':\n                return 'num';\n            case 'Right':\n                return 'right';\n            default:\n                return 'clear';\n        }\n    };\n    // // Seraializes the pargraph list format\n    // private serializeListParagraph(writer: XmlWriter, paragraph: any): void {\n    //     if (!isNullOrUndefined(paragraph.paragraphFormat.listFormat)) {\n    //         this.serializeListFormat(writer, paragraph.paragraphFormat.listFormat);\n    //     }\n    // }\n    // Serialize the list format\n    WordExport.prototype.serializeListFormat = function (writer, lf) {\n        // let pStyleName = undefined;\n        // if (lf.CurrentListStyle.IsBuiltInStyle && !isNullOrUndefined(lf.OwnerParagraph))\n        // {\n        //     pStyleName = lf.OwnerParagraph.StyleName;\n        // }\n        // int listId = GetListId(lf);\n        // if (!isNullOrUndefined(pStyleName) && string.IsNullOrEmpty(lf.LFOStyleName)) \n        // {\n        //     WordDocument doc = lf.OwnerParagraph.Document;\n        //     WParagraphStyle style = doc.Styles.FindByName(pStyleName, StyleType.ParagraphStyle) as WParagraphStyle;\n        //     if (style.ListIndex === -1)\n        //     {\n        //         ListStyle lstStyle = lf.OwnerParagraph.Document.ListStyles.FindByName(lf.CustomStyleName);\n        //         style.ListIndex = listId;\n        //         if (lstStyle.Levels.length > 1)\n        //         {\n        //             style.ListLevel = lf.ListLevelNumber;\n        //         }\n        //         pStyleName = pStyleName.Replace(' ', '');\n        //         lstStyle.Levels[lf.ListLevelNumber].ParaStyleName = pStyleName;\n        //     }\n        // }\n        // else\n        // {\n        // if (!isNullOrUndefined(lf.listId) && !isNullOrUndefined(lf.listLevelNumber)) {\n        //     this.serializeNumPr(writer, lf.listId, lf.listLevelNumber);\n        // }\n        // }\n        if (!isNullOrUndefined(lf.listId) || !isNullOrUndefined(lf.listLevelNumber)) {\n            writer.writeStartElement(undefined, 'numPr', this.wNamespace);\n            if (!isNullOrUndefined(lf.listLevelNumber) && lf.listLevelNumber !== -1) {\n                writer.writeStartElement(undefined, 'ilvl', this.wNamespace);\n                writer.writeAttributeString('w', 'val', this.wNamespace, lf.listLevelNumber.toString());\n                writer.writeEndElement();\n            }\n            if (!isNullOrUndefined(lf.listId) && lf.listId !== -1) {\n                writer.writeStartElement(undefined, 'numId', this.wNamespace);\n                writer.writeAttributeString('w', 'val', this.wNamespace, (lf.listId + 1).toString());\n                writer.writeEndElement();\n            }\n            writer.writeEndElement();\n        }\n    };\n    // // Serializes the numbering properties to the paragraph\n    // private serializeNumPr(writer: XmlWriter, listId: number, listLevel: number): void {\n    //     writer.writeStartElement(undefined, 'numPr', this.wNamespace);\n    //     if (listLevel !== -1) {\n    //         writer.writeStartElement(undefined, 'ilvl', this.wNamespace);\n    //         writer.writeAttributeString('w', 'val', this.wNamespace, listLevel.toString());\n    //         writer.writeEndElement();\n    //     }\n    //     if (listId !== -1) {\n    //         writer.writeStartElement(undefined, 'numId', this.wNamespace);\n    //         writer.writeAttributeString('w', 'val', this.wNamespace, listId.toString());\n    //         writer.writeEndElement();\n    //     }\n    //     writer.writeEndElement();\n    // }\n    WordExport.prototype.serializeParagraphAlignment = function (writer, txtAlignment) {\n        if (!isNullOrUndefined(txtAlignment)) {\n            writer.writeStartElement(undefined, 'jc', this.wNamespace);\n            var alignment = void 0;\n            switch (txtAlignment) {\n                case 'Center':\n                    alignment = 'center';\n                    break;\n                case 'Right':\n                    alignment = 'right';\n                    break;\n                case 'Justify':\n                    alignment = 'both';\n                    break;\n                default:\n                    alignment = 'left';\n                    break;\n            }\n            writer.writeAttributeString('w', 'val', this.wNamespace, alignment);\n            writer.writeEndElement();\n        }\n    };\n    // Serializes the paragraph spacings\n    WordExport.prototype.serializeParagraphSpacing = function (writer, paragraphFormat) {\n        writer.writeStartElement(undefined, 'spacing', this.wNamespace);\n        // if (paragraphFormat.HasValue(WParagraphFormat.BeforeLinesKey))\n        // {\n        //     short beforeLines = (short)Math.Round(paragraphFormat.BeforeLines * DLSConstants.HundredthsUnit);\n        //     writer.WriteAttributeString('beforeLines', this.wNamespace, ToString((float)beforeLines));               \n        // }\n        // if (paragraphFormat.HasValue(WParagraphFormat.AfterLinesKey))\n        // {\n        //     short afterLines = (short)Math.Round(paragraphFormat.AfterLines * DLSConstants.HundredthsUnit);\n        //     writer.WriteAttributeString('afterLines', this.wNamespace, ToString((float)afterLines));                 \n        // }\n        // tslint:disable-next-line:max-line-length\n        if (!isNullOrUndefined(paragraphFormat.beforeSpacing)) {\n            writer.writeAttributeString(undefined, 'before', this.wNamespace, this.roundToTwoDecimal(paragraphFormat.beforeSpacing * this.twentiethOfPoint).toString());\n        }\n        //TODO:ISSUEFIX(paragraphFormat.beforeSpacing * this.twentiethOfPoint).toString());\n        // if (paragraphFormat.HasValue(WParagraphFormat.SpacingBeforeAutoKey))\n        // {\n        //     if (paragraphFormat.SpaceBeforeAuto)\n        //     {\n        //         writer.WriteAttributeString('beforeAutospacing', this.wNamespace, '1');\n        //     }\n        //     else\n        //     {\n        //         writer.WriteAttributeString('beforeAutospacing', this.wNamespace, '0');\n        //     }\n        // }\n        if (!isNullOrUndefined(paragraphFormat.afterSpacing)) {\n            // tslint:disable-next-line:max-line-length\n            writer.writeAttributeString(undefined, 'after', this.wNamespace, this.roundToTwoDecimal(paragraphFormat.afterSpacing * this.twentiethOfPoint).toString());\n        }\n        //TODO:ISSUEFIX(paragraphFormat.afterSpacing * this.twentiethOfPoint).toString());\n        // if (paragraphFormat.HasValue(WParagraphFormat.SpacingAfterAutoKey))\n        // {\n        //     if (paragraphFormat.SpaceAfterAuto)\n        //     {\n        //         writer.WriteAttributeString('afterAutospacing', this.wNamespace, '1');\n        //     }\n        //     else\n        //     {\n        //         writer.WriteAttributeString('afterAutospacing', this.wNamespace, '0');\n        //     }\n        // }\n        writer.writeAttributeString(undefined, 'line', this.wNamespace, '240');\n        //TODO:ISSUEFIX((paragraphFormat.lineSpacing) * this.twentiethOfPoint).toString());\n        switch (paragraphFormat.lineSpacingType) {\n            case 'AtLeast':\n                writer.writeAttributeString(undefined, 'lineRule', this.wNamespace, 'atLeast');\n                break;\n            case 'Exactly':\n                writer.writeAttributeString(undefined, 'lineRule', this.wNamespace, 'exact');\n                break;\n            default:\n                writer.writeAttributeString(undefined, 'lineRule', this.wNamespace, 'auto');\n                break;\n        }\n        writer.writeEndElement();\n    };\n    // Serializes the paragraph indentation\n    WordExport.prototype.serializeIndentation = function (writer, paragraphFormat) {\n        writer.writeStartElement(undefined, 'ind', this.wNamespace);\n        if (!isNullOrUndefined(paragraphFormat.leftIndent)) {\n            // tslint:disable-next-line:max-line-length\n            writer.writeAttributeString(undefined, 'left', this.wNamespace, this.roundToTwoDecimal(paragraphFormat.leftIndent * this.twipsInOnePoint).toString());\n        }\n        if (!isNullOrUndefined(paragraphFormat.rightIndent)) {\n            // tslint:disable-next-line:max-line-length\n            writer.writeAttributeString(undefined, 'right', this.wNamespace, this.roundToTwoDecimal(paragraphFormat.rightIndent * this.twipsInOnePoint).toString());\n        }\n        if (!isNullOrUndefined(paragraphFormat.firstLineIndent)) {\n            if (paragraphFormat.firstLineIndent < 0) {\n                // tslint:disable-next-line:max-line-length\n                writer.writeAttributeString(undefined, 'hanging', this.wNamespace, this.roundToTwoDecimal(-1 * paragraphFormat.firstLineIndent * this.twipsInOnePoint).toString());\n            }\n            else {\n                // tslint:disable-next-line:max-line-length\n                writer.writeAttributeString(undefined, 'firstLine', this.wNamespace, this.roundToTwoDecimal(paragraphFormat.firstLineIndent * this.twipsInOnePoint).toString());\n            }\n        }\n        writer.writeEndElement();\n    };\n    // Serialize the styles (styles.xml)\n    WordExport.prototype.serializeStyles = function () {\n        var writer = new XmlWriter();\n        writer.writeStartElement('w', 'styles', this.wNamespace);\n        writer.writeAttributeString('xmlns', 'mc', undefined, this.veNamespace);\n        writer.writeAttributeString('xmlns', 'r', undefined, this.rNamespace);\n        writer.writeAttributeString('xmlns', 'w', undefined, this.wNamespace);\n        writer.writeAttributeString('xmlns', 'w14', undefined, this.w14Namespace);\n        writer.writeAttributeString('xmlns', 'w15', undefined, this.w15Namespace);\n        writer.writeAttributeString('mc', 'Ignorable', undefined, 'w14 w15');\n        //writes the document defaults, latent styles and default styles.\n        this.serializeDefaultStyles(writer);\n        //writes the document styles\n        this.serializeDocumentStyles(writer);\n        writer.writeEndElement(); //end of styles tag\n        var zipArchiveItem = new ZipArchiveItem(writer.buffer, this.stylePath);\n        this.mArchive.addItem(zipArchiveItem); //this.stylePath, styleStream, false, FileAttributes.Archive);\n    };\n    // Serializes the default styles (document default paragraph and character format)\n    WordExport.prototype.serializeDefaultStyles = function (writer) {\n        writer.writeStartElement(undefined, 'docDefaults', this.wNamespace);\n        //if (HasDefaultCharFormat())\n        //{\n        writer.writeStartElement(undefined, 'rPrDefault', this.wNamespace);\n        // if (!isNullOrUndefined(this.mDocument.characterFormat)) {\n        this.serializeCharacterFormat(writer, this.defCharacterFormat);\n        writer.writeEndElement(); // end of rPrDefault\n        // }\n        // else {\n        //     writer.writeStartElement(undefined, 'rPr', this.wNamespace);\n        //     writer.writeStartElement(undefined, 'rFonts', this.wNamespace);\n        //     if (!string.IsNullOrEmpty(m_document.StandardAsciiFont))\n        //         writer.WriteAttributeString('ascii', this.wNamespace, m_document.StandardAsciiFont);\n        //     if (!string.IsNullOrEmpty(m_document.StandardFarEastFont))\n        //         writer.WriteAttributeString('eastAsia', this.wNamespace, m_document.StandardFarEastFont);\n        //     if (!string.IsNullOrEmpty(m_document.StandardNonFarEastFont))\n        //         writer.WriteAttributeString('hAnsi', this.wNamespace, m_document.StandardNonFarEastFont);\n        //     if (!string.IsNullOrEmpty(m_document.StandardBidiFont))\n        //         writer.WriteAttributeString('cs', this.wNamespace, m_document.StandardBidiFont);\n        //     writer.WriteEndElement();\n        //     float fontSize = GetDefFontSize(m_document, WCharacterFormat.FontSizeKey);\n        //     if (fontSize !== 0f)\n        //     {\n        //         writer.WriteStartElement('sz', this.wNamespace);\n        //         writer.WriteAttributeString('val', this.wNamespace, (fontSize * 2).ToString(CultureInfo.InvariantCulture));\n        //         writer.WriteEndElement();\n        //     }\n        //     fontSize = GetDefFontSize(m_document, WCharacterFormat.FontSizeBidiKey);\n        //     if (fontSize !== 0f)\n        //     {\n        //         writer.WriteStartElement('szCs', this.wNamespace);\n        //         writer.WriteAttributeString('val', this.wNamespace, (fontSize * 2).ToString(CultureInfo.InvariantCulture));\n        //         writer.WriteEndElement();\n        //     }\n        //     writer.WriteEndElement();\n        // }\n        // writer.WriteEndElement();\n        // //}\n        writer.writeStartElement(undefined, 'pPrDefault', this.wNamespace);\n        if (!isNullOrUndefined(this.defParagraphFormat)) {\n            writer.writeStartElement(undefined, 'pPr', this.wNamespace);\n            this.serializeParagraphFormat(writer, this.defParagraphFormat, undefined);\n            writer.writeEndElement(); //end of pPr\n        }\n        writer.writeEndElement(); //end of pPrDefault\n        // writer.WriteEndElement();\n        // SerializeLatentStyles();\n        // //Default styles\n        // if (m_document.Styles.length === 0 || isNullOrUndefined(m_document.Styles.FindByName('Normal')))\n        // {\n        //     SerializeDefaultParagraphStyle();\n        // }\n        // if (!IsDocumentContainsDefaultTableStyle())\n        // {\n        //     SerializeTableNormalStyle();\n        // }\n        // if (isNullOrUndefined(m_document.Styles.FindByName('No List')) && isNullOrUndefined(m_document.Styles.FindByName('NoList')))\n        //     SerializeNoListStyle();\n        // tslint:disable-next-line:max-line-length\n        // if (isNullOrUndefined(m_document.Styles.FindByName('Table Grid')) && isNullOrUndefined(m_document.Styles.FindByName('TableGrid')))\n        // {\n        //     SerializeTableGridStyle();\n        // }\n        // }        \n        writer.writeEndElement();\n    };\n    WordExport.prototype.serializeDocumentStyles = function (writer) {\n        for (var i = 0; i < this.mStyles.length; i++) {\n            var style = this.mStyles[i];\n            writer.writeStartElement(undefined, 'style', this.wNamespace);\n            var type = style.type === 'Paragraph' ? 'paragraph' : 'character';\n            writer.writeAttributeString('w', 'type', this.wNamespace, type);\n            writer.writeAttributeString('w', 'styleId', this.wNamespace, style.name);\n            //name\n            writer.writeStartElement(undefined, 'name', this.wNamespace);\n            writer.writeAttributeString('w', 'val', this.wNamespace, style.name);\n            writer.writeEndElement();\n            //basedOn\n            if (!isNullOrUndefined(style.basedOn)) {\n                writer.writeStartElement(undefined, 'basedOn', this.wNamespace);\n                writer.writeAttributeString('w', 'val', this.wNamespace, style.basedOn);\n                writer.writeEndElement();\n            }\n            //next\n            if (!isNullOrUndefined(style.next)) {\n                writer.writeStartElement(undefined, 'next', this.wNamespace);\n                writer.writeAttributeString('w', 'val', this.wNamespace, style.next);\n                writer.writeEndElement();\n            }\n            //link\n            if (!isNullOrUndefined(style.link)) {\n                writer.writeStartElement(undefined, 'link', this.wNamespace);\n                writer.writeAttributeString('w', 'val', this.wNamespace, style.link);\n                writer.writeEndElement();\n            }\n            if (style.type === 'Paragraph') {\n                writer.writeStartElement(undefined, 'pPr', this.wNamespace);\n                this.serializeParagraphFormat(writer, style.paragraphFormat, undefined);\n                writer.writeEndElement();\n            }\n            // let value = (style.characterFormat as WCharacterFormat).newgetCharacterFormat();\n            this.serializeCharacterFormat(writer, style.characterFormat);\n            writer.writeEndElement(); //end of Style\n        }\n    };\n    // Serializes the Character format\n    WordExport.prototype.serializeCharacterFormat = function (writer, characterFormat) {\n        writer.writeStartElement(undefined, 'rPr', this.wNamespace);\n        if (!isNullOrUndefined(characterFormat.styleName)) {\n            writer.writeStartElement(undefined, 'rStyle', this.wNamespace);\n            writer.writeAttributeString('w', 'val', this.wNamespace, characterFormat.styleName);\n            writer.writeEndElement();\n        }\n        if (!isNullOrUndefined(characterFormat.fontFamily)) {\n            writer.writeStartElement(undefined, 'rFonts', this.wNamespace);\n            writer.writeAttributeString(undefined, 'ascii', this.wNamespace, characterFormat.fontFamily);\n            writer.writeAttributeString(undefined, 'hAnsi', this.wNamespace, characterFormat.fontFamily);\n            writer.writeAttributeString(undefined, 'eastAsia', this.wNamespace, characterFormat.fontFamily);\n            writer.writeAttributeString(undefined, 'cs', this.wNamespace, characterFormat.fontFamily);\n            writer.writeEndElement(); //end         \n        }\n        if (!isNullOrUndefined(characterFormat.bold)) {\n            this.serializeBoolProperty(writer, 'b', characterFormat.bold);\n        }\n        if (!isNullOrUndefined(characterFormat.italic)) {\n            this.serializeBoolProperty(writer, 'i', characterFormat.italic);\n        }\n        if (!isNullOrUndefined(characterFormat.strikethrough)) {\n            switch (characterFormat.strikethrough) {\n                case 'SingleStrike':\n                    this.serializeBoolProperty(writer, 'strike', true);\n                    break;\n                case 'DoubleStrike':\n                    this.serializeBoolProperty(writer, 'dstrike', true);\n                    break;\n                default:\n                    this.serializeBoolProperty(writer, 'strike', false);\n                    this.serializeBoolProperty(writer, 'dstrike', false);\n                    break;\n            }\n        }\n        if (!isNullOrUndefined(characterFormat.fontColor)) {\n            writer.writeStartElement(undefined, 'color', this.wNamespace);\n            writer.writeAttributeString('w', 'val', this.wNamespace, this.getColor(characterFormat.fontColor));\n            writer.writeEndElement();\n        }\n        if (!isNullOrUndefined(characterFormat.fontSize)) {\n            writer.writeStartElement(undefined, 'sz', this.wNamespace);\n            // tslint:disable-next-line:max-line-length\n            writer.writeAttributeString('w', 'val', this.wNamespace, this.roundToTwoDecimal(characterFormat.fontSize * 2).toString());\n            writer.writeEndElement();\n        }\n        if (!isNullOrUndefined(characterFormat.highlightColor) && characterFormat.highlightColor !== 'NoColor') {\n            writer.writeStartElement(undefined, 'highlight', this.wNamespace);\n            writer.writeAttributeString('w', 'val', this.wNamespace, this.getHighlightColor(characterFormat.highlightColor));\n            writer.writeEndElement();\n        }\n        if (!isNullOrUndefined(characterFormat.underline) && characterFormat.underline !== 'None') {\n            writer.writeStartElement(undefined, 'u', this.wNamespace);\n            writer.writeAttributeString('w', 'val', this.wNamespace, this.getUnderlineStyle(characterFormat.underline));\n            writer.writeEndElement();\n        }\n        if (!isNullOrUndefined(characterFormat.baselineAlignment)) {\n            writer.writeStartElement(undefined, 'vertAlign', this.wNamespace);\n            switch (characterFormat.baselineAlignment) {\n                case 'Subscript':\n                    writer.writeAttributeString('w', 'val', this.wNamespace, 'subscript');\n                    break;\n                case 'Superscript':\n                    writer.writeAttributeString('w', 'val', this.wNamespace, 'superscript');\n                    break;\n                default:\n                    writer.writeAttributeString('w', 'val', this.wNamespace, 'baseline');\n                    break;\n            }\n            writer.writeEndElement();\n        }\n        writer.writeEndElement(); //end of rPrChange\n    };\n    WordExport.prototype.getColor = function (color) {\n        if (color.length > 0) {\n            if (color[0] === '#') {\n                color = color.substr(1);\n            }\n            if (color.length > 6) {\n                color = color.substr(0, 6);\n            }\n        }\n        return color;\n    };\n    // Get the underline style as string\n    WordExport.prototype.getUnderlineStyle = function (underlineStyle) {\n        switch (underlineStyle) {\n            case 'DotDotDashHeavy':\n                return 'dashDotDotHeavy';\n            case 'DotDashHeavy':\n                return 'dashDotHeavy';\n            case 'DashHeavy':\n                return 'dashedHeavy';\n            case 'DashLong':\n                return 'dashLong';\n            case 'DashLongHeavy':\n                return 'dashLongHeavy';\n            case 'DotDash':\n                return 'dotDash';\n            case 'DotDotDash':\n                return 'dotDotDash';\n            case 'Dotted':\n                return 'dotted';\n            case 'DottedHeavy':\n                return 'dottedHeavy';\n            case 'Double':\n                return 'double';\n            case 'Single':\n                return 'single';\n            case 'Thick':\n                return 'thick';\n            case 'Wavy':\n                return 'wave';\n            case 'WavyDouble':\n                return 'wavyDouble';\n            case 'WavyHeavy':\n                return 'wavyHeavy';\n            case 'Words':\n                return 'words';\n            default:\n                return 'dash';\n        }\n    };\n    WordExport.prototype.getHighlightColor = function (highlight) {\n        switch (highlight) {\n            // Highlights the content with bright green (#ff00ff00) color.\n            case 'BrightGreen':\n                return 'green';\n            // Highlights the content with turquoise (#ff00ffff) color.\n            case 'Turquoise':\n                return 'cyan';\n            // Highlights the content with pink (#ffff00ff) color.\n            case 'Pink':\n                return 'magenta';\n            // Highlights the content with blue (#ff0000ff) color.\n            case 'Blue':\n                return 'blue';\n            // Highlights the content with red (#ffff0000) color.\n            case 'Red':\n                return 'red';\n            // Highlights the content with dark blue (#ff000080) color.\n            case 'DarkBlue':\n                return 'darkBlue';\n            // Highlights the content with teal (#ff008080) color.\n            case 'Teal':\n                return 'darkCyan';\n            // Highlights the content with green (#ff008000) color.\n            case 'Green':\n                return 'darkGreen';\n            // Highlights the content with violet (#ff800080) color.\n            case 'Violet':\n                return 'darkMagenta';\n            // Highlights the content with dark red (#ff800000) color.\n            case 'DarkRed':\n                return 'darkRed';\n            // Highlights the content with dark yellow (#ff808000)  color.\n            case 'DarkYellow':\n                return 'darkYellow';\n            // Highlights the content with gray 50 (#ff808080) color.\n            case 'Gray50':\n                return 'darkGray';\n            // Highlights the content with gray 25 (#ffc0c0c0) color.\n            case 'Gray25':\n                return 'lightGray';\n            // Highlights the content with black (#ff000000) color.\n            case 'Black':\n                return 'black';\n            // Highlights the content with yellow (#ffffff00) color.\n            default:\n                return 'yellow';\n        }\n    };\n    /*private toggleFirstCahar(text: string) {\n        return text.charAt(0).toLowerCase() + text.slice(1);\n    }*/\n    // Serializes the bool character format property\n    WordExport.prototype.serializeBoolProperty = function (writer, tag, value) {\n        writer.writeStartElement(undefined, tag, this.wNamespace);\n        if (!value) {\n            writer.writeAttributeString(undefined, 'val', this.wNamespace, '0');\n        }\n        writer.writeEndElement();\n    };\n    // Serialize the list styles and numberings (numberings.xml)\n    WordExport.prototype.serializeNumberings = function () {\n        if (this.document.lists.length === 0) {\n            return;\n        }\n        var writer = new XmlWriter();\n        writer.writeStartElement('w', 'numbering', this.wNamespace);\n        this.writeCommonAttributeStrings(writer);\n        // this.serializePictureBullets(writer, this.mDocument.lists);\n        this.serializeAbstractListStyles(writer, this.document.abstractLists);\n        this.serializeListInstances(writer, this.document.lists);\n        // SerializeListOverrides(writer, this.mDocument.ridesm_document.ListOverrides);\n        writer.writeEndElement();\n        var zipArchiveItem = new ZipArchiveItem(writer.buffer, this.numberingPath);\n        this.mArchive.addItem(zipArchiveItem);\n    };\n    // Serializes the abstract list styles\n    WordExport.prototype.serializeAbstractListStyles = function (writer, listStyles) {\n        for (var i = 0; i < listStyles.length; i++) {\n            var abstractList = listStyles[i];\n            writer.writeStartElement(undefined, 'abstractNum', this.wNamespace);\n            writer.writeAttributeString(undefined, 'abstractNumId', this.wNamespace, abstractList.abstractListId.toString());\n            writer.writeStartElement(undefined, 'nsid', this.wNamespace);\n            writer.writeAttributeString(undefined, 'val', this.wNamespace, this.generateHex());\n            writer.writeEndElement();\n            for (var ilvl = 0, cnt = abstractList.levels.length; ilvl < cnt; ilvl++) {\n                this.serializeListLevel(writer, abstractList.levels[ilvl], ilvl);\n            }\n            writer.writeEndElement(); //end of abstractNum\n        }\n    };\n    // Serializes the list styles\n    WordExport.prototype.serializeListInstances = function (writer, listStyles) {\n        for (var i = 0; i < listStyles.length; i++) {\n            var list = listStyles[i];\n            writer.writeStartElement(undefined, 'num', this.wNamespace);\n            writer.writeAttributeString(undefined, 'numId', this.wNamespace, (list.listId + 1).toString());\n            writer.writeStartElement(undefined, 'abstractNumId', this.wNamespace);\n            writer.writeAttributeString(undefined, 'val', this.wNamespace, list.abstractListId.toString());\n            writer.writeEndElement();\n            writer.writeEndElement();\n        }\n    };\n    WordExport.prototype.generateHex = function () {\n        return (Math.floor(Math.random() * (4000000000 - 270000000)) + 270000000).toString(16).toUpperCase();\n    };\n    WordExport.prototype.roundToTwoDecimal = function (num) {\n        return Math.round(num); // * 100) / 100;\n    };\n    // Serialize the list level\n    WordExport.prototype.serializeListLevel = function (writer, listLevel, levelIndex) {\n        writer.writeStartElement(undefined, 'lvl', this.wNamespace);\n        writer.writeAttributeString(undefined, 'ilvl', this.wNamespace, levelIndex.toString());\n        writer.writeStartElement(undefined, 'start', this.wNamespace);\n        writer.writeAttributeString(undefined, 'val', this.wNamespace, listLevel.startAt.toString());\n        writer.writeEndElement();\n        writer.writeStartElement(undefined, 'numFmt', this.wNamespace);\n        writer.writeAttributeString(undefined, 'val', this.wNamespace, this.getLevelPattern(listLevel.listLevelPattern));\n        writer.writeEndElement();\n        if (listLevel.restartLevel > 0) {\n            writer.writeStartElement(undefined, 'lvlRestart', this.wNamespace);\n            writer.writeAttributeString(undefined, 'val', this.wNamespace, '0');\n            writer.writeEndElement();\n        }\n        // if (!isNullOrUndefined(listLevel.paragraphFormat)) {\n        //     string name = listLevel.ParaStyleName.Substring(0, 1).ToUpper() + listLevel.ParaStyleName.Remove(0, 1);\n        //     writer.WriteStartElement('pStyle', this.wNamespace);\n        //     writer.WriteAttributeString('val', this.wNamespace, name);\n        //     writer.WriteEndElement();\n        // }\n        // if (listLevel.IsLegalStyleNumbering) {\n        //     writer.WriteStartElement('isLgl', this.wNamespace);\n        //     writer.WriteEndElement();\n        // }\n        this.serializeLevelFollow(writer, listLevel);\n        this.serializeLevelText(writer, listLevel, levelIndex + 1);\n        // SerializeLegacyProperties(listLevel);\n        // if (listLevel.PicBulletId > 0) {\n        //     writer.WriteStartElement('lvlPicBulletId', this.wNamespace);\n        //     writer.WriteAttributeString('val', this.wNamespace, listLevel.PicBulletId.ToString());\n        //     writer.WriteEndElement();\n        // }\n        // //lvlJc\n        // if (listLevel.NumberAlignment !== ListNumberAlignment.Left) {\n        //     writer.WriteStartElement('lvlJc', this.wNamespace);\n        //     string alignment = string.Empty;\n        //     if (listLevel.NumberAlignment === ListNumberAlignment.Right) {\n        //         alignment = 'right';\n        //     }\n        //     else {\n        //         alignment = 'center';\n        //     }\n        //     writer.WriteAttributeString('val', this.wNamespace, alignment);\n        //     writer.WriteEndElement();\n        // }\n        writer.writeStartElement(undefined, 'pPr', this.wNamespace);\n        this.serializeParagraphFormat(writer, listLevel.paragraphFormat, undefined);\n        writer.writeEndElement(); //end of pPr\n        this.serializeCharacterFormat(writer, listLevel.characterFormat);\n        writer.writeEndElement();\n    };\n    WordExport.prototype.getLevelPattern = function (levelPattern) {\n        var patternType;\n        switch (levelPattern) {\n            case 'Arabic':\n                patternType = 'decimal';\n                break;\n            case 'UpRoman':\n                patternType = 'upperRoman';\n                break;\n            case 'LowRoman':\n                patternType = 'lowerRoman';\n                break;\n            case 'UpLetter':\n                patternType = 'upperLetter';\n                break;\n            case 'LowLetter':\n                patternType = 'lowerLetter';\n                break;\n            // case 'Ordinal':\n            //     patternType = 'ordinal';\n            //     break;\n            // case 'Number':\n            //     patternType = 'cardinalText';\n            //     break;\n            // case 'OrdinalText':\n            //     patternType = 'ordinalText';\n            //     break;\n            // case 'LeadingZero':\n            //     patternType = 'decimalZero';\n            //     break;\n            // case 'Bullet':\n            default:\n                patternType = 'bullet';\n                break;\n        }\n        return patternType;\n    };\n    // Serializes the level text\n    WordExport.prototype.serializeLevelText = function (writer, listLevel, lvlIndex) {\n        writer.writeStartElement(undefined, 'lvlText', this.wNamespace);\n        writer.writeAttributeString(undefined, 'val', this.wNamespace, (listLevel.numberFormat));\n        writer.writeEndElement();\n    };\n    // Serialize the level follow character\n    WordExport.prototype.serializeLevelFollow = function (writer, listLevel) {\n        var fc;\n        //TODO:Type issue returns number instead of string\n        if (listLevel.followCharacter === 'Tab') {\n            fc = 'tab';\n        }\n        else if (listLevel.followCharacter === 'Space') {\n            fc = 'space';\n        }\n        else {\n            fc = 'nothing';\n        }\n        writer.writeStartElement(undefined, 'suff', this.wNamespace);\n        writer.writeAttributeString(undefined, 'val', this.wNamespace, fc);\n        writer.writeEndElement();\n    };\n    WordExport.prototype.serializeSettings = function () {\n        var writer = new XmlWriter();\n        writer.writeStartElement('w', 'settings', this.wNamespace);\n        this.writeCustom(writer);\n        // writer.writeAttributeString('xmlns', 'mc', undefined, this.veNamespace);\n        // writer.writeAttributeString('xmlns', 'o', undefined, this.oNamespace);\n        // writer.writeAttributeString('xmlns', 'r', undefined, this.rNamespace);\n        // writer.writeAttributeString('xmlns', 'm', undefined, this.mNamespace);\n        // writer.writeAttributeString('xmlns', 'v', undefined, this.vNamespace);\n        writer.writeAttributeString('xmlns', 'w10', undefined, this.w10Namespace);\n        writer.writeAttributeString('xmlns', 'w14', undefined, this.w14Namespace);\n        writer.writeAttributeString('xmlns', 'w15', undefined, this.w15Namespace);\n        writer.writeAttributeString('xmlns', 'sl', undefined, this.slNamespace);\n        writer.writeAttributeString('mc', 'Ignorable', undefined, 'w14 w15');\n        // //w:writeProtection - Write Protection\n        // if (m_document.WriteProtected)\n        // {\n        //     writer.writeStartElement('w', 'writeProtection', this.wNamespace);\n        //     writer.writeAttributeString('recommended', this.wNamespace, '1');\n        //     writer.writeEndElement();\n        // }\n        //w:view - Document View Setting\n        // if (this.mDocument.ViewSetup.DocumentViewType !== DocumentViewType.PrintLayout &&\n        //   m_document.ViewSetup.DocumentViewType !== DocumentViewType.NormalLayout)\n        // {\n        //     writer.writeStartElement('view', this.wNamespace);\n        //     string viewTypeStr = string.Empty;\n        //     if (m_document.ViewSetup.DocumentViewType === DocumentViewType.OutlineLayout)\n        //     {\n        //         viewTypeStr = 'outline';\n        //     }\n        //     else if (m_document.ViewSetup.DocumentViewType === DocumentViewType.WebLayout)\n        //     {\n        //         viewTypeStr = 'web';\n        //     }\n        //     writer.writeAttributeString('val', this.wNamespace, viewTypeStr);\n        //     writer.writeEndElement();\n        // }\n        //w:zoom - Magnification Setting\n        writer.writeStartElement('w', 'zoom', this.wNamespace);\n        // switch (m_document.ViewSetup.ZoomType)\n        // {\n        //     case ZoomType.FullPage:\n        //         writer.writeAttributeString('w', 'val', this.wNamespace, 'fullPage');\n        //         break;\n        //     case ZoomType.PageWidth:\n        //         writer.writeAttributeString('w', 'val', this.wNamespace, 'bestFit');\n        //         break;\n        //     case ZoomType.TextFit:\n        //         writer.writeAttributeString('w', 'val', this.wNamespace, 'textFit');\n        //         break;\n        // default:\n        writer.writeAttributeString('w', 'val', this.wNamespace, 'none');\n        // break;\n        // }\n        writer.writeAttributeString('w', 'percent', this.wNamespace, '100');\n        writer.writeEndElement();\n        //w:displayBackgroundShape - Display Background Objects When Displaying Document\n        // if (m_document.Background.Type !== BackgroundType.NoBackground)\n        // {\n        writer.writeStartElement(undefined, 'displayBackgroundShape', this.wNamespace);\n        writer.writeEndElement();\n        // }\n        //w:defaultTabStop - Distance Between Automatic Tab Stops\n        writer.writeStartElement(undefined, 'defaultTabStop', this.wNamespace);\n        var tabWidth = Math.round(this.defaultTabWidthValue * this.twipsInOnePoint);\n        writer.writeAttributeString(undefined, 'val', this.wNamespace, tabWidth.toString());\n        writer.writeEndElement();\n        //w:evenAndOddHeaders - Different Even/Odd Page Headers and Footers        \n        if (this.mDifferentFirstPage) {\n            writer.writeStartElement(undefined, 'evenAndOddHeaders', this.wNamespace);\n            writer.writeEndElement();\n        }\n        //w:footnotePr - Document-Wide Footnote Properties and w:endnotePr - Document-Wide Endnote Properties\n        // SerializeFootnoteSettings();\n        //w:compat - Compatibility Settings\n        writer.writeStartElement(undefined, 'compat', this.wNamespace);\n        writer.writeStartElement(undefined, 'compatSetting', this.wNamespace);\n        writer.writeAttributeString(undefined, 'name', this.wNamespace, 'compatibilityMode');\n        writer.writeAttributeString(undefined, 'uri', this.wNamespace, 'http://schemas.microsoft.com/office/word');\n        writer.writeAttributeString(undefined, 'val', this.wNamespace, '15');\n        writer.writeEndElement();\n        writer.writeEndElement();\n        writer.writeEndElement();\n        var zipArchiveItem = new ZipArchiveItem(writer.buffer, this.settingsPath);\n        this.mArchive.addItem(zipArchiveItem);\n    };\n    WordExport.prototype.serializeCoreProperties = function () {\n        //implementation\n    };\n    WordExport.prototype.serializeAppProperties = function () {\n        //implementation\n    };\n    WordExport.prototype.serializeFontTable = function (contentType) {\n        //implementation\n    };\n    WordExport.prototype.serializeSettingsRelation = function () {\n        //implementation\n    };\n    WordExport.prototype.serializeHeaderFooters = function () {\n        this.serializeHeaderFooter('EvenFooter');\n        this.serializeHeaderFooter('EvenHeader');\n        this.serializeHeaderFooter('FirstPageFooter');\n        this.serializeHeaderFooter('FirstPageHeader');\n        this.serializeHeaderFooter('OddFooter');\n        this.serializeHeaderFooter('OddHeader');\n    };\n    // Serializes the Header/Footer\n    WordExport.prototype.serializeHeaderFooter = function (hfType) {\n        if (this.headersFooters.length === 0) {\n            return;\n        }\n        var headerFooterPath;\n        var headerFooterRelsPath;\n        if (!this.headersFooters.containsKey(hfType)) {\n            return;\n        }\n        var hfColl = this.headersFooters.get(hfType);\n        var hf = undefined;\n        for (var i = 0; i < hfColl.keys.length; i++) {\n            var id = hfColl.keys[i];\n            hf = hfColl.get(id);\n            if (hfType === 'EvenHeader' || hfType === 'FirstPageHeader' ||\n                hfType === 'OddHeader') {\n                headerFooterPath = this.headerPath + id.replace('rId', '') + '.xml';\n                headerFooterRelsPath = this.headerRelationPath + id.replace('rId', '') + '.xml.rels';\n                this.serializeHeader(hf, id, headerFooterPath, headerFooterRelsPath);\n            }\n            else {\n                headerFooterPath = this.footerPath + id.replace('rId', '') + '.xml';\n                headerFooterRelsPath = this.footerRelationPath + id.replace('rId', '') + '.xml.rels';\n                this.serializeFooter(hf, id, headerFooterPath, headerFooterRelsPath);\n            }\n        }\n    };\n    // Serialize the header part\n    WordExport.prototype.serializeHeader = function (header, id, headerFooterPath, headerFooterRelsPath) {\n        this.headerFooter = header;\n        var writer = new XmlWriter();\n        writer.writeStartElement('w', 'hdr', this.wNamespace);\n        this.writeHFCommonAttributes(writer);\n        var owner = this.blockOwner;\n        this.blockOwner = header;\n        this.serializeBodyItems(writer, header.blocks, true);\n        this.blockOwner = owner;\n        writer.writeEndElement();\n        var zipArchiveItem = new ZipArchiveItem(writer.buffer, headerFooterPath);\n        this.mArchive.addItem(zipArchiveItem);\n        this.serializeHFRelations(id, headerFooterRelsPath);\n        this.headerFooter = undefined;\n    };\n    // Serializes the HeaderFooter relations\n    WordExport.prototype.serializeHFRelations = function (hfId, headerFooterRelsPath) {\n        var hasHFImage = this.headerFooterImages.containsKey(hfId);\n        // let hasHFHyperlinks = HeaderFooterHyperlinks.ContainsKey(hfId);\n        // let hasHFInclPics = HeaderFooterInclPicUrls.ContainsKey(hfId);\n        // let hasHFAlternateChunks = HeaderFooterAlternateChunks.ContainsKey(hfId);\n        if (hasHFImage) {\n            var writer = new XmlWriter();\n            writer.writeStartElement(undefined, 'Relationships', this.rpNamespace);\n            this.serializeImagesRelations(this.headerFooterImages.get(hfId), writer);\n            // if (hasHFHyperlinks)\n            //     SerializeHyperlinkRelations(stream, HeaderFooterHyperlinks[hfId]);\n            // if (hasHFAlternateChunks)\n            //     SerializeAltChunkRelations(stream, HeaderFooterAlternateChunks[hfId]);\n            // if (hasHFInclPics)\n            //     SerializeIncludePictureUrlRelations(stream, HeaderFooterInclPicUrls[hfId]);\n            // if (HFOleContainers.ContainsKey(hfId))\n            // {\n            //     AddOLEToZip(HFOleContainers[hfId]);\n            // }\n            // if (HFRelations.ContainsKey(hfId))\n            //     SerializeHFCommonRelations(stream, HFRelations[hfId]);\n            writer.writeEndElement();\n            var zipArchiveItem = new ZipArchiveItem(writer.buffer, headerFooterRelsPath);\n            this.mArchive.addItem(zipArchiveItem);\n        }\n        else {\n            return;\n        }\n    };\n    WordExport.prototype.writeHFCommonAttributes = function (writer) {\n        writer.writeAttributeString('xmlns', 'v', undefined, this.vNamespace);\n        writer.writeAttributeString('xmlns', 'w10', undefined, this.w10Namespace);\n        writer.writeAttributeString('xmlns', 'o', undefined, this.oNamespace);\n        writer.writeAttributeString('xmlns', 've', undefined, this.veNamespace);\n        writer.writeAttributeString('xmlns', 'r', undefined, this.rNamespace);\n        writer.writeAttributeString('xmlns', 'm', undefined, this.mNamespace);\n        writer.writeAttributeString('xmlns', 'wne', undefined, this.wneNamespace);\n        writer.writeAttributeString('xmlns', 'a', undefined, this.aNamespace);\n        writer.writeAttributeString('xmlns', 'pic', undefined, this.pictureNamespace);\n        writer.writeAttributeString('xmlns', 'wp', undefined, this.wpNamespace);\n        writer.writeAttributeString('xmlns', 'wpc', undefined, this.wpCanvasNamespace);\n        writer.writeAttributeString('xmlns', 'wp14', undefined, this.wpDrawingNamespace);\n        this.writeDup(writer);\n        writer.writeAttributeString('xmlns', 'wps', undefined, this.wpShapeNamespace);\n        writer.writeAttributeString('ve', 'Ignorable', undefined, 'w14 w15 wp14');\n    };\n    // Serailize the footer and its relations\n    WordExport.prototype.serializeFooter = function (footer, id, headerFooterPath, headerFooterRelsPath) {\n        this.headerFooter = footer;\n        var writer = new XmlWriter();\n        writer.writeStartElement('w', 'ftr', this.wNamespace);\n        this.writeHFCommonAttributes(writer);\n        this.serializeBodyItems(writer, footer.blocks, true);\n        writer.writeEndElement();\n        var zipArchiveItem = new ZipArchiveItem(writer.buffer, headerFooterPath);\n        this.mArchive.addItem(zipArchiveItem);\n        this.serializeHFRelations(id, headerFooterRelsPath);\n    };\n    WordExport.prototype.serializeDocumentRelations = function () {\n        var writer = new XmlWriter();\n        writer.writeStartElement(undefined, 'Relationships', this.rpNamespace);\n        this.serializeRelationShip(writer, this.getNextRelationShipID(), this.stylesRelType, 'styles.xml');\n        this.serializeRelationShip(writer, this.getNextRelationShipID(), this.settingsRelType, 'settings.xml');\n        // this.serializeRelationShip(writer, this.getNextRelationShipID(), this.ThemeRelType, 'theme/theme1.xml');\n        if (this.document.lists.length > 0) {\n            this.serializeRelationShip(writer, this.getNextRelationShipID(), this.numberingRelType, 'numbering.xml');\n        }\n        this.serializeHeaderFooterRelations(writer);\n        // if (HasFontTable) {\n        //     SerializeRelationShip(docRelstream, GetNextRelationShipID(), this.FontTableRelType, 'fontTable.xml');\n        // }\n        // SerializeIncludePictureUrlRelations(docRelstream, InclPicFieldUrl);\n        // //// Creating relationships for every hyperlink and image containing in the document\n        this.serializeImagesRelations(this.documentImages, writer);\n        // SerializeSvgImageRelation();\n        //this.serializeExternalLinkImages(writer);\n        // if (HasHyperlink && HyperlinkTargets.length > 0) {\n        //     SerializeHyperlinkRelations(docRelstream, HyperlinkTargets);\n        // }\n        // if (m_document.HasMacros\n        //     && IsMacroEnabled)\n        //     SerializeRelationShip(docRelstream, GetNextRelationShipID(), this.VbaProjectRelType, this.VbaProject);\n        writer.writeEndElement();\n        var zipArchiveItem = new ZipArchiveItem(writer.buffer, this.wordRelationPath);\n        this.mArchive.addItem(zipArchiveItem);\n        this.headerFooter = undefined;\n    };\n    // Serializes the image relations\n    WordExport.prototype.serializeImagesRelations = function (images, writer) {\n        if (images.length > 0) {\n            var imagePath = '';\n            var base64ImageString = void 0;\n            var keys = images.keys;\n            for (var i = 0; i < keys.length; i++) {\n                var mImage = images.get(keys[i]);\n                base64ImageString = mImage.imageString;\n                if (isNullOrUndefined(base64ImageString)) {\n                    imagePath = this.imagePath + '/0.jpeg';\n                    this.serializeRelationShip(writer, keys[i], this.imageRelType, imagePath.replace('word/', ''));\n                }\n                else {\n                    var extension = '';\n                    var formatClippedString = '';\n                    if (this.startsWith(base64ImageString, 'data:image/bmp;base64,')) {\n                        extension = '.bmp';\n                        formatClippedString = base64ImageString.replace('data:image/bmp;base64,', '');\n                    }\n                    else if (this.startsWith(base64ImageString, 'data:image/x-emf;base64,')) {\n                        extension = '.emf';\n                        formatClippedString = base64ImageString.replace('data:image/x-emf;base64,', '');\n                    }\n                    else if (this.startsWith(base64ImageString, 'data:image/exif;base64,')) {\n                        extension = '.exif';\n                        formatClippedString = base64ImageString.replace('data:image/exif;base64,', '');\n                    }\n                    else if (this.startsWith(base64ImageString, 'data:image/gif;base64,')) {\n                        extension = '.gif';\n                        formatClippedString = base64ImageString.replace('data:image/gif;base64,', '');\n                    }\n                    else if (this.startsWith(base64ImageString, 'data:image/icon;base64,')) {\n                        extension = '.ico';\n                        formatClippedString = base64ImageString.replace('data:image/icon;base64,', '');\n                    }\n                    else if (this.startsWith(base64ImageString, 'data:image/jpeg;base64,')) {\n                        extension = '.jpeg';\n                        formatClippedString = base64ImageString.replace('data:image/jpeg;base64,', '');\n                    }\n                    else if (this.startsWith(base64ImageString, 'data:image/jpg;base64,')) {\n                        extension = '.jpg';\n                        formatClippedString = base64ImageString.replace('data:image/jpg;base64,', '');\n                    }\n                    else if (this.startsWith(base64ImageString, 'data:image/png;base64,')) {\n                        extension = '.png';\n                        formatClippedString = base64ImageString.replace('data:image/png;base64,', '');\n                    }\n                    else if (this.startsWith(base64ImageString, 'data:image/tiff;base64,')) {\n                        extension = '.tif';\n                        formatClippedString = base64ImageString.replace('data:image/tiff;base64,', '');\n                    }\n                    else if (this.startsWith(base64ImageString, 'data:image/x-wmf;base64,')) {\n                        extension = '.wmf';\n                        formatClippedString = base64ImageString.replace('data:image/x-wmf;base64,', '');\n                    }\n                    else {\n                        extension = '.jpeg';\n                    }\n                    imagePath = this.imagePath + keys[i] + extension;\n                    this.serializeRelationShip(writer, keys[i], this.imageRelType, imagePath.replace('word/', ''));\n                    //if (m_archive.Find(imagePath.Replace('\\\\', '/')) === -1)\n                    // {\n                    var imageBlob = new Blob([this.encodedString(formatClippedString)]);\n                    var zipArchiveItem = new ZipArchiveItem(imageBlob, imagePath);\n                    // let TestArchive = new ZipArchive();\n                    this.mArchive.addItem(zipArchiveItem);\n                    // TestArchive.save('image.zip').then(function (): void {\n                    //     TestArchive.destroy();\n                    // });\n                    // }\n                }\n            }\n        }\n    };\n    /**\n     * @private\n     */\n    WordExport.prototype.encodedString = function (input) {\n        var keyStr = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=';\n        var chr1;\n        var chr2;\n        var chr3;\n        var enc1;\n        var enc2;\n        var enc3;\n        var enc4;\n        var i = 0;\n        var resultIndex = 0;\n        /*let dataUrlPrefix: string = 'data:';*/\n        input = input.replace(/[^A-Za-z0-9\\+\\/\\=]/g, '');\n        var totalLength = input.length * 3 / 4;\n        if (input.charAt(input.length - 1) === keyStr.charAt(64)) {\n            totalLength--;\n        }\n        if (input.charAt(input.length - 2) === keyStr.charAt(64)) {\n            totalLength--;\n        }\n        if (totalLength % 1 !== 0) {\n            // totalLength is not an integer, the length does not match a valid\n            // base64 content. That can happen if:\n            // - the input is not a base64 content\n            // - the input is *almost* a base64 content, with a extra chars at the\n            // beginning or at the end\n            // - the input uses a base64 variant (base64url for example)\n            throw new Error('Invalid base64 input, bad content length.');\n        }\n        var output = new Uint8Array(totalLength | 0);\n        while (i < input.length) {\n            enc1 = keyStr.indexOf(input.charAt(i++));\n            enc2 = keyStr.indexOf(input.charAt(i++));\n            enc3 = keyStr.indexOf(input.charAt(i++));\n            enc4 = keyStr.indexOf(input.charAt(i++));\n            chr1 = (enc1 << 2) | (enc2 >> 4);\n            chr2 = ((enc2 & 15) << 4) | (enc3 >> 2);\n            chr3 = ((enc3 & 3) << 6) | enc4;\n            output[resultIndex++] = chr1;\n            if (enc3 !== 64) {\n                output[resultIndex++] = chr2;\n            }\n            if (enc4 !== 64) {\n                output[resultIndex++] = chr3;\n            }\n        }\n        return output;\n    };\n    WordExport.prototype.serializeExternalLinkImages = function (writer) {\n        var imagePath = '';\n        var keys = this.externalImages.keys;\n        for (var i = 0; i < this.externalImages.keys.length; i++) {\n            this.serializeRelationShip(writer, keys[i], this.imageRelType, this.externalImages.get(keys[i]));\n        }\n    };\n    // Serializes the HeaderFooters relations to the document relations stream\n    WordExport.prototype.serializeHeaderFooterRelations = function (writer) {\n        this.serializeHFRelation(writer, 'EvenFooter');\n        this.serializeHFRelation(writer, 'EvenHeader');\n        this.serializeHFRelation(writer, 'FirstPageFooter');\n        this.serializeHFRelation(writer, 'FirstPageHeader');\n        this.serializeHFRelation(writer, 'OddFooter');\n        this.serializeHFRelation(writer, 'OddHeader');\n    };\n    // Serializes the headers footers relations.\n    WordExport.prototype.serializeHFRelation = function (writer, hfType) {\n        var headerFooterPath = '';\n        var relType;\n        if (!this.headersFooters.containsKey(hfType)) {\n            return;\n        }\n        var hfColl = this.headersFooters.get(hfType);\n        for (var i = 0; i < hfColl.keys.length; i++) {\n            var id = hfColl.keys[i];\n            if (hfType === 'EvenHeader' || hfType === 'FirstPageHeader' ||\n                hfType === 'OddHeader') {\n                headerFooterPath = 'header' + id.replace('rId', '') + '.xml';\n                relType = this.headerRelType;\n            }\n            else {\n                headerFooterPath = 'footer' + id.replace('rId', '') + '.xml';\n                relType = this.footerRelType;\n            }\n            this.serializeRelationShip(writer, id, relType, headerFooterPath);\n        }\n    };\n    // Serializes the relationship\n    WordExport.prototype.serializeRelationShip = function (writer, relationshipID, relationshipType, targetPath) {\n        writer.writeStartElement(undefined, 'Relationship', undefined);\n        writer.writeAttributeString(undefined, 'Id', undefined, relationshipID);\n        writer.writeAttributeString(undefined, 'Type', undefined, relationshipType);\n        writer.writeAttributeString(undefined, 'Target', undefined, targetPath.replace('\\\\', '/').replace('\\v', ''));\n        // tslint:disable-next-line:max-line-length\n        if (relationshipType === this.hyperlinkRelType || this.startsWith(targetPath, 'http://') || this.startsWith(targetPath, 'https://') || this.startsWith(targetPath, 'file:///')) {\n            // Uri targetUri;\n            // if ((!targetPath.StartsWith('file:///')) && Uri.TryCreate(targetPath, UriKind.Absolute, out targetUri))\n            // {\n            //     //Handled using Try catch to avoid exception if the Host name type is None because in \n            //Silverlight 'HostNameType' property is not available.\n            //     try\n            //     {\n            //         m_writer.WriteAttributeString('Target', targetUri.AbsoluteUri);\n            //     }\n            //     catch\n            //     {\n            //         m_writer.WriteAttributeString('Target', targetPath.Replace('\\\\', '/').Replace(ControlChar.LineBreak, string.Empty));\n            //     }\n            // }\n            // else\n            // {\n            //     m_writer.WriteAttributeString('Target', targetPath.Replace('\\\\', '/').Replace(ControlChar.LineBreak, string.Empty));\n            // }\n            writer.writeAttributeString(undefined, 'TargetMode', undefined, 'External');\n        }\n        writer.writeEndElement();\n    };\n    // Get the next relationship ID\n    WordExport.prototype.getNextRelationShipID = function () {\n        return 'rId' + (++this.mRelationShipID);\n    };\n    WordExport.prototype.serializeGeneralRelations = function () {\n        var writer = new XmlWriter();\n        this.resetRelationShipID();\n        writer.writeStartElement(undefined, 'Relationships', this.rpNamespace);\n        this.serializeRelationShip(writer, this.getNextRelationShipID(), this.documentRelType, this.documentPath);\n        // this.serializeRelationShip(writer, this.getNextRelationShipID(), this.AppRelType, this.appPath);\n        // this.serializeRelationShip(writer, this.getNextRelationShipID(), this.CoreRelType, this.corePath);\n        //End of Relationships tag\n        writer.writeEndElement();\n        var zipArchiveItem = new ZipArchiveItem(writer.buffer, this.generalRelationPath);\n        this.mArchive.addItem(zipArchiveItem);\n    };\n    WordExport.prototype.serializeContentTypes = function (contentType) {\n        var writer = new XmlWriter();\n        writer.writeStartElement(undefined, 'Types', 'http://schemas.openxmlformats.org/package/2006/content-types');\n        //if (m_hasOleObject)\n        //{\n        //    //<Default Extension='bin' ContentType='application/vnd.openxmlformats-officedocument.oleObject'/>\n        //    SerializeDefaultContentType(contentStream, 'bin', 'application/vnd.openxmlformats-officedocument.oleObject');\n        //}\n        this.serializeDefaultContentType(writer, 'rels', this.relationContentType);\n        this.serializeDefaultContentType(writer, 'xml', this.xmlContentType);\n        // if (m_hasEmbedFonts && !string.IsNullOrEmpty(type))\n        // {\n        //     SerializeDefaultContentType(contentStream,type, this.fontContentType);\n        // }\n        if (this.documentImages.length > 0 || this.externalImages.length > 0 || this.headerFooterImages.length > 0) {\n            this.serializeDefaultContentType(writer, 'png', 'image/png');\n            this.serializeDefaultContentType(writer, 'bmp', 'image/bmp');\n            this.serializeDefaultContentType(writer, 'emf', 'image/x-emf');\n            this.serializeDefaultContentType(writer, 'wmf', 'image/x-wmf');\n            this.serializeDefaultContentType(writer, 'gif', 'image/gif');\n            this.serializeDefaultContentType(writer, 'ico', 'image/x-icon');\n            this.serializeDefaultContentType(writer, 'tif', 'image/tiff');\n            this.serializeDefaultContentType(writer, 'tiff', 'image/tiff');\n            this.serializeDefaultContentType(writer, 'jpeg', 'image/jpeg');\n            this.serializeDefaultContentType(writer, 'jpg', 'image/jpeg');\n            this.serializeDefaultContentType(writer, 'svg', 'image/svg+xml');\n        }\n        // if (m_document.HasMacros\n        //     && IsMacroEnabled && !m_isSkipBinExtension)\n        // {\n        //     SerializeDefaultContentType(contentStream, 'bin', this.VbaProjectContentType);\n        //     m_isSkipBinExtension = true;\n        // }\n        // if (m_hasOleObject)\n        // {\n        //     SerializeOleContentType(contentStream);\n        // }\n        //document.xml\n        this.serializeOverrideContentType(writer, this.documentPath, this.documentContentType);\n        // tslint:disable-next-line:max-line-length\n        //<Override PartName='/word/numbering.xml' ContentType='application/vnd.openxmlformats-officedocument.wordprocessingml.numbering+xml'/>\n        // if (HasNumbering) {\n        this.serializeOverrideContentType(writer, this.numberingPath, this.numberingContentType);\n        // }\n        //Add the header/footer Alternate chunks\n        // if (HeaderFooterAlternateChunks.length > 0) {\n        //     foreach(Dictionary < string, string > item in m_headerFooterAlternateChunks.Values)\n        //     AddAlternateChunkItem(item);\n        // }\n        //styles.xml\n        this.serializeOverrideContentType(writer, this.stylePath, this.stylesContentType);\n        //settings.xml\n        this.serializeOverrideContentType(writer, this.settingsPath, this.settingsContentType);\n        //             //core.xml\n        //             SerializeOverrideContentType(contentStream, this.corePath, this.CoreContentType);\n        //             //app.xml\n        //             SerializeOverrideContentType(contentStream, this.appPath, this.AppContentType);\n        //             //custom.xml\n        //             if (!isNullOrUndefined(m_document.CustomDocumentProperties) && m_document.CustomDocumentProperties.length > 0)\n        //                 SerializeOverrideContentType(contentStream, this.CustomPath, this.CustomContentType);\n        // #if Chart\n        //             if (m_hasChart)\n        //                 SerializeChartContentType(contentStream);\n        // #endif\n        this.serializeHFContentTypes(writer);\n        // WriteXmlItemsContentTypes(contentStream);\n        //End of Types tag\n        writer.writeEndElement();\n        var zipArchiveItem = new ZipArchiveItem(writer.buffer, this.contentTypesPath);\n        this.mArchive.addItem(zipArchiveItem);\n    };\n    // Serializes the HeaderFooter content types\n    WordExport.prototype.serializeHFContentTypes = function (writer) {\n        this.serializeHeaderFootersContentType(writer, 'EvenFooter');\n        this.serializeHeaderFootersContentType(writer, 'EvenHeader');\n        this.serializeHeaderFootersContentType(writer, 'FirstPageFooter');\n        this.serializeHeaderFootersContentType(writer, 'FirstPageHeader');\n        this.serializeHeaderFootersContentType(writer, 'OddFooter');\n        this.serializeHeaderFootersContentType(writer, 'OddHeader');\n    };\n    // Serializes the HeaderFooter content types.\n    WordExport.prototype.serializeHeaderFootersContentType = function (writer, headerFooterType) {\n        var contentType;\n        var partName;\n        if (!this.headersFooters.containsKey(headerFooterType)) {\n            return;\n        }\n        var hfColl = this.headersFooters.get(headerFooterType);\n        for (var i = 0; i < hfColl.keys.length; i++) {\n            var id = hfColl.keys[i];\n            if (headerFooterType === 'EvenHeader' || headerFooterType === 'FirstPageHeader' ||\n                headerFooterType === 'OddHeader') {\n                partName = this.headerPath + id.replace('rId', '') + '.xml';\n                contentType = this.headerContentType;\n            }\n            else {\n                partName = this.footerPath + id.replace('rId', '') + '.xml';\n                contentType = this.footerContentType;\n            }\n            this.serializeOverrideContentType(writer, partName, contentType);\n        }\n    };\n    // Serializes the Override content type.\n    WordExport.prototype.serializeOverrideContentType = function (writer, partName, contentType) {\n        writer.writeStartElement(undefined, 'Override', undefined);\n        writer.writeAttributeString(undefined, 'PartName', undefined, '/' + partName.replace('\\\\', '/'));\n        writer.writeAttributeString(undefined, 'ContentType', undefined, contentType);\n        writer.writeEndElement();\n    };\n    // Serializes the default content type\n    WordExport.prototype.serializeDefaultContentType = function (writer, extension, contentType) {\n        writer.writeStartElement(undefined, 'Default', undefined);\n        writer.writeAttributeString(undefined, 'Extension', undefined, extension);\n        writer.writeAttributeString(undefined, 'ContentType', undefined, contentType);\n        writer.writeEndElement();\n    };\n    // Reset the relationship id counter\n    WordExport.prototype.resetRelationShipID = function () {\n        this.mRelationShipID = 0;\n    };\n    WordExport.prototype.close = function () {\n        //Implement\n    };\n    return WordExport;\n}());\nexport { WordExport };\n","import { StreamWriter } from '@syncfusion/ej2-file-utils';\nimport { isNullOrUndefined } from '@syncfusion/ej2-base';\n/**\n * Exports the document to Text format.\n */\nvar TextExport = /** @class */ (function () {\n    function TextExport() {\n        this.text = '';\n        this.curSectionIndex = 0;\n        this.inField = false;\n    }\n    TextExport.prototype.getModuleName = function () {\n        return 'TextExport';\n    };\n    /**\n     * @private\n     */\n    TextExport.prototype.save = function (viewer, fileName) {\n        this.serialize(viewer);\n        var writer = new StreamWriter();\n        this.writeInternal(writer);\n        writer.save(fileName + '.txt');\n    };\n    /**\n     * @private\n     */\n    TextExport.prototype.saveAsBlob = function (viewer) {\n        this.serialize(viewer);\n        var streamWriter = new StreamWriter();\n        this.writeInternal(streamWriter);\n        var blob = streamWriter.buffer;\n        streamWriter.destroy();\n        var promise;\n        return new Promise(function (resolve, reject) {\n            resolve(blob);\n        });\n    };\n    TextExport.prototype.serialize = function (viewer) {\n        var document = viewer.owner.sfdtExportModule.write();\n        this.setDocument(document);\n    };\n    TextExport.prototype.setDocument = function (document) {\n        this.document = document;\n        this.mSections = document.sections;\n    };\n    TextExport.prototype.writeInternal = function (streamWriter) {\n        var section = undefined;\n        var sectionCount = this.document.sections.length - 1;\n        var isLastSection = false;\n        this.updateLastParagraph();\n        for (var i = 0; i <= sectionCount; i++) {\n            section = this.document.sections[i];\n            isLastSection = (i === sectionCount) ? true : false;\n            this.writeBody(streamWriter, section.blocks);\n            this.writeNewLine(streamWriter);\n            this.writeSectionEnd(section, isLastSection);\n        }\n        for (var j = 0; j <= sectionCount; j++) {\n            section = this.document.sections[j];\n            this.writeHeadersFooters(streamWriter, section);\n        }\n    };\n    /// <summary>\n    /// Writes the specified document content to the text file.\n    /// </summary>\n    TextExport.prototype.writeBody = function (streamWriter, body) {\n        var bodyItemsCount = body.length - 1;\n        var bodyItem = undefined;\n        for (var i = 0; i <= bodyItemsCount; i++) {\n            bodyItem = body[i];\n            if (bodyItem.hasOwnProperty('inlines')) {\n                var isLastPara = (bodyItem === this.lastPara) ? true : false;\n                this.writeParagraph(streamWriter, bodyItem, isLastPara);\n            }\n            else {\n                this.writeTable(streamWriter, bodyItem);\n            }\n        }\n    };\n    TextExport.prototype.writeParagraph = function (streamWriter, paragraph, isLastPara) {\n        for (var i = 0; i < paragraph.inlines.length; i++) {\n            var item = paragraph.inlines[i];\n            if (item.hasOwnProperty('fieldType')) {\n                this.inField = item.fieldType === 0;\n            }\n            else if (item.hasOwnProperty('text') && !this.inField) {\n                this.writeText(streamWriter, item.text);\n            }\n        }\n        if (!isLastPara) {\n            this.writeNewLine(streamWriter);\n        }\n    };\n    /// }\n    /// <summary>\n    /// Writes the specified table text content to the text file.\n    /// </summary>\n    TextExport.prototype.writeTable = function (streamWriter, table) {\n        for (var i = 0; i < table.rows.length; i++) {\n            var row = table.rows[i];\n            for (var j = 0; j < row.cells.length; j++) {\n                var cell = row.cells[j];\n                this.writeBody(streamWriter, cell.blocks);\n            }\n        }\n    };\n    /// <summary>\n    /// Writes the specified Header Footer text content to the text file.\n    /// </summary>\n    TextExport.prototype.writeHeadersFooters = function (streamWriter, section) {\n        var headersFooters = section.headersFooters;\n        if (isNullOrUndefined(headersFooters)) {\n            return;\n        }\n        this.writeHeaderFooter(streamWriter, section.headersFooters.header);\n        this.writeHeaderFooter(streamWriter, section.headersFooters.footer);\n        this.writeHeaderFooter(streamWriter, section.headersFooters.evenFooter);\n        this.writeHeaderFooter(streamWriter, section.headersFooters.evenHeader);\n        this.writeHeaderFooter(streamWriter, section.headersFooters.firstPageHeader);\n        this.writeHeaderFooter(streamWriter, section.headersFooters.firstPageFooter);\n    };\n    TextExport.prototype.writeHeaderFooter = function (streamWriter, headerFooter) {\n        if (headerFooter && headerFooter.blocks) {\n            this.writeBody(streamWriter, headerFooter.blocks);\n        }\n    };\n    /// <summary>\n    /// Writes the end of the section.\n    /// </summary>\n    TextExport.prototype.writeSectionEnd = function (section, lastSection) {\n        this.curSectionIndex++;\n    };\n    TextExport.prototype.writeNewLine = function (writer) {\n        writer.writeLine('');\n    };\n    TextExport.prototype.writeText = function (writer, text) {\n        writer.write(text);\n    };\n    TextExport.prototype.updateLastParagraph = function () {\n        var cnt = this.document.sections.length;\n        var sec;\n        if (cnt > 0) {\n            sec = this.document.sections[cnt - 1];\n        }\n        if (!isNullOrUndefined(sec)) {\n            var paragraphs = [];\n            for (var i = 0; i < sec.blocks.length; i++) {\n                if (sec.blocks[i].hasOwnProperty('inlines')) {\n                    paragraphs.push(sec.blocks[i]);\n                }\n            }\n            var pCount = paragraphs.length;\n            if (pCount > 0) {\n                this.lastPara = paragraphs[pCount - 1];\n            }\n        }\n    };\n    /**\n     * @private\n     */\n    TextExport.prototype.destroy = function () {\n        this.document = undefined;\n        this.lastPara = undefined;\n        this.mSections = undefined;\n        this.sections = undefined;\n    };\n    return TextExport;\n}());\nexport { TextExport };\n","import { LineWidget, ParagraphWidget, BodyWidget, TextElementBox, FieldElementBox, TableRowWidget, TableCellWidget, ImageElementBox, ListTextElementBox, BookmarkElementBox } from '../viewer/page';\nimport { BlockWidget } from '../viewer/page';\nimport { isNullOrUndefined } from '@syncfusion/ej2-base';\nimport { HelperMethods } from '../editor/editor-helper';\nimport { StreamWriter } from '@syncfusion/ej2-file-utils';\n/**\n * Exports the document to Sfdt format.\n */\nvar SfdtExport = /** @class */ (function () {\n    /**\n     * @private\n     */\n    function SfdtExport(owner) {\n        /* tslint:disable:no-any */\n        this.endLine = undefined;\n        this.endOffset = undefined;\n        this.endCell = undefined;\n        this.startColumnIndex = undefined;\n        this.endColumnIndex = undefined;\n        this.lists = undefined;\n        this.viewer = undefined;\n        this.document = undefined;\n        this.writeInlineStyles = undefined;\n        this.viewer = owner;\n    }\n    SfdtExport.prototype.getModuleName = function () {\n        return 'SfdtExport';\n    };\n    SfdtExport.prototype.clear = function () {\n        this.writeInlineStyles = undefined;\n        this.endLine = undefined;\n        this.lists = undefined;\n        this.document = undefined;\n    };\n    /**\n     * Serialize the data as Syncfusion document text.\n     * @private\n     */\n    SfdtExport.prototype.serialize = function () {\n        return JSON.stringify(this.write());\n    };\n    /**\n     * @private\n     */\n    SfdtExport.prototype.saveAsBlob = function (viewer) {\n        var streamWriter = new StreamWriter();\n        streamWriter.write(this.serialize());\n        var blob = streamWriter.buffer;\n        streamWriter.destroy();\n        var promise;\n        return new Promise(function (resolve, reject) {\n            resolve(blob);\n        });\n    };\n    // tslint:disable-next-line:max-line-length\n    /**\n     * @private\n     */\n    SfdtExport.prototype.write = function (line, startOffset, endLine, endOffset, writeInlineStyles) {\n        if (writeInlineStyles) {\n            this.writeInlineStyles = true;\n        }\n        this.lists = [];\n        this.document = {};\n        this.document.sections = [];\n        this.document.characterFormat = this.writeCharacterFormat(this.viewer.characterFormat);\n        this.document.paragraphFormat = this.writeParagraphFormat(this.viewer.paragraphFormat);\n        if (line instanceof LineWidget && endLine instanceof LineWidget) {\n            // For selection\n            var startPara = line.paragraph;\n            var endPara = endLine.paragraph;\n            var startCell = startPara.associatedCell;\n            var endCell = endPara.associatedCell;\n            // Creates section\n            var bodyWidget = startPara.bodyWidget;\n            var section = this.createSection(line.paragraph.bodyWidget);\n            this.document.sections.push(section);\n            if (startCell === endCell || isNullOrUndefined(endCell)) {\n                this.endLine = endLine;\n                this.endOffset = endOffset;\n            }\n            else {\n                // Todo: Handle nested table cases\n                if (startCell instanceof TableCellWidget) {\n                    var startTable = startCell.getContainerTable();\n                    var endTable = endCell.getContainerTable();\n                    if (startTable.tableFormat === endTable.tableFormat) {\n                        this.endCell = endCell;\n                        this.endColumnIndex = this.endCell.columnIndex + this.endCell.cellFormat.columnSpan;\n                        this.startColumnIndex = startCell.columnIndex;\n                    }\n                }\n                else {\n                    this.endCell = endCell;\n                }\n            }\n            if (startCell === endCell || isNullOrUndefined(startCell)) {\n                var paragraph = this.createParagraph(line.paragraph);\n                section.blocks.push(paragraph);\n                if (!this.writeParagraph(line.paragraph, paragraph, section.blocks, line.indexInOwner, startOffset)) {\n                    // Todo:continue in next section\n                }\n            }\n            else {\n                var table = this.createTable(startCell.ownerTable);\n                section.blocks.push(table);\n                this.writeTable(startCell.ownerTable, table, startCell.ownerRow.indexInOwner, section.blocks);\n            }\n        }\n        else {\n            if (this.viewer.pages.length > 0) {\n                var page = this.viewer.pages[0];\n                if (page.bodyWidgets.length > 0) {\n                    this.writeBodyWidget(page.bodyWidgets[0], 0);\n                }\n            }\n        }\n        this.writeStyles(this.viewer);\n        this.writeLists(this.viewer);\n        var doc = this.document;\n        this.clear();\n        return doc;\n    };\n    SfdtExport.prototype.writeBodyWidget = function (bodyWidget, index) {\n        if (!(bodyWidget instanceof BodyWidget)) {\n            return true;\n        }\n        var section = this.createSection(bodyWidget);\n        this.document.sections.push(section);\n        this.writeHeaderFooters(this.viewer.headersFooters[bodyWidget.index], section);\n        if (this.writeBlock(bodyWidget.childWidgets[index], 0, section.blocks)) {\n            return true;\n        }\n        var next = bodyWidget;\n        do {\n            bodyWidget = next;\n            next = next.nextRenderedWidget;\n        } while (next instanceof BodyWidget && next.index === bodyWidget.index);\n        return this.writeBodyWidget(next, index);\n    };\n    SfdtExport.prototype.writeHeaderFooters = function (hfs, section) {\n        if (isNullOrUndefined(hfs)) {\n            return;\n        }\n        section.headersFooters.header = this.writeHeaderFooter(hfs[0]);\n        section.headersFooters.footer = this.writeHeaderFooter(hfs[1]);\n        section.headersFooters.evenHeader = this.writeHeaderFooter(hfs[2]);\n        section.headersFooters.evenFooter = this.writeHeaderFooter(hfs[3]);\n        section.headersFooters.firstPageHeader = this.writeHeaderFooter(hfs[4]);\n        section.headersFooters.firstPageFooter = this.writeHeaderFooter(hfs[5]);\n    };\n    SfdtExport.prototype.writeHeaderFooter = function (widget) {\n        if (isNullOrUndefined(widget)) {\n            return undefined;\n        }\n        var headerFooter = {};\n        if (widget && widget.childWidgets && widget.childWidgets.length > 0) {\n            headerFooter.blocks = [];\n            this.writeBlock(widget.firstChild, 0, headerFooter.blocks);\n        }\n        return headerFooter;\n    };\n    SfdtExport.prototype.createSection = function (bodyWidget) {\n        var section = {};\n        section.sectionFormat = {};\n        section.sectionFormat.pageWidth = bodyWidget.sectionFormat.pageWidth;\n        section.sectionFormat.pageHeight = bodyWidget.sectionFormat.pageHeight;\n        section.sectionFormat.leftMargin = bodyWidget.sectionFormat.leftMargin;\n        section.sectionFormat.rightMargin = bodyWidget.sectionFormat.rightMargin;\n        section.sectionFormat.topMargin = bodyWidget.sectionFormat.topMargin;\n        section.sectionFormat.bottomMargin = bodyWidget.sectionFormat.bottomMargin;\n        section.sectionFormat.differentFirstPage = bodyWidget.sectionFormat.differentFirstPage;\n        section.sectionFormat.differentOddAndEvenPages = bodyWidget.sectionFormat.differentOddAndEvenPages;\n        section.sectionFormat.headerDistance = bodyWidget.sectionFormat.headerDistance;\n        section.sectionFormat.footerDistance = bodyWidget.sectionFormat.footerDistance;\n        section.blocks = [];\n        section.headersFooters = {};\n        return section;\n    };\n    SfdtExport.prototype.writeBlock = function (widget, index, blocks) {\n        if (!(widget instanceof BlockWidget)) {\n            return true;\n        }\n        if (widget instanceof ParagraphWidget) {\n            var paragraph = this.createParagraph(widget);\n            blocks.push(paragraph);\n            if (this.writeParagraph(widget, paragraph, blocks)) {\n                return true;\n            }\n        }\n        else {\n            var tableWidget = widget;\n            var table = this.createTable(tableWidget);\n            blocks.push(table);\n            if (this.writeTable(tableWidget, table, 0, blocks)) {\n                return true;\n            }\n        }\n        return false;\n    };\n    SfdtExport.prototype.writeNextBlock = function (widget, blocks) {\n        var next = widget.nextRenderedWidget;\n        if (next instanceof BlockWidget && next.containerWidget.index === widget.containerWidget.index) {\n            return this.writeBlock(widget.nextRenderedWidget, 0, blocks);\n        }\n        return false;\n    };\n    SfdtExport.prototype.writeParagraph = function (paragraphWidget, paragraph, blocks, lineIndex, start) {\n        if (isNullOrUndefined(lineIndex)) {\n            lineIndex = 0;\n        }\n        if (isNullOrUndefined(start)) {\n            start = 0;\n        }\n        var next = paragraphWidget;\n        while (next instanceof ParagraphWidget) {\n            if (this.writeLines(next, lineIndex, start, paragraph.inlines)) {\n                return true;\n            }\n            lineIndex = 0;\n            start = 0;\n            paragraphWidget = next;\n            next = paragraphWidget.nextSplitWidget;\n        }\n        return this.writeNextBlock(paragraphWidget, blocks);\n    };\n    SfdtExport.prototype.writeInlines = function (line, inlines) {\n        for (var i = 0; i < line.children.length; i++) {\n            var element = line.children[i];\n            if (element instanceof ListTextElementBox) {\n                continue;\n            }\n            var inline = this.writeInline(element);\n            if (!isNullOrUndefined(inline)) {\n                inlines.push(inline);\n            }\n        }\n    };\n    SfdtExport.prototype.writeInline = function (element) {\n        var inline = {};\n        inline.characterFormat = this.writeCharacterFormat(element.characterFormat);\n        if (element instanceof FieldElementBox) {\n            inline.fieldType = element.fieldType;\n        }\n        else if (element instanceof ImageElementBox) {\n            inline.imageString = element.imageString;\n            inline.width = HelperMethods.convertPixelToPoint(element.width);\n            inline.height = HelperMethods.convertPixelToPoint(element.height);\n        }\n        else if (element instanceof BookmarkElementBox) {\n            inline.bookmarkType = element.bookmarkType;\n            inline.name = element.name;\n        }\n        else if (element instanceof TextElementBox) {\n            inline.text = element.text;\n        }\n        else {\n            inline = undefined;\n        }\n        return inline;\n    };\n    SfdtExport.prototype.writeLines = function (paragraph, lineIndex, offset, inlines) {\n        var startIndex = lineIndex;\n        var endParagraph = this.endLine instanceof LineWidget && this.endLine.paragraph === paragraph;\n        var endIndex = endParagraph ? this.endLine.indexInOwner : paragraph.childWidgets.length - 1;\n        for (var i = startIndex; i <= endIndex; i++) {\n            var child = paragraph.childWidgets[i];\n            if (this.endLine === child || (lineIndex === i && offset !== 0)) {\n                this.writeLine(child, offset, inlines);\n            }\n            else {\n                this.writeInlines(child, inlines);\n            }\n        }\n        return endParagraph;\n    };\n    SfdtExport.prototype.writeLine = function (line, offset, inlines) {\n        var isEnd = line === this.endLine;\n        var started = false;\n        var ended = false;\n        var length = 0;\n        for (var j = 0; j < line.children.length; j++) {\n            var element = line.children[j];\n            if (element instanceof ListTextElementBox) {\n                continue;\n            }\n            var inline = undefined;\n            length += element.length;\n            started = length > offset;\n            ended = isEnd && length >= this.endOffset;\n            if (!started) {\n                continue;\n            }\n            inline = this.writeInline(element);\n            inlines[inlines.length] = inline;\n            if (length > offset || ended) {\n                if (inline.hasOwnProperty('text')) {\n                    var startIndex = length - element.length;\n                    var indexInInline = offset - startIndex;\n                    var endIndex = ended ? this.endOffset - startIndex : element.length;\n                    inline.text = inline.text.substring(indexInInline, endIndex);\n                }\n                offset = -1;\n            }\n            if (ended) {\n                break;\n            }\n        }\n    };\n    SfdtExport.prototype.createParagraph = function (paragraphWidget) {\n        var paragraph = {};\n        paragraph.paragraphFormat = this.writeParagraphFormat(paragraphWidget.paragraphFormat);\n        paragraph.characterFormat = this.writeCharacterFormat(paragraphWidget.characterFormat);\n        paragraph.inlines = [];\n        return paragraph;\n    };\n    /**\n     * @private\n     */\n    SfdtExport.prototype.writeCharacterFormat = function (format, isInline) {\n        var characterFormat = {};\n        HelperMethods.writeCharacterFormat(characterFormat, isInline, format);\n        if (this.writeInlineStyles && !isInline) {\n            characterFormat.inlineFormat = this.writeCharacterFormat(format, true);\n        }\n        return characterFormat;\n    };\n    SfdtExport.prototype.writeParagraphFormat = function (format, isInline) {\n        var paragraphFormat = {};\n        paragraphFormat.leftIndent = isInline ? format.leftIndent : format.getValue('leftIndent');\n        paragraphFormat.rightIndent = isInline ? format.rightIndent : format.getValue('rightIndent');\n        paragraphFormat.firstLineIndent = isInline ? format.firstLineIndent : format.getValue('firstLineIndent');\n        paragraphFormat.textAlignment = isInline ? format.textAlignment : format.getValue('textAlignment');\n        paragraphFormat.beforeSpacing = isInline ? format.beforeSpacing : format.getValue('beforeSpacing');\n        paragraphFormat.afterSpacing = isInline ? format.afterSpacing : format.getValue('afterSpacing');\n        paragraphFormat.lineSpacing = isInline ? format.lineSpacing : format.getValue('lineSpacing');\n        paragraphFormat.lineSpacingType = isInline ? format.lineSpacingType : format.getValue('lineSpacingType');\n        paragraphFormat.styleName = !isNullOrUndefined(format.baseStyle) ? format.baseStyle.name : undefined;\n        paragraphFormat.outlineLevel = isInline ? format.outlineLevel : format.getValue('outlineLevel');\n        paragraphFormat.listFormat = this.writeListFormat(format.listFormat, isInline);\n        paragraphFormat.tabs = this.writeTabs(format.tabs);\n        if (this.writeInlineStyles && !isInline) {\n            paragraphFormat.inlineFormat = this.writeParagraphFormat(format, true);\n        }\n        return paragraphFormat;\n    };\n    SfdtExport.prototype.writeTabs = function (tabStops) {\n        if (isNullOrUndefined(tabStops) || tabStops.length < 1) {\n            return undefined;\n        }\n        var tabs = [];\n        for (var i = 0; i < tabStops.length; i++) {\n            var tabStop = tabStops[i];\n            var tab = {};\n            tab.position = tabStop.position;\n            tab.deletePosition = tabStop.deletePosition;\n            tab.tabJustification = tabStop.tabJustification;\n            tab.tabLeader = tabStop.tabLeader;\n            tabs.push(tab);\n        }\n        return tabs;\n    };\n    /**\n     * @private\n     */\n    SfdtExport.prototype.writeListFormat = function (format, isInline) {\n        var listFormat = {};\n        var listIdValue = format.getValue('listId');\n        if (!isNullOrUndefined(listIdValue) && listIdValue > -1) {\n            listFormat.listId = listIdValue;\n            listFormat.listLevelNumber = format.getValue('listLevelNumber');\n            if (this.lists.indexOf(format.listId) < 0) {\n                this.lists.push(format.listId);\n            }\n        }\n        return listFormat;\n    };\n    SfdtExport.prototype.writeTable = function (tableWidget, table, index, blocks) {\n        var widget = tableWidget.childWidgets[index];\n        if (widget instanceof TableRowWidget) {\n            if (this.writeRow(widget, table.rows)) {\n                return true;\n            }\n        }\n        var next = tableWidget;\n        do {\n            tableWidget = next;\n            next = tableWidget.nextSplitWidget;\n        } while (next instanceof BlockWidget);\n        return this.writeNextBlock(tableWidget, blocks);\n    };\n    SfdtExport.prototype.writeRow = function (rowWidget, rows) {\n        if (!(rowWidget instanceof TableRowWidget)) {\n            return false;\n        }\n        var row = this.createRow(rowWidget);\n        rows.push(row);\n        for (var i = 0; i < rowWidget.childWidgets.length; i++) {\n            var widget = rowWidget.childWidgets[i];\n            if (widget instanceof TableCellWidget) {\n                if (rowWidget.index === widget.rowIndex\n                    && (isNullOrUndefined(this.startColumnIndex) || widget.columnIndex >= this.startColumnIndex)\n                    && (isNullOrUndefined(this.endColumnIndex) || widget.columnIndex < this.endColumnIndex)) {\n                    if (this.writeCell(widget, row.cells)) {\n                        return true;\n                    }\n                }\n            }\n        }\n        var next = rowWidget;\n        do {\n            rowWidget = next;\n            next = rowWidget.nextRenderedWidget;\n        } while (next instanceof TableRowWidget && next.index === rowWidget.index);\n        return this.writeRow(next, rows);\n    };\n    SfdtExport.prototype.writeCell = function (cellWidget, cells) {\n        var cell = this.createCell(cellWidget);\n        cells.push(cell);\n        if (this.writeBlock(cellWidget.firstChild, 0, cell.blocks)) {\n            return true;\n        }\n        return this.endCell instanceof TableCellWidget ? this.endCell.cellFormat === cellWidget.cellFormat : false;\n    };\n    SfdtExport.prototype.createTable = function (tableWidget) {\n        var table = {};\n        table.rows = [];\n        table.grid = [];\n        for (var i = 0; i < tableWidget.tableHolder.columns.length; i++) {\n            table.grid[i] = tableWidget.tableHolder.columns[i].preferredWidth;\n        }\n        table.tableFormat = this.writeTableFormat(tableWidget.tableFormat);\n        table.description = tableWidget.description;\n        table.title = tableWidget.title;\n        return table;\n    };\n    SfdtExport.prototype.createRow = function (rowWidget) {\n        var row = {};\n        row.cells = [];\n        row.rowFormat = this.writeRowFormat(rowWidget.rowFormat);\n        return row;\n    };\n    SfdtExport.prototype.createCell = function (cellWidget) {\n        var cell = {};\n        cell.blocks = [];\n        cell.cellFormat = this.writeCellFormat(cellWidget.cellFormat);\n        cell.columnIndex = cellWidget.columnIndex;\n        return cell;\n    };\n    SfdtExport.prototype.writeShading = function (wShading) {\n        var shading = {};\n        shading.backgroundColor = wShading.backgroundColor;\n        shading.foregroundColor = wShading.foregroundColor;\n        shading.textureStyle = wShading.textureStyle;\n        return shading;\n    };\n    SfdtExport.prototype.writeBorder = function (wBorder) {\n        var border = {};\n        border.color = wBorder.color;\n        border.hasNoneStyle = wBorder.hasNoneStyle;\n        border.lineStyle = wBorder.lineStyle;\n        border.lineWidth = wBorder.lineWidth;\n        border.shadow = wBorder.shadow;\n        border.space = wBorder.space;\n        return border;\n    };\n    SfdtExport.prototype.writeBorders = function (wBorders) {\n        var borders = {};\n        borders.top = this.writeBorder(wBorders.top);\n        borders.left = this.writeBorder(wBorders.left);\n        borders.right = this.writeBorder(wBorders.right);\n        borders.bottom = this.writeBorder(wBorders.bottom);\n        borders.diagonalDown = this.writeBorder(wBorders.diagonalDown);\n        borders.diagonalUp = this.writeBorder(wBorders.diagonalUp);\n        borders.horizontal = this.writeBorder(wBorders.horizontal);\n        borders.vertical = this.writeBorder(wBorders.vertical);\n        return borders;\n    };\n    SfdtExport.prototype.writeCellFormat = function (wCellFormat) {\n        var cellFormat = {};\n        cellFormat.borders = this.writeBorders(wCellFormat.borders);\n        cellFormat.shading = this.writeShading(wCellFormat.shading);\n        cellFormat.topMargin = wCellFormat.topMargin;\n        cellFormat.rightMargin = wCellFormat.rightMargin;\n        cellFormat.leftMargin = wCellFormat.leftMargin;\n        cellFormat.bottomMargin = wCellFormat.bottomMargin;\n        cellFormat.preferredWidth = wCellFormat.preferredWidth;\n        cellFormat.preferredWidthType = wCellFormat.preferredWidthType;\n        cellFormat.cellWidth = wCellFormat.cellWidth;\n        cellFormat.columnSpan = wCellFormat.columnSpan;\n        cellFormat.rowSpan = wCellFormat.rowSpan;\n        cellFormat.verticalAlignment = wCellFormat.verticalAlignment;\n        return cellFormat;\n    };\n    SfdtExport.prototype.writeRowFormat = function (wRowFormat) {\n        var rowFormat = {};\n        rowFormat.height = wRowFormat.height;\n        rowFormat.allowBreakAcrossPages = wRowFormat.allowBreakAcrossPages;\n        rowFormat.heightType = wRowFormat.heightType;\n        rowFormat.isHeader = wRowFormat.isHeader;\n        rowFormat.borders = this.writeBorders(wRowFormat.borders);\n        rowFormat.gridBefore = wRowFormat.gridBefore;\n        rowFormat.gridBeforeWidth = wRowFormat.gridBeforeWidth;\n        rowFormat.gridBeforeWidthType = wRowFormat.gridBeforeWidthType;\n        rowFormat.gridAfter = wRowFormat.gridAfter;\n        rowFormat.gridAfterWidth = wRowFormat.gridAfterWidth;\n        rowFormat.gridAfterWidthType = wRowFormat.gridAfterWidthType;\n        return rowFormat;\n    };\n    SfdtExport.prototype.writeTableFormat = function (wTableFormat) {\n        var tableFormat = {};\n        tableFormat.borders = this.writeBorders(wTableFormat.borders);\n        tableFormat.shading = this.writeShading(wTableFormat.shading);\n        tableFormat.cellSpacing = wTableFormat.cellSpacing;\n        tableFormat.leftIndent = wTableFormat.leftIndent;\n        tableFormat.tableAlignment = wTableFormat.tableAlignment;\n        tableFormat.topMargin = wTableFormat.topMargin;\n        tableFormat.rightMargin = wTableFormat.rightMargin;\n        tableFormat.leftMargin = wTableFormat.leftMargin;\n        tableFormat.bottomMargin = wTableFormat.bottomMargin;\n        tableFormat.preferredWidth = wTableFormat.preferredWidth;\n        tableFormat.preferredWidthType = wTableFormat.preferredWidthType;\n        return tableFormat;\n    };\n    SfdtExport.prototype.writeStyles = function (viewer) {\n        var styles = [];\n        this.document.styles = [];\n        for (var i = 0; i < viewer.styles.length; i++) {\n            this.document.styles.push(this.writeStyle(viewer.styles.getItem(i)));\n        }\n    };\n    SfdtExport.prototype.writeStyle = function (style) {\n        var wStyle = {};\n        wStyle.name = style.name;\n        if (style.type === 'Paragraph') {\n            wStyle.type = 'Paragraph';\n            wStyle.paragraphFormat = this.writeParagraphFormat(style.paragraphFormat);\n            wStyle.characterFormat = this.writeCharacterFormat(style.characterFormat);\n        }\n        if (style.type === 'Character') {\n            wStyle.type = 'Character';\n            wStyle.characterFormat = this.writeCharacterFormat(style.characterFormat);\n        }\n        if (!isNullOrUndefined(style.basedOn)) {\n            wStyle.basedOn = style.basedOn.name;\n        }\n        if (!isNullOrUndefined(style.link)) {\n            wStyle.link = style.link.name;\n        }\n        if (!isNullOrUndefined(style.next)) {\n            wStyle.next = style.next.name;\n        }\n        return wStyle;\n    };\n    SfdtExport.prototype.writeLists = function (viewer) {\n        var abstractLists = [];\n        this.document.lists = [];\n        for (var i = 0; i < viewer.lists.length; i++) {\n            var list = viewer.lists[i];\n            if (this.lists.indexOf(list.listId) > -1) {\n                this.document.lists.push(this.writeList(list));\n                if (abstractLists.indexOf(list.abstractListId) < 0) {\n                    abstractLists.push(list.abstractListId);\n                }\n            }\n        }\n        this.document.abstractLists = [];\n        for (var i = 0; i < viewer.abstractLists.length; i++) {\n            var abstractList = viewer.abstractLists[i];\n            if (this.lists.indexOf(abstractList.abstractListId) > -1) {\n                this.document.abstractLists.push(this.writeAbstractList(abstractList));\n            }\n        }\n    };\n    SfdtExport.prototype.writeAbstractList = function (wAbstractList) {\n        var abstractList = {};\n        abstractList.abstractListId = wAbstractList.abstractListId;\n        abstractList.levels = [];\n        for (var i = 0; i < wAbstractList.levels.length; i++) {\n            abstractList.levels[i] = this.writeListLevel(wAbstractList.levels[i]);\n        }\n        return abstractList;\n    };\n    SfdtExport.prototype.writeList = function (wList) {\n        var list = {};\n        list.abstractListId = wList.abstractListId;\n        //list.levelOverrides = wList.levelOverrides;\n        list.listId = wList.listId;\n        return list;\n    };\n    SfdtExport.prototype.writeListLevel = function (wListLevel) {\n        var listLevel = {};\n        listLevel.characterFormat = this.writeCharacterFormat(wListLevel.characterFormat);\n        listLevel.paragraphFormat = this.writeParagraphFormat(wListLevel.paragraphFormat);\n        listLevel.followCharacter = wListLevel.followCharacter;\n        listLevel.listLevelPattern = wListLevel.listLevelPattern;\n        listLevel.numberFormat = wListLevel.numberFormat;\n        listLevel.restartLevel = wListLevel.restartLevel;\n        listLevel.startAt = wListLevel.startAt;\n        return listLevel;\n    };\n    /**\n     * @private\n     */\n    SfdtExport.prototype.destroy = function () {\n        this.lists = undefined;\n        this.endLine = undefined;\n        this.endOffset = undefined;\n        this.viewer = undefined;\n    };\n    return SfdtExport;\n}());\nexport { SfdtExport };\n","import { createElement, isNullOrUndefined, L10n, setCulture } from '@syncfusion/ej2-base';\nimport { DropDownList } from '@syncfusion/ej2-dropdowns';\nimport { CheckBox } from '@syncfusion/ej2-buttons';\n/**\n * The Hyperlink dialog is used to insert or edit hyperlink at selection.\n */\n/* tslint:disable:max-line-length */\nvar HyperlinkDialog = /** @class */ (function () {\n    /**\n     * @private\n     */\n    function HyperlinkDialog(viewer) {\n        var _this = this;\n        this.displayText = '';\n        this.navigationUrl = undefined;\n        this.bookmarkDropdown = undefined;\n        this.bookmarkCheckbox = undefined;\n        this.bookmarks = [];\n        /**\n         * @private\n         */\n        this.onKeyUpOnUrlBox = function (event) {\n            if (event.keyCode === 13) {\n                if (_this.displayTextBox.value !== '' && _this.urlTextBox.value !== '') {\n                    _this.onInsertHyperlink();\n                }\n                return;\n            }\n            var selectedText = _this.owner.selection.text;\n            var urlValue = _this.urlTextBox.value;\n            if (urlValue.substring(0, 4).toLowerCase() === 'www.') {\n                _this.urlTextBox.value = 'http://' + urlValue;\n            }\n            if (_this.displayText === '') {\n                _this.displayTextBox.value = urlValue;\n            }\n            _this.enableOrDisableInsertButton();\n        };\n        /**\n         * @private\n         */\n        this.onKeyUpOnDisplayBox = function () {\n            _this.displayText = _this.displayTextBox.value;\n            _this.enableOrDisableInsertButton();\n        };\n        /**\n         * @private\n         */\n        this.onInsertButtonClick = function () {\n            _this.onInsertHyperlink();\n        };\n        /**\n         * @private\n         */\n        this.onCancelButtonClick = function () {\n            _this.owner.dialog.hide();\n            _this.clearValue();\n        };\n        /**\n         * @private\n         */\n        this.loadHyperlinkDialog = function () {\n            _this.owner.updateFocus();\n            _this.bookmarks = [];\n            for (var i = 0; i < _this.owner.bookmarks.keys.length; i++) {\n                var bookmark = _this.owner.bookmarks.keys[i];\n                if (bookmark.indexOf('_') !== 0) {\n                    _this.bookmarks.push(bookmark);\n                }\n            }\n            var fieldBegin = _this.owner.selection.getHyperlinkField();\n            if (!isNullOrUndefined(fieldBegin)) {\n                if (!isNullOrUndefined(fieldBegin.fieldSeparator)) {\n                    var format = undefined;\n                    // tslint:disable-next-line:max-line-length\n                    var fieldObj = _this.owner.selection.getHyperlinkDisplayText(fieldBegin.fieldSeparator.line.paragraph, fieldBegin.fieldSeparator, fieldBegin.fieldEnd, false, format);\n                    _this.displayText = fieldObj.displayText;\n                    _this.displayTextBox.disabled = fieldObj.isNestedField;\n                }\n                _this.displayTextBox.value = _this.displayText;\n                var link = _this.owner.selection.getLinkText(fieldBegin);\n                _this.urlTextBox.value = _this.navigationUrl = link;\n                _this.owner.dialog.header = _this.localObj.getConstant('Edit Hyperlink');\n            }\n            else {\n                _this.displayText = _this.owner.selection.getText(true);\n                if (_this.displayText !== '') {\n                    if (_this.displayText.indexOf(String.fromCharCode(65532)) !== -1 ||\n                        _this.displayText.indexOf('\\r') !== -1 && (_this.displayText.lastIndexOf('\\r') !== -1 &&\n                            _this.displayText.slice(0, -1).indexOf('\\r') !== -1)) {\n                        _this.displayTextBox.value = '<<Selection in document>>';\n                        _this.displayTextBox.disabled = true;\n                    }\n                    else {\n                        _this.displayTextBox.value = _this.displayText;\n                    }\n                }\n            }\n            _this.bookmarkDiv.style.display = 'none';\n            _this.addressText.style.display = 'block';\n            _this.urlTextBox.style.display = 'block';\n            _this.bookmarkCheckbox.checked = false;\n            _this.bookmarkDropdown.dataSource = _this.owner.bookmarks.keys;\n            _this.insertButton = document.getElementsByClassName('e-hyper-insert')[0];\n            _this.enableOrDisableInsertButton();\n            _this.urlTextBox.focus();\n            if (_this.owner.selection.caret.style.display !== 'none') {\n                _this.owner.selection.caret.style.display = 'none';\n            }\n        };\n        /**\n         * @private\n         */\n        this.closeHyperlinkDialog = function () {\n            _this.clearValue();\n            _this.owner.updateFocus();\n        };\n        /* tslint:disable:no-any */\n        this.onUseBookmarkChange = function (args) {\n            if (args.checked) {\n                _this.bookmarkDiv.style.display = 'block';\n                _this.bookmarkDropdown.dataSource = _this.bookmarks;\n                _this.addressText.style.display = 'none';\n                _this.urlTextBox.style.display = 'none';\n            }\n            else {\n                _this.bookmarkDiv.style.display = 'none';\n                _this.addressText.style.display = 'block';\n                _this.urlTextBox.style.display = 'block';\n            }\n        };\n        this.onBookmarkchange = function (args) {\n            if (_this.bookmarkDropdown.value !== '') {\n                _this.insertButton.disabled = false;\n            }\n        };\n        this.owner = viewer;\n    }\n    /**\n     * @private\n     */\n    HyperlinkDialog.prototype.getModuleName = function () {\n        return 'HyperlinkDialog';\n    };\n    /**\n     * @private\n     */\n    HyperlinkDialog.prototype.initHyperlinkDialog = function (localValue) {\n        var instance = this;\n        var id = this.owner.owner.containerId + '_insert_hyperlink';\n        this.target = createElement('div', { id: id, className: 'e-de-hyperlink' });\n        var container = createElement('div');\n        var displayText = createElement('div', { className: 'e-de-hyperlink-dlg-title', innerHTML: localValue.getConstant('Text to display') });\n        this.displayTextBox = createElement('input', { id: this.owner.owner.containerId + '_display_text', className: 'e-input e-de-hyperlink-dlg-input' });\n        this.displayTextBox.addEventListener('keyup', instance.onKeyUpOnDisplayBox);\n        container.appendChild(displayText);\n        container.appendChild(this.displayTextBox);\n        this.addressText = createElement('div', { className: 'e-de-hyperlink-dlg-title', innerHTML: localValue.getConstant('Address') });\n        this.urlTextBox = createElement('input', { id: this.owner.owner.containerId + '_url_text', className: 'e-input e-de-hyperlink-dlg-input', attrs: { autofocus: 'true' } });\n        this.urlTextBox.addEventListener('input', instance.onKeyUpOnUrlBox);\n        this.urlTextBox.addEventListener('keyup', instance.onKeyUpOnUrlBox);\n        container.appendChild(this.addressText);\n        container.appendChild(this.urlTextBox);\n        this.bookmarkDiv = createElement('div', { styles: 'display:none;' });\n        var bookmarkText = createElement('div', { className: 'e-de-hyperlink-dlg-title', innerHTML: localValue.getConstant('Bookmark') });\n        var bookmarkTextElement = createElement('div', { className: 'e-de-hyperlink-dlg-bookmark' });\n        // tslint:disable-next-line:max-line-length\n        var bookmarkValue = createElement('input', { id: 'e-de-hyperlink-dlg-bookmark-value' });\n        bookmarkTextElement.appendChild(bookmarkValue);\n        // tslint:disable-next-line:max-line-length\n        this.bookmarkDropdown = new DropDownList({ dataSource: [], change: this.onBookmarkchange, popupHeight: '230px', width: '230px', noRecordsTemplate: localValue.getConstant('No bookmarks found') });\n        this.bookmarkDropdown.appendTo(bookmarkValue);\n        this.bookmarkDiv.appendChild(bookmarkText);\n        this.bookmarkDiv.appendChild(bookmarkTextElement);\n        container.appendChild(this.bookmarkDiv);\n        // tslint:disable-next-line:max-line-length\n        var bookmarkCheckDiv = createElement('div', { className: 'e-de-hyperlink-bookmark-check e-de-hyperlink-dlg-title' });\n        var bookmarkCheck = createElement('input', { attrs: { type: 'checkbox' }, id: this.target.id + '_bookmark', className: this.target.id + '_bookmarkcheck' });\n        bookmarkCheckDiv.appendChild(bookmarkCheck);\n        this.bookmarkCheckbox = new CheckBox({ label: localValue.getConstant('Use bookmarks'), change: this.onUseBookmarkChange });\n        this.bookmarkCheckbox.appendTo(bookmarkCheck);\n        container.appendChild(bookmarkCheckDiv);\n        this.target.appendChild(container);\n    };\n    /**\n     * @private\n     */\n    HyperlinkDialog.prototype.show = function () {\n        this.localObj = new L10n('documenteditor', this.owner.owner.defaultLocale);\n        this.localObj.setLocale(this.owner.owner.locale);\n        setCulture(this.owner.owner.locale);\n        if (!this.target) {\n            this.initHyperlinkDialog(this.localObj);\n        }\n        this.owner.dialog.header = this.localObj.getConstant('Insert Hyperlink');\n        this.owner.dialog.height = 'auto';\n        this.owner.dialog.width = 'auto';\n        this.owner.dialog.content = this.target;\n        this.owner.dialog.buttons = [{\n                click: this.onInsertButtonClick,\n                buttonModel: { content: this.localObj.getConstant('Ok'), cssClass: 'e-flat e-hyper-insert', isPrimary: true }\n            },\n            {\n                click: this.onCancelButtonClick,\n                buttonModel: { content: this.localObj.getConstant('Cancel'), cssClass: 'e-flat e-hyper-cancel' }\n            }];\n        this.owner.dialog.dataBind();\n        this.owner.dialog.beforeOpen = this.loadHyperlinkDialog;\n        this.owner.dialog.close = this.closeHyperlinkDialog;\n        this.owner.dialog.show();\n    };\n    /**\n     * @private\n     */\n    HyperlinkDialog.prototype.hide = function () {\n        this.closeHyperlinkDialog();\n    };\n    HyperlinkDialog.prototype.enableOrDisableInsertButton = function () {\n        if (!isNullOrUndefined(this.insertButton)) {\n            // tslint:disable-next-line:max-line-length\n            this.insertButton.disabled = (this.urlTextBox.value === '' || this.displayTextBox.value === '');\n        }\n    };\n    /**\n     * @private\n     */\n    HyperlinkDialog.prototype.onInsertHyperlink = function () {\n        var displayText = this.displayTextBox.value.trim();\n        var address = this.urlTextBox.value.trim();\n        var isBookmark = false;\n        if (!isNullOrUndefined(this.bookmarkDropdown.value) && this.bookmarkDropdown.value !== '') {\n            address = this.bookmarkDropdown.value;\n            isBookmark = true;\n        }\n        if (address === '') {\n            this.owner.dialog.hide();\n            return;\n        }\n        if (displayText === '' && address !== '') {\n            displayText = address;\n        }\n        else {\n            displayText = this.displayTextBox.value;\n        }\n        if (!isNullOrUndefined(this.navigationUrl)) {\n            this.owner.owner.editorModule.editHyperlink(this.owner.selection, address, displayText, isBookmark);\n        }\n        else {\n            var remove = this.owner.selection.text !== displayText && !this.displayTextBox.disabled;\n            this.owner.owner.editorModule.insertHyperlink(address, displayText, remove, isBookmark);\n        }\n        this.owner.dialog.hide();\n        this.navigationUrl = undefined;\n    };\n    /* tslint:enable:no-any */\n    /**\n     * @private\n     */\n    HyperlinkDialog.prototype.clearValue = function () {\n        this.displayTextBox.value = '';\n        this.urlTextBox.value = '';\n        this.displayText = '';\n        this.displayTextBox.disabled = false;\n        this.bookmarks = [];\n    };\n    /**\n     * @private\n     */\n    HyperlinkDialog.prototype.destroy = function () {\n        if (this.displayTextBox) {\n            this.displayTextBox.innerHTML = '';\n            this.displayTextBox = undefined;\n        }\n        if (this.urlTextBox) {\n            this.urlTextBox.parentElement.removeChild(this.urlTextBox);\n            this.urlTextBox = undefined;\n        }\n        this.owner = undefined;\n        if (!isNullOrUndefined(this.target)) {\n            if (this.target.parentElement) {\n                this.target.parentElement.removeChild(this.target);\n            }\n            this.target.innerHTML = '';\n            this.target = undefined;\n        }\n    };\n    return HyperlinkDialog;\n}());\nexport { HyperlinkDialog };\n","import { NumericTextBox } from '@syncfusion/ej2-inputs';\nimport { L10n, createElement, setCulture, isNullOrUndefined } from '@syncfusion/ej2-base';\n/**\n * The Table dialog is used to insert table at selection.\n */\nvar TableDialog = /** @class */ (function () {\n    /**\n     * @private\n     */\n    function TableDialog(viewer) {\n        var _this = this;\n        /**\n         * @private\n         */\n        this.keyUpInsertTable = function (event) {\n            if (event.keyCode === 13) {\n                if (_this.rowsCountBox.value !== '' && _this.columnsCountBox.value !== '') {\n                    _this.onInsertTableClick();\n                }\n            }\n        };\n        /**\n         * @private\n         */\n        this.onCancelButtonClick = function () {\n            _this.owner.dialog.hide();\n        };\n        /**\n         * @private\n         */\n        this.onInsertTableClick = function () {\n            var rowCount = _this.rowValueTextBox.value;\n            var columnCount = _this.columnValueTexBox.value;\n            if (!(isNullOrUndefined(rowCount) && isNullOrUndefined(columnCount))) {\n                _this.owner.owner.editor.insertTable(rowCount, columnCount);\n            }\n            _this.owner.dialog.hide();\n        };\n        this.owner = viewer;\n    }\n    TableDialog.prototype.getModuleName = function () {\n        return 'TableDialog';\n    };\n    /**\n     * @private\n     */\n    TableDialog.prototype.initTableDialog = function (localValue) {\n        var instance = this;\n        var id = this.owner.owner.containerId + '_insert_Table';\n        this.target = createElement('div', { id: id, className: 'e-de-insert-table' });\n        var parentDiv = createElement('div');\n        var columnContainer = createElement('div', {\n            className: 'e-de-insert-table-dlg-sub-header', innerHTML: localValue.getConstant('Number of columns')\n        });\n        var columnValue = createElement('div', { className: 'e-de-insert-table-dlg-input' });\n        this.columnsCountBox = createElement('input', {\n            attrs: { type: 'text' }, id: this.owner.owner.containerId + '_column'\n        });\n        columnValue.appendChild(this.columnsCountBox);\n        var rowContainer = createElement('div', {\n            className: 'e-de-insert-table-dlg-sub-header', innerHTML: localValue.getConstant('Number of rows')\n        });\n        var rowValue = createElement('div', { className: 'e-de-insert-table-dlg-input' });\n        this.rowsCountBox = createElement('input', {\n            attrs: { type: 'text' }, id: this.owner.owner.containerId + 'row'\n        });\n        rowValue.appendChild(this.rowsCountBox);\n        parentDiv.appendChild(columnContainer);\n        parentDiv.appendChild(columnValue);\n        parentDiv.appendChild(rowContainer);\n        parentDiv.appendChild(rowValue);\n        this.target.appendChild(parentDiv);\n        this.columnsCountBox.addEventListener('keyup', instance.keyUpInsertTable);\n        this.rowsCountBox.addEventListener('keyup', instance.keyUpInsertTable);\n        this.rowValueTextBox = new NumericTextBox({\n            format: '#',\n            value: 2,\n            min: 1,\n            max: 32767,\n            enablePersistence: false\n        });\n        this.rowValueTextBox.appendTo(this.rowsCountBox);\n        this.columnValueTexBox = new NumericTextBox({\n            format: '#',\n            value: 2,\n            min: 1,\n            max: 63,\n            enablePersistence: false\n        });\n        this.columnValueTexBox.appendTo(this.columnsCountBox);\n    };\n    /**\n     * @private\n     */\n    TableDialog.prototype.show = function () {\n        var localValue = new L10n('documenteditor', this.owner.owner.defaultLocale);\n        localValue.setLocale(this.owner.owner.locale);\n        setCulture(this.owner.owner.locale);\n        if (!this.target) {\n            this.initTableDialog(localValue);\n        }\n        if (this.owner.selection.caret.style.display !== 'none') {\n            this.owner.selection.caret.style.display = 'none';\n        }\n        this.owner.dialog.header = localValue.getConstant('Insert Table');\n        this.owner.dialog.height = 'auto';\n        this.owner.dialog.width = 'auto';\n        this.owner.dialog.content = this.target;\n        this.owner.dialog.beforeOpen = this.owner.updateFocus;\n        this.owner.dialog.buttons = [{\n                click: this.onInsertTableClick,\n                buttonModel: { content: localValue.getConstant('Ok'), cssClass: 'e-flat e-table-ok', isPrimary: true }\n            },\n            {\n                click: this.onCancelButtonClick,\n                buttonModel: { content: localValue.getConstant('Cancel'), cssClass: 'e-flat e-table-cancel' }\n            }];\n        this.rowValueTextBox.value = 2;\n        this.columnValueTexBox.value = 2;\n        this.owner.dialog.close = this.owner.updateFocus;\n        this.owner.dialog.dataBind();\n        this.owner.dialog.show();\n    };\n    /**\n     * @private\n     */\n    TableDialog.prototype.destroy = function () {\n        if (this.columnsCountBox) {\n            if (this.columnsCountBox.parentElement) {\n                this.columnsCountBox.parentElement.removeChild(this.columnsCountBox);\n            }\n            this.columnsCountBox = undefined;\n        }\n        if (this.rowsCountBox) {\n            if (this.rowsCountBox.parentElement) {\n                this.rowsCountBox.parentElement.removeChild(this.rowsCountBox);\n            }\n            this.rowsCountBox = undefined;\n        }\n        if (this.columnValueTexBox) {\n            this.columnValueTexBox.destroy();\n            this.columnValueTexBox = undefined;\n        }\n        if (this.rowValueTextBox) {\n            this.rowValueTextBox.destroy();\n            this.rowValueTextBox = undefined;\n        }\n        this.columnsCountBox = undefined;\n        this.rowsCountBox = undefined;\n        this.owner = undefined;\n        if (!isNullOrUndefined(this.target)) {\n            if (this.target.parentElement) {\n                this.target.parentElement.removeChild(this.target);\n            }\n            for (var i = 0; i < this.target.childNodes.length; i++) {\n                this.target.removeChild(this.target.childNodes[i]);\n                i--;\n            }\n            this.target = undefined;\n        }\n    };\n    return TableDialog;\n}());\nexport { TableDialog };\n","import { ListView } from '@syncfusion/ej2-lists';\nimport { Button } from '@syncfusion/ej2-buttons';\nimport { createElement, L10n, setCulture } from '@syncfusion/ej2-base';\n/**\n * The Bookmark dialog is used to add, navigate or delete bookmarks.\n */\nvar BookmarkDialog = /** @class */ (function () {\n    /**\n     * @private\n     */\n    function BookmarkDialog(viewer) {\n        var _this = this;\n        this.addBookmark = function () {\n            _this.owner.owner.editorModule.insertBookmark(_this.textBoxInput.value);\n            _this.owner.dialog.hide();\n        };\n        /* tslint:disable:no-any */\n        this.selectHandler = function (args) {\n            _this.textBoxInput.value = args.text;\n            /* tslint:disable:no-any */\n            var value = document.getElementById('bookmark_text_box');\n            value.setSelectionRange(0, args.text.length);\n            value.focus();\n        };\n        this.gotoBookmark = function () {\n            _this.owner.selection.selectBookmark(_this.textBoxInput.value);\n        };\n        this.deleteBookmark = function () {\n            _this.owner.owner.editorModule.deleteBookmark(_this.textBoxInput.value);\n            _this.show();\n        };\n        this.owner = viewer;\n    }\n    /**\n     * @private\n     */\n    BookmarkDialog.prototype.getModuleName = function () {\n        return 'BookmarkDialog';\n    };\n    /**\n     * @private\n     */\n    BookmarkDialog.prototype.initBookmarkDialog = function (localValue, bookmarks) {\n        var instance = this;\n        var id = this.owner.owner.containerId + '_insert_bookmark';\n        this.target = createElement('div', { id: id, className: 'e-de-bookmark' });\n        var headerValue = localValue.getConstant('Bookmark name') + ':';\n        var dlgFields = createElement('div', { innerHTML: headerValue, className: 'e-bookmark-dlgfields' });\n        this.target.appendChild(dlgFields);\n        var commonDiv = createElement('div', { className: 'e-bookmark-common' });\n        this.target.appendChild(commonDiv);\n        var searchDiv = createElement('div', { className: 'e-bookmark-list' });\n        commonDiv.appendChild(searchDiv);\n        var textBoxDiv = createElement('div', { className: 'e-bookmark-textboxdiv' });\n        searchDiv.appendChild(textBoxDiv);\n        // tslint:disable-next-line:max-line-length\n        this.textBoxInput = createElement('input', { className: 'e-input e-bookmark-textbox-input', id: 'bookmark_text_box' });\n        this.textBoxInput.setAttribute('type', 'text');\n        textBoxDiv.appendChild(this.textBoxInput);\n        var listviewDiv = createElement('div', { className: 'e-bookmark-listViewDiv', id: 'bookmark_listview' });\n        searchDiv.appendChild(listviewDiv);\n        var arts = this.owner.bookmarks.keys;\n        this.listviewInstance = new ListView({\n            dataSource: bookmarks,\n            cssClass: 'e-bookmark-listview',\n        });\n        this.listviewInstance.appendTo(listviewDiv);\n        this.listviewInstance.addEventListener('select', this.selectHandler);\n        var buttonDiv = createElement('div', { className: 'e-bookmark-button' });\n        commonDiv.appendChild(buttonDiv);\n        var addbuttonDiv = createElement('div', { className: 'e-bookmark-addbutton' });\n        buttonDiv.appendChild(addbuttonDiv);\n        var addButtonElement = createElement('button', { innerHTML: 'Add', id: 'add' });\n        addbuttonDiv.appendChild(addButtonElement);\n        var addbutton = new Button({ cssClass: 'e-button-custom' });\n        addbutton.appendTo(addButtonElement);\n        addButtonElement.addEventListener('click', this.addBookmark);\n        var deleteButtonDiv = createElement('div', { className: 'e-bookmark-deletebutton' });\n        buttonDiv.appendChild(deleteButtonDiv);\n        var deleteButtonElement = createElement('button', { innerHTML: 'Delete', id: 'delete' });\n        deleteButtonDiv.appendChild(deleteButtonElement);\n        var deletebutton = new Button({ cssClass: 'e-button-custom' });\n        deletebutton.appendTo(deleteButtonElement);\n        deleteButtonElement.addEventListener('click', this.deleteBookmark);\n        var gotoButtonDiv = createElement('div', { className: 'e-bookmark-gotobutton' });\n        buttonDiv.appendChild(gotoButtonDiv);\n        var gotoButtonElement = createElement('button', { innerHTML: 'Go To', id: 'goto' });\n        gotoButtonDiv.appendChild(gotoButtonElement);\n        var gotobutton = new Button({ cssClass: 'e-button-custom' });\n        gotobutton.appendTo(gotoButtonElement);\n        gotoButtonElement.addEventListener('click', this.gotoBookmark);\n    };\n    /**\n     * @private\n     */\n    BookmarkDialog.prototype.show = function () {\n        var bookmarks = this.owner.getBookmarks();\n        var localObj = new L10n('documenteditor', this.owner.owner.defaultLocale);\n        localObj.setLocale(this.owner.owner.locale);\n        setCulture(this.owner.owner.locale);\n        // if (!this.target) {\n        this.initBookmarkDialog(localObj, bookmarks);\n        //}\n        this.owner.dialog.header = 'Bookmark';\n        this.owner.dialog.height = 'auto';\n        this.owner.dialog.width = 'auto';\n        this.owner.dialog.content = this.target;\n        this.owner.dialog.beforeOpen = this.owner.updateFocus;\n        this.owner.dialog.close = this.owner.updateFocus;\n        this.owner.dialog.buttons = [{\n                click: this.removeObjects.bind(this),\n                buttonModel: { content: localObj.getConstant('Cancel'), cssClass: 'e-flat e-hyper-insert', isPrimary: true }\n            }];\n        this.owner.dialog.dataBind();\n        this.owner.dialog.show();\n    };\n    BookmarkDialog.prototype.removeObjects = function () {\n        this.owner.dialog.hide();\n    };\n    /**\n     * @private\n     */\n    BookmarkDialog.prototype.destroy = function () {\n        if (this.textBoxInput) {\n            this.textBoxInput.remove();\n            this.textBoxInput = undefined;\n        }\n        if (this.listviewInstance) {\n            this.listviewInstance.destroy();\n            this.listviewInstance = undefined;\n        }\n    };\n    return BookmarkDialog;\n}());\nexport { BookmarkDialog };\n","import { L10n, setCulture, createElement, isNullOrUndefined } from '@syncfusion/ej2-base';\nimport { CheckBox, Button } from '@syncfusion/ej2-buttons';\nimport { DropDownList } from '@syncfusion/ej2-dropdowns';\nimport { NumericTextBox } from '@syncfusion/ej2-inputs';\nimport { ListView } from '@syncfusion/ej2-lists';\n/**\n * The Table of contents dialog is used to insert or edit table of contents at selection.\n */\nvar TableOfContentsDialog = /** @class */ (function () {\n    /**\n     * @private\n     */\n    function TableOfContentsDialog(viewer) {\n        var _this = this;\n        /**\n         * @private\n         */\n        this.loadTableofContentDialog = function () {\n            _this.owner.updateFocus();\n            _this.pageNumber.checked = true;\n            _this.rightAlign.disabled = false;\n            _this.rightAlign.checked = true;\n            _this.tabLeader.enabled = true;\n            _this.hyperlink.checked = true;\n            _this.style.checked = true;\n            _this.outline.checked = true;\n            _this.outline.disabled = false;\n            _this.showLevel.enabled = true;\n        };\n        /**\n         * @private\n         */\n        this.closeTableOfContentDialog = function () {\n            _this.unWireEventsAndBindings();\n            _this.owner.updateFocus();\n        };\n        /**\n         * @private\n         */\n        this.onCancelButtonClick = function () {\n            _this.owner.dialog.hide();\n            _this.unWireEventsAndBindings();\n        };\n        /* tslint:disable:no-any */\n        this.selectHandler = function (args) {\n            _this.textBoxInput.value = args.text;\n            /* tslint:disable:no-any */\n            var value = document.getElementById('toclist');\n            value.setSelectionRange(0, args.text.length);\n            value.focus();\n        };\n        this.showStyleDialog = function () {\n            if (!isNullOrUndefined(_this.owner.owner.styleDialogModule)) {\n                _this.owner.owner.styleDialogModule.show(_this.textBoxInput.value);\n            }\n        };\n        this.changeShowLevelValue = function (event) {\n            var levels = event.value;\n            var values = [];\n            switch (levels) {\n                case 1:\n                    values = ['1', null, null, null, null, null, null, null, null];\n                    _this.changeByValue(values);\n                    break;\n                case 2:\n                    values = ['1', '2', null, null, null, null, null, null, null];\n                    _this.changeByValue(values);\n                    break;\n                case 3:\n                    values = ['1', '2', '3', null, null, null, null, null, null];\n                    _this.changeByValue(values);\n                    break;\n                case 4:\n                    values = ['1', '2', '3', '4', null, null, null, null, null];\n                    _this.changeByValue(values);\n                    break;\n                case 5:\n                    values = ['1', '2', '3', '4', '5', null, null, null, null];\n                    _this.changeByValue(values);\n                    break;\n                case 6:\n                    values = ['1', '2', '3', '4', '5', '6', null, null, null];\n                    _this.changeByValue(values);\n                    break;\n                case 7:\n                    values = ['1', '2', '3', '4', '5', '6', '7', null, null];\n                    _this.changeByValue(values);\n                    break;\n                case 8:\n                    values = ['1', '2', '3', '4', '5', '6', '7', '8', null];\n                    _this.changeByValue(values);\n                    break;\n                case 9:\n                    values = ['1', '2', '3', '4', '5', '6', '7', '8', '9'];\n                    _this.changeByValue(values);\n                    break;\n            }\n        };\n        this.changeByValue = function (headings) {\n            _this.heading1.value = headings[0];\n            _this.heading2.value = headings[1];\n            _this.heading3.value = headings[2];\n            _this.heading4.value = headings[3];\n            _this.heading5.value = headings[4];\n            _this.heading6.value = headings[5];\n            _this.heading7.value = headings[6];\n            _this.heading8.value = headings[7];\n            _this.heading9.value = headings[8];\n        };\n        this.reset = function () {\n            _this.showLevel.enabled = true;\n            _this.showLevel.value = 3;\n            _this.outline.disabled = false;\n            _this.outline.checked = true;\n            var values = ['1', '2', '3', null, null, null, null, null, null];\n            _this.changeByValue(values);\n            _this.normal.value = null;\n        };\n        this.changeStyle = function (args) {\n            var headingValue = args.srcElement.value;\n            var value = _this.getElementValue(args.srcElement);\n            if (headingValue !== value && headingValue !== '') {\n                _this.showLevel.enabled = false;\n            }\n            else {\n                _this.showLevel.enabled = true;\n                _this.checkLevel();\n            }\n        };\n        this.changeHeadingStyle = function (args) {\n            var headingValue = args.srcElement.value;\n            if (headingValue === '') {\n                _this.showLevel.enabled = true;\n            }\n            else {\n                _this.showLevel.enabled = false;\n            }\n            if (_this.normal === args.srcElement) {\n                _this.outline.checked = false;\n                _this.outline.disabled = true;\n            }\n        };\n        /**\n         * @private\n         */\n        this.changePageNumberValue = function (args) {\n            if (args.checked) {\n                _this.rightAlign.checked = true;\n                _this.rightAlign.disabled = false;\n                _this.tabLeader.enabled = true;\n            }\n            else {\n                _this.rightAlign.disabled = true;\n                _this.tabLeader.enabled = false;\n            }\n        };\n        /**\n         * @private\n         */\n        this.changeRightAlignValue = function (args) {\n            if (args.checked) {\n                _this.tabLeader.enabled = true;\n            }\n            else {\n                _this.tabLeader.enabled = false;\n            }\n        };\n        /**\n         * @private\n         */\n        this.changeStyleValue = function (args) {\n            if (args.checked) {\n                _this.heading1.disabled = false;\n                _this.heading2.disabled = false;\n                _this.heading3.disabled = false;\n                _this.heading4.disabled = false;\n                _this.heading5.disabled = false;\n                _this.heading6.disabled = false;\n                _this.heading7.disabled = false;\n                _this.heading8.disabled = false;\n                _this.heading9.disabled = false;\n                _this.normal.disabled = false;\n            }\n            else {\n                _this.heading1.disabled = true;\n                _this.heading2.disabled = true;\n                _this.heading3.disabled = true;\n                _this.heading4.disabled = true;\n                _this.heading5.disabled = true;\n                _this.heading6.disabled = true;\n                _this.heading7.disabled = true;\n                _this.heading8.disabled = true;\n                _this.heading9.disabled = true;\n                _this.normal.disabled = true;\n            }\n        };\n        /**\n         * @private\n         */\n        this.applyTableOfContentProperties = function () {\n            var tocSettings = {\n                startLevel: 1,\n                endLevel: _this.showLevel.value,\n                includeHyperlink: _this.hyperlink.checked,\n                includePageNumber: _this.pageNumber.checked,\n                rightAlign: _this.rightAlign.checked,\n                tabLeader: _this.tabLeader.value,\n                includeOutlineLevels: _this.outline.checked\n            };\n            _this.applyLevelSetting(tocSettings);\n            _this.owner.owner.editorModule.insertTableOfContents(tocSettings);\n            _this.owner.dialog.hide();\n        };\n        /**\n         * @private\n         */\n        this.unWireEventsAndBindings = function () {\n            _this.pageNumber.checked = false;\n            _this.rightAlign.checked = false;\n            _this.tabLeader.value = '';\n            _this.hyperlink.checked = false;\n            _this.style.checked = false;\n            _this.outline.checked = false;\n            _this.normal.value = '';\n        };\n        this.owner = viewer;\n    }\n    TableOfContentsDialog.prototype.getModuleName = function () {\n        return 'TableOfContentsDialog';\n    };\n    /*tslint:disable max-func-body-length*/\n    /**\n     * @private\n     */\n    TableOfContentsDialog.prototype.initTableOfContentDialog = function (locale) {\n        var instance = this;\n        var ownerId = this.owner.owner.containerId;\n        var id = ownerId + '_toc_dialog';\n        this.target = createElement('div', { id: id, className: 'e-de-toc-dlg-container' });\n        this.owner.owner.element.appendChild(this.target);\n        // tslint:disable-next-line:max-line-length\n        var generalDiv = createElement('div', { id: 'general_div', className: 'e-de-toc-dlg-sub-container' });\n        this.target.appendChild(generalDiv);\n        // tslint:disable-next-line:max-line-length\n        var genLabel = createElement('div', { id: ownerId + '_genLabel', className: 'e-de-toc-dlg-main-heading', styles: 'margin-bottom: 13px;', innerHTML: locale.getConstant('General') });\n        generalDiv.appendChild(genLabel);\n        // tslint:disable-next-line:max-line-length\n        var leftGeneralDiv = createElement('div', { id: 'left_general', styles: 'float:left;position:relative;' });\n        generalDiv.appendChild(leftGeneralDiv);\n        // tslint:disable-next-line:max-line-length\n        var rightGeneralDiv = createElement('div', { styles: 'position:relative;', className: 'e-de-toc-dlg-right-general-div' });\n        generalDiv.appendChild(rightGeneralDiv);\n        // tslint:disable-next-line:max-line-length\n        var leftBottomGeneralDiv = createElement('div', { id: 'leftBottom_general', styles: 'float:left;position:absolute;top:210px;' });\n        generalDiv.appendChild(leftBottomGeneralDiv);\n        // tslint:disable-next-line:max-line-length\n        var rightBottomGeneralDiv = createElement('div', { className: 'e-de-toc-dlg-right-sub-container', styles: 'float:right;' });\n        generalDiv.appendChild(rightBottomGeneralDiv);\n        // tslint:disable-next-line:max-line-length\n        var pageNumberDiv = createElement('div', { id: 'pageNumber_div', className: 'e-de-toc-dlg-sub-container' });\n        var pageNumber = createElement('input', {\n            attrs: { 'type': 'checkbox' }, id: this.target.id + '_pageNumber'\n        });\n        pageNumberDiv.appendChild(pageNumber);\n        // tslint:disable-next-line:max-line-length\n        var rightAlignDiv = createElement('div', { id: 'rightAlign_div', className: 'e-de-toc-dlg-sub-container' });\n        var rightAlign = createElement('input', {\n            attrs: { 'type': 'checkbox' }, id: this.target.id + '_rightAlign'\n        });\n        rightAlignDiv.appendChild(rightAlign);\n        // tslint:disable-next-line:max-line-length\n        this.pageNumber = new CheckBox({ label: locale.getConstant('Show page numbers'), checked: true, change: this.changePageNumberValue });\n        // tslint:disable-next-line:max-line-length\n        this.rightAlign = new CheckBox({ label: locale.getConstant('Right align page numbers'), checked: true, change: this.changeRightAlignValue });\n        this.pageNumber.appendTo(pageNumber);\n        this.rightAlign.appendTo(rightAlign);\n        var tabDiv = createElement('div', { id: 'tab_div', className: 'e-de-toc-dlg-tab-div' });\n        // tslint:disable-next-line:max-line-length\n        var tabLeaderLabelDiv = createElement('div', { id: 'tabLeaderLabel_div' });\n        // tslint:disable-next-line:max-line-length\n        var tabLeaderLabel = createElement('label', { id: ownerId + '_tabLeaderLabel', className: 'e-de-toc-dlg-heading', innerHTML: locale.getConstant('Tab leader') + ':' });\n        tabLeaderLabelDiv.appendChild(tabLeaderLabel);\n        var tabLeaderDiv = createElement('div', { id: 'tabLeader_div' });\n        var tabLeader = createElement('select', {\n            id: ownerId + '_tabLeader',\n            innerHTML: '<option value=\"None\">' + '(' + locale.getConstant('None').toLocaleLowerCase() + ')' +\n                '</option><option value=\"Dot\" selected>' + '....................' +\n                '</option><option value=\"Hyphen\">' + '-------------------' +\n                '</option><option value=\"Underscore\">' + '____________' + '</option>'\n        });\n        tabLeaderDiv.appendChild(tabLeader);\n        tabDiv.appendChild(tabLeaderLabelDiv);\n        tabDiv.appendChild(tabLeaderDiv);\n        leftGeneralDiv.appendChild(pageNumberDiv);\n        leftGeneralDiv.appendChild(rightAlignDiv);\n        leftGeneralDiv.appendChild(tabDiv);\n        this.tabLeader = new DropDownList({ width: 210 });\n        this.tabLeader.appendTo(tabLeader);\n        var hyperlink = createElement('input', {\n            attrs: { 'type': 'checkbox' }, id: this.target.id + '_hyperlink'\n        });\n        rightGeneralDiv.appendChild(hyperlink);\n        this.hyperlink = new CheckBox({ label: locale.getConstant('Use hyperlinks instead of page numbers'), checked: true });\n        this.hyperlink.appendTo(hyperlink);\n        // tslint:disable-next-line:max-line-length\n        var showDiv = createElement('div', { id: 'show_div', className: 'e-de-toc-dlg-style-label' });\n        // tslint:disable-next-line:max-line-length\n        var showLevelLabelDiv = createElement('div', { id: 'showLevelLabel_div', className: 'e-de-toc-dlg-show-level-div' });\n        // tslint:disable-next-line:max-line-length\n        var showLevelLabel = createElement('label', { id: ownerId + '_showLevelLabel', className: 'e-de-toc-dlg-heading', innerHTML: locale.getConstant('Show levels') + ':' });\n        showLevelLabelDiv.appendChild(showLevelLabel);\n        // tslint:disable-next-line:max-line-length\n        var showLevelDiv = createElement('div', { id: 'showLevel_div', className: 'e-de-toc-dlg-showlevel-div' });\n        // tslint:disable-next-line:max-line-length\n        var showLevel = createElement('input', { id: ownerId + '_showLevel', attrs: { 'type': 'text' } });\n        showLevelDiv.appendChild(showLevel);\n        showDiv.appendChild(showLevelLabelDiv);\n        showDiv.appendChild(showLevelDiv);\n        rightGeneralDiv.appendChild(showDiv);\n        this.showLevel = new NumericTextBox({ format: '#', value: 3, min: 1, max: 9, width: 210, change: this.changeShowLevelValue });\n        this.showLevel.appendTo(showLevel);\n        // tslint:disable-next-line:max-line-length\n        var buildTableDiv = createElement('div', { id: 'buildTable_div', className: 'e-de-toc-dlg-sub-container' });\n        // tslint:disable-next-line:max-line-length\n        var buildTableLabel = createElement('div', { id: ownerId + '_buildTableLabel', className: 'e-de-toc-dlg-main-heading e-de-toc-dlg-build-table', styles: 'margin-bottom: 13px;', innerHTML: locale.getConstant('Build table of contents from') + ':' });\n        leftBottomGeneralDiv.appendChild(buildTableDiv);\n        leftBottomGeneralDiv.appendChild(buildTableLabel);\n        var style = createElement('input', {\n            attrs: { 'type': 'checkbox' }, id: this.target.id + '_style',\n        });\n        leftBottomGeneralDiv.appendChild(style);\n        this.style = new CheckBox({ label: locale.getConstant('Styles'), checked: true, change: this.changeStyleValue });\n        this.style.appendTo(style);\n        var table = createElement('TABLE', { styles: 'margin-top:3px;' });\n        var tr1 = createElement('tr');\n        var td1 = createElement('td', { styles: 'width:120px;padding-left:10px;' });\n        var availableLabel = createElement('label', {\n            // tslint:disable-next-line:max-line-length\n            innerHTML: locale.getConstant('Available styles'), className: 'e-de-toc-dlg-main-heading e-de-toc-dlg-sub-level-heading', id: this.target.id + '_availableLabel'\n        });\n        td1.appendChild(availableLabel);\n        var td2 = createElement('td');\n        var tocLabel = createElement('label', {\n            innerHTML: locale.getConstant('TOC level') + ':', className: 'e-de-toc-dlg-main-heading e-de-toc-dlg-sub-level-heading',\n            id: this.target.id + '_tocLabel'\n        });\n        td2.appendChild(tocLabel);\n        tr1.appendChild(td1);\n        tr1.appendChild(td2);\n        table.appendChild(tr1);\n        // tslint:disable-next-line:max-line-length\n        var tableDiv = createElement('div', { id: 'table_div', className: 'e-de-toc-table-div' });\n        var table1 = createElement('TABLE');\n        var tr2 = createElement('tr');\n        var td3 = createElement('td');\n        var heading1Label = createElement('label', {\n            innerHTML: locale.getConstant('Heading') + ' 1',\n            className: 'e-de-toc-dlg-sub-heading', id: this.target.id + '_heading1Label'\n        });\n        td3.appendChild(heading1Label);\n        var td4 = createElement('td');\n        this.heading1 = createElement('input', { id: '_heading1', className: 'e-input e-de-toc-dlg-toc-level' });\n        this.heading1.value = '1';\n        this.heading1.addEventListener('keyup', this.changeStyle);\n        td4.appendChild(this.heading1);\n        tr2.appendChild(td3);\n        tr2.appendChild(td4);\n        var tr3 = createElement('tr');\n        var td5 = createElement('td');\n        var heading2Label = createElement('label', {\n            innerHTML: locale.getConstant('Heading') + ' 2',\n            className: 'e-de-toc-dlg-sub-heading', id: this.target.id + '_heading2Label'\n        });\n        td5.appendChild(heading2Label);\n        var td6 = createElement('td');\n        this.heading2 = createElement('input', { id: '_heading2', className: 'e-input e-de-toc-dlg-toc-level' });\n        this.heading2.value = '2';\n        this.heading2.addEventListener('keyup', this.changeStyle);\n        td6.appendChild(this.heading2);\n        tr3.appendChild(td5);\n        tr3.appendChild(td6);\n        var tr4 = createElement('tr');\n        var td7 = createElement('td');\n        var heading3Label = createElement('label', {\n            innerHTML: locale.getConstant('Heading') + ' 3',\n            className: 'e-de-toc-dlg-sub-heading', id: this.target.id + '_heading3Label'\n        });\n        td7.appendChild(heading3Label);\n        var td8 = createElement('td');\n        this.heading3 = createElement('input', { id: '_heading3', className: 'e-input e-de-toc-dlg-toc-level' });\n        this.heading3.value = '3';\n        this.heading3.addEventListener('keyup', this.changeStyle);\n        td8.appendChild(this.heading3);\n        tr4.appendChild(td7);\n        tr4.appendChild(td8);\n        var tr5 = createElement('tr');\n        var td9 = createElement('td');\n        var heading4Label = createElement('label', {\n            innerHTML: locale.getConstant('Heading') + ' 4',\n            className: 'e-de-toc-dlg-sub-heading', id: this.target.id + '_heading4Label'\n        });\n        td9.appendChild(heading4Label);\n        var td10 = createElement('td');\n        this.heading4 = createElement('input', { id: '_heading4', className: 'e-input e-de-toc-dlg-toc-level' });\n        this.heading4.addEventListener('keyup', this.changeStyle);\n        td10.appendChild(this.heading4);\n        tr5.appendChild(td9);\n        tr5.appendChild(td10);\n        var tr6 = createElement('tr');\n        var td11 = createElement('td');\n        var heading5Label = createElement('label', {\n            innerHTML: locale.getConstant('Heading') + ' 5',\n            className: 'e-de-toc-dlg-sub-heading', id: this.target.id + '_heading5Label'\n        });\n        td11.appendChild(heading5Label);\n        var td12 = createElement('td');\n        this.heading5 = createElement('input', { id: '_heading5', className: 'e-input e-de-toc-dlg-toc-level' });\n        this.heading5.addEventListener('keyup', this.changeStyle);\n        td12.appendChild(this.heading5);\n        tr6.appendChild(td11);\n        tr6.appendChild(td12);\n        var tr7 = createElement('tr');\n        var td13 = createElement('td');\n        var heading6Label = createElement('label', {\n            innerHTML: locale.getConstant('Heading') + ' 6',\n            className: 'e-de-toc-dlg-sub-heading', id: this.target.id + '_heading6Label'\n        });\n        td13.appendChild(heading6Label);\n        var td14 = createElement('td');\n        this.heading6 = createElement('input', { id: '_heading6', className: 'e-input e-de-toc-dlg-toc-level' });\n        this.heading6.addEventListener('keyup', this.changeStyle);\n        td14.appendChild(this.heading6);\n        tr7.appendChild(td13);\n        tr7.appendChild(td14);\n        var tr8 = createElement('tr');\n        var td15 = createElement('td');\n        var heading7Label = createElement('label', {\n            innerHTML: locale.getConstant('Heading') + ' 7',\n            className: 'e-de-toc-dlg-sub-heading', id: this.target.id + '_heading7Label'\n        });\n        td15.appendChild(heading7Label);\n        var td16 = createElement('td');\n        this.heading7 = createElement('input', { id: '_heading7', className: 'e-input e-de-toc-dlg-toc-level' });\n        this.heading7.addEventListener('keyup', this.changeStyle);\n        td16.appendChild(this.heading7);\n        tr8.appendChild(td15);\n        tr8.appendChild(td16);\n        var tr9 = createElement('tr');\n        var td17 = createElement('td');\n        var heading8Label = createElement('label', {\n            innerHTML: locale.getConstant('Heading') + ' 8',\n            className: 'e-de-toc-dlg-sub-heading', id: this.target.id + '_heading8Label'\n        });\n        td17.appendChild(heading8Label);\n        var td18 = createElement('td');\n        this.heading8 = createElement('input', { id: '_heading8', className: 'e-input e-de-toc-dlg-toc-level' });\n        this.heading8.addEventListener('keyup', this.changeStyle);\n        td18.appendChild(this.heading8);\n        tr9.appendChild(td17);\n        tr9.appendChild(td18);\n        var tr10 = createElement('tr');\n        var td19 = createElement('td');\n        var heading9Label = createElement('label', {\n            innerHTML: locale.getConstant('Heading') + ' 9',\n            className: 'e-de-toc-dlg-sub-heading', id: this.target.id + '_heading9Label'\n        });\n        td19.appendChild(heading9Label);\n        var td20 = createElement('td');\n        this.heading9 = createElement('input', { id: '_heading9', className: 'e-input e-de-toc-dlg-toc-level' });\n        this.heading9.addEventListener('keyup', this.changeStyle);\n        td20.appendChild(this.heading9);\n        tr10.appendChild(td19);\n        tr10.appendChild(td20);\n        var tr12 = createElement('tr');\n        var td23 = createElement('td');\n        var normalLabel = createElement('label', {\n            innerHTML: locale.getConstant('Normal'),\n            className: 'e-de-toc-dlg-sub-heading', id: this.target.id + '_normalLabel'\n        });\n        td23.appendChild(normalLabel);\n        var td24 = createElement('td');\n        this.normal = createElement('input', { id: '_normal', className: 'e-input e-de-toc-dlg-toc-level' });\n        this.normal.addEventListener('keyup', this.changeHeadingStyle);\n        td24.appendChild(this.normal);\n        tr12.appendChild(td23);\n        tr12.appendChild(td24);\n        table1.appendChild(tr2);\n        table1.appendChild(tr3);\n        table1.appendChild(tr4);\n        table1.appendChild(tr5);\n        table1.appendChild(tr6);\n        table1.appendChild(tr7);\n        table1.appendChild(tr8);\n        table1.appendChild(tr9);\n        table1.appendChild(tr10);\n        table1.appendChild(tr12);\n        tableDiv.appendChild(table1);\n        var stylesLevelDiv = createElement('div', { className: 'e-de-toc-styles-table-div' });\n        stylesLevelDiv.appendChild(table);\n        stylesLevelDiv.appendChild(tableDiv);\n        leftBottomGeneralDiv.appendChild(stylesLevelDiv);\n        //leftBottomGeneralDiv.appendChild(table); leftBottomGeneralDiv.appendChild(tableDiv);\n        var fieldsDiv = createElement('div', { id: 'fields_div', styles: 'display: flex;' });\n        leftBottomGeneralDiv.appendChild(fieldsDiv);\n        var outDiv = createElement('div', { id: 'out_div' });\n        // tslint:disable-next-line:max-line-length\n        var outlineDiv = createElement('div', { id: 'outline_div', className: 'e-de-toc-dlg-sub-container e-de-toc-dlg-outline-levels' });\n        var outline = createElement('input', {\n            attrs: { 'type': 'checkbox' }, id: '_outline'\n        });\n        outlineDiv.appendChild(outline);\n        outDiv.appendChild(outlineDiv);\n        fieldsDiv.appendChild(outDiv);\n        this.outline = new CheckBox({ label: locale.getConstant('Outline levels'), checked: true });\n        this.outline.appendTo(outline);\n        var resetButtonDiv = createElement('div', { className: 'e-de-toc-reset-button' });\n        fieldsDiv.appendChild(resetButtonDiv);\n        var resetElement = createElement('button', { innerHTML: 'Reset', id: 'reset' });\n        resetButtonDiv.appendChild(resetElement);\n        var resetButton = new Button({ cssClass: 'e-btn e-flat' });\n        resetButton.appendTo(resetElement);\n        resetElement.addEventListener('click', this.reset);\n        // tslint:disable-next-line:max-line-length\n        var tocStylesDiv = createElement('div', { id: 'tocStyles_div', className: 'e-de-toc-dlg-sub-container' });\n        // tslint:disable-next-line:max-line-length\n        var tocStylesLabel = createElement('div', {\n            id: ownerId + '_tocStylesLabel', className: 'e-de-toc-dlg-main-heading e-de-toc-dlg-styles',\n            innerHTML: locale.getConstant('Styles') + ':'\n        });\n        rightBottomGeneralDiv.appendChild(tocStylesDiv);\n        rightBottomGeneralDiv.appendChild(tocStylesLabel);\n        var textBoxDiv = createElement('div', { className: 'e-de-toc-dlg-style-input' });\n        rightBottomGeneralDiv.appendChild(textBoxDiv);\n        this.textBoxInput = createElement('input', { className: 'e-input', id: 'toclist' });\n        this.textBoxInput.setAttribute('type', 'text');\n        textBoxDiv.appendChild(this.textBoxInput);\n        var listViewDiv = createElement('div', { className: 'e-de-toc-list-view' });\n        var styleValues = ['TOC 1', 'TOC 2', 'TOC 3', 'TOC 4', 'TOC 5', 'TOC 6', 'TOC 7', 'TOC 8', 'TOC 9'];\n        this.listViewInstance = new ListView({ dataSource: styleValues, cssClass: 'e-toc-list-view' });\n        this.listViewInstance.appendTo(listViewDiv);\n        this.listViewInstance.addEventListener('select', this.selectHandler);\n        rightBottomGeneralDiv.appendChild(listViewDiv);\n        var modifyButtonDiv = createElement('div', { className: 'e-de-toc-modify-button' });\n        rightBottomGeneralDiv.appendChild(modifyButtonDiv);\n        var modifyElement = createElement('button', { innerHTML: 'Modify', id: 'modify' });\n        modifyButtonDiv.appendChild(modifyElement);\n        var modifyButton = new Button({ cssClass: 'e-btn e-flat' });\n        modifyButton.appendTo(modifyElement);\n        modifyElement.addEventListener('click', this.showStyleDialog);\n    };\n    /**\n     * @private\n     */\n    TableOfContentsDialog.prototype.show = function () {\n        var localValue = new L10n('documenteditor', this.owner.owner.defaultLocale);\n        localValue.setLocale(this.owner.owner.locale);\n        setCulture(this.owner.owner.locale);\n        if (!this.target) {\n            this.initTableOfContentDialog(localValue);\n        }\n        this.owner.dialog.header = localValue.getConstant('Table of Contents');\n        this.owner.dialog.width = 'auto';\n        this.owner.dialog.height = 'auto';\n        this.owner.dialog.content = this.target;\n        this.owner.dialog.beforeOpen = this.loadTableofContentDialog;\n        this.owner.dialog.close = this.closeTableOfContentDialog;\n        this.owner.dialog.buttons = [{\n                click: this.applyTableOfContentProperties,\n                buttonModel: { content: localValue.getConstant('Ok'), cssClass: 'e-flat e-toc-okay', isPrimary: true }\n            },\n            {\n                click: this.onCancelButtonClick,\n                buttonModel: { content: localValue.getConstant('Cancel'), cssClass: 'e-flat e-toc-cancel' }\n            }];\n        this.owner.dialog.dataBind();\n        this.owner.dialog.show();\n    };\n    TableOfContentsDialog.prototype.checkLevel = function () {\n        if (this.heading1.value !== '') {\n            this.showLevel.value = 1;\n        }\n        if (this.heading2.value !== '') {\n            this.showLevel.value = 2;\n        }\n        if (this.heading3.value !== '') {\n            this.showLevel.value = 3;\n        }\n        if (this.heading4.value !== '') {\n            this.showLevel.value = 4;\n        }\n        if (this.heading5.value !== '') {\n            this.showLevel.value = 5;\n        }\n        if (this.heading6.value !== '') {\n            this.showLevel.value = 6;\n        }\n        if (this.heading7.value !== '') {\n            this.showLevel.value = 7;\n        }\n        if (this.heading8.value !== '') {\n            this.showLevel.value = 8;\n        }\n        if (this.heading9.value !== '') {\n            this.showLevel.value = 9;\n        }\n    };\n    TableOfContentsDialog.prototype.getElementValue = function (element) {\n        switch (element) {\n            case this.heading1:\n                return '1';\n            case this.heading2:\n                return '2';\n            case this.heading3:\n                return '3';\n            case this.heading4:\n                return '4';\n            case this.heading5:\n                return '5';\n            case this.heading6:\n                return '6';\n            case this.heading7:\n                return '7';\n            case this.heading8:\n                return '8';\n            case this.heading9:\n                return '9';\n            default:\n                return '1';\n        }\n    };\n    TableOfContentsDialog.prototype.getHeadingLevel = function (index) {\n        switch (index) {\n            case 1:\n                return parseInt(this.heading1.value);\n            case 2:\n                return parseInt(this.heading2.value);\n            case 3:\n                return parseInt(this.heading3.value);\n            case 4:\n                return parseInt(this.heading4.value);\n            case 5:\n                return parseInt(this.heading5.value);\n            case 6:\n                return parseInt(this.heading6.value);\n            case 7:\n                return parseInt(this.heading7.value);\n            case 8:\n                return parseInt(this.heading8.value);\n            case 9:\n                return parseInt(this.heading9.value);\n            default:\n                return 0;\n        }\n    };\n    TableOfContentsDialog.prototype.applyLevelSetting = function (tocSettings) {\n        tocSettings.levelSettings = {};\n        var headingPrefix = 'Heading ';\n        var newStartLevel = 0;\n        var newEndLevel = 0;\n        var isEndLevel = false;\n        for (var i = 1; i <= tocSettings.endLevel; i++) {\n            var outlineLevel = this.getHeadingLevel(i);\n            if (i === outlineLevel) {\n                if (newStartLevel === 0) {\n                    newStartLevel = i;\n                    isEndLevel = false;\n                }\n                if (!isEndLevel) {\n                    newEndLevel = i;\n                }\n            }\n            else {\n                isEndLevel = true;\n                if (outlineLevel !== 0) {\n                    var headingStyle = headingPrefix + i.toString();\n                    tocSettings.levelSettings[headingStyle] = outlineLevel;\n                }\n            }\n        }\n        tocSettings.startLevel = newStartLevel;\n        tocSettings.endLevel = newEndLevel;\n        if (this.normal.value !== '') {\n            tocSettings.levelSettings['Normal'] = +this.normal.value;\n        }\n    };\n    /**\n     * @private\n     */\n    TableOfContentsDialog.prototype.destroy = function () {\n        if (this.pageNumber) {\n            this.pageNumber.destroy();\n            this.pageNumber = undefined;\n        }\n        if (this.rightAlign) {\n            this.rightAlign.destroy();\n            this.rightAlign = undefined;\n        }\n        if (this.tabLeader) {\n            this.tabLeader.destroy();\n            this.tabLeader = undefined;\n        }\n        if (this.showLevel) {\n            this.showLevel.destroy();\n            this.showLevel = undefined;\n        }\n        if (this.hyperlink) {\n            this.hyperlink.destroy();\n            this.hyperlink = undefined;\n        }\n        if (this.style) {\n            this.style.destroy();\n            this.style = undefined;\n        }\n        if (this.outline) {\n            this.outline.destroy();\n            this.outline = undefined;\n        }\n        if (this.listViewInstance) {\n            this.listViewInstance.destroy();\n            this.listViewInstance = undefined;\n        }\n        this.heading1 = undefined;\n        this.heading2 = undefined;\n        this.heading3 = undefined;\n        this.heading4 = undefined;\n        this.heading5 = undefined;\n        this.heading6 = undefined;\n        this.heading7 = undefined;\n        this.heading8 = undefined;\n        this.heading9 = undefined;\n        this.normal = undefined;\n        this.textBoxInput = undefined;\n        this.owner = undefined;\n        if (!isNullOrUndefined(this.target)) {\n            if (this.target.parentElement) {\n                this.target.parentElement.removeChild(this.target);\n            }\n            for (var count = 0; count < this.target.childNodes.length; count++) {\n                this.target.removeChild(this.target.childNodes[count]);\n                count--;\n            }\n            this.target = undefined;\n        }\n    };\n    return TableOfContentsDialog;\n}());\nexport { TableOfContentsDialog };\n","import { NumericTextBox } from '@syncfusion/ej2-inputs';\nimport { createElement, L10n, setCulture } from '@syncfusion/ej2-base';\nimport { DropDownList } from '@syncfusion/ej2-dropdowns';\nimport { CheckBox, RadioButton } from '@syncfusion/ej2-buttons';\nimport { isNullOrUndefined } from '@syncfusion/ej2-base';\nimport { WSectionFormat } from './../../implementation/format/index';\nimport { Tab } from '@syncfusion/ej2-navigations';\n/**\n * The Page setup dialog is used to modify formatting of selected sections.\n */\nvar PageSetupDialog = /** @class */ (function () {\n    /**\n     * @private\n     */\n    function PageSetupDialog(viewer) {\n        var _this = this;\n        this.isPortrait = true;\n        /**\n         * @private\n         */\n        this.loadPageSetupDialog = function () {\n            _this.owner.updateFocus();\n            var sectionFormat = _this.owner.selection.sectionFormat;\n            _this.topMarginBox.value = sectionFormat.topMargin;\n            _this.leftMarginBox.value = sectionFormat.leftMargin;\n            _this.bottomMarginBox.value = sectionFormat.bottomMargin;\n            _this.rightMarginBox.value = sectionFormat.rightMargin;\n            _this.widthBox.value = sectionFormat.pageWidth;\n            _this.heightBox.value = sectionFormat.pageHeight;\n            _this.checkBox1.checked = sectionFormat.differentOddAndEvenPages;\n            _this.checkBox2.checked = sectionFormat.differentFirstPage;\n            _this.headerBox.value = sectionFormat.headerDistance;\n            _this.footerBox.value = sectionFormat.footerDistance;\n            if (_this.widthBox.value > _this.heightBox.value) {\n                _this.landscape.checked = true;\n            }\n            else {\n                _this.portrait.checked = true;\n            }\n        };\n        /**\n         * @private\n         */\n        this.closePageSetupDialog = function () {\n            _this.unWireEventsAndBindings();\n            _this.owner.updateFocus();\n        };\n        /**\n         * @private\n         */\n        this.onCancelButtonClick = function () {\n            _this.owner.dialog.hide();\n            _this.unWireEventsAndBindings();\n        };\n        /**\n         * @private\n         */\n        this.keyUpInsertPageSettings = function (event) {\n            if (event.keyCode === 13) {\n                _this.applyPageSetupProperties();\n            }\n        };\n        /**\n         * @private\n         */\n        this.applyPageSetupProperties = function () {\n            var sectionFormat = new WSectionFormat();\n            sectionFormat.bottomMargin = _this.bottomMarginBox.value;\n            sectionFormat.topMargin = _this.topMarginBox.value;\n            sectionFormat.leftMargin = _this.leftMarginBox.value;\n            sectionFormat.rightMargin = _this.rightMarginBox.value;\n            sectionFormat.pageWidth = _this.widthBox.value;\n            sectionFormat.pageHeight = _this.heightBox.value;\n            sectionFormat.differentOddAndEvenPages = _this.checkBox1.checked;\n            sectionFormat.differentFirstPage = _this.checkBox2.checked;\n            sectionFormat.headerDistance = _this.headerBox.value;\n            sectionFormat.footerDistance = _this.footerBox.value;\n            _this.owner.owner.editorModule.onApplySectionFormat(undefined, sectionFormat);\n            _this.owner.dialog.hide();\n        };\n        /**\n         * @private\n         */\n        this.changeByPaperSize = function (event) {\n            var value = event.value;\n            var sectionFormat = _this.owner.selection.sectionFormat;\n            var width = sectionFormat.pageWidth;\n            var height = sectionFormat.pageHeight;\n            if (_this.owner.selection.sectionFormat.pageWidth > _this.owner.selection.sectionFormat.pageHeight || _this.landscape.checked) {\n                _this.isPortrait = false;\n            }\n            else {\n                _this.isPortrait = true;\n            }\n            if (value === 'letter') {\n                if (_this.isPortrait) {\n                    _this.widthBox.value = 612;\n                    _this.heightBox.value = 792;\n                }\n                else {\n                    _this.widthBox.value = 792;\n                    _this.heightBox.value = 612;\n                }\n            }\n            else if (value === 'tabloid') {\n                if (_this.isPortrait) {\n                    _this.widthBox.value = 792;\n                    _this.heightBox.value = 1224;\n                }\n                else {\n                    _this.widthBox.value = 1224;\n                    _this.heightBox.value = 792;\n                }\n            }\n            else if (value === 'legal') {\n                if (_this.isPortrait) {\n                    _this.widthBox.value = 612;\n                    _this.heightBox.value = 1008;\n                }\n                else {\n                    _this.widthBox.value = 1008;\n                    _this.heightBox.value = 612;\n                }\n            }\n            else if (value === 'statement') {\n                if (_this.isPortrait) {\n                    _this.widthBox.value = 392;\n                    _this.heightBox.value = 612;\n                }\n                else {\n                    _this.widthBox.value = 612;\n                    _this.heightBox.value = 392;\n                }\n            }\n            else if (value === 'executive') {\n                if (_this.isPortrait) {\n                    _this.widthBox.value = 522;\n                    _this.heightBox.value = 756;\n                }\n                else {\n                    _this.widthBox.value = 756;\n                    _this.heightBox.value = 522;\n                }\n            }\n            else if (value === 'a3') {\n                if (_this.isPortrait) {\n                    _this.widthBox.value = 841.9;\n                    _this.heightBox.value = 1190.55;\n                }\n                else {\n                    _this.widthBox.value = 1190.55;\n                    _this.heightBox.value = 841.9;\n                }\n            }\n            else if (value === 'a4') {\n                if (_this.isPortrait) {\n                    _this.widthBox.value = 595.3;\n                    _this.heightBox.value = 841.9;\n                }\n                else {\n                    _this.widthBox.value = 841.9;\n                    _this.heightBox.value = 595.3;\n                }\n            }\n            else if (value === 'a5') {\n                if (_this.isPortrait) {\n                    _this.widthBox.value = 419.55;\n                    _this.heightBox.value = 595.3;\n                }\n                else {\n                    _this.widthBox.value = 595.3;\n                    _this.heightBox.value = 419.55;\n                }\n            }\n            else if (value === 'b4') {\n                if (_this.isPortrait) {\n                    _this.widthBox.value = 728.5;\n                    _this.heightBox.value = 1031.8;\n                }\n                else {\n                    _this.widthBox.value = 1031.8;\n                    _this.heightBox.value = 728.5;\n                }\n            }\n            else if (value === 'b5') {\n                if (_this.isPortrait) {\n                    _this.widthBox.value = 515.9;\n                    _this.heightBox.value = 728.5;\n                }\n                else {\n                    _this.widthBox.value = 728.5;\n                    _this.heightBox.value = 515.9;\n                }\n            }\n            else if (value === 'customsize') {\n                if (_this.isPortrait) {\n                    _this.widthBox.value = 515.9;\n                    _this.heightBox.value = 728.5;\n                }\n                else {\n                    _this.widthBox.value = 728.5;\n                    _this.heightBox.value = 515.9;\n                }\n            }\n        };\n        /**\n         * @private\n         */\n        this.onPortrait = function (event) {\n            _this.landscape.checked = false;\n            var width = _this.widthBox.value;\n            var height = _this.heightBox.value;\n            if (width > height) {\n                _this.widthBox.value = height;\n                _this.heightBox.value = width;\n            }\n        };\n        /**\n         * @private\n         */\n        this.onLandscape = function (event) {\n            _this.portrait.checked = false;\n            var width = _this.widthBox.value;\n            var height = _this.heightBox.value;\n            if (width < height) {\n                _this.widthBox.value = height;\n                _this.heightBox.value = width;\n            }\n        };\n        /**\n         * @private\n         */\n        this.unWireEventsAndBindings = function () {\n            _this.paperSize.value = undefined;\n            _this.topMarginBox.value = undefined;\n            _this.bottomMarginBox.value = undefined;\n            _this.leftMarginBox.value = undefined;\n            _this.rightMarginBox.value = undefined;\n            _this.headerBox.value = undefined;\n            _this.footerBox.value = undefined;\n            _this.widthBox.value = undefined;\n            _this.heightBox.value = undefined;\n            _this.checkBox1.checked = false;\n            _this.checkBox2.checked = false;\n            _this.portrait.checked = false;\n            _this.landscape.checked = false;\n        };\n        this.owner = viewer;\n    }\n    PageSetupDialog.prototype.getModuleName = function () {\n        return 'PageSetupDialog';\n    };\n    /**\n     * @private\n     */\n    PageSetupDialog.prototype.initPageSetupDialog = function (locale) {\n        var id = this.owner.owner.containerId + '_pagesetup_dialog';\n        this.target = createElement('div', { id: id, className: 'e-de-pagesetup-dlg-container' });\n        this.owner.owner.element.appendChild(this.target);\n        var ejtabContainer = createElement('div', { id: this.target.id + '_MarginTabContainer' });\n        this.target.appendChild(ejtabContainer);\n        this.marginTab = createElement('div', {\n            id: this.target.id + '_marginPropertyTab', styles: 'position: relative;width:400px;'\n        });\n        this.paperTab = createElement('div', {\n            id: this.target.id + '_paperSizePropertyTab', styles: 'position: relative;width:400px;'\n        });\n        this.layoutTab = createElement('div', {\n            id: this.target.id + '_CellPropertiesDialogTab', styles: 'position: relative;width:400px;'\n        });\n        // tslint:disable-next-line:max-line-length\n        var ejtab = createElement('div', { id: this.target.id + '_PageSetupDialogTab', className: 'e-de-page-setup-ppty-tab' });\n        var headerContainer = createElement('div', { className: 'e-tab-header' });\n        var marginHeader = createElement('div', {\n            id: this.target.id + '_marginHeader', innerHTML: locale.getConstant('Margin')\n        });\n        var paperHeader = createElement('div', {\n            id: this.target.id + '_paperHeader', innerHTML: locale.getConstant('Paper')\n        });\n        var layoutHeader = createElement('div', {\n            id: this.target.id + '_layoutHeader', innerHTML: locale.getConstant('Layout')\n        });\n        headerContainer.appendChild(marginHeader);\n        headerContainer.appendChild(paperHeader);\n        headerContainer.appendChild(layoutHeader);\n        var contentContainer = createElement('div', { className: 'e-content' });\n        var marginContent = createElement('div', { id: this.target.id + '_marginContent' });\n        var paperContent = createElement('div', { id: this.target.id + '_paperContent' });\n        var layoutContent = createElement('div', { id: this.target.id + '_layoutContent' });\n        marginContent.appendChild(this.marginTab);\n        paperContent.appendChild(this.paperTab);\n        layoutContent.appendChild(this.layoutTab);\n        contentContainer.appendChild(marginContent);\n        contentContainer.appendChild(paperContent);\n        contentContainer.appendChild(layoutContent);\n        ejtab.appendChild(headerContainer);\n        ejtab.appendChild(contentContainer);\n        ejtabContainer.appendChild(ejtab);\n        this.initMarginProperties(this.marginTab, locale);\n        this.initPaperSizeProperties(this.paperTab, locale);\n        this.initLayoutProperties(this.layoutTab, locale);\n        var tabObj = new Tab({}, ejtab);\n        this.target.addEventListener('keyup', this.keyUpInsertPageSettings);\n        var marginTabHeader = tabObj.element.getElementsByClassName('e-item e-toolbar-item')[0];\n        var marginTabHeaderItem = marginTabHeader.getElementsByClassName('e-tab-wrap')[0];\n        marginTabHeaderItem.classList.add('e-de-page-setup-dlg-margin-tab-header');\n    };\n    /**\n     * @private\n     */\n    PageSetupDialog.prototype.initMarginProperties = function (element, locale) {\n        var marginDiv = createElement('div', {\n            id: 'margin_div',\n            className: 'e-de-page-setup-dlg-sub-container', styles: 'height:135px;'\n        });\n        // tslint:disable-next-line:max-line-length\n        var leftMarginDiv = createElement('div', { id: 'left_margin', className: 'e-de-page-setup-dlg-left-sub-container' });\n        marginDiv.appendChild(leftMarginDiv);\n        // tslint:disable-next-line:max-line-length\n        var rightMarginDiv = createElement('div', { className: 'e-de-page-setup-dlg-right-sub-container' });\n        marginDiv.appendChild(rightMarginDiv);\n        var topLabel = createElement('label', {\n            innerHTML: locale.getConstant('Top'), className: 'e-de-page-setup-dlg-sub-header',\n            id: this.target.id + '_TopLabel', styles: 'padding-top:0px;width:190px;'\n        });\n        var topTextBox = createElement('input', {\n            attrs: { 'type': 'text' }, id: this.target.id + '_Top'\n        });\n        var bottomBoxLabel = createElement('label', {\n            innerHTML: locale.getConstant('Bottom'),\n            className: 'e-de-page-setup-dlg-sub-title-header', id: this.target.id + '_bottomLabel'\n        });\n        var bottomTextBox = createElement('input', {\n            attrs: { 'type': 'text' },\n            id: this.target.id + '_bottom'\n        });\n        leftMarginDiv.appendChild(topLabel);\n        leftMarginDiv.appendChild(topTextBox);\n        leftMarginDiv.appendChild(bottomBoxLabel);\n        leftMarginDiv.appendChild(bottomTextBox);\n        var leftBoxLabel = createElement('label', {\n            innerHTML: locale.getConstant('Left'), className: 'e-de-page-setup-dlg-sub-header', styles: 'padding-top:0px;width:190px;',\n            id: this.target.id + '_leftLabel'\n        });\n        var leftTextBox = createElement('input', {\n            attrs: { 'type': 'text' }, id: this.target.id + '_left'\n        });\n        var rightLabel = createElement('label', {\n            innerHTML: locale.getConstant('Right'),\n            id: this.target.id + '_rightLabel', className: 'e-de-page-setup-dlg-sub-title-header'\n        });\n        var rightTextBox = createElement('input', {\n            attrs: { 'type': 'text' },\n            id: this.target.id + '_right'\n        });\n        rightMarginDiv.appendChild(leftBoxLabel);\n        rightMarginDiv.appendChild(leftTextBox);\n        rightMarginDiv.appendChild(rightLabel);\n        rightMarginDiv.appendChild(rightTextBox);\n        element.appendChild(marginDiv);\n        this.topMarginBox = new NumericTextBox({ value: 71, width: 170, decimals: 2 });\n        this.topMarginBox.appendTo(topTextBox);\n        this.leftMarginBox = new NumericTextBox({ value: 73, width: 170, decimals: 2 });\n        this.leftMarginBox.appendTo(leftTextBox);\n        this.bottomMarginBox = new NumericTextBox({ value: 72, width: 170, decimals: 2 });\n        this.bottomMarginBox.appendTo(bottomTextBox);\n        this.rightMarginBox = new NumericTextBox({ value: 74, width: 170, decimals: 2 });\n        this.rightMarginBox.appendTo(rightTextBox);\n        // tslint:disable-next-line:max-line-length\n        var orientationDiv = createElement('div', { id: 'orientation_div', className: 'e-de-page-setup-dlg-sub-container-port' });\n        // tslint:disable-next-line:max-line-length\n        var orientationLabeldiv = createElement('div', { id: '_orientationLabelDiv', className: 'e-de-page-setup-dlg-sub-label', innerHTML: locale.getConstant('Orientation') });\n        var orientationPropDiv = createElement('div', { id: '_orientationPropDiv', styles: 'display: flex;', className: 'e-de-page-setup-dlg-orientation-prop' });\n        var portraitDiv = createElement('div', { id: '_portraitDiv', styles: 'padding-right: 30px;' });\n        var portrait = createElement('input', {\n            attrs: { 'type': 'radiobutton' }, id: this.target.id + '_portrait'\n        });\n        var landscapeDiv = createElement('div', { id: '_landscapeDiv' });\n        var landscape = createElement('input', {\n            attrs: { 'type': 'radiobutton' }, id: this.target.id + '_landscape'\n        });\n        portraitDiv.appendChild(portrait);\n        landscapeDiv.appendChild(landscape);\n        orientationPropDiv.appendChild(portraitDiv);\n        orientationPropDiv.appendChild(landscapeDiv);\n        orientationDiv.appendChild(orientationLabeldiv);\n        orientationDiv.appendChild(orientationPropDiv);\n        this.portrait = new RadioButton({ label: locale.getConstant('Portrait'), checked: true, change: this.onPortrait });\n        this.landscape = new RadioButton({ label: locale.getConstant('Landscape'), change: this.onLandscape });\n        this.portrait.appendTo(portrait);\n        this.landscape.appendTo(landscape);\n        element.appendChild(orientationDiv);\n    };\n    /**\n     * @private\n     */\n    PageSetupDialog.prototype.initPaperSizeProperties = function (element, locale) {\n        var sizeDiv = createElement('div', {\n            id: 'size_div',\n            className: 'e-de-page-setup-dlg-sub-size-container'\n        });\n        // tslint:disable-next-line:max-line-length\n        var leftSizeDiv = createElement('div', { id: 'left_size', className: 'e-de-page-setup-dlg-left-sub-container' });\n        sizeDiv.appendChild(leftSizeDiv);\n        // tslint:disable-next-line:max-line-length\n        var rightSizeDiv = createElement('div', { className: 'e-de-page-setup-dlg-right-sub-container' });\n        sizeDiv.appendChild(rightSizeDiv);\n        var widthLabel = createElement('label', {\n            innerHTML: locale.getConstant('Width'), className: 'e-de-page-setup-dlg-sub-header',\n            id: this.target.id + '_widthLabel', styles: 'padding-top:0px;width:190px;'\n        });\n        var widthTextBox = createElement('input', {\n            attrs: { 'type': 'text' }, id: this.target.id + '_Width'\n        });\n        leftSizeDiv.appendChild(widthLabel);\n        leftSizeDiv.appendChild(widthTextBox);\n        var heightLabel = createElement('label', {\n            innerHTML: locale.getConstant('Height'), className: 'e-de-page-setup-dlg-sub-header', styles: 'padding-top:0px;width:190px;',\n            id: this.target.id + '_heightLabel'\n        });\n        var heightTextBox = createElement('input', {\n            attrs: { 'type': 'text' }, id: this.target.id + '_height'\n        });\n        rightSizeDiv.appendChild(heightLabel);\n        rightSizeDiv.appendChild(heightTextBox);\n        element.appendChild(sizeDiv);\n        this.widthBox = new NumericTextBox({ value: 612, width: 170, decimals: 2 });\n        this.widthBox.appendTo(widthTextBox);\n        this.heightBox = new NumericTextBox({ value: 792, width: 170, decimals: 2 });\n        this.heightBox.appendTo(heightTextBox);\n        // tslint:disable-next-line:max-line-length\n        var paperSizeDiv = createElement('div', { id: '_paperSizeDiv', styles: 'height:37px;', className: 'e-de-page-setup-dlg-sub-container' });\n        var paperSize = createElement('select', {\n            id: this.target.id + '_papersize', styles: 'width:170px;padding-bottom: 20px;',\n            innerHTML: '<option value=\"letter\">' + locale.getConstant('Letter') +\n                '</option><option value=\"tabloid\">' + locale.getConstant('Tabloid') +\n                '</option><option value=\"legal\">' + locale.getConstant('Legal') +\n                '</option><option value=\"statement\">' + locale.getConstant('Statement') +\n                '</option><option value=\"executive\">' + locale.getConstant('Executive') +\n                '</option><option value=\"a3\">' + locale.getConstant('A3') +\n                '</option><option value=\"a4\">' + locale.getConstant('A4') +\n                '</option><option value=\"a5\">' + locale.getConstant('A5') +\n                '</option><option value=\"b4\">' + locale.getConstant('B4') +\n                '</option><option value=\"b5\">' + locale.getConstant('B5') +\n                '</option><option value=\"customsize\">' + locale.getConstant('Custom Size') + '</option>'\n        });\n        paperSizeDiv.appendChild(paperSize);\n        this.paperSize = new DropDownList({ change: this.changeByPaperSize, width: '170px' });\n        this.paperSize.appendTo(paperSize);\n        element.appendChild(paperSizeDiv);\n    };\n    /**\n     * @private\n     */\n    PageSetupDialog.prototype.initLayoutProperties = function (element, locale) {\n        // tslint:disable-next-line:max-line-length\n        var layoutDiv = createElement('div', { id: '_layoutDiv', className: 'e-de-page-setup-dlg-layout-sub-container', });\n        // tslint:disable-next-line:max-line-length\n        var firstPageDiv = createElement('div', { id: '_firstPageDiv', styles: 'height: 27px;', className: 'e-de-page-setup-dlg-first-page-prop' });\n        var checkBox1 = createElement('input', {\n            attrs: { 'type': 'checkbox' }, id: this.target.id + '_oddoreven'\n        });\n        firstPageDiv.appendChild(checkBox1);\n        // tslint:disable-next-line:max-line-length\n        var oddOrEvenDiv = createElement('div', { id: '_oddOrEvenDiv', styles: 'height: 27px;', className: 'e-de-page-setup-dlg-odd-or-even-prop' });\n        var checkBox2 = createElement('input', {\n            attrs: { 'type': 'checkbox' }, id: this.target.id + '_even'\n        });\n        oddOrEvenDiv.appendChild(checkBox2);\n        layoutDiv.appendChild(firstPageDiv);\n        layoutDiv.appendChild(oddOrEvenDiv);\n        this.checkBox1 = new CheckBox({ label: locale.getConstant('Different odd and even') });\n        this.checkBox2 = new CheckBox({ label: locale.getConstant('Different first page') });\n        this.checkBox1.appendTo(checkBox1);\n        this.checkBox2.appendTo(checkBox2);\n        element.appendChild(layoutDiv);\n        // tslint:disable-next-line:max-line-length\n        var textLabelDiv = createElement('div', { id: '_textLabelDiv', className: 'e-de-page-setup-dlg-sub-label' });\n        var textLabel = createElement('label', {\n            innerHTML: locale.getConstant('From edge'), id: this.target.id + '_textLabel'\n        });\n        textLabelDiv.appendChild(textLabel);\n        element.appendChild(textLabelDiv);\n        // tslint:disable-next-line:max-line-length\n        var propertyDiv = createElement('div', { id: '_headerFooeterPropDiv', className: 'e-de-page-setup-dlg-sub-container', styles: 'height: 65px;' });\n        // tslint:disable-next-line:max-line-length\n        var leftLayoutDiv = createElement('div', { id: '_leftLayoutDiv', className: 'e-de-page-setup-dlg-left-layout-container' });\n        propertyDiv.appendChild(leftLayoutDiv);\n        // tslint:disable-next-line:max-line-length\n        var rightLayoutDiv = createElement('div', { className: 'e-de-page-setup-dlg-right-layout-container' });\n        propertyDiv.appendChild(rightLayoutDiv);\n        var headerLabel = createElement('label', {\n            innerHTML: locale.getConstant('Header'), className: 'e-de-page-setup-dlg-sub-header',\n            id: this.target.id + '_headerLabel', styles: 'padding-top:0px;width:190px;'\n        });\n        var headerBox = createElement('input', {\n            attrs: { 'type': 'text' }, id: this.target.id + '_header'\n        });\n        leftLayoutDiv.appendChild(headerLabel);\n        leftLayoutDiv.appendChild(headerBox);\n        var footerLabel = createElement('label', {\n            innerHTML: locale.getConstant('Footer'), className: 'e-de-page-setup-dlg-sub-header', styles: 'padding-top:0px;width:190px;',\n            id: this.target.id + '_footerLabel'\n        });\n        var footerBox = createElement('input', {\n            attrs: { 'type': 'text' }, id: this.target.id + '_footer'\n        });\n        rightLayoutDiv.appendChild(footerLabel);\n        rightLayoutDiv.appendChild(footerBox);\n        element.appendChild(propertyDiv);\n        this.headerBox = new NumericTextBox({ value: 612, width: 170, decimals: 2 });\n        this.headerBox.appendTo(headerBox);\n        this.footerBox = new NumericTextBox({ value: 792, width: 170, decimals: 2 });\n        this.footerBox.appendTo(footerBox);\n    };\n    /**\n     * @private\n     */\n    PageSetupDialog.prototype.show = function () {\n        var localValue = new L10n('documenteditor', this.owner.owner.defaultLocale);\n        localValue.setLocale(this.owner.owner.locale);\n        setCulture(this.owner.owner.locale);\n        if (!this.target) {\n            this.initPageSetupDialog(localValue);\n        }\n        this.owner.dialog.header = localValue.getConstant('Page Setup');\n        this.owner.dialog.width = 'auto';\n        this.owner.dialog.height = 'auto';\n        this.owner.dialog.content = this.target;\n        this.owner.dialog.beforeOpen = this.loadPageSetupDialog;\n        this.owner.dialog.close = this.closePageSetupDialog;\n        this.owner.dialog.buttons = [{\n                click: this.applyPageSetupProperties,\n                buttonModel: { content: localValue.getConstant('Ok'), cssClass: 'e-flat e-layout-ppty-okay', isPrimary: true }\n            },\n            {\n                click: this.onCancelButtonClick,\n                buttonModel: { content: localValue.getConstant('Cancel'), cssClass: 'e-flat e-layout-ppty-cancel' }\n            }];\n        this.owner.dialog.dataBind();\n        this.owner.dialog.show();\n    };\n    /**\n     * @private\n     */\n    PageSetupDialog.prototype.destroy = function () {\n        if (this.topMarginBox) {\n            this.topMarginBox.destroy();\n            this.topMarginBox = undefined;\n        }\n        if (this.leftMarginBox) {\n            this.leftMarginBox.destroy();\n            this.leftMarginBox = undefined;\n        }\n        if (this.bottomMarginBox) {\n            this.bottomMarginBox.destroy();\n            this.bottomMarginBox = undefined;\n        }\n        if (this.rightMarginBox) {\n            this.rightMarginBox.destroy();\n            this.rightMarginBox = undefined;\n        }\n        if (this.headerBox) {\n            this.headerBox.destroy();\n            this.headerBox = undefined;\n        }\n        if (this.footerBox) {\n            this.footerBox.destroy();\n            this.footerBox = undefined;\n        }\n        if (this.widthBox) {\n            this.widthBox.destroy();\n            this.widthBox = undefined;\n        }\n        if (this.heightBox) {\n            this.heightBox.destroy();\n            this.heightBox = undefined;\n        }\n        if (this.paperSize) {\n            this.paperSize.destroy();\n            this.paperSize = undefined;\n        }\n        if (this.checkBox1) {\n            this.checkBox1.destroy();\n            this.checkBox1 = undefined;\n        }\n        if (this.checkBox2) {\n            this.checkBox2.destroy();\n            this.checkBox2 = undefined;\n        }\n        if (this.portrait) {\n            this.portrait.destroy();\n            this.portrait = undefined;\n        }\n        if (this.landscape) {\n            this.landscape.destroy();\n            this.landscape = undefined;\n        }\n        this.owner = undefined;\n        if (!isNullOrUndefined(this.target)) {\n            if (this.target.parentElement) {\n                this.target.parentElement.removeChild(this.target);\n            }\n            for (var s = 0; s < this.target.childNodes.length; s++) {\n                this.target.removeChild(this.target.childNodes[s]);\n                s--;\n            }\n            this.target = undefined;\n        }\n    };\n    return PageSetupDialog;\n}());\nexport { PageSetupDialog };\n","import { NumericTextBox } from '@syncfusion/ej2-inputs';\nimport { createElement, L10n, setCulture } from '@syncfusion/ej2-base';\nimport { isNullOrUndefined } from '@syncfusion/ej2-base';\nimport { DropDownList } from '@syncfusion/ej2-dropdowns';\nimport { WParagraphFormat } from '../index';\n/**\n * The Paragraph dialog is used to modify formatting of selected paragraphs.\n */\nvar ParagraphDialog = /** @class */ (function () {\n    /**\n     * @private\n     */\n    function ParagraphDialog(viewer) {\n        var _this = this;\n        //paragraph Format properties\n        this.leftIndent = undefined;\n        this.rightIndent = undefined;\n        this.beforeSpacing = undefined;\n        this.afterSpacing = undefined;\n        this.textAlignment = undefined;\n        this.firstLineIndent = undefined;\n        this.lineSpacingIn = undefined;\n        this.lineSpacingType = undefined;\n        this.paragraphFormat = undefined;\n        /**\n         * @private\n         */\n        this.keyUpParagraphSettings = function (event) {\n            if (event.keyCode === 13) {\n                _this.applyParagraphFormat();\n            }\n        };\n        this.changeBeforeSpacing = function (event) {\n            _this.beforeSpacing = event.value;\n        };\n        this.changeAfterSpacing = function (event) {\n            _this.afterSpacing = event.value;\n        };\n        this.changeLeftIndent = function (event) {\n            _this.leftIndent = event.value;\n        };\n        this.changeRightIndent = function (event) {\n            _this.rightIndent = event.value;\n        };\n        this.changeLineSpacingValue = function (event) {\n            _this.lineSpacingIn = event.value;\n        };\n        this.changeFirstLineIndent = function (event) {\n            _this.firstLineIndent = event.value;\n        };\n        this.changeByTextAlignment = function (args) {\n            _this.textAlignment = args.value;\n        };\n        /**\n         * @private\n         */\n        this.changeByValue = function (event) {\n            var paragraphFormat = _this.owner.selection.paragraphFormat;\n            switch (_this.special.index) {\n                case 0:\n                    if (paragraphFormat.firstLineIndent !== 0) {\n                        _this.byIn.value = 0;\n                    }\n                    break;\n                case 1:\n                    if (paragraphFormat.firstLineIndent === 0 || isNullOrUndefined(paragraphFormat.firstLineIndent)) {\n                        _this.byIn.value = 0.1;\n                    }\n                    else if (paragraphFormat.firstLineIndent < 0) {\n                        _this.byIn.value = -(paragraphFormat.firstLineIndent);\n                    }\n                    break;\n                case 2:\n                    if (paragraphFormat.firstLineIndent === 0 || isNullOrUndefined(paragraphFormat.firstLineIndent)) {\n                        paragraphFormat.firstLineIndent = -0.1;\n                    }\n                    else if (paragraphFormat.firstLineIndent > 0) {\n                        _this.byIn.value = -(paragraphFormat.firstLineIndent);\n                    }\n                    break;\n            }\n        };\n        /**\n         * @private\n         */\n        this.changeBySpacing = function (event) {\n            if (isNullOrUndefined(_this.lineSpacing)) {\n                return;\n            }\n            switch (_this.lineSpacing.index) {\n                case 0:\n                    _this.lineSpacingType = 'AtLeast';\n                    _this.atIn.value = 12;\n                    break;\n                case 1:\n                    _this.lineSpacingType = 'Exactly';\n                    _this.atIn.value = 12;\n                    break;\n                case 2:\n                    _this.lineSpacingType = 'Multiple';\n                    _this.atIn.value = 1;\n                    break;\n            }\n        };\n        /* tslint:enable */\n        /**\n         * @private\n         */\n        this.loadParagraphDialog = function () {\n            var selectionFormat;\n            if (_this.paragraphFormat) {\n                selectionFormat = _this.paragraphFormat;\n            }\n            else {\n                selectionFormat = _this.owner.selection.paragraphFormat;\n            }\n            var alignValue = _this.alignment.index;\n            if (selectionFormat.textAlignment === 'Center') {\n                alignValue = 0;\n            }\n            else if (selectionFormat.textAlignment === 'Left') {\n                alignValue = 1;\n            }\n            else if (selectionFormat.textAlignment === 'Right') {\n                alignValue = 2;\n            }\n            else {\n                alignValue = 3;\n            }\n            _this.alignment.index = alignValue;\n            _this.beforeSpacingIn.value = selectionFormat.beforeSpacing;\n            _this.afterSpacingIn.value = selectionFormat.afterSpacing;\n            _this.leftIndentIn.value = selectionFormat.leftIndent;\n            _this.rightIndentIn.value = selectionFormat.rightIndent;\n            _this.byIn.value = selectionFormat.firstLineIndent;\n            var lineSpaceValue = _this.lineSpacing.index;\n            if (selectionFormat.lineSpacingType === 'AtLeast') {\n                lineSpaceValue = 0;\n            }\n            else if (selectionFormat.lineSpacingType === 'Exactly') {\n                lineSpaceValue = 1;\n            }\n            else {\n                lineSpaceValue = 2;\n            }\n            _this.lineSpacing.index = lineSpaceValue;\n            _this.atIn.value = selectionFormat.lineSpacing;\n            if (_this.owner.selection.caret.style.display !== 'none') {\n                _this.owner.selection.caret.style.display = 'none';\n            }\n        };\n        /**\n         * @private\n         */\n        this.applyParagraphFormat = function () {\n            var paraFormat;\n            var isApply;\n            if (_this.paragraphFormat) {\n                paraFormat = _this.paragraphFormat;\n                isApply = false;\n            }\n            else {\n                paraFormat = new WParagraphFormat();\n                isApply = true;\n            }\n            if (!isNullOrUndefined(_this.beforeSpacing)) {\n                paraFormat.beforeSpacing = _this.beforeSpacing;\n            }\n            if (!isNullOrUndefined(_this.afterSpacing)) {\n                paraFormat.afterSpacing = _this.afterSpacing;\n            }\n            if (!isNullOrUndefined(_this.lineSpacingType)) {\n                paraFormat.lineSpacingType = _this.lineSpacingType;\n            }\n            if (!isNullOrUndefined(_this.leftIndent)) {\n                paraFormat.leftIndent = _this.leftIndent;\n            }\n            if (!isNullOrUndefined(_this.rightIndent)) {\n                paraFormat.rightIndent = _this.rightIndent;\n            }\n            if (!isNullOrUndefined(_this.lineSpacingIn)) {\n                paraFormat.lineSpacing = _this.lineSpacingIn;\n            }\n            if (!isNullOrUndefined(_this.firstLineIndent)) {\n                paraFormat.firstLineIndent = _this.firstLineIndent;\n            }\n            if (!isNullOrUndefined(_this.textAlignment)) {\n                paraFormat.textAlignment = _this.textAlignment;\n            }\n            if (isApply) {\n                _this.onParagraphFormat(paraFormat);\n            }\n            else {\n                _this.owner.owner.styleDialogModule.updateParagraphFormat();\n            }\n            _this.owner.dialog.hide();\n        };\n        /**\n         * @private\n         */\n        this.closeParagraphDialog = function () {\n            _this.leftIndent = undefined;\n            _this.afterSpacing = undefined;\n            _this.beforeSpacing = undefined;\n            _this.firstLineIndent = undefined;\n            _this.textAlignment = undefined;\n            _this.rightIndent = undefined;\n            _this.lineSpacingIn = undefined;\n            _this.lineSpacingType = undefined;\n            _this.paragraphFormat = undefined;\n            _this.owner.dialog.hide();\n            _this.owner.updateFocus();\n        };\n        this.owner = viewer;\n    }\n    /**\n     * @private\n     */\n    ParagraphDialog.prototype.getModuleName = function () {\n        return 'ParagraphDialog';\n    };\n    /*tslint:disable max-func-body-length*/\n    /**\n     * @private\n     */\n    ParagraphDialog.prototype.initParagraphDialog = function (locale) {\n        var instance = this;\n        var ownerId = this.owner.owner.containerId;\n        var id = ownerId + '_paragraph_dialog';\n        this.target = createElement('div', { id: id, className: 'e-de-para-dlg-container' });\n        // tslint:disable-next-line:max-line-length\n        var div = createElement('div', { id: 'property_div', styles: 'width:400px;' });\n        var generalDiv = createElement('div', { id: 'genral_div', styles: 'width:200px;height:85px;', className: 'e-de-para-dlg-sub-container' });\n        // tslint:disable-next-line:max-line-length\n        var genLabel = createElement('div', { id: ownerId + '_genLabel', className: 'e-de-para-dlg-heading', innerHTML: locale.getConstant('General') });\n        var alignLabel = createElement('div', { id: ownerId + '_AlignLabel', className: 'e-de-dlg-sub-header', innerHTML: locale.getConstant('Alignment') });\n        var alignment = createElement('select', {\n            id: ownerId + '_Alignment',\n            innerHTML: '<option value=\"Center\">' + locale.getConstant('Center') +\n                '</option><option value=\"Left\">' + locale.getConstant('Left') +\n                '</option><option value=\"Right\">' + locale.getConstant('Right') +\n                '</option><option value=\"Justify\">' + locale.getConstant('Justify') + '</option>'\n        });\n        generalDiv.appendChild(genLabel);\n        generalDiv.appendChild(alignLabel);\n        generalDiv.appendChild(alignment);\n        // tslint:disable-next-line:max-line-length\n        var indentionDiv = createElement('div', { id: 'indention_div', styles: 'width: 400px;height: 150px;', className: 'e-de-para-dlg-sub-container' });\n        var leftIndentionDiv = createElement('div', { id: 'left_indention', styles: 'float:left;position:relative;' });\n        indentionDiv.appendChild(leftIndentionDiv);\n        // tslint:disable-next-line:max-line-length\n        var rightIndentionDiv = createElement('div', { className: 'e-de-para-dlg-right-sub-container', styles: 'float:right;position:relative;' });\n        indentionDiv.appendChild(rightIndentionDiv);\n        // tslint:disable-next-line:max-line-length\n        var spacingDiv = createElement('div', { id: 'spacing_div', styles: 'width: 400px;height: 150px;', className: 'e-de-para-dlg-sub-container' });\n        var leftSpacingDiv = createElement('div', { id: 'left_spacing', styles: 'float:left;position:relative;' });\n        spacingDiv.appendChild(leftSpacingDiv);\n        // tslint:disable-next-line:max-line-length\n        var rightSpacingDiv = createElement('div', { className: 'e-de-para-dlg-right-sub-container', styles: 'float:right;position:relative;' });\n        spacingDiv.appendChild(rightSpacingDiv);\n        // tslint:disable-next-line:max-line-length\n        var indentLabel = createElement('div', {\n            id: ownerId + '_indentLabel', className: 'e-de-para-dlg-heading', innerHTML: locale.getConstant('Indentation')\n        });\n        var beforeTextLabel = createElement('div', {\n            id: ownerId + '_bfTextLabel',\n            className: 'e-de-dlg-sub-header', innerHTML: locale.getConstant('Before text')\n        });\n        // tslint:disable-next-line:max-line-length\n        var leftIndent = createElement('input', { id: ownerId + '_leftIndent', attrs: { 'type': 'text' } });\n        var specialLabel = createElement('div', { id: ownerId + '_specialLabel', className: 'e-de-dlg-sub-header', innerHTML: locale.getConstant('Special') });\n        var special = createElement('select', {\n            id: ownerId + '_special',\n            innerHTML: '<option value=\"None\">' + locale.getConstant('None') +\n                '</option><option value=\"First Line\">' + locale.getConstant('First line') +\n                '</option><option value=\"Hanging\">' + locale.getConstant('Hanging') + '</option> '\n        });\n        leftIndentionDiv.appendChild(indentLabel);\n        leftIndentionDiv.appendChild(beforeTextLabel);\n        leftIndentionDiv.appendChild(leftIndent);\n        leftIndentionDiv.appendChild(specialLabel);\n        leftIndentionDiv.appendChild(special);\n        // tslint:disable-next-line:max-line-length\n        var afterTextLabel = createElement('div', { id: ownerId + '_afTextLabel', className: 'e-de-dlg-sub-header', innerHTML: locale.getConstant('After text') });\n        var rightIndent = createElement('input', { id: ownerId + '_rightIndent', attrs: { 'type': 'text' } });\n        // tslint:disable-next-line:max-line-length\n        var byLabel = createElement('label', { id: ownerId + '_byLabel', className: 'e-de-dlg-sub-header', innerHTML: locale.getConstant('By') });\n        var by = createElement('input', { id: ownerId + '_By', attrs: { 'type': 'text' } });\n        rightIndentionDiv.appendChild(afterTextLabel);\n        rightIndentionDiv.appendChild(rightIndent);\n        rightIndentionDiv.appendChild(byLabel);\n        rightIndentionDiv.appendChild(by);\n        // tslint:disable-next-line:max-line-length\n        var spaceLabel = createElement('div', { innerHTML: locale.getConstant('Spacing'), className: 'e-de-para-dlg-heading', id: ownerId + '_spaceLabel' });\n        var beforeLabel = createElement('div', { className: 'e-de-dlg-sub-header', innerHTML: locale.getConstant('Before'), id: ownerId + '_beforeLabel' });\n        // tslint:disable-next-line:max-line-length\n        var beforeSpacing = createElement('input', { id: ownerId + '_beforeSpacing', attrs: { 'type': 'text' } });\n        var lineSpaceLabel = createElement('div', { id: ownerId + '_lineSpaceLabel', className: 'e-de-dlg-sub-header', innerHTML: locale.getConstant('Line Spacing') });\n        // tslint:disable-next-line:max-line-length\n        var lineSpacing = createElement('select', {\n            id: ownerId + '_lineSpacing', styles: 'width:180px;',\n            innerHTML: '<option value=\"At least\">' + locale.getConstant('At least') +\n                '</option><option value=\"Exactly\">' + locale.getConstant('Exactly') +\n                '</option><option value=\"Multiple\">' + locale.getConstant('Multiple') + '</option>'\n        });\n        leftSpacingDiv.appendChild(spaceLabel);\n        leftSpacingDiv.appendChild(beforeLabel);\n        leftSpacingDiv.appendChild(beforeSpacing);\n        leftSpacingDiv.appendChild(lineSpaceLabel);\n        leftSpacingDiv.appendChild(lineSpacing);\n        // tslint:disable-next-line:max-line-length\n        var afterLabel = createElement('div', { innerHTML: locale.getConstant('After'), className: 'e-de-dlg-sub-header', id: ownerId + '_afterLabel' });\n        var afterSpacing = createElement('input', { id: ownerId + '_afterSpacing', attrs: { 'type': 'text' } });\n        // tslint:disable-next-line:max-line-length\n        var atLabel = createElement('div', { innerHTML: locale.getConstant('At'), id: ownerId + '_atLabel', className: 'e-de-dlg-sub-header' });\n        var lineSpacingAt = createElement('input', { id: ownerId + '_lineSpacingAt', attrs: { 'type': 'text' } });\n        rightSpacingDiv.appendChild(afterLabel);\n        rightSpacingDiv.appendChild(afterSpacing);\n        rightSpacingDiv.appendChild(atLabel);\n        rightSpacingDiv.appendChild(lineSpacingAt);\n        div.appendChild(generalDiv);\n        div.appendChild(indentionDiv);\n        div.appendChild(spacingDiv);\n        this.target.appendChild(div);\n        this.leftIndentIn = new NumericTextBox({\n            format: 'n1', value: 0, min: -1584, max: 1584, width: 180, enablePersistence: false, change: this.changeLeftIndent\n        });\n        this.leftIndentIn.appendTo(leftIndent);\n        this.rightIndentIn = new NumericTextBox({\n            format: 'n1', value: 0, min: -1584, max: 1584, width: 180, enablePersistence: false, change: this.changeRightIndent\n        });\n        this.rightIndentIn.appendTo(rightIndent);\n        this.byIn = new NumericTextBox({\n            format: 'n1', value: 0, min: 0, max: 1584, width: 180, enablePersistence: false, change: this.changeFirstLineIndent\n        });\n        this.byIn.appendTo(by);\n        this.beforeSpacingIn = new NumericTextBox({\n            format: 'n1', value: 0, min: 0, max: 1584, width: 180, step: 6, enablePersistence: false,\n            change: this.changeBeforeSpacing\n        });\n        this.beforeSpacingIn.appendTo(beforeSpacing);\n        this.afterSpacingIn = new NumericTextBox({\n            format: 'n1', value: 0, min: 0, max: 1584, width: 180, step: 6, enablePersistence: false,\n            change: this.changeAfterSpacing\n        });\n        this.afterSpacingIn.appendTo(afterSpacing);\n        this.atIn = new NumericTextBox({\n            format: 'n1', value: 0, min: 1, max: 1584, width: 180, step: 0.5, enablePersistence: false, change: this.changeLineSpacingValue\n        });\n        this.special = new DropDownList({ change: this.changeByValue, width: 180 });\n        this.special.appendTo(special);\n        this.lineSpacing = new DropDownList({ change: this.changeBySpacing, width: '180px' });\n        this.lineSpacing.appendTo(lineSpacing);\n        this.alignment = new DropDownList({ width: 180, change: this.changeByTextAlignment });\n        this.alignment.appendTo(alignment);\n        this.atIn.appendTo(lineSpacingAt);\n        this.target.addEventListener('keyup', instance.keyUpParagraphSettings);\n    };\n    /**\n     * Applies Paragraph Format\n     * @param  {WParagraphFormat} paragraphFormat\n     * @private\n     */\n    ParagraphDialog.prototype.onParagraphFormat = function (paragraphFormat) {\n        this.owner.owner.editorModule.initHistory('ParagraphFormat');\n        var selection = this.owner.selection;\n        this.owner.owner.isShiftingEnabled = true;\n        if (this.owner.selection.isEmpty) {\n            this.owner.owner.editorModule.applyParaFormatProperty(selection.start.paragraph, undefined, paragraphFormat, false);\n            this.owner.owner.editor.layoutItemBlock(selection.start.paragraph, false);\n        }\n        else {\n            this.owner.owner.editorModule.updateSelectionParagraphFormatting('ParagraphFormat', paragraphFormat, false);\n        }\n        this.owner.owner.editorModule.reLayout(selection);\n    };\n    /**\n     * @private\n     */\n    ParagraphDialog.prototype.show = function (paragraphFormat) {\n        if (paragraphFormat) {\n            this.paragraphFormat = paragraphFormat;\n        }\n        var local = new L10n('documenteditor', this.owner.owner.defaultLocale);\n        local.setLocale(this.owner.owner.locale);\n        setCulture(this.owner.owner.locale);\n        if (!this.target) {\n            this.initParagraphDialog(local);\n        }\n        this.loadParagraphDialog();\n        this.owner.dialog.header = 'Paragraph';\n        this.owner.dialog.content = this.target;\n        this.owner.dialog.height = 'auto';\n        this.owner.dialog.width = 'auto';\n        this.owner.dialog.buttons = [{\n                click: this.applyParagraphFormat,\n                buttonModel: { content: local.getConstant('Ok'), cssClass: 'e-flat e-para-okay', isPrimary: true }\n            },\n            {\n                click: this.closeParagraphDialog,\n                buttonModel: { content: local.getConstant('Cancel'), cssClass: 'e-flat e-para-cancel' }\n            }];\n        this.owner.dialog.beforeOpen = this.owner.updateFocus;\n        this.owner.dialog.close = this.owner.updateFocus;\n        this.owner.dialog.dataBind();\n        this.owner.dialog.show();\n    };\n    /**\n     * @private\n     */\n    ParagraphDialog.prototype.destroy = function () {\n        if (this.afterSpacingIn) {\n            this.afterSpacingIn.destroy();\n            this.afterSpacingIn = undefined;\n        }\n        if (this.beforeSpacingIn) {\n            this.beforeSpacingIn.destroy();\n            this.beforeSpacingIn = undefined;\n        }\n        if (this.leftIndentIn) {\n            this.leftIndentIn.destroy();\n            this.leftIndentIn = undefined;\n        }\n        if (this.rightIndentIn) {\n            this.rightIndentIn.destroy();\n            this.rightIndentIn = undefined;\n        }\n        if (this.byIn) {\n            this.byIn.destroy();\n            this.byIn = undefined;\n        }\n        if (this.atIn) {\n            this.atIn.destroy();\n            this.atIn = undefined;\n        }\n        if (this.alignment) {\n            this.alignment.change = undefined;\n            this.alignment.destroy();\n        }\n        this.alignment = undefined;\n        if (this.lineSpacing) {\n            this.lineSpacing.change = undefined;\n            this.lineSpacing.destroy();\n        }\n        this.lineSpacing = undefined;\n        if (this.special) {\n            this.special.change = undefined;\n            this.special.destroy();\n        }\n        this.special = undefined;\n        this.owner = undefined;\n        if (!isNullOrUndefined(this.target)) {\n            if (this.target.parentElement) {\n                this.target.parentElement.removeChild(this.target);\n            }\n            for (var q = 0; q < this.target.childNodes.length; q++) {\n                this.target.removeChild(this.target.childNodes[q]);\n                q--;\n            }\n            this.target = undefined;\n        }\n    };\n    return ParagraphDialog;\n}());\nexport { ParagraphDialog };\n","import { WCharacterFormat, WParagraphFormat } from '../format/index';\nimport { WList } from '../list/list';\nimport { WAbstractList } from '../list/abstract-list';\nimport { WListLevel } from '../list/list-level';\nimport { isNullOrUndefined } from '@syncfusion/ej2-base';\n/**\n * List view model implementation\n * @private\n */\nvar ListViewModel = /** @class */ (function () {\n    /**\n     * @private\n     */\n    function ListViewModel() {\n        this.listIn = undefined;\n        this.levelNumberIn = undefined;\n        /**\n         * @private\n         */\n        this.dialog = undefined;\n        this.levelNumber = 0;\n    }\n    Object.defineProperty(ListViewModel.prototype, \"levelNumber\", {\n        /**\n         * @private\n         */\n        get: function () {\n            return this.levelNumberIn;\n        },\n        /**\n         * @private\n         */\n        set: function (value) {\n            this.levelNumberIn = value;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(ListViewModel.prototype, \"list\", {\n        /**\n         * @private\n         */\n        get: function () {\n            return this.listIn;\n        },\n        /**\n         * @private\n         */\n        set: function (value) {\n            if (isNullOrUndefined(value)) {\n                this.createList();\n            }\n            else {\n                this.listIn = value;\n            }\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(ListViewModel.prototype, \"listLevel\", {\n        /**\n         * @private\n         */\n        get: function () {\n            if (!isNullOrUndefined(this.list) && this.levelNumber >= 0 && this.levelNumber < 9) {\n                if (!isNullOrUndefined(this.dialog.owner.getAbstractListById(this.list.abstractListId))) {\n                    if (this.dialog.owner.getAbstractListById(this.list.abstractListId).levels.length <= this.levelNumber) {\n                        this.addListLevels();\n                    }\n                    return this.dialog.owner.getAbstractListById(this.list.abstractListId).levels[this.levelNumber];\n                }\n                else {\n                    this.dialog.owner.lists.push(this.list);\n                    var abstractList = this.list.abstractList;\n                    if (!this.list.abstractList) {\n                        abstractList = new WAbstractList();\n                        abstractList.abstractListId = this.list.abstractListId;\n                    }\n                    var listLevelAdv = new WListLevel(abstractList);\n                    listLevelAdv.characterFormat = new WCharacterFormat(listLevelAdv);\n                    listLevelAdv.paragraphFormat = new WParagraphFormat(listLevelAdv);\n                    listLevelAdv.paragraphFormat.leftIndent = (1) * 48;\n                    listLevelAdv.paragraphFormat.firstLineIndent = -24;\n                    listLevelAdv.numberFormat = '%' + (1).toString() + '.';\n                    listLevelAdv.listLevelPattern = 'UpRoman';\n                    listLevelAdv.followCharacter = 'Tab';\n                    listLevelAdv.startAt = 1;\n                    listLevelAdv.restartLevel = 1;\n                    this.dialog.owner.abstractLists.push(abstractList);\n                    return this.dialog.owner.getAbstractListById(this.list.abstractListId).levels[0];\n                    // return this.dialog.owner.getAbstractListById(this.list.abstractListId).levels.getItem(0);\n                }\n            }\n            return undefined;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(ListViewModel.prototype, \"listLevelPattern\", {\n        /**\n         * @private\n         */\n        get: function () {\n            if (!isNullOrUndefined(this.listLevel)) {\n                return this.listLevel.listLevelPattern;\n            }\n            return 'Arabic';\n        },\n        /**\n         * @private\n         */\n        set: function (value) {\n            if (!isNullOrUndefined(this.listLevel)) {\n                this.listLevel.listLevelPattern = value;\n            }\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(ListViewModel.prototype, \"followCharacter\", {\n        /**\n         * @private\n         */\n        get: function () {\n            if (!isNullOrUndefined(this.listLevel)) {\n                return this.listLevel.followCharacter;\n            }\n            return 'None';\n        },\n        /**\n         * @private\n         */\n        set: function (value) {\n            if (!isNullOrUndefined(this.listLevel)) {\n                this.listLevel.followCharacter = value;\n            }\n        },\n        enumerable: true,\n        configurable: true\n    });\n    ListViewModel.prototype.createList = function () {\n        this.list = new WList();\n        this.list.listId = this.dialog.owner.lists.length + 1;\n        var abstractList = new WAbstractList();\n        abstractList.abstractListId = this.dialog.owner.abstractLists.length + 1;\n        this.list.abstractListId = abstractList.abstractListId;\n        this.dialog.owner.lists.push(this.list);\n        var listLevel = new WListLevel(abstractList);\n        listLevel.paragraphFormat = new WParagraphFormat(listLevel);\n        listLevel.paragraphFormat.leftIndent = 48;\n        listLevel.paragraphFormat.firstLineIndent = -24;\n        listLevel.characterFormat = new WCharacterFormat(listLevel);\n        listLevel.numberFormat = '%1.';\n        listLevel.startAt = 1;\n        abstractList.levels.push(listLevel);\n        this.dialog.owner.abstractLists.push(abstractList);\n    };\n    ListViewModel.prototype.addListLevels = function () {\n        if (!isNullOrUndefined(this.list) && !isNullOrUndefined(this.list.abstractListId)) {\n            for (var i = this.dialog.owner.getAbstractListById(this.list.abstractListId).levels.length; i < 9; i++) {\n                var listLevelAdv = new WListLevel(this.dialog.owner.getAbstractListById(this.list.abstractListId));\n                listLevelAdv.characterFormat = new WCharacterFormat(listLevelAdv);\n                listLevelAdv.paragraphFormat = new WParagraphFormat(listLevelAdv);\n                listLevelAdv.paragraphFormat.leftIndent = (i + 1) * 48;\n                listLevelAdv.paragraphFormat.firstLineIndent = -24;\n                listLevelAdv.numberFormat = '%' + (i + 1).toString() + '.';\n                listLevelAdv.listLevelPattern = 'Arabic';\n                listLevelAdv.followCharacter = 'Tab';\n                listLevelAdv.startAt = 1;\n                listLevelAdv.restartLevel = i;\n                (this.dialog.owner).getAbstractListById(this.list.abstractListId).levels.push(listLevelAdv);\n            }\n        }\n    };\n    /**\n     * @private\n     */\n    ListViewModel.prototype.destroy = function () {\n        this.list = undefined;\n        this.followCharacter = undefined;\n        this.levelNumber = undefined;\n        this.listLevelPattern = undefined;\n    };\n    return ListViewModel;\n}());\nexport { ListViewModel };\n","import { NumericTextBox } from '@syncfusion/ej2-inputs';\nimport { createElement, L10n, setCulture } from '@syncfusion/ej2-base';\nimport { isNullOrUndefined } from '@syncfusion/ej2-base';\n// tslint:disable-next-line:max-line-length\nimport { WCharacterFormat, WParagraphFormat } from '../format/index';\nimport { WAbstractList } from '../list/abstract-list';\nimport { WLevelOverride } from '../list/level-override';\nimport { DropDownList } from '@syncfusion/ej2-dropdowns';\nimport { Tooltip } from '@syncfusion/ej2-popups';\nimport { ListViewModel } from './list-view-model';\n/**\n * The List dialog is used to create or modify lists.\n */\n/* tslint:disable:no-any */\nvar ListDialog = /** @class */ (function () {\n    /**\n     * @private\n     */\n    function ListDialog(viewer) {\n        var _this = this;\n        /**\n         * @private\n         */\n        this.dialog = undefined;\n        this.target = undefined;\n        /**\n         * @private\n         */\n        this.owner = undefined;\n        this.viewModel = undefined;\n        this.startAt = undefined;\n        this.textIndent = undefined;\n        this.alignedAt = undefined;\n        this.listLevelElement = undefined;\n        this.followNumberWith = undefined;\n        this.numberStyle = undefined;\n        this.numberFormat = undefined;\n        this.restartBy = undefined;\n        /**\n         * @private\n         */\n        this.isListCharacterFormat = false;\n        this.onTextIndentChanged = function (args) {\n            _this.viewModel.listLevel.paragraphFormat.leftIndent = args.value;\n        };\n        this.onStartValueChanged = function (args) {\n            _this.viewModel.listLevel.startAt = args.value;\n        };\n        this.onListLevelValueChanged = function (args) {\n            _this.viewModel.levelNumber = parseInt(args.value.slice(args.value.length - 1), 10) - 1;\n            if (isNullOrUndefined(_this.listLevel)) {\n                return;\n            }\n            if (isNullOrUndefined(_this.listLevel.characterFormat)) {\n                _this.listLevel.characterFormat = new WCharacterFormat(_this.viewModel.listLevel);\n            }\n            if (!isNullOrUndefined(_this.listLevel.paragraphFormat)) {\n                _this.listLevel.paragraphFormat = new WParagraphFormat(_this.viewModel.listLevel);\n            }\n            _this.updateDialogValues();\n            _this.updateRestartLevelBox();\n        };\n        this.onNumberFormatChanged = function (args) {\n            _this.viewModel.listLevel.numberFormat = args.target.value;\n        };\n        this.onAlignedAtValueChanged = function (args) {\n            _this.viewModel.listLevel.paragraphFormat.firstLineIndent = args.value;\n        };\n        this.onFollowCharacterValueChanged = function (args) {\n            if (args.value) {\n                _this.viewModel.followCharacter = args.value;\n            }\n        };\n        this.onLevelPatternValueChanged = function (args) {\n            _this.viewModel.listLevelPattern = args.value;\n            var numberFormat = '%' + (_this.levelNumber + 1).toString();\n            // tslint:disable-next-line:max-line-length\n            var numberFormatTextBox = document.getElementById(_this.owner.owner.containerId + '_numberFormat');\n            if (_this.listLevel.listLevelPattern === 'Bullet') {\n                _this.listLevel.numberFormat = '\\uf0b7';\n                numberFormatTextBox.value = _this.listLevel.numberFormat;\n                _this.listLevel.characterFormat.fontFamily = 'Wingdings';\n            }\n            else {\n                if (_this.listLevel.listLevelPattern === 'None') {\n                    _this.listLevel.numberFormat = '';\n                }\n                if (!_this.listLevel.numberFormat.match(numberFormat) && _this.listLevel.listLevelPattern !== 'None') {\n                    _this.listLevel.numberFormat = numberFormat + '.';\n                }\n                numberFormatTextBox.value = _this.listLevel.numberFormat;\n            }\n        };\n        this.loadListDialog = function () {\n            _this.owner.updateFocus();\n            if (isNullOrUndefined(_this.owner.owner)) {\n                return;\n            }\n            _this.viewModel = new ListViewModel();\n            _this.viewModel.dialog = _this;\n            if (_this.owner.selection.paragraphFormat.listLevelNumber > 0) {\n                _this.viewModel.levelNumber = _this.owner.selection.paragraphFormat.listLevelNumber;\n            }\n            _this.viewModel.list = _this.owner.selection.paragraphFormat.getList();\n            if (isNullOrUndefined(_this.listLevel)) {\n                return;\n            }\n            if (isNullOrUndefined(_this.listLevel.characterFormat)) {\n                _this.listLevel.characterFormat = new WCharacterFormat(_this.viewModel.listLevel);\n            }\n            if (isNullOrUndefined(_this.listLevel.paragraphFormat)) {\n                _this.listLevel.paragraphFormat = new WParagraphFormat(_this.viewModel.listLevel);\n            }\n            _this.updateDialogValues();\n            if (_this.owner.selection.caret.style.display !== 'none') {\n                _this.owner.selection.caret.style.display = 'none';\n            }\n        };\n        this.showFontDialog = function () {\n            _this.owner.owner.fontDialogModule.showFontDialog(_this.listLevel.characterFormat);\n        };\n        this.onApplyList = function () {\n            if (!isNullOrUndefined(_this.owner)) {\n                _this.owner.selection.paragraphFormat.setList(_this.list);\n            }\n            _this.owner.dialog2.hide();\n            _this.owner.updateFocus();\n        };\n        this.onCancelButtonClick = function () {\n            _this.disposeBindingForListUI();\n            _this.owner.dialog2.hide();\n            _this.owner.updateFocus();\n            _this.isListCharacterFormat = false;\n        };\n        this.closeListDialog = function () {\n            _this.disposeBindingForListUI();\n            _this.owner.updateFocus();\n            _this.isListCharacterFormat = false;\n        };\n        this.owner = viewer;\n        this.viewModel = new ListViewModel();\n    }\n    Object.defineProperty(ListDialog.prototype, \"listLevel\", {\n        /**\n         * @private\n         */\n        get: function () {\n            if (!isNullOrUndefined(this.viewModel)) {\n                return this.viewModel.listLevel;\n            }\n            return undefined;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(ListDialog.prototype, \"list\", {\n        /**\n         * @private\n         */\n        get: function () {\n            if (!isNullOrUndefined(this.viewModel)) {\n                return this.viewModel.list;\n            }\n            return undefined;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(ListDialog.prototype, \"levelNumber\", {\n        /**\n         * @private\n         */\n        get: function () {\n            if (this.listLevel.ownerBase instanceof WLevelOverride) {\n                return this.listLevel.ownerBase.levelNumber;\n                // tslint:disable-next-line:max-line-length\n            }\n            else if (this.listLevel.ownerBase instanceof WAbstractList && !isNullOrUndefined(this.listLevel.ownerBase.levels)) {\n                return this.listLevel.ownerBase.levels.indexOf(this.listLevel);\n            }\n            else {\n                return -1;\n            }\n        },\n        enumerable: true,\n        configurable: true\n    });\n    /**\n     * @private\n     */\n    ListDialog.prototype.getModuleName = function () {\n        return 'ListDialog';\n    };\n    /**\n     * @private\n     */\n    ListDialog.prototype.showListDialog = function () {\n        var locale = new L10n('documenteditor', this.owner.owner.defaultLocale);\n        locale.setLocale(this.owner.owner.locale);\n        setCulture(this.owner.owner.locale);\n        if (!this.target) {\n            this.initListDialog(locale);\n        }\n        this.isListCharacterFormat = true;\n        this.owner.dialog2.header = locale.getConstant('Define new Multilevel list');\n        this.owner.dialog2.height = 'auto';\n        this.owner.dialog2.width = 'auto';\n        this.owner.dialog2.content = this.target;\n        this.owner.dialog2.buttons = [{\n                click: this.showFontDialog,\n                buttonModel: { content: locale.getConstant('Font'), cssClass: 'e-flat e-list-dlg-font e-font' }\n            }, {\n                click: this.onApplyList,\n                buttonModel: { content: locale.getConstant('Ok'), cssClass: 'e-flat e-list-dlg', isPrimary: true }\n            },\n            {\n                click: this.onCancelButtonClick,\n                buttonModel: { content: locale.getConstant('Cancel'), cssClass: 'e-flat e-list-dlg' }\n            }];\n        this.owner.dialog2.dataBind();\n        this.owner.dialog2.beforeOpen = this.loadListDialog;\n        this.owner.dialog2.close = this.closeListDialog;\n        this.owner.dialog2.position = { X: 'center', Y: 'top' };\n        this.owner.dialog2.show();\n    };\n    /**\n     * Shows the table properties dialog\n     * @private\n     */\n    ListDialog.prototype.initListDialog = function (locale) {\n        var instance = this;\n        var containerId = this.owner.owner.containerId;\n        var id = containerId + '_insert_list';\n        this.target = createElement('div', { id: id, className: 'e-de-list-dlg' });\n        this.owner.owner.element.appendChild(this.target);\n        // tslint:disable-next-line:max-line-length\n        var listLevelDiv = createElement('div', { innerHTML: '<label id=\"' + containerId + '_listLevellabel\" style=\"display:block;\" class=e-de-list-ddl-header-list-level>' + locale.getConstant('List level') + '</label><label id=\"' + containerId + '_modifyLabel\" style=\"display:block;\" class=e-de-list-ddl-subheader>' + locale.getConstant('Choose level to modify') + '</label><select style=\"height:20px;width:43%\" id=\"' + containerId + '_listLevel\"><option>' + locale.getConstant('Level') + ' 1' + '</option><option>' + locale.getConstant('Level') + ' 2' + '</option><option>' + locale.getConstant('Level') + ' 3' + '</option><option>' + locale.getConstant('Level') + ' 4' + '</option><option>' + locale.getConstant('Level') + ' 5' + '</option><option>' + locale.getConstant('Level') + ' 6' + '</option><option>' + locale.getConstant('Level') + ' 7' + '</option><option>' + locale.getConstant('Level') + ' 8' + '</option><option>' + locale.getConstant('Level') + ' 9' + '</option></select>' });\n        this.target.appendChild(listLevelDiv);\n        var div = createElement('div');\n        // tslint:disable-next-line:max-line-length\n        var numberStyleDiv = createElement('div', { innerHTML: '<div style=\"float:left;display:block;\"><label id=\"' + containerId + '_numberFormatLabel\" style=\"display:block;\" class=e-de-list-ddl-header>' + locale.getConstant('Number format') + '</label><label id=\"' + containerId + '_numberStyleLabel\" style=\"display:block;\" class=e-de-list-ddl-subheader>' + locale.getConstant('Number style for this level') + '</label><select style=\"height:20px;width:100%\" id=\"' + containerId + '_numberStyle\"><option>' + locale.getConstant('Arabic') + '</option><option>' + locale.getConstant('UpRoman') + '</option><option>' + locale.getConstant('LowRoman') + '</option><option>' + locale.getConstant('UpLetter') + '</option><option>' + locale.getConstant('LowLetter') + '</option><option>' + locale.getConstant('Number') + '</option><option>' + locale.getConstant('Leading zero') + '</option><option>' + locale.getConstant('Bullet') + '</option><option>' + locale.getConstant('Ordinal') + '</option><option>' + locale.getConstant('Ordinal Text') + '</option><option>' + locale.getConstant('Special') + '</option><option>' + locale.getConstant('For East') + '</option></select><label id=\"' + containerId + '_startAtLabel\" style=\"display:block;\" class=e-de-list-ddl-subheaderbottom>' + locale.getConstant('Start at') + '</label><input type=\"text\" id=\"' + containerId + '_startAt\">' });\n        div.appendChild(numberStyleDiv);\n        // tslint:disable-next-line:max-line-length\n        var numberFormatDiv = createElement('div', { className: 'e-de-list-dlg-subdiv', innerHTML: '<div><div><label id=\"' + containerId + '_formatLabel\" style=\"display:inline-block;width:86%\" class=e-de-list-ddl-subheader>' + locale.getConstant('Enter formatting for number') + '</label><button id=\"' + containerId + '_list_info\" class=\"e-control e-btn e-primary e-de-list-format-info\">i</button></div><input style=width:180px; type=\"text\" id=\"' + containerId + '_numberFormat\" class=e-input></div><label id=\"' + containerId + '_restartLabel\" style=\"display:block;\" class=e-de-list-ddl-subheaderbottom>' + locale.getConstant('Restart list after') + '</label><select style=\"height:20px;width:100%\" id=\"' + containerId + '_restartBy\"><option>' + locale.getConstant('No Restart') + '</option></select></div>' });\n        div.appendChild(numberFormatDiv);\n        this.target.appendChild(div);\n        // tslint:disable-next-line:max-line-length\n        var indentsDiv = createElement('div', { innerHTML: '<div style=\"float:left;display:block;\"><label id=\"' + containerId + '_IndentsLabel\" style=\"display:block;\" class=e-de-list-ddl-header>' + locale.getConstant('Position') + '</label><label id=\"' + containerId + '_textIndentLabel\" style=\"display:block;\" class=e-de-list-ddl-subheader>' + locale.getConstant('Text indent at') + '</label><input type=\"text\" id=\"' + containerId + '_textIndent\"><label id=\"' + containerId + '_followCharacterLabel\" style=\"display:block;\" class=e-de-list-ddl-subheaderbottom>' + locale.getConstant('Follow number with') + '</label><select style=\"height:20px;width:100%\" id=\"' + containerId + '_followCharacter\"><option>' + locale.getConstant('Tab character') + '</option><option>' + locale.getConstant('Space') + '</option><option>' + locale.getConstant('Nothing') + '</option></select></div><div class=\"e-de-list-dlg-div\"><label id=\"' + containerId + '_alignedAtLabel\" style=\"display:block;\" class=e-de-list-ddl-subheader>' + locale.getConstant('Aligned at') + '</label><input type=\"text\" id=\"' + containerId + '_alignedAt\"></div>', });\n        this.target.appendChild(indentsDiv);\n        var startAtTextBox = document.getElementById(containerId + '_startAt');\n        var textIndentAtTextBox = document.getElementById(containerId + '_textIndent');\n        var alignedAtTextBox = document.getElementById(containerId + '_alignedAt');\n        this.startAt = new NumericTextBox({\n            format: '#',\n            decimals: 0,\n            min: 0,\n            max: 50,\n            width: '180px',\n            enablePersistence: false,\n        });\n        this.startAt.addEventListener('change', instance.onStartValueChanged);\n        this.startAt.appendTo(startAtTextBox);\n        this.textIndent = new NumericTextBox({\n            format: '#',\n            decimals: 0,\n            min: 0,\n            max: 1584,\n            width: '180px',\n            step: 4,\n            enablePersistence: false\n        });\n        this.textIndent.addEventListener('change', instance.onTextIndentChanged);\n        this.textIndent.appendTo(textIndentAtTextBox);\n        this.alignedAt = new NumericTextBox({\n            format: '#',\n            max: 1584,\n            step: 6,\n            width: '180px',\n            enablePersistence: false\n        });\n        this.alignedAt.addEventListener('change', instance.onAlignedAtValueChanged);\n        this.alignedAt.appendTo(alignedAtTextBox);\n        var listLevel = document.getElementById(containerId + '_listLevel');\n        this.listLevelElement = new DropDownList({ popupHeight: '150px', width: '180px', change: instance.onListLevelValueChanged });\n        this.listLevelElement.appendTo(listLevel);\n        var followCharacterElement = document.getElementById(containerId + '_followCharacter');\n        this.followNumberWith = new DropDownList({ popupHeight: '150px', width: '180px', change: instance.onFollowCharacterValueChanged });\n        this.followNumberWith.appendTo(followCharacterElement);\n        var numberStyleEle = document.getElementById(containerId + '_numberStyle');\n        this.numberStyle = new DropDownList({ popupHeight: '150px', width: '180px', change: instance.onLevelPatternValueChanged });\n        this.numberStyle.appendTo(numberStyleEle);\n        this.numberFormat = document.getElementById(containerId + '_numberFormat');\n        this.numberFormat.addEventListener('change', instance.onNumberFormatChanged);\n        var restartElement = document.getElementById(containerId + '_restartBy');\n        this.restartBy = new DropDownList({ popupHeight: '150px', width: '180px' });\n        this.restartBy.appendTo(restartElement);\n        var button = document.getElementById(containerId + '_list_info');\n        this.formatInfoToolTip = new Tooltip({ width: 200 });\n        // tslint:disable-next-line:max-line-length\n        this.formatInfoToolTip.content = locale.getConstant('Number format tooltip information');\n        this.formatInfoToolTip.position = 'RightTop';\n        this.formatInfoToolTip.appendTo(button);\n    };\n    ListDialog.prototype.updateRestartLevelBox = function () {\n        var containerId = this.owner.owner.containerId;\n        var listLevel = document.getElementById(containerId + '_listLevel');\n        var restartBy = document.getElementById(containerId + '_restartBy');\n        for (var i = 0; i < restartBy.options.length; i) {\n            restartBy.options.remove(i);\n        }\n        if (listLevel.selectedIndex === 0) {\n            var option = document.createElement('option');\n            option.value = 'No Restart';\n            option.innerHTML = 'No Restart';\n            restartBy.appendChild(option);\n        }\n        else {\n            for (var i = listLevel.selectedIndex; i > 0; i--) {\n                var option_1 = document.createElement('option');\n                option_1.value = 'Level ' + i;\n                option_1.innerHTML = 'Level ' + i;\n                restartBy.appendChild(option_1);\n            }\n            var option = document.createElement('option');\n            option.value = 'No Restart';\n            option.innerHTML = 'No Restart';\n            restartBy.appendChild(option);\n        }\n        restartBy.selectedIndex = 0;\n    };\n    ListDialog.prototype.listPatternConverter = function (listLevelPattern) {\n        switch (listLevelPattern) {\n            case 'Arabic': return 0;\n            case 'UpRoman': return 1;\n            case 'LowRoman': return 2;\n            case 'UpLetter': return 3;\n            case 'LowLetter': return 4;\n            case 'Number': return 5;\n            case 'LeadingZero': return 6;\n            case 'Bullet': return 7;\n            case 'Ordinal': return 8;\n            case 'OrdinalText': return 9;\n            case 'Special': return 10;\n            case 'FarEast': return 11;\n            default: return 12;\n        }\n    };\n    ListDialog.prototype.followCharacterConverter = function (followCharacter) {\n        switch (followCharacter) {\n            case 'Tab':\n                return 0;\n            case 'Space':\n                return 1;\n            default:\n                return 2;\n        }\n    };\n    ListDialog.prototype.updateDialogValues = function () {\n        // tslint:disable-next-line:max-line-length\n        var restartByTextBox = document.getElementById(this.owner.owner.containerId + '_restartBy');\n        this.startAt.value = this.viewModel.listLevel.startAt;\n        this.textIndent.value = this.viewModel.listLevel.paragraphFormat.leftIndent;\n        this.alignedAt.value = this.viewModel.listLevel.paragraphFormat.firstLineIndent;\n        this.followNumberWith.index = this.followCharacterConverter(this.viewModel.followCharacter);\n        this.numberFormat.value = this.viewModel.listLevel.numberFormat;\n        this.numberStyle.index = this.listPatternConverter(this.viewModel.listLevelPattern);\n        this.listLevelElement.index = this.viewModel.levelNumber;\n        this.viewModel.levelNumber = this.viewModel.levelNumber;\n    };\n    ListDialog.prototype.disposeBindingForListUI = function () {\n        this.followNumberWith.index = -1;\n        this.numberFormat.value = ' ';\n        this.numberStyle.index = -1;\n        this.listLevelElement.index = -1;\n        this.restartBy.index = -1;\n        this.viewModel.destroy();\n    };\n    /**\n     * @private\n     */\n    ListDialog.prototype.destroy = function () {\n        if (this.alignedAt) {\n            this.alignedAt.destroy();\n        }\n        this.alignedAt = undefined;\n        this.dialog = undefined;\n        if (this.followNumberWith) {\n            this.followNumberWith.destroy();\n        }\n        this.followNumberWith = undefined;\n        if (this.listLevelElement) {\n            this.listLevelElement.destroy();\n        }\n        this.listLevelElement = undefined;\n        if (this.textIndent) {\n            this.textIndent.destroy();\n        }\n        this.textIndent = undefined;\n        if (this.startAt) {\n            this.startAt.destroy();\n        }\n        this.startAt = undefined;\n        if (this.numberStyle) {\n            this.numberStyle.destroy();\n        }\n        this.numberStyle = undefined;\n        this.numberFormat = undefined;\n        if (this.restartBy) {\n            this.restartBy.destroy();\n        }\n        this.restartBy = undefined;\n        if (!isNullOrUndefined(this.target)) {\n            if (this.target.parentElement) {\n                this.target.parentElement.removeChild(this.target);\n            }\n            for (var l = 0; l < this.target.childNodes.length; l++) {\n                this.target.removeChild(this.target.childNodes[l]);\n                l--;\n            }\n            this.target = undefined;\n        }\n        this.owner = undefined;\n        this.viewModel = undefined;\n    };\n    return ListDialog;\n}());\nexport { ListDialog };\n/* tslint:enable:no-any */ \n","import { createElement, isNullOrUndefined, L10n, setCulture } from '@syncfusion/ej2-base';\nimport { DropDownList, ComboBox } from '@syncfusion/ej2-dropdowns';\nimport { Button } from '@syncfusion/ej2-buttons';\nimport { WCharacterStyle, WParagraphStyle } from '../../implementation/format/style';\nimport { BulletsAndNumberingDialog } from './index';\nimport { WAbstractList } from '../list/abstract-list';\nimport { ColorPicker } from '@syncfusion/ej2-inputs';\nimport { DropDownButton } from '@syncfusion/ej2-splitbuttons';\n/**\n * The Style dialog is used to create or modify styles.\n */\nvar StyleDialog = /** @class */ (function () {\n    /**\n     * @private\n     */\n    function StyleDialog(viewer) {\n        var _this = this;\n        this.target = undefined;\n        this.styleType = undefined;\n        this.styleBasedOn = undefined;\n        this.styleParagraph = undefined;\n        this.onlyThisDocument = undefined;\n        this.template = undefined;\n        this.fontFamily = undefined;\n        this.fontSize = undefined;\n        this.characterFormat = undefined;\n        this.paragraphFormat = undefined;\n        /* tslint:disable-next-line:no-any */\n        this.openDialog = function (args) {\n            switch (args.item.id) {\n                case 'style_font':\n                    _this.showFontDialog();\n                    break;\n                case 'style_paragraph':\n                    _this.showParagraphDialog();\n                    break;\n                case 'style_numbering':\n                    _this.showNumberingBulletDialog();\n                    break;\n            }\n        };\n        this.setBoldProperty = function () {\n            _this.characterFormat.bold = !_this.characterFormat.bold;\n            _this.fontButtonClicked(undefined);\n        };\n        this.setItalicProperty = function () {\n            _this.characterFormat.italic = !_this.characterFormat.italic;\n            _this.fontButtonClicked(undefined);\n        };\n        this.setUnderlineProperty = function () {\n            _this.characterFormat.underline = _this.characterFormat.underline === 'None' ? 'Single' : 'None';\n            _this.fontButtonClicked(undefined);\n        };\n        /* tslint:disable-next-line:no-any */\n        this.fontButtonClicked = function (args) {\n            if (_this.characterFormat.bold) {\n                if (!_this.bold.classList.contains('e-active')) {\n                    _this.bold.classList.add('e-active');\n                }\n            }\n            else {\n                if (_this.bold.classList.contains('e-active')) {\n                    _this.bold.classList.remove('e-active');\n                }\n            }\n            if (_this.characterFormat.italic) {\n                if (!_this.italic.classList.contains('e-active')) {\n                    _this.italic.classList.add('e-active');\n                }\n            }\n            else {\n                if (_this.italic.classList.contains('e-active')) {\n                    _this.italic.classList.remove('e-active');\n                }\n            }\n            if (_this.characterFormat.underline !== undefined && _this.characterFormat.underline !== 'None') {\n                if (!_this.underline.classList.contains('e-active')) {\n                    _this.underline.classList.add('e-active');\n                    _this.characterFormat.underline = 'Single';\n                }\n            }\n            else {\n                if (_this.underline.classList.contains('e-active')) {\n                    _this.underline.classList.remove('e-active');\n                    _this.characterFormat.underline = 'None';\n                }\n            }\n        };\n        /* tslint:disable-next-line:no-any */\n        this.fontSizeUpdate = function (args) {\n            _this.characterFormat.fontSize = args.value;\n        };\n        /* tslint:disable-next-line:no-any */\n        this.fontFamilyChanged = function (args) {\n            _this.characterFormat.fontFamily = args.value;\n        };\n        /* tslint:disable-next-line:no-any */\n        this.fontColorUpdate = function (args) {\n            _this.characterFormat.fontColor = args.currentValue.rgba;\n        };\n        this.setLeftAlignment = function () {\n            if (_this.paragraphFormat.textAlignment === 'Left') {\n                _this.paragraphFormat.textAlignment = 'Justify';\n            }\n            else {\n                _this.paragraphFormat.textAlignment = 'Left';\n            }\n            _this.updateParagraphFormat();\n        };\n        this.setRightAlignment = function () {\n            if (_this.paragraphFormat.textAlignment === 'Right') {\n                _this.paragraphFormat.textAlignment = 'Left';\n            }\n            else {\n                _this.paragraphFormat.textAlignment = 'Right';\n            }\n            _this.updateParagraphFormat();\n        };\n        this.setCenterAlignment = function () {\n            if (_this.paragraphFormat.textAlignment === 'Center') {\n                _this.paragraphFormat.textAlignment = 'Left';\n            }\n            else {\n                _this.paragraphFormat.textAlignment = 'Center';\n            }\n            _this.updateParagraphFormat();\n        };\n        this.setJustifyAlignment = function () {\n            if (_this.paragraphFormat.textAlignment === 'Justify') {\n                _this.paragraphFormat.textAlignment = 'Left';\n            }\n            else {\n                _this.paragraphFormat.textAlignment = 'Justify';\n            }\n            _this.updateParagraphFormat();\n        };\n        this.increaseBeforeAfterSpacing = function () {\n            _this.paragraphFormat.beforeSpacing += 6;\n            _this.paragraphFormat.afterSpacing += 6;\n        };\n        this.decreaseBeforeAfterSpacing = function () {\n            if (_this.paragraphFormat.beforeSpacing >= 6) {\n                _this.paragraphFormat.beforeSpacing -= 6;\n            }\n            else {\n                _this.paragraphFormat.beforeSpacing = 0;\n            }\n            if (_this.paragraphFormat.afterSpacing >= 6) {\n                _this.paragraphFormat.afterSpacing -= 6;\n            }\n            else {\n                _this.paragraphFormat.afterSpacing = 0;\n            }\n        };\n        /**\n         * @private\n         */\n        this.updateNextStyle = function (args) {\n            var typedName = args.srcElement.value;\n            if (_this.getTypeValue() === 'Paragraph' && !isNullOrUndefined(typedName) && typedName !== '' && !_this.isUserNextParaUpdated) {\n                var styles = _this.owner.owner.viewer.styles.getStyleNames(_this.getTypeValue());\n                if (_this.isEdit) {\n                    styles = styles.filter(function (e) { return e !== _this.editStyleName; });\n                }\n                styles.push(typedName);\n                _this.styleParagraph.dataSource = styles;\n                _this.styleParagraph.index = null;\n                _this.styleParagraph.index = styles.indexOf(typedName);\n                _this.styleParagraph.dataBind();\n            }\n        };\n        /**\n         * @private\n         */\n        this.updateOkButton = function () {\n            var styleName = _this.target.getElementsByClassName('e-input e-de-style-dlg-name-input').item(0).value;\n            _this.enableOrDisableOkButton();\n        };\n        /**\n         * @private\n         */\n        /* tslint:disable-next-line:no-any */\n        this.styleTypeChange = function (args) {\n            if (args.isInteracted) {\n                var type = void 0;\n                if (args.value === 'Character') {\n                    _this.style = new WCharacterStyle();\n                    type = 'Character';\n                }\n                if (args.value === 'Paragraph' || args.value === 'Linked(Paragraph and Character)') {\n                    _this.style = new WParagraphStyle();\n                    type = 'Paragraph';\n                }\n                _this.toggleDisable();\n                _this.updateStyleNames(type);\n            }\n        };\n        /* tslint:disable-next-line:no-any */\n        this.styleBasedOnChange = function (args) {\n            //Based on change\n        };\n        /**\n         * @private\n         */\n        /* tslint:disable-next-line:no-any */\n        this.styleParagraphChange = function (args) {\n            if (args.isInteracted) {\n                _this.isUserNextParaUpdated = true;\n            }\n            //Next change\n        };\n        /**\n         * @private\n         */\n        this.showFontDialog = function () {\n            if (!isNullOrUndefined(_this.owner.owner.fontDialogModule)) {\n                _this.owner.owner.showFontDialog(_this.characterFormat);\n            }\n            _this.updateCharacterFormat();\n        };\n        /**\n         * @private\n         */\n        this.showParagraphDialog = function () {\n            if (!isNullOrUndefined(_this.owner.owner.paragraphDialogModule)) {\n                _this.owner.owner.showParagraphDialog(_this.paragraphFormat);\n            }\n        };\n        /**\n         * @private\n         */\n        this.showNumberingBulletDialog = function () {\n            _this.numberingBulletDialog = new BulletsAndNumberingDialog(_this.owner.owner.viewer);\n            if (_this.style instanceof WParagraphStyle && (!isNullOrUndefined(_this.style.paragraphFormat))) {\n                // tslint:disable-next-line:max-line-length\n                _this.numberingBulletDialog.showNumberBulletDialog(_this.style.paragraphFormat.listFormat, _this.abstractList);\n            }\n        };\n        /**\n         * @private\n         */\n        this.onOkButtonClick = function () {\n            var styleName = _this.styleNameElement.value;\n            if (styleName.length > 0) {\n                var style = _this.owner.owner.viewer.styles.findByName(styleName);\n                var name_1;\n                if (!isNullOrUndefined(style)) {\n                    _this.style.type = _this.getTypeValue();\n                    _this.style.basedOn = _this.owner.owner.viewer.styles.findByName(_this.styleBasedOn.value);\n                    if (_this.styleType.value === 'Paragraph' || _this.styleType.value === 'Linked(Paragraph and Character)') {\n                        _this.style.next = _this.owner.owner.viewer.styles.findByName(_this.styleParagraph.value);\n                        _this.style.characterFormat.mergeFormat(style.characterFormat);\n                        _this.style.paragraphFormat.mergeFormat(style.paragraphFormat);\n                        _this.updateList();\n                        // tslint:disable-next-line:max-line-length\n                        _this.style.link = (_this.styleType.value === 'Linked(Paragraph and Character)') ? _this.createLinkStyle(styleName, _this.isEdit) : undefined;\n                    }\n                    //Updating existing style implementation\n                    _this.style.name = style.name;\n                    name_1 = style.name;\n                    style = _this.style;\n                    _this.owner.owner.isShiftingEnabled = true;\n                    _this.owner.owner.editorModule.layoutWholeDocument();\n                    _this.owner.owner.isShiftingEnabled = false;\n                }\n                else {\n                    /* tslint:disable-next-line:no-any */\n                    var basedOn = _this.owner.owner.viewer.styles.findByName(_this.styleBasedOn.value);\n                    if (_this.styleType.value === 'Paragraph' || _this.styleType.value === 'Linked(Paragraph and Character)') {\n                        if (styleName === _this.styleParagraph.value) {\n                            _this.style.next = _this.style;\n                        }\n                        else {\n                            _this.style.next = _this.owner.owner.viewer.styles.findByName(_this.styleParagraph.value);\n                        }\n                        _this.updateList();\n                    }\n                    // tslint:disable-next-line:max-line-length\n                    _this.style.link = (_this.styleType.value === 'Linked(Paragraph and Character)') ? _this.createLinkStyle(styleName) : undefined;\n                    _this.style.type = _this.getTypeValue();\n                    _this.style.name = styleName;\n                    _this.style.basedOn = basedOn;\n                    /* tslint:disable-next-line:no-any */\n                    _this.owner.owner.viewer.styles.push(_this.style);\n                    name_1 = styleName;\n                    _this.owner.owner.editorModule.applyStyle(name_1);\n                }\n                _this.owner.owner.viewer.dialog2.hide();\n            }\n            else {\n                throw new Error('Enter valid Style name');\n            }\n            if (_this.style) {\n                //this.style.destroy();\n            }\n        };\n        /* tslint:disable-next-line:no-any */\n        this.loadStyleDialog = function (args) {\n            _this.owner.owner.viewer.updateFocus();\n            _this.isUserNextParaUpdated = false;\n            /* tslint:disable-next-line:max-line-length */\n            _this.styleNameElement = _this.target.getElementsByClassName('e-input e-de-style-dlg-name-input').item(0);\n            _this.styleNameElement.value = null;\n            if (!_this.isEdit) {\n                _this.styleType.index = 0; //Set to paragraph            \n            }\n            var name;\n            if (_this.isEdit) {\n                _this.styleNameElement.value = _this.editStyleName;\n                name = _this.editStyleName;\n            }\n            /* tslint:disable-next-line:max-line-length */\n            _this.okButton = _this.owner.dialog2.element.getElementsByClassName('e-flat e-style-okay').item(0);\n            _this.enableOrDisableOkButton();\n            _this.updateStyleNames(_this.getTypeValue(), name);\n            _this.updateCharacterFormat(_this.style.characterFormat);\n            _this.updateParagraphFormat(_this.style.paragraphFormat);\n        };\n        /**\n         * @private\n         */\n        this.onCancelButtonClick = function () {\n            if (!_this.isEdit && _this.style) {\n                _this.style.destroy();\n            }\n            _this.owner.owner.viewer.dialog2.hide();\n        };\n        /**\n         * @private\n         */\n        this.closeStyleDialog = function () {\n            _this.owner.owner.viewer.updateFocus();\n        };\n        this.owner = viewer;\n    }\n    /**\n     * @private\n     */\n    StyleDialog.prototype.getModuleName = function () {\n        return 'StyleDialog';\n    };\n    /**\n     * @private\n     */\n    //tslint:disable: max-func-body-length\n    StyleDialog.prototype.initStyleDialog = function (localValue) {\n        var instance = this;\n        var id = this.owner.owner.containerId + '_style';\n        this.target = createElement('div', { id: id, className: 'e-de-style-dialog' });\n        var container = createElement('div');\n        // tslint:disable-next-line:max-line-length\n        var properties = createElement('div', { className: 'e-de-style-properties', innerHTML: localValue.getConstant('Properties') });\n        container.appendChild(properties);\n        var styleNameTypeDiv = createElement('div', { styles: 'display:flex', className: 'e-de-style-nametype-div' });\n        container.appendChild(styleNameTypeDiv);\n        var nameWholeDiv = createElement('div', { className: 'e-de-style-left-div' });\n        styleNameTypeDiv.appendChild(nameWholeDiv);\n        var name = createElement('div', { className: 'e-de-style-name', innerHTML: localValue.getConstant('Name') + ':' });\n        nameWholeDiv.appendChild(name);\n        // tslint:disable-next-line:max-line-length\n        var nameValue = createElement('input', { id: this.owner.owner.containerId + '_style_name', styles: 'width:210px;', className: 'e-input e-de-style-dlg-name-input' });\n        nameValue.addEventListener('keyup', this.updateOkButton);\n        nameValue.addEventListener('input', this.updateOkButton);\n        nameValue.addEventListener('blur', this.updateNextStyle);\n        nameWholeDiv.appendChild(nameValue);\n        var styleTypeWholeDiv = createElement('div');\n        styleNameTypeDiv.appendChild(styleTypeWholeDiv);\n        // tslint:disable-next-line:max-line-length\n        var styleType = createElement('div', { className: 'e-de-style-styletype', innerHTML: localValue.getConstant('Style type') + ':' });\n        styleTypeWholeDiv.appendChild(styleType);\n        var styleTypeDivElement = createElement('div', { className: 'e-de-style-style-type-div' });\n        var styleTypeValue = createElement('select', { id: 'e-de-style-style-type' });\n        // tslint:disable-next-line:max-line-length\n        styleTypeValue.innerHTML = '<option>Paragraph</option><option>Character</option><option>Linked(Paragraph and Character)</option>'; //<option>Linked(Paragraph and Character)</option><option>Table</option><option>List</option>';\n        styleTypeDivElement.appendChild(styleTypeValue);\n        this.styleType = new DropDownList({ change: this.styleTypeChange, popupHeight: '253px', width: '210px' });\n        this.styleType.appendTo(styleTypeValue);\n        styleTypeWholeDiv.appendChild(styleTypeDivElement);\n        // tslint:disable-next-line:max-line-length\n        var styleBasedParaDiv = createElement('div', { styles: 'display:flex', className: 'e-de-style-based-para-div' });\n        container.appendChild(styleBasedParaDiv);\n        var styleBasedOnWholeDiv = createElement('div', { className: 'e-de-style-left-div' });\n        styleBasedParaDiv.appendChild(styleBasedOnWholeDiv);\n        // tslint:disable-next-line:max-line-length\n        var styleBasedOn = createElement('div', { className: 'e-de-style-style-based-on', innerHTML: localValue.getConstant('Style based on') + ':' });\n        styleBasedOnWholeDiv.appendChild(styleBasedOn);\n        var styleBasedOnDivElement = createElement('div', { className: 'e-de-style-style-based-on-div' });\n        // tslint:disable-next-line:max-line-length\n        var styleBasedOnValue = createElement('input', { id: 'e-de-style-style-based-on-value' });\n        //styleBasedOnValue.innerHTML = '<option>Normal</option><option>Heading 1</option><option>Heading 2</option><option>Heading 3</option><option>Heading 4</option><option>Heading 5</option><option>Heading 6</option>';\n        styleBasedOnDivElement.appendChild(styleBasedOnValue);\n        this.styleBasedOn = new DropDownList({ dataSource: [], select: this.styleBasedOnChange, popupHeight: '253px', width: '210px' });\n        this.styleBasedOn.appendTo(styleBasedOnValue);\n        styleBasedOnWholeDiv.appendChild(styleBasedOnDivElement);\n        var styleParagraphWholeDiv = createElement('div', { className: 'e-de-style-left-div' });\n        styleBasedParaDiv.appendChild(styleParagraphWholeDiv);\n        // tslint:disable-next-line:max-line-length\n        var styleParagraph = createElement('div', { className: 'e-de-style-style-paragraph', innerHTML: localValue.getConstant('Style for following paragraph') + ':' });\n        styleParagraphWholeDiv.appendChild(styleParagraph);\n        var styleParagraphDivElement = createElement('div', { className: 'e-de-style-style-paragraph-div' });\n        // tslint:disable-next-line:max-line-length\n        var styleParagraphValue = createElement('input', { id: 'e-de-style-style-paragraph-value' });\n        // tslint:disable-next-line:max-line-length\n        //styleParagraphValue.innerHTML = '<option>Normal</option><option>Heading 1</option><option>Heading 2</option><option>Heading 3</option><option>Heading 4</option><option>Heading 5</option><option>Heading 6</option>';\n        styleParagraphDivElement.appendChild(styleParagraphValue);\n        this.styleParagraph = new DropDownList({ dataSource: [], select: this.styleParagraphChange, popupHeight: '253px', width: '210px' });\n        this.styleParagraph.appendTo(styleParagraphValue);\n        styleParagraphWholeDiv.appendChild(styleParagraphDivElement);\n        // tslint:disable-next-line:max-line-length\n        var formatting = createElement('div', { className: 'e-de-style-formatting', innerHTML: localValue.getConstant('Formatting') });\n        container.appendChild(formatting);\n        var optionsDiv = createElement('div', { className: 'e-de-style-options-div' });\n        container.appendChild(optionsDiv);\n        var fontOptionsDiv = createElement('div', { styles: 'display:flex;margin-bottom: 15px;' });\n        optionsDiv.appendChild(fontOptionsDiv);\n        this.createFontOptions(fontOptionsDiv);\n        var paragraphOptionsDiv = createElement('div', { styles: 'display:flex', className: 'e-style-paragraph' });\n        optionsDiv.appendChild(paragraphOptionsDiv);\n        this.createParagraphOptions(paragraphOptionsDiv);\n        // let radioOptionsDiv: HTMLElement = createElement('div', { styles: 'display:flex' });\n        // container.appendChild(radioOptionsDiv);\n        // let onlyThisDocumentDiv: HTMLElement = createElement('div', { className: 'e-de-style-radio-button' });\n        // tslint:disable-next-line:max-line-length\n        // let onlyThisDocument: HTMLInputElement = createElement('input', { className: 'e-de-style-only-this-doc', attrs: { type: 'radio' } }) as HTMLInputElement;\n        // onlyThisDocumentDiv.appendChild(onlyThisDocument);\n        // tslint:disable-next-line:max-line-length\n        // this.onlyThisDocument = new RadioButton({ label: 'Only in this document', value: 'only in this document', checked: true, name: 'styles' });\n        // this.onlyThisDocument.appendTo(onlyThisDocument);\n        // radioOptionsDiv.appendChild(onlyThisDocumentDiv);\n        // let templateDiv: HTMLElement = createElement('div', { className: 'e-de-style-radio-button' });\n        // tslint:disable-next-line:max-line-length\n        // let template: HTMLInputElement = createElement('input', { className: 'e-de-style-temp', attrs: { type: 'radio' } }) as HTMLInputElement;\n        // templateDiv.appendChild(template);\n        // this.template = new RadioButton({ label: 'Template', value: 'template', name: 'styles' });\n        // this.template.appendTo(template);\n        // radioOptionsDiv.appendChild(templateDiv);\n        this.createFormatDropdown(container, localValue);\n        this.target.appendChild(container);\n    };\n    StyleDialog.prototype.createFormatDropdown = function (parentDiv, localValue) {\n        var _this = this;\n        var formatBtn = createElement('button', { id: 'style_format_dropdown', innerHTML: localValue.getConstant('Format') });\n        formatBtn.style.height = '35px';\n        parentDiv.appendChild(formatBtn);\n        var items = [{ text: localValue.getConstant('Font') + '..', id: 'style_font' },\n            { text: localValue.getConstant('Paragraph') + '..', id: 'style_paragraph' },\n            { text: localValue.getConstant('Numbering') + '..', id: 'style_numbering' }];\n        var dropDownbtn = new DropDownButton({\n            items: items, cssClass: 'e-de-style-format-dropdwn',\n            beforeItemRender: function (args) {\n                if (_this.styleType.value === 'Character') {\n                    if (args.item.text === 'Paragraph') {\n                        args.element.classList.add('e-disabled');\n                    }\n                    if (args.item.text === 'Numbering') {\n                        args.element.classList.add('e-disabled');\n                    }\n                }\n                else {\n                    if (args.item.text === 'Paragraph') {\n                        args.element.classList.remove('e-disabled');\n                    }\n                    if (args.item.text === 'Numbering') {\n                        args.element.classList.remove('e-disabled');\n                    }\n                }\n            }\n        });\n        dropDownbtn.appendTo(formatBtn);\n        dropDownbtn.addEventListener('select', this.openDialog);\n    };\n    StyleDialog.prototype.createFontOptions = function (parentDiv) {\n        var fontFamilyElement = createElement('select', { id: this.target.id + '_fontName' });\n        fontFamilyElement.innerHTML = '<option>Arial</option><option>Calibri</option><option>Candara</option>' +\n            '<option>Comic Sans MS</option><option>Consolas</option><option>Constantia</option><option>Corbel</option>' +\n            '<option>Courier New</option><option>Ebrima</option><option>Franklin Gothic</option>' +\n            '<option>Gabriola</option><option>Gadugi</option><option>Georgia</option><option>Impact</option>' +\n            '<option>Javanese Text</option><option>Microsoft Sans Serif</option><option>MS Gothic</option><option>MS UI Gothic</option>' +\n            '<option>Segoe Print</option><option>Times New Roman</option><option>Verdana</option><option>Segoe UI</option>' +\n            '<option>Algerian</option><option>Cambria</option><option>Georgia</option><option>Consolas</option>';\n        parentDiv.appendChild(fontFamilyElement);\n        this.fontFamily = new ComboBox({\n            width: '123px', popupWidth: '123px',\n            cssClass: 'e-style-font-fmaily-right', change: this.fontFamilyChanged\n        });\n        this.fontFamily.showClearButton = false;\n        this.fontFamily.appendTo(fontFamilyElement);\n        var fontSizeElement = createElement('input');\n        parentDiv.appendChild(fontSizeElement);\n        var sizeDataSource = [8, 9, 10, 11, 12, 14, 16, 18, 20, 22, 24, 26, 28, 36, 48, 72];\n        this.fontSize = new ComboBox({\n            dataSource: sizeDataSource, width: '73px', cssClass: 'e-style-font-fmaily-right',\n            change: this.fontSizeUpdate\n        });\n        this.fontSize.showClearButton = false;\n        this.fontSize.appendTo(fontSizeElement);\n        var fontGroupButton = createElement('div', { className: 'e-de-style-font-group-button' });\n        parentDiv.appendChild(fontGroupButton);\n        // tslint:disable-next-line:max-line-length\n        this.bold = this.createButtonElement(fontGroupButton, 'e-de-bold', 'e-de-style-bold-button-size', this.owner.owner.containerId + '_style_bold');\n        this.bold.addEventListener('click', this.setBoldProperty);\n        // tslint:disable-next-line:max-line-length\n        this.italic = this.createButtonElement(fontGroupButton, 'e-de-italic', 'e-de-style-icon-button-size', this.owner.owner.containerId + '_style_italic');\n        this.italic.addEventListener('click', this.setItalicProperty);\n        // tslint:disable-next-line:max-line-length\n        this.underline = this.createButtonElement(fontGroupButton, 'e-de-underline', 'e-de-style-icon-button-size', this.owner.owner.containerId + '_style_underline');\n        this.underline.addEventListener('click', this.setUnderlineProperty);\n        var fontColorElement = createElement('input', { attrs: { type: 'color' }, className: 'e-de-style-icon-button-size' });\n        parentDiv.appendChild(fontColorElement);\n        this.fontColor = new ColorPicker({ cssClass: 'e-de-style-font-color-picker', change: this.fontColorUpdate });\n        this.fontColor.appendTo(fontColorElement);\n    };\n    StyleDialog.prototype.createParagraphOptions = function (parentDiv) {\n        var _this = this;\n        var alignmentDiv = createElement('div', { className: 'e-de-style-paragraph-group-button' });\n        parentDiv.appendChild(alignmentDiv);\n        this.leftAlign = this.createButtonElement(alignmentDiv, 'e-de-align-left', 'e-de-style-icon-button-size');\n        this.leftAlign.addEventListener('click', this.setLeftAlignment);\n        this.centerAlign = this.createButtonElement(alignmentDiv, 'e-de-align-center', 'e-de-style-icon-button-size');\n        this.centerAlign.addEventListener('click', this.setCenterAlignment);\n        this.rightAlign = this.createButtonElement(alignmentDiv, 'e-de-align-right', 'e-de-style-icon-button-size');\n        this.rightAlign.addEventListener('click', this.setRightAlignment);\n        this.justify = this.createButtonElement(alignmentDiv, 'e-de-justify', 'e-de-style-icon-button-last-size');\n        this.justify.addEventListener('click', this.setJustifyAlignment);\n        var lineSpacingDiv = createElement('div', { className: 'e-de-style-paragraph-group-button' });\n        parentDiv.appendChild(lineSpacingDiv);\n        this.singleLineSpacing = this.createButtonElement(lineSpacingDiv, 'e-de-single-spacing', 'e-de-style-icon-button-first-size');\n        this.singleLineSpacing.addEventListener('click', function () {\n            _this.paragraphFormat.lineSpacing = 1;\n            _this.updateParagraphFormat();\n        });\n        // tslint:disable-next-line:max-line-length\n        this.onePointFiveLineSpacing = this.createButtonElement(lineSpacingDiv, 'e-de-one-point-five-spacing', 'e-de-style-icon-button-size');\n        this.onePointFiveLineSpacing.addEventListener('click', function () {\n            _this.paragraphFormat.lineSpacing = 1.5;\n            _this.updateParagraphFormat();\n        });\n        this.doubleLineSpacing = this.createButtonElement(lineSpacingDiv, 'e-de-double-spacing', 'e-de-style-icon-button-last-size');\n        this.doubleLineSpacing.addEventListener('click', function () {\n            _this.paragraphFormat.lineSpacing = 2;\n            _this.updateParagraphFormat();\n        });\n        var spacingDiv = createElement('div', { className: 'e-de-style-paragraph-group-button' });\n        parentDiv.appendChild(spacingDiv);\n        var beforeSpacing = this.createButtonElement(spacingDiv, 'e-de-before-spacing', 'e-de-style-icon-button-first-size');\n        var afterSpacing = this.createButtonElement(spacingDiv, 'e-de-after-spacing', 'e-de-style-icon-button-last-size');\n        beforeSpacing.addEventListener('click', this.increaseBeforeAfterSpacing);\n        afterSpacing.addEventListener('click', this.decreaseBeforeAfterSpacing);\n        var indentingDiv = createElement('div', { className: 'e-de-style-paragraph-indent-group-button' });\n        parentDiv.appendChild(indentingDiv);\n        var decreaseIndent = this.createButtonElement(indentingDiv, 'e-de-indent', 'e-de-style-icon-button-first-size');\n        decreaseIndent.addEventListener('click', function () {\n            if (_this.paragraphFormat.leftIndent >= 36) {\n                _this.paragraphFormat.leftIndent -= 36;\n            }\n            else {\n                _this.paragraphFormat.leftIndent = 0;\n            }\n        });\n        var increaseindent = this.createButtonElement(indentingDiv, 'e-de-outdent', 'e-de-style-icon-button-size');\n        increaseindent.addEventListener('click', function () {\n            _this.paragraphFormat.leftIndent += 36;\n        });\n    };\n    StyleDialog.prototype.createButtonElement = function (parentDiv, iconCss, className, id) {\n        var buttonElement = createElement('button');\n        if (!isNullOrUndefined(id)) {\n            buttonElement.id = id;\n        }\n        parentDiv.appendChild(buttonElement);\n        var button = new Button({ iconCss: iconCss, cssClass: className });\n        button.appendTo(buttonElement);\n        return buttonElement;\n    };\n    StyleDialog.prototype.toggleDisable = function () {\n        if (this.styleType.value === 'Character') {\n            this.styleParagraph.enabled = false;\n            // tslint:disable-next-line:max-line-length\n            this.target.getElementsByClassName('e-style-paragraph').item(0).setAttribute('style', 'display:flex;pointer-events:none;opacity:0.5');\n        }\n        else {\n            this.styleParagraph.enabled = true;\n            this.target.getElementsByClassName('e-style-paragraph').item(0).removeAttribute('style');\n            this.target.getElementsByClassName('e-style-paragraph').item(0).setAttribute('style', 'display:flex');\n        }\n        this.styleBasedOn.enabled = true;\n    };\n    /**\n     * @private\n     */\n    StyleDialog.prototype.show = function (styleName, header) {\n        var localObj = new L10n('documenteditor', this.owner.owner.defaultLocale);\n        this.isEdit = (!isNullOrUndefined(styleName) && styleName.length > 0) ? true : false;\n        this.editStyleName = styleName;\n        this.abstractList = new WAbstractList();\n        // tslint:disable-next-line:max-line-length\n        var style = this.owner.owner.viewer.styles.findByName(styleName);\n        this.style = !this.isEdit ? new WParagraphStyle() : style ? style : this.getStyle(styleName);\n        localObj.setLocale(this.owner.owner.locale);\n        setCulture(this.owner.owner.locale);\n        if (!this.target) {\n            this.initStyleDialog(localObj);\n        }\n        if (isNullOrUndefined(header)) {\n            header = localObj.getConstant('Create New Style');\n        }\n        this.owner.owner.viewer.dialog2.header = header;\n        this.owner.owner.viewer.dialog2.height = 'auto';\n        this.owner.owner.viewer.dialog2.width = 'auto';\n        this.owner.owner.viewer.dialog2.content = this.target;\n        this.owner.owner.viewer.dialog2.buttons = [{\n                click: this.onOkButtonClick,\n                buttonModel: { content: localObj.getConstant('Ok'), cssClass: 'e-flat e-style-okay', isPrimary: true }\n            },\n            {\n                click: this.onCancelButtonClick,\n                buttonModel: { content: localObj.getConstant('Cancel'), cssClass: 'e-flat e-style-cancel' }\n            }];\n        this.toggleDisable();\n        this.owner.owner.viewer.dialog2.dataBind();\n        this.owner.owner.viewer.dialog2.beforeOpen = this.loadStyleDialog;\n        this.owner.owner.viewer.dialog2.close = this.closeStyleDialog;\n        this.owner.owner.viewer.dialog2.position = { X: 'center', Y: 'center' };\n        this.owner.owner.viewer.dialog2.show();\n    };\n    StyleDialog.prototype.updateList = function () {\n        var listId = this.style.paragraphFormat.listFormat.listId;\n        if (listId > -1) {\n            if (this.owner.owner.viewer.lists.filter(function (a) { return (a.listId === listId); }).length === 0) {\n                this.owner.owner.viewer.lists.push(this.style.paragraphFormat.listFormat.list);\n            }\n            else {\n                this.owner.owner.viewer.lists = this.owner.owner.viewer.lists.filter(function (a) { return (a.listId !== listId); });\n                this.owner.owner.viewer.lists.push(this.style.paragraphFormat.listFormat.list);\n            }\n        }\n        if (this.abstractList.abstractListId !== -1) {\n            this.owner.owner.viewer.abstractLists.push(this.abstractList);\n        }\n    };\n    StyleDialog.prototype.createLinkStyle = function (name, isEdit) {\n        var charStyle;\n        if (isEdit) {\n            charStyle = this.owner.owner.viewer.styles.findByName((name + ' Char'), 'Character');\n        }\n        else {\n            charStyle = new WCharacterStyle();\n        }\n        charStyle.type = 'Character';\n        charStyle.name = name + ' Char';\n        charStyle.characterFormat = this.style.characterFormat.cloneFormat();\n        charStyle.basedOn = this.style.basedOn;\n        if (!isEdit) {\n            this.owner.owner.viewer.styles.push(charStyle);\n        }\n        return this.owner.owner.viewer.styles.findByName(charStyle.name, 'Character');\n    };\n    /**\n     * @private\n     */\n    StyleDialog.prototype.updateCharacterFormat = function (characterFormat) {\n        if (!isNullOrUndefined(characterFormat)) {\n            this.characterFormat = characterFormat;\n        }\n        this.fontFamily.value = this.characterFormat.fontFamily;\n        this.fontSize.value = this.characterFormat.fontSize;\n        this.fontColor.value = this.characterFormat.fontColor;\n        this.fontButtonClicked(undefined);\n    };\n    /**\n     * @private\n     */\n    StyleDialog.prototype.updateParagraphFormat = function (paragraphFOrmat) {\n        if (!isNullOrUndefined(paragraphFOrmat)) {\n            this.paragraphFormat = paragraphFOrmat;\n        }\n        if (this.paragraphFormat.textAlignment === 'Left') {\n            if (!this.leftAlign.classList.contains('e-active')) {\n                this.leftAlign.classList.add('e-active');\n            }\n            if (this.rightAlign.classList.contains('e-active')) {\n                this.rightAlign.classList.remove('e-active');\n            }\n            if (this.centerAlign.classList.contains('e-active')) {\n                this.centerAlign.classList.remove('e-active');\n            }\n            if (this.justify.classList.contains('e-active')) {\n                this.justify.classList.remove('e-active');\n            }\n        }\n        else if (this.paragraphFormat.textAlignment === 'Right') {\n            if (this.leftAlign.classList.contains('e-active')) {\n                this.leftAlign.classList.remove('e-active');\n            }\n            if (!this.rightAlign.classList.contains('e-active')) {\n                this.rightAlign.classList.add('e-active');\n            }\n            if (this.centerAlign.classList.contains('e-active')) {\n                this.centerAlign.classList.remove('e-active');\n            }\n            if (this.justify.classList.contains('e-active')) {\n                this.justify.classList.remove('e-active');\n            }\n        }\n        else if (this.paragraphFormat.textAlignment === 'Center') {\n            if (this.leftAlign.classList.contains('e-active')) {\n                this.leftAlign.classList.remove('e-active');\n            }\n            if (this.rightAlign.classList.contains('e-active')) {\n                this.rightAlign.classList.remove('e-active');\n            }\n            if (!this.centerAlign.classList.contains('e-active')) {\n                this.centerAlign.classList.add('e-active');\n            }\n            if (this.justify.classList.contains('e-active')) {\n                this.justify.classList.remove('e-active');\n            }\n        }\n        else if (this.paragraphFormat.textAlignment === 'Justify') {\n            if (this.leftAlign.classList.contains('e-active')) {\n                this.leftAlign.classList.remove('e-active');\n            }\n            if (this.rightAlign.classList.contains('e-active')) {\n                this.rightAlign.classList.remove('e-active');\n            }\n            if (this.centerAlign.classList.contains('e-active')) {\n                this.centerAlign.classList.remove('e-active');\n            }\n            if (!this.justify.classList.contains('e-active')) {\n                this.justify.classList.add('e-active');\n            }\n        }\n        if (this.paragraphFormat.lineSpacing === 1) {\n            this.singleLineSpacing.classList.add('e-active');\n            this.onePointFiveLineSpacing.classList.remove('e-active');\n            this.doubleLineSpacing.classList.remove('e-active');\n        }\n        else if (this.paragraphFormat.lineSpacing === 1.5) {\n            this.singleLineSpacing.classList.remove('e-active');\n            this.onePointFiveLineSpacing.classList.add('e-active');\n            this.doubleLineSpacing.classList.remove('e-active');\n        }\n        else if (this.paragraphFormat.lineSpacing === 2) {\n            this.singleLineSpacing.classList.remove('e-active');\n            this.onePointFiveLineSpacing.classList.remove('e-active');\n            this.doubleLineSpacing.classList.add('e-active');\n        }\n        else {\n            this.singleLineSpacing.classList.remove('e-active');\n            this.onePointFiveLineSpacing.classList.remove('e-active');\n            this.doubleLineSpacing.classList.remove('e-active');\n        }\n    };\n    StyleDialog.prototype.enableOrDisableOkButton = function () {\n        if (!isNullOrUndefined(this.okButton)) {\n            this.okButton.disabled = (this.styleNameElement.value === '');\n        }\n    };\n    StyleDialog.prototype.getTypeValue = function () {\n        var type;\n        if (this.styleType.value === 'Linked(Paragraph and Character)' || this.styleType.value === 'Paragraph') {\n            return 'Paragraph';\n        }\n        else {\n            return 'Character';\n        }\n    };\n    StyleDialog.prototype.updateStyleNames = function (type, name) {\n        var styles = this.owner.owner.viewer.styles.getStyleNames(type);\n        this.styleParagraph.dataSource = styles;\n        this.styleParagraph.index = null;\n        if (name) {\n            this.styleBasedOn.dataSource = styles.filter(function (e) { return e !== name; });\n            this.styleBasedOn.index = null;\n            var style = this.getStyle(name);\n            if (style.basedOn instanceof String || isNullOrUndefined(style.basedOn)) {\n                this.styleBasedOn.enabled = false;\n            }\n            else {\n                /* tslint:disable-next-line:max-line-length */\n                this.styleBasedOn.index = styles.indexOf(style.basedOn.name) > -1 ? styles.indexOf(style.basedOn.name) : 0;\n            }\n            if (style.type === 'Paragraph') {\n                if (!isNullOrUndefined(style.link)) {\n                    this.styleType.index = 2;\n                }\n                else {\n                    this.styleType.index = 0;\n                }\n            }\n            else {\n                this.styleType.index = 1;\n            }\n            if (!isNullOrUndefined(style.next)) {\n                var nxtName = style.next.name;\n                var index = 0;\n                if (styles.indexOf(nxtName) > -1) {\n                    index = styles.indexOf(nxtName);\n                }\n                this.styleParagraph.index = index;\n                this.isUserNextParaUpdated = (nxtName === name) ? false : true;\n            }\n        }\n        else {\n            this.styleBasedOn.dataSource = styles;\n            this.styleBasedOn.index = null;\n            var basedOnIndex = 0;\n            if (this.owner.owner.selectionModule) {\n                var styleName = void 0;\n                if (type === 'Character') {\n                    styleName = this.owner.owner.selection.characterFormat.styleName;\n                }\n                else {\n                    styleName = this.owner.owner.selection.paragraphFormat.styleName;\n                }\n                basedOnIndex = styles.indexOf(styleName);\n            }\n            this.styleBasedOn.index = basedOnIndex;\n            this.styleParagraph.index = 0;\n        }\n        if (this.isEdit) {\n            this.styleType.enabled = false;\n        }\n        else {\n            this.styleType.enabled = true;\n        }\n        this.styleBasedOn.dataBind();\n        this.styleParagraph.dataBind();\n    };\n    StyleDialog.prototype.getStyle = function (styleName) {\n        /* tslint:disable-next-line:max-line-length */\n        if (isNullOrUndefined(this.owner.owner.viewer.styles.findByName(styleName))) {\n            /* tslint:disable-next-line:max-line-length */\n            this.owner.owner.editor.createStyle(this.owner.owner.viewer.preDefinedStyles.get(styleName));\n        }\n        return this.owner.owner.viewer.styles.findByName(styleName);\n    };\n    /**\n     * @private\n     */\n    StyleDialog.prototype.destroy = function () {\n        this.owner = undefined;\n        if (!isNullOrUndefined(this.target)) {\n            if (this.target.parentElement) {\n                this.target.parentElement.removeChild(this.target);\n            }\n            for (var n = 0; n < this.target.childNodes.length; n++) {\n                this.target.removeChild(this.target.childNodes[n]);\n                n--;\n            }\n            this.target = undefined;\n        }\n        if (this.styleType) {\n            this.styleType.destroy();\n        }\n        this.styleType = undefined;\n        if (this.styleBasedOn) {\n            this.styleBasedOn.destroy();\n        }\n        this.styleBasedOn = undefined;\n        if (this.styleParagraph) {\n            this.styleParagraph.destroy();\n        }\n        this.styleParagraph = undefined;\n        if (this.onlyThisDocument) {\n            this.onlyThisDocument.destroy();\n        }\n        this.onlyThisDocument = undefined;\n        if (this.template) {\n            this.template.destroy();\n        }\n        this.template = undefined;\n        if (this.style) {\n            this.style = undefined;\n        }\n        if (this.abstractList) {\n            this.abstractList = undefined;\n        }\n        if (this.numberingBulletDialog) {\n            this.numberingBulletDialog.destroy();\n        }\n        this.numberingBulletDialog = undefined;\n    };\n    return StyleDialog;\n}());\nexport { StyleDialog };\n","import { createElement, isNullOrUndefined, L10n, setCulture } from '@syncfusion/ej2-base';\nimport { Tab } from '@syncfusion/ej2-navigations';\nimport { WList } from '../list/list';\nimport { WAbstractList } from '../list/abstract-list';\nimport { WListLevel } from '../list/list-level';\nimport { WListFormat } from '../../implementation/format/list-format';\n/**\n * The Bullets and Numbering dialog is used to apply list format for a paragraph style.\n */\n/* tslint:disable:no-any */\nvar BulletsAndNumberingDialog = /** @class */ (function () {\n    /**\n     * @private\n     */\n    function BulletsAndNumberingDialog(layoutViewer) {\n        var _this = this;\n        this.isBullet = false;\n        /**\n         * @private\n         */\n        this.numberListClick = function (args) {\n            _this.isBullet = false;\n            _this.setActiveElement(args);\n            if (args.currentTarget.classList.contains('e-de-list-numbered-none')) {\n                _this.numberFormat = undefined;\n                _this.listLevelPattern = undefined;\n            }\n            else if (args.currentTarget.classList.contains('e-de-list-numbered-number-dot')) {\n                _this.numberFormat = '%1.';\n                _this.listLevelPattern = 'Arabic';\n            }\n            else if (args.currentTarget.classList.contains('e-de-list-numbered-number-brace')) {\n                _this.numberFormat = '%1)';\n                _this.listLevelPattern = 'Arabic';\n            }\n            else if (args.currentTarget.classList.contains('e-de-list-numbered-up-roman')) {\n                _this.numberFormat = '%1.';\n                _this.listLevelPattern = 'UpRoman';\n            }\n            else if (args.currentTarget.classList.contains('e-de-list-numbered-up-letter')) {\n                _this.numberFormat = '%1.';\n                _this.listLevelPattern = 'UpLetter';\n            }\n            else if (args.currentTarget.classList.contains('e-de-list-numbered-low-letter-brace')) {\n                _this.numberFormat = '%1)';\n                _this.listLevelPattern = 'LowLetter';\n            }\n            else if (args.currentTarget.classList.contains('e-de-numbered-low-letter-dot')) {\n                _this.numberFormat = '%1.';\n                _this.listLevelPattern = 'LowLetter';\n            }\n            else if (args.currentTarget.classList.contains('e-de-list-numbered-low-roman')) {\n                _this.numberFormat = '%1.';\n                _this.listLevelPattern = 'LowRoman';\n            }\n        };\n        /**\n         * @private\n         */\n        this.bulletListClick = function (args) {\n            _this.isBullet = true;\n            _this.setActiveElement(args);\n            if (args.currentTarget.classList.contains('e-bullet-none')) {\n                _this.symbol = undefined;\n                _this.fontFamily = undefined;\n            }\n            else if (args.currentTarget.classList.contains('e-bullet-dot')) {\n                _this.symbol = '\\uf0b7';\n                _this.fontFamily = 'Symbol';\n            }\n            else if (args.currentTarget.classList.contains('e-bullet-circle')) {\n                _this.symbol = '\\uf06f' + '\\u0020';\n                _this.fontFamily = 'Symbol';\n            }\n            else if (args.currentTarget.classList.contains('e-bullet-square')) {\n                _this.symbol = '\\uf0a7';\n                _this.fontFamily = 'Wingdings';\n            }\n            else if (args.currentTarget.classList.contains('e-bullet-flower')) {\n                _this.symbol = '\\uf076';\n                _this.fontFamily = 'Wingdings';\n            }\n            else if (args.currentTarget.classList.contains('e-bullet-arrow')) {\n                _this.symbol = '\\uf0d8';\n                _this.fontFamily = 'Wingdings';\n            }\n            else if (args.currentTarget.classList.contains('e-bullet-tick')) {\n                _this.symbol = '\\uf0fc';\n                _this.fontFamily = 'Wingdings';\n            }\n        };\n        /**\n         * @private\n         */\n        this.loadNumberingBulletDialog = function () {\n            //Load \n            _this.owner.updateFocus();\n        };\n        /**\n         * @private\n         */\n        this.closeNumberingBulletDialog = function () {\n            _this.unWireEventsAndBindings();\n            _this.owner.updateFocus();\n        };\n        /**\n         * @private\n         */\n        this.onCancelButtonClick = function () {\n            _this.isBullet = false;\n            _this.listLevelPattern = undefined;\n            _this.numberFormat = undefined;\n            _this.symbol = undefined;\n            _this.fontFamily = undefined;\n            _this.owner.dialog.hide();\n            _this.unWireEventsAndBindings();\n        };\n        /**\n         * @private\n         */\n        this.onOkButtonClick = function () {\n            if (_this.owner.owner.viewer.lists.length > 0) {\n                _this.listFormat.list.listId = _this.owner.owner.viewer.lists[_this.owner.owner.viewer.lists.length - 1].listId + 1;\n                _this.listFormat.listId = _this.listFormat.list.listId;\n            }\n            else {\n                _this.listFormat.list.listId = 0;\n                _this.listFormat.listId = 0;\n            }\n            if (_this.owner.owner.viewer.abstractLists.length > 0) {\n                /* tslint:disable-next-line:max-line-length */\n                _this.abstractList.abstractListId = _this.owner.owner.viewer.abstractLists[_this.owner.owner.viewer.abstractLists.length - 1].abstractListId + 1;\n            }\n            else {\n                _this.abstractList.abstractListId = 0;\n            }\n            _this.listFormat.list.abstractListId = _this.abstractList.abstractListId;\n            var listLevel = new WListLevel(_this.abstractList);\n            listLevel.listLevelPattern = !isNullOrUndefined(_this.listLevelPattern) ? _this.listLevelPattern : 'Bullet';\n            listLevel.numberFormat = _this.isBullet ? _this.symbol : _this.numberFormat;\n            if (listLevel.listLevelPattern !== 'Bullet') {\n                listLevel.startAt = 1;\n            }\n            listLevel.characterFormat.fontFamily = !isNullOrUndefined(_this.fontFamily) ? _this.fontFamily : 'Verdana';\n            listLevel.paragraphFormat.leftIndent = 36;\n            listLevel.paragraphFormat.firstLineIndent = -18;\n            _this.abstractList.levels.push(listLevel);\n            _this.listFormat.listLevelNumber = 0;\n            _this.listFormat.list.abstractList = _this.abstractList;\n            _this.owner.dialog.hide();\n        };\n        this.owner = layoutViewer;\n    }\n    /**\n     * @private\n     */\n    BulletsAndNumberingDialog.prototype.getModuleName = function () {\n        return 'BulletsAndNumberingDialog';\n    };\n    /**\n     * @private\n     */\n    BulletsAndNumberingDialog.prototype.initNumberingBulletDialog = function (locale) {\n        var instance = this;\n        var id = this.owner.owner.containerId;\n        this.target = createElement('div', { id: id + '_insertNumberBulletDialog', className: 'e-de-number-bullet-dlg' });\n        var tabTarget = createElement('div', { id: id + '_tabNumberBulletDialog', className: 'e-de-tab-number-bullet-dlg' });\n        this.target.appendChild(tabTarget);\n        this.createNumberList(id);\n        this.createBulletList(id);\n        //Initialize Tab component\n        var tabObj = new Tab({\n            items: [\n                {\n                    header: { 'text': locale.getConstant('Numbering') },\n                    /* tslint:disable-next-line:max-line-length */\n                    content: ('#' + id + '_Number'),\n                },\n                {\n                    header: { 'text': locale.getConstant('Bullets') },\n                    /* tslint:disable-next-line:max-line-length */\n                    content: ('#' + id + '_Bullet'),\n                },\n            ],\n            heightAdjustMode: 'None',\n            width: 272,\n        });\n        //Render initialized Tab component\n        tabObj.appendTo(tabTarget);\n        this.owner.owner.element.appendChild(this.target);\n        tabObj.refresh();\n    };\n    BulletsAndNumberingDialog.prototype.createNumberList = function (id) {\n        var numberListDiv = createElement('div', { className: 'e-de-style-numbered-list', id: id + '_Number' });\n        numberListDiv.style.display = 'none';\n        numberListDiv.style.height = '270px';\n        var ulTag = createElement('ul', {\n            styles: 'display: block; outline: 0px;',\n            id: 'listMenu',\n            className: 'e-de-ui-wfloating-menu e-de-ui-bullets-menu e-de-list-container e-de-list-thumbnail'\n        });\n        numberListDiv.appendChild(ulTag);\n        var numberedNone = this.createNumberNoneListTag(ulTag);\n        var numberedNumberDot = this.createNumberListTag(ulTag, '1.', '2.', '3.', 'e-de-list-numbered-number-dot');\n        var numberedNumberBrace = this.createNumberListTag(ulTag, '1)', '2)', '3)', 'e-de-list-numbered-number-brace');\n        var numberedUpRoman = this.createNumberListTag(ulTag, 'I.', 'II.', 'III.', 'e-de-list-numbered-up-roman');\n        var numberedUpLettter = this.createNumberListTag(ulTag, 'A.', 'B.', 'C.', 'e-de-list-numbered-up-letter');\n        var numberedLowLetterDot = this.createNumberListTag(ulTag, 'a.', 'b.', 'c.', 'e-de-numbered-low-letter-dot');\n        var numberedLowLetterBrace = this.createNumberListTag(ulTag, 'a)', 'b)', 'c)', 'e-de-list-numbered-low-letter-brace');\n        var numberedLowRoman = this.createNumberListTag(ulTag, 'i.', 'ii.', 'iii.', 'e-de-list-numbered-low-roman');\n        numberedNone.addEventListener('click', this.numberListClick);\n        numberedNumberDot.addEventListener('click', this.numberListClick);\n        numberedNumberBrace.addEventListener('click', this.numberListClick);\n        numberedUpRoman.addEventListener('click', this.numberListClick);\n        numberedUpLettter.addEventListener('click', this.numberListClick);\n        numberedLowLetterBrace.addEventListener('click', this.numberListClick);\n        numberedLowLetterDot.addEventListener('click', this.numberListClick);\n        numberedLowRoman.addEventListener('click', this.numberListClick);\n        this.target.appendChild(numberListDiv);\n    };\n    BulletsAndNumberingDialog.prototype.createNumberListTag = function (ulTag, text1, text2, text3, className) {\n        var liTag = createElement('li', {\n            styles: 'display:block',\n            className: 'e-de-ui-wfloating-menuitem e-de-ui-wfloating-menuitem-md e-de-list-items  e-de-list-item-size ' + className\n        });\n        ulTag.appendChild(liTag);\n        /* tslint:disable-next-line:max-line-length */\n        var innerHTML = '<div>' + text1 + '<span class=\"e-de-ui-list-line\"></span></div><div>' + text2 + '<span class=\"e-de-ui-list-line\">';\n        innerHTML += '</span></div><div>' + text3 + '<span class=\"e-de-ui-list-line\"> </span></div >';\n        var liInnerDiv = createElement('div', {\n            className: 'e-de-ui-list-header-presetmenu',\n            id: 'e-de-ui-zlist0', innerHTML: innerHTML\n        });\n        liTag.style.cssFloat = 'left';\n        liTag.appendChild(liInnerDiv);\n        return liTag;\n    };\n    BulletsAndNumberingDialog.prototype.createNumberNoneListTag = function (ulTag) {\n        var liTag = createElement('li', {\n            styles: 'display:block',\n            /* tslint:disable-next-line:max-line-length */\n            className: 'e-de-ui-wfloating-menuitem e-de-ui-wfloating-menuitem-md e-de-list-items  e-de-list-item-size e-de-list-numbered-none'\n        });\n        ulTag.appendChild(liTag);\n        var innerHTML = '<div class=\"e-de-ui-bullets e-de-bullet-icons\">None</div>';\n        var liInnerDiv = createElement('div', {\n            className: 'e-de-ui-list-header-presetmenu',\n            id: 'e-de-ui-zlist0', innerHTML: innerHTML\n        });\n        liTag.style.cssFloat = 'left';\n        liTag.appendChild(liInnerDiv);\n        return liTag;\n    };\n    BulletsAndNumberingDialog.prototype.createBulletListTag = function (ulTag, iconCss, className) {\n        var liTag = createElement('li', {\n            styles: 'display:block;',\n            className: 'e-de-ui-wfloating-menuitem e-de-ui-wfloating-bullet-menuitem-md e-de-list-items  e-de-list-item-size ' + className\n        });\n        ulTag.appendChild(liTag);\n        /* tslint:disable-next-line:max-line-length */\n        var liInnerDiv = createElement('div', { className: 'e-de-ui-bullet-list-header-presetmenu e-de-bullet-icon-size', id: 'e-de-ui-zlist0' });\n        var liNextDiv = createElement('div', { className: iconCss });\n        liInnerDiv.appendChild(liNextDiv);\n        liTag.appendChild(liInnerDiv);\n        return liTag;\n    };\n    BulletsAndNumberingDialog.prototype.createBulletList = function (id) {\n        var bulletListDiv = createElement('div', { className: 'e-de-ui-bullet-list-header-presetmenu', id: id + '_Bullet' });\n        bulletListDiv.style.display = 'none';\n        bulletListDiv.style.height = '270px';\n        var ulTag = createElement('ul', {\n            styles: 'display: block; outline: 0px;', id: 'listMenu',\n            className: 'e-de-ui-wfloating-menu e-de-ui-bullets-menu e-de-list-container e-de-list-thumbnail'\n        });\n        bulletListDiv.appendChild(ulTag);\n        var bulletNone = this.createBulletListTag(ulTag, 'e-de-icon-bullet-list-none e-de-bullet-icons', 'e-bullet-none');\n        var bulletDot = this.createBulletListTag(ulTag, 'e-de-icon-bullet-list-dot e-de-bullet-icons', 'e-bullet-dot');\n        /* tslint:disable-next-line:max-line-length */\n        var bulletCircle = this.createBulletListTag(ulTag, 'e-de-icon-bullet-list-circle e-de-bullet-icons', 'e-bullet-circle');\n        var bulletSquare = this.createBulletListTag(ulTag, 'e-de-icon-bullet-list-square e-de-bullet-icons', 'e-bullet-square');\n        /* tslint:disable-next-line:max-line-length */\n        var bulletFlower = this.createBulletListTag(ulTag, 'e-de-icon-bullet-list-flower e-de-bullet-icons', 'e-bullet-flower');\n        var bulletArrow = this.createBulletListTag(ulTag, 'e-de-icon-bullet-list-arrow e-de-bullet-icons', 'e-bullet-arrow');\n        var bulletTick = this.createBulletListTag(ulTag, 'e-de-icon-bullet-list-tick e-de-bullet-icons', 'e-bullet-tick');\n        bulletNone.addEventListener('click', this.bulletListClick);\n        bulletDot.addEventListener('click', this.bulletListClick);\n        bulletCircle.addEventListener('click', this.bulletListClick);\n        bulletSquare.addEventListener('click', this.bulletListClick);\n        bulletFlower.addEventListener('click', this.bulletListClick);\n        bulletArrow.addEventListener('click', this.bulletListClick);\n        bulletTick.addEventListener('click', this.bulletListClick);\n        // bulletListDiv.appendChild(table1);        \n        this.target.appendChild(bulletListDiv);\n    };\n    /**\n     * @private\n     */\n    BulletsAndNumberingDialog.prototype.showNumberBulletDialog = function (listFormat, abstractList) {\n        if (!isNullOrUndefined(listFormat)) {\n            this.listFormat = listFormat;\n        }\n        else {\n            this.listFormat = new WListFormat();\n        }\n        if (isNullOrUndefined(this.listFormat.list)) {\n            this.listFormat.list = new WList();\n        }\n        if (!isNullOrUndefined(abstractList)) {\n            this.abstractList = abstractList;\n        }\n        else {\n            this.abstractList = new WAbstractList();\n        }\n        var locale = new L10n('documenteditor', this.owner.owner.defaultLocale);\n        locale.setLocale(this.owner.owner.locale);\n        setCulture(this.owner.owner.locale);\n        if (!this.target) {\n            this.initNumberingBulletDialog(locale);\n        }\n        this.owner.dialog.header = locale.getConstant('Numbering and Bullets');\n        this.owner.dialog.width = 'auto';\n        this.owner.dialog.height = 'auto';\n        this.owner.dialog.content = this.target;\n        this.owner.dialog.beforeOpen = this.loadNumberingBulletDialog;\n        this.owner.dialog.close = this.closeNumberingBulletDialog;\n        this.owner.dialog.position = { X: 'center', Y: 'center' };\n        this.owner.dialog.buttons = [{\n                click: this.onOkButtonClick,\n                buttonModel: { content: locale.getConstant('Ok'), cssClass: 'e-flat e-numbering-bullet-okay', isPrimary: true }\n            },\n            {\n                click: this.onCancelButtonClick,\n                buttonModel: { content: locale.getConstant('Cancel'), cssClass: 'e-flat e-numbering-bullet-cancel' }\n            }];\n        this.owner.dialog.dataBind();\n        this.owner.dialog.show();\n    };\n    BulletsAndNumberingDialog.prototype.setActiveElement = function (args) {\n        var html = args.currentTarget.parentElement;\n        for (var i = 0; i < html.childElementCount; i++) {\n            if (html.childNodes[i].classList.contains('e-de-list-active')) {\n                html.childNodes[i].classList.remove('e-de-list-active');\n            }\n        }\n        args.currentTarget.classList.add('e-de-list-active');\n    };\n    /**\n     * @private\n     */\n    BulletsAndNumberingDialog.prototype.unWireEventsAndBindings = function () {\n        //Unwire events\n    };\n    /**\n     * @private\n     */\n    BulletsAndNumberingDialog.prototype.destroy = function () {\n        this.owner = undefined;\n        if (this.listFormat) {\n            this.listFormat.destroy();\n            this.listFormat = undefined;\n        }\n        if (this.abstractList) {\n            this.abstractList.destroy();\n            this.abstractList = undefined;\n        }\n        if (this.target && this.target.parentElement) {\n            this.target.parentElement.removeChild(this.target);\n            for (var m = 0; m < this.target.childNodes.length; m++) {\n                this.target.removeChild(this.target.childNodes[m]);\n                m--;\n            }\n            this.target = undefined;\n        }\n    };\n    return BulletsAndNumberingDialog;\n}());\nexport { BulletsAndNumberingDialog };\n/* tslint:enable:no-any */ \n","import { createElement, isNullOrUndefined, L10n, setCulture } from '@syncfusion/ej2-base';\nimport { DropDownList, ComboBox } from '@syncfusion/ej2-dropdowns';\nimport { CheckBox } from '@syncfusion/ej2-buttons';\nimport { WCharacterFormat } from '../format/character-format';\nimport { ColorPicker } from '@syncfusion/ej2-inputs';\n/**\n * The Font dialog is used to modify formatting of selected text.\n */\n/* tslint:disable:no-any */\nvar FontDialog = /** @class */ (function () {\n    /**\n     * @private\n     */\n    function FontDialog(layoutViewer) {\n        var _this = this;\n        this.fontStyleInternal = undefined;\n        this.fontNameList = undefined;\n        this.fontStyleText = undefined;\n        this.fontSizeText = undefined;\n        this.colorPicker = undefined;\n        this.underlineDrop = undefined;\n        this.strikethroughBox = undefined;\n        this.doublestrikethrough = undefined;\n        this.superscript = undefined;\n        this.subscript = undefined;\n        //Character Format Property\n        this.bold = undefined;\n        this.italic = undefined;\n        this.underline = undefined;\n        this.strikethrough = undefined;\n        this.baselineAlignment = undefined;\n        this.fontSize = undefined;\n        this.fontFamily = undefined;\n        this.fontColor = undefined;\n        /**\n         * @private\n         */\n        this.characterFormat = undefined;\n        /**\n         * @private\n         */\n        this.loadFontDialog = function () {\n            _this.owner.updateFocus();\n            var characterFormat;\n            if (_this.characterFormat) {\n                characterFormat = _this.characterFormat;\n            }\n            else {\n                characterFormat = _this.owner.owner.selection.characterFormat;\n            }\n            _this.fontNameList.value = characterFormat.fontFamily;\n            if (!characterFormat.bold && !characterFormat.italic) {\n                _this.fontStyleText.value = _this.fontSizeText.value;\n                _this.fontStyleText.index = 0;\n            }\n            else if (characterFormat.bold && !characterFormat.italic) {\n                _this.fontStyleText.value = _this.fontSizeText.value;\n                _this.fontStyleText.index = 1;\n            }\n            else if (!characterFormat.bold && characterFormat.italic) {\n                _this.fontStyleText.value = _this.fontSizeText.value;\n                _this.fontStyleText.index = 2;\n            }\n            else if (characterFormat.bold && characterFormat.italic) {\n                _this.fontStyleText.value = _this.fontSizeText.value;\n                _this.fontStyleText.index = 3;\n            }\n            if (!isNullOrUndefined(characterFormat.fontSize)) {\n                for (var i = 0; i <= 15; i++) {\n                    var items = _this.fontSizeText.getItems();\n                    if (characterFormat.fontSize.toString() === items[i].innerHTML) {\n                        _this.fontSizeText.value = characterFormat.fontSize;\n                        _this.fontSizeText.index = i;\n                        break;\n                    }\n                }\n            }\n            if (!isNullOrUndefined(characterFormat.fontColor)) {\n                _this.colorPicker.value = characterFormat.fontColor;\n            }\n            else {\n                _this.colorPicker.value = '#000000';\n            }\n            if (characterFormat.underline === 'None') {\n                _this.underlineDrop.index = 0;\n            }\n            else if (characterFormat.underline === 'Single') {\n                _this.underlineDrop.index = 1;\n            }\n            if (characterFormat.strikethrough === 'SingleStrike') {\n                _this.strikethroughBox.checked = true;\n            }\n            else if (characterFormat.strikethrough === 'DoubleStrike') {\n                _this.doublestrikethrough.checked = true;\n            }\n            else {\n                _this.strikethroughBox.checked = false;\n                _this.doublestrikethrough.checked = false;\n            }\n            if (characterFormat.baselineAlignment === 'Superscript') {\n                _this.superscript.checked = true;\n            }\n            else if (characterFormat.baselineAlignment === 'Subscript') {\n                _this.subscript.checked = true;\n            }\n            else {\n                _this.superscript.checked = false;\n                _this.subscript.checked = false;\n            }\n            if (_this.owner.selection.caret.style.display !== 'none') {\n                _this.owner.selection.caret.style.display = 'none';\n            }\n        };\n        /**\n         * @private\n         */\n        this.closeFontDialog = function () {\n            _this.unWireEventsAndBindings();\n            _this.owner.updateFocus();\n        };\n        /**\n         * @private\n         */\n        this.onCancelButtonClick = function () {\n            _this.owner.dialog.hide();\n            _this.unWireEventsAndBindings();\n        };\n        /**\n         * @private\n         */\n        this.onInsertFontFormat = function () {\n            var format;\n            if (_this.characterFormat) {\n                format = _this.characterFormat;\n            }\n            else {\n                format = new WCharacterFormat(undefined);\n            }\n            if (!isNullOrUndefined(_this.bold)) {\n                format.bold = _this.bold;\n            }\n            if (!isNullOrUndefined(_this.italic)) {\n                format.italic = _this.italic;\n            }\n            if (!isNullOrUndefined(_this.fontSize) && _this.fontSize > 0) {\n                format.fontSize = _this.fontSize;\n            }\n            if (!isNullOrUndefined(_this.fontColor)) {\n                format.fontColor = _this.fontColor;\n            }\n            if (!isNullOrUndefined(_this.baselineAlignment)) {\n                format.baselineAlignment = _this.baselineAlignment;\n            }\n            if (!isNullOrUndefined(_this.strikethrough)) {\n                format.strikethrough = _this.strikethrough;\n            }\n            if (!isNullOrUndefined(_this.underline)) {\n                format.underline = _this.underline;\n            }\n            if (!isNullOrUndefined(_this.fontFamily)) {\n                format.fontFamily = _this.fontFamily;\n            }\n            if (!_this.characterFormat) {\n                _this.onCharacterFormat(_this.owner.selection, format);\n            }\n            else {\n                _this.owner.owner.styleDialogModule.updateCharacterFormat();\n            }\n            _this.owner.dialog.hide();\n        };\n        this.fontSizeUpdate = function (args) {\n            _this.fontSize = args.value;\n        };\n        this.fontStyleUpdate = function (args) {\n            _this.fontStyle = args.value;\n        };\n        this.fontFamilyUpdate = function (args) {\n            _this.fontFamily = args.value;\n        };\n        this.underlineUpdate = function (args) {\n            _this.underline = args.value;\n        };\n        this.fontColorUpdate = function (args) {\n            if (!isNullOrUndefined(args.currentValue)) {\n                _this.fontColor = args.currentValue.hex;\n            }\n        };\n        this.singleStrikeUpdate = function (args) {\n            _this.enableCheckBoxProperty(args);\n            if (args.checked) {\n                _this.strikethrough = 'SingleStrike';\n            }\n            else {\n                _this.strikethrough = 'None';\n            }\n        };\n        this.doubleStrikeUpdate = function (args) {\n            _this.enableCheckBoxProperty(args);\n            if (args.checked) {\n                _this.strikethrough = 'DoubleStrike';\n            }\n            else {\n                _this.strikethrough = 'None';\n            }\n        };\n        this.superscriptUpdate = function (args) {\n            _this.enableCheckBoxProperty(args);\n            if (args.checked) {\n                _this.baselineAlignment = 'Superscript';\n            }\n            else {\n                _this.baselineAlignment = 'Normal';\n            }\n        };\n        this.subscriptUpdate = function (args) {\n            _this.enableCheckBoxProperty(args);\n            if (args.checked) {\n                _this.baselineAlignment = 'Subscript';\n            }\n            else {\n                _this.baselineAlignment = 'Normal';\n            }\n        };\n        this.owner = layoutViewer;\n    }\n    Object.defineProperty(FontDialog.prototype, \"fontStyle\", {\n        /**\n         * @private\n         */\n        get: function () {\n            return this.fontStyleInternal;\n        },\n        /**\n         * @private\n         */\n        set: function (value) {\n            this.fontStyleInternal = value;\n            switch (this.fontStyle) {\n                case 'Bold':\n                    this.bold = true;\n                    this.italic = false;\n                    break;\n                case 'Italic':\n                    this.bold = false;\n                    this.italic = true;\n                    break;\n                case 'BoldItalic':\n                    this.bold = true;\n                    this.italic = true;\n                    break;\n                case 'Regular':\n                    this.bold = false;\n                    this.italic = false;\n                    break;\n            }\n        },\n        enumerable: true,\n        configurable: true\n    });\n    /**\n     * @private\n     */\n    FontDialog.prototype.getModuleName = function () {\n        return 'FontDialog';\n    };\n    FontDialog.prototype.createInputElement = function (type, id, className) {\n        var element = createElement('input', {\n            attrs: { type: type },\n            id: id,\n            className: className\n        });\n        return element;\n    };\n    /**\n     * @private\n     */\n    FontDialog.prototype.initFontDialog = function (locale) {\n        var instance = this;\n        var effectLabel;\n        var strikeThroughElement;\n        var superScriptElement;\n        var subScriptElement;\n        var doubleStrikeThroughElement;\n        var id = this.owner.owner.containerId;\n        this.target = createElement('div', { id: id + '_insertFontDialog', className: 'e-de-font-dlg' });\n        var fontDiv = this.getFontDiv(locale);\n        this.target.appendChild(fontDiv);\n        var sizeDiv = this.getFontSizeDiv(locale);\n        this.target.appendChild(sizeDiv);\n        var colorDiv = createElement('div', { id: id + '_fontColor', styles: 'margin-top:15px;' });\n        this.fontColorDiv = createElement('div', { id: id + '_fontColorDiv', className: 'e-de-font-dlg-display' });\n        var fontColorLabel = createElement('label', {\n            className: 'e-de-font-dlg-header-font-color e-de-font-color-margin', innerHTML: locale.getConstant('Font color')\n        });\n        this.fontColorDiv.appendChild(fontColorLabel);\n        var fontColorElement = this.createInputElement('color', this.target.id + '_ColorDiv', 'e-de-font-dlg-color');\n        this.fontColorDiv.appendChild(fontColorElement);\n        colorDiv.appendChild(this.fontColorDiv);\n        this.target.appendChild(colorDiv);\n        var fontEffectsDiv = createElement('div', { id: id + '_fontEffectsDiv' });\n        var fontEffectSubDiv1 = createElement('div', {\n            className: 'e-de-font-color-label e-de-font-dlg-display',\n            id: this.target.id + '_fontEffectsSubDiv1'\n        });\n        effectLabel = createElement('label', { className: 'e-de-font-dlg-header-effects', innerHTML: locale.getConstant('Effects') });\n        fontEffectSubDiv1.appendChild(effectLabel);\n        strikeThroughElement = this.createInputElement('checkbox', this.target.id + '_strikeThrough', '');\n        fontEffectSubDiv1.appendChild(strikeThroughElement);\n        superScriptElement = this.createInputElement('checkbox', this.target.id + '_superScript', '');\n        fontEffectSubDiv1.appendChild(superScriptElement);\n        fontEffectsDiv.appendChild(fontEffectSubDiv1);\n        var fontEffectSubDiv2 = createElement('div', { className: 'e-de-font-checkbox', id: id + '_fontEffectsSubDiv2' });\n        subScriptElement = this.createInputElement('checkbox', this.target.id + '_subScript', '');\n        fontEffectSubDiv2.appendChild(subScriptElement);\n        doubleStrikeThroughElement = this.createInputElement('checkbox', this.target.id + '_doubleStrikeThrough', '');\n        fontEffectSubDiv2.appendChild(doubleStrikeThroughElement);\n        fontEffectsDiv.appendChild(fontEffectSubDiv2);\n        this.target.appendChild(fontEffectsDiv);\n        this.owner.owner.element.appendChild(this.target);\n        this.colorPicker = new ColorPicker({\n            change: this.fontColorUpdate, value: '#000000',\n        });\n        this.colorPicker.appendTo(fontColorElement);\n        this.strikethroughBox = new CheckBox({\n            change: this.singleStrikeUpdate,\n            cssClass: 'e-de-font-content-label',\n            label: locale.getConstant('Strikethrough')\n        });\n        this.strikethroughBox.appendTo(strikeThroughElement);\n        this.doublestrikethrough = new CheckBox({\n            change: this.doubleStrikeUpdate,\n            cssClass: 'e-de-font-content-checkbox-label',\n            label: locale.getConstant('Double strikethrough')\n        });\n        this.doublestrikethrough.appendTo(doubleStrikeThroughElement);\n        this.subscript = new CheckBox({\n            label: locale.getConstant('Subscript'),\n            change: this.subscriptUpdate\n        });\n        this.subscript.appendTo(subScriptElement);\n        this.superscript = new CheckBox({\n            label: locale.getConstant('Superscript'),\n            cssClass: 'e-de-font-content-label', change: this.superscriptUpdate\n        });\n        this.superscript.appendTo(superScriptElement);\n    };\n    FontDialog.prototype.getFontSizeDiv = function (locale) {\n        var fontSize;\n        var sizeDiv;\n        var id = this.owner.owner.containerId;\n        sizeDiv = createElement('div', { id: id + '_fontSizeAndUnderlineDiv', className: 'e-de-font-dlg-padding e-de-font-dlg-display' });\n        var sizeSubDiv1 = createElement('div', { id: id + '_fontSizeAndUnderlineSubDiv1' });\n        var sizeLabel = createElement('label', { className: 'e-de-font-dlg-header', innerHTML: locale.getConstant('Size') });\n        var styles = 'font-family:Roboto;font-size:14px;opacity:0.8;';\n        fontSize = createElement('select', { id: this.target.id + '_fontSize', styles: styles });\n        fontSize.innerHTML = '<option>8</option><option>9</option><option>10</option><option>11</option><option>12</option>' +\n            '<option>14</option><option>16</option><option>18</option><option>20</option><option>24</option><option>26</option>' +\n            '<option>28</option><option>36</option><option>48</option><option>72</option><option>96</option>';\n        sizeSubDiv1.appendChild(sizeLabel);\n        sizeSubDiv1.appendChild(fontSize);\n        sizeDiv.appendChild(sizeSubDiv1);\n        var sizeSubDiv2 = createElement('div', {\n            className: 'e-de-font-dlg-cb-right',\n            id: id + '_fontSizeAndUnderlineSubDiv2'\n        });\n        var html = locale.getConstant('Underline style');\n        var underlineLabel = createElement('label', { className: 'e-de-font-dlg-header', innerHTML: html });\n        var underlineElement;\n        underlineElement = createElement('select', { id: this.target.id + '_underLine', styles: styles });\n        underlineElement.innerHTML = '<option>' + locale.getConstant('None') + '</option><option>________</option>';\n        sizeSubDiv2.appendChild(underlineLabel);\n        sizeSubDiv2.appendChild(underlineElement);\n        sizeDiv.appendChild(sizeSubDiv2);\n        this.fontSizeText = new ComboBox({ change: this.fontSizeUpdate, popupHeight: '170px', width: '170px' });\n        this.fontSizeText.showClearButton = false;\n        this.fontSizeText.appendTo(fontSize);\n        this.underlineDrop = new DropDownList({ change: this.underlineUpdate, popupHeight: '100px', width: '170px' });\n        this.underlineDrop.appendTo(underlineElement);\n        return sizeDiv;\n    };\n    FontDialog.prototype.getFontDiv = function (locale) {\n        var id = this.owner.owner.containerId;\n        var fontDiv = createElement('div', { id: id + '_fontDiv', className: 'e-de-font-dlg-display' });\n        var fontSubDiv1 = createElement('div', { id: id + '_fontSubDiv1' });\n        var fontNameLabel = createElement('label', {\n            className: 'e-de-font-dlg-header',\n            innerHTML: locale.getConstant('Font')\n        });\n        var fontNameValues = createElement('select', { id: this.target.id + '_fontName' });\n        fontNameValues.innerHTML = '<option>Arial</option><option>Calibri</option><option>Candara</option><option>Comic Sans MS</option>' +\n            '<option>Consolas</option><option>Constantia</option><option>Corbel</option>' +\n            '<option>Courier New</option><option>Ebrima</option><option>Franklin Gothic</option>' +\n            '<option>Gabriola</option><option>Gadugi</option><option>Georgia</option><option>Impact</option>' +\n            '<option>Javanese Text</option><option>Microsoft Sans Serif</option><option>MS Gothic</option><option>MS UI Gothic</option>' +\n            '<option>Segoe Print</option><option>Times New Roman</option><option>Verdana</option><option>Segoe UI</option>' +\n            '<option>Algerian</option><option>Cambria</option><option>Georgia</option><option>Consolas</option>';\n        fontSubDiv1.appendChild(fontNameLabel);\n        fontSubDiv1.appendChild(fontNameValues);\n        fontDiv.appendChild(fontSubDiv1);\n        var fontSubDiv2;\n        var fontStyleLabel;\n        var fontStyleValues;\n        fontSubDiv2 = createElement('div', { className: 'e-de-font-dlg-cb-right', id: id + '_fontSubDiv2', styles: 'float:right;' });\n        fontStyleLabel = createElement('label', { className: 'e-de-font-dlg-header', innerHTML: locale.getConstant('Font style') });\n        var fontStyle = 'font-family:Roboto;font-size:14px;opacity:0.8;';\n        fontStyleValues = createElement('select', { id: this.target.id + '_fontStyle', styles: fontStyle });\n        fontStyleValues.innerHTML = '<option>' +\n            locale.getConstant('Regular') + '</option><option>' + locale.getConstant('Bold') + '</option><option>' +\n            locale.getConstant('Italic') + '</option><option>' + locale.getConstant('Bold') + locale.getConstant('Italic') + '</option>';\n        fontSubDiv2.appendChild(fontStyleLabel);\n        fontSubDiv2.appendChild(fontStyleValues);\n        fontDiv.appendChild(fontSubDiv2);\n        this.fontNameList = new ComboBox({ change: this.fontFamilyUpdate, popupHeight: '200px', width: '170px' });\n        this.fontNameList.showClearButton = false;\n        this.fontNameList.appendTo(fontNameValues);\n        this.fontStyleText = new DropDownList({ change: this.fontStyleUpdate, popupHeight: '170px', width: '170px' });\n        this.fontStyleText.appendTo(fontStyleValues);\n        return fontDiv;\n    };\n    /**\n     * @private\n     */\n    FontDialog.prototype.showFontDialog = function (characterFormat) {\n        if (characterFormat) {\n            this.characterFormat = characterFormat;\n        }\n        var locale = new L10n('documenteditor', this.owner.owner.defaultLocale);\n        locale.setLocale(this.owner.owner.locale);\n        setCulture(this.owner.owner.locale);\n        if (!this.target) {\n            this.initFontDialog(locale);\n        }\n        this.owner.dialog.header = locale.getConstant('Font');\n        this.owner.dialog.width = 'auto';\n        this.owner.dialog.height = 'auto';\n        this.owner.dialog.content = this.target;\n        this.owner.dialog.beforeOpen = this.loadFontDialog;\n        this.owner.dialog.close = this.closeFontDialog;\n        this.owner.dialog.buttons = [{\n                click: this.onInsertFontFormat,\n                buttonModel: { content: locale.getConstant('Ok'), cssClass: 'e-flat e-font-okay', isPrimary: true }\n            },\n            {\n                click: this.onCancelButtonClick,\n                buttonModel: { content: locale.getConstant('Cancel'), cssClass: 'e-flat e-font-cancel' }\n            }];\n        this.owner.dialog.dataBind();\n        this.owner.dialog.show();\n    };\n    /**\n     * Applies character format\n     * @param  {Selection} selection\n     * @param  {WCharacterFormat} format\n     * @private\n     */\n    FontDialog.prototype.onCharacterFormat = function (selection, format) {\n        this.owner.owner.editorModule.initHistory('CharacterFormat');\n        if (selection.isEmpty) {\n            if (selection.start.offset === selection.getParagraphLength(selection.start.paragraph)) {\n                // tslint:disable-next-line:max-line-length\n                this.owner.owner.editorModule.applyCharFormatValueInternal(selection, selection.start.paragraph.characterFormat, undefined, format);\n                this.owner.owner.editorModule.reLayout(selection);\n            }\n            this.owner.updateFocus();\n            return;\n        }\n        else {\n            //Iterate and update formating.\n            this.owner.owner.editorModule.setOffsetValue(this.owner.selection);\n            this.owner.owner.editorModule.updateSelectionCharacterFormatting('CharacterFormat', format, false);\n        }\n    };\n    /**\n     * @private\n     */\n    FontDialog.prototype.enableCheckBoxProperty = function (args) {\n        if (this.strikethroughBox.checked && this.doublestrikethrough.checked) {\n            this.strikethroughBox.checked = false;\n            this.doublestrikethrough.checked = false;\n            if (args.event.currentTarget.id === this.target.id + '_doubleStrikeThrough') {\n                this.doublestrikethrough.checked = true;\n            }\n            else {\n                this.strikethroughBox.checked = true;\n            }\n        }\n        if (this.superscript.checked && this.subscript.checked) {\n            this.subscript.checked = false;\n            this.superscript.checked = false;\n            if (args.event.currentTarget.id === this.target.id + '_subScript') {\n                this.subscript.checked = true;\n            }\n            else {\n                this.superscript.checked = true;\n            }\n        }\n    };\n    /**\n     * @private\n     */\n    FontDialog.prototype.unWireEventsAndBindings = function () {\n        this.fontNameList.value = '';\n        this.fontSizeText.value = '';\n        this.fontStyleText.value = '';\n        this.strikethroughBox.checked = false;\n        this.doublestrikethrough.checked = false;\n        this.superscript.checked = false;\n        this.subscript.checked = false;\n        this.bold = undefined;\n        this.italic = undefined;\n        this.underline = undefined;\n        this.strikethrough = undefined;\n        this.baselineAlignment = undefined;\n        this.fontColor = undefined;\n        this.fontSize = undefined;\n        this.fontFamily = undefined;\n    };\n    /**\n     * @private\n     */\n    FontDialog.prototype.destroy = function () {\n        this.owner = undefined;\n        if (this.characterFormat) {\n            this.characterFormat.destroy();\n            this.characterFormat = undefined;\n        }\n        if (!isNullOrUndefined(this.target)) {\n            if (this.target.parentElement) {\n                this.target.parentElement.removeChild(this.target);\n            }\n            for (var m = 0; m < this.target.childNodes.length; m++) {\n                this.target.removeChild(this.target.childNodes[m]);\n                m--;\n            }\n            this.target = undefined;\n        }\n        if (this.fontNameList) {\n            this.fontNameList.destroy();\n        }\n        this.fontNameList = undefined;\n        if (this.fontStyleText) {\n            this.fontStyleText.destroy();\n        }\n        this.fontStyleText = undefined;\n        if (this.fontSizeText) {\n            this.fontSizeText.destroy();\n        }\n        this.fontSizeText = undefined;\n        if (this.colorPicker) {\n            this.colorPicker.destroy();\n        }\n        this.colorPicker = undefined;\n        if (this.underlineDrop) {\n            this.underlineDrop.destroy();\n        }\n        this.underlineDrop = undefined;\n        if (this.strikethroughBox) {\n            this.strikethroughBox.destroy();\n        }\n        this.strikethroughBox = undefined;\n        if (this.doublestrikethrough) {\n            this.doublestrikethrough.destroy();\n        }\n        this.doublestrikethrough = undefined;\n        if (this.superscript) {\n            this.superscript.destroy();\n        }\n        this.superscript = undefined;\n        if (this.subscript) {\n            this.subscript.destroy();\n        }\n        this.subscript = undefined;\n    };\n    return FontDialog;\n}());\nexport { FontDialog };\n/* tslint:enable:no-any */ \n","import { createElement, isNullOrUndefined, L10n, setCulture } from '@syncfusion/ej2-base';\nimport { NumericTextBox } from '@syncfusion/ej2-inputs';\nimport { WTableFormat, WRowFormat, WCellFormat } from '../format/index';\nimport { CheckBox } from '@syncfusion/ej2-buttons';\nimport { DropDownList } from '@syncfusion/ej2-dropdowns';\nimport { Tab } from '@syncfusion/ej2-navigations';\nimport { classList } from '@syncfusion/ej2-base';\nimport { HelperMethods } from '../editor/editor-helper';\n/**\n * The Table properties dialog is used to modify properties of selected table.\n */\nvar TablePropertiesDialog = /** @class */ (function () {\n    /**\n     * @private\n     */\n    function TablePropertiesDialog(viewer) {\n        var _this = this;\n        this.hasTableWidth = false;\n        this.hasCellWidth = false;\n        /**\n         * @private\n         */\n        this.isTableBordersAndShadingUpdated = false;\n        /**\n         * @private\n         */\n        this.isCellBordersAndShadingUpdated = false;\n        this.tabObj = undefined;\n        /**\n         * @private\n         */\n        this.isCellOptionsUpdated = false;\n        /**\n         * @private\n         */\n        this.isTableOptionsUpdated = false;\n        this.onBeforeOpen = function () {\n            _this.owner.updateFocus();\n            _this.loadTableProperties();\n        };\n        /**\n         * @private\n         */\n        this.onCloseTablePropertyDialog = function () {\n            _this.unWireEvent.bind(_this);\n            _this.owner.updateFocus();\n        };\n        /**\n         * @private\n         */\n        this.applyTableProperties = function () {\n            var selection = _this.owner.selection;\n            if (!_this.preferCheckBox.checked && !_this.preferCheckBox.indeterminate) {\n                if (isNullOrUndefined(selection.tableFormat.preferredWidth) || selection.tableFormat.preferredWidth !== 0) {\n                    _this.tableFormat.preferredWidth = 0;\n                    _this.tableFormat.preferredWidthType = 'Point';\n                }\n            }\n            if (_this.tableFormat.hasValue('tableAlignment') && _this.tableFormat.tableAlignment !== 'Left') {\n                if (isNullOrUndefined(selection.tableFormat.leftIndent) || selection.tableFormat.leftIndent !== 0) {\n                    _this.tableFormat.leftIndent = 0;\n                }\n            }\n            if (!_this.rowHeightCheckBox.checked && !_this.rowHeightCheckBox.indeterminate) {\n                if (isNullOrUndefined(selection.rowFormat.height) || selection.rowFormat.height !== 0) {\n                    _this.rowFormat.heightType = 'AtLeast';\n                    _this.rowFormat.height = 0;\n                }\n            }\n            if (!_this.preferredCellWidthCheckBox.checked && !_this.preferredCellWidthCheckBox.indeterminate) {\n                if (isNullOrUndefined(selection.cellFormat.preferredWidth) || selection.cellFormat.preferredWidth === 0) {\n                    _this.cellFormat.preferredWidthType = 'Point';\n                    _this.cellFormat.preferredWidth = 0;\n                }\n            }\n            else {\n                if (_this.cellFormat.preferredWidthType === 'Percent') {\n                    if (!_this.tableFormat.hasValue('preferredWidth') && !_this.tableFormat.hasValue('preferredWidthType')\n                        && _this.owner.selection.start.paragraph.associatedCell.ownerTable.tableFormat.preferredWidth === 0) {\n                        // tslint:disable-next-line:max-line-length\n                        var containerWidth = _this.owner.selection.start.paragraph.associatedCell.ownerTable.getOwnerWidth(true);\n                        var tableWidth = _this.owner.selection.start.paragraph.associatedCell.ownerTable.getTableClientWidth(containerWidth);\n                        _this.tableFormat.preferredWidthType = 'Percent';\n                        _this.tableFormat.preferredWidth = tableWidth / HelperMethods.convertPixelToPoint(_this.owner.clientArea.width) * 100;\n                    }\n                }\n            }\n            if (_this.rowHeightValue) {\n                _this.rowFormat.height = _this.rowHeightValue;\n            }\n            _this.owner.owner.editorModule.initComplexHistory('TableProperties');\n            _this.owner.owner.editorModule.onTableFormat(_this.tableFormat);\n            _this.owner.owner.editorModule.onRowFormat(_this.rowFormat);\n            _this.owner.owner.editorModule.onCellFormat(_this.cellFormat);\n            _this.owner.owner.editorHistory.updateComplexHistory();\n            _this.closeTablePropertiesDialog();\n            _this.owner.updateFocus();\n        };\n        /**\n         * @private\n         */\n        this.applyTableSubProperties = function () {\n            if (_this.isCellOptionsUpdated) {\n                var cellFormat = _this.owner.owner.cellOptionsDialogModule.cellFormat;\n                _this.owner.owner.cellOptionsDialogModule.applySubCellOptions(cellFormat);\n            }\n            if (_this.isTableOptionsUpdated) {\n                var tableFormat = _this.owner.owner.tableOptionsDialogModule.tableFormat;\n                _this.owner.owner.tableOptionsDialogModule.applySubTableOptions(tableFormat);\n            }\n            _this.isCellOptionsUpdated = false;\n            _this.isTableOptionsUpdated = false;\n        };\n        /**\n         * @private\n         */\n        this.unWireEvent = function () {\n            //Table Format\n            _this.preferCheckBox.change = undefined;\n            _this.tableWidthBox.change = undefined;\n            _this.tableWidthType.change = undefined;\n            _this.leftIndentBox.change = undefined;\n            //Row Format\n            _this.rowHeightCheckBox.change = undefined;\n            _this.rowHeightBox.change = undefined;\n            _this.rowHeightType.change = undefined;\n            _this.repeatHeader.change = undefined;\n            _this.allowRowBreak.change = undefined;\n            //Cell Format\n            _this.preferredCellWidthCheckBox.change = undefined;\n            _this.cellWidthBox.change = undefined;\n            _this.cellWidthType.change = undefined;\n            _this.cellFormat.destroy();\n            _this.rowFormat.destroy();\n            _this.tableFormat.destroy();\n            _this.rowHeightValue = undefined;\n            _this.owner.dialog2.open = _this.owner.selection.hideCaret.bind(_this.owner);\n        };\n        /**\n         * @private\n         */\n        this.closeTablePropertiesDialog = function () {\n            _this.owner.dialog2.hide();\n            _this.owner.updateFocus();\n        };\n        /**\n         * @private\n         */\n        this.changeTableCheckBox = function () {\n            var enable = (_this.preferCheckBox.checked || _this.preferCheckBox.indeterminate);\n            _this.tableWidthBox.enabled = enable;\n            _this.tableWidthType.enabled = enable;\n            if (enable) {\n                _this.tableFormat.preferredWidthType = (_this.tableWidthType.value === 'Points') ?\n                    'Point' : _this.tableWidthType.value;\n            }\n            else {\n                _this.tableFormat.preferredWidthType = _this.owner.selection.tableFormat.preferredWidthType;\n            }\n        };\n        /**\n         * @private\n         */\n        this.changeTableAlignment = function (event) {\n            _this.updateClassForAlignmentProperties(_this.tableTab);\n            var element = event.target;\n            classList(element, ['e-de-table-alignment-active'], ['e-de-table-properties-alignment']);\n            if (element.classList.contains('e-de-table-left-alignment')) {\n                _this.leftIndentBox.enabled = true;\n            }\n            else {\n                _this.leftIndentBox.enabled = false;\n            }\n            _this.tableFormat.tableAlignment = _this.getTableAlignment();\n        };\n        /**\n         * @private\n         */\n        this.changeTableRowCheckBox = function () {\n            _this.rowHeightType.enabled = _this.rowHeightCheckBox.checked;\n            _this.rowHeightBox.enabled = _this.rowHeightCheckBox.checked;\n            if (_this.rowHeightType.enabled) {\n                _this.rowFormat.heightType = _this.rowHeightType.value;\n            }\n            else {\n                _this.rowFormat.heightType = _this.owner.selection.rowFormat.heightType;\n            }\n        };\n        /**\n         * @private\n         */\n        this.changeTableCellCheckBox = function () {\n            _this.cellWidthType.enabled = _this.preferredCellWidthCheckBox.checked;\n            _this.cellWidthBox.enabled = _this.preferredCellWidthCheckBox.checked;\n        };\n        /**\n         * @private\n         */\n        this.changeCellAlignment = function (event) {\n            _this.updateClassForCellAlignment(_this.cellTab);\n            var element = event.target;\n            classList(element, ['e-de-table-alignment-active'], ['e-de-tablecell-alignment']);\n            _this.cellFormat.verticalAlignment = _this.getCellAlignment();\n        };\n        //#endregion\n        /**\n         * @private\n         */\n        this.showTableOptionsDialog = function () {\n            _this.owner.owner.tableOptionsDialogModule.show();\n            _this.owner.dialog2.element.style.pointerEvents = 'none';\n        };\n        /**\n         * @private\n         */\n        this.showBordersShadingsPropertiesDialog = function () {\n            _this.owner.owner.bordersAndShadingDialogModule.show();\n            _this.owner.dialog2.element.style.pointerEvents = 'none';\n        };\n        /**\n         * @private\n         */\n        this.showCellOptionsDialog = function () {\n            _this.owner.owner.cellOptionsDialogModule.show();\n            _this.owner.dialog2.element.style.pointerEvents = 'none';\n        };\n        this.owner = viewer;\n    }\n    Object.defineProperty(TablePropertiesDialog.prototype, \"cellFormat\", {\n        /**\n         * @private\n         */\n        get: function () {\n            if (isNullOrUndefined(this.cellFormatIn)) {\n                return this.cellFormatIn = new WCellFormat();\n            }\n            return this.cellFormatIn;\n        },\n        /**\n         * @private\n         */\n        set: function (value) {\n            this.cellFormatIn = value;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(TablePropertiesDialog.prototype, \"tableFormat\", {\n        /**\n         * @private\n         */\n        get: function () {\n            if (isNullOrUndefined(this.tableFormatIn)) {\n                this.tableFormatIn = new WTableFormat();\n                return this.tableFormatIn;\n            }\n            return this.tableFormatIn;\n        },\n        /**\n         * @private\n         */\n        set: function (value) {\n            this.tableFormatIn = value;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(TablePropertiesDialog.prototype, \"rowFormat\", {\n        /**\n         * @private\n         */\n        get: function () {\n            if (isNullOrUndefined(this.rowFormatInternal)) {\n                this.rowFormatInternal = new WRowFormat();\n                return this.rowFormatInternal;\n            }\n            return this.rowFormatInternal;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    TablePropertiesDialog.prototype.getModuleName = function () {\n        return 'TablePropertiesDialog';\n    };\n    /**\n     * @private\n     */\n    TablePropertiesDialog.prototype.initTablePropertyDialog = function (localValue) {\n        var id = this.owner.owner.containerId + '_TablePropertiesDialog';\n        this.target = createElement('div', { id: id, className: 'e-de-table-properties-dlg' });\n        this.owner.owner.element.appendChild(this.target);\n        var ejtabContainer = createElement('div', { id: this.target.id + '_TabContainer' });\n        this.target.appendChild(ejtabContainer);\n        this.tableTab = createElement('div', {\n            id: this.target.id + '_TablePropertiesContentDialogTab', className: 'e-de-table-ppty-dlg-tabs'\n        });\n        this.rowTab = createElement('div', {\n            id: this.target.id + '_RowPropertiesDialogTab', className: 'e-de-table-ppty-dlg-tabs'\n        });\n        this.cellTab = createElement('div', {\n            id: this.target.id + '_CellPropertiesDialogTab', className: 'e-de-table-ppty-dlg-tabs'\n        });\n        var separatorLine = createElement('div', { className: 'e-de-table-dialog-separator-line' });\n        // tslint:disable-next-line:max-line-length\n        var ejtab = createElement('div', { id: this.target.id + '_TablePropertiesDialogTab', className: 'e-de-table-ppty-tab' });\n        var headerContainer = createElement('div', { className: 'e-tab-header' });\n        var tableHeader = createElement('div', {\n            id: this.target.id + '_tableHeader', innerHTML: localValue.getConstant('Table')\n        });\n        var rowHeader = createElement('div', {\n            id: this.target.id + '_rowHeader', innerHTML: localValue.getConstant('Row')\n        });\n        var cellHeader = createElement('div', {\n            id: this.target.id + '_cellHeader', innerHTML: localValue.getConstant('Cell')\n        });\n        headerContainer.appendChild(tableHeader);\n        headerContainer.appendChild(rowHeader);\n        headerContainer.appendChild(cellHeader);\n        var contentContainer = createElement('div', { className: 'e-content' });\n        var tableContent = createElement('div', { id: this.target.id + '_tableContent' });\n        var rowContent = createElement('div', { id: this.target.id + '_rowContent' });\n        var cellContent = createElement('div', { id: this.target.id + '_cellContent' });\n        tableContent.appendChild(this.tableTab);\n        rowContent.appendChild(this.rowTab);\n        cellContent.appendChild(this.cellTab);\n        contentContainer.appendChild(tableContent);\n        contentContainer.appendChild(rowContent);\n        contentContainer.appendChild(cellContent);\n        ejtab.appendChild(headerContainer);\n        ejtab.appendChild(contentContainer);\n        ejtabContainer.appendChild(ejtab);\n        this.initTableProperties(this.tableTab, localValue);\n        this.initTableRowProperties(this.rowTab, localValue);\n        this.initTableCellProperties(this.cellTab, localValue);\n        this.tabObj = new Tab({}, ejtab);\n        this.target.appendChild(separatorLine);\n        var alignMentButtons = this.tableTab.getElementsByClassName(this.tableTab.id + 'e-de-table-alignment');\n        for (var i = 0; i < alignMentButtons.length; i++) {\n            alignMentButtons[i].addEventListener('click', this.changeTableAlignment);\n        }\n        var cellAlignment = this.cellTab.getElementsByClassName(this.cellTab.id + 'e-de-table-cell-alignment');\n        for (var i = 0; i < cellAlignment.length; i++) {\n            cellAlignment[i].addEventListener('click', this.changeCellAlignment);\n        }\n        var tableTabHeader = this.tabObj.element.getElementsByClassName('e-item e-toolbar-item')[0];\n        var tableTabHeaderItem = tableTabHeader.getElementsByClassName('e-tab-wrap')[0];\n        tableTabHeaderItem.classList.add('e-de-table-ppty-dlg-table-header');\n        var rowTabHeader = this.tabObj.element.getElementsByClassName('e-item e-toolbar-item')[1];\n        var rowTabHeaderItem = rowTabHeader.getElementsByClassName('e-tab-wrap')[0];\n        rowTabHeaderItem.classList.add('e-de-table-ppty-dlg-row-header');\n        var cellTabHeader = this.tabObj.element.getElementsByClassName('e-item e-toolbar-item')[2];\n        var cellTabHeaderItem = cellTabHeader.getElementsByClassName('e-tab-wrap')[0];\n        cellTabHeaderItem.classList.add('e-de-table-ppty-dlg-cell-header');\n        this.tabObj.element.getElementsByClassName('e-indicator')[0].style.right = '155px';\n    };\n    /**\n     * @private\n     */\n    TablePropertiesDialog.prototype.show = function () {\n        var localValue = new L10n('documenteditor', this.owner.owner.defaultLocale);\n        localValue.setLocale(this.owner.owner.locale);\n        setCulture(this.owner.owner.locale);\n        if (!this.target) {\n            this.initTablePropertyDialog(localValue);\n        }\n        if (this.owner.selection.caret.style.display !== 'none') {\n            this.owner.selection.caret.style.display = 'none';\n        }\n        this.owner.dialog2.header = localValue.getConstant('Table Properties');\n        this.owner.dialog2.position = { X: 'center', Y: 'center' };\n        this.owner.dialog2.width = 'auto';\n        this.owner.dialog2.height = 'auto';\n        this.owner.dialog2.content = this.target;\n        this.owner.dialog2.beforeOpen = this.onBeforeOpen;\n        this.owner.dialog2.close = this.onCloseTablePropertyDialog;\n        this.owner.dialog2.open = this.wireEvent.bind(this);\n        this.owner.dialog2.buttons = [{\n                click: this.applyTableProperties,\n                buttonModel: { content: localValue.getConstant('Ok'), cssClass: 'e-flat e-table-ppty-okay', isPrimary: true }\n            },\n            {\n                click: this.closeTablePropertiesDialog,\n                buttonModel: { content: localValue.getConstant('Cancel'), cssClass: 'e-flat e-table-ppty-cancel' }\n            }];\n        //this.tabObj.select(0);\n        this.owner.dialog2.dataBind();\n        this.owner.dialog2.show();\n    };\n    /**\n     * @private\n     */\n    TablePropertiesDialog.prototype.calculateGridValue = function (table) {\n        table.calculateGrid();\n        table.isGridUpdated = false;\n        table.buildTableColumns();\n        table.isGridUpdated = true;\n        this.owner.selection.owner.isLayoutEnabled = true;\n        this.owner.layout.reLayoutTable(table);\n        this.owner.owner.editorModule.reLayout(this.owner.selection);\n        this.owner.owner.editorModule.updateSelectionTextPosition(true);\n        var history = this.owner.owner.editorHistory;\n        if (history && history.currentBaseHistoryInfo) {\n            if (history.currentBaseHistoryInfo.modifiedProperties.length > 0) {\n                history.currentBaseHistoryInfo.updateSelection();\n            }\n            history.updateHistory();\n        }\n        this.owner.owner.editorModule.fireContentChange();\n    };\n    /**\n     * @private\n     */\n    TablePropertiesDialog.prototype.loadTableProperties = function () {\n        this.setTableProperties();\n        this.setTableRowProperties();\n        this.setTableCellProperties();\n        if (!this.owner.owner.bordersAndShadingDialogModule) {\n            this.bordersAndShadingButton.disabled = true;\n        }\n        else {\n            this.bordersAndShadingButton.disabled = false;\n        }\n        // if (!this.owner.owner.tableOptionsDialogModule) {\n        //     this.tableOptionButton.disabled = true;\n        // } else {\n        this.tableOptionButton.disabled = false;\n        // }\n        // if (!this.owner.owner.cellOptionsDialogModule) {\n        //     this.cellOptionButton.disabled = true;\n        // } else {\n        this.cellOptionButton.disabled = false;\n        // }\n    };\n    /**\n     * @private\n     */\n    TablePropertiesDialog.prototype.wireEvent = function () {\n        this.owner.selection.hideCaret();\n        //Table Format\n        this.preferCheckBox.change = this.changeTableCheckBox.bind(this);\n        this.tableWidthBox.change = this.onTableWidthChange.bind(this);\n        this.tableWidthType.change = this.onTableWidthTypeChange.bind(this);\n        this.leftIndentBox.change = this.onLeftIndentChange.bind(this);\n        //Row Format\n        this.rowHeightCheckBox.change = this.changeTableRowCheckBox.bind(this);\n        this.rowHeightBox.change = this.onRowHeightChange.bind(this);\n        this.rowHeightType.change = this.onRowHeightTypeChange.bind(this);\n        this.allowRowBreak.change = this.onAllowBreakAcrossPage.bind(this);\n        this.repeatHeader.change = this.onRepeatHeader.bind(this);\n        //Cell Format\n        this.preferredCellWidthCheckBox.change = this.changeTableCellCheckBox.bind(this);\n        this.cellWidthBox.change = this.onCellWidthChange.bind(this);\n        this.cellWidthType.change = this.onCellWidthTypeChange.bind(this);\n    };\n    //#region Table Format\n    /**\n     * @private\n     */\n    // tslint:disable-next-line:max-func-body-length\n    TablePropertiesDialog.prototype.initTableProperties = function (element, localValue) {\n        var container = createElement('div', { id: element.id + '_table_TabContainer' });\n        var sizeHeader = createElement('div', {\n            id: container.id + '_sizeLabel', innerHTML: localValue.getConstant('Size'),\n            styles: 'width:100%;margin:0px;padding-top: 20px;padding-bottom: 0px;', className: 'e-de-table-dialog-options-label'\n        });\n        var parentContainer = createElement('div', { styles: 'display: inline-flex;' });\n        var childContainer1 = createElement('div', {\n            styles: 'float: left;',\n            className: 'e-de-table-container-div'\n        });\n        var childContainer2 = createElement('div', {\n            className: 'e-de-table-ppty-dlg-preferred-width-div'\n        });\n        var child1 = createElement('div', {\n            styles: 'display: inline;',\n            className: 'e-de-table-ppty-dlg-measure-div'\n        });\n        var child2 = createElement('div', {\n            styles: 'display: inline;position: absolute;',\n            className: 'e-de-table-ppty-dlg-measure-drop-down-div'\n        });\n        var childContainer3 = createElement('div');\n        var preferCheckBox = createElement('input', {\n            id: element.id + '_Prefer_Width_CheckBox', attrs: { 'type': 'checkbox' }\n        });\n        this.preferredWidth = createElement('input', { id: element.id + 'preferred_Width' });\n        var controlDiv = createElement('div');\n        var tableWidthType = createElement('select', {\n            innerHTML: '<option>' + localValue.getConstant('Points') +\n                '</option><option>' + localValue.getConstant('Percent') + '</option>', id: element.id + '_width_dropdown'\n        });\n        var labeltext = createElement('label', {\n            innerHTML: localValue.getConstant('Measure in'), styles: 'width: 60px;font-size: 11px; font-weight: normal;'\n        });\n        var alignmentHeader = createElement('div', {\n            innerHTML: localValue.getConstant('Alignment'), className: 'e-de-table-dialog-options-label',\n            styles: 'width: 100%;margin: 0px;padding-bottom: 15px'\n        });\n        var alignmentContainer = createElement('div', { styles: 'height:70px;' });\n        var classDivName = element.id + 'e-de-table-alignment';\n        var leftAlignDiv = createElement('div', { className: 'e-de-table-dia-align-div' });\n        this.left = createElement('div', {\n            className: 'e-icons e-de-table-properties-alignment e-de-table-left-alignment ' + classDivName,\n            id: element.id + '_left_alignment', styles: 'width:54px;height:54px;margin:2px'\n        });\n        leftAlignDiv.appendChild(this.left);\n        var centerAlignDiv = createElement('div', { className: 'e-de-table-dia-align-div' });\n        this.center = createElement('div', {\n            className: 'e-icons e-de-table-properties-alignment  e-de-table-center-alignment ' + classDivName,\n            id: element.id + '_center_alignment', styles: 'width:54px;height:54px;margin:2px'\n        });\n        centerAlignDiv.appendChild(this.center);\n        this.right = createElement('div', {\n            styles: 'width:54px;height:54px;margin:2px', id: element.id + '_right_alignment',\n            className: 'e-icons e-de-table-properties-alignment  e-de-table-right-alignment ' + classDivName\n        });\n        var rightAlignDiv = createElement('div', { className: 'e-de-table-dia-align-div' });\n        rightAlignDiv.appendChild(this.right);\n        var leftlabel = createElement('label', {\n            innerHTML: localValue.getConstant('Left'), className: 'e-de-table-dia-align-label'\n        });\n        var centerlabel = createElement('label', {\n            innerHTML: localValue.getConstant('Center'), className: 'e-de-table-dia-align-label'\n        });\n        var rightlabel = createElement('label', {\n            innerHTML: localValue.getConstant('Right'), className: 'e-de-table-dia-align-label'\n        });\n        var leftIndenetContainer = createElement('div', {\n            className: 'e-de-table-ppty-dlg-left-indent-container'\n        });\n        var leftIndentLabel = createElement('label', {\n            innerHTML: localValue.getConstant('Indent from left'),\n            styles: 'font-weight: normal;font-size: 11px;float:right;margin-right:121px;'\n        });\n        var leftIndentBox = createElement('div', {\n            styles: 'margin-top: 27px;'\n        });\n        this.leftIndent = createElement('input', { id: element.id + '_left_indent' });\n        var tableOptionContiner = createElement('div', {\n            className: 'e-de-tbl-dlg-border-btn'\n        });\n        this.bordersAndShadingButton = createElement('button', {\n            innerHTML: localValue.getConstant('Borders and Shading'),\n            id: element.id + '_borders_and_shadings', className: 'e-control e-btn e-flat e-de-ok-button'\n        });\n        this.tableOptionButton = createElement('button', {\n            className: 'e-control e-btn e-flat', innerHTML: localValue.getConstant('Options'),\n            id: element.id + '_table_cellmargin'\n        });\n        this.tableOptionButton.addEventListener('click', this.showTableOptionsDialog);\n        this.bordersAndShadingButton.addEventListener('click', this.showBordersShadingsPropertiesDialog);\n        tableOptionContiner.appendChild(this.bordersAndShadingButton);\n        tableOptionContiner.appendChild(this.tableOptionButton);\n        leftIndenetContainer.appendChild(leftIndentLabel);\n        leftIndentBox.appendChild(this.leftIndent);\n        leftIndenetContainer.appendChild(leftIndentBox);\n        alignmentContainer.appendChild(leftAlignDiv);\n        alignmentContainer.appendChild(centerAlignDiv);\n        alignmentContainer.appendChild(rightAlignDiv);\n        leftAlignDiv.appendChild(leftlabel);\n        centerAlignDiv.appendChild(centerlabel);\n        rightAlignDiv.appendChild(rightlabel);\n        alignmentContainer.appendChild(leftIndenetContainer);\n        container.appendChild(sizeHeader);\n        element.appendChild(container);\n        childContainer1.appendChild(preferCheckBox);\n        parentContainer.appendChild(childContainer1);\n        childContainer2.appendChild(this.preferredWidth);\n        parentContainer.appendChild(childContainer2);\n        controlDiv.appendChild(tableWidthType);\n        child1.appendChild(labeltext);\n        child2.appendChild(controlDiv);\n        childContainer3.appendChild(child1);\n        childContainer3.appendChild(child2);\n        parentContainer.appendChild(childContainer3);\n        element.appendChild(parentContainer);\n        element.appendChild(alignmentHeader);\n        element.appendChild(alignmentContainer);\n        element.appendChild(tableOptionContiner);\n        this.tableWidthBox = new NumericTextBox({\n            value: 0, decimals: 2, min: 0, max: 1584, width: 120, enablePersistence: false\n        });\n        this.tableWidthBox.appendTo(this.preferredWidth);\n        this.leftIndentBox = new NumericTextBox({\n            value: 0, decimals: 2, min: -1584, max: 1584, width: 140, enablePersistence: false\n        });\n        this.leftIndentBox.appendTo(this.leftIndent);\n        this.preferCheckBox = new CheckBox({\n            label: localValue.getConstant('Preferred Width')\n        });\n        this.preferCheckBox.appendTo(preferCheckBox);\n        this.tableWidthType = new DropDownList({ width: '120px' });\n        this.tableWidthType.appendTo(tableWidthType);\n    };\n    /**\n     * @private\n     */\n    TablePropertiesDialog.prototype.onTableWidthChange = function () {\n        this.tableFormat.preferredWidth = this.tableWidthBox.value;\n    };\n    /**\n     * @private\n     */\n    TablePropertiesDialog.prototype.onTableWidthTypeChange = function () {\n        var value;\n        var table = this.owner.selection.start.paragraph.associatedCell.ownerTable;\n        var width = HelperMethods.convertPixelToPoint(this.owner.clientArea.width);\n        if (this.tableWidthType.text === 'Percent' && this.owner.selection.tableFormat.preferredWidthType !== 'Percent') {\n            value = this.tableWidthBox.value / width * 100;\n            this.formatNumericTextBox(this.tableWidthBox, 'Percent', value);\n        }\n        else if (this.tableWidthType.text === 'Points' && this.owner.selection.tableFormat.preferredWidthType !== 'Point') {\n            value = width / 100 * this.tableWidthBox.value;\n            this.formatNumericTextBox(this.tableWidthBox, 'Point', value);\n        }\n        else {\n            if (this.tableWidthBox.format === '#\\'\\%\\'') {\n                if (this.tableWidthType.text === 'Points') {\n                    value = width / 100 * this.tableWidthBox.value;\n                }\n                else {\n                    value = this.tableWidthBox.value;\n                }\n            }\n            else {\n                if (this.tableWidthType.text === 'Percent') {\n                    value = this.tableWidthBox.value / width * 100;\n                }\n                else {\n                    value = this.tableWidthBox.value;\n                }\n            }\n            // tslint:disable-next-line:max-line-length\n            this.formatNumericTextBox(this.tableWidthBox, (this.tableWidthType.text === 'Points') ? 'Point' : this.tableWidthType.text, value);\n        }\n        this.tableFormat.preferredWidthType = (this.tableWidthType.text === 'Points') ? 'Point' : this.tableWidthType.text;\n    };\n    /**\n     * @private\n     */\n    TablePropertiesDialog.prototype.onLeftIndentChange = function () {\n        this.tableFormat.leftIndent = this.leftIndentBox.value;\n    };\n    TablePropertiesDialog.prototype.setTableProperties = function () {\n        //instance of Table Property values\n        var tableFormat = this.owner.selection.tableFormat;\n        var tableHasWidth = tableFormat.preferredWidth > 0;\n        var preferredWidth = tableFormat.preferredWidth;\n        if (isNullOrUndefined(tableFormat.preferredWidth)) {\n            this.preferCheckBox.indeterminate = true;\n            var startTable = this.owner.selection.start.paragraph.associatedCell.ownerTable;\n            var table = startTable.combineWidget(this.owner);\n            preferredWidth = table.tableFormat.preferredWidth;\n        }\n        else {\n            this.preferCheckBox.checked = tableHasWidth;\n        }\n        this.tableWidthBox.enabled = tableHasWidth;\n        this.tableWidthType.enabled = tableHasWidth;\n        this.formatNumericTextBox(this.tableWidthBox, tableFormat.preferredWidthType, preferredWidth);\n        if (tableFormat.preferredWidthType === 'Auto' || tableFormat.preferredWidthType === 'Point') {\n            this.tableWidthType.index = 0;\n        }\n        else {\n            this.tableWidthType.index = 1;\n        }\n        this.leftIndentBox.value = tableFormat.leftIndent;\n        this.leftIndentBox.enabled = tableFormat.tableAlignment === 'Left';\n        classList(this.left, [], ['e-de-table-alignment-active']);\n        classList(this.right, [], ['e-de-table-alignment-active']);\n        classList(this.center, [], ['e-de-table-alignment-active']);\n        if (tableFormat.tableAlignment === 'Left') {\n            this.left.classList.add('e-de-table-alignment-active');\n        }\n        else if (tableFormat.tableAlignment === 'Center') {\n            this.center.classList.add('e-de-table-alignment-active');\n        }\n        else if (tableFormat.tableAlignment === 'Right') {\n            this.right.classList.add('e-de-table-alignment-active');\n        }\n    };\n    /**\n     * @private\n     */\n    TablePropertiesDialog.prototype.getTableAlignment = function () {\n        var id = this.tableTab.id;\n        var groupButtons = this.tableTab.getElementsByClassName(id + 'e-de-table-alignment');\n        for (var j = 0; j < groupButtons.length; j++) {\n            var groupButton = groupButtons[j];\n            if (groupButton.classList.contains('e-de-table-alignment-active')) {\n                if (j === 0) {\n                    return 'Left';\n                }\n                else if (j === 1) {\n                    return 'Center';\n                }\n                else {\n                    return 'Right';\n                }\n            }\n        }\n        return undefined;\n    };\n    /**\n     * @private\n     */\n    TablePropertiesDialog.prototype.updateClassForAlignmentProperties = function (element) {\n        var id = element.id;\n        var groupButtons = element.getElementsByClassName(id + 'e-de-table-alignment');\n        for (var j = 0; j < groupButtons.length; j++) {\n            var groupButton = groupButtons[j];\n            if (groupButton.classList.contains('e-de-table-alignment-active')) {\n                classList(groupButton, ['e-de-table-properties-alignment'], ['e-de-table-alignment-active']);\n            }\n        }\n    };\n    //#endregion\n    //#region Row Format\n    /**\n     * @private\n     */\n    TablePropertiesDialog.prototype.initTableRowProperties = function (element, localValue) {\n        var rowDiv = createElement('div', { styles: 'width: 100%;' });\n        var sizeLabeldiv = createElement('div', {\n            innerHTML: localValue.getConstant('Size'),\n            styles: 'width: 100%;padding-top: 20px;padding-bottom: 10px;',\n            className: 'e-de-table-dialog-options-label'\n        });\n        var parentDiv = createElement('div', { styles: 'display: inline;width: 100%;' });\n        var childDiv1 = createElement('div', {\n            styles: 'display: inline;float: left;',\n            className: 'e-de-table-header-div'\n        });\n        var rowHeightCheckBox = createElement('input', {\n            attrs: { 'type': 'checkbox' }, id: element.id + '_height_CheckBox'\n        });\n        var childdiv2 = createElement('div', {\n            styles: 'display: inline-block;',\n            className: 'e-de-row-ht-top'\n        });\n        this.rowHeight = createElement('input', {\n            attrs: { 'type': 'text' }, 'id': element.id + '_table_row_height'\n        });\n        var child2 = createElement('div', {\n            styles: 'float: right;display: inline;width: auto;margin-top: 5px;'\n        });\n        var child3 = createElement('div', {\n            styles: 'display: inline;',\n            className: 'e-de-table-ppty-dlg-row-height-label'\n        });\n        var child4 = createElement('div', {\n            styles: 'display: inline;',\n            className: 'e-de-table-subheader-div'\n        });\n        var controlDiv = createElement('div');\n        var rowHeightType = createElement('select', {\n            innerHTML: '<option>' + localValue.getConstant('At least')\n                + '</option><option>' + localValue.getConstant('Exactly') + '</option>',\n            id: element.id + '_height_type'\n        });\n        var labeltext = createElement('label', {\n            innerHTML: localValue.getConstant('Row height is'), styles: 'font-size: 11px;font-weight: normal;width: 75px;'\n        });\n        rowDiv.appendChild(sizeLabeldiv);\n        element.appendChild(rowDiv);\n        childDiv1.appendChild(rowHeightCheckBox);\n        parentDiv.appendChild(childDiv1);\n        childdiv2.appendChild(this.rowHeight);\n        parentDiv.appendChild(childdiv2);\n        controlDiv.appendChild(rowHeightType);\n        child3.appendChild(labeltext);\n        child4.appendChild(controlDiv);\n        child2.appendChild(child3);\n        child2.appendChild(child4);\n        parentDiv.appendChild(child2);\n        element.appendChild(parentDiv);\n        var alignmentDiv = createElement('div', {\n            innerHTML: localValue.getConstant('Options'), styles: 'width: 100%;',\n            className: 'e-de-table-dialog-options-label'\n        });\n        // tslint:disable-next-line:max-line-length\n        var allowRowContainer = createElement('div', { className: 'e-de-table-ppty-options-break' });\n        var repeatHeaderContaniner = createElement('div', { className: 'e-de-table-ppty-options-header-row' });\n        var allowRowBreak = createElement('input', {\n            attrs: { 'type': 'checkbox' }, id: element.id + '_allow_row_break'\n        });\n        var repeatHeader = createElement('input', {\n            attrs: { 'type': 'checkbox' }, 'id': element.id + '_repeat_header'\n        });\n        allowRowContainer.appendChild(allowRowBreak);\n        repeatHeaderContaniner.appendChild(repeatHeader);\n        element.appendChild(alignmentDiv);\n        element.appendChild(allowRowContainer);\n        element.appendChild(repeatHeaderContaniner);\n        this.rowHeightBox = new NumericTextBox({\n            value: 0, decimals: 2, min: 0, max: 1584, width: 120, enablePersistence: false\n        });\n        this.rowHeightBox.appendTo(this.rowHeight);\n        this.rowHeightCheckBox = new CheckBox({\n            label: localValue.getConstant('Specify height')\n        });\n        this.rowHeightCheckBox.appendTo(rowHeightCheckBox);\n        this.rowHeightType = new DropDownList({ width: '120px' });\n        this.rowHeightType.appendTo(rowHeightType);\n        this.allowRowBreak = new CheckBox({\n            label: localValue.getConstant('Allow row to break across pages')\n        });\n        this.allowRowBreak.appendTo(allowRowBreak);\n        this.repeatHeader = new CheckBox({\n            label: localValue.getConstant('Repeat as header row at the top of each page')\n        });\n        this.repeatHeader.appendTo(repeatHeader);\n    };\n    TablePropertiesDialog.prototype.setTableRowProperties = function () {\n        var rowFormat = this.owner.selection.rowFormat;\n        var enableRowHeight = (rowFormat.height > 0 || rowFormat.heightType === 'Exactly');\n        //instance of table row values\n        if (enableRowHeight) {\n            this.rowHeightCheckBox.checked = true;\n        }\n        else {\n            if (rowFormat.heightType === undefined) {\n                this.rowHeightCheckBox.indeterminate = true;\n                enableRowHeight = true;\n            }\n            else {\n                this.rowHeightCheckBox.checked = false;\n            }\n        }\n        this.rowHeightBox.enabled = enableRowHeight;\n        this.rowHeightType.enabled = enableRowHeight;\n        // let enabledHeader: boolean = this.enableRepeatHeader() ? false : true;\n        var enabledHeader = true;\n        if (isNullOrUndefined(this.owner.selection.rowFormat.isHeader)) {\n            this.repeatHeader.indeterminate = true;\n            this.repeatHeader.disabled = true;\n        }\n        else if (this.owner.selection.rowFormat.isHeader) {\n            this.repeatHeader.checked = !enabledHeader;\n            this.repeatHeader.indeterminate = enabledHeader;\n            this.repeatHeader.disabled = enabledHeader;\n        }\n        else {\n            this.repeatHeader.checked = false;\n            this.repeatHeader.indeterminate = false;\n            this.repeatHeader.disabled = enabledHeader;\n        }\n        if (isNullOrUndefined(rowFormat.allowBreakAcrossPages)) {\n            this.allowRowBreak.indeterminate = true;\n        }\n        else {\n            this.allowRowBreak.checked = rowFormat.allowBreakAcrossPages;\n        }\n        this.rowHeightBox.value = rowFormat.height;\n        if (rowFormat.heightType === 'Auto' || rowFormat.heightType === 'AtLeast') {\n            this.rowHeightType.index = 0;\n        }\n        else {\n            this.rowHeightType.index = 1;\n        }\n    };\n    /**\n     * @private\n     */\n    TablePropertiesDialog.prototype.onRowHeightChange = function () {\n        this.rowHeightValue = this.rowHeightBox.value;\n    };\n    /**\n     * @private\n     */\n    TablePropertiesDialog.prototype.onRowHeightTypeChange = function () {\n        this.rowFormat.heightType = this.rowHeightType.text;\n    };\n    /**\n     * @private\n     */\n    TablePropertiesDialog.prototype.onAllowBreakAcrossPage = function () {\n        this.rowFormat.allowBreakAcrossPages = this.allowRowBreak.checked;\n    };\n    /**\n     * @private\n     */\n    TablePropertiesDialog.prototype.onRepeatHeader = function () {\n        this.rowFormat.isHeader = this.repeatHeader.checked;\n    };\n    /**\n     * @private\n     */\n    // public enableRepeatHeader(): boolean {\n    //     let isFirstRow: number = 0;\n    //     for (let i: number = 0; i < this.owner.selection.selectionRanges.length; i++) {\n    //         let range: SelectionRange = this.owner.selection.selectionRanges.getRange(i);\n    //         let table: WTable = range.start.paragraph.associatedCell.ownerTable;\n    //         if (table.childNodes.indexOf(range.start.paragraph.associatedCell.ownerRow) === 0 ||\n    //             table.childNodes.indexOf(range.start.paragraph.associatedCell.ownerRow) === 0) {\n    //             isFirstRow++;\n    //         }\n    //     }\n    //     return isFirstRow === this.owner.selection.selectionRanges.length;\n    // }\n    //#endregion\n    //#region Cell Format\n    /**\n     * @private\n     */\n    TablePropertiesDialog.prototype.initTableCellProperties = function (element, localValue) {\n        var sizeDiv = createElement('div', { styles: 'width: 100%;' });\n        var div = createElement('div', {\n            innerHTML: localValue.getConstant('Size'), className: 'e-de-table-dialog-options-label',\n            styles: 'width: 100%;padding-top: 20px;padding-bottom: 10px;',\n        });\n        var parentdiv = createElement('div', { styles: 'display: inline;width: 100%;' });\n        var childdiv1 = createElement('div', {\n            styles: 'display: inline;float: left;',\n            className: 'e-de-table-cell-header-div'\n        });\n        var preferredCellWidthCheckBox = createElement('input', {\n            attrs: { 'type': 'checkbox' }, id: element.id + '_Prefer_Width_CheckBox_cell'\n        });\n        var childdiv2 = createElement('div', {\n            styles: 'display: inline-block;',\n            className: 'e-de-cell-width-top'\n        });\n        this.preferredCellWidth = createElement('input', {\n            id: element.id + 'tablecell_Width_textBox', attrs: { 'type': 'text' }\n        });\n        var child2 = createElement('div', {\n            styles: 'float: right;display: inline;width: auto;margin-top: 5px;'\n        });\n        var child3 = createElement('div', {\n            styles: 'display: inline;',\n            className: 'e-de-table-ppty-dlg-cell-tab-measure-label'\n        });\n        var child4 = createElement('div', {\n            styles: 'display: inline;float: right;', className: 'e-de-table-cell-subheader-div'\n        });\n        var controlDiv = createElement('div');\n        var cellWidthType = createElement('select', {\n            innerHTML: '<option>' + localValue.getConstant('Points') + '</option><option>' +\n                localValue.getConstant('Percent') + '</option>', 'id': element.id + '_measure_type_cell'\n        });\n        var labeltext = createElement('label', {\n            innerHTML: localValue.getConstant('Measure in'),\n            styles: 'font-size: 11px;font-weight: normal;'\n        });\n        sizeDiv.appendChild(div);\n        element.appendChild(sizeDiv);\n        childdiv1.appendChild(preferredCellWidthCheckBox);\n        parentdiv.appendChild(childdiv1);\n        childdiv2.appendChild(this.preferredCellWidth);\n        parentdiv.appendChild(childdiv2);\n        controlDiv.appendChild(cellWidthType);\n        child3.appendChild(labeltext);\n        child4.appendChild(controlDiv);\n        child2.appendChild(child3);\n        child2.appendChild(child4);\n        parentdiv.appendChild(child2);\n        element.appendChild(parentdiv);\n        var alignmentDiv = createElement('div', {\n            innerHTML: localValue.getConstant('Vertical alignment'),\n            styles: 'width: 100%;margin: 0px;',\n            className: 'e-de-table-dialog-options-label'\n        });\n        var classDivName = element.id + 'e-de-table-cell-alignment';\n        var divAlignment = createElement('div', {\n            styles: 'width: 100%;height: 100px;'\n        });\n        var divStyle = 'width:54px;height:54px;margin:2px;border-style:solid;border-width:1px';\n        var topAlignDiv = createElement('div', { className: 'e-de-table-dia-align-div' });\n        this.cellTopAlign = createElement('div', {\n            styles: divStyle, id: element.id + '_cell_top-alignment',\n            className: 'e-icons e-de-tablecell-alignment  e-de-tablecell-top-alignment ' + classDivName\n        });\n        topAlignDiv.appendChild(this.cellTopAlign);\n        var centerAlignDiv = createElement('div', { className: 'e-de-table-dia-align-div' });\n        this.cellCenterAlign = createElement('div', {\n            styles: divStyle, id: element.id + '_cell_center-alignment',\n            className: 'e-icons e-de-tablecell-alignment  e-de-tablecell-center-alignment ' + classDivName\n        });\n        centerAlignDiv.appendChild(this.cellCenterAlign);\n        var bottomAlignDiv = createElement('div', { className: 'e-de-table-dia-align-div' });\n        this.cellBottomAlign = createElement('div', {\n            styles: divStyle, id: element.id + '_cell_bottom-alignment',\n            className: 'e-icons e-de-tablecell-alignment e-de-tablecell-bottom-alignment  ' + classDivName\n        });\n        bottomAlignDiv.appendChild(this.cellBottomAlign);\n        var topLabel = createElement('label', {\n            innerHTML: localValue.getConstant('Top'), className: 'e-de-table-dia-align-label'\n        });\n        var centerLabel = createElement('label', {\n            innerHTML: localValue.getConstant('Center'), className: 'e-de-table-dia-align-label'\n        });\n        var bottomLabel = createElement('label', {\n            innerHTML: localValue.getConstant('Bottom'), className: 'e-de-table-dia-align-label'\n        });\n        this.cellOptionButton = createElement('button', {\n            innerHTML: localValue.getConstant('Options'), id: element.id + '_table_cellmargin',\n            className: 'e-de-tbl-dlg-op-btn e-control e-btn e-flat e-de-cell-options',\n        });\n        divAlignment.appendChild(topAlignDiv);\n        divAlignment.appendChild(centerAlignDiv);\n        divAlignment.appendChild(bottomAlignDiv);\n        topAlignDiv.appendChild(topLabel);\n        centerAlignDiv.appendChild(centerLabel);\n        bottomAlignDiv.appendChild(bottomLabel);\n        element.appendChild(alignmentDiv);\n        element.appendChild(divAlignment);\n        element.appendChild(this.cellOptionButton);\n        this.cellOptionButton.addEventListener('click', this.showCellOptionsDialog);\n        this.cellWidthBox = new NumericTextBox({\n            value: 0, decimals: 2, min: 0, max: 1584, width: 120, enablePersistence: false\n        });\n        this.cellWidthBox.appendTo(this.preferredCellWidth);\n        this.preferredCellWidthCheckBox = new CheckBox({ label: localValue.getConstant('Preferred Width') });\n        this.preferredCellWidthCheckBox.appendTo(preferredCellWidthCheckBox);\n        this.cellWidthType = new DropDownList({ width: '120px' });\n        this.cellWidthType.appendTo(cellWidthType);\n    };\n    TablePropertiesDialog.prototype.setTableCellProperties = function () {\n        var cellFormat = this.owner.selection.cellFormat;\n        //instance of table cell Values\n        this.hasCellWidth = cellFormat.preferredWidth > 0;\n        var preferredWidth = cellFormat.preferredWidth;\n        if (isNullOrUndefined(cellFormat.preferredWidth)) {\n            this.preferredCellWidthCheckBox.indeterminate = true;\n            preferredWidth = this.owner.selection.start.paragraph.associatedCell.cellFormat.preferredWidth;\n        }\n        else {\n            this.preferredCellWidthCheckBox.checked = this.hasCellWidth;\n        }\n        this.cellWidthBox.enabled = this.hasCellWidth;\n        this.cellWidthType.enabled = this.hasCellWidth;\n        if (cellFormat.preferredWidthType === 'Auto' || cellFormat.preferredWidthType === 'Point') {\n            this.cellWidthType.index = 0;\n        }\n        else {\n            this.cellWidthType.index = 1;\n        }\n        this.formatNumericTextBox(this.cellWidthBox, cellFormat.preferredWidthType, preferredWidth);\n        classList(this.cellTopAlign, ['e-de-tablecell-alignment'], ['e-de-table-alignment-active']);\n        classList(this.cellCenterAlign, ['e-de-tablecell-alignment'], ['e-de-table-alignment-active']);\n        classList(this.cellBottomAlign, ['e-de-tablecell-alignment'], ['e-de-table-alignment-active']);\n        if (cellFormat.verticalAlignment === 'Top') {\n            this.cellTopAlign.classList.add('e-de-table-alignment-active');\n        }\n        else if (cellFormat.verticalAlignment === 'Center') {\n            this.cellCenterAlign.classList.add('e-de-table-alignment-active');\n        }\n        else if (cellFormat.verticalAlignment === 'Bottom') {\n            this.cellBottomAlign.classList.add('e-de-table-alignment-active');\n        }\n    };\n    /**\n     * @private\n     */\n    TablePropertiesDialog.prototype.updateClassForCellAlignment = function (element) {\n        var cellAlignments = element.getElementsByClassName(element.id + 'e-de-table-cell-alignment');\n        for (var j = 0; j < cellAlignments.length; j++) {\n            var cellAlignment = cellAlignments[j];\n            if (cellAlignment.classList.contains('e-de-table-alignment-active')) {\n                classList(cellAlignment, ['e-de-tablecell-alignment'], ['e-de-table-alignment-active']);\n            }\n        }\n    };\n    /**\n     * @private\n     */\n    TablePropertiesDialog.prototype.formatNumericTextBox = function (textBox, format, value) {\n        if (format === 'Auto' || format === 'Point') {\n            textBox.format = 'n2';\n        }\n        else {\n            textBox.format = '#\\'\\%\\'';\n        }\n        textBox.step = 1;\n        textBox.decimals = 2;\n        textBox.value = value;\n    };\n    /**\n     * @private\n     */\n    TablePropertiesDialog.prototype.getCellAlignment = function () {\n        var id = this.cellTab.id;\n        var groupButtons = this.cellTab.getElementsByClassName(id + 'e-de-table-cell-alignment');\n        for (var j = 0; j < groupButtons.length; j++) {\n            var groupButton = groupButtons[j];\n            if (groupButton.classList.contains('e-de-table-alignment-active')) {\n                if (j === 0) {\n                    return 'Top';\n                }\n                else if (j === 1) {\n                    return 'Center';\n                }\n                else {\n                    return 'Bottom';\n                }\n            }\n        }\n        return this.owner.selection.cellFormat.verticalAlignment;\n    };\n    /**\n     * @private\n     */\n    TablePropertiesDialog.prototype.onCellWidthChange = function () {\n        this.cellFormat.preferredWidth = this.cellWidthBox.value;\n    };\n    /**\n     * @private\n     */\n    TablePropertiesDialog.prototype.onCellWidthTypeChange = function () {\n        var value;\n        var table = this.owner.selection.start.paragraph.associatedCell.ownerTable;\n        var containerWidth = table.getOwnerWidth(true);\n        var tableWidth = table.getTableClientWidth(containerWidth);\n        if (this.cellWidthType.text === 'Percent' && this.owner.selection.cellFormat.preferredWidthType !== 'Percent') {\n            value = this.cellWidthBox.value / tableWidth * 100;\n            this.formatNumericTextBox(this.cellWidthBox, 'Percent', value);\n        }\n        else if (this.cellWidthType.text === 'Points' && this.owner.selection.cellFormat.preferredWidthType !== 'Point') {\n            value = tableWidth / 100 * this.cellWidthBox.value;\n            this.formatNumericTextBox(this.cellWidthBox, 'Point', value);\n        }\n        else {\n            if (this.cellWidthBox.format === '#\\'\\%\\'') {\n                if (this.cellWidthType.text === 'Points') {\n                    value = tableWidth / 100 * this.cellWidthBox.value;\n                }\n                else {\n                    value = this.cellWidthBox.value;\n                }\n            }\n            else {\n                if (this.cellWidthType.text === 'Percent') {\n                    value = this.cellWidthBox.value / tableWidth * 100;\n                }\n                else {\n                    value = this.cellWidthBox.value;\n                }\n            }\n            // tslint:disable-next-line:max-line-length\n            this.formatNumericTextBox(this.cellWidthBox, (this.cellWidthType.text === 'Points') ? 'Point' : this.cellWidthType.text, value);\n        }\n        this.cellFormat.preferredWidthType = (this.cellWidthType.text === 'Points') ? 'Point' : this.cellWidthType.text;\n    };\n    /**\n     * @private\n     */\n    TablePropertiesDialog.prototype.destroy = function () {\n        if (!isNullOrUndefined(this.target)) {\n            if (this.target.parentElement) {\n                this.target.parentElement.removeChild(this.target);\n            }\n            for (var s = 0; s < this.target.childNodes.length; s++) {\n                this.target.removeChild(this.target.childNodes[s]);\n                s--;\n            }\n            this.target = undefined;\n        }\n        this.dialog = undefined;\n        this.target = undefined;\n        this.cellAlignment = undefined;\n        this.tableAlignment = undefined;\n        this.owner = undefined;\n        this.preferCheckBox = undefined;\n        this.tableWidthType = undefined;\n        this.preferredWidth = undefined;\n        this.rowHeightType = undefined;\n        this.rowHeightCheckBox = undefined;\n        this.rowHeight = undefined;\n        this.cellWidthType = undefined;\n        this.preferredCellWidthCheckBox = undefined;\n        this.preferredCellWidth = undefined;\n        this.tableTab = undefined;\n        this.rowTab = undefined;\n        this.cellTab = undefined;\n        this.left = undefined;\n        this.center = undefined;\n        this.right = undefined;\n        this.leftIndent = undefined;\n        this.allowRowBreak = undefined;\n        this.repeatHeader = undefined;\n        this.cellTopAlign = undefined;\n        this.cellCenterAlign = undefined;\n        this.cellBottomAlign = undefined;\n        this.tableFormat.destroy();\n        this.cellFormat.destroy();\n        this.tableFormat = undefined;\n        this.cellFormat = undefined;\n    };\n    return TablePropertiesDialog;\n}());\nexport { TablePropertiesDialog };\n","import { createElement, isNullOrUndefined, L10n, setCulture } from '@syncfusion/ej2-base';\nimport { NumericTextBox } from '@syncfusion/ej2-inputs';\nimport { WTableFormat, WBorder, WBorders, WShading, WCellFormat } from '../format/index';\nimport { DropDownList } from '@syncfusion/ej2-dropdowns';\nimport { ColorPicker } from '@syncfusion/ej2-inputs';\n/**\n * The Borders and Shading dialog is used to modify borders and shading options for selected table or cells.\n */\nvar BordersAndShadingDialog = /** @class */ (function () {\n    /**\n     * @private\n     */\n    function BordersAndShadingDialog(viewer) {\n        var _this = this;\n        this.cellFormat = new WCellFormat();\n        this.tableFormat = new WTableFormat();\n        this.applyBordersShadingsProperties = function () {\n            var tablePropertiesDialog = _this.owner.owner.tablePropertiesDialogModule;\n            var selectedCell = _this.owner.selection.start.paragraph.associatedCell;\n            //Need to bind the properties with current cell and current table formats.\n            var borders = undefined;\n            if (_this.checkClassName(_this.previewDivTopTop) || _this.checkClassName(_this.previewDivTopBottom)\n                || _this.checkClassName(_this.previewDivTopCenter) || _this.checkClassName(_this.previewDivBottomcenter)\n                || _this.checkClassName(_this.previewDivBottomLeft) || _this.checkClassName(_this.previewDivBottomRight)\n                || _this.checkClassName(_this.previewDivDiagonalRight) || _this.checkClassName(_this.previewDivLeftDiagonal)) {\n                borders = new WBorders();\n                if (_this.checkClassName(_this.previewDivTopTop)) {\n                    borders.top = _this.getBorder();\n                }\n                if (_this.checkClassName(_this.previewDivTopBottom)) {\n                    borders.bottom = _this.getBorder();\n                }\n                if (_this.checkClassName(_this.previewDivBottomLeft)) {\n                    borders.left = _this.getBorder();\n                }\n                if (_this.checkClassName(_this.previewDivBottomRight)) {\n                    borders.right = _this.getBorder();\n                }\n                if (_this.checkClassName(_this.previewDivTopCenter)) {\n                    borders.horizontal = _this.getBorder();\n                }\n                if (_this.checkClassName(_this.previewDivBottomcenter)) {\n                    borders.vertical = _this.getBorder();\n                }\n                if (_this.checkClassName(_this.previewDivLeftDiagonal)) {\n                    borders.diagonalDown = _this.getBorder();\n                }\n                if (_this.checkClassName(_this.previewDivDiagonalRight)) {\n                    borders.diagonalUp = _this.getBorder();\n                }\n            }\n            var shading = new WShading();\n            var editorModule = _this.owner.owner.editorModule;\n            shading.backgroundColor = _this.shadingColorPicker.value;\n            if (_this.ulelementShading.index === 0) {\n                _this.applyTo = 0;\n                if (tablePropertiesDialog) {\n                    tablePropertiesDialog.isCellBordersAndShadingUpdated = true;\n                }\n                _this.cellFormat.borders = new WBorders();\n                if (!isNullOrUndefined(borders)) {\n                    editorModule.applyBordersInternal(_this.cellFormat.borders, borders);\n                }\n                else if (_this.noneDiv.classList.contains('e-de-table-border-inside-setting-click')) {\n                    editorModule.applyBordersInternal(_this.cellFormat.borders, new WBorders());\n                }\n                // Once option has been added for texture and foreground, need to handle this similar to Shading Fill.\n                if (!isNullOrUndefined(selectedCell.cellFormat.shading)) {\n                    shading.foregroundColor = selectedCell.cellFormat.shading.foregroundColor;\n                    shading.textureStyle = selectedCell.cellFormat.shading.textureStyle;\n                }\n                _this.cellFormat.shading = new WShading();\n                editorModule.applyShading(_this.cellFormat.shading, shading);\n            }\n            else {\n                if (tablePropertiesDialog) {\n                    tablePropertiesDialog.isTableBordersAndShadingUpdated = true;\n                }\n                _this.applyTo = 1;\n                var currentTableFormat = _this.owner.owner.selection.tableFormat.table.tableFormat;\n                _this.tableFormat.copyFormat(currentTableFormat);\n                _this.tableFormat.borders = new WBorders();\n                if (!isNullOrUndefined(borders)) {\n                    editorModule.applyBordersInternal(_this.tableFormat.borders, borders);\n                }\n                else if (_this.noneDiv.classList.contains('e-de-table-border-inside-setting-click')) {\n                    editorModule.applyBordersInternal(_this.tableFormat.borders, new WBorders());\n                }\n                // Once option has been added for texture and foreground, need to handle this similar to Shading Fill.\n                if (!isNullOrUndefined(currentTableFormat.shading)) {\n                    shading.foregroundColor = currentTableFormat.shading.foregroundColor;\n                    shading.textureStyle = currentTableFormat.shading.textureStyle;\n                }\n                _this.tableFormat.shading = new WShading();\n                editorModule.applyShading(_this.tableFormat.shading, shading);\n            }\n            _this.applyFormat();\n            _this.closeDialog();\n        };\n        /**\n         * @private\n         */\n        this.closeDialog = function () {\n            _this.owner.dialog.hide();\n            _this.closeBordersShadingsDialog();\n        };\n        this.closeBordersShadingsDialog = function () {\n            _this.owner.dialog2.element.style.pointerEvents = '';\n            _this.owner.updateFocus();\n        };\n        this.handleSettingCheckBoxAction = function (event) {\n            var targetId = event.target.id;\n            var tableBorderDialogId = _this.target.id;\n            var targetDiv;\n            if (targetId === tableBorderDialogId + '_None_Div' || targetId === tableBorderDialogId + '_None_Div_Container'\n                || targetId === tableBorderDialogId + '_None_Div_Transparent') {\n                _this.updateClassForSettingDivElements();\n                _this.noneDiv.classList.add('e-de-table-border-inside-setting-click');\n                _this.setSettingPreviewDivElement('none');\n            }\n            else if (targetId === tableBorderDialogId + '_Box_Div' || targetId === tableBorderDialogId + '_Box_Div_Container'\n                || targetId === tableBorderDialogId + '_Box_Div_Transparent') {\n                _this.updateClassForSettingDivElements();\n                _this.boxDiv.classList.add('e-de-table-border-inside-setting-click');\n                _this.setSettingPreviewDivElement('box');\n            }\n            else if (targetId === tableBorderDialogId + '_All_Div' || targetId === tableBorderDialogId + '_All_Div_Container'\n                || targetId === tableBorderDialogId + '_All_Div_Transparent') {\n                _this.updateClassForSettingDivElements();\n                _this.allDiv.classList.add('e-de-table-border-inside-setting-click');\n                _this.setSettingPreviewDivElement('all');\n            }\n            else {\n                _this.updateClassForSettingDivElements();\n                _this.customDiv.classList.add('e-de-table-border-inside-setting-click');\n                _this.setSettingPreviewDivElement('customDiv');\n            }\n        };\n        this.handlePreviewCheckBoxAction = function (event) {\n            var target = event.target;\n            var targetId = target.id;\n            var tableBorderDialog = _this.target;\n            var tableBorderDialogId = _this.target.id;\n            var checkBox;\n            var compareClass = 'e-de-table-border-inside-preview-click';\n            _this.customDiv.click();\n            if (targetId === tableBorderDialogId + '_Preview_Div_TopTop_Container' || targetId === tableBorderDialogId + '_Preview_Div_TopTop'\n                || targetId === tableBorderDialogId + '_previewDivTopTopTransParent') {\n                _this.handlePreviewCheckBoxShowHide(tableBorderDialogId, compareClass, _this.previewDivTopTop);\n                _this.showHidePreviewDivElements(tableBorderDialogId, compareClass, '_Preview_Div', '_Preview_Div_TopTop', 'TopTop');\n            }\n            else if (targetId === tableBorderDialogId + '_Preview_Div_TopCenter_Container'\n                || targetId === tableBorderDialogId + '_Preview_Div_TopCenter'\n                || targetId === tableBorderDialogId + '_previewDivTopCenterTransParent') {\n                _this.handlePreviewCheckBoxShowHide(tableBorderDialogId, compareClass, _this.previewDivTopCenter);\n                // tslint:disable-next-line:max-line-length\n                _this.showHidePreviewDivElements(tableBorderDialogId, compareClass, '_Preview_Div_Horizontal', '_Preview_Div_TopCenter', 'TopCenter');\n            }\n            else if (targetId === tableBorderDialogId + '_Preview_Div_TopBottom_Container' || targetId === tableBorderDialogId + '_Preview_Div_TopBottom'\n                || targetId === tableBorderDialogId + '_previewDivTopBottomTransParent') {\n                _this.handlePreviewCheckBoxShowHide(tableBorderDialogId, compareClass, _this.previewDivTopBottom);\n                _this.showHidePreviewDivElements(tableBorderDialogId, compareClass, '_Preview_Div', '_Preview_Div_TopBottom', 'TopBottom');\n            }\n            else if (targetId === tableBorderDialogId + '_Preview_Div_LeftDiagonal_Container'\n                || targetId === tableBorderDialogId + '_Preview_Div_LeftDiagonal'\n                || targetId === tableBorderDialogId + '_previewDivLeftDiagonalTransParent') {\n                _this.handlePreviewCheckBoxShowHide(tableBorderDialogId, compareClass, _this.previewDivLeftDiagonal);\n                // tslint:disable-next-line:max-line-length\n                _this.showHidePreviewDivElements(tableBorderDialogId, compareClass, '_Preview_Div_Left_Diagonal', '_Preview_Div_LeftDiagonal', 'LeftDiagonal');\n            }\n            else if (targetId === tableBorderDialogId + '_Preview_Div_BottomLeft_Container' || targetId === tableBorderDialogId + '_Preview_Div_BottomLeft'\n                || targetId === tableBorderDialogId + '_previewDivBottomLeftTransparent') {\n                _this.handlePreviewCheckBoxShowHide(tableBorderDialogId, compareClass, _this.previewDivBottomLeft);\n                _this.showHidePreviewDivElements(tableBorderDialogId, compareClass, '_Preview_Div', '_Preview_Div_BottomLeft', 'BottomLeft');\n            }\n            else if (targetId === tableBorderDialogId + '_Preview_Div_BottomCenter_Container'\n                || targetId === tableBorderDialogId + '_Preview_Div_BottomCenter'\n                || targetId === tableBorderDialogId + '_previewDivBottomcenterTransparent') {\n                _this.handlePreviewCheckBoxShowHide(tableBorderDialogId, compareClass, _this.previewDivBottomcenter);\n                // tslint:disable-next-line:max-line-length\n                _this.showHidePreviewDivElements(tableBorderDialogId, compareClass, '_Preview_Div_Vertical', '_Preview_Div_BottomCenter', 'BottomCenter');\n            }\n            else if (targetId === tableBorderDialogId + '_Preview_Div_BottomRight_Container' || targetId === tableBorderDialogId + '_Preview_Div_BottomRight'\n                || targetId === tableBorderDialogId + '_previewDivBottomRightTransparent') {\n                _this.handlePreviewCheckBoxShowHide(tableBorderDialogId, compareClass, _this.previewDivBottomRight);\n                _this.showHidePreviewDivElements(tableBorderDialogId, compareClass, '_Preview_Div', '_Preview_Div_BottomRight', 'BottomRight');\n            }\n            else if (targetId === tableBorderDialogId + '_Preview_Div_RightDiagonal_Container'\n                || targetId === tableBorderDialogId + '_Preview_Div_RightDiagonal'\n                || targetId === tableBorderDialogId + '_previewDivDiagonalRightTransparent') {\n                _this.handlePreviewCheckBoxShowHide(tableBorderDialogId, compareClass, _this.previewDivDiagonalRight);\n                // tslint:disable-next-line:max-line-length\n                _this.showHidePreviewDivElements(tableBorderDialogId, compareClass, '_Preview_Div_Right_Diagonal', '_Preview_Div_RightDiagonal', 'RightDiagonal');\n            }\n        };\n        this.applyTableCellPreviewBoxes = function () {\n            _this.customDiv.click();\n            if (!isNullOrUndefined(_this.ulelementShading)) {\n                if (_this.ulelementShading.index === 0) {\n                    _this.previewDivBottomcenterContainer.style.display = 'none';\n                    _this.previewDivTopCenterContainer.style.display = 'none';\n                    _this.previewVerticalDiv.style.display = 'none';\n                    _this.previewHorizontalDiv.style.display = 'none';\n                    _this.previewDivLeftDiagonal.style.display = '';\n                    _this.previewDivDiagonalRight.style.display = '';\n                    _this.previewDivBottomRightContainer.style.left = '80px';\n                }\n                else {\n                    _this.previewDivLeftDiagonal.style.display = 'none';\n                    _this.previewDivDiagonalRight.style.display = 'none';\n                    _this.previewDivBottomcenterContainer.style.display = '';\n                    _this.previewDivTopCenterContainer.style.display = '';\n                    _this.previewVerticalDiv.style.display = '';\n                    _this.previewHorizontalDiv.style.display = '';\n                    _this.previewDivBottomRightContainer.style.left = '110px';\n                }\n            }\n        };\n        this.applyPreviewTableBackgroundColor = function (args) {\n            if (!isNullOrUndefined(args.currentValue)) {\n                var color = args.currentValue.hex;\n                _this.previewDiv.style.backgroundColor = color;\n            }\n        };\n        this.applyPreviewTableBorderColor = function (args) {\n            if (!isNullOrUndefined(args.currentValue)) {\n                var color = args.currentValue.hex;\n                _this.previewDiv.style.borderColor = color;\n                _this.previewRightDiagonalDiv.style.backgroundColor = color;\n                _this.previewLeftDiagonalDiv.style.backgroundColor = color;\n                _this.previewVerticalDiv.style.backgroundColor = color;\n                _this.previewHorizontalDiv.style.backgroundColor = color;\n            }\n        };\n        this.owner = viewer;\n    }\n    BordersAndShadingDialog.prototype.getModuleName = function () {\n        return 'BordersAndShadingDialog';\n    };\n    /**\n     * @private\n     */\n    // tslint:disable-next-line:max-func-body-length\n    BordersAndShadingDialog.prototype.initBordersAndShadingsDialog = function (localeValue) {\n        var instance = this;\n        this.target = createElement('div', {\n            id: instance.owner.owner.containerId + '_table_border_shadings',\n            className: 'e-de-table-border-shading-dlg'\n        });\n        this.owner.owner.element.appendChild(this.target);\n        var displayText = createElement('div', {\n            innerHTML: localeValue.getConstant('Borders'), styles: 'position: absolute;top: 65px;',\n            id: this.target.id + '_border_label', className: 'e-de-table-border-heading'\n        });\n        var settingsContiner = createElement('div', {\n            styles: 'display: inline-block;position: absolute;top: 105px;width: 100px;height: 235px;border-style: none;',\n            id: this.target.id + '_border_settings'\n        });\n        var styleContainer = createElement('div', {\n            // tslint:disable-next-line:max-line-length\n            styles: 'display: inline-block;position: absolute;left: 125px;top: 125px;width: 150px;height: 235px;padding-left: 40px;border-style: none;padding-right: 40px;',\n            id: this.target.id + '_border_style'\n        });\n        var previewContiner = createElement('div', {\n            // tslint:disable-next-line:max-line-length\n            styles: 'display: inline-block;position: absolute;left: 345px;top: 87px;width: 180px;height: 235px;padding: 0px;border-style: none;',\n            id: this.target.id + '_border_preview'\n        });\n        var styleText = createElement('div', {\n            innerHTML: localeValue.getConstant('Style'), styles: 'width: 100%;padding-bottom: 10px;',\n            className: 'e-de-table-element-subheading'\n        });\n        var dropDownList = createElement('select', {\n            id: this.target.id + '_border_style_dropDown'\n        });\n        dropDownList.innerHTML = '<option>' + localeValue.getConstant('None') + '</option><option>'\n            + localeValue.getConstant('Single') + '</option><option>' + localeValue.getConstant('Dot') + '</option><option>'\n            + localeValue.getConstant('DashSmallGap') + '</option><option>' + localeValue.getConstant('DashLargeGap') + '</option><option>'\n            + localeValue.getConstant('DashDot') + '</option><option>' + localeValue.getConstant('DashDotDot') + '</option><option>'\n            + localeValue.getConstant('Double') + '</option><option>' + localeValue.getConstant('Triple') + '</option><option>'\n            + localeValue.getConstant('ThinThickSmallGap') + '</option><option>'\n            + localeValue.getConstant('ThickThinSmallGap') + '</option><option>' + localeValue.getConstant('ThinThickThinSmallGap')\n            + '</option><option>' + localeValue.getConstant('ThinThickMediumGap') + '</option><option>'\n            + localeValue.getConstant('ThickThinMediumGap') + '</option><option>' + localeValue.getConstant('ThinThickThinMediumGap')\n            + '</option><option>' + localeValue.getConstant('ThinThickLargeGap') + '</option><option>'\n            + localeValue.getConstant('ThickThinLargeGap') + '</option><option>' + localeValue.getConstant('ThinThickThinLargeGap')\n            + '</option><option>' + localeValue.getConstant('SingleWavy') + '</option><option>'\n            + localeValue.getConstant('DoubleWavy') + '</option><option>' + localeValue.getConstant('DashDotStroked')\n            + '</option><option>' + localeValue.getConstant('Emboss3D') + '</option><option>' + localeValue.getConstant('Engrave3D')\n            + '</option><option>' + localeValue.getConstant('Outset') + '</option><option>'\n            + localeValue.getConstant('Inset') + '</option><option>' + localeValue.getConstant('Thick') + '</option>';\n        var widthText = createElement('div', {\n            innerHTML: localeValue.getConstant('Width'), styles: 'width:100%;padding-top: 20px;padding-bottom: 10px;',\n            className: 'e-de-table-element-subheading'\n        });\n        var widthNumeric = createElement('input', {\n            id: this.target.id + '_width'\n        });\n        var colorText = createElement('div', {\n            innerHTML: localeValue.getConstant('Color'), styles: 'padding-top: 25px;',\n            className: 'e-de-table-setting-heading'\n        });\n        var borderColorPickerElement = createElement('input', {\n            attrs: { 'type': 'color' },\n            id: this.target.id + '_border_color',\n            styles: 'width: 30px;position: absolute;left: 90px;',\n            className: 'e-dlg-clr-pkr-top'\n        });\n        var settingText = createElement('div', {\n            innerHTML: localeValue.getConstant('Setting'), styles: 'width: 100%;position: absolute;',\n            className: 'e-de-table-setting-heading'\n        });\n        var noneDivContainer = createElement('div', {\n            id: this.target.id + '_None_Div_Container', className: 'e-de-table-border-none'\n        });\n        this.noneDiv = createElement('div', {\n            id: this.target.id + '_None_Div',\n            className: 'e-de-table-border-inside-setting e-de-table-border-setting-genral'\n        });\n        var noneDivLabel = createElement('label', {\n            innerHTML: localeValue.getConstant('None'), className: 'e-de-table-setting-labels-heading',\n            styles: 'padding-left: 10px;top: 20px;position: absolute;',\n            id: this.target.id + '_None_Div_Label'\n        });\n        var boxDivContainer = createElement('div', {\n            id: this.target.id + '_Box_Div_Container', className: 'e-de-table-border-box'\n        });\n        this.boxDiv = createElement('div', {\n            id: this.target.id + '_Box_Div',\n            className: 'e-de-table-border-inside-setting e-de-table-border-setting-genral'\n        });\n        var boxDivLabel = createElement('label', {\n            innerHTML: localeValue.getConstant('Box'), className: 'e-de-table-setting-labels-heading',\n            styles: 'padding-left: 10px;top: 20px;position: absolute;',\n            id: this.target.id + '_Box_Div_Label'\n        });\n        var allDivContainer = createElement('div', {\n            id: this.target.id + '_All_Div_Container', className: 'e-de-table-border-all'\n        });\n        this.allDiv = createElement('div', {\n            id: this.target.id + '_All_Div',\n            className: 'e-de-table-border-inside-setting e-de-table-border-setting-genral'\n        });\n        var allDivLabel = createElement('label', {\n            innerHTML: localeValue.getConstant('All'), className: 'e-de-table-setting-labels-heading',\n            styles: 'padding-left: 10px;top: 25px;position: absolute;',\n            id: this.target.id + '_All_Div_Label'\n        });\n        var customDivContainer = createElement('div', {\n            id: this.target.id + '_Custom_Div_Container', className: 'e-de-table-border-custom'\n        });\n        this.customDiv = createElement('div', {\n            id: this.target.id + '_Custom_Div',\n            className: 'e-de-table-border-inside-setting e-de-table-border-setting-genral'\n        });\n        var customDivLabel = createElement('label', {\n            innerHTML: localeValue.getConstant('Custom'), className: 'e-de-table-setting-labels-heading',\n            styles: 'padding-left: 10px;top: 25px;position: absolute;',\n            id: this.target.id + '_Custom_Div_Label'\n        });\n        this.noneDivTransparent = createElement('div', {\n            id: this.target.id + '_None_Div_Transparent', className: 'e-icons e-de-table-border-setting e-de-table-border-none-setting'\n        });\n        this.boxDivTransparent = createElement('div', {\n            id: this.target.id + '_Box_Div_Transparent', className: 'e-icons e-de-table-border-setting e-de-table-border-box-setting'\n        });\n        this.allDivTransparent = createElement('div', {\n            id: this.target.id + '_All_Div_Transparent', className: 'e-icons e-de-table-border-setting e-de-table-border-all-setting'\n        });\n        this.customDivTransparent = createElement('div', {\n            id: this.target.id + '_Custom_Div_Transparent', className: 'e-icons e-de-table-border-setting e-de-table-border-custom-setting'\n        });\n        var previewText = createElement('div', {\n            innerHTML: localeValue.getConstant('Preview'), className: 'e-de-table-setting-heading',\n            styles: 'position: absolute;top: 20px;left: 10px;'\n        });\n        this.previewDiv = createElement('div', {\n            styles: 'width: 80px;height: 80px;position: absolute; left: 50px;top: 50px;',\n            id: this.target.id + '_Preview_Div', className: 'e-de-border-dlg-preview-div'\n        });\n        this.previewRightDiagonalDiv = createElement('div', {\n            styles: 'position: absolute;width:1px;height:113px;left: 90px;top: 34px;transform: rotate(135deg);',\n            id: this.target.id + '_Preview_Div_Right_Diagonal',\n            className: 'e-de-border-dlg-preview-inside-divs'\n        });\n        this.previewLeftDiagonalDiv = createElement('div', {\n            styles: 'position: absolute;width: 1px;height: 113px;left: 90px;top: 34px;transform:rotate(45deg);',\n            id: this.target.id + '_Preview_Div_Left_Diagonal',\n            className: 'e-de-border-dlg-preview-inside-divs'\n        });\n        this.previewVerticalDiv = createElement('div', {\n            styles: 'width: 1px;height: 81px;position: absolute;left: 90px;top: 50px;',\n            id: this.target.id + '_Preview_Div_Vertical',\n            className: 'e-de-border-dlg-preview-inside-divs'\n        });\n        this.previewHorizontalDiv = createElement('div', {\n            styles: 'width: 81px;height: 1px;position: absolute;left: 50px;top: 90px;',\n            id: this.target.id + '_Preview_Div_Horizontal',\n            className: 'e-de-border-dlg-preview-inside-divs'\n        });\n        this.previewDivTopTopContainer = createElement('div', {\n            styles: 'top: 50px;position: absolute;left: 10px;', id: this.target.id + '_Preview_Div_TopTop_Container'\n        });\n        this.previewDivTopTop = createElement('div', {\n            id: this.target.id + '_Preview_Div_TopTop',\n            className: 'e-de-table-border-inside-preview e-de-table-border-preview-genral'\n        });\n        this.previewDivTopCenterContainer = createElement('div', {\n            styles: 'top: 80px;position: absolute;left: 10px;', id: this.target.id + '_Preview_Div_TopCenter_Container'\n        });\n        this.previewDivTopCenter = createElement('div', {\n            id: this.target.id + '_Preview_Div_TopCenter',\n            className: 'e-de-table-border-inside-preview e-de-table-border-preview-genral'\n        });\n        this.previewDivTopBottomContainer = createElement('div', {\n            styles: 'top: 110px;position: absolute;left: 10px;', id: this.target.id + '_Preview_Div_TopBottom_Container'\n        });\n        this.previewDivTopBottom = createElement('div', {\n            id: this.target.id + '_Preview_Div_TopBottom',\n            className: 'e-de-table-border-inside-preview e-de-table-border-preview-genral'\n        });\n        this.previewDivLeftDiagonalContainer = createElement('div', {\n            styles: 'top: 145px;position: absolute;left: 10px;', id: this.target.id + '_Preview_Div_LeftDiagonal_Container'\n        });\n        this.previewDivLeftDiagonal = createElement('div', {\n            id: this.target.id + '_Preview_Div_LeftDiagonal',\n            className: 'e-de-table-border-inside-preview e-de-table-border-preview-genral'\n        });\n        this.previewDivBottomLeftContainer = createElement('div', {\n            styles: 'top: 145px;position: absolute;left: 50px', id: this.target.id + '_Preview_Div_BottomLeft_Container'\n        });\n        this.previewDivBottomLeft = createElement('div', {\n            id: this.target.id + '_Preview_Div_BottomLeft',\n            className: 'e-de-table-border-inside-preview e-de-table-border-preview-genral'\n        });\n        this.previewDivBottomcenterContainer = createElement('div', {\n            styles: 'top: 145px;position: absolute;left: 80px;', id: this.target.id + '_Preview_Div_BottomCenter_Container'\n        });\n        this.previewDivBottomcenter = createElement('div', {\n            id: this.target.id + '_Preview_Div_BottomCenter',\n            className: 'e-de-table-border-inside-preview e-de-table-border-preview-genral'\n        });\n        this.previewDivBottomRightContainer = createElement('div', {\n            styles: 'top: 145px;position: absolute;left: 110px;', id: this.target.id + '_Preview_Div_BottomRight_Container'\n        });\n        this.previewDivBottomRight = createElement('div', {\n            id: this.target.id + '_Preview_Div_BottomRight',\n            className: 'e-de-table-border-inside-preview e-de-table-border-preview-genral'\n        });\n        this.previewDivDiagonalRightContainer = createElement('div', {\n            styles: 'top: 145px; position: absolute; left: 110px;', id: this.target.id + '_Preview_Div_RightDiagonal_Container'\n        });\n        this.previewDivDiagonalRight = createElement('div', {\n            id: this.target.id + '_Preview_Div_RightDiagonal',\n            className: 'e-de-table-border-inside-preview e-de-table-border-preview-genral'\n        });\n        this.previewDivTopTopTransParent = createElement('div', {\n            id: this.target.id + '_previewDivTopTopTransParent',\n            className: 'e-icons e-de-table-border-preview e-de-table-border-toptop-alignment'\n        });\n        this.previewDivTopCenterTransParent = createElement('div', {\n            id: this.target.id + '_previewDivTopCenterTransParent',\n            className: 'e-icons e-de-table-border-preview e-de-table-border-topcenter-alignment'\n        });\n        this.previewDivTopBottomTransParent = createElement('div', {\n            id: this.target.id + '_previewDivTopBottomTransParent',\n            className: 'e-icons e-de-table-border-preview e-de-table-border-topbottom-alignment'\n        });\n        this.previewDivLeftDiagonalTransParent = createElement('div', {\n            id: this.target.id + '_previewDivLeftDiagonalTransParent',\n            className: 'e-icons e-de-table-border-preview e-de-table-border-diagionalup-alignment'\n        });\n        this.previewDivBottomLeftTransparent = createElement('div', {\n            id: this.target.id + '_previewDivBottomLeftTransparent',\n            className: 'e-icons e-de-table-border-preview e-de-table-border-bottomleft-alignment'\n        });\n        this.previewDivBottomcenterTransparent = createElement('div', {\n            id: this.target.id + '_previewDivBottomcenterTransparent',\n            className: 'e-icons e-de-table-border-preview e-de-table-border-bottomcenter-alignment'\n        });\n        this.previewDivBottomRightTransparent = createElement('div', {\n            id: this.target.id + '_previewDivBottomRightTransparent',\n            className: 'e-icons e-de-table-border-preview e-de-table-border-bottomright-alignment'\n        });\n        this.previewDivDiagonalRightTransparent = createElement('div', {\n            id: this.target.id + '_previewDivDiagonalRightTransparent',\n            className: 'e-icons e-de-table-border-preview e-de-table-border-diagionaldown-alignment'\n        });\n        this.shadingContiner = createElement('div', {\n            /* tslint:disable:max-line-length */\n            styles: 'display:inline-block;position:absolute;left:17px;width:400px;height:100px;padding:0px;border-style: none;margin-left:10px;',\n            id: this.target.id + '_shading_preview', className: 'e-de-table-shading-preview'\n        });\n        var shadingText = createElement('div', {\n            innerHTML: localeValue.getConstant('Shading'), className: 'e-de-table-border-heading',\n            styles: 'padding-top: 30px;left: 5px;'\n        });\n        var shadings = createElement('div', { styles: 'display:flex;' });\n        var label = createElement('div', {\n            innerHTML: localeValue.getConstant('Fill'), className: 'e-de-table-setting-heading e-de-table-border-fill',\n            styles: 'top: 50px;left: 10px;'\n        });\n        var shadingColorPickerElement = createElement('input', {\n            attrs: { 'type': 'color' },\n            id: this.target.id + '_shading_color', styles: 'position: absolute;top: 75px;left: 40px;width: 30px;'\n        });\n        var shdApply = createElement('div', {\n            styles: 'position:absolute;top:41px;left:150px;width:180px;'\n        });\n        var div = createElement('div', {\n            styles: 'width:100px;padding-bottom: 10px;', innerHTML: localeValue.getConstant('Apply To'),\n            className: 'e-de-table-element-subheading'\n        });\n        var divsion = createElement('div', { styles: 'width:100px;position:absolute;' });\n        var ulelementShading = createElement('select', {\n            innerHTML: '<option>' + localeValue.getConstant('Cell') + '</option>'\n                + '<option>' + localeValue.getConstant('Table') + '</option>',\n            id: this.target.id + '_shading'\n        });\n        divsion.appendChild(ulelementShading);\n        this.noneDiv.appendChild(this.noneDivTransparent);\n        this.boxDiv.appendChild(this.boxDivTransparent);\n        this.allDiv.appendChild(this.allDivTransparent);\n        this.customDiv.appendChild(this.customDivTransparent);\n        noneDivContainer.appendChild(this.noneDiv);\n        noneDivContainer.appendChild(noneDivLabel);\n        boxDivContainer.appendChild(this.boxDiv);\n        boxDivContainer.appendChild(boxDivLabel);\n        allDivContainer.appendChild(this.allDiv);\n        allDivContainer.appendChild(allDivLabel);\n        customDivContainer.appendChild(this.customDiv);\n        customDivContainer.appendChild(customDivLabel);\n        settingsContiner.appendChild(settingText);\n        settingsContiner.appendChild(noneDivContainer);\n        settingsContiner.appendChild(boxDivContainer);\n        settingsContiner.appendChild(allDivContainer);\n        settingsContiner.appendChild(customDivContainer);\n        this.previewDivBottomcenter.appendChild(this.previewDivBottomcenterTransparent);\n        this.previewDivBottomRight.appendChild(this.previewDivBottomRightTransparent);\n        this.previewDivBottomLeft.appendChild(this.previewDivBottomLeftTransparent);\n        this.previewDivTopTop.appendChild(this.previewDivTopTopTransParent);\n        this.previewDivTopCenter.appendChild(this.previewDivTopCenterTransParent);\n        this.previewDivTopBottom.appendChild(this.previewDivTopBottomTransParent);\n        this.previewDivDiagonalRight.appendChild(this.previewDivDiagonalRightTransparent);\n        this.previewDivLeftDiagonal.appendChild(this.previewDivLeftDiagonalTransParent);\n        this.previewDivBottomcenterContainer.appendChild(this.previewDivBottomcenter);\n        this.previewDivBottomLeftContainer.appendChild(this.previewDivBottomLeft);\n        this.previewDivBottomRightContainer.appendChild(this.previewDivBottomRight);\n        this.previewDivDiagonalRightContainer.appendChild(this.previewDivDiagonalRight);\n        this.previewDivLeftDiagonalContainer.appendChild(this.previewDivLeftDiagonal);\n        this.previewDivTopBottomContainer.appendChild(this.previewDivTopBottom);\n        this.previewDivTopCenterContainer.appendChild(this.previewDivTopCenter);\n        this.previewDivTopTopContainer.appendChild(this.previewDivTopTop);\n        previewContiner.appendChild(previewText);\n        previewContiner.appendChild(this.previewDiv);\n        previewContiner.appendChild(this.previewRightDiagonalDiv);\n        previewContiner.appendChild(this.previewHorizontalDiv);\n        previewContiner.appendChild(this.previewLeftDiagonalDiv);\n        previewContiner.appendChild(this.previewVerticalDiv);\n        previewContiner.appendChild(this.previewDivBottomcenterContainer);\n        previewContiner.appendChild(this.previewDivBottomLeftContainer);\n        previewContiner.appendChild(this.previewDivBottomRightContainer);\n        previewContiner.appendChild(this.previewDivDiagonalRightContainer);\n        previewContiner.appendChild(this.previewDivLeftDiagonalContainer);\n        previewContiner.appendChild(this.previewDivTopBottomContainer);\n        previewContiner.appendChild(this.previewDivTopCenterContainer);\n        previewContiner.appendChild(this.previewDivTopTopContainer);\n        shdApply.appendChild(div);\n        shdApply.appendChild(divsion);\n        shadings.appendChild(label);\n        shadings.appendChild(shadingColorPickerElement);\n        shadings.appendChild(shdApply);\n        this.shadingContiner.appendChild(shadingText);\n        this.shadingContiner.appendChild(shadings);\n        styleContainer.appendChild(styleText);\n        styleContainer.appendChild(dropDownList);\n        styleContainer.appendChild(widthText);\n        styleContainer.appendChild(widthNumeric);\n        styleContainer.appendChild(colorText);\n        styleContainer.appendChild(borderColorPickerElement);\n        this.target.appendChild(displayText);\n        this.target.appendChild(settingsContiner);\n        this.target.appendChild(styleContainer);\n        this.target.appendChild(previewContiner);\n        this.target.appendChild(this.shadingContiner);\n        // Handling Setting Container\n        noneDivContainer.addEventListener('click', this.handleSettingCheckBoxAction);\n        boxDivContainer.addEventListener('click', this.handleSettingCheckBoxAction);\n        allDivContainer.addEventListener('click', this.handleSettingCheckBoxAction);\n        customDivContainer.addEventListener('click', this.handleSettingCheckBoxAction);\n        // Handling Preview Div Container\n        this.previewDivBottomcenterContainer.addEventListener('click', this.handlePreviewCheckBoxAction);\n        this.previewDivBottomLeftContainer.addEventListener('click', this.handlePreviewCheckBoxAction);\n        this.previewDivBottomRightContainer.addEventListener('click', this.handlePreviewCheckBoxAction);\n        this.previewDivTopTopContainer.addEventListener('click', this.handlePreviewCheckBoxAction);\n        this.previewDivTopBottomContainer.addEventListener('click', this.handlePreviewCheckBoxAction);\n        this.previewDivTopCenterContainer.addEventListener('click', this.handlePreviewCheckBoxAction);\n        this.previewDivDiagonalRightContainer.addEventListener('click', this.handlePreviewCheckBoxAction);\n        this.previewDivLeftDiagonalContainer.addEventListener('click', this.handlePreviewCheckBoxAction);\n        // handling dropdown change\n        this.borderWidth = new NumericTextBox({\n            value: 0, min: 0, max: 6, decimals: 2,\n            width: 150, enablePersistence: false\n        });\n        this.borderWidth.appendTo(widthNumeric);\n        this.borderStyle = new DropDownList({\n            width: '150px', popupHeight: '150px', index: 1\n        });\n        this.borderStyle.appendTo(dropDownList);\n        this.ulelementShading = new DropDownList({\n            width: '150px', change: this.applyTableCellPreviewBoxes, index: 1\n        });\n        this.ulelementShading.appendTo(ulelementShading);\n        this.borderColorPicker = new ColorPicker({\n            value: '#000000', change: this.applyPreviewTableBorderColor\n        });\n        this.borderColorPicker.appendTo(borderColorPickerElement);\n        this.shadingColorPicker = new ColorPicker({\n            value: '#000000', change: this.applyPreviewTableBackgroundColor\n        });\n        this.shadingColorPicker.appendTo(shadingColorPickerElement);\n    };\n    BordersAndShadingDialog.prototype.applyFormat = function () {\n        var selection = this.owner.selection;\n        var editorModule = this.owner.owner.editorModule;\n        editorModule.initComplexHistory('BordersAndShading');\n        editorModule.isBordersAndShadingDialog = true;\n        if (this.applyTo === 0) {\n            editorModule.onCellFormat(this.cellFormat);\n        }\n        else {\n            editorModule.onTableFormat(this.tableFormat);\n        }\n        if (!isNullOrUndefined(this.owner.owner.editorHistory.currentHistoryInfo)) {\n            this.owner.owner.editorHistory.updateComplexHistory();\n        }\n        editorModule.isBordersAndShadingDialog = false;\n    };\n    BordersAndShadingDialog.prototype.getBorder = function () {\n        var border = new WBorder();\n        border.color = this.borderColorPicker.value;\n        border.lineStyle = this.borderStyle.text;\n        border.lineWidth = this.borderWidth.value;\n        return border;\n    };\n    BordersAndShadingDialog.prototype.checkClassName = function (element) {\n        return element.classList.contains('e-de-table-border-inside-preview-click');\n    };\n    /**\n     * @private\n     */\n    BordersAndShadingDialog.prototype.show = function () {\n        var localeValue = new L10n('documenteditor', this.owner.owner.defaultLocale);\n        localeValue.setLocale(this.owner.owner.locale);\n        setCulture(this.owner.owner.locale);\n        if (!this.target) {\n            this.initBordersAndShadingsDialog(localeValue);\n        }\n        this.loadBordersShadingsPropertiesDialog();\n        this.owner.dialog.content = this.target;\n        this.owner.dialog.header = localeValue.getConstant('Borders and Shading');\n        this.owner.dialog.beforeOpen = this.owner.updateFocus;\n        this.owner.dialog.close = this.closeBordersShadingsDialog;\n        this.owner.dialog.position = { X: 'center', Y: 'top' };\n        this.owner.dialog.width = 'auto';\n        this.owner.dialog.height = 'auto';\n        this.owner.dialog.buttons = [{\n                click: this.applyBordersShadingsProperties,\n                buttonModel: { content: localeValue.getConstant('Ok'), cssClass: 'e-flat e-table-border-shading-okay', isPrimary: true }\n            },\n            {\n                click: this.closeDialog,\n                buttonModel: { content: localeValue.getConstant('Cancel'), cssClass: 'e-flat e-table-border-shading-cancel' }\n            }];\n        this.owner.dialog.dataBind();\n        this.owner.dialog.show();\n    };\n    BordersAndShadingDialog.prototype.updateClassForSettingDivElements = function () {\n        var settingDivs = this.target.getElementsByClassName('e-de-table-border-inside-setting');\n        for (var j = 0; j < settingDivs.length; j++) {\n            if (settingDivs[j].className.indexOf('e-de-table-border-inside-setting-click') !== -1) {\n                var tempClassName = settingDivs[j].className;\n                tempClassName = tempClassName.replace('e-de-table-border-inside-setting-click', '');\n                settingDivs[j].className = tempClassName;\n            }\n        }\n    };\n    BordersAndShadingDialog.prototype.setSettingPreviewDivElement = function (position) {\n        switch (position) {\n            case 'none':\n                this.previewDivTopTop.classList.remove('e-de-table-border-inside-preview-click');\n                this.previewDivTopCenter.classList.remove('e-de-table-border-inside-preview-click');\n                this.previewDivTopBottom.classList.remove('e-de-table-border-inside-preview-click');\n                this.previewDivLeftDiagonal.classList.remove('e-de-table-border-inside-preview-click');\n                this.previewDivDiagonalRight.classList.remove('e-de-table-border-inside-preview-click');\n                this.previewDivBottomRight.classList.remove('e-de-table-border-inside-preview-click');\n                this.previewDivBottomLeft.classList.remove('e-de-table-border-inside-preview-click');\n                this.previewDivBottomcenter.classList.remove('e-de-table-border-inside-preview-click');\n                this.isShowHidePreviewTableElements('none');\n                break;\n            case 'box':\n                this.previewDivTopCenter.classList.remove('e-de-table-border-inside-preview-click');\n                this.previewDivLeftDiagonal.classList.remove('e-de-table-border-inside-preview-click');\n                this.previewDivDiagonalRight.classList.remove('e-de-table-border-inside-preview-click');\n                this.previewDivBottomcenter.classList.remove('e-de-table-border-inside-preview-click');\n                this.previewDivTopTop.classList.add('e-de-table-border-inside-preview-click');\n                this.previewDivTopBottom.classList.add('e-de-table-border-inside-preview-click');\n                this.previewDivBottomRight.classList.add('e-de-table-border-inside-preview-click');\n                this.previewDivBottomLeft.classList.add('e-de-table-border-inside-preview-click');\n                this.isShowHidePreviewTableElements('box');\n                break;\n            case 'all':\n                this.previewDivLeftDiagonal.classList.remove('e-de-table-border-inside-preview-click');\n                this.previewDivDiagonalRight.classList.remove('e-de-table-border-inside-preview-click');\n                this.previewDivBottomcenter.classList.add('e-de-table-border-inside-preview-click');\n                this.previewDivTopTop.classList.add('e-de-table-border-inside-preview-click');\n                this.previewDivTopBottom.classList.add('e-de-table-border-inside-preview-click');\n                this.previewDivBottomRight.classList.add('e-de-table-border-inside-preview-click');\n                this.previewDivBottomLeft.classList.add('e-de-table-border-inside-preview-click');\n                this.previewDivTopCenter.classList.add('e-de-table-border-inside-preview-click');\n                this.isShowHidePreviewTableElements('all');\n                break;\n        }\n    };\n    BordersAndShadingDialog.prototype.isShowHidePreviewTableElements = function (settingDiv) {\n        switch (settingDiv) {\n            case 'none':\n                this.previewDiv.style.border = 'none';\n                this.previewRightDiagonalDiv.style.display = 'none';\n                this.previewLeftDiagonalDiv.style.display = 'none';\n                this.previewHorizontalDiv.style.display = 'none';\n                this.previewVerticalDiv.style.display = 'none';\n                break;\n            case 'box':\n                this.previewDiv.style.border = '1px solid rgba(0, 0, 0, .54)';\n                this.previewRightDiagonalDiv.style.display = 'none';\n                this.previewLeftDiagonalDiv.style.display = 'none';\n                this.previewHorizontalDiv.style.display = 'none';\n                this.previewVerticalDiv.style.display = 'none';\n                break;\n            case 'all':\n                this.previewDiv.style.border = '1px solid rgba(0, 0, 0, .54)';\n                this.previewRightDiagonalDiv.style.display = 'none';\n                this.previewLeftDiagonalDiv.style.display = 'none';\n                this.previewHorizontalDiv.style.display = 'block';\n                this.previewVerticalDiv.style.display = 'block';\n                break;\n        }\n    };\n    BordersAndShadingDialog.prototype.handlePreviewCheckBoxShowHide = function (tableBorderDialogId, compareClass, element) {\n        if (element.classList.contains(compareClass)) {\n            element.classList.remove(compareClass);\n        }\n        else {\n            element.classList.add(compareClass);\n        }\n    };\n    // tslint:disable-next-line:max-line-length\n    BordersAndShadingDialog.prototype.showHidePreviewDivElements = function (tableBorderDialogId, compareClass, elementClass, compareElementClass, position) {\n        var setElement = document.getElementById(tableBorderDialogId + elementClass);\n        var compareElement = document.getElementById(tableBorderDialogId + compareElementClass);\n        if (position === 'TopTop') {\n            this.setPropertyPreviewDivElement(setElement, compareElement, compareClass, 'border-top');\n        }\n        else if (position === 'TopCenter') {\n            this.setPropertyPreviewDivElement(setElement, compareElement, compareClass, 'display');\n        }\n        else if (position === 'TopBottom') {\n            this.setPropertyPreviewDivElement(setElement, compareElement, compareClass, 'border-bottom');\n        }\n        else if (position === 'LeftDiagonal') {\n            this.setPropertyPreviewDivElement(setElement, compareElement, compareClass, 'display');\n        }\n        else if (position === 'BottomLeft') {\n            this.setPropertyPreviewDivElement(setElement, compareElement, compareClass, 'border-left');\n        }\n        else if (position === 'BottomCenter') {\n            this.setPropertyPreviewDivElement(setElement, compareElement, compareClass, 'display');\n        }\n        else if (position === 'BottomRight') {\n            this.setPropertyPreviewDivElement(setElement, compareElement, compareClass, 'border-right');\n        }\n        else if (position === 'RightDiagonal') {\n            this.setPropertyPreviewDivElement(setElement, compareElement, compareClass, 'display');\n        }\n    };\n    BordersAndShadingDialog.prototype.setPropertyPreviewDivElement = function (ele, compareElement, compareClass, property) {\n        if (compareElement.classList.contains(compareClass) && property.split('-')[0] === 'border') {\n            /* tslint:disable:no-any */\n            ele.style[property] = '1px solid rgba(0, 0, 0, .54)';\n        }\n        else if (compareElement.classList.contains(compareClass) && property === 'display') {\n            ele.style[property] = 'block';\n        }\n        else {\n            ele.style[property] = 'none';\n            /* tslint:enable:no-any */\n        }\n    };\n    BordersAndShadingDialog.prototype.loadBordersShadingsPropertiesDialog = function () {\n        var tableFormat = this.owner.selection.tableFormat.table.tableFormat;\n        var lineStyle;\n        var borderColor;\n        var fillColor;\n        var borderWidth;\n        if (!isNullOrUndefined(tableFormat) && !isNullOrUndefined(tableFormat.borders)) {\n            this.cloneBorders(tableFormat.borders);\n            if (isNullOrUndefined(tableFormat.borders) || isNullOrUndefined(tableFormat.borders.top)) {\n                lineStyle = 1;\n                borderColor = '#000000';\n                borderWidth = 0;\n                fillColor = '#000000';\n            }\n            else {\n                lineStyle = this.getLineStyle(tableFormat.borders.top.lineStyle);\n                borderColor = tableFormat.borders.top.color;\n                borderWidth = tableFormat.borders.top.getLineWidth();\n                fillColor = tableFormat.shading.backgroundColor;\n            }\n        }\n        this.borderColorPicker.value = borderColor;\n        this.shadingColorPicker.value = fillColor;\n        /* tslint:disable:no-any */\n        var colorPickerEvent = {\n            target: this.borderColorPicker, ctrlKey: false,\n            shiftKey: false, which: 0\n        };\n        var fillColorEvent = {\n            target: this.shadingColorPicker, ctrlKey: false,\n            shiftKey: false, which: 0\n        };\n        /* tslint:enable:no-any */\n        this.applyPreviewTableBackgroundColor(fillColorEvent);\n        this.applyPreviewTableBorderColor(colorPickerEvent);\n        this.ulelementShading.index = 1;\n        this.previewDivLeftDiagonal.style.display = 'none';\n        this.previewDivDiagonalRight.style.display = 'none';\n        this.borderWidth.value = borderWidth;\n        this.borderStyle.index = lineStyle;\n    };\n    // tslint:disable:max-func-body-length\n    BordersAndShadingDialog.prototype.cloneBorders = function (borders) {\n        var topBorder = false;\n        var bottomBorder = false;\n        var leftBorder = false;\n        var rightBorder = false;\n        var horizontalBorder = false;\n        var verticalBorder = false;\n        var diagonalDownBorder = false;\n        var customBorder = false;\n        var diagonalUpBorder = false;\n        if (borders !== null) {\n            if (borders.top && (borders.top.hasNoneStyle || borders.top.lineStyle !== 'None')) {\n                topBorder = true;\n            }\n            if (borders.bottom && (borders.bottom.hasNoneStyle || borders.bottom.lineStyle !== 'None')) {\n                bottomBorder = true;\n            }\n            if (borders.left && (borders.left.hasNoneStyle || borders.left.lineStyle !== 'None')) {\n                leftBorder = true;\n            }\n            if (borders.right && (borders.right.hasNoneStyle || borders.right.lineStyle !== 'None')) {\n                rightBorder = true;\n            }\n            if (borders.horizontal && (borders.horizontal.hasNoneStyle || borders.horizontal.lineStyle !== 'None')) {\n                horizontalBorder = true;\n            }\n            if (borders.vertical && (borders.vertical.hasNoneStyle || borders.vertical.lineStyle !== 'None')) {\n                verticalBorder = true;\n            }\n            if (borders.diagonalDown && (borders.diagonalDown.hasNoneStyle || borders.diagonalDown.lineStyle !== 'None')) {\n                diagonalDownBorder = true;\n            }\n            if (borders.diagonalUp && (borders.diagonalUp.hasNoneStyle || borders.diagonalUp.lineStyle !== 'None')) {\n                diagonalUpBorder = true;\n            }\n            if (!(!topBorder || !bottomBorder || !leftBorder || !rightBorder)) {\n                if (!(!topBorder || !bottomBorder || !leftBorder || !rightBorder || !horizontalBorder\n                    || !verticalBorder || diagonalUpBorder || diagonalDownBorder)) {\n                    if ((topBorder && bottomBorder && leftBorder && rightBorder && horizontalBorder && verticalBorder\n                        && !diagonalUpBorder && !diagonalDownBorder)) {\n                        if (borders.top.hasNoneStyle && borders.bottom.hasNoneStyle && borders.left.hasNoneStyle\n                            && borders.right.hasNoneStyle && borders.horizontal.hasNoneStyle && borders.vertical.hasNoneStyle) {\n                            this.setSettingPreviewDivElement('none');\n                            this.customDiv.classList.remove('e-de-table-border-inside-setting-click');\n                            this.noneDiv.classList.add('e-de-table-border-inside-setting-click');\n                            this.boxDiv.classList.remove('e-de-table-border-inside-setting-click');\n                            this.allDiv.classList.remove('e-de-table-border-inside-setting-click');\n                        }\n                        else {\n                            this.setSettingPreviewDivElement('all');\n                            this.allDiv.classList.add('e-de-table-border-inside-setting-click');\n                            this.customDiv.classList.remove('e-de-table-border-inside-setting-click');\n                            this.noneDiv.classList.remove('e-de-table-border-inside-setting-click');\n                            this.boxDiv.classList.remove('e-de-table-border-inside-setting-click');\n                        }\n                    }\n                }\n                else if ((leftBorder && bottomBorder && topBorder && rightBorder && !horizontalBorder && !verticalBorder)) {\n                    if (borders.top.hasNoneStyle && borders.bottom.hasNoneStyle && borders.left.hasNoneStyle\n                        && borders.right.hasNoneStyle && borders.horizontal.hasNoneStyle && borders.vertical.hasNoneStyle) {\n                        this.setSettingPreviewDivElement('none');\n                        this.boxDiv.classList.remove('e-de-table-border-inside-setting-click');\n                        this.allDiv.classList.remove('e-de-table-border-inside-setting-click');\n                        this.customDiv.classList.remove('e-de-table-border-inside-setting-click');\n                        this.noneDiv.classList.add('e-de-table-border-inside-setting-click');\n                    }\n                    else {\n                        this.setSettingPreviewDivElement('box');\n                        this.customDiv.classList.remove('e-de-table-border-inside-setting-click');\n                        this.noneDiv.classList.remove('e-de-table-border-inside-setting-click');\n                        this.boxDiv.classList.add('e-de-table-border-inside-setting-click');\n                        this.allDiv.classList.remove('e-de-table-border-inside-setting-click');\n                    }\n                }\n                else {\n                    customBorder = true;\n                }\n            }\n            else {\n                customBorder = true;\n            }\n            this.previewDivLeftDiagonal.classList.remove('e-de-table-border-inside-preview-click');\n            this.previewDivDiagonalRight.classList.remove('e-de-table-border-inside-preview-click');\n            if (customBorder) {\n                this.customDiv.classList.add('e-de-table-border-inside-setting-click');\n                this.noneDiv.classList.remove('e-de-table-border-inside-setting-click');\n                this.boxDiv.classList.remove('e-de-table-border-inside-setting-click');\n                this.allDiv.classList.remove('e-de-table-border-inside-setting-click');\n                if (topBorder) {\n                    this.previewDivTopTop.classList.add('e-de-table-border-inside-preview-click');\n                }\n                else {\n                    this.previewDivTopTop.classList.remove('e-de-table-border-inside-preview-click');\n                }\n                if (bottomBorder) {\n                    this.previewDivTopBottom.classList.add('e-de-table-border-inside-preview-click');\n                }\n                else {\n                    this.previewDivTopBottom.classList.remove('e-de-table-border-inside-preview-click');\n                }\n                if (leftBorder) {\n                    this.previewDivBottomLeft.classList.add('e-de-table-border-inside-preview-click');\n                }\n                else {\n                    this.previewDivBottomLeft.classList.remove('e-de-table-border-inside-preview-click');\n                }\n                if (rightBorder) {\n                    this.previewDivBottomRight.classList.add('e-de-table-border-inside-preview-click');\n                }\n                else {\n                    this.previewDivBottomRight.classList.remove('e-de-table-border-inside-preview-click');\n                }\n                if (verticalBorder) {\n                    this.previewDivBottomcenter.classList.add('e-de-table-border-inside-preview-click');\n                }\n                else {\n                    this.previewDivBottomcenter.classList.remove('e-de-table-border-inside-preview-click');\n                }\n                if (horizontalBorder) {\n                    this.previewDivTopCenter.classList.add('e-de-table-border-inside-preview-click');\n                }\n                else {\n                    this.previewDivTopCenter.classList.remove('e-de-table-border-inside-preview-click');\n                }\n            }\n        }\n    };\n    BordersAndShadingDialog.prototype.getLineStyle = function (lineStyle) {\n        switch (lineStyle) {\n            case 'Single': return 1;\n            case 'Dot': return 2;\n            case 'DashSmallGap': return 3;\n            case 'DashLargeGap': return 4;\n            case 'DashDot': return 5;\n            case 'DashDotDot': return 6;\n            case 'Double': return 7;\n            case 'Triple': return 8;\n            case 'ThinThickSmallGap': return 9;\n            case 'ThickThinSmallGap': return 10;\n            case 'ThinThickThinSmallGap': return 11;\n            case 'ThinThickMediumGap': return 12;\n            case 'ThickThinMediumGap': return 13;\n            case 'ThinThickThinMediumGap': return 14;\n            case 'ThinThickLargeGap': return 15;\n            case 'ThickThinLargeGap': return 16;\n            case 'ThinThickThinLargeGap': return 17;\n            case 'SingleWavy': return 18;\n            case 'DoubleWavy': return 19;\n            case 'DashDotStroked': return 20;\n            case 'Emboss3D': return 21;\n            case 'Engrave3D': return 22;\n            case 'Outset': return 23;\n            case 'Inset': return 24;\n            case 'Thick': return 25;\n        }\n        return 0;\n    };\n    /**\n     * @private\n     */\n    BordersAndShadingDialog.prototype.destroy = function () {\n        if (!isNullOrUndefined(this.target)) {\n            if (this.target.parentElement) {\n                this.target.parentElement.removeChild(this.target);\n            }\n            for (var k = 0; k < this.target.childNodes.length; k++) {\n                this.target.removeChild(this.target.childNodes[k]);\n                k--;\n            }\n            this.target = undefined;\n        }\n        if (this.cellFormat) {\n            this.cellFormat.destroy();\n            this.cellFormat = undefined;\n        }\n        if (this.tableFormat) {\n            this.tableFormat.destroy();\n            this.tableFormat = undefined;\n        }\n        this.dialog = undefined;\n        this.target = undefined;\n        if (!isNullOrUndefined(this.borderStyle)) {\n            this.borderStyle.destroy();\n        }\n        this.borderStyle = undefined;\n        if (!isNullOrUndefined(this.borderColorPicker)) {\n            this.borderColorPicker.destroy();\n        }\n        this.borderColorPicker = undefined;\n        if (!isNullOrUndefined(this.shadingColorPicker)) {\n            this.shadingColorPicker.destroy();\n        }\n        this.shadingColorPicker = undefined;\n        if (!isNullOrUndefined(this.ulelementShading)) {\n            this.ulelementShading.destroy();\n        }\n        this.ulelementShading = undefined;\n        this.noneDivTransparent = undefined;\n        this.boxDivTransparent = undefined;\n        this.allDivTransparent = undefined;\n        this.customDivTransparent = undefined;\n        this.previewDiv = undefined;\n        this.previewRightDiagonalDiv = undefined;\n        this.previewLeftDiagonalDiv = undefined;\n        this.previewVerticalDiv = undefined;\n        this.previewHorizontalDiv = undefined;\n        this.previewDivTopTopContainer = undefined;\n        this.previewDivTopTop = undefined;\n        this.previewDivTopCenterContainer = undefined;\n        this.previewDivTopCenter = undefined;\n        this.previewDivTopBottomContainer = undefined;\n        this.previewDivTopBottom = undefined;\n        this.previewDivLeftDiagonalContainer = undefined;\n        this.previewDivLeftDiagonal = undefined;\n        this.previewDivBottomLeftContainer = undefined;\n        this.previewDivBottomLeft = undefined;\n        this.previewDivBottomcenterContainer = undefined;\n        this.previewDivBottomcenter = undefined;\n        this.previewDivBottomRightContainer = undefined;\n        this.previewDivBottomRight = undefined;\n        this.previewDivDiagonalRightContainer = undefined;\n        this.previewDivDiagonalRight = undefined;\n        this.previewDivTopTopTransParent = undefined;\n        this.previewDivTopCenterTransParent = undefined;\n        this.previewDivTopBottomTransParent = undefined;\n        this.previewDivLeftDiagonalTransParent = undefined;\n        this.previewDivBottomLeftTransparent = undefined;\n        this.previewDivBottomcenterTransparent = undefined;\n        this.previewDivBottomRightTransparent = undefined;\n        this.previewDivDiagonalRightTransparent = undefined;\n        this.shadingContiner = undefined;\n        this.noneDiv = undefined;\n        this.customDiv = undefined;\n        this.allDiv = undefined;\n        this.boxDiv = undefined;\n    };\n    return BordersAndShadingDialog;\n}());\nexport { BordersAndShadingDialog };\n","import { CheckBox } from '@syncfusion/ej2-buttons';\nimport { NumericTextBox } from '@syncfusion/ej2-inputs';\nimport { WTableFormat } from '../index';\nimport { isNullOrUndefined, L10n, createElement, setCulture } from '@syncfusion/ej2-base';\nimport { CellOptionsDialog } from './index';\n/**\n * The Table options dialog is used to modify default cell margins and cell spacing of selected table.\n */\nvar TableOptionsDialog = /** @class */ (function () {\n    /**\n     * @private\n     */\n    function TableOptionsDialog(viewer) {\n        var _this = this;\n        /**\n         * @private\n         */\n        this.applyTableCellProperties = function () {\n            var tableFormat = _this.owner.selection.tableFormat;\n            if (!isNullOrUndefined(_this.bottomMarginBox.value || _this.leftMarginBox.value\n                || _this.rightMarginBox.value || _this.topMarginBox.value || _this.cellSpaceTextBox.value)\n                && (tableFormat.bottomMargin !== _this.bottomMarginBox.value\n                    || tableFormat.leftMargin !== _this.leftMarginBox.value\n                    || tableFormat.rightMargin !== _this.rightMarginBox.value\n                    || tableFormat.topMargin !== _this.topMarginBox.value\n                    || tableFormat.cellSpacing !== _this.cellSpaceTextBox.value)) {\n                _this.owner.owner.tablePropertiesDialogModule.isTableOptionsUpdated = true;\n                _this.applyTableOptions(_this.tableFormat);\n                _this.owner.owner.tablePropertiesDialogModule.applyTableSubProperties();\n            }\n            _this.closeCellMarginsDialog();\n        };\n        /**\n         * @private\n         */\n        this.closeCellMarginsDialog = function () {\n            _this.owner.dialog.hide();\n            _this.owner.dialog.element.style.pointerEvents = '';\n            _this.owner.updateFocus();\n        };\n        /**\n         * @private\n         */\n        this.changeAllowSpaceCheckBox = function () {\n            if (_this.allowSpaceCheckBox.checked) {\n                _this.cellSpaceTextBox.enabled = true;\n            }\n            else {\n                _this.cellSpaceTextBox.enabled = false;\n            }\n        };\n        /**\n         * @private\n         */\n        this.removeEvents = function () {\n            _this.owner.dialog2.element.style.pointerEvents = '';\n            _this.owner.updateFocus();\n        };\n        this.owner = viewer;\n    }\n    Object.defineProperty(TableOptionsDialog.prototype, \"tableFormat\", {\n        /**\n         * @private\n         */\n        get: function () {\n            if (isNullOrUndefined(this.tableFormatIn)) {\n                return this.tableFormatIn = new WTableFormat();\n            }\n            return this.tableFormatIn;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    /**\n     * @private\n     */\n    TableOptionsDialog.prototype.getModuleName = function () {\n        return 'TableOptionsDialog';\n    };\n    /**\n     * @private\n     */\n    TableOptionsDialog.prototype.initTableOptionsDialog = function (localValue) {\n        var instance = this.owner;\n        this.target = createElement('div', {\n            id: this.owner.owner.containerId + '_insertCellMarginsDialog', className: 'e-de-table-options-dlg'\n        });\n        this.owner.owner.element.appendChild(this.target);\n        var innerDiv = createElement('div', { styles: 'width: 475px;position: relative;height: 180px;' });\n        var innerDivLabel = createElement('Label', {\n            id: this.target.id + '_innerDivLabel', className: 'e-de-cell-dia-options-label',\n            innerHTML: localValue.getConstant('Default cell margins')\n        });\n        innerDiv.appendChild(innerDivLabel);\n        CellOptionsDialog.getCellMarginDialogElements(this, innerDiv, localValue);\n        var div = createElement('div', { styles: 'width: 475px; position: relative;' });\n        var cellSpaceLabel = createElement('Label', {\n            className: 'e-de-cell-dia-options-label',\n            id: this.target.id + '_cellSpaceLabel'\n        });\n        cellSpaceLabel.innerHTML = localValue.getConstant('Default cell spacing');\n        div.appendChild(cellSpaceLabel);\n        var table2 = createElement('TABLE', {\n            styles: 'height: 30px;padding-bottom: 15px;'\n        });\n        var tr3 = createElement('tr');\n        var td5 = createElement('td');\n        var allowSpaceCheckBox = createElement('input', {\n            attrs: { 'type': 'checkbox' }, id: this.target.id + '_cellcheck'\n        });\n        var td6 = createElement('td', { styles: 'padding-left: 15px;', });\n        this.cellspacingTextBox = createElement('input', {\n            attrs: { 'type': 'text' }, id: this.target.id + '_cellspacing'\n        });\n        td5.appendChild(allowSpaceCheckBox);\n        td6.appendChild(this.cellspacingTextBox);\n        tr3.appendChild(td5);\n        tr3.appendChild(td6);\n        table2.appendChild(tr3);\n        div.appendChild(table2);\n        var divBtn = document.createElement('div');\n        this.target.appendChild(div);\n        this.target.appendChild(divBtn);\n        this.cellSpaceTextBox = new NumericTextBox({\n            value: 0, min: 0, max: 264.5, width: 150,\n            decimals: 2, enablePersistence: false\n        });\n        this.cellSpaceTextBox.appendTo(this.cellspacingTextBox);\n        this.allowSpaceCheckBox = new CheckBox({\n            label: localValue.getConstant('Allow spacing between cells'),\n            change: this.changeAllowSpaceCheckBox,\n            cssClass: 'e-de-tbl-margin-sub-header',\n        });\n        this.allowSpaceCheckBox.appendTo(allowSpaceCheckBox);\n    };\n    /**\n     * @private\n     */\n    TableOptionsDialog.prototype.loadCellMarginsDialog = function () {\n        var tableFormat = this.owner.selection.tableFormat;\n        this.cellSpaceTextBox.value = tableFormat.cellSpacing;\n        this.bottomMarginBox.value = tableFormat.bottomMargin;\n        this.topMarginBox.value = tableFormat.topMargin;\n        this.rightMarginBox.value = tableFormat.rightMargin;\n        this.leftMarginBox.value = tableFormat.leftMargin;\n        if (tableFormat.cellSpacing > 0) {\n            this.allowSpaceCheckBox.checked = true;\n            this.cellSpaceTextBox.enabled = true;\n        }\n        else {\n            this.allowSpaceCheckBox.checked = false;\n            this.cellSpaceTextBox.enabled = false;\n        }\n    };\n    /**\n     * @private\n     */\n    TableOptionsDialog.prototype.applySubTableOptions = function (tableFormat) {\n        this.owner.owner.editorHistory.initComplexHistory(this.owner.selection, 'TableMarginsSelection');\n        this.applyTableOptionsHistory(tableFormat);\n        if (!isNullOrUndefined(this.owner.owner.editorHistory.currentHistoryInfo)) {\n            this.owner.owner.editorHistory.updateComplexHistory();\n        }\n    };\n    /**\n     * @private\n     */\n    TableOptionsDialog.prototype.applyTableOptionsHelper = function (tableFormat) {\n        this.applySubTableOptionsHelper(tableFormat);\n    };\n    /**\n     * @private\n     */\n    TableOptionsDialog.prototype.applyTableOptionsHistory = function (tableFormat) {\n        this.owner.owner.editorModule.initHistory('TableOptions');\n        this.applySubTableOptionsHelper(tableFormat);\n    };\n    /**\n     * @private\n     */\n    TableOptionsDialog.prototype.applySubTableOptionsHelper = function (tableFormat) {\n        var ownerTable = this.owner.selection.start.currentWidget.paragraph.associatedCell.ownerTable;\n        ownerTable = ownerTable.combineWidget(this.owner);\n        var currentTableFormat = ownerTable.tableFormat;\n        if (!isNullOrUndefined(this.owner.owner.editorHistory.currentBaseHistoryInfo)) {\n            this.owner.owner.editorHistory.currentBaseHistoryInfo.addModifiedTableOptions(currentTableFormat);\n        }\n        currentTableFormat.cellSpacing = tableFormat.cellSpacing;\n        currentTableFormat.leftMargin = tableFormat.leftMargin;\n        currentTableFormat.topMargin = tableFormat.topMargin;\n        currentTableFormat.rightMargin = tableFormat.rightMargin;\n        currentTableFormat.bottomMargin = tableFormat.bottomMargin;\n        this.owner.owner.tablePropertiesDialogModule.calculateGridValue(ownerTable);\n    };\n    /**\n     * @private\n     */\n    TableOptionsDialog.prototype.applyTableOptions = function (tableFormat) {\n        tableFormat.leftMargin = this.leftMarginBox.value;\n        tableFormat.topMargin = this.topMarginBox.value;\n        tableFormat.bottomMargin = this.bottomMarginBox.value;\n        tableFormat.rightMargin = this.rightMarginBox.value;\n        if (this.allowSpaceCheckBox.checked) {\n            tableFormat.cellSpacing = this.cellSpaceTextBox.value;\n        }\n    };\n    /**\n     * @private\n     */\n    TableOptionsDialog.prototype.show = function () {\n        var documentLocale = new L10n('documenteditor', this.owner.owner.defaultLocale);\n        documentLocale.setLocale(this.owner.owner.locale);\n        setCulture(this.owner.owner.locale);\n        if (!this.target) {\n            this.initTableOptionsDialog(documentLocale);\n        }\n        this.loadCellMarginsDialog();\n        this.owner.dialog.header = documentLocale.getConstant('Table Options');\n        this.owner.dialog.content = this.target;\n        this.owner.dialog.beforeOpen = undefined;\n        this.owner.dialog.position = { X: 'center', Y: 'top' };\n        //  this.owner.dialog.cssClass = 'e-de-table-margin-size';\n        this.owner.dialog.height = 'auto';\n        this.owner.dialog.width = 'auto';\n        this.owner.dialog.open = undefined;\n        this.owner.dialog.beforeOpen = this.owner.updateFocus;\n        this.owner.dialog.close = this.removeEvents;\n        this.owner.dialog.buttons = [{\n                click: this.applyTableCellProperties,\n                buttonModel: { content: documentLocale.getConstant('Ok'), cssClass: 'e-flat e-table-cell-okay', isPrimary: true }\n            },\n            {\n                click: this.closeCellMarginsDialog,\n                buttonModel: { content: documentLocale.getConstant('Cancel'), cssClass: 'e-flat e-table-cell-cancel' }\n            }];\n        this.owner.dialog.dataBind();\n        this.owner.dialog.show();\n    };\n    /**\n     * @private\n     */\n    TableOptionsDialog.prototype.destroy = function () {\n        if (!isNullOrUndefined(this.target)) {\n            if (this.target.parentElement) {\n                this.target.parentElement.removeChild(this.target);\n            }\n            for (var p = 0; p < this.target.childNodes.length; p++) {\n                this.target.removeChild(this.target.childNodes[p]);\n                p--;\n            }\n            this.target = undefined;\n        }\n        this.dialog = undefined;\n        this.target = undefined;\n        this.owner = undefined;\n        this.cellspacingTextBox = undefined;\n        this.allowSpaceCheckBox = undefined;\n    };\n    return TableOptionsDialog;\n}());\nexport { TableOptionsDialog };\n","import { CheckBox } from '@syncfusion/ej2-buttons';\nimport { NumericTextBox } from '@syncfusion/ej2-inputs';\nimport { WCellFormat } from '../index';\nimport { isNullOrUndefined, L10n, createElement, setCulture } from '@syncfusion/ej2-base';\n/**\n * The Cell options dialog is used to modify margins of selected cells.\n */\nvar CellOptionsDialog = /** @class */ (function () {\n    /**\n     * @private\n     */\n    function CellOptionsDialog(viewer) {\n        var _this = this;\n        /**\n         * @private\n         */\n        this.removeEvents = function () {\n            _this.owner.dialog2.element.style.pointerEvents = '';\n            _this.owner.updateFocus();\n        };\n        /**\n         * @private\n         */\n        this.changeSameAsTable = function () {\n            if (_this.sameAsTableCheckBox.checked) {\n                _this.leftMarginBox.enabled = false;\n                _this.rightMarginBox.enabled = false;\n                _this.bottomMarginBox.enabled = false;\n                _this.topMarginBox.enabled = false;\n            }\n            else {\n                _this.leftMarginBox.enabled = true;\n                _this.rightMarginBox.enabled = true;\n                _this.bottomMarginBox.enabled = true;\n                _this.topMarginBox.enabled = true;\n            }\n        };\n        /**\n         * @private\n         */\n        this.applyTableCellProperties = function () {\n            var cellFormat = _this.owner.selection.cellFormat;\n            if (!isNullOrUndefined(_this.bottomMarginBox.value || _this.leftMarginBox.value\n                || _this.rightMarginBox.value || _this.topMarginBox.value) &&\n                (cellFormat.bottomMargin !== _this.bottomMarginBox.value || cellFormat.leftMargin !== _this.leftMarginBox.value\n                    || cellFormat.rightMargin !== _this.rightMarginBox.value || cellFormat.topMargin !== _this.topMarginBox.value)) {\n                _this.owner.owner.tablePropertiesDialogModule.isCellOptionsUpdated = true;\n                _this.applyTableOptions(_this.cellFormat);\n                _this.owner.owner.tablePropertiesDialogModule.applyTableSubProperties();\n            }\n            _this.closeCellMarginsDialog();\n        };\n        /**\n         * @private\n         */\n        this.closeCellMarginsDialog = function () {\n            _this.owner.dialog.hide();\n            _this.owner.dialog.element.style.pointerEvents = '';\n        };\n        this.owner = viewer;\n    }\n    Object.defineProperty(CellOptionsDialog.prototype, \"cellFormat\", {\n        /**\n         * @private\n         */\n        get: function () {\n            if (isNullOrUndefined(this.cellFormatIn)) {\n                return this.cellFormatIn = new WCellFormat();\n            }\n            return this.cellFormatIn;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    /**\n     * @private\n     */\n    CellOptionsDialog.prototype.getModuleName = function () {\n        return 'CellOptionsDialog';\n    };\n    /**\n     * @private\n     */\n    CellOptionsDialog.prototype.initCellMarginsDialog = function (localValue) {\n        var instance = this.owner;\n        this.target = createElement('div', {\n            id: this.owner.owner.containerId + '_tableCellMarginsDialog', className: 'e-de-table-cell-margin-dlg'\n        });\n        this.owner.owner.element.appendChild(this.target);\n        var innerDiv = createElement('div', { styles: 'width: 475px;position: relative;height: 165px;' });\n        var innerDivLabel = createElement('Label', {\n            className: 'e-de-cell-dia-options-label', id: this.target.id + '_innerDivLabel'\n        });\n        innerDivLabel.innerHTML = localValue.getConstant('Cell margins');\n        innerDiv.appendChild(innerDivLabel);\n        var table = createElement('TABLE', {\n            styles: 'height: 40px;padding-bottom: 0px;', className: 'e-de-cell-margin-top'\n        });\n        var tr = createElement('tr');\n        var td = createElement('td', { className: 'e-de-tbl-btn-seperator' });\n        var sameAsTableCheckBox = createElement('input', {\n            attrs: { 'type': 'checkbox' }, id: this.target.id + '_sameAsCheckBox'\n        });\n        td.appendChild(sameAsTableCheckBox);\n        tr.appendChild(td);\n        table.appendChild(tr);\n        innerDiv.appendChild(table);\n        CellOptionsDialog.getCellMarginDialogElements(this, innerDiv, localValue);\n        var divBtn = document.createElement('div');\n        this.target.appendChild(divBtn);\n        this.sameAsTableCheckBox = new CheckBox({\n            label: localValue.getConstant('Same as the whole table'),\n            change: this.changeSameAsTable\n        });\n        this.sameAsTableCheckBox.appendTo(sameAsTableCheckBox);\n        this.sameAsTableCheckBox.addEventListener('change', this.changeSameAsTable);\n    };\n    /**\n     * @private\n     */\n    CellOptionsDialog.prototype.show = function () {\n        var localizeValue = new L10n('documenteditor', this.owner.owner.defaultLocale);\n        localizeValue.setLocale(this.owner.owner.locale);\n        setCulture(this.owner.owner.locale);\n        if (!this.target) {\n            this.initCellMarginsDialog(localizeValue);\n        }\n        this.loadCellMarginsDialog();\n        this.owner.dialog.header = localizeValue.getConstant('Cell Options');\n        this.owner.dialog.position = { X: 'center', Y: 'top' };\n        this.owner.dialog.height = 'auto';\n        this.owner.dialog.width = 'auto';\n        this.owner.dialog.content = this.target;\n        this.owner.dialog.beforeOpen = undefined;\n        this.owner.dialog.open = undefined;\n        this.owner.dialog.close = this.removeEvents;\n        this.owner.dialog.buttons = [{\n                click: this.applyTableCellProperties,\n                buttonModel: { content: localizeValue.getConstant('Ok'), cssClass: 'e-flat e-table-cell-margin-okay', isPrimary: true }\n            },\n            {\n                click: this.closeCellMarginsDialog,\n                buttonModel: { content: localizeValue.getConstant('Cancel'), cssClass: 'e-flat e-table-cell-margin-cancel' }\n            }];\n        this.owner.dialog.show();\n    };\n    /**\n     * @private\n     */\n    CellOptionsDialog.prototype.loadCellMarginsDialog = function () {\n        var cellFormat = this.owner.selection.cellFormat;\n        this.sameAsTable = isNullOrUndefined(cellFormat.leftMargin || cellFormat.topMargin\n            || cellFormat.rightMargin || cellFormat.bottomMargin);\n        if (this.sameAsTable) {\n            var tableFormat = this.owner.selection.tableFormat;\n            this.loadCellProperties(tableFormat, false, true);\n        }\n        else {\n            this.loadCellProperties(cellFormat, true, false);\n        }\n    };\n    CellOptionsDialog.prototype.loadCellProperties = function (format, enableTextBox, enableCheckBox) {\n        this.leftMarginBox.value = format.leftMargin;\n        this.rightMarginBox.value = format.rightMargin;\n        this.topMarginBox.value = format.topMargin;\n        this.bottomMarginBox.value = format.bottomMargin;\n        this.leftMarginBox.enabled = enableTextBox;\n        this.rightMarginBox.enabled = enableTextBox;\n        this.topMarginBox.enabled = enableTextBox;\n        this.bottomMarginBox.enabled = enableTextBox;\n        this.sameAsTableCheckBox.checked = enableCheckBox;\n    };\n    /**\n     * @private\n     */\n    CellOptionsDialog.prototype.applySubCellOptions = function (cellFormat) {\n        this.owner.owner.editorHistory.initComplexHistory(this.owner.selection, 'CellMarginsSelection');\n        this.owner.owner.editorModule.initHistory('CellOptions');\n        /* tslint:disable:max-line-length */\n        var startTable = this.owner.selection.start.paragraph.associatedCell.ownerTable;\n        startTable = startTable.combineWidget(this.owner);\n        this.applyCellmarginsValue(this.owner.selection.start.paragraph.associatedCell.ownerRow.combineWidget(this.owner), this.owner.selection.start, this.owner.selection.end, cellFormat);\n        this.owner.owner.editorModule.reLayout(this.owner.selection, false);\n        if (!isNullOrUndefined(this.owner.owner.editorHistory.currentHistoryInfo)) {\n            this.owner.owner.editorHistory.updateComplexHistory();\n        }\n    };\n    /**\n     * @private\n     */\n    CellOptionsDialog.prototype.applyCellmarginsValue = function (row, start, end, cellFormat) {\n        this.applyCellMarginsInternal(row, cellFormat);\n        if (end.paragraph.associatedCell.ownerRow === row) {\n            return;\n        }\n        var newRow = row.nextWidget;\n        if (!isNullOrUndefined(newRow)) {\n            this.applyCellmarginsValue(newRow, start, end, cellFormat);\n        }\n    };\n    CellOptionsDialog.prototype.applyCellMarginsInternal = function (row, cellFormat) {\n        if (!isNullOrUndefined(this.owner.owner.editorHistory.currentBaseHistoryInfo)) {\n            var currentFormat = row.childWidgets[0].cellFormat;\n            /* tslint:disable:max-line-length */\n            cellFormat = this.owner.owner.editorHistory.currentBaseHistoryInfo.addModifiedCellOptions(currentFormat, cellFormat, row.ownerTable);\n        }\n        if (!isNullOrUndefined(cellFormat)) {\n            this.applyCellMarginsForCells(row, cellFormat);\n        }\n    };\n    /**\n     * @private\n     */\n    CellOptionsDialog.prototype.applyCellMarginsForCells = function (row, cellFormat) {\n        var rowCells = row.childWidgets;\n        this.iterateCells(rowCells, cellFormat);\n    };\n    /**\n     * @private\n     */\n    CellOptionsDialog.prototype.iterateCells = function (cells, cellFormat) {\n        for (var i = 0; i < cells.length; i++) {\n            this.applySubCellMargins(cells[i].cellFormat, cellFormat);\n        }\n        this.owner.owner.tablePropertiesDialogModule.calculateGridValue(cells[0].ownerTable);\n    };\n    /**\n     * @private\n     */\n    CellOptionsDialog.prototype.applySubCellMargins = function (sourceFormat, cellFormat) {\n        sourceFormat.leftMargin = cellFormat.leftMargin;\n        sourceFormat.topMargin = cellFormat.topMargin;\n        sourceFormat.rightMargin = cellFormat.rightMargin;\n        sourceFormat.bottomMargin = cellFormat.bottomMargin;\n    };\n    /**\n     * @private\n     */\n    CellOptionsDialog.prototype.applyTableOptions = function (cellFormat) {\n        if (!this.sameAsTableCheckBox.checked) {\n            cellFormat.leftMargin = this.leftMarginBox.value;\n            cellFormat.topMargin = this.topMarginBox.value;\n            cellFormat.bottomMargin = this.bottomMarginBox.value;\n            cellFormat.rightMargin = this.rightMarginBox.value;\n        }\n    };\n    /**\n     * @private\n     */\n    CellOptionsDialog.prototype.destroy = function () {\n        if (!isNullOrUndefined(this.target)) {\n            if (this.target.parentElement) {\n                this.target.parentElement.removeChild(this.target);\n            }\n            for (var y = 0; y < this.target.childNodes.length; y++) {\n                this.target.removeChild(this.target.childNodes[y]);\n                y--;\n            }\n            this.target = undefined;\n        }\n        this.dialog = undefined;\n        this.target = undefined;\n        this.owner = undefined;\n        this.sameAsTableCheckBox = undefined;\n    };\n    /**\n     * @private\n     */\n    CellOptionsDialog.getCellMarginDialogElements = function (dialog, div, locale) {\n        if (!isNullOrUndefined(dialog)) {\n            var table = createElement('TABLE', { className: 'e-de-cell-margin-top' });\n            var tr1 = createElement('tr', { styles: 'height: 50px;color:black;' });\n            var td1 = createElement('td');\n            var topLabel = createElement('label', {\n                innerHTML: locale.getConstant('Top'), className: 'e-de-cell-dia-label-common',\n                id: dialog.target.id + '_TopLabel'\n            });\n            var topTextBox = createElement('input', {\n                attrs: { 'type': 'text' }, styles: 'width:100%', id: dialog.target.id + '_Top'\n            });\n            td1.appendChild(topLabel);\n            td1.appendChild(topTextBox);\n            var td2 = createElement('td', { className: 'e-de-tbl-btn-seperator' });\n            var leftLabel = createElement('label', {\n                innerHTML: locale.getConstant('Left'), className: 'e-de-cell-dia-label-common',\n                id: dialog.target.id + '_leftLabel'\n            });\n            var leftTextBox = createElement('input', {\n                attrs: { 'type': 'text' },\n                styles: 'width:100%', id: dialog.target.id + '_left'\n            });\n            td2.appendChild(leftLabel);\n            td2.appendChild(leftTextBox);\n            tr1.appendChild(td1);\n            tr1.appendChild(td2);\n            var tr2 = createElement('tr', { styles: 'height: 50px;color:black;' });\n            var td3 = createElement('td', { styles: 'width:40%;' });\n            var bottomLabel = createElement('label', {\n                innerHTML: locale.getConstant('Bottom'),\n                className: 'e-de-cell-dia-label-common', id: dialog.target.id + '_bottomLabel'\n            });\n            var bottomTextBox = createElement('input', {\n                attrs: { 'type': 'text' },\n                styles: 'width:100%', id: dialog.target.id + '_bottom'\n            });\n            td3.appendChild(bottomLabel);\n            td3.appendChild(bottomTextBox);\n            var td4 = createElement('td', { styles: 'width:40%;' });\n            var rightLabel = createElement('label', {\n                innerHTML: locale.getConstant('Right'), id: dialog.target.id + '_rightLabel',\n                className: 'e-de-cell-dia-label-common'\n            });\n            var rightTextBox = createElement('input', {\n                attrs: { 'type': 'text' },\n                styles: 'width:100%', id: dialog.target.id + '_right'\n            });\n            td4.appendChild(rightLabel);\n            td4.appendChild(rightTextBox);\n            tr2.appendChild(td3);\n            tr2.appendChild(td4);\n            table.appendChild(tr1);\n            table.appendChild(tr2);\n            div.appendChild(table);\n            dialog.target.appendChild(div);\n            dialog.topMarginBox = new NumericTextBox({\n                value: 0, min: 0, max: 1584, width: 150, decimals: 2,\n                enablePersistence: false\n            });\n            dialog.topMarginBox.appendTo(topTextBox);\n            dialog.leftMarginBox = new NumericTextBox({\n                value: 0, min: 0, max: 1584, width: 150,\n                decimals: 2, enablePersistence: false\n            });\n            dialog.leftMarginBox.appendTo(leftTextBox);\n            dialog.bottomMarginBox = new NumericTextBox({\n                value: 0, min: 0, max: 1584, width: 150, decimals: 2,\n                enablePersistence: false\n            });\n            dialog.bottomMarginBox.appendTo(bottomTextBox);\n            dialog.rightMarginBox = new NumericTextBox({\n                value: 0, min: 0, max: 1584, width: 150,\n                decimals: 2, enablePersistence: false\n            });\n            dialog.rightMarginBox.appendTo(rightTextBox);\n        }\n    };\n    return CellOptionsDialog;\n}());\nexport { CellOptionsDialog };\n","import { ListView } from '@syncfusion/ej2-lists';\nimport { Button } from '@syncfusion/ej2-buttons';\nimport { createElement, L10n, setCulture } from '@syncfusion/ej2-base';\n/**\n * The Styles dialog is used to create or modify styles.\n */\nvar StylesDialog = /** @class */ (function () {\n    /**\n     * @private\n     */\n    function StylesDialog(viewer) {\n        var _this = this;\n        this.updateStyleNames = function () {\n            var collection = _this.owner.owner.viewer.styles.getStyleNames('Paragraph');\n            var defaultStyleNames = ['Normal', 'Heading 1', 'Heading 2', 'Heading 3', 'Heading 4', 'Heading 5', 'Heading 6'];\n            var finalList = collection.concat(defaultStyleNames).filter(function (v, i, a) { return a.indexOf(v) === i; });\n            return finalList;\n        };\n        this.modifyStyles = function () {\n            _this.owner.dialog.hide();\n            _this.owner.owner.styleDialogModule.show(_this.styleName, _this.localValue.getConstant('Modify Style'));\n        };\n        /* tslint:disable:no-any */\n        this.selectHandler = function (args) {\n            _this.styleName = args.text;\n        };\n        this.addNewStyles = function () {\n            _this.owner.dialog.hide();\n            _this.owner.owner.styleDialogModule.show();\n        };\n        this.owner = viewer;\n    }\n    /**\n     * @private\n     */\n    StylesDialog.prototype.getModuleName = function () {\n        return 'StylesDialog';\n    };\n    /**\n     * @private\n     */\n    StylesDialog.prototype.initStylesDialog = function (localValue, styles) {\n        var instance = this;\n        var id = this.owner.owner.containerId + '_insert_styles';\n        this.target = createElement('div', { id: id, className: 'e-de-styles' });\n        var headerValue = localValue.getConstant('Styles');\n        var dlgFields = createElement('div', { innerHTML: headerValue, className: 'e-styles-dlgfields' });\n        this.target.appendChild(dlgFields);\n        var commonDiv = createElement('div', { className: 'e-styles-common' });\n        this.target.appendChild(commonDiv);\n        var searchDiv = createElement('div', { className: 'e-styles-list' });\n        commonDiv.appendChild(searchDiv);\n        var listviewDiv = createElement('div', { className: 'e-styles-listViewDiv', id: 'styles_listview' });\n        searchDiv.appendChild(listviewDiv);\n        this.listviewInstance = new ListView({\n            dataSource: styles,\n            cssClass: 'e-styles-listview',\n        });\n        this.listviewInstance.appendTo(listviewDiv);\n        this.listviewInstance.addEventListener('select', this.selectHandler);\n        var buttonDiv = createElement('div', { className: 'e-styles-button' });\n        commonDiv.appendChild(buttonDiv);\n        var newButtonDiv = createElement('div', { className: 'e-styles-addbutton' });\n        buttonDiv.appendChild(newButtonDiv);\n        var newButtonElement = createElement('button', { innerHTML: localValue.getConstant('New'), id: 'new' });\n        newButtonDiv.appendChild(newButtonElement);\n        var newbutton = new Button({ cssClass: 'e-button-custom' });\n        newbutton.appendTo(newButtonElement);\n        newButtonElement.addEventListener('click', this.addNewStyles);\n        var modifybuttonDiv = createElement('div', { className: 'e-styles-addbutton' });\n        buttonDiv.appendChild(modifybuttonDiv);\n        var modifyButtonElement = createElement('button', { innerHTML: localValue.getConstant('Modify'), id: 'modify' });\n        modifybuttonDiv.appendChild(modifyButtonElement);\n        var addbutton = new Button({ cssClass: 'e-button-custom' });\n        addbutton.appendTo(modifyButtonElement);\n        modifyButtonElement.addEventListener('click', this.modifyStyles);\n    };\n    /**\n     * @private\n     */\n    StylesDialog.prototype.show = function () {\n        var styles = this.updateStyleNames();\n        var localValue = new L10n('documenteditor', this.owner.owner.defaultLocale);\n        localValue.setLocale(this.owner.owner.locale);\n        setCulture(this.owner.owner.locale);\n        this.localValue = localValue;\n        this.initStylesDialog(localValue, styles);\n        this.owner.dialog.content = this.target;\n        this.owner.dialog.beforeOpen = this.owner.updateFocus;\n        this.owner.dialog.close = this.owner.updateFocus;\n        this.owner.dialog.header = 'Styles';\n        this.owner.dialog.height = 'auto';\n        this.owner.dialog.width = 'auto';\n        this.owner.dialog.buttons = [{\n                click: this.hideObjects.bind(this),\n                buttonModel: { content: localValue.getConstant('Cancel'), cssClass: 'e-flat e-hyper-insert', isPrimary: true }\n            }];\n        this.owner.dialog.dataBind();\n        this.owner.dialog.show();\n    };\n    StylesDialog.prototype.hideObjects = function () {\n        this.owner.dialog.hide();\n    };\n    /**\n     * @private\n     */\n    StylesDialog.prototype.destroy = function () {\n        if (this.listviewInstance) {\n            this.listviewInstance.destroy();\n            this.listviewInstance = undefined;\n        }\n    };\n    return StylesDialog;\n}());\nexport { StylesDialog };\n"],"names":["Dictionary","this","keysInternal","valuesInternal","item","Object","defineProperty","prototype","get","length","enumerable","configurable","getItem","i","push","add","key","value","isNullOrUndefined","ReferenceError","indexOf","index","RangeError","set","remove","splice","containsKey","clear","destroy","undefined","WUniqueFormat","type","referenceCount","uniqueFormatType","propertiesHash","isEqual","source","property","modifiedValue","isBorderEqual","isCharacterFormatEqual","isParagraphFormatEqual","isCellFormatEqual","isShadingEqual","isRowFormatEqual","isListFormatEqual","isTableFormatEqual","isListLevelEqual","isSectionFormatEqual","isNotEqual","modifiedProperty","targetValue","propertyType","getPropertyType","sourceValue","getBorderPropertyType","getCharacterFormatPropertyType","getParaFormatPropertyType","getCellFormatPropertyType","getShadingPropertyType","getRowFormatType","getListFormatType","getTableFormatType","getListLevelType","getSectionFormatType","cloneItems","format","keys","mergeProperties","hash","cloneProperties","WUniqueFormats","items","addUniqueFormat","matchedFormat","updateUniqueFormat","uniqueFormat","__extends","extendStatics","setPrototypeOf","__proto__","Array","d","b","p","hasOwnProperty","__","constructor","create","__decorate","decorators","target","desc","c","arguments","r","getOwnPropertyDescriptor","Reflect","decorate","DocumentEditor","_super","options","element","_this","call","enableHeaderFooterIn","isShiftingEnabled","isLayoutEnabled","isPastingContent","parser","disableHistoryIn","findResultsList","documentName","tablePropertiesDialogModule","bordersAndShadingDialogModule","cellOptionsDialogModule","tableOptionsDialogModule","paragraphDialogModule","imageResizerModule","useCtrlClickToFollowHyperlink","pageOutline","enableCursorOnReadOnly","enableLocalPaste","defaultLocale","Table","Row","Cell","Ok","Cancel","Size","Preferred Width","Points","Percent","Measure in","Alignment","Left","Center","Right","Justify","Indent from left","Borders and Shading","Options","Specify height","At least","Exactly","Row height is","Allow row to break across pages","Repeat as header row at the top of each page","Vertical alignment","Top","Bottom","Default cell margins","Default cell spacing","Allow spacing between cells","Cell margins","Same as the whole table","Borders","None","Single","Dot","DashSmallGap","DashLargeGap","DashDot","DashDotDot","Double","Triple","ThinThickSmallGap","ThickThinSmallGap","ThinThickThinSmallGap","ThinThickMediumGap","ThickThinMediumGap","ThinThickThinMediumGap","ThinThickLargeGap","ThickThinLargeGap","ThinThickThinLargeGap","SingleWavy","DoubleWavy","DashDotStroked","Emboss3D","Engrave3D","Outset","Inset","Thick","Style","Width","Height","Letter","Tabloid","Legal","Statement","Executive","A3","A4","A5","B4","B5","Custom Size","Different odd and even","Different first page","From edge","Header","Footer","Margin","Paper","Layout","Orientation","Landscape","Portrait","Table Of Contents","Show page numbers","Right align page numbers","Nothing","Tab leader","Show levels","Use hyperlinks instead of page numbers","Build table of contents from","Styles","Available styles","TOC level","Heading","List Paragraph","Normal","Outline levels","Table entry fields","Modify","Color","Setting","Box","All","Custom","Preview","Shading","Fill","Apply To","Table Properties","Cell Options","Table Options","Insert Table","Number of columns","Number of rows","Text to display","Address","Insert Hyperlink","Edit Hyperlink","Insert","General","Indentation","Before text","Special","First line","Hanging","After text","By","Before","Line Spacing","After","At","Multiple","Spacing","Define new Multilevel list","List level","Choose level to modify","Level","Number format","Number style for this level","Enter formatting for number","Start at","Restart list after","Position","Text indent at","Aligned at","Follow number with","Tab character","Space","Arabic","UpRoman","LowRoman","UpLetter","LowLetter","Number","Leading zero","Bullet","Ordinal","Ordinal Text","For East","No Restart","Font","Font style","Underline style","Font color","Effects","Strikethrough","Superscript","Subscript","Double strikethrough","Regular","Bold","Italic","Cut","Copy","Paste","Hyperlink","Open Hyperlink","Copy Hyperlink","Remove Hyperlink","Paragraph","Merge Cells","Insert Above","Insert Below","Insert Left","Insert Right","Delete","Delete Table","Delete Row","Delete Column","File Name","Format Type","Save","Navigation","Results","Replace","Replace All","We replaced all","Find","No matches","All Done","Result","of","instances","with","Click to follow link","Continue Numbering","Bookmark name","Close","Restart At","Properties","Name","Style type","Style based on","Style for following paragraph","Formatting","Numbering and Bullets","Numbering","Update Field","Edit Field","Bookmark","Page Setup","No bookmarks found","Number format tooltip information","Format","Create New Style","Modify Style","New","Bullets","Use bookmarks","Table of Contents","viewer","PageLayoutViewer","SfdtReader","DocumentEditor_1","updateScrollBars","isDocumentLoaded","pages","selectionModule","editorModule","editorHistoryModule","searchModule","contextMenuModule","id","isDocumentLoadedIn","enableEditorHistory","selection","getDocumentStart","getDocumentEnd","isReadOnly","enableImageResizer","preRender","render","initializeComponents","openBlank","container","style","minHeight","minWidth","getModuleName","onPropertyChanged","model","oldProp","_i","_a","zoomFactor","localizeDialogs","optionsPaneModule","isOptionsPaneShow","showHideOptionsPane","locale","l10n","L10n","setLocale","setCulture","initOptionsPane","initParagraphDialog","pageSetupDialogModule","initPageSetupDialog","fontDialogModule","initFontDialog","hyperlinkDialogModule","initHyperlinkDialog","initContextMenu","listDialogModule","initListDialog","initTablePropertyDialog","initBordersAndShadingsDialog","initCellMarginsDialog","initTableOptionsDialog","tableDialogModule","initTableDialog","styleDialogModule","initStyleDialog","tableOfContentsDialogModule","initTableOfContentDialog","getPersistData","clearPreservedCollectionsInViewer","LayoutViewer","clearDocumentItems","getDocumentEditorElement","fireContentChange","eventArgs","trigger","fireDocumentChange","fireSelectionChange","isCompositionStart","Browser","isDevice","predictText","fireZoomFactorChange","fireViewChange","visiblePages","startPage","endPage","showParagraphDialog","paragraphFormat","isReadOnlyMode","show","showPageSetupDialog","showFontDialog","characterFormat","showCellOptionsDialog","showTableOptionsDialog","showTableDialog","showTableOfContentsDialog","showStyleDialog","showHyperlinkDialog","showBookmarkDialog","bookmarkDialogModule","showStylesDialog","stylesDialogModule","showListDialog","showTablePropertiesDialog","showBordersAndShadingDialog","requiredModules","modules","enablePrint","member","args","enableSfdtExport","enableWordExport","enableTextExport","enableSelection","enableEditor","enableSearch","enableContextMenu","enableOptionsPane","enableHyperlinkDialog","enableTableDialog","enableBookmarkDialog","enableTableOfContentsDialog","enablePageSetupDialog","enableStyleDialog","enableListDialog","enableParagraphDialog","enableFontDialog","enableTablePropertiesDialog","enableBordersAndShadingDialog","enableTableOptionsDialog","open","sfdtText","lists","abstractLists","styles","WStyles","onDocumentChanged","convertJsonToDocument","intializeDefaultStyles","scrollToPage","pageNumber","enableAllModules","Inject","Print","SfdtExport","WordExport","TextExport","Selection","Search","Editor","ImageResizer","EditorHistory","ContextMenu","OptionsPane","HyperlinkDialog","TableDialog","BookmarkDialog","TableOfContentsDialog","PageSetupDialog","StyleDialog","ListDialog","ParagraphDialog","BulletsAndNumberingDialog","FontDialog","TablePropertiesDialog","BordersAndShadingDialog","TableOptionsDialog","CellOptionsDialog","StylesDialog","resize","width","height","updateViewerSize","focusIn","updateFocus","fitPage","pageFitType","print","printWindow","Error","printModule","serialize","sfdtExportModule","save","fileName","formatType","wordExportModule","textExportModule","jsonString","blob","Blob","saveAsBlob","Promise","resolve","reject","section","BodyWidget","sectionFormat","WSectionFormat","paragraph","ParagraphWidget","WParagraphFormat","WCharacterFormat","childWidgets","containerWidget","sections","hfs","parseHeaderFooter","header","footer","evenHeader","evenFooter","firstPageHeader","firstPageFooter","headersFooters","findByName","baseStyle","listFormat","getStyleNames","styleType","getStyles","showDialog","dialogType","showOptionsPane","destroyDependentModules","classList","innerHTML","Property","Event","NotifyPropertyChanges","Component","navigator","userAgent","browserUserAgent","getPageHeight","getPageWidth","printElement","document","createElement","overflow","generatePrintContent","window","write","toString","close","focus","interval","setInterval","ready","clearInterval","htmlString","page","pageHeight","boundingRectangle","pageWidth","isPrinting","renderWidgets","canvasURL","pageCanvas","toDataURL","node","uniqueSectionFormat","ownerBase","getPropertyValue","setPropertyValue","uniqueSectionFormats","hasValue","getPropertyDefaultValue","initializeUniqueSectionFormat","propValue","uniqueSectionFormatTemp","addUniqueSectionFormat","copyFormat","history","isUndoing","isRedoing","updateUniqueSectionFormat","cloneFormat","WLevelOverride","overrideListLevel","levelNumber","startAt","WList","listId","sourceListId","abstractListId","abstractList","levelOverrides","getListLevel","levelOverride","getLevelOverride","levels","mergeList","list","WListFormat","uniqueListFormat","baseListStyle","basedOn","listLevelNumber","WParagraphStyle","initializeUniqueListFormat","uniqueListFormats","uniqueListFormatTemp","addUniqueListFormat","clearFormat","ApplyStyle","getValue","mergeFormat","WTabStop","positionIn","deletePositionIn","justification","leader","position","deletePosition","tabJustification","uniqueParagraphFormat","tabs","getUpdatedTabs","inTabs","tabStops","tab","_b","_c","hasTabStop","concat","filter","a","sort","getListFormatParagraphFormat","level","listLevel","ifListFormat","getDefaultValue","docParagraphFormat","documentParagraphFormat","bodyWidget","initializeUniqueParagraphFormat","uniqueParagraphFormats","uniqueParaFormatTemp","addUniqueParaFormat","updateUniqueParagraphFormat","leftIndent","rightIndent","firstLineIndent","beforeSpacing","afterSpacing","lineSpacing","lineSpacingType","textAlignment","outlineLevel","uniqueCharacterFormat","baseCharStyle","charStyleValue","checkCharacterStyle","baseStyleValue","checkBaseStyle","docCharacterFormat","documentCharacterFormat","name","returnPropertyType","initializeUniqueCharacterFormat","uniqueCharacterFormats","uniqueCharFormatTemp","addUniqueCharacterFormat","isEqualFormat","fontSize","fontFamily","bold","italic","baselineAlignment","underline","fontColor","strikethrough","highlightColor","isSameFormat","updateUniqueCharacterFormat","HelperMethods","insert","spanText","text","slice","join","substring","indexOfAny","wordSplitCharacter","j","temp","lastIndexOfAny","addCssStyle","css","cssText","appendChild","createTextNode","getElementsByTagName","getHighlightColorCode","color","convertPointToPixel","point","round","convertPixelToPoint","pixel","isLinkedFieldCharacter","inline","FieldElementBox","fieldType","fieldEnd","fieldBegin","removeSpace","charAt","replace","trimStart","trimEnd","endsWith","writeCharacterFormat","isInline","styleName","decimalDigits","Math","wordBefore","wordAfter","wordSplitCharacters","Point","xPosition","yPosition","xIn","yIn","copy","WStyle","copyStyle","paraStyle","next","link","WCharacterStyle","charStyle","collection","contains","pop","returnStyle","map","styleObjects","styles_1","returnStyleObject","JSON","stringify","WBorder","uniqueBorderFormat","initializeUniqueBorder","uniqueBorderFormats","uniqueBorderFormatTemp","addUniqueBorderFormat","getLineWidth","lineStyle","lineArray","getBorderLineWidthArray","lineWidth","borderLineArray","abs","getBorderWeight","weight","numberOfLines","getNumberOfLines","borderNumber","getBorderNumber","getPrecedence","border","shadow","space","WBorders","leftIn","rightIn","topIn","bottomIn","horizontalIn","verticalIn","diagonalUpIn","diagonalDownIn","lineWidthIn","left","top","bottom","right","horizontal","vertical","diagonalDown","diagonalUp","valueIn","borders","WShading","uniqueShadingFormat","initializeUniqueShading","uniqueShadingFormats","uniqueShadingTemp","addUniqueShading","shading","backgroundColor","foregroundColor","textureStyle","WTableFormat","owner","uniqueTableFormat","assignTableMarginValue","initializeUniqueTableFormat","uniqueTableFormats","uniqueTableFormatTemp","addUniqueTableFormat","leftMargin","topMargin","rightMargin","bottomMargin","initializeTableBorders","tableFormat","tableAlignment","cellSpacing","preferredWidth","preferredWidthType","WRowFormat","uniqueRowFormat","beforeWidth","afterWidth","heightType","initializeUniqueRowFormat","uniqueRowFormats","uniqueRowFormatTemp","addUniqueRowFormat","allowBreakAcrossPages","isHeader","gridBefore","gridBeforeWidth","gridBeforeWidthType","gridAfter","gridAfterWidth","gridAfterWidthType","WCellFormat","uniqueCellFormat","initializeUniqueCellFormat","uniqueCellFormats","uniqueCellFormatTemp","addUniqueCellFormat","containsMargins","verticalAlignment","cellWidth","columnSpan","rowSpan","Rect","x","y","clone","Widget","bodyWidgets","widget","indexInOwner","previousPage","previousContainer","TableCellWidget","getPreviousSplitWidget","TableRowWidget","HeaderFooterWidget","previousRenderedWidget","lastChild","nextPage","nextContainer","getNextSplitWidget","nextRenderedWidget","firstChild","previous","equals","BlockWidget","getPreviousSplitWidgets","widgets","previousSplitWidget","unshift","getSplitWidgets","nextSplitWidget","combineWidget","root","shift","splitWidget","combine","TableWidget","combineRows","addWidgets","destroyInternal","LineWidget","removeChild","child","margin","BlockContainer","apply","sectionFormatIn","getHierarchicalIndex","hierarchicalIndex","headerFooterType","getTableCellWidget","touchPoint","tableCellWidget","n","chilgWidget","headerWidget","footerWidget","headerFooter","block","isPageBreak","children","getIndex","ownerTable","ownerRow","getContainerWidth","isInsideTable","associatedCell","cellFormat","isEndsWithPageBreak","isEmpty","inlineElement","TextElementBox","ImageElementBox","BookmarkElementBox","getInline","offset","indexInInline","count","isStarted","splittedWidget","k","line","ListTextElementBox","getLength","cloneLine","flags","leftBorderWidth","rightBorderWidth","topBorderWidth","bottomBorderWidth","tableHolder","WTableHolder","spannedRowCollection","row","combineCells","tableCell","getOwnerWidth","isBasedOnViewer","getTableWidth","rowWidth","getTableClientWidth","clientWidth","tableWidth","getCellWidth","containerWidth","cell","getMinimumPreferredWidth","fitCellsToClientArea","factor","rowFormat","calculateGrid","tempGrid","spannedCells","tableCellInfo","rowCellInfo","currOffset","startOffset","columnIndex","removeSpannedCell","rowIndex","m","cellIndex","columns","updateColumnSpans","getGridCount","buildTableColumns","isGridUpdated","resetColumns","rowSpannedCells","isAutoWidth","addColumns","rowSpannedCell","minWidth_1","ownerColumn","validateColumnWidths","fitColumns","setWidthToCells","rw","getMaxRowWidth","updateWidth","dragValue","totalPreferredWidth","getTotalWidth","convertPointToPercent","tablePreferredWidth","ownerWidth","table","getTableOf","getRowOf","fitChildToClientArea","getColumnCellsForSelection","startCell","endCell","cells","start","end","splitWidthToTableCells","tableClientWidth","splitWidthToRowCells","insertTableRowsInternal","tableRows","startIndex","updateRowIndex","getCellStartOffset","tableGrids","headerHeight","description","title","getCellOf","getCell","tableGrid","prevOffset","gridStartIndex","getOffsetIndex","getCellOffset","updateRowBySpannedCells","getPreviousRowSpannedCells","currentRowIndex","spannedCell","include","previousWidget","cellWidget","getContainerTable","previousCell","nextCell","cellPreferredWidth","getCellLeftBorder","leftBorder","cellBorder","rowBorders","tableBorders","getLeftBorderToRenderByHierarchy","prevCell","previousRow","prevRowCell","getPreviousCellLeftBorder","getLeftBorderWidth","getRightBorderWidth","getCellSpacing","actualCellSpacing","hasNoneStyle","prevCellRightBorder","getBorderBasedOnPriority","adjacentBorder","borderWeight","adjacentBorderWeight","borderPriority","adjacentBorderPriority","borderColInRGB","convertHexToRGB","R1","G1","g","B1","adjacentBorderColInRGB","R2","G2","B2","borderBrightness","adjacentBorderBrightness","getCellRightBorder","rightBorder","getRightBorderToRenderByHierarchy","nextWidget","getAdjacentCellRightBorder","nextCellLeftBorder","getCellTopBorder","topBorder","getTopBorderToRenderByHierarchy","prevTopCell","prevRow","getPreviousCellTopBorder","previousTopCell","prevTopCellBottomBorder","getCellBottomBorder","bottomBorder","getBottomBorderToRenderByHierarchy","nextBottomCell","nextRow","getAdjacentCellBottomBorder","prevBottomCellTopBorder","colorCode","colCodeNo","parseInt","paragraphWidget","lineIndex","splitParagraph","lastElement","isFirstLine","isLastLine","getOffset","textIndex","getEndOffset","previousLine","elementBox","ElementBox","linkFieldCharacter","linkFieldTraversingForward","fields","linkFieldTraversingBackwardSeparator","fieldSeparator","isFieldEnd","linkFieldTraversingBackward","previousNode","childNode","prevParagraph","nextLine","childElement","lineWidget","objectCharacter","String","fromCharCode","hasFieldEnd","fieldBeginInternal","fieldSeparatorInternal","fieldEndInternal","field","baselineOffset","span","FieldTextElementBox","fieldText","TabElementBox","tabText","tabLeader","bookmarkTypeIn","refereneceIn","nameIn","reference","bookmarkType","isInlineImage","imageStr","imgElement","isInlineImageIn","isMetaFile","src","image","imageString","isListFollowCharacter","isFollowCharacter","Page","repeatHeaderRowTableWidget","editor","removeFieldInWidget","removePage","tableColumns","getPreviousSpannedCellWidth","previousColumnIndex","curColumnIndex","currentColumnIndex","WColumn","availableWidth","endOffset","isFitColumns","preferredTableWidth","totalColumnWidth","isNaN","column","maxWidth","CONTEXTMENU_COPY","CONTEXTMENU_CUT","CONTEXTMENU_PASTE","CONTEXTMENU_UPDATE_FIELD","CONTEXTMENU_EDIT_FIELD","CONTEXTMENU_HYPERLINK","CONTEXTMENU_OPEN_HYPERLINK","CONTEXTMENU_COPY_HYPERLINK","CONTEXTMENU_REMOVE_HYPERLINK","CONTEXTMENU_EDIT_HYPERLINK","CONTEXTMENU_FONT_DIALOG","CONTEXTMENU_PARAGRAPH","CONTEXTMENU_TABLE","CONTEXTMENU_INSERT_TABLE","CONTEXTMENU_DELETE_TABLE","CONTEXTMENU_INSERT_ABOVE","CONTEXTMENU_INSERT_BELOW","CONTEXTMENU_INSERT_RIGHT","CONTEXTMENU_INSERT_LEFT","CONTEXTMENU_COMPLETE_DELETE_TABLE","CONTEXTMENU_DELETE_ROW","CONTEXTMENU_DELETE_COLUMN","CONTEXTMENU_MERGE_CELL","CONTEXTMENU_CONTINUE_NUMBERING","CONTEXTMENU_RESTART_AT","contextMenuInstance","onContextMenuInternal","event","showHideElements","preventDefault","localValue","contextMenu","containerId","body","ul","listStyle","padding","maxHeight","oncontextmenu","disableBrowserContextmenu","menuItems","getConstant","iconCss","separator","menuOptions","select","handleContextMenuItem","Menu","beforeOpen","caret","showCaret","onClose","cut","pasteInternal","updateToc","navigateHyperlink","copyHyperlink","removeHyperlink","mergeCells","insertRow","insertColumn","deleteTable","deleteRow","deleteColumn","applyContinueNumbering","applyRestartNumbering","getElementById","paste","updateField","editField","font","tableProperties","insertTable","hyperlink","openHyperlink","editHyperlink","continueNumbering","restartAt","display","nextSibling","hideToolTip","copiedData","contextType","listLevelPattern","isCellSelected","getHyperlinkField","isImageField","canMergeCells","previousSibling","parentElement","WAbstractList","abstractListIdIn","WListLevel","uniqueListLevel","followCharacter","numberFormat","restartLevel","initializeUniqueWListLevel","uniqueListLevels","uniqueListLevelTemp","addUniqueWListLevel","dotBullet","squareBullet","arrowBullet","circleBullet","allowLayout","isInitialLoad","maxTextHeight","maxBaseline","maxTextBaseline","isFieldCode","layout","layoutItems","createNewPage","addBodyWidget","clientActiveArea","pageIndex","i_1","prevPage","sectionIndex","insertPage","layoutSection","updateFieldElements","ownerWidget","nextBlock","updateClientAreaForBlock","layoutBlock","layoutHeaderFooter","headerFooterWidget","getCurrentPageHeaderFooter","updateHFClientArea","layoutHeaderFooterItems","updateHeaderFooterToParent","typeIndex","getHeaderFooter","clearTableWidget","linkFieldInHeaderFooter","linkFieldInParagraph","linkFieldInTable","updateClientAreaLocation","pargaraph","shiftChildLocation","clientArea","shiftTop","widgetTop","footerMaxHeight","max","childWidget","shiftChildLocationForTableWidget","tableWidget","shiftChildLocationForTableRowWidget","rowWidget","shiftChildLocationForTableCellWidget","moveToLine","layoutParagraph","layoutTable","addParagraphWidget","area","textHelper","getParagraphMarkWidth","addLineWidget","layoutListItems","layoutEmptyLineWidget","updateClientWidth","layoutLine","updateWidgetToPage","clearLineMeasures","moveElementFromNextLine","layoutElement","nextElement","layoutFieldCharacters","nextNode","moveToNextLine","moveFromNextPage","hasValidElement","getFieldResult","checkAndSplitTabOrLineBreakCharacter","getTextSize","getTabWidth","moveToNextPage","updateFieldText","previousElement","cutClientWidth","textWrap","addElementToLine","currentLine","addSplittedLineWidget","splitTextForClientArea","checkLineWidgetWithClientArea","splitElementForClientArea","elementIndex","getNextValidElementForField","character","splitByLineBreakOrTab","currentElement","splitCurrentWidget","cutFromLeft","splitTextElementWordByWord","fieldStacks","isEmptyLine","isShiftEnter","paragraphMarkSize","getParagraphMarkSize","getBeforeSpacing","getLineSpacing","BaselineOffset","cutFromTop","getListById","clearListElementBox","layoutList","currentListLevel","getListNumber","updateTextSize","addListLevels","val","getListLevelPattern","splittedElementBox","movedElementBox","newLineWidget","splitByWord","getSplitIndexByWord","getWidth","substr","splitByCharacter","textElement","getTextSplitIndexByCharacter","splitWidth","measureTextExcludingSpaceAtEnd","splittedElement","trim","getTextIndexAfterSpace","splittedText","isSplitByWord","textWidth","characterUptoWS","checkPreviousElement","spiltBy","inlineIndex","remainder","newSpan","newText","paraFormat","isParagraphStart","isParagraphEnd","maxDescent","updateLineWidget","measurement","measureText","subWidth","whiteSpaceCount","getWidthAndSpace","getSubWidth","spaceCount","addSubWidth","alignElements","alignLineElements","nextBody","moveBlocksToNextPage","updateClientArea","nextParagraph","insertIndex","isLastElement","getCellContentHeight","enableHeaderAndFooter","shiftFooterChildLocation","top_2","footerDistance","lastTextElement","index_1","lastIndexOf","updateListValues","getListText","getListStartValue","renderedLists","getAbstractListById","startVal","listAdv","listText","levelKey","match","getListTextListLevel","getAsLetter","number","quotient","letter","listValue","getAsRoman","toUpperCase","toLowerCase","getAsLeadingZero","generateNumber","magnitude","numberstring","retval","levelOverrideAdv","fposition","isCustomTab","defaultTabWidth","tabPosition","tabwidth","getRightTabWidth","diff","clientActiveWidth","nextIndex","totalClientWidth","clientActiveAreaWidth","justify","trimSpace","lineText","elementText","isParagraphFirstLine","isParagraphLastLine","lastLineWidget","lastInline","moveNextWidgetsToTable","rowWidgets","moveFromNext","currentRow","currentTable","nextWidgets","addTableCellWidget","maxCellMarginTop","maxCellMarginBottom","prevColumnIndex","cellspace","prevSpannedCellWidth","addWidgetToTable","tableCollection","rowCollection","endRowWidget","prevWidget","rowWidgetIndex","prevIndex","addTableWidget","updateRowHeightBySpannedCell","updateRowHeightByCellSpacing","updateHeightForRowWidget","updateSpannedRowCollection","prevRowWidget","updateRowHeight","mergedCellHeight","isRowSpanEnd","splittedCellWidgets","splittedCell","isVerticalMergedCellContinue","colIndex","splitWidgets","tableRowWidget","isLastRow","isFirstLineFitForRow","getSplittedWidgetForRow","insertSplittedCellWidgets","getSplittedWidget","updateWidgetLocation","updateWidgetsToTable","tableWidgets","rowHeight","getRowHeight","isAllowBreakAcrossPages","moveRowToNextTable","continueHeader","isInsertSplittedWidgets","updateWidgetsToPage","prevBodyWidget","curretTable","currentRenderingPage","updateChildLocationForRow","getHeader","getHeaderHeight","flag","row_1","updateWidgetToRow","lastWidget","cellHeight","isUpdateVerticalPosition","isLayouted","cellspacing","currentRowWidgetIndex","rowSpanWidgetEndIndex","splitSpannedCellWidget","spanEndRowWidget","childWidget_1","updateHeightForCellWidget","updateCellVerticalPosition","updateHeightForTableWidget","previousRowIndex","insertRowSpannedWidget","length_1","insertEmptySplittedCellWidget","previousLeft","emptyCellWidget","createCellWidget","splitMinimalWidget","splittedPara","getSplittedWidgetForPara","tableCol","tableHeight","splittedTable","getSplittedWidgetForTable","createTableWidget","newTable","lineBottom","rowBottom","splittedRow","allowRowBreakAcrossPages","isFirstLineFitForPara","paraWidget","cellwidget","isFirstLineFitInShiftWidgets","containerCellWidget","isFirstLineFitForTable","isFit","isFirstLineFitForCell","updateChildLocationForTable","spacing","updateChildLocationForCell","isUpdateToTop","displacement","getDisplacement","updateCellContentVerticalPosition","location","updateTableWidgetLocation","cellContentHeight","contentHeight","getTableLeftBorder","getTableRightBorder","getTableTopBorder","getTableBottomBorder","getCellDiagonalUpBorder","getCellDiagonalDownBorder","layoutNextItemsBlock","blockAdv","blockToShift","updateNextBlockList","currentWidget","blocks","isInsertingTOC","updateContainerWidget","getFirstParagraphInFirstCell","updateWholeListItems","updateListItemsTillEnd","updateClientAreaForLine","startLineWidget","getTop","getParentTable","reLayoutParagraph","elementBoxIndex","layoutBodyWidgetCollection","reLayoutTable","reLayoutLine","isInHeaderFooter","updateHCFClientAreaWithTop","isBlockInHeader","block_1","clearPosition","clearHeight","clearRowWidget","clearCellWidget","blockIndex","shiftNextWidget","curretBlock","checkAndGetBlock","currentParagraph","shiftNextWidgets","tableView","updateClientAreaTopOrLeft","layoutRow","tables","rows","addTableRowWidget","updateClientAreaForRow","layoutCell","getMaxTopOrBottomCellMargin","borderWidth","topOrBottom","updateClientAreaForCell","shiftLayoutedItems","reLayoutOrShiftWidgets","removeEmptyPages","fieldCode","getFieldCode","shiftWidgetsBlock","updateRenderedListItems","shiftWidgetsForPara","shiftWidgetsForTable","prevBodyObj","getBodyWidgetOfPreviousBlock","shiftToPreviousWidget","updateClientAreaByWidget","isFitInClientArea","nextBodyWidget","createOrGetNextBodyWidget","previousBlock","isSplittedToNewPage","shiftTableWidget","shiftRowWidget","shiftCellWidget","shiftParagraphWidget","prevObj","updateVerticalPositionToTop","combinedTable","isUpdateTop","tablewidget","previousBodyWidget","firstLine","maxElementHeight","getMaxElementHeight","paragraphView","widgetIndex","updateParagraphWidgetInternal","activeArea","lastLine","newParagraphWidget","destroyAndScroll","scrollToBottom","createSplitBody","lastBlock","newBody","lineToLayout","Renderer","pageLeft","pageTop","pageCanvasIn","getContext","containerCanvas","selectionCanvas","getColor","pageContext","fillStyle","beginPath","fillRect","closePath","strokeStyle","strokeRect","setPageSize","rect","clip","renderHFWidgets","renderHeaderSeparator","restore","clearRect","selectionContext","dpr","devicePixelRatio","globalAlpha","scale","cliped","widgetHeight","headerFooterHeight","getScaledValue","renderWidget","ctx","min","renderDashLine","getHeaderFooterType","renderHeaderFooterMark","renderHeaderFooterMarkText","footerHeight","differentFirstPage","differentOddAndEvenPages","setLineDash","moveTo","lineTo","stroke","w","h","content","textBaseline","fillText","renderHeader","renderParagraphWidget","renderTableWidget","renderTableCellWidget","renderLine","renderTableRowWidget","renderTableOutline","visibleBounds","selectedWidgets","addSelectionHighlightTable","renderTableCellOutline","clipRect","addSelectionHighlight","searchHighlighters","widgetInfo","toSkipFieldCode","underlineY","getUnderlineYPosition","renderListTextElementBox","renderImageElementBox","renderTextElementBox","lineHeight","breakCharacterFormat","renderUnderline","renderStrikeThrough","isHeightType","scaledWidth","tabElement","getTabLeader","tabString","getTabLeaderString","floor","xPos","yPos","renderedHeight","underlineHeight","lineCount","widgetWidth","isClipped","containerWid","drawImage","renderSingleBorder","cellTopMargin","cellBottomMargin","cellLeftMargin","cellRightMargin","renderCellBackground","nextRowIsInCurrentTableWidget","nextRowWidget","bgColor","top_1","startX","startY","endX","endY","TextHelper","context","containerContext","paragraphMark","getHeight","textTrimEndWidth","getFormatText","heightInfoCollection","sizeInfo","getHeightInternal","formatText","toLocaleLowerCase","textHeight","spanElement","whiteSpace","innerText","applyStyle","parentDiv","tempDiv","setAttribute","offsetHeight","textTopVal","offsetTop","lineBreakMark","fontWeight","fontStyle","listCharacterFormat","Zoom","onMouseWheelInternal","ctrlKey","pageX","viewerContainer","offsetLeft","pageContainer","offsetWidth","wheel","detail","wheelDelta","setZoomFactor","onZoomFactorChanged","updateCaretPosition","updateTouchMarkPosition","updateImageResizerPosition","zoom","clearContent","handleZoom","currentPage","selectionStartPageIn","selectionEndPageIn","tableLefts","tapCount","timer","isTimerStarted","preZoomFactor","preDifference","fieldEndParagraph","fieldToLayout","containerTop","containerLeft","isMouseDown","isSelectionChangedOnMouseMoved","isControlPressed","isTouchInput","useTouchSelectionMark","touchDownOnSelectionMark","isCompositionUpdated","isCompositionCanceled","isCompositionEnd","prefix","suffix","preDefinedStyles","isRowOrCellResizing","isMouseDownInFooterRegion","pageFitTypeIn","fieldCollection","isPageField","mouseDownOffset","zoomFactorInternal","compositionStart","compositionUpdated","compositionEnd","onImageResizer","isImageResizerVisible","isImageResizing","MouseEvent","onMouseUpInternal","TouchEvent","onTouchUpInternal","onKeyPressInternal","keyCode","charCode","char","handleTextInput","onTextInputInternal","editableDiv","onPaste","onFocusOut","hideCaret","scrollHandler","vtHeight","scrollTop","onWindowResize","resizeTimer","setTimeout","updateViewerSizeInternal","clearTimeout","onContextMenu","onMouseDownInternal","offsetX","offsetY","clientHeight","updateCursor","isLeftButtonPressed","enableImageResizerMode","selectedResizeElement","cursorPoint","findFocusedPage","isCursorInsidePageRect","isCursorInFooterRegion","tableResize","isInCellResizerArea","isInRowResizerArea","startingPoint","handleResize","which","checkCursorIsInSelection","getLineWidget","onMouseMoveInternal","isImageMoveToNextPage","handleImageResizingOnMouse","handleResizing","updateTextPositionForSelection","touchY","textPosition","touchPoint_1","moveTextPosition","checkForCursorVisibility","onDoubleTap","checkAndEnableHeaderFooter","selectCurrentWord","isListTextSelected","isIE","updateResizingHistory","isImageSelected","navigateHyperLinkOnEvent","isSelectionInListText","selectListText","mouseUpInternal","scrollToPosition","updateHistoryForImageResizer","imageResizer","leftValue","topValue","onTouchStartInternal","touches","zoomX","clientX","zoomY","clientY","getTouchOffsetValue","resizeObj","getImagePointOnTouch","selectedElement","getCaretBottom","onTouchMoveInternal","touch","handleImageResizingOnTouch","currentDiff","sqrt","pow","onPinchOutInternal","onPinchInInternal","changedTouches","touchStart","touchEnd","onKeyUpInternal","getSelection","anchorOffset","setEditableDivCaretPosition","onKeyDownInternal","isHandled","keyEventArgs","ctrl","metaKey","shiftKey","alt","altKey","initalizeStyles","bookmarks","containerCanvasIn","selectionCanvasIn","visibleBoundsIn","zoomModule","dialogInternal","initDialog","dialogInternal2","initDialog2","onPageFitTypeChanged","getListLevelNumber","getBookmarks","includeHidden","bookmark","tabIndex","outline","className","pointerEvents","contentEditable","initializeImageResizer","initTouchEllipse","wireEvent","initCaret","addEventListener","dialogTarget","Dialog","showCloseIcon","allowDragging","visible","isModal","X","Y","zIndex","beforeClose","appendTo","tocStyles","tocBookmarkId","editorHistory","selectRange","documentStart","ellipse","getPage","pageGap","getLeftValue","isInsideRect","selectionLineWidget","button","getBoundingClientRect","touchOffsetValues","pageY","updatedZoomFactor","optionsRect","optionsPane","ceil","beforeLayout","currentResizingTable","resizerPosition","headerDistance","updateClientAreaForTable","POSITIVE_INFINITY","updateTextPosition","selectCurrentParagraph","startPosition","endPosition","getLineWidgetInternal","prevLineWidget","prevTop","scrollLeft","caretInfo","updateCaretSize","caretHeight","updateCaretToPage","scrollBarWidth","isMouseDragged","pageBottom","getPageTop","getLineWidgetBodyWidget","clearSelectionHighlight","clearSelectionHighlightInSelectedWidgets","scrollToLastPage","containerHeight","fieldCodes","split","fieldCategory","fieldPattern","getFieldText","pattern","unWireEvent","removeEventListener","hyperlinkField","div","isRowResize","isCellResize","resizePosition","getImagePoint","lineLeft","getLineStartLeft","getHyperLinkFieldInCurrentSelection","updateTextPositionIn","getLeft","setHyperlinkContentToToolTip","cursor","currentPoint","updateCurrentPage","pageRight","prevScaleFactor","verticalHeight","horizontalWidth","horWidth","prevPageTop","prevY","prevValue","prevX","getCurrentHeaderFooter","createHeaderFooterWidget","viewerWidth","viewerHeight","displayPixelRatio","updateScrollBarPosition","parseFloat","updateVisiblePages","pageH","left_1","addVisiblePage","setImageResizerPositions","renderPage","renderVisiblePages","json","jsonObject","parse","parseCharacterFormat","parseParagraphFormat","background","parseAbstractList","parseList","parseStyles","parseSections","data","parseStyle","wStyle","basedStyle","getStyle","styleString","linkStyle","charaStyle","nextStyleString","abstract","parseListLevel","listCollection","parseLevelOverride","parseSectionFormat","parseTextBody","oddHeader","oddFooter","parseBody","styleObj","inlines","parseParagraph","parseTable","parseTableFormat","tableRow","parseRowFormat","parseRowGridValues","parseCellFormat","writeInlineFormat","lineWidgetCount","bookmarkStart","sourceFormat","parseBorders","parseShading","isSamePaddingAsTable","parseCellMargin","sourceBorders","destBorder","parseBorder","sourceBorder","sourceShading","destShading","texture","inlineFormat","parseListFormat","parseTabStop","wTabs","tabStop","SelectionCharacterFormat","boldIn","italicIn","underlineIn","strikeThroughIn","baselineAlignmentIn","highlightColorIn","fontSizeIn","fontColorIn","notifyPropertyChanged","fontFamilyIn","propertyName","isCleared","isRetrieveFormatting","propertyValue","onApplyCharacterFormat","combineFormat","selectionCharacterFormat","SelectionParagraphFormat","leftIndentIn","rightIndentIn","beforeSpacingIn","afterSpacingIn","textAlignmentIn","firstLineIndentIn","lineSpacingIn","lineSpacingTypeIn","listLevelNumberIn","levelPattern","onApplyListInternal","onApplyParagraphFormat","copyToFormat","getList","currentAbstractList","cloneListLevel","cloneLevelOverride","setList","onApplyList","history_1","setOffsetValue","updateListChangesInHistory","updateListParagraphs","applyListChanges","layoutWholeDocument","updateSelectionTextPosition","currentBaseHistoryInfo","modifiedProperties","updateSelection","updateHistory","SelectionSectionFormat","differentFirstPageIn","differentOddAndEvenPagesIn","pageHeightIn","pageWidthIn","leftMarginIn","bottomMarginIn","topMarginIn","rightMarginIn","headerDistanceIn","footerDistanceIn","getPropertyvalue","onApplySectionFormat","SelectionTableFormat","backgroundIn","tableAlignmentIn","cellSpacingIn","preferredWidthIn","tableIn","preferredWidthTypeIn","onApplyTableFormat","SelectionCellFormat","verticalAlignmentIn","onApplyTableCellFormat","clearCellFormat","SelectionRowFormat","heightIn","heightTypeIn","isHeaderIn","allowRowBreakAcrossPagesIn","onApplyTableRowFormat","clearRowFormat","SelectionImageFormat","updateImageFormat","onImageFormat","copyImageFormat","clearImageFormat","HtmlExport","fieldCheck","writeHtml","html","serializeSection","string","serializeParagraph","serializeTable","blockStyle","tagAttributes","serializeParagraphStyle","createAttributesTag","serializeInlines","endTag","serializeImageContainer","serializeInlineStyle","serializeSpan","spanClass","decodeHtmlNames","imageStyle","imageSource","serializeCell","cellHtml","serializeCellBordersStyle","createTableStartTag","serializeRow","createTableEndTag","createRowStartTag","isList","paragraphClass","serializeCharacterFormat","serializeParagraphFormat","serializeTableBorderStyle","borderStyle","convertBorderLineStyle","serializeBorderStyle","borderPosition","tagValue","localProperties","sb","createTag","s","tableStyle","createRowEndTag","htmlText","TextPosition","isUpdateLocation","getStartOffset","getLineLength","getHierarchicalIndexInternal","setPositionForSelection","physicalLocation","isLastRenderedInline","getParagraphLength","setPositionFromLine","setPosition","positionAtStart","updatePhysicalPosition","setPositionInternal","setPositionForCurrentIndex","getParagraphWidget","setPositionParagraph","newValue","moveNextLine","getPhysicalPositionInternal","isAtSamePosition","isInSameParagraph","isExistBefore","isExistAfter","startParagraph","endParagraph","offsetInLine","setPositionForLineWidget","lineLength","nextLineWidget","getNextRenderedBlock","prevLine","curretOffSet","moveNextPosition","isNavigate","getNextStartInline","moveNextPositionInternal","fieldEndOffset","fieldEndIndex","isForwardSelection","moveToInline","nextOffset","getNextValidOffset","info","nextValidInline","getNextValidElement","getStartLineOffset","inlineObj","updateOffsetToNextParagraph","moveToPreviousParagraphInTable","previousParagraph","currentPara","getPreviousSelectionCell","getPreviousParagraphBlock","isHighlight","getNextSelectionBlock","getContainerCellOf","getNextParagraphBlock","updateOffsetToPrevPosition","inlineInfo","getPreviousValidOffset","getPreviousSelectionBlock","previousInline","getPreviousValidElement","moveToNextParagraphStartInternal","movePreviousPosition","movePreviousPositionInternal","hasValidInline","moveBackward","nextInline","getNextRenderedElementBox","fieldBeginOffset","moveForward","fieldBeginIndex","selectionStartIndex","selectionStartInlineObj","selectionStartInline","inlineObj_1","selectionStart","selectionEnd","moveToWordStartInternal","getPreviousWordOffset","calculateOffset","getNextWordOffset","isInField","endSelection","excludeSpace","getNextWordOffsetSpan","getNextWordOffsetImage","getNextWordOffsetFieldBegin","getNextWordOffsetFieldSeperator","getNextWordOffsetFieldEnd","wordEndIndex","txt","getPreviousWordOffsetSpan","getPreviousWordOffsetImage","getPreviousWordOffsetFieldBegin","getPreviousWordOffsetFieldSeparator","getPreviousWordOffsetFieldEnd","getPreviousWordOffsetBookMark","wordStartIndex","setPreviousWordOffset","validateForwardFieldSelection","currentIndex","selectionEndIndex","isPositionMoved","validateBackwardFieldSelection","paragraphStartInternal","moveToPreviousParagraph","moveToNextParagraphInTableCheck","paragraphValue","moveToParagraphStartInternal","moveToParagraphEndInternal","moveToNextParagraph","splittedParagraph","moveToNextParagraphInTable","moveUp","moveToLineStartInternal","getFirstCellInRegion","lastParagraph","getLastParagraph","prevBlock","getLastBlockInLastCell","getLineWidgetParagraph","upDownSelectionLength","getLastCellInRegion","updateTextPositionWidget","moveDown","moveToLineEndInternal","getFirstParagraph","getFirstBlockInFirstCell","moveToPreviousLine","firstElement","getFirstElementInternal","getIndexInInline","prevInline","moveToWordEndInternal","incrementValue","getNextSelectionCell","moveUpInTable","lineStart","isMoveToLineEnd","moveDownInTable","firstItemWidth","getLeftInternal","isPositionUpdated","isBackwardSelection","containerCell","getSelectedCell","isInContainerCell","containsCell","isContainerCellSelected","isAtParagraphStart","getContainerCell","isForward","SelectionWidgetInfo","widthIn","fieldBeginAdv","linkInternal","localRef","opensNewWindow","parseFieldValues","typeInternal","codes","isLocalRef","code","parseFieldValue","setLinkType","endChar","endIndex","navigationLink","ImageFormat","imageContainer","documentEditor","isSkipLayouting","contextTypeInternal","skipFormatRetrieval","isMoveDownOrMoveUp","characterFormatIn","paragraphFormatIn","rowFormatIn","cellFormatIn","tableFormatIn","imageFormatInternal","htmlWriterIn","startInternal","endInternal","selectionStartPage","selectionEndPage","getText","goToHeader","enableHeadersFootersRegion","goToFooter","closeHeaderFooter","disableHeaderFooter","goToPage","updateTextPositionForBlockContainer","selectTable","selectTableInternal","selectRow","selectTableRow","selectColumn","selectColumnInternal","selectCell","selectTableCell","selectionSettings","pageCoordinates","extend","toggleBold","toggleItalic","toggleUnderline","toggleStrikethrough","toggleHighlightColor","toggleSubscript","toggleSuperscript","toggleTextAlignment","increaseIndent","decreaseIndent","fireRequestNavigate","linkType","localReference","navigateBookmark","hyperLinkField","linkText","getLinkText","copyToClipboard","highlightSelection","isSelectionChanged","hideImageResizer","highlightSelectedContent","createHighlightBorder","selectionWidget","clipSelection","createHighlightBorderInsideTable","isVisiblePage","canvasContext","removeSelectionHighlight","currentParaWidget","pageRect","selectCurrentWordRange","fireSelectionChanged","wordStart","extendToParagraphStart","extendToParagraphEnd","updateForwardSelection","updateBackwardSelection","extendToPreviousLine","extendToLineEnd","extendToLineStart","firstrow","firstcell","selectionLength","isMovePrevious","cellStart","getCellLeft","cellEnd","cellLeft","firstBlock","getFirstParagraphBlock","lastrow","lastcell","moveToLineStart","moveToLineEnd","setPositionForBlock","lastPage","handleControlEndKey","documentEnd","selectContent","handleControlHomeKey","handleControlLeftKey","extendToWordStart","handleControlRightKey","extendToWordEnd","handleControlDownKey","handleControlUpKey","handleShiftLeftKey","extendBackward","handleShiftUpKey","handleShiftRightKey","extendForward","handleShiftDownKey","extendToNextLine","handleControlShiftLeftKey","handleControlShiftUpKey","handleControlShiftRightKey","handleControlShiftDownKey","handleLeftKey","handleUpKey","handleRightKey","handleEndKey","handleHomeKey","handleDownKey","handleShiftEndKey","handleShiftHomeKey","handleControlShiftEndKey","handleControlShiftHomeKey","handleTabKey","isNavigateInCell","isShiftTab","selectPreviousCell","selectNextCell","updateListLevel","selectTableCellInternal","clearMultiSelection","firstParagraph","selectParagraph","firstLineWidget","getTable","firstPara","lastPara","getLastParagraphBlock","selectPosition","startTextPos","endTextPos","columnCells","startCellColumnCells","endCellColumnCells","startPos","endPos","selectAll","getContainerWidget","extendToWordStartEnd","isNavigation","getTextPosition","includeObject","getTextInternal","startInlineObj","elementInfo","getRenderedInline","endInlineObj","endInline","getTextInline","nextParagraphWidget","endParagraphWidget","startLineIndex","getFieldCodeInternal","getTocFieldInternal","getNextParagraph","getPreviousParagraph","getFirstParagraphInCell","getLastParagraphInLastCell","getLastParagraphInFirstRow","getPreviousTextInline","getNextTextInline","cell1","cell2","isExistBeforeInline","currentInline","isExistAfterInline","getPreviousRenderedBlock","getNextParagraphCell","getFirstBlockInNextHeaderFooter","getLastBlockInPreviousHeaderFooter","getPreviousParagraphCell","endLine","getLineInfo","childLength","getElementInfo","getPreviousParagraphSelection","getFirstParagraphInLastRow","getPreviousSelectionRow","getNextParagraphSelection","getNextSelection","getNextSelectionRow","getCellInTable","getPreviousSelection","selLength","isMovePrev","validOffset","size","maxBaselineOffset","getPhysicalPositionInline","startInline","fieldValue","elementBoxObj","getElementBoxInternal","positionImageResizer","showImageResizer","highlight","highlightCell","startElement","endElement","endLineWidget","startLineObj","getStartLineWidget","endLineObj","getEndLineWidget","highlightParagraph","highlightNextBlock","highlightTable","getLineWidgetInternalInline","linewidget","highlightCells","endCellLeft","endCellRight","tableWidgetCollection","startTableIndex","endTableIndex","highlightRow","startRowIndex","endRowIndex","highlightInternal","getNextParagraphRow","getPreviousParagraphRow","containsRow","highlightCellWidget","sourceCell","getSelectedCells","highlightContainer","previousValidInline","validateTextPosition","getElementBox","getFieldCharacterPosition","getNextLineWidget","getPreviousTextElement","getNextTextElement","measureObj","firstInline","getEndPosition","getRenderedField","elementObj","getCaretHeight","isEmptySelection","isItalic","getFieldCharacterHeight","heightElement","maxLineHeight","paragarph","textSizeInfo","charHeight","elementHeight","top_3","isNonEmptySelection","clearChildSelectionHighlight","clearSelectionHighlightLineWidget","getLineWidgetParaWidget","getLineWidgetTableWidget","getLineWidgetRowWidget","leftCellSpacing","rightCellSpacing","topCellSpacing","bottomCellSpacing","getLineWidgetCellWidget","getFirstBlock","caretPosition","isImageSelectedObj","selectInternal","includeParagraphMark","elementValues","getFirstElement","prevWidth","charIndex","curIndex","textMetrics","isLineEnd","updatePositionObj","selectFirstBlock","selects","skipSelectionChange","retrieveCurrentFormatProperties","retrieveImageFormat","retrieveCharacterFormat","retrieveParagraphFormat","retrieveSectionFormat","retrieveTableFormat","imageFormat","setCurrentContextType","contextIsinImage","contextIsinTable","tocField","isInHeader","tableAdv","retrieveCellFormat","retrieveRowFormat","getCellFormat","getRowFormat","tempTableRow","startTable","endTable","startParaSection","endParaSection","startPageIndex","endPageIndex","getParagraphFormatForSelection","getParagraphFormatInternalInParagraph","getParagraphFormatInternalInCell","getParagraphFormatInternalInBlock","getParagraphFormatInternalInTable","getParagraphFormatInCell","getParagraphFormatInBlock","getParagraphFormatInParagraph","getParagraphFormatInTable","cellAdv","getParagraphFormatInRow","getParaFormatForCell","startCellIn","endCellIn","para","elemInfo","getCharacterFormatForSelection","getCharacterFormatInTableCell","getCharacterFormat","getCharacterFormatForTableRow","tableRowAdv","getCharacterFormatForSelectionCell","getCharacterFormatForBlock","getCharacterFormatInternalInTable","startIn","endIn","setCharacterFormat","isFieldStartSelected","fieldInline","getCharacterFormatInternal","inlineAndIndex","getNextValidCharacterFormatOfField","getNextValidCharacterFormat","getCharacterFormatInTable","isSelected","top_4","copySelectionParagraphFormat","getHyperlinkDisplayText","isNestedField","displayText","toolTipElement","toolTipText","top_5","showToolTip","toolTipField","toolTipObject","Popup","relateTo","hide","cursorPosition","lineStartLeft","checkedFields","getHyperLinkFields","getHyperLinkFieldInternal","paragraphIsInFieldResult","inlineIsInFieldResult","getBlock","bodyIndex","getBlockInternal","fieldParagraph","selectionIndex","highlightListText","updateImageSize","getSelectedCellsInTable","startColumnIndex","endColumnIndex","startRowindex","copySelectedContent","isCut","htmlWriter","handleCut","htmlContent","removeAllRanges","range","createRange","selectNodeContents","addRange","copySuccess","execCommand","e","parentNode","caretLeft","caretStartLeft","caretEndLeft","page_1","getSelectionPage","childNodes","setStart","collapse","skipUpdate","paragraphInfo","transform","caretHeightInfo","searchResults","pagePoint","isCursorInHeaderRegion","moveToStart","bookmrkElmnt","bookmrkEnd","endoffset","selectBookmark","getTocField","tocPara","isTocStyle","TextSearch","isFooter","find","findOption","findNext","hierarchicalPosition","stringToRegex","textSearchResults","clearResults","results","findDocument","currentSearchResult","textToFind","option","RegExp","isPatternEmpty","wordEmpty","patternRegExp","findAll","isFirstMatch","hierachicalPosition","findInline","findInlineText","inlineEle","stringBuilder","spans","matchObject","matches","exec","result","addResult","spanKeys","spanLength","SearchWidgetInfo","leftInternal","widthInternal","TextSearchResult","TextSearchResults","innerList","textSearchResult","SearchResults","search","navigate","textToReplace","replaceInternal","replaceAll","replaceAllInternal","clearSearchHighlight","isHandledOddPageHeader","isHandledEvenPageHeader","isHandledOddPageFooter","isHandledEvenPageFooter","textSearch","searchResultsInternal","findOptions","replaceText","insertText","endTextPosition","initComplexHistory","currentHistoryInfo","updateComplexHistory","updateComplexWithoutHistory","highlightResult","highlightSearchResult","highlightSearchResultParaWidget","findHighLight","addSearchHighlightBorder","highlighters","searchHighlight","addSearchResultItems","addFindResultView","addFindResultViewForSearch","suffixtext","lastIndex","boxObj","box","boxIndex","shiftIndex","headerFooterString","listElement","layoutViewer","matchCase","wholeWord","searchText","resultsText","messageDivText","replaceButtonText","replaceAllButtonText","focusedIndex","focusedElement","isOptionsPane","replacePaneText","findPaneText","matchDivReplaceText","tabInstance","isReplace","selectedTabItem","previousIndex","selectedIndex","previousTab","querySelector","nextTab","insertBefore","firstElementChild","onFindPane","onReplacePane","searchOptionChange","clearSearchResultItems","inputText","searchInput","navigateSearchResult","messageDiv","localeValue","resultContainer","resultsListBlock","clearFocusElement","wholeWordsChange","matchInput","checked","wholeInput","matchChange","onWireEvents","searchIcon","searchIconClickInternal","navigateToNextResult","navigateNextResultButtonClick","navigateToPreviousResult","navigatePreviousResultButtonClick","onKeyDown","onEnableDisableReplaceButton","resultListBlockClick","closeButton","replaceButton","onReplaceButtonClick","replaceAllButton","onReplaceAllButtonClick","replaceDiv","occurrenceDiv","replaceTabContentDiv","findDiv","findTabButtonHeader","replaceTabButtonHeader","getMessageDivHeight","disabled","replaceWith","onKeyDownOnOptionPane","focusIndex","HTMLInputElement","HTMLLIElement","click","findText","selectionText","inputElement","matchDiv","patterns","resultsContainerHeight","currentelement","listElementsDiv","liElement","listElements","currentlist","list_1","searchDiv","closeSpan","findTab","tabHeader","findTabButton","replaceTabButton","tabContent","findTabContent","findTabContentDiv","searchTextBoxContainer","attrs","placeholder","CheckBox","label","change","replaceTabContent","createReplacePane","Tab","selected","findHeader","getElementsByClassName","replaceHeader","replaceButtonDiv","emptyDiv6","currentIndexValue","blur","text_1","scrollHeight","optionPaneContainer","hideTab","textBox","selectedText","resultListBox","message","TableResizer","resizeNode","initResizingHistory","getRowReSizerPosition","getCellReSizerPosition","getTableWidget","startingPointX","resizerBoundaryWidth","getCellReSizerPositionInternal","childTableWidget","getTableWidgetFromWidget","childCellWidget","getActualWidth","resizeTableCellColumn","resizeTableRow","parentTable","reLayout","currentHeight","selectionFlag","setPreferredWidth","newIndent","resizeColumnWithSelection","rightColumn","prevDragValue","newWidth","dragOffset","updateCellPreferredWidths","updateGridValue","resizeColumnAtLastColumnIndex","resizeCellAtMiddle","selectedCells","resizeColumnAtStart","leftColumnCollection","getColumnCells","increaseOrDecreaseWidth","updateRowsGridAfterWidth","rightColumnCollection","isColumnResizing","isColumnSelected","changeWidthOfCells","selectedRow","newGridBefore","updateGridBefore","leastGridBefore","getLeastGridBefore","updateWidthForCells","hasTableWidth","leftColumn","isContinue","isUpdate","getOffsetValue","isLeftSideCollection","ignoreRow","isIncrease","minimumWidth","isSelection","maxRowWidth","currentRowWidth","getRowWidth","toUpdateGridAfter","leftColumnCells","rightColumnCells","columnCell","applyProperties","tableHistoryInfo","isAutoFit","updateGridBeforeWidth","updateGridAfterWidth","nodes","editHyperlinkInternal","isHandledComplex","refListNumber","incrementListNumber","removedBookmarkElements","pageRefFields","isBordersAndShadingDialog","nbsp","lineFeed","textBoxText","textContent","handleBackKey","insertField","fieldCodeSpan","fieldResultSpan","pasteContentsInternal","clearDirectFormatting","clearFormatting","getCompleteStyles","action","getPrefixAndSuffix","boxInfo","spaceIndex","prefixAdded","endInlineInfo","suffixAdded","toggleBaselineAlignment","acceptTab","handleEnterKey","handleDelete","handleShiftEnter","insertPageBreak","redo","undo","onBackSpace","onDelete","onEnter","animationTimer","copyInsertFormat","insertFormat","sFormat","insertPosition","isRemoved","initHistory","getParagraphInfo","editPosition","removeSelectedContents","updateInsertPosition","insertTextInline","tempSpan","splittedSpan","updateEndPosition","isSelectionOnHyperlink","checkAndConvertList","checkAndConvertToHyperlink","insertSectionBreak","insertSection","newSectionFormat","newParagraph","splitTable","updateNextBlocksIndex","splitParagraphInternal","splitBodyWidget","startBlock","newBodyWidget","updateSectionIndex","insertRemoveHeaderFooter","updateBlockIndex","startBodyWidget","increaseIndex","currentSectionIndex","isTab","convertList","isLeadingZero","tabValue","previousText","checkNumberFormat","checkLeadingZero","deleteSelectedContents","leadingZeroText","autoConvertList","newList","newAbstractList","isBullet","isZero","getPageFromBlockWidget","insertImageText","insertFieldBeginText","insertFieldSeparatorText","insertFieldEndText","insertBookMarkText","spanObj","spanIndex","previousInlineObj","nextInlineObj","isEnter","tabCharIndex","lowerCaseText","containsURL","atIndex","dotIndex","autoFormatHyperlink","url","blockInfo","createHyperlinkElement","appylingHyperlinkFormat","updateCharacterFormatWithUpdate","initInsertInline","begin","insertHyperlinkfield","isBookmark","unLinkFieldCharacter","fieldIndex","insertHyperlink","insertHyperlinkInternal","fieldStartPosition","insertHyperlinkByFormat","insertElement","insertInlineInSelection","insertElementInCurrentLine","isReLayout","checkIsNotRedoing","checkEndPosition","updateHistoryPosition","fieldResult","fieldObj","newFieldBegin","insertInlineInternal","removedNodes","insertClonedFieldResult","getClonedFieldResultWithSel","getClonedFieldResult","insertParagraph","insertBlock","curParagraph","fieldSeparatorPosition","pasteWindow","pasteLocal","clipboardData","getData","pasteContents","document_1","getBlocks","pasteContent","arr","insertParaFormat","removeSelectedContentInternal","pasteCopiedData","insertTableRows","insertBlockInternal","insertTableInternal","moveRows","removeBlock","insertBlockTable","moveInlines","checkInsertPosition","deleteSelectedContent","curInline","insertElementInternal","prevElement","newElement","relayout","startPara","insertNewParagraphWidget","insertImage","insertPicture","createTable","startLine","above","rowPlacement","getOwnerCell","cloneTableToHistoryInfo","rowCount","getRowCountToInsert","isAffectedByRowSpannedCell","cellCountInfo","updateRowspan","newRow","createRowAndColumn","updateCellFormatForInsertedRow","cellFormats","isCellIncluded","isRowSpanned","clonedRowIndex","columnPlacement","newCell","columnCount","getColumnCountToInsert","createColumn","isCellInserted","j_1","rowCell","getOwnerRow","isStart","startRow","endRow","getOwnerTable","mergeSelectedCellsInTable","startOwnerCell","endOwnerCell","mergedCell","mergeSelectedCells","cellInfo","updateSelectedCellsInTable","rowStartIndex","mergeBorders","updateBlockIndexAfterMerge","mergedCellborders","cellBorders","startCellIndex","canMergeSelectedCellsInTable","startLeft","endLeft","selectionLeft","selectionRight","isRowLeftWithinSel","isRowRightWithinSel","rowLeft","rowRight","checkCellWithInSelection","isPrevCellWithinSel","checkPrevOrNextCellIsWithinSel","isNextCellWithinSel","isNoRowSpan","isCellWithInSel","checkCurrentCell","checkCellWidth","isPrev","prevOrNextCell","isPrevCellWithInSel","cellOwner","spannedCellOwner","checkRowSpannedCells","insertAfter","insertIndex_1","isMoved","moveContent","removeEmptyLine","updateHeaderFooterWidget","isHandledComplexHistory","updateHeaderFooterWidgetToPage","shiftPageContent","isEvenPage","updateHeaderFooterWidgetToPageInternal","hfWidget","headerOrFooter","removeFieldInBlock","removeFieldTable","removeField","checkAndShiftFromBottom","update","isAtParagraphEnd","applyCharFormatValue","applyCharacterFormatForListText","updateSelectionCharacterFormatting","values","applyListCharacterFormatByValue","updateListCharacterFormat","updateListTextSelRange","startPositionInternal","endPositionInternal","initHistoryPosition","startSelectionReLayouting","currentList","clearList","applyBullet","bullet","applyBulletOrNumbering","applyNumbering","baseAlignment","updateProperty","initializeHistory","updateParagraphFormatInternal","currentUnderline","script","completeStylesString","name_1","existingStyles","styleNames_1","name_2","createStyle","createStyleIn","getUniqueStyleName","uniqueName","getUniqueName","matchArray","updateCharacterFormat","applyCharFormatSelectedContent","applyCharFormat","applyCharFormatCell","applyCharFormatForSelectedPara","splittedLastParagraph","splittedWidets","getNextParagraphForCharacterFormatting","widgetCollection","applyCharFormatForTable","inlineLength","applyCharFormatInline","getCurrentSelectionValue","updateFontSize","fontsizeCollection","formatInline","getCharacterFormatValueOfCell","applyCharFormatForSelectedCell","applyCharFormatRow","applyCharFormatForTableCell","applyCharFormatForSelTable","startCellLeft","startCellRight","applyCharFormatValueInternal","copyInlineCharacterFormat","destFormat","addModifiedProperties","modifiedFormat","getIndentIncrementValue","applyParaFormatProperty","layoutItemBlock","updateSelectionParagraphFormatting","increaseLevel","nextListLevel","incrementFactor","currentParagraphIndent","getIndentIncrementValueInternal","fPosition","updateParagraphFormat","applyParaFormatSelectedContent","applyCharacterStyle","applyParaFormat","applyParaFormatInCell","addModifiedPropertiesForParagraphFormat","copyParagraphFormat","copyFromListLevelParagraphFormat","onListFormatChange","updateListParagraphFormat","listlevel","oldFormat","newFormat","applyContinueNumberingInternal","numberingInfo","getContinueNumberingInfo","getParagraphFormat","listPattern","changeListId","revertContinueNumbering","levelNum","listType","baseHistoryInfo","addModifiedPropertiesForContinueNumbering","checkNumberArabic","restartListAt","createListLevels","restartListAtInternal","changeRestartNumbering","addModifiedPropertiesForRestartNumbering","levelPatterns","indexOfLevelPattern","getNextParagraphForFormatting","obj","cellContainer","getParaFormatValueInCell","applyParaFormatCellInternal","applyParagraphFormatRow","applyParaFormatTableCell","wCell","applyParagraphFormatTableInternal","wRow","startValue","endValue","applyParaFormatTable","updateSectionFormat","startSectionIndex","endSectionIndex","applyPropertyValueForSection","getTableFormatAction","applyTablePropertyValue","updateSelectionTableFormat","getRowAction","applyRowPropertyValue","getTableCellAction","applyCellPropertyValue","addModifiedPropertiesForSection","startInfo","endInfo","combineSection","nextSection","combineSectionChild","updateTableFormat","updateCellFormat","updateRowFormat","tableStartPosition","newStartPosition","updateFormatForCell","rowStartPosition","rowEndPosition","applyRowFormat","reLayoutSelectionOfTable","reLayoutSelection","isEnded","reLayoutSelectionOfBlock","removeSelectedContent","editAction","deletePara","deleteTableCell","getParagraphForSelection","deleteCells","removeRow","updateTable","paragraphStart","endParagraphStartOffset","isCombineNextParagraph","lastLinelength","isEndInAdjacentTable","isStartParagraph","removeInlines","deleteSection","deleteBlock","insertParagraphPaste","addRemovedNodes","checkAndInsertBlock","combineSectionInternal","currentSection","lastBlockIndex","paragraphAdv","deleteTableBlock","deletePreviousBlock","updateEditPosition","deleteCellsInTable","deleteCell","deleteContainer","isDeleteCells","cell_1","setActionInternal","copyChildToClipboard","checkClearCells","deleteContent","splitEndRow","enableHistoryMode","clonedTable","deleteParagraphMark","removeContent","copyListLevel","destination","listParagraphs","updateListParagraphsInBlock","startListLevel","tempList","abstractListAdv","listName","bulletCharacters","isInsertPageBreak","initialStart","breakParagraph","pageBreak","updateIndex","currentCellIndex","increment","singleBackspace","skipBackSpace","insertRemoveBookMarkElements","bookMark","bookMarkStart","bookMarkEnd","isBackSpace","deleteSelectedContentInternal","getParagraph","lineInfo","canRedo","canUndo","historyInfo","undoStack","startBlockInfo","endBlockInfo","currentLineWidget","setPositionForHistory","removeOffset","removeAtOffset","singleDelete","nextRenderedInline","bookMarkBegin","paraEndOffset","singleDeleteInternal","updateEditPositionOnMerge","base64String","imageElementBox","insertPictureInternal","fitImageToPage","onPortrait","onLandscape","copyValues","changeMarginValue","onPaperSize","currentBlock","updateListItems","updateListItemsForPara","updateListItemsForTable","updateListItemsForRow","updateListItemsForCell","updateRenderedListItemsForPara","updateRenderedListItemsForTable","updateRenderedListItemsForRow","updateRenderedListItemsForCell","getParagraphInfoInternal","lineOffset","insertPageNumber","createFields","insertPageCount","fieldtext","insertBookmark","bookmarkEnd","insertElements","updateComplexHistoryInternal","deleteBookmark","bookmarkName","setBookmarkInfo","deleteBookmarkInternal","getSelectionInfo","startElementInfo","endElementInfo","endElements","startElements","insertElementsInternal","elements","hfString","getBodyWidget","getBlockByIndex","blockObj","getParagraphInternal","getHeaderFooterWidget","getBodyWidgetInternal","isInsertPosition","applyBorders","settings","getBorder","borderColor","clearAllBorderValues","selectedCell","getTopBorderCellsOnSelection","getLeftBorderCellsOnSelection","getRightBorderCellsOnSelection","getBottomBorderCellsOnSelection","getAdjacentCellToApplyBottomBorder","clearBorder","getAdjacentCellToApplyRightBorder","applyAllBorders","applyInsideBorders","updateGridForTableDialog","borderType","isLastSelectedRow","isLastRightCell","nextRowIndex","getAdjacentBottomBorderOnEmptyCells","rightBorderCells","getSelectedCellsNextWidgets","topBorderCells","leftBorderCells","bottomBorderCells","nextCellColIndex","isSingleCell","startPosIn","endPosIn","applyBordersInternal","applyBorder","applyShading","onTableFormat","applyTableFormat","addModifiedTableProperties","handleTableFormat","applyFormat","shiftNextItem","onRowFormat","rowStartPos","rowEndPos","addModifiedRowProperties","handleRowFormat","onCellFormat","updateCellMargins","cellStartPosition","cellEndPosition","applyCellmarginsValue","getSelectedCellInColumn","rowEndIndex","addModifiedCellProperties","handleCellFormat","isTocField","insertTableOfContents","validateTocSettings","getTocSettings","tocSettings","includePageNumber","rightAlign","startLevel","endLevel","swtiches","swtch","includeHyperlink","includeOutlineLevels","decodeTSwitch","tSwitch","levelSettings","tableOfContentsSettings","constructTocFieldCode","buildToc","tocLastPara","tocLastLine","appendEndField","appendEmptyPara","updatePageRef","emptyPara","emptyLine","tocFieldCode","constructTSwitch","isFirstPara","tocDomBody","createHeadingLevels","createOutlineLevels","isHeadingStyle","isOutlineLevelStyle","insertTocBookmark","createTOCWidgets","levelStyle","headingStyle","createTocFieldElement","tocLine","headingStyleName","tocStyleName","insertTocHyperlink","pageField","insertTocPageNumber","bookMarkname","isRightAlign","pageRef","generateBookmarkName","formatString","onCellContentAlignment","ModifiedLevel","modified","ownerListLevelIn","modifiedListLevelIn","ownerListLevel","modifiedListLevel","ModifiedParagraphFormat","ownerFormat","ownerFormatIn","modifiedFormatIn","RowHistoryFormat","rowHeightType","revertChanges","isRedo","currentRowHeightType","TableHistoryInfo","TableFormatHistoryInfo","copyProperties","RowFormatHistoryInfo","CellFormatHistoryInfo","tableHierarchicalIndex","CellHistoryFormat","BaseHistoryInfo","ownerIn","modifiedPropertiesIn","modifiedNodeLength","removedNodesIn","actionIn","selectionStartIn","selectionEndIn","insertPositionIn","endPositionIn","revertBookmark","bookmarkInfo","recordChanges","revert","selectionStartTextPosition","selectionEndTextPosition","revertModifiedProperties","deletedNodes","insertTextPosition","isRemoveContent","isRedoAction","revertModifiedNodes","isDelete","revertResizing","revertTableDialogProperties","revertProperties","redoAction","lastNode","firstNode","insertRemovedNodes","prevTableHistoryInfo","tableHistoryInfoCurrent","currentPropertyIndex","applyTableOptionsHelper","previousFormat","currentFormat","skipRemove","prevLength","nextFormat","addModifiedPropertiesForList","previousLevel","getProperty","modifiedLevel","updateListChanges","addModifiedCellOptions","copyCellOptions","addModifiedTableOptions","copyTableOptions","getCharacterPropertyValue","previousTableFormat","resizeContainerDiv","topLeftRect","topMiddleRect","topRightRect","bottomLeftRect","bottomMiddleRect","bottomRightRect","leftMiddleRect","rightMiddleRect","topLeftRectParent","topMiddleRectParent","topRightRectParent","bottomLeftRectParent","bottomMiddleRectParent","bottomRightRectParent","leftMiddleRectParent","rightMiddleRectParent","resizeMarkSizeIn","selectedImageWidget","imageResizerPoints","ImageResizingPoints","imageResizerDiv","currentImageElementBoxIn","imageResizerDivElement","resizeDiv","initResizeMarks","currentImageElementBox","currentPageDiv","currentPageDivWidth","currentPageDivHeight","imageResizerDivWidth","imageResizerDivHeight","resizeMarkSize","setImageResizerPosition","selectedImageInfo","SelectedImageInfo","initResizeContainerDiv","opacity","setImageResizingPoints","applyPropertiesForTouch","applyPropertiesForMouse","resizeRectElement","boxShadow","handleImageResizing","points","topRightResizing","topLeftResizing","topMiddleResizing","bottomRightResizing","bottomLeftResizing","leftMiddleResizing","imageHeight","initHistoryForImageResizer","getOuterResizingPoint","getInnerResizingPoint","touchEvent","imageResizingPoints","bottomMiddle","bottomRight","bottomLeft","topMiddle","topRight","topLeft","rightMiddle","leftMiddle","touchPoints","imageResizingPointsOnTouch","selectedElements","HistoryInfo","isChild","isChildHistoryInfo","modifiedActions","addModifiedAction","undoStackIn","redoStackIn","historyInfoStack","modifiedParaFormats","undoLimitIn","redoLimitIn","redoStack","rowHistoryFormat","cellHistoryFormat","redoLimit","undoLimit","clearRedoStack","hasAction","modifiedLevelsInternal","modifiedCollection","revertListChanges","clearHistory","clearUndoStack","documentPath","stylePath","numberingPath","settingsPath","headerPath","footerPath","imagePath","appPath","corePath","contentTypesPath","generalRelationPath","wordRelationPath","headerRelationPath","footerRelationPath","xmlContentType","fontContentType","documentContentType","settingsContentType","footerContentType","headerContentType","numberingContentType","stylesContentType","webSettingsContentType","appContentType","coreContentType","customContentType","customXmlContentType","relationContentType","tableStyleContentType","settingsRelType","footerRelType","headerRelType","documentRelType","numberingRelType","stylesRelType","fontRelType","tableStyleRelType","coreRelType","appRelType","customRelType","imageRelType","hyperlinkRelType","controlRelType","packageRelType","customXmlRelType","customUIRelType","attachedTemplateRelType","wNamespace","wpNamespace","pictureNamespace","aNamespace","a14Namespace","rNamespace","rpNamespace","vNamespace","oNamespace","xmlNamespace","w10Namespace","cpNamespace","dcNamespace","docPropsNamespace","veNamespace","mNamespace","wneNamespace","customPropsNamespace","vtNamespace","chartNamespace","slNamespace","dtNamespace","wmlNamespace","w14Namespace","wpCanvasNamespace","wpDrawingNamespace","wpGroupNamespace","wpInkNamespace","wpShapeNamespace","w15Namespace","diagramNamespace","eNamespace","pNamespace","certNamespace","cRelationshipsTag","cRelationshipTag","cIdTag","cTypeTag","cTargetTag","cUserShapesTag","cExternalData","twipsInOnePoint","twentiethOfPoint","borderMultiplier","percentageFactor","emusPerPoint","cConditionalTableStyleTag","cTableFormatTag","cTowFormatTag","cCellFormatTag","cParagraphFormatTag","cCharacterFormatTag","packageType","relsPartPath","documentRelsPartPath","webSettingsPath","wordMLDocumentPath","wordMLStylePath","wordMLNumberingPath","wordMLSettingsPath","wordMLHeaderPath","wordMLFooterPath","wordMLCommentsPath","wordMLImagePath","wordMLFootnotesPath","wordMLEndnotesPath","wordMLAppPath","wordMLCorePath","wordMLCustomPath","wordMLFontTablePath","wordMLChartsPath","wordMLDefaultEmbeddingPath","wordMLEmbeddingPath","wordMLDrawingPath","wordMLThemePath","wordMLFontsPath","wordMLDiagramPath","wordMLControlPath","wordMLVbaProject","wordMLVbaData","wordMLVbaProjectPath","wordMLVbaDataPath","wordMLWebSettingsPath","wordMLCustomItemProp1Path","wordMLFootnoteRelPath","wordMLEndnoteRelPath","wordMLSettingsRelPath","wordMLNumberingRelPath","wordMLFontTableRelPath","wordMLCustomXmlPropsRelType","wordMLControlRelType","wordMLDiagramContentType","lastSection","mRelationShipID","mDocPrID","mDifferentFirstPage","mBookmarks","mDocumentImages","mExternalLinkImages","mHeaderFooterImages","mHeaderFooterColl","mArchive","then","clearDocument","setDocument","ZipArchive","compressionLevel","mVerticalMerge","mGridSpans","serializeDocument","serializeStyles","serializeNumberings","serializeSettings","serializeCoreProperties","serializeAppProperties","serializeFontTable","contenttype","serializeSettingsRelation","serializeHeaderFooters","serializeDocumentRelations","serializeGeneralRelations","serializeContentTypes","mSections","mLists","mAbstractLists","defCharacterFormat","defParagraphFormat","defaultTabWidthValue","mStyles","blockOwner","writer","XmlWriter","writeStartElement","writeCommonAttributeStrings","serializeDocumentBody","writeEndElement","archiveItem","ZipArchiveItem","buffer","addItem","writeAttributeString","writeCustom","writeDup","last","serializeBodyItems","serializeSectionProperties","serializeHFReference","serializeSectionType","serializePageSetup","serializeColumns","pageSetup","serializePageSize","serializePageMargins","roundToTwoDecimal","marginValue","sectionBreakCode","hfId","hf","getNextRelationShipID","addHeaderFooter","hfType","hfColl","blockCollection","isLastSection","serializeBodyItem","sec","serializeParagraphItems","paraItems","serializeFieldCharacter","serializePicture","serializeBookMark","serializeTextRange","bookmarkId","getBookmarkId","serializeDrawing","serializeInlinePicture","cx","cy","serializeDrawingGraphics","startsWith","sourceString","startString","picture","updateShapeId","documentImages","externalImages","tOwner","updateHFImageRels","addImageRelation","imageCollection","relationId","headerId","types","hfKeys","headerImages","headerFooterImages","serializeTableFormat","serializeTableGrid","serializeTableRows","grid","serializeGridColumns","serializeRowFormat","serializeCells","pointWidth","serializeCellFormat","itemIndex","serializeCellWidth","serializeCellMerge","serializeGridSpan","serializeBorders","serializeShading","serializeTableCellDirection","serializeCellVerticalAlign","cf","collKey","isserialized","createMerge","serializeColumnSpan","checkMergeCell","num","alignment","gridValue","serializeTableWidth","serializeTableAlignment","serializeCellSpacing","serializeTableIndentation","serializeTableBorders","serializeTblLayout","getTextureStyle","multipler","serializeBorder","tagName","multiplier","sz","getBorderStyle","tableIndent","writeElementString","isField","writeString","serializeListFormat","serializeParagraphSpacing","serializeIndentation","serializeParagraphAlignment","serializeTabs","serializeTab","getTabJustification","lf","txtAlignment","serializeDefaultStyles","serializeDocumentStyles","zipArchiveItem","serializeBoolProperty","getHighlightColor","getUnderlineStyle","underlineStyle","tag","serializeAbstractListStyles","serializeListInstances","listStyles","generateHex","ilvl","cnt","serializeListLevel","random","levelIndex","getLevelPattern","serializeLevelFollow","serializeLevelText","patternType","lvlIndex","fc","tabWidth","contentType","serializeHeaderFooter","headerFooterPath","headerFooterRelsPath","serializeHeader","serializeFooter","writeHFCommonAttributes","serializeHFRelations","serializeImagesRelations","serializeRelationShip","serializeHeaderFooterRelations","images","base64ImageString","extension","formatClippedString","imageBlob","encodedString","input","chr1","chr2","chr3","enc2","enc3","enc4","keyStr","resultIndex","totalLength","output","Uint8Array","serializeExternalLinkImages","serializeHFRelation","relType","relationshipID","relationshipType","targetPath","resetRelationShipID","serializeDefaultContentType","serializeOverrideContentType","serializeHFContentTypes","serializeHeaderFootersContentType","partName","curSectionIndex","inField","StreamWriter","writeInternal","streamWriter","sectionCount","updateLastParagraph","writeBody","writeNewLine","writeSectionEnd","writeHeadersFooters","bodyItemsCount","bodyItem","isLastPara","writeParagraph","writeTable","writeText","writeHeaderFooter","writeLine","paragraphs","pCount","writeInlineStyles","writeParagraphFormat","endPara","createSection","createParagraph","writeBodyWidget","writeStyles","writeLists","doc","writeHeaderFooters","writeBlock","writeNextBlock","writeLines","writeInlines","writeInline","isEnd","started","ended","writeListFormat","writeTabs","listIdValue","writeRow","createRow","writeCell","createCell","writeTableFormat","writeRowFormat","writeCellFormat","writeShading","wShading","writeBorder","wBorder","writeBorders","wBorders","wCellFormat","wRowFormat","wTableFormat","writeStyle","writeList","writeAbstractList","wAbstractList","writeListLevel","wList","wListLevel","navigationUrl","bookmarkDropdown","bookmarkCheckbox","onKeyUpOnUrlBox","urlValue","urlTextBox","displayTextBox","enableOrDisableInsertButton","onInsertHyperlink","onKeyUpOnDisplayBox","onInsertButtonClick","onCancelButtonClick","dialog","clearValue","loadHyperlinkDialog","localObj","bookmarkDiv","addressText","dataSource","insertButton","closeHyperlinkDialog","onUseBookmarkChange","onBookmarkchange","autofocus","bookmarkText","bookmarkTextElement","bookmarkValue","DropDownList","popupHeight","noRecordsTemplate","bookmarkCheckDiv","bookmarkCheck","buttons","buttonModel","cssClass","isPrimary","dataBind","address","keyUpInsertTable","rowsCountBox","columnsCountBox","onInsertTableClick","rowValueTextBox","columnValueTexBox","columnContainer","columnValue","rowContainer","rowValue","NumericTextBox","enablePersistence","addBookmark","textBoxInput","selectHandler","setSelectionRange","gotoBookmark","initBookmarkDialog","headerValue","dlgFields","commonDiv","textBoxDiv","listviewDiv","listviewInstance","ListView","buttonDiv","addbuttonDiv","addButtonElement","Button","deleteButtonDiv","deleteButtonElement","gotoButtonDiv","gotoButtonElement","removeObjects","bind","loadTableofContentDialog","enabled","showLevel","closeTableOfContentDialog","unWireEventsAndBindings","changeShowLevelValue","changeByValue","headings","heading1","heading2","heading3","heading4","heading5","heading6","heading7","heading8","heading9","reset","normal","changeStyle","headingValue","srcElement","getElementValue","checkLevel","changeHeadingStyle","changePageNumberValue","changeRightAlignValue","changeStyleValue","applyTableOfContentProperties","applyLevelSetting","ownerId","generalDiv","genLabel","leftGeneralDiv","rightGeneralDiv","leftBottomGeneralDiv","rightBottomGeneralDiv","pageNumberDiv","rightAlignDiv","tabDiv","tabLeaderLabelDiv","tabLeaderLabel","tabLeaderDiv","showDiv","showLevelLabelDiv","showLevelLabel","showLevelDiv","buildTableDiv","buildTableLabel","tr1","td1","availableLabel","td2","tocLabel","tableDiv","table1","tr2","td3","heading1Label","td4","tr3","td5","heading2Label","td6","tr4","td7","heading3Label","td8","tr5","td9","heading4Label","td10","tr6","td11","heading5Label","td12","tr7","td13","heading6Label","td14","tr8","td15","heading7Label","td16","tr9","td17","heading8Label","td18","tr10","td19","heading9Label","td20","tr12","td23","normalLabel","td24","stylesLevelDiv","fieldsDiv","outDiv","outlineDiv","resetButtonDiv","resetElement","tocStylesDiv","tocStylesLabel","listViewDiv","listViewInstance","modifyButtonDiv","modifyElement","getHeadingLevel","newStartLevel","newEndLevel","isEndLevel","isPortrait","loadPageSetupDialog","topMarginBox","leftMarginBox","bottomMarginBox","rightMarginBox","widthBox","heightBox","checkBox1","checkBox2","headerBox","footerBox","landscape","portrait","closePageSetupDialog","keyUpInsertPageSettings","applyPageSetupProperties","changeByPaperSize","paperSize","ejtabContainer","marginTab","paperTab","layoutTab","ejtab","headerContainer","marginHeader","paperHeader","layoutHeader","contentContainer","marginContent","paperContent","layoutContent","initMarginProperties","initPaperSizeProperties","initLayoutProperties","tabObj","marginDiv","leftMarginDiv","rightMarginDiv","topLabel","topTextBox","bottomBoxLabel","bottomTextBox","leftBoxLabel","leftTextBox","rightLabel","rightTextBox","decimals","orientationDiv","orientationLabeldiv","orientationPropDiv","portraitDiv","landscapeDiv","RadioButton","sizeDiv","leftSizeDiv","rightSizeDiv","widthLabel","widthTextBox","heightLabel","heightTextBox","paperSizeDiv","layoutDiv","firstPageDiv","oddOrEvenDiv","textLabelDiv","textLabel","propertyDiv","leftLayoutDiv","rightLayoutDiv","headerLabel","footerLabel","keyUpParagraphSettings","applyParagraphFormat","changeBeforeSpacing","changeAfterSpacing","changeLeftIndent","changeRightIndent","changeLineSpacingValue","changeFirstLineIndent","changeByTextAlignment","special","byIn","changeBySpacing","atIn","loadParagraphDialog","selectionFormat","alignValue","lineSpaceValue","isApply","onParagraphFormat","closeParagraphDialog","alignLabel","indentionDiv","leftIndentionDiv","rightIndentionDiv","spacingDiv","leftSpacingDiv","rightSpacingDiv","indentLabel","beforeTextLabel","specialLabel","afterTextLabel","byLabel","by","spaceLabel","beforeLabel","lineSpaceLabel","afterLabel","atLabel","lineSpacingAt","step","local","q","ListViewModel","listIn","levelNumberIn","createList","listLevelAdv","viewModel","textIndent","alignedAt","listLevelElement","followNumberWith","numberStyle","restartBy","isListCharacterFormat","onTextIndentChanged","onStartValueChanged","onListLevelValueChanged","updateDialogValues","updateRestartLevelBox","onNumberFormatChanged","onAlignedAtValueChanged","onFollowCharacterValueChanged","onLevelPatternValueChanged","numberFormatTextBox","loadListDialog","dialog2","disposeBindingForListUI","closeListDialog","listLevelDiv","numberStyleDiv","numberFormatDiv","indentsDiv","startAtTextBox","textIndentAtTextBox","alignedAtTextBox","followCharacterElement","numberStyleEle","restartElement","formatInfoToolTip","Tooltip","option_1","listPatternConverter","followCharacterConverter","l","styleBasedOn","styleParagraph","onlyThisDocument","template","openDialog","showNumberingBulletDialog","setBoldProperty","fontButtonClicked","setItalicProperty","setUnderlineProperty","fontSizeUpdate","fontFamilyChanged","fontColorUpdate","currentValue","rgba","setLeftAlignment","setRightAlignment","setCenterAlignment","setJustifyAlignment","increaseBeforeAfterSpacing","decreaseBeforeAfterSpacing","updateNextStyle","typedName","getTypeValue","isUserNextParaUpdated","isEdit","editStyleName","updateOkButton","enableOrDisableOkButton","styleTypeChange","isInteracted","toggleDisable","updateStyleNames","styleBasedOnChange","styleParagraphChange","numberingBulletDialog","showNumberBulletDialog","onOkButtonClick","styleNameElement","updateList","createLinkStyle","loadStyleDialog","okButton","closeStyleDialog","properties","styleNameTypeDiv","nameWholeDiv","nameValue","styleTypeWholeDiv","styleTypeDivElement","styleTypeValue","styleBasedParaDiv","styleBasedOnWholeDiv","styleBasedOnDivElement","styleBasedOnValue","styleParagraphWholeDiv","styleParagraphDivElement","styleParagraphValue","formatting","optionsDiv","fontOptionsDiv","createFontOptions","paragraphOptionsDiv","createParagraphOptions","createFormatDropdown","formatBtn","dropDownbtn","DropDownButton","beforeItemRender","fontFamilyElement","ComboBox","popupWidth","showClearButton","fontSizeElement","fontGroupButton","createButtonElement","fontColorElement","ColorPicker","alignmentDiv","leftAlign","centerAlign","lineSpacingDiv","singleLineSpacing","onePointFiveLineSpacing","doubleLineSpacing","indentingDiv","buttonElement","removeAttribute","paragraphFOrmat","nxtName","basedOnIndex","numberListClick","setActiveElement","currentTarget","bulletListClick","symbol","loadNumberingBulletDialog","closeNumberingBulletDialog","initNumberingBulletDialog","tabTarget","createNumberList","createBulletList","heightAdjustMode","refresh","numberListDiv","ulTag","numberedNone","createNumberNoneListTag","numberedNumberDot","createNumberListTag","numberedNumberBrace","numberedUpRoman","numberedUpLettter","numberedLowLetterDot","numberedLowLetterBrace","numberedLowRoman","text1","text2","text3","liTag","liInnerDiv","cssFloat","createBulletListTag","liNextDiv","bulletListDiv","bulletNone","bulletDot","bulletCircle","bulletSquare","bulletFlower","bulletArrow","bulletTick","childElementCount","fontStyleInternal","fontNameList","fontStyleText","fontSizeText","colorPicker","underlineDrop","strikethroughBox","doublestrikethrough","superscript","subscript","loadFontDialog","getItems","closeFontDialog","onInsertFontFormat","onCharacterFormat","fontStyleUpdate","fontFamilyUpdate","underlineUpdate","hex","singleStrikeUpdate","enableCheckBoxProperty","doubleStrikeUpdate","superscriptUpdate","subscriptUpdate","createInputElement","effectLabel","strikeThroughElement","superScriptElement","subScriptElement","doubleStrikeThroughElement","fontDiv","getFontDiv","getFontSizeDiv","colorDiv","fontColorDiv","fontColorLabel","fontEffectsDiv","fontEffectSubDiv1","fontEffectSubDiv2","sizeSubDiv1","sizeLabel","underlineElement","sizeSubDiv2","underlineLabel","fontSubDiv1","fontNameLabel","fontNameValues","fontSubDiv2","fontStyleLabel","fontStyleValues","hasCellWidth","isTableBordersAndShadingUpdated","isCellBordersAndShadingUpdated","isCellOptionsUpdated","isTableOptionsUpdated","onBeforeOpen","loadTableProperties","onCloseTablePropertyDialog","applyTableProperties","preferCheckBox","indeterminate","rowHeightCheckBox","preferredCellWidthCheckBox","rowHeightValue","closeTablePropertiesDialog","applyTableSubProperties","applySubCellOptions","applySubTableOptions","tableWidthBox","tableWidthType","leftIndentBox","rowHeightBox","repeatHeader","allowRowBreak","cellWidthBox","cellWidthType","changeTableCheckBox","enable","changeTableAlignment","updateClassForAlignmentProperties","tableTab","getTableAlignment","changeTableRowCheckBox","changeTableCellCheckBox","changeCellAlignment","updateClassForCellAlignment","cellTab","getCellAlignment","showBordersShadingsPropertiesDialog","rowFormatInternal","rowTab","separatorLine","tableHeader","rowHeader","cellHeader","tableContent","rowContent","cellContent","initTableProperties","initTableRowProperties","initTableCellProperties","alignMentButtons","cellAlignment","calculateGridValue","setTableProperties","setTableRowProperties","setTableCellProperties","bordersAndShadingButton","tableOptionButton","cellOptionButton","onTableWidthChange","onTableWidthTypeChange","onLeftIndentChange","onRowHeightChange","onRowHeightTypeChange","onAllowBreakAcrossPage","onRepeatHeader","onCellWidthChange","onCellWidthTypeChange","sizeHeader","parentContainer","childContainer1","childContainer2","child1","child2","childContainer3","controlDiv","labeltext","alignmentHeader","alignmentContainer","classDivName","leftAlignDiv","centerAlignDiv","center","leftlabel","centerlabel","rightlabel","leftIndenetContainer","leftIndentLabel","tableOptionContiner","formatNumericTextBox","tableHasWidth","groupButtons","groupButton","rowDiv","sizeLabeldiv","childDiv1","childdiv2","child3","child4","allowRowContainer","repeatHeaderContaniner","enableRowHeight","parentdiv","childdiv1","preferredCellWidth","divAlignment","divStyle","topAlignDiv","cellTopAlign","cellCenterAlign","bottomAlignDiv","cellBottomAlign","centerLabel","bottomLabel","cellAlignments","applyBordersShadingsProperties","tablePropertiesDialog","checkClassName","previewDivTopTop","previewDivTopBottom","previewDivTopCenter","previewDivBottomcenter","previewDivBottomLeft","previewDivBottomRight","previewDivDiagonalRight","previewDivLeftDiagonal","shadingColorPicker","ulelementShading","applyTo","noneDiv","currentTableFormat","closeDialog","closeBordersShadingsDialog","handleSettingCheckBoxAction","targetId","tableBorderDialogId","updateClassForSettingDivElements","setSettingPreviewDivElement","boxDiv","allDiv","customDiv","handlePreviewCheckBoxAction","compareClass","handlePreviewCheckBoxShowHide","showHidePreviewDivElements","applyTableCellPreviewBoxes","previewDivBottomcenterContainer","previewDivTopCenterContainer","previewVerticalDiv","previewHorizontalDiv","previewDivBottomRightContainer","applyPreviewTableBackgroundColor","previewDiv","applyPreviewTableBorderColor","previewRightDiagonalDiv","previewLeftDiagonalDiv","settingsContiner","styleContainer","previewContiner","styleText","dropDownList","widthText","widthNumeric","colorText","borderColorPickerElement","settingText","noneDivContainer","noneDivLabel","boxDivContainer","boxDivLabel","allDivContainer","allDivLabel","customDivContainer","customDivLabel","noneDivTransparent","boxDivTransparent","allDivTransparent","customDivTransparent","previewText","previewDivTopTopContainer","previewDivTopBottomContainer","previewDivLeftDiagonalContainer","previewDivBottomLeftContainer","previewDivDiagonalRightContainer","previewDivTopTopTransParent","previewDivTopCenterTransParent","previewDivTopBottomTransParent","previewDivLeftDiagonalTransParent","previewDivBottomLeftTransparent","previewDivBottomcenterTransparent","previewDivBottomRightTransparent","previewDivDiagonalRightTransparent","shadingContiner","shadingText","shadings","shadingColorPickerElement","shdApply","divsion","borderColorPicker","loadBordersShadingsPropertiesDialog","settingDivs","tempClassName","isShowHidePreviewTableElements","settingDiv","elementClass","compareElementClass","setElement","compareElement","setPropertyPreviewDivElement","ele","fillColor","cloneBorders","getLineStyle","colorPickerEvent","fillColorEvent","horizontalBorder","verticalBorder","diagonalDownBorder","customBorder","diagonalUpBorder","applyTableCellProperties","cellSpaceTextBox","applyTableOptions","closeCellMarginsDialog","changeAllowSpaceCheckBox","allowSpaceCheckBox","removeEvents","innerDiv","innerDivLabel","getCellMarginDialogElements","cellSpaceLabel","table2","cellspacingTextBox","divBtn","loadCellMarginsDialog","applyTableOptionsHistory","applySubTableOptionsHelper","documentLocale","changeSameAsTable","sameAsTableCheckBox","tr","td","localizeValue","sameAsTable","loadCellProperties","enableTextBox","enableCheckBox","applyCellMarginsInternal","applyCellMarginsForCells","rowCells","iterateCells","applySubCellMargins","leftLabel","v","modifyStyles","addNewStyles","initStylesDialog","newButtonDiv","newButtonElement","modifybuttonDiv","modifyButtonElement","hideObjects"],"mappings":"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"}