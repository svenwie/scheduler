{"version":3,"file":"ej2-documenteditor.min.js","sources":["../../src/document-editor/base/dictionary.js","../../src/document-editor/base/unique-format.js","../../src/document-editor/base/unique-formats.js","../../src/document-editor/document-editor.js","../../src/document-editor/implementation/print.js","../../src/document-editor/implementation/format/section-format.js","../../src/document-editor/implementation/list/level-override.js","../../src/document-editor/implementation/list/list.js","../../src/document-editor/implementation/format/list-format.js","../../src/document-editor/implementation/format/paragraph-format.js","../../src/document-editor/implementation/format/character-format.js","../../src/document-editor/implementation/editor/editor-helper.js","../../src/document-editor/implementation/format/style.js","../../src/document-editor/implementation/format/border.js","../../src/document-editor/implementation/format/borders.js","../../src/document-editor/implementation/format/shading.js","../../src/document-editor/implementation/format/table-format.js","../../src/document-editor/implementation/format/row-format.js","../../src/document-editor/implementation/format/cell-format.js","../../src/document-editor/implementation/viewer/page.js","../../src/document-editor/implementation/context-menu.js","../../src/document-editor/implementation/list/abstract-list.js","../../src/document-editor/implementation/list/list-level.js","../../src/document-editor/implementation/viewer/layout.js","../../src/document-editor/implementation/viewer/render.js","../../src/document-editor/implementation/viewer/text-helper.js","../../src/document-editor/implementation/viewer/zooming.js","../../src/document-editor/implementation/viewer/viewer.js","../../src/document-editor/implementation/viewer/sfdt-reader.js","../../src/document-editor/implementation/selection/selection-format.js","../../src/document-editor/implementation/writer/html-export.js","../../src/document-editor/implementation/selection/selection-helper.js","../../src/document-editor/implementation/selection/selection.js","../../src/document-editor/implementation/search/text-search.js","../../src/document-editor/implementation/search/text-search-result.js","../../src/document-editor/implementation/search/text-search-results.js","../../src/document-editor/implementation/search/search-results.js","../../src/document-editor/implementation/search/search.js","../../src/document-editor/implementation/search/options-pane.js","../../src/document-editor/implementation/editor/table-resizer.js","../../src/document-editor/implementation/editor/editor.js","../../src/document-editor/implementation/editor-history/history-helper.js","../../src/document-editor/implementation/editor-history/base-history-info.js","../../src/document-editor/implementation/editor/image-resizer.js","../../src/document-editor/implementation/editor-history/history-info.js","../../src/document-editor/implementation/editor-history/editor-history.js","../../src/document-editor/implementation/writer/word-export.js","../../src/document-editor/implementation/writer/text-export.js","../../src/document-editor/implementation/writer/sfdt-export.js","../../src/document-editor/implementation/dialogs/hyperlink-dialog.js","../../src/document-editor/implementation/dialogs/table-dialog.js","../../src/document-editor/implementation/dialogs/bookmark-dialog.js","../../src/document-editor/implementation/dialogs/table-of-contents-dialog.js","../../src/document-editor/implementation/dialogs/page-setup-dialog.js","../../src/document-editor/implementation/dialogs/paragraph-dialog.js","../../src/document-editor/implementation/dialogs/list-view-model.js","../../src/document-editor/implementation/dialogs/list-dialog.js","../../src/document-editor/implementation/dialogs/style-dialog.js","../../src/document-editor/implementation/dialogs/bullets-and-numbering-dialog.js","../../src/document-editor/implementation/dialogs/font-dialog.js","../../src/document-editor/implementation/dialogs/table-properties-dialog.js","../../src/document-editor/implementation/dialogs/borders-and-shading-dialog.js","../../src/document-editor/implementation/dialogs/table-options-dialog.js","../../src/document-editor/implementation/dialogs/cell-options-dialog.js","../../src/document-editor/implementation/dialogs/styles-dialog.js"],"sourcesContent":["import { isNullOrUndefined } from '@syncfusion/ej2-base';\n/**\n * @private\n */\nvar Dictionary = /** @class */ (function () {\n    function Dictionary() {\n        this.keysInternal = [];\n        this.valuesInternal = [];\n        this.item = [];\n    }\n    Object.defineProperty(Dictionary.prototype, \"length\", {\n        /**\n         * @private\n         */\n        get: function () {\n            return this.keysInternal.length;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(Dictionary.prototype, \"keys\", {\n        /**\n         * @private\n         */\n        get: function () {\n            return this.getItem();\n        },\n        enumerable: true,\n        configurable: true\n    });\n    /**\n     * @private\n     */\n    Dictionary.prototype.getItem = function () {\n        this.item = [];\n        for (var i = 0; i < this.keysInternal.length; i++) {\n            this.item.push(this.keysInternal[i]);\n        }\n        return this.item;\n    };\n    /**\n     * @private\n     */\n    Dictionary.prototype.add = function (key, value) {\n        if (isNullOrUndefined(key)) {\n            throw new ReferenceError('Provided key or value is not valid.');\n        }\n        var index = this.keysInternal.indexOf(key);\n        // if (index < 0 || index > this.keysInternal.length - 1) {\n        if (index < 0) {\n            this.keysInternal.push(key);\n            this.valuesInternal.push(value);\n        }\n        return 1;\n        // else {\n        //     throw new RangeError('An item with the same key has already been added.');\n        // }\n    };\n    /**\n     * @private\n     */\n    Dictionary.prototype.get = function (key) {\n        if (isNullOrUndefined(key)) {\n            throw new ReferenceError('Provided key is not valid.');\n        }\n        var index = this.keysInternal.indexOf(key);\n        if (index < 0 || index > this.keysInternal.length - 1) {\n            throw new RangeError('No item with the specified key has been added.');\n        }\n        else {\n            return this.valuesInternal[index];\n        }\n    };\n    /**\n     * @private\n     */\n    Dictionary.prototype.set = function (key, value) {\n        if (isNullOrUndefined(key)) {\n            throw new ReferenceError('Provided key is not valid.');\n        }\n        var index = this.keysInternal.indexOf(key);\n        if (index < 0 || index > this.keysInternal.length - 1) {\n            throw new RangeError('No item with the specified key has been added.');\n        }\n        else {\n            this.valuesInternal[index] = value;\n        }\n    };\n    /**\n     * @private\n     */\n    Dictionary.prototype.remove = function (key) {\n        if (isNullOrUndefined(key)) {\n            throw new ReferenceError('Provided key is not valid.');\n        }\n        var index = this.keysInternal.indexOf(key);\n        if (index < 0 || index > this.keysInternal.length - 1) {\n            throw new RangeError('No item with the specified key has been added.');\n        }\n        else {\n            this.keysInternal.splice(index, 1);\n            this.valuesInternal.splice(index, 1);\n            return true;\n        }\n    };\n    /**\n     * @private\n     */\n    Dictionary.prototype.containsKey = function (key) {\n        if (isNullOrUndefined(key)) {\n            throw new ReferenceError('Provided key is not valid.');\n        }\n        var index = this.keysInternal.indexOf(key);\n        if (index < 0 || index > this.keysInternal.length - 1) {\n            return false;\n        }\n        return true;\n    };\n    /**\n     * @private\n     */\n    Dictionary.prototype.clear = function () {\n        this.keysInternal = [];\n        this.valuesInternal = [];\n    };\n    /**\n     * @private\n     */\n    Dictionary.prototype.destroy = function () {\n        this.clear();\n        this.keysInternal = undefined;\n        this.valuesInternal = undefined;\n    };\n    return Dictionary;\n}());\nexport { Dictionary };\n","import { isNullOrUndefined } from '@syncfusion/ej2-base';\nimport { Dictionary } from './dictionary';\n/**\n * @private\n */\nvar WUniqueFormat = /** @class */ (function () {\n    function WUniqueFormat(type) {\n        this.referenceCount = 0;\n        this.uniqueFormatType = type;\n        this.propertiesHash = new Dictionary();\n    }\n    /**\n     * @private\n     */\n    WUniqueFormat.prototype.isEqual = function (source, property, modifiedValue) {\n        var isEqual = false;\n        switch (this.uniqueFormatType) {\n            case 1:\n                isEqual = this.isBorderEqual(source, property, modifiedValue);\n                break;\n            case 2:\n                isEqual = this.isCharacterFormatEqual(source, property, modifiedValue);\n                break;\n            case 3:\n                isEqual = this.isParagraphFormatEqual(source, property, modifiedValue);\n                break;\n            case 4:\n                isEqual = this.isCellFormatEqual(source, property, modifiedValue);\n                break;\n            case 5:\n                isEqual = this.isShadingEqual(source, property, modifiedValue);\n                break;\n            case 6:\n                isEqual = this.isRowFormatEqual(source, property, modifiedValue);\n                break;\n            case 7:\n                isEqual = this.isListFormatEqual(source, property, modifiedValue);\n                break;\n            case 8:\n                isEqual = this.isTableFormatEqual(source, property, modifiedValue);\n                break;\n            case 9:\n                isEqual = this.isListLevelEqual(source, property, modifiedValue);\n                break;\n            case 10:\n                isEqual = this.isSectionFormatEqual(source, property, modifiedValue);\n                break;\n            default:\n                break;\n        }\n        return isEqual;\n    };\n    // tslint:disable-next-line:max-line-length\n    WUniqueFormat.prototype.isNotEqual = function (property, source, modifiedProperty, modifiedValue, uniqueFormatType) {\n        var targetValue = undefined;\n        var propertyType = WUniqueFormat.getPropertyType(uniqueFormatType, property);\n        if (this.propertiesHash.containsKey(propertyType)) {\n            targetValue = this.propertiesHash.get(propertyType);\n        }\n        var sourceValue = undefined;\n        if (property === modifiedProperty) {\n            sourceValue = modifiedValue;\n        }\n        else if (source.containsKey(propertyType)) {\n            sourceValue = source.get(propertyType);\n        }\n        // tslint:disable-next-line:max-line-length\n        if (!(targetValue === sourceValue || (!isNullOrUndefined(targetValue) && !isNullOrUndefined(sourceValue) && targetValue === sourceValue))) {\n            return true;\n        }\n        return false;\n    };\n    /**\n     * @private\n     */\n    WUniqueFormat.getPropertyType = function (uniqueFormatType, property) {\n        var type = 0;\n        switch (uniqueFormatType) {\n            case 1:\n                type = this.getBorderPropertyType(property);\n                break;\n            case 2:\n                type = this.getCharacterFormatPropertyType(property);\n                break;\n            case 3:\n                type = this.getParaFormatPropertyType(property);\n                break;\n            case 4:\n                type = this.getCellFormatPropertyType(property);\n                break;\n            case 5:\n                type = this.getShadingPropertyType(property);\n                break;\n            case 6:\n                type = this.getRowFormatType(property);\n                break;\n            case 7:\n                type = this.getListFormatType(property);\n                break;\n            case 8:\n                type = this.getTableFormatType(property);\n                break;\n            case 9:\n                type = this.getListLevelType(property);\n                break;\n            case 10:\n                type = this.getSectionFormatType(property);\n                break;\n            default:\n                break;\n        }\n        return type;\n    };\n    WUniqueFormat.getRowFormatType = function (property) {\n        if (property === 'allowBreakAcrossPages') {\n            return 1;\n        }\n        if (property === 'isHeader') {\n            return 2;\n        }\n        if (property === 'height') {\n            return 3;\n        }\n        if (property === 'heightType') {\n            return 4;\n        }\n        if (property === 'gridBefore') {\n            return 5;\n        }\n        if (property === 'gridBeforeWidth') {\n            return 6;\n        }\n        if (property === 'gridBeforeWidthType') {\n            return 7;\n        }\n        if (property === 'gridAfter') {\n            return 8;\n        }\n        if (property === 'gridAfterWidth') {\n            return 9;\n        }\n        if (property === 'gridAfterWidthType') {\n            return 10;\n        }\n        return 0;\n    };\n    WUniqueFormat.getListFormatType = function (property) {\n        if (property === 'listId') {\n            return 1;\n        }\n        if (property === 'listLevelNumber') {\n            return 2;\n        }\n        return 0;\n    };\n    WUniqueFormat.getTableFormatType = function (property) {\n        if (property === 'leftMargin') {\n            return 1;\n        }\n        if (property === 'rightMargin') {\n            return 2;\n        }\n        if (property === 'topMargin') {\n            return 3;\n        }\n        if (property === 'bottomMargin') {\n            return 4;\n        }\n        if (property === 'cellSpacing') {\n            return 5;\n        }\n        if (property === 'leftIndent') {\n            return 6;\n        }\n        if (property === 'tableAlignment') {\n            return 7;\n        }\n        if (property === 'preferredWidth') {\n            return 8;\n        }\n        if (property === 'preferredWidthType') {\n            return 9;\n        }\n        return 0;\n    };\n    WUniqueFormat.getListLevelType = function (property) {\n        if (property === 'listLevelPattern') {\n            return 1;\n        }\n        if (property === 'startAt') {\n            return 2;\n        }\n        if (property === 'followCharacter') {\n            return 3;\n        }\n        if (property === 'numberFormat') {\n            return 4;\n        }\n        if (property === 'restartLevel') {\n            return 5;\n        }\n        return 0;\n    };\n    WUniqueFormat.getShadingPropertyType = function (property) {\n        if (property === 'backgroundColor') {\n            return 1;\n        }\n        if (property === 'foregroundColor') {\n            return 2;\n        }\n        if (property === 'textureStyle') {\n            return 3;\n        }\n        return 0;\n    };\n    WUniqueFormat.getCellFormatPropertyType = function (property) {\n        if (property === 'leftMargin') {\n            return 1;\n        }\n        if (property === 'rightMargin') {\n            return 2;\n        }\n        if (property === 'topMargin') {\n            return 3;\n        }\n        if (property === 'bottomMargin') {\n            return 4;\n        }\n        if (property === 'columnSpan') {\n            return 5;\n        }\n        if (property === 'rowSpan') {\n            return 6;\n        }\n        if (property === 'verticalAlignment') {\n            return 7;\n        }\n        if (property === 'preferredWidthType') {\n            return 8;\n        }\n        if (property === 'preferredWidth') {\n            return 9;\n        }\n        if (property === 'cellWidth') {\n            return 10;\n        }\n        return 0;\n    };\n    WUniqueFormat.getBorderPropertyType = function (property) {\n        if (property === 'color') {\n            return 1;\n        }\n        if (property === 'lineStyle') {\n            return 2;\n        }\n        if (property === 'lineWidth') {\n            return 3;\n        }\n        if (property === 'shadow') {\n            return 4;\n        }\n        if (property === 'space') {\n            return 5;\n        }\n        if (property === 'hasNoneStyle') {\n            return 6;\n        }\n        return 0;\n    };\n    WUniqueFormat.getCharacterFormatPropertyType = function (property) {\n        if (property === 'fontColor') {\n            return 1;\n        }\n        if (property === 'fontFamily') {\n            return 2;\n        }\n        if (property === 'fontSize') {\n            return 3;\n        }\n        if (property === 'bold') {\n            return 4;\n        }\n        if (property === 'italic') {\n            return 5;\n        }\n        if (property === 'underline') {\n            return 6;\n        }\n        if (property === 'strikethrough') {\n            return 7;\n        }\n        if (property === 'baselineAlignment') {\n            return 8;\n        }\n        if (property === 'highlightColor') {\n            return 9;\n        }\n        return 0;\n    };\n    WUniqueFormat.getParaFormatPropertyType = function (property) {\n        if (property === 'leftIndent') {\n            return 1;\n        }\n        if (property === 'rightIndent') {\n            return 2;\n        }\n        if (property === 'firstLineIndent') {\n            return 3;\n        }\n        if (property === 'textAlignment') {\n            return 4;\n        }\n        if (property === 'beforeSpacing') {\n            return 5;\n        }\n        if (property === 'afterSpacing') {\n            return 6;\n        }\n        if (property === 'lineSpacing') {\n            return 7;\n        }\n        if (property === 'lineSpacingType') {\n            return 8;\n        }\n        if (property === 'outlineLevel') {\n            return 9;\n        }\n        return 0;\n    };\n    WUniqueFormat.getSectionFormatType = function (property) {\n        if (property === 'headerDistance') {\n            return 1;\n        }\n        if (property === 'footerDistance') {\n            return 2;\n        }\n        if (property === 'differentFirstPage') {\n            return 3;\n        }\n        if (property === 'differentOddAndEvenPages') {\n            return 4;\n        }\n        if (property === 'pageWidth') {\n            return 5;\n        }\n        if (property === 'pageHeight') {\n            return 6;\n        }\n        if (property === 'leftMargin') {\n            return 7;\n        }\n        if (property === 'topMargin') {\n            return 8;\n        }\n        if (property === 'rightMargin') {\n            return 9;\n        }\n        if (property === 'bottomMargin') {\n            return 10;\n        }\n        return 0;\n    };\n    /**\n     * @private\n     */\n    WUniqueFormat.prototype.isBorderEqual = function (source, modifiedProperty, modifiedValue) {\n        if (this.isNotEqual('color', source, modifiedProperty, modifiedValue, 1)) {\n            return false;\n        }\n        if (this.isNotEqual('lineStyle', source, modifiedProperty, modifiedValue, 1)) {\n            return false;\n        }\n        if (this.isNotEqual('lineWidth', source, modifiedProperty, modifiedValue, 1)) {\n            return false;\n        }\n        if (this.isNotEqual('shadow', source, modifiedProperty, modifiedValue, 1)) {\n            return false;\n        }\n        if (this.isNotEqual('space', source, modifiedProperty, modifiedValue, 1)) {\n            return false;\n        }\n        if (this.isNotEqual('hasNoneStyle', source, modifiedProperty, modifiedValue, 1)) {\n            return false;\n        }\n        return true;\n    };\n    /**\n     * @private\n     */\n    WUniqueFormat.prototype.isCharacterFormatEqual = function (source, modifiedProperty, modifiedValue) {\n        if (this.isNotEqual('fontColor', source, modifiedProperty, modifiedValue, 2)) {\n            return false;\n        }\n        if (this.isNotEqual('fontFamily', source, modifiedProperty, modifiedValue, 2)) {\n            return false;\n        }\n        if (this.isNotEqual('fontSize', source, modifiedProperty, modifiedValue, 2)) {\n            return false;\n        }\n        if (this.isNotEqual('bold', source, modifiedProperty, modifiedValue, 2)) {\n            return false;\n        }\n        if (this.isNotEqual('italic', source, modifiedProperty, modifiedValue, 2)) {\n            return false;\n        }\n        if (this.isNotEqual('underline', source, modifiedProperty, modifiedValue, 2)) {\n            return false;\n        }\n        if (this.isNotEqual('strikethrough', source, modifiedProperty, modifiedValue, 2)) {\n            return false;\n        }\n        if (this.isNotEqual('baselineAlignment', source, modifiedProperty, modifiedValue, 2)) {\n            return false;\n        }\n        if (this.isNotEqual('highlightColor', source, modifiedProperty, modifiedValue, 2)) {\n            return false;\n        }\n        return true;\n    };\n    WUniqueFormat.prototype.isParagraphFormatEqual = function (source, modifiedProperty, modifiedValue) {\n        if (this.isNotEqual('leftIndent', source, modifiedProperty, modifiedValue, 3)) {\n            return false;\n        }\n        if (this.isNotEqual('rightIndent', source, modifiedProperty, modifiedValue, 3)) {\n            return false;\n        }\n        if (this.isNotEqual('firstLineIndent', source, modifiedProperty, modifiedValue, 3)) {\n            return false;\n        }\n        if (this.isNotEqual('textAlignment', source, modifiedProperty, modifiedValue, 3)) {\n            return false;\n        }\n        if (this.isNotEqual('beforeSpacing', source, modifiedProperty, modifiedValue, 3)) {\n            return false;\n        }\n        if (this.isNotEqual('afterSpacing', source, modifiedProperty, modifiedValue, 3)) {\n            return false;\n        }\n        if (this.isNotEqual('lineSpacing', source, modifiedProperty, modifiedValue, 3)) {\n            return false;\n        }\n        if (this.isNotEqual('lineSpacingType', source, modifiedProperty, modifiedValue, 3)) {\n            return false;\n        }\n        if (this.isNotEqual('outlineLevel', source, modifiedProperty, modifiedValue, 3)) {\n            return false;\n        }\n        return true;\n    };\n    /**\n     * @private\n     */\n    WUniqueFormat.prototype.isCellFormatEqual = function (source, modifiedProperty, modifiedValue) {\n        if (this.isNotEqual('leftMargin', source, modifiedProperty, modifiedValue, 4)) {\n            return false;\n        }\n        if (this.isNotEqual('rightMargin', source, modifiedProperty, modifiedValue, 4)) {\n            return false;\n        }\n        if (this.isNotEqual('topMargin', source, modifiedProperty, modifiedValue, 4)) {\n            return false;\n        }\n        if (this.isNotEqual('bottomMargin', source, modifiedProperty, modifiedValue, 4)) {\n            return false;\n        }\n        if (this.isNotEqual('columnSpan', source, modifiedProperty, modifiedValue, 4)) {\n            return false;\n        }\n        if (this.isNotEqual('rowSpan', source, modifiedProperty, modifiedValue, 4)) {\n            return false;\n        }\n        if (this.isNotEqual('verticalAlignment', source, modifiedProperty, modifiedValue, 4)) {\n            return false;\n        }\n        if (this.isNotEqual('preferredWidthType', source, modifiedProperty, modifiedValue, 4)) {\n            return false;\n        }\n        if (this.isNotEqual('preferredWidth', source, modifiedProperty, modifiedValue, 4)) {\n            return false;\n        }\n        if (this.isNotEqual('cellWidth', source, modifiedProperty, modifiedValue, 4)) {\n            return false;\n        }\n        return true;\n    };\n    /**\n     * @private\n     */\n    WUniqueFormat.prototype.isShadingEqual = function (source, modifiedProperty, modifiedValue) {\n        if (this.isNotEqual('backgroundColor', source, modifiedProperty, modifiedValue, 5)) {\n            return false;\n        }\n        if (this.isNotEqual('foregroundColor', source, modifiedProperty, modifiedValue, 5)) {\n            return false;\n        }\n        if (this.isNotEqual('textureStyle', source, modifiedProperty, modifiedValue, 5)) {\n            return false;\n        }\n        return true;\n    };\n    /**\n     * @private\n     */\n    WUniqueFormat.prototype.isRowFormatEqual = function (source, modifiedProperty, modifiedValue) {\n        if (this.isNotEqual('allowBreakAcrossPages', source, modifiedProperty, modifiedValue, 6)) {\n            return false;\n        }\n        if (this.isNotEqual('isHeader', source, modifiedProperty, modifiedValue, 6)) {\n            return false;\n        }\n        if (this.isNotEqual('height', source, modifiedProperty, modifiedValue, 6)) {\n            return false;\n        }\n        if (this.isNotEqual('heightType', source, modifiedProperty, modifiedValue, 6)) {\n            return false;\n        }\n        if (this.isNotEqual('gridBefore', source, modifiedProperty, modifiedValue, 6)) {\n            return false;\n        }\n        if (this.isNotEqual('gridBeforeWidth', source, modifiedProperty, modifiedValue, 6)) {\n            return false;\n        }\n        if (this.isNotEqual('gridBeforeWidthType', source, modifiedProperty, modifiedValue, 6)) {\n            return false;\n        }\n        if (this.isNotEqual('gridAfter', source, modifiedProperty, modifiedValue, 6)) {\n            return false;\n        }\n        if (this.isNotEqual('gridAfterWidth', source, modifiedProperty, modifiedValue, 6)) {\n            return false;\n        }\n        if (this.isNotEqual('gridAfterWidthType', source, modifiedProperty, modifiedValue, 6)) {\n            return false;\n        }\n        return true;\n    };\n    /**\n     * @private\n     */\n    WUniqueFormat.prototype.isListFormatEqual = function (source, modifiedProperty, modifiedValue) {\n        if (this.isNotEqual('listId', source, modifiedProperty, modifiedValue, 7)) {\n            return false;\n        }\n        if (this.isNotEqual('listLevelNumber', source, modifiedProperty, modifiedValue, 7)) {\n            return false;\n        }\n        return true;\n    };\n    /**\n     * @private\n     */\n    WUniqueFormat.prototype.isTableFormatEqual = function (source, modifiedProperty, modifiedValue) {\n        if (this.isNotEqual('leftMargin', source, modifiedProperty, modifiedValue, 8)) {\n            return false;\n        }\n        if (this.isNotEqual('rightMargin', source, modifiedProperty, modifiedValue, 8)) {\n            return false;\n        }\n        if (this.isNotEqual('topMargin', source, modifiedProperty, modifiedValue, 8)) {\n            return false;\n        }\n        if (this.isNotEqual('bottomMargin', source, modifiedProperty, modifiedValue, 8)) {\n            return false;\n        }\n        if (this.isNotEqual('cellSpacing', source, modifiedProperty, modifiedValue, 8)) {\n            return false;\n        }\n        if (this.isNotEqual('leftIndent', source, modifiedProperty, modifiedValue, 8)) {\n            return false;\n        }\n        if (this.isNotEqual('tableAlignment', source, modifiedProperty, modifiedValue, 8)) {\n            return false;\n        }\n        if (this.isNotEqual('preferredWidth', source, modifiedProperty, modifiedValue, 8)) {\n            return false;\n        }\n        if (this.isNotEqual('preferredWidthType', source, modifiedProperty, modifiedValue, 8)) {\n            return false;\n        }\n        return true;\n    };\n    /**\n     * @private\n     */\n    WUniqueFormat.prototype.isListLevelEqual = function (source, modifiedProperty, modifiedValue) {\n        if (this.isNotEqual('listLevelPattern', source, modifiedProperty, modifiedValue, 9)) {\n            return false;\n        }\n        if (this.isNotEqual('startAt', source, modifiedProperty, modifiedValue, 9)) {\n            return false;\n        }\n        if (this.isNotEqual('followCharacter', source, modifiedProperty, modifiedValue, 9)) {\n            return false;\n        }\n        if (this.isNotEqual('numberFormat', source, modifiedProperty, modifiedValue, 9)) {\n            return false;\n        }\n        if (this.isNotEqual('restartLevel', source, modifiedProperty, modifiedValue, 9)) {\n            return false;\n        }\n        return true;\n    };\n    /**\n     * @private\n     */\n    WUniqueFormat.prototype.isSectionFormatEqual = function (source, modifiedProperty, modifiedValue) {\n        if (this.isNotEqual('headerDistance', source, modifiedProperty, modifiedValue, 10)) {\n            return false;\n        }\n        if (this.isNotEqual('footerDistance', source, modifiedProperty, modifiedValue, 10)) {\n            return false;\n        }\n        if (this.isNotEqual('differentFirstPage', source, modifiedProperty, modifiedValue, 10)) {\n            return false;\n        }\n        if (this.isNotEqual('differentOddAndEvenPages', source, modifiedProperty, modifiedValue, 10)) {\n            return false;\n        }\n        if (this.isNotEqual('pageWidth', source, modifiedProperty, modifiedValue, 10)) {\n            return false;\n        }\n        if (this.isNotEqual('pageHeight', source, modifiedProperty, modifiedValue, 10)) {\n            return false;\n        }\n        if (this.isNotEqual('leftMargin', source, modifiedProperty, modifiedValue, 10)) {\n            return false;\n        }\n        if (this.isNotEqual('topMargin', source, modifiedProperty, modifiedValue, 10)) {\n            return false;\n        }\n        if (this.isNotEqual('rightMargin', source, modifiedProperty, modifiedValue, 10)) {\n            return false;\n        }\n        if (this.isNotEqual('bottomMargin', source, modifiedProperty, modifiedValue, 10)) {\n            return false;\n        }\n        return true;\n    };\n    /**\n     * @private\n     */\n    WUniqueFormat.prototype.cloneItems = function (format, property, value, uniqueFormatType) {\n        var propertyType = WUniqueFormat.getPropertyType(uniqueFormatType, property);\n        var keys = format.propertiesHash.getItem();\n        for (var i = 0; i < keys.length; i++) {\n            if (keys[i] === propertyType) {\n                this.propertiesHash.add(propertyType, value);\n            }\n            else {\n                this.propertiesHash.add(keys[i], format.propertiesHash.get(keys[i]));\n            }\n        }\n        if (!format.propertiesHash.containsKey(propertyType)) {\n            this.propertiesHash.add(propertyType, value);\n        }\n    };\n    /**\n     * @private\n     */\n    WUniqueFormat.prototype.mergeProperties = function (format) {\n        var hash = format.cloneProperties();\n        var keys = this.propertiesHash.keys;\n        for (var i = 0; i < keys.length; i++) {\n            if (!hash.containsKey(keys[i])) {\n                hash.add(keys[i], this.propertiesHash.get(keys[i]));\n            }\n        }\n        return hash;\n    };\n    /**\n     * @private\n     */\n    WUniqueFormat.prototype.cloneProperties = function () {\n        var hash = new Dictionary();\n        var keys = this.propertiesHash.keys;\n        for (var i = 0; i < keys.length; i++) {\n            hash.add(keys[i], this.propertiesHash.get(keys[i]));\n        }\n        return hash;\n    };\n    // public cloneItemsInternal(format: WUniqueFormat): void {\n    //     let keys: number[] = format.propertiesHash.getItem();\n    //     for (let i: number = 0; i < keys.length; i++) {\n    //         this.propertiesHash.add(keys[i], format.propertiesHash.get(keys[i]));\n    //     }\n    //     this.referenceCount = format.referenceCount;\n    // }\n    /**\n     * @private\n     */\n    WUniqueFormat.prototype.destroy = function () {\n        if (!isNullOrUndefined(this.propertiesHash)) {\n            this.propertiesHash.destroy();\n        }\n        this.propertiesHash = undefined;\n        this.referenceCount = undefined;\n        this.uniqueFormatType = undefined;\n    };\n    return WUniqueFormat;\n}());\nexport { WUniqueFormat };\n","import { isNullOrUndefined } from '@syncfusion/ej2-base';\nimport { WUniqueFormat } from './unique-format';\n/**\n * @private\n */\nvar WUniqueFormats = /** @class */ (function () {\n    function WUniqueFormats() {\n        this.items = [];\n    }\n    /**\n     * @private\n     */\n    WUniqueFormats.prototype.addUniqueFormat = function (format, type) {\n        var matchedFormat = undefined;\n        for (var i = 0; i < this.items.length; i++) {\n            if (this.items[i].isEqual(format, undefined, undefined)) {\n                matchedFormat = this.items[i];\n                break;\n            }\n        }\n        if (isNullOrUndefined(matchedFormat)) {\n            matchedFormat = new WUniqueFormat(type);\n            matchedFormat.propertiesHash = format;\n            matchedFormat.referenceCount = 1;\n            this.items.push(matchedFormat);\n        }\n        else {\n            matchedFormat.referenceCount++;\n        }\n        return matchedFormat;\n    };\n    /**\n     * @private\n     */\n    WUniqueFormats.prototype.updateUniqueFormat = function (uniqueFormat, property, value) {\n        var matchedFormat = undefined;\n        for (var i = 0; i < this.items.length; i++) {\n            if (this.items[i].isEqual(uniqueFormat.propertiesHash, property, value)) {\n                matchedFormat = this.items[i];\n                break;\n            }\n        }\n        if (isNullOrUndefined(matchedFormat)) {\n            matchedFormat = new WUniqueFormat(uniqueFormat.uniqueFormatType);\n            matchedFormat.cloneItems(uniqueFormat, property, value, uniqueFormat.uniqueFormatType);\n            matchedFormat.referenceCount = 1;\n            this.items.push(matchedFormat);\n        }\n        else {\n            matchedFormat.referenceCount++;\n        }\n        this.remove(uniqueFormat);\n        uniqueFormat = undefined;\n        return matchedFormat;\n    };\n    /**\n     * @private\n     */\n    WUniqueFormats.prototype.remove = function (uniqueFormat) {\n        uniqueFormat.referenceCount--;\n        if (uniqueFormat.referenceCount <= 0) {\n            this.items.splice(this.items.indexOf(uniqueFormat), 1);\n            uniqueFormat.destroy();\n            uniqueFormat = undefined;\n        }\n    };\n    /**\n     * @private\n     */\n    WUniqueFormats.prototype.clear = function () {\n        if (isNullOrUndefined(this.items)) {\n            for (var i = 0; i < this.items.length; i++) {\n                this.items[i].destroy();\n            }\n        }\n        this.items = [];\n    };\n    /**\n     * @private\n     */\n    WUniqueFormats.prototype.destroy = function () {\n        this.clear();\n        this.items = undefined;\n    };\n    return WUniqueFormats;\n}());\nexport { WUniqueFormats };\n","var __extends = (this && this.__extends) || (function () {\n    var extendStatics = Object.setPrototypeOf ||\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nimport { Component, Property, NotifyPropertyChanges, Event } from '@syncfusion/ej2-base';\nimport { isNullOrUndefined, L10n, setCulture, Browser } from '@syncfusion/ej2-base';\nimport { Save } from '@syncfusion/ej2-file-utils';\nimport { LayoutViewer, PageLayoutViewer, BulletsAndNumberingDialog } from './index';\nimport { Print } from './index';\nimport { BodyWidget, ParagraphWidget } from './index';\nimport { WSectionFormat, WParagraphFormat, WCharacterFormat } from './index';\nimport { SfdtReader } from './index';\nimport { Selection } from './index';\nimport { Editor, EditorHistory } from './index';\nimport { WStyles } from './index';\nimport { Search } from './index';\nimport { OptionsPane } from './index';\nimport { WordExport } from './index';\nimport { TextExport } from './index';\nimport { ContextMenu } from './index';\nimport { ImageResizer } from './index';\nimport { SfdtExport } from './index';\nimport { HyperlinkDialog, TableDialog, BookmarkDialog, StylesDialog, TableOfContentsDialog } from './index';\nimport { PageSetupDialog, ParagraphDialog, ListDialog, StyleDialog, FontDialog } from './index';\nimport { TablePropertiesDialog, BordersAndShadingDialog, CellOptionsDialog, TableOptionsDialog } from './index';\n/**\n * The Document editor component is used to draft, save or print rich text contents as page by page.\n */\nvar DocumentEditor = /** @class */ (function (_super) {\n    __extends(DocumentEditor, _super);\n    /**\n     * Initialize the constructor of DocumentEditor\n     */\n    function DocumentEditor(options, element) {\n        var _this = _super.call(this, options, element) || this;\n        //Internal Variable\n        _this.enableHeaderFooterIn = false;\n        /**\n         * @private\n         */\n        _this.isShiftingEnabled = false;\n        /**\n         * @private\n         */\n        _this.isLayoutEnabled = true;\n        /**\n         * @private\n         */\n        _this.isPastingContent = false;\n        /**\n         * @private\n         */\n        _this.parser = undefined;\n        _this.disableHistoryIn = false;\n        /**\n         * @private\n         */\n        _this.findResultsList = undefined;\n        /**\n         * Gets or sets the name of the document.\n         */\n        _this.documentName = '';\n        /**\n         * @private\n         */\n        _this.tablePropertiesDialogModule = undefined;\n        /**\n         * @private\n         */\n        _this.bordersAndShadingDialogModule = undefined;\n        /**\n         * @private\n         */\n        _this.cellOptionsDialogModule = undefined;\n        /**\n         * @private\n         */\n        _this.tableOptionsDialogModule = undefined;\n        /**\n         * @private\n         */\n        _this.paragraphDialogModule = undefined;\n        /**\n         * @private\n         */\n        _this.imageResizerModule = undefined;\n        /**\n         * Gets or Sets a value indicating whether holding Ctrl key is required to follow hyperlink on click. The default value is true.\n         */\n        _this.useCtrlClickToFollowHyperlink = true;\n        /**\n         * Gets or sets the page outline color.\n         */\n        _this.pageOutline = '#000000';\n        /**\n         * Gets or sets a value indicating whether to enable cursor in document editor on read only state or not. The default value is false.\n         */\n        _this.enableCursorOnReadOnly = false;\n        /**\n         * Gets or sets a value indicating whether local paste needs to be enabled or not.\n         */\n        _this.enableLocalPaste = false;\n        /**\n         * @private\n         */\n        _this.defaultLocale = {\n            'Table': 'Table',\n            'Row': 'Row',\n            'Cell': 'Cell',\n            'Ok': 'Ok',\n            'Cancel': 'Cancel',\n            'Size': 'Size',\n            'Preferred Width': 'Preferred width',\n            'Points': 'Points',\n            'Percent': 'Percent',\n            'Measure in': 'Measure in',\n            'Alignment': 'Alignment',\n            'Left': 'Left',\n            'Center': 'Center',\n            'Right': 'Right',\n            'Justify': 'Justify',\n            'Indent from left': 'Indent from left',\n            'Borders and Shading': 'Borders and Shading',\n            'Options': 'Options',\n            'Specify height': 'Specify height',\n            'At least': 'At least',\n            'Exactly': 'Exactly',\n            'Row height is': 'Row height is',\n            'Allow row to break across pages': 'Allow row to break across pages',\n            'Repeat as header row at the top of each page': 'Repeat as header row at the top of each page',\n            'Vertical alignment': 'Vertical alignment',\n            'Top': 'Top',\n            'Bottom': 'Bottom',\n            'Default cell margins': 'Default cell margins',\n            'Default cell spacing': 'Default cell spacing',\n            'Allow spacing between cells': 'Allow spacing between cells',\n            'Cell margins': 'Cell margins',\n            'Same as the whole table': 'Same as the whole table',\n            'Borders': 'Borders',\n            'None': 'None',\n            'Single': 'Single',\n            'Dot': 'Dot',\n            'DashSmallGap': 'DashSmallGap',\n            'DashLargeGap': 'DashLargeGap',\n            'DashDot': 'DashDot',\n            'DashDotDot': 'DashDotDot',\n            'Double': 'Double',\n            'Triple': 'Triple',\n            'ThinThickSmallGap': 'ThinThickSmallGap',\n            'ThickThinSmallGap': 'ThickThinSmallGap',\n            'ThinThickThinSmallGap': 'ThinThickThinSmallGap',\n            'ThinThickMediumGap': 'ThinThickMediumGap',\n            'ThickThinMediumGap': 'ThickThinMediumGap',\n            'ThinThickThinMediumGap': 'ThinThickThinMediumGap',\n            'ThinThickLargeGap': 'ThinThickLargeGap',\n            'ThickThinLargeGap': 'ThickThinLargeGap',\n            'ThinThickThinLargeGap': 'ThinThickThinLargeGap',\n            'SingleWavy': 'SingleWavy',\n            'DoubleWavy': 'DoubleWavy',\n            'DashDotStroked': 'DashDotStroked',\n            'Emboss3D': 'Emboss3D',\n            'Engrave3D': 'Engrave3D',\n            'Outset': 'Outset',\n            'Inset': 'Inset',\n            'Thick': 'Thick',\n            'Style': 'Style',\n            'Width': 'Width',\n            'Height': 'Height',\n            'Letter': 'Letter',\n            'Tabloid': 'Tabloid',\n            'Legal': 'Legal',\n            'Statement': 'Statement',\n            'Executive': 'Executive',\n            'A3': 'A3',\n            'A4': 'A4',\n            'A5': 'A5',\n            'B4': 'B4',\n            'B5': 'B5',\n            'Custom Size': 'Custom size',\n            'Different odd and even': 'Different odd and even',\n            'Different first page': 'Different first page',\n            'From edge': 'From edge',\n            'Header': 'Header',\n            'Footer': 'Footer',\n            'Margin': 'Margins',\n            'Paper': 'Paper',\n            'Layout': 'Layout',\n            'Orientation': 'Orientation',\n            'Landscape': 'Landscape',\n            'Portrait': 'Portrait',\n            'Table Of Contents': 'Table Of Contents',\n            'Show page numbers': 'Show page numbers',\n            'Right align page numbers': 'Right align page numbers',\n            'Nothing': 'Nothing',\n            'Tab leader': 'Tab leader',\n            'Show levels': 'Show levels',\n            'Use hyperlinks instead of page numbers': 'Use hyperlinks instead of page numbers',\n            'Build table of contents from': 'Build table of contents from',\n            'Styles': 'Styles',\n            'Available styles': 'Available styles',\n            'TOC level': 'TOC level',\n            'Heading': 'Heading',\n            'List Paragraph': 'List Paragraph',\n            'Normal': 'Normal',\n            'Outline levels': 'Outline levels',\n            'Table entry fields': 'Table entry fields',\n            'Modify': 'Modify',\n            'Color': 'Color',\n            'Setting': 'Setting',\n            'Box': 'Box',\n            'All': 'All',\n            'Custom': 'Custom',\n            'Preview': 'Preview',\n            'Shading': 'Shading',\n            'Fill': 'Fill',\n            'Apply To': 'Apply to',\n            'Table Properties': 'Table Properties',\n            'Cell Options': 'Cell Options',\n            'Table Options': 'Table Options',\n            'Insert Table': 'Insert Table',\n            'Number of columns': 'Number of columns',\n            'Number of rows': 'Number of rows',\n            'Text to display': 'Text to display',\n            'Address': 'Address',\n            'Insert Hyperlink': 'Insert Hyperlink',\n            'Edit Hyperlink': 'Edit Hyperlink',\n            'Insert': 'Insert',\n            'General': 'General',\n            'Indentation': 'Indentation',\n            'Before text': 'Before text',\n            'Special': 'Special',\n            'First line': 'First line',\n            'Hanging': 'Hanging',\n            'After text': 'After text',\n            'By': 'By',\n            'Before': 'Before',\n            'Line Spacing': 'Line spacing',\n            'After': 'After',\n            'At': 'At',\n            'Multiple': 'Multiple',\n            'Spacing': 'Spacing',\n            'Define new Multilevel list': 'Define new Multilevel list',\n            'List level': 'List level',\n            'Choose level to modify': 'Choose level to modify',\n            'Level': 'Level',\n            'Number format': 'Number format',\n            'Number style for this level': 'Number style for this level',\n            'Enter formatting for number': 'Enter formatting for number',\n            'Start at': 'Start at',\n            'Restart list after': 'Restart list after',\n            'Position': 'Position',\n            'Text indent at': 'Text indent at',\n            'Aligned at': 'Aligned at',\n            'Follow number with': 'Follow number with',\n            'Tab character': 'Tab character',\n            'Space': 'Space',\n            'Arabic': 'Arabic',\n            'UpRoman': 'UpRoman',\n            'LowRoman': 'LowRoman',\n            'UpLetter': 'UpLetter',\n            'LowLetter': 'LowLetter',\n            'Number': 'Number',\n            'Leading zero': 'Leading zero',\n            'Bullet': 'Bullet',\n            'Ordinal': 'Ordinal',\n            'Ordinal Text': 'Ordinal Text',\n            'For East': 'For East',\n            'No Restart': 'No Restart',\n            'Font': 'Font',\n            'Font style': 'Font style',\n            'Underline style': 'Underline style',\n            'Font color': 'Font color',\n            'Effects': 'Effects',\n            'Strikethrough': 'Strikethrough',\n            'Superscript': 'Superscript',\n            'Subscript': 'Subscript',\n            'Double strikethrough': 'Double strikethrough',\n            'Regular': 'Regular',\n            'Bold': 'Bold',\n            'Italic': 'Italic',\n            'Cut': 'Cut',\n            'Copy': 'Copy',\n            'Paste': 'Paste',\n            'Hyperlink': 'Hyperlink',\n            'Open Hyperlink': 'Open Hyperlink',\n            'Copy Hyperlink': 'Copy Hyperlink',\n            'Remove Hyperlink': 'Remove Hyperlink',\n            'Paragraph': 'Paragraph',\n            'Merge Cells': 'Merge Cells',\n            'Insert Above': 'Insert Above',\n            'Insert Below': 'Insert Below',\n            'Insert Left': 'Insert Left',\n            'Insert Right': 'Insert Right',\n            'Delete': 'Delete',\n            'Delete Table': 'Delete Table',\n            'Delete Row': 'Delete Row',\n            'Delete Column': 'Delete Column',\n            'File Name': 'File Name',\n            'Format Type': 'Format Type',\n            'Save': 'Save',\n            'Navigation': 'Navigation',\n            'Results': 'Results',\n            'Replace': 'Replace',\n            'Replace All': 'Replace All',\n            'We replaced all': 'We replaced all',\n            'Find': 'Find',\n            'No matches': 'No matches',\n            'All Done': 'All Done',\n            'Result': 'Result',\n            'of': 'of',\n            'instances': 'instances',\n            'with': 'with',\n            'Click to follow link': 'Click to follow link',\n            'Continue Numbering': 'Continue Numbering',\n            'Bookmark name': 'Bookmark name',\n            'Close': 'Close',\n            'Restart At': 'Restart At',\n            'Properties': 'Properties',\n            'Name': 'Name',\n            'Style type': 'Style type',\n            'Style based on': 'Style based on',\n            'Style for following paragraph': 'Style for following paragraph',\n            'Formatting': 'Formatting',\n            'Numbering and Bullets': 'Numbering and Bullets',\n            'Numbering': 'Numbering',\n            'Update Field': 'Update Field',\n            'Edit Field': 'Edit Field',\n            'Bookmark': 'Bookmark',\n            'Page Setup': 'Page Setup',\n            'No bookmarks found': 'No bookmarks found',\n            'Number format tooltip information': 'Single-level number format: </br>[PREFIX]%[LEVELNUMBER][SUFFIX]</br>'\n                + 'For example, \"Chapter %1.\" will display numbering like</br>Chapter 1. Item</br>Chapter 2. Item</br>â€¦'\n                + '</br>Chapter N. Item</br>'\n                + '</br>Multilevel number format:</br>[PREFIX]%[LEVELNUMBER][SUFFIX]+[PREFIX]%[LEVELNUMBER][SUFFIX]'\n                + '</br>For example, \"%1.%2.\" will display numbering like</br>1.1. Item</br>1.2. Item</br>â€¦</br>1.N. Item',\n            'Format': 'Format',\n            'Create New Style': 'Create New Style',\n            'Modify Style': 'Modify Style',\n            'New': 'New',\n            'Bullets': 'Bullets',\n            'Use bookmarks': 'Use bookmarks',\n            'Table of Contents': 'Table of Contents'\n        };\n        _this.viewer = new PageLayoutViewer(_this);\n        _this.parser = new SfdtReader(_this.viewer);\n        return _this;\n    }\n    DocumentEditor_1 = DocumentEditor;\n    Object.defineProperty(DocumentEditor.prototype, \"enableHeaderAndFooter\", {\n        /**\n         * @private\n         */\n        get: function () {\n            return this.enableHeaderFooterIn;\n        },\n        set: function (value) {\n            this.enableHeaderFooterIn = value;\n            this.viewer.updateScrollBars();\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(DocumentEditor.prototype, \"pageCount\", {\n        /**\n         * Gets the total number of pages.\n         */\n        get: function () {\n            if (!this.isDocumentLoaded || isNullOrUndefined(this.viewer)) {\n                return 1;\n            }\n            return this.viewer.pages.length;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(DocumentEditor.prototype, \"selection\", {\n        /**\n         *  Gets the selection object of the document editor.\n         * @returns Selection\n         * @default undefined\n         */\n        get: function () {\n            return this.selectionModule;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(DocumentEditor.prototype, \"editor\", {\n        /**\n         *  Gets the editor object of the document editor.\n         * @returns Editor\n         * @default undefined\n         */\n        get: function () {\n            return this.editorModule;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(DocumentEditor.prototype, \"editorHistory\", {\n        /**\n         * Gets the editor history object of the document editor.\n         * @returns EditorHistory\n         */\n        get: function () {\n            return this.editorHistoryModule;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(DocumentEditor.prototype, \"search\", {\n        /**\n         * Gets the search object of the document editor.\n         * @returns { Search }\n         */\n        get: function () {\n            return this.searchModule;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(DocumentEditor.prototype, \"contextMenu\", {\n        /**\n         * Gets the context menu object of the document editor.\n         * @returns ContextMenu\n         */\n        get: function () {\n            return this.contextMenuModule;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(DocumentEditor.prototype, \"containerId\", {\n        /**\n         * @private\n         */\n        get: function () {\n            return this.element.id;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(DocumentEditor.prototype, \"isDocumentLoaded\", {\n        /**\n         * @private\n         */\n        get: function () {\n            return this.isDocumentLoadedIn;\n        },\n        set: function (value) {\n            this.isDocumentLoadedIn = value;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(DocumentEditor.prototype, \"enableHistoryMode\", {\n        /**\n         * Determines whether history needs to be enabled or not.\n         * @default - false\n         * @private\n         */\n        get: function () {\n            return this.enableEditorHistory && !isNullOrUndefined(this.editorHistoryModule);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(DocumentEditor.prototype, \"documentStart\", {\n        /**\n         * Gets the start text position in the document.\n         * @default undefined\n         * @private\n         */\n        get: function () {\n            if (!isNullOrUndefined(this.selectionModule)) {\n                return this.selection.getDocumentStart();\n            }\n            return undefined;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(DocumentEditor.prototype, \"documentEnd\", {\n        /**\n         * Gets the end text position in the document.\n         * @default undefined\n         * @private\n         */\n        get: function () {\n            if (!isNullOrUndefined(this.selectionModule)) {\n                return this.selection.getDocumentEnd();\n            }\n            return undefined;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(DocumentEditor.prototype, \"isReadOnlyMode\", {\n        /**\n         * @private\n         */\n        get: function () {\n            return this.isReadOnly || isNullOrUndefined(this.editorModule) || isNullOrUndefined(this.selectionModule);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(DocumentEditor.prototype, \"enableImageResizerMode\", {\n        /**\n         * Specifies to enable image resizer option\n         * default - false\n         * @private\n         */\n        get: function () {\n            return this.enableImageResizer && !isNullOrUndefined(this.imageResizerModule);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    DocumentEditor.prototype.preRender = function () {\n        this.findResultsList = [];\n        //pre render section\n    };\n    DocumentEditor.prototype.render = function () {\n        this.viewer.initializeComponents();\n        this.openBlank();\n        if (!isNullOrUndefined(this.element)) {\n            var container = this.element;\n            container.style.minHeight = '200px';\n            container.style.minWidth = '200px';\n        }\n    };\n    /**\n     * Get component name\n     * @private\n     */\n    DocumentEditor.prototype.getModuleName = function () {\n        return 'DocumentEditor';\n    };\n    /**\n     * Called internally if any of the property value changed.\n     * @private\n     */\n    DocumentEditor.prototype.onPropertyChanged = function (model, oldProp) {\n        for (var _i = 0, _a = Object.keys(model); _i < _a.length; _i++) {\n            var prop = _a[_i];\n            switch (prop) {\n                case 'zoomFactor':\n                    if (this.viewer) {\n                        this.viewer.zoomFactor = model.zoomFactor;\n                    }\n                    break;\n                case 'locale':\n                    this.localizeDialogs();\n                    break;\n                case 'isReadOnly':\n                    if (!isNullOrUndefined(this.optionsPaneModule) && this.optionsPaneModule.isOptionsPaneShow) {\n                        this.optionsPaneModule.showHideOptionsPane(false);\n                    }\n                    break;\n            }\n        }\n    };\n    DocumentEditor.prototype.localizeDialogs = function () {\n        if (this.locale !== '') {\n            var l10n = new L10n('documenteditor', this.defaultLocale);\n            l10n.setLocale(this.locale);\n            setCulture(this.locale);\n            if (this.optionsPaneModule) {\n                this.optionsPaneModule.initOptionsPane(l10n);\n            }\n            if (this.paragraphDialogModule) {\n                this.paragraphDialogModule.initParagraphDialog(l10n);\n            }\n            if (this.pageSetupDialogModule) {\n                this.pageSetupDialogModule.initPageSetupDialog(l10n);\n            }\n            if (this.fontDialogModule) {\n                this.fontDialogModule.initFontDialog(l10n);\n            }\n            if (this.hyperlinkDialogModule) {\n                this.hyperlinkDialogModule.initHyperlinkDialog(l10n);\n            }\n            if (this.contextMenuModule) {\n                this.contextMenuModule.initContextMenu(l10n);\n            }\n            if (this.listDialogModule) {\n                this.listDialogModule.initListDialog(l10n);\n            }\n            if (this.tablePropertiesDialogModule) {\n                this.tablePropertiesDialogModule.initTablePropertyDialog(l10n);\n            }\n            if (this.bordersAndShadingDialogModule) {\n                this.bordersAndShadingDialogModule.initBordersAndShadingsDialog(l10n);\n            }\n            if (this.cellOptionsDialogModule) {\n                this.cellOptionsDialogModule.initCellMarginsDialog(l10n);\n            }\n            if (this.tableOptionsDialogModule) {\n                this.tableOptionsDialogModule.initTableOptionsDialog(l10n);\n            }\n            if (this.tableDialogModule) {\n                this.tableDialogModule.initTableDialog(l10n);\n            }\n            if (this.styleDialogModule) {\n                this.styleDialogModule.initStyleDialog(l10n);\n            }\n            if (this.tableOfContentsDialogModule) {\n                this.tableOfContentsDialogModule.initTableOfContentDialog(l10n);\n            }\n        }\n    };\n    /**\n     * Get the properties to be maintained in the persisted state.\n     * @private\n     */\n    DocumentEditor.prototype.getPersistData = function () {\n        return 'documenteditor';\n    };\n    DocumentEditor.prototype.clearPreservedCollectionsInViewer = function () {\n        if (this.viewer instanceof LayoutViewer) {\n            this.viewer.clearDocumentItems();\n        }\n    };\n    /**\n     * @private\n     */\n    DocumentEditor.prototype.getDocumentEditorElement = function () {\n        return this.element;\n    };\n    /**\n     * @private\n     */\n    DocumentEditor.prototype.fireContentChange = function () {\n        var eventArgs = { source: this };\n        this.trigger('contentChange', eventArgs);\n    };\n    /**\n     * @private\n     */\n    DocumentEditor.prototype.fireDocumentChange = function () {\n        var eventArgs = { source: this };\n        this.trigger('documentChange', eventArgs);\n    };\n    /**\n     * @private\n     */\n    DocumentEditor.prototype.fireSelectionChange = function () {\n        if (!this.viewer.isCompositionStart && Browser.isDevice && this.editorModule) {\n            this.editorModule.predictText();\n        }\n        var eventArgs = { source: this };\n        this.trigger('selectionChange', eventArgs);\n    };\n    /**\n     * @private\n     */\n    DocumentEditor.prototype.fireZoomFactorChange = function () {\n        var eventArgs = { source: this };\n        this.trigger('zoomFactorChange', eventArgs);\n    };\n    /**\n     * @private\n     */\n    DocumentEditor.prototype.fireViewChange = function () {\n        if (this.viewer && this.viewer.pages.length > 0) {\n            if (this.viewer.visiblePages.length > 0) {\n                var pages = this.viewer.visiblePages;\n                var eventArgs = {\n                    startPage: pages[0].index + 1,\n                    endPage: pages[pages.length - 1].index + 1,\n                    source: this\n                };\n                this.trigger('viewChange', eventArgs);\n            }\n        }\n    };\n    /**\n     * Shows the Paragraph dialog\n     * @private\n     */\n    DocumentEditor.prototype.showParagraphDialog = function (paragraphFormat) {\n        if (this.paragraphDialogModule && !this.isReadOnlyMode && this.viewer) {\n            this.paragraphDialogModule.show(paragraphFormat);\n        }\n    };\n    /**\n     * Shows the margin dialog\n     * @private\n     */\n    DocumentEditor.prototype.showPageSetupDialog = function () {\n        if (this.pageSetupDialogModule && !this.isReadOnlyMode && this.viewer) {\n            this.pageSetupDialogModule.show();\n        }\n    };\n    /**\n     * Shows the font dialog\n     * @private\n     */\n    DocumentEditor.prototype.showFontDialog = function (characterFormat) {\n        if (this.fontDialogModule && !this.isReadOnlyMode && this.viewer) {\n            this.fontDialogModule.showFontDialog(characterFormat);\n        }\n    };\n    /**\n     * Shows the cell option dialog\n     * @private\n     */\n    DocumentEditor.prototype.showCellOptionsDialog = function () {\n        if (this.cellOptionsDialogModule && !this.isReadOnlyMode && this.viewer) {\n            this.cellOptionsDialogModule.show();\n        }\n    };\n    /**\n     * Shows the table options dialog.\n     * @private\n     */\n    DocumentEditor.prototype.showTableOptionsDialog = function () {\n        if (this.tableOptionsDialogModule && !this.isReadOnlyMode && this.viewer) {\n            this.tableOptionsDialogModule.show();\n        }\n    };\n    /**\n     * Shows insert table dialog\n     * @private\n     */\n    DocumentEditor.prototype.showTableDialog = function () {\n        if (this.tableDialogModule && !this.isReadOnlyMode && this.viewer) {\n            this.tableDialogModule.show();\n        }\n    };\n    /**\n     * Shows the table of content dialog\n     * @private\n     */\n    DocumentEditor.prototype.showTableOfContentsDialog = function () {\n        if (this.tableOfContentsDialogModule && !this.isReadOnlyMode && this.viewer) {\n            this.tableOfContentsDialogModule.show();\n        }\n    };\n    /* tslint:enable:no-any */\n    /**\n     * Shows the style dialog\n     * @private\n     */\n    DocumentEditor.prototype.showStyleDialog = function () {\n        if (this.styleDialogModule && !this.isReadOnlyMode && this.viewer) {\n            this.styleDialogModule.show();\n        }\n    };\n    /**\n     * Shows the hyperlink dialog\n     * @private\n     */\n    DocumentEditor.prototype.showHyperlinkDialog = function () {\n        if (this.hyperlinkDialogModule && !this.isReadOnlyMode && this.viewer) {\n            this.hyperlinkDialogModule.show();\n        }\n    };\n    /**\n     * Shows the bookmark dialog.\n     * @private\n     */\n    DocumentEditor.prototype.showBookmarkDialog = function () {\n        if (this.bookmarkDialogModule && !this.isReadOnlyMode && this.viewer) {\n            this.bookmarkDialogModule.show();\n        }\n    };\n    /**\n     * Shows the styles dialog.\n     * @private\n     */\n    DocumentEditor.prototype.showStylesDialog = function () {\n        if (this.stylesDialogModule && !this.isReadOnlyMode && this.viewer) {\n            this.stylesDialogModule.show();\n        }\n    };\n    /**\n     * Shows the List dialog\n     * @private\n     */\n    DocumentEditor.prototype.showListDialog = function () {\n        if (this.listDialogModule && !this.isReadOnlyMode && this.viewer) {\n            this.listDialogModule.showListDialog();\n        }\n    };\n    /**\n     * Shows the table properties dialog\n     * @private\n     */\n    DocumentEditor.prototype.showTablePropertiesDialog = function () {\n        if (this.tablePropertiesDialogModule && !this.isReadOnlyMode && this.viewer) {\n            this.tablePropertiesDialogModule.show();\n        }\n    };\n    /**\n     * Shows the borders and shading dialog\n     * @private\n     */\n    DocumentEditor.prototype.showBordersAndShadingDialog = function () {\n        if (this.bordersAndShadingDialogModule && !this.isReadOnlyMode && this.viewer) {\n            this.bordersAndShadingDialogModule.show();\n        }\n    };\n    //tslint:disable: max-func-body-length\n    DocumentEditor.prototype.requiredModules = function () {\n        var modules = [];\n        if (this.enablePrint) {\n            modules.push({\n                member: 'Print', args: []\n            });\n        }\n        if (this.enableSfdtExport || this.enableWordExport || this.enableTextExport || this.enableSelection || this.enableEditor) {\n            modules.push({\n                member: 'SfdtExport', args: [this.viewer]\n            });\n        }\n        if (this.enableWordExport) {\n            modules.push({\n                member: 'WordExport', args: []\n            });\n        }\n        if (this.enableTextExport) {\n            modules.push({\n                member: 'TextExport', args: []\n            });\n        }\n        if (this.enableSelection || this.enableSearch || this.enableEditor) {\n            modules.push({\n                member: 'Selection', args: [this]\n            });\n            if (this.enableContextMenu) {\n                modules.push({\n                    member: 'ContextMenu', args: [this.viewer]\n                });\n            }\n        }\n        if (this.enableSearch) {\n            modules.push({\n                member: 'Search', args: [this]\n            });\n            if (this.enableOptionsPane) {\n                modules.push({\n                    member: 'OptionsPane', args: [this.viewer]\n                });\n            }\n        }\n        if (this.enableEditor) {\n            modules.push({\n                member: 'Editor', args: [this.viewer]\n            });\n            if (this.enableImageResizer) {\n                modules.push({\n                    member: 'ImageResizer', args: [this, this.viewer]\n                });\n            }\n            if (this.enableEditorHistory) {\n                modules.push({\n                    member: 'EditorHistory', args: [this]\n                });\n            }\n            if (this.enableHyperlinkDialog) {\n                modules.push({\n                    member: 'HyperlinkDialog', args: [this.viewer]\n                });\n            }\n            if (this.enableTableDialog) {\n                modules.push({\n                    member: 'TableDialog', args: [this.viewer]\n                });\n            }\n            if (this.enableBookmarkDialog) {\n                modules.push({\n                    member: 'BookmarkDialog', args: [this.viewer]\n                });\n            }\n            if (this.enableTableOfContentsDialog) {\n                modules.push({\n                    member: 'TableOfContentsDialog', args: [this.viewer]\n                });\n            }\n            if (this.enablePageSetupDialog) {\n                modules.push({\n                    member: 'PageSetupDialog', args: [this.viewer]\n                });\n            }\n            if (this.enableStyleDialog) {\n                modules.push({\n                    member: 'StylesDialog', args: [this.viewer]\n                });\n                modules.push({\n                    member: 'StyleDialog', args: [this.viewer]\n                });\n                modules.push({\n                    member: 'BulletsAndNumberingDialog', args: [this.viewer]\n                });\n            }\n            if (this.enableListDialog) {\n                modules.push({\n                    member: 'ListDialog', args: [this.viewer]\n                });\n            }\n            if (this.enableParagraphDialog) {\n                modules.push({\n                    member: 'ParagraphDialog', args: [this.viewer]\n                });\n            }\n            if (this.enableFontDialog) {\n                modules.push({\n                    member: 'FontDialog', args: [this.viewer]\n                });\n            }\n            if (this.enableTablePropertiesDialog) {\n                modules.push({\n                    member: 'TablePropertiesDialog', args: [this.viewer]\n                });\n                modules.push({\n                    member: 'CellOptionsDialog', args: [this.viewer]\n                });\n            }\n            if (this.enableBordersAndShadingDialog) {\n                modules.push({\n                    member: 'BordersAndShadingDialog', args: [this.viewer]\n                });\n            }\n            if (this.enableTableOptionsDialog) {\n                modules.push({\n                    member: 'TableOptionsDialog', args: [this.viewer]\n                });\n            }\n        }\n        return modules;\n    };\n    // Public Implementation Starts\n    /**\n     * Opens the given Sfdt text.\n     * @param {string} sfdtText.\n     */\n    DocumentEditor.prototype.open = function (sfdtText) {\n        if (!isNullOrUndefined(this.viewer)) {\n            this.clearPreservedCollectionsInViewer();\n            this.viewer.lists = [];\n            this.viewer.abstractLists = [];\n            this.viewer.styles = new WStyles();\n            if (!isNullOrUndefined(sfdtText) && this.viewer) {\n                this.viewer.onDocumentChanged(this.parser.convertJsonToDocument(sfdtText));\n                if (this.editorModule) {\n                    this.editorModule.intializeDefaultStyles();\n                }\n            }\n        }\n    };\n    /**\n     * Scrolls view to start of the given page number if exists.\n     * @param  {number} pageNumber.\n     * @returns void\n     */\n    DocumentEditor.prototype.scrollToPage = function (pageNumber) {\n        if (isNullOrUndefined(this.viewer) || pageNumber < 1 || pageNumber > this.viewer.pages.length) {\n            return false;\n        }\n        this.viewer.scrollToPage(pageNumber - 1);\n        return true;\n    };\n    /**\n     * Enables all the modules.\n     * @returns void\n     */\n    DocumentEditor.prototype.enableAllModules = function () {\n        this.enablePrint = this.enableSfdtExport = this.enableWordExport = this.enableTextExport\n            = this.enableSelection = this.enableContextMenu = this.enableSearch = this.enableOptionsPane\n                = this.enableEditor = this.enableImageResizer = this.enableEditorHistory\n                    = this.enableHyperlinkDialog = this.enableTableDialog = this.enableBookmarkDialog\n                        = this.enableTableOfContentsDialog = this.enablePageSetupDialog = this.enableStyleDialog\n                            = this.enableListDialog = this.enableParagraphDialog = this.enableFontDialog\n                                = this.enableTablePropertiesDialog = this.enableBordersAndShadingDialog\n                                    = this.enableTableOptionsDialog = true;\n        // tslint:disable-next-line:max-line-length\n        DocumentEditor_1.Inject(Print, SfdtExport, WordExport, TextExport, Selection, Search, Editor, ImageResizer, EditorHistory, ContextMenu, OptionsPane, HyperlinkDialog, TableDialog, BookmarkDialog, TableOfContentsDialog, PageSetupDialog, StyleDialog, ListDialog, ParagraphDialog, BulletsAndNumberingDialog, FontDialog, TablePropertiesDialog, BordersAndShadingDialog, TableOptionsDialog, CellOptionsDialog, StylesDialog);\n    };\n    /**\n     * Resizes the component and its sub elements based on given size or container size.\n     * @param width\n     * @param height\n     */\n    DocumentEditor.prototype.resize = function (width, height) {\n        if (this.element) {\n            if (!isNullOrUndefined(width) && width > 200) {\n                this.element.style.width = width + 'px';\n            }\n            if (!isNullOrUndefined(height) && height > 200) {\n                this.element.style.height = height + 'px';\n            }\n            if (this.viewer) {\n                this.viewer.updateViewerSize();\n            }\n        }\n    };\n    /**\n     * Shifts the focus to the document.\n     */\n    DocumentEditor.prototype.focusIn = function () {\n        if (this.viewer) {\n            this.viewer.updateFocus();\n        }\n    };\n    /**\n     * Fits the page based on given fit type.\n     * @param  {PageFitType} pageFitType? - Default value of â€˜pageFitTypeâ€™ parameter is 'None'\n     * @returns void\n     */\n    DocumentEditor.prototype.fitPage = function (pageFitType) {\n        if (isNullOrUndefined(pageFitType)) {\n            pageFitType = 'None';\n        }\n        if (this.viewer) {\n            this.viewer.pageFitType = pageFitType;\n        }\n    };\n    /**\n     * Prints the document.\n     * @param  {Window} printWindow? - Default value of 'printWindow' parameter is undefined.\n     */\n    DocumentEditor.prototype.print = function (printWindow) {\n        if (isNullOrUndefined(this.viewer)) {\n            throw new Error('Invalid operation.');\n        }\n        if (this.printModule) {\n            this.printModule.print(this.viewer, printWindow);\n        }\n        else {\n            throw new Error('Invalid operation. Print is not enabled.');\n        }\n    };\n    /**\n     * Serialize the data to JSON string.\n     */\n    DocumentEditor.prototype.serialize = function () {\n        var json = '';\n        if (this.enableSfdtExport && this.sfdtExportModule instanceof SfdtExport) {\n            json = this.sfdtExportModule.serialize();\n        }\n        else {\n            throw new Error('Invalid operation. Sfdt export is not enabled.');\n        }\n        return json;\n    };\n    /**\n     * Saves the document.\n     * @param {string} fileName\n     * @param {FormatType} formatType\n     */\n    DocumentEditor.prototype.save = function (fileName, formatType) {\n        fileName = fileName || 'Untitled';\n        if (isNullOrUndefined(this.viewer)) {\n            throw new Error('Invalid operation.');\n        }\n        if (formatType === 'Docx' && this.wordExportModule) {\n            if (this.wordExportModule) {\n                this.wordExportModule.save(this.viewer, fileName);\n            }\n        }\n        else if (formatType === 'Txt' && this.textExportModule) {\n            this.textExportModule.save(this.viewer, fileName);\n        }\n        else if (formatType === 'Sfdt' && this.enableSfdtExport && this.sfdtExportModule) {\n            var jsonString = this.serialize();\n            var blob = new Blob([jsonString], {\n                type: 'application/json'\n            });\n            Save.save(fileName + '.sfdt', blob);\n        }\n        else {\n            throw new Error('Invalid operation. Specified export is not enabled.');\n        }\n    };\n    /**\n     * Saves the document as blob.\n     * @param {FormatType} formatType\n     */\n    DocumentEditor.prototype.saveAsBlob = function (formatType) {\n        var _this = this;\n        if (isNullOrUndefined(this.viewer)) {\n            throw new Error('Invalid operation');\n        }\n        return new Promise(function (resolve, reject) {\n            if (formatType === 'Docx' && _this.wordExportModule) {\n                resolve(_this.wordExportModule.saveAsBlob(_this.viewer));\n            }\n            else if (formatType === 'Txt' && _this.textExportModule) {\n                resolve(_this.textExportModule.saveAsBlob(_this.viewer));\n            }\n            else if (formatType === 'Sfdt' && _this.enableSfdtExport && _this.sfdtExportModule) {\n                resolve(_this.sfdtExportModule.saveAsBlob(_this.viewer));\n            }\n        });\n    };\n    /**\n     * Opens a blank document.\n     */\n    DocumentEditor.prototype.openBlank = function () {\n        var section = new BodyWidget();\n        section.index = 0;\n        section.sectionFormat = new WSectionFormat(section);\n        var paragraph = new ParagraphWidget();\n        paragraph.index = 0;\n        paragraph.paragraphFormat = new WParagraphFormat(paragraph);\n        paragraph.characterFormat = new WCharacterFormat(paragraph);\n        section.childWidgets.push(paragraph);\n        paragraph.containerWidget = section;\n        var sections = [];\n        sections.push(section);\n        // tslint:disable-next-line:max-line-length\n        var hfs = this.parser.parseHeaderFooter({ header: {}, footer: {}, evenHeader: {}, evenFooter: {}, firstPageHeader: {}, firstPageFooter: {} }, undefined);\n        if (this.viewer) {\n            this.clearPreservedCollectionsInViewer();\n            this.viewer.headersFooters.push(hfs);\n            this.viewer.onDocumentChanged(sections);\n            if (this.editorModule) {\n                this.editorModule.intializeDefaultStyles();\n                var style = this.viewer.styles.findByName('Normal');\n                paragraph.paragraphFormat.baseStyle = style;\n                paragraph.paragraphFormat.listFormat.baseStyle = style;\n            }\n        }\n    };\n    /**\n     * Gets the style names based on given style type.\n     * @param styleType\n     */\n    DocumentEditor.prototype.getStyleNames = function (styleType) {\n        if (this.viewer) {\n            return this.viewer.styles.getStyleNames(styleType);\n        }\n        return [];\n    };\n    /**\n     * Gets the style objects on given style type.\n     * @param styleType\n     */\n    DocumentEditor.prototype.getStyles = function (styleType) {\n        if (this.viewer) {\n            return this.viewer.styles.getStyles(styleType);\n        }\n        return [];\n    };\n    /**\n     * Shows the dialog.\n     * @param {DialogType} dialogType\n     * @returns void\n     */\n    DocumentEditor.prototype.showDialog = function (dialogType) {\n        switch (dialogType) {\n            case 'Hyperlink':\n                this.showHyperlinkDialog();\n                break;\n            case 'Table':\n                this.showTableDialog();\n                break;\n            case 'Bookmark':\n                this.showBookmarkDialog();\n                break;\n            case 'TableOfContents':\n                this.showTableOfContentsDialog();\n                break;\n            case 'PageSetup':\n                this.showPageSetupDialog();\n                break;\n            case 'List':\n                this.showListDialog();\n                break;\n            case 'Styles':\n                this.showStylesDialog();\n                break;\n            case 'Style':\n                this.showStyleDialog();\n                break;\n            case 'Paragraph':\n                this.showParagraphDialog();\n                break;\n            case 'Font':\n                this.showFontDialog();\n                break;\n            case 'TableProperties':\n                this.showTablePropertiesDialog();\n                break;\n            case 'BordersAndShading':\n                this.showBordersAndShadingDialog();\n                break;\n            case 'TableOptions':\n                this.showTableOptionsDialog();\n                break;\n        }\n    };\n    /**\n     * Shows the options pane.\n     */\n    DocumentEditor.prototype.showOptionsPane = function () {\n        if (!isNullOrUndefined(this.optionsPaneModule) && !isNullOrUndefined(this.viewer)) {\n            this.optionsPaneModule.showHideOptionsPane(true);\n        }\n    };\n    /**\n     * Destroys all managed resources used by this object.\n     */\n    DocumentEditor.prototype.destroy = function () {\n        _super.prototype.destroy.call(this);\n        this.destroyDependentModules();\n        if (!isNullOrUndefined(this.viewer)) {\n            this.viewer.destroy();\n        }\n        this.viewer = undefined;\n        if (!isNullOrUndefined(this.element)) {\n            this.element.classList.remove('e-documenteditor');\n            this.element.innerHTML = '';\n        }\n        this.element = undefined;\n        this.findResultsList = [];\n        this.findResultsList = undefined;\n    };\n    DocumentEditor.prototype.destroyDependentModules = function () {\n        if (this.printModule) {\n            this.printModule.destroy();\n            this.printModule = undefined;\n        }\n        if (this.sfdtExportModule) {\n            this.sfdtExportModule.destroy();\n            this.sfdtExportModule = undefined;\n        }\n        if (this.optionsPaneModule) {\n            this.optionsPaneModule.destroy();\n            this.optionsPaneModule = undefined;\n        }\n        if (!isNullOrUndefined(this.hyperlinkDialogModule)) {\n            this.hyperlinkDialogModule.destroy();\n            this.hyperlinkDialogModule = undefined;\n        }\n        if (this.searchModule) {\n            this.searchModule.destroy();\n            this.searchModule = undefined;\n        }\n        if (this.contextMenuModule) {\n            this.contextMenuModule.destroy();\n            this.contextMenuModule = undefined;\n        }\n        if (this.editorModule) {\n            this.editorModule.destroy();\n            this.editorModule = undefined;\n        }\n        if (this.selectionModule) {\n            this.selectionModule.destroy();\n            this.selectionModule = undefined;\n        }\n        if (this.editorHistoryModule) {\n            this.editorHistoryModule.destroy();\n            this.editorHistoryModule = undefined;\n        }\n        if (!isNullOrUndefined(this.paragraphDialogModule)) {\n            this.paragraphDialogModule.destroy();\n            this.paragraphDialogModule = undefined;\n        }\n        if (this.pageSetupDialogModule) {\n            this.pageSetupDialogModule.destroy();\n            this.pageSetupDialogModule = undefined;\n        }\n        if (this.fontDialogModule) {\n            this.fontDialogModule.destroy();\n            this.fontDialogModule = undefined;\n        }\n        if (this.listDialogModule) {\n            this.listDialogModule.destroy();\n            this.listDialogModule = undefined;\n        }\n        if (this.imageResizerModule) {\n            this.imageResizerModule.destroy();\n            this.imageResizerModule = undefined;\n        }\n        if (this.tablePropertiesDialogModule) {\n            this.tablePropertiesDialogModule.destroy();\n            this.tablePropertiesDialogModule = undefined;\n        }\n        if (this.bordersAndShadingDialogModule) {\n            this.bordersAndShadingDialogModule.destroy();\n            this.bordersAndShadingDialogModule = undefined;\n        }\n        if (this.cellOptionsDialogModule) {\n            this.cellOptionsDialogModule.destroy();\n            this.cellOptionsDialogModule = undefined;\n        }\n        if (this.tableOptionsDialogModule) {\n            this.tableOptionsDialogModule.destroy();\n            this.tableOptionsDialogModule = undefined;\n        }\n        if (this.tableDialogModule) {\n            this.tableDialogModule.destroy();\n            this.tableDialogModule = undefined;\n        }\n        if (this.styleDialogModule) {\n            this.styleDialogModule = undefined;\n        }\n        if (this.bookmarkDialogModule) {\n            this.bookmarkDialogModule.destroy();\n            this.bookmarkDialogModule = undefined;\n        }\n        if (this.styleDialogModule) {\n            this.styleDialogModule.destroy();\n            this.styleDialogModule = undefined;\n        }\n        if (this.textExportModule) {\n            this.textExportModule.destroy();\n            this.textExportModule = undefined;\n        }\n        if (this.wordExportModule) {\n            this.wordExportModule.destroy();\n            this.wordExportModule = undefined;\n        }\n        if (this.tableOfContentsDialogModule) {\n            this.tableOfContentsDialogModule.destroy();\n            this.tableOfContentsDialogModule = undefined;\n        }\n    };\n    __decorate([\n        Property(1)\n    ], DocumentEditor.prototype, \"zoomFactor\", void 0);\n    __decorate([\n        Property(true)\n    ], DocumentEditor.prototype, \"isReadOnly\", void 0);\n    __decorate([\n        Property(false)\n    ], DocumentEditor.prototype, \"enablePrint\", void 0);\n    __decorate([\n        Property(false)\n    ], DocumentEditor.prototype, \"enableSelection\", void 0);\n    __decorate([\n        Property(false)\n    ], DocumentEditor.prototype, \"enableEditor\", void 0);\n    __decorate([\n        Property(false)\n    ], DocumentEditor.prototype, \"enableEditorHistory\", void 0);\n    __decorate([\n        Property(false)\n    ], DocumentEditor.prototype, \"enableSfdtExport\", void 0);\n    __decorate([\n        Property(false)\n    ], DocumentEditor.prototype, \"enableWordExport\", void 0);\n    __decorate([\n        Property(false)\n    ], DocumentEditor.prototype, \"enableTextExport\", void 0);\n    __decorate([\n        Property(false)\n    ], DocumentEditor.prototype, \"enableOptionsPane\", void 0);\n    __decorate([\n        Property(false)\n    ], DocumentEditor.prototype, \"enableContextMenu\", void 0);\n    __decorate([\n        Property(false)\n    ], DocumentEditor.prototype, \"enableHyperlinkDialog\", void 0);\n    __decorate([\n        Property(false)\n    ], DocumentEditor.prototype, \"enableBookmarkDialog\", void 0);\n    __decorate([\n        Property(false)\n    ], DocumentEditor.prototype, \"enableTableOfContentsDialog\", void 0);\n    __decorate([\n        Property(false)\n    ], DocumentEditor.prototype, \"enableSearch\", void 0);\n    __decorate([\n        Property(false)\n    ], DocumentEditor.prototype, \"enableParagraphDialog\", void 0);\n    __decorate([\n        Property(false)\n    ], DocumentEditor.prototype, \"enableListDialog\", void 0);\n    __decorate([\n        Property(false)\n    ], DocumentEditor.prototype, \"enableTablePropertiesDialog\", void 0);\n    __decorate([\n        Property(false)\n    ], DocumentEditor.prototype, \"enableBordersAndShadingDialog\", void 0);\n    __decorate([\n        Property(false)\n    ], DocumentEditor.prototype, \"enablePageSetupDialog\", void 0);\n    __decorate([\n        Property(false)\n    ], DocumentEditor.prototype, \"enableStyleDialog\", void 0);\n    __decorate([\n        Property(false)\n    ], DocumentEditor.prototype, \"enableFontDialog\", void 0);\n    __decorate([\n        Property(false)\n    ], DocumentEditor.prototype, \"enableTableOptionsDialog\", void 0);\n    __decorate([\n        Property(false)\n    ], DocumentEditor.prototype, \"enableTableDialog\", void 0);\n    __decorate([\n        Property(false)\n    ], DocumentEditor.prototype, \"enableImageResizer\", void 0);\n    __decorate([\n        Event()\n    ], DocumentEditor.prototype, \"documentChange\", void 0);\n    __decorate([\n        Event()\n    ], DocumentEditor.prototype, \"viewChange\", void 0);\n    __decorate([\n        Event()\n    ], DocumentEditor.prototype, \"zoomFactorChange\", void 0);\n    __decorate([\n        Event()\n    ], DocumentEditor.prototype, \"selectionChange\", void 0);\n    __decorate([\n        Event()\n    ], DocumentEditor.prototype, \"requestNavigate\", void 0);\n    __decorate([\n        Event()\n    ], DocumentEditor.prototype, \"contentChange\", void 0);\n    __decorate([\n        Event()\n    ], DocumentEditor.prototype, \"keyDown\", void 0);\n    __decorate([\n        Event()\n    ], DocumentEditor.prototype, \"searchResultsChange\", void 0);\n    __decorate([\n        Event()\n    ], DocumentEditor.prototype, \"created\", void 0);\n    __decorate([\n        Event()\n    ], DocumentEditor.prototype, \"destroyed\", void 0);\n    DocumentEditor = DocumentEditor_1 = __decorate([\n        NotifyPropertyChanges\n    ], DocumentEditor);\n    return DocumentEditor;\n    var DocumentEditor_1;\n}(Component));\nexport { DocumentEditor };\n","import { isNullOrUndefined } from '@syncfusion/ej2-base';\n/**\n * Print class\n */\nvar Print = /** @class */ (function () {\n    function Print() {\n    }\n    /**\n     * Gets module name.\n     */\n    Print.prototype.getModuleName = function () {\n        return 'Print';\n    };\n    /**\n     * Prints the current viewer\n     * @param viewer\n     * @param printWindow\n     * @private\n     */\n    Print.prototype.print = function (viewer, printWindow) {\n        this.printWindow(viewer, navigator.userAgent, printWindow);\n    };\n    /**\n     * Opens print window and displays current page to print.\n     * @private\n     */\n    Print.prototype.printWindow = function (viewer, browserUserAgent, printWindow) {\n        var height = this.getPageHeight(viewer.pages);\n        var width = this.getPageWidth(viewer.pages);\n        var printElement = document.createElement('div');\n        printElement.style.width = '100%';\n        printElement.style.height = '100%';\n        printElement.style.overflow = 'scroll';\n        // Rendering canvas to print\n        this.generatePrintContent(viewer, printElement);\n        if (isNullOrUndefined(printWindow)) {\n            printWindow = window.open('', 'print', 'height=452,width=1024,tabbar=no');\n        }\n        if ((browserUserAgent.indexOf('Chrome') !== -1) || (browserUserAgent.indexOf('Firefox')) !== -1) {\n            // Chrome and Firefox\n            printWindow.document.write('<!DOCTYPE html>');\n            // tslint:disable-next-line:max-line-length\n            printWindow.document.write('<html moznomarginboxes mozdisallowselectionprint><head><style>html, body { height: 100 %; } img { height: 100 %; width: 100 %; display: block;}img { box-sizing: border-box; }br, button { display: none; }@page{ margin: 0cm; size:' + width.toString() + 'px ' + height.toString() + 'px; }@media print{ body { margin: 0cm; }</style></head> <body><center>');\n        }\n        else {\n            // Internet Explorer and Edge\n            // tslint:disable-next-line:max-line-length\n            printWindow.document.write('<html><head><style>@page{margin:0;size:' + width.toString() + 'px ' + height.toString() + 'px;}</style></head><body><center>');\n        }\n        // tslint:disable-next-line:max-line-length\n        printWindow.document.write(printElement.innerHTML + '</center><script> (function() { window.ready = true; })(); </script></body></html>');\n        printElement = undefined;\n        printWindow.document.close();\n        printWindow.focus();\n        var interval = setInterval(function () {\n            if (printWindow.ready) {\n                printWindow.print();\n                printWindow.close();\n                clearInterval(interval);\n            }\n        }, 500);\n    };\n    /**\n     * Generates print content.\n     * @private\n     */\n    Print.prototype.generatePrintContent = function (viewer, element) {\n        // Rendering canvas to print\n        var htmlString = '';\n        for (var i = 0; i < viewer.pages.length; i++) {\n            var page = viewer.pages[i];\n            var pageHeight = page.boundingRectangle.height;\n            var pageWidth = page.boundingRectangle.width;\n            viewer.render.isPrinting = true;\n            viewer.render.renderWidgets(page, 0, 0, 0, 0);\n            var canvasURL = viewer.render.pageCanvas.toDataURL();\n            viewer.render.isPrinting = false;\n            // tslint:disable-next-line:max-line-length\n            htmlString += '<div><img src=' + canvasURL + ' style=\"margin:0px;display:block;width: ' + pageWidth.toString() + 'px; height:' + pageHeight.toString() + 'px; \"/></div><br/>';\n        }\n        element.innerHTML = htmlString;\n    };\n    /**\n     * Gets page width.\n     * @param pages\n     * @private\n     */\n    Print.prototype.getPageWidth = function (pages) {\n        var width = 0;\n        for (var i = 0; i < pages.length; i++) {\n            if (width < pages[i].boundingRectangle.width) {\n                width = pages[i].boundingRectangle.width;\n            }\n        }\n        return width;\n    };\n    /**\n     *  Gets page height.\n     * @private\n     */\n    Print.prototype.getPageHeight = function (pages) {\n        var height = 0;\n        for (var i = 0; i < pages.length; i++) {\n            if (height < pages[i].boundingRectangle.height) {\n                height = pages[i].boundingRectangle.height;\n            }\n        }\n        return height;\n    };\n    /**\n     * @private\n     */\n    Print.prototype.destroy = function () {\n        return;\n    };\n    return Print;\n}());\nexport { Print };\n","import { isNullOrUndefined } from '@syncfusion/ej2-base';\nimport { Dictionary } from '../../base/dictionary';\nimport { WUniqueFormat } from '../../base/unique-format';\nimport { WUniqueFormats } from '../../base/unique-formats';\n/**\n * @private\n */\nvar WSectionFormat = /** @class */ (function () {\n    function WSectionFormat(node) {\n        this.uniqueSectionFormat = undefined;\n        this.ownerBase = node;\n    }\n    Object.defineProperty(WSectionFormat.prototype, \"headerDistance\", {\n        get: function () {\n            return this.getPropertyValue('headerDistance');\n        },\n        set: function (value) {\n            this.setPropertyValue('headerDistance', value);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(WSectionFormat.prototype, \"footerDistance\", {\n        get: function () {\n            return this.getPropertyValue('footerDistance');\n        },\n        set: function (value) {\n            this.setPropertyValue('footerDistance', value);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(WSectionFormat.prototype, \"differentFirstPage\", {\n        get: function () {\n            return this.getPropertyValue('differentFirstPage');\n        },\n        set: function (value) {\n            this.setPropertyValue('differentFirstPage', value);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(WSectionFormat.prototype, \"differentOddAndEvenPages\", {\n        get: function () {\n            return this.getPropertyValue('differentOddAndEvenPages');\n        },\n        set: function (value) {\n            this.setPropertyValue('differentOddAndEvenPages', value);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(WSectionFormat.prototype, \"pageHeight\", {\n        get: function () {\n            return this.getPropertyValue('pageHeight');\n        },\n        set: function (value) {\n            this.setPropertyValue('pageHeight', value);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(WSectionFormat.prototype, \"rightMargin\", {\n        get: function () {\n            return this.getPropertyValue('rightMargin');\n        },\n        set: function (value) {\n            this.setPropertyValue('rightMargin', value);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(WSectionFormat.prototype, \"pageWidth\", {\n        get: function () {\n            return this.getPropertyValue('pageWidth');\n        },\n        set: function (value) {\n            this.setPropertyValue('pageWidth', value);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(WSectionFormat.prototype, \"leftMargin\", {\n        get: function () {\n            return this.getPropertyValue('leftMargin');\n        },\n        set: function (value) {\n            this.setPropertyValue('leftMargin', value);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(WSectionFormat.prototype, \"bottomMargin\", {\n        get: function () {\n            return this.getPropertyValue('bottomMargin');\n        },\n        set: function (value) {\n            this.setPropertyValue('bottomMargin', value);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(WSectionFormat.prototype, \"topMargin\", {\n        get: function () {\n            return this.getPropertyValue('topMargin');\n        },\n        set: function (value) {\n            this.setPropertyValue('topMargin', value);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    WSectionFormat.prototype.destroy = function () {\n        if (!isNullOrUndefined(this.uniqueSectionFormat)) {\n            WSectionFormat.uniqueSectionFormats.remove(this.uniqueSectionFormat);\n        }\n        this.uniqueSectionFormat = undefined;\n    };\n    WSectionFormat.prototype.hasValue = function (property) {\n        if (!isNullOrUndefined(this.uniqueSectionFormat)) {\n            var propertyType = WUniqueFormat.getPropertyType(this.uniqueSectionFormat.uniqueFormatType, property);\n            return this.uniqueSectionFormat.propertiesHash.containsKey(propertyType);\n        }\n        return false;\n    };\n    WSectionFormat.getPropertyDefaultValue = function (property) {\n        var value = undefined;\n        switch (property) {\n            case 'headerDistance':\n                value = 36;\n                break;\n            case 'footerDistance':\n                value = 36;\n                break;\n            case 'differentFirstPage':\n                value = false;\n                break;\n            case 'differentOddAndEvenPages':\n                value = false;\n                break;\n            case 'pageWidth':\n                value = 612;\n                break;\n            case 'pageHeight':\n                value = 792;\n                break;\n            case 'leftMargin':\n                value = 72;\n                break;\n            case 'topMargin':\n                value = 72;\n                break;\n            case 'rightMargin':\n                value = 72;\n                break;\n            case 'bottomMargin':\n                value = 72;\n                break;\n        }\n        return value;\n    };\n    WSectionFormat.prototype.getPropertyValue = function (property) {\n        var hasValue = this.hasValue(property);\n        if (hasValue) {\n            var propertyType = WUniqueFormat.getPropertyType(WSectionFormat.uniqueFormatType, property);\n            if (!isNullOrUndefined(this.uniqueSectionFormat) && this.uniqueSectionFormat.propertiesHash.containsKey(propertyType)) {\n                return this.uniqueSectionFormat.propertiesHash.get(propertyType);\n            }\n        }\n        return WSectionFormat.getPropertyDefaultValue(property);\n    };\n    WSectionFormat.prototype.setPropertyValue = function (property, value) {\n        if (isNullOrUndefined(value) || value === '') {\n            value = WSectionFormat.getPropertyDefaultValue(property);\n        }\n        if (isNullOrUndefined(this.uniqueSectionFormat)) {\n            this.initializeUniqueSectionFormat(property, value);\n        }\n        else {\n            var propertyType = WUniqueFormat.getPropertyType(this.uniqueSectionFormat.uniqueFormatType, property);\n            if (this.uniqueSectionFormat.propertiesHash.containsKey(propertyType) &&\n                this.uniqueSectionFormat.propertiesHash.get(propertyType) === value) {\n                //Do nothing, since no change in property value and return\n                return;\n            }\n            // tslint:disable-next-line:max-line-length\n            this.uniqueSectionFormat = WSectionFormat.uniqueSectionFormats.updateUniqueFormat(this.uniqueSectionFormat, property, value);\n        }\n    };\n    WSectionFormat.prototype.initializeUniqueSectionFormat = function (property, propValue) {\n        var uniqueSectionFormatTemp = new Dictionary();\n        this.addUniqueSectionFormat('headerDistance', property, propValue, uniqueSectionFormatTemp);\n        this.addUniqueSectionFormat('footerDistance', property, propValue, uniqueSectionFormatTemp);\n        this.addUniqueSectionFormat('differentFirstPage', property, propValue, uniqueSectionFormatTemp);\n        this.addUniqueSectionFormat('differentOddAndEvenPages', property, propValue, uniqueSectionFormatTemp);\n        this.addUniqueSectionFormat('pageWidth', property, propValue, uniqueSectionFormatTemp);\n        this.addUniqueSectionFormat('pageHeight', property, propValue, uniqueSectionFormatTemp);\n        this.addUniqueSectionFormat('leftMargin', property, propValue, uniqueSectionFormatTemp);\n        this.addUniqueSectionFormat('topMargin', property, propValue, uniqueSectionFormatTemp);\n        this.addUniqueSectionFormat('rightMargin', property, propValue, uniqueSectionFormatTemp);\n        this.addUniqueSectionFormat('bottomMargin', property, propValue, uniqueSectionFormatTemp);\n        // tslint:disable-next-line:max-line-length\n        this.uniqueSectionFormat = WSectionFormat.uniqueSectionFormats.addUniqueFormat(uniqueSectionFormatTemp, WSectionFormat.uniqueFormatType);\n    };\n    // tslint:disable-next-line:max-line-length\n    WSectionFormat.prototype.addUniqueSectionFormat = function (property, modifiedProperty, propValue, uniqueSectionFormatTemp) {\n        var propertyType;\n        propertyType = WUniqueFormat.getPropertyType(WSectionFormat.uniqueFormatType, property);\n        if (property === modifiedProperty) {\n            uniqueSectionFormatTemp.add(propertyType, propValue);\n        }\n        else {\n            uniqueSectionFormatTemp.add(propertyType, WSectionFormat.getPropertyDefaultValue(property));\n        }\n    };\n    WSectionFormat.prototype.copyFormat = function (format, history) {\n        if (history && (history.isUndoing || history.isRedoing)) {\n            this.uniqueSectionFormat = format.uniqueSectionFormat;\n        }\n        else {\n            if (!isNullOrUndefined(format)) {\n                if (!isNullOrUndefined(format.uniqueSectionFormat) && format.uniqueSectionFormat.propertiesHash) {\n                    this.updateUniqueSectionFormat(format);\n                }\n            }\n        }\n    };\n    WSectionFormat.prototype.updateUniqueSectionFormat = function (format) {\n        var hash = undefined;\n        if (this.uniqueSectionFormat) {\n            hash = this.uniqueSectionFormat.mergeProperties(format.uniqueSectionFormat);\n            if (this.uniqueSectionFormat.referenceCount === 0) {\n                WSectionFormat.uniqueSectionFormats.remove(this.uniqueSectionFormat);\n                this.uniqueSectionFormat = undefined;\n            }\n        }\n        this.uniqueSectionFormat = new WUniqueFormat(WSectionFormat.uniqueFormatType);\n        if (isNullOrUndefined(hash)) {\n            hash = this.uniqueSectionFormat.mergeProperties(format.uniqueSectionFormat);\n        }\n        this.uniqueSectionFormat = WSectionFormat.uniqueSectionFormats.addUniqueFormat(hash, WSectionFormat.uniqueFormatType);\n    };\n    WSectionFormat.prototype.cloneFormat = function () {\n        var format = new WSectionFormat();\n        format.uniqueSectionFormat = this.uniqueSectionFormat;\n        return format;\n    };\n    WSectionFormat.clear = function () {\n        this.uniqueSectionFormats.clear();\n    };\n    WSectionFormat.uniqueSectionFormats = new WUniqueFormats();\n    WSectionFormat.uniqueFormatType = 10;\n    return WSectionFormat;\n}());\nexport { WSectionFormat };\n","import { isNullOrUndefined } from '@syncfusion/ej2-base';\n/**\n * @private\n */\nvar WLevelOverride = /** @class */ (function () {\n    function WLevelOverride() {\n    }\n    WLevelOverride.prototype.destroy = function () {\n        if (!isNullOrUndefined(this.overrideListLevel)) {\n            this.overrideListLevel.destroy();\n        }\n        this.levelNumber = undefined;\n        this.startAt = undefined;\n        this.overrideListLevel = undefined;\n    };\n    return WLevelOverride;\n}());\nexport { WLevelOverride };\n","import { isNullOrUndefined } from '@syncfusion/ej2-base';\nimport { WLevelOverride } from './level-override';\n/**\n * @private\n */\nvar WList = /** @class */ (function () {\n    function WList() {\n        this.listId = -1;\n        this.sourceListId = -1;\n        this.abstractListId = -1;\n        this.abstractList = undefined;\n        this.levelOverrides = [];\n    }\n    WList.prototype.getListLevel = function (levelNumber) {\n        var listLevel = undefined;\n        var levelOverride = this.getLevelOverride(levelNumber);\n        if (!isNullOrUndefined(levelOverride) && !isNullOrUndefined(levelOverride.overrideListLevel)) {\n            listLevel = levelOverride.overrideListLevel;\n        }\n        else {\n            listLevel = this.abstractList.levels[levelNumber];\n        }\n        return listLevel;\n    };\n    WList.prototype.getLevelOverride = function (levelNumber) {\n        for (var i = 0; i < this.levelOverrides.length; i++) {\n            if (this.levelOverrides[i] instanceof WLevelOverride) {\n                var levelOverride = this.levelOverrides[i];\n                if (levelOverride.levelNumber === levelNumber) {\n                    return levelOverride;\n                }\n            }\n        }\n        return undefined;\n    };\n    WList.prototype.destroy = function () {\n        if (!isNullOrUndefined(this.levelOverrides)) {\n            this.levelOverrides = [];\n        }\n        this.abstractListId = undefined;\n        this.listId = undefined;\n        this.sourceListId = undefined;\n        this.levelOverrides = undefined;\n    };\n    WList.prototype.mergeList = function (list) {\n        if (!isNullOrUndefined(this.abstractListId) && this.abstractListId !== -1) {\n            this.abstractListId = list.abstractListId;\n        }\n        if (!isNullOrUndefined(this.listId) && this.listId !== -1) {\n            this.listId = list.listId;\n        }\n        if (!isNullOrUndefined(this.sourceListId) && this.sourceListId !== -1) {\n            this.sourceListId = list.sourceListId;\n        }\n        if (!isNullOrUndefined(this.levelOverrides) && this.levelOverrides.length !== 0) {\n            this.levelOverrides = list.levelOverrides;\n        }\n    };\n    return WList;\n}());\nexport { WList };\n","import { isNullOrUndefined } from '@syncfusion/ej2-base';\nimport { Dictionary } from '../../base/dictionary';\nimport { WUniqueFormat } from '../../base/unique-format';\nimport { WUniqueFormats } from '../../base/unique-formats';\nimport { WParagraphStyle } from './style';\nimport { WList } from '../list/list';\n/**\n * @private\n */\nvar WListFormat = /** @class */ (function () {\n    function WListFormat(node) {\n        this.uniqueListFormat = undefined;\n        this.ownerBase = undefined;\n        this.baseStyle = undefined;\n        this.list = undefined;\n        this.ownerBase = node;\n    }\n    Object.defineProperty(WListFormat.prototype, \"listId\", {\n        get: function () {\n            return this.getPropertyValue('listId');\n        },\n        set: function (listId) {\n            this.setPropertyValue('listId', listId);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(WListFormat.prototype, \"listLevelNumber\", {\n        get: function () {\n            return this.getPropertyValue('listLevelNumber');\n        },\n        set: function (value) {\n            this.setPropertyValue('listLevelNumber', value);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(WListFormat.prototype, \"listLevel\", {\n        get: function () {\n            var list = undefined;\n            if (!isNullOrUndefined(this.list)) {\n                list = this.list;\n            }\n            else {\n                /* tslint:disable-next-line:no-any */\n                var baseListStyle = this.baseStyle;\n                while (!isNullOrUndefined(baseListStyle)) {\n                    if (baseListStyle.paragraphFormat.listFormat.list) {\n                        list = baseListStyle.paragraphFormat.listFormat.list;\n                        break;\n                    }\n                    else {\n                        baseListStyle = baseListStyle.basedOn;\n                    }\n                }\n            }\n            if (!isNullOrUndefined(list)) {\n                return list.getListLevel(this.listLevelNumber);\n            }\n            else {\n                return undefined;\n            }\n        },\n        enumerable: true,\n        configurable: true\n    });\n    WListFormat.prototype.getPropertyValue = function (property) {\n        if (!this.hasValue(property)) {\n            if (this.baseStyle instanceof WParagraphStyle) {\n                /* tslint:disable-next-line:no-any */\n                var baseStyle = this.baseStyle;\n                while (!isNullOrUndefined(baseStyle)) {\n                    if (baseStyle.paragraphFormat.listFormat.hasValue(property)) {\n                        break;\n                    }\n                    else {\n                        baseStyle = baseStyle.basedOn;\n                    }\n                }\n                if (!isNullOrUndefined(baseStyle)) {\n                    var propertyType = WUniqueFormat.getPropertyType(WListFormat.uniqueFormatType, property);\n                    return baseStyle.paragraphFormat.listFormat.uniqueListFormat.propertiesHash.get(propertyType);\n                }\n            }\n        }\n        else {\n            var propertyType = WUniqueFormat.getPropertyType(WListFormat.uniqueFormatType, property);\n            if (!isNullOrUndefined(this.uniqueListFormat) && this.uniqueListFormat.propertiesHash.containsKey(propertyType)) {\n                return this.uniqueListFormat.propertiesHash.get(propertyType);\n            }\n        }\n        return WListFormat.getPropertyDefaultValue(property);\n    };\n    WListFormat.prototype.setPropertyValue = function (property, value) {\n        if (isNullOrUndefined(value) || value === '') {\n            value = WListFormat.getPropertyDefaultValue(property);\n        }\n        if (isNullOrUndefined(this.uniqueListFormat)) {\n            this.initializeUniqueListFormat(property, value);\n        }\n        else {\n            var propertyType = WUniqueFormat.getPropertyType(this.uniqueListFormat.uniqueFormatType, property);\n            if (this.uniqueListFormat.propertiesHash.containsKey(propertyType) &&\n                this.uniqueListFormat.propertiesHash.get(propertyType) === value) {\n                //Do nothing, since no change in property value and return\n                return;\n            }\n            this.uniqueListFormat = WListFormat.uniqueListFormats.updateUniqueFormat(this.uniqueListFormat, property, value);\n        }\n    };\n    WListFormat.prototype.initializeUniqueListFormat = function (property, propValue) {\n        var uniqueListFormatTemp = new Dictionary();\n        this.addUniqueListFormat('listId', property, propValue, uniqueListFormatTemp);\n        this.addUniqueListFormat('listLevelNumber', property, propValue, uniqueListFormatTemp);\n        this.uniqueListFormat = WListFormat.uniqueListFormats.addUniqueFormat(uniqueListFormatTemp, WListFormat.uniqueFormatType);\n    };\n    // tslint:disable-next-line:max-line-length\n    WListFormat.prototype.addUniqueListFormat = function (property, modifiedProperty, propValue, uniqueListFormatTemp) {\n        var propertyType;\n        propertyType = WUniqueFormat.getPropertyType(WListFormat.uniqueFormatType, property);\n        if (property === modifiedProperty) {\n            uniqueListFormatTemp.add(propertyType, propValue);\n        }\n    };\n    WListFormat.getPropertyDefaultValue = function (property) {\n        var value = undefined;\n        switch (property) {\n            case 'listId':\n                value = -1;\n                break;\n            case 'listLevelNumber':\n                value = 0;\n                break;\n        }\n        return value;\n    };\n    WListFormat.prototype.copyFormat = function (format) {\n        if (!isNullOrUndefined(format)) {\n            if (!isNullOrUndefined(format.uniqueListFormat)) {\n                this.listId = format.listId;\n                this.listLevelNumber = format.listLevelNumber;\n            }\n            if (!isNullOrUndefined(format.baseStyle)) {\n                this.baseStyle = format.baseStyle;\n            }\n            if (!isNullOrUndefined(format.list)) {\n                this.list = format.list;\n            }\n        }\n    };\n    WListFormat.prototype.hasValue = function (property) {\n        if (!isNullOrUndefined(this.uniqueListFormat)) {\n            var propertyType = WUniqueFormat.getPropertyType(this.uniqueListFormat.uniqueFormatType, property);\n            return this.uniqueListFormat.propertiesHash.containsKey(propertyType);\n        }\n        return false;\n    };\n    WListFormat.prototype.clearFormat = function () {\n        if (!isNullOrUndefined(this.uniqueListFormat) && this.uniqueListFormat.referenceCount === 0) {\n            WListFormat.uniqueListFormats.remove(this.uniqueListFormat);\n        }\n        this.uniqueListFormat = undefined;\n        this.list = undefined;\n    };\n    WListFormat.prototype.destroy = function () {\n        this.clearFormat();\n    };\n    WListFormat.clear = function () {\n        this.uniqueListFormats.clear();\n    };\n    WListFormat.prototype.ApplyStyle = function (baseStyle) {\n        this.baseStyle = baseStyle;\n    };\n    /**\n     * For internal use\n     * @private\n     */\n    WListFormat.prototype.getValue = function (property) {\n        return this.hasValue(property) ? this.getPropertyValue(property) : undefined;\n    };\n    /**\n     * For internal use\n     * @private\n     */\n    WListFormat.prototype.mergeFormat = function (format) {\n        if (isNullOrUndefined(this.getValue('listId'))) {\n            this.listId = format.getValue('listId');\n        }\n        if (isNullOrUndefined(this.getValue('listLevelNumber'))) {\n            this.listLevelNumber = format.getValue('listLevelNumber');\n        }\n        if (!isNullOrUndefined(format.list)) {\n            if (isNullOrUndefined(this.list)) {\n                this.list = new WList();\n            }\n            this.list.mergeList(format.list);\n        }\n    };\n    WListFormat.uniqueListFormats = new WUniqueFormats();\n    WListFormat.uniqueFormatType = 7;\n    return WListFormat;\n}());\nexport { WListFormat };\n","import { isNullOrUndefined } from '@syncfusion/ej2-base';\nimport { Dictionary } from '../../base/dictionary';\nimport { WUniqueFormat } from '../../base/unique-format';\nimport { WUniqueFormats } from '../../base/unique-formats';\nimport { WListFormat } from './list-format';\nimport { WParagraphStyle } from './style';\n/**\n * @private\n */\nvar WTabStop = /** @class */ (function () {\n    function WTabStop() {\n    }\n    Object.defineProperty(WTabStop.prototype, \"position\", {\n        get: function () {\n            return this.positionIn;\n        },\n        set: function (value) {\n            this.positionIn = value;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(WTabStop.prototype, \"deletePosition\", {\n        get: function () {\n            return this.deletePositionIn;\n        },\n        set: function (value) {\n            this.deletePositionIn = value;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(WTabStop.prototype, \"tabJustification\", {\n        get: function () {\n            return this.justification;\n        },\n        set: function (value) {\n            this.justification = value;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(WTabStop.prototype, \"tabLeader\", {\n        get: function () {\n            return this.leader;\n        },\n        set: function (value) {\n            this.leader = value;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    WTabStop.prototype.destroy = function () {\n        this.position = undefined;\n        this.deletePosition = undefined;\n        this.tabJustification = undefined;\n        this.leader = undefined;\n    };\n    return WTabStop;\n}());\nexport { WTabStop };\n/**\n * @private\n */\nvar WParagraphFormat = /** @class */ (function () {\n    function WParagraphFormat(node) {\n        this.uniqueParagraphFormat = undefined;\n        this.ownerBase = undefined;\n        this.baseStyle = undefined;\n        this.tabs = undefined;\n        this.ownerBase = node;\n        this.listFormat = new WListFormat(this);\n        this.tabs = [];\n    }\n    WParagraphFormat.prototype.getUpdatedTabs = function () {\n        var inTabs = [];\n        if (!isNullOrUndefined(this.baseStyle)) {\n            /* tslint:disable-next-line:no-any */\n            var baseStyle = this.baseStyle;\n            var tabStops = new Dictionary();\n            while (!isNullOrUndefined(baseStyle)) {\n                for (var _i = 0, _a = baseStyle.paragraphFormat.tabs; _i < _a.length; _i++) {\n                    var tab = _a[_i];\n                    if (!tabStops.containsKey(tab.position)) {\n                        tabStops.add(tab.position, tab);\n                    }\n                }\n                baseStyle = baseStyle.basedOn;\n            }\n            for (var _b = 0, _c = tabStops.keys; _b < _c.length; _b++) {\n                var key = _c[_b];\n                if (!this.hasTabStop(key)) {\n                    inTabs.push(tabStops.get(key));\n                }\n            }\n            inTabs = inTabs.concat(this.tabs.filter(function (a) { return (a.position !== 0 && a.deletePosition === 0); }));\n            inTabs = inTabs.sort(function (a, b) { return a.position - b.position; });\n        }\n        return inTabs;\n    };\n    WParagraphFormat.prototype.hasTabStop = function (position) {\n        for (var i = 0; i < this.tabs.length; i++) {\n            if (this.tabs[i].deletePosition === position) {\n                return true;\n            }\n        }\n        return false;\n    };\n    Object.defineProperty(WParagraphFormat.prototype, \"leftIndent\", {\n        get: function () {\n            return this.getPropertyValue('leftIndent');\n        },\n        set: function (value) {\n            this.setPropertyValue('leftIndent', value);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(WParagraphFormat.prototype, \"rightIndent\", {\n        get: function () {\n            return this.getPropertyValue('rightIndent');\n        },\n        set: function (value) {\n            this.setPropertyValue('rightIndent', value);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(WParagraphFormat.prototype, \"firstLineIndent\", {\n        get: function () {\n            return this.getPropertyValue('firstLineIndent');\n        },\n        set: function (value) {\n            this.setPropertyValue('firstLineIndent', value);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(WParagraphFormat.prototype, \"beforeSpacing\", {\n        get: function () {\n            return this.getPropertyValue('beforeSpacing');\n        },\n        set: function (value) {\n            this.setPropertyValue('beforeSpacing', value);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(WParagraphFormat.prototype, \"afterSpacing\", {\n        get: function () {\n            return this.getPropertyValue('afterSpacing');\n        },\n        set: function (value) {\n            this.setPropertyValue('afterSpacing', value);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(WParagraphFormat.prototype, \"lineSpacing\", {\n        get: function () {\n            return this.getPropertyValue('lineSpacing');\n        },\n        set: function (value) {\n            this.setPropertyValue('lineSpacing', value);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(WParagraphFormat.prototype, \"lineSpacingType\", {\n        get: function () {\n            return this.getPropertyValue('lineSpacingType');\n        },\n        set: function (value) {\n            this.setPropertyValue('lineSpacingType', value);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(WParagraphFormat.prototype, \"textAlignment\", {\n        get: function () {\n            return this.getPropertyValue('textAlignment');\n        },\n        set: function (value) {\n            this.setPropertyValue('textAlignment', value);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(WParagraphFormat.prototype, \"outlineLevel\", {\n        get: function () {\n            return this.getPropertyValue('outlineLevel');\n        },\n        set: function (value) {\n            this.setPropertyValue('outlineLevel', value);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    WParagraphFormat.prototype.getListFormatParagraphFormat = function (property) {\n        if (this.listFormat.listId > -1 && this.listFormat.listLevelNumber > -1) {\n            var level = this.listFormat.listLevel;\n            var propertyType = WUniqueFormat.getPropertyType(WParagraphFormat.uniqueFormatType, property);\n            // tslint:disable-next-line:max-line-length\n            if (!isNullOrUndefined(level) && !isNullOrUndefined(level.paragraphFormat.uniqueParagraphFormat) && level.paragraphFormat.uniqueParagraphFormat.propertiesHash.containsKey(propertyType)) {\n                return level.paragraphFormat.uniqueParagraphFormat.propertiesHash.get(propertyType);\n            }\n            else {\n                return undefined;\n            }\n        }\n        return undefined;\n    };\n    WParagraphFormat.prototype.getPropertyValue = function (property) {\n        if (!this.hasValue(property)) {\n            var ifListFormat = this.getListFormatParagraphFormat(property);\n            if (!isNullOrUndefined(ifListFormat)) {\n                return ifListFormat;\n            }\n            else {\n                if (this.baseStyle instanceof WParagraphStyle) {\n                    /* tslint:disable-next-line:no-any */\n                    var baseStyle = this.baseStyle;\n                    while (!isNullOrUndefined(baseStyle)) {\n                        if (baseStyle.paragraphFormat.hasValue(property)) {\n                            break;\n                        }\n                        else {\n                            baseStyle = baseStyle.basedOn;\n                        }\n                    }\n                    if (!isNullOrUndefined(baseStyle)) {\n                        var propertyType = WUniqueFormat.getPropertyType(WParagraphFormat.uniqueFormatType, property);\n                        return baseStyle.paragraphFormat.uniqueParagraphFormat.propertiesHash.get(propertyType);\n                    }\n                }\n            }\n        }\n        else {\n            var propertyType = WUniqueFormat.getPropertyType(WParagraphFormat.uniqueFormatType, property);\n            if (!isNullOrUndefined(this.uniqueParagraphFormat) && this.uniqueParagraphFormat.propertiesHash.containsKey(propertyType)) {\n                return this.uniqueParagraphFormat.propertiesHash.get(propertyType);\n            }\n        }\n        return this.getDefaultValue(property);\n    };\n    WParagraphFormat.prototype.getDefaultValue = function (property) {\n        var propertyType = WUniqueFormat.getPropertyType(WParagraphFormat.uniqueFormatType, property);\n        var docParagraphFormat = this.documentParagraphFormat();\n        // tslint:disable-next-line:max-line-length\n        if (!isNullOrUndefined(docParagraphFormat) && !isNullOrUndefined(docParagraphFormat.uniqueParagraphFormat) && docParagraphFormat.uniqueParagraphFormat.propertiesHash.containsKey(propertyType)) {\n            return docParagraphFormat.uniqueParagraphFormat.propertiesHash.get(propertyType);\n        }\n        else {\n            return WParagraphFormat.getPropertyDefaultValue(property);\n        }\n    };\n    WParagraphFormat.prototype.documentParagraphFormat = function () {\n        var docParagraphFormat;\n        if (!isNullOrUndefined(this.ownerBase)) {\n            if (!isNullOrUndefined(this.ownerBase.bodyWidget)) {\n                docParagraphFormat = this.ownerBase.bodyWidget.page.viewer.paragraphFormat;\n            }\n        }\n        return docParagraphFormat;\n    };\n    WParagraphFormat.prototype.setPropertyValue = function (property, value) {\n        if (isNullOrUndefined(value) || value === '') {\n            value = WParagraphFormat.getPropertyDefaultValue(property);\n        }\n        if (isNullOrUndefined(this.uniqueParagraphFormat)) {\n            this.initializeUniqueParagraphFormat(property, value);\n        }\n        else {\n            var propertyType = WUniqueFormat.getPropertyType(this.uniqueParagraphFormat.uniqueFormatType, property);\n            if (this.uniqueParagraphFormat.propertiesHash.containsKey(propertyType) &&\n                this.uniqueParagraphFormat.propertiesHash.get(propertyType) === value) {\n                //Do nothing, since no change in property value and return\n                return;\n            }\n            // tslint:disable-next-line:max-line-length\n            this.uniqueParagraphFormat = WParagraphFormat.uniqueParagraphFormats.updateUniqueFormat(this.uniqueParagraphFormat, property, value);\n        }\n    };\n    WParagraphFormat.prototype.initializeUniqueParagraphFormat = function (property, propValue) {\n        var uniqueParaFormatTemp = new Dictionary();\n        this.addUniqueParaFormat('leftIndent', property, propValue, uniqueParaFormatTemp);\n        this.addUniqueParaFormat('rightIndent', property, propValue, uniqueParaFormatTemp);\n        this.addUniqueParaFormat('firstLineIndent', property, propValue, uniqueParaFormatTemp);\n        this.addUniqueParaFormat('textAlignment', property, propValue, uniqueParaFormatTemp);\n        this.addUniqueParaFormat('beforeSpacing', property, propValue, uniqueParaFormatTemp);\n        this.addUniqueParaFormat('afterSpacing', property, propValue, uniqueParaFormatTemp);\n        this.addUniqueParaFormat('lineSpacing', property, propValue, uniqueParaFormatTemp);\n        this.addUniqueParaFormat('lineSpacingType', property, propValue, uniqueParaFormatTemp);\n        this.addUniqueParaFormat('outlineLevel', property, propValue, uniqueParaFormatTemp);\n        // tslint:disable-next-line:max-line-length\n        this.uniqueParagraphFormat = WParagraphFormat.uniqueParagraphFormats.addUniqueFormat(uniqueParaFormatTemp, WParagraphFormat.uniqueFormatType);\n    };\n    // tslint:disable-next-line:max-line-length\n    WParagraphFormat.prototype.addUniqueParaFormat = function (property, modifiedProperty, propValue, uniqueParaFormatTemp) {\n        var propertyType;\n        propertyType = WUniqueFormat.getPropertyType(WParagraphFormat.uniqueFormatType, property);\n        if (property === modifiedProperty) {\n            uniqueParaFormatTemp.add(propertyType, propValue);\n        }\n    };\n    WParagraphFormat.getPropertyDefaultValue = function (property) {\n        var value = undefined;\n        switch (property) {\n            case 'leftIndent':\n                value = 0;\n                break;\n            case 'rightIndent':\n                value = 0;\n                break;\n            case 'firstLineIndent':\n                value = 0;\n                break;\n            case 'textAlignment':\n                value = 'Left';\n                break;\n            case 'beforeSpacing':\n                value = 0;\n                break;\n            case 'afterSpacing':\n                value = 0;\n                break;\n            case 'lineSpacing':\n                value = 1;\n                break;\n            case 'lineSpacingType':\n                value = 'Multiple';\n                break;\n            case 'styleName':\n                value = 'Normal';\n                break;\n            case 'outlineLevel':\n                value = 'BodyText';\n                break;\n        }\n        return value;\n    };\n    WParagraphFormat.prototype.clearFormat = function () {\n        if (!isNullOrUndefined(this.listFormat)) {\n            this.listFormat.clearFormat();\n        }\n        if (!isNullOrUndefined(this.uniqueParagraphFormat) && this.uniqueParagraphFormat.referenceCount === 0) {\n            WParagraphFormat.uniqueParagraphFormats.remove(this.uniqueParagraphFormat);\n        }\n        this.uniqueParagraphFormat = undefined;\n        this.baseStyle = undefined;\n    };\n    WParagraphFormat.prototype.destroy = function () {\n        this.clearFormat();\n        if (!isNullOrUndefined(this.listFormat)) {\n            this.listFormat.destroy();\n        }\n        this.listFormat = undefined;\n        if (this.tabs !== undefined) {\n            for (var i = 0; i < this.tabs.length; i++) {\n                this.tabs[i].destroy();\n            }\n            this.tabs = undefined;\n        }\n    };\n    WParagraphFormat.prototype.copyFormat = function (format) {\n        if (!isNullOrUndefined(format)) {\n            if (!isNullOrUndefined(format.uniqueParagraphFormat)) {\n                this.updateUniqueParagraphFormat(format);\n            }\n            if (!isNullOrUndefined(format.listFormat)) {\n                this.listFormat.copyFormat(format.listFormat);\n            }\n            if (!isNullOrUndefined(format.baseStyle)) {\n                this.baseStyle = format.baseStyle;\n            }\n            if (!isNullOrUndefined(format.tabs)) {\n                for (var i = 0; i < format.tabs.length; i++) {\n                    this.tabs[i] = format.tabs[i];\n                }\n            }\n        }\n    };\n    WParagraphFormat.prototype.updateUniqueParagraphFormat = function (format) {\n        var hash = undefined;\n        if (this.uniqueParagraphFormat) {\n            hash = this.uniqueParagraphFormat.mergeProperties(format.uniqueParagraphFormat);\n            if (this.uniqueParagraphFormat.referenceCount === 0) {\n                WParagraphFormat.uniqueParagraphFormats.remove(this.uniqueParagraphFormat);\n                this.uniqueParagraphFormat = undefined;\n            }\n        }\n        this.uniqueParagraphFormat = new WUniqueFormat(WParagraphFormat.uniqueFormatType);\n        if (isNullOrUndefined(hash)) {\n            hash = this.uniqueParagraphFormat.mergeProperties(format.uniqueParagraphFormat);\n        }\n        this.uniqueParagraphFormat = WParagraphFormat.uniqueParagraphFormats.addUniqueFormat(hash, WParagraphFormat.uniqueFormatType);\n    };\n    WParagraphFormat.prototype.cloneFormat = function () {\n        var format = new WParagraphFormat(undefined);\n        format.uniqueParagraphFormat = this.uniqueParagraphFormat;\n        format.baseStyle = this.baseStyle;\n        if (isNullOrUndefined(this.listFormat)) {\n            format.listFormat = undefined;\n        }\n        else {\n            format.listFormat = new WListFormat();\n            format.listFormat.listId = this.listFormat.listId;\n            format.listFormat.listLevelNumber = this.listFormat.listLevelNumber;\n        }\n        return format;\n    };\n    WParagraphFormat.prototype.hasValue = function (property) {\n        if (!isNullOrUndefined(this.uniqueParagraphFormat) && !isNullOrUndefined(this.uniqueParagraphFormat.propertiesHash)) {\n            var propertyType = WUniqueFormat.getPropertyType(this.uniqueParagraphFormat.uniqueFormatType, property);\n            return this.uniqueParagraphFormat.propertiesHash.containsKey(propertyType);\n        }\n        return false;\n    };\n    WParagraphFormat.clear = function () {\n        this.uniqueParagraphFormats.clear();\n    };\n    WParagraphFormat.prototype.ApplyStyle = function (baseStyle) {\n        this.baseStyle = baseStyle;\n        this.listFormat.ApplyStyle(this.baseStyle);\n    };\n    /**\n     * For internal use\n     * @private\n     */\n    WParagraphFormat.prototype.getValue = function (property) {\n        return this.hasValue(property) ? this.getPropertyValue(property) : undefined;\n    };\n    /**\n     * For internal use\n     * @private\n     */\n    WParagraphFormat.prototype.mergeFormat = function (format) {\n        if (isNullOrUndefined(this.getValue('leftIndent'))) {\n            this.leftIndent = format.getValue('leftIndent');\n        }\n        if (isNullOrUndefined(this.getValue('rightIndent'))) {\n            this.rightIndent = format.getValue('rightIndent');\n        }\n        if (isNullOrUndefined(this.getValue('firstLineIndent'))) {\n            this.firstLineIndent = format.getValue('firstLineIndent');\n        }\n        if (isNullOrUndefined(this.getValue('beforeSpacing'))) {\n            this.beforeSpacing = format.getValue('beforeSpacing');\n        }\n        if (isNullOrUndefined(this.getValue('afterSpacing'))) {\n            this.afterSpacing = format.getValue('afterSpacing');\n        }\n        if (isNullOrUndefined(this.getValue('lineSpacing'))) {\n            this.lineSpacing = format.getValue('lineSpacing');\n        }\n        if (isNullOrUndefined(this.getValue('lineSpacingType'))) {\n            this.lineSpacingType = format.getValue('lineSpacingType');\n        }\n        if (isNullOrUndefined(this.getValue('textAlignment'))) {\n            this.textAlignment = format.getValue('textAlignment');\n        }\n        if (isNullOrUndefined(this.getValue('outlineLevel'))) {\n            this.outlineLevel = format.getValue('outlineLevel');\n        }\n        if (isNullOrUndefined(this.listFormat)) {\n            this.listFormat.mergeFormat(format.listFormat);\n        }\n    };\n    WParagraphFormat.uniqueParagraphFormats = new WUniqueFormats();\n    WParagraphFormat.uniqueFormatType = 3;\n    return WParagraphFormat;\n}());\nexport { WParagraphFormat };\n","import { ParagraphWidget } from '../viewer/page';\nimport { Dictionary } from '../../base/dictionary';\nimport { WUniqueFormat } from '../../base/unique-format';\nimport { WUniqueFormats } from '../../base/unique-formats';\nimport { WParagraphStyle } from './style';\nimport { isNullOrUndefined } from '@syncfusion/ej2-base';\n/**\n * @private\n */\nvar WCharacterFormat = /** @class */ (function () {\n    function WCharacterFormat(node) {\n        this.uniqueCharacterFormat = undefined;\n        this.ownerBase = undefined;\n        this.baseCharStyle = undefined;\n        this.ownerBase = node;\n    }\n    Object.defineProperty(WCharacterFormat.prototype, \"bold\", {\n        get: function () {\n            return this.getPropertyValue('bold');\n        },\n        set: function (value) {\n            this.setPropertyValue('bold', value);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(WCharacterFormat.prototype, \"italic\", {\n        get: function () {\n            return this.getPropertyValue('italic');\n        },\n        set: function (value) {\n            this.setPropertyValue('italic', value);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(WCharacterFormat.prototype, \"fontSize\", {\n        get: function () {\n            return this.getPropertyValue('fontSize');\n        },\n        set: function (value) {\n            this.setPropertyValue('fontSize', value);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(WCharacterFormat.prototype, \"fontFamily\", {\n        get: function () {\n            return this.getPropertyValue('fontFamily');\n        },\n        set: function (value) {\n            this.setPropertyValue('fontFamily', value);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(WCharacterFormat.prototype, \"underline\", {\n        get: function () {\n            return this.getPropertyValue('underline');\n        },\n        set: function (value) {\n            this.setPropertyValue('underline', value);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(WCharacterFormat.prototype, \"strikethrough\", {\n        get: function () {\n            return this.getPropertyValue('strikethrough');\n        },\n        set: function (value) {\n            this.setPropertyValue('strikethrough', value);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(WCharacterFormat.prototype, \"baselineAlignment\", {\n        get: function () {\n            return this.getPropertyValue('baselineAlignment');\n        },\n        set: function (value) {\n            this.setPropertyValue('baselineAlignment', value);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(WCharacterFormat.prototype, \"highlightColor\", {\n        get: function () {\n            return this.getPropertyValue('highlightColor');\n        },\n        set: function (value) {\n            this.setPropertyValue('highlightColor', value);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(WCharacterFormat.prototype, \"fontColor\", {\n        get: function () {\n            return this.getPropertyValue('fontColor');\n        },\n        set: function (value) {\n            this.setPropertyValue('fontColor', value);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    WCharacterFormat.prototype.getPropertyValue = function (property) {\n        if (!this.hasValue(property)) {\n            var charStyleValue = this.checkCharacterStyle(property);\n            if (!isNullOrUndefined(charStyleValue)) {\n                return charStyleValue;\n            }\n            else {\n                var baseStyleValue = this.checkBaseStyle(property);\n                if (!isNullOrUndefined(baseStyleValue)) {\n                    return baseStyleValue;\n                }\n            }\n        }\n        else {\n            var propertyType = WUniqueFormat.getPropertyType(WCharacterFormat.uniqueFormatType, property);\n            if (!isNullOrUndefined(this.uniqueCharacterFormat) && this.uniqueCharacterFormat.propertiesHash.containsKey(propertyType)) {\n                return this.uniqueCharacterFormat.propertiesHash.get(propertyType);\n            }\n        }\n        return this.getDefaultValue(property);\n    };\n    WCharacterFormat.prototype.getDefaultValue = function (property) {\n        var propertyType = WUniqueFormat.getPropertyType(WCharacterFormat.uniqueFormatType, property);\n        var docCharacterFormat = this.documentCharacterFormat();\n        // tslint:disable-next-line:max-line-length\n        if (!isNullOrUndefined(docCharacterFormat) && !isNullOrUndefined(docCharacterFormat.uniqueCharacterFormat) && docCharacterFormat.uniqueCharacterFormat.propertiesHash.containsKey(propertyType)) {\n            return docCharacterFormat.uniqueCharacterFormat.propertiesHash.get(propertyType);\n        }\n        else {\n            return WCharacterFormat.getPropertyDefaultValue(property);\n        }\n    };\n    WCharacterFormat.prototype.documentCharacterFormat = function () {\n        var docCharacterFormat;\n        if (!isNullOrUndefined(this.ownerBase)) {\n            if (!isNullOrUndefined(this.ownerBase.paragraph)) {\n                docCharacterFormat = this.ownerBase.paragraph.bodyWidget.page.viewer.characterFormat;\n            }\n            else {\n                if (!isNullOrUndefined(this.ownerBase.bodyWidget)) {\n                    docCharacterFormat = this.ownerBase.bodyWidget.page.viewer.characterFormat;\n                }\n            }\n        }\n        return docCharacterFormat;\n    };\n    WCharacterFormat.prototype.checkBaseStyle = function (property) {\n        /* tslint:disable-next-line:no-any */\n        var baseStyle;\n        if (!isNullOrUndefined(this.ownerBase)) {\n            if (!isNullOrUndefined(this.ownerBase.paragraph)) {\n                baseStyle = this.ownerBase.paragraph.paragraphFormat.baseStyle;\n            }\n            else {\n                // tslint:disable-next-line:max-line-length\n                if ((this.ownerBase instanceof ParagraphWidget) && !isNullOrUndefined(this.ownerBase.paragraphFormat)) {\n                    baseStyle = this.ownerBase.paragraphFormat.baseStyle;\n                }\n                else {\n                    if (!isNullOrUndefined(this.ownerBase instanceof WParagraphStyle)) {\n                        baseStyle = this.ownerBase.basedOn;\n                    }\n                }\n            }\n        }\n        while (!isNullOrUndefined(baseStyle)) {\n            if (baseStyle.characterFormat.hasValue(property)) {\n                break;\n            }\n            else {\n                baseStyle = baseStyle.basedOn;\n            }\n        }\n        if (!isNullOrUndefined(baseStyle)) {\n            var propertyType = WUniqueFormat.getPropertyType(WCharacterFormat.uniqueFormatType, property);\n            return baseStyle.characterFormat.uniqueCharacterFormat.propertiesHash.get(propertyType);\n        }\n        return undefined;\n    };\n    WCharacterFormat.prototype.checkCharacterStyle = function (property) {\n        /* tslint:disable-next-line:no-any */\n        var baseStyle = this.baseCharStyle;\n        if (!isNullOrUndefined(baseStyle)) {\n            while (!isNullOrUndefined(baseStyle) && baseStyle.name !== 'Default Paragraph Font') {\n                var hasKey = baseStyle.characterFormat.hasValue(property);\n                if (hasKey) {\n                    var returnPropertyType = WUniqueFormat.getPropertyType(WCharacterFormat.uniqueFormatType, property);\n                    return baseStyle.characterFormat.uniqueCharacterFormat.propertiesHash.get(returnPropertyType);\n                }\n                else {\n                    baseStyle = baseStyle.basedOn;\n                }\n            }\n        }\n        return undefined;\n    };\n    WCharacterFormat.prototype.setPropertyValue = function (property, value) {\n        if (isNullOrUndefined(value) || value === '') {\n            value = WCharacterFormat.getPropertyDefaultValue(property);\n        }\n        if (isNullOrUndefined(this.uniqueCharacterFormat)) {\n            this.initializeUniqueCharacterFormat(property, value);\n        }\n        else {\n            var propertyType = WUniqueFormat.getPropertyType(this.uniqueCharacterFormat.uniqueFormatType, property);\n            if (this.uniqueCharacterFormat.propertiesHash.containsKey(propertyType) &&\n                // tslint:disable-next-line:max-line-length\n                this.uniqueCharacterFormat.propertiesHash.get(propertyType) === value) {\n                return;\n            }\n            // tslint:disable-next-line:max-line-length\n            this.uniqueCharacterFormat = WCharacterFormat.uniqueCharacterFormats.updateUniqueFormat(this.uniqueCharacterFormat, property, value);\n        }\n    };\n    WCharacterFormat.prototype.initializeUniqueCharacterFormat = function (property, propValue) {\n        var uniqueCharFormatTemp = new Dictionary();\n        this.addUniqueCharacterFormat('fontColor', property, propValue, uniqueCharFormatTemp);\n        this.addUniqueCharacterFormat('fontFamily', property, propValue, uniqueCharFormatTemp);\n        this.addUniqueCharacterFormat('fontSize', property, propValue, uniqueCharFormatTemp);\n        this.addUniqueCharacterFormat('bold', property, propValue, uniqueCharFormatTemp);\n        this.addUniqueCharacterFormat('italic', property, propValue, uniqueCharFormatTemp);\n        this.addUniqueCharacterFormat('underline', property, propValue, uniqueCharFormatTemp);\n        this.addUniqueCharacterFormat('strikethrough', property, propValue, uniqueCharFormatTemp);\n        this.addUniqueCharacterFormat('baselineAlignment', property, propValue, uniqueCharFormatTemp);\n        this.addUniqueCharacterFormat('highlightColor', property, propValue, uniqueCharFormatTemp);\n        this.addUniqueCharacterFormat('styleName', property, propValue, uniqueCharFormatTemp);\n        // tslint:disable-next-line:max-line-length\n        this.uniqueCharacterFormat = WCharacterFormat.uniqueCharacterFormats.addUniqueFormat(uniqueCharFormatTemp, WCharacterFormat.uniqueFormatType);\n    };\n    // tslint:disable-next-line:max-line-length\n    WCharacterFormat.prototype.addUniqueCharacterFormat = function (property, modifiedProperty, propValue, uniqueCharFormatTemp) {\n        var propertyType;\n        propertyType = WUniqueFormat.getPropertyType(WCharacterFormat.uniqueFormatType, property);\n        if (property === modifiedProperty) {\n            uniqueCharFormatTemp.add(propertyType, propValue);\n        }\n    };\n    WCharacterFormat.getPropertyDefaultValue = function (property) {\n        var value = undefined;\n        switch (property) {\n            case 'bold':\n                value = false;\n                break;\n            case 'italic':\n                value = false;\n                break;\n            case 'fontSize':\n                value = 11;\n                break;\n            case 'underline':\n                value = 'None';\n                break;\n            case 'strikethrough':\n                value = 'None';\n                break;\n            case 'baselineAlignment':\n                value = 'Normal';\n                break;\n            case 'highlightColor':\n                value = 'NoColor';\n                break;\n            case 'fontColor':\n                value = '#000000';\n                break;\n            case 'fontFamily':\n                value = 'Calibri';\n                break;\n            case 'styleName':\n                value = 'Default Paragraph Font';\n                break;\n        }\n        return value;\n    };\n    WCharacterFormat.prototype.isEqualFormat = function (format) {\n        return (this.fontSize === format.fontSize\n            && this.fontFamily === format.fontFamily\n            && this.bold === format.bold\n            && this.italic === format.italic\n            && this.baselineAlignment === format.baselineAlignment\n            && this.underline === format.underline\n            && this.fontColor === format.fontColor\n            && this.strikethrough === format.strikethrough\n            && this.highlightColor === format.highlightColor);\n    };\n    WCharacterFormat.prototype.isSameFormat = function (format) {\n        return this.baseCharStyle === format.baseCharStyle &&\n            this.uniqueCharacterFormat === format.uniqueCharacterFormat;\n    };\n    WCharacterFormat.prototype.cloneFormat = function () {\n        var format = new WCharacterFormat(undefined);\n        format.uniqueCharacterFormat = this.uniqueCharacterFormat;\n        format.baseCharStyle = this.baseCharStyle;\n        return format;\n    };\n    WCharacterFormat.prototype.hasValue = function (property) {\n        if (!isNullOrUndefined(this.uniqueCharacterFormat) && !isNullOrUndefined(this.uniqueCharacterFormat.propertiesHash)) {\n            var propertyType = WUniqueFormat.getPropertyType(this.uniqueCharacterFormat.uniqueFormatType, property);\n            return this.uniqueCharacterFormat.propertiesHash.containsKey(propertyType);\n        }\n        return false;\n    };\n    WCharacterFormat.prototype.clearFormat = function () {\n        if (!isNullOrUndefined(this.uniqueCharacterFormat) && this.uniqueCharacterFormat.referenceCount === 0) {\n            WCharacterFormat.uniqueCharacterFormats.remove(this.uniqueCharacterFormat);\n        }\n        this.uniqueCharacterFormat = undefined;\n        this.baseCharStyle = undefined;\n    };\n    WCharacterFormat.prototype.destroy = function () {\n        this.clearFormat();\n    };\n    WCharacterFormat.prototype.copyFormat = function (format) {\n        if (!isNullOrUndefined(format)) {\n            if (!isNullOrUndefined(format.uniqueCharacterFormat) && format.uniqueCharacterFormat.propertiesHash) {\n                this.updateUniqueCharacterFormat(format);\n            }\n            if (!isNullOrUndefined(format.baseCharStyle)) {\n                this.baseCharStyle = format.baseCharStyle;\n            }\n        }\n    };\n    WCharacterFormat.prototype.updateUniqueCharacterFormat = function (format) {\n        var hash = undefined;\n        if (this.uniqueCharacterFormat) {\n            hash = this.uniqueCharacterFormat.mergeProperties(format.uniqueCharacterFormat);\n            if (this.uniqueCharacterFormat.referenceCount === 0) {\n                WCharacterFormat.uniqueCharacterFormats.remove(this.uniqueCharacterFormat);\n                this.uniqueCharacterFormat = undefined;\n            }\n        }\n        this.uniqueCharacterFormat = new WUniqueFormat(WCharacterFormat.uniqueFormatType);\n        if (isNullOrUndefined(hash)) {\n            hash = this.uniqueCharacterFormat.mergeProperties(format.uniqueCharacterFormat);\n        }\n        this.uniqueCharacterFormat = WCharacterFormat.uniqueCharacterFormats.addUniqueFormat(hash, WCharacterFormat.uniqueFormatType);\n    };\n    WCharacterFormat.clear = function () {\n        this.uniqueCharacterFormats.clear();\n    };\n    WCharacterFormat.prototype.ApplyStyle = function (baseCharStyle) {\n        this.baseCharStyle = baseCharStyle;\n    };\n    /**\n     * For internal use\n     * @private\n     */\n    WCharacterFormat.prototype.getValue = function (property) {\n        return this.hasValue(property) ? this.getPropertyValue(property) : undefined;\n    };\n    /**\n     * For internal use\n     * @private\n     */\n    WCharacterFormat.prototype.mergeFormat = function (format) {\n        if (isNullOrUndefined(this.getValue('bold'))) {\n            this.bold = format.getValue('bold');\n        }\n        if (isNullOrUndefined(this.getValue('italic'))) {\n            this.italic = format.getValue('italic');\n        }\n        if (isNullOrUndefined(this.getValue('fontSize'))) {\n            this.fontSize = format.getValue('fontSize');\n        }\n        if (isNullOrUndefined(this.getValue('fontFamily'))) {\n            this.fontFamily = format.getValue('fontFamily');\n        }\n        if (isNullOrUndefined(this.getValue('underline'))) {\n            this.underline = format.getValue('underline');\n        }\n        if (isNullOrUndefined(this.getValue('strikethrough'))) {\n            this.strikethrough = format.getValue('strikethrough');\n        }\n        if (isNullOrUndefined(this.getValue('baselineAlignment'))) {\n            this.baselineAlignment = format.getValue('baselineAlignment');\n        }\n        if (isNullOrUndefined(this.getValue('highlightColor'))) {\n            this.highlightColor = format.getValue('highlightColor');\n        }\n        if (isNullOrUndefined(this.getValue('fontColor'))) {\n            this.fontColor = format.getValue('fontColor');\n        }\n    };\n    WCharacterFormat.uniqueCharacterFormats = new WUniqueFormats();\n    WCharacterFormat.uniqueFormatType = 2;\n    return WCharacterFormat;\n}());\nexport { WCharacterFormat };\n","import { isNullOrUndefined } from '@syncfusion/ej2-base';\nimport { FieldElementBox } from '../viewer/page';\n/**\n * @private\n */\nvar HelperMethods = /** @class */ (function () {\n    function HelperMethods() {\n    }\n    /**\n     * Inserts text at specified index in string.\n     * @param {string} spanText\n     * @param {number} index\n     * @param {string} text\n     * @private\n     */\n    HelperMethods.insert = function (spanText, index, text) {\n        if (index >= 0) {\n            return [spanText.slice(0, index) + text + spanText.slice(index)].join('');\n        }\n        else {\n            return text + this;\n        }\n    };\n    /**\n     * Removes text from specified index in string.\n     * @param {string} text\n     * @param {number} index\n     * @param {number} length\n     * @private\n     */\n    HelperMethods.remove = function (text, index, length) {\n        if (index === 0) {\n            return text.substring(index + 1, text.length);\n        }\n        else {\n            return text.substring(0, index) + text.substring(index + 1, text.length);\n        }\n    };\n    /**\n     * Returns the index of word split character in a string.\n     * @param {string} text\n     * @param {string[]} wordSplitCharacter\n     * @private\n     */\n    /* tslint:disable:no-any */\n    HelperMethods.indexOfAny = function (text, wordSplitCharacter) {\n        var index = undefined;\n        for (var j = 0; j < wordSplitCharacter.length; j++) {\n            var temp = text.indexOf(wordSplitCharacter[j]);\n            if (temp !== -1 && isNullOrUndefined(index)) {\n                index = temp;\n            }\n            else if (temp !== -1 && temp < index) {\n                index = temp;\n            }\n        }\n        return isNullOrUndefined(index) ? -1 : index;\n    };\n    /**\n     * Returns the last index of word split character in a string.\n     * @param {string} text\n     * @param {string[]} wordSplitCharacter\n     * @private\n     */\n    HelperMethods.lastIndexOfAny = function (text, wordSplitCharacter) {\n        for (var i = text.length - 1; i >= 0; i--) {\n            for (var j = 0; j <= wordSplitCharacter.length - 1; j++) {\n                if (text[i] === wordSplitCharacter[j]) {\n                    return i;\n                }\n            }\n        }\n        return -1;\n    };\n    /**\n     * Adds css styles to document header.\n     * @param {string} css\n     * @private\n     */\n    HelperMethods.addCssStyle = function (css) {\n        var style = document.createElement('style');\n        if (style.style.cssText) {\n            style.style.cssText = css;\n        }\n        else {\n            style.appendChild(document.createTextNode(css));\n        }\n        document.getElementsByTagName('head')[0].appendChild(style);\n    };\n    /**\n     * Gets highlight color code.\n     * @param {HighlightColor} highlightColor\n     * @private\n     */\n    HelperMethods.getHighlightColorCode = function (highlightColor) {\n        var color = '#ffffff';\n        switch (highlightColor) {\n            case 'Yellow':\n                color = '#ffff00';\n                break;\n            case 'BrightGreen':\n                color = '#00ff00';\n                break;\n            case 'Turquoise':\n                color = '#00ffff';\n                break;\n            case 'Pink':\n                color = '#ff00ff';\n                break;\n            case 'Blue':\n                color = '#0000ff';\n                break;\n            case 'Red':\n                color = '#ff0000';\n                break;\n            case 'DarkBlue':\n                color = '#000080';\n                break;\n            case 'Teal':\n                color = '#008080';\n                break;\n            case 'Green':\n                color = '#008000';\n                break;\n            case 'Violet':\n                color = '#800080';\n                break;\n            case 'DarkRed':\n                color = '#800000';\n                break;\n            case 'DarkYellow':\n                color = '#808000';\n                break;\n            case 'Gray50':\n                color = '#808080';\n                break;\n            case 'Gray25':\n                color = '#c0c0c0';\n                break;\n            case 'Black':\n                color = '#000000';\n                break;\n        }\n        return color;\n    };\n    /**\n     * Converts point to pixel.\n     * @param {number} point\n     * @private\n     */\n    HelperMethods.convertPointToPixel = function (point) {\n        var pixel = HelperMethods.round((point * 96 / 72), 5);\n        return pixel;\n    };\n    /**\n     * Converts pixel to point.\n     * @param {number} pixel\n     * @private\n     */\n    HelperMethods.convertPixelToPoint = function (pixel) {\n        var point = HelperMethods.round((pixel * 72 / 96), 5);\n        return point;\n    };\n    /**\n     * Return true if field linked\n     * @private\n     */\n    HelperMethods.isLinkedFieldCharacter = function (inline) {\n        if (inline instanceof FieldElementBox && inline.fieldType === 0) {\n            return !isNullOrUndefined(inline.fieldEnd);\n        }\n        else if (inline instanceof FieldElementBox && inline.fieldType === 2) {\n            return !isNullOrUndefined(inline.fieldBegin) && !isNullOrUndefined(inline.fieldEnd);\n        }\n        else {\n            return !isNullOrUndefined(inline.fieldBegin);\n        }\n    };\n    /**\n     * Removes white space in a string.\n     * @param {string} text\n     * @private\n     */\n    HelperMethods.removeSpace = function (text) {\n        if (!isNullOrUndefined(text) && text.length !== 0) {\n            for (var i = 0; i < text.length; i++) {\n                if (text.charAt(i) === ' ') {\n                    //replace the space by empty string in string\n                    text = text.replace(' ', '');\n                }\n            }\n        }\n        return text;\n    };\n    /**\n     * Trims white space at start of the string.\n     * @param {string} text\n     * @private\n     */\n    HelperMethods.trimStart = function (text) {\n        var i = 0;\n        for (i; i < text.length; i++) {\n            if (text[i] !== ' ') {\n                break;\n            }\n        }\n        return text.substring(i, text.length);\n    };\n    /**\n     * Trims white space at end of the string.\n     * @param {string} text\n     * @private\n     */\n    HelperMethods.trimEnd = function (text) {\n        var i = text.length - 1;\n        for (i; i >= 0; i--) {\n            if (text[i] !== ' ') {\n                break;\n            }\n        }\n        return text.substring(0, i + 1);\n    };\n    /**\n     * Checks whether string ends with whitespace.\n     * @param {string} text\n     * @private\n     */\n    HelperMethods.endsWith = function (text) {\n        if (!isNullOrUndefined(text) && text.length !== 0) {\n            return text[text.length - 1] === ' ';\n        }\n        return false;\n    };\n    /**\n     * @private\n     * Write Characterformat\n     * @param {any} characterFormat\n     * @param {boolean} isInline\n     * @param {WCharacterFormat} format\n     */\n    HelperMethods.writeCharacterFormat = function (characterFormat, isInline, format) {\n        characterFormat.bold = isInline ? format.bold : format.getValue('bold');\n        characterFormat.italic = isInline ? format.italic : format.getValue('italic');\n        characterFormat.fontSize = isInline ? format.fontSize : format.getValue('fontSize');\n        characterFormat.fontFamily = isInline ? format.fontFamily : format.getValue('fontFamily');\n        characterFormat.underline = isInline ? format.underline : format.getValue('underline');\n        characterFormat.strikethrough = isInline ? format.strikethrough : format.getValue('strikethrough');\n        characterFormat.baselineAlignment = isInline ? format.baselineAlignment : format.getValue('baselineAlignment');\n        characterFormat.highlightColor = isInline ? format.highlightColor : format.getValue('highlightColor');\n        characterFormat.fontColor = isInline ? format.fontColor : format.getValue('fontColor');\n        characterFormat.styleName = !isNullOrUndefined(format.baseCharStyle) ? format.baseCharStyle.name : undefined;\n    };\n    /* tslint:enable:no-any */\n    /**\n     * Rounds the values with specified decimal digits.\n     * @param {number} value\n     * @param {number} decimalDigits\n     * @private\n     */\n    HelperMethods.round = function (value, decimalDigits) {\n        var temp = value;\n        for (var i = 0; i < decimalDigits; i++) {\n            temp = temp * 10;\n        }\n        temp = Math.round(temp);\n        for (var i = 0; i < decimalDigits; i++) {\n            temp = temp / 10;\n        }\n        return temp;\n    };\n    /**\n     * @private\n     */\n    HelperMethods.wordBefore = '\\\\b';\n    /**\n     * @private\n     */\n    HelperMethods.wordAfter = '\\\\b';\n    /**\n     * @private\n     */\n    HelperMethods.wordSplitCharacters = [' ', ',', '.', ':', ';', '<', '>', '=',\n        '+', '-', '_', '{', '}', '[', ']', '`', '~', '!', '@', '#', '$', '%', '^', '&',\n        '*', '(', ')', '\"', '?', '/', '|', '\\\\', 'â€'];\n    return HelperMethods;\n}());\nexport { HelperMethods };\n/**\n * @private\n */\nvar Point = /** @class */ (function () {\n    function Point(xPosition, yPosition) {\n        this.xIn = 0;\n        this.yIn = 0;\n        this.xIn = xPosition;\n        this.yIn = yPosition;\n    }\n    Object.defineProperty(Point.prototype, \"x\", {\n        /**\n         * Gets or sets x value.\n         * @private\n         */\n        get: function () {\n            return this.xIn;\n        },\n        set: function (value) {\n            this.xIn = value;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(Point.prototype, \"y\", {\n        /**\n         * Gets or sets y value.\n         * @private\n         */\n        get: function () {\n            return this.yIn;\n        },\n        set: function (value) {\n            this.yIn = value;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    /**\n     * @private\n     */\n    Point.prototype.copy = function (point) {\n        this.xIn = point.xIn;\n        this.yIn = point.yIn;\n    };\n    /**\n     * Destroys the internal objects maintained.\n     * @returns void\n     */\n    Point.prototype.destroy = function () {\n        this.xIn = undefined;\n        this.yIn = undefined;\n    };\n    return Point;\n}());\nexport { Point };\n","var __extends = (this && this.__extends) || (function () {\n    var extendStatics = Object.setPrototypeOf ||\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nimport { WParagraphFormat } from './paragraph-format';\nimport { WCharacterFormat } from './character-format';\nimport { HelperMethods } from '../editor/editor-helper';\nimport { isNullOrUndefined } from '@syncfusion/ej2-base';\n/**\n * @private\n */\nvar WStyle = /** @class */ (function () {\n    function WStyle() {\n    }\n    return WStyle;\n}());\nexport { WStyle };\n/**\n * @private\n */\nvar WParagraphStyle = /** @class */ (function (_super) {\n    __extends(WParagraphStyle, _super);\n    function WParagraphStyle(node) {\n        var _this = _super.call(this) || this;\n        _this.ownerBase = node;\n        _this.paragraphFormat = new WParagraphFormat(_this);\n        _this.characterFormat = new WCharacterFormat(_this);\n        return _this;\n    }\n    WParagraphStyle.prototype.destroy = function () {\n        this.characterFormat.destroy();\n        this.paragraphFormat.destroy();\n    };\n    WParagraphStyle.prototype.copyStyle = function (paraStyle) {\n        this.name = paraStyle.name;\n        this.ownerBase = paraStyle.ownerBase;\n        this.type = paraStyle.type;\n        this.next = paraStyle.next;\n        this.basedOn = paraStyle.basedOn;\n        this.link = paraStyle.link;\n        this.characterFormat.copyFormat(paraStyle.characterFormat);\n        this.paragraphFormat.copyFormat(paraStyle.paragraphFormat);\n    };\n    return WParagraphStyle;\n}(WStyle));\nexport { WParagraphStyle };\n/**\n * @private\n */\nvar WCharacterStyle = /** @class */ (function (_super) {\n    __extends(WCharacterStyle, _super);\n    function WCharacterStyle(node) {\n        var _this = _super.call(this) || this;\n        _this.ownerBase = node;\n        _this.characterFormat = new WCharacterFormat(_this);\n        return _this;\n    }\n    WCharacterStyle.prototype.destroy = function () {\n        this.characterFormat.destroy();\n    };\n    WCharacterStyle.prototype.copyStyle = function (charStyle) {\n        this.name = charStyle.name;\n        this.ownerBase = charStyle.ownerBase;\n        this.type = charStyle.type;\n        this.next = charStyle.next;\n        this.basedOn = charStyle.basedOn;\n        this.characterFormat.copyFormat(charStyle.characterFormat);\n    };\n    return WCharacterStyle;\n}(WStyle));\nexport { WCharacterStyle };\n/**\n * @private\n */\nvar WStyles = /** @class */ (function () {\n    function WStyles() {\n        this.collection = [];\n        /* tslint:enable:no-any */\n    }\n    Object.defineProperty(WStyles.prototype, \"length\", {\n        get: function () {\n            return this.collection.length;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    WStyles.prototype.remove = function (item) {\n        this.collection = this.collection.filter(function (a) { return (a.name !== item.name); });\n    };\n    WStyles.prototype.push = function (item) {\n        if (item != null && item !== undefined) {\n            this.collection.push(item);\n        }\n        return 1;\n    };\n    WStyles.prototype.getItem = function (index) {\n        if (this.collection.length > index) {\n            return this.collection[index];\n        }\n        return null;\n    };\n    WStyles.prototype.indexOf = function (item) {\n        return this.collection.indexOf(item);\n    };\n    WStyles.prototype.contains = function (item) {\n        var index = this.collection.indexOf(item);\n        return index > -1 && index < this.collection.length;\n    };\n    WStyles.prototype.clear = function () {\n        while (this.collection.length > 0) {\n            this.collection.pop();\n        }\n    };\n    WStyles.prototype.findByName = function (name, type) {\n        var returnStyle;\n        for (var _i = 0, _a = this.collection; _i < _a.length; _i++) {\n            var value = _a[_i];\n            if (value.name === name) {\n                returnStyle = value;\n                if (!isNullOrUndefined(type) && value.type === type) {\n                    returnStyle = value;\n                }\n            }\n        }\n        return returnStyle;\n    };\n    WStyles.prototype.getStyleNames = function (type) {\n        return this.collection.filter(function (a) { return (a.type === type); }).map(function (a) { return a.name; });\n    };\n    /* tslint:disable:no-any */\n    WStyles.prototype.getStyles = function (type) {\n        var styles = this.collection.filter(function (a) { return (a.type === type); }).map(function (a) { return a; });\n        var styleObjects = [];\n        for (var _i = 0, styles_1 = styles; _i < styles_1.length; _i++) {\n            var style = styles_1[_i];\n            var returnStyle = {};\n            var returnStyleObject = {};\n            returnStyleObject.characterFormat = {};\n            HelperMethods.writeCharacterFormat(returnStyleObject.characterFormat, true, style.characterFormat);\n            returnStyle.name = style.name;\n            returnStyle.style = JSON.stringify(returnStyleObject);\n            styleObjects.push(returnStyle);\n        }\n        return styleObjects;\n    };\n    return WStyles;\n}());\nexport { WStyles };\n","import { Dictionary } from '../../base/dictionary';\nimport { WUniqueFormat } from '../../base/unique-format';\nimport { WUniqueFormats } from '../../base/unique-formats';\nimport { isNullOrUndefined } from '@syncfusion/ej2-base';\n/**\n * @private\n */\nvar WBorder = /** @class */ (function () {\n    function WBorder(node) {\n        this.uniqueBorderFormat = undefined;\n        this.ownerBase = undefined;\n        this.ownerBase = node;\n    }\n    Object.defineProperty(WBorder.prototype, \"color\", {\n        get: function () {\n            return this.getPropertyValue('color');\n        },\n        set: function (value) {\n            this.setPropertyValue('color', value);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(WBorder.prototype, \"lineStyle\", {\n        get: function () {\n            return this.getPropertyValue('lineStyle');\n        },\n        set: function (value) {\n            this.setPropertyValue('lineStyle', value);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(WBorder.prototype, \"lineWidth\", {\n        get: function () {\n            return this.getPropertyValue('lineWidth');\n        },\n        set: function (value) {\n            this.setPropertyValue('lineWidth', value);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(WBorder.prototype, \"shadow\", {\n        get: function () {\n            return this.getPropertyValue('shadow');\n        },\n        set: function (value) {\n            this.setPropertyValue('shadow', value);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(WBorder.prototype, \"space\", {\n        get: function () {\n            return this.getPropertyValue('space');\n        },\n        set: function (value) {\n            this.setPropertyValue('space', value);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(WBorder.prototype, \"hasNoneStyle\", {\n        get: function () {\n            return this.getPropertyValue('hasNoneStyle');\n        },\n        set: function (value) {\n            this.setPropertyValue('hasNoneStyle', value);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    WBorder.prototype.getPropertyValue = function (property) {\n        var hasValue = this.hasValue(property);\n        if (hasValue) {\n            var propertyType = WUniqueFormat.getPropertyType(WBorder.uniqueFormatType, property);\n            if (!isNullOrUndefined(this.uniqueBorderFormat) && this.uniqueBorderFormat.propertiesHash.containsKey(propertyType)) {\n                return this.uniqueBorderFormat.propertiesHash.get(propertyType);\n            }\n        }\n        return WBorder.getPropertyDefaultValue(property);\n    };\n    WBorder.prototype.setPropertyValue = function (property, value) {\n        if (isNullOrUndefined(value) || value === '') {\n            value = WBorder.getPropertyDefaultValue(property);\n        }\n        if (isNullOrUndefined(this.uniqueBorderFormat)) {\n            this.initializeUniqueBorder(property, value);\n        }\n        else {\n            var propertyType = WUniqueFormat.getPropertyType(this.uniqueBorderFormat.uniqueFormatType, property);\n            if (this.uniqueBorderFormat.propertiesHash.containsKey(propertyType) &&\n                this.uniqueBorderFormat.propertiesHash.get(propertyType) === value) {\n                //Do nothing, since no change in property value and return\n                return;\n            }\n            this.uniqueBorderFormat = WBorder.uniqueBorderFormats.updateUniqueFormat(this.uniqueBorderFormat, property, value);\n        }\n    };\n    WBorder.prototype.initializeUniqueBorder = function (property, propValue) {\n        var uniqueBorderFormatTemp = new Dictionary();\n        this.addUniqueBorderFormat('color', property, propValue, uniqueBorderFormatTemp);\n        this.addUniqueBorderFormat('lineStyle', property, propValue, uniqueBorderFormatTemp);\n        this.addUniqueBorderFormat('lineWidth', property, propValue, uniqueBorderFormatTemp);\n        this.addUniqueBorderFormat('shadow', property, propValue, uniqueBorderFormatTemp);\n        this.addUniqueBorderFormat('space', property, propValue, uniqueBorderFormatTemp);\n        this.addUniqueBorderFormat('hasNoneStyle', property, propValue, uniqueBorderFormatTemp);\n        this.uniqueBorderFormat = WBorder.uniqueBorderFormats.addUniqueFormat(uniqueBorderFormatTemp, WBorder.uniqueFormatType);\n    };\n    // tslint:disable-next-line:max-line-length\n    WBorder.prototype.addUniqueBorderFormat = function (property, modifiedProperty, propValue, uniqueBorderFormatTemp) {\n        var propertyType;\n        propertyType = WUniqueFormat.getPropertyType(WBorder.uniqueFormatType, property);\n        if (property === modifiedProperty) {\n            uniqueBorderFormatTemp.add(propertyType, propValue);\n        }\n        else {\n            uniqueBorderFormatTemp.add(propertyType, WBorder.getPropertyDefaultValue(property));\n        }\n    };\n    WBorder.getPropertyDefaultValue = function (property) {\n        var value = undefined;\n        switch (property) {\n            case 'color':\n                value = '#000000';\n                break;\n            case 'lineStyle':\n                value = 'None';\n                break;\n            case 'lineWidth':\n                value = 0;\n                break;\n            case 'shadow':\n                value = false;\n                break;\n            case 'space':\n                value = 0;\n                break;\n            case 'hasNoneStyle':\n                value = false;\n                break;\n        }\n        return value;\n    };\n    WBorder.prototype.getLineWidth = function () {\n        /* tslint:disable */\n        switch (this.lineStyle) {\n            case 'None':\n            case 'Cleared':\n                return 0;\n            case 'Triple':\n            case 'Double':\n            case 'ThinThickSmallGap':\n            case 'ThickThinSmallGap':\n            case 'ThinThickThinSmallGap':\n            case 'ThinThickMediumGap':\n            case 'ThickThinMediumGap':\n            case 'ThinThickThinMediumGap':\n            case 'ThinThickLargeGap':\n            case 'ThickThinLargeGap':\n            case 'ThinThickThinLargeGap':\n            case 'Emboss3D':\n            case 'Engrave3D':\n                {\n                    var lineArray = this.getBorderLineWidthArray(this.lineStyle, this.lineWidth);\n                    var width = 0;\n                    for (var i = 0; i < lineArray.length; i++) {\n                        width += lineArray[i];\n                    }\n                    return width;\n                }\n            case 'Single':\n            case 'DashLargeGap':\n            case 'DashSmallGap':\n            case 'Dot':\n            case 'DashDot':\n            case 'DashDotDot':\n            case 'Thick':\n                return this.lineWidth;\n            case 'SingleWavy':\n                return (this.lineWidth === 1.5 ? 3 : 2.5); //Double wave border only draw with the fixed width\n            case 'DoubleWavy':\n                return (6.75); //Double wave border only draw with the fixed width\n            case 'DashDotStroked':\n            case 'Outset':\n                return this.lineWidth;\n        }\n        return this.lineWidth;\n        /* tslint:enable */\n    };\n    WBorder.prototype.getBorderLineWidthArray = function (lineStyle, lineWidth) {\n        var borderLineArray = [lineWidth];\n        switch (lineStyle) {\n            case 'Double':\n                borderLineArray = [1, 1, 1];\n                break;\n            case 'ThinThickSmallGap':\n                borderLineArray = [1, -0.75, -0.75];\n                break;\n            case 'ThickThinSmallGap':\n                borderLineArray = [-0.75, -0.75, 1];\n                break;\n            case 'ThinThickMediumGap':\n                borderLineArray = [1, 0.5, 0.5];\n                break;\n            case 'ThickThinMediumGap':\n                borderLineArray = [0.5, 0.5, 1];\n                break;\n            case 'ThinThickLargeGap':\n                borderLineArray = [-1.5, 1, -0.75];\n                break;\n            case 'ThickThinLargeGap':\n                borderLineArray = [-0.75, 1, -1.5];\n                break;\n            case 'Triple':\n                borderLineArray = [1, 1, 1, 1, 1];\n                break;\n            case 'ThinThickThinSmallGap':\n                borderLineArray = [-0.75, -0.75, 1, -0.75, -0.75];\n                break;\n            case 'ThinThickThinMediumGap':\n                borderLineArray = [0.5, 0.5, 1, 0.5, 0.5];\n                break;\n            case 'ThinThickThinLargeGap':\n                borderLineArray = [-0.75, 1, -1.5, 1, -0.75];\n                break;\n            case 'Emboss3D':\n            case 'Engrave3D':\n                borderLineArray = [0.25, 0, 1, 0, 0.25];\n                break;\n        }\n        if (borderLineArray.length === 1) {\n            return [lineWidth];\n        }\n        for (var i = 0; i < borderLineArray.length; i++) {\n            if (borderLineArray[i] >= 0) {\n                borderLineArray[i] = borderLineArray[i] * lineWidth;\n            }\n            else {\n                borderLineArray[i] = Math.abs(borderLineArray[i]);\n            }\n        }\n        return borderLineArray;\n    };\n    WBorder.prototype.getBorderWeight = function () {\n        var weight = 0;\n        var numberOfLines = this.getNumberOfLines();\n        var borderNumber = this.getBorderNumber();\n        switch (this.lineStyle) {\n            case 'Single':\n            case 'DashSmallGap':\n            case 'DashDot':\n            case 'DashDotDot':\n            case 'Double':\n            case 'Triple':\n            case 'ThinThickSmallGap':\n            case 'ThickThinSmallGap':\n            case 'ThinThickThinSmallGap':\n            case 'ThinThickMediumGap':\n            case 'ThickThinMediumGap':\n            case 'ThinThickThinMediumGap':\n            case 'ThinThickLargeGap':\n            case 'ThickThinLargeGap':\n            case 'ThinThickThinLargeGap':\n            case 'SingleWavy':\n            case 'DoubleWavy':\n            case 'DashDotStroked':\n            case 'Emboss3D':\n            case 'Engrave3D':\n            case 'Outset':\n            case 'Inset':\n            case 'Thick':\n                weight = numberOfLines * borderNumber;\n                break;\n            case 'Dot':\n            case 'DashLargeGap':\n                weight = 1;\n                break;\n        }\n        return weight;\n    };\n    WBorder.prototype.getBorderNumber = function () {\n        var borderNumber = 0;\n        switch (this.lineStyle) {\n            case 'Single':\n                borderNumber = 1;\n                break;\n            case 'Thick':\n                borderNumber = 2;\n                break;\n            case 'Double':\n                borderNumber = 3;\n                break;\n            case 'Dot':\n                borderNumber = 4;\n                break;\n            case 'DashLargeGap'://dashed.\n                borderNumber = 5;\n                break;\n            case 'DashDot':\n                borderNumber = 6;\n                break;\n            case 'DashDotDot':\n                borderNumber = 7;\n                break;\n            case 'Triple':\n                borderNumber = 8;\n                break;\n            case 'ThinThickSmallGap':\n                borderNumber = 9;\n                break;\n            case 'ThickThinSmallGap':\n                borderNumber = 10;\n                break;\n            case 'ThinThickThinSmallGap':\n                borderNumber = 11;\n                break;\n            case 'ThinThickMediumGap':\n                borderNumber = 12;\n                break;\n            case 'ThickThinMediumGap':\n                borderNumber = 13;\n                break;\n            case 'ThinThickThinMediumGap':\n                borderNumber = 14;\n                break;\n            case 'ThinThickLargeGap':\n                borderNumber = 15;\n                break;\n            case 'ThickThinLargeGap':\n                borderNumber = 16;\n                break;\n            case 'ThinThickThinLargeGap':\n                borderNumber = 17;\n                break;\n            case 'SingleWavy'://wave.\n                borderNumber = 18;\n                break;\n            case 'DoubleWavy':\n                borderNumber = 19;\n                break;\n            case 'DashSmallGap':\n                borderNumber = 20;\n                break;\n            case 'DashDotStroked':\n                borderNumber = 21;\n                break;\n            case 'Emboss3D':\n                borderNumber = 22;\n                break;\n            case 'Engrave3D':\n                borderNumber = 23;\n                break;\n            case 'Outset':\n                borderNumber = 24;\n                break;\n            case 'Inset':\n                borderNumber = 25;\n                break;\n        }\n        return borderNumber;\n    };\n    WBorder.prototype.getNumberOfLines = function () {\n        //ToDo: Need to analyze more on this.\n        var value = 0;\n        switch (this.lineStyle) {\n            case 'Single':\n            case 'Dot':\n            case 'DashSmallGap':\n            case 'DashLargeGap':\n            case 'DashDot':\n            case 'DashDotDot':\n                value = 1;\n                break;\n            case 'Double':\n                value = 3;\n                break;\n            case 'Triple':\n                value = 5;\n                break;\n            case 'ThinThickSmallGap':\n                value = 3;\n                break;\n            case 'ThickThinSmallGap':\n                value = 3;\n                break;\n            case 'ThinThickThinSmallGap':\n                value = 5;\n                break;\n            case 'ThinThickMediumGap':\n                value = 3;\n                break;\n            case 'ThickThinMediumGap':\n                value = 3;\n                break;\n            case 'ThinThickThinMediumGap':\n                value = 5;\n                break;\n            case 'ThinThickLargeGap':\n                value = 3;\n                break;\n            case 'ThickThinLargeGap':\n                value = 3;\n                break;\n            case 'ThinThickThinLargeGap':\n                value = 5;\n                break;\n            case 'SingleWavy':\n                value = 1;\n                break;\n            case 'DoubleWavy':\n                value = 2;\n                break;\n            case 'DashDotStroked':\n                value = 1;\n                break;\n            case 'Emboss3D':\n            case 'Engrave3D':\n                value = 3;\n                break;\n            case 'Outset':\n            case 'Inset':\n            case 'Thick':\n                value = 1;\n                break;\n        }\n        return value;\n    };\n    WBorder.prototype.getPrecedence = function () {\n        var value = 0;\n        switch (this.lineStyle) {\n            case 'Single':\n                value = 1;\n                break;\n            case 'Thick':\n                value = 2;\n                break;\n            case 'Double':\n                value = 3;\n                break;\n            case 'Dot':\n                value = 4;\n                break;\n            case 'DashLargeGap'://dashed.\n                value = 5;\n                break;\n            case 'DashDot':\n                value = 6;\n                break;\n            case 'DashDotDot':\n                value = 7;\n                break;\n            case 'Triple':\n                value = 8;\n                break;\n            case 'ThinThickSmallGap':\n                value = 9;\n                break;\n            case 'ThickThinSmallGap':\n                value = 10;\n                break;\n            case 'ThinThickThinSmallGap':\n                value = 11;\n                break;\n            case 'ThinThickMediumGap':\n                value = 12;\n                break;\n            case 'ThickThinMediumGap':\n                value = 13;\n                break;\n            case 'ThinThickThinMediumGap':\n                value = 14;\n                break;\n            case 'ThinThickLargeGap':\n                value = 15;\n                break;\n            case 'ThickThinLargeGap':\n                value = 16;\n                break;\n            case 'ThinThickThinLargeGap':\n                value = 17;\n                break;\n            case 'SingleWavy'://wave.\n                value = 18;\n                break;\n            case 'DoubleWavy':\n                value = 19;\n                break;\n            case 'DashSmallGap':\n                value = 20;\n                break;\n            case 'DashDotStroked':\n                value = 21;\n                break;\n            case 'Emboss3D':\n                value = 22;\n                break;\n            case 'Engrave3D':\n                value = 23;\n                break;\n            case 'Outset':\n                value = 24;\n                break;\n            case 'Inset':\n                value = 25;\n                break;\n        }\n        return value;\n    };\n    WBorder.prototype.hasValue = function (property) {\n        if (!isNullOrUndefined(this.uniqueBorderFormat)) {\n            var propertyType = WUniqueFormat.getPropertyType(this.uniqueBorderFormat.uniqueFormatType, property);\n            return this.uniqueBorderFormat.propertiesHash.containsKey(propertyType);\n        }\n        return false;\n    };\n    WBorder.prototype.cloneFormat = function () {\n        var border = new WBorder(undefined);\n        border.color = this.color;\n        border.lineStyle = this.lineStyle;\n        border.lineWidth = this.lineWidth;\n        border.shadow = this.shadow;\n        border.space = this.space;\n        return border;\n    };\n    WBorder.prototype.destroy = function () {\n        if (!isNullOrUndefined(this.uniqueBorderFormat)) {\n            WBorder.uniqueBorderFormats.remove(this.uniqueBorderFormat);\n        }\n        this.uniqueBorderFormat = undefined;\n    };\n    WBorder.prototype.copyFormat = function (border) {\n        if (!isNullOrUndefined(border) && !isNullOrUndefined(border.uniqueBorderFormat)) {\n            this.color = border.color;\n            this.lineStyle = border.lineStyle;\n            this.lineWidth = border.lineWidth;\n            this.shadow = border.shadow;\n            this.space = border.space;\n        }\n    };\n    WBorder.clear = function () {\n        this.uniqueBorderFormats.clear();\n    };\n    WBorder.uniqueBorderFormats = new WUniqueFormats();\n    WBorder.uniqueFormatType = 1;\n    return WBorder;\n}());\nexport { WBorder };\n","import { WBorder } from './border';\nimport { isNullOrUndefined } from '@syncfusion/ej2-base';\n/**\n * @private\n */\nvar WBorders = /** @class */ (function () {\n    function WBorders(node) {\n        this.leftIn = new WBorder(this);\n        this.rightIn = new WBorder(this);\n        this.topIn = new WBorder(this);\n        this.bottomIn = new WBorder(this);\n        this.horizontalIn = new WBorder(this);\n        this.verticalIn = new WBorder(this);\n        this.diagonalUpIn = new WBorder(this);\n        this.diagonalDownIn = new WBorder(this);\n        this.lineWidthIn = 0;\n        this.ownerBase = node;\n    }\n    Object.defineProperty(WBorders.prototype, \"left\", {\n        get: function () {\n            return this.leftIn;\n        },\n        set: function (value) {\n            this.leftIn = value;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(WBorders.prototype, \"right\", {\n        get: function () {\n            return this.rightIn;\n        },\n        set: function (value) {\n            this.rightIn = value;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(WBorders.prototype, \"top\", {\n        get: function () {\n            return this.topIn;\n        },\n        set: function (value) {\n            this.topIn = value;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(WBorders.prototype, \"bottom\", {\n        get: function () {\n            return this.bottomIn;\n        },\n        set: function (value) {\n            this.bottomIn = value;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(WBorders.prototype, \"horizontal\", {\n        get: function () {\n            return this.horizontalIn;\n        },\n        set: function (value) {\n            this.horizontalIn = value;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(WBorders.prototype, \"vertical\", {\n        get: function () {\n            return this.verticalIn;\n        },\n        set: function (value) {\n            this.verticalIn = value;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(WBorders.prototype, \"diagonalUp\", {\n        get: function () {\n            return this.diagonalUpIn;\n        },\n        set: function (value) {\n            this.diagonalUpIn = value;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(WBorders.prototype, \"diagonalDown\", {\n        get: function () {\n            return this.diagonalDownIn;\n        },\n        set: function (value) {\n            this.diagonalDownIn = value;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    WBorders.prototype.destroy = function () {\n        if (!isNullOrUndefined(this.left)) {\n            this.left.destroy();\n        }\n        if (!isNullOrUndefined(this.top)) {\n            this.top.destroy();\n        }\n        if (!isNullOrUndefined(this.bottom)) {\n            this.bottom.destroy();\n        }\n        if (!isNullOrUndefined(this.right)) {\n            this.right.destroy();\n        }\n        if (!isNullOrUndefined(this.horizontal)) {\n            this.horizontal.destroy();\n        }\n        if (!isNullOrUndefined(this.vertical)) {\n            this.vertical.destroy();\n        }\n        if (!isNullOrUndefined(this.diagonalDown)) {\n            this.diagonalDown.destroy();\n        }\n        if (!isNullOrUndefined(this.diagonalUp)) {\n            this.diagonalUp.destroy();\n        }\n        this.topIn = undefined;\n        this.bottomIn = undefined;\n        this.leftIn = undefined;\n        this.rightIn = undefined;\n        this.horizontalIn = undefined;\n        this.verticalIn = undefined;\n        this.diagonalDownIn = undefined;\n        this.diagonalUpIn = undefined;\n        this.lineWidthIn = undefined;\n        this.valueIn = undefined;\n    };\n    WBorders.prototype.cloneFormat = function () {\n        var borders = new WBorders(undefined);\n        borders.top = isNullOrUndefined(this.top) ? undefined : this.top.cloneFormat();\n        borders.bottom = isNullOrUndefined(this.bottom) ? undefined : this.bottom.cloneFormat();\n        borders.left = isNullOrUndefined(this.left) ? undefined : this.left.cloneFormat();\n        borders.right = isNullOrUndefined(this.right) ? undefined : this.right.cloneFormat();\n        borders.horizontal = isNullOrUndefined(this.horizontal) ? undefined : this.horizontal.cloneFormat();\n        borders.vertical = isNullOrUndefined(this.vertical) ? undefined : this.vertical.cloneFormat();\n        borders.diagonalUp = isNullOrUndefined(this.diagonalUp) ? undefined : this.diagonalUp.cloneFormat();\n        borders.diagonalDown = isNullOrUndefined(this.diagonalDown) ? undefined : this.diagonalDown.cloneFormat();\n        return borders;\n    };\n    WBorders.prototype.copyFormat = function (borders) {\n        if (!isNullOrUndefined(borders.left) && borders.left instanceof WBorder) {\n            this.left = new WBorder(this);\n            this.left.copyFormat(borders.left);\n        }\n        if (!isNullOrUndefined(borders.right) && borders.right instanceof WBorder) {\n            this.right = new WBorder(this);\n            this.right.copyFormat(borders.right);\n        }\n        if (!isNullOrUndefined(borders.top) && borders.top instanceof WBorder) {\n            this.top = new WBorder(this);\n            this.top.copyFormat(borders.top);\n        }\n        if (!isNullOrUndefined(borders.bottom) && borders.bottom instanceof WBorder) {\n            this.bottom = new WBorder(this);\n            this.bottom.copyFormat(borders.bottom);\n        }\n        if (!isNullOrUndefined(borders.horizontal) && borders.horizontal instanceof WBorder) {\n            this.horizontal = new WBorder(this);\n            this.horizontal.copyFormat(borders.horizontal);\n        }\n        if (!isNullOrUndefined(borders.vertical) && borders.vertical instanceof WBorder) {\n            this.vertical = new WBorder(this);\n            this.vertical.copyFormat(borders.vertical);\n        }\n        if (!isNullOrUndefined(borders.diagonalDown) && borders.diagonalDown instanceof WBorder) {\n            this.diagonalDown = new WBorder(this);\n            this.diagonalDown.copyFormat(borders.diagonalDown);\n        }\n        if (!isNullOrUndefined(borders.diagonalUp) && borders.diagonalUp instanceof WBorder) {\n            this.diagonalUp = new WBorder(this);\n            this.diagonalUp.copyFormat(borders.diagonalUp);\n        }\n    };\n    return WBorders;\n}());\nexport { WBorders };\n","import { isNullOrUndefined } from '@syncfusion/ej2-base';\nimport { WUniqueFormat } from '../../base/unique-format';\nimport { WUniqueFormats } from '../../base/unique-formats';\nimport { Dictionary } from '../../base/dictionary';\n/**\n * @private\n */\nvar WShading = /** @class */ (function () {\n    function WShading(node) {\n        this.uniqueShadingFormat = undefined;\n        this.ownerBase = undefined;\n        this.ownerBase = node;\n    }\n    Object.defineProperty(WShading.prototype, \"backgroundColor\", {\n        get: function () {\n            return this.getPropertyValue('backgroundColor');\n        },\n        set: function (value) {\n            this.setPropertyValue('backgroundColor', value);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(WShading.prototype, \"foregroundColor\", {\n        get: function () {\n            return this.getPropertyValue('foregroundColor');\n        },\n        set: function (value) {\n            this.setPropertyValue('foregroundColor', value);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(WShading.prototype, \"textureStyle\", {\n        get: function () {\n            return this.getPropertyValue('textureStyle');\n        },\n        set: function (value) {\n            this.setPropertyValue('textureStyle', value);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    WShading.prototype.getPropertyValue = function (property) {\n        var hasValue = this.hasValue(property);\n        if (hasValue) {\n            var propertyType = WUniqueFormat.getPropertyType(WShading.uniqueFormatType, property);\n            if (!isNullOrUndefined(this.uniqueShadingFormat) && this.uniqueShadingFormat.propertiesHash.containsKey(propertyType)) {\n                return this.uniqueShadingFormat.propertiesHash.get(propertyType);\n            }\n        }\n        return WShading.getPropertyDefaultValue(property);\n    };\n    WShading.prototype.setPropertyValue = function (property, value) {\n        if (isNullOrUndefined(value) || value === '') {\n            value = WShading.getPropertyDefaultValue(property);\n        }\n        if (isNullOrUndefined(this.uniqueShadingFormat)) {\n            this.initializeUniqueShading(property, value);\n        }\n        else {\n            var propertyType = WUniqueFormat.getPropertyType(this.uniqueShadingFormat.uniqueFormatType, property);\n            if (this.uniqueShadingFormat.propertiesHash.containsKey(propertyType) &&\n                this.uniqueShadingFormat.propertiesHash.get(propertyType) === value) {\n                //Do nothing, since no change in property value and return\n                return;\n            }\n            this.uniqueShadingFormat = WShading.uniqueShadingFormats.updateUniqueFormat(this.uniqueShadingFormat, property, value);\n        }\n    };\n    WShading.getPropertyDefaultValue = function (property) {\n        var value = undefined;\n        switch (property) {\n            case 'backgroundColor':\n                value = '#ffffff';\n                break;\n            case 'foregroundColor':\n                value = 'empty';\n                break;\n            case 'textureStyle':\n                value = 'TextureNone';\n                break;\n        }\n        return value;\n    };\n    WShading.prototype.initializeUniqueShading = function (property, propValue) {\n        var uniqueShadingTemp = new Dictionary();\n        this.addUniqueShading('backgroundColor', property, propValue, uniqueShadingTemp);\n        this.addUniqueShading('foregroundColor', property, propValue, uniqueShadingTemp);\n        this.addUniqueShading('textureStyle', property, propValue, uniqueShadingTemp);\n        // tslint:disable-next-line:max-line-length        \n        this.uniqueShadingFormat = WShading.uniqueShadingFormats.addUniqueFormat(uniqueShadingTemp, WShading.uniqueFormatType);\n    };\n    // tslint:disable-next-line:max-line-length\n    WShading.prototype.addUniqueShading = function (property, modifiedProperty, propValue, uniqueShadingTemp) {\n        var propertyType;\n        propertyType = WUniqueFormat.getPropertyType(WShading.uniqueFormatType, property);\n        if (property === modifiedProperty) {\n            uniqueShadingTemp.add(propertyType, propValue);\n        }\n        else {\n            uniqueShadingTemp.add(propertyType, WShading.getPropertyDefaultValue(property));\n        }\n    };\n    WShading.prototype.destroy = function () {\n        if (!isNullOrUndefined(this.uniqueShadingFormat)) {\n            WShading.uniqueShadingFormats.remove(this.uniqueShadingFormat);\n        }\n        this.uniqueShadingFormat = undefined;\n    };\n    WShading.prototype.cloneFormat = function () {\n        var shading = new WShading(undefined);\n        shading.backgroundColor = this.backgroundColor;\n        shading.foregroundColor = this.foregroundColor;\n        shading.textureStyle = this.textureStyle;\n        return shading;\n    };\n    WShading.prototype.copyFormat = function (shading) {\n        if (!isNullOrUndefined(shading) && !isNullOrUndefined(shading.uniqueShadingFormat)) {\n            this.backgroundColor = shading.backgroundColor;\n            this.foregroundColor = shading.foregroundColor;\n            this.textureStyle = shading.textureStyle;\n        }\n    };\n    WShading.prototype.hasValue = function (property) {\n        if (!isNullOrUndefined(this.uniqueShadingFormat)) {\n            var propertyType = WUniqueFormat.getPropertyType(this.uniqueShadingFormat.uniqueFormatType, property);\n            return this.uniqueShadingFormat.propertiesHash.containsKey(propertyType);\n        }\n        return false;\n    };\n    WShading.clear = function () {\n        this.uniqueShadingFormats.clear();\n    };\n    WShading.uniqueShadingFormats = new WUniqueFormats();\n    WShading.uniqueFormatType = 5;\n    return WShading;\n}());\nexport { WShading };\n","import { Dictionary } from '../../base/dictionary';\nimport { WUniqueFormat } from '../../base/unique-format';\nimport { WUniqueFormats } from '../../base/unique-formats';\nimport { WBorders } from './borders';\nimport { WShading } from './shading';\nimport { isNullOrUndefined } from '@syncfusion/ej2-base';\n/**\n * @private\n */\nvar WTableFormat = /** @class */ (function () {\n    function WTableFormat(owner) {\n        this.uniqueTableFormat = undefined;\n        this.borders = new WBorders(this);\n        this.shading = new WShading(this);\n        this.ownerBase = undefined;\n        this.ownerBase = owner;\n        this.assignTableMarginValue(5.4, 0, 5.4, 0);\n    }\n    Object.defineProperty(WTableFormat.prototype, \"cellSpacing\", {\n        get: function () {\n            return this.getPropertyValue('cellSpacing');\n        },\n        set: function (value) {\n            if (value < 0 || value > 264.6) {\n                throw new RangeError('The measurement must be between 0 px and 264.6 px.');\n            }\n            this.setPropertyValue('cellSpacing', value);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(WTableFormat.prototype, \"leftMargin\", {\n        get: function () {\n            return this.getPropertyValue('leftMargin');\n        },\n        set: function (value) {\n            this.setPropertyValue('leftMargin', value);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(WTableFormat.prototype, \"topMargin\", {\n        get: function () {\n            return this.getPropertyValue('topMargin');\n        },\n        set: function (value) {\n            this.setPropertyValue('topMargin', value);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(WTableFormat.prototype, \"rightMargin\", {\n        get: function () {\n            return this.getPropertyValue('rightMargin');\n        },\n        set: function (value) {\n            this.setPropertyValue('rightMargin', value);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(WTableFormat.prototype, \"bottomMargin\", {\n        get: function () {\n            return this.getPropertyValue('bottomMargin');\n        },\n        set: function (value) {\n            this.setPropertyValue('bottomMargin', value);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(WTableFormat.prototype, \"leftIndent\", {\n        get: function () {\n            return this.getPropertyValue('leftIndent');\n        },\n        set: function (value) {\n            if (value < -1440 || value > 1440) {\n                throw new RangeError('The measurement must be between -1440 px and 1440 px.');\n            }\n            this.setPropertyValue('leftIndent', value);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(WTableFormat.prototype, \"tableAlignment\", {\n        get: function () {\n            return this.getPropertyValue('tableAlignment');\n        },\n        set: function (value) {\n            this.setPropertyValue('tableAlignment', value);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(WTableFormat.prototype, \"preferredWidth\", {\n        get: function () {\n            return this.getPropertyValue('preferredWidth');\n        },\n        set: function (value) {\n            this.setPropertyValue('preferredWidth', value);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(WTableFormat.prototype, \"preferredWidthType\", {\n        get: function () {\n            return this.getPropertyValue('preferredWidthType');\n        },\n        set: function (value) {\n            this.setPropertyValue('preferredWidthType', value);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    WTableFormat.prototype.getPropertyValue = function (property) {\n        var hasValue = this.hasValue(property);\n        if (hasValue) {\n            var propertyType = WUniqueFormat.getPropertyType(WTableFormat.uniqueFormatType, property);\n            if (!isNullOrUndefined(this.uniqueTableFormat) && this.uniqueTableFormat.propertiesHash.containsKey(propertyType)) {\n                return this.uniqueTableFormat.propertiesHash.get(propertyType);\n            }\n        }\n        return WTableFormat.getPropertyDefaultValue(property);\n    };\n    WTableFormat.prototype.setPropertyValue = function (property, value) {\n        if (isNullOrUndefined(value) || value === '') {\n            value = WTableFormat.getPropertyDefaultValue(property);\n        }\n        if (isNullOrUndefined(this.uniqueTableFormat)) {\n            this.initializeUniqueTableFormat(property, value);\n        }\n        else {\n            var propertyType = WUniqueFormat.getPropertyType(this.uniqueTableFormat.uniqueFormatType, property);\n            if (this.uniqueTableFormat.propertiesHash.containsKey(propertyType) &&\n                this.uniqueTableFormat.propertiesHash.get(propertyType) === value) {\n                //Do nothing, since no change in property value and return\n                return;\n            }\n            this.uniqueTableFormat = WTableFormat.uniqueTableFormats.updateUniqueFormat(this.uniqueTableFormat, property, value);\n        }\n    };\n    WTableFormat.prototype.initializeUniqueTableFormat = function (property, propValue) {\n        var uniqueTableFormatTemp = new Dictionary();\n        this.addUniqueTableFormat('cellSpacing', property, propValue, uniqueTableFormatTemp);\n        this.addUniqueTableFormat('leftMargin', property, propValue, uniqueTableFormatTemp);\n        this.addUniqueTableFormat('topMargin', property, propValue, uniqueTableFormatTemp);\n        this.addUniqueTableFormat('bottomMargin', property, propValue, uniqueTableFormatTemp);\n        this.addUniqueTableFormat('rightMargin', property, propValue, uniqueTableFormatTemp);\n        this.addUniqueTableFormat('leftIndent', property, propValue, uniqueTableFormatTemp);\n        this.addUniqueTableFormat('tableAlignment', property, propValue, uniqueTableFormatTemp);\n        this.addUniqueTableFormat('preferredWidth', property, propValue, uniqueTableFormatTemp);\n        this.addUniqueTableFormat('preferredWidthType', property, propValue, uniqueTableFormatTemp);\n        this.uniqueTableFormat = WTableFormat.uniqueTableFormats.addUniqueFormat(uniqueTableFormatTemp, WTableFormat.uniqueFormatType);\n    };\n    // tslint:disable-next-line:max-line-length\n    WTableFormat.prototype.addUniqueTableFormat = function (property, modifiedProperty, propValue, uniqueTableFormatTemp) {\n        var propertyType;\n        propertyType = WUniqueFormat.getPropertyType(WTableFormat.uniqueFormatType, property);\n        if (property === modifiedProperty) {\n            uniqueTableFormatTemp.add(propertyType, propValue);\n        }\n    };\n    WTableFormat.getPropertyDefaultValue = function (property) {\n        var value = undefined;\n        switch (property) {\n            case 'cellSpacing':\n                value = 0;\n                break;\n            case 'leftMargin':\n                value = 5.4;\n                break;\n            case 'topMargin':\n                value = 0;\n                break;\n            case 'bottomMargin':\n                value = 0;\n                break;\n            case 'rightMargin':\n                value = 5.4;\n                break;\n            case 'leftIndent':\n                value = 0;\n                break;\n            case 'tableAlignment':\n                value = 'Left';\n                break;\n            case 'preferredWidth':\n                value = 0;\n                break;\n            case 'preferredWidthType':\n                value = 'Point';\n                break;\n        }\n        return value;\n    };\n    WTableFormat.prototype.assignTableMarginValue = function (left, top, right, bottom) {\n        this.leftMargin = left;\n        this.topMargin = top;\n        this.rightMargin = right;\n        this.bottomMargin = bottom;\n    };\n    WTableFormat.prototype.initializeTableBorders = function () {\n        this.borders.left.lineStyle = 'Single';\n        this.borders.left.lineWidth = 0.5;\n        this.borders.right.lineStyle = 'Single';\n        this.borders.right.lineWidth = 0.5;\n        this.borders.top.lineStyle = 'Single';\n        this.borders.top.lineWidth = 0.5;\n        this.borders.bottom.lineStyle = 'Single';\n        this.borders.bottom.lineWidth = 0.5;\n        this.borders.horizontal.lineStyle = 'Single';\n        this.borders.horizontal.lineWidth = 0.5;\n        this.borders.vertical.lineStyle = 'Single';\n        this.borders.vertical.lineWidth = 0.5;\n    };\n    WTableFormat.prototype.destroy = function () {\n        if (!isNullOrUndefined(this.borders)) {\n            this.borders.destroy();\n        }\n        if (!isNullOrUndefined(this.shading)) {\n            this.shading.destroy();\n        }\n        if (!isNullOrUndefined(this.uniqueTableFormat)) {\n            WTableFormat.uniqueTableFormats.remove(this.uniqueTableFormat);\n        }\n        this.uniqueTableFormat = undefined;\n        this.borders = undefined;\n        this.shading = undefined;\n    };\n    WTableFormat.prototype.cloneFormat = function () {\n        var tableFormat = new WTableFormat(undefined);\n        tableFormat.leftIndent = this.leftIndent;\n        tableFormat.tableAlignment = this.tableAlignment;\n        tableFormat.cellSpacing = this.cellSpacing;\n        tableFormat.leftMargin = this.leftMargin;\n        tableFormat.rightMargin = this.rightMargin;\n        tableFormat.topMargin = this.topMargin;\n        tableFormat.bottomMargin = this.bottomMargin;\n        tableFormat.preferredWidth = this.preferredWidth;\n        tableFormat.preferredWidthType = this.preferredWidthType;\n        tableFormat.borders = isNullOrUndefined(this.borders) ? undefined : this.borders.cloneFormat();\n        tableFormat.shading = isNullOrUndefined(this.shading) ? undefined : this.shading.cloneFormat();\n        return tableFormat;\n    };\n    WTableFormat.prototype.hasValue = function (property) {\n        if (!isNullOrUndefined(this.uniqueTableFormat)) {\n            var propertyType = WUniqueFormat.getPropertyType(this.uniqueTableFormat.uniqueFormatType, property);\n            return this.uniqueTableFormat.propertiesHash.containsKey(propertyType);\n        }\n        return false;\n    };\n    WTableFormat.prototype.copyFormat = function (format) {\n        if (!isNullOrUndefined(format)) {\n            if (!isNullOrUndefined(format.uniqueTableFormat)) {\n                this.cellSpacing = format.cellSpacing;\n                this.leftMargin = format.leftMargin;\n                this.topMargin = format.topMargin;\n                this.rightMargin = format.rightMargin;\n                this.bottomMargin = format.bottomMargin;\n                this.leftIndent = format.leftIndent;\n                this.tableAlignment = format.tableAlignment;\n                this.preferredWidth = format.preferredWidth;\n                this.preferredWidthType = format.preferredWidthType;\n            }\n            if (!isNullOrUndefined(format.borders)) {\n                this.borders = new WBorders(this);\n                this.borders.copyFormat(format.borders);\n            }\n            if (!isNullOrUndefined(format.shading)) {\n                this.shading = new WShading(this);\n                this.shading.copyFormat(format.shading);\n            }\n        }\n    };\n    WTableFormat.clear = function () {\n        this.uniqueTableFormats.clear();\n    };\n    WTableFormat.uniqueTableFormats = new WUniqueFormats();\n    WTableFormat.uniqueFormatType = 8;\n    return WTableFormat;\n}());\nexport { WTableFormat };\n","import { isNullOrUndefined } from '@syncfusion/ej2-base';\nimport { Dictionary } from '../../base/dictionary';\nimport { WUniqueFormat } from '../../base/unique-format';\nimport { WUniqueFormats } from '../../base/unique-formats';\nimport { WBorders } from './borders';\n/**\n * @private\n */\nvar WRowFormat = /** @class */ (function () {\n    function WRowFormat(node) {\n        this.uniqueRowFormat = undefined;\n        /**\n         * @private\n         */\n        this.borders = new WBorders(this);\n        /**\n         * @private\n         */\n        this.ownerBase = undefined;\n        /**\n         * @private\n         */\n        this.beforeWidth = 0;\n        /**\n         * @private\n         */\n        this.afterWidth = 0;\n        this.ownerBase = node;\n    }\n    Object.defineProperty(WRowFormat.prototype, \"gridBefore\", {\n        get: function () {\n            return this.getPropertyValue('gridBefore');\n        },\n        set: function (value) {\n            this.setPropertyValue('gridBefore', value);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(WRowFormat.prototype, \"gridBeforeWidth\", {\n        get: function () {\n            return this.getPropertyValue('gridBeforeWidth');\n        },\n        set: function (value) {\n            this.setPropertyValue('gridBeforeWidth', value);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(WRowFormat.prototype, \"gridBeforeWidthType\", {\n        get: function () {\n            return this.getPropertyValue('gridBeforeWidthType');\n        },\n        set: function (value) {\n            this.setPropertyValue('gridBeforeWidthType', value);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(WRowFormat.prototype, \"gridAfter\", {\n        get: function () {\n            return this.getPropertyValue('gridAfter');\n        },\n        set: function (value) {\n            this.setPropertyValue('gridAfter', value);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(WRowFormat.prototype, \"gridAfterWidth\", {\n        get: function () {\n            return this.getPropertyValue('gridAfterWidth');\n        },\n        set: function (value) {\n            this.setPropertyValue('gridAfterWidth', value);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(WRowFormat.prototype, \"gridAfterWidthType\", {\n        get: function () {\n            return this.getPropertyValue('gridAfterWidthType');\n        },\n        set: function (value) {\n            this.setPropertyValue('gridAfterWidthType', value);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(WRowFormat.prototype, \"allowBreakAcrossPages\", {\n        get: function () {\n            return this.getPropertyValue('allowBreakAcrossPages');\n        },\n        set: function (value) {\n            this.setPropertyValue('allowBreakAcrossPages', value);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(WRowFormat.prototype, \"isHeader\", {\n        get: function () {\n            return this.getPropertyValue('isHeader');\n        },\n        set: function (value) {\n            this.setPropertyValue('isHeader', value);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(WRowFormat.prototype, \"height\", {\n        get: function () {\n            return this.getPropertyValue('height');\n        },\n        set: function (value) {\n            if (value === 0 && (this.heightType === 'AtLeast' || this.heightType === 'Exactly')) {\n                value = 1;\n            }\n            else if (this.heightType === 'Auto') {\n                value = 0;\n            }\n            this.setPropertyValue('height', value);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(WRowFormat.prototype, \"heightType\", {\n        get: function () {\n            return this.getPropertyValue('heightType');\n        },\n        set: function (value) {\n            if (value === 'AtLeast' || value === 'Exactly') {\n                this.height = 1;\n            }\n            else {\n                this.height = 0;\n            }\n            this.setPropertyValue('heightType', value);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    WRowFormat.prototype.getPropertyValue = function (property) {\n        var hasValue = this.hasValue(property);\n        if (hasValue) {\n            var propertyType = WUniqueFormat.getPropertyType(WRowFormat.uniqueFormatType, property);\n            if (!isNullOrUndefined(this.uniqueRowFormat) && this.uniqueRowFormat.propertiesHash.containsKey(propertyType)) {\n                return this.uniqueRowFormat.propertiesHash.get(propertyType);\n            }\n        }\n        return WRowFormat.getPropertyDefaultValue(property);\n    };\n    WRowFormat.prototype.setPropertyValue = function (property, value) {\n        if (isNullOrUndefined(value) || value === '') {\n            value = WRowFormat.getPropertyDefaultValue(property);\n        }\n        if (isNullOrUndefined(this.uniqueRowFormat)) {\n            this.initializeUniqueRowFormat(property, value);\n        }\n        else {\n            var propertyType = WUniqueFormat.getPropertyType(this.uniqueRowFormat.uniqueFormatType, property);\n            if (this.uniqueRowFormat.propertiesHash.containsKey(propertyType) &&\n                this.uniqueRowFormat.propertiesHash.get(propertyType) === value) {\n                //Do nothing, since no change in property value and return\n                return;\n            }\n            this.uniqueRowFormat = WRowFormat.uniqueRowFormats.updateUniqueFormat(this.uniqueRowFormat, property, value);\n        }\n    };\n    WRowFormat.prototype.initializeUniqueRowFormat = function (property, propValue) {\n        var uniqueRowFormatTemp = new Dictionary();\n        this.addUniqueRowFormat('allowBreakAcrossPages', property, propValue, uniqueRowFormatTemp);\n        this.addUniqueRowFormat('isHeader', property, propValue, uniqueRowFormatTemp);\n        this.addUniqueRowFormat('height', property, propValue, uniqueRowFormatTemp);\n        this.addUniqueRowFormat('heightType', property, propValue, uniqueRowFormatTemp);\n        this.addUniqueRowFormat('gridBefore', property, propValue, uniqueRowFormatTemp);\n        this.addUniqueRowFormat('gridBeforeWidth', property, propValue, uniqueRowFormatTemp);\n        this.addUniqueRowFormat('gridBeforeWidthType', property, propValue, uniqueRowFormatTemp);\n        this.addUniqueRowFormat('gridAfter', property, propValue, uniqueRowFormatTemp);\n        this.addUniqueRowFormat('gridAfterWidth', property, propValue, uniqueRowFormatTemp);\n        this.addUniqueRowFormat('gridgridAfterWidth', property, propValue, uniqueRowFormatTemp);\n        this.addUniqueRowFormat('gridBeforeWidthType', property, propValue, uniqueRowFormatTemp);\n        this.uniqueRowFormat = WRowFormat.uniqueRowFormats.addUniqueFormat(uniqueRowFormatTemp, WRowFormat.uniqueFormatType);\n    };\n    // tslint:disable-next-line:max-line-length\n    WRowFormat.prototype.addUniqueRowFormat = function (property, modifiedProperty, propValue, uniqueRowFormatTemp) {\n        var propertyType;\n        propertyType = WUniqueFormat.getPropertyType(WRowFormat.uniqueFormatType, property);\n        if (property === modifiedProperty) {\n            uniqueRowFormatTemp.add(propertyType, propValue);\n        }\n    };\n    WRowFormat.getPropertyDefaultValue = function (property) {\n        var value = undefined;\n        switch (property) {\n            case 'allowBreakAcrossPages':\n                value = true;\n                break;\n            case 'isHeader':\n                value = false;\n                break;\n            case 'height':\n                value = 0;\n                break;\n            case 'heightType':\n                value = 'Auto';\n                break;\n            case 'gridBefore':\n                value = 0;\n                break;\n            case 'gridBeforeWidth':\n                value = 0;\n                break;\n            case 'gridBeforeWidthType':\n                value = 'Point';\n                break;\n            case 'gridAfter':\n                value = 0;\n                break;\n            case 'gridAfterWidth':\n                value = 0;\n                break;\n            case 'gridAfterWidthType':\n                value = 'Point';\n                break;\n        }\n        return value;\n    };\n    WRowFormat.prototype.cloneFormat = function () {\n        var format = new WRowFormat();\n        format.allowBreakAcrossPages = this.allowBreakAcrossPages;\n        format.heightType = this.heightType;\n        format.height = this.height;\n        format.isHeader = this.isHeader;\n        format.gridBefore = this.gridBefore;\n        format.gridBeforeWidth = this.gridBeforeWidth;\n        format.gridBeforeWidthType = this.gridBeforeWidthType;\n        format.gridAfter = this.gridAfter;\n        format.gridAfterWidth = this.gridAfterWidth;\n        format.gridAfterWidthType = this.gridAfterWidthType;\n        return format;\n    };\n    WRowFormat.prototype.hasValue = function (property) {\n        if (!isNullOrUndefined(this.uniqueRowFormat)) {\n            var propertyType = WUniqueFormat.getPropertyType(this.uniqueRowFormat.uniqueFormatType, property);\n            return this.uniqueRowFormat.propertiesHash.containsKey(propertyType);\n        }\n        return false;\n    };\n    WRowFormat.prototype.copyFormat = function (format) {\n        if (!isNullOrUndefined(format)) {\n            if (!isNullOrUndefined(format.uniqueRowFormat)) {\n                this.allowBreakAcrossPages = format.allowBreakAcrossPages;\n                this.isHeader = format.isHeader;\n                this.heightType = format.heightType;\n                this.height = format.height;\n                this.gridBefore = format.gridBefore;\n                this.gridBeforeWidth = format.gridBeforeWidth;\n                this.gridBeforeWidthType = format.gridBeforeWidthType;\n                this.gridAfter = format.gridAfter;\n                this.gridAfterWidth = format.gridAfterWidth;\n                this.gridAfterWidthType = format.gridAfterWidthType;\n            }\n            if (!isNullOrUndefined(format.borders)) {\n                this.borders = new WBorders(this);\n                this.borders.ownerBase = format;\n                this.borders.copyFormat(format.borders);\n            }\n        }\n    };\n    WRowFormat.prototype.destroy = function () {\n        if (!isNullOrUndefined(this.borders)) {\n            this.borders.destroy();\n        }\n        if (!isNullOrUndefined(this.uniqueRowFormat)) {\n            WRowFormat.uniqueRowFormats.remove(this.uniqueRowFormat);\n        }\n        this.beforeWidth = undefined;\n        this.afterWidth = undefined;\n        this.borders = undefined;\n        this.uniqueRowFormat = undefined;\n    };\n    WRowFormat.clear = function () {\n        this.uniqueRowFormats.clear();\n    };\n    WRowFormat.uniqueRowFormats = new WUniqueFormats();\n    WRowFormat.uniqueFormatType = 6;\n    return WRowFormat;\n}());\nexport { WRowFormat };\n","import { isNullOrUndefined } from '@syncfusion/ej2-base';\nimport { Dictionary } from '../../base/dictionary';\nimport { WUniqueFormat } from '../../base/unique-format';\nimport { WUniqueFormats } from '../../base/unique-formats';\nimport { WBorders } from './borders';\nimport { WShading } from './shading';\n/**\n * @private\n */\nvar WCellFormat = /** @class */ (function () {\n    function WCellFormat(node) {\n        this.uniqueCellFormat = undefined;\n        this.borders = new WBorders(this);\n        this.shading = new WShading(this);\n        this.ownerBase = node;\n        this.borders = new WBorders(this);\n        this.shading = new WShading(this);\n    }\n    Object.defineProperty(WCellFormat.prototype, \"leftMargin\", {\n        get: function () {\n            return this.getPropertyValue('leftMargin');\n        },\n        set: function (value) {\n            this.setPropertyValue('leftMargin', value);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(WCellFormat.prototype, \"rightMargin\", {\n        get: function () {\n            return this.getPropertyValue('rightMargin');\n        },\n        set: function (value) {\n            this.setPropertyValue('rightMargin', value);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(WCellFormat.prototype, \"topMargin\", {\n        get: function () {\n            return this.getPropertyValue('topMargin');\n        },\n        set: function (value) {\n            this.setPropertyValue('topMargin', value);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(WCellFormat.prototype, \"bottomMargin\", {\n        get: function () {\n            return this.getPropertyValue('bottomMargin');\n        },\n        set: function (value) {\n            this.setPropertyValue('bottomMargin', value);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(WCellFormat.prototype, \"cellWidth\", {\n        get: function () {\n            return this.getPropertyValue('cellWidth');\n        },\n        set: function (value) {\n            this.setPropertyValue('cellWidth', value);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(WCellFormat.prototype, \"columnSpan\", {\n        get: function () {\n            return this.getPropertyValue('columnSpan');\n        },\n        set: function (value) {\n            this.setPropertyValue('columnSpan', value);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(WCellFormat.prototype, \"rowSpan\", {\n        get: function () {\n            return this.getPropertyValue('rowSpan');\n        },\n        set: function (value) {\n            this.setPropertyValue('rowSpan', value);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(WCellFormat.prototype, \"preferredWidth\", {\n        get: function () {\n            return this.getPropertyValue('preferredWidth');\n        },\n        set: function (value) {\n            this.setPropertyValue('preferredWidth', value);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(WCellFormat.prototype, \"verticalAlignment\", {\n        get: function () {\n            return this.getPropertyValue('verticalAlignment');\n        },\n        set: function (value) {\n            this.setPropertyValue('verticalAlignment', value);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(WCellFormat.prototype, \"preferredWidthType\", {\n        get: function () {\n            return this.getPropertyValue('preferredWidthType');\n        },\n        set: function (value) {\n            this.setPropertyValue('preferredWidthType', value);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    WCellFormat.prototype.getPropertyValue = function (property) {\n        var hasValue = this.hasValue(property);\n        if (hasValue) {\n            var propertyType = WUniqueFormat.getPropertyType(WCellFormat.uniqueFormatType, property);\n            if (!isNullOrUndefined(this.uniqueCellFormat) && this.uniqueCellFormat.propertiesHash.containsKey(propertyType)) {\n                return this.uniqueCellFormat.propertiesHash.get(propertyType);\n            }\n        }\n        return WCellFormat.getPropertyDefaultValue(property);\n    };\n    WCellFormat.prototype.setPropertyValue = function (property, value) {\n        if (isNullOrUndefined(value) || value === '') {\n            value = WCellFormat.getPropertyDefaultValue(property);\n        }\n        if (isNullOrUndefined(this.uniqueCellFormat)) {\n            this.initializeUniqueCellFormat(property, value);\n        }\n        else {\n            var propertyType = WUniqueFormat.getPropertyType(this.uniqueCellFormat.uniqueFormatType, property);\n            if (this.uniqueCellFormat.propertiesHash.containsKey(propertyType) &&\n                this.uniqueCellFormat.propertiesHash.get(propertyType) === value) {\n                //Do nothing, since no change in property value and return\n                return;\n            }\n            this.uniqueCellFormat = WCellFormat.uniqueCellFormats.updateUniqueFormat(this.uniqueCellFormat, property, value);\n        }\n    };\n    WCellFormat.prototype.initializeUniqueCellFormat = function (property, propValue) {\n        var uniqueCellFormatTemp = new Dictionary();\n        this.addUniqueCellFormat('leftMargin', property, propValue, uniqueCellFormatTemp);\n        this.addUniqueCellFormat('topMargin', property, propValue, uniqueCellFormatTemp);\n        this.addUniqueCellFormat('bottomMargin', property, propValue, uniqueCellFormatTemp);\n        this.addUniqueCellFormat('rightMargin', property, propValue, uniqueCellFormatTemp);\n        this.addUniqueCellFormat('cellWidth', property, propValue, uniqueCellFormatTemp);\n        this.addUniqueCellFormat('columnSpan', property, propValue, uniqueCellFormatTemp);\n        this.addUniqueCellFormat('rowSpan', property, propValue, uniqueCellFormatTemp);\n        this.addUniqueCellFormat('preferredWidth', property, propValue, uniqueCellFormatTemp);\n        this.addUniqueCellFormat('verticalAlignment', property, propValue, uniqueCellFormatTemp);\n        this.addUniqueCellFormat('preferredWidthType', property, propValue, uniqueCellFormatTemp);\n        this.uniqueCellFormat = WCellFormat.uniqueCellFormats.addUniqueFormat(uniqueCellFormatTemp, WCellFormat.uniqueFormatType);\n    };\n    // tslint:disable-next-line:max-line-length\n    WCellFormat.prototype.addUniqueCellFormat = function (property, modifiedProperty, propValue, uniqueCellFormatTemp) {\n        var propertyType;\n        propertyType = WUniqueFormat.getPropertyType(WCellFormat.uniqueFormatType, property);\n        if (property === modifiedProperty) {\n            uniqueCellFormatTemp.add(propertyType, propValue);\n        }\n    };\n    WCellFormat.getPropertyDefaultValue = function (property) {\n        var value = undefined;\n        switch (property) {\n            case 'leftMargin':\n                value = undefined;\n                break;\n            case 'topMargin':\n                value = undefined;\n                break;\n            case 'bottomMargin':\n                value = undefined;\n                break;\n            case 'rightMargin':\n                value = undefined;\n                break;\n            case 'cellWidth':\n                value = 0;\n                break;\n            case 'columnSpan':\n                value = 1;\n                break;\n            case 'rowSpan':\n                value = 1;\n                break;\n            case 'preferredWidth':\n                value = 0;\n                break;\n            case 'verticalAlignment':\n                value = 'Top';\n                break;\n            case 'preferredWidthType':\n                value = 'Point';\n                break;\n        }\n        return value;\n    };\n    WCellFormat.prototype.containsMargins = function () {\n        return (!isNullOrUndefined(this.leftMargin)\n            || !isNullOrUndefined(this.rightMargin)\n            || !isNullOrUndefined(this.bottomMargin)\n            || !isNullOrUndefined(this.topMargin));\n    };\n    WCellFormat.prototype.destroy = function () {\n        if (!isNullOrUndefined(this.borders)) {\n            this.borders.destroy();\n        }\n        if (!isNullOrUndefined(this.shading)) {\n            this.shading.destroy();\n        }\n        if (!isNullOrUndefined(this.uniqueCellFormat)) {\n            WCellFormat.uniqueCellFormats.remove(this.uniqueCellFormat);\n        }\n        this.uniqueCellFormat = undefined;\n        this.borders = undefined;\n        this.shading = undefined;\n    };\n    WCellFormat.prototype.cloneFormat = function () {\n        var format = new WCellFormat(undefined);\n        format.verticalAlignment = this.verticalAlignment;\n        format.leftMargin = this.leftMargin;\n        format.rightMargin = this.rightMargin;\n        format.topMargin = this.topMargin;\n        format.bottomMargin = this.bottomMargin;\n        format.preferredWidth = this.preferredWidth;\n        format.preferredWidthType = this.preferredWidthType;\n        format.cellWidth = this.cellWidth;\n        format.borders = isNullOrUndefined(this.borders) ? undefined : this.borders.cloneFormat();\n        format.shading = isNullOrUndefined(this.shading) ? undefined : this.shading.cloneFormat();\n        return format;\n    };\n    WCellFormat.prototype.hasValue = function (property) {\n        if (!isNullOrUndefined(this.uniqueCellFormat)) {\n            var propertyType = WUniqueFormat.getPropertyType(this.uniqueCellFormat.uniqueFormatType, property);\n            return this.uniqueCellFormat.propertiesHash.containsKey(propertyType);\n        }\n        return false;\n    };\n    WCellFormat.prototype.copyFormat = function (format) {\n        if (!isNullOrUndefined(format)) {\n            if (!isNullOrUndefined(format.uniqueCellFormat)) {\n                this.cellWidth = format.cellWidth;\n                this.leftMargin = format.leftMargin;\n                this.topMargin = format.topMargin;\n                this.rightMargin = format.rightMargin;\n                this.bottomMargin = format.bottomMargin;\n                this.preferredWidth = format.preferredWidth;\n                this.columnSpan = format.columnSpan;\n                this.rowSpan = format.rowSpan;\n                this.preferredWidthType = format.preferredWidthType;\n                this.verticalAlignment = format.verticalAlignment;\n            }\n            if (!isNullOrUndefined(format.shading)) {\n                this.shading = new WShading(this);\n                this.shading.copyFormat(format.shading);\n            }\n            if (!isNullOrUndefined(format.borders)) {\n                this.borders = new WBorders(this);\n                this.borders.copyFormat(format.borders);\n            }\n        }\n    };\n    WCellFormat.clear = function () {\n        this.uniqueCellFormats.clear();\n    };\n    WCellFormat.uniqueCellFormats = new WUniqueFormats();\n    WCellFormat.uniqueFormatType = 4;\n    return WCellFormat;\n}());\nexport { WCellFormat };\n","var __extends = (this && this.__extends) || (function () {\n    var extendStatics = Object.setPrototypeOf ||\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nimport { WTableFormat, WRowFormat, WCellFormat } from '../format/index';\nimport { WParagraphFormat, WCharacterFormat, WBorder, WBorders } from '../format/index';\nimport { isNullOrUndefined } from '@syncfusion/ej2-base';\nimport { Dictionary } from '../../base/dictionary';\nimport { HelperMethods } from '../editor/editor-helper';\n/**\n * @private\n */\nvar Rect = /** @class */ (function () {\n    function Rect(x, y, width, height) {\n        this.x = x;\n        this.y = y;\n        this.width = width;\n        this.height = height;\n    }\n    Object.defineProperty(Rect.prototype, \"right\", {\n        /**\n         * @private\n         */\n        get: function () {\n            return this.x + this.width;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(Rect.prototype, \"bottom\", {\n        /**\n         * @private\n         */\n        get: function () {\n            return this.y + this.height;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    return Rect;\n}());\nexport { Rect };\n/**\n * @private\n */\nvar Margin = /** @class */ (function () {\n    function Margin(leftMargin, topMargin, rightMargin, bottomMargin) {\n        this.left = leftMargin;\n        this.top = topMargin;\n        this.right = rightMargin;\n        this.bottom = bottomMargin;\n    }\n    /**\n     * @private\n     */\n    Margin.prototype.clone = function () {\n        return new Margin(this.left, this.top, this.right, this.bottom);\n    };\n    /**\n     * @private\n     */\n    Margin.prototype.destroy = function () {\n        this.left = undefined;\n        this.right = undefined;\n        this.top = undefined;\n        this.bottom = undefined;\n    };\n    return Margin;\n}());\nexport { Margin };\n/**\n * @private\n */\nvar Widget = /** @class */ (function () {\n    function Widget() {\n        /**\n         * @private\n         */\n        this.childWidgets = [];\n        /**\n         * @private\n         */\n        this.x = 0;\n        /**\n         * @private\n         */\n        this.y = 0;\n        /**\n         * @private\n         */\n        this.width = 0;\n        /**\n         * @private\n         */\n        this.height = 0;\n        /**\n         * @private\n         */\n        this.index = 0;\n    }\n    Object.defineProperty(Widget.prototype, \"indexInOwner\", {\n        /**\n         * @private\n         */\n        get: function () {\n            if (this instanceof BodyWidget && this.page) {\n                return this.page.bodyWidgets.indexOf(this);\n            }\n            else if (this.containerWidget && this.containerWidget.childWidgets) {\n                return this.containerWidget.childWidgets.indexOf(this);\n            }\n            return -1;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(Widget.prototype, \"firstChild\", {\n        /**\n         * @private\n         */\n        get: function () {\n            return this.childWidgets.length > 0 ? this.childWidgets[0] : undefined;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(Widget.prototype, \"lastChild\", {\n        /**\n         * @private\n         */\n        get: function () {\n            if (this.childWidgets) {\n                return this.childWidgets.length > 0 ?\n                    this.childWidgets[this.childWidgets.length - 1] : undefined;\n            }\n            return undefined;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(Widget.prototype, \"previousWidget\", {\n        /**\n         * @private\n         */\n        get: function () {\n            var widget = this;\n            var index = this.indexInOwner;\n            if (widget instanceof BodyWidget) {\n                widget = index > 0 ? widget.page.bodyWidgets[index - 1] : undefined;\n            }\n            else {\n                widget = index > 0 ? widget.containerWidget.childWidgets[index - 1] : undefined;\n            }\n            return widget;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(Widget.prototype, \"nextWidget\", {\n        /**\n         * @private\n         */\n        get: function () {\n            var widget = this;\n            var index = this.indexInOwner;\n            if (index === -1) {\n                return undefined;\n            }\n            if (widget instanceof BodyWidget) {\n                widget = index < widget.page.bodyWidgets.length - 1 ?\n                    widget.page.bodyWidgets[index + 1] : undefined;\n            }\n            else {\n                widget = index < widget.containerWidget.childWidgets.length - 1 ?\n                    widget.containerWidget.childWidgets[index + 1] : undefined;\n            }\n            return widget;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(Widget.prototype, \"previousRenderedWidget\", {\n        /**\n         * @private\n         */\n        get: function () {\n            var widget = this;\n            var index = this.indexInOwner;\n            if (index < 0) {\n                return undefined;\n            }\n            if (widget instanceof BodyWidget) {\n                if (index > 0) {\n                    widget = widget.page.bodyWidgets[index - 1];\n                }\n                else {\n                    var page = widget.page.previousPage;\n                    widget = page && page.bodyWidgets.length > 0 ? page.bodyWidgets[page.bodyWidgets.length - 1] : undefined;\n                }\n            }\n            else {\n                if (index > 0) {\n                    widget = widget.containerWidget.childWidgets[index - 1];\n                }\n                else {\n                    var previousContainer = undefined;\n                    if (widget.containerWidget instanceof TableCellWidget) {\n                        previousContainer = widget.containerWidget.getPreviousSplitWidget();\n                    }\n                    else if (!(widget.containerWidget instanceof TableRowWidget\n                        || widget.containerWidget instanceof HeaderFooterWidget)) {\n                        // Since cells are lay outed left to right, we should not navigate to previous row.\n                        previousContainer = widget.containerWidget.previousRenderedWidget;\n                    }\n                    while (previousContainer && previousContainer.childWidgets.length === 0) {\n                        previousContainer = previousContainer.previousRenderedWidget;\n                        if (isNullOrUndefined(previousContainer)) {\n                            break;\n                        }\n                    }\n                    widget = previousContainer && previousContainer.constructor === widget.containerWidget.constructor ?\n                        previousContainer.lastChild : undefined;\n                }\n            }\n            return widget;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(Widget.prototype, \"nextRenderedWidget\", {\n        /**\n         * @private\n         */\n        get: function () {\n            var widget = this;\n            var index = this.indexInOwner;\n            if (index < 0) {\n                return undefined;\n            }\n            if (widget instanceof BodyWidget) {\n                if (index < widget.page.bodyWidgets.length - 1) {\n                    widget = widget.page.bodyWidgets[index + 1];\n                }\n                else {\n                    var page = widget.page.nextPage;\n                    widget = page && page.bodyWidgets.length > 0 ? page.bodyWidgets[0] : undefined;\n                }\n            }\n            else {\n                if (index < widget.containerWidget.childWidgets.length - 1) {\n                    widget = widget.containerWidget.childWidgets[index + 1];\n                }\n                else {\n                    var nextContainer = undefined;\n                    if (widget.containerWidget instanceof TableCellWidget) {\n                        nextContainer = widget.containerWidget.getNextSplitWidget();\n                    }\n                    else if (!(widget.containerWidget instanceof TableRowWidget\n                        || widget.containerWidget instanceof HeaderFooterWidget)) {\n                        // Since cells are lay outed left to right, we should not navigate to next row.\n                        nextContainer = widget.containerWidget.nextRenderedWidget;\n                    }\n                    while (nextContainer && nextContainer.childWidgets.length === 0 && !(nextContainer instanceof TableCellWidget)) {\n                        nextContainer = nextContainer.nextRenderedWidget;\n                        if (isNullOrUndefined(nextContainer)) {\n                            break;\n                        }\n                    }\n                    widget = nextContainer && nextContainer.constructor === widget.containerWidget.constructor ?\n                        nextContainer.firstChild : undefined;\n                }\n            }\n            return widget;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(Widget.prototype, \"previousSplitWidget\", {\n        /**\n         * @private\n         */\n        get: function () {\n            var widget = this;\n            if (widget instanceof TableCellWidget) {\n                return widget.getPreviousSplitWidget();\n            }\n            else {\n                var previous = widget.previousRenderedWidget;\n                if (widget instanceof BodyWidget && previous instanceof BodyWidget && widget.equals(previous)) {\n                    return previous;\n                }\n                else if (previous instanceof BlockWidget && widget.index === previous.index && widget.equals(previous)) {\n                    return previous;\n                }\n            }\n            return undefined;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(Widget.prototype, \"nextSplitWidget\", {\n        /**\n         * @private\n         */\n        get: function () {\n            var widget = this;\n            if (widget instanceof TableCellWidget) {\n                return widget.getNextSplitWidget();\n            }\n            else {\n                var next = widget.nextRenderedWidget;\n                if (widget instanceof BodyWidget && next instanceof BodyWidget && widget.equals(next)) {\n                    return next;\n                }\n                else if (next instanceof BlockWidget && widget.index === next.index && widget.equals(next)) {\n                    return next;\n                }\n            }\n            return undefined;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    /**\n     * @private\n     */\n    Widget.prototype.getPreviousSplitWidgets = function () {\n        var widgets = [];\n        var widget = this.previousSplitWidget;\n        while (widget) {\n            widgets.unshift(widget);\n            widget = widget.previousSplitWidget;\n        }\n        return widgets;\n    };\n    /**\n     * @private\n     */\n    Widget.prototype.getSplitWidgets = function () {\n        var widgets = this.getPreviousSplitWidgets();\n        var widget = this;\n        while (widget) {\n            widgets.push(widget);\n            widget = widget.nextSplitWidget;\n        }\n        return widgets;\n    };\n    /**\n     * @private\n     */\n    Widget.prototype.combineWidget = function (viewer) {\n        var root = this;\n        var widgets = this.getSplitWidgets();\n        if (widgets.length > 1) {\n            root = widgets.shift();\n            while (widgets.length > 0) {\n                var splitWidget = widgets.shift();\n                root.combine(splitWidget, viewer);\n            }\n        }\n        if (root instanceof TableWidget) {\n            root.combineRows(viewer);\n        }\n        return root;\n    };\n    Widget.prototype.combine = function (widget, viewer) {\n        if (widget.childWidgets.length > 0) {\n            var lastChild = this.lastChild;\n            if (lastChild instanceof TableWidget) {\n                lastChild.combineWidget(viewer);\n            }\n            else {\n                var firstChild = widget.firstChild;\n                if (!(widget instanceof TableWidget) && lastChild instanceof Widget && firstChild instanceof Widget &&\n                    lastChild.index === firstChild.index) {\n                    lastChild.combine(widget.childWidgets.shift(), viewer);\n                }\n            }\n            this.addWidgets(widget.childWidgets);\n            widget.childWidgets = [];\n        }\n        widget.destroyInternal(viewer);\n    };\n    /**\n     * @private\n     */\n    Widget.prototype.addWidgets = function (childWidgets) {\n        while (childWidgets.length > 0) {\n            var widget = childWidgets.shift();\n            if (widget instanceof LineWidget && this instanceof ParagraphWidget) {\n                widget.paragraph = this;\n                this.height += widget.height;\n            }\n            else if (widget instanceof Widget) {\n                var lastChild = this.lastChild;\n                widget.containerWidget = this;\n                widget.y = lastChild instanceof Widget ? lastChild.y + lastChild.height : this.y;\n                this.height += widget.height;\n            }\n            this.childWidgets.push(widget);\n        }\n    };\n    /**\n     * @private\n     */\n    Widget.prototype.removeChild = function (index) {\n        if (index > -1 && index < this.childWidgets.length) {\n            this.childWidgets.splice(index, 1);\n        }\n    };\n    /**\n     * @private\n     */\n    Widget.prototype.destroy = function () {\n        if (this.childWidgets) {\n            while (this.childWidgets.length > 0) {\n                var child = this.childWidgets.pop();\n                if (child instanceof LineWidget || child instanceof Widget) {\n                    child.destroy();\n                }\n            }\n        }\n        this.childWidgets = undefined;\n        if (this.containerWidget) {\n            this.containerWidget.removeChild(this.indexInOwner);\n        }\n        this.containerWidget = undefined;\n        // if (this.margin) {\n        //     this.margin.destroy();\n        // }\n        this.margin = undefined;\n        this.x = undefined;\n        this.y = undefined;\n        this.width = undefined;\n        this.height = undefined;\n        this.index = undefined;\n    };\n    return Widget;\n}());\nexport { Widget };\n/**\n * @private\n */\nvar BlockContainer = /** @class */ (function (_super) {\n    __extends(BlockContainer, _super);\n    function BlockContainer() {\n        var _this = _super !== null && _super.apply(this, arguments) || this;\n        /**\n         * @private\n         */\n        _this.sectionFormatIn = undefined;\n        return _this;\n    }\n    Object.defineProperty(BlockContainer.prototype, \"sectionFormat\", {\n        /**\n         * @private\n         */\n        get: function () {\n            var container = this;\n            if (container instanceof BodyWidget) {\n                return container.sectionFormatIn;\n            }\n            else if (container.page) {\n                return container.page.bodyWidgets[0].sectionFormat;\n            }\n            return undefined;\n        },\n        /**\n         * @private\n         */\n        set: function (value) {\n            if (this instanceof BodyWidget) {\n                this.sectionFormatIn = value;\n            }\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(BlockContainer.prototype, \"sectionIndex\", {\n        /**\n         * @private\n         */\n        get: function () {\n            var container = this;\n            var index = 0;\n            if (container instanceof BodyWidget) {\n                index = container.index;\n            }\n            else if (container.page) {\n                index = container.page.bodyWidgets[0].index;\n            }\n            return index;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    /**\n     * @private\n     */\n    BlockContainer.prototype.getHierarchicalIndex = function (hierarchicalIndex) {\n        var viewer = undefined;\n        var node = this;\n        if (node instanceof BodyWidget) {\n            hierarchicalIndex = node.index + ';' + hierarchicalIndex;\n        }\n        else {\n            if (node.headerFooterType.indexOf('Header') !== -1) {\n                hierarchicalIndex = 'H' + ';' + hierarchicalIndex;\n            }\n            else {\n                hierarchicalIndex = 'F' + ';' + hierarchicalIndex;\n            }\n        }\n        if (!isNullOrUndefined(node.page)) {\n            viewer = this.page.viewer;\n            var pageIndex = viewer.pages.indexOf(this.page);\n            return pageIndex + ';' + hierarchicalIndex;\n        }\n        return hierarchicalIndex;\n    };\n    return BlockContainer;\n}(Widget));\nexport { BlockContainer };\n/**\n * @private\n */\nvar BodyWidget = /** @class */ (function (_super) {\n    __extends(BodyWidget, _super);\n    /**\n     * Initialize the constructor of BodyWidget\n     */\n    function BodyWidget() {\n        return _super.call(this) || this;\n    }\n    /**\n     * @private\n     */\n    BodyWidget.prototype.equals = function (widget) {\n        return widget instanceof BodyWidget && widget.sectionFormat === this.sectionFormat;\n    };\n    /**\n     * @private\n     */\n    BodyWidget.prototype.getHierarchicalIndex = function (hierarchicalIndex) {\n        var viewer = undefined;\n        var node = this;\n        hierarchicalIndex = node.index + ';' + hierarchicalIndex;\n        if (!isNullOrUndefined(node.page)) {\n            viewer = this.page.viewer;\n            var pageIndex = viewer.pages.indexOf(this.page);\n            return pageIndex + ';' + hierarchicalIndex;\n        }\n        return hierarchicalIndex;\n    };\n    /**\n     * @private\n     */\n    BodyWidget.prototype.getTableCellWidget = function (touchPoint) {\n        for (var i = 0; i < this.childWidgets.length; i++) {\n            if (this.childWidgets[i].y <= touchPoint.y\n                && (this.childWidgets[i].y + this.childWidgets[i].height) >= touchPoint.y) {\n                return this.childWidgets[i].getTableCellWidget(touchPoint);\n            }\n        }\n        var tableCellWidget = undefined;\n        if (this.childWidgets.length > 0) {\n            if (this.childWidgets[0].y <= touchPoint.y) {\n                tableCellWidget = this.childWidgets[this.childWidgets.length - 1].getTableCellWidget(touchPoint);\n            }\n            else {\n                tableCellWidget = this.childWidgets[0].getTableCellWidget(touchPoint);\n            }\n        }\n        return tableCellWidget;\n    };\n    /**\n     * @private\n     */\n    BodyWidget.prototype.destroyInternal = function (viewer) {\n        var height = this.height;\n        if (!isNullOrUndefined(this.childWidgets)) {\n            for (var n = 0; n < this.childWidgets.length; n++) {\n                var chilgWidget = this.childWidgets[n];\n                if (chilgWidget instanceof ParagraphWidget) {\n                    chilgWidget.destroyInternal(viewer);\n                }\n                else {\n                    chilgWidget.destroyInternal(viewer);\n                }\n                if (isNullOrUndefined(this.childWidgets)) {\n                    break;\n                }\n                n--;\n            }\n            this.childWidgets = undefined;\n        }\n        // if (this instanceof HeaderFooterWidget && ((this as HeaderFooterWidget).currentNode ))) {\n        //     if (((this as HeaderFooterWidget).currentNode as WHeaderFooter).layoutedWidgets )) {\n        //         let index: number = ((this as HeaderFooterWidget).currentNode as WHeaderFooter).layoutedWidgets.indexOf(this);\n        //         ((this as HeaderFooterWidget).currentNode as WHeaderFooter).layoutedWidgets.splice(index, 1);\n        //     }\n        //     this.currentNode = undefined;\n        /* tslint:disable: one-line */\n        if (!isNullOrUndefined(this.page)) {\n            var index = this.indexInOwner;\n            if (this.indexInOwner > -1) {\n                this.page.bodyWidgets.splice(index, 1);\n                if (this.page.bodyWidgets.length === 0) {\n                    this.page.destroy();\n                    // }\n                }\n                else if ((this instanceof HeaderFooterWidget)\n                    && this.page.headerWidget === this) {\n                    this.page.headerWidget = undefined;\n                }\n                else if ((this instanceof HeaderFooterWidget)\n                    && this.page.footerWidget === this) {\n                    this.page.footerWidget = undefined;\n                }\n                this.page = undefined;\n            }\n        }\n        this.destroy();\n    };\n    /**\n     * @private\n     */\n    BodyWidget.prototype.destroy = function () {\n        // if (this.sectionFormat) {\n        //     this.sectionFormat.destroy();\n        // }\n        this.sectionFormat = undefined;\n        this.page = undefined;\n        _super.prototype.destroy.call(this);\n    };\n    return BodyWidget;\n}(BlockContainer));\nexport { BodyWidget };\n/**\n * @private\n */\nvar HeaderFooterWidget = /** @class */ (function (_super) {\n    __extends(HeaderFooterWidget, _super);\n    function HeaderFooterWidget(type) {\n        var _this = _super.call(this) || this;\n        _this.headerFooterType = type;\n        return _this;\n    }\n    /**\n     * @private\n     */\n    HeaderFooterWidget.prototype.getTableCellWidget = function (point) {\n        return undefined;\n    };\n    /**\n     * @private\n     */\n    HeaderFooterWidget.prototype.equals = function (widget) {\n        // Todo: Need to work\n        return widget instanceof HeaderFooterWidget\n            && widget.containerWidget === this.containerWidget;\n    };\n    /**\n     * @private\n     */\n    HeaderFooterWidget.prototype.clone = function () {\n        var headerFooter = new HeaderFooterWidget(this.headerFooterType);\n        for (var i = 0; i < this.childWidgets.length; i++) {\n            var block = this.childWidgets[i].clone();\n            headerFooter.childWidgets.push(block);\n            block.index = i;\n            block.containerWidget = headerFooter;\n        }\n        headerFooter.x = this.x;\n        headerFooter.y = this.y;\n        headerFooter.height = 0;\n        headerFooter.width = 0;\n        return headerFooter;\n    };\n    /**\n     * @private\n     */\n    HeaderFooterWidget.prototype.destroyInternal = function (viewer) {\n        this.page = undefined;\n        _super.prototype.destroy.call(this);\n    };\n    return HeaderFooterWidget;\n}(BlockContainer));\nexport { HeaderFooterWidget };\n/**\n * @private\n */\nvar BlockWidget = /** @class */ (function (_super) {\n    __extends(BlockWidget, _super);\n    function BlockWidget() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    Object.defineProperty(BlockWidget.prototype, \"bodyWidget\", {\n        /**\n         * @private\n         */\n        get: function () {\n            var widget = this;\n            while (widget.containerWidget) {\n                if (widget.containerWidget instanceof BlockContainer) {\n                    return widget.containerWidget;\n                }\n                widget = widget.containerWidget;\n            }\n            return undefined;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(BlockWidget.prototype, \"leftIndent\", {\n        /**\n         * @private\n         */\n        get: function () {\n            var blockAdv = this;\n            if (blockAdv instanceof ParagraphWidget && blockAdv.paragraphFormat instanceof WParagraphFormat) {\n                return blockAdv.paragraphFormat.leftIndent;\n            }\n            else if (blockAdv instanceof TableWidget && blockAdv.tableFormat instanceof WTableFormat) {\n                return blockAdv.tableFormat.leftIndent;\n            }\n            return 0;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(BlockWidget.prototype, \"rightIndent\", {\n        /**\n         * @private\n         */\n        get: function () {\n            var blockAdv = this;\n            if (blockAdv instanceof ParagraphWidget && blockAdv.paragraphFormat instanceof WParagraphFormat) {\n                return blockAdv.paragraphFormat.rightIndent;\n            }\n            return 0;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(BlockWidget.prototype, \"isInsideTable\", {\n        /**\n         * @private\n         */\n        get: function () {\n            return this.containerWidget instanceof TableCellWidget;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(BlockWidget.prototype, \"isInHeaderFooter\", {\n        /**\n         * @private\n         */\n        get: function () {\n            return this.bodyWidget instanceof HeaderFooterWidget;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(BlockWidget.prototype, \"associatedCell\", {\n        /**\n         * @private\n         */\n        get: function () {\n            if (this.containerWidget instanceof TableCellWidget) {\n                return this.containerWidget;\n            }\n            return undefined;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    /**\n     * Check whether the paragraph contains only page break.\n     * @private\n     */\n    BlockWidget.prototype.isPageBreak = function () {\n        var isPageBreak = false;\n        if (this instanceof ParagraphWidget) {\n            var paragraph = this;\n            if (paragraph != null && paragraph.childWidgets.length === 1 &&\n                paragraph.firstChild.children.length === 1) {\n                var pageBreak = paragraph.firstChild.children[0];\n                isPageBreak = pageBreak.isPageBreak;\n            }\n        }\n        return isPageBreak;\n    };\n    /**\n     * @private\n     */\n    BlockWidget.prototype.getHierarchicalIndex = function (hierarchicalIndex) {\n        var node = this;\n        hierarchicalIndex = node.containerWidget.childWidgets.indexOf(node) + ';' + hierarchicalIndex;\n        if (!isNullOrUndefined(node.containerWidget)) {\n            if (node.containerWidget instanceof BlockWidget) {\n                return node.containerWidget.getHierarchicalIndex(hierarchicalIndex);\n            }\n            else if (node.containerWidget instanceof BlockContainer) {\n                hierarchicalIndex = node.containerWidget.getHierarchicalIndex(hierarchicalIndex);\n            }\n        }\n        return hierarchicalIndex;\n    };\n    /**\n     * @private\n     */\n    BlockWidget.prototype.getIndex = function () {\n        if (this instanceof ParagraphWidget || this instanceof TableWidget) {\n            return this.containerWidget.childWidgets.indexOf(this);\n        }\n        else if (this instanceof TableRowWidget) {\n            return this.ownerTable.childWidgets.indexOf(this);\n        }\n        else if (this instanceof TableCellWidget) {\n            return this.ownerRow.childWidgets.indexOf(this);\n        }\n        return 0;\n    };\n    /**\n     * @private\n     */\n    BlockWidget.prototype.getContainerWidth = function () {\n        if (this.isInsideTable) {\n            return this.associatedCell.cellFormat.cellWidth - (this.associatedCell.margin.left + this.associatedCell.margin.right);\n        }\n        else {\n            var bodyWidget = this.bodyWidget;\n            var sectionFormat = bodyWidget.sectionFormat;\n            return sectionFormat.pageWidth - (sectionFormat.leftMargin + sectionFormat.rightMargin);\n        }\n    };\n    return BlockWidget;\n}(Widget));\nexport { BlockWidget };\n/**\n * @private\n */\nvar ParagraphWidget = /** @class */ (function (_super) {\n    __extends(ParagraphWidget, _super);\n    /**\n     * Initialize the constructor of ParagraphWidget\n     */\n    function ParagraphWidget() {\n        var _this = _super.call(this) || this;\n        _this.paragraphFormat = new WParagraphFormat(_this);\n        _this.characterFormat = new WCharacterFormat(_this);\n        return _this;\n    }\n    Object.defineProperty(ParagraphWidget.prototype, \"isEndsWithPageBreak\", {\n        /**\n         * @private\n         */\n        get: function () {\n            if (this.childWidgets.length > 0) {\n                return this.lastChild.isEndsWithPageBreak;\n            }\n            return false;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    /**\n     * @private\n     */\n    ParagraphWidget.prototype.equals = function (widget) {\n        return widget instanceof ParagraphWidget && widget.paragraphFormat === this.paragraphFormat;\n    };\n    /**\n     * @private\n     */\n    ParagraphWidget.prototype.isEmpty = function () {\n        if (isNullOrUndefined(this.childWidgets) || this.childWidgets.length === 0) {\n            return true;\n        }\n        for (var j = 0; j < this.childWidgets.length; j++) {\n            var inlineElement = this.childWidgets[j];\n            for (var i = 0; i < inlineElement.children.length; i++) {\n                var inline = inlineElement.children[i];\n                if (inline.length === 0) {\n                    continue;\n                }\n                if (inline instanceof TextElementBox || inline instanceof ImageElementBox || inline instanceof BookmarkElementBox\n                    || (inline instanceof FieldElementBox && HelperMethods.isLinkedFieldCharacter(inline))) {\n                    return false;\n                }\n            }\n        }\n        return true;\n    };\n    /**\n     * @private\n     */\n    ParagraphWidget.prototype.getInline = function (offset, indexInInline) {\n        var inline = undefined;\n        var count = 0;\n        var isStarted = false;\n        var splittedWidget = this.getSplitWidgets();\n        for (var k = 0; k < splittedWidget.length; k++) {\n            var widget = splittedWidget[k];\n            for (var j = 0; j < widget.childWidgets.length; j++) {\n                var line = widget.childWidgets[j];\n                for (var i = 0; i < line.children.length; i++) {\n                    inline = line.children[i];\n                    if (inline instanceof ListTextElementBox) {\n                        continue;\n                    }\n                    if (!isStarted && (inline instanceof TextElementBox || inline instanceof ImageElementBox\n                        || inline instanceof BookmarkElementBox || inline instanceof FieldElementBox\n                        && HelperMethods.isLinkedFieldCharacter(inline))) {\n                        isStarted = true;\n                    }\n                    if (isStarted && offset <= count + inline.length) {\n                        indexInInline = (offset - count);\n                        return { 'element': inline, 'index': indexInInline };\n                    }\n                    count += inline.length;\n                }\n            }\n        }\n        if (offset > count) {\n            indexInInline = isNullOrUndefined(inline) ? offset : inline.length;\n        }\n        return { 'element': inline, 'index': indexInInline };\n    };\n    /**\n     * @private\n     */\n    ParagraphWidget.prototype.getLength = function () {\n        var length = 0;\n        for (var j = 0; j < this.childWidgets.length; j++) {\n            var line = this.childWidgets[j];\n            for (var i = 0; i < line.children.length; i++) {\n                var element = line.children[i];\n                if (element instanceof ListTextElementBox) {\n                    continue;\n                }\n                length += element.length;\n            }\n        }\n        return length;\n    };\n    /**\n     * @private\n     */\n    ParagraphWidget.prototype.getTableCellWidget = function (point) {\n        return undefined;\n    };\n    /**\n     * @private\n     */\n    ParagraphWidget.prototype.clone = function () {\n        var paragraph = new ParagraphWidget();\n        paragraph.paragraphFormat.copyFormat(this.paragraphFormat);\n        paragraph.characterFormat.copyFormat(this.characterFormat);\n        for (var i = 0; i < this.childWidgets.length; i++) {\n            var line = this.childWidgets[i];\n            var cloneLine = line.clone();\n            paragraph.childWidgets.push(cloneLine);\n            cloneLine.paragraph = paragraph;\n        }\n        paragraph.x = this.x;\n        paragraph.y = this.y;\n        paragraph.height = this.height;\n        paragraph.width = this.width;\n        return paragraph;\n    };\n    /**\n     * @private\n     */\n    ParagraphWidget.prototype.destroyInternal = function (viewer) {\n        var height = this.height;\n        if (!isNullOrUndefined(this.childWidgets)) {\n            for (var i = 0; i < this.childWidgets.length; i++) {\n                var widget = this.childWidgets[i];\n                widget.destroy();\n                if (this.childWidgets.length === 1 && isNullOrUndefined(this.childWidgets[0].children)) {\n                    this.childWidgets = undefined;\n                }\n                if (isNullOrUndefined(this.childWidgets)) {\n                    break;\n                }\n                i--;\n            }\n            this.childWidgets = undefined;\n        }\n        if (!isNullOrUndefined(this.containerWidget) && !isNullOrUndefined(this.containerWidget.childWidgets)\n            && this.containerWidget.childWidgets.indexOf(this) !== -1) {\n            this.containerWidget.childWidgets.splice(this.containerWidget.childWidgets.indexOf(this), 1);\n            this.containerWidget.height -= height;\n            // if ((isNullOrUndefined(this.containerWidget.childWidgets) || this.containerWidget.childWidgets.length === 0)\n            //     && this.containerWidget instanceof BodyWidget) {\n            //     // (this.containerWidget as BodyWidget).destroyInternal(viewer);\n            // }\n            this.containerWidget = undefined;\n        }\n        this.destroy();\n    };\n    /**\n     * @private\n     */\n    ParagraphWidget.prototype.destroy = function () {\n        // if (this.paragraphFormat) {\n        //     this.paragraphFormat.destroy();\n        // }\n        this.paragraphFormat = undefined;\n        // if (this.characterFormat) {\n        //     this.characterFormat.destroy();\n        // }\n        this.characterFormat = undefined;\n        _super.prototype.destroy.call(this);\n    };\n    return ParagraphWidget;\n}(BlockWidget));\nexport { ParagraphWidget };\n/**\n * @private\n */\nvar TableWidget = /** @class */ (function (_super) {\n    __extends(TableWidget, _super);\n    function TableWidget() {\n        var _this = _super.call(this) || this;\n        _this.flags = 0;\n        /**\n         * @private\n         */\n        _this.leftMargin = 0;\n        /**\n         * @private\n         */\n        _this.topMargin = 0;\n        /**\n         * @private\n         */\n        _this.rightMargin = 0;\n        /**\n         * @private\n         */\n        _this.bottomMargin = 0;\n        _this.margin = new Margin(_this.leftMargin, _this.topMargin, _this.rightMargin, _this.bottomMargin);\n        _this.leftBorderWidth = 0;\n        _this.rightBorderWidth = 0;\n        _this.topBorderWidth = 0;\n        _this.bottomBorderWidth = 0;\n        _this.tableFormat = new WTableFormat(_this);\n        _this.tableHolder = new WTableHolder();\n        _this.spannedRowCollection = new Dictionary();\n        return _this;\n    }\n    Object.defineProperty(TableWidget.prototype, \"isGridUpdated\", {\n        /**\n         * @private\n         */\n        get: function () {\n            return ((this.flags & 0x4) >> 2) !== 0;\n        },\n        /**\n         * @private\n         */\n        set: function (value) {\n            this.flags = ((this.flags & 0xFB) | ((value ? 1 : 0) << 2));\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(TableWidget.prototype, \"continueHeader\", {\n        /**\n         * @private\n         */\n        get: function () {\n            return ((this.flags & 0x2) >> 1) !== 0;\n        },\n        /**\n         * @private\n         */\n        set: function (value) {\n            this.flags = ((this.flags & 0xFD) | ((value ? 1 : 0) << 1));\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(TableWidget.prototype, \"header\", {\n        /**\n         * @private\n         */\n        get: function () {\n            return (this.flags & 0x1) !== 0;\n        },\n        /**\n         * @private\n         */\n        set: function (value) {\n            this.flags = ((this.flags & 0xFE) | (value ? 1 : 0));\n        },\n        enumerable: true,\n        configurable: true\n    });\n    /**\n     * @private\n     */\n    TableWidget.prototype.equals = function (widget) {\n        return widget instanceof TableWidget && widget.tableFormat === this.tableFormat;\n    };\n    /**\n     * @private\n     */\n    TableWidget.prototype.combineRows = function (viewer) {\n        for (var i = 0; i < this.childWidgets.length; i++) {\n            var row = this.childWidgets[i];\n            if (row.childWidgets.length === 0) {\n                row.destroy();\n                i--;\n            }\n            else {\n                row.combineCells(viewer);\n            }\n        }\n    };\n    /**\n     * @private\n     */\n    TableWidget.prototype.contains = function (tableCell) {\n        if (this.equals(tableCell.ownerTable)) {\n            return true;\n        }\n        while (tableCell.ownerTable.isInsideTable) {\n            if (this.equals(tableCell.ownerTable)) {\n                return true;\n            }\n            tableCell = tableCell.ownerTable.associatedCell;\n        }\n        return this.equals(tableCell.ownerTable);\n    };\n    /**\n     * @private\n     */\n    TableWidget.prototype.getOwnerWidth = function (isBasedOnViewer) {\n        var width = this.getContainerWidth();\n        // Left and right indents should be neglected.\n        width = width - this.leftIndent - this.rightIndent;\n        return width >= 0 ? width : 0;\n    };\n    TableWidget.prototype.getTableWidth = function () {\n        var width = 0;\n        for (var i = 0; i < this.childWidgets.length; i++) {\n            var rowWidth = 0;\n            var row = this.childWidgets[i];\n            for (var j = 0; j < row.childWidgets.length; j++) {\n                rowWidth += row.childWidgets[j].cellFormat.cellWidth;\n            }\n            if (width < rowWidth) {\n                width = rowWidth;\n            }\n        }\n        return width;\n    };\n    /**\n     * @private\n     */\n    TableWidget.prototype.getTableClientWidth = function (clientWidth) {\n        var tableWidth = clientWidth;\n        if (this.tableFormat.preferredWidthType === 'Point'\n            && this.tableFormat.preferredWidth > 0) {\n            tableWidth = this.tableFormat.preferredWidth;\n        }\n        else {\n            if (this.tableFormat.preferredWidthType === 'Percent'\n                && this.tableFormat.preferredWidth > 0) {\n                tableWidth = tableWidth * this.tableFormat.preferredWidth / 100;\n            }\n            else {\n                //By default, if Table preferred widthType is auto , width is set based on ClientWidth and type is set as 'Point'\n                this.tableFormat.preferredWidthType = 'Point';\n                this.tableFormat.preferredWidth = tableWidth;\n            }\n        }\n        return tableWidth;\n    };\n    /**\n     * @private\n     */\n    TableWidget.prototype.getCellWidth = function (preferredWidth, preferredWidthType, containerWidth, cell) {\n        var cellWidth = preferredWidth;\n        if (preferredWidthType === 'Percent') {\n            cellWidth = (preferredWidth * containerWidth) / 100;\n        }\n        else if (preferredWidthType === 'Point') {\n            cellWidth = preferredWidth;\n        }\n        else if (!isNullOrUndefined(cell)) {\n            cellWidth = cell.getMinimumPreferredWidth();\n        }\n        return cellWidth;\n    };\n    /**\n     * @private\n     */\n    TableWidget.prototype.fitCellsToClientArea = function (clientWidth) {\n        var tableWidth = this.getTableWidth();\n        var factor = clientWidth / tableWidth;\n        for (var i = 0; i < this.childWidgets.length; i++) {\n            var row = this.childWidgets[i];\n            row.rowFormat.gridAfterWidth *= factor;\n            row.rowFormat.gridBeforeWidth *= factor;\n            for (var j = 0; j < row.childWidgets.length; j++) {\n                row.childWidgets[j].cellFormat.cellWidth *= factor;\n            }\n        }\n    };\n    /**\n     * @private\n     */\n    TableWidget.prototype.getTableCellWidget = function (point) {\n        var tableCellWidget = undefined;\n        for (var i = 0; i < this.childWidgets.length; i++) {\n            if (this.childWidgets[i].y <= point.y\n                && (this.childWidgets[i].y + this.childWidgets[i].height) >= point.y) {\n                tableCellWidget = this.childWidgets[i].getTableCellWidget(point);\n                break;\n            }\n        }\n        return tableCellWidget;\n    };\n    /**\n     * @private\n     */\n    //tslint:disable: max-func-body-length\n    TableWidget.prototype.calculateGrid = function () {\n        var tempGrid = [];\n        var spannedCells = [];\n        var containerWidth = this.getOwnerWidth(true);\n        var tableWidth = this.getTableClientWidth(containerWidth);\n        this.tableCellInfo = new Dictionary();\n        for (var i = 0; i < this.childWidgets.length; i++) {\n            var row = this.childWidgets[i];\n            var rowCellInfo = new Dictionary();\n            var rowFormat = row.rowFormat;\n            var cellWidth = 0;\n            var columnSpan = row.rowFormat.gridBefore;\n            var currOffset = 0;\n            if (tempGrid.indexOf(currOffset) < 0) {\n                tempGrid.push(currOffset);\n            }\n            //Converts the row grid before width from point to twips point by 15 factor.\n            cellWidth = this.getCellWidth(rowFormat.gridBeforeWidth, rowFormat.gridBeforeWidthType, tableWidth, null);\n            currOffset += cellWidth;\n            var startOffset = Math.round(currOffset);\n            if (tempGrid.indexOf(startOffset) < 0) {\n                tempGrid.push(startOffset);\n            }\n            for (var j = 0; j < row.childWidgets.length; j++) {\n                var cell = row.childWidgets[j];\n                for (var k = 0; k < spannedCells.length; k++) {\n                    if (spannedCells[k].columnIndex < columnSpan) {\n                        continue;\n                    }\n                    var rowSpan = spannedCells[k].cellFormat.rowSpan;\n                    var removeSpannedCell = true;\n                    if (spannedCells[k].columnIndex > columnSpan) {\n                        {\n                            removeSpannedCell = false;\n                            // If the cell is the last cell in the row and the row has grid after value..\n                            if (j === row.childWidgets.length - 1 && row.rowFormat.gridAfter > 0) {\n                                // tslint:disable-next-line:max-line-length\n                                cellWidth = this.getCellWidth(spannedCells[k].cellFormat.preferredWidth, spannedCells[k].cellFormat.preferredWidthType, tableWidth, null);\n                                currOffset += cellWidth;\n                            }\n                        }\n                    }\n                    else {\n                        // If the table gird alone calculted then column index of the rowspanned cell will be directly taken. \n                        // If the gird calculation is done from the UI level opearations such as resizing then table holder \n                        // will have the columns at that time we can get the column index from the table holder.\n                        //Converts the cell width from point to twips point by 15 factor.\n                        // tslint:disable-next-line:max-line-length\n                        cellWidth = this.getCellWidth(spannedCells[k].cellFormat.preferredWidth, spannedCells[k].cellFormat.preferredWidthType, tableWidth, null);\n                        currOffset += cellWidth;\n                        columnSpan = spannedCells[k].columnIndex + spannedCells[k].cellFormat.columnSpan;\n                    }\n                    if (!removeSpannedCell && j === row.childWidgets.length - 1) {\n                        removeSpannedCell = true;\n                    }\n                    if (removeSpannedCell && i - spannedCells[k].ownerRow.rowIndex === rowSpan - 1) {\n                        spannedCells.splice(k, 1);\n                        k--;\n                    }\n                }\n                // At the start of each row, we will process the row spanned cells to get the start column index.\n                // To calculate grid properly, we need the items in the spanned cells collection in the order of their column index\n                if (cell.cellFormat.rowSpan > 1) {\n                    if (spannedCells.length === 0 || spannedCells[spannedCells.length - 1].columnIndex <= columnSpan) {\n                        spannedCells.push(cell);\n                    }\n                    else {\n                        for (var m = spannedCells.length; m > 0; m--) {\n                            if (spannedCells[m - 1].columnIndex > columnSpan) {\n                                spannedCells.splice(m - 1, 0, cell);\n                            }\n                        }\n                    }\n                }\n                // Add start offset of each cell based on its index\n                if (!rowCellInfo.containsKey(cell.cellIndex)) {\n                    rowCellInfo.add(cell.cellIndex, Math.round(currOffset - startOffset));\n                }\n                columnSpan += cell.cellFormat.columnSpan;\n                //Converts the cell width from pixel to twips point by 15 factor.\n                cellWidth = this.getCellWidth(cell.cellFormat.preferredWidth, cell.cellFormat.preferredWidthType, tableWidth, null);\n                currOffset += cellWidth;\n                var offset = Math.round(currOffset);\n                if (tempGrid.indexOf(offset) < 0) {\n                    tempGrid.push(offset);\n                }\n                if (j === row.childWidgets.length - 1 && rowFormat.gridAfter > 0) {\n                    cellWidth = this.getCellWidth(rowFormat.gridAfterWidth, 'Point', tableWidth, null);\n                    currOffset += cellWidth;\n                    if (tempGrid.indexOf(Math.round(currOffset)) < 0) {\n                        tempGrid.push(Math.round(currOffset));\n                    }\n                    columnSpan += rowFormat.gridAfter;\n                }\n                // Add rowindex and its cells info for each row\n                if (!this.tableCellInfo.containsKey(row.rowIndex)) {\n                    this.tableCellInfo.add(row.rowIndex, rowCellInfo);\n                }\n            }\n        }\n        tempGrid.sort(function (a, b) { return a - b; });\n        if (tempGrid.length - 1 !== this.tableHolder.columns.length) {\n            this.updateColumnSpans(tempGrid, tableWidth);\n        }\n        this.tableCellInfo.clear();\n        this.tableCellInfo = undefined;\n    };\n    TableWidget.prototype.updateColumnSpans = function (tempGrid, containerWidth) {\n        for (var i = 0; i < this.childWidgets.length; i++) {\n            var row = this.childWidgets[i];\n            if (row.rowFormat.gridBeforeWidth >= 0) {\n                row.rowFormat.gridBefore = row.getGridCount(tempGrid, undefined, -1, containerWidth);\n            }\n            for (var j = 0; j < row.childWidgets.length; j++) {\n                var cell = row.childWidgets[j];\n                var columnSpan = row.getGridCount(tempGrid, cell, cell.getIndex(), containerWidth);\n                if (columnSpan > 0 && cell.cellFormat.columnSpan !== columnSpan) {\n                    cell.cellFormat.columnSpan = columnSpan;\n                }\n            }\n            if (row.rowFormat.gridAfterWidth >= 0) {\n                row.rowFormat.gridAfter = row.getGridCount(tempGrid, undefined, row.childWidgets.length, containerWidth);\n            }\n        }\n    };\n    /**\n     * @private\n     */\n    TableWidget.prototype.buildTableColumns = function () {\n        if (this.isGridUpdated) {\n            return;\n        }\n        // Clear existing columns in order to start creating columns freshly.\n        this.tableHolder.resetColumns();\n        var containerWidth = 0;\n        var tableWidth = 0;\n        var rowSpannedCells = [];\n        var isAutoWidth = this.tableFormat.preferredWidthType === 'Auto';\n        // For continuous layout, window width should be considered. \n        // If preferred width exceeds this limit, it can take upto maximum of 2112 pixels (1584 points will be assigned by Microsoft Word).\n        containerWidth = this.getOwnerWidth(true);\n        tableWidth = this.getTableClientWidth(containerWidth);\n        for (var i = 0; i < this.childWidgets.length; i++) {\n            var row = this.childWidgets[i];\n            var rowFormat = row.rowFormat;\n            var columnSpan = 0;\n            var cellWidth = 0;\n            var offset = 0;\n            if (rowFormat.gridBefore > 0) {\n                cellWidth = this.getCellWidth(rowFormat.gridBeforeWidth, row.rowFormat.gridAfterWidthType, tableWidth, null);\n                this.tableHolder.addColumns(columnSpan, columnSpan = rowFormat.gridBefore, cellWidth, cellWidth, offset = cellWidth);\n            }\n            for (var j = 0; j < row.childWidgets.length; j++) {\n                var cell = row.childWidgets[j];\n                if (rowSpannedCells.length === 0) {\n                    cell.columnIndex = columnSpan;\n                }\n                for (var k = 0; k < rowSpannedCells.length; k++) {\n                    var rowSpannedCell = rowSpannedCells[k];\n                    if (rowSpannedCell.columnIndex < columnSpan) {\n                        cell.columnIndex = columnSpan;\n                        continue;\n                    }\n                    var rowSpan = 1;\n                    var removeSpannedCell = true;\n                    rowSpan = rowSpannedCell.cellFormat.rowSpan;\n                    if (rowSpannedCell.columnIndex > columnSpan) {\n                        cell.columnIndex = columnSpan;\n                        removeSpannedCell = false;\n                    }\n                    else {\n                        // tslint:disable-next-line:max-line-length\n                        cellWidth = this.getCellWidth(rowSpannedCell.cellFormat.preferredWidth, rowSpannedCell.cellFormat.preferredWidthType, tableWidth, rowSpannedCell);\n                        var minWidth_1 = rowSpannedCell.getMinimumPreferredWidth();\n                        // If the table gird alone calculted then column index of the rowspanned cell will be directly taken. \n                        // tslint:disable-next-line:max-line-length\n                        // If the gird calculation is done from the UI level opearations such as resizing then table holder will have the columns at that time we can get the column index from the table holder.\n                        // tslint:disable-next-line:max-line-length\n                        if (this.tableHolder.columns.length > 0) {\n                            this.tableHolder.addColumns(columnSpan, columnSpan = this.tableHolder.columns.indexOf(rowSpannedCell.ownerColumn) + rowSpannedCell.cellFormat.columnSpan, cellWidth, minWidth_1, offset += cellWidth);\n                            cell.columnIndex = columnSpan;\n                        }\n                        else {\n                            // tslint:disable-next-line:max-line-length\n                            this.tableHolder.addColumns(columnSpan, columnSpan = rowSpannedCell.columnIndex + rowSpannedCell.cellFormat.columnSpan, cellWidth, minWidth_1, offset += cellWidth);\n                            cell.columnIndex = columnSpan;\n                        }\n                    }\n                    if (!removeSpannedCell && j === row.childWidgets.length - 1) {\n                        removeSpannedCell = true;\n                    }\n                    if (removeSpannedCell && i - rowSpannedCell.ownerRow.rowIndex === rowSpan - 1) {\n                        rowSpannedCells.splice(k, 1);\n                        k--;\n                    }\n                }\n                // At the start of each row, we will process the row spanned cells to get the start column index.\n                // To calculate grid properly, we need the items in the spanned cells collection in the order of their column index\n                if (cell.cellFormat.rowSpan > 1) {\n                    if (rowSpannedCells.length === 0 || rowSpannedCells[rowSpannedCells.length - 1].columnIndex <= columnSpan) {\n                        rowSpannedCells.push(cell);\n                    }\n                    else {\n                        for (var m = rowSpannedCells.length; m > 0; m--) {\n                            if (rowSpannedCells[m - 1].columnIndex > columnSpan) {\n                                rowSpannedCells.splice(m - 1, 0, cell);\n                            }\n                        }\n                    }\n                }\n                cellWidth = this.getCellWidth(cell.cellFormat.preferredWidth, cell.cellFormat.preferredWidthType, tableWidth, cell);\n                var minWidth = cell.getMinimumPreferredWidth();\n                this.tableHolder.addColumns(columnSpan, columnSpan += cell.cellFormat.columnSpan, cellWidth, minWidth, offset += cellWidth);\n                if (j === row.childWidgets.length - 1 && rowFormat.gridAfterWidth > 0) {\n                    cellWidth = this.getCellWidth(rowFormat.gridAfterWidth, 'Point', tableWidth, null);\n                    this.tableHolder.addColumns(columnSpan, columnSpan += rowFormat.gridAfter, cellWidth, cellWidth, offset += cellWidth);\n                }\n            }\n        }\n        this.tableHolder.validateColumnWidths();\n        // Fits the column width based on preferred width. i.e. Fixed layout.\n        this.tableHolder.fitColumns(containerWidth, tableWidth, isAutoWidth);\n        //Sets the width to cells\n        this.setWidthToCells(tableWidth, isAutoWidth);\n    };\n    /**\n     * @private\n     */\n    TableWidget.prototype.setWidthToCells = function (tableWidth, isAutoWidth) {\n        for (var i = 0; i < this.childWidgets.length; i++) {\n            var rw = this.childWidgets[i];\n            var rowFormat = rw.rowFormat;\n            if (rowFormat.gridBefore > 0) {\n                rowFormat.beforeWidth = this.tableHolder.getCellWidth(0, rowFormat.gridBefore, tableWidth, isAutoWidth);\n            }\n            for (var j = 0; j < rw.childWidgets.length; j++) {\n                var cell = rw.childWidgets[j];\n                // tslint:disable-next-line:max-line-length\n                cell.cellFormat.cellWidth = this.tableHolder.getCellWidth(cell.columnIndex, cell.cellFormat.columnSpan, tableWidth, isAutoWidth);\n                //By default, if cell preferred widthType is auto , width set based on table width and type is changed to 'Point'\n                if (cell.cellFormat.preferredWidthType !== 'Percent') {\n                    cell.cellFormat.preferredWidth = cell.cellFormat.cellWidth;\n                    cell.cellFormat.preferredWidthType = 'Point';\n                }\n            }\n            if (rowFormat.gridAfter > 0) {\n                rowFormat.afterWidth = this.tableHolder.getCellWidth(0, rowFormat.gridAfter, tableWidth, isAutoWidth);\n            }\n        }\n    };\n    /**\n     * @private\n     */\n    TableWidget.prototype.getMaxRowWidth = function (clientWidth) {\n        var width = 0;\n        for (var i = 0; i < this.childWidgets.length; i++) {\n            var row = this.childWidgets[i];\n            var rowWidth = 0;\n            for (var j = 0; j < row.childWidgets.length; j++) {\n                var cell = row.childWidgets[j];\n                rowWidth += this.getCellWidth(cell.cellFormat.preferredWidth, cell.cellFormat.preferredWidthType, clientWidth, cell);\n            }\n            if (width < rowWidth) {\n                width = rowWidth;\n            }\n        }\n        return width;\n    };\n    /**\n     * @private\n     */\n    TableWidget.prototype.updateWidth = function (dragValue) {\n        var totalPreferredWidth = this.tableHolder.getTotalWidth();\n        var containerWidth = this.getTableClientWidth(this.getOwnerWidth(true));\n        if (containerWidth <= totalPreferredWidth) {\n            if (this.tableFormat.preferredWidthType === 'Auto') {\n                this.tableFormat.preferredWidthType = 'Point';\n            }\n        }\n        if (this.tableFormat.preferredWidthType !== 'Auto') {\n            if (this.tableFormat.preferredWidthType === 'Point') {\n                this.tableFormat.preferredWidth = this.getMaxRowWidth(containerWidth);\n            }\n            // else\n            // {   //ToDo:Need to anzlyze more the Percentage calculation for table width.\n            //     let value:number = ConvertPixelToPercent(GetMaxRowWidth(containerWidth));\n            //     this.tableFormat.preferredWidth = value;\n            // }\n        }\n    };\n    /**\n     * @private\n     */\n    TableWidget.prototype.convertPointToPercent = function (tablePreferredWidth, ownerWidth) {\n        var value = 0;\n        value = (tablePreferredWidth / ownerWidth) * 100;\n        value = Math.round(value);\n        return value < 100 ? value : 100; // The value should be lesser than or equal to 100%;\n    };\n    /**\n     * @private\n     */\n    TableWidget.prototype.clone = function () {\n        var table = new TableWidget();\n        table.tableHolder = this.tableHolder.clone();\n        table.tableFormat.copyFormat(this.tableFormat);\n        for (var i = 0; i < this.childWidgets.length; i++) {\n            var row = this.childWidgets[i].clone();\n            table.childWidgets.push(row);\n            row.containerWidget = table;\n            row.index = i;\n        }\n        table.x = this.x;\n        table.y = this.y;\n        table.height = this.height;\n        table.width = this.width;\n        table.containerWidget = this.containerWidget;\n        return table;\n    };\n    /**\n     * @private\n     */\n    TableWidget.getTableOf = function (node) {\n        if (node instanceof WBorders) {\n            var row = TableRowWidget.getRowOf(node);\n            if (!isNullOrUndefined(row)) {\n                return row.ownerTable;\n            }\n            else if (node.ownerBase instanceof WTableFormat && node.ownerBase.ownerBase instanceof TableWidget) {\n                return node.ownerBase.ownerBase;\n            }\n            else {\n                return undefined;\n            }\n        }\n        return undefined;\n    };\n    /**\n     * @private\n     */\n    TableWidget.prototype.fitChildToClientArea = function () {\n        var clientWidth = this.getContainerWidth();\n        if (Math.round(clientWidth) < Math.round(this.getTableWidth())) {\n            this.fitCellsToClientArea(clientWidth);\n        }\n        for (var i = 0; i < this.childWidgets.length; i++) {\n            var row = this.childWidgets[i];\n            for (var j = 0; j < row.childWidgets.length; j++) {\n                var cell = row.childWidgets[j];\n                for (var k = 0; k < cell.childWidgets.length; k++) {\n                    if (cell.childWidgets[k] instanceof TableWidget) {\n                        cell.childWidgets[k].fitChildToClientArea();\n                    }\n                }\n            }\n        }\n    };\n    /**\n     * @private\n     */\n    TableWidget.prototype.getColumnCellsForSelection = function (startCell, endCell) {\n        var cells = [];\n        var start = startCell.columnIndex;\n        var end = endCell.columnIndex + endCell.cellFormat.columnSpan;\n        for (var i = 0; i < this.childWidgets.length; i++) {\n            var row = this.childWidgets[i];\n            for (var j = 0; j < row.childWidgets.length; j++) {\n                var cell = row.childWidgets[j];\n                var columnIndex = cell.columnIndex;\n                var columnSpan = cell.cellFormat.columnSpan;\n                if ((columnIndex + columnSpan > start && columnIndex + columnSpan < end) || (columnIndex > start && columnIndex < end)) {\n                    if (cells.indexOf(cell) < 0) {\n                        cells.push(cell);\n                    }\n                }\n                else if ((columnIndex > start && columnIndex < end && columnIndex + columnSpan < end)\n                    || (columnIndex < start && columnIndex + columnSpan > end)) {\n                    if (cells.indexOf(cell) < 0) {\n                        cells.push(cell);\n                    }\n                }\n                else if (columnIndex === start || columnIndex + columnSpan === end) {\n                    if (cells.indexOf(cell) < 0) {\n                        cells.push(cell);\n                    }\n                }\n            }\n        }\n        return cells;\n    };\n    /**\n     * Splits width equally for all the cells.\n     * @param tableClientWidth\n     * @private\n     */\n    TableWidget.prototype.splitWidthToTableCells = function (tableClientWidth) {\n        for (var row = 0; row < this.childWidgets.length; row++) {\n            this.childWidgets[row].splitWidthToRowCells(tableClientWidth);\n        }\n    };\n    /**\n     * @private\n     */\n    TableWidget.prototype.insertTableRowsInternal = function (tableRows, startIndex) {\n        for (var i = 0; i < tableRows.length; i++) {\n            var row = tableRows.splice(i, 1)[0];\n            row.containerWidget = this;\n            this.childWidgets.splice(startIndex, 0, row);\n            i--;\n        }\n        this.updateRowIndex(startIndex);\n        this.isGridUpdated = false;\n        this.buildTableColumns();\n        this.isGridUpdated = true;\n    };\n    /**\n     * @private\n     */\n    TableWidget.prototype.updateRowIndex = function (startIndex) {\n        for (var i = startIndex; i < this.childWidgets.length; i++) {\n            var row = this.childWidgets[i];\n            row.index = i;\n            for (var j = 0; j < row.childWidgets.length; j++) {\n                row.childWidgets[j].index = j;\n                row.childWidgets[j].rowIndex = row.rowIndex;\n            }\n            startIndex++;\n        }\n    };\n    /**\n     * @private\n     */\n    TableWidget.prototype.getCellStartOffset = function (cell) {\n        var offset = 0;\n        if (cell && this.tableCellInfo) {\n            if (this.tableCellInfo.containsKey(cell.ownerRow.rowIndex)) {\n                var rowCellInfo = this.tableCellInfo.get(cell.ownerRow.rowIndex);\n                if (rowCellInfo.containsKey(cell.cellIndex)) {\n                    offset = rowCellInfo.get(cell.cellIndex);\n                }\n            }\n        }\n        return offset;\n    };\n    /**\n     * @private\n     */\n    TableWidget.prototype.destroyInternal = function (viewer) {\n        var height = this.height;\n        if (!isNullOrUndefined(this.childWidgets)) {\n            for (var j = 0; j < this.childWidgets.length; j++) {\n                var widget = undefined;\n                var childWidget = this.childWidgets[j];\n                widget = childWidget;\n                if (!isNullOrUndefined(widget)) {\n                    widget.destroyInternal(viewer);\n                }\n                if (isNullOrUndefined(this.childWidgets)) {\n                    break;\n                }\n                j--;\n            }\n            this.childWidgets = undefined;\n        }\n        if (!isNullOrUndefined(this.containerWidget)) {\n            if (!isNullOrUndefined(this.containerWidget.childWidgets)) {\n                if (this.containerWidget.childWidgets.indexOf(this) !== -1) {\n                    this.containerWidget.childWidgets.splice(this.containerWidget.childWidgets.indexOf(this), 1);\n                }\n                this.containerWidget.height -= height;\n                // if ((isNullOrUndefined(this.containerWidget.childWidgets) || this.containerWidget.childWidgets.length === 0)\n                //     && this.containerWidget instanceof BodyWidget) {\n                //     // (this.containerWidget as BodyWidget).destroyInternal(viewer);\n                // }\n            }\n            this.containerWidget = undefined;\n        }\n        this.destroy();\n    };\n    /**\n     * @private\n     */\n    TableWidget.prototype.destroy = function () {\n        // if (this.tableFormat) {\n        //     this.tableFormat.destroy();\n        // }\n        this.tableFormat = undefined;\n        // if (this.spannedRowCollection) {\n        //     this.spannedRowCollection.destroy();\n        // }\n        this.spannedRowCollection = undefined;\n        this.tableGrids = [];\n        this.tableGrids = undefined;\n        // if (this.tableHolder) {\n        //     this.tableHolder.destroy();\n        // }\n        this.tableHolder = undefined;\n        this.flags = undefined;\n        this.leftMargin = undefined;\n        this.topMargin = undefined;\n        this.rightMargin = undefined;\n        this.bottomMargin = undefined;\n        this.headerHeight = undefined;\n        this.description = undefined;\n        this.title = undefined;\n        _super.prototype.destroy.call(this);\n    };\n    return TableWidget;\n}(BlockWidget));\nexport { TableWidget };\n/**\n * @private\n */\nvar TableRowWidget = /** @class */ (function (_super) {\n    __extends(TableRowWidget, _super);\n    function TableRowWidget() {\n        var _this = _super.call(this) || this;\n        /**\n         * @private\n         */\n        _this.spannedRowCollection = [];\n        _this.topBorderWidth = 0;\n        _this.bottomBorderWidth = 0;\n        _this.rowFormat = new WRowFormat(_this);\n        return _this;\n    }\n    Object.defineProperty(TableRowWidget.prototype, \"rowIndex\", {\n        /**\n         * @private\n         */\n        get: function () {\n            if (this.containerWidget) {\n                return this.containerWidget.childWidgets.indexOf(this);\n            }\n            return -1;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(TableRowWidget.prototype, \"ownerTable\", {\n        /**\n         * @private\n         */\n        get: function () {\n            if (this.containerWidget instanceof TableWidget) {\n                return this.containerWidget;\n            }\n            return undefined;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(TableRowWidget.prototype, \"nextRow\", {\n        /**\n         * @private\n         */\n        get: function () {\n            var index = this.indexInOwner;\n            if (index > -1 && index < this.ownerTable.childWidgets.length - 1) {\n                return this.ownerTable.childWidgets[index + 1];\n            }\n            return undefined;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    /**\n     * @private\n     */\n    TableRowWidget.prototype.equals = function (widget) {\n        return widget instanceof TableRowWidget && widget.rowFormat === this.rowFormat;\n    };\n    /**\n     * @private\n     */\n    TableRowWidget.prototype.combineCells = function (viewer) {\n        for (var i = 0; i < this.childWidgets.length; i++) {\n            var cell = this.childWidgets[i];\n            cell.combineWidget(viewer);\n            if (cell.cellFormat.rowSpan === 1) {\n                var cellHeight = cell.height + cell.margin.top + cell.margin.bottom;\n                if ((this.height - this.ownerTable.tableFormat.cellSpacing) < cell.height) {\n                    this.height = this.ownerTable.tableFormat.cellSpacing + cell.height;\n                }\n            }\n        }\n    };\n    /**\n     * @private\n     */\n    TableRowWidget.getRowOf = function (node) {\n        if (node instanceof WBorders) {\n            var cell = TableCellWidget.getCellOf(node);\n            if (!isNullOrUndefined(cell)) {\n                return cell.ownerRow;\n            }\n            else if (node.ownerBase instanceof WRowFormat && node.ownerBase.ownerBase instanceof TableRowWidget) {\n                return node.ownerBase.ownerBase;\n            }\n            else {\n                return undefined;\n            }\n        }\n        return undefined;\n    };\n    /**\n     * @private\n     */\n    TableRowWidget.prototype.getCell = function (rowIndex, cellIndex) {\n        for (var i = 0; i < this.childWidgets.length; i++) {\n            var cell = this.childWidgets[i];\n            if (cell.rowIndex === rowIndex && cell.index === cellIndex) {\n                return cell;\n            }\n        }\n        return undefined;\n    };\n    /**\n     * @private\n     */\n    TableRowWidget.prototype.splitWidthToRowCells = function (tableClientWidth) {\n        var cells = this.childWidgets;\n        var cellWidth = tableClientWidth / cells.length;\n        for (var cell = 0; cell < cells.length; cell++) {\n            cells[cell].cellFormat.preferredWidth = cellWidth;\n        }\n    };\n    /**\n     * @private\n     */\n    TableRowWidget.prototype.getGridCount = function (tableGrid, cell, index, containerWidth) {\n        var prevOffset = 0;\n        var width = 0;\n        var ownerTable = this.ownerTable;\n        var rowFormat = this.rowFormat;\n        if (index === -1) {\n            width = ownerTable.getCellWidth(rowFormat.gridBeforeWidth, rowFormat.gridBeforeWidthType, containerWidth, null);\n        }\n        else {\n            prevOffset += ownerTable.getCellWidth(rowFormat.gridBeforeWidth, rowFormat.gridBeforeWidthType, containerWidth, null);\n            if (index >= 0) {\n                prevOffset += ownerTable.getCellStartOffset(cell);\n            }\n            if (index < this.childWidgets.length) {\n                width = ownerTable.getCellWidth(cell.cellFormat.preferredWidth, cell.cellFormat.preferredWidthType, containerWidth, null);\n            }\n            else {\n                width = ownerTable.getCellWidth(rowFormat.gridAfterWidth, rowFormat.gridAfterWidthType, containerWidth, null);\n            }\n        }\n        var gridStartIndex = this.getOffsetIndex(tableGrid, prevOffset);\n        var gridEndIndex = this.getOffsetIndex(tableGrid, prevOffset + width);\n        return gridEndIndex - gridStartIndex;\n    };\n    TableRowWidget.prototype.getOffsetIndex = function (tableGrid, offset) {\n        offset = Math.round(offset);\n        var index = 0;\n        if (tableGrid.indexOf(offset) >= 0) {\n            index = tableGrid.indexOf(offset);\n        }\n        else {\n            for (var i = 0; i < tableGrid.length; i++) {\n                if (tableGrid[i] > offset) {\n                    return i;\n                }\n            }\n            index = tableGrid.length - 1;\n        }\n        return index;\n    };\n    TableRowWidget.prototype.getCellOffset = function (index, containerWidth) {\n        var prevOffset = 0;\n        var ownerTable = this.ownerTable;\n        for (var i = 0; i < this.childWidgets.length; i++) {\n            var cellFormat = this.childWidgets[i].cellFormat;\n            if (i === index) {\n                break;\n            }\n            prevOffset += ownerTable.getCellWidth(cellFormat.preferredWidth, cellFormat.preferredWidthType, containerWidth, null);\n        }\n        return prevOffset;\n    };\n    /**\n     * @private\n     */\n    TableRowWidget.prototype.updateRowBySpannedCells = function () {\n        var rowSpannedCells = this.getPreviousRowSpannedCells();\n        var currentRowIndex = this.rowIndex;\n        for (var i = 0; i < rowSpannedCells.length; i++) {\n            var spannedCell = rowSpannedCells[i];\n            var rowSpanEnd = spannedCell.ownerRow.rowIndex + spannedCell.cellFormat.rowSpan - 1;\n            // If current row is row span end or includes spanned cells. then, decrease the rowspan\n            if (rowSpanEnd >= currentRowIndex) {\n                spannedCell.cellFormat.rowSpan -= 1;\n            }\n        }\n    };\n    /**\n     * @private\n     */\n    TableRowWidget.prototype.getPreviousRowSpannedCells = function (include) {\n        var rowSpannedCells = [];\n        var row = include ? this : this.previousWidget;\n        while (!isNullOrUndefined(row)) {\n            for (var i = 0; i < row.childWidgets.length; i++) {\n                var cell = row.childWidgets[i];\n                if (cell.cellFormat.rowSpan > 1) {\n                    rowSpannedCells.splice(0, 0, cell);\n                }\n            }\n            row = row.previousWidget;\n        }\n        return rowSpannedCells;\n    };\n    /**\n     * @private\n     */\n    TableRowWidget.prototype.getTableCellWidget = function (point) {\n        for (var i = 0; i < this.childWidgets.length; i++) {\n            var x = Math.round(this.childWidgets[i].x);\n            if (x - this.childWidgets[i].margin.left - 1 <= point.x\n                && (x + this.childWidgets[i].width) >= point.x) {\n                return this.childWidgets[i];\n            }\n            else if (i === this.childWidgets.length - 1\n                && (this.childWidgets[i].x + this.childWidgets[i].width) + 1 <= point.x) {\n                return this.childWidgets[i];\n            }\n        }\n        var cellWidget = undefined;\n        if (this.childWidgets.length > 0) {\n            if (this.childWidgets[0].x <= point.x) {\n                cellWidget = this.childWidgets[this.childWidgets.length - 1].getTableCellWidget(point);\n            }\n            else {\n                cellWidget = this.childWidgets[0].getTableCellWidget(point);\n            }\n        }\n        return cellWidget;\n    };\n    /**\n     * @private\n     */\n    TableRowWidget.prototype.destroyInternal = function (viewer) {\n        var height = this.height;\n        if (!isNullOrUndefined(this.childWidgets)) {\n            for (var i = 0; i < this.childWidgets.length; i++) {\n                var widget = this.childWidgets[i];\n                widget.destroyInternal(viewer);\n                if (isNullOrUndefined(this.childWidgets)) {\n                    break;\n                }\n                i--;\n            }\n            this.childWidgets = undefined;\n        }\n        if (!isNullOrUndefined(this.containerWidget)) {\n            if (!isNullOrUndefined(this.containerWidget.childWidgets)) {\n                this.containerWidget.childWidgets.splice(this.containerWidget.childWidgets.indexOf(this), 1);\n                if ((isNullOrUndefined(this.containerWidget.childWidgets) || this.containerWidget.childWidgets.length === 0)\n                    && this.containerWidget instanceof TableWidget) {\n                    this.containerWidget.destroyInternal(viewer);\n                }\n                else if (this.containerWidget.containerWidget instanceof BodyWidget) {\n                    this.containerWidget.containerWidget.height -= height;\n                }\n                this.containerWidget.height -= height;\n            }\n        }\n        this.destroy();\n    };\n    /**\n     * @private\n     */\n    TableRowWidget.prototype.clone = function () {\n        var row = new TableRowWidget();\n        row.rowFormat.copyFormat(this.rowFormat);\n        row.topBorderWidth = this.topBorderWidth;\n        row.bottomBorderWidth = this.bottomBorderWidth;\n        for (var i = 0; i < this.childWidgets.length; i++) {\n            var cell = this.childWidgets[i].clone();\n            row.childWidgets.push(cell);\n            cell.containerWidget = row;\n            cell.index = i;\n            cell.rowIndex = this.rowIndex;\n        }\n        row.x = this.x;\n        row.y = this.y;\n        row.height = this.height;\n        row.width = this.width;\n        return row;\n    };\n    /**\n     * @private\n     */\n    TableRowWidget.prototype.destroy = function () {\n        // if (this.rowFormat) {\n        //     this.rowFormat.destroy();\n        // }\n        this.rowFormat = undefined;\n        this.rowFormat = undefined;\n        this.spannedRowCollection = [];\n        this.spannedRowCollection = undefined;\n        this.topBorderWidth = undefined;\n        this.bottomBorderWidth = undefined;\n        _super.prototype.destroy.call(this);\n    };\n    return TableRowWidget;\n}(BlockWidget));\nexport { TableRowWidget };\n/**\n * @private\n */\nvar TableCellWidget = /** @class */ (function (_super) {\n    __extends(TableCellWidget, _super);\n    function TableCellWidget() {\n        var _this = _super.call(this) || this;\n        /**\n         * @private\n         */\n        _this.rowIndex = -1;\n        _this.margin = new Margin(_this.leftMargin, _this.topMargin, _this.rightMargin, _this.bottomMargin);\n        _this.leftBorderWidth = 0;\n        _this.rightBorderWidth = 0;\n        _this.cellFormat = new WCellFormat(_this);\n        return _this;\n    }\n    Object.defineProperty(TableCellWidget.prototype, \"ownerColumn\", {\n        /**\n         * @private\n         */\n        get: function () {\n            return this.ownerTable.tableHolder.columns[this.columnIndex];\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(TableCellWidget.prototype, \"leftMargin\", {\n        /**\n         * @private\n         */\n        get: function () {\n            if (this.cellFormat && this.cellFormat.containsMargins()) {\n                return this.cellFormat.leftMargin;\n            }\n            else if (!isNullOrUndefined(this.ownerTable) && !isNullOrUndefined(this.ownerTable.tableFormat)) {\n                return this.ownerTable.tableFormat.leftMargin;\n            }\n            else {\n                return 0;\n            }\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(TableCellWidget.prototype, \"topMargin\", {\n        /**\n         * @private\n         */\n        get: function () {\n            if (this.cellFormat && this.cellFormat.containsMargins()) {\n                return this.cellFormat.topMargin;\n            }\n            else if (!isNullOrUndefined(this.ownerTable) && !isNullOrUndefined(this.ownerTable.tableFormat)) {\n                return this.ownerTable.tableFormat.topMargin;\n            }\n            else {\n                return 0;\n            }\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(TableCellWidget.prototype, \"rightMargin\", {\n        /**\n         * @private\n         */\n        get: function () {\n            if (this.cellFormat && this.cellFormat.containsMargins()) {\n                return this.cellFormat.rightMargin;\n            }\n            else if (!isNullOrUndefined(this.ownerTable) && !isNullOrUndefined(this.ownerTable.tableFormat)) {\n                return this.ownerTable.tableFormat.rightMargin;\n            }\n            else {\n                return 0;\n            }\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(TableCellWidget.prototype, \"bottomMargin\", {\n        /**\n         * @private\n         */\n        get: function () {\n            if (this.cellFormat && this.cellFormat.containsMargins()) {\n                return this.cellFormat.bottomMargin;\n            }\n            else if (!isNullOrUndefined(this.ownerTable) && !isNullOrUndefined(this.ownerTable.tableFormat)) {\n                return this.ownerTable.tableFormat.bottomMargin;\n            }\n            else {\n                return 0;\n            }\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(TableCellWidget.prototype, \"cellIndex\", {\n        /**\n         * @private\n         */\n        get: function () {\n            if (this.ownerRow) {\n                return this.ownerRow.childWidgets.indexOf(this);\n            }\n            return -1;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(TableCellWidget.prototype, \"ownerTable\", {\n        /**\n         * @private\n         */\n        get: function () {\n            if (this.containerWidget instanceof TableRowWidget) {\n                return this.containerWidget.ownerTable;\n            }\n            return undefined;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(TableCellWidget.prototype, \"ownerRow\", {\n        /**\n         * @private\n         */\n        get: function () {\n            return this.containerWidget;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    /**\n     * @private\n     */\n    TableCellWidget.prototype.equals = function (widget) {\n        return widget instanceof TableCellWidget && widget.cellFormat === this.cellFormat;\n    };\n    /**\n     * @private\n     */\n    TableCellWidget.prototype.getContainerTable = function () {\n        var table = this.ownerTable;\n        while (table instanceof TableWidget && table.associatedCell instanceof TableCellWidget) {\n            table = table.associatedCell.getContainerTable();\n        }\n        return table;\n    };\n    /**\n     * @private\n     */\n    TableCellWidget.prototype.getPreviousSplitWidget = function () {\n        if (this.containerWidget instanceof TableRowWidget) {\n            var row = this.containerWidget;\n            do {\n                row = row.previousRenderedWidget;\n                if (isNullOrUndefined(row) || row.index < this.rowIndex) {\n                    break;\n                }\n                var previousCell = row.getCell(this.rowIndex, this.index);\n                if (previousCell && this.equals(previousCell)) {\n                    return previousCell;\n                }\n            } while (row);\n        }\n        return undefined;\n    };\n    /**\n     * @private\n     */\n    TableCellWidget.prototype.getNextSplitWidget = function () {\n        var rowSpan = this.cellFormat.rowSpan;\n        if (this.containerWidget instanceof TableRowWidget) {\n            var row = this.containerWidget;\n            do {\n                row = row.nextRenderedWidget;\n                if (isNullOrUndefined(row) || row.index > this.rowIndex + rowSpan) {\n                    break;\n                }\n                var nextCell = row.getCell(this.rowIndex, this.index);\n                if (nextCell && this.equals(nextCell)) {\n                    return nextCell;\n                }\n            } while (row);\n        }\n        return undefined;\n    };\n    /**\n     * @private\n     */\n    TableCellWidget.prototype.getTableCellWidget = function (point) {\n        for (var i = 0; i < this.childWidgets.length; i++) {\n            if (this.childWidgets[i].y <= point.y\n                && (this.childWidgets[i].y + this.childWidgets[i].height) >= point.y) {\n                return this.childWidgets[i].getTableCellWidget(point);\n            }\n        }\n        var tableCellWidget = undefined;\n        if (this.childWidgets.length > 0) {\n            if (this.childWidgets[0].y <= point.y) {\n                tableCellWidget = this.childWidgets[this.childWidgets.length - 1].getTableCellWidget(point);\n            }\n            else {\n                tableCellWidget = this.childWidgets[0].getTableCellWidget(point);\n            }\n        }\n        return tableCellWidget;\n    };\n    /**\n     * @private\n     */\n    TableCellWidget.prototype.updateWidth = function (preferredWidth) {\n        if (this.cellFormat.preferredWidthType === 'Auto') {\n            this.cellFormat.preferredWidth = preferredWidth;\n            this.cellFormat.preferredWidthType = 'Point';\n        }\n        else if (this.cellFormat.preferredWidthType === 'Point') {\n            this.cellFormat.preferredWidth = preferredWidth;\n        }\n        else if (this.cellFormat.preferredWidthType === 'Percent') {\n            this.cellFormat.preferredWidth = this.convertPointToPercent(preferredWidth);\n        }\n        this.cellFormat.cellWidth = preferredWidth;\n    };\n    /**\n     * @private\n     */\n    TableCellWidget.prototype.convertPointToPercent = function (cellPreferredWidth) {\n        var value = 0;\n        var clientWidth = this.ownerTable.getOwnerWidth(true);\n        var tableWidth = this.ownerTable.getTableClientWidth(clientWidth);\n        value = (cellPreferredWidth / tableWidth) * 100;\n        value = Math.round(value);\n        return value < 100 ? value : 100; // The value should be lesser than or equal to 100%;\n    };\n    /**\n     * @private\n     */\n    TableCellWidget.getCellLeftBorder = function (tableCell) {\n        var leftBorder = undefined;\n        var cellBorder = tableCell.cellFormat.borders;\n        var rowBorders = !isNullOrUndefined(tableCell.ownerRow) ? tableCell.ownerRow.rowFormat.borders : undefined;\n        var tableBorders = !isNullOrUndefined(tableCell.ownerTable) ? tableCell.ownerTable.tableFormat.borders : undefined;\n        if (!isNullOrUndefined(cellBorder.left)) {\n            leftBorder = cellBorder.left;\n        }\n        if (isNullOrUndefined(leftBorder)) {\n            leftBorder = tableCell.getLeftBorderToRenderByHierarchy(leftBorder, rowBorders, tableBorders);\n        }\n        if (tableCell.ownerTable.tableFormat.cellSpacing > 0) {\n            leftBorder = tableCell.getLeftBorderToRenderByHierarchy(leftBorder, rowBorders, tableBorders);\n        }\n        else {\n            var prevCell = undefined;\n            if (!isNullOrUndefined(tableCell.previousWidget)) {\n                // if the border is shared then choose the border based on Conflict Resolution algorithm.\n                prevCell = tableCell.previousWidget;\n            }\n            else if ((tableCell.cellFormat.columnSpan > 1 || tableCell.columnIndex > 1) && tableCell.ownerRow.rowIndex > 0) {\n                var previousRow = tableCell.ownerRow.previousWidget;\n                while (!isNullOrUndefined(previousRow) && previousRow.childWidgets.length > 0) {\n                    for (var i = 0; i < previousRow.childWidgets.length; i++) {\n                        var prevRowCell = previousRow.childWidgets[i];\n                        if (prevRowCell.columnIndex + prevRowCell.cellFormat.columnSpan === tableCell.columnIndex) {\n                            prevCell = previousRow.childWidgets[i];\n                            break;\n                        }\n                    }\n                    if (!isNullOrUndefined(prevCell)) {\n                        break;\n                    }\n                    previousRow = previousRow.previousWidget;\n                }\n            }\n            leftBorder = tableCell.getPreviousCellLeftBorder(leftBorder, prevCell);\n        }\n        if (isNullOrUndefined(leftBorder)) {\n            leftBorder = new WBorder(tableCell.cellFormat.borders);\n        }\n        return leftBorder;\n    };\n    /**\n     * @private\n     */\n    TableCellWidget.prototype.getLeftBorderWidth = function () {\n        var borderWidth = 0;\n        //let ownerTable = this.ownerTable;\n        //Added null condition check for asynchronous loading.\n        // if (this.cellFormat !== null && this.cellFormat.borders !== null) {\n        // update the margins values respect to layouting of borders.\n        //For normal table cells only left border is rendred. for last cell left and right border is rendred.\n        // this border widths are not included in margins.\n        //     boderWidth = this.cellFormat.borders.GetRightBorderToRender(this).GetLineWidth();\n        //need to render rightBorder specifically for all the cells when the cellSpacing is greater than zero or for last cell of each row.\n        // }\n        return borderWidth;\n    };\n    /**\n     * @private\n     */\n    TableCellWidget.prototype.getRightBorderWidth = function () {\n        var borderWidth = 0;\n        var ownerTable = this.ownerTable;\n        //Added null condition check for asynchronous loading.\n        // if (this.cellFormat !== null && this.cellFormat.borders !== null) {\n        ///need to render right border specifically for all the cells when the cell spacing is \n        //greater than zero or for last cell of each row.\n        //     let isLastCell: boolean = false;\n        //     isLastCell = this.cellIndex === 0;\n        //     if (ownerTable.tableFormat.cellSpacing > 0 || isLastCell) {\n        //         boderWidth = this.cellFormat.borders.getLeftBorderToRender(this).GetLineWidth();\n        //     }\n        // }\n        return borderWidth;\n    };\n    /**\n     * @private\n     */\n    TableCellWidget.prototype.getCellSpacing = function () {\n        var actualCellSpacing = this.ownerTable && this.ownerTable.tableFormat ? this.ownerTable.tableFormat.cellSpacing : 0;\n        var cellSpacingToLayout = actualCellSpacing;\n        // Considers the left, right margins and border widths(only available for Layouted table) for Minimum width.\n        if (this.ownerRow.childWidgets.length === 1) {\n            cellSpacingToLayout = actualCellSpacing * 2;\n        }\n        else if (this.cellIndex === 0 || this.cellIndex === this.ownerRow.childWidgets.length - 1) {\n            cellSpacingToLayout = actualCellSpacing + (actualCellSpacing / 2);\n        }\n        else {\n            cellSpacingToLayout = actualCellSpacing;\n        }\n        return cellSpacingToLayout;\n    };\n    /**\n     * @private\n     */\n    TableCellWidget.prototype.getMinimumPreferredWidth = function () {\n        var defaultWidth = 0;\n        defaultWidth = this.leftMargin + this.rightMargin + this.getLeftBorderWidth() + this.getRightBorderWidth() + this.getCellSpacing();\n        return defaultWidth;\n    };\n    /**\n     * @private\n     */\n    TableCellWidget.prototype.getPreviousCellLeftBorder = function (leftBorder, previousCell) {\n        // tslint:disable-next-line:max-line-length\n        if ((isNullOrUndefined(previousCell) || (!isNullOrUndefined(leftBorder) && (leftBorder.lineStyle === 'None' && !leftBorder.hasNoneStyle)))) {\n            if (!isNullOrUndefined(leftBorder) && !(leftBorder.ownerBase.ownerBase instanceof WTableFormat)) {\n                // tslint:disable-next-line:max-line-length\n                return this.getLeftBorderToRenderByHierarchy(leftBorder, TableRowWidget.getRowOf(leftBorder.ownerBase).rowFormat.borders, TableWidget.getTableOf(leftBorder.ownerBase).tableFormat.borders);\n            }\n        }\n        else {\n            var prevCellRightBorder = undefined;\n            // tslint:disable-next-line:max-line-length\n            if (!isNullOrUndefined(previousCell.cellFormat.borders) && !isNullOrUndefined(previousCell.cellFormat.borders.right) && previousCell.cellFormat.borders.right.lineStyle !== 'None') {\n                prevCellRightBorder = previousCell.cellFormat.borders.right;\n            }\n            if (!isNullOrUndefined(prevCellRightBorder) && prevCellRightBorder.lineStyle !== 'None') {\n                return this.getBorderBasedOnPriority(prevCellRightBorder, leftBorder);\n            }\n            else if (!isNullOrUndefined(leftBorder) && !(leftBorder.ownerBase.ownerBase instanceof WTableFormat)) {\n                // tslint:disable-next-line:max-line-length\n                return this.getLeftBorderToRenderByHierarchy(leftBorder, TableRowWidget.getRowOf(leftBorder.ownerBase).rowFormat.borders, TableWidget.getTableOf(leftBorder.ownerBase).tableFormat.borders);\n            }\n        }\n        return leftBorder;\n    };\n    /**\n     * @private\n     */\n    TableCellWidget.prototype.getBorderBasedOnPriority = function (border, adjacentBorder) {\n        // If the cell and its adjacent cell defined different borders then based on this algorithm the border choose to render.\n        // Reference link :https://msdn.microsoft.com/en-us/library/office/documentformat.openxml.wordprocessing.tablecellborders.aspx\n        if (isNullOrUndefined(border)) {\n            return adjacentBorder;\n        }\n        else if (isNullOrUndefined(adjacentBorder)) {\n            return border;\n        }\n        var borderWeight = border.getBorderWeight();\n        var adjacentBorderWeight = adjacentBorder.getBorderWeight();\n        //the border with higher wight  shall be displayed.\n        if (borderWeight === adjacentBorderWeight) {\n            //if the border is equal weight the based on the priority the border will be choosen to render.\n            var borderPriority = border.getPrecedence();\n            var adjacentBorderPriority = adjacentBorder.getPrecedence();\n            if (borderPriority === adjacentBorderPriority) {\n                //The color with the smaller brightness value shall be displayed.\n                var borderColInRGB = this.convertHexToRGB(border.color);\n                var R1 = borderColInRGB.r;\n                var G1 = borderColInRGB.g;\n                var B1 = borderColInRGB.b;\n                var adjacentBorderColInRGB = this.convertHexToRGB(adjacentBorder.color);\n                var R2 = adjacentBorderColInRGB.r;\n                var G2 = adjacentBorderColInRGB.g;\n                var B2 = adjacentBorderColInRGB.b;\n                var borderBrightness = (R1 + B1 + (2 * G1));\n                var adjacentBorderBrightness = (R2 + B2 + (2 * G2));\n                if (borderBrightness === adjacentBorderBrightness) {\n                    borderBrightness = (B1 + (2 * G1));\n                    adjacentBorderBrightness = (B2 + (2 * G2));\n                    if (borderBrightness === adjacentBorderBrightness) {\n                        if (G1 === G2) {\n                            return border;\n                        }\n                        else if (G1 > G2) {\n                            return adjacentBorder;\n                        }\n                        else {\n                            return border;\n                        }\n                    }\n                    else if (borderBrightness > adjacentBorderBrightness) {\n                        return adjacentBorder;\n                    }\n                    else {\n                        return border;\n                    }\n                }\n                else if (borderBrightness > adjacentBorderBrightness) {\n                    return adjacentBorder;\n                }\n                else {\n                    return border;\n                }\n            }\n            else if (borderPriority > adjacentBorderPriority) {\n                return border;\n            }\n            else {\n                return adjacentBorder;\n            }\n        }\n        else if (borderWeight > adjacentBorderWeight) {\n            return border;\n        }\n        else {\n            return adjacentBorder;\n        }\n    };\n    /**\n     * @private\n     */\n    TableCellWidget.prototype.getLeftBorderToRenderByHierarchy = function (leftBorder, rowBorders, tableBorders) {\n        if (!isNullOrUndefined(leftBorder) && (leftBorder.lineStyle !== 'None' || (leftBorder.hasNoneStyle &&\n            //If border defined with default values then border drawn based on hierarchy. \n            !(leftBorder.lineStyle === 'None' && leftBorder.lineWidth === 0 && leftBorder.color === '#000000')))) {\n            return leftBorder;\n            // tslint:disable-next-line:max-line-length\n        }\n        else if (!isNullOrUndefined(leftBorder) && (leftBorder.ownerBase instanceof WBorders) && TableCellWidget.getCellOf(leftBorder.ownerBase).columnIndex === 0) {\n            if (!isNullOrUndefined(tableBorders) && !isNullOrUndefined(tableBorders.left)) {\n                leftBorder = tableBorders.left;\n            }\n            return leftBorder;\n        }\n        else if (!isNullOrUndefined(rowBorders)\n            && !isNullOrUndefined(rowBorders.vertical) && rowBorders.vertical.lineStyle !== 'None') {\n            return leftBorder = rowBorders.vertical;\n        }\n        else if (!isNullOrUndefined(tableBorders)\n            && !isNullOrUndefined(tableBorders.vertical) && tableBorders.vertical.lineStyle !== 'None') {\n            return leftBorder = tableBorders.vertical;\n        }\n        else {\n            return leftBorder;\n        }\n    };\n    /**\n     * @private\n     */\n    TableCellWidget.getCellRightBorder = function (tableCell) {\n        var rightBorder = undefined;\n        var cellBorder = tableCell.cellFormat.borders;\n        var rowBorders = !isNullOrUndefined(tableCell.ownerRow) ? tableCell.ownerRow.rowFormat.borders : undefined;\n        var tableBorders = !isNullOrUndefined(tableCell.ownerTable) ? tableCell.ownerTable.tableFormat.borders : undefined;\n        if (!isNullOrUndefined(cellBorder.right)) {\n            rightBorder = cellBorder.right;\n        }\n        if (isNullOrUndefined(rightBorder)) {\n            rightBorder = tableCell.getRightBorderToRenderByHierarchy(rightBorder, rowBorders, tableBorders);\n        }\n        if (tableCell.ownerTable.tableFormat.cellSpacing > 0) {\n            rightBorder = tableCell.getRightBorderToRenderByHierarchy(rightBorder, rowBorders, tableBorders);\n        }\n        else {\n            var nextCell = undefined;\n            if (!isNullOrUndefined(tableCell.nextWidget)) {\n                nextCell = tableCell.nextWidget;\n            }\n            // if the border is shared then choose the border based on Conflict Resolution algorithm.\n            rightBorder = tableCell.getAdjacentCellRightBorder(rightBorder, nextCell);\n        }\n        if (isNullOrUndefined(rightBorder)) {\n            rightBorder = new WBorder(tableCell.cellFormat.borders);\n        }\n        return rightBorder;\n    };\n    /**\n     * @private\n     */\n    TableCellWidget.prototype.getAdjacentCellRightBorder = function (rightBorder, nextCell) {\n        // tslint:disable-next-line:max-line-length\n        if (isNullOrUndefined(nextCell) || (!isNullOrUndefined(rightBorder) && (rightBorder.lineStyle === 'None' && !rightBorder.hasNoneStyle))) {\n            if (!isNullOrUndefined(rightBorder) && !(rightBorder.ownerBase.ownerBase instanceof WTableFormat)) {\n                // tslint:disable-next-line:max-line-length\n                return this.getRightBorderToRenderByHierarchy(rightBorder, TableRowWidget.getRowOf(rightBorder.ownerBase).rowFormat.borders, TableWidget.getTableOf(rightBorder.ownerBase).tableFormat.borders);\n            }\n        }\n        else {\n            var nextCellLeftBorder = undefined;\n            // tslint:disable-next-line:max-line-length\n            if (!isNullOrUndefined(nextCell.cellFormat.borders) && !isNullOrUndefined(nextCell.cellFormat.borders.left) && nextCell.cellFormat.borders.left.lineStyle !== 'None') {\n                nextCellLeftBorder = nextCell.cellFormat.borders.left;\n            }\n            if (!isNullOrUndefined(nextCellLeftBorder) && nextCellLeftBorder.lineStyle !== 'None') {\n                return this.getBorderBasedOnPriority(rightBorder, nextCellLeftBorder);\n            }\n            else if (!isNullOrUndefined(rightBorder) && !(rightBorder.ownerBase.ownerBase instanceof WTableFormat)) {\n                // tslint:disable-next-line:max-line-length\n                return this.getRightBorderToRenderByHierarchy(rightBorder, TableRowWidget.getRowOf(rightBorder.ownerBase).rowFormat.borders, TableWidget.getTableOf(rightBorder.ownerBase).tableFormat.borders);\n            }\n        }\n        return rightBorder;\n    };\n    /**\n     * @private\n     */\n    TableCellWidget.prototype.getRightBorderToRenderByHierarchy = function (rightBorder, rowBorders, tableBorders) {\n        if (!isNullOrUndefined(rightBorder) && (rightBorder.lineStyle !== 'None' || (rightBorder.hasNoneStyle &&\n            //If border defined with default values then border drawn based on hierarchy. \n            !(rightBorder.lineStyle === 'None' && rightBorder.lineWidth === 0 && rightBorder.color === '#000000')))) {\n            return rightBorder;\n            // tslint:disable-next-line:max-line-length\n        }\n        else if (!isNullOrUndefined(rightBorder) && (rightBorder.ownerBase instanceof WBorders) && TableCellWidget.getCellOf(rightBorder.ownerBase).columnIndex === TableCellWidget.getCellOf(rightBorder.ownerBase).ownerRow.childWidgets.length - 1) {\n            if (!isNullOrUndefined(tableBorders) && !isNullOrUndefined(tableBorders.right)) {\n                rightBorder = tableBorders.right;\n            }\n            return rightBorder;\n        }\n        else if (!isNullOrUndefined(rowBorders)\n            && !isNullOrUndefined(rowBorders.vertical) && rowBorders.vertical.lineStyle !== 'None') {\n            return rightBorder = rowBorders.vertical;\n        }\n        else if (!isNullOrUndefined(tableBorders)\n            && !isNullOrUndefined(tableBorders.vertical) && tableBorders.vertical.lineStyle !== 'None') {\n            return rightBorder = tableBorders.vertical;\n        }\n        else {\n            return rightBorder;\n        }\n    };\n    /**\n     * @private\n     */\n    TableCellWidget.getCellTopBorder = function (tableCell) {\n        var topBorder = undefined;\n        var cellBorder = tableCell.cellFormat.borders;\n        var rowBorders = !isNullOrUndefined(tableCell.ownerRow) ? tableCell.ownerRow.rowFormat.borders : undefined;\n        var tableBorders = !isNullOrUndefined(tableCell.ownerTable) ? tableCell.ownerTable.tableFormat.borders : undefined;\n        if (!isNullOrUndefined(cellBorder.top)) {\n            topBorder = cellBorder.top;\n        }\n        if (isNullOrUndefined(topBorder)) {\n            topBorder = tableCell.getTopBorderToRenderByHierarchy(topBorder, rowBorders, tableBorders);\n        }\n        if (tableCell.ownerTable.tableFormat.cellSpacing > 0) {\n            topBorder = tableCell.getTopBorderToRenderByHierarchy(topBorder, rowBorders, tableBorders);\n        }\n        else {\n            var prevTopCell = undefined;\n            //ToDo: Need to analyze more to get the previous cell.\n            var prevRow = tableCell.ownerRow.previousWidget;\n            while (!isNullOrUndefined(prevRow) && prevRow.childWidgets.length > 0) {\n                for (var i = 0; i < prevRow.childWidgets.length; i++) {\n                    var prevRowCell = prevRow.childWidgets[i];\n                    if (prevRowCell.columnIndex + prevRowCell.cellFormat.columnSpan - 1 >= tableCell.columnIndex) {\n                        prevTopCell = prevRow.childWidgets[i];\n                        break;\n                    }\n                }\n                if (!isNullOrUndefined(prevTopCell)) {\n                    break;\n                }\n                prevRow = prevRow.previousWidget;\n                //If all the previous rows checked and the previous top cell is null\n                // then TableCell previus row matched column index cell is taken for border calculation.\n                if (isNullOrUndefined(prevRow) && isNullOrUndefined(prevTopCell)) {\n                    prevRow = tableCell.ownerRow.previousWidget;\n                    if (tableCell.columnIndex < prevRow.childWidgets.length) {\n                        for (var i = 0; i < prevRow.childWidgets.length; i++) {\n                            var prevRowCell = prevRow.childWidgets[i];\n                            if (prevRowCell.columnIndex === tableCell.columnIndex) {\n                                prevTopCell = prevRow.childWidgets[i];\n                                break;\n                            }\n                        }\n                        //If table cell Column index is greater than previous row cells count then last cell is taken as previous top cell.\n                    }\n                    else {\n                        // tslint:disable-next-line:max-line-length\n                        prevTopCell = tableCell.ownerRow.previousWidget.childWidgets[tableCell.ownerRow.previousWidget.childWidgets.length - 1];\n                    }\n                }\n            }\n            //If the border is shared then choose the border based on Conflict Resolution algorithm.\n            topBorder = tableCell.getPreviousCellTopBorder(topBorder, prevTopCell);\n        }\n        if (isNullOrUndefined(topBorder)) {\n            topBorder = new WBorder(tableCell.cellFormat.borders);\n        }\n        return topBorder;\n    };\n    /**\n     * @private\n     */\n    TableCellWidget.prototype.getPreviousCellTopBorder = function (topBorder, previousTopCell) {\n        // tslint:disable-next-line:max-line-length\n        if (isNullOrUndefined(previousTopCell) || (!isNullOrUndefined(topBorder) && (topBorder.lineStyle === 'None' && !topBorder.hasNoneStyle))) {\n            if (!isNullOrUndefined(topBorder) && !(topBorder.ownerBase.ownerBase instanceof WTableFormat)) {\n                // tslint:disable-next-line:max-line-length\n                return this.getTopBorderToRenderByHierarchy(topBorder, TableRowWidget.getRowOf(topBorder.ownerBase).rowFormat.borders, TableWidget.getTableOf(topBorder.ownerBase).tableFormat.borders);\n            }\n        }\n        else {\n            var prevTopCellBottomBorder = undefined;\n            // tslint:disable-next-line:max-line-length\n            if (!isNullOrUndefined(previousTopCell.cellFormat.borders) && !isNullOrUndefined(previousTopCell.cellFormat.borders.bottom) && previousTopCell.cellFormat.borders.bottom.lineStyle !== 'None') {\n                prevTopCellBottomBorder = previousTopCell.cellFormat.borders.bottom;\n            }\n            if (!isNullOrUndefined(prevTopCellBottomBorder) && prevTopCellBottomBorder.lineStyle !== 'None') {\n                return this.getBorderBasedOnPriority(topBorder, prevTopCellBottomBorder);\n            }\n            else if (!isNullOrUndefined(topBorder) && !(topBorder.ownerBase.ownerBase instanceof WTableFormat)) {\n                // tslint:disable-next-line:max-line-length\n                return this.getTopBorderToRenderByHierarchy(topBorder, TableRowWidget.getRowOf(topBorder.ownerBase).rowFormat.borders, TableWidget.getTableOf(topBorder.ownerBase).tableFormat.borders);\n            }\n        }\n        return topBorder;\n    };\n    /**\n     * @private\n     */\n    TableCellWidget.prototype.getTopBorderToRenderByHierarchy = function (topBorder, rowBorders, tableBorders) {\n        if (!isNullOrUndefined(topBorder) && (topBorder.lineStyle !== 'None' || (topBorder.hasNoneStyle &&\n            //If border defined with default values then border drawn based on hierarchy. \n            !(topBorder.lineStyle === 'None' && topBorder.lineWidth === 0 && topBorder.color === '#000000')))) {\n            return topBorder;\n            // tslint:disable-next-line:max-line-length\n        }\n        else if (!isNullOrUndefined(topBorder) && (topBorder.ownerBase instanceof WBorders) && TableCellWidget.getCellOf(topBorder.ownerBase).ownerRow.rowIndex === 0) {\n            if (!isNullOrUndefined(tableBorders) && !isNullOrUndefined(tableBorders.top)) {\n                topBorder = tableBorders.top;\n            }\n            return topBorder;\n        }\n        else if (!isNullOrUndefined(rowBorders)\n            && !isNullOrUndefined(rowBorders.horizontal) && rowBorders.horizontal.lineStyle !== 'None') {\n            return topBorder = rowBorders.horizontal;\n        }\n        else if (!isNullOrUndefined(tableBorders)\n            && !isNullOrUndefined(tableBorders.horizontal) && tableBorders.horizontal.lineStyle !== 'None') {\n            return topBorder = tableBorders.horizontal;\n        }\n        else {\n            return topBorder;\n        }\n    };\n    /**\n     * @private\n     */\n    TableCellWidget.getCellBottomBorder = function (tableCell) {\n        var bottomBorder = undefined;\n        var cellBorder = tableCell.cellFormat.borders;\n        var rowBorders = !isNullOrUndefined(tableCell.ownerRow) ? tableCell.ownerRow.rowFormat.borders : undefined;\n        var tableBorders = !isNullOrUndefined(tableCell.ownerTable) ? tableCell.ownerTable.tableFormat.borders : undefined;\n        if (!isNullOrUndefined(cellBorder.bottom)) {\n            bottomBorder = cellBorder.bottom;\n        }\n        if (isNullOrUndefined(bottomBorder)) {\n            // tslint:disable-next-line:max-line-length\n            bottomBorder = tableCell.getBottomBorderToRenderByHierarchy(bottomBorder, rowBorders, tableBorders); // select the left border based on heirarchy.\n        }\n        if (tableCell.ownerTable.tableFormat.cellSpacing > 0) {\n            bottomBorder = tableCell.getBottomBorderToRenderByHierarchy(bottomBorder, rowBorders, tableBorders);\n        }\n        else {\n            var nextBottomCell = undefined;\n            var nextRow = tableCell.ownerRow.nextWidget;\n            if (!isNullOrUndefined(nextRow) && tableCell.columnIndex < nextRow.childWidgets.length) {\n                nextBottomCell = nextRow.childWidgets[tableCell.columnIndex];\n            }\n            //If the border is shared then choose the border based on Conflict Resolution algorithm.\n            bottomBorder = tableCell.getAdjacentCellBottomBorder(bottomBorder, nextBottomCell);\n        }\n        if (isNullOrUndefined(bottomBorder)) {\n            bottomBorder = new WBorder(tableCell.cellFormat.borders);\n        }\n        return bottomBorder;\n    };\n    /**\n     * @private\n     */\n    TableCellWidget.prototype.getAdjacentCellBottomBorder = function (bottomBorder, nextBottomCell) {\n        // tslint:disable-next-line:max-line-length\n        if (isNullOrUndefined(nextBottomCell) || (!isNullOrUndefined(bottomBorder) && (bottomBorder.lineStyle === 'None' && !bottomBorder.hasNoneStyle))) {\n            if (!isNullOrUndefined(bottomBorder) && !(bottomBorder.ownerBase.ownerBase instanceof WTableFormat)) {\n                // tslint:disable-next-line:max-line-length\n                return this.getBottomBorderToRenderByHierarchy(bottomBorder, TableRowWidget.getRowOf(bottomBorder.ownerBase).rowFormat.borders, TableWidget.getTableOf(bottomBorder.ownerBase).tableFormat.borders);\n            }\n        }\n        else {\n            var prevBottomCellTopBorder = undefined;\n            // tslint:disable-next-line:max-line-length\n            if (!isNullOrUndefined(nextBottomCell.cellFormat.borders) && !isNullOrUndefined(nextBottomCell.cellFormat.borders.top) && nextBottomCell.cellFormat.borders.top.lineStyle !== 'None') {\n                prevBottomCellTopBorder = nextBottomCell.cellFormat.borders.top;\n            }\n            if (!isNullOrUndefined(prevBottomCellTopBorder) && prevBottomCellTopBorder.lineStyle !== 'None') {\n                return this.getBorderBasedOnPriority(bottomBorder, prevBottomCellTopBorder);\n            }\n            else if (!isNullOrUndefined(bottomBorder) && !(bottomBorder.ownerBase.ownerBase instanceof WTableFormat)) {\n                // tslint:disable-next-line:max-line-length\n                return this.getBottomBorderToRenderByHierarchy(bottomBorder, TableRowWidget.getRowOf(bottomBorder.ownerBase).rowFormat.borders, TableWidget.getTableOf(bottomBorder.ownerBase).tableFormat.borders);\n            }\n        }\n        return bottomBorder;\n    };\n    /**\n     * @private\n     */\n    TableCellWidget.prototype.getBottomBorderToRenderByHierarchy = function (bottomBorder, rowBorders, tableBorders) {\n        if (!isNullOrUndefined(bottomBorder) && (bottomBorder.lineStyle !== 'None' || (bottomBorder.hasNoneStyle &&\n            //If border defined with default values then border drawn based on hierarchy. \n            !(bottomBorder.lineStyle === 'None' && bottomBorder.lineWidth === 0 && bottomBorder.color === '#000000')))) {\n            return bottomBorder;\n            // tslint:disable-next-line:max-line-length\n        }\n        else if (!isNullOrUndefined(bottomBorder) && (bottomBorder.ownerBase instanceof WBorders) && TableCellWidget.getCellOf(bottomBorder.ownerBase).ownerRow.rowIndex + TableCellWidget.getCellOf(bottomBorder.ownerBase).cellFormat.rowSpan === TableCellWidget.getCellOf(bottomBorder.ownerBase).ownerTable.childWidgets.length) {\n            if (!isNullOrUndefined(tableBorders) && !isNullOrUndefined(tableBorders.bottom)) {\n                bottomBorder = tableBorders.bottom;\n            }\n            return bottomBorder;\n        }\n        else if (!isNullOrUndefined(rowBorders)\n            && !isNullOrUndefined(rowBorders.horizontal) && rowBorders.horizontal.lineStyle !== 'None') {\n            return bottomBorder = rowBorders.horizontal;\n        }\n        else if (!isNullOrUndefined(tableBorders)\n            && !isNullOrUndefined(tableBorders.horizontal) && tableBorders.horizontal.lineStyle !== 'None') {\n            return bottomBorder = tableBorders.horizontal;\n        }\n        else {\n            return bottomBorder;\n        }\n    };\n    TableCellWidget.prototype.convertHexToRGB = function (colorCode) {\n        if (colorCode) {\n            colorCode = colorCode.replace(/[^0-9A-Ã¢â‚¬Å’Ã¢â‚¬â€¹F]/gi, ''); // To remove # from color code string.\n            var colCodeNo = parseInt(colorCode, 16);\n            var r = (colCodeNo >> 16) & 255;\n            var g = (colCodeNo >> 8) & 255;\n            var b = colCodeNo & 255;\n            return { 'r': r, 'g': g, 'b': b };\n        }\n        return undefined;\n    };\n    /**\n     * @private\n     */\n    TableCellWidget.getCellOf = function (node) {\n        if (node instanceof WBorders) {\n            if (node.ownerBase instanceof WCellFormat && node.ownerBase.ownerBase instanceof TableCellWidget) {\n                return node.ownerBase.ownerBase;\n            }\n            else {\n                return undefined;\n            }\n        }\n        return undefined;\n    };\n    /**\n     * @private\n     */\n    TableCellWidget.prototype.destroyInternal = function (viewer) {\n        // let viewer: LayoutViewer = undefined;\n        // let page: Page = this.getPage();\n        // if (!isNullOrUndefined(page ))\n        //     viewer = page.viewer;\n        if (!isNullOrUndefined(this.childWidgets)) {\n            for (var i = 0; i < this.childWidgets.length; i++) {\n                var widget = this.childWidgets[i];\n                if (widget instanceof ParagraphWidget) {\n                    widget.destroyInternal(viewer);\n                }\n                else {\n                    widget.destroyInternal(viewer);\n                }\n                i--;\n            }\n            this.childWidgets = undefined;\n        }\n        this.destroy();\n    };\n    /**\n     * @private\n     */\n    TableCellWidget.prototype.clone = function () {\n        var cell = new TableCellWidget();\n        cell.cellFormat.copyFormat(this.cellFormat);\n        for (var i = 0; i < this.childWidgets.length; i++) {\n            var block = this.childWidgets[i].clone();\n            cell.childWidgets.push(block);\n            block.containerWidget = cell;\n            block.index = i;\n        }\n        cell.leftBorderWidth = this.leftBorderWidth;\n        cell.rightBorderWidth = this.rightBorderWidth;\n        if (this.margin) {\n            cell.margin = this.margin.clone();\n        }\n        cell.columnIndex = this.columnIndex;\n        cell.x = this.x;\n        cell.y = this.y;\n        cell.height = this.height;\n        cell.width = this.width;\n        return cell;\n    };\n    /**\n     * @private\n     */\n    TableCellWidget.prototype.destroy = function () {\n        // if (this.cellFormat) {\n        //     this.cellFormat.destroy();\n        // }\n        this.cellFormat = undefined;\n        this.rowIndex = undefined;\n        this.columnIndex = undefined;\n        _super.prototype.destroy.call(this);\n    };\n    return TableCellWidget;\n}(BlockWidget));\nexport { TableCellWidget };\n/**\n * @private\n */\nvar LineWidget = /** @class */ (function () {\n    /**\n     * Initialize the constructor of LineWidget\n     */\n    function LineWidget(paragraphWidget) {\n        /**\n         * @private\n         */\n        this.children = [];\n        /**\n         * @private\n         */\n        this.x = 0;\n        /**\n         * @private\n         */\n        this.y = 0;\n        /**\n         * @private\n         */\n        this.width = 0;\n        /**\n         * @private\n         */\n        this.height = 0;\n        this.paragraph = paragraphWidget;\n    }\n    Object.defineProperty(LineWidget.prototype, \"indexInOwner\", {\n        /**\n         * @private\n         */\n        get: function () {\n            if (this.paragraph && this.paragraph.childWidgets) {\n                return this.paragraph.childWidgets.indexOf(this);\n            }\n            return -1;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(LineWidget.prototype, \"nextLine\", {\n        /**\n         * @private\n         */\n        get: function () {\n            var paragraph = this.paragraph;\n            var lineIndex = this.indexInOwner;\n            if (lineIndex <= paragraph.childWidgets.length - 2) {\n                return paragraph.childWidgets[lineIndex + 1];\n            }\n            else if (paragraph.nextSplitWidget) {\n                var line = paragraph.nextSplitWidget.firstChild;\n                if (line instanceof LineWidget && line.paragraph.equals(this.paragraph)) {\n                    return line;\n                }\n            }\n            return undefined;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(LineWidget.prototype, \"previousLine\", {\n        /**\n         * @private\n         */\n        get: function () {\n            var paragraph = this.paragraph;\n            var lineIndex = this.indexInOwner;\n            var splitParagraph = paragraph.previousSplitWidget;\n            if (lineIndex > 0) {\n                return paragraph.childWidgets[lineIndex - 1];\n            }\n            else if (splitParagraph instanceof ParagraphWidget) {\n                var line = splitParagraph.lastChild;\n                if (line instanceof LineWidget && line.paragraph.equals(this.paragraph)) {\n                    return line;\n                }\n            }\n            return undefined;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(LineWidget.prototype, \"isEndsWithPageBreak\", {\n        /**\n         * @private\n         */\n        get: function () {\n            if (this.children.length > 0) {\n                var lastElement = this.children[this.children.length - 1];\n                if (lastElement instanceof TextElementBox) {\n                    return lastElement.isPageBreak;\n                }\n            }\n            return false;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    /**\n     * @private\n     */\n    LineWidget.prototype.isFirstLine = function () {\n        var index = this.indexInOwner;\n        if (index > -1 && this.paragraph.previousSplitWidget === undefined) {\n            return index === 0;\n        }\n        return false;\n    };\n    /**\n     * @private\n     */\n    LineWidget.prototype.isLastLine = function () {\n        var index = this.indexInOwner;\n        if (index > -1 && this.paragraph.nextSplitWidget === undefined) {\n            return index === this.paragraph.childWidgets.length - 1;\n        }\n        return false;\n    };\n    /**\n     * @private\n     */\n    LineWidget.prototype.getOffset = function (inline, index) {\n        if (isNullOrUndefined(inline)) {\n            return index;\n        }\n        var textIndex = index;\n        var line = inline.line;\n        var lineIndex = inline.line.paragraph.childWidgets.indexOf(inline.line);\n        for (var i = 0; i < line.children.length; i++) {\n            var inlineElement = line.children[i];\n            if (inline === inlineElement) {\n                break;\n            }\n            if (inlineElement instanceof ListTextElementBox) {\n                continue;\n            }\n            textIndex += inlineElement.length;\n        }\n        return textIndex;\n    };\n    /**\n     * @private\n     */\n    LineWidget.prototype.getEndOffset = function () {\n        var startOffset = 0;\n        var count = 0;\n        for (var i = 0; i < this.children.length; i++) {\n            var inlineElement = this.children[i];\n            if (inlineElement.length === 0) {\n                continue;\n            }\n            if (inlineElement instanceof ListTextElementBox) {\n                continue;\n            }\n            if (inlineElement instanceof TextElementBox || inlineElement instanceof ImageElementBox\n                || inlineElement instanceof BookmarkElementBox || (inlineElement instanceof FieldElementBox\n                && HelperMethods.isLinkedFieldCharacter(inlineElement))) {\n                startOffset = count + inlineElement.length;\n            }\n            count += inlineElement.length;\n        }\n        return startOffset;\n    };\n    /**\n     * @private\n     */\n    LineWidget.prototype.getInline = function (offset, indexInInline) {\n        var inlineElement = undefined;\n        var count = 0;\n        var isStarted = false;\n        if (this.children.length === 0) {\n            if (this.previousLine) {\n                var elementBox = this.previousLine.children[this.previousLine.children.length - 1];\n                if (elementBox instanceof TextElementBox && elementBox.text === '\\v') {\n                    inlineElement = this.previousLine.children[this.previousLine.children.length - 1];\n                    indexInInline = 1;\n                    return { 'element': inlineElement, 'index': indexInInline };\n                }\n            }\n        }\n        for (var i = 0; i < this.children.length; i++) {\n            inlineElement = this.children[i];\n            if (inlineElement instanceof ListTextElementBox) {\n                continue;\n            }\n            if (!isStarted && (inlineElement instanceof TextElementBox || inlineElement instanceof ImageElementBox\n                || inlineElement instanceof BookmarkElementBox\n                || inlineElement instanceof FieldElementBox && HelperMethods.isLinkedFieldCharacter(inlineElement))) {\n                isStarted = true;\n            }\n            if (isStarted && offset <= count + inlineElement.length) {\n                indexInInline = (offset - count);\n                return { 'element': inlineElement, 'index': indexInInline };\n            }\n            count += inlineElement.length;\n        }\n        if (offset > count) {\n            indexInInline = isNullOrUndefined(inlineElement) ? offset : inlineElement.length;\n        }\n        return { 'element': inlineElement, 'index': indexInInline };\n    };\n    /**\n     * @private\n     */\n    LineWidget.prototype.getHierarchicalIndex = function (hierarchicalIndex) {\n        var node = this;\n        hierarchicalIndex = node.paragraph.childWidgets.indexOf(node) + ';' + hierarchicalIndex;\n        if (node.paragraph instanceof BlockWidget) {\n            return node.paragraph.getHierarchicalIndex(hierarchicalIndex);\n        }\n        return hierarchicalIndex;\n    };\n    /**\n     * @private\n     */\n    LineWidget.prototype.clone = function () {\n        var line = new LineWidget(undefined);\n        for (var j = 0; j < this.children.length; j++) {\n            var element = this.children[j];\n            var clone = element.clone();\n            line.children.push(clone);\n            clone.line = line;\n        }\n        line.width = this.width;\n        line.height = this.height;\n        return line;\n    };\n    /**\n     * @private\n     */\n    LineWidget.prototype.destroy = function () {\n        if (!isNullOrUndefined(this.children)) {\n            for (var i = 0; i < this.children.length; i++) {\n                this.children[i].destroy();\n            }\n            this.children = [];\n        }\n        this.children = undefined;\n        if (this.paragraph) {\n            this.paragraph.removeChild(this.indexInOwner);\n        }\n        this.paragraph = undefined;\n        this.x = undefined;\n        this.y = undefined;\n        this.width = undefined;\n        this.height = undefined;\n    };\n    return LineWidget;\n}());\nexport { LineWidget };\n/**\n * @private\n */\nvar ElementBox = /** @class */ (function () {\n    /**\n     * Initialize the constructor of ElementBox\n     */\n    function ElementBox() {\n        /**\n         * @private\n         */\n        this.x = 0;\n        /**\n         * @private\n         */\n        this.y = 0;\n        /**\n         * @private\n         */\n        this.width = 0;\n        /**\n         * @private\n         */\n        this.height = 0;\n        /**\n         * @private\n         */\n        this.margin = new Margin(0, 0, 0, 0);\n        /**\n         * @private\n         */\n        this.characterFormat = undefined;\n        this.characterFormat = new WCharacterFormat(this);\n        this.margin = new Margin(0, 0, 0, 0);\n    }\n    Object.defineProperty(ElementBox.prototype, \"isPageBreak\", {\n        /**\n         * @private\n         */\n        get: function () {\n            if (this instanceof TextElementBox) {\n                return this.text === '\\f';\n            }\n            return false;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    /**\n     * @private\n     */\n    ElementBox.prototype.linkFieldCharacter = function (viewer) {\n        if (!(this instanceof FieldElementBox)) {\n            return;\n        }\n        if (this.fieldType === 0) {\n            var fieldBegin = this;\n            if (isNullOrUndefined(fieldBegin.fieldEnd)) {\n                this.linkFieldTraversingForward(this.line, fieldBegin, fieldBegin);\n                if (viewer.fields.indexOf(fieldBegin) === -1) {\n                    viewer.fields.push(fieldBegin);\n                }\n            }\n        }\n        else if (this.fieldType === 2) {\n            var fieldSeparator = this;\n            //Links the field begin for the current separator.\n            if (isNullOrUndefined(fieldSeparator.fieldBegin)) {\n                this.linkFieldTraversingBackwardSeparator(this.line, fieldSeparator, fieldSeparator);\n            }\n            fieldSeparator.fieldBegin.fieldSeparator = fieldSeparator;\n            if (!isNullOrUndefined(fieldSeparator.fieldBegin)) {\n                //Links to field end traversing from field separator.\n                var isFieldEnd = this.linkFieldTraversingForward(this.line, fieldSeparator.fieldBegin, fieldSeparator);\n                if (isNullOrUndefined(fieldSeparator.fieldEnd) && isFieldEnd) {\n                    fieldSeparator.fieldEnd = fieldSeparator.fieldBegin.fieldEnd;\n                }\n                if (fieldSeparator.fieldEnd) {\n                    fieldSeparator.fieldEnd.fieldSeparator = fieldSeparator;\n                }\n            }\n        }\n        else {\n            var fieldEnd = this;\n            //Links the field begin and separator for the current end.\n            if (isNullOrUndefined(fieldEnd.fieldBegin)) {\n                this.linkFieldTraversingBackward(this.line, fieldEnd, fieldEnd);\n            }\n        }\n    };\n    /**\n     * @private\n     */\n    ElementBox.prototype.linkFieldTraversingBackward = function (line, fieldEnd, previousNode) {\n        var k = line.children.length - 1;\n        if (line.children.indexOf(previousNode) > -1) {\n            k = line.children.indexOf(previousNode) - 1;\n        }\n        for (var j = k; j >= 0; j--) {\n            var childNode = line.children[j];\n            if (childNode instanceof FieldElementBox) {\n                if (childNode.fieldType === 0) {\n                    if (isNullOrUndefined(childNode.fieldEnd)) {\n                        fieldEnd.fieldBegin = childNode;\n                        if (isNullOrUndefined(childNode.fieldEnd)) {\n                            childNode.fieldEnd = fieldEnd;\n                        }\n                        if (fieldEnd.fieldSeparator && isNullOrUndefined(fieldEnd.fieldSeparator.fieldBegin)) {\n                            fieldEnd.fieldSeparator.fieldBegin = childNode;\n                            if (isNullOrUndefined(childNode.fieldSeparator)) {\n                                childNode.fieldSeparator = fieldEnd.fieldSeparator;\n                            }\n                        }\n                    }\n                    return !isNullOrUndefined(fieldEnd.fieldBegin);\n                }\n                else if (childNode.fieldType === 2 && isNullOrUndefined(childNode.fieldEnd)) {\n                    fieldEnd.fieldSeparator = childNode;\n                    childNode.fieldEnd = fieldEnd;\n                    if (!isNullOrUndefined(childNode.fieldBegin)) {\n                        fieldEnd.fieldBegin = childNode.fieldBegin;\n                    }\n                }\n            }\n        }\n        if (line.previousLine) {\n            this.linkFieldTraversingBackward(line.previousLine, fieldEnd, this);\n        }\n        else if (line.paragraph.previousRenderedWidget instanceof ParagraphWidget) {\n            var prevParagraph = line.paragraph.previousRenderedWidget;\n            // tslint:disable-next-line:max-line-length\n            this.linkFieldTraversingBackward(prevParagraph.childWidgets[prevParagraph.childWidgets.length - 1], fieldEnd, this);\n        }\n        return true;\n    };\n    /**\n     * @private\n     */\n    ElementBox.prototype.linkFieldTraversingForward = function (line, fieldBegin, previousNode) {\n        var i = 0;\n        if (line.children.indexOf(previousNode) > -1) {\n            i = line.children.indexOf(previousNode) + 1;\n        }\n        for (var j = i; j < line.children.length; j++) {\n            var node = line.children[j];\n            if (node instanceof FieldElementBox) {\n                if (node.fieldType === 1) {\n                    if (isNullOrUndefined(node.fieldBegin)) {\n                        fieldBegin.fieldEnd = node;\n                    }\n                    if (fieldBegin.fieldEnd && isNullOrUndefined(fieldBegin.fieldEnd.fieldBegin)) {\n                        fieldBegin.fieldEnd.fieldBegin = fieldBegin;\n                    }\n                    return true;\n                }\n                else if (isNullOrUndefined(fieldBegin.fieldSeparator)) {\n                    if (node.fieldType === 2 && isNullOrUndefined(node.fieldBegin)) {\n                        fieldBegin.fieldSeparator = node;\n                        if (!isNullOrUndefined(node.fieldEnd)) {\n                            fieldBegin.fieldEnd = node.fieldEnd;\n                            return true;\n                        }\n                    }\n                    else {\n                        return false;\n                    }\n                }\n            }\n        }\n        if (line.nextLine) {\n            this.linkFieldTraversingForward(line.nextLine, fieldBegin, this);\n        }\n        else if (line.paragraph.nextRenderedWidget instanceof ParagraphWidget) {\n            this.linkFieldTraversingForward(line.paragraph.nextRenderedWidget.childWidgets[0], fieldBegin, this);\n        }\n        return true;\n    };\n    /**\n     * @private\n     */\n    ElementBox.prototype.linkFieldTraversingBackwardSeparator = function (line, fieldSeparator, previousNode) {\n        var index = line.children.length - 1;\n        if (line.children.indexOf(previousNode) > -1) {\n            index = line.children.indexOf(previousNode) - 1;\n        }\n        for (var i = index; i >= 0; i--) {\n            var childElement = line.children[i];\n            if (childElement instanceof FieldElementBox) {\n                if (childElement instanceof FieldElementBox && childElement.fieldType === 0) {\n                    if (isNullOrUndefined(childElement.fieldSeparator)) {\n                        fieldSeparator.fieldBegin = childElement;\n                    }\n                    return !isNullOrUndefined(fieldSeparator.fieldBegin);\n                }\n            }\n        }\n        if (line.previousLine) {\n            this.linkFieldTraversingBackwardSeparator(line.previousLine, fieldSeparator, this);\n        }\n        else if (line.paragraph.nextRenderedWidget instanceof ParagraphWidget) {\n            // tslint:disable-next-line:max-line-length\n            line = line.paragraph.previousRenderedWidget.childWidgets[line.paragraph.previousRenderedWidget.childWidgets.length - 1];\n            this.linkFieldTraversingBackwardSeparator(line, fieldSeparator, this);\n        }\n        else {\n            return true;\n        }\n        return true;\n    };\n    Object.defineProperty(ElementBox.prototype, \"length\", {\n        /**\n         * @private\n         */\n        get: function () {\n            return this.getLength();\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(ElementBox.prototype, \"indexInOwner\", {\n        /**\n         * @private\n         */\n        get: function () {\n            return this.line instanceof LineWidget && this.line.children ? this.line.children.indexOf(this) : -1;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(ElementBox.prototype, \"previousElement\", {\n        /**\n         * @private\n         */\n        get: function () {\n            var index = this.indexInOwner;\n            if (index > 0 && index < this.line.children.length) {\n                return this.line.children[index - 1];\n            }\n            return undefined;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(ElementBox.prototype, \"nextElement\", {\n        /**\n         * @private\n         */\n        get: function () {\n            var index = this.indexInOwner;\n            if (index > -1 && index < this.line.children.length - 1) {\n                return this.line.children[index + 1];\n            }\n            return undefined;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(ElementBox.prototype, \"nextNode\", {\n        /**\n         * @private\n         */\n        get: function () {\n            var index = this.line.children.indexOf(this);\n            var lineIndex = this.line.paragraph.childWidgets.indexOf(this.line);\n            if (index < this.line.children.length - 1) {\n                return this.line.children[index + 1];\n            }\n            else if (lineIndex < this.line.paragraph.childWidgets.length - 1) {\n                return this.line.paragraph.childWidgets[lineIndex + 1].children[0];\n            }\n            return undefined;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(ElementBox.prototype, \"previousNode\", {\n        /**\n         * @private\n         */\n        get: function () {\n            var index = this.line.children.indexOf(this);\n            var lineIndex = this.line.paragraph.childWidgets.indexOf(this.line);\n            if (index > 0) {\n                return this.line.children[index - 1];\n            }\n            else if (lineIndex > 0) {\n                var lineWidget = this.line.paragraph.childWidgets[lineIndex - 1];\n                return lineWidget.children[lineWidget.children.length - 1];\n            }\n            return undefined;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(ElementBox.prototype, \"paragraph\", {\n        /**\n         * @private\n         */\n        get: function () {\n            if (this.line) {\n                return this.line.paragraph;\n            }\n            return undefined;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    /**\n     * @private\n     */\n    ElementBox.prototype.destroy = function () {\n        if (!isNullOrUndefined(this.line) && this.line.children && this.line.children.indexOf(this) > -1) {\n            var index = this.line.children.indexOf(this);\n            this.line.children.splice(index, 1);\n        }\n        this.line = undefined;\n        if (this.characterFormat) {\n            this.characterFormat.destroy();\n        }\n        this.characterFormat = undefined;\n        if (this.margin) {\n            this.margin.destroy();\n        }\n        this.margin = undefined;\n        this.x = undefined;\n        this.y = undefined;\n        this.width = undefined;\n        this.height = undefined;\n    };\n    /**\n     * @private\n     */\n    ElementBox.objectCharacter = String.fromCharCode(65532);\n    return ElementBox;\n}());\nexport { ElementBox };\n/**\n * @private\n */\nvar FieldElementBox = /** @class */ (function (_super) {\n    __extends(FieldElementBox, _super);\n    function FieldElementBox(type) {\n        var _this = _super.call(this) || this;\n        /**\n         * @private\n         */\n        _this.fieldType = 0;\n        /**\n         * @private\n         */\n        _this.hasFieldEnd = false;\n        _this.fieldBeginInternal = undefined;\n        _this.fieldSeparatorInternal = undefined;\n        _this.fieldEndInternal = undefined;\n        _this.fieldType = type;\n        return _this;\n    }\n    Object.defineProperty(FieldElementBox.prototype, \"fieldBegin\", {\n        get: function () {\n            return this.fieldBeginInternal;\n        },\n        set: function (field) {\n            this.fieldBeginInternal = field;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(FieldElementBox.prototype, \"fieldSeparator\", {\n        get: function () {\n            return this.fieldSeparatorInternal;\n        },\n        set: function (field) {\n            this.fieldSeparatorInternal = field;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(FieldElementBox.prototype, \"fieldEnd\", {\n        get: function () {\n            return this.fieldEndInternal;\n        },\n        set: function (field) {\n            this.fieldEndInternal = field;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    /**\n     * @private\n     */\n    FieldElementBox.prototype.getLength = function () {\n        return 1;\n    };\n    /**\n     * @private\n     */\n    FieldElementBox.prototype.clone = function () {\n        var field = new FieldElementBox(this.fieldType);\n        field.characterFormat.copyFormat(this.characterFormat);\n        if (this.margin) {\n            field.margin = this.margin.clone();\n        }\n        field.width = this.width;\n        field.height = this.height;\n        return field;\n    };\n    /**\n     * @private\n     */\n    FieldElementBox.prototype.destroy = function () {\n        this.fieldType = undefined;\n        this.hasFieldEnd = undefined;\n        this.fieldBeginInternal = undefined;\n        this.fieldEndInternal = undefined;\n        this.fieldSeparatorInternal = undefined;\n        _super.prototype.destroy.call(this);\n    };\n    return FieldElementBox;\n}(ElementBox));\nexport { FieldElementBox };\n/**\n * @private\n */\nvar TextElementBox = /** @class */ (function (_super) {\n    __extends(TextElementBox, _super);\n    function TextElementBox() {\n        var _this = _super.call(this) || this;\n        /**\n         * @private\n         */\n        _this.baselineOffset = 0;\n        /**\n         * @private\n         */\n        _this.text = '';\n        return _this;\n    }\n    /**\n     * @private\n     */\n    TextElementBox.prototype.getLength = function () {\n        return this.text ? this.text.length : 0;\n    };\n    /**\n     * @private\n     */\n    TextElementBox.prototype.clone = function () {\n        var span = new TextElementBox();\n        span.characterFormat.copyFormat(this.characterFormat);\n        span.text = this.text;\n        if (this.margin) {\n            span.margin = this.margin.clone();\n        }\n        span.width = this.width;\n        span.height = this.height;\n        return span;\n    };\n    /**\n     * @private\n     */\n    TextElementBox.prototype.destroy = function () {\n        this.text = undefined;\n        _super.prototype.destroy.call(this);\n    };\n    return TextElementBox;\n}(ElementBox));\nexport { TextElementBox };\n/**\n * @private\n */\nvar FieldTextElementBox = /** @class */ (function (_super) {\n    __extends(FieldTextElementBox, _super);\n    function FieldTextElementBox() {\n        var _this = _super.call(this) || this;\n        _this.fieldText = '';\n        return _this;\n    }\n    Object.defineProperty(FieldTextElementBox.prototype, \"text\", {\n        get: function () {\n            return this.fieldText;\n        },\n        set: function (value) {\n            this.fieldText = value;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    /**\n     * @private\n     */\n    FieldTextElementBox.prototype.clone = function () {\n        var span = new FieldTextElementBox();\n        span.characterFormat.copyFormat(this.characterFormat);\n        span.fieldBegin = this.fieldBegin;\n        span.text = this.text;\n        if (this.margin) {\n            span.margin = this.margin.clone();\n        }\n        span.width = this.width;\n        span.height = this.height;\n        return span;\n    };\n    return FieldTextElementBox;\n}(TextElementBox));\nexport { FieldTextElementBox };\n/**\n * @private\n */\nvar TabElementBox = /** @class */ (function (_super) {\n    __extends(TabElementBox, _super);\n    function TabElementBox() {\n        var _this = _super.call(this) || this;\n        /**\n         * @private\n         */\n        _this.tabText = '';\n        /**\n         * @private\n         */\n        _this.tabLeader = 'None';\n        return _this;\n    }\n    /**\n     * @private\n     */\n    TabElementBox.prototype.destroy = function () {\n        this.tabText = undefined;\n        this.tabLeader = undefined;\n    };\n    /**\n     * @private\n     */\n    TabElementBox.prototype.clone = function () {\n        var span = new TabElementBox();\n        span.characterFormat.copyFormat(this.characterFormat);\n        span.tabText = this.tabText;\n        span.tabLeader = this.tabLeader;\n        span.text = this.text;\n        if (this.margin) {\n            span.margin = this.margin.clone();\n        }\n        span.width = this.width;\n        span.height = this.height;\n        return span;\n    };\n    return TabElementBox;\n}(TextElementBox));\nexport { TabElementBox };\n/**\n * @private\n */\nvar BookmarkElementBox = /** @class */ (function (_super) {\n    __extends(BookmarkElementBox, _super);\n    function BookmarkElementBox(type) {\n        var _this = _super.call(this) || this;\n        _this.bookmarkTypeIn = 0;\n        _this.refereneceIn = undefined;\n        _this.nameIn = '';\n        _this.bookmarkTypeIn = type;\n        return _this;\n    }\n    Object.defineProperty(BookmarkElementBox.prototype, \"bookmarkType\", {\n        /**\n         * @private\n         */\n        get: function () {\n            return this.bookmarkTypeIn;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(BookmarkElementBox.prototype, \"name\", {\n        /**\n         * @private\n         */\n        get: function () {\n            return this.nameIn;\n        },\n        /**\n         * @private\n         */\n        set: function (name) {\n            this.nameIn = name;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(BookmarkElementBox.prototype, \"reference\", {\n        /**\n         * @private\n         */\n        get: function () {\n            return this.refereneceIn;\n        },\n        /**\n         * @private\n         */\n        set: function (reference) {\n            this.refereneceIn = reference;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    /**\n     * @private\n     */\n    BookmarkElementBox.prototype.getLength = function () {\n        return 1;\n    };\n    /**\n     * @private\n     */\n    BookmarkElementBox.prototype.destroy = function () {\n        this.name = undefined;\n        this.reference = undefined;\n        this.bookmarkTypeIn = undefined;\n    };\n    /**\n     * Clones the bookmark element box.\n     * @param element - book mark element\n     */\n    /**\n     * @private\n     */\n    BookmarkElementBox.prototype.clone = function () {\n        var span = new BookmarkElementBox(this.bookmarkType);\n        span.name = this.name;\n        span.reference = this.reference;\n        if (this.margin) {\n            span.margin = this.margin.clone();\n        }\n        span.width = this.width;\n        span.height = this.height;\n        return span;\n    };\n    return BookmarkElementBox;\n}(ElementBox));\nexport { BookmarkElementBox };\n/**\n * @private\n */\nvar ImageElementBox = /** @class */ (function (_super) {\n    __extends(ImageElementBox, _super);\n    function ImageElementBox(isInlineImage) {\n        var _this = _super.call(this) || this;\n        _this.imageStr = '';\n        _this.imgElement = undefined;\n        _this.isInlineImageIn = true;\n        /**\n         * @private\n         */\n        _this.isMetaFile = false;\n        _this.isInlineImageIn = isInlineImage;\n        return _this;\n    }\n    Object.defineProperty(ImageElementBox.prototype, \"isInlineImage\", {\n        /**\n         * @private\n         */\n        get: function () {\n            return this.isInlineImageIn;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(ImageElementBox.prototype, \"element\", {\n        /**\n         * @private\n         */\n        get: function () {\n            if (isNullOrUndefined(this.imgElement)) {\n                this.imgElement = document.createElement('img');\n            }\n            return this.imgElement;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(ImageElementBox.prototype, \"length\", {\n        /**\n         * @private\n         */\n        get: function () {\n            return 1;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(ImageElementBox.prototype, \"imageString\", {\n        /**\n         * @private\n         */\n        get: function () {\n            return this.imageStr;\n        },\n        /**\n         * @private\n         */\n        set: function (value) {\n            this.imageStr = value;\n            if (!isNullOrUndefined(value)) {\n                this.element.src = this.imageStr;\n            }\n        },\n        enumerable: true,\n        configurable: true\n    });\n    /**\n     * @private\n     */\n    ImageElementBox.prototype.getLength = function () {\n        return 1;\n    };\n    /**\n     * @private\n     */\n    ImageElementBox.prototype.clone = function () {\n        var image = new ImageElementBox(this.isInlineImage);\n        image.characterFormat.copyFormat(this.characterFormat);\n        image.imageString = this.imageString;\n        image.isMetaFile = this.isMetaFile;\n        image.width = this.width;\n        image.height = this.height;\n        if (this.margin) {\n            image.margin = this.margin.clone();\n        }\n        return image;\n    };\n    /**\n     * @private\n     */\n    ImageElementBox.prototype.destroy = function () {\n        this.imgElement = undefined;\n        this.imageString = undefined;\n        this.isInlineImageIn = undefined;\n        _super.prototype.destroy.call(this);\n    };\n    return ImageElementBox;\n}(ElementBox));\nexport { ImageElementBox };\n/**\n * @private\n */\nvar ListTextElementBox = /** @class */ (function (_super) {\n    __extends(ListTextElementBox, _super);\n    function ListTextElementBox(listLevel, isListFollowCharacter) {\n        var _this = _super.call(this) || this;\n        /**\n         * @private\n         */\n        _this.baselineOffset = 0;\n        /**\n         * @private\n         */\n        _this.isFollowCharacter = false;\n        _this.listLevel = listLevel;\n        _this.isFollowCharacter = isListFollowCharacter;\n        return _this;\n    }\n    /**\n     * @private\n     */\n    ListTextElementBox.prototype.getLength = function () {\n        return this.text ? this.text.length : 0;\n    };\n    /**\n     * @private\n     */\n    ListTextElementBox.prototype.clone = function () {\n        var list = new ListTextElementBox(this.listLevel, this.isFollowCharacter);\n        list.text = this.text;\n        list.baselineOffset = this.baselineOffset;\n        if (this.margin) {\n            list.margin = this.margin.clone();\n        }\n        list.width = this.width;\n        list.height = this.height;\n        return list;\n    };\n    /**\n     * @private\n     */\n    ListTextElementBox.prototype.destroy = function () {\n        this.text = undefined;\n        _super.prototype.destroy.call(this);\n    };\n    return ListTextElementBox;\n}(ElementBox));\nexport { ListTextElementBox };\n/**\n * @private\n */\nvar Page = /** @class */ (function () {\n    /**\n     * Initialize the constructor of Page\n     */\n    function Page() {\n        /**\n         * Specifies the Bonding Rectangle\n         * @private\n         */\n        this.boundingRectangle = new Rect(96, 96, 816, 1056);\n        /**\n         * @private\n         */\n        this.repeatHeaderRowTableWidget = false;\n        /**\n         * Specifies the bodyWidgets\n         * @default []\n         * @private\n         */\n        this.bodyWidgets = [];\n        /**\n         * @private\n         */\n        this.headerWidget = undefined;\n        /**\n         * @private\n         */\n        this.footerWidget = undefined;\n        // let text: string = 'DocumentEditor';\n    }\n    Object.defineProperty(Page.prototype, \"index\", {\n        /**\n         * @private\n         */\n        get: function () {\n            if (this.viewer) {\n                return this.viewer.pages.indexOf(this);\n            }\n            return -1;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(Page.prototype, \"previousPage\", {\n        /**\n         * @private\n         */\n        get: function () {\n            var index = this.index;\n            if (index > 0) {\n                return this.viewer.pages[index - 1];\n            }\n            return undefined;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(Page.prototype, \"nextPage\", {\n        /**\n         * @private\n         */\n        get: function () {\n            var index = this.index;\n            if (index < this.viewer.pages.length - 1) {\n                return this.viewer.pages[index + 1];\n            }\n            return undefined;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(Page.prototype, \"sectionIndex\", {\n        /**\n         * @private\n         */\n        get: function () {\n            if (this.bodyWidgets.length > 0) {\n                return this.bodyWidgets[0].index;\n            }\n            return -1;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Page.prototype.destroy = function () {\n        if (this.headerWidget) {\n            if (this.viewer && this.viewer.owner.editor) {\n                this.viewer.owner.editor.removeFieldInWidget(this.headerWidget);\n            }\n            this.headerWidget.destroy();\n        }\n        this.headerWidget = undefined;\n        if (this.footerWidget) {\n            if (this.viewer && this.viewer.owner.editor) {\n                this.viewer.owner.editor.removeFieldInWidget(this.footerWidget);\n            }\n            this.footerWidget.destroy();\n        }\n        this.footerWidget = undefined;\n        this.bodyWidgets = [];\n        this.bodyWidgets = undefined;\n        if (!isNullOrUndefined(this.viewer)) {\n            if (!isNullOrUndefined(this.viewer.pages)) {\n                this.viewer.removePage(this);\n            }\n        }\n        this.viewer = undefined;\n    };\n    return Page;\n}());\nexport { Page };\n/**\n * @private\n */\nvar WTableHolder = /** @class */ (function () {\n    function WTableHolder() {\n        this.tableColumns = [];\n        /**\n         * @private\n         */\n        this.tableWidth = 0;\n    }\n    Object.defineProperty(WTableHolder.prototype, \"columns\", {\n        get: function () {\n            return this.tableColumns;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    /**\n     * @private\n     */\n    WTableHolder.prototype.resetColumns = function () {\n        for (var i = 0; i < this.tableColumns.length; i++) {\n            this.tableColumns[i].destroy();\n        }\n        this.tableColumns = [];\n    };\n    /**\n     * @private\n     */\n    WTableHolder.prototype.getPreviousSpannedCellWidth = function (previousColumnIndex, curColumnIndex) {\n        var width = 0;\n        for (var i = previousColumnIndex; i < curColumnIndex; i++) {\n            width += this.tableColumns[i].preferredWidth;\n        }\n        return width;\n    };\n    /**\n     * @private\n     */\n    WTableHolder.prototype.addColumns = function (currentColumnIndex, columnSpan, width, minWidth, offset) {\n        for (var i = this.columns.length; i < columnSpan; i++) {\n            this.columns.push(new WColumn());\n        }\n        var availableWidth = 0;\n        for (var j = currentColumnIndex; j < columnSpan; j++) {\n            availableWidth += this.columns[j].preferredWidth;\n        }\n        // If width to add is greater than preferred width, then preferred width will be increased.\n        // In case of Gridspan > 1, only last grid column width will be updated.\n        var gridSpan = columnSpan - currentColumnIndex;\n        if (!(gridSpan > 1) && availableWidth < width) {\n            this.columns[columnSpan - 1].preferredWidth += (width - availableWidth);\n        }\n        if (minWidth > this.columns[columnSpan - 1].minWidth) {\n            this.columns[columnSpan - 1].minWidth = minWidth;\n        }\n        if (offset > this.columns[columnSpan - 1].endOffset) {\n            this.columns[columnSpan - 1].endOffset = offset;\n        }\n    };\n    /**\n     * @private\n     */\n    WTableHolder.prototype.getTotalWidth = function () {\n        var width = 0;\n        for (var i = 0; i < this.columns.length; i++) {\n            var column = this.columns[i];\n            width += column.preferredWidth;\n        }\n        return width;\n    };\n    /**\n     * @private\n     */\n    WTableHolder.prototype.isFitColumns = function (containerWidth, preferredTableWidth, isAutoWidth) {\n        // Gets total preferred width.\n        var totalColumnWidth = this.getTotalWidth();\n        // If auto table width, based on total column widths, minimum value will be updated.\n        if (isAutoWidth) {\n            this.tableWidth = preferredTableWidth > totalColumnWidth ? totalColumnWidth : preferredTableWidth;\n        }\n        else {\n            this.tableWidth = preferredTableWidth;\n        }\n        // If total columns width doesn't match table width, then all grid column widths will be updated by even factor.\n        // If totalColumnWidth < TableWidth, all grid columns are enlarged. Otherwise shrinked.\n        if (totalColumnWidth !== this.tableWidth) {\n            var factor = this.tableWidth / totalColumnWidth;\n            factor = isNaN(factor) ? 1 : factor;\n            for (var i = 0; i < this.columns.length; i++) {\n                var column = this.columns[i];\n                //column.PreferredWidth = factor * column.PreferredWidth;\n                if (factor * column.preferredWidth < column.minWidth) {\n                    return false;\n                }\n            }\n            return true;\n        }\n        else {\n            return true;\n        }\n    };\n    /**\n     * @private\n     */\n    WTableHolder.prototype.fitColumns = function (containerWidth, preferredTableWidth, isAutoWidth) {\n        // Gets total preferred width.\n        var totalColumnWidth = this.getTotalWidth();\n        // If auto table width, based on total column widths, minimum value will be updated.\n        if (isAutoWidth) {\n            this.tableWidth = preferredTableWidth > totalColumnWidth ? totalColumnWidth : preferredTableWidth;\n        }\n        else {\n            this.tableWidth = preferredTableWidth;\n        }\n        // If total columns width doesn't match table width, then all grid column widths will be updated by even factor.\n        // If totalColumnWidth < TableWidth, all grid columns are enlarged. Otherwise shrinked.\n        if (totalColumnWidth !== this.tableWidth) {\n            var factor = this.tableWidth / totalColumnWidth;\n            for (var i = 0; i < this.columns.length; i++) {\n                var column = this.columns[i];\n                column.preferredWidth = factor * column.preferredWidth;\n            }\n        }\n    };\n    /**\n     * @private\n     */\n    WTableHolder.prototype.getCellWidth = function (columnIndex, columnSpan, preferredTableWidth, isAutoWidth) {\n        var width = 0;\n        for (var i = 0; i < columnSpan; i++) {\n            width += this.tableColumns[i + columnIndex].preferredWidth;\n        }\n        return width;\n    };\n    /**\n     * @private\n     */\n    WTableHolder.prototype.validateColumnWidths = function () {\n        for (var i = 0; i < this.columns.length; i++) {\n            if (i === 0) {\n                if (this.columns[i].preferredWidth !== this.columns[i].endOffset) {\n                    this.columns[i].preferredWidth = this.columns[i].endOffset;\n                }\n            }\n            else {\n                // If Previous column offset + current column preferred width is less than current column offset, \n                // Then current column preferred width is set to current column offset - previous column offset.\n                if (this.columns[i - 1].endOffset + this.columns[i].preferredWidth < this.columns[i].endOffset) {\n                    this.columns[i].preferredWidth = this.columns[i].endOffset - this.columns[i - 1].endOffset;\n                }\n            }\n        }\n    };\n    /**\n     * @private\n     */\n    WTableHolder.prototype.clone = function () {\n        var tableHolder = new WTableHolder();\n        tableHolder.tableWidth = this.tableWidth;\n        for (var i = 0; i < this.columns.length; i++) {\n            tableHolder.columns.push(this.columns[i].clone());\n        }\n        return tableHolder;\n    };\n    /**\n     * @private\n     */\n    WTableHolder.prototype.destroy = function () {\n        if (!isNullOrUndefined(this.tableColumns)) {\n            for (var i = 0; i < this.tableColumns.length; i++) {\n                var column = this.tableColumns[i];\n                column.destroy();\n            }\n        }\n        this.tableColumns = [];\n        this.tableColumns = undefined;\n        this.tableWidth = undefined;\n    };\n    return WTableHolder;\n}());\nexport { WTableHolder };\n/**\n * @private\n */\nvar WColumn = /** @class */ (function () {\n    function WColumn() {\n        /**\n         * @private\n         */\n        this.preferredWidth = 0;\n        /**\n         * @private\n         */\n        this.minWidth = 0;\n        /**\n         * @private\n         */\n        this.maxWidth = 0;\n        /**\n         * @private\n         */\n        this.endOffset = 0;\n    }\n    /**\n     * @private\n     */\n    WColumn.prototype.clone = function () {\n        var column = new WColumn();\n        column.preferredWidth = this.preferredWidth;\n        column.minWidth = this.minWidth;\n        column.maxWidth = this.maxWidth;\n        return column;\n    };\n    /**\n     * @private\n     */\n    WColumn.prototype.destroy = function () {\n        this.preferredWidth = undefined;\n        this.minWidth = undefined;\n        this.maxWidth = undefined;\n    };\n    return WColumn;\n}());\nexport { WColumn };\n","import { ContextMenu as Menu } from '@syncfusion/ej2-navigations';\nimport { isNullOrUndefined, L10n, setCulture, classList } from '@syncfusion/ej2-base';\nimport { FieldElementBox } from './viewer/page';\nvar CONTEXTMENU_COPY = '_contextmenu_copy';\nvar CONTEXTMENU_CUT = '_contextmenu_cut';\nvar CONTEXTMENU_PASTE = '_contextmenu_paste';\nvar CONTEXTMENU_UPDATE_FIELD = '_contextmenu_update_field';\nvar CONTEXTMENU_EDIT_FIELD = '_contextmenu_edit_field';\nvar CONTEXTMENU_HYPERLINK = '_contextmenu_hyperlink';\nvar CONTEXTMENU_OPEN_HYPERLINK = '_contextmenu_open_hyperlink';\nvar CONTEXTMENU_COPY_HYPERLINK = '_contextmenu_copy_hyperlink';\nvar CONTEXTMENU_REMOVE_HYPERLINK = '_contextmenu_remove_hyperlink';\nvar CONTEXTMENU_EDIT_HYPERLINK = '_contextmenu_edit_hyperlink';\nvar CONTEXTMENU_FONT_DIALOG = '_contextmenu_font_dialog';\nvar CONTEXTMENU_PARAGRAPH = '_contextmenu_paragraph_dialog';\nvar CONTEXTMENU_TABLE = '_contextmenu_table_dialog';\nvar CONTEXTMENU_INSERT_TABLE = '_contextmenu_insert_table';\nvar CONTEXTMENU_DELETE_TABLE = '_contextmenu_delete_table';\nvar CONTEXTMENU_INSERT_ABOVE = '_contextmenu_insert_above';\nvar CONTEXTMENU_INSERT_BELOW = '_contextmenu_insert_below';\nvar CONTEXTMENU_INSERT_RIGHT = '_contextmenu_insert_right';\nvar CONTEXTMENU_INSERT_LEFT = '_contextmenu_insert_left';\nvar CONTEXTMENU_COMPLETE_DELETE_TABLE = '_contextmenu_complete_table_delete';\nvar CONTEXTMENU_DELETE_ROW = '_contextmenu_delete_row';\nvar CONTEXTMENU_DELETE_COLUMN = '_contextmenu_delete_column';\nvar CONTEXTMENU_MERGE_CELL = '_contextmenu_merge_cell';\nvar CONTEXTMENU_CONTINUE_NUMBERING = '_contextmenu_continue_numbering';\nvar CONTEXTMENU_RESTART_AT = '_contextmenu_restart_at';\n/**\n * Context Menu class\n */\nvar ContextMenu = /** @class */ (function () {\n    /**\n     * @private\n     */\n    function ContextMenu(viewer) {\n        var _this = this;\n        /**\n         * @private\n         */\n        this.contextMenuInstance = undefined;\n        /**\n         * Handles on context menu key pressed.\n         * @param  {PointerEvent} event\n         * @private\n         */\n        this.onContextMenuInternal = function (event) {\n            if (_this.showHideElements(_this.viewer.selection)) {\n                _this.contextMenuInstance.open(event.y, event.x);\n                event.preventDefault();\n            }\n        };\n        this.viewer = viewer;\n        var locale = new L10n('documenteditor', this.viewer.owner.defaultLocale);\n        locale.setLocale(this.viewer.owner.locale);\n        setCulture(this.viewer.owner.locale);\n        this.initContextMenu(locale);\n    }\n    /**\n     * Gets module name.\n     */\n    ContextMenu.prototype.getModuleName = function () {\n        return 'ContextMenu';\n    };\n    /**\n     * Initialize context menu.\n     * @param localValue Localize value.\n     * @private\n     */\n    // tslint:disable:max-func-body-length\n    ContextMenu.prototype.initContextMenu = function (localValue) {\n        var _this = this;\n        var id = this.viewer.owner.element.id;\n        this.contextMenu = document.createElement('div');\n        this.contextMenu.id = this.viewer.owner.containerId + 'e-de-contextmenu';\n        document.body.appendChild(this.contextMenu);\n        var ul = document.createElement('ul');\n        ul.style.width = 'auto';\n        ul.id = this.viewer.owner.containerId + 'e-de-contextmenu-list';\n        ul.style.listStyle = 'none';\n        ul.style.margin = '0px';\n        ul.style.padding = '0px';\n        ul.style.maxHeight = 'auto';\n        ul.oncontextmenu = this.disableBrowserContextmenu;\n        this.contextMenu.appendChild(ul);\n        var menuItems = [\n            {\n                text: localValue.getConstant('Cut'),\n                iconCss: 'e-icons e-de-cut',\n                id: id + CONTEXTMENU_CUT\n            },\n            {\n                text: localValue.getConstant('Copy'),\n                iconCss: 'e-icons e-de-copy',\n                id: id + CONTEXTMENU_COPY\n            },\n            {\n                text: localValue.getConstant('Paste'),\n                iconCss: 'e-icons e-de-paste',\n                id: id + CONTEXTMENU_PASTE\n            },\n            {\n                separator: true\n            },\n            {\n                text: localValue.getConstant('Update Field'),\n                iconCss: 'e-icons e-de-update_field',\n                id: id + CONTEXTMENU_UPDATE_FIELD\n            },\n            {\n                text: localValue.getConstant('Edit Field'),\n                iconCss: 'e-icons e-de-edit_field',\n                id: id + CONTEXTMENU_EDIT_FIELD\n            },\n            {\n                text: localValue.getConstant('Continue Numbering'),\n                iconCss: 'e-icons e-de-continue-numbering',\n                id: id + CONTEXTMENU_CONTINUE_NUMBERING\n            },\n            {\n                text: localValue.getConstant('Restart At') + ' 1',\n                iconCss: 'e-icons e-de-restart-at',\n                id: id + CONTEXTMENU_RESTART_AT\n            },\n            {\n                separator: true\n            },\n            {\n                text: localValue.getConstant('Hyperlink'),\n                iconCss: 'e-icons e-de-insertlink',\n                id: id + CONTEXTMENU_HYPERLINK\n            },\n            {\n                text: localValue.getConstant('Edit Hyperlink') + '...',\n                iconCss: 'e-icons e-de-edit-hyperlink',\n                id: id + CONTEXTMENU_EDIT_HYPERLINK\n            },\n            {\n                text: localValue.getConstant('Open Hyperlink'),\n                iconCss: 'e-icons e-de-open-hyperlink',\n                id: id + CONTEXTMENU_OPEN_HYPERLINK\n            },\n            {\n                text: localValue.getConstant('Copy Hyperlink'),\n                iconCss: 'e-icons e-de-copy-hyperlink',\n                id: id + CONTEXTMENU_COPY_HYPERLINK\n            },\n            {\n                text: localValue.getConstant('Remove Hyperlink'),\n                iconCss: 'e-icons e-de-remove-hyperlink',\n                id: id + CONTEXTMENU_REMOVE_HYPERLINK\n            },\n            {\n                separator: true\n            },\n            {\n                text: localValue.getConstant('Font'),\n                iconCss: 'e-icons e-de-fonts',\n                id: id + CONTEXTMENU_FONT_DIALOG\n            },\n            {\n                text: localValue.getConstant('Paragraph'),\n                iconCss: 'e-icons e-de-paragraph',\n                id: id + CONTEXTMENU_PARAGRAPH\n            },\n            {\n                separator: true,\n            },\n            {\n                text: localValue.getConstant('Table Properties'),\n                id: id + CONTEXTMENU_TABLE,\n                iconCss: 'e-icons e-de-table'\n            },\n            {\n                text: localValue.getConstant('Merge Cells'),\n                id: id + CONTEXTMENU_MERGE_CELL,\n                iconCss: 'e-icons e-de-icon-table-merge-cells'\n            },\n            {\n                text: localValue.getConstant('Insert'),\n                id: id + CONTEXTMENU_INSERT_TABLE,\n                iconCss: 'e-icons',\n                items: [\n                    {\n                        text: localValue.getConstant('Insert Above'),\n                        id: id + CONTEXTMENU_INSERT_ABOVE,\n                        iconCss: 'e-icons e-de-insertabove'\n                    },\n                    {\n                        text: localValue.getConstant('Insert Below'),\n                        id: id + CONTEXTMENU_INSERT_BELOW,\n                        iconCss: 'e-icons e-de-insertbelow'\n                    },\n                    {\n                        text: localValue.getConstant('Insert Left'),\n                        id: id + CONTEXTMENU_INSERT_LEFT,\n                        iconCss: 'e-icons e-de-insertleft'\n                    },\n                    {\n                        text: localValue.getConstant('Insert Right'),\n                        id: id + CONTEXTMENU_INSERT_RIGHT,\n                        iconCss: 'e-icons e-de-insertright'\n                    }\n                ]\n            },\n            {\n                text: localValue.getConstant('Delete'),\n                id: id + CONTEXTMENU_DELETE_TABLE,\n                iconCss: 'e-icons',\n                items: [\n                    {\n                        text: localValue.getConstant('Delete Table'),\n                        id: id + CONTEXTMENU_COMPLETE_DELETE_TABLE,\n                        iconCss: 'e-icons e-de-delete-table'\n                    },\n                    {\n                        text: localValue.getConstant('Delete Row'),\n                        id: id + CONTEXTMENU_DELETE_ROW,\n                        iconCss: 'e-icons e-de-deleterow'\n                    },\n                    {\n                        text: localValue.getConstant('Delete Column'),\n                        id: id + CONTEXTMENU_DELETE_COLUMN,\n                        iconCss: 'e-icons e-de-deletecolumn'\n                    }\n                ]\n            },\n        ];\n        var menuOptions = {\n            target: '#' + this.viewer.owner.containerId + 'e-de-contextmenu',\n            items: menuItems,\n            select: function (args) {\n                var item = args.element.id;\n                _this.handleContextMenuItem(item);\n            },\n        };\n        this.contextMenuInstance = new Menu(menuOptions, '#' + this.viewer.owner.containerId + 'e-de-contextmenu-list');\n        this.contextMenuInstance.beforeOpen = function () {\n            if (_this.viewer && _this.viewer.selection) {\n                classList(_this.viewer.selection.caret, [], ['e-de-cursor-animation']);\n                _this.viewer.selection.showCaret();\n            }\n        };\n        this.contextMenuInstance.onClose = function () {\n            if (_this.viewer && _this.viewer.selection) {\n                classList(_this.viewer.selection.caret, ['e-de-cursor-animation'], []);\n                _this.viewer.updateFocus();\n            }\n        };\n    };\n    /**\n     * Disable browser context menu.\n     */\n    ContextMenu.prototype.disableBrowserContextmenu = function () {\n        return false;\n    };\n    /**\n     * Handles context menu items.\n     * @param  {string} item Specifies which item is selected.\n     * @private\n     */\n    ContextMenu.prototype.handleContextMenuItem = function (item) {\n        var id = this.viewer.owner.element.id;\n        switch (item) {\n            case id + CONTEXTMENU_COPY:\n                this.viewer.selection.copy();\n                break;\n            case id + CONTEXTMENU_CUT:\n                this.viewer.owner.editor.cut();\n                break;\n            case id + CONTEXTMENU_PASTE:\n                if (!this.viewer.owner.isReadOnlyMode) {\n                    this.viewer.owner.editorModule.pasteInternal(undefined);\n                }\n                break;\n            case id + CONTEXTMENU_UPDATE_FIELD:\n                if (!this.viewer.owner.isReadOnlyMode) {\n                    this.viewer.owner.editorModule.updateToc();\n                }\n                break;\n            case id + CONTEXTMENU_EDIT_FIELD:\n                if (!this.viewer.owner.isReadOnlyMode) {\n                    this.viewer.owner.tableOfContentsDialogModule.show();\n                }\n                break;\n            case id + CONTEXTMENU_FONT_DIALOG:\n                if (this.viewer.owner.fontDialogModule) {\n                    this.viewer.owner.fontDialogModule.showFontDialog();\n                }\n                break;\n            case id + CONTEXTMENU_OPEN_HYPERLINK:\n                this.viewer.selection.navigateHyperlink();\n                break;\n            case id + CONTEXTMENU_COPY_HYPERLINK:\n                this.viewer.selection.copyHyperlink();\n                break;\n            case id + CONTEXTMENU_EDIT_HYPERLINK:\n            case id + CONTEXTMENU_HYPERLINK:\n                if (this.viewer.owner.hyperlinkDialogModule) {\n                    this.viewer.owner.hyperlinkDialogModule.show();\n                }\n                break;\n            case id + CONTEXTMENU_REMOVE_HYPERLINK:\n                this.viewer.owner.editor.removeHyperlink();\n                break;\n            case id + CONTEXTMENU_PARAGRAPH:\n                if (this.viewer.owner.paragraphDialogModule) {\n                    this.viewer.owner.paragraphDialogModule.show();\n                }\n                break;\n            case id + CONTEXTMENU_TABLE:\n                this.viewer.owner.tablePropertiesDialogModule.show();\n                break;\n            case id + CONTEXTMENU_MERGE_CELL:\n                this.viewer.owner.editor.mergeCells();\n                break;\n            case id + CONTEXTMENU_INSERT_ABOVE:\n                this.viewer.owner.editor.insertRow(true);\n                break;\n            case id + CONTEXTMENU_INSERT_BELOW:\n                this.viewer.owner.editor.insertRow(false);\n                break;\n            case id + CONTEXTMENU_INSERT_LEFT:\n                this.viewer.owner.editor.insertColumn(true);\n                break;\n            case id + CONTEXTMENU_INSERT_RIGHT:\n                this.viewer.owner.editor.insertColumn(false);\n                break;\n            case id + CONTEXTMENU_COMPLETE_DELETE_TABLE:\n                this.viewer.owner.editor.deleteTable();\n                break;\n            case id + CONTEXTMENU_DELETE_ROW:\n                this.viewer.owner.editor.deleteRow();\n                break;\n            case id + CONTEXTMENU_DELETE_COLUMN:\n                this.viewer.owner.editor.deleteColumn();\n                break;\n            case id + CONTEXTMENU_CONTINUE_NUMBERING:\n                this.viewer.owner.editorModule.applyContinueNumbering(this.viewer.selection);\n                break;\n            case id + CONTEXTMENU_RESTART_AT:\n                this.viewer.owner.editorModule.applyRestartNumbering(this.viewer.selection);\n                break;\n        }\n    };\n    ContextMenu.prototype.showHideElements = function (selection) {\n        var owner = this.viewer.owner;\n        var id = owner.element.id;\n        var copy = document.getElementById(id + CONTEXTMENU_COPY);\n        var cut = document.getElementById(id + CONTEXTMENU_CUT);\n        var paste = document.getElementById(id + CONTEXTMENU_PASTE);\n        var updateField = document.getElementById(id + CONTEXTMENU_UPDATE_FIELD);\n        var editField = document.getElementById(id + CONTEXTMENU_EDIT_FIELD);\n        var font = document.getElementById(id + CONTEXTMENU_FONT_DIALOG);\n        var paragraph = document.getElementById(id + CONTEXTMENU_PARAGRAPH);\n        var tableProperties = document.getElementById(id + CONTEXTMENU_TABLE);\n        var insertTable = document.getElementById(id + CONTEXTMENU_INSERT_TABLE);\n        var deleteTable = document.getElementById(id + CONTEXTMENU_DELETE_TABLE);\n        var mergeCells = document.getElementById(id + CONTEXTMENU_MERGE_CELL);\n        var hyperlink = document.getElementById(id + CONTEXTMENU_HYPERLINK);\n        var openHyperlink = document.getElementById(id + CONTEXTMENU_OPEN_HYPERLINK);\n        var editHyperlink = document.getElementById(id + CONTEXTMENU_EDIT_HYPERLINK);\n        var copyHyperlink = document.getElementById(id + CONTEXTMENU_COPY_HYPERLINK);\n        var removeHyperlink = document.getElementById(id + CONTEXTMENU_REMOVE_HYPERLINK);\n        var continueNumbering = document.getElementById(id + CONTEXTMENU_CONTINUE_NUMBERING);\n        var restartAt = document.getElementById(id + CONTEXTMENU_RESTART_AT);\n        cut.style.display = 'none';\n        paste.style.display = 'none';\n        paste.nextSibling.style.display = 'none';\n        hyperlink.style.display = 'none';\n        openHyperlink.style.display = 'none';\n        copyHyperlink.style.display = 'none';\n        editHyperlink.style.display = 'none';\n        removeHyperlink.style.display = 'none';\n        removeHyperlink.nextSibling.style.display = 'none';\n        mergeCells.style.display = 'none';\n        font.style.display = 'none';\n        paragraph.style.display = 'none';\n        paragraph.nextSibling.style.display = 'none';\n        insertTable.style.display = 'none';\n        deleteTable.style.display = 'none';\n        tableProperties.style.display = 'none';\n        updateField.style.display = 'none';\n        editField.style.display = 'none';\n        continueNumbering.style.display = 'none';\n        restartAt.style.display = 'none';\n        restartAt.nextSibling.style.display = 'none';\n        if (isNullOrUndefined(selection)) {\n            return false;\n        }\n        selection.hideToolTip();\n        if (selection.isEmpty) {\n            cut.classList.add('e-disabled');\n            copy.classList.add('e-disabled');\n        }\n        else {\n            cut.classList.remove('e-disabled');\n            copy.classList.remove('e-disabled');\n        }\n        if (owner.isReadOnlyMode) {\n            return true;\n        }\n        cut.style.display = 'block';\n        paste.style.display = 'block';\n        paste.nextSibling.style.display = 'block';\n        insertTable.classList.add('e-blankicon');\n        deleteTable.classList.add('e-blankicon');\n        updateField.classList.add('e-blankicon');\n        editField.classList.add('e-blankicon');\n        if (owner.enableLocalPaste && !isNullOrUndefined(owner.editor.copiedData)) {\n            paste.classList.remove('e-disabled');\n        }\n        else {\n            paste.classList.add('e-disabled');\n        }\n        if (selection.contextType === 'TableOfContents') {\n            updateField.style.display = 'block';\n            editField.style.display = 'block';\n            restartAt.nextSibling.style.display = 'block';\n        }\n        else {\n            var start = selection.start;\n            var end = selection.end;\n            if (selection.contextType === 'List'\n                && owner.editorModule.getListLevel(start.paragraph).listLevelPattern !== 'Bullet') {\n                continueNumbering.style.display = 'block';\n                restartAt.style.display = 'block';\n                restartAt.nextSibling.style.display = 'block';\n            }\n            var isCellOrRowSelected = start.paragraph.isInsideTable && (!end.paragraph.isInsideTable\n                || start.paragraph.associatedCell !== end.paragraph.associatedCell\n                || selection.isCellSelected(start.paragraph.associatedCell, start, end));\n            if (isCellOrRowSelected) {\n                hyperlink.classList.add('e-disabled');\n            }\n            else {\n                if (hyperlink.classList.contains('e-disabled')) {\n                    hyperlink.classList.remove('e-disabled');\n                }\n            }\n            var field = selection.getHyperlinkField();\n            if (field instanceof FieldElementBox && !selection.isImageField()) {\n                openHyperlink.style.display = 'block';\n                copyHyperlink.style.display = 'block';\n                if (owner.hyperlinkDialogModule) {\n                    editHyperlink.style.display = 'block';\n                }\n                removeHyperlink.style.display = 'block';\n                removeHyperlink.nextSibling.style.display = 'block';\n            }\n            else {\n                if (owner.hyperlinkDialogModule) {\n                    hyperlink.style.display = 'block';\n                }\n            }\n        }\n        if (this.viewer.owner.selection.start.paragraph.isInsideTable\n            && this.viewer.owner.selection.end.paragraph.isInsideTable) {\n            paragraph.nextSibling.style.display = 'block';\n            if (owner.tablePropertiesDialogModule) {\n                tableProperties.style.display = 'block';\n            }\n            insertTable.style.display = 'block';\n            deleteTable.style.display = 'block';\n            if (this.viewer.owner.editor.canMergeCells()) {\n                mergeCells.style.display = 'block';\n            }\n        }\n        else {\n            if (this.viewer.owner.fontDialogModule) {\n                font.style.display = 'block';\n                font.previousSibling.style.display = 'block';\n            }\n            if (this.viewer.owner.paragraphDialogModule) {\n                paragraph.style.display = 'block';\n            }\n        }\n        if (selection.contextType === 'Image') {\n            font.style.display = 'none';\n            paragraph.style.display = 'none';\n            removeHyperlink.nextSibling.style.display = 'none';\n        }\n        return true;\n    };\n    /**\n     * Disposes the internal objects which are maintained.\n     * @private\n     */\n    ContextMenu.prototype.destroy = function () {\n        if (this.contextMenuInstance) {\n            this.contextMenuInstance.destroy();\n        }\n        if (this.contextMenu) {\n            if (this.contextMenu.parentElement) {\n                this.contextMenu.parentElement.removeChild(this.contextMenu);\n            }\n            this.contextMenu.innerHTML = '';\n        }\n        this.contextMenu = undefined;\n        this.contextMenuInstance = undefined;\n    };\n    return ContextMenu;\n}());\nexport { ContextMenu };\n","import { isNullOrUndefined } from '@syncfusion/ej2-base';\n/**\n * @private\n */\nvar WAbstractList = /** @class */ (function () {\n    function WAbstractList() {\n        this.abstractListIdIn = -1;\n        this.levels = [];\n    }\n    Object.defineProperty(WAbstractList.prototype, \"abstractListId\", {\n        get: function () {\n            return this.abstractListIdIn;\n        },\n        set: function (abstractListId) {\n            this.abstractListIdIn = abstractListId;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    WAbstractList.prototype.destroy = function () {\n        if (!isNullOrUndefined(this.levels)) {\n            for (var i = 0; i < this.levels.length; i++) {\n                var listLevel = this.levels[i];\n                listLevel.destroy();\n                this.levels.splice(this.levels.indexOf(listLevel), 1);\n                i--;\n            }\n            this.levels = [];\n        }\n        this.levels = undefined;\n    };\n    return WAbstractList;\n}());\nexport { WAbstractList };\n","import { Dictionary } from '../../base/dictionary';\nimport { WUniqueFormat } from '../../base/unique-format';\nimport { WUniqueFormats } from '../../base/unique-formats';\nimport { WCharacterFormat } from '../format/character-format';\nimport { WParagraphFormat } from '../format/paragraph-format';\nimport { WAbstractList } from './abstract-list';\nimport { isNullOrUndefined } from '@syncfusion/ej2-base';\n/**\n * @private\n */\nvar WListLevel = /** @class */ (function () {\n    function WListLevel(node) {\n        this.uniqueListLevel = undefined;\n        this.paragraphFormat = undefined;\n        this.characterFormat = undefined;\n        if (node instanceof WAbstractList) {\n            this.ownerBase = node;\n        }\n        else {\n            this.ownerBase = node;\n        }\n        this.characterFormat = new WCharacterFormat(undefined);\n        this.paragraphFormat = new WParagraphFormat(undefined);\n    }\n    Object.defineProperty(WListLevel.prototype, \"listLevelPattern\", {\n        get: function () {\n            return this.getPropertyValue('listLevelPattern');\n        },\n        set: function (listLevelPattern) {\n            this.setPropertyValue('listLevelPattern', listLevelPattern);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(WListLevel.prototype, \"followCharacter\", {\n        get: function () {\n            return this.getPropertyValue('followCharacter');\n        },\n        set: function (followCharacter) {\n            this.setPropertyValue('followCharacter', followCharacter);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(WListLevel.prototype, \"startAt\", {\n        get: function () {\n            return this.getPropertyValue('startAt');\n        },\n        set: function (startAt) {\n            this.setPropertyValue('startAt', startAt);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(WListLevel.prototype, \"numberFormat\", {\n        get: function () {\n            return this.getPropertyValue('numberFormat');\n        },\n        set: function (numberFormat) {\n            this.setPropertyValue('numberFormat', numberFormat);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(WListLevel.prototype, \"restartLevel\", {\n        get: function () {\n            return this.getPropertyValue('restartLevel');\n        },\n        set: function (restartLevel) {\n            this.setPropertyValue('restartLevel', restartLevel);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    WListLevel.prototype.getPropertyValue = function (property) {\n        var propertyType = WUniqueFormat.getPropertyType(WListLevel.uniqueFormatType, property);\n        if (!isNullOrUndefined(this.uniqueListLevel) && this.uniqueListLevel.propertiesHash.containsKey(propertyType)) {\n            return this.uniqueListLevel.propertiesHash.get(propertyType);\n        }\n        return WListLevel.getPropertyDefaultValue(property);\n    };\n    WListLevel.prototype.setPropertyValue = function (property, value) {\n        if (isNullOrUndefined(value) || value === '') {\n            value = WListLevel.getPropertyDefaultValue(property);\n        }\n        if (isNullOrUndefined(this.uniqueListLevel)) {\n            this.initializeUniqueWListLevel(property, value);\n        }\n        else {\n            var propertyType = WUniqueFormat.getPropertyType(this.uniqueListLevel.uniqueFormatType, property);\n            if (this.uniqueListLevel.propertiesHash.containsKey(propertyType) &&\n                // tslint:disable-next-line:max-line-length\n                this.uniqueListLevel.propertiesHash.get(propertyType) === value) {\n                return;\n            }\n            // tslint:disable-next-line:max-line-length\n            this.uniqueListLevel = WListLevel.uniqueListLevels.updateUniqueFormat(this.uniqueListLevel, property, value);\n        }\n    };\n    WListLevel.prototype.initializeUniqueWListLevel = function (property, propValue) {\n        var uniqueListLevelTemp = new Dictionary();\n        this.addUniqueWListLevel('listLevelPattern', property, propValue, uniqueListLevelTemp);\n        this.addUniqueWListLevel('startAt', property, propValue, uniqueListLevelTemp);\n        this.addUniqueWListLevel('followCharacter', property, propValue, uniqueListLevelTemp);\n        this.addUniqueWListLevel('numberFormat', property, propValue, uniqueListLevelTemp);\n        this.addUniqueWListLevel('restartLevel', property, propValue, uniqueListLevelTemp);\n        // tslint:disable-next-line:max-line-length    \n        this.uniqueListLevel = WListLevel.uniqueListLevels.addUniqueFormat(uniqueListLevelTemp, WListLevel.uniqueFormatType);\n    };\n    // tslint:disable-next-line:max-line-length\n    WListLevel.prototype.addUniqueWListLevel = function (property, modifiedProperty, propValue, uniqueCharFormatTemp) {\n        var propertyType;\n        propertyType = WUniqueFormat.getPropertyType(WListLevel.uniqueFormatType, property);\n        if (property === modifiedProperty) {\n            uniqueCharFormatTemp.add(propertyType, propValue);\n        }\n        else {\n            uniqueCharFormatTemp.add(propertyType, WListLevel.getPropertyDefaultValue(property));\n        }\n    };\n    WListLevel.getPropertyDefaultValue = function (property) {\n        var value = undefined;\n        switch (property) {\n            case 'listLevelPattern':\n                value = 'Arabic';\n                break;\n            case 'startAt':\n                value = 0;\n                break;\n            case 'followCharacter':\n                value = 'Tab';\n                break;\n            case 'numberFormat':\n                value = '';\n                break;\n            case 'restartLevel':\n                value = 0;\n                break;\n        }\n        return value;\n    };\n    WListLevel.prototype.destroy = function () {\n        if (!isNullOrUndefined(this.characterFormat)) {\n            this.characterFormat.destroy();\n        }\n        if (!isNullOrUndefined(this.paragraphFormat)) {\n            this.paragraphFormat.destroy();\n        }\n        if (!isNullOrUndefined(this.uniqueListLevel)) {\n            WListLevel.uniqueListLevels.remove(this.uniqueListLevel);\n        }\n        this.uniqueListLevel = undefined;\n        this.characterFormat = undefined;\n        this.paragraphFormat = undefined;\n    };\n    WListLevel.clear = function () {\n        this.uniqueListLevels.clear();\n    };\n    WListLevel.dotBullet = '\\uf0b7';\n    WListLevel.squareBullet = '\\uf0a7'; //Symbol font \\u25aa.\n    WListLevel.arrowBullet = '\\u27a4';\n    WListLevel.circleBullet = '\\uf06f' + '\\u0020';\n    WListLevel.uniqueListLevels = new WUniqueFormats();\n    WListLevel.uniqueFormatType = 9;\n    return WListLevel;\n}());\nexport { WListLevel };\n","import { Dictionary } from '../../base/dictionary';\nimport { WListLevel } from '../list/list-level';\nimport { WCharacterFormat, WParagraphFormat } from '../format/index';\nimport { WBorder } from '../format/index';\nimport { PageLayoutViewer } from './viewer';\nimport { LineWidget, Rect, Widget, Margin, ParagraphWidget, BodyWidget, TextElementBox, ElementBox, ListTextElementBox, TableCellWidget, TableRowWidget, TableWidget, FieldElementBox, BlockWidget, HeaderFooterWidget, BlockContainer, BookmarkElementBox, FieldTextElementBox, TabElementBox } from './page';\nimport { HelperMethods } from '../editor/editor-helper';\nimport { isNullOrUndefined } from '@syncfusion/ej2-base';\n/**\n * @private\n */\nvar Layout = /** @class */ (function () {\n    /**\n     * viewer definition\n     */\n    function Layout(viewer) {\n        /**\n         * @private\n         */\n        this.allowLayout = true;\n        /**\n         * @private\n         */\n        this.isInitialLoad = true;\n        this.fieldBegin = undefined;\n        this.maxTextHeight = 0;\n        this.maxBaseline = 0;\n        this.maxTextBaseline = 0;\n        this.isFieldCode = false;\n        this.viewer = viewer;\n    }\n    /**\n     * @private\n     */\n    Layout.prototype.layout = function () {\n        // Todo: Need to handle complete document layout(relayout).\n        var page = this.viewer.pages[0];\n        var body = page.bodyWidgets[0];\n    };\n    /**\n     * Releases un-managed and - optionally - managed resources.\n     */\n    Layout.prototype.destroy = function () {\n        this.viewer = undefined;\n        this.value = undefined;\n        this.allowLayout = undefined;\n        this.isInitialLoad = undefined;\n        this.fieldBegin = undefined;\n        this.maxTextHeight = undefined;\n        this.maxBaseline = undefined;\n        this.maxTextBaseline = undefined;\n        this.isFieldCode = undefined;\n    };\n    /**\n     * Layouts the items\n     * @private\n     */\n    Layout.prototype.layoutItems = function (sections) {\n        var page;\n        for (var i = 0; i < sections.length; i++) {\n            var section = sections[i];\n            page = this.viewer.createNewPage(section);\n            this.addBodyWidget(this.viewer.clientActiveArea, section);\n            if (this.viewer.pages.length > 1) {\n                var pageIndex = 0;\n                for (var i_1 = 0; i_1 < this.viewer.pages.length; i_1++) {\n                    var prevPage = this.viewer.pages[i_1];\n                    var prevSectionIndex = prevPage.sectionIndex;\n                    var index = section.index;\n                    if (prevSectionIndex > index || prevPage === page) {\n                        break;\n                    }\n                    pageIndex++;\n                }\n                if (pageIndex < this.viewer.pages.length - 1) {\n                    this.viewer.insertPage(pageIndex, page);\n                }\n            }\n            this.layoutSection(section, 0, this.viewer);\n        }\n        this.updateFieldElements();\n        this.viewer.updateScrollBars();\n        this.isInitialLoad = false;\n    };\n    /**\n     * Layouts the items\n     * @param section\n     * @param viewer\n     * @private\n     */\n    Layout.prototype.layoutSection = function (section, index, viewer, ownerWidget) {\n        var block = section.firstChild;\n        var nextBlock;\n        do {\n            this.viewer.updateClientAreaForBlock(block, true);\n            nextBlock = this.layoutBlock(block, index);\n            index = 0;\n            this.viewer.updateClientAreaForBlock(block, false);\n            block = nextBlock;\n        } while (block);\n    };\n    /**\n     * Layouts the header footer items\n     * @param section\n     * @param viewer\n     * @private\n     */\n    Layout.prototype.layoutHeaderFooter = function (section, viewer, page) {\n        //Header layout\n        var headerFooterWidget = viewer.getCurrentPageHeaderFooter(section, true);\n        if (headerFooterWidget) {\n            var header = headerFooterWidget.clone();\n            header.page = page;\n            viewer.updateHFClientArea(section.sectionFormat, true);\n            page.headerWidget = this.layoutHeaderFooterItems(viewer, header);\n            this.updateHeaderFooterToParent(header);\n        }\n        //Footer Layout\n        headerFooterWidget = viewer.getCurrentPageHeaderFooter(section, false);\n        if (headerFooterWidget) {\n            var footer = headerFooterWidget.clone();\n            footer.page = page;\n            viewer.updateHFClientArea(section.sectionFormat, false);\n            page.footerWidget = this.layoutHeaderFooterItems(viewer, footer);\n            this.updateHeaderFooterToParent(footer);\n        }\n    };\n    /**\n     * @private\n     */\n    Layout.prototype.updateHeaderFooterToParent = function (node) {\n        var sectionIndex = node.page.sectionIndex;\n        var typeIndex = this.viewer.getHeaderFooter(node.headerFooterType);\n        var clone = node.clone();\n        this.viewer.headersFooters[sectionIndex][typeIndex] = clone;\n        for (var j = 0; j < clone.childWidgets.length; j++) {\n            var child = clone.childWidgets[j];\n            if (child instanceof TableWidget) {\n                this.clearTableWidget(child, false, true);\n            }\n        }\n        return clone;\n    };\n    Layout.prototype.linkFieldInHeaderFooter = function (widget) {\n        var firstChild = widget.firstChild;\n        do {\n            if (firstChild instanceof ParagraphWidget) {\n                this.linkFieldInParagraph(firstChild);\n            }\n            else {\n                this.linkFieldInTable(firstChild);\n            }\n            //tslint:disable:no-conditional-assignment\n        } while (firstChild = firstChild.nextWidget);\n    };\n    /**\n     * @private\n     */\n    Layout.prototype.linkFieldInParagraph = function (widget) {\n        for (var j = 0; j < widget.childWidgets.length; j++) {\n            var line = widget.childWidgets[j];\n            for (var i = 0; i < line.children.length; i++) {\n                var element = line.children[i];\n                if (element instanceof FieldElementBox && element.fieldType !== 0) {\n                    element.linkFieldCharacter(this.viewer);\n                }\n            }\n        }\n    };\n    /**\n     * @private\n     */\n    Layout.prototype.linkFieldInTable = function (widget) {\n        for (var i = 0; i < widget.childWidgets.length; i++) {\n            var row = widget.childWidgets[i];\n            for (var j = 0; j < row.childWidgets.length; j++) {\n                var cell = row.childWidgets[j];\n                for (var k = 0; k < cell.childWidgets.length; k++) {\n                    var block = cell.childWidgets[k];\n                    if (block instanceof ParagraphWidget) {\n                        this.linkFieldInParagraph(block);\n                    }\n                    else {\n                        this.linkFieldInTable(block);\n                    }\n                }\n            }\n        }\n    };\n    /**\n     * Layouts the header footer items.\n     * @param viewer\n     * @param hfModule\n     * @private\n     */\n    Layout.prototype.layoutHeaderFooterItems = function (viewer, widget) {\n        this.viewer.updateClientAreaLocation(widget, viewer.clientActiveArea);\n        if (widget.childWidgets.length === 0) {\n            var pargaraph = new ParagraphWidget();\n            var line = new LineWidget(pargaraph);\n            pargaraph.childWidgets.push(line);\n            widget.childWidgets.push(pargaraph);\n            pargaraph.containerWidget = widget;\n        }\n        this.linkFieldInHeaderFooter(widget);\n        for (var i = 0; i < widget.childWidgets.length; i++) {\n            var block = widget.childWidgets[i];\n            viewer.updateClientAreaForBlock(block, true);\n            this.layoutBlock(block, 0);\n            viewer.updateClientAreaForBlock(block, false);\n        }\n        var type = widget.headerFooterType;\n        if (type === 'OddFooter' || type === 'EvenFooter' || type === 'FirstPageFooter') {\n            this.shiftChildLocation(viewer.clientArea.y - viewer.clientActiveArea.y, widget);\n        }\n        return widget;\n    };\n    /**\n     * Shifts the child location\n     * @param shiftTop\n     * @param bodyWidget\n     */\n    Layout.prototype.shiftChildLocation = function (shiftTop, bodyWidget) {\n        var widgetTop = bodyWidget.y + shiftTop;\n        var footerMaxHeight = bodyWidget.page.boundingRectangle.height - (bodyWidget.page.boundingRectangle.height / 100) * 40;\n        widgetTop = Math.max(widgetTop, footerMaxHeight);\n        shiftTop = widgetTop - bodyWidget.y;\n        bodyWidget.y = widgetTop;\n        for (var i = 0; i < bodyWidget.childWidgets.length; i++) {\n            var childWidget = bodyWidget.childWidgets[i];\n            if (childWidget instanceof ParagraphWidget) {\n                childWidget.x = childWidget.x;\n                childWidget.y = childWidget.y + shiftTop;\n            }\n            else {\n                this.shiftChildLocationForTableWidget(childWidget, shiftTop);\n            }\n        }\n    };\n    /**\n     * Shifts the child location for table widget.\n     * @param tableWidget\n     * @param shiftTop\n     */\n    Layout.prototype.shiftChildLocationForTableWidget = function (tableWidget, shiftTop) {\n        tableWidget.y = tableWidget.y + shiftTop;\n        for (var i = 0; i < tableWidget.childWidgets.length; i++) {\n            var childWidget = tableWidget.childWidgets[i];\n            if (childWidget instanceof TableRowWidget) {\n                this.shiftChildLocationForTableRowWidget(childWidget, shiftTop);\n            }\n        }\n    };\n    /**\n     * Shifts the child location for table row widget.\n     * @param rowWidget\n     * @param shiftTop\n     */\n    Layout.prototype.shiftChildLocationForTableRowWidget = function (rowWidget, shiftTop) {\n        rowWidget.y = rowWidget.y + shiftTop;\n        for (var i = 0; i < rowWidget.childWidgets.length; i++) {\n            this.shiftChildLocationForTableCellWidget(rowWidget.childWidgets[i], shiftTop);\n        }\n    };\n    /**\n     * Shifts the child location for table cell widget.\n     * @param cellWidget\n     * @param shiftTop\n     */\n    Layout.prototype.shiftChildLocationForTableCellWidget = function (cellWidget, shiftTop) {\n        cellWidget.y = cellWidget.y + shiftTop;\n        for (var i = 0; i < cellWidget.childWidgets.length; i++) {\n            if (cellWidget.childWidgets[i] instanceof ParagraphWidget) {\n                cellWidget.childWidgets[i].x = cellWidget.childWidgets[i].x;\n                cellWidget.childWidgets[i].y = cellWidget.childWidgets[i].y + shiftTop;\n            }\n            else {\n                this.shiftChildLocationForTableWidget(cellWidget.childWidgets[i], shiftTop);\n            }\n        }\n    };\n    /**\n     * Layouts specified block.\n     * @param block\n     * @private\n     */\n    Layout.prototype.layoutBlock = function (block, index, moveToLine) {\n        var nextBlock;\n        if (block instanceof ParagraphWidget) {\n            nextBlock = this.layoutParagraph(block, index);\n        }\n        else {\n            nextBlock = this.layoutTable(block, index);\n        }\n        return nextBlock.nextRenderedWidget;\n    };\n    /**\n     * Adds paragraph widget.\n     * @param area\n     */\n    Layout.prototype.addParagraphWidget = function (area, paragraphWidget) {\n        var ownerParaWidget = undefined;\n        if (paragraphWidget.isEmpty() && !isNullOrUndefined(paragraphWidget.paragraphFormat) &&\n            (paragraphWidget.paragraphFormat.textAlignment === 'Center' || paragraphWidget.paragraphFormat.textAlignment === 'Right') &&\n            paragraphWidget.paragraphFormat.listFormat.listId === -1) {\n            var top_1 = 0;\n            var bottom = 0;\n            var width = this.viewer.textHelper.getParagraphMarkWidth(paragraphWidget.characterFormat);\n            var left = area.x;\n            if (paragraphWidget.paragraphFormat.textAlignment === 'Center') {\n                left += (area.width - width) / 2;\n            }\n            else {\n                left += area.width - width;\n            }\n            paragraphWidget.width = width;\n            paragraphWidget.x = left;\n            paragraphWidget.y = area.y;\n        }\n        else {\n            paragraphWidget.width = area.width;\n            paragraphWidget.x = area.x;\n            paragraphWidget.y = area.y;\n        }\n        return paragraphWidget;\n    };\n    /**\n     * Adds line widget.\n     * @param paragraph\n     */\n    Layout.prototype.addLineWidget = function (paragraphWidget) {\n        var line = undefined;\n        line = new LineWidget(paragraphWidget);\n        line.width = paragraphWidget.width;\n        paragraphWidget.childWidgets.push(line);\n        line.paragraph = paragraphWidget;\n        return line;\n    };\n    /**\n     * Layouts specified paragraph.\n     * @private\n     * @param paragraph\n     */\n    Layout.prototype.layoutParagraph = function (paragraph, lineIndex) {\n        this.addParagraphWidget(this.viewer.clientActiveArea, paragraph);\n        this.layoutListItems(paragraph);\n        if (paragraph.isEmpty()) {\n            this.layoutEmptyLineWidget(paragraph, true);\n        }\n        else {\n            var line = lineIndex < paragraph.childWidgets.length ?\n                paragraph.childWidgets[lineIndex] : undefined;\n            while (line instanceof LineWidget) {\n                if (line.isFirstLine() && isNullOrUndefined(this.fieldBegin)) {\n                    if (!isNullOrUndefined(paragraph.paragraphFormat)) {\n                        // tslint:disable-next-line:max-line-length\n                        var firstLineIndent = -HelperMethods.convertPointToPixel(paragraph.paragraphFormat.firstLineIndent);\n                        this.viewer.updateClientWidth(firstLineIndent);\n                    }\n                }\n                line = this.layoutLine(line, 0);\n                paragraph = line.paragraph;\n                line = line.nextLine;\n            }\n        }\n        this.updateWidgetToPage(this.viewer, paragraph);\n        return paragraph;\n    };\n    Layout.prototype.clearLineMeasures = function () {\n        this.maxBaseline = 0;\n        this.maxTextBaseline = 0;\n        this.maxTextHeight = 0;\n    };\n    Layout.prototype.moveElementFromNextLine = function (line) {\n        var nextLine = line.nextLine;\n        while (nextLine instanceof LineWidget) {\n            if (nextLine.children.length > 0) {\n                var element = nextLine.children.splice(0, 1)[0];\n                line.children.push(element);\n                element.line = line;\n                break;\n            }\n            else {\n                if (nextLine.paragraph.childWidgets.length === 1) {\n                    nextLine.paragraph.destroy();\n                }\n                else {\n                    nextLine.destroy();\n                }\n                nextLine = line.nextLine;\n            }\n        }\n    };\n    Layout.prototype.layoutLine = function (line, count) {\n        var paragraph = line.paragraph;\n        if (line.children.length === 0) {\n            this.moveElementFromNextLine(line);\n        }\n        var element = line.children[count];\n        this.clearLineMeasures();\n        while (element instanceof ElementBox) {\n            this.layoutElement(element, paragraph);\n            line = element.line;\n            element = element.nextElement;\n        }\n        return line;\n    };\n    // tslint:disable:max-func-body-length\n    Layout.prototype.layoutElement = function (element, paragraph) {\n        var line = element.line;\n        var text = '';\n        var index = element.indexInOwner;\n        if (element instanceof FieldElementBox) {\n            if (element.fieldType === 0 && this.viewer.fields.indexOf(element) === -1) {\n                this.viewer.fields.push(element);\n            }\n            this.layoutFieldCharacters(element);\n            if (element.line.isLastLine() && isNullOrUndefined(element.nextNode) && !this.isFieldCode) {\n                if (isNullOrUndefined(element.fieldSeparator)) {\n                    this.layoutEmptyLineWidget(paragraph, false, element.line);\n                }\n                this.moveToNextLine(line);\n            }\n            else if (isNullOrUndefined(element.nextElement) && this.viewer.clientActiveArea.width > 0 && !element.line.isLastLine()) {\n                this.moveElementFromNextLine(line);\n            }\n            else if (isNullOrUndefined(element.nextElement) && this.viewer.clientActiveArea.width === 0) {\n                this.moveToNextLine(line);\n                if (line.paragraph.lastChild === line && !isNullOrUndefined(line.nextLine) &&\n                    this.viewer.clientActiveArea.height >= 0) {\n                    this.moveFromNextPage(line);\n                }\n            }\n            return;\n        }\n        if (element instanceof ListTextElementBox || this.isFieldCode || element instanceof BookmarkElementBox) {\n            if (isNullOrUndefined(element.nextElement) && this.viewer.clientActiveArea.width > 0 && !element.line.isLastLine()) {\n                this.moveElementFromNextLine(line);\n            }\n            if (element.line.isLastLine() && isNullOrUndefined(element.nextElement)) {\n                if (this.hasValidElement(line.paragraph)) {\n                    this.moveToNextLine(line);\n                }\n                else {\n                    this.layoutEmptyLineWidget(line.paragraph, false, line, false);\n                }\n            }\n            return;\n        }\n        var width = element.width;\n        if (element instanceof FieldTextElementBox) {\n            text = this.viewer.getFieldResult(element.fieldBegin, element.paragraph.bodyWidget.page);\n            if (text !== '') {\n                element.text = text;\n            }\n            else {\n                text = element.text;\n            }\n        }\n        else if (element instanceof TextElementBox) {\n            this.checkAndSplitTabOrLineBreakCharacter(element.text, element);\n            text = element.text;\n        }\n        // Here field code width and height update need to skipped based on the hidden property.\n        if (element instanceof TextElementBox) {\n            width = this.viewer.textHelper.getTextSize(element, element.characterFormat);\n            if (element.text === '\\t') {\n                element.width = this.getTabWidth(paragraph, this.viewer, index, line, element);\n            }\n        }\n        if (this.viewer instanceof PageLayoutViewer\n            && this.viewer.clientActiveArea.height < element.height && this.viewer.clientActiveArea.y !== this.viewer.clientArea.y) {\n            this.moveToNextPage(this.viewer, line);\n            if (element instanceof FieldTextElementBox) {\n                this.updateFieldText(element);\n            }\n            if (element.previousElement) {\n                this.cutClientWidth(element.previousElement);\n            }\n        }\n        if (width < this.viewer.clientActiveArea.width || !this.viewer.textWrap) {\n            //Fits the text in current line.\n            this.addElementToLine(paragraph, element);\n            if (isNullOrUndefined(element.nextElement) && this.viewer.clientActiveArea.width > 0 && !element.line.isLastLine()) {\n                this.moveElementFromNextLine(line);\n            }\n            else if (!element.line.isLastLine() && isNullOrUndefined(element.nextElement) && this.viewer.clientActiveArea.width === 0) {\n                this.moveToNextLine(line);\n                if (line.paragraph.lastChild === line && this.viewer.clientActiveArea.height >= 0) {\n                    this.moveFromNextPage(line);\n                }\n            }\n        }\n        else if (element instanceof TextElementBox) {\n            if (element.text === '\\t') {\n                var currentLine = element.line;\n                this.addSplittedLineWidget(currentLine, currentLine.children.indexOf(element));\n                this.moveToNextLine(currentLine);\n                // Recalculates tab width based on new client active area X position\n                element.width = this.getTabWidth(paragraph, this.viewer, index, line, element);\n                this.addElementToLine(paragraph, element);\n            }\n            else {\n                //Splits the text and arrange line by line, till end of text.\n                do {\n                    line = element.line;\n                    this.splitTextForClientArea(line, element, element.text, element.width, element.characterFormat);\n                    this.checkLineWidgetWithClientArea(line, element);\n                    if (element instanceof FieldTextElementBox) {\n                        this.updateFieldText(element);\n                    }\n                } while (element.line !== line && this.cutClientWidth(element));\n            }\n        }\n        else {\n            do {\n                line = element.line;\n                this.splitElementForClientArea(paragraph, element);\n                this.checkLineWidgetWithClientArea(line, element);\n                if (element instanceof FieldTextElementBox) {\n                    this.updateFieldText(element);\n                }\n            } while (element.line !== line && this.cutClientWidth(element));\n        }\n        if (text === '\\v' || text === '\\f') {\n            var elementIndex = line.children.indexOf(element);\n            if (elementIndex > -1) {\n                this.addSplittedLineWidget(line, elementIndex);\n            }\n        }\n        if (element.line.isLastLine() && isNullOrUndefined(element.nextElement) || text === '\\v' || text === '\\f') {\n            this.moveToNextLine(element.line);\n            if (text === '\\v' && isNullOrUndefined(element.nextNode)) {\n                this.layoutEmptyLineWidget(paragraph, true, line, true);\n            }\n            else if (text === '\\f') {\n                if (isNullOrUndefined(element.nextNode)) {\n                    this.moveToNextPage(this.viewer, element.line, true);\n                }\n                else {\n                    this.moveToNextPage(this.viewer, element.line.nextLine, false);\n                }\n            }\n        }\n    };\n    /**\n     * Return true if paragraph has valid inline\n     * @private\n     */\n    Layout.prototype.hasValidElement = function (paragraph) {\n        var line = paragraph.firstChild;\n        if (line && !isNullOrUndefined(this.viewer.selection)) {\n            var elementBox = line.children[0];\n            while (elementBox) {\n                if (elementBox instanceof FieldElementBox) {\n                    elementBox = this.viewer.selection.getNextValidElementForField(elementBox);\n                    if (!elementBox.line.paragraph.equals(paragraph)) {\n                        return false;\n                    }\n                }\n                if (elementBox instanceof TextElementBox) {\n                    return true;\n                }\n                elementBox = elementBox.nextNode;\n            }\n        }\n        return false;\n    };\n    Layout.prototype.updateFieldText = function (element) {\n        // tslint:disable-next-line:max-line-length\n        var text = this.viewer.getFieldResult(element.fieldBegin, element.paragraph.bodyWidget.page);\n        if (text !== '') {\n            element.text = text;\n            this.viewer.textHelper.getTextSize(element, element.characterFormat);\n        }\n    };\n    Layout.prototype.checkLineWidgetWithClientArea = function (line, element) {\n        if (line !== element.line || element.line === line && isNullOrUndefined(element.nextElement)\n            && !element.line.isLastLine()) {\n            this.moveToNextLine(line);\n        }\n        if (element.line !== line && this.viewer instanceof PageLayoutViewer\n            && this.viewer.clientActiveArea.height < element.height &&\n            this.viewer.clientActiveArea.y !== this.viewer.clientArea.y) {\n            this.moveToNextPage(this.viewer, element.line);\n        }\n        else if (element.line === line && isNullOrUndefined(element.nextElement)\n            && line.paragraph.lastChild === line && !line.isLastLine() && this.viewer.clientActiveArea.height >= 0) {\n            this.moveFromNextPage(line);\n        }\n    };\n    Layout.prototype.checkAndSplitTabOrLineBreakCharacter = function (text, element) {\n        var char = ['\\t', '\\v', '\\f'];\n        var index = HelperMethods.indexOfAny(text, char);\n        if (index > -1) {\n            var character = text[index];\n            if ((character === '\\t' && text !== '\\t') || (character === '\\v' && text !== '\\v')\n                || (character === '\\f' && text !== '\\f')) {\n                this.splitByLineBreakOrTab(this.viewer, element, index, character);\n            }\n        }\n    };\n    /**\n     * @private\n     */\n    Layout.prototype.moveFromNextPage = function (line) {\n        var nextLine = line.nextLine;\n        if (nextLine && line.paragraph.childWidgets.indexOf(nextLine) === -1) {\n            nextLine.paragraph.childWidgets.splice(nextLine.indexInOwner, 1);\n            line.paragraph.childWidgets.push(nextLine);\n            nextLine.paragraph = line.paragraph;\n        }\n    };\n    Layout.prototype.cutClientWidth = function (currentElement) {\n        this.clearLineMeasures();\n        var line = currentElement.line;\n        var width = 0;\n        for (var i = 0; i < line.children.length; i++) {\n            var element = line.children[i];\n            width += element.width;\n            if (currentElement === element) {\n                break;\n            }\n        }\n        var splitCurrentWidget = this.viewer.clientActiveArea.width - width < 0;\n        if (!splitCurrentWidget) {\n            this.viewer.cutFromLeft(this.viewer.clientActiveArea.x + width);\n            if (currentElement.line.paragraph.paragraphFormat.textAlignment === 'Justify' &&\n                currentElement instanceof TextElementBox) {\n                this.splitTextElementWordByWord(currentElement);\n            }\n            if (isNullOrUndefined(currentElement.nextElement) && this.viewer.clientActiveArea.width > 0\n                && !currentElement.line.isLastLine()) {\n                this.moveElementFromNextLine(line);\n            }\n        }\n        else if (currentElement.previousElement) {\n            this.cutClientWidth(currentElement.previousElement);\n        }\n        return splitCurrentWidget;\n    };\n    Layout.prototype.layoutFieldCharacters = function (element) {\n        if (element.fieldType === 0) {\n            if (!this.isFieldCode && (!isNullOrUndefined(element.fieldEnd) || element.hasFieldEnd)) {\n                this.viewer.fieldStacks.push(element);\n                this.isFieldCode = true;\n                element.hasFieldEnd = true;\n            }\n        }\n        else if (this.viewer.fieldStacks.length > 0) {\n            if (element.fieldType === 2) {\n                var field = this.viewer.fieldStacks[this.viewer.fieldStacks.length - 1];\n                if (field.fieldSeparator === element && (!isNullOrUndefined(field.fieldEnd) || field.hasFieldEnd)) {\n                    this.isFieldCode = false;\n                }\n            }\n            else {\n                var field = this.viewer.fieldStacks[this.viewer.fieldStacks.length - 1];\n                if (element === field.fieldEnd) {\n                    this.viewer.fieldStacks.pop();\n                    this.isFieldCode = false;\n                }\n            }\n        }\n    };\n    /**\n     * Layouts empty line widget.\n     */\n    // tslint:disable-next-line:max-line-length\n    Layout.prototype.layoutEmptyLineWidget = function (paragraph, isEmptyLine, line, isShiftEnter) {\n        isShiftEnter = isNullOrUndefined(isShiftEnter) ? false : isShiftEnter;\n        //Calculate line height and descent based on formatting defined in paragraph.\n        var paragraphMarkSize = this.viewer.textHelper.getParagraphMarkSize(paragraph.characterFormat);\n        var maxHeight = paragraphMarkSize.Height;\n        var beforeSpacing = this.getBeforeSpacing(paragraph);\n        var lineWidget;\n        if (paragraph.childWidgets.length > 0 && !isShiftEnter) {\n            lineWidget = paragraph.childWidgets[0];\n        }\n        else {\n            lineWidget = isEmptyLine ? this.addLineWidget(paragraph) : line;\n        }\n        //isNullOrUndefined(this.viewer.currentHeaderFooter) && \n        if (this.viewer instanceof PageLayoutViewer\n            && this.viewer.clientActiveArea.height < beforeSpacing + maxHeight\n            && this.viewer.clientActiveArea.y !== this.viewer.clientArea.y) {\n            this.moveToNextPage(this.viewer, lineWidget);\n        }\n        //Gets line spacing.\n        var lineSpacing = this.getLineSpacing(paragraph, maxHeight);\n        var maxDescent = maxHeight - paragraphMarkSize.BaselineOffset;\n        //Calculate the bottom position of current line - max height + line spacing.\n        if (!isNaN(this.maxTextHeight)\n            && maxHeight < this.maxTextHeight) {\n            maxHeight = this.maxTextHeight;\n            maxDescent = maxHeight - this.maxTextBaseline;\n        }\n        var topMargin = 0;\n        var bottomMargin = 0;\n        var leftMargin = 0;\n        var height = maxHeight;\n        var lineSpacingType = paragraph.paragraphFormat.lineSpacingType;\n        if (lineSpacingType === 'Multiple') {\n            if (lineSpacing > maxHeight) {\n                bottomMargin += lineSpacing - maxHeight;\n            }\n            else {\n                topMargin += lineSpacing - maxHeight;\n            }\n        }\n        else if (lineSpacingType === 'Exactly') {\n            topMargin += lineSpacing - (topMargin + height + bottomMargin);\n        }\n        else if (lineSpacing > topMargin + height + bottomMargin) {\n            topMargin += lineSpacing - (topMargin + height + bottomMargin);\n        }\n        topMargin += beforeSpacing;\n        bottomMargin += HelperMethods.convertPointToPixel(paragraph.paragraphFormat.afterSpacing);\n        for (var i = 0; i < lineWidget.children.length; i++) {\n            var element = lineWidget.children[i];\n            if (element instanceof ListTextElementBox) {\n                var textAlignment = paragraph.paragraphFormat.textAlignment;\n                if (textAlignment === 'Right') {\n                    leftMargin = this.viewer.clientArea.width - element.width;\n                }\n                else if (textAlignment === 'Center') {\n                    leftMargin = (this.viewer.clientArea.width - element.width) / 2;\n                }\n                element.margin = new Margin(leftMargin, topMargin, 0, bottomMargin);\n                element.line = lineWidget;\n                lineWidget.height = topMargin + height + bottomMargin;\n            }\n        }\n        lineWidget.height = topMargin + height + bottomMargin;\n        this.viewer.cutFromTop(this.viewer.clientActiveArea.y + lineWidget.height);\n        //Clears the previous line elements from collection.     \n    };\n    /**\n     * @private\n     */\n    Layout.prototype.layoutListItems = function (paragraph) {\n        if (!this.isFieldCode) {\n            if (!isNullOrUndefined(paragraph.paragraphFormat)\n                && !isNullOrUndefined(paragraph.paragraphFormat.listFormat)\n                && !isNullOrUndefined(this.viewer.getListById(paragraph.paragraphFormat.listFormat.listId)) &&\n                paragraph.paragraphFormat.listFormat.listLevelNumber >= 0\n                && paragraph.paragraphFormat.listFormat.listLevelNumber < 9) {\n                this.clearListElementBox(paragraph);\n                this.layoutList(paragraph, this.viewer);\n            }\n            else if (paragraph.paragraphFormat.listFormat && paragraph.paragraphFormat.listFormat.listId === -1) {\n                this.clearListElementBox(paragraph);\n            }\n        }\n    };\n    /**\n     * Layouts list.\n     * @param viewer\n     */\n    Layout.prototype.layoutList = function (paragraph, viewer) {\n        var list = viewer.getListById(paragraph.paragraphFormat.listFormat.listId);\n        viewer.updateClientWidth(-HelperMethods.convertPointToPixel(paragraph.paragraphFormat.firstLineIndent));\n        var currentListLevel = this.getListLevel(list, paragraph.paragraphFormat.listFormat.listLevelNumber);\n        // if (isNullOrUndefined(currentListLevel)) {\n        //     return;\n        // }\n        var lineWidget = paragraph.childWidgets[0];\n        if (isNullOrUndefined(lineWidget)) {\n            lineWidget = new LineWidget(paragraph);\n            paragraph.childWidgets.push(lineWidget);\n        }\n        var element = new ListTextElementBox(currentListLevel, false);\n        element.line = lineWidget;\n        if (currentListLevel.listLevelPattern === 'Bullet') {\n            element.text = currentListLevel.numberFormat;\n        }\n        else {\n            element.text = this.getListNumber(paragraph.paragraphFormat.listFormat);\n        }\n        viewer.textHelper.updateTextSize(element, paragraph);\n        var moveToNextPage;\n        if (this.viewer instanceof PageLayoutViewer\n            && this.viewer.clientActiveArea.height < element.height && this.viewer.clientActiveArea.y !== this.viewer.clientArea.y) {\n            moveToNextPage = true;\n        }\n        viewer.cutFromLeft(viewer.clientActiveArea.x + element.width);\n        //Adds the text element to the line\n        lineWidget.children.splice(0, 0, element);\n        if (currentListLevel.followCharacter !== 'None') {\n            element = new ListTextElementBox(currentListLevel, true);\n            if (currentListLevel.followCharacter === 'Tab') {\n                element.text = '\\t';\n                var index = lineWidget.children.indexOf(element);\n                element.width = this.getTabWidth(paragraph, viewer, index, lineWidget, undefined);\n            }\n            else {\n                element.text = ' ';\n                viewer.textHelper.updateTextSize(element, paragraph);\n            }\n            viewer.cutFromLeft(viewer.clientActiveArea.x + element.width);\n            //Adds the tabSpace to the line\n            lineWidget.children.splice(1, 0, element);\n            element.line = lineWidget;\n        }\n        if (moveToNextPage) {\n            this.moveToNextPage(this.viewer, lineWidget);\n            this.cutClientWidth(element);\n            return;\n        }\n        if (currentListLevel.followCharacter !== 'None') {\n            viewer.updateClientWidth(HelperMethods.convertPointToPixel(paragraph.paragraphFormat.firstLineIndent));\n        }\n    };\n    /**\n     * Adds body widget.\n     * @param area\n     * @param section\n     * @private\n     */\n    Layout.prototype.addBodyWidget = function (area, widget) {\n        var bodyWidget;\n        if (widget) {\n            bodyWidget = widget;\n        }\n        else {\n            bodyWidget = new BodyWidget();\n        }\n        bodyWidget.width = area.width;\n        bodyWidget.x = area.x;\n        bodyWidget.y = area.y;\n        // this.addSectionInDictionary(this.viewer, section, bodyWidget);\n        return bodyWidget;\n    };\n    /**\n     * Adds list level.\n     * @param abstractList\n     */\n    Layout.prototype.addListLevels = function (abstractList) {\n        for (var i = abstractList.levels.length; i < 9; i++) {\n            var listLevel = new WListLevel(abstractList);\n            var val = i % 3;\n            if (abstractList.levels[0].listLevelPattern === 'Bullet') {\n                listLevel.listLevelPattern = 'Bullet';\n                listLevel.numberFormat = val === 0 ? '\\uf0b7' : val === 1 ? '\\uf0a7' : '\\uf0d8';\n                listLevel.characterFormat.fontFamily = listLevel.numberFormat === '\\uf0a7' || '\\uf0d8' ? 'Wingdings' : 'Symbol';\n            }\n            else {\n                listLevel.listLevelPattern = this.getListLevelPattern(val);\n                listLevel.numberFormat = '%' + (i + 1).toString() + '.';\n                listLevel.startAt = 1;\n                listLevel.restartLevel = i;\n            }\n            listLevel.paragraphFormat = new WParagraphFormat(undefined);\n            listLevel.paragraphFormat.leftIndent = 48 * (i + 1);\n            listLevel.paragraphFormat.firstLineIndent = -24;\n            abstractList.levels.push(listLevel);\n        }\n    };\n    Layout.prototype.addSplittedLineWidget = function (lineWidget, elementIndex, splittedElementBox) {\n        var paragraph = lineWidget.paragraph;\n        var movedElementBox = [];\n        var lineIndex = paragraph.childWidgets.indexOf(lineWidget);\n        if (!isNullOrUndefined(splittedElementBox)) {\n            movedElementBox.push(splittedElementBox);\n        }\n        var newLineWidget = undefined;\n        //Move Next element box to temp collection\n        for (var i = elementIndex + 1; i < lineWidget.children.length; i++) {\n            movedElementBox.push(lineWidget.children[i]);\n        }\n        if (movedElementBox.length > 0) {\n            if (lineIndex === paragraph.childWidgets.length - 1) {\n                newLineWidget = new LineWidget(paragraph);\n            }\n            else {\n                newLineWidget = paragraph.childWidgets[lineIndex + 1];\n            }\n            for (var j = 0; j < movedElementBox.length; j++) {\n                movedElementBox[j].line = newLineWidget;\n            }\n            lineWidget.children.splice(elementIndex + 1, lineWidget.children.length - 1);\n            newLineWidget.children = movedElementBox.concat(newLineWidget.children);\n            if (paragraph.childWidgets.indexOf(newLineWidget) === -1) {\n                paragraph.childWidgets.splice(lineIndex + 1, 0, newLineWidget);\n            }\n        }\n    };\n    /**\n     * Adds element to line.\n     * @param element\n     */\n    Layout.prototype.addElementToLine = function (paragraph, element) {\n        this.viewer.cutFromLeft(this.viewer.clientActiveArea.x + element.width);\n        if (paragraph.paragraphFormat.textAlignment === 'Justify' && element instanceof TextElementBox) {\n            this.splitTextElementWordByWord(element);\n        }\n    };\n    /**\n     * Splits element for client area.\n     * @param element\n     */\n    Layout.prototype.splitElementForClientArea = function (paragraph, element) {\n        var line = element.line;\n        if (element.line.children.length > 0) {\n            var previousElement = element.previousElement;\n            var index = element.indexInOwner;\n            // if line widget contain only single image element box need to skip this from splitting\n            // else move element to next line\n            if (element.line.children.length > 1) {\n                if (previousElement && this.viewer.clientActiveArea.x !== this.viewer.clientArea.x) {\n                    index -= 1;\n                }\n            }\n            this.addSplittedLineWidget(element.line, index);\n        }\n    };\n    /**\n     * Splits by word\n     * @param elementBox\n     * @param text\n     * @param width\n     * @param characterFormat\n     */\n    // tslint:disable-next-line:max-line-length\n    Layout.prototype.splitByWord = function (lineWidget, paragraph, elementBox, text, width, characterFormat) {\n        var index = this.getSplitIndexByWord(this.viewer.clientActiveArea.width, text, width, characterFormat);\n        if (index > 0 && index < elementBox.length) {\n            var indexOf = lineWidget.children.indexOf(elementBox);\n            var lineIndex = paragraph.childWidgets.indexOf(lineWidget);\n            var splittedElementBox = new TextElementBox();\n            text = text.substring(index);\n            splittedElementBox.text = text;\n            if (text[0] === ' ') {\n                var prevLength = text.length;\n                text = HelperMethods.trimStart(text); //To trim white space at starting of the text.\n                index += prevLength - text.length;\n            }\n            splittedElementBox.characterFormat.copyFormat(elementBox.characterFormat);\n            splittedElementBox.width = this.viewer.textHelper.getWidth(splittedElementBox.text, characterFormat);\n            elementBox.text = elementBox.text.substr(0, index);\n            elementBox.width -= splittedElementBox.width;\n            splittedElementBox.height = elementBox.height;\n            splittedElementBox.baselineOffset = elementBox.baselineOffset;\n            this.addSplittedLineWidget(lineWidget, indexOf, splittedElementBox);\n            this.addElementToLine(paragraph, elementBox);\n            if (elementBox.width === 0) {\n                lineWidget.children.splice(indexOf, 1);\n            }\n        }\n    };\n    /**\n     * Splits by character.\n     * @param textElement\n     * @param text\n     * @param width\n     * @param characterFormat\n     */\n    // tslint:disable-next-line:max-line-length\n    Layout.prototype.splitByCharacter = function (lineWidget, textElement, text, width, characterFormat) {\n        var paragraph = lineWidget.paragraph;\n        // tslint:disable-next-line:max-line-length\n        var index = this.getTextSplitIndexByCharacter(this.viewer.clientArea.width, this.viewer.clientActiveArea.width, text, width, characterFormat);\n        var splitWidth = 0;\n        if (index < textElement.length) {\n            splitWidth = this.viewer.textHelper.measureTextExcludingSpaceAtEnd(text.substring(0, index), characterFormat);\n            text = text.substring(index);\n        }\n        if (splitWidth > this.viewer.clientActiveArea.width && textElement.indexInOwner > 0) {\n            this.addSplittedLineWidget(lineWidget, textElement.indexInOwner - 1);\n            return;\n        }\n        var indexOf = lineWidget.children.indexOf(textElement);\n        if (index < textElement.length) {\n            var lineIndex = paragraph.childWidgets.indexOf(lineWidget);\n            var splittedElement = new TextElementBox();\n            splittedElement.text = text;\n            textElement.text = textElement.text.substr(0, index);\n            splittedElement.characterFormat.copyFormat(textElement.characterFormat);\n            splittedElement.width = this.viewer.textHelper.getWidth(splittedElement.text, characterFormat);\n            textElement.width -= splittedElement.width;\n            splittedElement.height = textElement.height;\n            splittedElement.baselineOffset = textElement.baselineOffset;\n            lineWidget.children.splice(textElement.indexInOwner + 1, 0, splittedElement);\n            this.addSplittedLineWidget(lineWidget, indexOf);\n            this.addElementToLine(paragraph, textElement);\n            if (textElement.width === 0) {\n                lineWidget.children.splice(indexOf, 1);\n            }\n        }\n        else {\n            //Adds the last text element on inline to line elements collection. \n            this.addSplittedLineWidget(lineWidget, indexOf);\n            this.addElementToLine(paragraph, textElement);\n        }\n    };\n    /**\n     * Splits text element word by word.\n     * @param textElement\n     */\n    Layout.prototype.splitTextElementWordByWord = function (textElement) {\n        var lineWidget = textElement.line;\n        var indexOf = lineWidget.children.indexOf(textElement);\n        var text = textElement.text;\n        var format;\n        var characterUptoWs = text.trim().indexOf(' ');\n        if (characterUptoWs >= 0) {\n            lineWidget.children.splice(indexOf, 1);\n            format = textElement.characterFormat;\n            var fontSize = format.fontSize;\n            var index = textElement.length - HelperMethods.trimStart(text).length; //Trim start\n            while (index < textElement.length) {\n                index = this.getTextIndexAfterSpace(text, index);\n                if (index === 0 || index === textElement.length) {\n                    break;\n                }\n                if (index < textElement.length) {\n                    var splittedElement = new TextElementBox();\n                    var splittedText = text.substring(0, index);\n                    text = text.substring(index);\n                    if (text.substring(0, 1) === ' ') {\n                        // start of the text is trimmed and its length is reduced from text length.                        \n                        index += text.length - HelperMethods.trimStart(text).length;\n                    }\n                    splittedElement.text = splittedText;\n                    splittedElement.characterFormat.copyFormat(textElement.characterFormat);\n                    splittedElement.line = lineWidget;\n                    splittedElement.width = this.viewer.textHelper.getWidth(splittedElement.text, format);\n                    splittedElement.height = textElement.height;\n                    splittedElement.baselineOffset = textElement.baselineOffset;\n                    lineWidget.children.splice(indexOf, 0, splittedElement);\n                    textElement.text = text;\n                    textElement.width -= splittedElement.width;\n                    if (textElement.width === 0) {\n                        lineWidget.children.splice(lineWidget.children.indexOf(textElement), 1);\n                    }\n                    index = 0;\n                    indexOf++;\n                }\n            }\n            textElement.text = text;\n            lineWidget.children.splice(indexOf, 0, textElement);\n        }\n    };\n    /**\n     * Splits text for client area.\n     * @param element\n     * @param text\n     * @param width\n     * @param characterFormat\n     */\n    // tslint:disable-next-line:max-line-length\n    Layout.prototype.splitTextForClientArea = function (lineWidget, element, text, width, characterFormat) {\n        var paragraph = lineWidget.paragraph;\n        var isSplitByWord = true;\n        var index = -1;\n        if (!(text.substring(0, 1) === ' ')) {\n            var textWidth = width;\n            var characterUptoWS = 0;\n            characterUptoWS = HelperMethods.trimEnd(text).indexOf(' ') + 1;\n            index = characterUptoWS;\n            //Checks whether text not starts with white space. If starts with white space, no need to check previous text blocks.\n            if (index > 0) {\n                textWidth = this.viewer.textHelper.measureTextExcludingSpaceAtEnd(text.slice(0, index), characterFormat);\n            }\n            if (this.viewer.clientActiveArea.width < textWidth) {\n                //Check and split the previous text elements to next line.            \n                isSplitByWord = this.checkPreviousElement(lineWidget, lineWidget.children.indexOf(element), characterFormat);\n                if (isSplitByWord) {\n                    //lineWidget = paragraph.childWidgets[paragraph.childWidgets.indexOf(lineWidget) + 1] as LineWidget;\n                    //isSplitByWord = textWidth <= this.viewer.clientActiveArea.width;\n                    return;\n                }\n            }\n        }\n        else {\n            index = 1;\n        }\n        if (width <= this.viewer.clientActiveArea.width) {\n            //Fits the text in current line.\n            this.addElementToLine(paragraph, element);\n        }\n        else if (isSplitByWord && (index > 0 || text.indexOf(' ') !== -1)) {\n            this.splitByWord(lineWidget, paragraph, element, text, width, characterFormat);\n        }\n        else {\n            this.splitByCharacter(lineWidget, element, text, width, characterFormat);\n        }\n    };\n    /**\n     * Handle tab or line break character splitting\n     * @param  {LayoutViewer} viewer\n     * @param  {TextElementBox} span\n     * @param  {number} index\n     * @param  {string} spiltBy\n     * @private\n     */\n    Layout.prototype.splitByLineBreakOrTab = function (viewer, span, index, spiltBy) {\n        // Splits tab character to separate SpanAdv\n        var inlineIndex = span.line.children.indexOf(span);\n        var value = span.text;\n        var remainder = value.substring(index);\n        var newSpan = spiltBy === '\\t' ? new TabElementBox() : new TextElementBox();\n        newSpan.line = span.line;\n        newSpan.characterFormat.copyFormat(span.characterFormat);\n        span.line.children.splice(inlineIndex + 1, 0, newSpan);\n        if (index > 0 && remainder.length === 1) {\n            newSpan.text = value.substring(index);\n            span.text = value.substring(0, index);\n        }\n        else if (index > 0) {\n            newSpan.text = spiltBy;\n            var newText = new TextElementBox();\n            newText.line = span.line;\n            newText.text = value.substring(index + 1);\n            newText.characterFormat.copyFormat(span.characterFormat);\n            span.line.children.splice(inlineIndex + 2, 0, newText);\n            span.text = value.substring(0, index);\n        }\n        else if (remainder !== '') {\n            newSpan.text = value.substring(index + 1);\n            span.text = spiltBy;\n        }\n    };\n    /**\n     * Moves to next line.\n     */\n    Layout.prototype.moveToNextLine = function (line) {\n        var paragraph = line.paragraph;\n        var paraFormat = paragraph.paragraphFormat;\n        var isParagraphStart = line.isFirstLine();\n        var isParagraphEnd = line.isLastLine();\n        var height = 0;\n        var maxDescent = 0;\n        var afterSpacing = 0;\n        var beforeSpacing = 0;\n        var lineSpacing = 0;\n        var firstLineIndent = 0;\n        this.updateLineWidget(line);\n        height = this.maxTextHeight;\n        maxDescent = height - this.maxTextBaseline;\n        //Updates before spacing at the top of Paragraph first line.\n        if (isParagraphStart) {\n            beforeSpacing = this.getBeforeSpacing(paragraph);\n            firstLineIndent = HelperMethods.convertPointToPixel(paraFormat.firstLineIndent);\n        }\n        //Updates after spacing at the bottom of Paragraph last line.\n        if (isParagraphEnd) {\n            afterSpacing = HelperMethods.convertPointToPixel(paraFormat.afterSpacing);\n        }\n        if (isNaN(this.maxTextHeight)) {\n            //Calculate line height and descent based on formatting defined in paragraph.\n            var measurement = this.viewer.textHelper.measureText('a', paragraph.characterFormat);\n            height = measurement.Height;\n            maxDescent = height - measurement.BaselineOffset;\n        }\n        else {\n            height = this.maxTextHeight;\n            maxDescent = height - this.maxTextBaseline;\n        }\n        // Gets line spacing.\n        lineSpacing = this.getLineSpacing(paragraph, height);\n        if (paraFormat.lineSpacingType === 'Exactly'\n            && lineSpacing < maxDescent + this.maxBaseline) {\n            lineSpacing = maxDescent + this.maxBaseline;\n        }\n        var subWidth = 0;\n        var whiteSpaceCount = 0;\n        var textAlignment = paraFormat.textAlignment;\n        //Calculates the sub width, for text alignments - Center, Right, Justify.\n        if (textAlignment !== 'Left' && this.viewer.textWrap && !(textAlignment === 'Justify' && isParagraphEnd)) {\n            // tslint:disable-next-line:max-line-length\n            var getWidthAndSpace = this.getSubWidth(line, textAlignment === 'Justify', whiteSpaceCount, firstLineIndent);\n            subWidth = getWidthAndSpace.subWidth;\n            whiteSpaceCount = getWidthAndSpace.spaceCount;\n        }\n        var addSubWidth = false;\n        var lineSpacingType = paraFormat.lineSpacingType;\n        for (var i = 0; i < line.children.length; i++) {\n            var topMargin = 0;\n            var bottomMargin = 0;\n            var leftMargin = 0;\n            var elementBox = line.children[i];\n            // tslint:disable-next-line:max-line-length\n            var alignElements = this.alignLineElements(elementBox, topMargin, bottomMargin, maxDescent, addSubWidth, subWidth, textAlignment, whiteSpaceCount, i === line.children.length - 1);\n            topMargin = alignElements.topMargin;\n            bottomMargin = alignElements.bottomMargin;\n            addSubWidth = alignElements.addSubWidth;\n            whiteSpaceCount = alignElements.whiteSpaceCount;\n            //Updates line spacing, paragraph after/ before spacing and aligns the text to base line offset.\n            if (lineSpacingType === 'Multiple') {\n                if (lineSpacing > height) {\n                    bottomMargin += lineSpacing - height;\n                }\n                else {\n                    topMargin += lineSpacing - height;\n                }\n            }\n            else if (lineSpacingType === 'Exactly') {\n                topMargin += lineSpacing - (topMargin + elementBox.height + bottomMargin);\n            }\n            else if (lineSpacing > topMargin + elementBox.height + bottomMargin) {\n                topMargin += lineSpacing - (topMargin + elementBox.height + bottomMargin);\n            }\n            topMargin += beforeSpacing;\n            bottomMargin += afterSpacing;\n            if (i === 0) {\n                line.height = topMargin + elementBox.height + bottomMargin;\n                if (textAlignment === 'Right') {\n                    //Aligns the text as right justified.\n                    leftMargin = subWidth;\n                }\n                else if (textAlignment === 'Center') {\n                    //Aligns the text as center justified.\n                    leftMargin = subWidth / 2;\n                }\n            }\n            elementBox.margin = new Margin(leftMargin, topMargin, 0, bottomMargin);\n            elementBox.line = line;\n        }\n        this.viewer.cutFromTop(this.viewer.clientActiveArea.y + line.height);\n    };\n    Layout.prototype.updateLineWidget = function (line) {\n        for (var i = 0; i < line.children.length; i++) {\n            var element = line.children[i];\n            if (element instanceof TextElementBox || element instanceof ListTextElementBox) {\n                if (this.maxTextHeight < element.height) {\n                    this.maxTextHeight = element.height;\n                    this.maxTextBaseline = element.baselineOffset;\n                }\n                if (this.maxBaseline < this.maxTextBaseline) {\n                    this.maxBaseline = this.maxTextBaseline;\n                }\n            }\n            else if (this.maxBaseline < element.height) {\n                this.maxBaseline = element.height;\n            }\n        }\n    };\n    /**\n     * @param viewer\n     */\n    Layout.prototype.moveToNextPage = function (viewer, line, isPageBreak) {\n        var paragraphWidget = line.paragraph;\n        var index = 0;\n        if (!isNullOrUndefined(line)) {\n            index = paragraphWidget.childWidgets.indexOf(line);\n            if (index > 0 || isPageBreak) {\n                paragraphWidget.height = viewer.clientActiveArea.y - paragraphWidget.y;\n            }\n        }\n        var nextBody = this.moveBlocksToNextPage(paragraphWidget);\n        this.viewer.updateClientArea(nextBody.sectionFormat, nextBody.page);\n        this.viewer.updateClientAreaForBlock(paragraphWidget, true);\n        if (index > 0) {\n            if (line.isLastLine() && isPageBreak) {\n                return;\n            }\n            var nextParagraph = void 0;\n            if (nextBody.firstChild instanceof ParagraphWidget && nextBody.firstChild.equals(paragraphWidget)) {\n                nextParagraph = nextBody.firstChild;\n            }\n            else {\n                nextParagraph = new ParagraphWidget();\n            }\n            nextParagraph = this.addParagraphWidget(this.viewer.clientActiveArea, nextParagraph);\n            nextParagraph.index = paragraphWidget.index;\n            var insertIndex = 0;\n            for (var i = index; i < paragraphWidget.childWidgets.length; i++) {\n                var lineWidget = paragraphWidget.childWidgets[i];\n                lineWidget.paragraph = nextParagraph;\n                nextParagraph.childWidgets.splice(insertIndex, 0, lineWidget);\n                lineWidget.paragraph = nextParagraph;\n                insertIndex++;\n            }\n            nextParagraph.paragraphFormat = paragraphWidget.paragraphFormat;\n            nextParagraph.characterFormat = paragraphWidget.characterFormat;\n            paragraphWidget.childWidgets.splice(index);\n            paragraphWidget = nextParagraph;\n        }\n        else if (!isPageBreak) {\n            paragraphWidget.containerWidget.removeChild(paragraphWidget.indexInOwner);\n        }\n        if (!isPageBreak) {\n            if (nextBody.childWidgets.indexOf(paragraphWidget) === -1) {\n                nextBody.childWidgets.splice(0, 0, paragraphWidget);\n            }\n            paragraphWidget.containerWidget = nextBody;\n            this.viewer.updateClientAreaLocation(paragraphWidget, this.viewer.clientActiveArea);\n        }\n    };\n    /**\n     * Aligns line elements\n     * @param element\n     * @param topMargin\n     * @param bottomMargin\n     * @param maxDescent\n     * @param addSubWidth\n     * @param subWidth\n     * @param textAlignment\n     * @param whiteSpaceCount\n     * @param isLastElement\n     */\n    // tslint:disable-next-line:max-line-length\n    Layout.prototype.alignLineElements = function (element, topMargin, bottomMargin, maxDescent, addSubWidth, subWidth, textAlignment, whiteSpaceCount, isLastElement) {\n        if (element instanceof TextElementBox || element instanceof ListTextElementBox) {\n            var textElement = element instanceof TextElementBox ? element : undefined;\n            //Updates the text to base line offset.\n            // tslint:disable-next-line:max-line-length\n            var baselineOffset = element instanceof TextElementBox ? textElement.baselineOffset : element.baselineOffset;\n            topMargin += this.maxBaseline - baselineOffset;\n            bottomMargin += maxDescent - (element.height - baselineOffset);\n            //Updates the text to base line offset.\n            if (!isNullOrUndefined(textElement) && textAlignment === 'Justify' && whiteSpaceCount > 0) {\n                //Aligns the text as Justified.\n                var width = textElement.width;\n                var text = textElement.text;\n                if (!addSubWidth) {\n                    text = HelperMethods.trimStart(text); // trim start\n                    addSubWidth = (text.length > 0);\n                }\n                if (addSubWidth) {\n                    var spaceCount = text.length - HelperMethods.removeSpace(text).length;\n                    if (isLastElement) {\n                        spaceCount -= text.length - HelperMethods.trimEnd(text).length;\n                    }\n                    if (whiteSpaceCount < spaceCount) {\n                        width = this.viewer.textHelper.measureTextExcludingSpaceAtEnd(text, textElement.characterFormat);\n                        spaceCount = whiteSpaceCount;\n                    }\n                    if (spaceCount > 0) {\n                        textElement.width = width + subWidth * spaceCount;\n                        whiteSpaceCount -= spaceCount;\n                    }\n                }\n            }\n        }\n        else {\n            addSubWidth = true;\n            //Updates the Image/UIElement to base line offset.\n            topMargin += this.maxBaseline - element.height;\n            bottomMargin += maxDescent;\n        }\n        return { 'topMargin': topMargin, 'bottomMargin': bottomMargin, 'addSubWidth': addSubWidth, 'whiteSpaceCount': whiteSpaceCount };\n    };\n    /**\n     * Updates widget to page.\n     * @param viewer\n     * @param block\n     * @private\n     */\n    Layout.prototype.updateWidgetToPage = function (viewer, paragraphWidget) {\n        if (paragraphWidget.isInsideTable) {\n            var cellWidget = paragraphWidget.associatedCell;\n            paragraphWidget.height = viewer.clientActiveArea.y - paragraphWidget.y;\n            // if (viewer instanceof PageLayoutViewer) {\n            if (isNullOrUndefined(paragraphWidget.associatedCell) || isNullOrUndefined(paragraphWidget.associatedCell.ownerRow)\n                || isNullOrUndefined(paragraphWidget.associatedCell.ownerRow.rowFormat)) {\n                return;\n            }\n            if (paragraphWidget.associatedCell.ownerRow.rowFormat.heightType === 'Exactly') {\n                cellWidget.height = HelperMethods.convertPointToPixel(paragraphWidget.associatedCell.ownerRow.rowFormat.height);\n            }\n            else {\n                // tslint:disable-next-line:max-line-length\n                if ([cellWidget].length <= 1 && paragraphWidget.associatedCell.ownerRow.rowFormat.heightType === 'AtLeast') {\n                    cellWidget.height = Math.max(HelperMethods.convertPointToPixel(paragraphWidget.associatedCell.ownerRow.rowFormat.height), this.getCellContentHeight(cellWidget));\n                }\n                else {\n                    cellWidget.height = cellWidget.height + paragraphWidget.height;\n                }\n            }\n            // } else {\n            //     cellWidget.height = cellWidget.height + paragraphWidget.height;\n            // }\n            // cellWidget.childWidgets.push(paragraphWidget);\n            paragraphWidget.containerWidget = cellWidget;\n        }\n        else {\n            if (!paragraphWidget.isEndsWithPageBreak) {\n                paragraphWidget.height = viewer.clientActiveArea.y - paragraphWidget.y;\n            }\n            //Adds the paragraph widget to the Header Footer/ Body widget.\n            // this.updateWidgetsToBody(paragraphWidget, viewer, paragraphWidget);\n            //For canvas no need to render paragraph widget here. In case of div, need to render paragraph here.\n            // tslint:disable-next-line:max-line-length             \n            // this.render.renderParagraphWidget((paragraphWidget.containerWidget as BodyWidget).page, paragraphWidget);\n        }\n        if (paragraphWidget.bodyWidget instanceof HeaderFooterWidget) {\n            if (!paragraphWidget.isInsideTable) {\n                paragraphWidget.containerWidget.height += paragraphWidget.height;\n            }\n            if (this.viewer.owner.enableHeaderAndFooter && paragraphWidget.bodyWidget.headerFooterType.indexOf('Footer') !== -1) {\n                this.shiftFooterChildLocation(paragraphWidget.bodyWidget, this.viewer);\n            }\n        }\n    };\n    /**\n     * @private\n     */\n    Layout.prototype.shiftFooterChildLocation = function (widget, viewer) {\n        var pageHeight = widget.page.bodyWidgets[0].sectionFormat.pageHeight;\n        if (widget.headerFooterType.indexOf('Footer') !== -1) {\n            var footerDistance = widget.page.bodyWidgets[0].sectionFormat.footerDistance;\n            var height = HelperMethods.convertPointToPixel(pageHeight - footerDistance);\n            var top_2;\n            if (widget.y + widget.height > height) {\n                top_2 = height - (widget.y + widget.height);\n            }\n            else if (widget.y + widget.height < height) {\n                top_2 = (widget.y + widget.height) - height;\n            }\n            if (!isNullOrUndefined(top_2)) {\n                top_2 = height - (widget.y + widget.height);\n                this.shiftChildLocation(top_2, widget);\n                viewer.clientActiveArea.y += top_2;\n            }\n        }\n    };\n    /**\n     * Checks previous element.\n     * @param characterFormat\n     */\n    Layout.prototype.checkPreviousElement = function (line, index, characterFormat) {\n        var paragraph = line.paragraph;\n        var isSplitByWord = false;\n        var lastTextElement = 0;\n        for (var i = index - 1; i >= 0; i--) {\n            var textElement = line.children[i];\n            if (textElement instanceof TextElementBox) {\n                var text = textElement.text;\n                lastTextElement = i;\n                if (text.length > 0 && text[text.length - 1] === ' ') {\n                    if (i === index - 1) {\n                        this.addSplittedLineWidget(line, index - 1);\n                        return true;\n                    }\n                    isSplitByWord = true;\n                    break;\n                }\n                else if (text === '\\t') {\n                    return false;\n                }\n                else if (text.indexOf(' ') >= 0) {\n                    isSplitByWord = true;\n                    var index_1 = text.lastIndexOf(' ') + 1;\n                    //Splits the text element by space.\n                    var splittedElement = new TextElementBox();\n                    splittedElement.text = text.substr(index_1);\n                    splittedElement.characterFormat.copyFormat(textElement.characterFormat);\n                    textElement.text = text.substr(0, index_1);\n                    this.viewer.textHelper.getTextSize(splittedElement, characterFormat);\n                    textElement.width -= splittedElement.width;\n                    textElement.height = splittedElement.height;\n                    if (textElement.width === 0) {\n                        line.children.splice(i, 1);\n                    }\n                    //Adds the text element to the line\n                    line.children.splice(i + 1, 0, splittedElement);\n                    break;\n                }\n            }\n            else if (!(textElement instanceof ListTextElementBox)) {\n                //Handled for inline images/UIelements.\n                lastTextElement = i;\n                isSplitByWord = true;\n                break;\n            }\n        }\n        if (isSplitByWord) {\n            lastTextElement++;\n            if (lastTextElement < line.children.length) {\n                var splitWidth = 0;\n                for (var i = lastTextElement; i < line.children.length; i++) {\n                    splitWidth += line.children[i].width;\n                    this.addSplittedLineWidget(line, i - 1);\n                    i--;\n                }\n                this.viewer.updateClientWidth(splitWidth);\n            }\n        }\n        return isSplitByWord;\n    };\n    /**\n     * @private\n     */\n    Layout.prototype.clearListElementBox = function (paragraph) {\n        if (paragraph.childWidgets.length === 0) {\n            return;\n        }\n        var line = paragraph.childWidgets[0];\n        if (isNullOrUndefined(line.children)) {\n            return;\n        }\n        for (var i = 0; i < line.children.length; i++) {\n            if (line.children[i] instanceof ListTextElementBox) {\n                line.children.splice(i, 1);\n                i--;\n            }\n            else {\n                break;\n            }\n        }\n    };\n    /**\n     * Gets list number.\n     * @param listFormat\n     * @param document\n     * @private\n     */\n    Layout.prototype.getListNumber = function (listFormat) {\n        var list = this.viewer.getListById(listFormat.listId);\n        var levelNumber = listFormat.listLevelNumber;\n        var listLevel = this.getListLevel(list, listFormat.listLevelNumber);\n        // tslint:disable-next-line:max-line-length\n        var levelOverride = !isNullOrUndefined(list.levelOverrides) ? list.levelOverrides[levelNumber] : undefined;\n        // If LevelOverride exists and have either override list level or StartAtOverride, then only list numbering will be restarted.\n        // tslint:disable-next-line:max-line-length\n        // if (!isNullOrUndefined(levelOverride) && !(document.renderedLevelOverrides.indexOf(levelOverride) > -1) && isNullOrUndefined(levelOverride.overrideListLevel)) {\n        //     //Add List Override style\n        //     document.renderedLevelOverrides.push(list.levelOverrides.getItem(levelNumber) as WLevelOverride);\n        //     if (document.renderedLists.containsKey((list.wordDocument as WordDocument).getAbstractListById(list.abstractListId))) {\n        // tslint:disable-next-line:max-line-length\n        //         let levels: Dictionary<number, number> = document.renderedLists.get((list.wordDocument as WordDocument).getAbstractListById(list.abstractListId));\n        //         if (levels.containsKey(levelNumber)) {\n        //             levels.remove(levelNumber);\n        //         }\n        //     }\n        // }\n        this.updateListValues(list, levelNumber);\n        return this.getListText(list, levelNumber, listLevel);\n    };\n    /**\n     * Gets list start value\n     * @param listLevelNumber\n     * @param list\n     * @private\n     */\n    Layout.prototype.getListStartValue = function (listLevelNumber, list) {\n        // tslint:disable-next-line:max-line-length\n        var levelOverride = !isNullOrUndefined(list.levelOverrides) ? list.levelOverrides[listLevelNumber] : undefined;\n        if (!isNullOrUndefined(levelOverride) && isNullOrUndefined(levelOverride.overrideListLevel)) {\n            return levelOverride.startAt;\n        }\n        var listLevel = this.getListLevel(list, listLevelNumber);\n        if (isNullOrUndefined(listLevel)) {\n            return 0;\n        }\n        else {\n            return listLevel.startAt;\n        }\n    };\n    /**\n     * Updates list values.\n     * @param list\n     * @param listLevelNumber\n     * @param document\n     */\n    Layout.prototype.updateListValues = function (list, listLevelNumber) {\n        if (!this.viewer.renderedLists.containsKey(this.viewer.getAbstractListById(list.abstractListId))) {\n            var startVal = new Dictionary();\n            this.viewer.renderedLists.add(this.viewer.getAbstractListById(list.abstractListId), startVal);\n            var listLevel = this.getListLevel(list, listLevelNumber);\n            for (var i = 0; i <= listLevelNumber; i++) {\n                startVal.add(i, this.getListStartValue(i, list));\n            }\n        }\n        else {\n            // tslint:disable-next-line:max-line-length\n            var levels = this.viewer.renderedLists.get(this.viewer.getAbstractListById(list.abstractListId));\n            if (levels.containsKey(listLevelNumber)) {\n                var startAt = levels.get(listLevelNumber);\n                levels.set(listLevelNumber, startAt + 1);\n                var levelNumber = listLevelNumber + 1;\n                while (levelNumber < this.viewer.getAbstractListById(list.abstractListId).levels.length) {\n                    var listLevel = this.getListLevel(list, levelNumber);\n                    // if (!isNullOrUndefined(listLevel)) {\n                    if (levels.containsKey(levelNumber) && listLevel.restartLevel > listLevelNumber) {\n                        levels.remove(levelNumber);\n                        // if (document.renderedListLevels.indexOf(listLevel) > -1) {\n                        //     document.renderedListLevels.pop();\n                        // }\n                    }\n                    // }\n                    levelNumber++;\n                }\n            }\n            else {\n                var levelNumber = listLevelNumber;\n                while (!levels.containsKey(levelNumber - 1) && levelNumber > 0) {\n                    var listLevel = this.getListLevel(list, levelNumber - 1);\n                    // if (!isNullOrUndefined(listLevel)) {\n                    levels.add(levelNumber - 1, this.getListStartValue(levelNumber - 1, list));\n                    // if (document.renderedListLevels.indexOf(listLevel) !== -1) {\n                    //     document.renderedListLevels.push(listLevel);\n                    // }\n                    // }\n                    levelNumber--;\n                }\n                var startAt = this.getListStartValue(listLevelNumber, list);\n                levels.add(listLevelNumber, startAt);\n            }\n        }\n    };\n    /**\n     * Gets list text\n     * @param listAdv\n     * @param listLevelNumber\n     * @param currentListLevel\n     * @param document\n     */\n    Layout.prototype.getListText = function (listAdv, listLevelNumber, currentListLevel) {\n        var listText = currentListLevel.numberFormat;\n        // tslint:disable-next-line:max-line-length\n        if (this.viewer.renderedLists.containsKey(this.viewer.getAbstractListById(listAdv.abstractListId))) {\n            var levels = this.viewer.renderedLists.get(this.viewer.getAbstractListById(listAdv.abstractListId));\n            var keys = levels.keys;\n            for (var i = 0; i < keys.length; i++) {\n                var levelNumber = keys[i];\n                var levelKey = '%' + (levelNumber + 1).toString();\n                var listLevel = this.getListLevel(listAdv, levelNumber);\n                if (listText.match(levelKey)) {\n                    if (levelNumber > listLevelNumber) {\n                        return '';\n                    }\n                    else if (levels.containsKey(levelNumber) && !isNullOrUndefined(listLevel)) {\n                        listText = listText.replace(levelKey, this.getListTextListLevel(listLevel, levels.get(levelNumber)));\n                    }\n                    else {\n                        listText = listText.replace(levelKey, '0');\n                    }\n                }\n            }\n        }\n        return listText;\n    };\n    /**\n     * Gets the roman letter.\n     * @param number\n     * @private\n     */\n    Layout.prototype.getAsLetter = function (number) {\n        // if (number <= 0) {\n        //     return '';\n        // }\n        var quotient = number / 26;\n        var remainder = number % 26;\n        if (remainder === 0) {\n            //If number denotes the factor of 26, then reduce quotient by 1 and set remainder as 26.\n            remainder = 26;\n            quotient--;\n        }\n        //Index of A char in the ASCII table.     \n        var letter = String.fromCharCode(65 - 1 + remainder);\n        var listValue = '';\n        while (quotient >= 0) {\n            listValue = listValue + letter.toString();\n            quotient--;\n        }\n        return listValue;\n    };\n    /**\n     * Gets list text using list level pattern.\n     * @param listLevel\n     * @param listValue\n     * @private\n     */\n    Layout.prototype.getListTextListLevel = function (listLevel, listValue) {\n        switch (listLevel.listLevelPattern) {\n            case 'UpRoman':\n                return this.getAsRoman(listValue).toUpperCase();\n            case 'LowRoman':\n                return this.getAsRoman(listValue).toLowerCase();\n            case 'UpLetter':\n                return this.getAsLetter(listValue).toUpperCase();\n            case 'LowLetter':\n                return this.getAsLetter(listValue).toLowerCase();\n            case 'Arabic':\n                return (listValue).toString();\n            case 'LeadingZero':\n                return this.getAsLeadingZero(listValue);\n            case 'Number':\n                return (listValue).toString();\n            case 'OrdinalText':\n                return (listValue).toString();\n            case 'Ordinal':\n                return (listValue).toString();\n            case 'FarEast':\n                return (listValue).toString();\n            case 'Special':\n                return (listValue).toString();\n            default:\n                return '';\n        }\n    };\n    /**\n     * Generate roman number for the specified number.\n     * @param number\n     * @param magnitude\n     * @param letter\n     */\n    Layout.prototype.generateNumber = function (number, magnitude, letter) {\n        var numberstring = '';\n        while (number >= magnitude) {\n            number -= magnitude;\n            numberstring += letter;\n            this.value = number;\n        }\n        return numberstring.toString();\n    };\n    /**\n     * Gets list value prefixed with zero, if less than 10\n     * @param listValue\n     */\n    Layout.prototype.getAsLeadingZero = function (listValue) {\n        if (listValue < 10) {\n            return '0' + listValue.toString();\n        }\n        else {\n            return listValue.toString();\n        }\n    };\n    /**\n     * Gets the roman number\n     * @param number\n     * @private\n     */\n    Layout.prototype.getAsRoman = function (number) {\n        var retval = '';\n        this.value = number;\n        retval += this.generateNumber(this.value, 1000, 'M');\n        retval += this.generateNumber(this.value, 900, 'CM');\n        retval += this.generateNumber(this.value, 500, 'D');\n        retval += this.generateNumber(this.value, 400, 'CD');\n        retval += this.generateNumber(this.value, 100, 'C');\n        retval += this.generateNumber(this.value, 90, 'XC');\n        retval += this.generateNumber(this.value, 50, 'L');\n        retval += this.generateNumber(this.value, 40, 'XL');\n        retval += this.generateNumber(this.value, 10, 'X');\n        retval += this.generateNumber(this.value, 9, 'IX');\n        retval += this.generateNumber(this.value, 5, 'V');\n        retval += this.generateNumber(this.value, 4, 'IV');\n        retval += this.generateNumber(this.value, 1, 'I');\n        return retval.toString();\n    };\n    /**\n     * Gets the list level\n     * @param list\n     * @param listLevelNumber\n     * @private\n     */\n    Layout.prototype.getListLevel = function (list, listLevelNumber) {\n        if (!isNullOrUndefined(list)) {\n            var abstractList = this.viewer.getAbstractListById(list.abstractListId);\n            if (!isNullOrUndefined(list) && abstractList.levels.length <= listLevelNumber\n                && listLevelNumber >= 0 && listLevelNumber < 9) {\n                this.addListLevels(abstractList);\n            }\n            var levelOverrideAdv = undefined;\n            var level = false;\n            level = (!isNullOrUndefined(list.levelOverrides))\n                && !isNullOrUndefined(((levelOverrideAdv = list.levelOverrides[listLevelNumber])))\n                && (!isNullOrUndefined(levelOverrideAdv.overrideListLevel));\n            if (level) {\n                return levelOverrideAdv.overrideListLevel;\n            }\n            else if (!isNullOrUndefined(abstractList) && listLevelNumber >= 0 && listLevelNumber < abstractList.levels.length) {\n                return abstractList.levels[listLevelNumber];\n            }\n        }\n        return undefined;\n    };\n    /**\n     * Gets tab width\n     * @param paragraph\n     * @param viewer\n     */\n    // tslint:disable-next-line:max-line-length\n    Layout.prototype.getTabWidth = function (paragraph, viewer, index, lineWidget, element) {\n        var fposition = 0;\n        var isCustomTab = false;\n        var tabs = paragraph.paragraphFormat.getUpdatedTabs();\n        //  Calculate hanging width\n        if (viewer.clientActiveArea.x < viewer.clientArea.x) {\n            return viewer.clientArea.x - viewer.clientActiveArea.x;\n        }\n        // Calculates tabwidth based on pageleftmargin and defaulttabwidth property\n        var position = viewer.clientActiveArea.x -\n            (viewer.clientArea.x - HelperMethods.convertPointToPixel(paragraph.paragraphFormat.leftIndent));\n        var defaultTabWidth = HelperMethods.convertPointToPixel(viewer.defaultTabWidth);\n        if (tabs.length === 0 && (position === 0 || defaultTabWidth === 0)) {\n            return defaultTabWidth;\n        }\n        else {\n            if (tabs.length > 0) {\n                for (var i = 0; i < tabs.length; i++) {\n                    var tabPosition = HelperMethods.convertPointToPixel(tabs[i].position);\n                    if (tabs[i].tabJustification === 'Left' && position < tabPosition) {\n                        fposition = tabPosition;\n                        isCustomTab = true;\n                        if (!isNullOrUndefined(element)) {\n                            element.tabLeader = tabs[i].tabLeader;\n                            element.tabText = '';\n                        }\n                        break;\n                    }\n                    else if (tabs[i].tabJustification === 'Right' && position < tabPosition) {\n                        var tabwidth = tabPosition - position;\n                        var width = this.getRightTabWidth(index + 1, lineWidget, paragraph);\n                        if (width < tabwidth) {\n                            defaultTabWidth = tabwidth - width;\n                        }\n                        else {\n                            defaultTabWidth = 0;\n                        }\n                        fposition = position;\n                        isCustomTab = true;\n                        if (!isNullOrUndefined(element)) {\n                            element.tabLeader = tabs[i].tabLeader;\n                            element.tabText = '';\n                        }\n                        break;\n                    }\n                }\n            }\n            if (!isCustomTab) {\n                var diff = ((Math.round(position) * 100) % (Math.round(defaultTabWidth) * 100)) / 100;\n                var cnt = (Math.round(position) - diff) / Math.round(defaultTabWidth);\n                fposition = (cnt + 1) * defaultTabWidth;\n            }\n            return (fposition - position) > 0 ? fposition - position : defaultTabWidth;\n        }\n    };\n    /**\n     * Returns the right tab width\n     * @param index - index of starting inline\n     * @param lineWidget - current line widget\n     * @param paragraph - current paragraph widget\n     */\n    Layout.prototype.getRightTabWidth = function (index, lineWidget, paragraph) {\n        var width = 0;\n        var isFieldCode = false;\n        while (index < lineWidget.children.length) {\n            var elementBox = lineWidget.children[index];\n            if ((elementBox instanceof FieldElementBox) || (elementBox instanceof BookmarkElementBox) || isFieldCode) {\n                if (elementBox instanceof FieldElementBox) {\n                    if (elementBox.fieldType === 0) {\n                        isFieldCode = true;\n                    }\n                    else if (elementBox.fieldType === 2) {\n                        isFieldCode = false;\n                    }\n                }\n                elementBox.width = 0;\n            }\n            else {\n                this.viewer.textHelper.getTextSize(elementBox, elementBox.characterFormat);\n            }\n            if (elementBox instanceof TextElementBox && elementBox.text === '\\t') {\n                return width;\n            }\n            else {\n                width = width + elementBox.width;\n            }\n            index++;\n        }\n        return width;\n    };\n    /**\n     * Gets split index by word.\n     * @param clientActiveWidth\n     * @param text\n     * @param width\n     * @param characterFormat\n     */\n    Layout.prototype.getSplitIndexByWord = function (clientActiveWidth, text, width, characterFormat) {\n        var index = 0;\n        var length = text.length;\n        while (index < length) {\n            var nextIndex = this.getTextIndexAfterSpace(text, index);\n            if (nextIndex === 0 || nextIndex === length) {\n                nextIndex = length - 1;\n            }\n            var splitWidth = width;\n            if ((nextIndex < length - 1 || (nextIndex === length - 1 && text[nextIndex - 1] === ' ')) && index !== nextIndex) {\n                splitWidth = this.viewer.textHelper.measureTextExcludingSpaceAtEnd(text.slice(0, nextIndex), characterFormat);\n            }\n            if (splitWidth <= clientActiveWidth) {\n                index = nextIndex;\n            }\n            else {\n                if (index === 0 && text[0] === ' ') {\n                    index = this.getTextIndexAfterSpace(text, 0);\n                }\n                break;\n            }\n        }\n        return index;\n    };\n    /**\n     * Gets split index by character\n     * @param totalClientWidth\n     * @param clientActiveAreaWidth\n     * @param text\n     * @param width\n     * @param characterFormat\n     */\n    // tslint:disable-next-line:max-line-length\n    Layout.prototype.getTextSplitIndexByCharacter = function (totalClientWidth, clientActiveAreaWidth, text, width, characterFormat) {\n        var length = text.length;\n        for (var i = 0; i < length; i++) {\n            var splitWidth = width;\n            if (i + 1 < length) {\n                splitWidth = this.viewer.textHelper.measureTextExcludingSpaceAtEnd(text.substring(0, i + 1), characterFormat);\n            }\n            if (splitWidth > clientActiveAreaWidth) {\n                if (i === 0 && splitWidth > totalClientWidth) {\n                    //Handle for cell/section having client width less than a character's width.\n                    return (length > 1 && text[1] === ' ') ? this.getTextIndexAfterSpace(text, 1) : 1;\n                }\n                return i;\n            }\n        }\n        return 0;\n    };\n    /**\n     * Gets sub width.\n     * @param justify\n     * @param spaceCount\n     * @param firstLineIndent\n     */\n    Layout.prototype.getSubWidth = function (lineWidget, justify, spaceCount, firstLineIndent) {\n        var width = 0;\n        var trimSpace = true;\n        var lineText = '';\n        for (var i = lineWidget.children.length - 1; i >= 0; i--) {\n            var element = lineWidget.children[i];\n            if (element instanceof TextElementBox) {\n                var elementText = element.text;\n                lineText = elementText + lineText;\n                if (trimSpace && (elementText.trim() !== '' || elementText === '\\t')) {\n                    if (HelperMethods.endsWith(elementText)) {\n                        width += this.viewer.textHelper.measureTextExcludingSpaceAtEnd(elementText, element.characterFormat);\n                    }\n                    else {\n                        width += element.width;\n                    }\n                    trimSpace = false;\n                }\n                else if (!trimSpace) {\n                    width += element.width;\n                }\n            }\n            else {\n                lineText = 'a' + lineText;\n                trimSpace = false;\n                width += element.width;\n            }\n            if (!justify) {\n                width = Math.round(width);\n            }\n        }\n        lineText = lineText.trim();\n        spaceCount = lineText.length - HelperMethods.removeSpace(lineText).length;\n        var subWidth = (this.viewer.clientArea.width - firstLineIndent - width);\n        if (subWidth <= 0 || (spaceCount === 0 && justify)) {\n            spaceCount = 0;\n            subWidth = 0;\n        }\n        else if (justify) {\n            subWidth = subWidth / spaceCount;\n        }\n        return { 'subWidth': subWidth, 'spaceCount': spaceCount };\n    };\n    /**\n     * Gets before spacing.\n     * @param paragraph\n     * @private\n     */\n    Layout.prototype.getBeforeSpacing = function (paragraph) {\n        var beforeSpacing = 0;\n        if (paragraph.previousWidget instanceof ParagraphWidget) {\n            if (paragraph.previousWidget.paragraphFormat.afterSpacing < paragraph.paragraphFormat.beforeSpacing) {\n                // tslint:disable-next-line:max-line-length\n                beforeSpacing = paragraph.paragraphFormat.beforeSpacing - paragraph.previousWidget.paragraphFormat.afterSpacing;\n            }\n        }\n        else {\n            beforeSpacing = paragraph.paragraphFormat.beforeSpacing;\n        }\n        return beforeSpacing;\n    };\n    /**\n     * Gets line spacing.\n     * @param paragraph\n     * @param maxHeight\n     * @private\n     */\n    Layout.prototype.getLineSpacing = function (paragraph, maxHeight) {\n        if (isNullOrUndefined(paragraph.paragraphFormat)) {\n            return 0;\n        }\n        var lineSpacing = 0;\n        switch (paragraph.paragraphFormat.lineSpacingType) {\n            case 'AtLeast':\n            case 'Exactly':\n                lineSpacing = paragraph.paragraphFormat.lineSpacing;\n                break;\n            default:\n                lineSpacing = paragraph.paragraphFormat.lineSpacing * maxHeight;\n                break;\n        }\n        return lineSpacing;\n    };\n    /**\n     * Checks whether current line is first line in a paragraph.\n     * @param paragraph\n     */\n    Layout.prototype.isParagraphFirstLine = function (paragraph, line) {\n        var widget = paragraph;\n        if (isNullOrUndefined(widget.childWidgets) || widget.childWidgets.indexOf(line) === 0) {\n            //If the line elements conatins the elements from previous paragraph then need to retun false.\n            //Example scenario, Field start and field end in different paragraphs.\n            if (line.children.length > 0 && !isNullOrUndefined(paragraph.previousWidget)\n                && paragraph.previousWidget instanceof ParagraphWidget) {\n                return line.paragraph.index !== paragraph.previousWidget.index;\n            }\n            return true; //If the line elements count is zero then also need to return true.\n        }\n        return false;\n    };\n    /**\n     * Checks whether current line is last line in a paragraph.\n     * @param paragraph\n     */\n    Layout.prototype.isParagraphLastLine = function (element) {\n        var paragraph = element.line.paragraph;\n        var lastLineWidget = paragraph.childWidgets[paragraph.childWidgets.length - 1];\n        var lastInline = lastLineWidget.children[lastLineWidget.children.length - 1];\n        if (element === lastInline) {\n            // tslint:disable-next-line:max-line-length            \n            return (lastInline instanceof FieldElementBox) || ((!(lastInline instanceof TextElementBox && lastInline.text === '\\v')));\n        }\n        return false;\n    };\n    /**\n     * Gets text index after space.\n     * @param text\n     * @param startIndex\n     */\n    Layout.prototype.getTextIndexAfterSpace = function (text, startIndex) {\n        var length = text.length;\n        var index = 0;\n        index = text.indexOf(' ', startIndex) + 1;\n        var nextIndex = index;\n        if (nextIndex === 0 || nextIndex === length) {\n            return nextIndex;\n        }\n        while (text[nextIndex] === ' ') {\n            nextIndex++;\n            if (nextIndex === length) {\n                break;\n            }\n        }\n        return nextIndex;\n    };\n    //#region Table\n    /**\n     * @private\n     */\n    Layout.prototype.moveNextWidgetsToTable = function (tableWidget, rowWidgets, moveFromNext) {\n        var currentRow = moveFromNext ? rowWidgets[rowWidgets.length - 2] : rowWidgets[rowWidgets.length - 1];\n        var rowIndex = currentRow.indexInOwner;\n        var currentTable = tableWidget[tableWidget.length - 1];\n        if (moveFromNext) {\n            rowIndex += 1;\n        }\n        var nextWidgets = currentRow.containerWidget.childWidgets.splice(rowIndex);\n        for (var i = 0; i < nextWidgets.length; i++) {\n            currentTable.childWidgets.push(nextWidgets[i]);\n            nextWidgets[i].containerWidget = currentTable;\n        }\n    };\n    /**\n     * Adds table cell widget.\n     * @param cell\n     * @param area\n     * @param maxCellMarginTop\n     * @param maxCellMarginBottom\n     */\n    Layout.prototype.addTableCellWidget = function (cell, area, maxCellMarginTop, maxCellMarginBottom) {\n        //let tableCellWidget: TableCellWidget = new TableCellWidget(cell);\n        var prevColumnIndex = 0;\n        var cellspace = 0;\n        var left = 0;\n        var top = maxCellMarginTop;\n        var right = 0;\n        var bottom = maxCellMarginBottom;\n        if (!isNullOrUndefined(cell.cellFormat)) {\n            if (cell.cellFormat.containsMargins()) {\n                // tslint:disable-next-line:max-line-length\n                left = isNullOrUndefined(cell.cellFormat.leftMargin) ? HelperMethods.convertPointToPixel(cell.ownerTable.tableFormat.leftMargin) : HelperMethods.convertPointToPixel(cell.cellFormat.leftMargin);\n                right = isNullOrUndefined(cell.cellFormat.rightMargin) ? HelperMethods.convertPointToPixel(cell.ownerTable.tableFormat.rightMargin) : HelperMethods.convertPointToPixel(cell.cellFormat.rightMargin);\n            }\n            else {\n                left = HelperMethods.convertPointToPixel(cell.ownerTable.tableFormat.leftMargin);\n                right = HelperMethods.convertPointToPixel(cell.ownerTable.tableFormat.rightMargin);\n            }\n        }\n        cell.margin = new Margin(left, top, right, bottom);\n        cell.width = HelperMethods.convertPointToPixel(cell.cellFormat.cellWidth);\n        if (!isNullOrUndefined(cell.previousWidget)) {\n            // tslint:disable-next-line:max-line-length\n            prevColumnIndex = cell.previousWidget.columnIndex + cell.previousWidget.cellFormat.columnSpan;\n        }\n        // tslint:disable-next-line:max-line-length\n        cellspace = !isNullOrUndefined(cell.ownerTable) && !isNullOrUndefined(cell.ownerTable.tableFormat) ? HelperMethods.convertPointToPixel(cell.ownerTable.tableFormat.cellSpacing) : 0;\n        var prevSpannedCellWidth = 0;\n        if (prevColumnIndex < cell.columnIndex) {\n            // tslint:disable-next-line:max-line-length\n            prevSpannedCellWidth = HelperMethods.convertPointToPixel(cell.ownerTable.tableHolder.getPreviousSpannedCellWidth(prevColumnIndex, cell.columnIndex));\n            if (prevColumnIndex === 0) {\n                prevSpannedCellWidth = prevSpannedCellWidth - cellspace / 2;\n            }\n        }\n        cell.x = area.x + prevSpannedCellWidth + cell.margin.left;\n        cell.y = area.y + cell.margin.top + cellspace;\n        cell.width = cell.width - cell.margin.left - cell.margin.right;\n        if (cellspace > 0) {\n            cell.x += cellspace;\n            if (cell.ownerTable.tableHolder.columns.length === 1) {\n                cell.width -= cellspace * 2;\n            }\n            else if (cell.columnIndex === 0 || cell.columnIndex === cell.ownerTable.tableHolder.columns.length - 1) {\n                cell.width -= ((cellspace * 2) - cellspace / 2);\n            }\n            else {\n                cell.width -= cellspace;\n            }\n        }\n        // update the margins values respect to layouting of borders.\n        // tslint:disable-next-line:max-line-length\n        //For normal table cells only left border is rendred. for last cell left and right border is rendred. this border widths are not included in margins.\n        cell.leftBorderWidth = HelperMethods.convertPointToPixel(TableCellWidget.getCellLeftBorder(cell).getLineWidth());\n        cell.x += cell.leftBorderWidth;\n        cell.width -= cell.leftBorderWidth;\n        if (cellspace > 0 || cell.cellIndex === cell.ownerRow.childWidgets.length - 1) {\n            cell.rightBorderWidth = TableCellWidget.getCellRightBorder(cell).getLineWidth();\n            cell.width -= cell.rightBorderWidth;\n        }\n        //Add the border widths to respective margin side.\n        cell.margin.left = cell.margin.left + cell.leftBorderWidth;\n        cell.margin.right = cell.margin.right + cell.rightBorderWidth;\n        //cell.ownerWidget = owner;\n        return cell;\n    };\n    /**\n     * Adds specified row widget to table.\n     * @param viewer\n     * @param tableRowWidget\n     * @param row\n     */\n    // tslint:disable-next-line:max-line-length\n    Layout.prototype.addWidgetToTable = function (viewer, tableCollection, rowCollection, row, endRowWidget) {\n        //Adds table row widget to owner table widget.\n        var tableWidget = tableCollection[0];\n        var index = tableWidget.childWidgets.length;\n        var prevWidget = undefined;\n        var rowWidgetIndex = rowCollection.indexOf(row);\n        if (rowWidgetIndex > 0) {\n            prevWidget = rowCollection[rowWidgetIndex - 1];\n            // Need to update on this further\n        }\n        else if (row.previousRenderedWidget instanceof TableRowWidget &&\n            row.previousRenderedWidget.ownerTable.equals(row.ownerTable)) {\n            // Need to update on this further\n            prevWidget = row.previousRenderedWidget;\n        }\n        if (!isNullOrUndefined(prevWidget)) {\n            tableWidget = prevWidget.containerWidget;\n            // index = tableWidget.childWidgets.length;\n            index = tableWidget.childWidgets.indexOf(prevWidget) + 1;\n            if (Math.round(row.y) !== Math.round(prevWidget.y + prevWidget.height)) {\n                var prevIndex = tableCollection.indexOf(tableWidget);\n                if (prevIndex + 1 >= tableCollection.length) {\n                    //Creates new table widget for splitted rows.\n                    this.addTableWidget(viewer.clientActiveArea, tableCollection, true);\n                }\n                tableWidget = tableCollection[prevIndex + 1];\n                index = tableWidget.childWidgets.length;\n            }\n            if (rowWidgetIndex > 0) {\n                index = 0;\n            }\n        }\n        this.updateRowHeightBySpannedCell(tableWidget, row, index);\n        this.updateRowHeightByCellSpacing(tableCollection, row, viewer);\n        //Remove widget from previous container after splitteing\n        if (row.containerWidget && row.containerWidget !== tableWidget &&\n            row.containerWidget.childWidgets.indexOf(row) !== -1) {\n            row.containerWidget.childWidgets.splice(row.containerWidget.childWidgets.indexOf(row), 1);\n        }\n        if (tableWidget.childWidgets.indexOf(row) === -1) {\n            tableWidget.childWidgets.splice(index, 0, row);\n        }\n        row.containerWidget = tableWidget;\n        tableWidget.height = tableWidget.height + row.height;\n        if (!isNullOrUndefined(tableWidget.containerWidget)\n            && tableWidget.containerWidget.childWidgets.indexOf(tableWidget) >= 0 &&\n            !(tableWidget.containerWidget instanceof HeaderFooterWidget)) {\n            tableWidget.containerWidget.height += row.height;\n        }\n        this.updateHeightForRowWidget(viewer, false, tableCollection, rowCollection, row, false, endRowWidget);\n        viewer.cutFromTop(row.y + row.height);\n    };\n    /**\n     * Updates row height by spanned cell.\n     * @param tableWidget\n     * @param rowWidget\n     * @param insertIndex\n     * @param row\n     * @private\n     */\n    Layout.prototype.updateRowHeightBySpannedCell = function (tableWidget, row, insertIndex) {\n        var rowSpan = 1;\n        if (tableWidget.childWidgets.length === 0 || insertIndex === 0) {\n            this.updateRowHeight(row, row);\n            return;\n        }\n        for (var i = 0; i < row.childWidgets.length; i++) {\n            var cellWidget = row.childWidgets[i];\n            // tslint:disable-next-line:max-line-length\n            rowSpan = (isNullOrUndefined(cellWidget) || isNullOrUndefined(cellWidget.cellFormat)) ? rowSpan : cellWidget.cellFormat.rowSpan;\n            this.updateSpannedRowCollection(rowSpan, row);\n        }\n        if (!isNullOrUndefined(row.ownerTable)) {\n            for (var i = 0; i < row.ownerTable.spannedRowCollection.length; i++) {\n                if (row.ownerTable.spannedRowCollection.keys[i] === row.index) {\n                    // Back track to previous table row widgets and update it height if vertical merge ends with this row.\n                    for (var j = 0; j < insertIndex; j++) {\n                        var prevRowWidget = tableWidget.childWidgets[j];\n                        this.updateRowHeight(prevRowWidget, row);\n                    }\n                    row.ownerTable.spannedRowCollection.remove(row.ownerTable.spannedRowCollection.keys[i]);\n                    break;\n                }\n            }\n        }\n    };\n    /**\n     * Updates row height.\n     * @param prevRowWidget\n     * @param rowWidget\n     * @param row\n     */\n    Layout.prototype.updateRowHeight = function (prevRowWidget, row) {\n        var rowIndex = row.index;\n        var rowSpan = 1;\n        for (var i = 0; i < prevRowWidget.childWidgets.length; i++) {\n            var cellWidget = prevRowWidget.childWidgets[i];\n            // tslint:disable-next-line:max-line-length\n            rowSpan = (isNullOrUndefined(cellWidget) || isNullOrUndefined(cellWidget.cellFormat)) ? rowSpan : cellWidget.cellFormat.rowSpan;\n            //To update Row height- if row has row span value greater than 1, need to add it in spannedRowCollection            \n            this.updateSpannedRowCollection(rowSpan, row);\n            if (rowIndex - cellWidget.rowIndex === rowSpan - 1) {\n                var mergedCellHeight = cellWidget.y + cellWidget.height + cellWidget.margin.bottom - row.y;\n                if (row.height < mergedCellHeight) {\n                    row.height = mergedCellHeight;\n                }\n            }\n        }\n    };\n    //if row has row span value greater than 1, need to add it in spannedRowCollection\n    Layout.prototype.updateSpannedRowCollection = function (rowSpan, row) {\n        if (rowSpan > 1 && !isNullOrUndefined(row.ownerTable)) {\n            //Checks the rowspan is already exist in the list\n            if (!row.ownerTable.spannedRowCollection.containsKey(row.index + rowSpan - 1)) {\n                row.ownerTable.spannedRowCollection.add(row.index + rowSpan - 1, row.index);\n            }\n        }\n    };\n    /**\n     * Updates row height by cell spacing\n     * @param rowWidget\n     * @param viewer\n     * @param row\n     */\n    Layout.prototype.updateRowHeightByCellSpacing = function (tableCollection, row, viewer) {\n        if (row.ownerTable.tableFormat.cellSpacing > 0) {\n            // In the Case of tableWidget is greater than one and rowWidget is start at the Top Position of the page. \n            // In such case we have update the row height with half of cell spacing.\n            // Remaining cases we have to update the entire hight\n            // tslint:disable-next-line:max-line-length\n            if (tableCollection.length > 1 && row.y === viewer.clientArea.y && viewer instanceof PageLayoutViewer) {\n                row.height = row.height - HelperMethods.convertPointToPixel(row.ownerTable.tableFormat.cellSpacing) / 2;\n            }\n        }\n    };\n    /**\n     * Checks whether row span is end.\n     * @param row\n     * @param viewer\n     */\n    Layout.prototype.isRowSpanEnd = function (row, viewer) {\n        var rowIndex = row.index;\n        var rowSpan = 1;\n        for (var i = 0; i < viewer.splittedCellWidgets.length; i++) {\n            var splittedCell = viewer.splittedCellWidgets[i];\n            // tslint:disable-next-line:max-line-length\n            rowSpan = (isNullOrUndefined(splittedCell) || isNullOrUndefined(splittedCell.cellFormat)) ? rowSpan : splittedCell.cellFormat.rowSpan;\n            if (rowIndex - splittedCell.rowIndex === rowSpan - 1) {\n                return true;\n            }\n        }\n        return false;\n    };\n    /**\n     * Checks whether vertical merged cell to continue or not.\n     * @param row\n     * @private\n     */\n    Layout.prototype.isVerticalMergedCellContinue = function (row) {\n        var colIndex = 0;\n        for (var i = 0; i < row.childWidgets.length; i++) {\n            var cell = row.childWidgets[i];\n            if (colIndex < cell.columnIndex) {\n                return true;\n            }\n            colIndex += cell.cellFormat.columnSpan;\n        }\n        return colIndex < row.ownerTable.tableHolder.columns.length;\n    };\n    /**\n     * Splits widgets.\n     * @param tableRowWidget\n     * @param viewer\n     * @param splittedWidget\n     * @param row\n     */\n    // tslint:disable-next-line:max-line-length\n    Layout.prototype.splitWidgets = function (tableRowWidget, viewer, tableCollection, rowCollection, splittedWidget, isLastRow) {\n        if (this.isFirstLineFitForRow(viewer.clientArea.bottom, tableRowWidget) && tableRowWidget.childWidgets.length > 0) {\n            splittedWidget = this.getSplittedWidgetForRow(viewer.clientArea.bottom, tableCollection, rowCollection, tableRowWidget);\n            if (viewer.splittedCellWidgets.length > 0 || splittedWidget !== tableRowWidget) {\n                if (isLastRow) {\n                    for (var i = 0; i < splittedWidget.childWidgets.length; i++) {\n                        var cell = splittedWidget.childWidgets[i];\n                        if (cell.rowIndex !== splittedWidget.index) {\n                            splittedWidget.childWidgets.splice(i, 1);\n                            i--;\n                        }\n                    }\n                }\n                //Adds the splitted widget of a vertical merged cell, to next row widget in the next page.\n                this.insertSplittedCellWidgets(viewer, tableCollection, splittedWidget, tableRowWidget.indexInOwner - 1);\n            }\n        }\n        else {\n            //Adds the splitted widget of a vertical merged cell, to next row widget in the next page.\n            this.insertSplittedCellWidgets(viewer, tableCollection, splittedWidget, tableRowWidget.indexInOwner - 1);\n        }\n        return splittedWidget;\n    };\n    /**\n     * Gets splitted widget for row.\n     * @param bottom\n     * @param tableRowWidget\n     */\n    // tslint:disable-next-line:max-line-length\n    Layout.prototype.getSplittedWidgetForRow = function (bottom, tableCollection, rowCollection, tableRowWidget) {\n        var splittedWidget = undefined;\n        var rowIndex = tableRowWidget.index;\n        for (var i = 0; i < tableRowWidget.childWidgets.length; i++) {\n            var cellWidget = tableRowWidget.childWidgets[i];\n            var splittedCell = this.getSplittedWidget(bottom, true, tableCollection, rowCollection, cellWidget);\n            if (!isNullOrUndefined(splittedCell)) {\n                if (splittedCell === cellWidget) {\n                    //Returns if the whole content of the row does not fit in current page.\n                    return tableRowWidget;\n                }\n                if (tableRowWidget.childWidgets.indexOf(splittedCell) !== -1) {\n                    tableRowWidget.childWidgets.splice(tableRowWidget.childWidgets.indexOf(splittedCell), 1);\n                }\n                if (i === 0 || tableRowWidget.height < cellWidget.height + cellWidget.margin.top + cellWidget.margin.bottom) {\n                    tableRowWidget.height = cellWidget.height + cellWidget.margin.top + cellWidget.margin.bottom;\n                }\n                if (isNullOrUndefined(splittedWidget)) {\n                    //Creates new widget, to hold the splitted contents.\n                    splittedWidget = new TableRowWidget();\n                    splittedWidget.containerWidget = tableRowWidget.containerWidget;\n                    splittedWidget.index = tableRowWidget.index;\n                    splittedWidget.rowFormat = tableRowWidget.rowFormat;\n                    this.updateWidgetLocation(tableRowWidget, splittedWidget);\n                    splittedWidget.height = 0;\n                    rowCollection.push(splittedWidget);\n                }\n                var rowSpan = 1;\n                // tslint:disable-next-line:max-line-length\n                rowSpan = (isNullOrUndefined(splittedCell) || isNullOrUndefined(splittedCell.cellFormat)) ? rowSpan : splittedCell.cellFormat.rowSpan;\n                if (rowIndex - splittedCell.rowIndex === rowSpan - 1\n                    && splittedWidget.height < splittedCell.height + splittedCell.margin.top + splittedCell.margin.bottom) {\n                    splittedWidget.height = splittedCell.height + splittedCell.margin.top + splittedCell.margin.bottom;\n                }\n                splittedWidget.childWidgets.push(splittedCell);\n                splittedCell.containerWidget = splittedWidget;\n            }\n        }\n        return splittedWidget;\n    };\n    /**\n     * Updates widget to table.\n     * @param row\n     * @param viewer\n     */\n    /* tslint:disable */\n    Layout.prototype.updateWidgetsToTable = function (tableWidgets, rowWidgets, row) {\n        var rowHeight = this.getRowHeight(row, [row]);\n        var viewer = this.viewer;\n        //initializing row properties with default values.\n        var isHeader = row.rowFormat.isHeader;\n        var isAllowBreakAcrossPages = row.rowFormat.allowBreakAcrossPages;\n        var heightType = row.rowFormat.heightType;\n        var cellSpacing = 0;\n        var count = 0;\n        var tableRowWidget = row;\n        var moveRowToNextTable = false;\n        if (row.ownerTable.continueHeader && !isHeader) {\n            row.ownerTable.continueHeader = false;\n        }\n        var isLastRow = false;\n        cellSpacing = (!isNullOrUndefined(row.ownerTable) && !isNullOrUndefined(row.ownerTable.tableFormat)) ? HelperMethods.convertPointToPixel(row.ownerTable.tableFormat.cellSpacing) : 0;\n        while (count < rowWidgets.length) {\n            count = rowWidgets.length;\n            if (row.ownerTable.isInsideTable || (viewer.splittedCellWidgets.length === 0 && tableRowWidget.y + tableRowWidget.height + cellSpacing <= viewer.clientArea.bottom)) {\n                this.addWidgetToTable(viewer, tableWidgets, rowWidgets, tableRowWidget);\n                if (viewer.splittedCellWidgets.length > 0 && isNullOrUndefined(rowWidgets[rowWidgets.length - 1].nextRow)) {\n                    count--;\n                    isLastRow = true;\n                }\n            }\n            else {\n                //Split widget for next page\n                if (viewer.splittedCellWidgets.length > 0 && tableRowWidget.y + tableRowWidget.height <= viewer.clientArea.bottom) {\n                    var isRowSpanEnd = this.isRowSpanEnd(row, viewer);\n                    if (!isRowSpanEnd) {\n                        if (this.isVerticalMergedCellContinue(row) && tableRowWidget.y == viewer.clientArea.y) {\n                            this.insertSplittedCellWidgets(viewer, tableWidgets, tableRowWidget, tableRowWidget.indexInOwner - 1);\n                        }\n                        this.addWidgetToTable(viewer, tableWidgets, rowWidgets, tableRowWidget);\n                        continue;\n                    }\n                }\n                var splittedWidget = tableRowWidget;\n                var tableWidget = tableWidgets[tableWidgets.length - 1];\n                if (rowHeight + tableRowWidget.y > viewer.clientArea.bottom) {\n                    // tslint:disable-next-line:max-line-length\n                    if (!isAllowBreakAcrossPages || (isHeader && row.ownerTable.continueHeader) || (heightType === 'AtLeast' && HelperMethods.convertPointToPixel(row.rowFormat.height) < viewer.clientArea.bottom)) {\n                        // tslint:disable-next-line:max-line-length\n                        if ((heightType === 'AtLeast' && HelperMethods.convertPointToPixel(row.rowFormat.height) < viewer.clientActiveArea.height && isAllowBreakAcrossPages) || (heightType !== 'Exactly' && tableRowWidget.y === viewer.clientArea.y) || (heightType === 'Auto' && isAllowBreakAcrossPages)) {\n                            splittedWidget = this.splitWidgets(tableRowWidget, viewer, tableWidgets, rowWidgets, splittedWidget, isLastRow);\n                        }\n                        if (heightType === 'Exactly' && tableRowWidget.y === viewer.clientArea.y) {\n                            this.addWidgetToTable(viewer, tableWidgets, rowWidgets, tableRowWidget);\n                            count++;\n                        }\n                        if (isHeader && row.ownerTable.continueHeader) {\n                            row.ownerTable.header = false;\n                            row.ownerTable.continueHeader = false;\n                            row.ownerTable.headerHeight = 0;\n                            var pages = undefined;\n                            // if (viewer instanceof PageLayoutViewer) {\n                            pages = viewer.pages;\n                            // }\n                            if (!isNullOrUndefined(pages)) {\n                                for (var i = 0; i < pages.length; i++) {\n                                    if (pages[i].repeatHeaderRowTableWidget) {\n                                        pages[i].repeatHeaderRowTableWidget = false;\n                                    }\n                                }\n                            }\n                        }\n                    }\n                    else {\n                        if ((heightType === 'Auto' || heightType === 'AtLeast') && isAllowBreakAcrossPages) {\n                            // tslint:disable-next-line:max-line-length\n                            if (!(HelperMethods.convertPointToPixel(row.rowFormat.height) > viewer.clientArea.bottom) || tableRowWidget.y === viewer.clientArea.y) {\n                                splittedWidget = this.splitWidgets(tableRowWidget, viewer, tableWidgets, rowWidgets, splittedWidget, isLastRow);\n                            }\n                        }\n                        else if (heightType === 'Exactly' && tableRowWidget.y === viewer.clientArea.y) {\n                            this.addWidgetToTable(viewer, tableWidgets, rowWidgets, tableRowWidget);\n                            count++;\n                        }\n                    }\n                }\n                else {\n                    var isInsertSplittedWidgets = false;\n                    // Splitting handled for the merged cell with allowRowBreakAcross pages. \n                    if (this.isVerticalMergedCellContinue(row) && (isAllowBreakAcrossPages ||\n                        (isInsertSplittedWidgets = tableRowWidget.y == viewer.clientArea.y))) {\n                        if (isInsertSplittedWidgets) {\n                            this.insertSplittedCellWidgets(viewer, tableWidgets, splittedWidget, tableRowWidget.indexInOwner - 1);\n                        }\n                        else {\n                            splittedWidget = this.splitWidgets(tableRowWidget, viewer, tableWidgets, rowWidgets, splittedWidget, isLastRow);\n                        }\n                    }\n                    else if (isLastRow && !isAllowBreakAcrossPages) {\n                        splittedWidget = this.splitWidgets(tableRowWidget, viewer, tableWidgets, rowWidgets, splittedWidget, isLastRow);\n                    }\n                }\n                //Create New table for splitted widget\n                if (!isNullOrUndefined(splittedWidget)) {\n                    if (splittedWidget !== tableRowWidget) {\n                        this.addWidgetToTable(viewer, tableWidgets, rowWidgets, tableRowWidget, tableRowWidget.nextRow);\n                        //Updates the fitted table rows to current page.\n                        this.updateWidgetsToPage(tableWidgets, rowWidgets, row.ownerTable, tableRowWidget.nextRow);\n                        var index_2 = tableWidgets.indexOf(tableRowWidget.containerWidget);\n                        if (index_2 + 1 >= tableWidgets.length) {\n                            //Creates new table widget for splitted rows.\n                            this.addTableWidget(viewer.clientActiveArea, tableWidgets, true);\n                        }\n                        tableRowWidget = splittedWidget;\n                    }\n                    else {\n                        if (row.index > 0) {\n                            //Updates the fitted table rows to current page.\n                            this.updateWidgetsToPage(tableWidgets, rowWidgets, row.ownerTable, row);\n                            // Need to update on this further\n                            if (row.previousRenderedWidget instanceof TableRowWidget) {\n                                // Need to update on this further\n                                var prevWidget = row.previousRenderedWidget;\n                                if (HelperMethods.round(tableRowWidget.y, 2) === HelperMethods.round(prevWidget.y + prevWidget.height, 2)) {\n                                    var prevIndex = tableWidgets.indexOf(prevWidget.containerWidget);\n                                    if (prevIndex + 1 >= tableWidgets.length) {\n                                        //Creates new table widget for splitted rows.\n                                        this.addTableWidget(viewer.clientActiveArea, tableWidgets, true);\n                                    }\n                                }\n                                else {\n                                    //Creates new table widget for splitted rows.\n                                    this.addTableWidget(viewer.clientActiveArea, tableWidgets, true);\n                                }\n                            }\n                            else {\n                                //Creates new table widget for splitted rows.\n                                this.addTableWidget(viewer.clientActiveArea, tableWidgets, true);\n                            }\n                        }\n                        moveRowToNextTable = true;\n                        count--;\n                    }\n                    tableWidget = tableWidgets[tableWidgets.length - 1];\n                    var prevBodyWidget = undefined;\n                    if (tableWidgets.length > 1) {\n                        //Get Previous Splitted Widget container\n                        prevBodyWidget = tableWidgets[tableWidgets.length - 2].containerWidget;\n                    }\n                    else {\n                        var previousBlock = row.ownerTable.previousRenderedWidget;\n                        prevBodyWidget = previousBlock.containerWidget;\n                    }\n                    var pageIndex = 0;\n                    if (!isNullOrUndefined(prevBodyWidget)) {\n                        pageIndex = viewer.pages.indexOf(prevBodyWidget.page);\n                    }\n                    var index = row.ownerTable.containerWidget.index;\n                    var bodyWidget = void 0;\n                    var block = void 0;\n                    if (moveRowToNextTable && tableWidgets.length === 1) {\n                        block = tableWidgets[tableWidgets.length - 1];\n                    }\n                    else {\n                        block = tableWidgets[tableWidgets.length - 2];\n                    }\n                    bodyWidget = this.moveBlocksToNextPage(block);\n                    var curretTable = tableWidgets[tableWidgets.length - 1];\n                    //Move Next RowWidge to next page\n                    if (moveRowToNextTable) {\n                        // tslint:disable-next-line:max-line-length\n                        if (row.index === 0 && curretTable.containerWidget && curretTable.containerWidget.childWidgets.indexOf(curretTable) !== -1) {\n                            curretTable.containerWidget.childWidgets.splice(curretTable.containerWidget.childWidgets.indexOf(curretTable), 1);\n                        }\n                    }\n                    if (bodyWidget.childWidgets.indexOf(curretTable) !== -1) {\n                        bodyWidget.childWidgets.splice(bodyWidget.childWidgets.indexOf(curretTable), 1);\n                    }\n                    bodyWidget.childWidgets.unshift(curretTable);\n                    curretTable.containerWidget = bodyWidget;\n                    if (moveRowToNextTable && row.index > 0 || rowWidgets.length > 1) {\n                        this.moveNextWidgetsToTable(tableWidgets, rowWidgets, !moveRowToNextTable);\n                    }\n                    moveRowToNextTable = false;\n                    if (row.ownerTable.header && tableRowWidget.height < viewer.clientArea.bottom) {\n                        // if (viewer instanceof PageLayoutViewer) {\n                        viewer.currentRenderingPage.repeatHeaderRowTableWidget = true;\n                        // }\n                        //Updates table widgets location.\n                        viewer.updateClientAreaForBlock(row.ownerTable, true, tableWidgets);\n                        // tslint:disable-next-line:max-line-length\n                        //Update splitted row widget location. if header is repeated update the y position of splitted widget to header height.\n                        splittedWidget.x = splittedWidget.x;\n                        splittedWidget.y = tableWidget.y + row.ownerTable.headerHeight;\n                        // let cellspace: number = viewer instanceof PageLayoutViewer ? cellspacing / 2 : cellspacing;\n                        var cellspace = cellSpacing / 2;\n                        this.updateChildLocationForRow(tableWidget.y + row.ownerTable.headerHeight - cellspace, splittedWidget);\n                    }\n                    else {\n                        //Updates table widgets location.\n                        viewer.updateClientAreaForBlock(row.ownerTable, true, tableWidgets);\n                        // tslint:disable-next-line:max-line-length\n                        //Update splitted row widget location. if header is repeated update the y position of splitted widget to header height.\n                        splittedWidget.x = splittedWidget.x;\n                        splittedWidget.y = tableWidget.y;\n                        // let cellspace: number = viewer instanceof PageLayoutViewer ? cellspacing / 2 : cellspacing;\n                        var cellspace = cellSpacing / 2;\n                        this.updateChildLocationForRow(tableWidget.y - cellspace, splittedWidget);\n                    }\n                }\n                isLastRow = false;\n            }\n            if (isHeader && row.ownerTable.continueHeader) {\n                row.ownerTable.header = true;\n                row.ownerTable.headerHeight = rowHeight + row.ownerTable.headerHeight;\n            }\n            if (isHeader && !isNullOrUndefined(this.getHeader(row.ownerTable)) && row.index === this.getHeader(row.ownerTable).index) {\n                var headerHeight = this.getHeaderHeight(row.ownerTable, row, rowWidgets);\n                if (headerHeight > row.ownerTable.headerHeight || headerHeight > row.ownerTable.headerHeight) {\n                    row.ownerTable.headerHeight = headerHeight;\n                }\n                if (row.ownerTable.headerHeight > viewer.clientArea.height) {\n                    row.ownerTable.header = false;\n                    row.ownerTable.continueHeader = false;\n                    row.ownerTable.headerHeight = 0;\n                    var pages = viewer.pages;\n                    for (var i = 0; i < pages.length; i++) {\n                        if (pages[i].repeatHeaderRowTableWidget) {\n                            pages[i].repeatHeaderRowTableWidget = false;\n                        }\n                    }\n                }\n            }\n            if (tableWidgets.length > 2 && row.ownerTable.header && tableRowWidget.height < viewer.clientActiveArea.bottom &&\n                !viewer.currentRenderingPage.repeatHeaderRowTableWidget) {\n                viewer.currentRenderingPage.repeatHeaderRowTableWidget = true;\n            }\n        }\n    };\n    /* tslint:enable */\n    /**\n     * Gets header.\n     * @param table\n     * @private\n     */\n    Layout.prototype.getHeader = function (table) {\n        var header = undefined;\n        var flag = true;\n        table = table.getSplitWidgets()[0];\n        for (var i = 0; i < table.childWidgets.length; i++) {\n            var row = table.childWidgets[i];\n            if (row.rowFormat.isHeader) {\n                header = row;\n            }\n            else {\n                flag = false;\n            }\n            if (!flag) {\n                break;\n            }\n        }\n        return header;\n    };\n    /**\n     * Gets header height.\n     * @param ownerTable\n     * @param row\n     */\n    Layout.prototype.getHeaderHeight = function (ownerTable, row, rowCollection) {\n        var height = 0;\n        if (row.ownerTable.childWidgets.length > 0 && ownerTable.childWidgets[0].rowFormat.isHeader) {\n            for (var i = 0; i < ownerTable.childWidgets.length; i++) {\n                var row_1 = ownerTable.childWidgets[i];\n                if (row_1.rowFormat.isHeader) {\n                    height = height + this.getRowHeight(row_1, rowCollection);\n                }\n                else {\n                    break;\n                }\n            }\n        }\n        return height;\n    };\n    /**\n     * Updates widgets to row.\n     * @param cell\n     */\n    Layout.prototype.updateWidgetToRow = function (cell) {\n        var viewer = this.viewer;\n        //Adds table cell widget to owner row widget.\n        var rowWidget = cell.ownerRow;\n        var cellLeft = rowWidget.x;\n        if (rowWidget.childWidgets.length > 0) {\n            var lastWidget = rowWidget.childWidgets[rowWidget.childWidgets.length - 1];\n            cellLeft = lastWidget.x + lastWidget.width + lastWidget.margin.right;\n        }\n        // rowWidget.childWidgets.push(cell);\n        cell.containerWidget = rowWidget;\n        //If the row height is set as Atleast then height is set to atleast height for the first cell of the row.\n        // tslint:disable-next-line:max-line-length\n        if (!isNullOrUndefined(cell.ownerRow) && cell.ownerRow.rowFormat.heightType !== 'Exactly' && HelperMethods.convertPointToPixel(cell.ownerRow.rowFormat.height) > 0 && cell.cellIndex === 0) {\n            rowWidget.height = rowWidget.height + HelperMethods.convertPointToPixel(cell.ownerRow.rowFormat.height);\n        }\n        //Add condition not cell merged vertically.\n        if (cell.cellFormat.rowSpan === 1) {\n            var cellHeight = cell.height + cell.margin.top + cell.margin.bottom;\n            if (rowWidget.height - HelperMethods.convertPointToPixel(cell.ownerTable.tableFormat.cellSpacing) < cellHeight) {\n                rowWidget.height = cellHeight + HelperMethods.convertPointToPixel(cell.ownerTable.tableFormat.cellSpacing);\n            }\n        }\n    };\n    /**\n     * Updates height for row widget.\n     * @param viewer\n     * @param isUpdateVerticalPosition\n     * @param rowWidget\n     */\n    // tslint:disable-next-line:max-line-length\n    Layout.prototype.updateHeightForRowWidget = function (viewer, isUpdateVerticalPosition, tableCollection, rowCollection, rowWidget, isLayouted, endRowWidget) {\n        for (var i = 0; i < rowWidget.childWidgets.length; i++) {\n            var cellspacing = 0;\n            var cellWidget = undefined;\n            var childWidget = rowWidget.childWidgets[i];\n            // if (childWidget instanceof TableCellWidget) {\n            cellWidget = childWidget;\n            // }\n            var rowSpan = 1;\n            rowSpan = cellWidget.cellFormat.rowSpan;\n            cellspacing = HelperMethods.convertPointToPixel(cellWidget.ownerTable.tableFormat.cellSpacing);\n            if (rowSpan > 1) {\n                var currentRowWidgetIndex = rowWidget.containerWidget.childWidgets.indexOf(rowWidget);\n                // tslint:disable-next-line:max-line-length\n                var rowSpanWidgetEndIndex = currentRowWidgetIndex + rowSpan - 1 - (rowWidget.index - cellWidget.rowIndex);\n                if (viewer.clientArea.bottom < cellWidget.y + cellWidget.height + cellWidget.margin.bottom\n                    || rowSpanWidgetEndIndex >= currentRowWidgetIndex + 1) {\n                    this.splitSpannedCellWidget(cellWidget, tableCollection, rowCollection, viewer);\n                }\n                var spanEndRowWidget = rowWidget;\n                if (rowSpanWidgetEndIndex > 0) {\n                    if (rowSpanWidgetEndIndex < rowWidget.containerWidget.childWidgets.length) {\n                        var childWidget_1 = rowWidget.containerWidget.childWidgets[rowSpanWidgetEndIndex];\n                        if (childWidget_1 instanceof TableRowWidget) {\n                            spanEndRowWidget = childWidget_1;\n                            if (spanEndRowWidget === endRowWidget) {\n                                spanEndRowWidget = rowWidget;\n                            }\n                        }\n                    }\n                    else {\n                        // tslint:disable-next-line:max-line-length\n                        spanEndRowWidget = rowWidget.containerWidget.childWidgets[rowWidget.containerWidget.childWidgets.length - 1];\n                    }\n                }\n                if (cellWidget.y + cellWidget.height + cellWidget.margin.bottom < spanEndRowWidget.y + spanEndRowWidget.height) {\n                    cellWidget.height = spanEndRowWidget.y + spanEndRowWidget.height - cellWidget.y - cellWidget.margin.bottom;\n                    // tslint:disable-next-line:max-line-length\n                }\n                else if (isLayouted && spanEndRowWidget && (spanEndRowWidget.y !== 0 && spanEndRowWidget.height !== 0) && cellWidget.y + cellWidget.height + cellWidget.margin.bottom > spanEndRowWidget.y + spanEndRowWidget.height) {\n                    spanEndRowWidget.height = cellWidget.y + cellWidget.height + cellWidget.margin.bottom - spanEndRowWidget.y;\n                    // tslint:disable-next-line:max-line-length\n                    //Update the next rowlayout widget location. Reason for the updation is previous row height is updated when cell height is greater. So already layouted next row location has to be updated again.\n                    // if (rowWidget === spanEndRowWidget && rowWidget.nextWidget instanceof TableRowWidget) {\n                    //     let nextRow: TableRowWidget = rowWidget.nextWidget as TableRowWidget;\n                    //     // Need to update on this further\n                    //     // if (viewer.renderedElements.containsKey(nextRow)) {\n                    //     //     let nextWidget: TableRowWidget[] = viewer.renderedElements.get(nextRow) as TableRowWidget[];\n                    //     //     if (nextWidget.length > 0) {\n                    //     //         nextWidget[0].x = nextWidget[0].x;\n                    //     //         nextWidget[0].y = rowWidget.y + rowWidget.height;\n                    //     //     }\n                    //     // }\n                    // }\n                }\n            }\n            else {\n                if (cellspacing > 0) {\n                    // In the Case of tableWidget is greater than one and rowWidget is start at the Top Position of the page. \n                    // In such case we have update the cell height with half of cell spacing.\n                    // Remaining cases we have to update the entire hight\n                    // tslint:disable-next-line:max-line-length\n                    if (tableCollection.length > 1 && rowWidget.y === viewer.clientArea.y && viewer instanceof PageLayoutViewer) {\n                        cellspacing = cellspacing / 2;\n                    }\n                }\n                cellWidget.height = rowWidget.height - cellWidget.margin.top - cellWidget.margin.bottom - cellspacing;\n            }\n            this.updateHeightForCellWidget(viewer, tableCollection, rowCollection, cellWidget);\n            var widget = rowWidget.containerWidget;\n            while (widget.containerWidget instanceof Widget) {\n                widget = widget.containerWidget;\n            }\n            var page = undefined;\n            if (widget instanceof BodyWidget) {\n                page = widget.page;\n            }\n            // tslint:disable-next-line:max-line-length\n            if ((viewer instanceof PageLayoutViewer && viewer.visiblePages.indexOf(page) !== -1) || isUpdateVerticalPosition) {\n                this.updateCellVerticalPosition(cellWidget, false, false);\n            }\n            //Renders the current table row contents, after relayout based on editing.\n            // if (viewer instanceof PageLayoutViewer && (viewer as PageLayoutViewer).visiblePages.indexOf(page) !== -1) {\n            //     //Added proper undefined condition check for Asynchronous operation.\n            //     if (!isNullOrUndefined(rowWidget.tableRow) && !isNullOrUndefined(rowWidget.tableRow.rowFormat)) {\n            //         this.viewer.updateScrollBars();\n            //         //this.render.renderTableCellWidget(page, cellWidget);\n            //     }\n            // }\n        }\n    };\n    /**\n     * Updates height for cell widget.\n     * @param viewer\n     * @param cellWidget\n     */\n    // tslint:disable-next-line:max-line-length\n    Layout.prototype.updateHeightForCellWidget = function (viewer, tableWidget, rowCollection, cellWidget) {\n        for (var i = 0; i < cellWidget.childWidgets.length; i++) {\n            if (cellWidget.childWidgets[i] instanceof TableWidget) {\n                this.updateHeightForTableWidget(tableWidget, rowCollection, cellWidget.childWidgets[i]);\n            }\n        }\n    };\n    /**\n     * Gets row height.\n     * @param row\n     * @private\n     */\n    Layout.prototype.getRowHeight = function (row, rowCollection) {\n        var height = 0;\n        if (row.rowFormat.heightType === 'Exactly') {\n            height = row.rowFormat.height;\n        }\n        else {\n            for (var i = 0; i < rowCollection.length; i++) {\n                if (rowCollection[i] instanceof TableRowWidget) {\n                    height = rowCollection[i].height + height;\n                }\n            }\n            height = Math.max(height, row.rowFormat.height);\n        }\n        return height;\n    };\n    /**\n     * splits spanned cell widget.\n     * @param cellWidget\n     * @param viewer\n     */\n    // tslint:disable-next-line:max-line-length\n    Layout.prototype.splitSpannedCellWidget = function (cellWidget, tableCollection, rowCollection, viewer) {\n        var splittedCell = this.getSplittedWidget(viewer.clientArea.bottom, false, tableCollection, rowCollection, cellWidget);\n        if (!isNullOrUndefined(splittedCell)) {\n            //Adds the splitted contents of a vertical merged cell, in order preserve in next page.\n            viewer.splittedCellWidgets.push(splittedCell);\n        }\n    };\n    /**\n     * Inserts splitted cell widgets.\n     * @param viewer\n     * @param rowWidget\n     */\n    // tslint:disable-next-line:max-line-length\n    Layout.prototype.insertSplittedCellWidgets = function (viewer, tableCollection, rowWidget, previousRowIndex) {\n        var left = rowWidget.x;\n        var tableWidth = 0;\n        tableWidth = HelperMethods.convertPointToPixel(rowWidget.ownerTable.tableHolder.tableWidth);\n        for (var i = 0; i < rowWidget.childWidgets.length; i++) {\n            var cellWidget = rowWidget.childWidgets[i];\n            if (Math.round(left) < Math.round(cellWidget.x - cellWidget.margin.left)) {\n                if (this.insertRowSpannedWidget(rowWidget, viewer, left, i)) {\n                    i--;\n                    continue;\n                }\n                var length_1 = rowWidget.childWidgets.length;\n                this.insertEmptySplittedCellWidget(rowWidget, tableCollection, left, i, previousRowIndex);\n                if (length_1 < rowWidget.childWidgets.length) {\n                    i--;\n                    continue;\n                }\n            }\n            left += cellWidget.margin.left + cellWidget.width + cellWidget.margin.right;\n            if (i === rowWidget.childWidgets.length - 1 && Math.round(left) < Math.round(rowWidget.x + tableWidth)) {\n                if (this.insertRowSpannedWidget(rowWidget, viewer, left, i + 1)) {\n                    continue;\n                }\n                this.insertEmptySplittedCellWidget(rowWidget, tableCollection, left, i + 1, previousRowIndex);\n                continue;\n            }\n        }\n        // tslint:disable-next-line:max-line-length\n        // Special case: when the child widgets of row is equal to 0 then the splitted widgets in the viewer is added in the table row widgets. \n        if ((isNullOrUndefined(rowWidget.childWidgets) || rowWidget.childWidgets.length === 0) && viewer.splittedCellWidgets.length > 0) {\n            for (var j = 0; j < viewer.splittedCellWidgets.length; j++) {\n                var widget = viewer.splittedCellWidgets[j];\n                if (Math.round(left) <= Math.round(widget.x - widget.margin.left)) {\n                    if (this.insertRowSpannedWidget(rowWidget, viewer, left, j)) {\n                        j--;\n                        continue;\n                    }\n                    var count = rowWidget.childWidgets.length;\n                    this.insertEmptySplittedCellWidget(rowWidget, tableCollection, left, j, previousRowIndex);\n                    if (count < rowWidget.childWidgets.length) {\n                        j--;\n                        continue;\n                    }\n                }\n                left += widget.margin.left + widget.width + widget.margin.right;\n                if (j === rowWidget.childWidgets.length - 1 && Math.round(left) <\n                    Math.round(rowWidget.x + tableWidth)) {\n                    if (this.insertRowSpannedWidget(rowWidget, viewer, left, j + 1)) {\n                        continue;\n                    }\n                    this.insertEmptySplittedCellWidget(rowWidget, tableCollection, left, j + 1, previousRowIndex);\n                    continue;\n                }\n            }\n        }\n        if (viewer.splittedCellWidgets.length > 0) {\n            viewer.splittedCellWidgets = [];\n        }\n    };\n    /**\n     * Inserts spanned row widget.\n     * @param rowWidget\n     * @param viewer\n     * @param left\n     * @param index\n     */\n    Layout.prototype.insertRowSpannedWidget = function (rowWidget, viewer, left, index) {\n        var cellSpacing = 0;\n        if (rowWidget.ownerTable.tableFormat.cellSpacing > 0) {\n            cellSpacing = HelperMethods.convertPointToPixel(rowWidget.ownerTable.tableFormat.cellSpacing);\n        }\n        for (var i = 0; i < viewer.splittedCellWidgets.length; i++) {\n            var splittedCell = viewer.splittedCellWidgets[i];\n            if (Math.round(left) === Math.round(splittedCell.x - splittedCell.margin.left)) {\n                rowWidget.childWidgets.splice(index, 0, splittedCell);\n                splittedCell.containerWidget = rowWidget;\n                //If the splitted cell location differs from expected location update the location of row child widgets.\n                if (splittedCell.y !== rowWidget.y + splittedCell.margin.top + cellSpacing) {\n                    this.updateChildLocationForRow(rowWidget.y, rowWidget);\n                }\n                viewer.splittedCellWidgets = [];\n                return true;\n            }\n        }\n        return false;\n    };\n    /**\n     * Inserts empty splitted cell widgets.\n     * @param rowWidget\n     * @param left\n     * @param index\n     */\n    // tslint:disable-next-line:max-line-length\n    Layout.prototype.insertEmptySplittedCellWidget = function (currentRow, tableCollection, left, index, previousRowIndex) {\n        var tableWidget = tableCollection[tableCollection.length - 1];\n        for (var i = previousRowIndex; i >= 0; i--) {\n            var rowWidget = tableWidget.childWidgets[i];\n            var previousLeft = rowWidget.x;\n            for (var j = 0; j < rowWidget.childWidgets.length; j++) {\n                var rowSpan = 1;\n                var cellWidget = rowWidget.childWidgets[j];\n                if (Math.round(left) === Math.round(previousLeft)) {\n                    rowSpan = (isNullOrUndefined(cellWidget) || isNullOrUndefined(cellWidget.cellFormat)) ? rowSpan :\n                        cellWidget.cellFormat.rowSpan;\n                    if (rowSpan > 1) {\n                        var emptyCellWidget = this.createCellWidget(cellWidget);\n                        currentRow.childWidgets.splice(index, 0, emptyCellWidget);\n                        emptyCellWidget.containerWidget = currentRow;\n                    }\n                    return;\n                }\n                previousLeft += cellWidget.margin.left + cellWidget.width + cellWidget.margin.right;\n            }\n        }\n    };\n    /**\n     * Gets spllited widget.\n     * @param bottom\n     * @param splitMinimalWidget\n     * @param cellWidget\n     */\n    // tslint:disable-next-line:max-line-length\n    Layout.prototype.getSplittedWidget = function (bottom, splitMinimalWidget, tableCollection, rowCollection, cellWidget) {\n        var splittedWidget = undefined;\n        if (cellWidget.y + cellWidget.height > bottom - cellWidget.margin.bottom) {\n            for (var i = 0; i < cellWidget.childWidgets.length; i++) {\n                if (cellWidget.childWidgets[i] instanceof ParagraphWidget) {\n                    var paragraphWidget = cellWidget.childWidgets[i];\n                    var splittedPara = this.getSplittedWidgetForPara(bottom - cellWidget.margin.bottom, paragraphWidget);\n                    if (!isNullOrUndefined(splittedPara)) {\n                        if (i === 0 && splittedPara === paragraphWidget) {\n                            //Returns if the whole content of the cell does not fit in current page.\n                            return cellWidget;\n                        }\n                        if (cellWidget.childWidgets.indexOf(splittedPara) !== -1) {\n                            cellWidget.childWidgets.splice(cellWidget.childWidgets.indexOf(splittedPara), 1);\n                            i--;\n                        }\n                        cellWidget.height -= splittedPara.height;\n                        if (isNullOrUndefined(splittedWidget)) {\n                            //Creates new widget, to hold the splitted contents.\n                            splittedWidget = this.createCellWidget(cellWidget);\n                        }\n                        splittedWidget.height += splittedPara.height;\n                        splittedWidget.childWidgets.push(splittedPara);\n                        splittedPara.containerWidget = splittedWidget;\n                    }\n                }\n                else {\n                    var tableWidget = cellWidget.childWidgets[i];\n                    var tableCol = [tableWidget];\n                    //Check for nested table.\n                    if (bottom - cellWidget.margin.bottom < tableWidget.y + tableWidget.height) {\n                        var tableHeight = tableWidget.height;\n                        // tslint:disable-next-line:max-line-length\n                        var splittedTable = this.getSplittedWidgetForTable(bottom - cellWidget.margin.bottom, tableCol, tableWidget);\n                        if (!isNullOrUndefined(splittedTable)) {\n                            if (i === 0 && splittedTable === tableWidget) {\n                                //Returns if the whole table does not fit in current page.\n                                return cellWidget;\n                            }\n                            if (cellWidget.childWidgets.indexOf(splittedTable) !== -1) {\n                                cellWidget.childWidgets.splice(cellWidget.childWidgets.indexOf(splittedTable), 1);\n                                i--;\n                                cellWidget.height -= splittedTable.height;\n                            }\n                            else {\n                                cellWidget.height -= tableHeight - tableWidget.height;\n                            }\n                            if (isNullOrUndefined(splittedWidget)) {\n                                //Creates new widget, to hold the splitted contents.\n                                splittedWidget = this.createCellWidget(cellWidget);\n                            }\n                            splittedWidget.height += splittedTable.height;\n                            splittedWidget.childWidgets.push(splittedTable);\n                            splittedTable.containerWidget = splittedWidget;\n                        }\n                    }\n                }\n            }\n        }\n        if (isNullOrUndefined(splittedWidget) && splitMinimalWidget) {\n            //Creates new widget, to hold the splitted contents.\n            splittedWidget = this.createCellWidget(cellWidget);\n        }\n        return splittedWidget;\n    };\n    /**\n     * Gets list level pattern\n     * @param value\n     * @private\n     */\n    Layout.prototype.getListLevelPattern = function (value) {\n        switch (value) {\n            case 0:\n                return 'Arabic';\n            case 1:\n                return 'UpRoman';\n            case 2:\n                return 'LowRoman';\n            case 3:\n                return 'UpLetter';\n            case 4:\n                return 'LowLetter';\n            case 5:\n                return 'Ordinal';\n            case 6:\n                return 'Number';\n            case 7:\n                return 'OrdinalText';\n            case 8:\n                return 'LeadingZero';\n            case 9:\n                return 'Bullet';\n            case 10:\n                return 'FarEast';\n            case 11:\n                return 'Special';\n            default:\n                return 'None';\n        }\n    };\n    /**\n     * Creates cell widget.\n     * @param cell\n     */\n    Layout.prototype.createCellWidget = function (cell) {\n        var cellWidget = new TableCellWidget();\n        cellWidget.cellFormat = cell.cellFormat;\n        cellWidget.index = cell.index;\n        cellWidget.rowIndex = cell.rowIndex;\n        cellWidget.columnIndex = cell.columnIndex;\n        cellWidget.containerWidget = cell.containerWidget;\n        this.updateWidgetLocation(cell, cellWidget);\n        cellWidget.margin = cell.margin;\n        cellWidget.leftBorderWidth = HelperMethods.convertPointToPixel(cell.leftBorderWidth);\n        cellWidget.rightBorderWidth = HelperMethods.convertPointToPixel(cell.rightBorderWidth);\n        return cellWidget;\n    };\n    /**\n     * Create Table Widget\n     */\n    Layout.prototype.createTableWidget = function (table) {\n        var newTable = new TableWidget();\n        if (table.header) {\n            newTable.header = table.header;\n            newTable.headerHeight = table.headerHeight;\n        }\n        newTable.index = table.index;\n        newTable.tableFormat = table.tableFormat;\n        newTable.tableHolder = table.tableHolder;\n        newTable.isGridUpdated = table.isGridUpdated;\n        return newTable;\n    };\n    /**\n     * Gets splitted widget for paragraph.\n     * @param bottom\n     * @param paragraphWidget\n     */\n    Layout.prototype.getSplittedWidgetForPara = function (bottom, paragraphWidget) {\n        var lineBottom = paragraphWidget.y;\n        var splittedWidget = undefined;\n        for (var i = 0; i < paragraphWidget.childWidgets.length; i++) {\n            var lineWidget = paragraphWidget.childWidgets[i];\n            if (bottom < lineBottom + lineWidget.height) {\n                if (i === 0) {\n                    if (lineWidget.paragraph.containerWidget instanceof TableCellWidget) {\n                        //checks first line of the page is exceed the page height\n                        if (lineWidget.paragraph.containerWidget.y === paragraphWidget.y) {\n                            lineBottom += lineWidget.height;\n                            continue;\n                        }\n                    }\n                    splittedWidget = paragraphWidget;\n                    break;\n                }\n                if (paragraphWidget.childWidgets.indexOf(lineWidget) !== -1) {\n                    paragraphWidget.childWidgets.splice(paragraphWidget.childWidgets.indexOf(lineWidget), 1);\n                    i--;\n                }\n                paragraphWidget.height -= lineWidget.height;\n                if (isNullOrUndefined(splittedWidget)) {\n                    //Creates new widget, to hold the splitted contents.\n                    splittedWidget = new ParagraphWidget();\n                    splittedWidget.characterFormat = paragraphWidget.characterFormat;\n                    splittedWidget.paragraphFormat = paragraphWidget.paragraphFormat;\n                    splittedWidget.index = paragraphWidget.index;\n                    this.updateWidgetLocation(paragraphWidget, splittedWidget);\n                    splittedWidget.height = lineWidget.height;\n                }\n                else {\n                    splittedWidget.height += lineWidget.height;\n                }\n                splittedWidget.childWidgets.push(lineWidget);\n                lineWidget.paragraph = splittedWidget;\n            }\n            lineBottom += lineWidget.height;\n        }\n        return splittedWidget;\n    };\n    /**\n     * Gets splitted table widget.\n     * @param bottom\n     * @param tableWidget\n     * @private\n     */\n    // tslint:disable-next-line:max-line-length\n    Layout.prototype.getSplittedWidgetForTable = function (bottom, tableCollection, tableWidget) {\n        var rowBottom = tableWidget.y;\n        var splittedWidget = undefined;\n        for (var i = 0; i < tableWidget.childWidgets.length; i++) {\n            var rowWidget = undefined;\n            var childWidget = tableWidget.childWidgets[i];\n            // if (childWidget instanceof TableRowWidget) {\n            rowWidget = childWidget;\n            // }\n            var rowHeight = rowWidget.height;\n            if (bottom < rowBottom + rowHeight || !isNullOrUndefined(splittedWidget)) {\n                //ToDo: Check whether row included in vertical merge or AllowRowSplitbyPage is true, if so split row.\n                //Checks if atleast first line fits in the client area.                \n                var splittedRow = undefined;\n                var allowRowBreakAcrossPages = true;\n                if (!isNullOrUndefined(rowWidget) && !isNullOrUndefined(rowWidget.rowFormat)) {\n                    allowRowBreakAcrossPages = rowWidget.rowFormat.allowBreakAcrossPages;\n                }\n                if (allowRowBreakAcrossPages) {\n                    // tslint:disable-next-line:max-line-length\n                    splittedRow = (isNullOrUndefined(splittedWidget) && this.isFirstLineFitForRow(bottom, rowWidget)) ? this.getSplittedWidgetForRow(bottom, tableCollection, [rowWidget], rowWidget) : rowWidget;\n                }\n                if (!isNullOrUndefined(splittedRow)) {\n                    if (i === 0 && splittedRow === rowWidget) {\n                        //Returns if the whole table does not fit in current page.\n                        return tableWidget;\n                    }\n                    if (tableWidget.childWidgets.indexOf(splittedRow) !== -1) {\n                        tableWidget.childWidgets.splice(tableWidget.childWidgets.indexOf(splittedRow), 1);\n                        i--;\n                        tableWidget.height -= splittedRow.height;\n                    }\n                    else {\n                        tableWidget.height -= rowHeight - rowWidget.height;\n                    }\n                    if (isNullOrUndefined(splittedWidget)) {\n                        //Creates new widget, to hold the splitted contents.\n                        splittedWidget = this.createTableWidget(tableWidget);\n                        this.updateWidgetLocation(tableWidget, splittedWidget);\n                        splittedWidget.height = splittedRow.height;\n                    }\n                    else {\n                        splittedWidget.height += splittedRow.height;\n                    }\n                    splittedWidget.childWidgets.push(splittedRow);\n                    splittedRow.containerWidget = splittedWidget;\n                }\n            }\n            rowBottom += rowWidget.height;\n        }\n        return splittedWidget;\n    };\n    /**\n     * Checks whether first line fits for paragraph or not.\n     * @param bottom\n     * @param paraWidget\n     */\n    Layout.prototype.isFirstLineFitForPara = function (bottom, paraWidget) {\n        var lineWidget = paraWidget.childWidgets[0];\n        var cellwidget = lineWidget.paragraph.containerWidget;\n        // let document: WordDocument = undefined;\n        // if (!isNullOrUndefined(lineWidget.paragraph.currentNode) && !isNullOrUndefined(cellwidget.containerWidget)) {\n        //     document = WordDocument.getDocumentOf(lineWidget.paragraph.currentNode);\n        // }\n        //checks first line of the page is exceed the page height\n        if (this.viewer.isFirstLineFitInShiftWidgets) {\n            if (this.viewer.clientActiveArea.y === this.viewer.clientArea.y && paraWidget.y + lineWidget.height >= bottom) {\n                return true;\n            }\n        }\n        else {\n            // For nested tables,\n            if (cellwidget.ownerTable.isInsideTable) {\n                // Gets the container cell widgets, consider it as client area for the cell widget.\n                var containerCellWidget = undefined;\n                if (cellwidget.containerWidget instanceof TableRowWidget &&\n                    cellwidget.containerWidget.containerWidget instanceof TableWidget\n                    && cellwidget.containerWidget.containerWidget.containerWidget instanceof TableCellWidget) {\n                    containerCellWidget = cellwidget.containerWidget.containerWidget.containerWidget;\n                }\n                if (!isNullOrUndefined(containerCellWidget) && cellwidget.containerWidget.y === containerCellWidget.y\n                    && paraWidget.y + lineWidget.height >= bottom) {\n                    return true;\n                }\n            }\n            else if (cellwidget.containerWidget.y === this.viewer.clientArea.y && paraWidget.y + lineWidget.height >= bottom) {\n                return true;\n            }\n        }\n        return (paraWidget.y + lineWidget.height <= bottom);\n    };\n    /**\n     * Checks whether first line fits for table or not.\n     * @param bottom\n     * @param tableWidget\n     * @private\n     */\n    Layout.prototype.isFirstLineFitForTable = function (bottom, tableWidget) {\n        var rowWidget = undefined;\n        var isFit = false;\n        var childWidget = tableWidget.childWidgets[0];\n        // if (childWidget instanceof TableRowWidget) {\n        rowWidget = childWidget;\n        // }\n        if (!isNullOrUndefined(rowWidget)) {\n            isFit = this.isFirstLineFitForRow(bottom, rowWidget);\n        }\n        return isFit;\n    };\n    /**\n     * Checks whether first line fits for row or not.\n     * @param bottom\n     * @param rowWidget\n     */\n    Layout.prototype.isFirstLineFitForRow = function (bottom, rowWidget) {\n        for (var i = 0; i < rowWidget.childWidgets.length; i++) {\n            var cellWidget = rowWidget.childWidgets[i];\n            if (!this.isFirstLineFitForCell(bottom, cellWidget)) {\n                return false;\n            }\n        }\n        return true;\n    };\n    /**\n     * Checks whether first line fits for cell or not.\n     * @param bottom\n     * @param cellWidget\n     */\n    Layout.prototype.isFirstLineFitForCell = function (bottom, cellWidget) {\n        if (cellWidget.childWidgets.length === 0) {\n            return true;\n        }\n        if (cellWidget.childWidgets[0] instanceof ParagraphWidget) {\n            var paraWidget = cellWidget.childWidgets[0];\n            return this.isFirstLineFitForPara(bottom - cellWidget.margin.bottom, paraWidget);\n        }\n        else {\n            var tableWidget = cellWidget.childWidgets[0];\n            return this.isFirstLineFitForTable(bottom - cellWidget.margin.bottom, tableWidget);\n        }\n    };\n    /**\n     * Updates widget location.\n     * @param widget\n     * @param table\n     */\n    Layout.prototype.updateWidgetLocation = function (widget, table) {\n        table.x = widget.x;\n        table.y = widget.y;\n        table.width = widget.width;\n    };\n    /**\n     * Updates child location for table.\n     * @param top\n     * @param tableWidget\n     * @private\n     */\n    Layout.prototype.updateChildLocationForTable = function (top, tableWidget) {\n        for (var i = 0; i < tableWidget.childWidgets.length; i++) {\n            var rowWidget = tableWidget.childWidgets[i];\n            rowWidget.x = rowWidget.x;\n            rowWidget.y = top;\n            this.updateChildLocationForRow(top, rowWidget);\n            top += rowWidget.height;\n        }\n    };\n    /**\n     * Updates child location for row.\n     * @param top\n     * @param rowWidget\n     * @private\n     */\n    Layout.prototype.updateChildLocationForRow = function (top, rowWidget) {\n        var spacing = 0;\n        if (rowWidget.ownerTable.tableFormat.cellSpacing > 0) {\n            spacing = HelperMethods.convertPointToPixel(rowWidget.ownerTable.tableFormat.cellSpacing);\n        }\n        for (var i = 0; i < rowWidget.childWidgets.length; i++) {\n            var cellWidget = rowWidget.childWidgets[i];\n            cellWidget.x = cellWidget.x;\n            cellWidget.y = top + cellWidget.margin.top + spacing;\n            this.updateChildLocationForCell(cellWidget.y, cellWidget);\n        }\n    };\n    /**\n     * Updates child location for cell.\n     * @param top\n     * @param cellWidget\n     */\n    Layout.prototype.updateChildLocationForCell = function (top, cellWidget) {\n        for (var i = 0; i < cellWidget.childWidgets.length; i++) {\n            cellWidget.childWidgets[i].x = cellWidget.childWidgets[i].x;\n            cellWidget.childWidgets[i].y = top;\n            if (cellWidget.childWidgets[i] instanceof TableWidget) {\n                this.updateChildLocationForTable(top, cellWidget.childWidgets[i]);\n            }\n            top += cellWidget.childWidgets[i].height;\n        }\n    };\n    /**\n     * Updates cell vertical position.\n     * @param cellWidget\n     * @param isUpdateToTop\n     * @param isInsideTable\n     * @private\n     */\n    Layout.prototype.updateCellVerticalPosition = function (cellWidget, isUpdateToTop, isInsideTable) {\n        if (cellWidget.ownerTable.containerWidget instanceof BodyWidget || isInsideTable) {\n            var displacement = this.getDisplacement(cellWidget, isUpdateToTop);\n            //Update Y position alone for the child widget of cell\n            this.updateCellContentVerticalPosition(cellWidget, displacement, isUpdateToTop);\n        }\n    };\n    /**\n     * Updates cell content vertical position.\n     * @param cellWidget\n     * @param displacement\n     * @param isUpdateToTop\n     */\n    Layout.prototype.updateCellContentVerticalPosition = function (cellWidget, displacement, isUpdateToTop) {\n        if (displacement === 0) {\n            return;\n        }\n        var location = cellWidget.y + displacement;\n        for (var i = 0; i < cellWidget.childWidgets.length; i++) {\n            if (cellWidget.childWidgets[i] instanceof ParagraphWidget) {\n                cellWidget.childWidgets[i].y = location;\n            }\n            else {\n                location = this.updateTableWidgetLocation(cellWidget.childWidgets[i], location, isUpdateToTop);\n            }\n            location = location + cellWidget.childWidgets[i].height;\n        }\n    };\n    /**\n     * Updates table widget location.\n     * @param tableWidget\n     * @param location\n     * @param isUpdateToTop\n     */\n    Layout.prototype.updateTableWidgetLocation = function (tableWidget, location, isUpdateToTop) {\n        tableWidget.y = location = location + tableWidget.topBorderWidth;\n        var cellSpacing = 0;\n        for (var i = 0; i < tableWidget.childWidgets.length; i++) {\n            var rowWidget = tableWidget.childWidgets[i];\n            rowWidget.y = location;\n            for (var j = 0; j < rowWidget.childWidgets.length; j++) {\n                var cellWidget = rowWidget.childWidgets[j];\n                cellWidget.y = location + cellWidget.margin.top + cellSpacing;\n                this.updateCellVerticalPosition(cellWidget, isUpdateToTop, true);\n            }\n            location = location + rowWidget.height;\n        }\n        return location;\n    };\n    /**\n     * Gets displacement.\n     * @param cellWidget\n     * @param isUpdateToTop\n     */\n    Layout.prototype.getDisplacement = function (cellWidget, isUpdateToTop) {\n        //Gets the height of row\n        var rowHeight = 0;\n        var rowWidget = cellWidget.containerWidget;\n        var padding = cellWidget.margin.top + cellWidget.margin.bottom;\n        if (!isNullOrUndefined(cellWidget.cellFormat) && cellWidget.cellFormat.rowSpan > 1) {\n            rowHeight = cellWidget.height;\n        }\n        else {\n            rowHeight = ((!isNullOrUndefined(rowWidget) ? rowWidget.height : 0) - padding);\n        }\n        //Gets the height of content within the cell\n        var cellContentHeight = this.getCellContentHeight(cellWidget);\n        //Displacement field holds the value which has reduced from rowHeight and cellContentHeight\n        var displacement = 0;\n        if (rowHeight > cellContentHeight) {\n            displacement = rowHeight - cellContentHeight;\n            if (cellWidget.cellFormat.verticalAlignment === 'Center') {\n                displacement = displacement / 2;\n            }\n            else if ((cellWidget.cellFormat.verticalAlignment === 'Top' || isUpdateToTop)) {\n                displacement = 0;\n            }\n        }\n        return displacement;\n    };\n    /**\n     * Gets cell content height.\n     * @param cellWidget\n     */\n    Layout.prototype.getCellContentHeight = function (cellWidget) {\n        if (isNullOrUndefined(cellWidget.childWidgets)) {\n            return 0;\n        }\n        var contentHeight = 0;\n        for (var i = 0; i < cellWidget.childWidgets.length; i++) {\n            if (cellWidget.childWidgets[i] instanceof ParagraphWidget) {\n                contentHeight += cellWidget.childWidgets[i].height;\n            }\n            else {\n                contentHeight += cellWidget.childWidgets[i].height;\n            }\n        }\n        return contentHeight;\n    };\n    /**\n     * Gets table left borders.\n     * @param borders\n     * @private\n     */\n    Layout.prototype.getTableLeftBorder = function (borders) {\n        if (!isNullOrUndefined(borders.left)) {\n            return borders.left;\n        }\n        else {\n            var border = new WBorder(borders);\n            border.lineStyle = 'Single';\n            border.lineWidth = 0.66;\n            return border;\n        }\n    };\n    /**\n     * Gets table right border.\n     * @param borders\n     * @private\n     */\n    Layout.prototype.getTableRightBorder = function (borders) {\n        if (!isNullOrUndefined(borders.right)) {\n            return borders.right;\n        }\n        else {\n            var border = new WBorder(borders);\n            border.lineStyle = 'Single';\n            border.lineWidth = 0.66;\n            return border;\n        }\n    };\n    /**\n     * Get table top border.\n     * @param borders\n     * @private\n     */\n    Layout.prototype.getTableTopBorder = function (borders) {\n        if (!isNullOrUndefined(borders.top)) {\n            return borders.top;\n        }\n        else {\n            var border = new WBorder(borders);\n            border.lineStyle = 'Single';\n            border.lineWidth = 0.66;\n            return border;\n        }\n    };\n    /**\n     * Gets table bottom border.\n     * @param borders\n     * @private\n     */\n    Layout.prototype.getTableBottomBorder = function (borders) {\n        if (!isNullOrUndefined(borders.bottom)) {\n            return borders.bottom;\n        }\n        else {\n            var border = new WBorder(borders);\n            border.lineStyle = 'Single';\n            border.lineWidth = 0.66;\n            return border;\n        }\n    };\n    /**\n     * Get diagonal cell up border.\n     * @param tableCell\n     * @private\n     */\n    Layout.prototype.getCellDiagonalUpBorder = function (tableCell) {\n        var diagonalUpBorder = undefined;\n        var cellBorder = undefined;\n        cellBorder = tableCell.cellFormat.borders;\n        diagonalUpBorder = cellBorder.diagonalUp;\n        return diagonalUpBorder;\n    };\n    /**\n     * Gets diagonal cell down border\n     * @param tableCell\n     * @private\n     */\n    Layout.prototype.getCellDiagonalDownBorder = function (tableCell) {\n        var diagonalDownBorder = undefined;\n        var cellBorder = undefined;\n        cellBorder = tableCell.cellFormat.borders;\n        diagonalDownBorder = cellBorder.diagonalDown;\n        return diagonalDownBorder;\n    };\n    /**\n     * Gets table width.\n     * @param table\n     * @private\n     */\n    Layout.prototype.getTableWidth = function (table) {\n        var width = 0;\n        for (var i = 0; i < table.childWidgets.length; i++) {\n            var row = table.childWidgets[i];\n            var rowWidth = 0;\n            for (var j = 0; j < row.childWidgets.length; j++) {\n                var cell = row.childWidgets[j];\n                rowWidth += HelperMethods.convertPointToPixel(cell.cellFormat.cellWidth);\n            }\n            if (width < rowWidth) {\n                width = rowWidth;\n            }\n        }\n        return width;\n    };\n    //#region shifting\n    /**\n     * @private\n     */\n    Layout.prototype.layoutNextItemsBlock = function (blockAdv, viewer) {\n        var sectionIndex = blockAdv.bodyWidget.sectionIndex;\n        var block = blockAdv;\n        var splittedWidget = block.getSplitWidgets();\n        var nextBlock = splittedWidget[splittedWidget.length - 1].nextRenderedWidget;\n        if (isNullOrUndefined(nextBlock) || this.viewer.blockToShift === block) {\n            this.viewer.blockToShift = undefined;\n        }\n        var updateNextBlockList = true;\n        while (nextBlock instanceof BlockWidget && nextBlock.bodyWidget.sectionIndex === sectionIndex) {\n            var currentWidget = undefined;\n            var blocks = block.getSplitWidgets();\n            currentWidget = blocks[blocks.length - 1];\n            // if (viewer.fieldEndParagraph === block) {\n            //     //Sets field end paragraph to undefined, inorder to hold reLayouting with this paragraph.\n            //     viewer.fieldEndParagraph = undefined;\n            // }\n            block = nextBlock;\n            if (viewer.blockToShift === block) {\n                viewer.blockToShift = undefined;\n            }\n            updateNextBlockList = false;\n            var nextWidget = undefined;\n            nextWidget = block.getSplitWidgets()[0];\n            // tslint:disable-next-line:max-line-length\n            if (viewer.fieldStacks.length === 0 && !isNullOrUndefined(nextWidget) && currentWidget.containerWidget === nextWidget.containerWidget\n                && (HelperMethods.round(nextWidget.y, 2) === HelperMethods.round(currentWidget.y + currentWidget.height, 2))) {\n                if (!isNullOrUndefined(viewer.blockToShift)) {\n                    viewer.blockToShift = block;\n                    break;\n                }\n                if (isNullOrUndefined(nextWidget.nextWidget)) {\n                    break;\n                }\n            }\n            updateNextBlockList = true;\n            if (viewer.owner.isShiftingEnabled && viewer.fieldStacks.length === 0) {\n                viewer.blockToShift = block;\n                break;\n            }\n            else if (isNullOrUndefined(this.viewer.owner.editorModule) || !this.viewer.owner.editorModule.isInsertingTOC) {\n                block = block.combineWidget(this.viewer);\n                var paragraph = void 0;\n                if (currentWidget.containerWidget !== block.containerWidget) {\n                    if (!(currentWidget instanceof ParagraphWidget) ||\n                        (currentWidget instanceof ParagraphWidget) && !currentWidget.isEndsWithPageBreak) {\n                        // tslint:disable-next-line:max-line-length\n                        this.updateContainerWidget(block, currentWidget.containerWidget, currentWidget.indexInOwner + 1, false);\n                    }\n                }\n                if (block instanceof TableWidget) {\n                    this.clearTableWidget(block, true, true);\n                    block.isGridUpdated = false;\n                    paragraph = this.viewer.selection.getFirstParagraphInFirstCell(block);\n                }\n                else {\n                    paragraph = block;\n                }\n                if ((this.viewer.owner.isDocumentLoaded) && this.viewer.owner.editorModule) {\n                    this.viewer.owner.editorModule.updateWholeListItems(paragraph);\n                }\n                viewer.updateClientAreaForBlock(block, true);\n                this.viewer.layout.layoutBlock(block, 0);\n                viewer.updateClientAreaForBlock(block, false);\n            }\n            splittedWidget = nextBlock.getSplitWidgets();\n            nextBlock = splittedWidget[splittedWidget.length - 1].nextRenderedWidget;\n        }\n        if (!viewer.owner.isShiftingEnabled || this.viewer.blockToShift !== block) {\n            this.viewer.owner.editorModule.updateListItemsTillEnd(block, updateNextBlockList);\n        }\n    };\n    /**\n     * @private\n     */\n    Layout.prototype.updateClientAreaForLine = function (paragraph, startLineWidget, elementIndex) {\n        //Clears the line widget starting from current line.\n        var top = this.viewer.selection.getTop(startLineWidget);\n        var left = this.viewer.clientArea.x;\n        this.viewer.cutFromTop(top);\n        this.viewer.cutFromLeft(left);\n    };\n    /**\n     * @private\n     */\n    Layout.prototype.getParentTable = function (block) {\n        var widget = block;\n        while (widget.containerWidget) {\n            if (widget.containerWidget instanceof BlockContainer) {\n                return widget;\n            }\n            widget = widget.containerWidget;\n        }\n        return undefined;\n    };\n    /**\n     * @private\n     */\n    Layout.prototype.reLayoutParagraph = function (paragraphWidget, lineIndex, elementBoxIndex) {\n        if (this.viewer.blockToShift === paragraphWidget) {\n            this.layoutBodyWidgetCollection(paragraphWidget.index, paragraphWidget.containerWidget, paragraphWidget, false);\n        }\n        // let isElementMoved: boolean = elementBoxIndex > 0;\n        if (paragraphWidget.isInsideTable) {\n            this.reLayoutTable(paragraphWidget);\n        }\n        else {\n            this.reLayoutLine(paragraphWidget, lineIndex);\n        }\n        if (paragraphWidget.bodyWidget instanceof HeaderFooterWidget &&\n            paragraphWidget.bodyWidget.headerFooterType.indexOf('Footer') !== -1) {\n            this.shiftFooterChildLocation(paragraphWidget.bodyWidget, this.viewer);\n        }\n    };\n    /**\n     * @private\n     */\n    Layout.prototype.reLayoutTable = function (block) {\n        //Get Top level owner of block\n        var table = this.getParentTable(block);\n        //Combine splitted table in to single table\n        // this.combineTableWidgets(this.viewer, table, undefined);\n        //Get Parent table\n        var currentTable = table.combineWidget(this.viewer);\n        currentTable.isGridUpdated = false;\n        currentTable.buildTableColumns();\n        currentTable.isGridUpdated = true;\n        var bodyWidget = currentTable.containerWidget;\n        if (this.viewer.owner.enableHeaderAndFooter || block.isInHeaderFooter) {\n            bodyWidget.height -= currentTable.height;\n            // tslint:disable-next-line:max-line-length\n            this.viewer.updateHCFClientAreaWithTop(table.bodyWidget.sectionFormat, this.viewer.isBlockInHeader(table), bodyWidget.page);\n        }\n        else {\n            this.viewer.updateClientArea(bodyWidget.sectionFormat, bodyWidget.page);\n        }\n        //Clear Hieght for all the content \n        if (this.viewer.owner.isDocumentLoaded && this.viewer.owner.editorModule) {\n            var block_1 = this.viewer.selection.getFirstParagraphInFirstCell(currentTable);\n            this.viewer.owner.editorModule.updateWholeListItems(block_1);\n        }\n        this.viewer.updateClientAreaForBlock(currentTable, true);\n        //Remove border width\n        currentTable.x -= currentTable.leftBorderWidth;\n        currentTable.y -= currentTable.topBorderWidth;\n        //Update Client area for current position\n        this.viewer.cutFromTop(currentTable.y);\n        this.clearTableWidget(currentTable, true, true);\n        this.layoutBlock(currentTable, 0, true);\n        this.viewer.updateClientAreaForBlock(currentTable, false);\n        this.layoutNextItemsBlock(currentTable, this.viewer);\n    };\n    /**\n     * @private\n     */\n    Layout.prototype.clearTableWidget = function (table, clearPosition, clearHeight) {\n        table.height = 0;\n        if (clearPosition) {\n            table.y = 0;\n            table.x = 0;\n        }\n        for (var i = 0; i < table.childWidgets.length; i++) {\n            var row = table.childWidgets[i];\n            this.clearRowWidget(row, clearPosition, clearHeight);\n        }\n    };\n    /**\n     * @private\n     */\n    Layout.prototype.clearRowWidget = function (row, clearPosition, clearHeight) {\n        row.height = 0;\n        if (clearPosition) {\n            row.y = 0;\n            row.x = 0;\n        }\n        for (var i = 0; i < row.childWidgets.length; i++) {\n            var cell = row.childWidgets[i];\n            this.clearCellWidget(cell, clearPosition, clearHeight);\n        }\n    };\n    /**\n     * @private\n     */\n    Layout.prototype.clearCellWidget = function (cell, clearPosition, clearHeight) {\n        cell.height = 0;\n        if (clearPosition) {\n            cell.y = 0;\n            cell.x = 0;\n        }\n        for (var i = 0; i < cell.childWidgets.length; i++) {\n            var block = cell.childWidgets[i];\n            if (block instanceof ParagraphWidget) {\n                if (clearHeight) {\n                    block.height = 0;\n                }\n            }\n            else {\n                this.clearTableWidget(block, clearPosition, clearHeight);\n            }\n        }\n    };\n    /**\n     * @param blockIndex\n     * @param bodyWidget\n     * @param block\n     * @private\n     */\n    // tslint:disable-next-line:max-line-length\n    Layout.prototype.layoutBodyWidgetCollection = function (blockIndex, bodyWidget, block, shiftNextWidget) {\n        if (!isNullOrUndefined(this.viewer.owner)\n            && this.viewer.owner.isLayoutEnabled) {\n            if (bodyWidget instanceof BlockContainer) {\n                var curretBlock = this.checkAndGetBlock(bodyWidget, blockIndex);\n                if (isNullOrUndefined(curretBlock)) {\n                    return;\n                }\n                if (bodyWidget instanceof HeaderFooterWidget) {\n                    // tslint:disable-next-line:max-line-length\n                    this.viewer.updateHCFClientAreaWithTop(bodyWidget.sectionFormat, bodyWidget.headerFooterType.indexOf('Header') !== -1, bodyWidget.page);\n                    curretBlock.containerWidget.height -= curretBlock.height;\n                }\n                else {\n                    this.viewer.updateClientArea(bodyWidget.sectionFormat, bodyWidget.page);\n                }\n                if (blockIndex > 0) {\n                    var prevWidget = curretBlock.getSplitWidgets()[0].previousRenderedWidget;\n                    if (!(prevWidget instanceof ParagraphWidget) ||\n                        (prevWidget instanceof ParagraphWidget) && !prevWidget.isEndsWithPageBreak) {\n                        this.viewer.cutFromTop(prevWidget.y + prevWidget.height);\n                        if (curretBlock.containerWidget !== prevWidget.containerWidget) {\n                            // tslint:disable-next-line:max-line-length\n                            this.updateContainerWidget(curretBlock, prevWidget.containerWidget, prevWidget.indexInOwner + 1, false);\n                        }\n                    }\n                    else if (prevWidget instanceof ParagraphWidget && prevWidget.isEndsWithPageBreak &&\n                        prevWidget.containerWidget === curretBlock.containerWidget) {\n                        this.moveBlocksToNextPage(prevWidget);\n                    }\n                }\n                var currentParagraph = void 0;\n                curretBlock = curretBlock.combineWidget(this.viewer);\n                if (curretBlock instanceof TableWidget) {\n                    this.clearTableWidget(curretBlock, true, true);\n                    curretBlock.isGridUpdated = false;\n                    currentParagraph = this.viewer.selection.getFirstParagraphInFirstCell(curretBlock);\n                }\n                else {\n                    currentParagraph = curretBlock;\n                }\n                if ((this.viewer.owner.isDocumentLoaded) && this.viewer.owner.editorModule) {\n                    this.viewer.owner.editorModule.updateWholeListItems(currentParagraph);\n                }\n                this.viewer.updateClientAreaForBlock(curretBlock, true);\n                this.viewer.layout.layoutBlock(curretBlock, 0, true);\n                this.viewer.updateClientAreaForBlock(curretBlock, false);\n                if (shiftNextWidget) {\n                    this.shiftNextWidgets(curretBlock);\n                }\n                else {\n                    this.layoutNextItemsBlock(curretBlock, this.viewer);\n                }\n            }\n            else if (bodyWidget instanceof TableCellWidget) {\n                var table = this.viewer.layout.getParentTable(bodyWidget.ownerTable.getSplitWidgets()[0]);\n                this.reLayoutTable(bodyWidget.ownerTable);\n                this.layoutNextItemsBlock(table, this.viewer);\n            }\n        }\n    };\n    Layout.prototype.checkAndGetBlock = function (containerWidget, blockIndex) {\n        var sectionIndex = containerWidget.index;\n        while (containerWidget && containerWidget.index === sectionIndex) {\n            if (containerWidget.childWidgets.length > 0 && containerWidget.firstChild.index <= blockIndex &&\n                containerWidget.lastChild.index >= blockIndex) {\n                for (var i = 0; i < containerWidget.childWidgets.length; i++) {\n                    var block = containerWidget.childWidgets[i];\n                    if (block.index === blockIndex) {\n                        return block;\n                    }\n                }\n            }\n            if (containerWidget instanceof BodyWidget) {\n                containerWidget = containerWidget.nextRenderedWidget;\n            }\n            else {\n                break;\n            }\n        }\n        return undefined;\n    };\n    //#endregion\n    //#region Table\n    /**\n     * Layouts table.\n     * @param table\n     * @private\n     */\n    Layout.prototype.layoutTable = function (table, startIndex) {\n        if (!table.isGridUpdated) {\n            table.buildTableColumns();\n            table.isGridUpdated = true;\n        }\n        var tableView = [table];\n        this.addTableWidget(this.viewer.clientActiveArea, tableView);\n        this.viewer.updateClientAreaTopOrLeft(table, true);\n        var isHeader = table.childWidgets[0].rowFormat.isHeader;\n        if (table.childWidgets.length > 0) {\n            table.header = isHeader;\n            table.continueHeader = isHeader;\n            table.headerHeight = 0;\n        }\n        var row = table.childWidgets[startIndex];\n        while (row) {\n            row = this.layoutRow(tableView, row);\n            row = row.nextRow;\n        }\n        this.updateWidgetsToPage(tableView, [], table);\n        return tableView[tableView.length - 1];\n    };\n    /**\n     * Adds table widget.\n     * @param area\n     * @param table\n     * @private\n     */\n    Layout.prototype.addTableWidget = function (area, table, create) {\n        var tableWidget = table[table.length - 1];\n        if (create) {\n            tableWidget = this.createTableWidget(tableWidget);\n            table.push(tableWidget);\n        }\n        tableWidget.width = area.width;\n        tableWidget.x = area.x;\n        tableWidget.y = area.y;\n        //Update the table height of tableWidget when cell spacing has been defined. \n        if (tableWidget.tableFormat.cellSpacing > 0) {\n            tableWidget.height = tableWidget.height + HelperMethods.convertPointToPixel(tableWidget.tableFormat.cellSpacing);\n            // tslint:disable-next-line:max-line-length\n            tableWidget.leftBorderWidth = HelperMethods.convertPointToPixel(this.getTableLeftBorder(tableWidget.tableFormat.borders).getLineWidth());\n            tableWidget.rightBorderWidth = HelperMethods.convertPointToPixel(this.getTableRightBorder(tableWidget.tableFormat.borders).getLineWidth());\n            // tslint:disable-next-line:max-line-length\n            tableWidget.topBorderWidth = HelperMethods.convertPointToPixel(this.getTableTopBorder(tableWidget.tableFormat.borders).getLineWidth());\n            tableWidget.bottomBorderWidth = HelperMethods.convertPointToPixel(this.getTableBottomBorder(tableWidget.tableFormat.borders).getLineWidth());\n            tableWidget.x += tableWidget.leftBorderWidth;\n            tableWidget.y += tableWidget.topBorderWidth;\n            tableWidget.width -= tableWidget.leftBorderWidth;\n            tableWidget.width -= tableWidget.rightBorderWidth;\n            tableWidget.height += tableWidget.bottomBorderWidth;\n        }\n        return tableWidget;\n    };\n    /**\n     * Updates widget to page.\n     * @param table\n     * @private\n     */\n    Layout.prototype.updateWidgetsToPage = function (tables, rows, table, endRowWidget) {\n        var viewer = this.viewer;\n        var tableWidget = tables[tables.length - 1];\n        if (!table.isInsideTable) {\n            this.updateHeightForTableWidget(tables, rows, tableWidget, endRowWidget);\n            if (tableWidget.childWidgets.length > 0 && tableWidget.y !== tableWidget.childWidgets[0].y) {\n                tableWidget.y = tableWidget.childWidgets[0].y;\n            }\n            // Need to update on this further\n            //Adds the table widget to owner cell widget.\n            // tslint:disable-next-line:max-line-length\n            // (viewer.renderedElements.get(table.associatedCell)[viewer.renderedElements.get(table.associatedCell).length - 1] as TableCellWidget).childWidgets.push(tableWidget);\n            // tableWidget.containerWidget = viewer.renderedElements.get(table.associatedCell)[viewer.renderedElements.get(table.associatedCell).length - 1] as BodyWidget;\n            // tslint:disable-next-line:max-line-length\n            // (viewer.renderedElements.get(table.associatedCell)[viewer.renderedElements.get(table.associatedCell).length - 1] as TableCellWidget).height = (viewer.renderedElements.get(table.associatedCell)[viewer.renderedElements.get(table.associatedCell).length - 1] as TableCellWidget).height + tableWidget.height;\n        }\n        if (table.tableFormat.cellSpacing > 0) {\n            // tslint:disable-next-line:max-line-length\n            if (tableWidget.y + tableWidget.height + HelperMethods.convertPointToPixel(table.tableFormat.cellSpacing) > viewer.clientArea.bottom && viewer instanceof PageLayoutViewer) {\n                //update the table height when split to next page. Which is equivalent Ms Word Behaviour. \n                //In Ms Word if the Table Split to next page the bottom spacing of the table will be half of the current spacing.\n                //And the Remaining space will be used in next page top of the table.\n                tableWidget.height = tableWidget.height - HelperMethods.convertPointToPixel(table.tableFormat.cellSpacing) / 2;\n            }\n            //Update the current Y position of current clientactivearea.\n            viewer.cutFromTop(tableWidget.y + tableWidget.height);\n        }\n        if (table.bodyWidget instanceof HeaderFooterWidget) {\n            table.containerWidget.height += table.height;\n            if (this.viewer.owner.enableHeaderAndFooter && table.bodyWidget.headerFooterType.indexOf('Footer') !== -1) {\n                this.shiftFooterChildLocation(table.bodyWidget, this.viewer);\n            }\n        }\n    };\n    /**\n     * Updates height for table widget.\n     * @param viewer\n     * @param tableWidget\n     * @private\n     */\n    // tslint:disable-next-line:max-line-length\n    Layout.prototype.updateHeightForTableWidget = function (tables, rows, tableWidget, endRowWidget) {\n        for (var i = 0; i < tableWidget.childWidgets.length; i++) {\n            var rowWidget = tableWidget.childWidgets[i];\n            if (rowWidget === endRowWidget) {\n                break;\n            }\n            this.updateHeightForRowWidget(this.viewer, true, tables, rows, rowWidget, true, endRowWidget);\n        }\n    };\n    //#endregion\n    //#region Row\n    /**\n     * Layouts table row.\n     * @param row\n     * @private\n     */\n    Layout.prototype.layoutRow = function (tableWidget, row) {\n        var viewer = this.viewer;\n        var rowWidgets = [row];\n        var widget = this.addTableRowWidget(viewer.clientActiveArea, rowWidgets);\n        viewer.updateClientAreaForRow(row, true);\n        for (var i = 0; i < row.childWidgets.length; i++) {\n            var cell = row.childWidgets[i];\n            // tslint:disable-next-line:max-line-length\n            this.layoutCell(cell, this.getMaxTopOrBottomCellMargin(row, 0) + row.topBorderWidth, this.getMaxTopOrBottomCellMargin(row, 1) + row.bottomBorderWidth, widget);\n        }\n        viewer.updateClientAreaForRow(row, false);\n        var rows = [row];\n        this.updateWidgetsToTable(tableWidget, rows, row);\n        return rows[rows.length - 1];\n    };\n    /**\n     * @param area\n     * @param row\n     */\n    Layout.prototype.addTableRowWidget = function (area, row) {\n        var rowWidget = row[row.length - 1];\n        rowWidget.x = area.x + rowWidget.rowFormat.gridBeforeWidth;\n        rowWidget.y = area.y;\n        rowWidget.width = area.width;\n        var borderWidth = 0;\n        if (!isNullOrUndefined(rowWidget.ownerTable) && !isNullOrUndefined(rowWidget.ownerTable.tableFormat)\n            && rowWidget.ownerTable.tableFormat.cellSpacing > 0) {\n            rowWidget.height = rowWidget.height + HelperMethods.convertPointToPixel(rowWidget.ownerTable.tableFormat.cellSpacing);\n            //Update the table height with the border width to layout the border when the cell spacing is defined..\n            for (var j = 0; j < rowWidget.childWidgets.length; j++) {\n                if (!isNullOrUndefined(rowWidget.childWidgets[j].cellFormat)\n                    && !isNullOrUndefined(rowWidget.childWidgets[j].cellFormat.borders)) {\n                    // tslint:disable-next-line:max-line-length\n                    var width = TableCellWidget.getCellBottomBorder(rowWidget.childWidgets[j]).getLineWidth();\n                    if (width > borderWidth) {\n                        borderWidth = width;\n                    }\n                }\n            }\n            //Maximum border width is calculated and hold it in a variable to add with the padding of the cells.\n            rowWidget.bottomBorderWidth = HelperMethods.convertPointToPixel(borderWidth);\n            if (rowWidget.index > 0 && !isNullOrUndefined(rowWidget.previousWidget)) {\n                var prevRow = rowWidget.previousWidget;\n                borderWidth = 0;\n                for (var i = 0; i < prevRow.childWidgets.length; i++) {\n                    // tslint:disable-next-line:max-line-length\n                    if (!isNullOrUndefined(prevRow.childWidgets[i].cellFormat) && !isNullOrUndefined(prevRow.childWidgets[i].cellFormat.borders)) {\n                        var value = TableCellWidget.getCellBottomBorder(prevRow.childWidgets[i]).getLineWidth();\n                        if (value > borderWidth) {\n                            borderWidth = value;\n                        }\n                    }\n                }\n                //Maximum border width is calculated and hold it in a variable to add with the padding of the cells.\n                rowWidget.topBorderWidth = HelperMethods.convertPointToPixel(borderWidth);\n            }\n        }\n        if (!isNullOrUndefined(rowWidget.childWidgets)) {\n            for (var i = 0; i < rowWidget.childWidgets.length; i++) {\n                // tslint:disable-next-line:max-line-length\n                if (!isNullOrUndefined(rowWidget.childWidgets[i].cellFormat) && !isNullOrUndefined(rowWidget.childWidgets[i].cellFormat.borders)) {\n                    var value = TableCellWidget.getCellTopBorder(rowWidget.childWidgets[i]).getLineWidth();\n                    if (value > borderWidth) {\n                        borderWidth = value;\n                    }\n                }\n            }\n        }\n        //Maximum border width is calculated and hold it in a variable to add with the padding of the cells.\n        rowWidget.topBorderWidth = HelperMethods.convertPointToPixel(borderWidth);\n        //Update the table height of tableWidget when cell spacing has been defined. \n        // tslint:disable-next-line:max-line-length\n        if (!isNullOrUndefined(rowWidget.ownerTable) && !isNullOrUndefined(rowWidget.ownerTable.tableFormat) && rowWidget.ownerTable.tableFormat.cellSpacing <= 0 && rowWidget.rowIndex === rowWidget.ownerTable.childWidgets.length - 1) {\n            // Update the bottom width for last row .\n            for (var i = 0; i < rowWidget.childWidgets.length; i++) {\n                // tslint:disable-next-line:max-line-length\n                if (!isNullOrUndefined(rowWidget.childWidgets[i].cellFormat) && !isNullOrUndefined(rowWidget.childWidgets[i].cellFormat.borders)) {\n                    var value = TableCellWidget.getCellBottomBorder(rowWidget.childWidgets[i]).getLineWidth();\n                    if (value > borderWidth) {\n                        borderWidth = value;\n                    }\n                }\n            }\n            //Maximum border width is calculated and hold it in a variable to add with the padding of the cells.\n            rowWidget.bottomBorderWidth = HelperMethods.convertPointToPixel(borderWidth);\n        }\n        //tableRowWidget.ownerWidget = owner;\n        return rowWidget;\n    };\n    /**\n     * Gets maximum top or bottom cell margin.\n     * @param row\n     * @param topOrBottom\n     */\n    Layout.prototype.getMaxTopOrBottomCellMargin = function (row, topOrBottom) {\n        if (isNullOrUndefined(row.childWidgets)) {\n            return 0;\n        }\n        var value = 0;\n        for (var i = 0; i < row.childWidgets.length; i++) {\n            if (row.childWidgets.length > 0) {\n                var cellFormat = row.childWidgets[i].cellFormat;\n                if (cellFormat.containsMargins()) {\n                    if (topOrBottom === 0 && !isNullOrUndefined(cellFormat.topMargin) &&\n                        HelperMethods.convertPointToPixel(cellFormat.topMargin) > value) {\n                        value = HelperMethods.convertPointToPixel(cellFormat.topMargin);\n                    }\n                    else if (topOrBottom === 1 && !isNullOrUndefined(cellFormat.bottomMargin) &&\n                        HelperMethods.convertPointToPixel(cellFormat.bottomMargin) > value) {\n                        value = HelperMethods.convertPointToPixel(cellFormat.bottomMargin);\n                    }\n                }\n                else {\n                    var tableFormat = row.childWidgets[i].ownerTable.tableFormat;\n                    if (topOrBottom === 0 && HelperMethods.convertPointToPixel(tableFormat.topMargin) > value) {\n                        value = HelperMethods.convertPointToPixel(tableFormat.topMargin);\n                    }\n                    else if (topOrBottom === 1 && HelperMethods.convertPointToPixel(tableFormat.bottomMargin) > value) {\n                        value = HelperMethods.convertPointToPixel(tableFormat.bottomMargin);\n                    }\n                }\n            }\n        }\n        return value;\n    };\n    //#endregion Row\n    //#region cell\n    /**\n     * Layouts cell\n     * @param cell\n     * @param maxCellMarginTop\n     * @param maxCellMarginBottom\n     */\n    Layout.prototype.layoutCell = function (cell, maxCellMarginTop, maxCellMarginBottom, owner) {\n        var viewer = this.viewer;\n        this.addTableCellWidget(cell, viewer.clientActiveArea, maxCellMarginTop, maxCellMarginBottom);\n        viewer.updateClientAreaForCell(cell, true);\n        if (cell.childWidgets.length === 0) {\n            var paragraphWidget = new ParagraphWidget();\n            paragraphWidget.characterFormat = new WCharacterFormat();\n            paragraphWidget.paragraphFormat = new WParagraphFormat();\n            paragraphWidget.index = 0;\n            var lineWidget = new LineWidget(undefined);\n            paragraphWidget.childWidgets.push(lineWidget);\n            cell.childWidgets.push(paragraphWidget);\n        }\n        for (var i = 0; i < cell.childWidgets.length; i++) {\n            var block = cell.childWidgets[i];\n            viewer.updateClientAreaForBlock(block, true);\n            block.containerWidget = cell;\n            this.layoutBlock(block, 0);\n            viewer.updateClientAreaForBlock(block, false);\n        }\n        this.updateWidgetToRow(cell);\n        viewer.updateClientAreaForCell(cell, false);\n    };\n    //endregion cell\n    //#region Shifting\n    /**\n     * @private\n     */\n    Layout.prototype.shiftLayoutedItems = function () {\n        if (isNullOrUndefined(this.viewer.blockToShift) || isNullOrUndefined(this.viewer.blockToShift.containerWidget)) {\n            this.viewer.blockToShift = undefined;\n            return;\n        }\n        var block = this.viewer.blockToShift;\n        var sectionIndex = block.bodyWidget.index;\n        this.reLayoutOrShiftWidgets(block, this.viewer);\n        var updateNextBlockList = true;\n        // If flow layout, then all sections are in single page. Hence need to update till last block of last section.\n        // Todo: For page layout and section break continuous, need to handle the same.\n        var splittedWidget = block.getSplitWidgets();\n        var nextBlock = splittedWidget[splittedWidget.length - 1].nextRenderedWidget;\n        while (nextBlock instanceof BlockWidget && nextBlock.bodyWidget.index === sectionIndex) {\n            var currentWidget = undefined;\n            var blocks = block.getSplitWidgets();\n            currentWidget = blocks[blocks.length - 1];\n            block = nextBlock;\n            updateNextBlockList = false;\n            var nextWidget = undefined;\n            blocks = block.getSplitWidgets();\n            if (block instanceof ParagraphWidget) {\n                nextWidget = blocks[0];\n            }\n            else {\n                if (block instanceof TableWidget) {\n                    nextWidget = blocks[0];\n                }\n            }\n            if (currentWidget.containerWidget === nextWidget.containerWidget\n                && (HelperMethods.round(nextWidget.y, 2) === HelperMethods.round(this.viewer.clientActiveArea.y, 2)) &&\n                isNullOrUndefined(nextWidget.nextWidget)) {\n                break;\n            }\n            updateNextBlockList = true;\n            this.reLayoutOrShiftWidgets(block, this.viewer);\n            splittedWidget = block.getSplitWidgets();\n            nextBlock = splittedWidget[splittedWidget.length - 1].nextRenderedWidget;\n        }\n        if (this.viewer.owner.editorModule) {\n            this.viewer.owner.editorModule.updateListItemsTillEnd(block, updateNextBlockList);\n        }\n        this.viewer.blockToShift = undefined;\n        var viewer = this.viewer;\n        // if (viewer instanceof PageLayoutViewer) {\n        viewer.removeEmptyPages();\n        this.updateFieldElements();\n        viewer.updateScrollBars();\n        // }\n    };\n    /**\n     * @private\n     */\n    Layout.prototype.updateFieldElements = function () {\n        for (var i = 0; i < this.viewer.fields.length; i++) {\n            var fieldBegin = this.viewer.fields[i];\n            if (!isNullOrUndefined(this.viewer.selection)) {\n                var fieldCode = this.viewer.selection.getFieldCode(fieldBegin);\n                if (!isNullOrUndefined(fieldCode) && fieldCode.toLowerCase().match('numpages')) {\n                    var textElement = fieldBegin.fieldSeparator.nextNode;\n                    if (!isNullOrUndefined(textElement)) {\n                        textElement.text = this.viewer.pages.length.toString();\n                        var paragraph = fieldBegin.line.paragraph;\n                        if (!isNullOrUndefined(paragraph.bodyWidget) && !isNullOrUndefined(paragraph.bodyWidget.page)) {\n                            var lineIndex = paragraph.childWidgets.indexOf(fieldBegin.line);\n                            var elementIndex = fieldBegin.line.children.indexOf(textElement);\n                            this.reLayoutParagraph(paragraph, lineIndex, elementIndex);\n                        }\n                    }\n                }\n            }\n        }\n    };\n    Layout.prototype.reLayoutOrShiftWidgets = function (blockAdv, viewer) {\n        var reLayoutItems = false;\n        var block = blockAdv;\n        // if (block instanceof ParagraphWidget) {\n        //     reLayoutItems = viewer.renderedElements.get(block as ParagraphWidget).length === 0;\n        // } else {\n        //     reLayoutItems = viewer.renderedElements.get(block as TableWidget).length === 0;\n        // }\n        // if (reLayoutItems) {\n        //     //Handle layouting the block.\n        //     viewer.updateClientAreaForBlock(block, true);\n        //     this.layoutMod.layoutBlock(block);\n        //     viewer.updateClientAreaForBlock(block, false);\n        // } else {\n        //Handled to check client area and shift layouted widget.\n        this.shiftWidgetsBlock(block, viewer);\n        //Updates the list value of the rendered paragraph.\n        if (this.viewer.owner.editorModule) {\n            this.viewer.owner.editorModule.updateRenderedListItems(block);\n        }\n        // }\n    };\n    Layout.prototype.shiftWidgetsBlock = function (block, viewer) {\n        if (block instanceof ParagraphWidget) {\n            this.shiftWidgetsForPara(block, viewer);\n        }\n        else if (block instanceof TableWidget) {\n            this.shiftWidgetsForTable(block, viewer);\n        }\n    };\n    Layout.prototype.shiftWidgetsForPara = function (paragraph, viewer) {\n        var prevBodyObj = this.getBodyWidgetOfPreviousBlock(paragraph, 0);\n        var prevBodyWidget = prevBodyObj.bodyWidget;\n        var index = prevBodyObj.index;\n        var prevWidget = undefined;\n        for (var i = 0; i < paragraph.getSplitWidgets().length; i++) {\n            var widget = paragraph.getSplitWidgets()[i];\n            if (!isNullOrUndefined(prevWidget)) {\n                var isPageBreak = prevWidget.lastChild ? prevWidget.lastChild.isEndsWithPageBreak : false;\n                this.shiftToPreviousWidget(widget, viewer, prevWidget, isPageBreak);\n                if ((isNullOrUndefined(widget.childWidgets) || widget.childWidgets.length === 0) && !isPageBreak) {\n                    i--;\n                    continue;\n                }\n                prevWidget = undefined;\n                if (prevBodyWidget !== widget.containerWidget) {\n                    prevBodyWidget = widget.containerWidget;\n                    if (isPageBreak) {\n                        viewer.updateClientAreaByWidget(widget);\n                    }\n                }\n            }\n            if (this.isFitInClientArea(widget, viewer)) {\n                //Check whether this widget is moved to previous container widget.\n                prevWidget = widget;\n                widget.y = viewer.clientActiveArea.y;\n                viewer.cutFromTop(viewer.clientActiveArea.y + widget.height);\n                //Moves the paragraph widget to previous body widget.\n                if (!isNullOrUndefined(prevBodyWidget) && prevBodyWidget !== widget.containerWidget) {\n                    index++;\n                    if (!prevBodyWidget.lastChild.isEndsWithPageBreak) {\n                        this.updateContainerWidget(widget, prevBodyWidget, index, true);\n                    }\n                }\n                if (widget.isEndsWithPageBreak) {\n                    var nextBodyWidget = this.createOrGetNextBodyWidget(prevBodyWidget, this.viewer);\n                    nextBodyWidget = this.moveBlocksToNextPage(widget);\n                    viewer.updateClientArea(nextBodyWidget.sectionFormat, nextBodyWidget.page);\n                }\n            }\n            else {\n                var previousBlock = widget.previousRenderedWidget;\n                var isPageBreak = false;\n                if (previousBlock instanceof ParagraphWidget && previousBlock.isEndsWithPageBreak) {\n                    isPageBreak = true;\n                }\n                var isSplittedToNewPage = this.splitWidget(widget, viewer, prevBodyWidget, index + 1, isPageBreak);\n                prevWidget = undefined;\n                if (prevBodyWidget !== widget.containerWidget) {\n                    prevBodyWidget = widget.containerWidget;\n                    i--;\n                }\n                index = prevBodyWidget.childWidgets.indexOf(widget);\n                if (isSplittedToNewPage) {\n                    prevBodyWidget = paragraph.getSplitWidgets()[i + 1].containerWidget;\n                }\n            }\n        }\n    };\n    /**\n     * @private\n     */\n    Layout.prototype.shiftTableWidget = function (table, viewer) {\n        var tables = [table];\n        this.addTableWidget(this.viewer.clientActiveArea, tables);\n        this.viewer.updateClientAreaTopOrLeft(table, true);\n        var row = table.childWidgets[0];\n        while (row) {\n            row = this.shiftRowWidget(tables, row);\n            row = row.nextRow;\n        }\n        this.updateWidgetsToPage(tables, [], table);\n        return tables[tables.length - 1];\n    };\n    /**\n     * @private\n     */\n    Layout.prototype.shiftRowWidget = function (tables, row) {\n        var viewer = this.viewer;\n        var rows = [row];\n        var widget = this.addTableRowWidget(viewer.clientActiveArea, rows);\n        viewer.updateClientAreaForRow(row, true);\n        for (var i = 0; i < row.childWidgets.length; i++) {\n            var cell = row.childWidgets[i];\n            // tslint:disable-next-line:max-line-length\n            this.shiftCellWidget(cell, this.getMaxTopOrBottomCellMargin(row, 0) + row.topBorderWidth, this.getMaxTopOrBottomCellMargin(row, 1) + row.bottomBorderWidth);\n        }\n        viewer.updateClientAreaForRow(row, false);\n        this.updateWidgetsToTable(tables, rows, row);\n        return rows[rows.length - 1];\n    };\n    /**\n     * @private\n     */\n    Layout.prototype.shiftCellWidget = function (cell, maxCellMarginTop, maxCellMarginBottom) {\n        var viewer = this.viewer;\n        this.addTableCellWidget(cell, viewer.clientActiveArea, maxCellMarginTop, maxCellMarginBottom);\n        viewer.updateClientAreaForCell(cell, true);\n        for (var i = 0; i < cell.childWidgets.length; i++) {\n            var block = cell.childWidgets[i];\n            viewer.updateClientAreaForBlock(block, true);\n            if (block instanceof ParagraphWidget) {\n                this.shiftParagraphWidget(block);\n            }\n            else {\n                this.shiftTableWidget(block, viewer);\n            }\n            viewer.updateClientAreaForBlock(block, false);\n        }\n        this.updateWidgetToRow(cell);\n        viewer.updateClientAreaForCell(cell, false);\n    };\n    /**\n     * @private\n     */\n    Layout.prototype.shiftParagraphWidget = function (paragraph) {\n        this.addParagraphWidget(this.viewer.clientActiveArea, paragraph);\n        this.viewer.cutFromTop(this.viewer.clientActiveArea.y + paragraph.height);\n        this.updateWidgetToPage(this.viewer, paragraph);\n    };\n    Layout.prototype.shiftWidgetsForTable = function (table, viewer) {\n        var prevObj = this.getBodyWidgetOfPreviousBlock(table, 0);\n        var prevBodyWidget = prevObj.bodyWidget;\n        var index = prevObj.index;\n        var isPageBreak = prevBodyWidget.lastChild.lastChild.isEndsWithPageBreak;\n        if (prevBodyWidget !== table.containerWidget) {\n            if (!isPageBreak) {\n                this.updateContainerWidget(table, prevBodyWidget, index + 1, true);\n            }\n            else {\n                viewer.updateClientArea(table.bodyWidget.sectionFormat, table.bodyWidget.page);\n            }\n        }\n        if (table.isInHeaderFooter) {\n            table.containerWidget.height -= table.height;\n        }\n        table.y = this.viewer.clientActiveArea.y;\n        this.updateVerticalPositionToTop(table, true);\n        var isPageLayout = viewer instanceof PageLayoutViewer;\n        var combinedTable = table.combineWidget(this.viewer);\n        this.viewer.layout.updateChildLocationForTable(combinedTable.y, combinedTable);\n        this.clearTableWidget(combinedTable, true, false);\n        this.shiftTableWidget(combinedTable, this.viewer);\n        this.updateVerticalPositionToTop(table, false);\n    };\n    Layout.prototype.updateVerticalPositionToTop = function (table, isUpdateTop) {\n        //Iterate the tableWidgets counts\n        for (var i = 0; i < table.getSplitWidgets().length; i++) {\n            var tablewidget = table.getSplitWidgets()[i];\n            //Iterate the tableWidget child items\n            for (var j = 0; j < tablewidget.childWidgets.length; j++) {\n                var rowWidget = tablewidget.childWidgets[j];\n                //Iterate the RowWidgets child items\n                for (var k = 0; k < rowWidget.childWidgets.length; k++) {\n                    var cellWidget = rowWidget.childWidgets[k];\n                    //Iterate the RowWidgets child items\n                    this.viewer.layout.updateCellVerticalPosition(cellWidget, isUpdateTop, false);\n                }\n            }\n        }\n    };\n    // tslint:disable-next-line:max-line-length\n    Layout.prototype.splitWidget = function (paragraphWidget, viewer, previousBodyWidget, index, isPageBreak) {\n        var firstLine = paragraphWidget.childWidgets[0];\n        var maxElementHeight = this.getMaxElementHeight(firstLine, viewer);\n        var paragraphView = paragraphWidget.getSplitWidgets();\n        var nextBodyWidget = paragraphWidget.containerWidget;\n        if (viewer.clientActiveArea.height >= maxElementHeight && !isPageBreak) {\n            var splittedWidget = undefined;\n            var widgetIndex = paragraphView.indexOf(paragraphWidget);\n            if (widgetIndex < (paragraphView.length - 1)) {\n                splittedWidget = paragraphView[widgetIndex + 1];\n                nextBodyWidget = splittedWidget.containerWidget;\n            }\n            else {\n                splittedWidget = new ParagraphWidget();\n                splittedWidget.index = paragraphWidget.index;\n                splittedWidget.characterFormat = paragraphWidget.characterFormat;\n                splittedWidget.paragraphFormat = paragraphWidget.paragraphFormat;\n                splittedWidget.width = paragraphWidget.width;\n                splittedWidget.x = paragraphWidget.x;\n                splittedWidget.y = paragraphWidget.y;\n                paragraphView.push(splittedWidget);\n            }\n            if (previousBodyWidget !== paragraphWidget.containerWidget) {\n                this.updateContainerWidget(paragraphWidget, previousBodyWidget, index, true);\n            }\n            for (var i = paragraphWidget.childWidgets.length - 1; i > 0; i--) {\n                if (this.isFitInClientArea(paragraphWidget, viewer)) {\n                    break;\n                }\n                else {\n                    var line = paragraphWidget.childWidgets[i];\n                    //Moves the line widget to next widget.\n                    this.updateParagraphWidgetInternal(line, splittedWidget, 0);\n                }\n            }\n            if (isNullOrUndefined(splittedWidget.containerWidget) && splittedWidget.childWidgets.length > 0) {\n                var y = viewer.clientActiveArea.y;\n                // tslint:disable-next-line:max-line-length\n                var clientArea = new Rect(viewer.clientArea.x, viewer.clientArea.y, viewer.clientArea.width, viewer.clientArea.height);\n                var activeArea = new Rect(viewer.clientActiveArea.x, viewer.clientActiveArea.y, viewer.clientActiveArea.width, viewer.clientActiveArea.height);\n                //Checks whether next node exists, else adds new page.\n                nextBodyWidget = this.moveBlocksToNextPage(paragraphWidget);\n                // nextBodyWidget = this.createOrGetNextBodyWidget(previousBodyWidget, viewer);\n                nextBodyWidget.childWidgets.splice(0, 0, splittedWidget);\n                nextBodyWidget.height += splittedWidget.height;\n                splittedWidget.containerWidget = nextBodyWidget;\n                if (nextBodyWidget.childWidgets.length === 1 && nextBodyWidget.firstChild instanceof ParagraphWidget &&\n                    nextBodyWidget.firstChild.equals(paragraphWidget)) {\n                    paragraphWidget.x = paragraphWidget.x;\n                    paragraphWidget.y = y;\n                    return true;\n                }\n                else {\n                    //Resetting Client area\n                    viewer.clientArea = clientArea;\n                    viewer.clientActiveArea = activeArea;\n                }\n            }\n        }\n        else {\n            nextBodyWidget = this.createOrGetNextBodyWidget(previousBodyWidget, this.viewer);\n            if (paragraphWidget.containerWidget !== nextBodyWidget) {\n                nextBodyWidget = this.moveBlocksToNextPage(paragraphWidget);\n                this.updateContainerWidget(paragraphWidget, nextBodyWidget, 0, true);\n            }\n        }\n        if (previousBodyWidget === paragraphWidget.containerWidget) {\n            paragraphWidget.y = viewer.clientActiveArea.y;\n            viewer.cutFromTop(viewer.clientActiveArea.y + paragraphWidget.height);\n        }\n        else {\n            //Updates client area based on next body widget.\n            viewer.updateClientArea(nextBodyWidget.sectionFormat, nextBodyWidget.page);\n        }\n        return false;\n    };\n    Layout.prototype.getMaxElementHeight = function (lineWidget, viewer) {\n        var height = 0;\n        // tslint:disable-next-line:max-line-length\n        if (lineWidget.children.length === 0 || ((lineWidget.children.length === 1 && lineWidget.children[0] instanceof ListTextElementBox) || (lineWidget.children.length === 2 && lineWidget.children[0] instanceof ListTextElementBox && lineWidget.children[1] instanceof ListTextElementBox))) {\n            var topMargin = 0;\n            var bottomMargin = 0;\n            height = viewer.selection.getParagraphMarkSize(lineWidget.paragraph, topMargin, bottomMargin).height;\n            height += topMargin;\n            if (lineWidget.children.length > 0) {\n                var element = lineWidget.children[0];\n                if (height < element.margin.top + element.height) {\n                    height = element.margin.top + element.height;\n                }\n            }\n        }\n        else {\n            for (var i = 0; i < lineWidget.children.length; i++) {\n                var element = lineWidget.children[i];\n                if (height < element.margin.top + element.height) {\n                    height = element.margin.top + element.height;\n                }\n            }\n        }\n        return height;\n    };\n    Layout.prototype.createOrGetNextBodyWidget = function (bodyWidget, viewer) {\n        var nextBodyWidget = undefined;\n        var pageIndex = 0;\n        pageIndex = viewer.pages.indexOf(bodyWidget.page);\n        var page = undefined;\n        var index = undefined;\n        index = bodyWidget.index;\n        if (pageIndex === viewer.pages.length - 1\n            || viewer.pages[pageIndex + 1].sectionIndex !== index) {\n            var currentWidget = new BodyWidget();\n            currentWidget.sectionFormat = bodyWidget.sectionFormat;\n            currentWidget.index = bodyWidget.index;\n            page = viewer.createNewPage(currentWidget);\n            if (viewer.pages[pageIndex + 1].sectionIndex !== index) {\n                viewer.insertPage(pageIndex + 1, page);\n            }\n            nextBodyWidget = page.bodyWidgets[0];\n        }\n        else {\n            page = viewer.pages[pageIndex + 1];\n            nextBodyWidget = page.bodyWidgets[0];\n        }\n        return nextBodyWidget;\n    };\n    Layout.prototype.isFitInClientArea = function (paragraphWidget, viewer) {\n        var lastLine = paragraphWidget.childWidgets[paragraphWidget.childWidgets.length - 1];\n        var height = paragraphWidget.height;\n        var maxElementHeight = this.getMaxElementHeight(lastLine, viewer);\n        if (lastLine.height > maxElementHeight) {\n            height -= lastLine.height - maxElementHeight;\n        }\n        return viewer.clientActiveArea.height >= height;\n    };\n    // tslint:disable-next-line:max-line-length\n    Layout.prototype.shiftToPreviousWidget = function (paragraphWidget, viewer, previousWidget, isPageBreak) {\n        for (var i = 0; i < paragraphWidget.childWidgets.length; i++) {\n            var line = paragraphWidget.childWidgets[i];\n            var maxElementHeight = this.getMaxElementHeight(line, viewer);\n            if (viewer.clientActiveArea.height >= maxElementHeight && !isPageBreak) {\n                //Moves the line widget to previous widget.\n                this.updateParagraphWidgetInternal(line, previousWidget, previousWidget.childWidgets.length);\n                i--;\n                viewer.cutFromTop(viewer.clientActiveArea.y + line.height);\n                if (isNullOrUndefined(paragraphWidget.childWidgets)) {\n                    break;\n                }\n            }\n            else {\n                var bodyWidget = previousWidget.containerWidget;\n                var nextBodyWidget = this.createOrGetNextBodyWidget(bodyWidget, viewer);\n                if (paragraphWidget.containerWidget !== nextBodyWidget) {\n                    nextBodyWidget = this.moveBlocksToNextPage(paragraphWidget);\n                }\n                if (bodyWidget !== nextBodyWidget) {\n                    this.updateContainerWidget(paragraphWidget, nextBodyWidget, 0, true);\n                }\n                //Updates client area based on next page.\n                viewer.updateClientArea(nextBodyWidget.sectionFormat, nextBodyWidget.page);\n                break;\n            }\n        }\n    };\n    Layout.prototype.updateParagraphWidgetInternal = function (lineWidget, newParagraphWidget, index) {\n        if (!isNullOrUndefined(lineWidget.paragraph)) {\n            lineWidget.paragraph.childWidgets.splice(lineWidget.paragraph.childWidgets.indexOf(lineWidget), 1);\n            lineWidget.paragraph.height -= lineWidget.height;\n            if (!isNullOrUndefined(lineWidget.paragraph.containerWidget)) {\n                lineWidget.paragraph.containerWidget.height -= lineWidget.height;\n            }\n            // tslint:disable-next-line:max-line-length\n            if (isNullOrUndefined(lineWidget.paragraph.childWidgets) || lineWidget.paragraph.childWidgets.length === 0) {\n                lineWidget.paragraph.destroyInternal(this.viewer);\n            }\n        }\n        newParagraphWidget.childWidgets.splice(index, 0, lineWidget);\n        lineWidget.paragraph = newParagraphWidget;\n        newParagraphWidget.height += lineWidget.height;\n        if (!isNullOrUndefined(newParagraphWidget.containerWidget)) {\n            newParagraphWidget.containerWidget.height += lineWidget.height;\n        }\n    };\n    Layout.prototype.shiftNextWidgets = function (blockAdv) {\n        var block = blockAdv;\n        while (block.nextWidget instanceof BlockWidget) {\n            block = block.nextWidget;\n            this.reLayoutOrShiftWidgets(block, this.viewer);\n        }\n    };\n    /**\n     * @private\n     */\n    Layout.prototype.updateContainerWidget = function (widget, bodyWidget, index, destroyAndScroll) {\n        if (!isNullOrUndefined(widget.containerWidget)) {\n            widget.containerWidget.childWidgets.splice(widget.containerWidget.childWidgets.indexOf(widget), 1);\n            widget.containerWidget.height -= bodyWidget.height;\n            if ((isNullOrUndefined(widget.containerWidget.childWidgets) || widget.containerWidget.childWidgets.length === 0)\n                && widget.containerWidget instanceof BodyWidget && widget.containerWidget !== bodyWidget && destroyAndScroll) {\n                var page = widget.containerWidget.page;\n                if (this.viewer.pages[this.viewer.pages.length - 1] === page &&\n                    this.viewer.visiblePages.indexOf(page) !== -1) {\n                    this.viewer.scrollToBottom();\n                }\n                if (isNullOrUndefined(page.nextPage) || page.nextPage.bodyWidgets[0].index !== widget.containerWidget.index) {\n                    widget.containerWidget.destroyInternal(this.viewer);\n                }\n            }\n        }\n        bodyWidget.childWidgets.splice(index, 0, widget);\n        bodyWidget.height += bodyWidget.height;\n        widget.containerWidget = bodyWidget;\n    };\n    Layout.prototype.getBodyWidgetOfPreviousBlock = function (block, index) {\n        index = 0;\n        var prevBodyWidget = undefined;\n        var previousBlock = block.previousRenderedWidget;\n        prevBodyWidget = (previousBlock && previousBlock.containerWidget.equals(block.containerWidget)) ?\n            previousBlock.containerWidget : block.containerWidget;\n        index = previousBlock && previousBlock.containerWidget.equals(block.containerWidget) ?\n            prevBodyWidget.childWidgets.indexOf(previousBlock) : block.containerWidget.childWidgets.indexOf(block);\n        return { bodyWidget: prevBodyWidget, index: index };\n    };\n    /**\n     * @private\n     */\n    Layout.prototype.moveBlocksToNextPage = function (block) {\n        var body = block.bodyWidget;\n        var page = body.page;\n        var pageIndex = page.index + 1;\n        var nextPage = undefined;\n        var nextBody = undefined;\n        var insertPage = false;\n        if (this.viewer.pages.length > pageIndex) {\n            nextPage = this.viewer.pages[pageIndex];\n            if (nextPage.bodyWidgets.length === 0 || !body.equals(nextPage.bodyWidgets[0])) {\n                nextPage = undefined;\n                insertPage = true;\n            }\n            else {\n                nextBody = nextPage.bodyWidgets[0];\n                this.viewer.updateClientArea(nextBody.sectionFormat, nextBody.page);\n            }\n        }\n        if (isNullOrUndefined(nextPage)) {\n            nextBody = this.createSplitBody(body);\n            nextPage = this.viewer.createNewPage(nextBody, pageIndex);\n            if (insertPage) {\n                this.viewer.insertPage(pageIndex, nextPage);\n            }\n        }\n        //tslint:disable :no-constant-condition\n        do {\n            var lastBlock = body.lastChild;\n            if (block === lastBlock) {\n                break;\n            }\n            body.childWidgets.pop();\n            nextBody.childWidgets.splice(0, 0, lastBlock);\n            lastBlock.containerWidget = nextBody;\n            nextBody.height += lastBlock.height;\n        } while (true);\n        return nextBody;\n    };\n    Layout.prototype.createSplitBody = function (body) {\n        var newBody = this.addBodyWidget(this.viewer.clientActiveArea);\n        newBody.sectionFormat = body.sectionFormat;\n        newBody.index = body.index;\n        return newBody;\n    };\n    //endregion\n    //#region Relayout Parargaph \n    /**\n     * Relayout Paragraph from specified line widget\n     * @param paragraph Paragraph to reLayout\n     * @param lineIndex start line index to reLayout\n     * @private\n     */\n    Layout.prototype.reLayoutLine = function (paragraph, lineIndex) {\n        if (this.viewer.owner.isDocumentLoaded && this.viewer.owner.editorModule) {\n            this.viewer.owner.editorModule.updateWholeListItems(paragraph);\n        }\n        var lineWidget;\n        if (paragraph.paragraphFormat.listFormat && paragraph.paragraphFormat.listFormat.listId !== -1) {\n            lineWidget = paragraph.getSplitWidgets()[0].firstChild;\n        }\n        else {\n            lineWidget = paragraph.childWidgets[lineIndex];\n        }\n        var lineToLayout = lineWidget.previousLine;\n        if (isNullOrUndefined(lineToLayout)) {\n            lineToLayout = lineWidget;\n        }\n        var currentParagraph = lineToLayout.paragraph;\n        var bodyWidget = paragraph.containerWidget;\n        bodyWidget.height -= paragraph.height;\n        if (this.viewer.owner.enableHeaderAndFooter || paragraph.isInHeaderFooter) {\n            // tslint:disable-next-line:max-line-length\n            this.viewer.updateHCFClientAreaWithTop(paragraph.bodyWidget.sectionFormat, this.viewer.isBlockInHeader(paragraph), bodyWidget.page);\n        }\n        else {\n            this.viewer.updateClientArea(bodyWidget.sectionFormat, bodyWidget.page);\n        }\n        this.viewer.updateClientAreaForBlock(paragraph, true);\n        if (lineToLayout.paragraph.isEmpty()) {\n            this.viewer.cutFromTop(paragraph.y);\n            this.layoutParagraph(paragraph, 0);\n        }\n        else {\n            this.updateClientAreaForLine(lineToLayout.paragraph, lineToLayout, 0);\n            this.layoutListItems(lineToLayout.paragraph);\n            if (lineToLayout.isFirstLine() && !isNullOrUndefined(paragraph.paragraphFormat)) {\n                var firstLineIndent = -HelperMethods.convertPointToPixel(paragraph.paragraphFormat.firstLineIndent);\n                this.viewer.updateClientWidth(firstLineIndent);\n            }\n            do {\n                lineToLayout = this.layoutLine(lineToLayout, 0);\n                paragraph = lineToLayout.paragraph;\n                lineToLayout = lineToLayout.nextLine;\n            } while (lineToLayout);\n            this.updateWidgetToPage(this.viewer, paragraph);\n            this.viewer.updateClientAreaForBlock(paragraph, false);\n        }\n        this.layoutNextItemsBlock(paragraph, this.viewer);\n    };\n    return Layout;\n}());\nexport { Layout };\n","import { isNullOrUndefined } from '@syncfusion/ej2-base';\nimport { Rect, ImageElementBox, ParagraphWidget, ListTextElementBox, TableRowWidget, TableWidget, TableCellWidget, FieldElementBox, TabElementBox } from './page';\nimport { Layout } from './layout';\nimport { HelperMethods } from '../editor/editor-helper';\n/**\n * @private\n */\nvar Renderer = /** @class */ (function () {\n    function Renderer(viewer) {\n        this.isPrinting = false;\n        this.pageLeft = 0;\n        this.pageTop = 0;\n        this.isFieldCode = false;\n        this.viewer = viewer;\n    }\n    Object.defineProperty(Renderer.prototype, \"pageCanvas\", {\n        /**\n         * Gets page canvas.\n         * @private\n         */\n        get: function () {\n            if (this.isPrinting) {\n                if (isNullOrUndefined(this.pageCanvasIn)) {\n                    this.pageCanvasIn = document.createElement('canvas');\n                    this.pageCanvasIn.getContext('2d').save();\n                }\n                return this.pageCanvasIn;\n            }\n            return isNullOrUndefined(this.viewer) ? undefined : this.viewer.containerCanvas;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(Renderer.prototype, \"selectionCanvas\", {\n        /**\n         * Gets selection canvas.\n         */\n        get: function () {\n            return isNullOrUndefined(this.viewer) ? undefined : this.viewer.selectionCanvas;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(Renderer.prototype, \"pageContext\", {\n        /**\n         * Gets page context.\n         */\n        get: function () {\n            return this.pageCanvas.getContext('2d');\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(Renderer.prototype, \"selectionContext\", {\n        /**\n         * Gets selection context.\n         */\n        get: function () {\n            return this.selectionCanvas.getContext('2d');\n        },\n        enumerable: true,\n        configurable: true\n    });\n    /**\n     * Gets the color.\n     */\n    Renderer.prototype.getColor = function (color) {\n        if (color.length > 0) {\n            if (color[0] === '#') {\n                if (color.length > 7) {\n                    return color.substr(0, 7);\n                }\n            }\n        }\n        return color;\n    };\n    /**\n     * Renders widgets.\n     * @param {Page} page\n     * @param {number} left\n     * @param {number} top\n     * @param {number} width\n     * @param {number} height\n     * @private\n     */\n    Renderer.prototype.renderWidgets = function (page, left, top, width, height) {\n        if (isNullOrUndefined(this.pageCanvas) || isNullOrUndefined(page)) {\n            return;\n        }\n        this.pageContext.fillStyle = this.getColor(this.viewer.backgroundColor);\n        this.pageContext.beginPath();\n        this.pageContext.fillRect(left, top, width, height);\n        this.pageContext.closePath();\n        this.pageContext.strokeStyle = this.viewer.owner.pageOutline;\n        this.pageContext.strokeRect(left, top, width, height);\n        this.pageLeft = left;\n        this.pageTop = top;\n        if (this.isPrinting) {\n            this.setPageSize(page);\n        }\n        else {\n            this.pageContext.beginPath();\n            this.pageContext.save();\n            this.pageContext.rect(left, top, width, height);\n            this.pageContext.clip();\n        }\n        if (page.headerWidget) {\n            this.renderHFWidgets(page, page.headerWidget, width, true);\n        }\n        if (page.footerWidget) {\n            this.renderHFWidgets(page, page.footerWidget, width, false);\n        }\n        for (var i = 0; i < page.bodyWidgets.length; i++) {\n            this.render(page, page.bodyWidgets[i]);\n        }\n        if (this.viewer.owner.enableHeaderAndFooter && !this.isPrinting) {\n            this.renderHeaderSeparator(page, this.pageLeft, this.pageTop, page.headerWidget);\n        }\n        this.pageLeft = 0;\n        this.pageTop = 0;\n        this.pageContext.restore();\n    };\n    /**\n     * Sets page size.\n     * @param {Page} page\n     */\n    Renderer.prototype.setPageSize = function (page) {\n        this.pageContext.clearRect(0, 0, this.pageCanvas.width, this.pageCanvas.height);\n        this.selectionContext.clearRect(0, 0, this.selectionCanvas.width, this.selectionCanvas.height);\n        this.pageContext.restore();\n        this.selectionContext.restore();\n        var width = page.boundingRectangle.width;\n        var height = page.boundingRectangle.height;\n        var dpr = Math.max(1, window.devicePixelRatio || 1);\n        if (this.pageCanvas.width !== width * dpr || this.pageCanvas.height !== height * dpr) {\n            this.pageCanvas.height = height * dpr;\n            this.pageCanvas.width = width * dpr;\n            this.pageCanvas.style.height = height + 'px';\n            this.pageCanvas.style.width = width + 'px';\n            this.pageContext.globalAlpha = 1;\n            this.pageContext.scale(dpr, dpr);\n        }\n    };\n    /**\n     * Renders header footer widget.\n     * @param {Page} page\n     * @param {HeaderFooterWidget} headFootWidget\n     */\n    Renderer.prototype.renderHFWidgets = function (page, widget, width, isHeader) {\n        this.pageContext.globalAlpha = this.viewer.owner.enableHeaderAndFooter ? 1 : 0.65;\n        var cliped = false;\n        if (isHeader) {\n            var topMargin = HelperMethods.convertPointToPixel(page.bodyWidgets[0].sectionFormat.topMargin);\n            var widgetHeight = Math.max((widget.y + widget.height), topMargin);\n            var headerFooterHeight = page.boundingRectangle.height / 100 * 40;\n            if (widgetHeight > headerFooterHeight) {\n                cliped = true;\n                this.pageContext.beginPath();\n                this.pageContext.save();\n                this.pageContext.rect(this.pageLeft, this.pageTop, width, this.getScaledValue(headerFooterHeight));\n                this.pageContext.clip();\n            }\n        }\n        for (var i = 0; i < widget.childWidgets.length; i++) {\n            var block = widget.childWidgets[i];\n            this.renderWidget(page, block);\n        }\n        if (cliped) {\n            this.pageContext.restore();\n        }\n        this.pageContext.globalAlpha = this.viewer.owner.enableHeaderAndFooter ? 0.65 : 1;\n    };\n    Renderer.prototype.renderHeaderSeparator = function (page, left, top, widget) {\n        //Header Widget\n        var topMargin = HelperMethods.convertPointToPixel(page.bodyWidgets[0].sectionFormat.topMargin);\n        var y = this.getScaledValue(Math.max((widget.y + widget.height), topMargin));\n        var pageWidth = this.getScaledValue(page.boundingRectangle.width);\n        var ctx = this.pageContext;\n        ctx.save();\n        ctx.globalAlpha = 0.65;\n        var headerFooterHeight = (this.getScaledValue(page.boundingRectangle.height) / 100) * 40;\n        //Maximum header height limit       \n        y = Math.min(y, headerFooterHeight);\n        //Dash line Separator\n        this.renderDashLine(ctx, left, top + y, pageWidth);\n        var type = this.getHeaderFooterType(page, true);\n        ctx.font = '9pt Arial';\n        var width = ctx.measureText(type).width;\n        this.renderHeaderFooterMark(ctx, left + 5, top + y, width + 10, 20);\n        this.renderHeaderFooterMarkText(ctx, type, left + 10, y + top + 15);\n        if (page.footerWidget) {\n            //Footer Widget\n            var footerDistance = HelperMethods.convertPointToPixel(page.bodyWidgets[0].sectionFormat.footerDistance);\n            // tslint:disable-next-line:max-line-length\n            var footerHeight = this.getScaledValue(page.boundingRectangle.height) -\n                this.getScaledValue(Math.max(page.footerWidget.height + footerDistance, HelperMethods.convertPointToPixel(page.footerWidget.sectionFormat.bottomMargin)));\n            //Maximum footer height limit     \n            footerHeight = Math.max((this.getScaledValue(page.boundingRectangle.height) - headerFooterHeight), footerHeight);\n            this.renderDashLine(ctx, left, top + footerHeight, pageWidth);\n            type = this.getHeaderFooterType(page, false);\n            width = ctx.measureText(type).width;\n            this.renderHeaderFooterMark(ctx, left + 5, top + footerHeight - 20, width + 10, 20);\n            this.renderHeaderFooterMarkText(ctx, type, left + 10, top + footerHeight - 5);\n            ctx.restore();\n        }\n    };\n    Renderer.prototype.getHeaderFooterType = function (page, isHeader) {\n        var type;\n        type = isHeader ? 'Header' : 'Footer';\n        if (page.bodyWidgets[0].sectionFormat.differentFirstPage && this.viewer.pages.indexOf(page) === 0) {\n            type = isHeader ? 'First Page Header' : 'First Page Footer';\n        }\n        else if (page.bodyWidgets[0].sectionFormat.differentOddAndEvenPages) {\n            if ((this.viewer.pages.indexOf(page) + 1) % 2 === 0) {\n                type = isHeader ? 'Even Page Header' : 'Even Page Footer';\n            }\n            else {\n                type = isHeader ? 'Odd Page Header' : 'Odd Page Footer';\n            }\n        }\n        return type;\n    };\n    Renderer.prototype.renderDashLine = function (ctx, x, y, width) {\n        ctx.beginPath();\n        ctx.strokeStyle = '#000000';\n        ctx.lineWidth = 1;\n        ctx.setLineDash([6, 4]);\n        ctx.moveTo(x, y);\n        ctx.lineTo(x + width, y);\n        ctx.stroke();\n        ctx.setLineDash([]);\n        ctx.closePath();\n    };\n    Renderer.prototype.renderHeaderFooterMark = function (ctx, x, y, w, h) {\n        ctx.beginPath();\n        ctx.fillStyle = 'lightgray';\n        ctx.fillRect(x, y, w, h);\n        ctx.strokeStyle = 'black';\n        ctx.strokeRect(x, y, w, h);\n        ctx.closePath();\n    };\n    Renderer.prototype.renderHeaderFooterMarkText = function (ctx, content, x, y) {\n        ctx.beginPath();\n        ctx.fillStyle = '#000000';\n        ctx.textBaseline = 'alphabetic';\n        ctx.fillText(content, x, y);\n        ctx.closePath();\n    };\n    /**\n     * Renders body widget.\n     * @param {Page} page\n     * @param {BodyWidget} bodyWidget\n     */\n    Renderer.prototype.render = function (page, bodyWidget) {\n        for (var i = 0; i < bodyWidget.childWidgets.length; i++) {\n            var widget = bodyWidget.childWidgets[i];\n            if (i === 0 && bodyWidget.childWidgets[0] instanceof TableWidget && page.repeatHeaderRowTableWidget) {\n                // tslint:disable-next-line:max-line-length\n                this.renderHeader(page, widget, this.viewer.layout.getHeader(bodyWidget.childWidgets[0]));\n            }\n            this.renderWidget(page, widget);\n        }\n    };\n    /**\n     * Renders block widget.\n     * @param {Page} page\n     * @param {Widget} widget\n     */\n    Renderer.prototype.renderWidget = function (page, widget) {\n        if (widget instanceof ParagraphWidget) {\n            this.renderParagraphWidget(page, widget);\n        }\n        else {\n            this.renderTableWidget(page, widget);\n        }\n    };\n    /**\n     * Renders header.\n     * @param {Page} page\n     * @param {TableWidget} widget\n     * @param {WRow} header\n     * @private\n     */\n    Renderer.prototype.renderHeader = function (page, widget, header) {\n        if (isNullOrUndefined(header)) {\n            return;\n        }\n        var top = page.viewer.clientArea.y;\n        for (var i = 0; i <= header.rowIndex; i++) {\n            if (header.ownerTable.getSplitWidgets()[0].childWidgets.length === 0) {\n                return;\n            }\n            var row = header.ownerTable.getSplitWidgets()[0].childWidgets[0];\n            var headerWidget = row.clone();\n            headerWidget.containerWidget = row.containerWidget;\n            // tslint:disable-next-line:max-line-length\n            page.viewer.updateClientAreaLocation(headerWidget, new Rect(page.viewer.clientArea.x, top, headerWidget.width, headerWidget.height));\n            page.viewer.layout.updateChildLocationForRow(top, headerWidget);\n            var cell = undefined;\n            //Renders table cell outline rectangle - Border and background color.\n            for (var j = 0; j < headerWidget.childWidgets.length; j++) {\n                cell = headerWidget.childWidgets[j];\n                this.renderTableCellWidget(page, cell);\n            }\n            top += headerWidget.height;\n        }\n        if (widget.y !== top) {\n            //this.Location.Y = top;\n            page.viewer.layout.updateChildLocationForTable(top, widget);\n        }\n    };\n    /**\n     * Renders paragraph widget.\n     * @param {Page} page\n     * @param {ParagraphWidget} paraWidget\n     */\n    Renderer.prototype.renderParagraphWidget = function (page, paraWidget) {\n        var top = paraWidget.y;\n        var left = paraWidget.x;\n        for (var i = 0; i < paraWidget.childWidgets.length; i++) {\n            var widget = paraWidget.childWidgets[i];\n            this.renderLine(widget, page, left, top);\n            top += widget.height;\n        }\n    };\n    /**\n     * Renders table widget.\n     * @param {Page} page\n     * @param {TableWidget} tableWidget\n     */\n    Renderer.prototype.renderTableWidget = function (page, tableWidget) {\n        for (var i = 0; i < tableWidget.childWidgets.length; i++) {\n            var widget = tableWidget.childWidgets[i];\n            this.renderTableRowWidget(page, widget);\n            if (tableWidget.tableFormat.cellSpacing > 0) {\n                this.renderTableOutline(tableWidget);\n            }\n        }\n    };\n    /**\n     * Renders table row widget.\n     * @param {Page} page\n     * @param {Widget} rowWidget\n     */\n    Renderer.prototype.renderTableRowWidget = function (page, rowWidget) {\n        for (var i = 0; i < rowWidget.childWidgets.length; i++) {\n            var widget = rowWidget.childWidgets[i];\n            this.renderTableCellWidget(page, widget);\n        }\n    };\n    /**\n     * Renders table cell widget.\n     * @param {Page} page\n     * @param {TableCellWidget} cellWidget\n     */\n    Renderer.prototype.renderTableCellWidget = function (page, cellWidget) {\n        if (!this.isPrinting) {\n            if (this.getScaledValue(cellWidget.y, 2) + cellWidget.height * this.viewer.zoomFactor < 0 ||\n                this.getScaledValue(cellWidget.y, 2) > this.viewer.visibleBounds.height) {\n                return;\n            }\n        }\n        var widgetHeight = 0;\n        if (!this.isPrinting && page.viewer.owner.selection && page.viewer.owner.selection.selectedWidgets.length > 0) {\n            page.viewer.owner.selection.addSelectionHighlightTable(this.selectionContext, cellWidget);\n        }\n        this.renderTableCellOutline(page.viewer, cellWidget);\n        for (var i = 0; i < cellWidget.childWidgets.length; i++) {\n            var widget = cellWidget.childWidgets[i];\n            var width = cellWidget.width + cellWidget.margin.left - cellWidget.leftBorderWidth;\n            this.clipRect(cellWidget.x, cellWidget.y, this.getScaledValue(width), this.getScaledValue(cellWidget.height));\n            this.renderWidget(page, widget);\n            this.pageContext.restore();\n        }\n    };\n    /**\n     * Renders line widget.\n     * @param {LineWidget} lineWidget\n     * @param {Page} page\n     * @param {number} left\n     * @param {number} top\n     */\n    Renderer.prototype.renderLine = function (lineWidget, page, left, top) {\n        if (!this.isPrinting && page.viewer.owner.selection && page.viewer.owner.selection.selectedWidgets.length > 0) {\n            page.viewer.owner.selection.addSelectionHighlight(this.selectionContext, lineWidget, top);\n        }\n        if (lineWidget.isFirstLine()) {\n            left += HelperMethods.convertPointToPixel(lineWidget.paragraph.paragraphFormat.firstLineIndent);\n        }\n        if (this.viewer.owner.searchModule) {\n            // tslint:disable-next-line:max-line-length\n            if (!isNullOrUndefined(page.viewer.owner.searchModule.searchHighlighters) && page.viewer.owner.searchModule.searchHighlighters.containsKey(lineWidget)) {\n                var widgetInfo = page.viewer.owner.searchModule.searchHighlighters.get(lineWidget);\n                for (var i = 0; i < widgetInfo.length; i++) {\n                    this.pageContext.fillStyle = '#ffe97f';\n                    // tslint:disable-next-line:max-line-length\n                    this.pageContext.fillRect(this.getScaledValue(widgetInfo[i].left, 1), this.getScaledValue(top, 2), this.getScaledValue(widgetInfo[i].width), this.getScaledValue(lineWidget.height));\n                }\n            }\n        }\n        for (var i = 0; i < lineWidget.children.length; i++) {\n            var elementBox = lineWidget.children[i];\n            if (elementBox instanceof FieldElementBox || this.isFieldCode ||\n                (elementBox.width === 0 && elementBox.height === 0)) {\n                if (this.isFieldCode) {\n                    elementBox.width = 0;\n                }\n                left += elementBox.width + elementBox.margin.left;\n                this.toSkipFieldCode(elementBox);\n                continue;\n            }\n            var underlineY = this.getUnderlineYPosition(lineWidget);\n            if (!this.isPrinting) {\n                if (this.getScaledValue(top + elementBox.margin.top, 2) + elementBox.height * this.viewer.zoomFactor < 0 ||\n                    this.getScaledValue(top + elementBox.margin.top, 2) > this.viewer.visibleBounds.height) {\n                    left += elementBox.width + elementBox.margin.left;\n                    continue;\n                }\n            }\n            if (elementBox instanceof ListTextElementBox) {\n                this.renderListTextElementBox(elementBox, left, top, underlineY);\n            }\n            else if (elementBox instanceof ImageElementBox) {\n                this.renderImageElementBox(elementBox, left, top, underlineY);\n            }\n            else {\n                this.renderTextElementBox(elementBox, left, top, underlineY);\n            }\n            left += elementBox.width + elementBox.margin.left;\n        }\n    };\n    Renderer.prototype.toSkipFieldCode = function (element) {\n        if (element instanceof FieldElementBox) {\n            if (element.fieldType === 0) {\n                if ((!isNullOrUndefined(element.fieldEnd) || element.hasFieldEnd)) {\n                    this.isFieldCode = true;\n                }\n            }\n            else if (element.fieldType === 2 || element.fieldType === 1) {\n                this.isFieldCode = false;\n            }\n        }\n    };\n    /**\n     * Gets underline y position.\n     * @param {LineWidget} lineWidget\n     */\n    Renderer.prototype.getUnderlineYPosition = function (lineWidget) {\n        var height = 0;\n        var lineHeight = 0;\n        for (var i = 0; i < lineWidget.children.length; i++) {\n            if (lineWidget.children[i] instanceof FieldElementBox ||\n                (lineWidget.children[i].width === 0 && lineWidget.children[i].height === 0)) {\n                continue;\n            }\n            if (height < lineWidget.children[i].height + lineWidget.children[i].margin.top) {\n                height = lineWidget.children[i].margin.top + lineWidget.children[i].height;\n                lineHeight = lineWidget.children[i].height / 20;\n            }\n        }\n        return height - 2 * lineHeight;\n    };\n    /**\n     * Renders list element box\n     * @param {ListTextElementBox} elementBox\n     * @param {number} left\n     * @param {number} top\n     * @param {number} underlineY\n     */\n    Renderer.prototype.renderListTextElementBox = function (elementBox, left, top, underlineY) {\n        var topMargin = elementBox.margin.top;\n        var leftMargin = elementBox.margin.left;\n        var format = elementBox.listLevel.characterFormat;\n        var breakCharacterFormat = elementBox.line.paragraph.characterFormat;\n        var color = format.fontColor === '#000000' ? breakCharacterFormat.fontColor : format.fontColor;\n        this.pageContext.textBaseline = 'top';\n        var bold = '';\n        var italic = '';\n        var fontFamily = format.fontFamily === 'Verdana' ? breakCharacterFormat.fontFamily : format.fontFamily;\n        var fontSize = format.fontSize === 11 ? breakCharacterFormat.fontSize : format.fontSize;\n        // tslint:disable-next-line:max-line-length\n        var baselineAlignment = format.baselineAlignment === 'Normal' ? breakCharacterFormat.baselineAlignment : format.baselineAlignment;\n        bold = format.bold ? 'bold' : breakCharacterFormat.bold ? 'bold' : '';\n        italic = format.italic ? 'italic' : breakCharacterFormat.italic ? 'italic' : '';\n        fontSize = fontSize === 0 ? 0.5 : fontSize / (baselineAlignment === 'Normal' ? 1 : 1.5);\n        var strikethrough = format.strikethrough === 'None' ? breakCharacterFormat.strikethrough : format.strikethrough;\n        var highlightColor = format.highlightColor === 'NoColor' ? breakCharacterFormat.highlightColor :\n            format.highlightColor;\n        if (highlightColor !== 'NoColor') {\n            if (highlightColor.substring(0, 1) !== '#') {\n                this.pageContext.fillStyle = HelperMethods.getHighlightColorCode(highlightColor);\n            }\n            else {\n                this.pageContext.fillStyle = this.getColor(highlightColor);\n            }\n            // tslint:disable-next-line:max-line-length\n            this.pageContext.fillRect(this.getScaledValue(left + leftMargin, 1), this.getScaledValue(top + topMargin, 2), this.getScaledValue(elementBox.width), this.getScaledValue(elementBox.height));\n        }\n        this.pageContext.font = bold + ' ' + italic + ' ' + fontSize * this.viewer.zoomFactor + 'pt' + ' ' + fontFamily;\n        if (baselineAlignment === 'Subscript') {\n            topMargin += elementBox.height - elementBox.height / 1.5;\n        }\n        this.pageContext.fillStyle = this.getColor(color);\n        // tslint:disable-next-line:max-line-length\n        this.pageContext.fillText(elementBox.text, this.getScaledValue(left + leftMargin, 1), this.getScaledValue(top + topMargin, 2), this.getScaledValue(elementBox.width));\n        if (format.underline !== 'None' && !isNullOrUndefined(format.underline)) {\n            this.renderUnderline(elementBox, left, top, underlineY, color, format.underline, baselineAlignment);\n        }\n        if (strikethrough !== 'None') {\n            this.renderStrikeThrough(elementBox, left, top, format.strikethrough, color, baselineAlignment);\n        }\n    };\n    /**\n     * Renders text element box.\n     * @param {TextElementBox} elementBox\n     * @param {number} left\n     * @param {number} top\n     * @param {number} underlineY\n     */\n    // tslint:disable-next-line:max-line-length\n    Renderer.prototype.renderTextElementBox = function (elementBox, left, top, underlineY) {\n        var isHeightType = false;\n        var containerWidget = elementBox.line.paragraph.containerWidget;\n        if (containerWidget instanceof TableCellWidget) {\n            isHeightType = (containerWidget.ownerRow.rowFormat.heightType === 'Exactly');\n        }\n        var topMargin = elementBox.margin.top;\n        var leftMargin = elementBox.margin.left;\n        if (isHeightType) {\n            // tslint:disable-next-line:max-line-length\n            this.clipRect(containerWidget.x, containerWidget.y, this.getScaledValue(containerWidget.width), this.getScaledValue(containerWidget.height));\n        }\n        var format = elementBox.characterFormat;\n        if (format.highlightColor !== 'NoColor') {\n            if (format.highlightColor.substring(0, 1) !== '#') {\n                this.pageContext.fillStyle = HelperMethods.getHighlightColorCode(format.highlightColor);\n            }\n            else {\n                this.pageContext.fillStyle = this.getColor(format.highlightColor);\n            }\n            // tslint:disable-next-line:max-line-length\n            this.pageContext.fillRect(this.getScaledValue(left + leftMargin, 1), this.getScaledValue(top + topMargin, 2), this.getScaledValue(elementBox.width), this.getScaledValue(elementBox.height));\n        }\n        var color = format.fontColor;\n        this.pageContext.textBaseline = 'top';\n        var bold = '';\n        var italic = '';\n        var fontSize = 11;\n        bold = format.bold ? 'bold' : '';\n        italic = format.italic ? 'italic' : '';\n        fontSize = format.fontSize === 0 ? 0.5 : format.fontSize / (format.baselineAlignment === 'Normal' ? 1 : 1.5);\n        this.pageContext.font = bold + ' ' + italic + ' ' + fontSize * this.viewer.zoomFactor + 'pt' + ' ' + format.fontFamily;\n        if (format.baselineAlignment === 'Subscript') {\n            topMargin += elementBox.height - elementBox.height / 1.5;\n        }\n        this.pageContext.fillStyle = this.getColor(color);\n        var scaledWidth = this.getScaledValue(elementBox.width);\n        var text = elementBox.text;\n        // tslint:disable-next-line:max-line-length\n        if (elementBox instanceof TabElementBox) {\n            var tabElement = elementBox;\n            if (tabElement.tabText === '' && !isNullOrUndefined(tabElement.tabLeader) && tabElement.tabLeader !== 'None') {\n                text = this.getTabLeader(elementBox);\n                tabElement.tabText = text;\n            }\n            else if (tabElement.tabText !== '') {\n                text = tabElement.tabText;\n            }\n        }\n        // tslint:disable-next-line:max-line-length\n        this.pageContext.fillText(text, this.getScaledValue(left + leftMargin, 1), this.getScaledValue(top + topMargin, 2), scaledWidth);\n        if (format.underline !== 'None' && !isNullOrUndefined(format.underline)) {\n            // tslint:disable-next-line:max-line-length\n            this.renderUnderline(elementBox, left, top, underlineY, color, format.underline, format.baselineAlignment);\n        }\n        if (format.strikethrough !== 'None' && !isNullOrUndefined(format.strikethrough)) {\n            this.renderStrikeThrough(elementBox, left, top, format.strikethrough, color, format.baselineAlignment);\n        }\n        if (isHeightType) {\n            this.pageContext.restore();\n        }\n    };\n    /**\n     * Returns tab leader\n     */\n    Renderer.prototype.getTabLeader = function (elementBox) {\n        var textWidth = 0;\n        var tabString = this.getTabLeaderString(elementBox.tabLeader);\n        var tabText = tabString;\n        textWidth = this.viewer.textHelper.getWidth(tabText, elementBox.characterFormat);\n        var count = Math.floor(elementBox.width / textWidth);\n        for (var i = 0; i <= count; i++) {\n            tabText += tabString;\n        }\n        return tabText.slice(0, -1);\n    };\n    /**\n     * Returns tab leader string.\n     */\n    Renderer.prototype.getTabLeaderString = function (tabLeader) {\n        var tabString = '';\n        switch (tabLeader) {\n            case 'Dot':\n                tabString = '.';\n                break;\n            case 'Hyphen':\n                tabString = '-';\n                break;\n            case 'Underscore':\n                tabString = '_';\n                break;\n        }\n        return tabString;\n    };\n    /**\n     * Clips the rectangle with specified position.\n     * @param {number} xPos\n     * @param {number} yPos\n     * @param {number} width\n     * @param {number} height\n     */\n    Renderer.prototype.clipRect = function (xPos, yPos, width, height) {\n        this.pageContext.beginPath();\n        this.pageContext.save();\n        this.pageContext.rect(this.getScaledValue(xPos, 1), this.getScaledValue(yPos, 2), width, height);\n        this.pageContext.clip();\n    };\n    /**\n     * Renders underline.\n     * @param {ElementBox} elementBox\n     * @param {number} left\n     * @param {number} top\n     * @param {number} underlineY\n     * @param {string} color\n     * @param {Underline} underline\n     * @param {BaselineAlignment} baselineAlignment\n     */\n    // tslint:disable-next-line:max-line-length\n    Renderer.prototype.renderUnderline = function (elementBox, left, top, underlineY, color, underline, baselineAlignment) {\n        var renderedHeight = elementBox.height / (baselineAlignment === 'Normal' ? 1 : 1.5);\n        var topMargin = elementBox.margin.top;\n        var underlineHeight = renderedHeight / 20;\n        var y = 0;\n        if (baselineAlignment === 'Subscript' || elementBox instanceof ListTextElementBox) {\n            y = (renderedHeight - 2 * underlineHeight) + top;\n            topMargin += elementBox.height - renderedHeight;\n            y += topMargin > 0 ? topMargin : 0;\n        }\n        else {\n            y = underlineY + top;\n        }\n        // tslint:disable-next-line:max-line-length\n        this.pageContext.fillRect(this.getScaledValue(left + elementBox.margin.left, 1), this.getScaledValue(y, 2), this.getScaledValue(elementBox.width), this.getScaledValue(underlineHeight));\n    };\n    /**\n     * Renders strike through.\n     * @param {ElementBox} elementBox\n     * @param {number} left\n     * @param {number} top\n     * @param {Strikethrough} strikethrough\n     * @param {string} color\n     * @param {BaselineAlignment} baselineAlignment\n     */\n    // tslint:disable-next-line:max-line-length\n    Renderer.prototype.renderStrikeThrough = function (elementBox, left, top, strikethrough, color, baselineAlignment) {\n        var renderedHeight = elementBox.height / (baselineAlignment === 'Normal' ? 1 : 1.5);\n        var topMargin = elementBox.margin.top;\n        if (baselineAlignment === 'Subscript') {\n            topMargin += elementBox.height - renderedHeight;\n        }\n        top += topMargin > 0 ? topMargin : 0;\n        var lineHeight = renderedHeight / 20;\n        var y = (renderedHeight / 2) + (0.5 * lineHeight);\n        var lineCount = 0;\n        if (strikethrough === 'DoubleStrike') {\n            y -= lineHeight;\n        }\n        while (lineCount < (strikethrough === 'DoubleStrike' ? 2 : 1)) {\n            lineCount++;\n            // tslint:disable-next-line:max-line-length\n            this.pageContext.fillRect(this.getScaledValue(left + elementBox.margin.left, 1), this.getScaledValue(y + top, 2), this.getScaledValue(elementBox.width), this.getScaledValue(lineHeight));\n            y += 2 * lineHeight;\n        }\n    };\n    /**\n     * Renders image element box.\n     * @param {ImageElementBox} elementBox\n     * @param {number} left\n     * @param {number} top\n     * @param {number} underlineY\n     */\n    // tslint:disable-next-line:max-line-length\n    Renderer.prototype.renderImageElementBox = function (elementBox, left, top, underlineY) {\n        var topMargin = elementBox.margin.top;\n        var leftMargin = elementBox.margin.left;\n        var color = 'black';\n        this.pageContext.textBaseline = 'top';\n        var widgetWidth = 0;\n        var isClipped = false;\n        if (topMargin < 0 || elementBox.line.paragraph.width < elementBox.width) {\n            var containerWid = elementBox.line.paragraph.containerWidget;\n            // if (containerWid instanceof BodyWidget) {\n            //     widgetWidth = containerWid.width + containerWid.x;\n            // } else \n            if (containerWid instanceof TableCellWidget) {\n                var leftIndent = 0;\n                if (containerWid.childWidgets[0] instanceof ParagraphWidget) {\n                    var paraAdv = containerWid.childWidgets[0];\n                    leftIndent = paraAdv.paragraphFormat.leftIndent;\n                }\n                widgetWidth = containerWid.width + containerWid.margin.left - containerWid.leftBorderWidth - leftIndent;\n                isClipped = true;\n                // tslint:disable-next-line:max-line-length\n                this.clipRect(left + leftMargin, top + topMargin, this.getScaledValue(widgetWidth), this.getScaledValue(containerWid.height));\n            }\n        }\n        if (elementBox.isMetaFile) {\n            /* tslint:disable:no-empty */\n        }\n        else {\n            // tslint:disable-next-line:max-line-length\n            this.pageContext.drawImage(elementBox.element, this.getScaledValue(left + leftMargin, 1), this.getScaledValue(top + topMargin, 2), this.getScaledValue(elementBox.width), this.getScaledValue(elementBox.height));\n        }\n        if (isClipped) {\n            this.pageContext.restore();\n        }\n    };\n    /**\n     * Renders table outline.\n     * @param {TableWidget} tableWidget\n     */\n    Renderer.prototype.renderTableOutline = function (tableWidget) {\n        var layout = new Layout(this.viewer);\n        var table = tableWidget;\n        tableWidget.width = this.viewer.layout.getTableWidth(table);\n        var border = layout.getTableTopBorder(table.tableFormat.borders);\n        var lineWidth = 0;\n        //ToDo: Need to draw the borders based on the line style.\n        // if (!isNullOrUndefined(border )) {\n        lineWidth = HelperMethods.convertPointToPixel(border.getLineWidth());\n        // tslint:disable-next-line:max-line-length\n        this.renderSingleBorder(border, tableWidget.x - tableWidget.margin.left - lineWidth / 2, tableWidget.y, tableWidget.x - tableWidget.margin.left - lineWidth / 2, tableWidget.y + tableWidget.height, lineWidth);\n        // }\n        border = layout.getTableTopBorder(table.tableFormat.borders);\n        lineWidth = 0;\n        // if (!isNullOrUndefined(border )) {\n        lineWidth = HelperMethods.convertPointToPixel(border.getLineWidth());\n        // tslint:disable-next-line:max-line-length\n        this.renderSingleBorder(border, tableWidget.x - tableWidget.margin.left - lineWidth, tableWidget.y - lineWidth / 2, tableWidget.x + tableWidget.width + lineWidth + tableWidget.margin.right, tableWidget.y - lineWidth / 2, lineWidth);\n        // }\n        border = layout.getTableRightBorder(table.tableFormat.borders);\n        lineWidth = 0;\n        // if (!isNullOrUndefined(border )) {\n        lineWidth = HelperMethods.convertPointToPixel(border.getLineWidth());\n        // tslint:disable-next-line:max-line-length\n        this.renderSingleBorder(border, tableWidget.x + tableWidget.width + tableWidget.margin.right + lineWidth / 2, tableWidget.y, tableWidget.x + tableWidget.width + tableWidget.margin.right + lineWidth / 2, tableWidget.y + tableWidget.height, lineWidth);\n        // }\n        border = layout.getTableBottomBorder(table.tableFormat.borders);\n        lineWidth = 0;\n        // if (!isNullOrUndefined(border )) {\n        lineWidth = HelperMethods.convertPointToPixel(border.getLineWidth());\n        // tslint:disable-next-line:max-line-length\n        this.renderSingleBorder(border, tableWidget.x - tableWidget.margin.left - lineWidth, tableWidget.y + tableWidget.height - lineWidth / 2, tableWidget.x + tableWidget.width + lineWidth + tableWidget.margin.right, tableWidget.y + tableWidget.height - lineWidth / 2, lineWidth);\n        // }\n    };\n    /**\n     * Renders table cell outline.\n     * @param {LayoutViewer} viewer\n     * @param {TableCellWidget} cellWidget\n     */\n    Renderer.prototype.renderTableCellOutline = function (viewer, cellWidget) {\n        var layout = viewer.layout;\n        var borders = undefined;\n        var tableCell = cellWidget;\n        var cellTopMargin = 0;\n        var cellBottomMargin = 0;\n        var cellLeftMargin = 0;\n        var cellRightMargin = 0;\n        var height = 0;\n        borders = tableCell.cellFormat.borders;\n        if (cellWidget.containerWidget instanceof TableRowWidget) {\n            cellBottomMargin = cellWidget.margin.bottom - cellWidget.containerWidget.bottomBorderWidth;\n            cellTopMargin = cellWidget.margin.top - cellWidget.containerWidget.topBorderWidth;\n        }\n        cellLeftMargin = cellWidget.margin.left - cellWidget.leftBorderWidth;\n        cellRightMargin = cellWidget.margin.right - cellWidget.rightBorderWidth;\n        if (!isNullOrUndefined(tableCell.ownerRow) && tableCell.ownerRow.rowFormat.heightType === 'Exactly') {\n            height = HelperMethods.convertPointToPixel(tableCell.ownerRow.rowFormat.height) + cellTopMargin + cellBottomMargin;\n        }\n        else {\n            if (!isNullOrUndefined(tableCell.ownerRow) && [tableCell.ownerRow].length <= 1) {\n                // tslint:disable-next-line:max-line-length\n                height = Math.max(HelperMethods.convertPointToPixel(tableCell.ownerRow.rowFormat.height), cellWidget.height) + cellTopMargin + cellBottomMargin;\n            }\n            else {\n                height = cellWidget.height + cellTopMargin + cellBottomMargin;\n            }\n        }\n        this.renderCellBackground(height, cellWidget);\n        var border = TableCellWidget.getCellLeftBorder(tableCell);\n        var lineWidth = 0;\n        // if (!isNullOrUndefined(border )) {       \n        lineWidth = HelperMethods.convertPointToPixel(border.getLineWidth()); //Renders the cell left border.\n        // tslint:disable-next-line:max-line-length\n        this.renderSingleBorder(border, cellWidget.x - cellLeftMargin - lineWidth, cellWidget.y - cellTopMargin, cellWidget.x - cellLeftMargin - lineWidth, cellWidget.y + cellWidget.height + cellBottomMargin, lineWidth);\n        // }\n        border = TableCellWidget.getCellTopBorder(tableCell);\n        // if (!isNullOrUndefined(border )) { //Renders the cell top border.        \n        lineWidth = HelperMethods.convertPointToPixel(border.getLineWidth());\n        // tslint:disable-next-line:max-line-length\n        this.renderSingleBorder(border, cellWidget.x - cellWidget.margin.left, cellWidget.y - cellWidget.margin.top + lineWidth / 2, cellWidget.x + cellWidget.width + cellWidget.margin.right, cellWidget.y - cellWidget.margin.top + lineWidth / 2, lineWidth);\n        // }\n        if (tableCell.ownerTable.tableFormat.cellSpacing > 0 || tableCell.cellIndex === tableCell.ownerRow.childWidgets.length - 1) {\n            border = TableCellWidget.getCellRightBorder(tableCell);\n            // if (!isNullOrUndefined(border )) { //Renders the cell right border.           \n            lineWidth = HelperMethods.convertPointToPixel(border.getLineWidth());\n            // tslint:disable-next-line:max-line-length\n            this.renderSingleBorder(border, cellWidget.x + cellWidget.width + cellWidget.margin.right - lineWidth / 2, cellWidget.y - cellTopMargin, cellWidget.x + cellWidget.width + cellWidget.margin.right - lineWidth / 2, cellWidget.y + cellWidget.height + cellBottomMargin, lineWidth);\n            // }\n        }\n        var nextRow = tableCell.ownerRow.nextWidget;\n        //Specifies the next row is within the current table widget.\n        //True means current row is not rendered at page end; Otherwise False.\n        var nextRowIsInCurrentTableWidget = false;\n        if (!isNullOrUndefined(nextRow)) {\n            var nextRowWidget = undefined;\n            // if (viewer.renderedElements.containsKey(nextRow) && viewer.renderedElements.get(nextRow).length > 0) {\n            nextRowWidget = nextRow;\n            // }\n            if (nextRowWidget instanceof TableRowWidget) {\n                // tslint:disable-next-line:max-line-length\n                if (cellWidget.containerWidget instanceof TableRowWidget && cellWidget.containerWidget.containerWidget instanceof TableWidget) {\n                    nextRowIsInCurrentTableWidget = cellWidget.containerWidget.containerWidget.childWidgets.indexOf(nextRowWidget) !== -1;\n                }\n            }\n        }\n        if (tableCell.ownerTable.tableFormat.cellSpacing > 0 || tableCell.ownerRow.rowIndex === tableCell.ownerTable.childWidgets.length - 1\n            || (tableCell.cellFormat.rowSpan > 1\n                && tableCell.ownerRow.rowIndex + tableCell.cellFormat.rowSpan === tableCell.ownerTable.childWidgets.length) ||\n            !nextRowIsInCurrentTableWidget) {\n            // tslint:disable-next-line:max-line-length\n            border = (tableCell.cellFormat.rowSpan > 1 && tableCell.ownerRow.rowIndex + tableCell.cellFormat.rowSpan === tableCell.ownerTable.childWidgets.length) ?\n                //true part for vertically merged cells specifically.\n                tableCell.getBorderBasedOnPriority(tableCell.cellFormat.borders.bottom, TableCellWidget.getCellBottomBorder(tableCell))\n                //false part for remaining cases that has been handled inside method. \n                : TableCellWidget.getCellBottomBorder(tableCell);\n            // if (!isNullOrUndefined(border )) {\n            //Renders the cell bottom border.\n            lineWidth = HelperMethods.convertPointToPixel(border.getLineWidth());\n            // tslint:disable-next-line:max-line-length\n            this.renderSingleBorder(border, cellWidget.x - cellWidget.margin.left, cellWidget.y + cellWidget.height + cellBottomMargin + lineWidth / 2, cellWidget.x + cellWidget.width + cellWidget.margin.right, cellWidget.y + cellWidget.height + cellBottomMargin + lineWidth / 2, lineWidth);\n            // }\n        }\n        border = layout.getCellDiagonalUpBorder(tableCell);\n        // if (!isNullOrUndefined(border )) {\n        //Renders the cell diagonal up border.\n        lineWidth = HelperMethods.convertPointToPixel(border.getLineWidth());\n        if (lineWidth > 0) {\n            // tslint:disable-next-line:max-line-length\n            this.renderSingleBorder(border, cellWidget.x - cellLeftMargin, cellWidget.y + cellWidget.height + cellBottomMargin, cellWidget.x + cellWidget.width + cellRightMargin, cellWidget.y - cellTopMargin, lineWidth);\n            // }\n        }\n        border = layout.getCellDiagonalDownBorder(tableCell);\n        // if (!isNullOrUndefined(border )) {\n        //Renders the cell diagonal down border.\n        lineWidth = HelperMethods.convertPointToPixel(border.getLineWidth());\n        if (lineWidth > 0) {\n            // tslint:disable-next-line:max-line-length\n            this.renderSingleBorder(border, cellWidget.x - cellLeftMargin, cellWidget.y - cellTopMargin, cellWidget.x + cellWidget.width + cellRightMargin, cellWidget.y + cellWidget.height + cellBottomMargin, lineWidth);\n        }\n        // }\n    };\n    /**\n     * Renders cell background.\n     * @param {number} height\n     * @param {TableCellWidget} cellWidget\n     */\n    Renderer.prototype.renderCellBackground = function (height, cellWidget) {\n        var cellFormat = cellWidget.cellFormat;\n        var bgColor = cellFormat.shading.backgroundColor === '#ffffff' ?\n            cellWidget.ownerTable.tableFormat.shading.backgroundColor : cellFormat.shading.backgroundColor;\n        this.pageContext.beginPath();\n        if (bgColor !== 'empty') {\n            this.pageContext.fillStyle = this.getColor(bgColor);\n            var left = cellWidget.x - cellWidget.margin.left + cellWidget.leftBorderWidth;\n            var top_1 = cellWidget.y - HelperMethods.convertPointToPixel(cellWidget.topMargin);\n            // tslint:disable-next-line:max-line-length\n            var width = cellWidget.width + cellWidget.margin.left + cellWidget.margin.right - cellWidget.leftBorderWidth - cellWidget.rightBorderWidth;\n            // tslint:disable-next-line:max-line-length\n            this.pageContext.fillRect(this.getScaledValue(left, 1), this.getScaledValue(top_1, 2), this.getScaledValue(width), this.getScaledValue(height));\n            this.pageContext.closePath();\n        }\n    };\n    /**\n     * Renders single border.\n     * @param {WBorder} border\n     * @param {number} startX\n     * @param {number} startY\n     * @param {number} endX\n     * @param {number} endY\n     * @param {number} lineWidth\n     */\n    // tslint:disable-next-line:max-line-length\n    Renderer.prototype.renderSingleBorder = function (border, startX, startY, endX, endY, lineWidth) {\n        this.pageContext.beginPath();\n        this.pageContext.moveTo(this.getScaledValue(startX, 1), this.getScaledValue(startY, 2));\n        this.pageContext.lineTo(this.getScaledValue(endX, 1), this.getScaledValue(endY, 2));\n        this.pageContext.lineWidth = this.getScaledValue(lineWidth);\n        // set line color\n        this.pageContext.strokeStyle = border.color;\n        if (lineWidth > 0) {\n            this.pageContext.stroke();\n        }\n        this.pageContext.closePath();\n    };\n    /**\n     * Gets scaled value.\n     * @param {number} value\n     * @param {number} type\n     * @private\n     */\n    Renderer.prototype.getScaledValue = function (value, type) {\n        if (this.isPrinting) {\n            return value;\n        }\n        if (isNullOrUndefined(type)) {\n            type = 0;\n        }\n        var x = value * this.viewer.zoomFactor;\n        return x + (type === 1 ? this.pageLeft : (type === 2 ? this.pageTop : 0));\n    };\n    /**\n     * Destroys the internal objects which is maintained.\n     */\n    Renderer.prototype.destroy = function () {\n        this.viewer = undefined;\n        if (!isNullOrUndefined(this.pageCanvasIn)) {\n            this.pageCanvasIn.innerHTML = '';\n        }\n        this.pageCanvasIn = undefined;\n    };\n    return Renderer;\n}());\nexport { Renderer };\n","import { isNullOrUndefined } from '@syncfusion/ej2-base';\nimport { WCharacterFormat } from '../index';\nimport { HelperMethods } from '../editor/editor-helper';\n/**\n * @private\n */\nvar TextHelper = /** @class */ (function () {\n    function TextHelper(viewer) {\n        this.owner = viewer;\n        if (!isNullOrUndefined(viewer)) {\n            this.context = viewer.containerContext;\n        }\n    }\n    Object.defineProperty(TextHelper.prototype, \"paragraphMark\", {\n        get: function () {\n            return 'Â¶';\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(TextHelper.prototype, \"lineBreakMark\", {\n        get: function () {\n            return 'â†²';\n        },\n        enumerable: true,\n        configurable: true\n    });\n    /**\n     * @private\n     */\n    TextHelper.prototype.getParagraphMarkWidth = function (characterFormat) {\n        return this.getWidth(this.paragraphMark, characterFormat);\n    };\n    /**\n     * @private\n     */\n    TextHelper.prototype.getParagraphMarkSize = function (characterFormat) {\n        // Gets the text element's width;\n        var width = this.getWidth(this.paragraphMark, characterFormat);\n        var height = 0;\n        var baselineOffset = 0;\n        // Calculate the text element's height and baseline offset.\n        var textHelper = this.getHeight(characterFormat);\n        return {\n            'Width': width, 'Height': textHelper.Height, 'BaselineOffset': textHelper.BaselineOffset\n        };\n    };\n    /**\n     * @private\n     */\n    TextHelper.prototype.getTextSize = function (elementBox, characterFormat) {\n        // Gets the text element's width;\n        var textTrimEndWidth = 0;\n        textTrimEndWidth = this.getWidth(elementBox.text, characterFormat);\n        elementBox.width = textTrimEndWidth;\n        // Calculate the text element's height and baseline offset.\n        var textHelper = this.getHeight(characterFormat);\n        elementBox.height = textHelper.Height;\n        elementBox.baselineOffset = textHelper.BaselineOffset;\n        if (elementBox.text[elementBox.text.length - 1] === ' ') {\n            textTrimEndWidth = this.getWidth(HelperMethods.trimEnd(elementBox.text), characterFormat);\n        }\n        return textTrimEndWidth;\n    };\n    /**\n     * @private\n     */\n    TextHelper.prototype.getHeight = function (characterFormat) {\n        // Get character format property as  below predefined structure to make it easy to check and retrieve\n        // Predefined static structure `[FontName];[FontSize];bold;italic` to maintain as key in the collection \n        var key = this.getFormatText(characterFormat);\n        if (!isNullOrUndefined(this.owner.heightInfoCollection[key])) {\n            return this.owner.heightInfoCollection[key];\n        }\n        var sizeInfo = this.getHeightInternal(characterFormat);\n        this.owner.heightInfoCollection[key] = sizeInfo;\n        return sizeInfo;\n    };\n    /**\n     * @private\n     */\n    TextHelper.prototype.getFormatText = function (characterFormat) {\n        var formatText = characterFormat.fontFamily.toLocaleLowerCase();\n        formatText += ';' + characterFormat.fontSize;\n        if (characterFormat.bold) {\n            formatText += ';' + 'bold';\n        }\n        if (characterFormat.italic) {\n            formatText += ';' + 'italic';\n        }\n        return formatText;\n    };\n    /**\n     * @private\n     */\n    TextHelper.prototype.getHeightInternal = function (characterFormat) {\n        var textHeight = 0;\n        var baselineOffset = 0;\n        var spanElement = document.createElement('span');\n        spanElement.id = 'tempSpan';\n        spanElement.style.whiteSpace = 'nowrap';\n        spanElement.innerText = 'm';\n        this.applyStyle(spanElement, characterFormat);\n        var body = document.getElementsByTagName('body');\n        var parentDiv = document.createElement('div');\n        parentDiv.style.display = 'inline-block';\n        var tempDiv = document.createElement('div');\n        tempDiv.setAttribute('style', 'display:inline-block;width: 1px; height: 0px;vertical-align: baseline;');\n        parentDiv.appendChild(spanElement);\n        parentDiv.appendChild(tempDiv);\n        document.body.appendChild(parentDiv);\n        // Sets the text element's height.\n        textHeight = spanElement.offsetHeight;\n        // Calculate the text element's baseline offset.\n        var textTopVal = spanElement.offsetTop;\n        var tempDivTopVal = tempDiv.offsetTop;\n        baselineOffset = tempDivTopVal - textTopVal;\n        document.body.removeChild(parentDiv);\n        return { 'Height': textHeight, 'BaselineOffset': baselineOffset };\n    };\n    /**\n     * @private\n     */\n    TextHelper.prototype.measureTextExcludingSpaceAtEnd = function (text, characterFormat) {\n        return this.getWidth(HelperMethods.trimEnd(text), characterFormat);\n    };\n    /**\n     * @private\n     */\n    TextHelper.prototype.getWidth = function (text, characterFormat) {\n        if (text.match('\\v')) {\n            text.replace('\\v', this.lineBreakMark);\n        }\n        var bold = '';\n        var italic = '';\n        var fontFamily = '';\n        var fontSize = characterFormat.fontSize;\n        bold = characterFormat.bold ? 'bold' : '';\n        italic = characterFormat.italic ? 'italic' : '';\n        fontFamily = characterFormat.fontFamily;\n        fontSize = fontSize === 0 ? 0.5 : fontSize / (characterFormat.baselineAlignment === 'Normal' ? 1 : 1.5);\n        this.context.font = bold + ' ' + italic + ' ' + fontSize + 'pt' + ' ' + fontFamily;\n        return this.context.measureText(text).width;\n    };\n    /**\n     * @private\n     */\n    TextHelper.prototype.applyStyle = function (spanElement, characterFormat) {\n        if (!isNullOrUndefined(spanElement) && !isNullOrUndefined(characterFormat)) {\n            if (characterFormat.fontFamily !== '') {\n                spanElement.style.fontFamily = characterFormat.fontFamily;\n            }\n            var fontSize = characterFormat.fontSize;\n            if (fontSize <= 0.5) {\n                fontSize = 0.5;\n            }\n            spanElement.style.fontSize = fontSize.toString() + 'pt';\n            if (characterFormat.bold) {\n                spanElement.style.fontWeight = 'bold';\n            }\n            if (characterFormat.italic) {\n                spanElement.style.fontStyle = 'italic';\n            }\n        }\n    };\n    /**\n     * @private\n     */\n    TextHelper.prototype.measureText = function (text, characterFormat) {\n        // Gets the text element's width;\n        var width = this.getWidth(text, characterFormat);\n        var height = 0;\n        var baselineOffset = 0;\n        // Calculate the text element's height and baseline offset.\n        var textHelper = this.getHeight(characterFormat);\n        return {\n            'Width': width, 'Height': textHelper.Height, 'BaselineOffset': textHelper.BaselineOffset\n        };\n    };\n    /**\n     * @private\n     */\n    TextHelper.prototype.updateTextSize = function (elementBox, paragraph) {\n        var format = new WCharacterFormat(undefined);\n        var listCharacterFormat = elementBox.listLevel.characterFormat;\n        var breakCharacterFormat = paragraph.characterFormat;\n        format.fontSize = listCharacterFormat.fontSize === 11 ? breakCharacterFormat.fontSize : listCharacterFormat.fontSize;\n        format.fontFamily = listCharacterFormat.fontFamily === 'Verdana' ? breakCharacterFormat.fontFamily\n            : listCharacterFormat.fontFamily;\n        var bold = '';\n        var italic = '';\n        var baselineAlignment = listCharacterFormat.baselineAlignment === 'Normal' ?\n            breakCharacterFormat.baselineAlignment : listCharacterFormat.baselineAlignment;\n        bold = listCharacterFormat.bold ? 'bold' : breakCharacterFormat.bold ? 'bold' : '';\n        italic = listCharacterFormat.italic ? 'italic' : breakCharacterFormat.italic ? 'italic' : '';\n        format.baselineAlignment = baselineAlignment;\n        if (bold) {\n            format.bold = true;\n        }\n        if (italic) {\n            format.italic = true;\n        }\n        elementBox.width = this.getWidth(elementBox.text, format);\n        // Calculate the text element's height and baseline offset.\n        var textHelper = this.getHeight(format);\n        elementBox.height = textHelper.Height;\n        elementBox.baselineOffset = textHelper.BaselineOffset;\n    };\n    TextHelper.prototype.destroy = function () {\n        this.owner = undefined;\n        this.context = undefined;\n    };\n    return TextHelper;\n}());\nexport { TextHelper };\n","import { isNullOrUndefined } from '@syncfusion/ej2-base';\n/**\n * @private\n */\nvar Zoom = /** @class */ (function () {\n    function Zoom(viewer) {\n        var _this = this;\n        this.onMouseWheelInternal = function (event) {\n            if (event.ctrlKey === true) {\n                event.preventDefault();\n                var pageX = event.pageX - _this.viewer.viewerContainer.offsetLeft;\n                if (pageX < _this.viewer.pageContainer.offsetWidth) {\n                    var wheel = navigator.userAgent.match('Firefox') ? event.detail < 0 : event.wheelDelta > 0;\n                    var zoomFactor = _this.viewer.zoomFactor;\n                    if (wheel) {\n                        if (zoomFactor <= 4.90) {\n                            zoomFactor += .10;\n                        }\n                        else {\n                            zoomFactor = 5.00;\n                        }\n                    }\n                    else {\n                        if (zoomFactor >= .20) {\n                            zoomFactor -= .10;\n                        }\n                        else {\n                            zoomFactor = 0.10;\n                        }\n                    }\n                    _this.viewer.zoomFactor = zoomFactor;\n                }\n            }\n        };\n        this.viewer = viewer;\n    }\n    Zoom.prototype.setZoomFactor = function (value) {\n        this.onZoomFactorChanged();\n        if (!isNullOrUndefined(this.viewer.selection)) {\n            this.viewer.selection.updateCaretPosition();\n        }\n        this.viewer.updateTouchMarkPosition();\n        if (!isNullOrUndefined(this.viewer.owner.imageResizerModule)) {\n            this.viewer.owner.imageResizerModule.updateImageResizerPosition();\n        }\n        this.viewer.owner.fireZoomFactorChange();\n    };\n    //Zoom Implementation Starts\n    Zoom.prototype.onZoomFactorChanged = function () {\n        if (this.viewer.zoomFactor > 5) {\n            this.viewer.zoomFactor = 5;\n        }\n        else if (this.viewer.zoomFactor < 0.1) {\n            this.viewer.zoomFactor = 0.1;\n        }\n        this.zoom();\n    };\n    Zoom.prototype.zoom = function () {\n        var viewer = this.viewer;\n        viewer.clearContent();\n        viewer.handleZoom();\n        viewer.updateFocus();\n    };\n    return Zoom;\n}());\nexport { Zoom };\n","var __extends = (this && this.__extends) || (function () {\n    var extendStatics = Object.setPrototypeOf ||\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nimport { Dictionary } from '../../base/dictionary';\nimport { WAbstractList } from '../list/abstract-list';\nimport { WLevelOverride } from '../list/level-override';\nimport { WCharacterFormat, WParagraphFormat, WStyles } from '../format/index';\nimport { Layout } from './layout';\nimport { Renderer } from './render';\nimport { createElement, Browser } from '@syncfusion/ej2-base';\nimport { Page, Rect, ListTextElementBox, ParagraphWidget, HeaderFooterWidget } from './page';\nimport { LineWidget, TableWidget } from './page';\nimport { HelperMethods, Point } from '../editor/editor-helper';\nimport { TextHelper } from './text-helper';\nimport { isNullOrUndefined } from '@syncfusion/ej2-base';\nimport { Zoom } from './zooming';\nimport { Dialog } from '@syncfusion/ej2-popups';\n/**\n * @private\n */\nvar LayoutViewer = /** @class */ (function () {\n    //#endregion\n    function LayoutViewer(owner) {\n        var _this = this;\n        /**\n         * @private\n         */\n        this.textWrap = true;\n        /**\n         * @private\n         */\n        this.currentPage = undefined;\n        this.selectionStartPageIn = undefined;\n        this.selectionEndPageIn = undefined;\n        /**\n         * @private\n         */\n        this.fieldStacks = [];\n        /**\n         * @private\n         */\n        this.splittedCellWidgets = [];\n        /**\n         * @private\n         */\n        this.tableLefts = [];\n        this.tapCount = 0;\n        this.timer = -1;\n        this.isTimerStarted = false;\n        /**\n         * @private\n         */\n        this.isFirstLineFitInShiftWidgets = false;\n        /**\n         * @private\n         */\n        this.preZoomFactor = 0;\n        /**\n         * @private\n         */\n        this.preDifference = -1;\n        /**\n         * @private\n         */\n        this.fieldEndParagraph = undefined;\n        /**\n         * @private\n         */\n        this.fieldToLayout = undefined;\n        /**\n         * @private\n         */\n        this.backgroundColor = '#FFFFFF';\n        /**\n         * @private\n         */\n        this.containerTop = 0;\n        /**\n         * @private\n         */\n        this.containerLeft = 0;\n        // Event \n        /**\n         * @private\n         */\n        this.isMouseDown = false;\n        /**\n         * @private\n         */\n        this.isSelectionChangedOnMouseMoved = false;\n        /**\n         * @private\n         */\n        this.isControlPressed = false;\n        /**\n         * @private\n         */\n        this.isTouchInput = false;\n        /**\n         * @private\n         */\n        this.useTouchSelectionMark = false;\n        /**\n         * @private\n         */\n        this.touchDownOnSelectionMark = 0;\n        /**\n         * @private\n         */\n        this.isCompositionStart = false;\n        /**\n         * @private\n         */\n        this.isCompositionUpdated = false;\n        /**\n         * @private\n         */\n        this.isCompositionCanceled = false;\n        /**\n         * @private\n         */\n        this.isCompositionEnd = false;\n        /**\n         * @private\n         */\n        this.prefix = '';\n        /**\n         * @private\n         */\n        this.suffix = '';\n        /**\n         * @private\n         */\n        this.fields = [];\n        /**\n         * @private\n         */\n        this.heightInfoCollection = {};\n        /**\n         * @private\n         */\n        this.defaultTabWidth = 36;\n        /**\n         * @private\n         */\n        this.lists = [];\n        /**\n         * @private\n         */\n        this.abstractLists = [];\n        /**\n         * @private\n         */\n        this.styles = new WStyles();\n        /**\n         * @private\n         */\n        this.preDefinedStyles = undefined;\n        /**\n         * @private\n         */\n        this.isRowOrCellResizing = false;\n        this.isMouseDownInFooterRegion = false;\n        this.pageFitTypeIn = 'None';\n        /**\n         * @private\n         */\n        this.fieldCollection = [];\n        /**\n         * @private\n         */\n        this.isPageField = false;\n        /**\n         * @private\n         */\n        this.mouseDownOffset = new Point(0, 0);\n        this.zoomFactorInternal = 1;\n        /**\n         * Fires when composition starts.\n         * @private\n         */\n        this.compositionStart = function (event) {\n            event.preventDefault();\n            _this.isCompositionStart = true;\n        };\n        /**\n         * Fires on every input during composition.\n         * @private\n         */\n        this.compositionUpdated = function (event) {\n            event.preventDefault();\n            _this.isCompositionUpdated = true;\n        };\n        /**\n         * Fires when user selects a character/word and finalizes the input.\n         * @private\n         */\n        this.compositionEnd = function (event) {\n            event.preventDefault();\n            _this.isCompositionUpdated = false;\n            _this.isCompositionEnd = true;\n        };\n        // tslint:disable:no-any \n        this.onImageResizer = function (args) {\n            if (!isNullOrUndefined(_this.owner.imageResizerModule) && _this.owner.imageResizerModule.isImageResizerVisible\n                && _this.owner.imageResizerModule.isImageResizing) {\n                if (args instanceof MouseEvent) {\n                    _this.onMouseUpInternal(args);\n                }\n                else if (args instanceof TouchEvent) {\n                    _this.onTouchUpInternal(args);\n                }\n            }\n        };\n        // tslint:enable:no-any \n        this.onKeyPressInternal = function (event) {\n            event.preventDefault();\n            if (!isNullOrUndefined(_this.selection)) {\n                var key = event.keyCode || event.charCode;\n                var char = '';\n                if (key) {\n                    char = String.fromCharCode(key);\n                }\n                else if (event.key) {\n                    char = event.key;\n                }\n                // tslint:disable-next-line:max-line-length\n                if (char !== 'Spacebar' && char !== '\\r' && char !== '\\b' && char !== '\\u001B' && !_this.owner.isReadOnlyMode && event.ctrlKey === false) {\n                    _this.owner.editorModule.handleTextInput(char);\n                }\n                else if (char === 'Spacebar') {\n                    _this.owner.editorModule.handleTextInput(' ');\n                }\n            }\n        };\n        this.onTextInputInternal = function (event) {\n            if (!_this.owner.isReadOnlyMode) {\n                _this.owner.editorModule.onTextInputInternal(event);\n            }\n            else {\n                _this.editableDiv.innerText = '';\n            }\n        };\n        /**\n         * Fired on paste.\n         * @param {ClipboardEvent} event\n         * @private\n         */\n        this.onPaste = function (event) {\n            if (!_this.owner.isReadOnlyMode) {\n                _this.owner.editorModule.pasteInternal(event);\n            }\n            _this.editableDiv.innerText = '';\n            event.preventDefault();\n        };\n        /**\n         * Fires when editable div loses focus.\n         * @private\n         */\n        this.onFocusOut = function () {\n            if (!isNullOrUndefined(_this.selection)) {\n                if (_this.owner.contextMenuModule && _this.owner.contextMenuModule.contextMenuInstance &&\n                    _this.owner.contextMenuModule.contextMenuInstance.element.style.display === 'block') {\n                    return;\n                }\n                _this.selection.hideCaret();\n            }\n        };\n        /**\n         * Updates focus to editor area.\n         * @private\n         */\n        this.updateFocus = function () {\n            if (_this.selection) {\n                _this.editableDiv.focus();\n                _this.selection.showCaret();\n            }\n        };\n        /**\n         * Fires on scrolling.\n         */\n        this.scrollHandler = function () {\n            _this.clearContent();\n            _this.updateScrollBars();\n            var vtHeight = _this.containerTop + _this.visibleBounds.height;\n            if (vtHeight > _this.pageContainer.offsetHeight) {\n                _this.viewerContainer.scrollTop = _this.containerTop - (vtHeight - _this.pageContainer.offsetHeight);\n            }\n            var viewer = _this;\n            if (viewer instanceof PageLayoutViewer && !isNullOrUndefined(_this.owner)) {\n                _this.owner.fireViewChange();\n            }\n        };\n        /**\n         * Fires when the window gets resized.\n         * @private\n         */\n        this.onWindowResize = function () {\n            var viewer = _this;\n            var resizeTimer;\n            /* tslint:disable:align */\n            resizeTimer = setTimeout(function () {\n                if (!isNullOrUndefined(viewer.owner) && !isNullOrUndefined(_this.owner.element)) {\n                    viewer.updateViewerSizeInternal(document.getElementById(viewer.owner.element.id));\n                    viewer.updateScrollBars();\n                    if (!isNullOrUndefined(_this.selection)) {\n                        _this.selection.updateCaretPosition();\n                    }\n                    viewer.updateTouchMarkPosition();\n                    if (viewer.owner.contextMenuModule && viewer.owner.contextMenuModule.contextMenuInstance) {\n                        viewer.owner.contextMenuModule.contextMenuInstance.close();\n                    }\n                    if (resizeTimer) {\n                        clearTimeout(resizeTimer);\n                    }\n                }\n            }, 100);\n        };\n        /**\n         * @private\n         */\n        this.onContextMenu = function (event) {\n            if (_this.owner.contextMenuModule) {\n                _this.owner.contextMenuModule.onContextMenuInternal(event);\n            }\n        };\n        /**\n         * Called on mouse down.\n         * @param {MouseEvent} event\n         * @private\n         */\n        this.onMouseDownInternal = function (event) {\n            if (_this.isTouchInput || event.offsetX > (_this.visibleBounds.width - (_this.visibleBounds.width - _this.viewerContainer.clientWidth))\n                || event.offsetY > (_this.visibleBounds.height - (_this.visibleBounds.height - _this.viewerContainer.clientHeight))) {\n                return;\n            }\n            if (!isNullOrUndefined(_this.selection)) {\n                _this.updateCursor(event);\n                // tslint:disable-next-line:max-line-length\n                if (_this.isLeftButtonPressed(event) && !_this.owner.isReadOnlyMode && _this.owner.enableImageResizerMode && !isNullOrUndefined(_this.owner.imageResizerModule.selectedResizeElement)) {\n                    _this.owner.imageResizerModule.isImageResizing = true;\n                }\n                event.preventDefault();\n                if (!_this.isTouchInput) {\n                    _this.selection.hideCaret();\n                }\n                var cursorPoint = new Point(event.offsetX, event.offsetY);\n                var touchPoint = _this.findFocusedPage(cursorPoint, true);\n                _this.mouseDownOffset.x = touchPoint.x;\n                _this.mouseDownOffset.y = touchPoint.y;\n                // tslint:disable-next-line:max-line-length\n                _this.isMouseDownInFooterRegion = _this.selection.isCursorInsidePageRect(cursorPoint, _this.currentPage) && _this.selection.isCursorInFooterRegion(cursorPoint, _this.currentPage);\n                _this.isSelectionChangedOnMouseMoved = false;\n                if (!_this.owner.isReadOnlyMode && (_this.owner.editorModule.tableResize.isInCellResizerArea(touchPoint) ||\n                    _this.owner.editorModule.tableResize.isInRowResizerArea(touchPoint))) {\n                    _this.selection.hideCaret();\n                    _this.isMouseDown = true;\n                    _this.isSelectionChangedOnMouseMoved = false;\n                    if (_this.isLeftButtonPressed(event)) {\n                        _this.owner.editorModule.tableResize.startingPoint.x = touchPoint.x;\n                        _this.owner.editorModule.tableResize.startingPoint.y = touchPoint.y;\n                        _this.owner.editorModule.tableResize.handleResize(touchPoint);\n                    }\n                    return;\n                }\n                if (event.ctrlKey) {\n                    _this.isControlPressed = true;\n                }\n                if (_this.owner.selection.isEmpty) {\n                    _this.useTouchSelectionMark = false;\n                }\n                if (event.which === 3 && !_this.owner.selection.isEmpty\n                    && _this.selection.checkCursorIsInSelection(_this.getLineWidget(touchPoint), touchPoint)) {\n                    event.preventDefault();\n                    return;\n                }\n                _this.isTouchInput = false;\n                _this.isMouseDown = true;\n                _this.updateFocus();\n                /* tslint:disable:align */\n                _this.timer = setTimeout(function () {\n                    _this.tapCount++;\n                    if (_this.tapCount === 4) {\n                        _this.tapCount = 1;\n                    }\n                }, 200);\n            }\n        };\n        /**\n         * Called on mouse move.\n         * @param {MouseEvent} event\n         * @private\n         */\n        this.onMouseMoveInternal = function (event) {\n            event.preventDefault();\n            if (!isNullOrUndefined(_this.selection)) {\n                //For image Resizing\n                if (!_this.owner.isReadOnlyMode && _this.owner.enableImageResizerMode\n                    && _this.owner.imageResizerModule.isImageResizing) {\n                    if (!_this.owner.imageResizerModule.isImageMoveToNextPage) {\n                        _this.owner.imageResizerModule.handleImageResizingOnMouse(event);\n                    }\n                    return;\n                }\n                var cursorPoint = new Point(event.offsetX, event.offsetY);\n                var touchPoint = _this.findFocusedPage(cursorPoint, !_this.owner.enableHeaderAndFooter);\n                if (_this.isMouseDown) {\n                    if (!isNullOrUndefined(_this.currentPage)) {\n                        var xPosition = touchPoint.x;\n                        var yPosition = touchPoint.y;\n                        if (!_this.owner.isReadOnlyMode && _this.isRowOrCellResizing) {\n                            _this.owner.editorModule.tableResize.handleResizing(touchPoint);\n                        }\n                        else {\n                            if (!(_this.isTouchInput || _this.isSelectionChangedOnMouseMoved || _this.touchDownOnSelectionMark > 0)) {\n                                _this.updateTextPositionForSelection(touchPoint, 1);\n                            }\n                            if (_this.isLeftButtonPressed(event)) {\n                                event.preventDefault();\n                                var touchY = yPosition;\n                                var textPosition = _this.owner.selection.end;\n                                var touchPoint_1 = new Point(xPosition, touchY);\n                                if (!_this.owner.enableImageResizerMode || !_this.owner.imageResizerModule.isImageResizerVisible) {\n                                    _this.owner.selection.moveTextPosition(touchPoint_1, textPosition);\n                                }\n                                _this.isSelectionChangedOnMouseMoved = true;\n                            }\n                        }\n                    }\n                    _this.selection.checkForCursorVisibility();\n                }\n                if (!_this.isRowOrCellResizing && !_this.isSelectionChangedOnMouseMoved) {\n                    _this.updateCursor(event);\n                }\n                if (_this.isRowOrCellResizing) {\n                    _this.selection.hideCaret();\n                }\n            }\n        };\n        /**\n         * Fired on double tap.\n         * @param {MouseEvent} event\n         * @private\n         */\n        this.onDoubleTap = function (event) {\n            if (!isNullOrUndefined(_this.selection)) {\n                _this.isTouchInput = false;\n                var cursorPoint = new Point(event.offsetX, event.offsetY);\n                if (_this.selection.checkAndEnableHeaderFooter(cursorPoint, _this.findFocusedPage(cursorPoint, true))) {\n                    return;\n                }\n                // tslint:disable-next-line:max-line-length\n                if (_this.selection.isEmpty && !isNullOrUndefined(_this.currentPage) && !isNullOrUndefined(_this.owner.selection.start)) {\n                    _this.owner.selection.selectCurrentWord();\n                    _this.selection.checkForCursorVisibility();\n                    _this.tapCount = 2;\n                }\n            }\n        };\n        /**\n         * Called on mouse up.\n         * @param {MouseEvent} event\n         * @private\n         */\n        this.onMouseUpInternal = function (event) {\n            event.preventDefault();\n            _this.isListTextSelected = false;\n            var cursorPoint = new Point(event.offsetX, event.offsetY);\n            var touchPoint = _this.findFocusedPage(cursorPoint, true);\n            if (!isNullOrUndefined(_this.selection)) {\n                var tapCount = 1;\n                if (!Browser.isIE) {\n                    if (event.detail > 2) {\n                        tapCount = event.detail;\n                    }\n                }\n                else {\n                    tapCount = _this.tapCount;\n                }\n                if (_this.isRowOrCellResizing) {\n                    _this.owner.editorModule.tableResize.updateResizingHistory(touchPoint);\n                }\n                if (_this.isMouseDown && !_this.isSelectionChangedOnMouseMoved\n                    && !isNullOrUndefined(_this.currentPage) && !isNullOrUndefined(_this.owner.selection.start)\n                    && (!_this.owner.enableImageResizerMode || !_this.owner.imageResizerModule.isImageResizing)) {\n                    if (_this.touchDownOnSelectionMark === 0 && !_this.isRowOrCellResizing) {\n                        _this.updateTextPositionForSelection(touchPoint, tapCount);\n                        if (Browser.isIE && tapCount === 2) {\n                            _this.selection.checkAndEnableHeaderFooter(cursorPoint, touchPoint);\n                        }\n                    }\n                    _this.selection.checkForCursorVisibility();\n                }\n                if (!isNullOrUndefined(_this.currentPage) && !isNullOrUndefined(_this.owner.selection.start)\n                    && (_this.owner.selection.isEmpty || _this.owner.selection.isImageSelected) &&\n                    (((event.ctrlKey && _this.owner.useCtrlClickToFollowHyperlink ||\n                        !_this.owner.useCtrlClickToFollowHyperlink) && _this.isLeftButtonPressed(event) === true))) {\n                    _this.selection.navigateHyperLinkOnEvent(touchPoint, false);\n                }\n                if (!_this.owner.isReadOnlyMode && _this.isSelectionInListText(touchPoint)) {\n                    _this.selection.selectListText();\n                }\n                // tslint:disable-next-line:max-line-length\n                if (!_this.owner.isReadOnlyMode && _this.owner.enableImageResizerMode && _this.owner.imageResizerModule.isImageResizing) {\n                    _this.owner.imageResizerModule.mouseUpInternal();\n                    _this.scrollToPosition(_this.owner.selection.start, _this.owner.selection.end);\n                    _this.owner.imageResizerModule.isImageResizing = false;\n                    _this.owner.imageResizerModule.updateHistoryForImageResizer();\n                }\n                // tslint:disable-next-line:max-line-length\n                if (_this.owner.enableImageResizerMode && _this.owner.imageResizerModule.isImageResizerVisible && !isNullOrUndefined(_this.selection.caret)) {\n                    _this.selection.caret.style.display = 'none';\n                }\n                _this.isMouseDown = false;\n                _this.isSelectionChangedOnMouseMoved = false;\n                _this.isTouchInput = false;\n                _this.useTouchSelectionMark = true;\n                _this.isControlPressed = false;\n                _this.updateFocus();\n                if (_this.isListTextSelected) {\n                    _this.selection.hideCaret();\n                }\n                if (_this.owner.enableImageResizerMode) {\n                    var imageResizer = _this.owner.imageResizerModule;\n                    imageResizer.isImageResizing = false;\n                    imageResizer.isImageMoveToNextPage = false;\n                    imageResizer.leftValue = undefined;\n                    imageResizer.topValue = undefined;\n                }\n                _this.isMouseDownInFooterRegion = false;\n            }\n        };\n        /**\n         * Fired on touch start.\n         * @param {TouchEvent} event\n         * @private\n         */\n        this.onTouchStartInternal = function (event) {\n            if (_this.selection) {\n                _this.isCompositionStart = false;\n                _this.isCompositionEnd = false;\n                _this.isCompositionUpdated = false;\n                _this.isCompositionCanceled = true;\n                _this.isTouchInput = true;\n                if (_this.isTimerStarted) {\n                    if (_this.tapCount === 1) {\n                        _this.tapCount = 2;\n                    }\n                    else {\n                        _this.tapCount = 3;\n                        _this.isTimerStarted = false;\n                    }\n                }\n                else {\n                    _this.isTimerStarted = true;\n                    _this.tapCount = 1;\n                }\n                if (event.touches.length === 1) {\n                    _this.zoomX = event.touches[0].clientX;\n                    _this.zoomY = event.touches[0].clientY;\n                    if (_this.owner.selection.isEmpty) {\n                        _this.useTouchSelectionMark = false;\n                    }\n                    _this.isMouseDown = true;\n                    _this.isSelectionChangedOnMouseMoved = false;\n                    var point = void 0;\n                    if (_this.isMouseDown) {\n                        point = _this.getTouchOffsetValue(event);\n                    }\n                    point = _this.findFocusedPage(point, true);\n                    if (_this.owner.enableImageResizerMode) {\n                        var resizeObj = _this.owner.imageResizerModule.getImagePointOnTouch(point);\n                        _this.owner.imageResizerModule.selectedResizeElement = resizeObj.selectedElement;\n                    }\n                    // tslint:disable-next-line:max-line-length\n                    if (_this.owner.enableImageResizerMode && !isNullOrUndefined(_this.owner.imageResizerModule.selectedResizeElement)) {\n                        _this.owner.imageResizerModule.isImageResizing = true;\n                    }\n                    var x = _this.owner.selection.end.location.x;\n                    var y = _this.selection.getCaretBottom(_this.owner.selection.end, _this.owner.selection.isEmpty) + 9;\n                    //TouchDownOnSelectionMark will be 2 when touch end is pressed\n                    _this.touchDownOnSelectionMark = ((point.y <= y && point.y >= y - 20 || point.y >= y && point.y <= y + 20)\n                        && (point.x <= x && point.x >= x - 20 || point.x >= x && point.x <= x + 20)) ? 1 : 0;\n                    if (!_this.owner.selection.isEmpty && _this.touchDownOnSelectionMark === 0) {\n                        x = _this.owner.selection.start.location.x;\n                        y = _this.selection.getCaretBottom(_this.owner.selection.start, false) + 9;\n                        //TouchDownOnSelectionMark will be 1 when touch start is pressed\n                        _this.touchDownOnSelectionMark = ((point.y <= y && point.y >= y - 20 || point.y >= y && point.y <= y + 20)\n                            && (point.x <= x && point.x >= x - 20 || point.x >= x && point.x <= x + 20)) ? 2 : 0;\n                    }\n                }\n                if (!isNullOrUndefined(_this.owner.contextMenuModule) && _this.owner.contextMenuModule.contextMenuInstance) {\n                    _this.owner.contextMenuModule.contextMenuInstance.close();\n                }\n                if (_this.touchDownOnSelectionMark || event.touches.length > 1) {\n                    event.preventDefault();\n                }\n                _this.timer = setTimeout(function () {\n                    _this.isTimerStarted = false;\n                }, 200);\n            }\n        };\n        /**\n         * Fired on touch move.\n         * @param {TouchEvent} event\n         * @private\n         */\n        this.onTouchMoveInternal = function (event) {\n            var touch = event.touches;\n            var cursorPoint;\n            if (!isNullOrUndefined(_this.selection)) {\n                // tslint:disable-next-line:max-line-length\n                if (_this.owner.editorModule && _this.owner.enableImageResizerMode && _this.owner.imageResizerModule.isImageResizing) {\n                    event.preventDefault();\n                    if (!_this.owner.imageResizerModule.isImageMoveToNextPage) {\n                        _this.owner.imageResizerModule.handleImageResizingOnTouch(event);\n                        _this.selection.caret.style.display = 'none';\n                    }\n                    return;\n                }\n                if (_this.isMouseDown) {\n                    cursorPoint = _this.getTouchOffsetValue(event);\n                    var touchPoint = _this.findFocusedPage(cursorPoint, true);\n                    if (_this.touchDownOnSelectionMark > 0 /*|| !this.useTouchSelectionMark*/) {\n                        event.preventDefault();\n                        var touchY = touchPoint.y;\n                        var textPosition = _this.owner.selection.end;\n                        var touchPointer = void 0;\n                        if (touchPoint.y <= 26) {\n                            touchY -= touchPoint.y < 0 ? 0 : touchPoint.y + 0.5;\n                        }\n                        else {\n                            touchY -= 36.5;\n                        }\n                        textPosition = _this.touchDownOnSelectionMark === 2 ? _this.selection.start : _this.selection.end;\n                        touchPoint = new Point(touchPoint.x, touchY);\n                        _this.owner.selection.moveTextPosition(touchPoint, textPosition);\n                        _this.isSelectionChangedOnMouseMoved = true;\n                    }\n                    _this.selection.checkForCursorVisibility();\n                }\n            }\n            if (touch.length > 1) {\n                event.preventDefault();\n                _this.isMouseDown = false;\n                _this.zoomX = (touch[0].clientX + touch[1].clientX) / 2;\n                _this.zoomY = (touch[0].clientY + touch[1].clientY) / 2;\n                // tslint:disable-next-line:max-line-length\n                var currentDiff = Math.sqrt(Math.pow((touch[0].clientX - touch[1].clientX), 2) + Math.pow((touch[0].clientY - touch[1].clientY), 2));\n                if (_this.preDifference > -1) {\n                    if (currentDiff > _this.preDifference) {\n                        _this.onPinchOutInternal(event);\n                    }\n                    else if (currentDiff < _this.preDifference) {\n                        _this.onPinchInInternal(event);\n                    }\n                }\n                else if (_this.zoomFactor < 2) {\n                    if (_this.preDifference !== -1) {\n                        if (currentDiff > _this.preDifference) {\n                            _this.onPinchInInternal(event);\n                        }\n                    }\n                }\n                else if (_this.preDifference === -1) {\n                    if (_this.zoomFactor > 2) {\n                        if (currentDiff > _this.preDifference) {\n                            _this.onPinchInInternal(event);\n                        }\n                    }\n                }\n                _this.preDifference = currentDiff;\n            }\n        };\n        /**\n         * Fired on touch up.\n         * @param {TouchEvent} event\n         * @private\n         */\n        this.onTouchUpInternal = function (event) {\n            if (!isNullOrUndefined(_this.selection)) {\n                var point = _this.getTouchOffsetValue(event);\n                var touchPoint = _this.findFocusedPage(point, true);\n                if (event.changedTouches.length === 1) {\n                    _this.zoomX = undefined;\n                    _this.zoomY = undefined;\n                    // tslint:disable-next-line:max-line-length\n                    if (_this.isMouseDown && !_this.isSelectionChangedOnMouseMoved && !isNullOrUndefined(_this.currentPage) && !isNullOrUndefined(_this.owner.selection.start)) {\n                        if (_this.touchDownOnSelectionMark === 0) {\n                            _this.updateTextPositionForSelection(new Point(touchPoint.x, touchPoint.y), _this.tapCount);\n                            if (_this.tapCount === 2) {\n                                _this.selection.checkAndEnableHeaderFooter(point, touchPoint);\n                            }\n                        }\n                        if (_this.owner.selection.isEmpty) {\n                            _this.selection.updateCaretPosition();\n                        }\n                        _this.selection.checkForCursorVisibility();\n                    }\n                    if (!isNullOrUndefined(_this.currentPage) && !isNullOrUndefined(_this.selection.start)\n                        && !_this.isSelectionChangedOnMouseMoved && (_this.selection.isEmpty ||\n                        _this.selection.isImageField() && (!_this.owner.enableImageResizerMode ||\n                            _this.owner.enableImageResizerMode && !_this.owner.imageResizerModule.isImageResizing))) {\n                        _this.selection.navigateHyperLinkOnEvent(touchPoint, true);\n                    }\n                    _this.isMouseDown = false;\n                    _this.touchDownOnSelectionMark = 0;\n                    _this.useTouchSelectionMark = true;\n                    _this.isSelectionChangedOnMouseMoved = false;\n                }\n                if (_this.owner.enableImageResizerMode && _this.owner.imageResizerModule.isImageResizing) {\n                    _this.owner.imageResizerModule.mouseUpInternal();\n                    _this.owner.imageResizerModule.isImageResizing = false;\n                    _this.owner.imageResizerModule.isImageMoveToNextPage = false;\n                    _this.scrollToPosition(_this.owner.selection.start, _this.owner.selection.end);\n                    _this.owner.imageResizerModule.updateHistoryForImageResizer();\n                }\n                // tslint:disable-next-line:max-line-length\n                if (_this.owner.enableImageResizerMode && _this.owner.imageResizerModule.isImageResizerVisible && _this.isTouchInput) {\n                    _this.touchStart.style.display = 'none';\n                    _this.touchEnd.style.display = 'none';\n                }\n                // if (!this.owner.isReadOnlyMode && this.isSelectionInListText(touchPoint)) {\n                //     this.selection.selectListText();\n                // }\n                event.preventDefault();\n            }\n            _this.preDifference = -1;\n            _this.isTouchInput = false;\n            if (!_this.isTimerStarted) {\n                _this.tapCount = 1;\n            }\n            if (_this.isListTextSelected) {\n                _this.selection.hideCaret();\n            }\n        };\n        /**\n         * Fired on keyup event.\n         * @private\n         */\n        this.onKeyUpInternal = function (event) {\n            if (Browser.isDevice) {\n                if (window.getSelection().anchorOffset !== _this.prefix.length) {\n                    _this.selection.setEditableDivCaretPosition(_this.editableDiv.innerText.length);\n                }\n            }\n            if (event.ctrlKey || (event.keyCode === 17 || event.which === 17)) {\n                _this.isControlPressed = false;\n            }\n        };\n        /**\n         * Fired on keydown.\n         * @private\n         */\n        this.onKeyDownInternal = function (event) {\n            var isHandled = false;\n            var keyEventArgs = { 'event': event, 'isHandled': false, source: _this.owner };\n            _this.owner.trigger('keyDown', keyEventArgs);\n            if (keyEventArgs.isHandled) {\n                return;\n            }\n            var key = event.which || event.keyCode;\n            var ctrl = (event.ctrlKey || event.metaKey) ? true : ((key === 17) ? true : false); // ctrl detection       \n            var shift = event.shiftKey ? event.shiftKey : ((key === 16) ? true : false); // Shift Key detection        \n            var alt = event.altKey ? event.altKey : ((key === 18) ? true : false); // alt key detection\n            if (ctrl && !shift && !alt) {\n                switch (key) {\n                    case 80:\n                        event.preventDefault();\n                        _this.owner.print();\n                        isHandled = true;\n                        break;\n                    case 83:\n                        event.preventDefault();\n                        _this.owner.save(_this.owner.documentName === '' ? 'sample' : _this.owner.documentName, 'Sfdt');\n                        isHandled = true;\n                        break;\n                }\n            }\n            if (!isHandled && !isNullOrUndefined(_this.selection)) {\n                _this.selection.onKeyDownInternal(event, ctrl, shift, alt);\n            }\n            if (isHandled) {\n                event.preventDefault();\n            }\n        };\n        this.owner = owner;\n        this.pages = [];\n        this.render = new Renderer(this);\n        this.lists = [];\n        this.abstractLists = [];\n        this.characterFormat = new WCharacterFormat(this);\n        this.paragraphFormat = new WParagraphFormat(this);\n        this.renderedLists = new Dictionary();\n        this.headersFooters = [];\n        this.styles = new WStyles();\n        this.preDefinedStyles = new Dictionary();\n        this.initalizeStyles();\n        this.bookmarks = new Dictionary();\n    }\n    Object.defineProperty(LayoutViewer.prototype, \"containerCanvas\", {\n        //#region Properties\n        /**\n         * Gets container canvas.\n         * @private\n         */\n        get: function () {\n            if (isNullOrUndefined(this.containerCanvasIn)) {\n                this.containerCanvasIn = document.createElement('canvas');\n                this.containerCanvasIn.getContext('2d').save();\n            }\n            if (!isNullOrUndefined(this.pageContainer)\n                && this.containerCanvasIn.parentElement !== this.pageContainer) {\n                this.pageContainer.appendChild(this.containerCanvasIn);\n            }\n            return this.containerCanvasIn;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(LayoutViewer.prototype, \"selectionCanvas\", {\n        /**\n         * Gets selection canvas.\n         * @private\n         */\n        get: function () {\n            if (isNullOrUndefined(this.selectionCanvasIn)) {\n                this.selectionCanvasIn = document.createElement('canvas');\n                this.selectionCanvas.getContext('2d').save();\n            }\n            if (!isNullOrUndefined(this.pageContainer)\n                && this.selectionCanvasIn.parentElement !== this.pageContainer) {\n                this.pageContainer.appendChild(this.selectionCanvasIn);\n            }\n            return this.selectionCanvasIn;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(LayoutViewer.prototype, \"containerContext\", {\n        /**\n         * Gets container context.\n         * @private\n         */\n        get: function () {\n            return this.containerCanvas.getContext('2d');\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(LayoutViewer.prototype, \"selectionContext\", {\n        /**\n         * Gets selection context.\n         * @private\n         */\n        get: function () {\n            return this.selectionCanvas.getContext('2d');\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(LayoutViewer.prototype, \"currentRenderingPage\", {\n        /**\n         * Gets the current rendering page.\n         */\n        get: function () {\n            if (this.pages.length === 0) {\n                return undefined;\n            }\n            return this.pages[this.pages.length - 1];\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(LayoutViewer.prototype, \"visibleBounds\", {\n        /**\n         * Gets visible bounds.\n         * @private\n         */\n        get: function () {\n            return this.visibleBoundsIn;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(LayoutViewer.prototype, \"zoomFactor\", {\n        /**\n         * Gets or sets zoom factor.\n         * @private\n         */\n        get: function () {\n            return this.zoomFactorInternal;\n        },\n        set: function (value) {\n            if (this.zoomFactorInternal !== value) {\n                this.preZoomFactor = this.zoomFactor;\n                this.zoomFactorInternal = value;\n                this.zoomModule.setZoomFactor(value);\n                this.owner.zoomFactor = value;\n            }\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(LayoutViewer.prototype, \"selection\", {\n        /**\n         * Gets the selection.\n         * @private\n         */\n        get: function () {\n            return this.owner.selection;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(LayoutViewer.prototype, \"selectionStartPage\", {\n        /**\n         * Gets or sets selection start page.\n         * @private\n         */\n        get: function () {\n            return this.selectionStartPageIn;\n        },\n        set: function (value) {\n            this.selectionStartPageIn = value;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(LayoutViewer.prototype, \"selectionEndPage\", {\n        /**\n         * Gets or sets selection end page.\n         * @private\n         */\n        get: function () {\n            return this.selectionEndPageIn;\n        },\n        set: function (value) {\n            this.selectionEndPageIn = value;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(LayoutViewer.prototype, \"dialog\", {\n        /**\n         * Gets the initialized default dialog.\n         * @private\n         */\n        get: function () {\n            if (!this.dialogInternal) {\n                this.initDialog();\n            }\n            return this.dialogInternal;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(LayoutViewer.prototype, \"dialog2\", {\n        /**\n         * Gets the initialized default dialog.\n         * @private\n         */\n        get: function () {\n            if (!this.dialogInternal2) {\n                this.initDialog2();\n            }\n            return this.dialogInternal2;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(LayoutViewer.prototype, \"pageFitType\", {\n        /**\n         * Gets or sets page fit type.\n         * @private\n         */\n        get: function () {\n            return this.pageFitTypeIn;\n        },\n        set: function (value) {\n            this.pageFitTypeIn = value;\n            this.onPageFitTypeChanged(this.pageFitTypeIn);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    LayoutViewer.prototype.initalizeStyles = function () {\n        /* tslint:disable-next-line:max-line-length */\n        this.preDefinedStyles.add('Normal', '{\"type\":\"Paragraph\",\"name\":\"Normal\",\"next\":\"Normal\"}');\n        /* tslint:disable-next-line:max-line-length */\n        this.preDefinedStyles.add('Heading 1', '{\"type\":\"Paragraph\",\"name\":\"Heading 1\",\"basedOn\":\"Normal\",\"next\":\"Normal\",\"link\":\"Heading 1 Char\",\"characterFormat\":{\"fontSize\":16.0,\"fontFamily\":\"Calibri Light\",\"fontColor\":\"#2F5496\"},\"paragraphFormat\":{\"leftIndent\":0.0,\"rightIndent\":0.0,\"firstLineIndent\":0.0,\"beforeSpacing\":12.0,\"afterSpacing\":0.0,\"lineSpacing\":1.0791666507720947,\"lineSpacingType\":\"Multiple\",\"textAlignment\":\"Left\",\"outlineLevel\":\"Level1\"}}');\n        /* tslint:disable-next-line:max-line-length */\n        this.preDefinedStyles.add('Heading 2', '{\"type\":\"Paragraph\",\"name\":\"Heading 2\",\"basedOn\":\"Normal\",\"next\":\"Normal\",\"link\":\"Heading 2 Char\",\"characterFormat\":{\"fontSize\":13.0,\"fontFamily\":\"Calibri Light\",\"fontColor\":\"#2F5496\"},\"paragraphFormat\":{\"leftIndent\":0.0,\"rightIndent\":0.0,\"firstLineIndent\":0.0,\"beforeSpacing\":2.0,\"afterSpacing\":0.0,\"lineSpacing\":1.0791666507720947,\"lineSpacingType\":\"Multiple\",\"textAlignment\":\"Left\",\"outlineLevel\":\"Level2\"}}');\n        /* tslint:disable-next-line:max-line-length */\n        this.preDefinedStyles.add('Heading 3', '{\"type\":\"Paragraph\",\"name\":\"Heading 3\",\"basedOn\":\"Normal\",\"next\":\"Normal\",\"link\":\"Heading 3 Char\",\"characterFormat\":{\"fontSize\":12.0,\"fontFamily\":\"Calibri Light\",\"fontColor\":\"#1F3763\"},\"paragraphFormat\":{\"leftIndent\":0.0,\"rightIndent\":0.0,\"firstLineIndent\":0.0,\"beforeSpacing\":2.0,\"afterSpacing\":0.0,\"lineSpacing\":1.0791666507720947,\"lineSpacingType\":\"Multiple\",\"textAlignment\":\"Left\",\"outlineLevel\":\"Level3\"}}');\n        /* tslint:disable-next-line:max-line-length */\n        this.preDefinedStyles.add('Heading 4', '{\"type\":\"Paragraph\",\"name\":\"Heading 4\",\"basedOn\":\"Normal\",\"next\":\"Normal\",\"link\":\"Heading 4 Char\",\"characterFormat\":{\"italic\":true,\"fontFamily\":\"Calibri Light\",\"fontColor\":\"#2F5496\"},\"paragraphFormat\":{\"leftIndent\":0.0,\"rightIndent\":0.0,\"firstLineIndent\":0.0,\"beforeSpacing\":2.0,\"afterSpacing\":0.0,\"lineSpacing\":1.0791666507720947,\"lineSpacingType\":\"Multiple\",\"textAlignment\":\"Left\",\"outlineLevel\":\"Level4\"}}');\n        /* tslint:disable-next-line:max-line-length */\n        this.preDefinedStyles.add('Heading 5', '{\"type\":\"Paragraph\",\"name\":\"Heading 5\",\"basedOn\":\"Normal\",\"next\":\"Normal\",\"link\":\"Heading 5 Char\",\"characterFormat\":{\"fontFamily\":\"Calibri Light\",\"fontColor\":\"#2F5496\"},\"paragraphFormat\":{\"leftIndent\":0.0,\"rightIndent\":0.0,\"firstLineIndent\":0.0,\"beforeSpacing\":2.0,\"afterSpacing\":0.0,\"lineSpacing\":1.0791666507720947,\"lineSpacingType\":\"Multiple\",\"textAlignment\":\"Left\",\"outlineLevel\":\"Level5\"}}');\n        /* tslint:disable-next-line:max-line-length */\n        this.preDefinedStyles.add('Heading 6', '{\"type\":\"Paragraph\",\"name\":\"Heading 6\",\"basedOn\":\"Normal\",\"next\":\"Normal\",\"link\":\"Heading 6 Char\",\"characterFormat\":{\"fontFamily\":\"Calibri Light\",\"fontColor\":\"#1F3763\"},\"paragraphFormat\":{\"leftIndent\":0.0,\"rightIndent\":0.0,\"firstLineIndent\":0.0,\"beforeSpacing\":2.0,\"afterSpacing\":0.0,\"lineSpacing\":1.0791666507720947,\"lineSpacingType\":\"Multiple\",\"textAlignment\":\"Left\",\"outlineLevel\":\"Level6\"}}');\n        /* tslint:disable-next-line:max-line-length */\n        this.preDefinedStyles.add('Default Paragraph Font', '{\"type\":\"Character\",\"name\":\"Default Paragraph Font\"}');\n        /* tslint:disable-next-line:max-line-length */\n        this.preDefinedStyles.add('Heading 1 Char', '{\"type\":\"Character\",\"name\":\"Heading 1 Char\",\"basedOn\":\"Default Paragraph Font\",\"characterFormat\":{\"fontSize\":16.0,\"fontFamily\":\"Calibri Light\",\"fontColor\":\"#2F5496\"}}');\n        /* tslint:disable-next-line:max-line-length */\n        this.preDefinedStyles.add('Heading 2 Char', '{\"type\":\"Character\",\"name\":\"Heading 2 Char\",\"basedOn\":\"Default Paragraph Font\",\"characterFormat\":{\"fontSize\":13.0,\"fontFamily\":\"Calibri Light\",\"fontColor\":\"#2F5496\"}}');\n        /* tslint:disable-next-line:max-line-length */\n        this.preDefinedStyles.add('Heading 3 Char', '{\"type\":\"Character\",\"name\":\"Heading 3 Char\",\"basedOn\":\"Default Paragraph Font\",\"characterFormat\":{\"fontSize\":12.0,\"fontFamily\":\"Calibri Light\",\"fontColor\": \"#1F3763\"}}');\n        /* tslint:disable-next-line:max-line-length */\n        this.preDefinedStyles.add('Heading 4 Char', '{\"type\":\"Character\",\"name\":\"Heading 4 Char\",\"basedOn\":\"Default Paragraph Font\",\"characterFormat\":{\"italic\":true,\"fontFamily\":\"Calibri Light\",\"fontColor\":\"#2F5496\"}}');\n        /* tslint:disable-next-line:max-line-length */\n        this.preDefinedStyles.add('Heading 5 Char', '{\"type\":\"Character\",\"name\":\"Heading 5 Char\",\"basedOn\":\"Default Paragraph Font\",\"characterFormat\":{\"fontFamily\":\"Calibri Light\",\"fontColor\":\"#2F5496\"}}');\n        /* tslint:disable-next-line:max-line-length */\n        this.preDefinedStyles.add('Heading 6 Char', '{\"type\":\"Character\",\"name\":\"Heading 6 Char\",\"basedOn\":\"Default Paragraph Font\",\"characterFormat\":{\"fontFamily\":\"Calibri Light\",\"fontColor\":\"#1F3763\"}}');\n        /* tslint:disable-next-line:max-line-length */\n        this.preDefinedStyles.add('Hyperlink', '{\"type\":\"Character\",\"name\":\"Hyperlink\",\"basedOn\":\"Default Paragraph Font\",\"next\":\"Normal\",\"characterFormat\":{\"fontColor\":\"#0563C1\",\"underline\": \"Single\"}}');\n        /* tslint:disable-next-line:max-line-length */\n        this.preDefinedStyles.add('Toc1', '{\"type\":\"Paragraph\",\"name\":\"Toc1\",\"basedOn\":\"Normal\",\"next\":\"Normal\",\"paragraphFormat\":{\"afterSpacing\":5.0}}');\n        /* tslint:disable-next-line:max-line-length */\n        this.preDefinedStyles.add('Toc2', '{\"type\":\"Paragraph\",\"name\":\"Toc2\",\"basedOn\":\"Normal\",\"next\":\"Normal\",\"paragraphFormat\":{\"leftIndent\" :11.0,\"afterSpacing\":5.0}}');\n        /* tslint:disable-next-line:max-line-length */\n        this.preDefinedStyles.add('Toc3', '{\"type\":\"Paragraph\",\"name\":\"Toc3\",\"basedOn\":\"Normal\",\"next\":\"Normal\",\"paragraphFormat\":{\"leftIndent\" :22.0,\"afterSpacing\":5.0}}');\n        /* tslint:disable-next-line:max-line-length */\n        this.preDefinedStyles.add('Toc4', '{\"type\":\"Paragraph\",\"name\":\"Toc4\",\"basedOn\":\"Normal\",\"next\":\"Normal\",\"paragraphFormat\":{\"leftIndent\" :33.0,\"afterSpacing\":5.0}}');\n        /* tslint:disable-next-line:max-line-length */\n        this.preDefinedStyles.add('Toc5', '{\"type\":\"Paragraph\",\"name\":\"Toc5\",\"basedOn\":\"Normal\",\"next\":\"Normal\",\"paragraphFormat\":{\"leftIndent\" :44.0,\"afterSpacing\":5.0}}');\n        /* tslint:disable-next-line:max-line-length */\n        this.preDefinedStyles.add('Toc6', '{\"type\":\"Paragraph\",\"name\":\"Toc6\",\"basedOn\":\"Normal\",\"next\":\"Normal\",\"paragraphFormat\":{\"leftIndent\" :55.0,\"afterSpacing\":5.0}}');\n        /* tslint:disable-next-line:max-line-length */\n        this.preDefinedStyles.add('Toc7', '{\"type\":\"Paragraph\",\"name\":\"Toc7\",\"basedOn\":\"Normal\",\"next\":\"Normal\",\"paragraphFormat\":{\"leftIndent\" :66.0,\"afterSpacing\":5.0}}');\n        /* tslint:disable-next-line:max-line-length */\n        this.preDefinedStyles.add('Toc8', '{\"type\":\"Paragraph\",\"name\":\"Toc8\",\"basedOn\":\"Normal\",\"next\":\"Normal\",\"paragraphFormat\":{\"leftIndent\" :77.0,\"afterSpacing\":5.0}}');\n        /* tslint:disable-next-line:max-line-length */\n        this.preDefinedStyles.add('Toc9', '{\"type\":\"Paragraph\",\"name\":\"Toc9\",\"basedOn\":\"Normal\",\"next\":\"Normal\",\"paragraphFormat\":{\"leftIndent\" :88.0,\"afterSpacing\":5.0}}');\n    };\n    /**\n     * @private\n     */\n    LayoutViewer.prototype.clearDocumentItems = function () {\n        this.headersFooters = [];\n        this.fields = [];\n        this.bookmarks.clear();\n        this.styles.clear();\n        this.characterFormat.clearFormat();\n        this.paragraphFormat.clearFormat();\n    };\n    /**\n     * @private\n     */\n    LayoutViewer.prototype.getAbstractListById = function (id) {\n        if (isNullOrUndefined(this.abstractLists)) {\n            return undefined;\n        }\n        for (var i = 0; i < this.abstractLists.length; i++) {\n            var abstractList = this.abstractLists[i];\n            if (abstractList instanceof WAbstractList && abstractList.abstractListId === id) {\n                return abstractList;\n            }\n        }\n        return undefined;\n    };\n    /**\n     * @private\n     */\n    LayoutViewer.prototype.getListById = function (id) {\n        if (isNullOrUndefined(this.lists)) {\n            return undefined;\n        }\n        for (var i = 0; i < this.lists.length; i++) {\n            if (!isNullOrUndefined(this.lists[i]) && this.lists[i].listId === id) {\n                return this.lists[i];\n            }\n        }\n        return undefined;\n    };\n    /**\n     * @private\n     */\n    LayoutViewer.getListLevelNumber = function (listLevel) {\n        if (listLevel.ownerBase instanceof WLevelOverride) {\n            return listLevel.ownerBase.levelNumber;\n        }\n        else if (listLevel.ownerBase instanceof WAbstractList && !isNullOrUndefined(listLevel.ownerBase.levels)) {\n            return listLevel.ownerBase.levels.indexOf(listLevel);\n        }\n        else {\n            return -1;\n        }\n    };\n    /**\n     * Gets the bookmarks.\n     * @private\n     */\n    LayoutViewer.prototype.getBookmarks = function (includeHidden) {\n        var bookmarks = [];\n        for (var i = 0; i < this.bookmarks.keys.length; i++) {\n            var bookmark = this.bookmarks.keys[i];\n            if (includeHidden || bookmark.indexOf('_') !== 0) {\n                bookmarks.push(bookmark);\n            }\n        }\n        return bookmarks;\n    };\n    /**\n     * Initializes components.\n     * @private\n     */\n    LayoutViewer.prototype.initializeComponents = function () {\n        var element = this.owner.element;\n        if (isNullOrUndefined(element)) {\n            return;\n        }\n        var viewer = this;\n        this.viewerContainer = createElement('div', { id: this.owner.containerId + '_viewerContainer' });\n        this.viewerContainer.style.cssText = 'position:relative;backgroundColor:#FBFBFB;overflow:auto';\n        element.appendChild(this.viewerContainer);\n        this.viewerContainer.tabIndex = 0;\n        this.viewerContainer.style.outline = 'none';\n        this.pageContainer = createElement('div', { id: this.owner.containerId + '_pageContainer', className: 'e-de-background' });\n        this.viewerContainer.appendChild(this.pageContainer);\n        this.pageContainer.style.top = '0px';\n        this.pageContainer.style.left = '0px';\n        this.pageContainer.style.position = 'relative';\n        this.pageContainer.style.pointerEvents = 'none';\n        this.editableDiv = document.createElement('div');\n        this.editableDiv.contentEditable = 'true';\n        this.editableDiv.style.position = 'fixed';\n        this.editableDiv.style.left = '-150em';\n        this.editableDiv.style.width = '100%';\n        this.editableDiv.style.height = '100%';\n        this.editableDiv.id = element.id + '_editableDiv';\n        document.body.appendChild(this.editableDiv);\n        if (this.owner.enableImageResizerMode) {\n            this.owner.imageResizerModule.initializeImageResizer();\n        }\n        this.updateViewerSizeInternal(element);\n        this.layout = new Layout(this);\n        this.textHelper = new TextHelper(this);\n        this.zoomModule = new Zoom(this);\n        // let locale: L10n = new L10n('documenteditor', this.owner.defaultLocale);\n        // locale.setLocale(this.owner.locale);\n        // setCulture(this.owner.locale);\n        this.initTouchEllipse();\n        this.wireEvent();\n    };\n    /**\n     * Wires events and methods.\n     */\n    LayoutViewer.prototype.wireEvent = function () {\n        if (!isNullOrUndefined(this.selection)) {\n            this.selection.initCaret();\n        }\n        this.editableDiv.addEventListener('paste', this.onPaste);\n        if (Browser.isIE) {\n            this.editableDiv.addEventListener('keypress', this.onKeyPressInternal);\n        }\n        else {\n            this.editableDiv.addEventListener('input', this.onTextInputInternal);\n        }\n        this.editableDiv.addEventListener('blur', this.onFocusOut);\n        this.editableDiv.addEventListener('keydown', this.onKeyDownInternal);\n        this.editableDiv.addEventListener('compositionstart', this.compositionStart);\n        this.editableDiv.addEventListener('compositionupdate', this.compositionUpdated);\n        this.editableDiv.addEventListener('compositionend', this.compositionEnd);\n        this.viewerContainer.addEventListener('scroll', this.scrollHandler);\n        this.viewerContainer.addEventListener('mousedown', this.onMouseDownInternal);\n        this.viewerContainer.addEventListener('keydown', this.onKeyDownInternal);\n        this.viewerContainer.addEventListener('mousemove', this.onMouseMoveInternal);\n        this.viewerContainer.addEventListener('contextmenu', this.onContextMenu);\n        this.viewerContainer.addEventListener('dblclick', this.onDoubleTap);\n        this.viewerContainer.addEventListener('mouseup', this.onMouseUpInternal);\n        window.addEventListener('resize', this.onWindowResize);\n        window.addEventListener('keyup', this.onKeyUpInternal);\n        window.addEventListener('mouseup', this.onImageResizer);\n        window.addEventListener('touchend', this.onImageResizer);\n        this.viewerContainer.addEventListener('touchstart', this.onTouchStartInternal);\n        this.viewerContainer.addEventListener('touchmove', this.onTouchMoveInternal);\n        this.viewerContainer.addEventListener('touchend', this.onTouchUpInternal);\n        if (navigator.userAgent.match('Firefox')) {\n            this.viewerContainer.addEventListener('DOMMouseScroll', this.zoomModule.onMouseWheelInternal);\n        }\n        this.viewerContainer.addEventListener('mousewheel', this.zoomModule.onMouseWheelInternal);\n    };\n    /**\n     * Initializes dialog template.\n     */\n    LayoutViewer.prototype.initDialog = function () {\n        if (!this.dialogInternal) {\n            this.dialogTarget = createElement('div', { className: 'e-de-dlg-target' });\n            document.body.appendChild(this.dialogTarget);\n            this.dialogInternal = new Dialog({\n                target: document.body, showCloseIcon: true,\n                allowDragging: true, visible: false, width: '1px', isModal: true, position: { X: 'center', Y: 'center' }, zIndex: 20\n            });\n            this.dialogInternal.open = this.selection.hideCaret;\n            this.dialogInternal.beforeClose = this.updateFocus;\n            this.dialogInternal.appendTo(this.dialogTarget);\n        }\n    };\n    /**\n     * Initializes dialog template.\n     */\n    LayoutViewer.prototype.initDialog2 = function () {\n        if (!this.dialogInternal2) {\n            var target = createElement('div', { className: 'e-de-dlg-target' });\n            document.body.appendChild(target);\n            this.dialogInternal2 = new Dialog({\n                target: document.body, showCloseIcon: true,\n                allowDragging: true, visible: false, width: '1px', isModal: true, position: { X: 'center', Y: 'Top' }, zIndex: 10\n            });\n            this.dialogInternal2.appendTo(target);\n        }\n    };\n    /**\n     * Clears the context.\n     * @private\n     */\n    LayoutViewer.prototype.clearContent = function () {\n        this.containerContext.clearRect(0, 0, this.containerCanvas.width, this.containerCanvas.height);\n        this.selectionContext.clearRect(0, 0, this.selectionCanvas.width, this.selectionCanvas.height);\n    };\n    /**\n     * Fired when the document gets changed.\n     * @param {WordDocument} document\n     */\n    LayoutViewer.prototype.onDocumentChanged = function (sections) {\n        this.clearContent();\n        if (this.owner.editorModule) {\n            this.owner.editorModule.tocStyles = {};\n            this.owner.editorModule.tocBookmarkId = 0;\n        }\n        this.heightInfoCollection = {};\n        this.owner.isDocumentLoaded = false;\n        for (var i = 0; i < this.pages.length; i++) {\n            this.pages[i].bodyWidgets[0].destroy();\n        }\n        this.pages = [];\n        if (!isNullOrUndefined(this.renderedLists)) {\n            this.renderedLists.clear();\n        }\n        if (!isNullOrUndefined(this.owner.editorHistory)) {\n            this.owner.editorHistory.destroy();\n        }\n        this.owner.isDocumentLoaded = true;\n        this.layout.isInitialLoad = true;\n        this.layout.layoutItems(sections);\n        if (this.owner.selection) {\n            this.owner.selection.selectRange(this.owner.documentStart, this.owner.documentStart);\n        }\n        if (this.owner.optionsPaneModule) {\n            this.owner.optionsPaneModule.showHideOptionsPane(false);\n        }\n        this.owner.fireDocumentChange();\n    };\n    /**\n     * Initialize touch ellipse.\n     */\n    LayoutViewer.prototype.initTouchEllipse = function () {\n        var style = 'height: 30px;width: 30px;position: absolute;background-color: transparent;margin: 0px;padding: 0px;z-index:5';\n        // tslint:disable-next-line:max-line-length\n        var ellipse = ' height: 12px;width: 12px;border-radius: 50%;background-color: white;position: absolute;margin: 0px 6px 0px 6px;border-width: 2px;border-style: solid;border-color: #000000;';\n        this.touchStart = createElement('div', { className: 'e-touch-ellipse', styles: style });\n        var start = createElement('div', { styles: ellipse });\n        this.touchEnd = createElement('div', { className: 'e-touch-ellipse', styles: style });\n        this.touchStart.style.display = 'none';\n        var end = createElement('div', { styles: ellipse });\n        this.touchStart.appendChild(start);\n        this.touchEnd.appendChild(end);\n        this.touchEnd.style.display = 'none';\n        this.viewerContainer.appendChild(this.touchStart);\n        this.viewerContainer.appendChild(this.touchEnd);\n    };\n    /**\n     * Updates touch mark position.\n     * @private\n     */\n    LayoutViewer.prototype.updateTouchMarkPosition = function () {\n        if (this.touchStart.style.display !== 'none' && !isNullOrUndefined(this.selection)) {\n            if (!this.selection.isEmpty) {\n                var y = this.selection.getCaretBottom(this.selection.start, false);\n                var page = this.selection.getPage(this.selection.start.paragraph);\n                var viewer = this;\n                // tslint:disable-next-line:max-line-length\n                var pageTop = (page.boundingRectangle.y - viewer.pageGap * (this.pages.indexOf(page) + 1)) * this.zoomFactor + viewer.pageGap * (this.pages.indexOf(page) + 1);\n                // tslint:disable-next-line:max-line-length\n                this.touchStart.style.left = page.boundingRectangle.x + (Math.round(this.selection.start.location.x) * this.zoomFactor - 14) + 'px';\n                this.touchStart.style.top = pageTop + ((y) * this.zoomFactor) + 'px';\n                if (!this.selection.isEmpty) {\n                    y = this.selection.getCaretBottom(this.selection.end, false);\n                    page = this.selection.getPage(this.selection.end.paragraph);\n                }\n                // tslint:disable-next-line:max-line-length\n                this.touchEnd.style.left = page.boundingRectangle.x + (Math.round(this.selection.end.location.x) * this.zoomFactor - 14) + 'px';\n                this.touchEnd.style.top = pageTop + (y * this.zoomFactor) + 'px';\n            }\n            else {\n                this.selection.updateCaretPosition();\n            }\n        }\n    };\n    LayoutViewer.prototype.isSelectionInListText = function (cursorPoint) {\n        var widget = this.getLineWidget(cursorPoint);\n        if (!isNullOrUndefined(widget) && widget.children[0] instanceof ListTextElementBox) {\n            var left = this.getLeftValue(widget);\n            var width = widget.children[0].width;\n            var height = widget.children[0].height;\n            if (this.isInsideRect(left, widget.paragraph.y, width, height, cursorPoint)) {\n                this.selectionLineWidget = widget;\n                return true;\n            }\n        }\n        return false;\n    };\n    /**\n     * Check whether touch point is inside the rectangle or not.\n     * @param x\n     * @param y\n     * @param width\n     * @param height\n     * @param touchPoint\n     * @private\n     */\n    LayoutViewer.prototype.isInsideRect = function (x, y, width, height, touchPoint) {\n        if ((touchPoint.x > x && touchPoint.x <= x + width) && (touchPoint.y > y && touchPoint.y <= y + height)) {\n            return true;\n        }\n        return false;\n    };\n    /**\n     * @private\n     */\n    LayoutViewer.prototype.getLeftValue = function (widget) {\n        var left = widget.paragraph.x;\n        var paragraphFormat = widget.paragraph.paragraphFormat;\n        if (this.selection.isParagraphFirstLine(widget)) {\n            if (paragraphFormat.textAlignment === 'Right') {\n                left -= HelperMethods.convertPointToPixel(paragraphFormat.firstLineIndent);\n                left -= HelperMethods.convertPointToPixel(paragraphFormat.leftIndent);\n            }\n            else {\n                left += HelperMethods.convertPointToPixel(paragraphFormat.firstLineIndent);\n            }\n        }\n        var element = widget.children[0];\n        if (element instanceof ListTextElementBox) {\n            left += element.margin.left;\n        }\n        return left;\n    };\n    /**\n     * Checks whether left mouse button is pressed or not.\n     */\n    LayoutViewer.prototype.isLeftButtonPressed = function (event) {\n        this.isTouchInput = false;\n        var button = event.which || event.button;\n        return button === 1;\n    };\n    /**\n     * Gets touch offset value.\n     */\n    LayoutViewer.prototype.getTouchOffsetValue = function (event) {\n        var targetElement = this.viewerContainer;\n        var offset = targetElement.getBoundingClientRect();\n        var touchOffsetValues = event.touches[0];\n        if (isNullOrUndefined(touchOffsetValues)) {\n            touchOffsetValues = event.changedTouches[0];\n        }\n        var offsetX = touchOffsetValues.pageX - offset.left;\n        var offsetY = touchOffsetValues.pageY - offset.top;\n        return new Point(offsetX, offsetY);\n    };\n    /**\n     * Fired on pinch zoom in.\n     * @param {TouchEvent} event\n     */\n    LayoutViewer.prototype.onPinchInInternal = function (event) {\n        this.preZoomFactor = this.zoomFactor;\n        var updatedZoomFactor = this.zoomFactor - 0.01;\n        if (updatedZoomFactor < 5 && updatedZoomFactor > 2) {\n            updatedZoomFactor = updatedZoomFactor - 0.01;\n        }\n        if (updatedZoomFactor < 0.1) {\n            updatedZoomFactor = 0.1;\n        }\n        this.zoomFactor = updatedZoomFactor;\n    };\n    /**\n     * Fired on pinch zoom out.\n     * @param {TouchEvent} event\n     */\n    LayoutViewer.prototype.onPinchOutInternal = function (event) {\n        this.preZoomFactor = this.zoomFactor;\n        var updatedZoomFactor = this.zoomFactor + 0.01;\n        if (updatedZoomFactor > 2) {\n            updatedZoomFactor = updatedZoomFactor + 0.01;\n        }\n        if (updatedZoomFactor > 5) {\n            updatedZoomFactor = 5;\n        }\n        this.zoomFactor = updatedZoomFactor;\n    };\n    /**\n     * Gets page width.\n     * @private\n     */\n    LayoutViewer.prototype.getPageWidth = function (page) {\n        var width = page.boundingRectangle.width;\n        return width;\n    };\n    /**\n     * Removes specified page.\n     * @private\n     */\n    LayoutViewer.prototype.removePage = function (page) {\n        if (this.currentPage === page) {\n            this.currentPage = undefined;\n        }\n        var index = this.pages.indexOf(page);\n        // if (index > -1) {\n        this.pages.splice(index, 1);\n        // }        \n        //this.removeRenderedPages();\n        var viewer = this;\n        if (!isNullOrUndefined(viewer.visiblePages)) {\n            if ((viewer.visiblePages).indexOf(page) > -1) {\n                var pageIndex = (viewer.visiblePages).indexOf(page);\n                (viewer.visiblePages).splice(pageIndex, 1);\n            }\n        }\n        //(viewer as PageLayoutViewer).visiblePages.remove(page);\n        var height = 0;\n        for (var i = 0; i < this.pages.length; i++) {\n            height = height + this.pages[i].boundingRectangle.height;\n        }\n        //Updates the vertical height.\n        height -= page.boundingRectangle.height + 20;\n        //ToDo:Update horizontal width, if removed page has max width.\n        var top = 20;\n        if (index > 0) {\n            top += this.pages[index - 1].boundingRectangle.bottom;\n        }\n        if (index !== -1) {\n            for (var i = index; i < this.pages.length; i++) {\n                //Update bounding rectangle of next pages in collection.\n                page = this.pages[i];\n                // tslint:disable-next-line:max-line-length\n                page.boundingRectangle = new Rect(page.boundingRectangle.x, top, page.boundingRectangle.width, page.boundingRectangle.height);\n                top = page.boundingRectangle.bottom + 20;\n                page.repeatHeaderRowTableWidget = false;\n            }\n        }\n    };\n    // private removeRenderedPages(): void {\n    //     for (let i: number = 0; i < this.pages.length; i++) {\n    //         this.clearContainer(this.pages[i]);\n    //     }\n    // }\n    /**\n     * Updates viewer size on window resize.\n     * @private\n     */\n    LayoutViewer.prototype.updateViewerSize = function () {\n        var viewer = this;\n        var element = this.owner.getDocumentEditorElement();\n        viewer.updateViewerSizeInternal(element);\n        viewer.updateScrollBars();\n        if (!isNullOrUndefined(this.selection)) {\n            this.selection.updateCaretPosition();\n        }\n    };\n    /**\n     * Updates viewer size.\n     */\n    LayoutViewer.prototype.updateViewerSizeInternal = function (element) {\n        if (!isNullOrUndefined(element)) {\n            var rect = element.getBoundingClientRect();\n            var width = 0;\n            var height = 0;\n            height = rect.height > 0 ? rect.height : 200;\n            if (this.owner.optionsPaneModule && this.owner.optionsPaneModule.isOptionsPaneShow) {\n                var optionsRect = this.owner.optionsPaneModule.optionsPane.getBoundingClientRect();\n                width = (rect.width - optionsRect.width) > 0 ? (rect.width - optionsRect.width) : 200;\n            }\n            else {\n                width = rect.width > 0 ? rect.width : 200;\n            }\n            this.viewerContainer.style.height = height.toString() + 'px';\n            this.viewerContainer.style.width = Math.ceil(width) + 'px';\n            this.visibleBoundsIn = new Rect(0, 0, width, height);\n            this.containerCanvas.width = width;\n            this.containerCanvas.height = height;\n            this.selectionCanvas.width = width;\n            this.selectionCanvas.height = height;\n        }\n    };\n    /**\n     * Updates client area for block.\n     * @private\n     */\n    LayoutViewer.prototype.updateClientAreaForBlock = function (block, beforeLayout, tableCollection) {\n        var leftIndent = HelperMethods.convertPointToPixel(block.leftIndent);\n        var rightIndent = HelperMethods.convertPointToPixel(block.rightIndent);\n        if (beforeLayout) {\n            if (block instanceof TableWidget && tableCollection) {\n                var tableWidget = tableCollection[0];\n                this.clientActiveArea.x = this.clientArea.x = tableWidget.x;\n                this.clientActiveArea.width = this.clientArea.width = tableWidget.width;\n                //Updates the location of last item.\n                tableWidget = tableCollection[tableCollection.length - 1];\n                tableWidget.x = this.clientActiveArea.x;\n                tableWidget.y = this.clientActiveArea.y;\n                this.clientArea = new Rect(this.clientArea.x, this.clientArea.y, this.clientArea.width, this.clientArea.height);\n                // tslint:disable-next-line:max-line-length\n                this.clientActiveArea = new Rect(this.clientActiveArea.x, this.clientActiveArea.y, this.clientActiveArea.width, this.clientActiveArea.height);\n            }\n            else {\n                // tslint:disable-next-line:max-line-length\n                if (block instanceof TableWidget && !isNullOrUndefined(block.tableFormat) && block.tableFormat.tableAlignment !== 'Left') {\n                    if (!block.isGridUpdated) {\n                        block.buildTableColumns();\n                        block.isGridUpdated = true;\n                    }\n                    var tableWidth = block.getMaxRowWidth(block.getTableClientWidth(block.getOwnerWidth(false)));\n                    // Fore resizing table, the tableholder table width taken for updated width. \n                    // Since, the columns will be cleared if we performed resizing.\n                    if (this.owner.editor && this.owner.editor.tableResize.currentResizingTable === block\n                        && this.owner.editor.tableResize.resizerPosition === 0) {\n                        tableWidth = block.tableHolder.tableWidth;\n                    }\n                    tableWidth = HelperMethods.convertPointToPixel(tableWidth);\n                    if (block.tableFormat.tableAlignment === 'Center') {\n                        leftIndent = (this.clientArea.width - tableWidth) / 2;\n                    }\n                    else {\n                        leftIndent = this.clientArea.width - tableWidth;\n                    }\n                    this.tableLefts.push(leftIndent);\n                }\n                this.clientActiveArea.x = this.clientArea.x = this.clientArea.x + leftIndent;\n                var width = this.clientArea.width - (leftIndent + rightIndent);\n                this.clientActiveArea.width = this.clientArea.width = width > 0 ? width : 0;\n                // tslint:disable-next-line:max-line-length\n                this.clientArea = new Rect(this.clientArea.x, this.clientArea.y, this.clientArea.width, this.clientArea.height);\n                // tslint:disable-next-line:max-line-length\n                this.clientActiveArea = new Rect(this.clientActiveArea.x, this.clientActiveArea.y, this.clientActiveArea.width, this.clientActiveArea.height);\n            }\n        }\n        else {\n            // tslint:disable-next-line:max-line-length\n            if (block instanceof TableWidget && block.tableFormat.tableAlignment !== 'Left' && this.tableLefts.length > 0) {\n                leftIndent = this.tableLefts.pop();\n            }\n            this.clientActiveArea.x = this.clientArea.x = this.clientArea.x - leftIndent;\n            var width = this.clientArea.width + leftIndent + rightIndent;\n            this.clientActiveArea.width = this.clientArea.width = width > 0 ? width : 0;\n            this.clientArea = new Rect(this.clientArea.x, this.clientArea.y, this.clientArea.width, this.clientArea.height);\n            // tslint:disable-next-line:max-line-length\n            this.clientActiveArea = new Rect(this.clientActiveArea.x, this.clientActiveArea.y, this.clientActiveArea.width, this.clientActiveArea.height);\n        }\n    };\n    /**\n     * Updates client active area left.\n     * @private\n     */\n    LayoutViewer.prototype.cutFromLeft = function (x) {\n        if (x < this.clientActiveArea.x) {\n            x = this.clientActiveArea.x;\n        }\n        if (x > this.clientActiveArea.right && this.textWrap) {\n            x = this.clientActiveArea.right;\n        }\n        this.clientActiveArea.width = this.clientActiveArea.right > x ? this.clientActiveArea.right - x : 0;\n        this.clientActiveArea.x = x;\n    };\n    /**\n     * Updates client active area top.\n     * @private\n     */\n    LayoutViewer.prototype.cutFromTop = function (y) {\n        if (y < this.clientActiveArea.y) {\n            y = this.clientActiveArea.y;\n        }\n        if (y > this.clientActiveArea.bottom) {\n            y = this.clientActiveArea.bottom;\n        }\n        this.clientActiveArea.height = this.clientActiveArea.bottom - y;\n        this.clientActiveArea.x = this.clientArea.x;\n        this.clientActiveArea.width = this.clientArea.width;\n        this.clientActiveArea.y = y;\n    };\n    /**\n     * Updates client width.\n     * @private\n     */\n    LayoutViewer.prototype.updateClientWidth = function (width) {\n        this.clientActiveArea.x -= width;\n        if (this.clientActiveArea.width + width > 0) {\n            this.clientActiveArea.width += width;\n        }\n        else {\n            this.clientActiveArea.width = 0;\n        }\n    };\n    /**\n     * Inserts page in specified index.\n     * @private\n     */\n    LayoutViewer.prototype.insertPage = function (index, page) {\n        if (this.pages.indexOf(page) > -1) {\n            this.pages.splice(this.pages.indexOf(page), 1);\n        }\n        this.pages.splice(index, 0, page);\n        var top = 20;\n        if (index > 0) {\n            top += this.pages[index - 1].boundingRectangle.bottom;\n        }\n        for (var i = index; i < this.pages.length; i++) {\n            //Update bounding rectangle of next pages in collection.\n            page = this.pages[i];\n            page.boundingRectangle = new Rect(page.boundingRectangle.x, top, page.boundingRectangle.width, page.boundingRectangle.height);\n            top = page.boundingRectangle.bottom + 20;\n        }\n    };\n    /**\n     * Updates client area.\n     * @private\n     */\n    LayoutViewer.prototype.updateClientArea = function (sectionFormat, page) {\n        var top = 0;\n        var headerDistance = 48;\n        var footerDistance = 48;\n        var pageHeight = HelperMethods.convertPointToPixel(sectionFormat.pageHeight);\n        var bottomMargin = HelperMethods.convertPointToPixel(sectionFormat.bottomMargin);\n        if (!isNullOrUndefined(sectionFormat)) {\n            top = HelperMethods.convertPointToPixel(sectionFormat.topMargin);\n            headerDistance = HelperMethods.convertPointToPixel(sectionFormat.headerDistance);\n            footerDistance = HelperMethods.convertPointToPixel(sectionFormat.footerDistance);\n        }\n        if (!isNullOrUndefined(page.headerWidget)) {\n            top = Math.min(Math.max(headerDistance + page.headerWidget.height, top), pageHeight / 100 * 40);\n        }\n        var bottom = 0.667 + bottomMargin;\n        if (!isNullOrUndefined(page.footerWidget)) {\n            bottom = 0.667 + Math.min(pageHeight / 100 * 40, Math.max(footerDistance + page.footerWidget.height, bottomMargin));\n        }\n        var width = 0;\n        var height = 0;\n        if (!isNullOrUndefined(sectionFormat)) {\n            width = HelperMethods.convertPointToPixel(sectionFormat.pageWidth - sectionFormat.leftMargin - sectionFormat.rightMargin);\n            height = pageHeight - top - bottom;\n        }\n        if (width < 0) {\n            width = 0;\n        }\n        this.clientArea = new Rect(HelperMethods.convertPointToPixel(sectionFormat.leftMargin), top, width, pageHeight - top - bottom);\n        this.clientActiveArea = new Rect(this.clientArea.x, this.clientArea.y, this.clientArea.width, this.clientArea.height);\n    };\n    /**\n     * Updates client area left or top position.\n     * @private\n     */\n    LayoutViewer.prototype.updateClientAreaTopOrLeft = function (tableWidget, beforeLayout) {\n        if (beforeLayout) {\n            this.clientActiveArea.y = this.clientActiveArea.y + tableWidget.topBorderWidth;\n            this.clientActiveArea.x = this.clientActiveArea.x + tableWidget.leftBorderWidth;\n        }\n    };\n    /**\n     * Updates client area for table.\n     * @private\n     */\n    LayoutViewer.prototype.updateClientAreaForTable = function (tableWidget) {\n        this.clientActiveArea.x = this.clientArea.x = tableWidget.x;\n        this.clientActiveArea.width = this.clientArea.width = tableWidget.width;\n    };\n    /**\n     * Updates client area for row.\n     * @private\n     */\n    LayoutViewer.prototype.updateClientAreaForRow = function (row, beforeLayout) {\n        // tslint:disable-next-line:max-line-length\n        var tableWidget = row.ownerTable;\n        if (beforeLayout) {\n            //tslint:disable:no-empty\n        }\n        else {\n            this.clientActiveArea.x = this.clientArea.x = tableWidget.x;\n            this.clientActiveArea.width = this.clientArea.width = tableWidget.width;\n            this.clientArea = new Rect(this.clientArea.x, this.clientArea.y, this.clientArea.width, this.clientArea.height);\n            // tslint:disable-next-line:max-line-length\n            this.clientActiveArea = new Rect(this.clientActiveArea.x, this.clientActiveArea.y, this.clientActiveArea.width, this.clientActiveArea.height);\n        }\n    };\n    /**\n     * Updates client area for cell.\n     * @private\n     */\n    LayoutViewer.prototype.updateClientAreaForCell = function (cell, beforeLayout) {\n        // tslint:disable-next-line:max-line-length\n        var rowWidget = cell.ownerRow;\n        var cellWidget = cell;\n        if (beforeLayout) {\n            this.clientActiveArea.x = this.clientArea.x = cellWidget.x;\n            this.clientActiveArea.y = cellWidget.y;\n            this.clientActiveArea.width = this.clientArea.width = cellWidget.width > 0 ? cellWidget.width : 0;\n            if (this instanceof PageLayoutViewer) {\n                this.clientActiveArea.height = Number.POSITIVE_INFINITY;\n            }\n            this.clientArea = new Rect(this.clientArea.x, this.clientArea.y, this.clientArea.width, this.clientArea.height);\n            // tslint:disable-next-line:max-line-length\n            this.clientActiveArea = new Rect(this.clientActiveArea.x, this.clientActiveArea.y, this.clientActiveArea.width, this.clientActiveArea.height);\n        }\n        else {\n            this.clientActiveArea.x = this.clientArea.x = cellWidget.x + cellWidget.width + cellWidget.margin.right;\n            if (rowWidget.x + rowWidget.width - this.clientArea.x < 0) {\n                this.clientActiveArea.width = this.clientArea.width = 0;\n            }\n            else {\n                this.clientActiveArea.width = this.clientArea.width = rowWidget.x + rowWidget.width - this.clientArea.x;\n            }\n            // tslint:disable-next-line:max-line-length\n            this.clientActiveArea.y = cellWidget.y - cellWidget.margin.top - HelperMethods.convertPointToPixel(cell.ownerTable.tableFormat.cellSpacing);\n            if (!cell.ownerTable.isInsideTable) {\n                this.clientActiveArea.height = this.clientArea.bottom - rowWidget.y > 0 ? this.clientArea.bottom - rowWidget.y : 0;\n            }\n            this.clientArea = new Rect(this.clientArea.x, this.clientArea.y, this.clientArea.width, this.clientArea.height);\n            // tslint:disable-next-line:max-line-length\n            this.clientActiveArea = new Rect(this.clientActiveArea.x, this.clientActiveArea.y, this.clientActiveArea.width, this.clientActiveArea.height);\n        }\n    };\n    /**\n     * Updates the client area based on widget.\n     * @private\n     */\n    LayoutViewer.prototype.updateClientAreaByWidget = function (widget) {\n        this.clientArea.x = widget.x;\n        this.clientArea.y = widget.y;\n        this.clientActiveArea.x = widget.x;\n        this.clientActiveArea.y = widget.y;\n    };\n    //Widget\n    /**\n     * Updates client area location.\n     * @param widget\n     * @param area\n     * @private\n     */\n    LayoutViewer.prototype.updateClientAreaLocation = function (widget, area) {\n        widget.x = area.x;\n        widget.y = area.y;\n        widget.width = area.width;\n    };\n    /**\n     * Updates text position for selection.\n     * @param cursorPoint\n     * @param tapCount\n     * @param clearMultiSelection\n     * @private\n     */\n    LayoutViewer.prototype.updateTextPositionForSelection = function (cursorPoint, tapCount) {\n        var widget = this.getLineWidget(cursorPoint);\n        if (!isNullOrUndefined(widget)) {\n            this.selection.updateTextPosition(widget, cursorPoint);\n        }\n        if (tapCount > 1) {\n            this.isMouseDown = false;\n            this.useTouchSelectionMark = false;\n            if (this.pages.length === 0) {\n                return;\n            }\n            //Double tap/triple tap selection\n            if (!isNullOrUndefined(this.currentPage) && !isNullOrUndefined(this.owner.selection.start)) {\n                if (tapCount % 2 === 0) {\n                    this.owner.selection.selectCurrentWord();\n                }\n                else {\n                    this.owner.selection.selectCurrentParagraph();\n                }\n            }\n        }\n    };\n    /**\n     * Scrolls to specified position.\n     * @param startPosition\n     * @param endPosition\n     * @private\n     */\n    LayoutViewer.prototype.scrollToPosition = function (startPosition, endPosition) {\n        if (this.owner.enableImageResizerMode && this.owner.imageResizerModule.isImageResizing\n            || this.isMouseDownInFooterRegion || this.isRowOrCellResizing) {\n            return;\n        }\n        var lineWidget = this.selection.getLineWidgetInternal(endPosition.currentWidget, endPosition.offset, true);\n        if (isNullOrUndefined(lineWidget)) {\n            return;\n        }\n        var top = this.selection.getTop(lineWidget);\n        if (this.isMouseDown) {\n            var prevLineWidget = this.selection.getLineWidgetInternal(endPosition.currentWidget, endPosition.offset, false);\n            var prevTop = this.selection.getTop(prevLineWidget);\n            if (prevLineWidget !== lineWidget && endPosition.location.y >= prevTop) {\n                lineWidget = prevLineWidget;\n            }\n        }\n        var height = lineWidget.height;\n        //Gets current page.\n        var endPage = this.selection.getPage(lineWidget.paragraph);\n        this.currentPage = endPage;\n        var x = 0;\n        var y = 0;\n        var viewer = this;\n        var horizontalWidth = 0;\n        var isPageLayout = viewer instanceof PageLayoutViewer;\n        if (isPageLayout) {\n            var pageLayout = viewer;\n            if (isNullOrUndefined(endPage)) {\n                return;\n            }\n            var pageWidth = endPage.boundingRectangle.width;\n            x = (this.visibleBounds.width - pageWidth * this.zoomFactor) / 2;\n            if (x < 30) {\n                x = 30;\n            }\n            // tslint:disable-next-line:max-line-length\n            y = endPage.boundingRectangle.y * this.zoomFactor + (this.pages.indexOf(endPage) + 1) * viewer.pageGap * (1 - this.zoomFactor);\n        }\n        var scrollTop = this.containerTop;\n        var scrollLeft = this.containerLeft;\n        var pageHeight = this.visibleBounds.height;\n        var caretInfo = this.selection.updateCaretSize(this.owner.selection.end, true);\n        var topMargin = caretInfo.topMargin;\n        var caretHeight = caretInfo.height;\n        x += (endPosition.location.x) * this.zoomFactor;\n        y += (endPosition.location.y + topMargin) * this.zoomFactor;\n        //vertical scroll bar update\n        if ((scrollTop + 20) > y) {\n            this.viewerContainer.scrollTop = (y - 10);\n        }\n        else if (scrollTop + pageHeight < y + caretHeight) {\n            this.viewerContainer.scrollTop = y + caretHeight - pageHeight + 10;\n        }\n        else {\n            this.selection.updateCaretToPage(startPosition, endPage);\n        }\n        this.selection.updateCaretToPage(startPosition, endPage);\n        var scrollBarWidth = this.viewerContainer.offsetWidth - this.viewerContainer.clientWidth;\n        if (scrollLeft > x) {\n            this.viewerContainer.scrollLeft = x - (viewer.pageContainer.offsetWidth / 100) * 20;\n        }\n        else if (scrollLeft + this.visibleBounds.width < x + scrollBarWidth) {\n            this.viewerContainer.scrollLeft = scrollLeft + (viewer.pageContainer.offsetWidth / 100) * 15 + scrollBarWidth;\n        }\n    };\n    /**\n     * Gets line widget using cursor point.\n     * @private\n     */\n    LayoutViewer.prototype.getLineWidget = function (cursorPoint) {\n        return this.getLineWidgetInternal(cursorPoint, false);\n    };\n    /**\n     * Gets line widget.\n     * @private\n     */\n    LayoutViewer.prototype.getLineWidgetInternal = function (cursorPoint, isMouseDragged) {\n        var widget = undefined;\n        if (!isNullOrUndefined(this.currentPage)) {\n            var childWidgets = void 0;\n            if (this.owner.enableHeaderAndFooter) {\n                var page = this.currentPage;\n                var pageTop = this.selection.getPageTop(page);\n                var pageBottom = page.boundingRectangle.height;\n                var headerHeight = Math.max((page.headerWidget.y + page.headerWidget.height), HelperMethods.convertPointToPixel(page.bodyWidgets[0].sectionFormat.topMargin)) * this.zoomFactor;\n                var footerDistance = HelperMethods.convertPointToPixel(page.bodyWidgets[0].sectionFormat.footerDistance);\n                var footerHeight = (page.boundingRectangle.height -\n                    Math.max(page.footerWidget.height + footerDistance, footerDistance * 2));\n                if (isMouseDragged) {\n                    if (this.isBlockInHeader(this.selection.start.paragraph)) {\n                        childWidgets = this.currentPage.headerWidget;\n                    }\n                    else {\n                        childWidgets = this.currentPage.footerWidget;\n                    }\n                }\n                else {\n                    if (cursorPoint.y <= pageBottom && cursorPoint.y >= footerHeight) {\n                        childWidgets = this.currentPage.footerWidget;\n                    }\n                    else if ((cursorPoint.y) >= 0 && (cursorPoint.y) <= headerHeight) {\n                        childWidgets = this.currentPage.headerWidget;\n                    }\n                }\n                if (isNullOrUndefined(childWidgets)) {\n                    return undefined;\n                }\n                return this.selection.getLineWidgetBodyWidget(childWidgets, cursorPoint);\n            }\n            else {\n                for (var i = 0; i < this.currentPage.bodyWidgets.length; i++) {\n                    var bodyWidgets = this.currentPage.bodyWidgets[i];\n                    widget = this.selection.getLineWidgetBodyWidget(bodyWidgets, cursorPoint);\n                    if (!isNullOrUndefined(widget)) {\n                        break;\n                    }\n                }\n            }\n        }\n        return widget;\n    };\n    /**\n     * @private\n     */\n    LayoutViewer.prototype.isBlockInHeader = function (block) {\n        while (!(block.containerWidget instanceof HeaderFooterWidget)) {\n            if (!block.containerWidget) {\n                return false;\n            }\n            block = block.containerWidget;\n        }\n        return block.containerWidget.headerFooterType.indexOf('Header') !== -1;\n    };\n    /**\n     * Clears selection highlight.\n     * @private\n     */\n    LayoutViewer.prototype.clearSelectionHighlight = function () {\n        var canClear = true;\n        canClear = (!this.isControlPressed || !this.isMouseDown);\n        // if (this.owner.selection.selectionRanges.length > 0 && canClear) {\n        if (this.owner.selection.clearSelectionHighlightInSelectedWidgets()) {\n            this.selectionContext.clearRect(0, 0, this.selectionCanvas.width, this.selectionCanvas.height);\n        }\n        // } else if (!isNullOrUndefined(this.owner.selection.currentSelectionRange) && this.isMouseDown) {\n        //     this.owner.selection.currentSelectionRange.clearSelectionHighlight();\n        // }\n        //this.renderVisiblePages();\n    };\n    /**\n     * @private\n     */\n    LayoutViewer.prototype.removeEmptyPages = function () {\n        var scrollToLastPage = false;\n        var viewer = this;\n        for (var j = 0; j < this.pages.length; j++) {\n            var page = this.pages[j];\n            if (page.bodyWidgets.length === 0 || page.bodyWidgets[0].childWidgets.length === 0) {\n                // tslint:disable-next-line:max-line-length\n                if (j === this.pages.length - 1 && viewer instanceof PageLayoutViewer && viewer.visiblePages.indexOf(this.pages[j]) !== -1) {\n                    scrollToLastPage = true;\n                }\n                this.removePage(this.pages[j]);\n                j--;\n            }\n        }\n        if (scrollToLastPage) {\n            this.scrollToBottom();\n        }\n    };\n    /**\n     * @private\n     */\n    LayoutViewer.prototype.scrollToBottom = function () {\n        if (this.selection.start.paragraph && this.selection.start.paragraph.bodyWidget) {\n            var page = this.selection.start.paragraph.bodyWidget.page;\n            var containerHeight = this.visibleBounds.height;\n            this.viewerContainer.scrollTop = page.boundingRectangle.bottom - containerHeight;\n        }\n    };\n    /**\n     * Returns the field code result.\n     * @private\n     */\n    LayoutViewer.prototype.getFieldResult = function (fieldBegin, page) {\n        if (!isNullOrUndefined(page) && !isNullOrUndefined(this.selection)) {\n            var fieldCode = this.selection.getFieldCode(fieldBegin);\n            var fieldCodes = fieldCode.split('\\*');\n            if (fieldCodes.length > 1) {\n                var fieldCategory = fieldCodes[0].replace(/[^\\w\\s]/gi, '').trim().toLowerCase();\n                var fieldPattern = fieldCodes[1].replace(/[^\\w\\s]/gi, '').trim();\n                switch (fieldCategory) {\n                    case 'page':\n                        return this.getFieldText(fieldPattern, (page.index + 1));\n                    case 'numpages':\n                        return this.getFieldText(fieldPattern, page.viewer.pages.length);\n                    default:\n                        break;\n                }\n            }\n        }\n        return '';\n    };\n    /**\n     * Returns field text.\n     */\n    LayoutViewer.prototype.getFieldText = function (pattern, value) {\n        switch (pattern) {\n            case 'ALPHABETIC':\n                return this.layout.getAsLetter(value).toUpperCase();\n            case 'alphabetic':\n                return this.layout.getAsLetter(value).toLowerCase();\n            case 'roman':\n                return this.layout.getAsRoman(value).toLowerCase();\n            case 'ROMAN':\n                return this.layout.getAsRoman(value).toUpperCase();\n            default:\n                return value.toString();\n        }\n    };\n    /**\n     * Destroys the internal objects maintained for control.\n     */\n    LayoutViewer.prototype.destroy = function () {\n        if (!isNullOrUndefined(this.owner)) {\n            this.unWireEvent();\n        }\n        this.pages = [];\n        this.pages = undefined;\n        this.fieldStacks = [];\n        this.fieldStacks = undefined;\n        this.splittedCellWidgets = [];\n        this.splittedCellWidgets = undefined;\n        this.fields = [];\n        this.fields = undefined;\n        if (this.layout) {\n            this.layout.destroy();\n        }\n        this.layout = undefined;\n        if (!isNullOrUndefined(this.render)) {\n            this.render.destroy();\n        }\n        this.render = undefined;\n        if (this.dialogInternal) {\n            this.dialogInternal.destroy();\n        }\n        this.dialogInternal = undefined;\n        if (this.dialogTarget && this.dialogTarget.parentElement) {\n            this.dialogTarget.parentElement.removeChild(this.dialogTarget);\n        }\n        this.dialogTarget = undefined;\n        if (!isNullOrUndefined(this.touchStart)) {\n            this.touchStart.innerHTML = '';\n        }\n        if (this.textHelper) {\n            this.textHelper.destroy();\n        }\n        this.textHelper = undefined;\n        this.touchStart = undefined;\n        if (!isNullOrUndefined(this.touchEnd)) {\n            this.touchEnd.innerHTML = '';\n        }\n        this.touchEnd = undefined;\n        if (!isNullOrUndefined(this.containerCanvasIn)) {\n            this.containerCanvasIn.innerHTML = '';\n        }\n        this.containerCanvasIn = undefined;\n        if (!isNullOrUndefined(this.selectionCanvasIn)) {\n            this.selectionCanvasIn.innerHTML = '';\n        }\n        this.selectionCanvasIn = undefined;\n        if (!isNullOrUndefined(this.editableDiv)) {\n            this.editableDiv.innerHTML = '';\n            this.editableDiv.parentElement.removeChild(this.editableDiv);\n        }\n        this.editableDiv = undefined;\n        if (!isNullOrUndefined(this.pageContainer)) {\n            this.pageContainer.innerHTML = '';\n        }\n        this.pageContainer = undefined;\n        if (!isNullOrUndefined(this.viewerContainer)) {\n            this.viewerContainer.innerHTML = '';\n        }\n        this.viewerContainer = undefined;\n        this.owner = undefined;\n        this.heightInfoCollection = undefined;\n    };\n    /**\n     * Un-Wires events and methods\n     */\n    LayoutViewer.prototype.unWireEvent = function () {\n        this.viewerContainer.removeEventListener('scroll', this.scrollHandler);\n        this.viewerContainer.removeEventListener('mousedown', this.onMouseDownInternal);\n        this.viewerContainer.removeEventListener('mousemove', this.onMouseMoveInternal);\n        if (Browser.isIE) {\n            this.editableDiv.removeEventListener('keypress', this.onKeyPressInternal);\n        }\n        else {\n            this.editableDiv.removeEventListener('input', this.onTextInputInternal);\n        }\n        this.editableDiv.removeEventListener('paste', this.onPaste);\n        this.viewerContainer.removeEventListener('contextmenu', this.onContextMenu);\n        this.editableDiv.removeEventListener('blur', this.onFocusOut);\n        this.editableDiv.removeEventListener('keydown', this.onKeyDownInternal);\n        this.editableDiv.removeEventListener('compositionstart', this.compositionStart);\n        this.editableDiv.removeEventListener('compositionupdate', this.compositionUpdated);\n        this.editableDiv.removeEventListener('compositionend', this.compositionEnd);\n        this.viewerContainer.removeEventListener('mouseup', this.onMouseUpInternal);\n        this.viewerContainer.removeEventListener('dblclick', this.onDoubleTap);\n        window.removeEventListener('resize', this.onWindowResize);\n        window.removeEventListener('keyup', this.onKeyUpInternal);\n        window.removeEventListener('mouseup', this.onImageResizer);\n        window.removeEventListener('touchend', this.onImageResizer);\n    };\n    return LayoutViewer;\n}());\nexport { LayoutViewer };\n/**\n * @private\n */\nvar PageLayoutViewer = /** @class */ (function (_super) {\n    __extends(PageLayoutViewer, _super);\n    /**\n     * Initialize the constructor of PageLayoutViewer\n     */\n    function PageLayoutViewer(owner) {\n        var _this = _super.call(this, owner) || this;\n        _this.pageLeft = 30;\n        /**\n         * @private\n         */\n        _this.pageGap = 20;\n        /**\n         * @private\n         */\n        _this.visiblePages = [];\n        if (isNullOrUndefined(owner) || isNullOrUndefined(owner.element)) {\n            return _this;\n        }\n        return _this;\n    }\n    /**\n     * Creates new page.\n     * @private\n     */\n    PageLayoutViewer.prototype.createNewPage = function (section, index) {\n        var viewer = this;\n        var yPos = this.pageGap;\n        if (this.pages.length > 0) {\n            yPos = this.pages[this.pages.length - 1].boundingRectangle.bottom + this.pageGap;\n        }\n        var page = new Page();\n        page.viewer = this;\n        // tslint:disable-next-line:max-line-length\n        var pageWidth = !isNullOrUndefined(section.sectionFormat) ? HelperMethods.convertPointToPixel(section.sectionFormat.pageWidth) : 816;\n        // tslint:disable-next-line:max-line-length\n        var pageHeight = !isNullOrUndefined(section.sectionFormat) ? HelperMethods.convertPointToPixel(section.sectionFormat.pageHeight) : 1056;\n        var xPos = (this.visibleBounds.width - pageWidth * this.zoomFactor) / 2;\n        if (xPos < this.pageLeft) {\n            xPos = this.pageLeft;\n        }\n        page.boundingRectangle = new Rect(xPos, yPos, pageWidth, pageHeight);\n        if (isNullOrUndefined(index)) {\n            this.pages.push(page);\n        }\n        else {\n            this.pages.splice(index, 0, page);\n        }\n        this.updateClientArea(section.sectionFormat, page);\n        page.bodyWidgets.push(section);\n        page.bodyWidgets[page.bodyWidgets.length - 1].page = page;\n        this.layout.layoutHeaderFooter(section, viewer, page);\n        this.updateClientArea(section.sectionFormat, page);\n        return page;\n    };\n    /**\n     * Updates cursor.\n     */\n    PageLayoutViewer.prototype.updateCursor = function (event) {\n        var hyperlinkField = undefined;\n        var div = this.viewerContainer;\n        var point = new Point(event.offsetX, event.offsetY);\n        var touchPoint = this.findFocusedPage(point, true);\n        var widget = this.getLineWidget(touchPoint);\n        var widgetInfo;\n        var left;\n        var top;\n        var editor = !this.owner.isReadOnlyMode ? this.owner.editorModule : undefined;\n        var isRowResize = editor ? editor.tableResize.isInRowResizerArea(touchPoint) : false;\n        var isCellResize = editor ? editor.tableResize.isInCellResizerArea(touchPoint) : false;\n        var resizePosition = '';\n        if (this.owner.enableImageResizerMode) {\n            var resizeObj = this.owner.imageResizerModule.getImagePoint(touchPoint);\n            this.owner.imageResizerModule.selectedResizeElement = resizeObj.selectedElement;\n            resizePosition = resizeObj.resizePosition;\n        }\n        var lineLeft = 0;\n        if (!isNullOrUndefined(widget)) {\n            lineLeft = this.selection.getLineStartLeft(widget);\n            hyperlinkField = this.selection.getHyperLinkFieldInCurrentSelection(widget, touchPoint);\n            widgetInfo = this.selection.updateTextPositionIn(widget, undefined, 0, touchPoint, true);\n            left = this.selection.getLeft(widget);\n            top = this.selection.getTop(widget);\n            this.selection.setHyperlinkContentToToolTip(hyperlinkField, widget, touchPoint.x);\n        }\n        if (!isNullOrUndefined(hyperlinkField) && (event.ctrlKey &&\n            this.owner.useCtrlClickToFollowHyperlink || !this.owner.useCtrlClickToFollowHyperlink)) {\n            div.style.cursor = 'pointer';\n            return;\n        }\n        else if (touchPoint.x >= lineLeft &&\n            event.offsetX < (this.visibleBounds.width - (this.visibleBounds.width - this.viewerContainer.clientWidth)) &&\n            event.offsetY < (this.visibleBounds.height - (this.visibleBounds.height - this.viewerContainer.clientHeight))) {\n            if (this.selection.isEmpty) {\n                div.style.cursor = 'text';\n            }\n            else {\n                div.style.cursor = this.selection.checkCursorIsInSelection(widget, touchPoint) ? 'default' : 'text';\n            }\n        }\n        else {\n            div.style.cursor = 'default';\n        }\n        if (!isNullOrUndefined(resizePosition) && resizePosition !== '') {\n            div.style.cursor = resizePosition;\n        }\n        else if (!isNullOrUndefined(widgetInfo) && widgetInfo.isImageSelected && left < touchPoint.x && top < touchPoint.y &&\n            left + widget.width > touchPoint.x && top + widget.height > touchPoint.y) {\n            div.style.cursor = 'move';\n        }\n        if (isRowResize) {\n            div.style.cursor = 'row-resize';\n        }\n        else if (isCellResize) {\n            div.style.cursor = 'col-resize';\n        }\n    };\n    /**\n     * Finds focused page.\n     * @private\n     */\n    PageLayoutViewer.prototype.findFocusedPage = function (currentPoint, updateCurrentPage) {\n        var point = new Point(currentPoint.x, currentPoint.y);\n        point.x += this.viewerContainer.scrollLeft;\n        point.y += this.viewerContainer.scrollTop;\n        for (var i = 0; i < this.pages.length; i++) {\n            var page = this.pages[i];\n            var pageTop = (page.boundingRectangle.y - this.pageGap * (i + 1)) * this.zoomFactor + this.pageGap * (i + 1);\n            var pageHeight = (page.boundingRectangle.height * this.zoomFactor) + this.pageGap;\n            var pageLeft = page.boundingRectangle.x;\n            var pageRight = ((page.boundingRectangle.right - pageLeft) * this.zoomFactor) + pageLeft;\n            if (pageTop <= point.y && pageTop + pageHeight >= point.y) {\n                if (updateCurrentPage) {\n                    this.currentPage = page;\n                }\n                point.y = (point.y - (pageTop)) / this.zoomFactor;\n                if (point.x > pageRight) {\n                    point.x = page.boundingRectangle.right;\n                }\n                else if (point.x < pageLeft) {\n                    point.x = 0;\n                }\n                else {\n                    point.x = (point.x - pageLeft) / this.zoomFactor;\n                }\n                return point;\n            }\n        }\n        return point;\n    };\n    /**\n     * Fired when page fit type changed.\n     * @private\n     */\n    PageLayoutViewer.prototype.onPageFitTypeChanged = function (pageFitType) {\n        var width = this.visibleBounds.width;\n        var height = this.visibleBounds.height;\n        var section = this.visiblePages[0].bodyWidgets[0];\n        var pageWidth = HelperMethods.convertPointToPixel(section.sectionFormat.pageWidth);\n        var pageHeight = HelperMethods.convertPointToPixel(section.sectionFormat.pageHeight);\n        switch (pageFitType) {\n            case 'FitOnePage':\n                if (height > 0 && pageHeight > 0) {\n                    var zoomFactor = (this.visibleBounds.height - 2 * this.pageGap - (this.pageGap - 2)) / pageHeight;\n                    if (zoomFactor === this.zoomFactor) {\n                        if (!isNullOrUndefined(this.owner.selection) && !isNullOrUndefined(this.owner.selection.start) &&\n                            !isNullOrUndefined(this.owner.selection.end)) {\n                            this.scrollToPosition(this.owner.selection.start, this.owner.selection.end);\n                        }\n                    }\n                    else {\n                        this.zoomFactor = zoomFactor;\n                    }\n                }\n                break;\n            case 'FitPageWidth':\n                if (width > 0 && pageWidth > 0) {\n                    this.zoomFactor = (this.visibleBounds.width - 80) / pageWidth;\n                }\n                break;\n            default:\n                this.zoomFactor = 100 / 100;\n                break;\n        }\n    };\n    /**\n     * @private\n     */\n    PageLayoutViewer.prototype.handleZoom = function () {\n        var prevScaleFactor = this.preZoomFactor;\n        var page = null;\n        var verticalHeight = 0;\n        var scrollToPosition = false;\n        if (this.selection && isNullOrUndefined(this.zoomX && isNullOrUndefined(this.zoomY))) {\n            var x = 0;\n            var y = 0;\n            var endPage = this.selection.getPage(this.selection.end.currentWidget.paragraph);\n            x = (this.visibleBounds.width - endPage.boundingRectangle.width * prevScaleFactor) / 2;\n            if (x < 30) {\n                x = 30;\n            }\n            // tslint:disable-next-line:max-line-length\n            y = endPage.boundingRectangle.y * prevScaleFactor + (this.pages.indexOf(endPage) + 1) * this.pageGap * (1 - prevScaleFactor);\n            var caretInfo = this.selection.updateCaretSize(this.owner.selection.end, true);\n            var topMargin = caretInfo.topMargin;\n            var caretHeight = caretInfo.height;\n            x += (this.selection.end.location.x) * prevScaleFactor;\n            y += (this.selection.end.location.y + topMargin) * prevScaleFactor;\n            if (x >= this.containerLeft && x <= this.visibleBounds.width &&\n                y >= this.containerTop && y <= this.containerTop + this.visibleBounds.height) {\n                scrollToPosition = true;\n            }\n        }\n        for (var i = 0; i < this.pages.length; i++) {\n            verticalHeight = verticalHeight + this.pages[i].boundingRectangle.height;\n        }\n        var horizontalWidth = 0;\n        for (var i = 0; i < this.pages.length; i++) {\n            if (horizontalWidth < this.pages[i].boundingRectangle.width) {\n                horizontalWidth = this.pages[i].boundingRectangle.width;\n            }\n        }\n        // tslint:disable-next-line:max-line-length\n        var height = (verticalHeight * this.zoomFactor + (this.pages.length + 1) * this.pageGap * (1 - this.zoomFactor)) - this.visibleBounds.height;\n        var horWidth = horizontalWidth * this.zoomFactor - this.visibleBounds.width;\n        if (this.visibleBounds.width - horizontalWidth * this.zoomFactor < 60) {\n            horWidth += 60;\n        }\n        //Update Vertical Scroll bar\n        if (height > 0) {\n            var value = this.containerTop;\n            if (this.visiblePages.length > 0) {\n                page = this.visiblePages[0];\n                // tslint:disable-next-line:max-line-length\n                var prevPageTop = (page.boundingRectangle.y - (page.index + 1) * this.pageGap) * prevScaleFactor + (page.index + 1) * this.pageGap;\n                var zoomY = this.zoomY;\n                if (isNullOrUndefined) {\n                    zoomY = this.visibleBounds.height / 2;\n                }\n                var prevY = value + zoomY;\n                while (prevY > prevPageTop + (page.boundingRectangle.height * prevScaleFactor)) {\n                    var pageIndex = page.index + 1;\n                    if (pageIndex === this.pages.length) {\n                        break;\n                    }\n                    page = this.pages[pageIndex];\n                    // tslint:disable-next-line:max-line-length\n                    prevPageTop = (page.boundingRectangle.y - (page.index + 1) * this.pageGap) * prevScaleFactor + (page.index + 1) * this.pageGap;\n                }\n                // tslint:disable-next-line:max-line-length\n                var currentY = (page.boundingRectangle.y - (page.index + 1) * this.pageGap) * this.zoomFactor + (page.index + 1) * this.pageGap\n                    + ((prevY - prevPageTop) < 0 ? prevY - prevPageTop : (prevY - prevPageTop) * (this.zoomFactor / prevScaleFactor));\n                value = currentY - zoomY;\n                zoomY = this.visibleBounds.height / 2;\n            }\n            this.viewerContainer.scrollTop = value;\n        }\n        else {\n            this.viewerContainer.scrollTop = 0;\n        }\n        // update Horizontal Scroll Bar\n        if (horWidth > 0) {\n            var value = this.containerLeft;\n            if (this.visiblePages.length > 0) {\n                if (page === null) {\n                    page = this.visiblePages[0];\n                }\n                var zoomX = this.zoomX;\n                if (isNullOrUndefined(zoomX)) {\n                    zoomX = this.visibleBounds.width / 2;\n                }\n                var prevValue = (page.boundingRectangle.width * prevScaleFactor) / page.boundingRectangle.width;\n                var prevX = value + zoomX;\n                // tslint:disable-next-line:max-line-length\n                var currentX = page.boundingRectangle.x\n                    + ((prevX - page.boundingRectangle.x) < 0 ? prevX - page.boundingRectangle.x : (prevX - page.boundingRectangle.x) * (this.zoomFactor / prevValue));\n                value = currentX - zoomX;\n                zoomX = this.visibleBounds.width / 2;\n            }\n            this.viewerContainer.scrollLeft = value;\n        }\n        else {\n            this.viewerContainer.scrollLeft = 0;\n        }\n        this.updateScrollBars();\n        if (scrollToPosition) {\n            this.scrollToPosition(this.selection.start, this.selection.end);\n        }\n    };\n    /**\n     * Gets current page header footer.\n     * @private\n     */\n    PageLayoutViewer.prototype.getCurrentPageHeaderFooter = function (section, isHeader) {\n        return this.getCurrentHeaderFooter(this.getHeaderFooterType(section, isHeader), section.index);\n    };\n    /**\n     * Get header footer type\n     * @private\n     */\n    PageLayoutViewer.prototype.getHeaderFooterType = function (section, isHeader) {\n        var type;\n        type = isHeader ? 'OddHeader' : 'OddFooter';\n        // tslint:disable-next-line:max-line-length\n        if (section.sectionFormat.differentFirstPage && (this.pages.length === 1 || this.pages[this.pages.length - 1].bodyWidgets[0].index !== section.index)) {\n            type = isHeader ? 'FirstPageHeader' : 'FirstPageFooter';\n        }\n        else if (section.sectionFormat.differentOddAndEvenPages && this.pages.length % 2 === 0) {\n            type = isHeader ? 'EvenHeader' : 'EvenFooter';\n        }\n        return type;\n    };\n    /**\n     * Gets current header footer.\n     * @param type\n     * @param section\n     * @private\n     */\n    PageLayoutViewer.prototype.getCurrentHeaderFooter = function (type, sectionIndex) {\n        if (this.headersFooters[sectionIndex]) {\n            var index = this.getHeaderFooter(type);\n            var headerFooter = this.headersFooters[sectionIndex][index];\n            if (!headerFooter) {\n                headerFooter = this.createHeaderFooterWidget(type);\n                this.headersFooters[sectionIndex][index] = headerFooter;\n            }\n            return headerFooter;\n        }\n        else if (sectionIndex > 0) {\n            return this.getCurrentHeaderFooter(type, sectionIndex - 1);\n        }\n        return undefined;\n    };\n    PageLayoutViewer.prototype.createHeaderFooterWidget = function (type) {\n        var headerFooter = new HeaderFooterWidget(type);\n        var paragraph = new ParagraphWidget();\n        paragraph.childWidgets.push(new LineWidget(paragraph));\n        return headerFooter;\n    };\n    /**\n     * Gets header footer.\n     * @param type\n     * @private\n     */\n    PageLayoutViewer.prototype.getHeaderFooter = function (type) {\n        switch (type) {\n            case 'OddHeader':\n                return 0;\n            case 'OddFooter':\n                return 1;\n            case 'EvenHeader':\n                return 2;\n            case 'EvenFooter':\n                return 3;\n            case 'FirstPageHeader':\n                return 4;\n            case 'FirstPageFooter':\n                return 5;\n        }\n    };\n    /**\n     * Updates header footer client area.\n     * @private\n     */\n    PageLayoutViewer.prototype.updateHFClientArea = function (sectionFormat, isHeader) {\n        // tslint:disable-next-line:max-line-length\n        var width = HelperMethods.convertPointToPixel(sectionFormat.pageWidth - sectionFormat.leftMargin - sectionFormat.rightMargin);\n        if (width < 0) {\n            width = 0;\n        }\n        if (isHeader) {\n            // tslint:disable-next-line:max-line-length\n            this.clientArea = new Rect(HelperMethods.convertPointToPixel(sectionFormat.leftMargin), HelperMethods.convertPointToPixel(sectionFormat.headerDistance), width, Number.POSITIVE_INFINITY);\n        }\n        else {\n            // tslint:disable-next-line:max-line-length\n            this.clientArea = new Rect(HelperMethods.convertPointToPixel(sectionFormat.leftMargin), HelperMethods.convertPointToPixel(sectionFormat.pageHeight - sectionFormat.footerDistance), width, Number.POSITIVE_INFINITY);\n        }\n        this.clientActiveArea = new Rect(this.clientArea.x, this.clientArea.y, this.clientArea.width, this.clientArea.height);\n    };\n    /**\n     * @private\n     */\n    PageLayoutViewer.prototype.updateHCFClientAreaWithTop = function (sectionFormat, isHeader, page) {\n        this.updateHFClientArea(sectionFormat, isHeader);\n        if (!isHeader) {\n            if (page.footerWidget.y < this.clientActiveArea.y) {\n                this.clientActiveArea.y = page.footerWidget.y;\n                this.clientActiveArea.height = Number.POSITIVE_INFINITY;\n            }\n        }\n    };\n    /**\n     * Scrolls to the specified page\n     * @private\n     */\n    PageLayoutViewer.prototype.scrollToPage = function (pageIndex) {\n        var top = 0;\n        for (var i = 0; i < this.pages.length; i++) {\n            top = this.pages[i].boundingRectangle.y - (this.pageGap / 2);\n            if (i === pageIndex) {\n                break;\n            }\n        }\n        this.viewerContainer.scrollTop = top;\n        this.updateScrollBars();\n    };\n    /**\n     * Updates scroll bars.\n     * @private\n     */\n    PageLayoutViewer.prototype.updateScrollBars = function () {\n        var height = 0;\n        for (var i = 0; i < this.pages.length; i++) {\n            height = height + this.pages[i].boundingRectangle.height;\n        }\n        var width = 0;\n        for (var i = 0; i < this.pages.length; i++) {\n            if (width < this.pages[i].boundingRectangle.width) {\n                width = this.pages[i].boundingRectangle.width;\n            }\n        }\n        var containerWidth = (width * this.zoomFactor) + (this.pageLeft * 2);\n        var containerHeight = (height * this.zoomFactor) + (this.pages.length + 1) * this.pageGap;\n        var viewerWidth = this.visibleBounds.width;\n        var viewerHeight = this.visibleBounds.height;\n        if (this.visibleBounds.width !== this.viewerContainer.clientWidth) {\n            viewerWidth -= (this.visibleBounds.width - this.viewerContainer.clientWidth);\n        }\n        else if (containerHeight > viewerHeight) {\n            viewerWidth -= this.viewerContainer.offsetWidth - this.viewerContainer.clientWidth;\n        }\n        if (containerWidth > viewerWidth) {\n            viewerHeight -= (this.visibleBounds.height - this.viewerContainer.clientHeight);\n        }\n        width = containerWidth > viewerWidth ? containerWidth : viewerWidth;\n        height = containerHeight > viewerHeight ? containerHeight : viewerHeight;\n        if (parseInt(this.pageContainer.style.width.replace('px', ''), 10) !== width ||\n            parseInt(this.pageContainer.style.height.replace('px', ''), 10) !== width) {\n            this.pageContainer.style.width = width.toString() + 'px';\n            this.pageContainer.style.height = height.toString() + 'px';\n        }\n        // if (!isNullOrUndefined(this.selection) && !this.selection.isEmpty) {\n        //     this.selectionContext.clearRect(0, 0, this.selectionCanvas.width, this.selectionCanvas.height);\n        // }\n        var displayPixelRatio = Math.max(1, window.devicePixelRatio || 1);\n        if (this.containerCanvas.width !== Math.floor(viewerWidth * displayPixelRatio)\n            || this.containerCanvas.height !== Math.floor(viewerHeight * displayPixelRatio)) {\n            this.containerCanvas.width = viewerWidth * displayPixelRatio;\n            this.containerCanvas.height = viewerHeight * displayPixelRatio;\n            this.containerCanvas.style.width = viewerWidth + 'px';\n            this.containerCanvas.style.height = viewerHeight + 'px';\n            this.containerContext.scale(displayPixelRatio, displayPixelRatio);\n            this.selectionCanvas.width = viewerWidth * displayPixelRatio;\n            this.selectionCanvas.height = viewerHeight * displayPixelRatio;\n            this.selectionCanvas.style.width = viewerWidth + 'px';\n            this.selectionCanvas.style.height = viewerHeight + 'px';\n            this.selectionContext.scale(displayPixelRatio, displayPixelRatio);\n        }\n        this.containerContext.globalAlpha = 1;\n        this.selectionContext.globalAlpha = 0.4;\n        for (var i = 0; i < this.pages.length; i++) {\n            var left = (width - this.pages[i].boundingRectangle.width * this.zoomFactor) / 2;\n            if (left > this.pageLeft) {\n                // tslint:disable-next-line:max-line-length\n                this.pages[i].boundingRectangle = new Rect(left, this.pages[i].boundingRectangle.y, this.pages[i].boundingRectangle.width, this.pages[i].boundingRectangle.height);\n            }\n            else {\n                // tslint:disable-next-line:max-line-length\n                this.pages[i].boundingRectangle = new Rect(this.pageLeft, this.pages[i].boundingRectangle.y, this.pages[i].boundingRectangle.width, this.pages[i].boundingRectangle.height);\n            }\n        }\n        this.updateScrollBarPosition(containerWidth, containerHeight, viewerWidth, viewerHeight, width, height);\n    };\n    // tslint:disable-next-line:max-line-length\n    PageLayoutViewer.prototype.updateScrollBarPosition = function (containerWidth, containerHeight, viewerWidth, viewerHeight, width, height) {\n        var left = 0;\n        var viewerHeight1 = parseFloat(this.viewerContainer.style.height);\n        var containerHeight1 = parseFloat(this.pageContainer.style.height);\n        this.containerTop = this.viewerContainer.scrollTop;\n        this.containerCanvas.style.position = 'absolute';\n        this.containerCanvas.style.top = this.containerTop.toString() + 'px';\n        this.selectionCanvas.style.position = 'absolute';\n        this.selectionCanvas.style.top = this.containerTop.toString() + 'px';\n        this.containerLeft = this.viewerContainer.scrollLeft;\n        this.containerCanvas.style.left = this.containerLeft + 'px';\n        this.selectionCanvas.style.left = this.containerLeft + 'px';\n        this.updateVisiblePages();\n    };\n    /**\n     * Updates visible pages.\n     * @private\n     */\n    PageLayoutViewer.prototype.updateVisiblePages = function () {\n        var left = 0;\n        var width = 0;\n        // Clears the container first.\n        this.visiblePages = [];\n        var height = this.visibleBounds.height;\n        var vertical = this.viewerContainer.scrollTop;\n        for (var i = 0; i < this.pages.length; i++) {\n            var page = this.pages[i];\n            var y = (page.boundingRectangle.y - this.pageGap * (i + 1)) * this.zoomFactor + this.pageGap * (i + 1);\n            var pageH = page.boundingRectangle.height * this.zoomFactor;\n            var left_1 = page.boundingRectangle.x;\n            var isTopFit = y >= vertical && y <= vertical + height;\n            var isBottomFit = y + pageH >= vertical && y + pageH <= vertical + height;\n            var isMiddleFit = y <= vertical && y + pageH >= vertical + height;\n            //UI Virtualization\n            if (isTopFit || isBottomFit || isMiddleFit) {\n                this.addVisiblePage(page, left_1, y);\n            }\n        }\n    };\n    /**\n     * Adds visible pages.\n     */\n    PageLayoutViewer.prototype.addVisiblePage = function (page, x, y) {\n        var width = page.boundingRectangle.width * this.zoomFactor;\n        var height = page.boundingRectangle.height * this.zoomFactor;\n        // tslint:disable-next-line:max-line-length\n        if (this.owner.enableImageResizerMode && this.owner.imageResizerModule.currentPage !== undefined && this.owner.imageResizerModule.currentPage === page && this.owner.imageResizerModule.isImageResizerVisible) {\n            this.owner.imageResizerModule.setImageResizerPositions(x, y, width, height);\n        }\n        this.visiblePages.push(page);\n        this.renderPage(page, x, y, width, height);\n    };\n    /**\n     * Render specified page widgets.\n     */\n    PageLayoutViewer.prototype.renderPage = function (page, x, y, width, height) {\n        this.render.renderWidgets(page, x - this.containerLeft, y - this.containerTop, width, height);\n    };\n    /**\n     * Renders visible pages.\n     * @private\n     */\n    PageLayoutViewer.prototype.renderVisiblePages = function () {\n        if (isNullOrUndefined(this.visiblePages) || this.visiblePages.length < 1) {\n            return;\n        }\n        this.clearContent();\n        for (var i = 0; i < this.visiblePages.length; i++) {\n            var page = this.visiblePages[i];\n            var width = page.boundingRectangle.width * this.zoomFactor;\n            var height = page.boundingRectangle.height * this.zoomFactor;\n            var x = page.boundingRectangle.x;\n            var y = (page.boundingRectangle.y - this.pageGap * (i + 1)) * this.zoomFactor + this.pageGap * (i + 1);\n            this.renderPage(page, x, y, width, height);\n        }\n    };\n    return PageLayoutViewer;\n}(LayoutViewer));\nexport { PageLayoutViewer };\n","import { isNullOrUndefined } from '@syncfusion/ej2-base';\nimport { WList } from '../list/list';\nimport { WListLevel } from '../list/list-level';\nimport { WAbstractList } from '../list/abstract-list';\nimport { WLevelOverride } from '../list/level-override';\nimport { WCharacterFormat, WListFormat, WParagraphFormat, WCellFormat, WTableFormat, WSectionFormat, WRowFormat } from '../format/index';\nimport { WCharacterStyle, WParagraphStyle, WTabStop } from '../format/index';\nimport { LineWidget, ParagraphWidget, ImageElementBox, BodyWidget, TextElementBox, TableCellWidget, TableRowWidget, TableWidget, FieldElementBox, HeaderFooterWidget, BookmarkElementBox, FieldTextElementBox, TabElementBox } from './page';\nimport { HelperMethods } from '../editor/editor-helper';\n/**\n * @private\n */\nvar SfdtReader = /** @class */ (function () {\n    function SfdtReader(viewer) {\n        /* tslint:disable:no-any */\n        this.viewer = undefined;\n        this.viewer = viewer;\n    }\n    Object.defineProperty(SfdtReader.prototype, \"isPasting\", {\n        get: function () {\n            return this.viewer && this.viewer.owner.isPastingContent;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    /**\n     * @private\n     * @param json\n     */\n    SfdtReader.prototype.convertJsonToDocument = function (json) {\n        var sections = [];\n        var jsonObject = JSON.parse(json);\n        this.parseCharacterFormat(jsonObject.characterFormat, this.viewer.characterFormat);\n        this.parseParagraphFormat(jsonObject.paragraphFormat, this.viewer.paragraphFormat);\n        if (!isNullOrUndefined(jsonObject.background)) {\n            this.viewer.backgroundColor = this.getColor(jsonObject.background.color);\n        }\n        if (!isNullOrUndefined(jsonObject.abstractLists)) {\n            this.parseAbstractList(jsonObject, this.viewer.abstractLists);\n        }\n        if (!isNullOrUndefined(jsonObject.lists)) {\n            this.parseList(jsonObject, this.viewer.lists);\n        }\n        if (!isNullOrUndefined(jsonObject.styles)) {\n            this.parseStyles(jsonObject, this.viewer.styles);\n        }\n        if (!isNullOrUndefined(jsonObject.sections)) {\n            this.parseSections(jsonObject.sections, sections);\n        }\n        return sections;\n    };\n    SfdtReader.prototype.parseStyles = function (data, styles) {\n        for (var i = 0; i < data.styles.length; i++) {\n            if (isNullOrUndefined(this.viewer.styles.findByName(data.styles[i].name))) {\n                this.parseStyle(data, data.styles[i], styles);\n            }\n        }\n    };\n    SfdtReader.prototype.parseStyle = function (data, style, styles) {\n        var wStyle;\n        if (!isNullOrUndefined(style.type)) {\n            if (style.type === 'Paragraph') {\n                wStyle = new WParagraphStyle();\n                wStyle.type = 'Paragraph';\n            }\n            if (style.type === 'Character') {\n                wStyle = new WCharacterStyle();\n                wStyle.type = 'Character';\n            }\n            if (!isNullOrUndefined(style.name)) {\n                wStyle.name = style.name;\n            }\n            styles.push(wStyle);\n            if (!isNullOrUndefined(style.basedOn)) {\n                var basedOn = styles.findByName(style.basedOn);\n                if (!isNullOrUndefined(basedOn)) {\n                    if (basedOn.type === wStyle.type) {\n                        wStyle.basedOn = basedOn;\n                    }\n                }\n                else {\n                    var basedStyle = this.getStyle(style.basedOn, data);\n                    var styleString = void 0;\n                    if (!isNullOrUndefined(basedStyle) && basedStyle.type === wStyle.type) {\n                        styleString = basedStyle;\n                    }\n                    else {\n                        if (wStyle.type === 'Paragraph') {\n                            styleString = JSON.parse('{\"type\":\"Paragraph\",\"name\":\"Normal\",\"next\":\"Normal\"}');\n                        }\n                        else {\n                            styleString = JSON.parse('{\"type\": \"Character\",\"name\": \"Default Paragraph Font\"}');\n                        }\n                    }\n                    this.parseStyle(data, styleString, styles);\n                    wStyle.basedOn = styles.findByName(styleString.name);\n                }\n            }\n            if (!isNullOrUndefined(style.link)) {\n                var link = styles.findByName(style.link);\n                var linkStyle = this.getStyle(style.link, data);\n                var styleString = void 0;\n                if (isNullOrUndefined(link)) {\n                    if (isNullOrUndefined(linkStyle)) {\n                        //Construct the CharacterStyle string\n                        var charaStyle = {};\n                        charaStyle.characterFormat = style.characterFormat;\n                        charaStyle.name = style.name + ' Char';\n                        charaStyle.type = 'Character';\n                        //TODO: Implement basedOn\n                        charaStyle.basedOn = style.basedOn === 'Normal' ? 'Default Paragraph Font' : (style.basedOn + ' Char');\n                        styleString = charaStyle;\n                    }\n                    else {\n                        styleString = linkStyle;\n                    }\n                    this.parseStyle(data, styleString, styles);\n                    wStyle.link = isNullOrUndefined(styles.findByName(styleString.name)) ? style.link : styles.findByName(styleString.name);\n                }\n                else {\n                    wStyle.link = link;\n                }\n            }\n            if (!isNullOrUndefined(style.characterFormat)) {\n                this.parseCharacterFormat(style.characterFormat, wStyle.characterFormat);\n            }\n            if (!isNullOrUndefined(style.paragraphFormat)) {\n                this.parseParagraphFormat(style.paragraphFormat, wStyle.paragraphFormat);\n            }\n            if (!isNullOrUndefined(style.next)) {\n                if (style.next === style.name) {\n                    wStyle.next = wStyle;\n                }\n                else {\n                    var next = styles.findByName(style.next);\n                    if (!isNullOrUndefined(next) && next.type === wStyle.type) {\n                        wStyle.next = next;\n                    }\n                    else {\n                        var nextStyleString = this.getStyle(style.next, data);\n                        if (!isNullOrUndefined(nextStyleString)) {\n                            this.parseStyle(data, nextStyleString, styles);\n                            wStyle.next = styles.findByName(nextStyleString.name);\n                        }\n                        else {\n                            wStyle.next = wStyle;\n                        }\n                    }\n                }\n            }\n        }\n    };\n    SfdtReader.prototype.getStyle = function (name, data) {\n        for (var i = 0; i < data.styles.length; i++) {\n            if (data.styles[i].name === name) {\n                return data.styles[i];\n            }\n        }\n        return undefined;\n    };\n    SfdtReader.prototype.parseAbstractList = function (data, abstractLists) {\n        for (var i = 0; i < data.abstractLists.length; i++) {\n            var abstractList = new WAbstractList();\n            var abstract = data.abstractLists[i];\n            abstractLists.push(abstractList);\n            if (!isNullOrUndefined(abstract)) {\n                if (!isNullOrUndefined(abstract.abstractListId)) {\n                    abstractList.abstractListId = abstract.abstractListId;\n                }\n                if (!isNullOrUndefined(abstract.levels)) {\n                    for (var j = 0; j < abstract.levels.length; j++) {\n                        var level = abstract.levels[j];\n                        if (!isNullOrUndefined(level)) {\n                            var listLevel = this.parseListLevel(level, abstractList);\n                            abstractList.levels.push(listLevel);\n                        }\n                    }\n                }\n            }\n        }\n    };\n    SfdtReader.prototype.parseListLevel = function (data, owner) {\n        var listLevel = new WListLevel(owner);\n        if (data.listLevelPattern === 'Bullet') {\n            listLevel.listLevelPattern = 'Bullet';\n            listLevel.numberFormat = !isNullOrUndefined(data.numberFormat) ? data.numberFormat : '';\n        }\n        else {\n            listLevel.listLevelPattern = data.listLevelPattern;\n            listLevel.startAt = data.startAt;\n            listLevel.numberFormat = !isNullOrUndefined(data.numberFormat) ? data.numberFormat : '';\n            if (data.restartLevel >= 0) {\n                listLevel.restartLevel = data.restartLevel;\n            }\n            else {\n                listLevel.restartLevel = data.levelNumber;\n            }\n        }\n        listLevel.followCharacter = data.followCharacter;\n        this.parseCharacterFormat(data.characterFormat, listLevel.characterFormat);\n        this.parseParagraphFormat(data.paragraphFormat, listLevel.paragraphFormat);\n        return listLevel;\n    };\n    SfdtReader.prototype.parseList = function (data, listCollection) {\n        for (var i = 0; i < data.lists.length; i++) {\n            var list = new WList();\n            var lists = data.lists[i];\n            if (!isNullOrUndefined(lists.abstractListId)) {\n                list.abstractListId = lists.abstractListId;\n                list.abstractList = this.viewer.getAbstractListById(lists.abstractListId);\n            }\n            listCollection.push(list);\n            if (!isNullOrUndefined(lists.listId)) {\n                list.listId = lists.listId;\n            }\n            if (lists.hasOwnProperty('levelOverrides')) {\n                this.parseLevelOverride(lists.levelOverrides, list);\n            }\n        }\n    };\n    SfdtReader.prototype.parseLevelOverride = function (data, list) {\n        if (isNullOrUndefined(data)) {\n            return;\n        }\n        for (var i = 0; i < data.length; i++) {\n            var levelOverrides = new WLevelOverride();\n            var levelOverride = data[i];\n            levelOverrides.startAt = levelOverride.startAt;\n            levelOverrides.levelNumber = levelOverride.levelNumber;\n            if (!isNullOrUndefined(levelOverride.overrideListLevel)) {\n                levelOverrides.overrideListLevel = this.parseListLevel(levelOverride.overrideListLevel, levelOverrides);\n            }\n            list.levelOverrides.push(levelOverrides);\n        }\n    };\n    SfdtReader.prototype.parseSections = function (data, sections) {\n        for (var i = 0; i < data.length; i++) {\n            var section = new BodyWidget();\n            section.sectionFormat = new WSectionFormat(section);\n            section.index = i;\n            var item = data[i];\n            if (!isNullOrUndefined(item.sectionFormat)) {\n                this.parseSectionFormat(item.sectionFormat, section.sectionFormat);\n            }\n            if (isNullOrUndefined(item.headersFooters)) {\n                item.headersFooters = {};\n            }\n            this.viewer.headersFooters.push(this.parseHeaderFooter(item.headersFooters, this.viewer.headersFooters));\n            this.parseTextBody(item.blocks, section);\n            for (var i_1 = 0; i_1 < section.childWidgets.length; i_1++) {\n                section.childWidgets[i_1].containerWidget = section;\n            }\n            sections.push(section);\n        }\n    };\n    /**\n     * @private\n     */\n    SfdtReader.prototype.parseHeaderFooter = function (data, headersFooters) {\n        var hfs = {};\n        if (!isNullOrUndefined(data.header)) {\n            var oddHeader = new HeaderFooterWidget('OddHeader');\n            hfs[0] = oddHeader;\n            this.parseTextBody(data.header.blocks, oddHeader);\n        }\n        if (!isNullOrUndefined(data.footer)) {\n            var oddFooter = new HeaderFooterWidget('OddFooter');\n            hfs[1] = oddFooter;\n            this.parseTextBody(data.footer.blocks, oddFooter);\n        }\n        if (!isNullOrUndefined(data.evenHeader)) {\n            var evenHeader = new HeaderFooterWidget('EvenHeader');\n            hfs[2] = evenHeader;\n            this.parseTextBody(data.evenHeader.blocks, evenHeader);\n        }\n        if (!isNullOrUndefined(data.evenFooter)) {\n            var evenFooter = new HeaderFooterWidget('EvenFooter');\n            hfs[3] = evenFooter;\n            this.parseTextBody(data.evenFooter.blocks, evenFooter);\n        }\n        if (!isNullOrUndefined(data.firstPageHeader)) {\n            var firstPageHeader = new HeaderFooterWidget('FirstPageHeader');\n            hfs[4] = firstPageHeader;\n            this.parseTextBody(data.firstPageHeader.blocks, firstPageHeader);\n        }\n        if (!isNullOrUndefined(data.firstPageFooter)) {\n            var firstPageFooter = new HeaderFooterWidget('FirstPageFooter');\n            hfs[5] = firstPageFooter;\n            this.parseTextBody(data.firstPageFooter.blocks, firstPageFooter);\n        }\n        return hfs;\n    };\n    SfdtReader.prototype.parseTextBody = function (data, section) {\n        this.parseBody(data, section.childWidgets, section);\n    };\n    SfdtReader.prototype.parseBody = function (data, blocks, container) {\n        if (!isNullOrUndefined(data)) {\n            for (var i = 0; i < data.length; i++) {\n                var block = data[i];\n                if (block.hasOwnProperty('inlines')) {\n                    var writeInlineFormat = false;\n                    //writeInlineFormat = this.isPasting && i === data.length - 1;\n                    var paragraph = new ParagraphWidget();\n                    paragraph.characterFormat = new WCharacterFormat(paragraph);\n                    paragraph.paragraphFormat = new WParagraphFormat(paragraph);\n                    this.parseCharacterFormat(block.characterFormat, paragraph.characterFormat);\n                    this.parseParagraphFormat(block.paragraphFormat, paragraph.paragraphFormat);\n                    var styleObj = void 0;\n                    if (!isNullOrUndefined(block.paragraphFormat) && !isNullOrUndefined(block.paragraphFormat.styleName)) {\n                        styleObj = this.viewer.styles.findByName(block.paragraphFormat.styleName, 'Paragraph');\n                        if (!isNullOrUndefined(styleObj)) {\n                            paragraph.paragraphFormat.ApplyStyle(styleObj);\n                        }\n                    }\n                    if (block.inlines.length > 0) {\n                        this.parseParagraph(block.inlines, paragraph, writeInlineFormat);\n                    }\n                    blocks.push(paragraph);\n                    paragraph.index = i;\n                    paragraph.containerWidget = container;\n                }\n                else if (block.hasOwnProperty('rows')) {\n                    this.parseTable(block, blocks, i, container);\n                }\n            }\n        }\n    };\n    SfdtReader.prototype.parseTable = function (block, blocks, index, section) {\n        var table = new TableWidget();\n        table.index = index;\n        table.tableFormat = new WTableFormat(table);\n        if (!isNullOrUndefined(block.tableFormat)) {\n            this.parseTableFormat(block.tableFormat, table.tableFormat);\n        }\n        table.title = block.title;\n        table.description = block.description;\n        for (var i = 0; i < block.rows.length; i++) {\n            var row = new TableRowWidget();\n            row.rowFormat = new WRowFormat(row);\n            var tableRow = block.rows[i];\n            if (tableRow.hasOwnProperty('rowFormat')) {\n                this.parseRowFormat(tableRow.rowFormat, row.rowFormat);\n                this.parseRowGridValues(tableRow, row.rowFormat);\n                this.parseRowGridValues(tableRow.rowFormat, row.rowFormat);\n                row.index = i;\n                for (var j = 0; j < block.rows[i].cells.length; j++) {\n                    var cell = new TableCellWidget();\n                    cell.cellFormat = new WCellFormat(cell);\n                    row.childWidgets.push(cell);\n                    cell.containerWidget = row;\n                    cell.index = j;\n                    cell.rowIndex = i;\n                    if (block.rows[i].cells[j].hasOwnProperty('cellFormat')) {\n                        this.parseCellFormat(block.rows[i].cells[j].cellFormat, cell.cellFormat);\n                    }\n                    this.parseTextBody(block.rows[i].cells[j].blocks, cell);\n                }\n            }\n            table.childWidgets.push(row);\n            row.containerWidget = table;\n        }\n        table.containerWidget = section;\n        blocks.push(table);\n        table.isGridUpdated = false;\n    };\n    SfdtReader.prototype.parseRowGridValues = function (data, rowFormat) {\n        if (!isNullOrUndefined(data.gridBefore)) {\n            rowFormat.gridBefore = data.gridBefore;\n        }\n        if (!isNullOrUndefined(data.gridBeforeWidth)) {\n            rowFormat.gridBeforeWidth = data.gridBeforeWidth;\n        }\n        if (!isNullOrUndefined(data.gridBeforeWidthType)) {\n            rowFormat.gridBeforeWidthType = data.gridBeforeWidthType;\n        }\n        if (!isNullOrUndefined(data.gridAfter)) {\n            rowFormat.gridAfter = data.gridAfter;\n        }\n        if (!isNullOrUndefined(data.gridAfterWidth)) {\n            rowFormat.gridAfterWidth = data.gridAfterWidth;\n        }\n        if (!isNullOrUndefined(data.gridAfterWidthType)) {\n            rowFormat.gridAfterWidthType = data.gridAfterWidthType;\n        }\n    };\n    SfdtReader.prototype.parseParagraph = function (data, paragraph, writeInlineFormat) {\n        var lineWidget = new LineWidget(paragraph);\n        for (var i = 0; i < data.length; i++) {\n            var inline = data[i];\n            if (inline.hasOwnProperty('text')) {\n                var textElement = undefined;\n                if (this.viewer.isPageField) {\n                    textElement = new FieldTextElementBox();\n                    textElement.fieldBegin = this.viewer.fieldStacks[this.viewer.fieldStacks.length - 1];\n                }\n                else if (inline.text === '\\t') {\n                    textElement = new TabElementBox();\n                }\n                else {\n                    textElement = new TextElementBox();\n                }\n                textElement.characterFormat = new WCharacterFormat(textElement);\n                this.parseCharacterFormat(inline.characterFormat, textElement.characterFormat, writeInlineFormat);\n                /*ï¿½tslint:disable-next-line:max-line-length */\n                if (!isNullOrUndefined(inline.characterFormat) && !isNullOrUndefined(inline.characterFormat.styleName)) {\n                    var charStyle = this.viewer.styles.findByName(inline.characterFormat.styleName, 'Character');\n                    textElement.characterFormat.ApplyStyle(charStyle);\n                }\n                textElement.text = inline.text;\n                textElement.line = lineWidget;\n                lineWidget.children.push(textElement);\n            }\n            else if (inline.hasOwnProperty('imageString')) {\n                var image = new ImageElementBox(data[i].isInlineImage);\n                image.isMetaFile = data[i].isMetaFile;\n                image.characterFormat = new WCharacterFormat(image);\n                image.line = lineWidget;\n                lineWidget.children.push(image);\n                image.imageString = inline.imageString;\n                image.width = HelperMethods.convertPointToPixel(inline.width);\n                image.height = HelperMethods.convertPointToPixel(inline.height);\n                this.parseCharacterFormat(inline.characterFormat, image.characterFormat);\n            }\n            else if (inline.hasOwnProperty('hasFieldEnd') || (inline.hasOwnProperty('fieldType') && inline.fieldType === 0)) {\n                var fieldBegin = new FieldElementBox(0);\n                fieldBegin.hasFieldEnd = inline.hasFieldEnd;\n                this.viewer.fieldStacks.push(fieldBegin);\n                fieldBegin.line = lineWidget;\n                this.viewer.fields.push(fieldBegin);\n                lineWidget.children.push(fieldBegin);\n            }\n            else if (inline.hasOwnProperty('fieldType')) {\n                var field = undefined;\n                if (inline.fieldType === 2) {\n                    field = new FieldElementBox(2);\n                    this.fieldSeparator = field;\n                    if (this.viewer.fieldStacks.length > 0) {\n                        field.fieldBegin = this.viewer.fieldStacks[this.viewer.fieldStacks.length - 1];\n                        field.fieldBegin.fieldSeparator = field;\n                        //finds the whether the field is page filed or not\n                        var lineWidgetCount = lineWidget.children.length;\n                        if (lineWidgetCount >= 2 && (lineWidget.children[lineWidgetCount - 2] instanceof FieldElementBox)\n                            && lineWidget.children[lineWidgetCount - 2].hasFieldEnd\n                            && (lineWidget.children[lineWidgetCount - 1] instanceof TextElementBox)) {\n                            var fieldElementText = lineWidget.children[lineWidgetCount - 1].text;\n                            if (fieldElementText.match('PAGE')) {\n                                this.viewer.isPageField = true;\n                            }\n                        }\n                    }\n                }\n                else if (inline.fieldType === 1) {\n                    field = new FieldElementBox(1);\n                    //For Field End Updated begin and separator.                                      \n                    if (this.viewer.fieldStacks.length > 0) {\n                        field.fieldBegin = this.viewer.fieldStacks[this.viewer.fieldStacks.length - 1];\n                        field.fieldBegin.fieldEnd = field;\n                    }\n                    if (!isNullOrUndefined(field.fieldBegin) && field.fieldBegin.fieldSeparator) {\n                        field.fieldSeparator = field.fieldBegin.fieldSeparator;\n                        field.fieldBegin.fieldSeparator.fieldEnd = field;\n                    }\n                    //After setting all the property clear the field values\n                    this.viewer.fieldStacks.splice(this.viewer.fieldStacks.length - 1, 1);\n                    this.fieldSeparator = undefined;\n                    this.viewer.isPageField = false;\n                    this.viewer.fieldCollection.push(field.fieldBegin);\n                }\n                field.line = lineWidget;\n                lineWidget.children.push(field);\n            }\n            else if (inline.hasOwnProperty('bookmarkType')) {\n                var bookmark = undefined;\n                bookmark = new BookmarkElementBox(inline.bookmarkType);\n                bookmark.name = inline.name;\n                lineWidget.children.push(bookmark);\n                bookmark.line = lineWidget;\n                if (inline.bookmarkType === 0) {\n                    this.viewer.bookmarks.add(bookmark.name, bookmark);\n                }\n                else if (inline.bookmarkType === 1) {\n                    if (this.viewer.bookmarks.containsKey(bookmark.name)) {\n                        var bookmarkStart = this.viewer.bookmarks.get(bookmark.name);\n                        bookmarkStart.reference = bookmark;\n                        bookmark.reference = bookmarkStart;\n                    }\n                }\n            }\n        }\n        paragraph.childWidgets.push(lineWidget);\n    };\n    SfdtReader.prototype.parseTableFormat = function (sourceFormat, tableFormat) {\n        this.parseBorders(sourceFormat.borders, tableFormat.borders);\n        if (!isNullOrUndefined(sourceFormat.cellSpacing)) {\n            tableFormat.cellSpacing = sourceFormat.cellSpacing;\n        }\n        if (!isNullOrUndefined(sourceFormat.leftMargin)) {\n            tableFormat.leftMargin = sourceFormat.leftMargin;\n        }\n        if (!isNullOrUndefined(sourceFormat.topMargin)) {\n            tableFormat.topMargin = sourceFormat.topMargin;\n        }\n        if (!isNullOrUndefined(sourceFormat.rightMargin)) {\n            tableFormat.rightMargin = sourceFormat.rightMargin;\n        }\n        if (!isNullOrUndefined(sourceFormat.bottomMargin)) {\n            tableFormat.bottomMargin = sourceFormat.bottomMargin;\n        }\n        if (!isNullOrUndefined(sourceFormat.leftIndent)) {\n            tableFormat.leftIndent = sourceFormat.leftIndent;\n        }\n        this.parseShading(sourceFormat.shading, tableFormat.shading);\n        if (!isNullOrUndefined(sourceFormat.tableAlignment)) {\n            tableFormat.tableAlignment = sourceFormat.tableAlignment;\n        }\n        if (!isNullOrUndefined(sourceFormat.preferredWidth)) {\n            tableFormat.preferredWidth = sourceFormat.preferredWidth;\n        }\n        if (!isNullOrUndefined(sourceFormat.preferredWidthType)) {\n            tableFormat.preferredWidthType = sourceFormat.preferredWidthType;\n        }\n    };\n    SfdtReader.prototype.parseCellFormat = function (sourceFormat, cellFormat) {\n        if (!isNullOrUndefined(sourceFormat)) {\n            this.parseBorders(sourceFormat.borders, cellFormat.borders);\n            if (!sourceFormat.isSamePaddingAsTable) {\n                //    cellFormat.ClearMargins();\n                //else\n                this.parseCellMargin(sourceFormat, cellFormat);\n            }\n            if (!isNullOrUndefined(sourceFormat.cellWidth)) {\n                cellFormat.cellWidth = sourceFormat.cellWidth;\n            }\n            if (!isNullOrUndefined(sourceFormat.columnSpan)) {\n                cellFormat.columnSpan = sourceFormat.columnSpan;\n            }\n            if (!isNullOrUndefined(sourceFormat.rowSpan)) {\n                cellFormat.rowSpan = sourceFormat.rowSpan;\n            }\n            this.parseShading(sourceFormat.shading, cellFormat.shading);\n            if (!isNullOrUndefined(sourceFormat.verticalAlignment)) {\n                cellFormat.verticalAlignment = sourceFormat.verticalAlignment;\n            }\n            if (!isNullOrUndefined(sourceFormat.preferredWidthType)) {\n                cellFormat.preferredWidthType = sourceFormat.preferredWidthType;\n            }\n            if (!isNullOrUndefined(sourceFormat.preferredWidth)) {\n                cellFormat.preferredWidth = sourceFormat.preferredWidth;\n            }\n        }\n    };\n    SfdtReader.prototype.parseCellMargin = function (sourceFormat, cellFormat) {\n        if (!isNullOrUndefined(sourceFormat.leftMargin)) {\n            cellFormat.leftMargin = sourceFormat.leftMargin;\n        }\n        if (!isNullOrUndefined(sourceFormat.rightMargin)) {\n            cellFormat.rightMargin = sourceFormat.rightMargin;\n        }\n        if (!isNullOrUndefined(sourceFormat.topMargin)) {\n            cellFormat.topMargin = sourceFormat.topMargin;\n        }\n        if (!isNullOrUndefined(sourceFormat.bottomMargin)) {\n            cellFormat.bottomMargin = sourceFormat.bottomMargin;\n        }\n    };\n    SfdtReader.prototype.parseRowFormat = function (sourceFormat, rowFormat) {\n        if (!isNullOrUndefined(sourceFormat)) {\n            if (!isNullOrUndefined(sourceFormat.allowBreakAcrossPages)) {\n                rowFormat.allowBreakAcrossPages = sourceFormat.allowBreakAcrossPages;\n            }\n            if (!isNullOrUndefined(sourceFormat.isHeader)) {\n                rowFormat.isHeader = sourceFormat.isHeader;\n            }\n            if (!isNullOrUndefined(sourceFormat.heightType)) {\n                rowFormat.heightType = sourceFormat.heightType;\n            }\n            if (!isNullOrUndefined(sourceFormat.height)) {\n                rowFormat.height = sourceFormat.height;\n            }\n            this.parseBorders(sourceFormat.borders, rowFormat.borders);\n        }\n    };\n    SfdtReader.prototype.parseBorders = function (sourceBorders, destBorder) {\n        if (!isNullOrUndefined(sourceBorders)) {\n            this.parseBorder(sourceBorders.left, destBorder.left);\n            this.parseBorder(sourceBorders.right, destBorder.right);\n            this.parseBorder(sourceBorders.top, destBorder.top);\n            this.parseBorder(sourceBorders.bottom, destBorder.bottom);\n            this.parseBorder(sourceBorders.vertical, destBorder.vertical);\n            this.parseBorder(sourceBorders.horizontal, destBorder.horizontal);\n            this.parseBorder(sourceBorders.diagonalDown, destBorder.diagonalDown);\n            this.parseBorder(sourceBorders.diagonalUp, destBorder.diagonalUp);\n        }\n    };\n    SfdtReader.prototype.parseBorder = function (sourceBorder, destBorder) {\n        if (!isNullOrUndefined(sourceBorder)) {\n            if (!isNullOrUndefined(sourceBorder.color)) {\n                destBorder.color = this.getColor(sourceBorder.color);\n            }\n            if (!isNullOrUndefined(sourceBorder.lineStyle)) {\n                destBorder.lineStyle = sourceBorder.lineStyle;\n            }\n            if (!isNullOrUndefined(sourceBorder.lineWidth)) {\n                destBorder.lineWidth = sourceBorder.lineWidth;\n            }\n            if (!isNullOrUndefined(sourceBorder.hasNoneStyle)) {\n                destBorder.hasNoneStyle = sourceBorder.hasNoneStyle;\n            }\n        }\n    };\n    SfdtReader.prototype.parseShading = function (sourceShading, destShading) {\n        if (!isNullOrUndefined(sourceShading)) {\n            if (!isNullOrUndefined(sourceShading.backgroundColor)) {\n                destShading.backgroundColor = this.getColor(sourceShading.backgroundColor);\n            }\n            if (!isNullOrUndefined(sourceShading.foregroundColor)) {\n                destShading.foregroundColor = this.getColor(sourceShading.foregroundColor);\n            }\n            if (!isNullOrUndefined(sourceShading.texture)) {\n                destShading.textureStyle = sourceShading.texture;\n            }\n        }\n    };\n    SfdtReader.prototype.parseCharacterFormat = function (sourceFormat, characterFormat, writeInlineFormat) {\n        if (!isNullOrUndefined(sourceFormat)) {\n            if (writeInlineFormat && sourceFormat.hasOwnProperty('inlineFormat')) {\n                this.parseCharacterFormat(sourceFormat.inlineFormat, characterFormat);\n                return;\n            }\n            if (!isNullOrUndefined(sourceFormat.baselineAlignment)) {\n                characterFormat.baselineAlignment = sourceFormat.baselineAlignment;\n            }\n            if (!isNullOrUndefined(sourceFormat.underline)) {\n                characterFormat.underline = sourceFormat.underline;\n            }\n            if (!isNullOrUndefined(sourceFormat.strikethrough)) {\n                characterFormat.strikethrough = sourceFormat.strikethrough;\n            }\n            if (!isNullOrUndefined(sourceFormat.fontSize)) {\n                characterFormat.fontSize = sourceFormat.fontSize;\n            }\n            if (!isNullOrUndefined(sourceFormat.fontFamily)) {\n                characterFormat.fontFamily = sourceFormat.fontFamily;\n            }\n            if (!isNullOrUndefined(sourceFormat.bold)) {\n                characterFormat.bold = sourceFormat.bold;\n            }\n            if (!isNullOrUndefined(sourceFormat.italic)) {\n                characterFormat.italic = sourceFormat.italic;\n            }\n            if (!isNullOrUndefined(sourceFormat.highlightColor)) {\n                characterFormat.highlightColor = sourceFormat.highlightColor;\n            }\n            if (!isNullOrUndefined(sourceFormat.fontColor)) {\n                characterFormat.fontColor = this.getColor(sourceFormat.fontColor);\n            }\n        }\n    };\n    SfdtReader.prototype.getColor = function (color) {\n        var convertColor = color;\n        return convertColor || '#ffffff';\n    };\n    SfdtReader.prototype.parseParagraphFormat = function (sourceFormat, paragraphFormat) {\n        if (!isNullOrUndefined(sourceFormat)) {\n            if (!isNullOrUndefined(sourceFormat.leftIndent)) {\n                paragraphFormat.leftIndent = sourceFormat.leftIndent;\n            }\n            if (!isNullOrUndefined(sourceFormat.rightIndent)) {\n                paragraphFormat.rightIndent = sourceFormat.rightIndent;\n            }\n            if (!isNullOrUndefined(sourceFormat.firstLineIndent)) {\n                paragraphFormat.firstLineIndent = sourceFormat.firstLineIndent;\n            }\n            if (!isNullOrUndefined(sourceFormat.afterSpacing)) {\n                paragraphFormat.afterSpacing = sourceFormat.afterSpacing;\n            }\n            if (!isNullOrUndefined(sourceFormat.beforeSpacing)) {\n                paragraphFormat.beforeSpacing = sourceFormat.beforeSpacing;\n            }\n            if (!isNullOrUndefined(sourceFormat.lineSpacing)) {\n                paragraphFormat.lineSpacing = sourceFormat.lineSpacing;\n            }\n            if (!isNullOrUndefined(sourceFormat.lineSpacingType)) {\n                paragraphFormat.lineSpacingType = sourceFormat.lineSpacingType;\n            }\n            if (!isNullOrUndefined(sourceFormat.textAlignment)) {\n                paragraphFormat.textAlignment = sourceFormat.textAlignment;\n            }\n            if (!isNullOrUndefined(sourceFormat.outlineLevel)) {\n                paragraphFormat.outlineLevel = sourceFormat.outlineLevel;\n            }\n            paragraphFormat.listFormat = new WListFormat();\n            if (sourceFormat.hasOwnProperty('listFormat')) {\n                this.parseListFormat(sourceFormat, paragraphFormat.listFormat);\n            }\n            if (sourceFormat.hasOwnProperty('tabs')) {\n                this.parseTabStop(sourceFormat.tabs, paragraphFormat.tabs);\n            }\n        }\n    };\n    SfdtReader.prototype.parseListFormat = function (block, listFormat) {\n        if (!isNullOrUndefined(block.listFormat)) {\n            if (!isNullOrUndefined(block.listFormat.listId)) {\n                listFormat.listId = block.listFormat.listId;\n                listFormat.list = this.viewer.getListById(block.listFormat.listId);\n            }\n            if (!isNullOrUndefined(block.listFormat.listLevelNumber)) {\n                listFormat.listLevelNumber = block.listFormat.listLevelNumber;\n            }\n        }\n    };\n    SfdtReader.prototype.parseSectionFormat = function (data, sectionFormat) {\n        if (!isNullOrUndefined(data.pageWidth)) {\n            sectionFormat.pageWidth = data.pageWidth;\n        }\n        if (!isNullOrUndefined(data.pageHeight)) {\n            sectionFormat.pageHeight = data.pageHeight;\n        }\n        if (!isNullOrUndefined(data.leftMargin)) {\n            sectionFormat.leftMargin = data.leftMargin;\n        }\n        if (!isNullOrUndefined(data.topMargin)) {\n            sectionFormat.topMargin = data.topMargin;\n        }\n        if (!isNullOrUndefined(data.rightMargin)) {\n            sectionFormat.rightMargin = data.rightMargin;\n        }\n        if (!isNullOrUndefined(data.bottomMargin)) {\n            sectionFormat.bottomMargin = data.bottomMargin;\n        }\n        if (!isNullOrUndefined(data.headerDistance)) {\n            sectionFormat.headerDistance = data.headerDistance;\n        }\n        if (!isNullOrUndefined(data.footerDistance)) {\n            sectionFormat.footerDistance = data.footerDistance;\n        }\n        if (!isNullOrUndefined(data.differentFirstPage)) {\n            sectionFormat.differentFirstPage = data.differentFirstPage;\n        }\n        if (!isNullOrUndefined(data.differentOddAndEvenPages)) {\n            sectionFormat.differentOddAndEvenPages = data.differentOddAndEvenPages;\n        }\n    };\n    SfdtReader.prototype.parseTabStop = function (wTabs, tabs) {\n        for (var i = 0; i < wTabs.length; i++) {\n            var tabStop = new WTabStop();\n            tabStop.position = wTabs[i].position;\n            tabStop.tabLeader = wTabs[i].tabLeader;\n            tabStop.deletePosition = wTabs[i].deletePosition;\n            tabStop.tabJustification = wTabs[i].tabJustification;\n            tabs.push(tabStop);\n        }\n    };\n    return SfdtReader;\n}());\nexport { SfdtReader };\n","import { WShading } from '../format/index';\nimport { isNullOrUndefined } from '@syncfusion/ej2-base';\nimport { WList } from '../list/list';\nimport { WAbstractList } from '../list/abstract-list';\nimport { WListLevel } from '../list/list-level';\n/**\n * Selection character format implementation\n */\nvar SelectionCharacterFormat = /** @class */ (function () {\n    /**\n     * @private\n     */\n    function SelectionCharacterFormat(selection) {\n        this.boldIn = undefined;\n        this.italicIn = undefined;\n        this.underlineIn = undefined;\n        this.strikeThroughIn = undefined;\n        this.baselineAlignmentIn = undefined;\n        this.highlightColorIn = undefined;\n        this.fontSizeIn = 0;\n        this.fontColorIn = undefined;\n        this.selection = selection;\n    }\n    Object.defineProperty(SelectionCharacterFormat.prototype, \"fontSize\", {\n        /**\n         * Gets or sets the font size of selected contents.\n         */\n        get: function () {\n            return this.fontSizeIn;\n        },\n        set: function (value) {\n            if (value === this.fontSizeIn) {\n                return;\n            }\n            this.fontSizeIn = value;\n            this.notifyPropertyChanged('fontSize');\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(SelectionCharacterFormat.prototype, \"fontFamily\", {\n        /**\n         * Gets or sets the font family of selected contents.\n         */\n        get: function () {\n            return this.fontFamilyIn;\n        },\n        set: function (value) {\n            if (value === this.fontFamilyIn) {\n                return;\n            }\n            this.fontFamilyIn = value;\n            this.notifyPropertyChanged('fontFamily');\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(SelectionCharacterFormat.prototype, \"fontColor\", {\n        /**\n         * Gets or sets the font color of selected contents.\n         */\n        get: function () {\n            return this.fontColorIn;\n        },\n        set: function (value) {\n            if (value === this.fontColorIn) {\n                return;\n            }\n            this.fontColorIn = value;\n            this.notifyPropertyChanged('fontColor');\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(SelectionCharacterFormat.prototype, \"bold\", {\n        /**\n         * Gets or sets the bold formatting of selected contents.\n         */\n        get: function () {\n            return this.boldIn;\n        },\n        set: function (value) {\n            if (value === this.boldIn) {\n                return;\n            }\n            this.boldIn = value;\n            this.notifyPropertyChanged('bold');\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(SelectionCharacterFormat.prototype, \"italic\", {\n        /**\n         * Gets or sets the italic formatting of selected contents.\n         */\n        get: function () {\n            return this.italicIn;\n        },\n        set: function (value) {\n            if (value === this.italic) {\n                return;\n            }\n            this.italicIn = value;\n            this.notifyPropertyChanged('italic');\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(SelectionCharacterFormat.prototype, \"strikethrough\", {\n        /**\n         * Gets or sets the strikethrough property of selected contents.\n         */\n        get: function () {\n            return this.strikeThroughIn;\n        },\n        set: function (value) {\n            if (value === this.strikeThroughIn) {\n                return;\n            }\n            this.strikeThroughIn = value;\n            this.notifyPropertyChanged('strikethrough');\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(SelectionCharacterFormat.prototype, \"baselineAlignment\", {\n        /**\n         * Gets or sets the baseline alignment property of selected contents.\n         */\n        get: function () {\n            return this.baselineAlignmentIn;\n        },\n        set: function (value) {\n            if (value === this.baselineAlignmentIn) {\n                return;\n            }\n            this.baselineAlignmentIn = value;\n            this.notifyPropertyChanged('baselineAlignment');\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(SelectionCharacterFormat.prototype, \"underline\", {\n        /**\n         * Gets or sets the underline style of selected contents.\n         */\n        get: function () {\n            return this.underlineIn;\n        },\n        set: function (value) {\n            if (value === this.underlineIn) {\n                return;\n            }\n            this.underlineIn = value;\n            this.notifyPropertyChanged('underline');\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(SelectionCharacterFormat.prototype, \"highlightColor\", {\n        /**\n         * Gets or sets the highlight color of selected contents.\n         */\n        get: function () {\n            return this.highlightColorIn;\n        },\n        set: function (value) {\n            if (value === this.highlightColorIn) {\n                return;\n            }\n            this.highlightColorIn = value;\n            this.notifyPropertyChanged('highlightColor');\n        },\n        enumerable: true,\n        configurable: true\n    });\n    SelectionCharacterFormat.prototype.getPropertyValue = function (property) {\n        switch (property) {\n            case 'bold':\n                return this.bold;\n            case 'italic':\n                return this.italic;\n            case 'fontSize':\n                if (this.fontSize >= 1) {\n                    return this.fontSize;\n                }\n                return undefined;\n            case 'fontFamily':\n                return this.fontFamily;\n            case 'strikethrough':\n                return this.strikethrough;\n            case 'baselineAlignment':\n                return this.baselineAlignment;\n            case 'highlightColor':\n                return this.highlightColor;\n            case 'underline':\n                return this.underline;\n            case 'fontColor':\n                return this.fontColor;\n            default:\n                return undefined;\n        }\n    };\n    /**\n     * Notifies whenever property gets changed.\n     * @param  {string} propertyName\n     */\n    SelectionCharacterFormat.prototype.notifyPropertyChanged = function (propertyName) {\n        // tslint:disable-next-line:max-line-length\n        if (!isNullOrUndefined(this.selection) && (this.selection.isCleared || this.selection.owner.isReadOnlyMode || !this.selection.owner.isDocumentLoaded || this.selection.owner.isPastingContent) && !this.selection.isRetrieveFormatting) {\n            return;\n        }\n        if (!isNullOrUndefined(this.selection) && !isNullOrUndefined(this.selection.start) && !this.selection.isRetrieveFormatting) {\n            var propertyValue = this.getPropertyValue(propertyName);\n            if (!isNullOrUndefined(propertyValue)) {\n                this.selection.owner.editorModule.onApplyCharacterFormat(propertyName, propertyValue);\n            }\n        }\n    };\n    /**\n     * Copies the source format.\n     * @param  {WCharacterFormat} format\n     * @returns void\n     * @private\n     */\n    SelectionCharacterFormat.prototype.copyFormat = function (format) {\n        this.styleName = !isNullOrUndefined(format.baseCharStyle) ? format.baseCharStyle.name : 'Default Paragraph Font';\n        this.fontSize = format.fontSize;\n        this.fontFamily = format.fontFamily;\n        this.bold = format.bold;\n        this.italic = format.italic;\n        this.baselineAlignment = format.baselineAlignment;\n        this.underline = format.underline;\n        this.fontColor = format.fontColor;\n        this.highlightColor = format.highlightColor;\n        this.strikethrough = format.strikethrough;\n    };\n    /**\n     * Combines the format.\n     * @param  {WCharacterFormat} format\n     * @private\n     */\n    SelectionCharacterFormat.prototype.combineFormat = function (format) {\n        if (!isNullOrUndefined(this.bold) && this.bold !== format.bold) {\n            this.bold = undefined;\n        }\n        if (!isNullOrUndefined(this.italic) && this.italic !== format.italic) {\n            this.italic = undefined;\n        }\n        if (this.fontSize !== 0 && this.fontSize !== format.fontSize) {\n            this.fontSize = 0;\n        }\n        if (!isNullOrUndefined(this.fontFamily) && this.fontFamily !== format.fontFamily) {\n            this.fontFamily = undefined;\n        }\n        if (!isNullOrUndefined(this.highlightColor) && this.highlightColor !== format.highlightColor) {\n            this.highlightColor = undefined;\n        }\n        if (!isNullOrUndefined(this.baselineAlignment) && this.baselineAlignment !== format.baselineAlignment) {\n            this.baselineAlignment = undefined;\n        }\n        if (!isNullOrUndefined(this.fontColor) && (this.fontColor !== format.fontColor)) {\n            this.fontColor = undefined;\n        }\n        if (!isNullOrUndefined(this.underline) && this.underline !== format.underline) {\n            this.underline = undefined;\n        }\n        if (!isNullOrUndefined(this.strikethrough) && this.strikethrough !== format.strikethrough) {\n            this.strikethrough = undefined;\n        }\n    };\n    /**\n     * Clones the format.\n     * @param  {SelectionCharacterFormat} selectionCharacterFormat\n     * @returns void\n     * @private\n     */\n    SelectionCharacterFormat.prototype.cloneFormat = function (selectionCharacterFormat) {\n        this.bold = selectionCharacterFormat.bold;\n        this.italic = selectionCharacterFormat.italic;\n        this.underline = selectionCharacterFormat.underline;\n        this.strikethrough = selectionCharacterFormat.strikethrough;\n        this.baselineAlignment = selectionCharacterFormat.baselineAlignment;\n        this.highlightColor = selectionCharacterFormat.highlightColor;\n        this.fontSize = selectionCharacterFormat.fontSize;\n        this.fontFamily = selectionCharacterFormat.fontFamily;\n        this.fontColor = selectionCharacterFormat.fontColor;\n        this.styleName = selectionCharacterFormat.styleName;\n    };\n    /**\n     * Checks whether current format is equal to the source format or not.\n     * @param  {SelectionCharacterFormat} format\n     * @returns boolean\n     * @private\n     */\n    SelectionCharacterFormat.prototype.isEqualFormat = function (format) {\n        return (this.fontSize === format.fontSize\n            && this.strikethrough === format.strikethrough\n            && this.bold === format.bold\n            && this.fontFamily === format.fontFamily\n            && this.underline === format.underline\n            && this.highlightColor === format.highlightColor\n            && this.italic === format.italic\n            && this.baselineAlignment === format.baselineAlignment\n            && this.fontColor === format.fontColor);\n    };\n    /**\n     * Clears the format.\n     * @returns void\n     * @private\n     */\n    SelectionCharacterFormat.prototype.clearFormat = function () {\n        this.fontSizeIn = 0;\n        this.boldIn = undefined;\n        this.italicIn = undefined;\n        this.fontFamilyIn = undefined;\n        this.fontColorIn = undefined;\n        this.underlineIn = undefined;\n        this.strikeThroughIn = undefined;\n        this.highlightColorIn = undefined;\n        this.baselineAlignmentIn = undefined;\n        this.styleName = undefined;\n    };\n    /**\n     * Destroys the maintained resources.\n     * @returns void\n     * @private\n     */\n    SelectionCharacterFormat.prototype.destroy = function () {\n        this.fontSizeIn = undefined;\n        this.boldIn = undefined;\n        this.italicIn = undefined;\n        this.fontFamilyIn = undefined;\n        this.fontColorIn = undefined;\n        this.underlineIn = undefined;\n        this.strikeThroughIn = undefined;\n        this.baselineAlignmentIn = undefined;\n        this.highlightColorIn = undefined;\n        this.selection = undefined;\n        this.styleName = undefined;\n    };\n    return SelectionCharacterFormat;\n}());\nexport { SelectionCharacterFormat };\n/**\n * Selection paragraph format implementation\n */\nvar SelectionParagraphFormat = /** @class */ (function () {\n    /**\n     * @private\n     */\n    function SelectionParagraphFormat(selection, viewer) {\n        // Declaring the character format properties.\n        this.leftIndentIn = 0;\n        this.rightIndentIn = 0;\n        this.beforeSpacingIn = 0;\n        this.afterSpacingIn = 0;\n        this.textAlignmentIn = undefined;\n        this.firstLineIndentIn = 0;\n        this.lineSpacingIn = 1;\n        this.lineSpacingTypeIn = undefined;\n        this.listLevelNumberIn = -1;\n        this.selection = selection;\n        this.viewer = viewer;\n    }\n    Object.defineProperty(SelectionParagraphFormat.prototype, \"leftIndent\", {\n        /**\n         * Gets or Sets the left indent for selected paragraphs.\n         * @default undefined\n         */\n        get: function () {\n            return this.leftIndentIn;\n        },\n        set: function (value) {\n            if (value === this.leftIndentIn) {\n                return;\n            }\n            this.leftIndentIn = value;\n            this.notifyPropertyChanged('leftIndent');\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(SelectionParagraphFormat.prototype, \"rightIndent\", {\n        /**\n         * Gets or Sets the right indent for selected paragraphs.\n         * @default undefined\n         */\n        get: function () {\n            return this.rightIndentIn;\n        },\n        set: function (value) {\n            if (value === this.rightIndentIn) {\n                return;\n            }\n            this.rightIndentIn = value;\n            this.notifyPropertyChanged('rightIndent');\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(SelectionParagraphFormat.prototype, \"firstLineIndent\", {\n        /**\n         * Gets or Sets the first line indent for selected paragraphs.\n         * @default undefined\n         */\n        get: function () {\n            return this.firstLineIndentIn;\n        },\n        set: function (value) {\n            if (value === this.firstLineIndentIn) {\n                return;\n            }\n            this.firstLineIndentIn = value;\n            this.notifyPropertyChanged('firstLineIndent');\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(SelectionParagraphFormat.prototype, \"textAlignment\", {\n        /**\n         * Gets or Sets the text alignment for selected paragraphs.\n         * @default undefined\n         */\n        get: function () {\n            return this.textAlignmentIn;\n        },\n        set: function (value) {\n            if (value === this.textAlignmentIn) {\n                return;\n            }\n            this.textAlignmentIn = value;\n            this.notifyPropertyChanged('textAlignment');\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(SelectionParagraphFormat.prototype, \"afterSpacing\", {\n        /**\n         * Gets or Sets the after spacing for selected paragraphs.\n         * @default undefined\n         */\n        get: function () {\n            return this.afterSpacingIn;\n        },\n        set: function (value) {\n            if (value === this.afterSpacingIn) {\n                return;\n            }\n            this.afterSpacingIn = value;\n            this.notifyPropertyChanged('afterSpacing');\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(SelectionParagraphFormat.prototype, \"beforeSpacing\", {\n        /**\n         * Gets or Sets the before spacing for selected paragraphs.\n         * @default undefined\n         */\n        get: function () {\n            return this.beforeSpacingIn;\n        },\n        set: function (value) {\n            if (value === this.beforeSpacingIn) {\n                return;\n            }\n            this.beforeSpacingIn = value;\n            this.notifyPropertyChanged('beforeSpacing');\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(SelectionParagraphFormat.prototype, \"lineSpacing\", {\n        /**\n         * Gets or Sets the line spacing for selected paragraphs.\n         * @default undefined\n         */\n        get: function () {\n            return this.lineSpacingIn;\n        },\n        set: function (value) {\n            if (value === this.lineSpacingIn) {\n                return;\n            }\n            this.lineSpacingIn = value;\n            this.notifyPropertyChanged('lineSpacing');\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(SelectionParagraphFormat.prototype, \"lineSpacingType\", {\n        /**\n         * Gets or Sets the line spacing type for selected paragraphs.\n         * @default undefined\n         */\n        get: function () {\n            return this.lineSpacingTypeIn;\n        },\n        set: function (value) {\n            if (value === this.lineSpacingTypeIn) {\n                return;\n            }\n            this.lineSpacingTypeIn = value;\n            this.notifyPropertyChanged('lineSpacingType');\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(SelectionParagraphFormat.prototype, \"listLevelNumber\", {\n        /**\n         * Gets or Sets the list level number for selected paragraphs.\n         * @default undefined\n         */\n        get: function () {\n            return this.listLevelNumberIn;\n        },\n        set: function (value) {\n            if (value === this.listLevelNumberIn) {\n                return;\n            }\n            this.listLevelNumberIn = value;\n            this.notifyPropertyChanged('listLevelNumber');\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(SelectionParagraphFormat.prototype, \"listText\", {\n        /**\n         * Gets the list text for selected paragraphs.\n         */\n        get: function () {\n            var listFormat = undefined;\n            var list = this.viewer.getListById(this.listId);\n            if (list instanceof WList && this.listLevelNumberIn > -1 && this.listLevelNumberIn < 9) {\n                var listLevel = list.getListLevel(this.listLevelNumber);\n                if (listLevel instanceof WListLevel) {\n                    if (listLevel.listLevelPattern === 'Bullet') {\n                        listFormat = listLevel.numberFormat;\n                    }\n                    else {\n                        listFormat = listLevel.numberFormat;\n                        for (var i = 0; i < 9; i++) {\n                            var levelPattern = '%' + (i + 1);\n                            if (listFormat.indexOf(levelPattern) > -1) {\n                                var level = i === this.listLevelNumberIn ? listLevel : list.getListLevel(i);\n                                var listText = this.selection.owner.viewer.layout.getListTextListLevel(level, 1);\n                                listFormat = listFormat.replace(levelPattern, listText);\n                            }\n                        }\n                    }\n                }\n            }\n            return listFormat;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    SelectionParagraphFormat.prototype.getPropertyValue = function (property) {\n        switch (property) {\n            case 'leftIndent':\n                return this.leftIndent;\n            case 'rightIndent':\n                return this.rightIndent;\n            case 'firstLineIndent':\n                return this.firstLineIndent;\n            case 'beforeSpacing':\n                return this.beforeSpacing;\n            case 'afterSpacing':\n                return this.afterSpacing;\n            case 'textAlignment':\n                return this.textAlignment;\n            case 'lineSpacing':\n                return this.lineSpacing;\n            case 'lineSpacingType':\n                return this.lineSpacingType;\n            default:\n                return undefined;\n        }\n    };\n    /**\n     * Notifies whenever the property gets changed.\n     * @param  {string} propertyName\n     */\n    SelectionParagraphFormat.prototype.notifyPropertyChanged = function (propertyName) {\n        if (!isNullOrUndefined(this.selection) &&\n            (this.selection.owner.isReadOnlyMode || !this.selection.owner.isDocumentLoaded)\n            && !this.selection.isRetrieveFormatting) {\n            return;\n        }\n        if (!isNullOrUndefined(this.selection) && !isNullOrUndefined(this.selection.start) && !this.selection.isRetrieveFormatting) {\n            var editorModule = this.selection.owner.editorModule;\n            var value = this.getPropertyValue(propertyName);\n            if ((propertyName === 'leftIndent' || propertyName === 'rightIndent' || propertyName === 'firstLineIndent')\n                && !(value >= -1056 && value < 1056)) {\n                return;\n            }\n            if (propertyName === 'listLevelNumber') {\n                editorModule.onApplyListInternal(this.viewer.getListById(this.listId), this.listLevelNumber);\n            }\n            else {\n                editorModule.onApplyParagraphFormat(propertyName, value, propertyName === 'textAlignment' ? true : false, false);\n            }\n        }\n    };\n    /**\n     * Copies the format.\n     * @param  {WParagraphFormat} format\n     * @returns void\n     * @private\n     */\n    SelectionParagraphFormat.prototype.copyFormat = function (format) {\n        this.styleName = !isNullOrUndefined(format.baseStyle) ? format.baseStyle.name : 'Normal';\n        this.leftIndent = format.leftIndent;\n        this.rightIndent = format.rightIndent;\n        this.firstLineIndent = format.firstLineIndent;\n        this.afterSpacing = format.afterSpacing;\n        this.beforeSpacing = format.beforeSpacing;\n        this.lineSpacing = format.lineSpacing;\n        this.lineSpacingType = format.lineSpacingType;\n        this.textAlignment = format.textAlignment;\n        if (!isNullOrUndefined(format.listFormat) && !isNullOrUndefined(format.listFormat.listId)) {\n            this.listId = format.listFormat.listId;\n            this.listLevelNumber = format.listFormat.listLevelNumber;\n        }\n        else {\n            this.listId = undefined;\n            this.listLevelNumber = 0;\n        }\n    };\n    /**\n     * Copies to format.\n     * @param  {WParagraphFormat} format\n     * @private\n     */\n    SelectionParagraphFormat.prototype.copyToFormat = function (format) {\n        if (isNullOrUndefined(format)) {\n            return;\n        }\n        if (!isNullOrUndefined(this.afterSpacing)) {\n            format.afterSpacing = this.afterSpacing;\n        }\n        if (!isNullOrUndefined(this.beforeSpacing)) {\n            format.beforeSpacing = this.beforeSpacing;\n        }\n        if (!isNullOrUndefined(this.leftIndent)) {\n            format.leftIndent = this.leftIndent;\n        }\n        if (!isNullOrUndefined(this.rightIndent)) {\n            format.rightIndent = this.rightIndent;\n        }\n        if (!isNullOrUndefined(this.textAlignment)) {\n            format.textAlignment = this.textAlignment;\n        }\n        if (!isNullOrUndefined(this.lineSpacing)) {\n            format.lineSpacing = this.lineSpacing;\n        }\n        if (!isNullOrUndefined(this.lineSpacingType)) {\n            format.lineSpacingType = this.lineSpacingType;\n        }\n        if (!isNullOrUndefined(this.firstLineIndent)) {\n            format.firstLineIndent = this.firstLineIndent;\n        }\n    };\n    /**\n     * Combines the format.\n     * @param  {WParagraphFormat} format\n     * @private\n     */\n    SelectionParagraphFormat.prototype.combineFormat = function (format) {\n        if (!isNullOrUndefined(this.leftIndent) && this.leftIndent !== format.leftIndent) {\n            this.leftIndent = undefined;\n        }\n        if (!isNullOrUndefined(this.rightIndent) && this.rightIndent !== format.rightIndent) {\n            this.rightIndent = undefined;\n        }\n        if (!isNullOrUndefined(this.firstLineIndent) && this.firstLineIndent !== format.firstLineIndent) {\n            this.firstLineIndent = undefined;\n        }\n        if (this.lineSpacing !== 0 && this.lineSpacing !== format.lineSpacing) {\n            this.lineSpacing = 0;\n        }\n        if (this.beforeSpacing !== -1 && this.beforeSpacing !== format.beforeSpacing) {\n            this.beforeSpacing = -1;\n        }\n        if (this.afterSpacing !== -1 && this.afterSpacing !== format.afterSpacing) {\n            this.afterSpacing = -1;\n        }\n        if (!isNullOrUndefined(this.lineSpacingType) && this.lineSpacingType !== format.lineSpacingType) {\n            this.lineSpacingType = undefined;\n        }\n        if (!isNullOrUndefined(this.textAlignment) && this.textAlignment !== format.textAlignment) {\n            this.textAlignment = undefined;\n        }\n        // tslint:disable-next-line:max-line-length\n        if (this.listLevelNumber >= 0 && !isNullOrUndefined(this.listId) && (isNullOrUndefined(format.listFormat) || format.listFormat.listLevelNumber !== this.listLevelNumber)) {\n            this.listLevelNumber = -1;\n        }\n        // tslint:disable-next-line:max-line-length\n        if (isNullOrUndefined(format.listFormat) || isNullOrUndefined(format.listFormat.listId) || (!isNullOrUndefined(this.listId) && this.listId !== format.listFormat.listId)) {\n            this.listId = undefined;\n        }\n    };\n    /**\n     * Clears the format.\n     * @returns void\n     * @private\n     */\n    SelectionParagraphFormat.prototype.clearFormat = function () {\n        this.leftIndent = 0;\n        this.rightIndent = 0;\n        this.beforeSpacing = 0;\n        this.afterSpacing = 0;\n        this.firstLineIndent = 0;\n        this.lineSpacing = 1;\n        this.textAlignment = undefined;\n        this.lineSpacingType = undefined;\n        this.listId = undefined;\n        this.listLevelNumber = -1;\n        this.styleName = undefined;\n    };\n    /**\n     * Gets the clone of list at current selection.\n     * @returns WList\n     * @private\n     */\n    SelectionParagraphFormat.prototype.getList = function () {\n        var list = this.viewer.getListById(this.listId);\n        if (!isNullOrUndefined(list)) {\n            var listAdv = new WList();\n            var abstractList = new WAbstractList();\n            var currentAbstractList = this.viewer.getAbstractListById(list.abstractListId);\n            var editor = this.selection.owner.editorModule;\n            if (!isNullOrUndefined(currentAbstractList)) {\n                for (var i = 0; i < currentAbstractList.levels.length; i++) {\n                    var level = editor.cloneListLevel(currentAbstractList.levels[i]);\n                    abstractList.levels.push(level);\n                    level.ownerBase = abstractList;\n                }\n            }\n            else {\n                abstractList.levels.push(new WListLevel(abstractList));\n            }\n            if (!isNullOrUndefined(list.levelOverrides)) {\n                for (var i = 0; i < list.levelOverrides.length; i++) {\n                    var levelOverride = editor.cloneLevelOverride(list.levelOverrides[i]);\n                    listAdv.levelOverrides.push(levelOverride);\n                }\n            }\n            listAdv.abstractList = abstractList;\n            listAdv.abstractListId = abstractList.abstractListId;\n            listAdv.sourceListId = list.listId;\n            return listAdv;\n        }\n        return undefined;\n    };\n    /**\n     * Modifies the list at current selection.\n     * @param  {WList} listAdv\n     * @private\n     */\n    SelectionParagraphFormat.prototype.setList = function (listAdv) {\n        if (this.viewer.owner.isReadOnlyMode || !this.viewer.owner.isDocumentLoaded) {\n            return;\n        }\n        var list = this.viewer.getListById(this.listId);\n        var collection = undefined;\n        var currentAbstractList = listAdv ? this.viewer.getAbstractListById(listAdv.abstractListId) : undefined;\n        if (!isNullOrUndefined(list) && !isNullOrUndefined(listAdv)\n            && !isNullOrUndefined(currentAbstractList) && listAdv.sourceListId === list.listId) {\n            var history_1 = this.viewer.owner.editorHistory;\n            var listLevel = this.viewer.layout.getListLevel(list, 1);\n            this.selection.owner.isLayoutEnabled = false;\n            this.viewer.owner.editorModule.setOffsetValue(this.selection);\n            if (history_1) {\n                collection = history_1.updateListChangesInHistory(currentAbstractList, list);\n            }\n            this.viewer.owner.editorModule.updateListParagraphs();\n            if (history_1) {\n                history_1.applyListChanges(this.selection, collection);\n            }\n            this.selection.owner.isLayoutEnabled = true;\n            this.viewer.renderedLists.clear();\n            // this.viewer.pages = [];\n            this.viewer.owner.editorModule.layoutWholeDocument();\n            this.viewer.owner.editorModule.updateSelectionTextPosition(false);\n            if (history_1 && history_1.currentBaseHistoryInfo) {\n                if (history_1.currentBaseHistoryInfo.modifiedProperties.length > 0) {\n                    history_1.currentBaseHistoryInfo.updateSelection();\n                }\n                history_1.updateHistory();\n            }\n            this.viewer.owner.editorModule.fireContentChange();\n        }\n        else if (!isNullOrUndefined(listAdv)) {\n            this.selection.owner.isLayoutEnabled = false;\n            if (!isNullOrUndefined(currentAbstractList) && this.viewer.abstractLists.indexOf(currentAbstractList) === -1) {\n                this.viewer.abstractLists.push(currentAbstractList);\n            }\n            if (this.viewer.lists.indexOf(listAdv) === -1) {\n                this.viewer.lists.push(listAdv);\n            }\n            //currentAbstractList.listType = 'Numbering';\n            this.selection.owner.isLayoutEnabled = true;\n            this.selection.owner.editorModule.onApplyList(listAdv);\n        }\n        else {\n            this.selection.owner.editorModule.onApplyList(undefined);\n        }\n    };\n    /**\n     * Destroys the managed resources.\n     * @returns void\n     * @private\n     */\n    SelectionParagraphFormat.prototype.destroy = function () {\n        this.leftIndentIn = undefined;\n        this.rightIndentIn = undefined;\n        this.beforeSpacingIn = undefined;\n        this.afterSpacingIn = undefined;\n        this.firstLineIndentIn = undefined;\n        this.lineSpacingIn = undefined;\n        this.textAlignmentIn = undefined;\n        this.lineSpacingTypeIn = undefined;\n        this.listId = undefined;\n        this.listLevelNumberIn = undefined;\n        this.viewer = undefined;\n        this.selection = undefined;\n        this.styleName = undefined;\n    };\n    return SelectionParagraphFormat;\n}());\nexport { SelectionParagraphFormat };\n/**\n * Selection section format implementation\n */\nvar SelectionSectionFormat = /** @class */ (function () {\n    /**\n     * @private\n     */\n    function SelectionSectionFormat(selection) {\n        this.differentFirstPageIn = undefined;\n        this.differentOddAndEvenPagesIn = undefined;\n        this.selection = selection;\n    }\n    Object.defineProperty(SelectionSectionFormat.prototype, \"pageHeight\", {\n        /**\n         * Gets or sets the page height.\n         */\n        get: function () {\n            return this.pageHeightIn;\n        },\n        set: function (value) {\n            this.pageHeightIn = value;\n            this.notifyPropertyChanged('pageHeight');\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(SelectionSectionFormat.prototype, \"pageWidth\", {\n        /**\n         * Gets or sets the page width.\n         */\n        get: function () {\n            return this.pageWidthIn;\n        },\n        set: function (value) {\n            this.pageWidthIn = value;\n            this.notifyPropertyChanged('pageWidth');\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(SelectionSectionFormat.prototype, \"leftMargin\", {\n        /**\n         * Gets or sets the page left margin.\n         */\n        get: function () {\n            return this.leftMarginIn;\n        },\n        set: function (value) {\n            this.leftMarginIn = value;\n            this.notifyPropertyChanged('leftMargin');\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(SelectionSectionFormat.prototype, \"bottomMargin\", {\n        /**\n         * Gets or sets the page bottom margin.\n         */\n        get: function () {\n            return this.bottomMarginIn;\n        },\n        set: function (value) {\n            this.bottomMarginIn = value;\n            this.notifyPropertyChanged('bottomMargin');\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(SelectionSectionFormat.prototype, \"topMargin\", {\n        /**\n         * Gets or sets the page top margin.\n         */\n        get: function () {\n            return this.topMarginIn;\n        },\n        set: function (value) {\n            this.topMarginIn = value;\n            this.notifyPropertyChanged('topMargin');\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(SelectionSectionFormat.prototype, \"rightMargin\", {\n        /**\n         * Gets or sets the page right margin.\n         */\n        get: function () {\n            return this.rightMarginIn;\n        },\n        set: function (value) {\n            this.rightMarginIn = value;\n            this.notifyPropertyChanged('rightMargin');\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(SelectionSectionFormat.prototype, \"headerDistance\", {\n        /**\n         * Gets or sets the header distance.\n         */\n        get: function () {\n            return this.headerDistanceIn;\n        },\n        set: function (value) {\n            this.headerDistanceIn = value;\n            this.notifyPropertyChanged('headerDistance');\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(SelectionSectionFormat.prototype, \"footerDistance\", {\n        /**\n         * Gets or sets the footer distance.\n         */\n        get: function () {\n            return this.footerDistanceIn;\n        },\n        set: function (value) {\n            this.footerDistanceIn = value;\n            this.notifyPropertyChanged('footerDistance');\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(SelectionSectionFormat.prototype, \"differentFirstPage\", {\n        /**\n         * Gets or sets a value indicating whether the section has different first page.\n         */\n        get: function () {\n            return this.differentFirstPageIn;\n        },\n        set: function (value) {\n            this.differentFirstPageIn = value;\n            this.notifyPropertyChanged('differentFirstPage');\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(SelectionSectionFormat.prototype, \"differentOddAndEvenPages\", {\n        /**\n         * Gets or sets a value indicating whether the section has different odd and even page.\n         */\n        get: function () {\n            return this.differentOddAndEvenPagesIn;\n        },\n        set: function (value) {\n            this.differentOddAndEvenPagesIn = value;\n            this.notifyPropertyChanged('differentOddAndEvenPages');\n        },\n        enumerable: true,\n        configurable: true\n    });\n    /**\n     * Copies the format.\n     * @param  {WSectionFormat} format\n     * @returns void\n     * @private\n     */\n    SelectionSectionFormat.prototype.copyFormat = function (format) {\n        this.pageHeight = format.pageHeight;\n        this.pageWidth = format.pageWidth;\n        this.leftMargin = format.leftMargin;\n        this.topMargin = format.topMargin;\n        this.rightMargin = format.rightMargin;\n        this.bottomMargin = format.bottomMargin;\n        this.headerDistance = format.headerDistance;\n        this.footerDistance = format.footerDistance;\n        this.differentFirstPage = format.differentFirstPage;\n        this.differentOddAndEvenPages = format.differentOddAndEvenPages;\n    };\n    SelectionSectionFormat.prototype.notifyPropertyChanged = function (propertyName) {\n        var selection = this.selection;\n        if (!isNullOrUndefined(selection) && (selection.isCleared || selection.owner.isPastingContent\n            || selection.owner.isReadOnlyMode || !selection.owner.isDocumentLoaded)\n            && !selection.isRetrieveFormatting) {\n            return;\n        }\n        if (!isNullOrUndefined(selection) && !isNullOrUndefined(selection.start) && !selection.isRetrieveFormatting) {\n            var value = this.getPropertyvalue(propertyName);\n            if (!isNullOrUndefined(value)) {\n                selection.owner.editorModule.onApplySectionFormat(propertyName, value);\n            }\n        }\n    };\n    SelectionSectionFormat.prototype.getPropertyvalue = function (propertyName) {\n        switch (propertyName) {\n            case 'pageHeight':\n                if (this.pageHeight > 0) {\n                    return this.pageHeight;\n                }\n                return undefined;\n            case 'pageWidth':\n                if (this.pageWidth > 0) {\n                    return this.pageWidth;\n                }\n                return undefined;\n            case 'leftMargin':\n                if (this.leftMargin >= 0) {\n                    return this.leftMargin;\n                }\n                return undefined;\n            case 'rightMargin':\n                if (this.rightMargin >= 0) {\n                    return this.rightMargin;\n                }\n                return undefined;\n            case 'topMargin':\n                if (this.topMargin >= 0) {\n                    return this.topMargin;\n                }\n                return undefined;\n            case 'bottomMargin':\n                if (this.bottomMargin >= 0) {\n                    return this.bottomMargin;\n                }\n                return undefined;\n            case 'differentFirstPage':\n                if (!isNullOrUndefined(this.differentFirstPage)) {\n                    return this.differentFirstPage;\n                }\n                return undefined;\n            case 'differentOddAndEvenPages':\n                if (!isNullOrUndefined(this.differentOddAndEvenPages)) {\n                    return this.differentOddAndEvenPages;\n                }\n                return undefined;\n            case 'headerDistance':\n                return this.headerDistanceIn;\n            case 'footerDistance':\n                return this.footerDistance;\n            default:\n                return undefined;\n        }\n    };\n    /**\n     * Combines the format.\n     * @param  {WSectionFormat} format\n     * @private\n     */\n    SelectionSectionFormat.prototype.combineFormat = function (format) {\n        if (this.pageHeight > 0 && this.pageHeight !== format.pageHeight) {\n            this.pageHeight = 0;\n        }\n        if (this.pageWidth > 0 && this.pageWidth !== format.pageWidth) {\n            this.pageWidth = 0;\n        }\n        if (this.leftMargin > -1 && this.leftMargin !== format.leftMargin) {\n            this.leftMargin = -1;\n        }\n        if (this.topMargin > -1 && this.topMargin !== format.topMargin) {\n            this.topMargin = -1;\n        }\n        if (this.rightMargin > -1 && this.rightMargin !== format.rightMargin) {\n            this.rightMargin = -1;\n        }\n        if (this.bottomMargin > -1 && this.bottomMargin !== format.bottomMargin) {\n            this.bottomMargin = -1;\n        }\n        if (this.headerDistance !== 0 && this.headerDistance !== format.headerDistance) {\n            this.headerDistance = 0;\n        }\n        if (this.footerDistance !== 0 && this.footerDistance !== format.footerDistance) {\n            this.footerDistance = 0;\n        }\n        if (!isNullOrUndefined(this.differentFirstPage) && this.differentFirstPage !== format.differentFirstPage) {\n            this.differentFirstPage = undefined;\n        }\n        if (!isNullOrUndefined(this.differentOddAndEvenPages) && this.differentOddAndEvenPages !== format.differentOddAndEvenPages) {\n            this.differentOddAndEvenPages = undefined;\n        }\n    };\n    /**\n     * Clears the format.\n     * @returns void\n     * @private\n     */\n    SelectionSectionFormat.prototype.clearFormat = function () {\n        this.headerDistance = 0;\n        this.footerDistance = 0;\n        this.pageHeight = 0;\n        this.pageWidth = 0;\n        this.leftMargin = -1;\n        this.rightMargin = -1;\n        this.topMargin = -1;\n        this.bottomMargin = -1;\n        this.differentFirstPage = undefined;\n        this.differentOddAndEvenPages = undefined;\n    };\n    /**\n     * Destroys the managed resources.\n     * @returns void\n     * @private\n     */\n    SelectionSectionFormat.prototype.destroy = function () {\n        this.headerDistanceIn = undefined;\n        this.footerDistanceIn = undefined;\n        this.pageHeightIn = undefined;\n        this.pageWidthIn = undefined;\n        this.leftMarginIn = undefined;\n        this.rightMarginIn = undefined;\n        this.topMarginIn = undefined;\n        this.bottomMarginIn = undefined;\n        this.differentFirstPageIn = undefined;\n        this.differentOddAndEvenPagesIn = undefined;\n        this.selection = undefined;\n    };\n    return SelectionSectionFormat;\n}());\nexport { SelectionSectionFormat };\n/**\n * Selection table format implementation\n */\nvar SelectionTableFormat = /** @class */ (function () {\n    /**\n     * @private\n     */\n    function SelectionTableFormat(selection) {\n        this.leftIndentIn = 0;\n        this.backgroundIn = undefined;\n        this.tableAlignmentIn = undefined;\n        this.cellSpacingIn = 0;\n        this.leftMarginIn = 0;\n        this.rightMarginIn = 0;\n        this.topMarginIn = 0;\n        this.bottomMarginIn = 0;\n        this.preferredWidthIn = 0;\n        this.selection = selection;\n    }\n    Object.defineProperty(SelectionTableFormat.prototype, \"table\", {\n        /**\n         * Gets or sets the table.\n         * @private\n         */\n        get: function () {\n            return this.tableIn;\n        },\n        set: function (value) {\n            this.tableIn = value;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(SelectionTableFormat.prototype, \"leftIndent\", {\n        /**\n         * Gets or Sets the left indent for selected table.\n         * @private\n         */\n        get: function () {\n            return this.leftIndentIn;\n        },\n        set: function (value) {\n            if (value === this.leftIndentIn) {\n                return;\n            }\n            this.leftIndentIn = value;\n            this.notifyPropertyChanged('leftIndent');\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(SelectionTableFormat.prototype, \"topMargin\", {\n        /**\n         * Gets or Sets the default top margin of cell for selected table.\n         * @default undefined\n         */\n        get: function () {\n            return this.topMarginIn;\n        },\n        set: function (value) {\n            if (value === this.topMarginIn) {\n                return;\n            }\n            this.topMarginIn = value;\n            this.notifyPropertyChanged('topMargin');\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(SelectionTableFormat.prototype, \"background\", {\n        /**\n         * Gets or Sets the background for selected table.\n         * @default undefined\n         */\n        get: function () {\n            return this.backgroundIn;\n        },\n        set: function (value) {\n            if (value === this.backgroundIn) {\n                return;\n            }\n            this.backgroundIn = value;\n            this.notifyPropertyChanged('background');\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(SelectionTableFormat.prototype, \"tableAlignment\", {\n        /**\n         * Gets or Sets the table alignment for selected table.\n         * @default undefined\n         */\n        get: function () {\n            return this.tableAlignmentIn;\n        },\n        set: function (value) {\n            if (value === this.tableAlignmentIn) {\n                return;\n            }\n            this.tableAlignmentIn = value;\n            this.notifyPropertyChanged('tableAlignment');\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(SelectionTableFormat.prototype, \"leftMargin\", {\n        /**\n         * Gets or Sets the default left margin of cell for selected table.\n         * @default undefined\n         */\n        get: function () {\n            return this.leftMarginIn;\n        },\n        set: function (value) {\n            if (value === this.leftMarginIn) {\n                return;\n            }\n            this.leftMarginIn = value;\n            this.notifyPropertyChanged('leftMargin');\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(SelectionTableFormat.prototype, \"bottomMargin\", {\n        /**\n         * Gets or Sets the default bottom margin of cell for selected table.\n         * @default undefined\n         */\n        get: function () {\n            return this.bottomMarginIn;\n        },\n        set: function (value) {\n            if (value === this.bottomMarginIn) {\n                return;\n            }\n            this.bottomMarginIn = value;\n            this.notifyPropertyChanged('bottomMargin');\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(SelectionTableFormat.prototype, \"cellSpacing\", {\n        /**\n         * Gets or Sets the cell spacing for selected table.\n         * @default undefined\n         */\n        get: function () {\n            return this.cellSpacingIn;\n        },\n        set: function (value) {\n            if (value === this.cellSpacingIn) {\n                return;\n            }\n            this.cellSpacingIn = value;\n            this.notifyPropertyChanged('cellSpacing');\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(SelectionTableFormat.prototype, \"rightMargin\", {\n        /**\n         * Gets or Sets the default right margin of cell for selected table.\n         * @default undefined\n         */\n        get: function () {\n            return this.rightMarginIn;\n        },\n        set: function (value) {\n            if (value === this.rightMarginIn) {\n                return;\n            }\n            this.rightMarginIn = value;\n            this.notifyPropertyChanged('rightMargin');\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(SelectionTableFormat.prototype, \"preferredWidth\", {\n        /**\n         * Gets or Sets the preferred width for selected table.\n         * @default undefined\n         */\n        get: function () {\n            return this.preferredWidthIn;\n        },\n        set: function (value) {\n            if (value === this.preferredWidthIn) {\n                return;\n            }\n            this.preferredWidthIn = value;\n            this.notifyPropertyChanged('preferredWidth');\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(SelectionTableFormat.prototype, \"preferredWidthType\", {\n        /**\n         * Gets or Sets the preferred width type for selected table.\n         * @default undefined\n         */\n        get: function () {\n            return this.preferredWidthTypeIn;\n        },\n        set: function (value) {\n            if (value === this.preferredWidthTypeIn) {\n                return;\n            }\n            this.preferredWidthTypeIn = value;\n            this.notifyPropertyChanged('preferredWidthType');\n        },\n        enumerable: true,\n        configurable: true\n    });\n    SelectionTableFormat.prototype.getPropertyValue = function (propertyName) {\n        switch (propertyName) {\n            case 'tableAlignment':\n                return this.tableAlignment;\n            case 'leftIndent':\n                return this.leftIndent;\n            case 'cellSpacing':\n                return this.cellSpacing;\n            case 'leftMargin':\n                return this.leftMargin;\n            case 'rightMargin':\n                return this.rightMargin;\n            case 'topMargin':\n                return this.topMargin;\n            case 'bottomMargin':\n                return this.bottomMargin;\n            case 'background':\n                var shading = new WShading();\n                shading.backgroundColor = this.background;\n                return shading;\n            case 'preferredWidth':\n                return this.preferredWidth;\n            case 'preferredWidthType':\n                return this.preferredWidthType;\n            default:\n                return undefined;\n        }\n    };\n    SelectionTableFormat.prototype.notifyPropertyChanged = function (propertyName) {\n        if (!isNullOrUndefined(this.selection) && (this.selection.isCleared\n            || !this.selection.owner.isDocumentLoaded || this.selection.owner.isReadOnlyMode\n            || this.selection.owner.isPastingContent) && !this.selection.isRetrieveFormatting) {\n            return;\n        }\n        if (!isNullOrUndefined(this.selection) && !isNullOrUndefined(this.selection.start) && !this.selection.isRetrieveFormatting) {\n            var value = this.getPropertyValue(propertyName);\n            if (propertyName === 'background') {\n                propertyName = 'shading';\n            }\n            if (!isNullOrUndefined(value)) {\n                this.selection.owner.editorModule.onApplyTableFormat(propertyName, value);\n            }\n        }\n    };\n    /**\n     * Copies the format.\n     * @param  {WTableFormat} format Format to copy.\n     * @returns void\n     * @private\n     */\n    SelectionTableFormat.prototype.copyFormat = function (format) {\n        this.leftIndent = format.leftIndent;\n        this.background = format.shading.backgroundColor;\n        this.tableAlignment = format.tableAlignment;\n        this.leftMargin = format.leftMargin;\n        this.rightMargin = format.rightMargin;\n        this.topMargin = format.topMargin;\n        this.bottomMargin = format.bottomMargin;\n        this.cellSpacing = format.cellSpacing;\n        this.preferredWidth = format.preferredWidth;\n        this.preferredWidthType = format.preferredWidthType;\n    };\n    /**\n     * Clears the format.\n     * @returns void\n     * @private\n     */\n    SelectionTableFormat.prototype.clearFormat = function () {\n        this.table = undefined;\n        this.leftIndent = 0;\n        this.background = undefined;\n        this.leftIndent = 0;\n        this.leftMargin = 0;\n        this.rightMargin = 0;\n        this.topMargin = 0;\n        this.bottomMargin = 0;\n        this.cellSpacing = 0;\n        this.tableAlignment = undefined;\n    };\n    /**\n     * Destroys the managed resources.\n     * @returns void\n     * @private\n     */\n    SelectionTableFormat.prototype.destroy = function () {\n        this.leftIndentIn = undefined;\n        this.backgroundIn = undefined;\n        this.leftIndentIn = undefined;\n        this.leftMarginIn = undefined;\n        this.rightMarginIn = undefined;\n        this.topMarginIn = undefined;\n        this.bottomMarginIn = undefined;\n        this.cellSpacingIn = undefined;\n        this.tableAlignmentIn = undefined;\n        this.tableIn = undefined;\n        this.selection = undefined;\n    };\n    return SelectionTableFormat;\n}());\nexport { SelectionTableFormat };\n/**\n * Selection cell format implementation\n */\nvar SelectionCellFormat = /** @class */ (function () {\n    /**\n     * @private\n     */\n    function SelectionCellFormat(selection) {\n        this.verticalAlignmentIn = undefined;\n        this.leftMarginIn = 0;\n        this.rightMarginIn = 0;\n        this.topMarginIn = 0;\n        this.bottomMarginIn = 0;\n        this.backgroundIn = undefined;\n        this.preferredWidthTypeIn = undefined;\n        this.selection = selection;\n    }\n    Object.defineProperty(SelectionCellFormat.prototype, \"verticalAlignment\", {\n        /**\n         * Gets or sets the vertical alignment of the selected cells.\n         * @default undefined\n         */\n        get: function () {\n            return this.verticalAlignmentIn;\n        },\n        set: function (value) {\n            if (value === this.verticalAlignmentIn) {\n                return;\n            }\n            this.verticalAlignmentIn = value;\n            this.notifyPropertyChanged('verticalAlignment');\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(SelectionCellFormat.prototype, \"leftMargin\", {\n        /**\n         * Gets or Sets the left margin for selected cells.\n         * @default undefined\n         */\n        /* tslint:disable */\n        get: function () {\n            return this.leftMarginIn;\n        },\n        set: function (value) {\n            if (value === this.leftMarginIn) {\n                return;\n            }\n            this.leftMarginIn = value;\n            this.notifyPropertyChanged('leftMargin');\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(SelectionCellFormat.prototype, \"rightMargin\", {\n        /**\n         * Gets or Sets the right margin for selected cells.\n         * @default undefined\n         */\n        get: function () {\n            return this.rightMarginIn;\n        },\n        set: function (value) {\n            if (value === this.rightMarginIn) {\n                return;\n            }\n            this.rightMarginIn = value;\n            this.notifyPropertyChanged('rightMargin');\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(SelectionCellFormat.prototype, \"topMargin\", {\n        /**\n         * Gets or Sets the top margin for selected cells.\n         * @default undefined\n         */\n        get: function () {\n            return this.topMarginIn;\n        },\n        set: function (value) {\n            if (value === this.topMarginIn) {\n                return;\n            }\n            this.topMarginIn = value;\n            this.notifyPropertyChanged('topMargin');\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(SelectionCellFormat.prototype, \"bottomMargin\", {\n        /**\n         * Gets or Sets the bottom margin for selected cells.\n         * @default undefined\n         */\n        get: function () {\n            return this.bottomMarginIn;\n        },\n        set: function (value) {\n            if (value === this.bottomMarginIn) {\n                return;\n            }\n            this.bottomMarginIn = value;\n            this.notifyPropertyChanged('bottomMargin');\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(SelectionCellFormat.prototype, \"background\", {\n        /**\n         * Gets or Sets the background for selected cells.\n         * @default undefined\n         */\n        get: function () {\n            return this.backgroundIn;\n        },\n        /* tslint:enable */\n        set: function (value) {\n            if (value === this.backgroundIn) {\n                return;\n            }\n            this.backgroundIn = value;\n            this.notifyPropertyChanged('background');\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(SelectionCellFormat.prototype, \"preferredWidthType\", {\n        /* tslint:disable */\n        /**\n         * Gets or Sets the preferred width type for selected cells.\n         * @default undefined\n         */\n        get: function () {\n            return this.preferredWidthTypeIn;\n        },\n        set: function (value) {\n            if (value === this.preferredWidthTypeIn) {\n                return;\n            }\n            this.preferredWidthTypeIn = value;\n            this.notifyPropertyChanged('preferredWidthType');\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(SelectionCellFormat.prototype, \"preferredWidth\", {\n        /**\n         * Gets or Sets the preferred width  for selected cells.\n         * @default undefined\n         */\n        get: function () {\n            return this.preferredWidthIn;\n        },\n        set: function (value) {\n            if (value === this.preferredWidthIn) {\n                return;\n            }\n            this.preferredWidthIn = value;\n            this.notifyPropertyChanged('preferredWidth');\n        },\n        enumerable: true,\n        configurable: true\n    });\n    /* tslint:enable */\n    SelectionCellFormat.prototype.notifyPropertyChanged = function (propertyName) {\n        var selection = this.selection;\n        if (!isNullOrUndefined(selection)) {\n            if ((selection.isCleared || !selection.owner.isDocumentLoaded\n                || selection.owner.isReadOnlyMode || selection.owner.isPastingContent) && !selection.isRetrieveFormatting) {\n                return;\n            }\n            if (!isNullOrUndefined(this.selection.start) && !this.selection.isRetrieveFormatting) {\n                var value = this.getPropertyValue(propertyName);\n                if (propertyName === 'background') {\n                    propertyName = 'shading';\n                }\n                if (!isNullOrUndefined(value)) {\n                    this.selection.owner.editorModule.onApplyTableCellFormat(propertyName, value);\n                }\n            }\n        }\n    };\n    SelectionCellFormat.prototype.getPropertyValue = function (propertyName) {\n        switch (propertyName) {\n            case 'verticalAlignment':\n                return this.verticalAlignment;\n            case 'leftMargin':\n                return this.leftMargin;\n            case 'rightMargin':\n                return this.rightMargin;\n            case 'topMargin':\n                return this.topMargin;\n            case 'bottomMargin':\n                return this.bottomMargin;\n            case 'preferredWidth':\n                return this.preferredWidth;\n            case 'preferredWidthType':\n                return this.preferredWidthType;\n            case 'background':\n                var shading = new WShading();\n                shading.backgroundColor = this.background;\n                return shading;\n            default:\n                return undefined;\n        }\n    };\n    /**\n     * Copies the format.\n     * @param  {WCellFormat} format Source Format to copy.\n     * @returns void\n     * @private\n     */\n    SelectionCellFormat.prototype.copyFormat = function (format) {\n        this.leftMargin = format.leftMargin;\n        this.rightMargin = format.rightMargin;\n        this.topMargin = format.topMargin;\n        this.bottomMargin = format.bottomMargin;\n        this.background = format.shading.backgroundColor;\n        this.verticalAlignment = format.verticalAlignment;\n        this.preferredWidth = format.preferredWidth;\n        this.preferredWidthType = format.preferredWidthType;\n    };\n    /**\n     * Clears the format.\n     * @returns void\n     * @private\n     */\n    SelectionCellFormat.prototype.clearCellFormat = function () {\n        this.leftMargin = undefined;\n        this.rightMargin = undefined;\n        this.topMargin = undefined;\n        this.bottomMargin = undefined;\n        this.background = undefined;\n        this.verticalAlignment = undefined;\n    };\n    /**\n     * Combines the format.\n     * @param  {WCellFormat} format\n     * @private\n     */\n    SelectionCellFormat.prototype.combineFormat = function (format) {\n        if (!isNullOrUndefined(this.leftMargin) && this.leftMargin !== format.leftMargin) {\n            this.leftMargin = undefined;\n        }\n        if (!isNullOrUndefined(this.topMargin) && this.topMargin !== format.topMargin) {\n            this.topMargin = undefined;\n        }\n        if (!isNullOrUndefined(this.rightMargin) && this.rightMargin !== format.rightMargin) {\n            this.rightMargin = undefined;\n        }\n        if (!isNullOrUndefined(this.bottomMargin) && this.bottomMargin !== format.bottomMargin) {\n            this.bottomMargin = undefined;\n        }\n        if (!isNullOrUndefined(this.background) && this.background !== format.shading.backgroundColor) {\n            this.background = undefined;\n        }\n        if (!isNullOrUndefined(this.verticalAlignment) && this.verticalAlignment !== format.verticalAlignment) {\n            this.verticalAlignment = undefined;\n        }\n        if (!isNullOrUndefined(this.preferredWidth) && this.preferredWidth !== format.preferredWidth) {\n            this.preferredWidth = undefined;\n        }\n        if (!isNullOrUndefined(this.preferredWidthType) && this.preferredWidthType !== format.preferredWidthType) {\n            this.preferredWidthType = undefined;\n        }\n    };\n    /**\n     * Clears the format.\n     * @returns void\n     * @private\n     */\n    SelectionCellFormat.prototype.clearFormat = function () {\n        this.background = undefined;\n        this.bottomMargin = 0;\n        this.leftMargin = 0;\n        this.rightMargin = 0;\n        this.topMargin = 0;\n        this.verticalAlignment = undefined;\n    };\n    /**\n     * Destroys the manages resources.\n     * @returns void\n     * @private\n     */\n    SelectionCellFormat.prototype.destroy = function () {\n        this.backgroundIn = undefined;\n        this.verticalAlignmentIn = undefined;\n        this.bottomMarginIn = undefined;\n        this.leftMarginIn = undefined;\n        this.rightMarginIn = undefined;\n        this.topMarginIn = undefined;\n        this.selection = undefined;\n    };\n    return SelectionCellFormat;\n}());\nexport { SelectionCellFormat };\n/**\n * Selection row format implementation\n */\nvar SelectionRowFormat = /** @class */ (function () {\n    /**\n     * @private\n     */\n    function SelectionRowFormat(selection) {\n        this.heightIn = undefined;\n        this.heightTypeIn = undefined;\n        this.isHeaderIn = undefined;\n        this.allowRowBreakAcrossPagesIn = undefined;\n        this.selection = selection;\n    }\n    Object.defineProperty(SelectionRowFormat.prototype, \"height\", {\n        /**\n         * Gets or Sets the height for selected rows.\n         * @default undefined\n         */\n        get: function () {\n            return this.heightIn;\n        },\n        set: function (value) {\n            if (value === this.heightIn) {\n                return;\n            }\n            this.heightIn = value;\n            this.notifyPropertyChanged('height');\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(SelectionRowFormat.prototype, \"heightType\", {\n        /**\n         * Gets or Sets the height type for selected rows.\n         * @default undefined\n         */\n        get: function () {\n            return this.heightTypeIn;\n        },\n        set: function (value) {\n            if (value === this.heightTypeIn) {\n                return;\n            }\n            this.heightTypeIn = value;\n            this.notifyPropertyChanged('heightType');\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(SelectionRowFormat.prototype, \"isHeader\", {\n        /**\n         * Gets or Sets a value indicating whether the selected rows are header rows or not.\n         * @default undefined\n         */\n        get: function () {\n            return this.isHeaderIn;\n        },\n        set: function (value) {\n            if (value === this.isHeaderIn) {\n                return;\n            }\n            this.isHeaderIn = value;\n            this.notifyPropertyChanged('isHeader');\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(SelectionRowFormat.prototype, \"allowBreakAcrossPages\", {\n        /**\n         * Gets or Sets a value indicating whether to allow break across pages for selected rows.\n         * @default undefined\n         */\n        get: function () {\n            return this.allowRowBreakAcrossPagesIn;\n        },\n        set: function (value) {\n            if (value === this.allowRowBreakAcrossPagesIn) {\n                return;\n            }\n            this.allowRowBreakAcrossPagesIn = value;\n            this.notifyPropertyChanged('allowBreakAcrossPages');\n        },\n        enumerable: true,\n        configurable: true\n    });\n    SelectionRowFormat.prototype.notifyPropertyChanged = function (propertyName) {\n        var selection = this.selection;\n        if (!isNullOrUndefined(selection) && (selection.isCleared || selection.owner.isReadOnlyMode\n            || !selection.owner.isDocumentLoaded || selection.owner.isPastingContent) && !selection.isRetrieveFormatting) {\n            return;\n        }\n        if (!isNullOrUndefined(selection) && !isNullOrUndefined(selection.start) && !selection.isRetrieveFormatting) {\n            var value = this.getPropertyValue(propertyName);\n            if (!isNullOrUndefined(value)) {\n                selection.owner.editorModule.onApplyTableRowFormat(propertyName, value);\n            }\n        }\n    };\n    SelectionRowFormat.prototype.getPropertyValue = function (propertyName) {\n        switch (propertyName) {\n            case 'height':\n                return this.height;\n            case 'heightType':\n                return this.heightType;\n            case 'isHeader':\n                return this.isHeader;\n            case 'allowBreakAcrossPages':\n                return this.allowBreakAcrossPages;\n            default:\n                return undefined;\n        }\n    };\n    /**\n     * Copies the format.\n     * @param  {WRowFormat} format\n     * @returns void\n     * @private\n     */\n    SelectionRowFormat.prototype.copyFormat = function (format) {\n        this.height = format.height;\n        this.heightType = format.heightType;\n        this.allowBreakAcrossPages = format.allowBreakAcrossPages;\n        this.isHeader = format.isHeader;\n    };\n    /**\n     * Combines the format.\n     * @param  {WRowFormat} format\n     * @private\n     */\n    SelectionRowFormat.prototype.combineFormat = function (format) {\n        if (!isNullOrUndefined(this.height) && this.height !== format.height) {\n            this.height = undefined;\n        }\n        if (!isNullOrUndefined(this.heightType) && this.heightType !== format.heightType) {\n            this.heightType = undefined;\n        }\n        if (!isNullOrUndefined(this.allowBreakAcrossPages) && this.allowBreakAcrossPages !== format.allowBreakAcrossPages) {\n            this.allowBreakAcrossPages = undefined;\n        }\n        if (!isNullOrUndefined(this.isHeader) && this.isHeader !== format.isHeader) {\n            this.isHeader = undefined;\n        }\n    };\n    /**\n     * Clears the row format.\n     * @returns void\n     * @private\n     */\n    SelectionRowFormat.prototype.clearRowFormat = function () {\n        this.height = undefined;\n        this.heightType = undefined;\n        this.allowBreakAcrossPages = undefined;\n        this.isHeader = undefined;\n    };\n    /**\n     * Clears the format.\n     * @returns void\n     * @private\n     */\n    SelectionRowFormat.prototype.clearFormat = function () {\n        this.height = 0;\n        this.heightType = undefined;\n        this.allowBreakAcrossPages = undefined;\n        this.isHeader = undefined;\n    };\n    /**\n     * Destroys the managed resources.\n     * @returns void\n     * @private\n     */\n    SelectionRowFormat.prototype.destroy = function () {\n        this.heightIn = undefined;\n        this.heightTypeIn = undefined;\n        this.allowRowBreakAcrossPagesIn = undefined;\n        this.isHeaderIn = undefined;\n        this.selection = undefined;\n    };\n    return SelectionRowFormat;\n}());\nexport { SelectionRowFormat };\n/**\n * Selection image format implementation\n */\nvar SelectionImageFormat = /** @class */ (function () {\n    /**\n     * @private\n     */\n    function SelectionImageFormat(selection) {\n        this.selection = selection;\n    }\n    Object.defineProperty(SelectionImageFormat.prototype, \"width\", {\n        /**\n         * Gets the width of the image.\n         */\n        get: function () {\n            if (this.image) {\n                return this.image.width;\n            }\n            return 0;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(SelectionImageFormat.prototype, \"height\", {\n        /**\n         * Gets the height of the image.\n         */\n        get: function () {\n            if (this.image) {\n                return this.image.height;\n            }\n            return 0;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    /**\n     * Resizes the image based on given size.\n     * @param width\n     * @param height\n     */\n    SelectionImageFormat.prototype.resize = function (width, height) {\n        this.updateImageFormat(width, height);\n    };\n    /**\n     * Update image width and height\n     * @private\n     */\n    SelectionImageFormat.prototype.updateImageFormat = function (width, height) {\n        if (this.image) {\n            if (this.selection.owner.editorModule) {\n                this.selection.owner.editorModule.onImageFormat(this.image, width, height);\n            }\n        }\n    };\n    /**\n     * @private\n     */\n    SelectionImageFormat.prototype.copyImageFormat = function (image) {\n        this.image = image;\n    };\n    /**\n     * @private\n     */\n    SelectionImageFormat.prototype.clearImageFormat = function () {\n        this.image = undefined;\n    };\n    return SelectionImageFormat;\n}());\nexport { SelectionImageFormat };\n/* tslint:enable */ \n","import { isNullOrUndefined } from '@syncfusion/ej2-base';\nimport { HelperMethods } from '../editor/editor-helper';\n/**\n * @private\n */\nvar HtmlExport = /** @class */ (function () {\n    function HtmlExport() {\n        /* tslint:disable:no-any */\n        this.document = undefined;\n        /* tslint:disable:no-any */\n        /**\n         * @private\n         */\n        this.fieldCheck = 0;\n        /* tslint:enable:no-any */\n    }\n    /* tslint:disable:no-any */\n    /**\n     * @private\n     */\n    HtmlExport.prototype.writeHtml = function (document) {\n        this.document = document;\n        var html = '';\n        for (var i = 0; i < document.sections.length; i++) {\n            html = this.serializeSection(document.sections[i]);\n        }\n        return html;\n    };\n    /**\n     * @private\n     */\n    HtmlExport.prototype.serializeSection = function (section) {\n        var string = '';\n        for (var i = 0; i < section.blocks.length; i++) {\n            var block = section.blocks[i];\n            if (block.hasOwnProperty('inlines')) {\n                string += this.serializeParagraph(block);\n            }\n            else {\n                string += this.serializeTable(block);\n            }\n        }\n        return string;\n    };\n    // Serialize Paragraph \n    /**\n     * @private\n     */\n    HtmlExport.prototype.serializeParagraph = function (paragraph) {\n        var blockStyle = '';\n        var startString = undefined;\n        var isList = false;\n        var tagAttributes = [];\n        tagAttributes.push('style=\"' + this.serializeParagraphStyle(paragraph, '', isList) + '\"');\n        blockStyle += this.createAttributesTag('p', tagAttributes);\n        if (paragraph.inlines.length === 0) {\n            //Handled to preserve non breaking space for empty paragraphs similar to MS Word behavior.\n            blockStyle += '&nbsp;';\n        }\n        else {\n            blockStyle = this.serializeInlines(paragraph, blockStyle);\n        }\n        blockStyle += this.endTag('p');\n        return blockStyle;\n    };\n    //SerializeInlines\n    /**\n     * @private\n     */\n    HtmlExport.prototype.serializeInlines = function (paragraph, blockStyle) {\n        var inline = undefined;\n        var i = 0;\n        while (paragraph.inlines.length > i) {\n            inline = paragraph.inlines[i];\n            if (inline.hasOwnProperty('imageString')) {\n                blockStyle += this.serializeImageContainer(inline);\n            }\n            else if (inline.hasOwnProperty('fieldType')) {\n                if (inline.fieldType === 0) {\n                    this.fieldCheck = 1;\n                    var tagAttributes = [];\n                    tagAttributes.push('style=\"' + this.serializeInlineStyle(inline.characterFormat, '') + '\"');\n                    blockStyle += this.createAttributesTag('a', tagAttributes);\n                }\n                else if (inline.fieldType === 2) {\n                    this.fieldCheck = 2;\n                }\n                else {\n                    blockStyle += this.endTag('a');\n                    this.fieldCheck = 0;\n                }\n            }\n            else {\n                var text = isNullOrUndefined(inline.text) ? '' : inline.text;\n                if (this.fieldCheck === 0) {\n                    blockStyle += this.serializeSpan(text, inline.characterFormat);\n                }\n                if (this.fieldCheck === 1) {\n                    var hyperLink = text.replace('\\\"', '');\n                    blockStyle += ' href= \\\"' + hyperLink.replace('HYPERLINK', '').trim();\n                    blockStyle += '\\\"';\n                    blockStyle += '>';\n                }\n                if (this.fieldCheck === 2) {\n                    blockStyle += text;\n                }\n            }\n            i++;\n        }\n        return blockStyle;\n    };\n    // Serialize Span\n    /**\n     * @private\n     */\n    HtmlExport.prototype.serializeSpan = function (spanText, characterFormat) {\n        var spanClass = '';\n        if (spanText.indexOf('\\v') !== -1) {\n            spanClass += '<br>';\n            return spanClass.toString();\n        }\n        var tagAttributes = [];\n        this.serializeInlineStyle(characterFormat, '');\n        tagAttributes.push('style=\"' + this.serializeInlineStyle(characterFormat, '') + '\"');\n        spanClass += this.createAttributesTag('span', tagAttributes);\n        var ignoreFirstSpace = false;\n        // Todo: Need to handle it.\n        // If the text starts with white-space, need to check whether it is a continuous space.\n        // if (characterFormat.ownerBase instanceof WInline) {\n        //     let inline: WInline = (characterFormat.ownerBase as WInline);\n        //     tslint:disable:max-line-length            \n        //     if (inline instanceof WSpan && !isNullOrUndefined(inline.text) && inline.text !== '' && (inline as WSpan).text[0] === ' ') {\n        //         Check previous inline until, it has valid rendered text.\n        //         do {\n        //             inline = WInline.getPreviousTextInline((inline as WSpan));\n        //         } while (inline instanceof WSpan && !isNullOrUndefined(inline.text));\n        //     } else {\n        //         inline = undefined;\n        //     }\n        //     If current white-space is a continuation of consecutive spaces, this will be set true.\n        //     ignoreFirstSpace = inline instanceof WSpan && !isNullOrUndefined(inline.text)\n        //         && (inline as WSpan).text[(inline as WSpan).text.length - 1] === ' ';\n        // }\n        var text = this.decodeHtmlNames(spanText.toString());\n        spanClass += text;\n        spanClass += this.endTag('span');\n        return spanClass.toString();\n    };\n    //Serialize Image\n    /**\n     * @private\n     */\n    HtmlExport.prototype.serializeImageContainer = function (image) {\n        var imageStyle = '';\n        var tagAttributes = [];\n        this.serializeInlineStyle(image.characterFormat, '');\n        var imageSource = '';\n        if (!isNullOrUndefined(image.imageString)) {\n            imageSource = image.imageString;\n        }\n        var width = HelperMethods.convertPointToPixel(image.width);\n        var height = HelperMethods.convertPointToPixel(image.height);\n        tagAttributes.push('width=\"', width.toString() + '\"');\n        tagAttributes.push('height=\"', height.toString() + '\"');\n        tagAttributes.push('src=\"', imageSource + '\"');\n        imageStyle += this.createAttributesTag('img', tagAttributes);\n        imageStyle += (this.endTag('img'));\n        return imageStyle.toString();\n    };\n    // Serialize Table Cell\n    /**\n     * @private\n     */\n    HtmlExport.prototype.serializeCell = function (cell) {\n        var blockStyle = '';\n        var tagAttributes = [];\n        var cellHtml = '';\n        tagAttributes = [];\n        if (!isNullOrUndefined(cell.cellFormat)) {\n            //if (cell.cellFormat.shading.backgroundColor !== Color.FromArgb(0, 0, 0, 0)) {\n            tagAttributes.push('bgcolor=\"' + cell.cellFormat.shading.backgroundColor + '\"');\n            // }\n            if (cell.cellFormat.columnSpan > 1) {\n                tagAttributes.push('colspan=\"' + cell.cellFormat.columnSpan.toString() + '\"');\n            }\n            if (cell.cellFormat.rowSpan > 1) {\n                tagAttributes.push('rowspan=\"' + cell.cellFormat.rowSpan.toString() + '\"');\n            }\n            if (cell.cellFormat.cellWidth !== 0) {\n                tagAttributes.push('width=\"' + cell.cellFormat.cellWidth.toString() + '\"');\n            }\n            if (cell.cellFormat.verticalAlignment !== 'Top') {\n                tagAttributes.push('valign=\"' + cell.cellFormat.verticalAlignment.toString().toLowerCase() + '\"');\n            }\n            if (!isNullOrUndefined(cell.cellFormat.leftMargin) && cell.cellFormat.leftMargin !== 0) {\n                cellHtml += ('padding-left:' + cell.cellFormat.leftMargin.toString() + 'pt;');\n            }\n            if (!isNullOrUndefined(cell.cellFormat.rightMargin) && cell.cellFormat.rightMargin !== 0) {\n                cellHtml += ('padding-right:' + cell.cellFormat.rightMargin.toString() + 'pt;');\n            }\n            if (!isNullOrUndefined(cell.cellFormat.topMargin) && cell.cellFormat.topMargin !== 0) {\n                cellHtml += ('padding-top:' + cell.cellFormat.topMargin.toString() + 'pt;');\n            }\n            if (!isNullOrUndefined(cell.cellFormat.bottomMargin) && cell.cellFormat.bottomMargin !== 0) {\n                cellHtml += ('padding-bottom:' + cell.cellFormat.bottomMargin.toString() + 'pt;');\n            }\n            if (!isNullOrUndefined(cell.cellFormat.borders)) {\n                cellHtml += this.serializeCellBordersStyle(cell.cellFormat.borders);\n            }\n        }\n        if (cellHtml.length !== 0) {\n            tagAttributes.push('style=\"' + cellHtml + '\"');\n        }\n        blockStyle += (this.createAttributesTag('td', tagAttributes));\n        for (var k = 0; k < cell.blocks.length; k++) {\n            var block = cell.blocks[k];\n            if (block.hasOwnProperty('rows')) {\n                blockStyle += this.serializeTable(block);\n            }\n            else {\n                blockStyle += this.serializeParagraph(block);\n            }\n        }\n        blockStyle += (this.endTag('td'));\n        return blockStyle;\n    };\n    // Serialize Table\n    /**\n     * @private\n     */\n    HtmlExport.prototype.serializeTable = function (table) {\n        var html = '';\n        html += this.createTableStartTag(table);\n        for (var j = 0; j < table.rows.length; j++) {\n            html += this.serializeRow(table.rows[j]);\n        }\n        html += this.createTableEndTag();\n        return html;\n    };\n    // Serialize Row\n    /**\n     * @private\n     */\n    HtmlExport.prototype.serializeRow = function (row) {\n        var html = '';\n        html += this.createRowStartTag(row);\n        for (var k = 0; k < row.cells.length; k++) {\n            html += this.serializeCell(row.cells[k]);\n        }\n        return html;\n    };\n    // Serialize Styles\n    /**\n     * @private\n     */\n    HtmlExport.prototype.serializeParagraphStyle = function (paragraph, className, isList) {\n        var paragraphClass = '';\n        paragraphClass += this.serializeCharacterFormat(paragraph.characterFormat);\n        paragraphClass += this.serializeParagraphFormat(paragraph.paragraphFormat, isList);\n        return paragraphClass;\n    };\n    /**\n     * @private\n     */\n    HtmlExport.prototype.serializeInlineStyle = function (characterFormat, className) {\n        return this.serializeCharacterFormat(characterFormat);\n    };\n    /**\n     * @private\n     */\n    HtmlExport.prototype.serializeTableBorderStyle = function (borders) {\n        var borderStyle = '';\n        borderStyle += ('border-left-style:' + this.convertBorderLineStyle(borders.left.lineStyle));\n        borderStyle += ';';\n        borderStyle += ('border-left-width:' + borders.left.lineWidth.toString() + 'pt');\n        borderStyle += ';';\n        borderStyle += ('border-left-color:' + borders.left.color);\n        borderStyle += ';';\n        borderStyle += ('border-right-style:' + this.convertBorderLineStyle(borders.right.lineStyle));\n        borderStyle += ';';\n        borderStyle += ('border-right-width:' + borders.right.lineWidth.toString() + 'pt');\n        borderStyle += ';';\n        borderStyle += ('border-right-color:' + borders.right.color);\n        borderStyle += ';';\n        borderStyle += ('border-top-style:' + this.convertBorderLineStyle(borders.top.lineStyle));\n        borderStyle += ';';\n        borderStyle += ('border-top-width:' + borders.top.lineWidth.toString() + 'pt');\n        borderStyle += ';';\n        borderStyle += ('border-top-color:' + borders.top.color);\n        borderStyle += ';';\n        borderStyle += ('border-Bottom-style:' + this.convertBorderLineStyle(borders.bottom.lineStyle));\n        borderStyle += ';';\n        borderStyle += ('border-Bottom-width:' + borders.bottom.lineWidth.toString() + 'pt');\n        borderStyle += ';';\n        borderStyle += ('border-Bottom-color:' + borders.bottom.color);\n        borderStyle += ';';\n        return borderStyle;\n    };\n    /**\n     * @private\n     */\n    HtmlExport.prototype.serializeCellBordersStyle = function (borders) {\n        var borderStyle = '';\n        borderStyle = 'border:solid 1px;';\n        // Todo: handle\n        // let border: WBorder = undefined;\n        // //LeftBorder\n        // border = WCell.getCellLeftBorder(WCell.getCellOf(borders));\n        // if (!isNullOrUndefined(border) && border.lineStyle !== 'None') {\n        //     borderStyle += this.serializeBorderStyle(border, 'left');\n        // } else if (!isNullOrUndefined(border) && border.hasNoneStyle) {\n        //     borderStyle += ('border-left-style:none;');\n        // }\n        // //RightBorder\n        // border = WCell.getCellRightBorder(WCell.getCellOf(borders));\n        // if (!isNullOrUndefined(border) && border.lineStyle !== 'None') {\n        //     borderStyle += this.serializeBorderStyle(border, 'right');\n        // } else if (!isNullOrUndefined(border) && border.hasNoneStyle) {\n        //     borderStyle += ('border-right-style:none');\n        // }\n        // //TopBorder\n        // border = WCell.getCellTopBorder(WCell.getCellOf(borders));\n        // if (!isNullOrUndefined(border) && border.lineStyle !== 'None') {\n        //     borderStyle += this.serializeBorderStyle(border, 'top');\n        // } else if (!isNullOrUndefined(border) && border.hasNoneStyle) {\n        //     borderStyle += ('border-top-style:none');\n        // }\n        // //BottomBorder\n        // border = WCell.getCellBottomBorder(WCell.getCellOf(borders));\n        // if (!isNullOrUndefined(border) && border.lineStyle !== 'None') {\n        //     borderStyle += this.serializeBorderStyle(border, 'bottom');\n        // } else if (!isNullOrUndefined(border) && border.hasNoneStyle) {\n        //     borderStyle += ('border-bottom-style:none');\n        // }\n        return borderStyle;\n    };\n    /**\n     * @private\n     */\n    HtmlExport.prototype.serializeBorderStyle = function (border, borderPosition) {\n        var borderStyle = '';\n        borderStyle += ('border-' + borderPosition + '-style:' + this.convertBorderLineStyle(border.lineStyle));\n        borderStyle += ';';\n        if (border.lineWidth > 0) {\n            borderStyle += ('border-' + borderPosition + '-width:' + border.lineWidth.toString() + 'pt;');\n        }\n        //if (border.color !== Color.FromArgb(0, 0, 0, 0))\n        borderStyle += ('border-' + borderPosition + '-color:' + border.color + ';');\n        return borderStyle;\n    };\n    /**\n     * @private\n     */\n    HtmlExport.prototype.convertBorderLineStyle = function (lineStyle) {\n        switch (lineStyle) {\n            case 'None':\n                return 'none';\n            case 'Single':\n                return 'solid';\n            case 'Dot':\n                return 'dotted';\n            case 'DashSmallGap':\n            case 'DashLargeGap':\n            case 'DashDot':\n            case 'DashDotDot':\n                return 'dashed';\n            case 'Double':\n            case 'Triple':\n            case 'ThinThickSmallGap':\n            case 'ThickThinSmallGap':\n            case 'ThinThickThinSmallGap':\n            case 'ThinThickMediumGap':\n            case 'ThickThinMediumGap':\n            case 'ThinThickThinMediumGap':\n            case 'ThinThickLargeGap':\n            case 'ThickThinLargeGap':\n            case 'ThinThickThinLargeGap':\n                return 'double';\n            case 'SingleWavy':\n                return 'solid';\n            case 'DoubleWavy':\n                return 'double';\n            case 'DashDotStroked':\n                return 'solid';\n            case 'Emboss3D':\n                return 'ridge';\n            case 'Engrave3D':\n                return 'groove';\n            case 'Outset':\n                return 'outset';\n            case 'Inset':\n                return 'inset';\n            default:\n                return 'solid';\n        }\n    };\n    // Serialize Format\n    /**\n     * @private\n     */\n    HtmlExport.prototype.serializeCharacterFormat = function (characterFormat) {\n        if (!isNullOrUndefined(characterFormat.inlineFormat)) {\n            return this.serializeCharacterFormat(characterFormat.inlineFormat);\n        }\n        var propertyValue;\n        var charStyle = '';\n        if (characterFormat.bold) {\n            charStyle += 'font-weight';\n            charStyle += ':';\n            charStyle += 'bold';\n            charStyle += ';';\n        }\n        charStyle += 'font-style';\n        charStyle += ':';\n        if (characterFormat.italic) {\n            charStyle += 'italic';\n        }\n        else {\n            charStyle += 'normal';\n        }\n        charStyle += ';';\n        // Double strike through will become Single strike through while saving HTML using MS Word.\n        if (characterFormat.strikethrough === 'SingleStrike' || characterFormat.strikethrough === 'DoubleStrike') {\n            charStyle += 'text-decoration';\n            charStyle += ':';\n            charStyle += 'line-through';\n            charStyle += ';';\n        }\n        //Text Baseline Alignment\n        // tslint:disable-next-line:max-line-length\n        if (characterFormat.baselineAlignment === 'Superscript' || characterFormat.baselineAlignment === 'Subscript') {\n            charStyle += 'vertical-align';\n            charStyle += ':';\n            charStyle += characterFormat.baselineAlignment === 'Superscript' ? 'super' : 'sub';\n            charStyle += ';';\n        }\n        //Text Foreground and Background Color \n        if (!isNullOrUndefined(characterFormat.highlightColor)) {\n            charStyle += 'background-color';\n            charStyle += ':';\n            charStyle += characterFormat.highlightColor.toString();\n            charStyle += ';';\n        }\n        //Font Color\n        propertyValue = characterFormat.fontColor;\n        if (!isNullOrUndefined(propertyValue)) {\n            charStyle += 'color';\n            charStyle += ':';\n            charStyle += propertyValue;\n            charStyle += ';';\n        }\n        if (!isNullOrUndefined(characterFormat.underline) && characterFormat.underline !== 'None') {\n            charStyle += 'text-decoration';\n            charStyle += ':';\n            charStyle += 'underline';\n            charStyle += ';';\n        }\n        propertyValue = characterFormat.fontSize;\n        if (!isNullOrUndefined(propertyValue)) {\n            charStyle += 'font-size';\n            charStyle += ':';\n            charStyle += propertyValue.toString();\n            charStyle += 'pt';\n            charStyle += ';';\n        }\n        propertyValue = characterFormat.fontFamily;\n        if (!isNullOrUndefined(propertyValue)) {\n            charStyle += 'font-family';\n            charStyle += ':';\n            charStyle += propertyValue.toString();\n            charStyle += ';';\n        }\n        return charStyle.toString();\n    };\n    /**\n     * @private\n     */\n    HtmlExport.prototype.serializeParagraphFormat = function (paragraphFormat, isList) {\n        if (!isNullOrUndefined(paragraphFormat.inlineFormat)) {\n            return this.serializeParagraphFormat(paragraphFormat.inlineFormat, isList);\n        }\n        var propertyValue;\n        var paraStyle = '';\n        propertyValue = paragraphFormat.textAlignment;\n        if (!isNullOrUndefined(propertyValue)) {\n            paraStyle += 'text-align:' + propertyValue.toLowerCase() + ';';\n        }\n        propertyValue = paragraphFormat.beforeSpacing;\n        if (!isNullOrUndefined(propertyValue)) {\n            paraStyle += 'margin-top:' + propertyValue.toString() + 'pt; ';\n        }\n        propertyValue = paragraphFormat.rightIndent;\n        if (!isNullOrUndefined(propertyValue)) {\n            paraStyle += 'margin-right:' + propertyValue.toString() + 'pt; ';\n        }\n        propertyValue = paragraphFormat.afterSpacing;\n        if (!isNullOrUndefined(propertyValue)) {\n            paraStyle += 'margin-bottom:' + propertyValue.toString() + 'pt; ';\n        }\n        propertyValue = paragraphFormat.leftIndent;\n        if (isList) {\n            if (isNullOrUndefined(propertyValue)) {\n                propertyValue = -48;\n            }\n            else {\n                propertyValue -= 48;\n            }\n        }\n        if (!isNullOrUndefined(propertyValue)) {\n            paraStyle += 'margin-left:' + propertyValue.toString() + 'pt; ';\n        }\n        propertyValue = paragraphFormat.firstLineIndent;\n        if (isList) {\n            if (isNullOrUndefined(propertyValue)) {\n                propertyValue = 24;\n            }\n            else {\n                propertyValue += 24;\n            }\n        }\n        if (!isNullOrUndefined(propertyValue) && propertyValue !== 0) {\n            paraStyle += 'text-indent:' + propertyValue.toString() + 'pt;';\n        }\n        propertyValue = paragraphFormat.lineSpacing;\n        if (!isNullOrUndefined(propertyValue)) {\n            if (paragraphFormat.lineSpacingType === 'Multiple') {\n                propertyValue = (propertyValue * 100).toString() + '%;';\n            }\n            else {\n                propertyValue = propertyValue.toString() + 'pt;';\n            }\n            paraStyle += 'line-height:' + propertyValue;\n        }\n        return paraStyle.toString();\n    };\n    /**\n     * @private\n     */\n    HtmlExport.prototype.createAttributesTag = function (tagValue, localProperties) {\n        var sb = '';\n        sb += '<';\n        sb += tagValue;\n        for (var i = 0; i < localProperties.length; i++) {\n            sb += ' ';\n            sb += localProperties[i];\n        }\n        if (tagValue !== 'a') {\n            sb += '>';\n        }\n        return sb;\n    };\n    /**\n     * @private\n     */\n    HtmlExport.prototype.createTag = function (tagValue) {\n        var s = '';\n        s += '<';\n        s += tagValue;\n        s += '>';\n        return s;\n    };\n    /**\n     * @private\n     */\n    HtmlExport.prototype.endTag = function (tagValue) {\n        var sb = '';\n        sb += '<';\n        sb += '/';\n        sb += tagValue;\n        sb += '>';\n        return sb;\n    };\n    /**\n     * @private\n     */\n    HtmlExport.prototype.createTableStartTag = function (table) {\n        var blockStyle = '';\n        var tableStyle = '';\n        var tagAttributes = [];\n        tagAttributes.push('border=\"' + '1\"');\n        if (!isNullOrUndefined(table.tableFormat)) {\n            //if (table.tableFormat.shading.backgroundColor !== Color.FromArgb(0, 0, 0, 0)) {\n            tagAttributes.push('bgcolor=\"' + table.tableFormat.shading.backgroundColor + '\"');\n            //}\n            if (table.tableFormat.leftIndent !== 0) {\n                tagAttributes.push('left-indent=\"' + table.tableFormat.leftIndent.toString() + 'pt;');\n            }\n            if (table.tableFormat.cellSpacing > 0) {\n                tagAttributes.push('cellspacing=\"' + (((table.tableFormat.cellSpacing * 72) / 96) * 2).toString() + '\"');\n            }\n            else {\n                tableStyle += ('border-collapse:collapse;');\n            }\n            tagAttributes.push('cellpadding=\"' + '0\"');\n            if (!isNullOrUndefined(table.tableFormat.borders)) {\n                tableStyle += this.serializeTableBorderStyle(table.tableFormat.borders);\n            }\n        }\n        if (tableStyle.length !== 0) {\n            tagAttributes.push('style=\"', tableStyle.toString() + '\"');\n        }\n        return blockStyle += (this.createAttributesTag('table', tagAttributes));\n    };\n    /**\n     * @private\n     */\n    HtmlExport.prototype.createTableEndTag = function () {\n        var blockStyle = '';\n        blockStyle += (this.endTag('table'));\n        return blockStyle;\n    };\n    /**\n     * @private\n     */\n    HtmlExport.prototype.createRowStartTag = function (row) {\n        var blockStyle = '';\n        var tagAttributes = [];\n        if (row.rowFormat.isHeader) {\n            blockStyle += (this.createTag('thead'));\n        }\n        if (row.rowFormat.height > 0) {\n            tagAttributes.push('height=\"' + row.rowFormat.height + '\"');\n        }\n        return blockStyle + this.createAttributesTag('tr', tagAttributes);\n    };\n    /**\n     * @private\n     */\n    HtmlExport.prototype.createRowEndTag = function (row) {\n        var blockStyle = '';\n        blockStyle += (this.endTag('tr'));\n        if (row.rowFormat.isHeader) {\n            blockStyle += (this.endTag('thead'));\n        }\n        return blockStyle;\n    };\n    /**\n     * @private\n     */\n    HtmlExport.prototype.decodeHtmlNames = function (text) {\n        if (text === '\\t') {\n            return '&emsp;';\n        }\n        var splittedText = text.split(' ');\n        var htmlText = '';\n        if (splittedText.length > 0) {\n            htmlText = splittedText[0];\n            for (var i = 0; i < splittedText.length - 1; i++) {\n                htmlText += '&nbsp;' + splittedText[i + 1];\n            }\n        }\n        return htmlText;\n    };\n    return HtmlExport;\n}());\nexport { HtmlExport };\n","import { Widget, TableRowWidget, TableWidget, LineWidget, ElementBox, TextElementBox, ListTextElementBox, ImageElementBox, ParagraphWidget, TableCellWidget, FieldElementBox, BlockContainer, BookmarkElementBox } from '../index';\nimport { HelperMethods } from '../index';\nimport { Point } from '../index';\nimport { isNullOrUndefined } from '@syncfusion/ej2-base';\n/**\n * @private\n */\nvar TextPosition = /** @class */ (function () {\n    function TextPosition(owner) {\n        /**\n         * @private\n         */\n        this.location = new Point(0, 0);\n        /**\n         * @private\n         */\n        this.isUpdateLocation = true;\n        this.owner = owner;\n        this.viewer = this.owner.viewer;\n    }\n    Object.defineProperty(TextPosition.prototype, \"paragraph\", {\n        /**\n         * @private\n         */\n        get: function () {\n            return this.currentWidget.paragraph;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(TextPosition.prototype, \"isAtParagraphStart\", {\n        /**\n         * @private\n         */\n        get: function () {\n            return this.offset === this.owner.selection.getStartOffset(this.paragraph);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(TextPosition.prototype, \"isAtParagraphEnd\", {\n        /**\n         * @private\n         */\n        get: function () {\n            return this.owner.selection.isParagraphLastLine(this.currentWidget)\n                && this.offset === this.owner.selection.getLineLength(this.currentWidget);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(TextPosition.prototype, \"selection\", {\n        /**\n         * @private\n         */\n        get: function () {\n            return this.owner.selection;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(TextPosition.prototype, \"hierarchicalPosition\", {\n        /**\n         * Gets the hierarchical position of logical text position in the document\n         * @returns {string}\n         */\n        get: function () {\n            return this.getHierarchicalIndexInternal();\n        },\n        enumerable: true,\n        configurable: true\n    });\n    /**\n     * Return clone of current text position\n     * @private\n     */\n    TextPosition.prototype.clone = function () {\n        var textPosition = new TextPosition(this.owner);\n        textPosition.currentWidget = this.currentWidget;\n        textPosition.offset = this.offset;\n        textPosition.location = this.location;\n        return textPosition;\n    };\n    /**\n     * Set text position for paragraph and inline\n     * @private\n     */\n    TextPosition.prototype.setPositionForSelection = function (line, element, index, physicalLocation) {\n        //Set the start end position\n        var isParagraphEnd = false;\n        if (isNullOrUndefined(element)) {\n            this.currentWidget = line;\n        }\n        else {\n            this.currentWidget = element.line;\n            if (element.nextNode instanceof FieldElementBox && index > element.length) {\n                isParagraphEnd = this.selection.isLastRenderedInline(element, element.length);\n            }\n        }\n        this.location = physicalLocation;\n        if (isParagraphEnd) {\n            this.offset = this.selection.getParagraphLength(this.currentWidget.paragraph) + 1;\n        }\n        else {\n            this.offset = this.currentWidget.getOffset(element, index);\n        }\n    };\n    /**\n     * Set text position\n     * @private\n     */\n    TextPosition.prototype.setPositionFromLine = function (line, offset, location) {\n        this.currentWidget = line;\n        this.offset = offset;\n        if (location instanceof Point) {\n            this.location.copy(location);\n        }\n    };\n    /**\n     * Set text position\n     * @private\n     */\n    TextPosition.prototype.setPosition = function (line, positionAtStart) {\n        this.currentWidget = line;\n        this.offset = positionAtStart ? this.selection.getStartOffset(line.paragraph)\n            : this.selection.getParagraphLength(line.paragraph) + 1;\n        this.updatePhysicalPosition(true);\n    };\n    /**\n     * Set position for text position\n     * @private\n     */\n    TextPosition.prototype.setPositionInternal = function (textPosition) {\n        this.currentWidget = textPosition.currentWidget;\n        this.offset = textPosition.offset;\n        this.location = textPosition.location;\n    };\n    /**\n     * Set position for current index\n     * @private\n     */\n    TextPosition.prototype.setPositionForCurrentIndex = function (hierarchicalIndex) {\n        var index = { index: hierarchicalIndex };\n        var paragraph = this.getParagraphWidget(index); //ref hierarchicalIndex\n        this.offset = parseFloat(index.index);\n        this.setPositionParagraph(paragraph, this.offset);\n    };\n    /**\n     * Get Page\n     */\n    TextPosition.prototype.getPage = function (position) {\n        var page;\n        var index = position.index.indexOf(';');\n        var newValue = '0';\n        if (index >= 0) {\n            newValue = position.index.substring(0, index);\n            position.index = position.index.substring(index).replace(';', '');\n        }\n        index = parseInt(newValue, 10);\n        page = this.viewer.pages[index];\n        return page;\n    };\n    /**\n     * @private\n     */\n    TextPosition.prototype.getParagraphWidget = function (position) {\n        if (isNullOrUndefined(position.index)) {\n            return undefined;\n        }\n        var page = this.getPage(position);\n        var child = this.getLineWidget(undefined, position, page);\n        return child;\n    };\n    /**\n     * @private\n     */\n    TextPosition.prototype.getLineWidget = function (widget, position, page) {\n        if (isNullOrUndefined(position.index)) {\n            return undefined;\n        }\n        var index = position.index.indexOf(';');\n        var value = '0';\n        if (index >= 0) {\n            value = position.index.substring(0, index);\n            position.index = position.index.substring(index).replace(';', '');\n        }\n        if (value === 'H' || value === 'F') {\n            if (value === 'H') {\n                widget = page.headerWidget;\n            }\n            else {\n                widget = page.footerWidget;\n            }\n        }\n        else if (!isNullOrUndefined(page)) {\n            widget = page.bodyWidgets[0];\n        }\n        index = parseInt(value, 10);\n        if (widget instanceof BlockContainer) {\n            index = position.index.indexOf(';');\n            value = '0';\n            value = position.index.substring(0, index);\n            position.index = position.index.substring(index).replace(';', '');\n            index = parseInt(value, 10);\n        }\n        if (widget instanceof TableRowWidget && index >= widget.childWidgets.length) {\n            position.index = '0;0';\n            index = widget.childWidgets.length - 1;\n        }\n        if (index >= 0 && index < widget.childWidgets.length) {\n            var child = widget.childWidgets[index];\n            if (child instanceof LineWidget) {\n                if (position.index.indexOf(';') > 0) {\n                    position.index = '0';\n                }\n                return child;\n            }\n            if (child instanceof Widget) {\n                if (position.index.indexOf(';') > 0) {\n                    return this.getLineWidget(child, position);\n                }\n                else {\n                    //If table is shifted to previous text position then return the first paragraph within table.\n                    if (child instanceof TableWidget) {\n                        return this.getLineWidget(this.selection.getFirstParagraphInFirstCell(child), position);\n                    }\n                    else if (child instanceof TableRowWidget && position.index.indexOf(';') === -1) {\n                        return this.selection.getFirstParagraphInFirstCell(child.ownerTable).childWidgets[0];\n                    }\n                    return undefined;\n                }\n            }\n        }\n        else if (widget.nextRenderedWidget instanceof Widget) {\n            position.index = '0';\n            if (widget.nextRenderedWidget instanceof TableWidget) {\n                return this.selection.getFirstParagraphInFirstCell(widget.nextRenderedWidget).firstChild;\n            }\n            return this.getLineWidget(widget.nextRenderedWidget, position);\n        }\n        return undefined;\n    };\n    /**\n     * Update physical location of paragraph\n     * @private\n     */\n    TextPosition.prototype.updatePhysicalPosition = function (moveNextLine) {\n        if (this.currentWidget && this.owner.isLayoutEnabled && this.isUpdateLocation) {\n            this.location = this.selection.getPhysicalPositionInternal(this.currentWidget, this.offset, moveNextLine);\n        }\n    };\n    /**\n     * Return true if text position are in same paragraph and offset\n     * @private\n     */\n    TextPosition.prototype.isAtSamePosition = function (textPosition) {\n        return this.currentWidget === textPosition.currentWidget\n            && this.offset === textPosition.offset;\n    };\n    /**\n     * Return true if text position is in same paragraph\n     * @private\n     */\n    TextPosition.prototype.isInSameParagraph = function (textPosition) {\n        if (isNullOrUndefined(textPosition)) {\n            throw new Error('textPosition is undefined.');\n        }\n        return this.paragraph === textPosition.paragraph;\n    };\n    /**\n     * Return true is current text position exist before given text position\n     * @private\n     */\n    TextPosition.prototype.isExistBefore = function (textPosition) {\n        if (isNullOrUndefined(textPosition)) {\n            throw new Error('textPosition is undefined.');\n        }\n        if (this.currentWidget === textPosition.currentWidget) {\n            return this.offset < textPosition.offset;\n        }\n        var currentParagraph = this.currentWidget.paragraph;\n        var paragraph = textPosition.currentWidget.paragraph;\n        if (currentParagraph === paragraph) {\n            return currentParagraph.childWidgets.indexOf(this.currentWidget) < paragraph.childWidgets.indexOf(textPosition.currentWidget);\n        }\n        if (currentParagraph.containerWidget === paragraph.containerWidget) {\n            if (currentParagraph.isInsideTable) {\n                return currentParagraph.associatedCell.childWidgets.indexOf(currentParagraph) <\n                    paragraph.associatedCell.childWidgets.indexOf(paragraph);\n                //handle after header footer implementation\n                // } else if ((this.currentParagraph).owner instanceof WHeaderFooter) {\n                //     return ((this.currentParagraph).owner as WHeaderFooter).blocks.indexOf((this.currentParagraph)) <\n                //         ((textPosition.currentParagraph).owner as WHeaderFooter).blocks.indexOf((textPosition.currentParagraph));\n            }\n            else {\n                return (currentParagraph.containerWidget.childWidgets.indexOf(currentParagraph)) <\n                    (paragraph.containerWidget.childWidgets.indexOf(paragraph));\n            }\n        }\n        return this.owner.selection.isExistBefore(currentParagraph, paragraph);\n    };\n    /**\n     * Return true is current text position exist after given text position\n     * @private\n     */\n    TextPosition.prototype.isExistAfter = function (textPosition) {\n        if (isNullOrUndefined(textPosition)) {\n            throw new Error('textPosition is undefined.');\n        }\n        if (this.currentWidget === textPosition.currentWidget) {\n            return this.offset > textPosition.offset;\n        }\n        if (this.currentWidget.paragraph === textPosition.currentWidget.paragraph) {\n            return this.currentWidget.paragraph.childWidgets.indexOf(this.currentWidget) >\n                textPosition.currentWidget.paragraph.childWidgets.indexOf(textPosition.currentWidget);\n        }\n        var startParagraph = this.currentWidget.paragraph;\n        var endParagraph = textPosition.currentWidget.paragraph;\n        if (startParagraph.containerWidget.index === endParagraph.containerWidget.index) {\n            if (startParagraph.isInsideTable) {\n                return startParagraph.associatedCell.childWidgets.indexOf(startParagraph) >\n                    endParagraph.associatedCell.childWidgets.indexOf(endParagraph);\n                // } else if ((this.currentParagraph).owner instanceof WHeaderFooter) {\n                //     return ((this.currentParagraph).owner as WHeaderFooter).blocks.indexOf((this.currentParagraph)) >\n                //         ((textPosition.currentParagraph).owner as WHeaderFooter).blocks.indexOf((textPosition.currentParagraph));\n            }\n            else {\n                return (startParagraph.containerWidget.childWidgets.indexOf(startParagraph) >\n                    (endParagraph.containerWidget.childWidgets.indexOf(endParagraph)));\n            }\n        }\n        return this.owner.selection.isExistAfter(startParagraph, endParagraph);\n    };\n    /**\n     * Return hierarchical index of current text position\n     * @private\n     */\n    TextPosition.prototype.getHierarchicalIndexInternal = function () {\n        return this.getHierarchicalIndex(this.currentWidget, this.offset.toString());\n    };\n    /**\n     * @private\n     */\n    TextPosition.prototype.getHierarchicalIndex = function (line, hierarchicalIndex) {\n        var node = line;\n        if (node) {\n            return node.getHierarchicalIndex(hierarchicalIndex);\n        }\n        return hierarchicalIndex;\n    };\n    /**\n     * @private\n     */\n    TextPosition.prototype.setPositionParagraph = function (line, offsetInLine) {\n        this.currentWidget = line;\n        this.offset = offsetInLine;\n        this.updatePhysicalPosition(true);\n    };\n    /**\n     * @private\n     */\n    TextPosition.prototype.setPositionForLineWidget = function (lineWidget, offset) {\n        var lineLength = this.selection.getLineLength(lineWidget);\n        var lineIndex = lineWidget.paragraph.childWidgets.indexOf(lineWidget);\n        if (offset > lineLength + 1) {\n            var nextLineWidget = void 0;\n            if (lineIndex >= lineWidget.paragraph.childWidgets.length - 1) {\n                var nextBlock = this.selection.getNextRenderedBlock(lineWidget.paragraph);\n                if (nextBlock && nextBlock.index === lineWidget.paragraph.index) {\n                    nextLineWidget = nextBlock.firstChild;\n                }\n            }\n            else {\n                nextLineWidget = lineWidget.paragraph.childWidgets[lineIndex + 1];\n            }\n            this.setPositionForLineWidget(nextLineWidget, offset - lineLength);\n            return;\n        }\n        else if (offset < 0) {\n            var prevLine = lineWidget.paragraph.childWidgets[lineIndex - 1];\n            var curretOffSet = this.selection.getLineLength(prevLine) + offset;\n            this.setPositionForLineWidget(prevLine, curretOffSet);\n            return;\n        }\n        else {\n            this.currentWidget = lineWidget;\n            this.offset = offset;\n        }\n        this.updatePhysicalPosition(true);\n    };\n    /**\n     * move to next text position\n     * @private\n     */\n    TextPosition.prototype.moveNextPosition = function (isNavigate) {\n        if (isNullOrUndefined(isNavigate)) {\n            isNavigate = true;\n        }\n        var inline = this.selection.getNextStartInline(this.currentWidget, this.offset);\n        if (inline instanceof FieldElementBox && inline.fieldType === 0 && !isNullOrUndefined(inline.fieldEnd)) {\n            if (isNavigate) {\n                this.moveNextPositionInternal(inline);\n                this.moveNextPosition();\n                return;\n            }\n            else {\n                var line = inline.fieldEnd.line;\n                var fieldEnd = inline.fieldEnd;\n                var fieldEndOffset = line.getOffset(fieldEnd, 1);\n                var fieldEndIndex = this.getHierarchicalIndex(line, fieldEndOffset.toString());\n                if (TextPosition.isForwardSelection(this.selection.end.getHierarchicalIndexInternal(), fieldEndIndex)) {\n                    //If field end is after selection end, extend selection end to field end.\n                    this.selection.end.moveToInline(inline.fieldEnd, 1);\n                    return;\n                }\n                this.moveToInline(inline.fieldEnd, 1);\n            }\n        }\n        var nextOffset = this.selection.getNextValidOffset(this.currentWidget, this.offset);\n        var lineIndex = this.paragraph.childWidgets.indexOf(this.currentWidget);\n        var index = 0;\n        if (nextOffset > this.offset) {\n            this.offset = nextOffset;\n            var info = this.currentWidget.getInline(this.offset, index);\n            inline = info.element;\n            index = info.index;\n            if (!isNullOrUndefined(inline) && index === inline.length && inline.nextNode instanceof FieldElementBox) {\n                var nextValidInline = this.selection.getNextValidElement(inline.nextNode);\n                //Moves to field end mark.\n                if (nextValidInline instanceof FieldElementBox && nextValidInline.fieldType === 1) {\n                    inline = nextValidInline;\n                    this.offset = this.currentWidget.getOffset(inline, 1);\n                }\n            }\n        }\n        else if (lineIndex + 1 < this.paragraph.childWidgets.length) {\n            var nextLineWidget = this.paragraph.childWidgets[lineIndex + 1];\n            if (nextLineWidget) {\n                this.currentWidget = nextLineWidget;\n                this.offset = this.selection.getStartLineOffset(this.currentWidget);\n            }\n            var inlineObj = this.currentWidget.getInline(this.offset, index);\n            inline = inlineObj.element;\n            index = inlineObj.index;\n            if (inline instanceof FieldElementBox && inline.fieldType === 0) {\n                this.offset++;\n            }\n        }\n        else {\n            this.updateOffsetToNextParagraph(index, false);\n        }\n        //Gets physical position in current page.\n        this.updatePhysicalPosition(true);\n    };\n    /**\n     * Move text position to previous paragraph inside table\n     * @private\n     */\n    TextPosition.prototype.moveToPreviousParagraphInTable = function (selection) {\n        var previousParagraph;\n        var currentPara = this.currentWidget.paragraph;\n        if (currentPara.isInsideTable) {\n            previousParagraph = selection.getPreviousSelectionCell(currentPara.associatedCell);\n        }\n        else {\n            previousParagraph = selection.getPreviousParagraphBlock(currentPara);\n        }\n        if (isNullOrUndefined(previousParagraph)) {\n            return;\n        }\n        this.currentWidget = previousParagraph.childWidgets[previousParagraph.childWidgets.length - 1];\n        this.offset = this.currentWidget.getEndOffset() + 1;\n    };\n    TextPosition.prototype.updateOffsetToNextParagraph = function (indexInInline, isHighlight) {\n        //Moves to owner and get next paragraph.\n        var inline;\n        var positionAtStart = false;\n        var nextParagraph = undefined;\n        var lineIndex = this.paragraph.childWidgets.indexOf(this.currentWidget);\n        if (!isHighlight) {\n            nextParagraph = this.selection.getNextParagraphBlock(this.paragraph);\n        }\n        else if (lineIndex + 1 < this.paragraph.childWidgets.length) {\n            var nextLineWidget = this.paragraph.childWidgets[lineIndex + 1];\n            if (nextLineWidget) {\n                this.currentWidget = nextLineWidget;\n                this.offset = 0;\n            }\n        }\n        else {\n            nextParagraph = this.selection.getNextSelectionBlock(this.paragraph);\n            if (!isNullOrUndefined(nextParagraph)) {\n                if (nextParagraph.containerWidget instanceof TableCellWidget) {\n                    if (this.selection.start.paragraph.isInsideTable) {\n                        // tslint:disable-next-line:max-line-length\n                        var containerCell = this.selection.getContainerCellOf(this.selection.start.paragraph.associatedCell, nextParagraph.associatedCell);\n                        positionAtStart = !containerCell.ownerTable.contains(nextParagraph.associatedCell);\n                    }\n                    else {\n                        positionAtStart = true;\n                    }\n                }\n            }\n        }\n        if (!isNullOrUndefined(nextParagraph) && nextParagraph.childWidgets.length > 0) {\n            if (!positionAtStart) {\n                this.currentWidget = nextParagraph.firstChild;\n                this.offset = isHighlight ? 1 : this.selection.getStartLineOffset(this.currentWidget);\n            }\n            else {\n                this.currentWidget = nextParagraph.childWidgets[nextParagraph.childWidgets.length - 1];\n                this.offset = this.selection.getLineLength(this.currentWidget) + 1;\n            }\n        }\n        var inlineObj = this.currentWidget.getInline(this.offset, indexInInline);\n        inline = inlineObj.element;\n        indexInInline = inlineObj.index;\n        if (inline instanceof FieldElementBox && inline.fieldType === 0) {\n            this.offset++;\n        }\n    };\n    TextPosition.prototype.updateOffsetToPrevPosition = function (index, isHighlight) {\n        var inlineInfo;\n        var inline;\n        var lineIndex = this.paragraph.childWidgets.indexOf(this.currentWidget);\n        var prevOffset = this.selection.getPreviousValidOffset(this.currentWidget.paragraph, this.offset);\n        if (this.offset > prevOffset) {\n            this.offset = prevOffset;\n        }\n        else if (lineIndex > 0) {\n            var prevLineWidget = this.paragraph.childWidgets[lineIndex - 1];\n            if (prevLineWidget) {\n                this.currentWidget = prevLineWidget;\n                this.offset = this.currentWidget.getEndOffset();\n            }\n        }\n        else {\n            //Moves to owner and get previous paragraph.\n            var previousParagraph = undefined;\n            var positionAtStart = false;\n            if (!isHighlight) {\n                previousParagraph = this.selection.getPreviousParagraphBlock(this.paragraph);\n            }\n            else {\n                previousParagraph = this.selection.getPreviousSelectionBlock(this.paragraph);\n                if (!isNullOrUndefined(previousParagraph)) {\n                    if (previousParagraph.containerWidget instanceof TableCellWidget) {\n                        if (this.selection.start.paragraph.isInsideTable) {\n                            // tslint:disable-next-line:max-line-length\n                            var containerCell = this.selection.getContainerCellOf(this.selection.start.paragraph.associatedCell, previousParagraph.associatedCell);\n                            positionAtStart = !containerCell.ownerTable.contains(previousParagraph.associatedCell);\n                        }\n                        else {\n                            positionAtStart = true;\n                        }\n                    }\n                }\n            }\n            if (!isNullOrUndefined(previousParagraph)) {\n                if (!positionAtStart) {\n                    this.currentWidget = previousParagraph.childWidgets[previousParagraph.childWidgets.length - 1];\n                    this.offset = this.currentWidget.getEndOffset();\n                }\n                else {\n                    this.currentWidget = previousParagraph.firstChild;\n                    this.offset = this.selection.getStartLineOffset(this.currentWidget);\n                }\n            }\n        }\n        index = 0;\n        inlineInfo = this.currentWidget.getInline(this.offset, index);\n        inline = inlineInfo.element;\n        index = inlineInfo.index;\n        if (inline instanceof FieldElementBox && inline.fieldType === 0) {\n            this.offset++;\n        }\n        if (inline instanceof FieldElementBox) {\n            //Checks if field character is part of rendered field, otherwise moves to previous rendered content.\n            var previousInline = this.selection.getPreviousValidElement(inline);\n            if (!isNullOrUndefined(previousInline)) {\n                inline = previousInline;\n                this.currentWidget = inline.line;\n                this.offset = this.currentWidget.getOffset(inline, inline.length);\n                if (inline instanceof FieldElementBox && inline.fieldType === 0) {\n                    this.offset--;\n                }\n            }\n        }\n        //Gets physical position in current page.\n        this.updatePhysicalPosition(true);\n    };\n    /**\n     * Moves the text position to start of the next paragraph.\n     */\n    TextPosition.prototype.moveToNextParagraphStartInternal = function () {\n        var paragraph = this.currentWidget.paragraph;\n        if (!isNullOrUndefined(this.selection.getNextParagraphBlock(paragraph))) {\n            // tslint:disable-next-line:max-line-length\n            this.currentWidget = this.selection.getNextParagraphBlock(paragraph).firstChild;\n            this.offset = this.selection.getStartOffset(paragraph);\n            this.updatePhysicalPosition(true);\n        }\n    };\n    /**\n     * Move to previous position\n     * @private\n     */\n    TextPosition.prototype.movePreviousPosition = function () {\n        var index = 0;\n        var inlineInfo = this.currentWidget.getInline(this.offset, index);\n        var inline = inlineInfo.element;\n        index = inlineInfo.index;\n        var lineIndex = this.paragraph.childWidgets.indexOf(this.currentWidget);\n        if (inline instanceof FieldElementBox && inline.fieldType === 1 && !isNullOrUndefined(inline.fieldBegin)) {\n            this.movePreviousPositionInternal(inline);\n        }\n        this.updateOffsetToPrevPosition(index, false);\n    };\n    /**\n     * Move to next position\n     * @private\n     */\n    TextPosition.prototype.moveNextPositionInternal = function (fieldBegin) {\n        var inline;\n        if (isNullOrUndefined(fieldBegin.fieldSeparator)) {\n            inline = fieldBegin.fieldEnd;\n        }\n        else {\n            inline = fieldBegin.fieldSeparator;\n            this.currentWidget = inline.line;\n            // tslint:disable-next-line:max-line-length\n            if (this.currentWidget === fieldBegin.fieldEnd.line && !this.selection.hasValidInline(this.paragraph, inline, fieldBegin.fieldEnd)) {\n                inline = fieldBegin.fieldEnd;\n            }\n        }\n        this.currentWidget = inline.line;\n        this.offset = this.currentWidget.getOffset(inline, 1);\n    };\n    /**\n     * Move text position backward\n     * @private\n     */\n    TextPosition.prototype.moveBackward = function () {\n        var indexInInline = 0;\n        var inlineObj = this.currentWidget.getInline(this.offset, indexInInline);\n        var inline = inlineObj.element;\n        indexInInline = inlineObj.index;\n        if (!this.owner.selection.isEmpty && !isNullOrUndefined(inline)) {\n            var nextInline = this.selection.getNextRenderedElementBox(inline, indexInInline);\n            if (nextInline instanceof FieldElementBox && nextInline.fieldType === 0) {\n                var hierarchicalIndex = this.owner.selection.start.getHierarchicalIndexInternal();\n                // tslint:disable-next-line:max-line-length\n                var fieldEndOffset = nextInline.fieldEnd.line.getOffset(nextInline.fieldEnd, 1);\n                // tslint:disable-next-line:max-line-length\n                var fieldEndIndex = this.getHierarchicalIndex(nextInline.fieldEnd.line, fieldEndOffset.toString());\n                if (!TextPosition.isForwardSelection(fieldEndIndex, hierarchicalIndex)) {\n                    //If field end is after selection start, move selection start to field end.\n                    // tslint:disable-next-line:max-line-length\n                    this.owner.selection.start.setPositionParagraph(nextInline.fieldEnd.line, fieldEndOffset);\n                    return;\n                }\n            }\n        }\n        if (inline instanceof FieldElementBox && inline.fieldType === 1 && !isNullOrUndefined(inline.fieldBegin)) {\n            var hierarchicalIndex = this.owner.selection.start.getHierarchicalIndexInternal();\n            var fieldEndOffset = inline.line.getOffset(inline, 1);\n            var fieldEndIndex = this.getHierarchicalIndex(inline.line, fieldEndOffset.toString());\n            if (!TextPosition.isForwardSelection(hierarchicalIndex, fieldEndIndex)) {\n                //If field end is after selection start, extend selection end to field begin.\n                // tslint:disable-next-line:max-line-length\n                var fieldBeginOffset = inline.fieldBegin.line.getOffset(inline.fieldBegin, 0);\n                this.currentWidget = inline.fieldBegin.line;\n                this.offset = fieldBeginOffset;\n                //Updates physical position in current page.\n                this.updatePhysicalPosition(true);\n                return;\n            }\n            this.movePreviousPositionInternal(inline);\n        }\n        this.updateOffsetToPrevPosition(indexInInline, true);\n    };\n    /**\n     * Move text position forward\n     * @private\n     */\n    TextPosition.prototype.moveForward = function () {\n        var indexInInline = 0;\n        var inlineObj = this.currentWidget.getInline(this.offset, indexInInline);\n        var inline = inlineObj.element;\n        indexInInline = inlineObj.index;\n        if (!isNullOrUndefined(inline)) {\n            if (!this.owner.selection.isEmpty && indexInInline === inline.length && inline instanceof FieldElementBox\n                && inline.fieldType === 1) {\n                var hierarchicalIndex = this.owner.selection.start.getHierarchicalIndexInternal();\n                // tslint:disable-next-line:max-line-length\n                var fieldBeginOffset = inline.fieldBegin.line.getOffset(inline.fieldBegin, 0);\n                // tslint:disable-next-line:max-line-length\n                var fieldBeginIndex = this.getHierarchicalIndex(inline.fieldBegin.line, fieldBeginOffset.toString());\n                if (!TextPosition.isForwardSelection(hierarchicalIndex, fieldBeginIndex)) {\n                    //If field begin is before selection start, move selection start to field begin.\n                    // tslint:disable-next-line:max-line-length\n                    this.owner.selection.start.setPositionParagraph(inline.fieldBegin.line, fieldBeginOffset);\n                    return;\n                }\n            }\n            inline = this.selection.getNextRenderedElementBox(inline, indexInInline);\n        }\n        if (inline instanceof FieldElementBox && !isNullOrUndefined(inline.fieldEnd)) {\n            var selectionStartParagraph = this.owner.selection.start.paragraph;\n            var selectionStartIndex = 0;\n            // tslint:disable-next-line:max-line-length\n            var selectionStartInlineObj = selectionStartParagraph.getInline(this.owner.selection.start.offset, selectionStartIndex);\n            var selectionStartInline = selectionStartInlineObj.element;\n            selectionStartIndex = selectionStartInlineObj.index;\n            var nextRenderInline = this.selection.getNextRenderedElementBox(selectionStartInline, selectionStartIndex);\n            if (nextRenderInline === inline) {\n                this.moveNextPositionInternal(inline);\n            }\n            else {\n                //If selection start is before field begin, extend selection end to field end.\n                inline = inline.fieldEnd;\n                this.currentWidget = inline.line;\n                this.offset = this.currentWidget.getOffset(inline, 1);\n                //Updates physical position in current page.\n                this.updatePhysicalPosition(true);\n                return;\n            }\n        }\n        else if ((inline instanceof FieldElementBox)\n            && (inline.fieldType === 0 || inline.fieldType === 1)) {\n            this.currentWidget = inline.line;\n            this.offset = this.currentWidget.getOffset(inline, 1);\n        }\n        indexInInline = 0;\n        var nextOffset = this.selection.getNextValidOffset(this.currentWidget, this.offset);\n        var length = this.selection.getLineLength(this.currentWidget);\n        var isParagraphEnd = this.selection.isParagraphLastLine(this.currentWidget);\n        if (this.offset < nextOffset) {\n            this.offset = nextOffset;\n            var inlineObj_1 = this.currentWidget.getInline(this.offset, indexInInline);\n            inline = inlineObj_1.element;\n            indexInInline = inlineObj_1.index;\n            if (!isNullOrUndefined(inline) && indexInInline === inline.length && inline.nextNode instanceof FieldElementBox) {\n                var nextValidInline = this.selection.getNextValidElement(inline.nextNode);\n                //Moves to field end mark.\n                if (nextValidInline instanceof FieldElementBox && nextValidInline.fieldType === 1) {\n                    inline = nextValidInline;\n                    this.offset = this.currentWidget.getOffset(inline, 1);\n                }\n            }\n        }\n        else if (this.offset === nextOffset && this.offset < length + 1 && isParagraphEnd) {\n            this.offset = length + 1;\n        }\n        else {\n            this.updateOffsetToNextParagraph(indexInInline, true);\n        }\n        //Gets physical position in current page.\n        this.updatePhysicalPosition(true);\n    };\n    /**\n     * Move to given inline\n     * @private\n     */\n    TextPosition.prototype.moveToInline = function (inline, index) {\n        this.currentWidget = inline.line;\n        this.offset = this.currentWidget.getOffset(inline, index);\n        //Updates physical position in current page.\n        this.updatePhysicalPosition(true);\n    };\n    /**\n     * Return true is start element exist before end element\n     * @private\n     */\n    TextPosition.isForwardSelection = function (start, end) {\n        if (start === end) {\n            return true;\n        }\n        start = start.replace(/C;/g, '');\n        end = end.replace(/C;/g, '');\n        start = start.replace(/H;/g, '');\n        end = end.replace(/H;/g, '');\n        start = start.replace(/F;/g, '');\n        end = end.replace(/F;/g, '');\n        var selectionStart = start.split(';');\n        var selectionEnd = end.split(';');\n        var length = selectionStart.length;\n        if (length > selectionEnd.length) {\n            length = selectionEnd.length - 1;\n        }\n        for (var i = 0; i < length; i++) {\n            var startOffset = parseFloat(selectionStart[i]);\n            var endOffset = parseFloat(selectionEnd[i]);\n            if (startOffset !== endOffset) {\n                return startOffset < endOffset;\n            }\n        }\n        return false;\n    };\n    /**\n     * Move to previous position offset\n     * @private\n     */\n    TextPosition.prototype.movePreviousPositionInternal = function (fieldEnd) {\n        var inline;\n        if (isNullOrUndefined(fieldEnd.fieldSeparator)) {\n            inline = this.selection.getPreviousValidElement(fieldEnd.fieldBegin);\n        }\n        else {\n            inline = this.selection.getPreviousValidElement(fieldEnd);\n        }\n        this.currentWidget = inline.line;\n        this.offset = this.currentWidget.getOffset(inline, inline instanceof FieldElementBox ? 0 : inline.length);\n    };\n    /**\n     * Moves the text position to start of the word.\n     * @private\n     */\n    TextPosition.prototype.moveToWordStartInternal = function (type) {\n        var endOffset = this.currentWidget.getEndOffset();\n        var currentPara = this.currentWidget.paragraph;\n        var selection = this.selection;\n        if (type === 2 && (this.offset === endOffset || this.offset === endOffset + 1)) {\n            return;\n        }\n        if (this.offset === endOffset + 1) {\n            this.offset = endOffset;\n        }\n        else if (this.offset === selection.getStartOffset(currentPara) && this.currentWidget === currentPara.childWidgets[0]) {\n            var previousParagraph = selection.getPreviousParagraphBlock(currentPara);\n            if (isNullOrUndefined(previousParagraph)) {\n                return;\n            }\n            this.currentWidget = previousParagraph.childWidgets[previousParagraph.childWidgets.length - 1];\n            this.offset = this.currentWidget.getEndOffset();\n        }\n        else {\n            if (this.offset === selection.getStartLineOffset(this.currentWidget)) {\n                var lineIndex = currentPara.childWidgets.indexOf(this.currentWidget);\n                if (lineIndex - 1 >= 0) {\n                    this.currentWidget = currentPara.childWidgets[lineIndex - 1];\n                    this.offset = this.currentWidget.getEndOffset();\n                }\n            }\n            var isStarted = false;\n            var endSelection = false;\n            var indexInInline = 0;\n            var inlineObj = this.currentWidget.getInline(this.offset, indexInInline);\n            var inline = inlineObj.element;\n            indexInInline = inlineObj.index;\n            // tslint:disable-next-line:max-line-length           \n            this.getPreviousWordOffset(inline, selection, indexInInline, type, (inline instanceof FieldElementBox && inline.fieldType === 1), isStarted, endSelection, this);\n        }\n        if (type === 1) {\n            this.calculateOffset();\n        }\n        this.updatePhysicalPosition(true);\n    };\n    /**\n     * Get next word offset\n     * @private\n     */\n    // tslint:disable-next-line:max-line-length\n    TextPosition.prototype.getNextWordOffset = function (inline, indexInInline, type, isInField, endSelection, endPosition, excludeSpace) {\n        if (inline instanceof TextElementBox) {\n            this.getNextWordOffsetSpan(inline, indexInInline, type, isInField, endSelection, endPosition, excludeSpace);\n        }\n        else if (inline instanceof ImageElementBox) {\n            // tslint:disable-next-line:max-line-length\n            this.getNextWordOffsetImage(inline, indexInInline, type, isInField, endSelection, endPosition, excludeSpace);\n        }\n        else if (inline instanceof FieldElementBox && inline.fieldType === 0) {\n            // tslint:disable-next-line:max-line-length\n            this.getNextWordOffsetFieldBegin(inline, indexInInline, type, isInField, endSelection, endPosition, excludeSpace);\n        }\n        else if (inline instanceof FieldElementBox && inline.fieldType === 2 || inline instanceof BookmarkElementBox) {\n            // tslint:disable-next-line:max-line-length\n            this.getNextWordOffsetFieldSeperator(inline, indexInInline, type, isInField, endSelection, endPosition, excludeSpace);\n        }\n        else if (inline instanceof FieldElementBox && inline.fieldType === 1) {\n            // tslint:disable-next-line:max-line-length\n            this.getNextWordOffsetFieldEnd(inline, indexInInline, type, isInField, endSelection, endPosition, excludeSpace);\n        }\n    };\n    /**\n     * get next word offset from field begin\n     * @private\n     */\n    // tslint:disable-next-line:max-line-length\n    TextPosition.prototype.getNextWordOffsetFieldBegin = function (fieldBegin, indexInInline, type, isInField, endSelection, endPosition, excludeSpace) {\n        var startOffset = fieldBegin.line.getOffset(fieldBegin, 0);\n        var endOffset = startOffset + fieldBegin.length;\n        if (isNullOrUndefined(fieldBegin.fieldSeparator)) {\n            this.getNextWordOffsetFieldEnd(fieldBegin.fieldEnd, 0, type, isInField, endSelection, endPosition, excludeSpace);\n        }\n        else if (type === 0) {\n            // tslint:disable-next-line:max-line-length\n            this.getNextWordOffsetFieldSeperator(fieldBegin.fieldSeparator, 0, type, isInField, endSelection, endPosition, excludeSpace);\n        }\n        else if (!isNullOrUndefined(fieldBegin.fieldEnd)) {\n            var inline = fieldBegin.fieldSeparator;\n            // tslint:disable-next-line:max-line-length\n            if (inline.line.paragraph === fieldBegin.fieldEnd.line.paragraph && !this.selection.hasValidInline(inline.line.paragraph, inline, fieldBegin.fieldEnd)) {\n                inline = fieldBegin.fieldEnd;\n            }\n            // tslint:disable-next-line:max-line-length\n            this.getNextWordOffset(inline, 0, type, !(endPosition.paragraph === fieldBegin.line.paragraph && endPosition.offset === startOffset), endSelection, endPosition, excludeSpace);\n            // tslint:disable-next-line:max-line-length\n            if (endSelection && !isNullOrUndefined(fieldBegin.fieldSeparator) && (endPosition.paragraph === fieldBegin.line.paragraph) && (endPosition.offset === fieldBegin.fieldSeparator.line.getOffset(fieldBegin.fieldSeparator, fieldBegin.fieldSeparator.length))) {\n                endPosition.setPositionParagraph(fieldBegin.line, startOffset);\n                return;\n            }\n            if (!endSelection) {\n                // tslint:disable-next-line:max-line-length\n                endPosition.setPositionParagraph(fieldBegin.fieldEnd.line, fieldBegin.fieldEnd.line.getOffset(fieldBegin.fieldEnd, fieldBegin.fieldEnd.length));\n            }\n        }\n    };\n    /**\n     * get next word offset from image\n     * @private\n     */\n    // tslint:disable-next-line:max-line-length\n    TextPosition.prototype.getNextWordOffsetImage = function (image, indexInInline, type, isInField, endSelection, endPosition, excludeSpace) {\n        if (isInField) {\n            endPosition.setPositionParagraph(image.line, image.line.getOffset(image, indexInInline));\n            endSelection = false;\n            return;\n        }\n        if (indexInInline === 0) {\n            var startOffset = image.line.getOffset(image, 0);\n            endSelection = true;\n            if (endPosition.offset === startOffset) {\n                if (isNullOrUndefined(image.nextNode)) {\n                    endPosition.setPositionParagraph(image.line, startOffset + image.length);\n                }\n                else {\n                    this.getNextWordOffset(image.nextNode, 0, type, isInField, endSelection, endPosition, excludeSpace);\n                }\n            }\n            else {\n                endPosition.setPositionParagraph(image.line, startOffset);\n            }\n        }\n        else if (!isNullOrUndefined(image.nextNode)) {\n            this.getNextWordOffset(image.nextNode, 0, type, isInField, endSelection, endPosition, excludeSpace);\n        }\n    };\n    /**\n     * get next word offset from span\n     */\n    // tslint:disable-next-line:max-line-length\n    TextPosition.prototype.getNextWordOffsetSpan = function (span, indexInInline, type, isInField, endSelection, endPosition, excludeSpace) {\n        if (span.text === '\\t' || span.text === '\\v') {\n            if (isInField) {\n                endPosition.setPositionParagraph(span.line, span.line.getOffset(span, indexInInline));\n                endSelection = false;\n                return;\n            }\n            if (indexInInline === 0) {\n                endSelection = true;\n                var startOffset = span.line.getOffset(span, 0);\n                if (endPosition.offset === startOffset) {\n                    endPosition.setPositionParagraph(span.line, startOffset + span.length);\n                }\n                else {\n                    endPosition.setPositionParagraph(span.line, startOffset);\n                }\n            }\n            else if (!isNullOrUndefined(span.nextNode)) {\n                this.getNextWordOffset(span.nextNode, 0, type, isInField, endSelection, endPosition, excludeSpace);\n            }\n        }\n        else {\n            var wordEndIndex = 0;\n            if (indexInInline === 0 && endSelection && (HelperMethods.wordSplitCharacters.indexOf(span.text[0]) === -1)) {\n                endPosition.setPositionParagraph(span.line, span.line.getOffset(span, indexInInline));\n                if (isInField) {\n                    return;\n                }\n            }\n            else if (indexInInline < span.length) {\n                // tslint:disable-next-line:max-line-length\n                var txt = indexInInline > 0 && span.text.length - 1 >= indexInInline ? span.text.slice(indexInInline, span.length) : span.text;\n                wordEndIndex = HelperMethods.indexOfAny(txt, HelperMethods.wordSplitCharacters);\n                if (wordEndIndex !== -1) {\n                    if (isInField) {\n                        endSelection = false;\n                        return;\n                    }\n                    var offset = span.line.getOffset(span, wordEndIndex + indexInInline);\n                    // tslint:disable-next-line:max-line-length\n                    if ((excludeSpace || txt[wordEndIndex] !== ' ') && !endSelection && span.line.paragraph === endPosition.paragraph && offset !== endPosition.offset) {\n                        endSelection = true;\n                        endPosition.setPositionParagraph(span.line, offset);\n                        return;\n                    }\n                    wordEndIndex++;\n                    while (wordEndIndex < txt.length && HelperMethods.wordSplitCharacters.indexOf(txt[wordEndIndex]) !== -1) {\n                        if (txt[wordEndIndex] !== ' ' && txt[wordEndIndex] !== 'ã€€') {\n                            break;\n                        }\n                        wordEndIndex++;\n                    }\n                    endSelection = true;\n                    if (wordEndIndex < txt.length) {\n                        // tslint:disable-next-line:max-line-length\n                        endPosition.setPositionParagraph(span.line, span.line.getOffset(span, wordEndIndex + indexInInline));\n                    }\n                    else if (!isNullOrUndefined(span.nextNode)) {\n                        // tslint:disable-next-line:max-line-length\n                        this.getNextWordOffset(span.nextNode, 0, type, isInField, endSelection, endPosition, excludeSpace);\n                    }\n                    else {\n                        // tslint:disable-next-line:max-line-length\n                        endPosition.setPositionParagraph(span.line, span.line.getOffset(span, wordEndIndex + indexInInline));\n                    }\n                }\n                else if (!isNullOrUndefined(span.nextNode)) {\n                    this.getNextWordOffset(span.nextNode, 0, type, isInField, endSelection, endPosition, excludeSpace);\n                }\n                else {\n                    endPosition.setPositionParagraph(span.line, span.line.getEndOffset());\n                }\n            }\n            else if (!isNullOrUndefined(span.nextNode)) {\n                this.getNextWordOffset(span.nextNode, 0, type, isInField, endSelection, endPosition, excludeSpace);\n            }\n        }\n    };\n    /**\n     * get next word offset from field separator\n     * @private\n     */\n    // tslint:disable-next-line:max-line-length\n    TextPosition.prototype.getNextWordOffsetFieldSeperator = function (fieldSeparator, indexInInline, type, isInField, endSelection, endPosition, excludeSpace) {\n        if (!isNullOrUndefined(fieldSeparator.nextNode)) {\n            this.getNextWordOffset(fieldSeparator.nextNode, 0, type, isInField, endSelection, endPosition, excludeSpace);\n        }\n    };\n    /**\n     * get next word offset from field end\n     * @private\n     */\n    // tslint:disable-next-line:max-line-length\n    TextPosition.prototype.getNextWordOffsetFieldEnd = function (fieldEnd, indexInInline, type, isInField, endSelection, endPosition, excludeSpace) {\n        var startOffset = fieldEnd.line.getOffset(fieldEnd, 0);\n        var endOffset = startOffset + fieldEnd.length;\n        if (endPosition.offset === startOffset) {\n            endPosition.setPositionParagraph(fieldEnd.line, endOffset);\n            if (isNullOrUndefined(fieldEnd.nextNode)) {\n                return;\n            }\n        }\n        if (!isNullOrUndefined(fieldEnd.nextNode)) {\n            this.getNextWordOffset(fieldEnd.nextNode, 0, type, false, endSelection, endPosition, excludeSpace);\n            if (endPosition.offset === endOffset) {\n                endPosition.setPositionParagraph(fieldEnd.line, startOffset);\n            }\n        }\n        else {\n            endPosition.setPositionParagraph(fieldEnd.line, startOffset);\n        }\n        endSelection = true;\n    };\n    /**\n     * Get previous word offset\n     * @private\n     */\n    // tslint:disable-next-line:max-line-length\n    TextPosition.prototype.getPreviousWordOffset = function (inline, selection, indexInInline, type, isInField, isStarted, endSelection, endPosition) {\n        if (inline instanceof TextElementBox) {\n            // tslint:disable-next-line:max-line-length\n            this.getPreviousWordOffsetSpan(inline, selection, indexInInline, type, isInField, isStarted, endSelection, endPosition);\n        }\n        else if (inline instanceof ImageElementBox) {\n            // tslint:disable-next-line:max-line-length\n            this.getPreviousWordOffsetImage(inline, selection, indexInInline, type, isInField, isStarted, endSelection, endPosition);\n        }\n        else if (inline instanceof FieldElementBox && inline.fieldType === 0) {\n            // tslint:disable-next-line:max-line-length\n            this.getPreviousWordOffsetFieldBegin(inline, selection, indexInInline, type, isInField, isStarted, endSelection, endPosition);\n        }\n        else if (inline instanceof FieldElementBox && inline.fieldType === 2) {\n            // tslint:disable-next-line:max-line-length\n            this.getPreviousWordOffsetFieldSeparator(inline, selection, indexInInline, type, isInField, isStarted, endSelection, endPosition);\n        }\n        else if (inline instanceof FieldElementBox && inline.fieldType === 1) {\n            // tslint:disable-next-line:max-line-length\n            this.getPreviousWordOffsetFieldEnd(inline, selection, indexInInline, type, isInField, isStarted, endSelection, endPosition);\n        }\n        else if (inline instanceof BookmarkElementBox) {\n            this.getPreviousWordOffsetBookMark(inline, selection, indexInInline, type, isInField, isStarted, endSelection, endPosition);\n        }\n        else if (inline instanceof ListTextElementBox && inline.previousNode) {\n            // tslint:disable-next-line:max-line-length\n            this.getPreviousWordOffsetSpan(inline.previousNode, selection, indexInInline, type, isInField, isStarted, endSelection, endPosition);\n        }\n    };\n    // tslint:disable-next-line:max-line-length\n    TextPosition.prototype.getPreviousWordOffsetBookMark = function (bookmark, selection, indexInInline, type, isInField, isStarted, endSelection, endPosition) {\n        if (bookmark.previousNode) {\n            if (bookmark.previousNode instanceof TextElementBox) {\n                var inline = bookmark.previousNode;\n                if (HelperMethods.lastIndexOfAny(inline.text, HelperMethods.wordSplitCharacters) !== inline.text.length - 1) {\n                    this.getPreviousWordOffset(inline, selection, indexInInline, type, isInField, isStarted, endSelection, endPosition);\n                }\n                else {\n                    endPosition.setPositionParagraph(bookmark.line, bookmark.line.getOffset(bookmark, 0));\n                }\n            }\n        }\n        else {\n            endPosition.setPositionParagraph(bookmark.line, selection.getStartLineOffset(bookmark.line));\n        }\n    };\n    /**\n     * get previous word offset from field end\n     * @private\n     */\n    // tslint:disable-next-line:max-line-length\n    TextPosition.prototype.getPreviousWordOffsetFieldEnd = function (fieldEnd, selection, indexInInline, type, isInField, isStarted, endSelection, endPosition) {\n        var startOffset = fieldEnd.line.getOffset(fieldEnd, 0);\n        var endOffset = startOffset + fieldEnd.length;\n        if (isNullOrUndefined(fieldEnd.fieldSeparator)) {\n            this.getPreviousWordOffsetFieldBegin(fieldEnd.fieldBegin, selection, 0, type, isInField, isStarted, endSelection, endPosition);\n        }\n        else if (type === 0 && !isNullOrUndefined(fieldEnd.previousNode)) {\n            var inline = fieldEnd.previousNode;\n            // tslint:disable-next-line:max-line-length\n            this.getPreviousWordOffset(inline, selection, inline.length, type, (inline instanceof FieldElementBox && inline.fieldType === 1), isStarted, endSelection, endPosition);\n        }\n        else if (!isNullOrUndefined(fieldEnd.fieldBegin) && type !== 0) {\n            var inline = fieldEnd.previousNode;\n            // tslint:disable-next-line:max-line-length\n            if (isNullOrUndefined(inline) || (inline.line.paragraph === fieldEnd.fieldBegin.line.paragraph && !selection.hasValidInline(inline.line.paragraph, inline, fieldEnd.fieldBegin))) {\n                inline = fieldEnd.fieldBegin;\n            }\n            // tslint:disable-next-line:max-line-length\n            this.getPreviousWordOffset(inline, selection, inline.length, type, !(endPosition.paragraph === fieldEnd.line.paragraph && endPosition.offset === endOffset), isStarted, endSelection, endPosition);\n            if (endSelection && endPosition.paragraph === fieldEnd.line.paragraph\n                && endPosition.offset === startOffset) {\n                endPosition.setPositionParagraph(fieldEnd.line, endOffset);\n                return;\n            }\n            if (!endSelection) {\n                // tslint:disable-next-line:max-line-length\n                endPosition.setPositionParagraph(fieldEnd.fieldBegin.line, fieldEnd.fieldBegin.line.getOffset(fieldEnd.fieldBegin, 0));\n            }\n        }\n    };\n    /**\n     * get previous word offset from field separator\n     * @private\n     */\n    // tslint:disable-next-line:max-line-length\n    TextPosition.prototype.getPreviousWordOffsetFieldSeparator = function (fieldSeparator, selection, indexInInline, type, isInField, isStarted, endSelection, endPosition) {\n        this.getPreviousWordOffsetFieldBegin(fieldSeparator.fieldBegin, selection, fieldSeparator.fieldBegin.length, type, isInField, isStarted, endSelection, endPosition);\n    };\n    /**\n     * get previous word offset from field begin\n     * @private\n     */\n    // tslint:disable-next-line:max-line-length\n    TextPosition.prototype.getPreviousWordOffsetFieldBegin = function (fieldBegin, selection, indexInInline, type, isInField, isStarted, endSelection, endPosition) {\n        var startOffset = fieldBegin.line.getOffset(fieldBegin, 0);\n        var endOffset = startOffset + fieldBegin.length;\n        if (endPosition.offset === endOffset) {\n            endPosition.setPositionParagraph(fieldBegin.line, startOffset);\n        }\n        if (!isNullOrUndefined(fieldBegin.previousNode)) {\n            // tslint:disable-next-line:max-line-length\n            this.getPreviousWordOffset(fieldBegin.previousNode, selection, fieldBegin.previousNode.length, type, false, isStarted, endSelection, endPosition);\n            if (endPosition.offset === startOffset) {\n                if (type !== 0 && !isNullOrUndefined(fieldBegin.fieldSeparator)) {\n                    // tslint:disable-next-line:max-line-length\n                    endPosition.setPositionParagraph(fieldBegin.line, fieldBegin.fieldSeparator.line.getOffset(fieldBegin.fieldSeparator, fieldBegin.fieldSeparator.length));\n                }\n            }\n        }\n        else {\n            endPosition.setPositionParagraph(fieldBegin.line, selection.getStartLineOffset(fieldBegin.line));\n        }\n    };\n    /**\n     * get previous word offset from image\n     * @private\n     */\n    // tslint:disable-next-line:max-line-length\n    TextPosition.prototype.getPreviousWordOffsetImage = function (image, selection, indexInInline, type, isInField, isStarted, endSelection, endPosition) {\n        if (isInField) {\n            endPosition.setPositionParagraph(image.line, image.line.getOffset(image, indexInInline));\n            endSelection = false;\n            return;\n        }\n        if (indexInInline === image.length) {\n            var endOffset = image.line.getOffset(image, image.length);\n            if (endOffset === endPosition.offset) {\n                endPosition.setPositionParagraph(image.line, endOffset - image.length);\n            }\n            else {\n                endPosition.setPositionParagraph(image.line, endOffset);\n            }\n        }\n        else if (!isNullOrUndefined(image.previousNode)) {\n            // tslint:disable-next-line:max-line-length\n            this.getPreviousWordOffset(image.previousNode, selection, image.previousNode.length, type, isInField, isStarted, endSelection, endPosition);\n        }\n    };\n    /**\n     * Get previous word offset from span\n     * @private\n     */\n    // tslint:disable-next-line:max-line-length   \n    TextPosition.prototype.getPreviousWordOffsetSpan = function (span, selection, indexInInline, type, isInField, isStarted, endSelection, endPosition) {\n        if (span.text === '\\t' || span.text === '\\v') {\n            if (isInField) {\n                endSelection = false;\n                return;\n            }\n            if (indexInInline === span.length) {\n                endSelection = true;\n                var endOffset = span.line.getOffset(span, span.length);\n                if (endOffset === endPosition.offset) {\n                    endPosition.setPositionParagraph(span.line, endOffset - span.length);\n                }\n                else {\n                    endPosition.setPositionParagraph(span.line, endOffset);\n                }\n            }\n            else if (!isNullOrUndefined(span.previousNode)) {\n                // tslint:disable-next-line:max-line-length\n                this.getPreviousWordOffset(span.previousNode, selection, span.previousNode.length, type, isInField, isStarted, endSelection, endPosition);\n            }\n        }\n        else {\n            var wordStartIndex = 0;\n            if (!isStarted) {\n                while (indexInInline > 0 && span.text[indexInInline - 1] === ' ') {\n                    indexInInline--;\n                }\n                endPosition.setPositionParagraph(span.line, span.line.getOffset(span, indexInInline));\n            }\n            if (indexInInline > 0) {\n                isStarted = true;\n                if (indexInInline === 0 && endSelection && (HelperMethods.wordSplitCharacters.indexOf(span.text[0])) === -1) {\n                    endPosition.setPositionParagraph(span.line, span.line.getOffset(span, indexInInline));\n                    endSelection = true;\n                    return;\n                }\n                var txt = span.text.length > indexInInline ? span.text.slice(0, indexInInline) : span.text;\n                wordStartIndex = HelperMethods.lastIndexOfAny(txt, HelperMethods.wordSplitCharacters);\n                if (wordStartIndex !== -1) {\n                    if (isInField) {\n                        endSelection = false;\n                        return;\n                    }\n                    while (wordStartIndex > 0 && endSelection && txt[wordStartIndex] !== ' '\n                        && (HelperMethods.wordSplitCharacters.indexOf(txt[wordStartIndex - 1])) !== -1) {\n                        wordStartIndex--;\n                    }\n                    if (txt[wordStartIndex] === ' ' || txt[wordStartIndex] === 'ã€€' || !endSelection) {\n                        wordStartIndex++;\n                    }\n                    endSelection = true;\n                    if (wordStartIndex > 0) {\n                        var offset = span.line.getOffset(span, wordStartIndex);\n                        if (span.line.paragraph === endPosition.paragraph && offset === endPosition.offset) {\n                            // tslint:disable-next-line:max-line-length\n                            this.getPreviousWordOffsetSpan(span, selection, indexInInline, type, isInField, isStarted, endSelection, endPosition);\n                        }\n                        else {\n                            endPosition.setPositionParagraph(span.line, offset);\n                        }\n                    }\n                    else if (span.previousNode instanceof TextElementBox) {\n                        // tslint:disable-next-line:max-line-length\n                        this.getPreviousWordOffset(span.previousNode, selection, span.previousNode.length, type, isInField, isStarted, endSelection, endPosition);\n                    }\n                    else {\n                        endPosition.setPositionParagraph(span.line, span.line.getOffset(span, 0));\n                    }\n                }\n                else {\n                    this.setPreviousWordOffset(span, selection, indexInInline, type, isInField, isStarted, endSelection, endPosition);\n                }\n            }\n            else {\n                this.setPreviousWordOffset(span, selection, indexInInline, type, isInField, isStarted, endSelection, endPosition);\n            }\n        }\n    };\n    /**\n     * set previous word offset in span\n     * @private\n     */\n    // tslint:disable-next-line:max-line-length\n    TextPosition.prototype.setPreviousWordOffset = function (span, selection, indexInInline, type, isInField, isStarted, endSelection, endPosition) {\n        if (span.previousNode instanceof ElementBox && span.line === span.previousNode.line) {\n            // tslint:disable-next-line:max-line-length\n            this.getPreviousWordOffset(span.previousNode, selection, span.previousNode.length, type, isInField, isStarted, endSelection, endPosition);\n        }\n        else {\n            endPosition.setPositionParagraph(span.line, selection.getStartLineOffset(span.line));\n        }\n    };\n    /**\n     * Validate if text position is in field forward\n     * @private\n     */\n    TextPosition.prototype.validateForwardFieldSelection = function (currentIndex, selectionEndIndex) {\n        var textPosition = new TextPosition(this.owner);\n        textPosition.setPositionForCurrentIndex(currentIndex);\n        textPosition.isUpdateLocation = false;\n        var isPositionMoved = false;\n        while (currentIndex !== selectionEndIndex && TextPosition.isForwardSelection(currentIndex, selectionEndIndex)) {\n            if (!isPositionMoved) {\n                textPosition.moveNextPosition(false);\n                var nextIndex = textPosition.getHierarchicalIndexInternal();\n                //Handled specifically to break infinite looping, if selection ends at last paragraph mark.\n                if (currentIndex === nextIndex) {\n                    break;\n                }\n            }\n            var indexInInline = 0;\n            var inlineObj = textPosition.currentWidget.getInline(textPosition.offset, indexInInline);\n            var inline = inlineObj.element;\n            indexInInline = inlineObj.index;\n            if (!isNullOrUndefined(inline)) {\n                var selectionStartIndex = this.selection.start.getHierarchicalIndexInternal();\n                if (indexInInline === inline.length && inline instanceof FieldElementBox && inline.fieldType === 1) {\n                    if (inline.line.getOffset(inline, 0) === this.offset) {\n                        return;\n                    }\n                    var lineWidget = inline.fieldBegin.line;\n                    var fieldBeginOffset = lineWidget.getOffset(inline.fieldBegin, 0);\n                    var fieldBeginIndex = this.getHierarchicalIndex(lineWidget, fieldBeginOffset.toString());\n                    if (!TextPosition.isForwardSelection(selectionStartIndex, fieldBeginIndex)) {\n                        this.selection.start.setPositionParagraph(lineWidget, fieldBeginOffset);\n                    }\n                }\n                var nextInline = this.selection.getNextRenderedElementBox(inline, indexInInline);\n                if (!isNullOrUndefined(nextInline) && nextInline instanceof ElementBox) {\n                    inline = nextInline;\n                }\n            }\n            isPositionMoved = (inline instanceof FieldElementBox && inline.fieldType === 0 && !isNullOrUndefined(inline.fieldEnd));\n            if (isPositionMoved) {\n                if (inline.line.getOffset(inline, 0) === this.offset) {\n                    return;\n                }\n                var fieldEnd = inline.fieldEnd;\n                var paragraph = fieldEnd.line.paragraph;\n                var fieldEndOffset = fieldEnd.line.getOffset(fieldEnd, 1);\n                var fieldEndIndex = this.getHierarchicalIndex(fieldEnd.line, fieldEndOffset.toString());\n                if (!TextPosition.isForwardSelection(fieldEndIndex, selectionEndIndex)) {\n                    //If selection end is after field begin, extend selection end to field end.\n                    this.moveToInline(inline.fieldEnd, 1);\n                    return;\n                }\n                textPosition.moveToInline(inline.fieldEnd, 1);\n            }\n            currentIndex = textPosition.getHierarchicalIndexInternal();\n        }\n    };\n    /**\n     * Validate if text position is in field backward\n     * @private\n     */\n    TextPosition.prototype.validateBackwardFieldSelection = function (currentIndex, selectionEndIndex) {\n        var textPosition = new TextPosition(this.owner);\n        textPosition.setPositionForCurrentIndex(currentIndex);\n        textPosition.isUpdateLocation = false;\n        var selectionStartIndex = this.selection.start.getHierarchicalIndexInternal();\n        while (currentIndex !== selectionEndIndex && TextPosition.isForwardSelection(selectionEndIndex, currentIndex)) {\n            var indexInInline = 0;\n            var inlineObj = textPosition.currentWidget.getInline(textPosition.offset, indexInInline);\n            var inline = inlineObj.element;\n            indexInInline = inlineObj.index;\n            if (!isNullOrUndefined(inline)) {\n                var nextInline = this.selection.getNextRenderedElementBox(inline, indexInInline);\n                if (nextInline instanceof FieldElementBox && nextInline.fieldType === 0) {\n                    var paragraph = nextInline.fieldEnd.line;\n                    var fieldEndOffset = paragraph.getOffset(nextInline.fieldEnd, 1);\n                    var fieldEndIndex = this.getHierarchicalIndex(paragraph, fieldEndOffset.toString());\n                    if (!TextPosition.isForwardSelection(fieldEndIndex, selectionStartIndex)) {\n                        this.selection.start.setPositionParagraph(paragraph, fieldEndOffset);\n                        selectionStartIndex = fieldEndIndex;\n                    }\n                }\n            }\n            if (inline instanceof FieldElementBox && inline.fieldType === 1 && !isNullOrUndefined(inline.fieldBegin)) {\n                var line = inline.fieldBegin.line;\n                var fieldBegin = inline.fieldBegin;\n                var fieldBeginOffset = line.getOffset(fieldBegin, 0);\n                var fieldBeginIndex = this.getHierarchicalIndex(line, fieldBeginOffset.toString());\n                if (!TextPosition.isForwardSelection(selectionEndIndex, fieldBeginIndex)) {\n                    //If field begin is before selection end, extend selection end to field begin.\n                    this.moveToInline(inline.fieldBegin, 0);\n                    return;\n                }\n                textPosition.moveToInline(inline.fieldBegin, 0);\n            }\n            else {\n                textPosition.movePreviousPosition();\n            }\n            currentIndex = textPosition.getHierarchicalIndexInternal();\n        }\n    };\n    /**\n     * @private\n     */\n    TextPosition.prototype.paragraphStartInternal = function (selection, moveToPreviousParagraph) {\n        var offset = selection.getStartLineOffset(this.currentWidget);\n        if (this.offset === offset && moveToPreviousParagraph) {\n            var startParagraph = this.moveToNextParagraphInTableCheck();\n            if (startParagraph) {\n                this.moveToPreviousParagraphInTable(selection);\n            }\n            else if (!isNullOrUndefined(selection.getPreviousParagraphBlock(this.currentWidget.paragraph))) {\n                var paragraphValue = selection.getPreviousParagraphBlock(this.currentWidget.paragraph);\n                this.currentWidget = paragraphValue.childWidgets[0];\n                this.offset = selection.getStartLineOffset(this.currentWidget);\n            }\n        }\n        else {\n            this.currentWidget = this.currentWidget.paragraph.getSplitWidgets()[0].childWidgets[0];\n            this.offset = offset;\n        }\n        this.calculateOffset();\n    };\n    /**\n     * @private\n     */\n    TextPosition.prototype.calculateOffset = function () {\n        var selectionStartIndex = this.owner.selection.start.getHierarchicalIndexInternal();\n        var selectionEndIndex = this.getHierarchicalIndexInternal();\n        if (selectionStartIndex !== selectionEndIndex) {\n            this.validateBackwardFieldSelection(selectionStartIndex, selectionEndIndex);\n        }\n        this.updatePhysicalPosition(true);\n    };\n    /**\n     * Moves the text position to start of the paragraph.\n     * @private\n     */\n    TextPosition.prototype.moveToParagraphStartInternal = function (selection, moveToPreviousParagraph) {\n        var startOffset = selection.getStartOffset(this.paragraph);\n        if (this.offset === startOffset && moveToPreviousParagraph) {\n            var paragraphstart = this.moveToNextParagraphInTableCheck();\n            if (paragraphstart) {\n                this.moveToPreviousParagraphInTable(selection);\n            }\n            else if (!isNullOrUndefined(selection.getPreviousParagraphBlock(this.paragraph))) {\n                this.currentWidget = selection.getPreviousParagraphBlock(this.paragraph).firstChild;\n                this.offset = selection.getStartOffset(this.paragraph);\n            }\n        }\n        else {\n            this.currentWidget = this.paragraph.firstChild;\n            this.offset = selection.getStartLineOffset(this.currentWidget);\n        }\n        var selectionStartIndex = this.owner.selection.start.getHierarchicalIndexInternal();\n        var selectionEndIndex = this.getHierarchicalIndexInternal();\n        if (selectionStartIndex !== selectionEndIndex) {\n            this.validateBackwardFieldSelection(selectionStartIndex, selectionEndIndex);\n        }\n        this.updatePhysicalPosition(false);\n    };\n    /**\n     * Moves the text position to end of the paragraph.\n     * @private\n     */\n    TextPosition.prototype.moveToParagraphEndInternal = function (selection, moveToNextParagraph) {\n        // tslint:disable-next-line:max-line-length\n        var splittedParagraph = this.currentWidget.paragraph;\n        while (splittedParagraph.nextSplitWidget) {\n            splittedParagraph = splittedParagraph.nextSplitWidget;\n        }\n        this.currentWidget = splittedParagraph.childWidgets[splittedParagraph.childWidgets.length - 1];\n        var endOffset = this.currentWidget.getEndOffset() + 1;\n        if (this.offset === endOffset && moveToNextParagraph) {\n            var paragraphEnd = this.moveToNextParagraphInTableCheck();\n            if (paragraphEnd) {\n                this.moveToNextParagraphInTable();\n            }\n            else if (!isNullOrUndefined(selection.getNextParagraphBlock(this.currentWidget.paragraph))) {\n                var endParagraph = selection.getNextParagraphBlock(this.currentWidget.paragraph);\n                this.currentWidget = endParagraph.childWidgets[endParagraph.childWidgets.length - 1];\n                this.offset = this.currentWidget.getEndOffset() + 1;\n            }\n        }\n        else {\n            this.offset = endOffset;\n        }\n        this.calculateOffset();\n    };\n    /**\n     * @private\n     */\n    TextPosition.prototype.moveUp = function (selection, left) {\n        var paragraph = this.currentWidget.paragraph;\n        //Moves text position to start of line.\n        this.moveToLineStartInternal(selection, true);\n        //Moves previous line starting.\n        this.movePreviousPosition();\n        var prevLine = undefined;\n        var currentParagraph = this.currentWidget.paragraph;\n        if (paragraph.isInsideTable && paragraph !== currentParagraph && paragraph.associatedCell !== currentParagraph.associatedCell\n            // tslint:disable-next-line:max-line-length\n            && (!isNullOrUndefined(currentParagraph.associatedCell) && (paragraph.associatedCell.ownerRow === currentParagraph.associatedCell.ownerRow))) {\n            var ownerRow = currentParagraph.associatedCell.ownerRow;\n            if (ownerRow.previousRenderedWidget instanceof TableRowWidget) {\n                // tslint:disable-next-line:max-line-length\n                var cell = selection.getFirstCellInRegion(ownerRow.previousRenderedWidget, currentParagraph.associatedCell, left, true);\n                var lastParagraph = selection.getLastParagraph(cell);\n                this.setPosition(lastParagraph.childWidgets[lastParagraph.childWidgets.length - 1], false);\n            }\n            else {\n                var prevBlock = ownerRow.ownerTable.previousRenderedWidget;\n                do {\n                    if (prevBlock instanceof TableWidget) {\n                        prevBlock = selection.getLastBlockInLastCell(prevBlock);\n                    }\n                } while (prevBlock instanceof TableWidget);\n                if (prevBlock instanceof ParagraphWidget) {\n                    this.setPosition(prevBlock.childWidgets[prevBlock.childWidgets.length - 1], false);\n                }\n            }\n            prevLine = selection.getLineWidgetParagraph(this.offset, this.currentWidget);\n        }\n        else {\n            if (!paragraph.isInsideTable && this.currentWidget.paragraph.isInsideTable) {\n                // tslint:disable-next-line:max-line-length\n                var cell = selection.getFirstCellInRegion(this.currentWidget.paragraph.associatedCell.ownerRow, this.currentWidget.paragraph.associatedCell, this.owner.selection.upDownSelectionLength, true);\n                var lastParagraph = selection.getLastParagraph(cell);\n                this.setPosition(lastParagraph.childWidgets[lastParagraph.childWidgets.length - 1], false);\n                // tslint:disable-next-line:max-line-length\n            }\n            else if (paragraph.isInsideTable && (!isNullOrUndefined(this.currentWidget.paragraph.associatedCell) && paragraph.associatedCell.ownerRow.previousRenderedWidget !== paragraph.associatedCell.ownerRow.previousSplitWidget &&\n                paragraph.associatedCell.ownerRow.previousRenderedWidget === this.currentWidget.paragraph.associatedCell.ownerRow)) {\n                // tslint:disable-next-line:max-line-length\n                var cell = selection.getLastCellInRegion(this.currentWidget.paragraph.associatedCell.ownerRow, this.currentWidget.paragraph.associatedCell, this.owner.selection.upDownSelectionLength, true);\n                var lastParagraph = selection.getLastParagraph(cell);\n                this.setPosition(lastParagraph.childWidgets[lastParagraph.childWidgets.length - 1], false);\n            }\n            prevLine = selection.getLineWidgetParagraph(this.offset, this.currentWidget);\n        }\n        //Moves till the Up/Down selection width.\n        var top = selection.getTop(prevLine);\n        selection.updateTextPositionWidget(prevLine, new Point(left, top), this, false);\n    };\n    /**\n     * @private\n     */\n    TextPosition.prototype.moveDown = function (selection, left) {\n        //Moves text position to end of line.\n        var prevParagraph = this.currentWidget.paragraph;\n        var prevOffset = this.offset;\n        this.moveToLineEndInternal(selection, true);\n        var length = this.selection.getParagraphLength(this.currentWidget.paragraph);\n        if (this.offset > length) {\n            this.offset = length;\n        }\n        //Moves next line starting.\n        this.moveNextPosition();\n        var nextLine = undefined;\n        // tslint:disable-next-line:max-line-length\n        if (prevParagraph.isInsideTable && prevParagraph !== this.currentWidget.paragraph && prevParagraph.associatedCell !== this.currentWidget.paragraph.associatedCell && (!isNullOrUndefined(this.currentWidget.paragraph.associatedCell) && prevParagraph.associatedCell.ownerRow === this.currentWidget.paragraph.associatedCell.ownerRow)) {\n            var ownerRow = this.currentWidget.paragraph.associatedCell.ownerRow;\n            // tslint:disable-next-line:max-line-length\n            if (prevParagraph.isInsideTable && this.currentWidget.paragraph.isInsideTable && prevParagraph.associatedCell.cellFormat.rowSpan > 1 && prevParagraph.associatedCell.cellFormat.rowSpan + prevParagraph.associatedCell.ownerRow.rowIndex === prevParagraph.associatedCell.ownerTable.childWidgets.length) {\n                //If the prevParagraph  owner cell is Verically merged upto the last row, then theposition moved to next column. the position moved to out of the current tabel so owner row is assigned to last row.\n                // tslint:disable-next-line:max-line-length\n                ownerRow = this.currentWidget.paragraph.associatedCell.ownerTable.childWidgets[this.currentWidget.paragraph.associatedCell.ownerTable.childWidgets.length - 1];\n            }\n            if (ownerRow.nextRenderedWidget instanceof TableRowWidget) {\n                // tslint:disable-next-line:max-line-length\n                var cell = this.selection.getLastCellInRegion(ownerRow.nextRenderedWidget, this.currentWidget.paragraph.associatedCell, left, false);\n                this.setPosition(this.selection.getFirstParagraph(cell).childWidgets[0], true);\n            }\n            else {\n                var nextBlock = this.selection.getNextRenderedBlock(ownerRow.ownerTable);\n                do {\n                    if (nextBlock instanceof TableWidget) {\n                        nextBlock = this.selection.getFirstBlockInFirstCell(nextBlock);\n                    }\n                } while (nextBlock instanceof TableWidget);\n                if (nextBlock instanceof ParagraphWidget) {\n                    this.setPosition(nextBlock.childWidgets[0], true);\n                }\n            }\n            nextLine = selection.getLineWidgetParagraph(this.offset, this.currentWidget);\n        }\n        else {\n            if (!prevParagraph.isInsideTable && this.currentWidget.paragraph.isInsideTable) {\n                // tslint:disable-next-line:max-line-length\n                var cell = this.selection.getLastCellInRegion(this.currentWidget.paragraph.associatedCell.ownerRow, this.currentWidget.paragraph.associatedCell, this.owner.selection.upDownSelectionLength, false);\n                this.setPosition(this.selection.getFirstParagraph(cell).childWidgets[0], true);\n                // tslint:disable-next-line:max-line-length\n            }\n            else if (prevParagraph.isInsideTable && (!isNullOrUndefined(this.currentWidget.paragraph.associatedCell) && prevParagraph.associatedCell.ownerRow.nextRenderedWidget !== prevParagraph.associatedCell.ownerRow.nextSplitWidget\n                && prevParagraph.associatedCell.ownerRow.nextRenderedWidget === this.currentWidget.paragraph.associatedCell.ownerRow)) {\n                // tslint:disable-next-line:max-line-length\n                var cell = selection.getLastCellInRegion(this.currentWidget.paragraph.associatedCell.ownerRow, this.currentWidget.paragraph.associatedCell, this.owner.selection.upDownSelectionLength, true);\n                this.setPosition(selection.getFirstParagraph(cell).childWidgets[0], false);\n            }\n            nextLine = selection.getLineWidgetParagraph(this.offset, this.currentWidget);\n        }\n        //Moves till the Up/Down selection width.\n        var top = this.selection.getTop(nextLine);\n        this.selection.updateTextPositionWidget(nextLine, new Point(left, top), this, false);\n    };\n    /**\n     * Moves the text position to start of the line.\n     * @private\n     */\n    TextPosition.prototype.moveToLineStartInternal = function (selection, moveToPreviousLine) {\n        if (this.location.x > this.viewer.clientActiveArea.right) {\n            this.offset = this.offset - 1;\n        }\n        var currentLine = selection.getLineWidgetInternal(this.currentWidget, this.offset, moveToPreviousLine);\n        var firstElement = selection.getFirstElementInternal(currentLine);\n        var startOffset = selection.getStartOffset(this.currentWidget.paragraph);\n        if (isNullOrUndefined(firstElement) && this.offset > startOffset) {\n            var index = 0;\n            var inlineObj = this.currentWidget.getInline(this.offset, index);\n            var inline = inlineObj.element;\n            index = inlineObj.index;\n            if (inline instanceof TextElementBox && inline.text !== '\\v') {\n                this.offset = startOffset;\n            }\n        }\n        else if (!isNullOrUndefined(firstElement)) {\n            var indexInInline = selection.getIndexInInline(firstElement);\n            this.currentWidget = firstElement.line;\n            this.offset = this.currentWidget.getOffset(firstElement, indexInInline);\n            indexInInline = 0;\n            var inlineObj = this.currentWidget.getInline(this.offset, indexInInline);\n            var inline = inlineObj.element;\n            indexInInline = inlineObj.index;\n            if (inline instanceof FieldElementBox) {\n                //Checks if field character is part of rendered field, otherwise moves to previous rendered content.\n                var prevInline = selection.getPreviousValidElement(inline);\n                if (!isNullOrUndefined(prevInline)) {\n                    inline = prevInline;\n                    this.currentWidget = inline.line;\n                    this.offset = this.currentWidget.getOffset(inline, inline.length);\n                    if (inline instanceof FieldElementBox) {\n                        this.offset--;\n                    }\n                }\n            }\n        }\n        this.updatePhysicalPosition(true);\n    };\n    /**\n     * Check paragraph is inside table\n     * @private\n     */\n    TextPosition.prototype.moveToNextParagraphInTableCheck = function () {\n        if ((this.selection.start.paragraph.isInsideTable || this.paragraph.isInsideTable)\n            && (this.selection.start.paragraph.associatedCell !== this.paragraph.associatedCell\n                || this.selection.isCellSelected(this.selection.start.paragraph.associatedCell, this.selection.start, this))) {\n            return true;\n        }\n        return false;\n    };\n    /**\n     * Moves the text position to end of the word.\n     * @private\n     */\n    TextPosition.prototype.moveToWordEndInternal = function (type, excludeSpace) {\n        // type === 0 -------->CTRL+ARROW Navigation\n        // type === 1 -------->CTRL+SHIFT+ARROW Selection\n        // type === 2 -------->Double-tap Word Selection\n        var incrementValue = 0;\n        var endOffset = this.currentWidget.getEndOffset();\n        if (this.selection.isParagraphFirstLine(this.currentWidget)) {\n            if (this.currentWidget.children[0] instanceof ListTextElementBox) {\n                incrementValue = 1;\n            }\n            if (this.currentWidget.children[1] instanceof ListTextElementBox) {\n                incrementValue = 2;\n            }\n        }\n        if (this.offset + incrementValue === endOffset || this.offset === endOffset + 1) {\n            if (this.offset === endOffset && type !== 0) {\n                this.setPositionParagraph(this.currentWidget, endOffset + 1);\n            }\n            else {\n                var nextParagraph = this.selection.getNextParagraphBlock(this.currentWidget.paragraph);\n                if (isNullOrUndefined(nextParagraph)) {\n                    return;\n                }\n                this.currentWidget = nextParagraph.childWidgets[0];\n                this.offset = this.selection.getStartLineOffset(this.currentWidget);\n                if (type === 1) {\n                    // tslint:disable-next-line:max-line-length\n                    var nextWord = this.moveToNextParagraphInTableCheck();\n                    if (nextWord) {\n                        this.moveToNextParagraphInTable();\n                    }\n                    else {\n                        this.moveToWordEndInternal(type, excludeSpace);\n                    }\n                }\n            }\n        }\n        else {\n            var indexInInline = 0;\n            var endSelection = false;\n            var inlineObj = this.currentWidget.getInline(this.offset, indexInInline);\n            var inline = inlineObj.element;\n            indexInInline = inlineObj.index;\n            this.getNextWordOffset(inline, indexInInline, type, false, endSelection, this, excludeSpace);\n        }\n        if (type !== 0) {\n            var selectionStartIndex = this.owner.selection.start.getHierarchicalIndexInternal();\n            var selectionEndIndex = this.getHierarchicalIndexInternal();\n            if (selectionStartIndex !== selectionEndIndex) {\n                this.validateForwardFieldSelection(selectionStartIndex, selectionEndIndex);\n            }\n        }\n        this.updatePhysicalPosition(true);\n    };\n    /**\n     * move text position to next paragraph inside table\n     * @private\n     */\n    TextPosition.prototype.moveToNextParagraphInTable = function () {\n        var paragraph = this.currentWidget.paragraph;\n        var nextParagraph = (paragraph.isInsideTable) ? this.selection.getNextSelectionCell(paragraph.associatedCell) :\n            this.selection.getNextParagraphBlock(paragraph);\n        if (isNullOrUndefined(nextParagraph)) {\n            return;\n        }\n        this.currentWidget = nextParagraph.childWidgets[nextParagraph.childWidgets.length - 1];\n        this.offset = this.currentWidget.getEndOffset() + 1;\n    };\n    /**\n     * Moves the text position to start of the previous paragraph.\n     */\n    TextPosition.prototype.moveToPreviousParagraph = function (selection) {\n        var startOffset = selection.getStartOffset(this.currentWidget.paragraph);\n        // tslint:disable-next-line:max-line-length\n        if (this.offset === startOffset && !isNullOrUndefined(selection.getPreviousParagraphBlock(this.currentWidget.paragraph))) {\n            var previousParagraph = selection.getPreviousParagraphBlock(this.currentWidget.paragraph);\n            this.currentWidget = previousParagraph.childWidgets[0];\n            this.offset = selection.getStartOffset(this.currentWidget.paragraph);\n        }\n        else {\n            this.offset = selection.getStartOffset(this.currentWidget.paragraph);\n        }\n        this.updatePhysicalPosition(true);\n    };\n    /**\n     * Move to previous line from current position\n     * @private\n     */\n    TextPosition.prototype.moveToPreviousLine = function (selection, left) {\n        var currentIndex = this.getHierarchicalIndexInternal();\n        var currentLine = selection.getLineWidgetParagraph(this.offset, this.currentWidget);\n        //Moves text position to start of line.\n        this.moveToLineStartInternal(selection, true);\n        if (this.currentWidget.paragraph.isInsideTable) {\n            this.moveUpInTable(selection);\n        }\n        else {\n            this.moveBackward();\n        }\n        var prevLine = selection.getLineWidgetParagraph(this.offset, this.currentWidget);\n        var lineStart = selection.getLeft(prevLine);\n        var lineWidth = selection.getWidth(prevLine, true);\n        //Moves till the Up/Down selection width.\n        if (lineWidth + lineStart >= left && currentLine !== prevLine) {\n            var top_1 = selection.getTop(prevLine);\n            var point = new Point(left, top_1);\n            selection.updateTextPositionWidget(prevLine, point, this, true);\n        }\n        //Checks if the current position is between field result, then move to field begin.\n        var selectionEndIndex = this.getHierarchicalIndexInternal();\n        this.validateBackwardFieldSelection(currentIndex, selectionEndIndex);\n    };\n    /**\n     * @private\n     */\n    TextPosition.prototype.moveToLineEndInternal = function (selection, moveToNextLine) {\n        if (this.location.x > this.viewer.clientActiveArea.right) {\n            this.offset = this.offset - 1;\n        }\n        var currentLine = selection.getLineWidgetParagraph(this.offset, this.currentWidget);\n        var firstElement = selection.getFirstElementInternal(currentLine);\n        if (isNullOrUndefined(firstElement) && this.offset === selection.getStartLineOffset(this.currentWidget)) {\n            this.offset = selection.getParagraphLength(this.paragraph) + 1;\n            this.updatePhysicalPosition(true);\n        }\n        else if (!isNullOrUndefined(firstElement)) {\n            var lastElement = currentLine.children[currentLine.children.length - 1];\n            var index = 0;\n            index += lastElement instanceof TextElementBox ? lastElement.length : 1;\n            this.currentWidget = lastElement.line;\n            if (index === lastElement.length\n                && isNullOrUndefined(lastElement.nextNode) && selection.isParagraphLastLine(this.currentWidget)) {\n                var length_1 = selection.getLineLength(this.currentWidget);\n                this.offset = moveToNextLine ? length_1 + 1 : length_1;\n            }\n            else {\n                var inline = lastElement;\n                while (!isNullOrUndefined(inline) && inline.length === index && inline.nextNode instanceof FieldElementBox) {\n                    var nextInline = selection.getNextValidElement(inline.nextNode);\n                    if (inline !== nextInline) {\n                        inline = nextInline;\n                        index = 0;\n                    }\n                    if (inline instanceof FieldElementBox && inline.fieldType === 0\n                        && !isNullOrUndefined(inline.fieldEnd)) {\n                        var fieldBegin = inline;\n                        if (isNullOrUndefined(fieldBegin.fieldSeparator)) {\n                            inline = fieldBegin.fieldEnd;\n                        }\n                        else {\n                            inline = fieldBegin.fieldSeparator;\n                            this.currentWidget = inline.line;\n                            if (this.currentWidget === fieldBegin.fieldEnd.line\n                                && !selection.hasValidInline(this.currentWidget.paragraph, inline, fieldBegin.fieldEnd)) {\n                                inline = fieldBegin.fieldEnd;\n                            }\n                        }\n                        this.currentWidget = inline.line;\n                    }\n                    if (inline instanceof FieldElementBox) {\n                        index = 1;\n                    }\n                }\n                if (index === inline.length && isNullOrUndefined(inline.nextNode)) {\n                    index++;\n                }\n                if (!moveToNextLine && inline instanceof ElementBox && inline.text === '\\v') {\n                    index--;\n                }\n                this.offset = this.currentWidget.getOffset(inline, index);\n            }\n            this.updatePhysicalPosition(moveToNextLine);\n        }\n    };\n    /**\n     * Move to next line\n     * @private\n     */\n    TextPosition.prototype.moveToNextLine = function (left) {\n        var selection = this.selection;\n        var textPosition = new TextPosition(this.owner);\n        textPosition.setPositionInternal(this);\n        var currentIndex = this.getHierarchicalIndexInternal();\n        var currentLine = selection.getLineWidgetParagraph(this.offset, this.currentWidget);\n        var isAtLineStart = this.offset === 0 ? true : false;\n        //Moves text position to end of line.\n        this.moveToLineEndInternal(selection, true);\n        var isMoveToLineEnd = !textPosition.isAtSamePosition(this);\n        textPosition.setPositionInternal(this);\n        if (this.currentWidget.paragraph.isInsideTable) {\n            this.moveDownInTable(selection);\n        }\n        else {\n            this.moveNextPosition();\n            this.moveForward();\n        }\n        var nextLine = selection.getLineWidgetParagraph(this.offset, this.currentWidget);\n        var lineStart = selection.getLeft(nextLine);\n        var firstElement = selection.getFirstElementInternal(nextLine);\n        // tslint:disable-next-line:max-line-length\n        var firstItemWidth = isNullOrUndefined(firstElement) ? selection.getWidth(nextLine, true) : selection.getLeftInternal(nextLine, firstElement, 1) - lineStart;\n        //Moves till the Up/Down selection width.\n        if (lineStart < left && (firstItemWidth / 2 < left - lineStart)) {\n            var top_2 = selection.getTop(nextLine);\n            var point = new Point(left, top_2);\n            selection.updateTextPositionWidget(nextLine, point, this, true);\n            var width = selection.getWidth(nextLine, true);\n            if (width < left - lineStart) {\n                this.moveToLineEndInternal(selection, true);\n            }\n        }\n        else if (isMoveToLineEnd && this.currentWidget.paragraph.isInsideTable\n            && this.currentWidget === this.owner.selection.start.currentWidget) {\n            this.setPositionInternal(textPosition);\n        }\n        else if (!isMoveToLineEnd) {\n            this.moveToLineEndInternal(selection, true);\n        }\n        //Checks if the current position is between field result, then move to field end.\n        var selectionEndIndex = this.getHierarchicalIndexInternal();\n        this.validateForwardFieldSelection(currentIndex, selectionEndIndex);\n    };\n    /**\n     * Move upward in table\n     * @private\n     */\n    TextPosition.prototype.moveUpInTable = function (selection) {\n        var isPositionUpdated = false;\n        var end = this.owner.selection.end;\n        var isBackwardSelection = !this.owner.selection.isEmpty;\n        isPositionUpdated = end.paragraph.isInsideTable;\n        if (isPositionUpdated) {\n            var startCell = this.currentWidget.paragraph.associatedCell;\n            var endCell = end.paragraph.associatedCell;\n            var containerCell = selection.getContainerCellOf(endCell, startCell);\n            isPositionUpdated = containerCell.ownerTable.contains(startCell);\n            if (isPositionUpdated) {\n                endCell = selection.getSelectedCell(endCell, containerCell);\n                startCell = selection.getSelectedCell(startCell, containerCell);\n                // tslint:disable-next-line:max-line-length\n                var isInContainerCell = selection.containsCell(containerCell, this.currentWidget.paragraph.associatedCell);\n                var isContainerCellSelected = selection.isCellSelected(containerCell, this, end);\n                if (!isContainerCellSelected) {\n                    // tslint:disable-next-line:max-line-length\n                    isContainerCellSelected = this.currentWidget.paragraph === selection.getFirstParagraph(containerCell) && this.isAtParagraphStart;\n                }\n                if ((isInContainerCell && isContainerCellSelected\n                    || !isInContainerCell) && !isNullOrUndefined(startCell.ownerRow.previousRenderedWidget)) {\n                    //Moves to cell in previous row.\n                    var row = startCell.ownerRow.previousRenderedWidget;\n                    // tslint:disable-next-line:max-line-length\n                    var cell = selection.getFirstCellInRegion(row, containerCell, this.owner.selection.upDownSelectionLength, true);\n                    var previousParagraph = selection.getLastParagraph(cell);\n                    this.setPosition(previousParagraph.childWidgets[0], true);\n                    return;\n                }\n                else if (isInContainerCell && isContainerCellSelected\n                    && isNullOrUndefined(startCell.ownerRow.previousRenderedWidget) || !isInContainerCell) {\n                    if (isBackwardSelection) {\n                        //Moves to first cell of row.\n                        startCell = startCell.ownerRow.childWidgets[0];\n                        var previousParagraph = selection.getFirstParagraph(startCell);\n                        this.setPosition(previousParagraph.childWidgets[0], true);\n                    }\n                    else {\n                        //Moves to last cell of row.\n                        startCell = startCell.ownerRow.childWidgets[startCell.ownerRow.childWidgets.length - 1];\n                        var previousParagraph = selection.getLastParagraph(startCell);\n                        this.setPosition(previousParagraph.childWidgets[0], false);\n                    }\n                }\n            }\n        }\n        if (!isPositionUpdated) {\n            //Moves to previous row / previous block.\n            var cell = selection.getContainerCell(this.currentWidget.paragraph.associatedCell);\n            if (isBackwardSelection) {\n                //Moves to first cell of row.\n                cell = cell.ownerRow.childWidgets[0];\n                var previousParagraph = selection.getFirstParagraph(cell);\n                this.setPosition(previousParagraph.childWidgets[0], true);\n            }\n            else {\n                //Moves to end of row.\n                cell = cell.ownerRow.childWidgets[cell.ownerRow.childWidgets.length - 1];\n                var previousParagraph = selection.getLastParagraph(cell);\n                this.setPosition(previousParagraph.childWidgets[0], false);\n            }\n        }\n        //Moves to previous row / previous block.\n        this.moveBackward();\n    };\n    /**\n     * Move down inside table\n     * @private\n     */\n    TextPosition.prototype.moveDownInTable = function (selection) {\n        var isPositionUpdated = false;\n        var isForwardSelection = this.owner.selection.isEmpty || this.owner.selection.isForward;\n        isPositionUpdated = this.owner.selection.start.paragraph.isInsideTable;\n        if (isPositionUpdated) {\n            var startCell = this.owner.selection.start.paragraph.associatedCell;\n            var endCell = this.currentWidget.paragraph.associatedCell;\n            var containerCell = selection.getContainerCellOf(startCell, endCell);\n            isPositionUpdated = containerCell.ownerTable.contains(endCell);\n            if (isPositionUpdated) {\n                startCell = selection.getSelectedCell(startCell, containerCell);\n                endCell = selection.getSelectedCell(endCell, containerCell);\n                // tslint:disable-next-line:max-line-length\n                var isInContainerCell = selection.containsCell(containerCell, this.currentWidget.paragraph.associatedCell);\n                var isContainerCellSelected = selection.isCellSelected(containerCell, this.owner.selection.start, this);\n                if ((isInContainerCell && isContainerCellSelected\n                    || !isInContainerCell) && !isNullOrUndefined(endCell.ownerRow.nextRenderedWidget)) {\n                    //Moves to cell in next row.\n                    var row = endCell.ownerRow.nextRenderedWidget;\n                    // tslint:disable-next-line:max-line-length\n                    var cell = selection.getLastCellInRegion(row, containerCell, this.owner.selection.upDownSelectionLength, false);\n                    var lastParagraph = selection.getLastParagraph(cell);\n                    this.setPosition(lastParagraph.childWidgets[lastParagraph.childWidgets.length - 1], false);\n                    return;\n                }\n                else if (isInContainerCell && isContainerCellSelected\n                    && isNullOrUndefined(endCell.ownerRow.nextRenderedWidget) || !isInContainerCell) {\n                    if (isForwardSelection) {\n                        //Moves to last cell of row.\n                        endCell = endCell.ownerRow.childWidgets[endCell.ownerRow.childWidgets.length - 1];\n                        var lastParagraph = selection.getLastParagraph(endCell);\n                        this.setPosition(lastParagraph.childWidgets[lastParagraph.childWidgets.length - 1], false);\n                    }\n                    else {\n                        //Moves to first cell of row.\n                        endCell = endCell.ownerRow.childWidgets[0];\n                        var lastParagraph = selection.getFirstParagraph(endCell);\n                        this.setPosition(lastParagraph.childWidgets[lastParagraph.childWidgets.length - 1], true);\n                    }\n                }\n            }\n        }\n        if (!isPositionUpdated) {\n            //Moves to next row / next block.\n            var cell = selection.getContainerCell(this.currentWidget.paragraph.associatedCell);\n            if (isForwardSelection) {\n                //Moves to end of row.\n                cell = cell.ownerRow.childWidgets[cell.ownerRow.childWidgets.length - 1];\n                var lastParagraph = selection.getLastParagraph(cell);\n                this.setPosition(lastParagraph.childWidgets[lastParagraph.childWidgets.length - 1], false);\n            }\n            else if (cell.ownerRow.nextRenderedWidget) {\n                //Moves to first cell of row.\n                cell = cell.ownerRow.nextRenderedWidget.childWidgets[0];\n                var lastParagraph = selection.getFirstParagraph(cell);\n                this.setPosition(lastParagraph.childWidgets[lastParagraph.childWidgets.length - 1], true);\n            }\n        }\n        //Moves to next row / next block.\n        this.moveForward();\n    };\n    /**\n     * @private\n     */\n    TextPosition.prototype.destroy = function () {\n        this.offset = undefined;\n        this.isUpdateLocation = undefined;\n        if (!isNullOrUndefined(this.location)) {\n            this.location.destroy();\n        }\n        this.location = undefined;\n        this.currentWidget = undefined;\n        this.owner = undefined;\n        this.viewer = undefined;\n    };\n    return TextPosition;\n}());\nexport { TextPosition };\n/**\n * @private\n */\nvar SelectionWidgetInfo = /** @class */ (function () {\n    function SelectionWidgetInfo(left, width) {\n        this.leftIn = 0;\n        this.widthIn = 0;\n        this.leftIn = left;\n        this.widthIn = width;\n    }\n    Object.defineProperty(SelectionWidgetInfo.prototype, \"left\", {\n        /**\n         * @private\n         */\n        get: function () {\n            return this.leftIn;\n        },\n        /**\n         * @private\n         */\n        set: function (value) {\n            this.leftIn = value;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(SelectionWidgetInfo.prototype, \"width\", {\n        /**\n         * @private\n         */\n        get: function () {\n            return this.widthIn;\n        },\n        /**\n         * @private\n         */\n        set: function (value) {\n            this.widthIn = value;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    /**\n     * @private\n     */\n    SelectionWidgetInfo.prototype.destroy = function () {\n        this.widthIn = undefined;\n        this.leftIn = undefined;\n    };\n    return SelectionWidgetInfo;\n}());\nexport { SelectionWidgetInfo };\n/**\n * @private\n */\nvar Hyperlink = /** @class */ (function () {\n    function Hyperlink(fieldBeginAdv, selection) {\n        this.linkInternal = '';\n        this.localRef = '';\n        this.opensNewWindow = false;\n        var fieldCode = selection.getFieldCode(fieldBeginAdv);\n        var lowercase = fieldCode.toLowerCase();\n        if (lowercase.substring(0, 9) === 'hyperlink') {\n            this.parseFieldValues(fieldCode.substring(9).trim(), selection);\n        }\n    }\n    Object.defineProperty(Hyperlink.prototype, \"navigationLink\", {\n        /**\n         * Gets navigation link.\n         * @returns string\n         * @private\n         */\n        get: function () {\n            return this.linkInternal;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(Hyperlink.prototype, \"localReference\", {\n        /**\n         * Gets the local reference if any.\n         * @returns string\n         * @private\n         */\n        get: function () {\n            return this.localRef;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(Hyperlink.prototype, \"linkType\", {\n        /**\n         * Gets hyper link type.\n         * @returns HyperLinkType\n         * @private\n         */\n        get: function () {\n            return this.typeInternal;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    /**\n     * Parse field values\n     * @param  {string} value\n     * @returns Void\n     */\n    Hyperlink.prototype.parseFieldValues = function (value, selection) {\n        var codes = value.split(' ');\n        var isLocalRef = false;\n        for (var i = 0; i < codes.length; i++) {\n            var code = codes[i];\n            if (code.length < 1) {\n                continue;\n            }\n            if (code === '\\\\t' || code === '\\\\l') {\n                isLocalRef = true;\n            }\n            else if (code === '\\\\n') {\n                this.opensNewWindow = true;\n            }\n            else {\n                code = this.parseFieldValue(code, code[0] === '\\\"' ? '\\\"' : undefined);\n                if (isLocalRef) {\n                    this.localRef = code;\n                    isLocalRef = false;\n                }\n                else {\n                    this.linkInternal = code;\n                }\n            }\n        }\n        this.setLinkType();\n    };\n    Hyperlink.prototype.parseFieldValue = function (value, endChar) {\n        value = value.substring(1);\n        var endIndex = endChar ? value.indexOf(endChar) : -1;\n        if (endIndex < 0) {\n            endIndex = value.length;\n        }\n        return value.substring(0, endIndex).trim();\n    };\n    Hyperlink.prototype.setLinkType = function () {\n        // If only local reference.\n        if (isNullOrUndefined(this.linkInternal) || this.linkInternal.length < 1) {\n            this.typeInternal = 'Bookmark';\n            return;\n        }\n        // Validates link.\n        if (this.linkInternal.substring(0, 4) === ('www.')) {\n            this.linkInternal = 'http://' + this.navigationLink;\n        }\n        else if (this.linkInternal[0] === '@') {\n            this.linkInternal = 'mailto:' + this.navigationLink;\n        }\n        // Finds proper link type.\n        if (this.linkInternal.substring(0, 7) === 'http://'\n            || this.linkInternal.substring(0, 8) === 'https://') {\n            this.typeInternal = 'WebPage';\n        }\n        else if (this.linkInternal.substring(0, 7) === 'mailto:') {\n            this.typeInternal = 'Email';\n        }\n        else {\n            this.typeInternal = 'File';\n        }\n    };\n    /**\n     * @private\n     */\n    Hyperlink.prototype.destroy = function () {\n        this.linkInternal = undefined;\n        this.localRef = undefined;\n        this.typeInternal = undefined;\n        this.opensNewWindow = undefined;\n    };\n    return Hyperlink;\n}());\nexport { Hyperlink };\n/**\n * @private\n */\nvar ImageFormat = /** @class */ (function () {\n    /**\n     * Constructor for image format class\n     * @param imageContainer - Specifies for image width and height values.\n     */\n    function ImageFormat(imageContainer) {\n        /**\n         * @private\n         */\n        this.width = 0;\n        /**\n         * @private\n         */\n        this.height = 0;\n        this.width = imageContainer.width;\n        this.height = imageContainer.height;\n    }\n    /**\n     * Dispose the internal objects which are maintained.\n     * @private\n     */\n    ImageFormat.prototype.destroy = function () {\n        this.width = undefined;\n        this.height = undefined;\n    };\n    return ImageFormat;\n}());\nexport { ImageFormat };\n","import { Widget, BodyWidget, TableRowWidget, TableWidget, LineWidget, ElementBox, TextElementBox, ListTextElementBox, ImageElementBox, ParagraphWidget, TableCellWidget, FieldElementBox, BlockWidget, HeaderFooterWidget, BlockContainer, BookmarkElementBox } from '../viewer/page';\nimport { HelperMethods } from '../editor/editor-helper';\nimport { SelectionCharacterFormat, SelectionCellFormat, SelectionParagraphFormat, SelectionRowFormat, SelectionSectionFormat, SelectionTableFormat, SelectionImageFormat } from './selection-format';\nimport { Point } from '../editor/editor-helper';\nimport { isNullOrUndefined, createElement, L10n } from '@syncfusion/ej2-base';\nimport { Dictionary } from '../../base/dictionary';\nimport { WParagraphFormat, WParagraphStyle } from '../index';\nimport { HtmlExport } from '../writer/html-export';\nimport { Popup } from '@syncfusion/ej2-popups';\nimport { TextPosition, SelectionWidgetInfo, Hyperlink } from './selection-helper';\n/**\n * Selection\n */\nvar Selection = /** @class */ (function () {\n    /**\n     * @private\n     */\n    function Selection(documentEditor) {\n        var _this = this;\n        /**\n         * @private\n         */\n        this.upDownSelectionLength = 0;\n        /**\n         * @private\n         */\n        this.isSkipLayouting = false;\n        /**\n         * @private\n         */\n        this.isImageSelected = false;\n        this.contextTypeInternal = undefined;\n        /**\n         * @private\n         */\n        this.caret = undefined;\n        //Format Retrieval Field\n        /**\n         * @private\n         */\n        this.isRetrieveFormatting = false;\n        /**\n         * @private\n         */\n        this.skipFormatRetrieval = false;\n        this.isMoveDownOrMoveUp = false;\n        /**\n         * @private\n         */\n        this.selectedWidgets = undefined;\n        /**\n         * Hides caret.\n         * @private\n         */\n        this.hideCaret = function () {\n            _this.caret.style.display = 'none';\n        };\n        this.owner = documentEditor;\n        this.viewer = this.owner.viewer;\n        this.start = new TextPosition(this.owner);\n        this.end = new TextPosition(this.owner);\n        this.selectedWidgets = new Dictionary();\n        this.characterFormatIn = new SelectionCharacterFormat(this);\n        this.paragraphFormatIn = new SelectionParagraphFormat(this, this.viewer);\n        this.sectionFormatIn = new SelectionSectionFormat(this);\n        this.rowFormatIn = new SelectionRowFormat(this);\n        this.cellFormatIn = new SelectionCellFormat(this);\n        this.tableFormatIn = new SelectionTableFormat(this);\n        this.imageFormatInternal = new SelectionImageFormat(this);\n    }\n    Object.defineProperty(Selection.prototype, \"htmlWriter\", {\n        /**\n         * @private\n         */\n        get: function () {\n            if (isNullOrUndefined(this.htmlWriterIn)) {\n                this.htmlWriterIn = new HtmlExport();\n            }\n            return this.htmlWriterIn;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(Selection.prototype, \"start\", {\n        /**\n         * Gets the start text position of last range in the selection\n         * @returns {TextPosition}\n         * @private\n         */\n        get: function () {\n            if (!isNullOrUndefined(this.owner) && !isNullOrUndefined(this.viewer)) {\n                if (isNullOrUndefined(this.startInternal)) {\n                    this.startInternal = this.owner.documentStart;\n                }\n                return this.startInternal;\n            }\n            return undefined;\n        },\n        /**\n         * @private\n         */\n        set: function (value) {\n            this.startInternal = value;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(Selection.prototype, \"characterFormat\", {\n        //Format retrieval properties\n        /**\n         * Gets the instance of selection character format.\n         * @default undefined\n         * @return {SelectionCharacterFormat}\n         */\n        get: function () {\n            return this.characterFormatIn;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(Selection.prototype, \"paragraphFormat\", {\n        /**\n         * Gets the instance of selection paragraph format.\n         * @default undefined\n         * @return {SelectionParagraphFormat}\n         */\n        get: function () {\n            return this.paragraphFormatIn;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(Selection.prototype, \"sectionFormat\", {\n        /**\n         * Gets the instance of selection section format.\n         * @default undefined\n         * @return {SelectionSectionFormat}\n         */\n        get: function () {\n            return this.sectionFormatIn;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(Selection.prototype, \"tableFormat\", {\n        /**\n         * Gets the instance of selection table format.\n         * @default undefined\n         * @return {SelectionTableFormat}\n         */\n        get: function () {\n            return this.tableFormatIn;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(Selection.prototype, \"cellFormat\", {\n        /**\n         * Gets the instance of selection cell format.\n         * @default undefined\n         * @return {SelectionCellFormat}\n         */\n        get: function () {\n            return this.cellFormatIn;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(Selection.prototype, \"rowFormat\", {\n        /**\n         * Gets the instance of selection row format.\n         * @default undefined\n         * @returns SelectionRowFormat\n         */\n        get: function () {\n            return this.rowFormatIn;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(Selection.prototype, \"imageFormat\", {\n        /**\n         * Gets the instance of selection image format.\n         * @default undefined\n         * @returns SelectionImageFormat\n         */\n        get: function () {\n            return this.imageFormatInternal;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(Selection.prototype, \"end\", {\n        /**\n         * Gets the start text position of selection range.\n         * @private\n         */\n        get: function () {\n            return this.endInternal;\n        },\n        /**\n         * For internal use\n         * @private\n         */\n        set: function (value) {\n            this.endInternal = value;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(Selection.prototype, \"startPage\", {\n        /**\n         * Gets the page number where the selection ends.\n         * @private\n         */\n        get: function () {\n            if (!this.owner.isDocumentLoaded || isNullOrUndefined(this.viewer)\n                || isNullOrUndefined(this.viewer.selectionStartPage)) {\n                return 1;\n            }\n            return this.viewer.pages.indexOf(this.viewer.selectionStartPage) + 1;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(Selection.prototype, \"endPage\", {\n        /**\n         * Gets the page number where the selection ends.\n         * @private\n         */\n        get: function () {\n            if (!this.owner.isDocumentLoaded || isNullOrUndefined(this.viewer)\n                || isNullOrUndefined(this.viewer.selectionEndPage)) {\n                return 1;\n            }\n            return this.viewer.pages.indexOf(this.viewer.selectionEndPage) + 1;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(Selection.prototype, \"isForward\", {\n        /**\n         * Determines whether the selection direction is forward or not.\n         * @default false\n         * @returns {boolean}\n         * @private\n         */\n        get: function () {\n            return this.start.isExistBefore(this.end);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(Selection.prototype, \"isEmpty\", {\n        /**\n         * Determines whether the start and end positions are same or not.\n         * @default false\n         * @returns {boolean}\n         * @private\n         */\n        get: function () {\n            if (isNullOrUndefined(this.start)) {\n                return true;\n            }\n            return this.start.isAtSamePosition(this.end);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(Selection.prototype, \"text\", {\n        /**\n         * Gets the text within selection.\n         * @default ''\n         * @returns {string}\n         */\n        get: function () {\n            return this.getText(false);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(Selection.prototype, \"contextType\", {\n        /**\n         * Gets the context type of the selection.\n         */\n        get: function () {\n            return this.contextTypeInternal;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(Selection.prototype, \"isCleared\", {\n        /**\n         * @private\n         */\n        get: function () {\n            return isNullOrUndefined(this.end);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Selection.prototype.getModuleName = function () {\n        return 'Selection';\n    };\n    //Public API\n    /**\n     * Moves the selection to the header of current page.\n     */\n    Selection.prototype.goToHeader = function () {\n        this.owner.enableHeaderAndFooter = true;\n        this.enableHeadersFootersRegion(this.start.paragraph.bodyWidget.page.headerWidget);\n    };\n    /**\n     * Moves the selection to the footer of current page.\n     */\n    Selection.prototype.goToFooter = function () {\n        this.owner.enableHeaderAndFooter = true;\n        this.enableHeadersFootersRegion(this.start.paragraph.bodyWidget.page.footerWidget);\n    };\n    /**\n     * Closes the header and footer region.\n     */\n    Selection.prototype.closeHeaderFooter = function () {\n        this.disableHeaderFooter();\n    };\n    /**\n     * Moves the selection to the start of specified page number.\n     */\n    Selection.prototype.goToPage = function (pageNumber) {\n        if (pageNumber >= 1 && pageNumber <= this.viewer.pages.length) {\n            var page = this.viewer.pages[pageNumber - 1];\n            this.updateTextPositionForBlockContainer(page.bodyWidgets[0]);\n        }\n    };\n    /**\n     * Selects the entire table if the context is within table.\n     */\n    Selection.prototype.selectTable = function () {\n        if (!this.owner.enableSelection) {\n            return;\n        }\n        this.selectTableInternal();\n    };\n    /**\n     * Selects the entire row if the context is within table.\n     */\n    Selection.prototype.selectRow = function () {\n        if (!this.owner.enableSelection) {\n            return;\n        }\n        this.selectTableRow();\n    };\n    /**\n     * Selects the entire column if the context is within table.\n     */\n    Selection.prototype.selectColumn = function () {\n        if (!this.owner.enableSelection) {\n            return;\n        }\n        this.selectColumnInternal();\n    };\n    /**\n     * Selects the entire cell if the context is within table.\n     */\n    Selection.prototype.selectCell = function () {\n        if (!this.owner.enableSelection) {\n            return;\n        }\n        this.selectTableCell();\n    };\n    /**\n     * Select content based on selection settings\n     */\n    Selection.prototype.select = function (selectionSettings) {\n        var point = new Point(selectionSettings.x, selectionSettings.y);\n        var pageCoordinates = this.viewer.findFocusedPage(point, true);\n        if (selectionSettings.extend) {\n            this.moveTextPosition(pageCoordinates, this.end);\n        }\n        else {\n            this.viewer.updateTextPositionForSelection(pageCoordinates, 1);\n        }\n    };\n    /**\n     * Toggles the bold property of selected contents.\n     * @private\n     */\n    Selection.prototype.toggleBold = function () {\n        if (this.owner.editorModule) {\n            this.owner.editorModule.toggleBold();\n        }\n    };\n    /**\n     * Toggles the italic property of selected contents.\n     * @private\n     */\n    Selection.prototype.toggleItalic = function () {\n        if (this.owner.editorModule) {\n            this.owner.editorModule.toggleItalic();\n        }\n    };\n    /**\n     * Toggles the underline property of selected contents.\n     * @param underline Default value of â€˜underlineâ€™ parameter is Single.\n     * @private\n     */\n    Selection.prototype.toggleUnderline = function (underline) {\n        if (this.owner.editor) {\n            this.owner.editor.toggleUnderline(underline);\n        }\n    };\n    /**\n     * Toggles the strike through property of selected contents.\n     * @param {Strikethrough} strikethrough Default value of strikethrough parameter is SingleStrike.\n     * @private\n     */\n    Selection.prototype.toggleStrikethrough = function (strikethrough) {\n        if (this.owner.editor) {\n            this.owner.editor.toggleStrikethrough(strikethrough);\n        }\n    };\n    /**\n     * Toggles the highlight color property of selected contents.\n     * @param {HighlightColor} highlightColor Default value of â€˜underlineâ€™ parameter is Yellow.\n     * @private\n     */\n    Selection.prototype.toggleHighlightColor = function (highlightColor) {\n        if (this.owner.editor) {\n            this.owner.editor.toggleHighlightColor(highlightColor);\n        }\n    };\n    /**\n     * Toggles the subscript formatting of selected contents.\n     * @private\n     */\n    Selection.prototype.toggleSubscript = function () {\n        if (this.owner.editor) {\n            this.owner.editor.toggleSubscript();\n        }\n    };\n    /**\n     * Toggles the superscript formatting of selected contents.\n     * @private\n     */\n    Selection.prototype.toggleSuperscript = function () {\n        if (this.owner.editor) {\n            this.owner.editor.toggleSuperscript();\n        }\n    };\n    /**\n     * Toggles the text alignment property of selected contents.\n     * @param {TextAlignment} textAlignment Default value of â€˜textAlignment parameter is TextAlignment.Left.\n     * @private\n     */\n    Selection.prototype.toggleTextAlignment = function (textAlignment) {\n        if (this.owner.editor) {\n            this.owner.editor.toggleTextAlignment(textAlignment);\n        }\n    };\n    /**\n     * Increases the left indent of selected paragraphs to a factor of 36 points.\n     * @private\n     */\n    Selection.prototype.increaseIndent = function () {\n        if (this.owner.editor) {\n            this.owner.editor.increaseIndent();\n        }\n    };\n    /**\n     * Decreases the left indent of selected paragraphs to a factor of 36 points.\n     * @private\n     */\n    Selection.prototype.decreaseIndent = function () {\n        if (this.owner.editor) {\n            this.owner.editor.decreaseIndent();\n        }\n    };\n    /**\n     * Fires the `requestNavigate` event if current selection context is in hyperlink.\n     */\n    Selection.prototype.navigateHyperlink = function () {\n        var fieldBegin = this.getHyperlinkField();\n        if (fieldBegin) {\n            this.fireRequestNavigate(fieldBegin);\n        }\n    };\n    /**\n     * Navigate Hyperlink\n     * @param fieldBegin\n     * @private\n     */\n    Selection.prototype.fireRequestNavigate = function (fieldBegin) {\n        var hyperlink = new Hyperlink(fieldBegin, this);\n        var eventArgs = {\n            isHandled: false,\n            navigationLink: hyperlink.navigationLink,\n            linkType: hyperlink.linkType,\n            localReference: hyperlink.localReference,\n            source: this.owner\n        };\n        this.owner.trigger('requestNavigate', eventArgs);\n        if (!eventArgs.isHandled) {\n            this.viewer.selection.navigateBookmark(hyperlink.localReference, true);\n        }\n    };\n    /**\n     * Copies the hyperlink URL if the context is within hyperlink.\n     */\n    Selection.prototype.copyHyperlink = function () {\n        var hyperLinkField = this.getHyperlinkField();\n        var linkText = this.getLinkText(hyperLinkField);\n        this.copyToClipboard(linkText);\n    };\n    //Selection add, Highlight, remove API starts\n    /**\n     * @private\n     */\n    Selection.prototype.highlightSelection = function (isSelectionChanged) {\n        if (this.owner.enableImageResizerMode) {\n            this.owner.imageResizerModule.hideImageResizer();\n        }\n        if (this.isEmpty) {\n            this.updateCaretPosition();\n        }\n        else {\n            if (this.isForward) {\n                this.highlightSelectedContent(this.start, this.end);\n            }\n            else {\n                this.highlightSelectedContent(this.end, this.start);\n            }\n        }\n        this.viewer.updateTouchMarkPosition();\n        if (isSelectionChanged) {\n            this.viewer.scrollToPosition(this.start, this.end);\n        }\n    };\n    /**\n     * @private\n     */\n    Selection.prototype.createHighlightBorder = function (lineWidget, width, left, top) {\n        if (width < 0) {\n            width = 0;\n        }\n        var page = this.getPage(lineWidget.paragraph);\n        var height = lineWidget.height;\n        var selectionWidget = undefined;\n        if (!this.selectedWidgets.containsKey(lineWidget)) {\n            selectionWidget = new SelectionWidgetInfo(left, width);\n            this.selectedWidgets.add(lineWidget, selectionWidget);\n        }\n        var viewer = this.viewer;\n        var pageTop = this.getPageTop(page);\n        var pageLeft = page.boundingRectangle.x;\n        if (viewer.containerTop <= pageTop\n            || pageTop < viewer.containerTop + viewer.selectionCanvas.height) {\n            viewer.selectionContext.fillStyle = 'gray';\n            viewer.selectionContext.globalAlpha = 0.4;\n            var zoomFactor = viewer.zoomFactor;\n            this.clipSelection(page, pageTop);\n            // tslint:disable-next-line:max-line-length\n            viewer.selectionContext.fillRect((pageLeft + (left * zoomFactor)) - viewer.containerLeft, (pageTop + (top * zoomFactor)) - viewer.containerTop, width * zoomFactor, height * zoomFactor);\n            viewer.selectionContext.restore();\n        }\n    };\n    /**\n     * Create selection highlight inside table\n     * @private\n     */\n    Selection.prototype.createHighlightBorderInsideTable = function (cellWidget) {\n        var page = this.getPage(cellWidget);\n        var selectionWidget = undefined;\n        var left = cellWidget.x - cellWidget.margin.left + cellWidget.leftBorderWidth;\n        var width = cellWidget.width + cellWidget.margin.left\n            + cellWidget.margin.right - cellWidget.leftBorderWidth - cellWidget.rightBorderWidth;\n        var top = cellWidget.y;\n        var height = cellWidget.height;\n        var pageTop = this.getPageTop(page);\n        var pageLeft = page.boundingRectangle.x;\n        var isVisiblePage = this.viewer.containerTop <= pageTop\n            || pageTop < this.viewer.containerTop + this.viewer.selectionCanvas.height;\n        if (this.selectedWidgets.containsKey(cellWidget)) {\n            selectionWidget = this.selectedWidgets.get(cellWidget);\n            if (isVisiblePage) {\n                // tslint:disable-next-line:max-line-length\n                this.viewer.selectionContext.clearRect((pageLeft + (selectionWidget.left * this.viewer.zoomFactor) - this.viewer.containerLeft), (pageTop + (top * this.viewer.zoomFactor)) - this.viewer.containerTop, selectionWidget.width * this.viewer.zoomFactor, height * this.viewer.zoomFactor);\n            }\n        }\n        selectionWidget = new SelectionWidgetInfo(left, width);\n        this.selectedWidgets.add(cellWidget, selectionWidget);\n        if (isVisiblePage) {\n            this.viewer.selectionContext.fillStyle = 'gray';\n            this.viewer.selectionContext.globalAlpha = 0.4;\n            var zoomFactor = this.viewer.zoomFactor;\n            this.clipSelection(page, pageTop);\n            // tslint:disable-next-line:max-line-length\n            this.viewer.selectionContext.fillRect((pageLeft + (left * zoomFactor)) - this.viewer.containerLeft, (pageTop + (top * zoomFactor)) - this.viewer.containerTop, width * zoomFactor, height * zoomFactor);\n            this.viewer.selectionContext.restore();\n        }\n    };\n    /**\n     * @private\n     */\n    Selection.prototype.clipSelection = function (page, pageTop) {\n        var viewer = this.viewer;\n        var width = page.boundingRectangle.width * viewer.zoomFactor;\n        var height = page.boundingRectangle.height * viewer.zoomFactor;\n        var left = page.boundingRectangle.x;\n        viewer.selectionContext.beginPath();\n        viewer.selectionContext.save();\n        viewer.selectionContext.rect(left - viewer.containerLeft, pageTop - viewer.containerTop, width, height);\n        viewer.selectionContext.clip();\n    };\n    /**\n     * Add selection highlight\n     * @private\n     */\n    Selection.prototype.addSelectionHighlight = function (canvasContext, widget, top) {\n        if (this.selectedWidgets.containsKey(widget)) {\n            var height = this.viewer.render.getScaledValue(widget.height);\n            var widgetInfo = this.selectedWidgets.get(widget);\n            var width = this.viewer.render.getScaledValue(widgetInfo.width);\n            var left = this.viewer.render.getScaledValue(widgetInfo.left, 1);\n            canvasContext.fillStyle = 'gray';\n            var page = this.owner.selection.getPage(widget.paragraph);\n            this.owner.selection.clipSelection(page, this.owner.selection.getPageTop(page));\n            canvasContext.fillRect(left, this.viewer.render.getScaledValue(top, 2), width, height);\n            canvasContext.restore();\n        }\n    };\n    /**\n     * Add Selection highlight inside table\n     * @private\n     */\n    Selection.prototype.addSelectionHighlightTable = function (canvasContext, tableCellWidget) {\n        if (this.selectedWidgets.containsKey(tableCellWidget)) {\n            var selectionWidget = this.selectedWidgets.get(tableCellWidget);\n            var left = this.viewer.render.getScaledValue(selectionWidget.left, 1);\n            var top_1 = this.viewer.render.getScaledValue(tableCellWidget.y, 2);\n            var width = this.viewer.render.getScaledValue(selectionWidget.width);\n            var height = this.viewer.render.getScaledValue(tableCellWidget.height);\n            canvasContext.fillStyle = 'gray';\n            var page = this.owner.selection.getPage(tableCellWidget);\n            this.owner.selection.clipSelection(page, this.owner.selection.getPageTop(page));\n            canvasContext.fillRect(left, top_1, width, height);\n            canvasContext.restore();\n        }\n    };\n    /**\n     * Remove Selection highlight\n     * @private\n     */\n    Selection.prototype.removeSelectionHighlight = function (widget) {\n        var left = 0;\n        var top = 0;\n        var width = 0;\n        var height = 0;\n        var page = undefined;\n        if (widget instanceof LineWidget) {\n            var lineWidget = widget;\n            var currentParaWidget = lineWidget.paragraph;\n            page = !isNullOrUndefined(currentParaWidget) ?\n                this.getPage((lineWidget.paragraph)) : undefined;\n            if (isNullOrUndefined(page)) {\n                return;\n            }\n            top = this.getTop(lineWidget);\n            height = lineWidget.height;\n        }\n        else if (widget instanceof TableCellWidget) {\n            page = !isNullOrUndefined(widget) ?\n                this.getPage(widget) : undefined;\n            if (isNullOrUndefined(page)) {\n                return;\n            }\n            top = widget.y;\n            height = widget.height;\n        }\n        if (isNullOrUndefined(page)) {\n            return;\n        }\n        var widgetInfo = this.selectedWidgets.get(widget);\n        width = widgetInfo.width;\n        left = widgetInfo.left;\n        var pageRect = page.boundingRectangle;\n        var pageIndex = this.viewer.pages.indexOf(page);\n        var pageGap = this.viewer.pageGap;\n        var pageTop = (pageRect.y - pageGap * (pageIndex + 1)) * this.viewer.zoomFactor + pageGap * (pageIndex + 1);\n        var pageLeft = pageRect.x;\n        var zoomFactor = this.viewer.zoomFactor;\n        if (this.viewer.containerTop <= pageTop\n            || pageTop < this.viewer.containerTop + this.viewer.selectionCanvas.height) {\n            // tslint:disable-next-line:max-line-length\n            this.viewer.selectionContext.clearRect((pageLeft + (left * zoomFactor) - this.viewer.containerLeft) - 0.5, (pageTop + (top * zoomFactor)) - this.viewer.containerTop - 0.5, width * zoomFactor + 0.5, height * zoomFactor + 0.5);\n        }\n    };\n    /**\n     * Select Current word\n     * @private\n     */\n    Selection.prototype.selectCurrentWord = function () {\n        var startPosition = this.start.clone();\n        var endPosition = this.end.clone();\n        this.selectCurrentWordRange(startPosition, endPosition, false);\n        this.selectRange(startPosition, endPosition);\n    };\n    /**\n     * Select current paragraph\n     * @private\n     */\n    Selection.prototype.selectCurrentParagraph = function () {\n        if (!isNullOrUndefined(this.start)) {\n            this.start.paragraphStartInternal(this, false);\n            this.end.moveToParagraphEndInternal(this, false);\n            this.upDownSelectionLength = this.end.location.x;\n            this.fireSelectionChanged(true);\n        }\n    };\n    /**\n     * Select current word range\n     * @private\n     */\n    Selection.prototype.selectCurrentWordRange = function (startPosition, endPosition, excludeSpace) {\n        if (!isNullOrUndefined(startPosition)) {\n            if (startPosition.offset > 0) {\n                var wordStart = startPosition.clone();\n                var indexInInline = 0;\n                var inlineObj = startPosition.currentWidget.getInline(startPosition.offset, indexInInline);\n                var inline = inlineObj.element;\n                indexInInline = inlineObj.index;\n                if (!isNullOrUndefined(inline) && inline instanceof FieldElementBox && inline.fieldType === 1) {\n                    // tslint:disable-next-line:max-line-length\n                    if (startPosition.offset > 2 && (!isNullOrUndefined(inline.fieldSeparator) || isNullOrUndefined(inline.fieldBegin))) {\n                        wordStart.setPositionParagraph(wordStart.currentWidget, startPosition.offset - 2);\n                        wordStart.moveToWordEndInternal(0, false);\n                        if (!(wordStart.paragraph === startPosition.paragraph && wordStart.offset === startPosition.offset - 1)) {\n                            startPosition.moveToWordStartInternal(2);\n                        }\n                    }\n                    else if (startPosition.offset > 3 && isNullOrUndefined(inline.fieldSeparator)) {\n                        wordStart.setPositionParagraph(wordStart.currentWidget, startPosition.offset - 3);\n                        wordStart.moveToWordEndInternal(0, false);\n                        if (!(wordStart.paragraph === startPosition.paragraph && wordStart.offset === startPosition.offset)) {\n                            startPosition.moveToWordStartInternal(2);\n                        }\n                    }\n                }\n                else {\n                    wordStart.setPositionParagraph(wordStart.currentWidget, startPosition.offset - 1);\n                    wordStart.moveToWordEndInternal(0, false);\n                    if (!(wordStart.paragraph === startPosition.paragraph && wordStart.offset === startPosition.offset)) {\n                        startPosition.moveToWordStartInternal(2);\n                    }\n                }\n            }\n            endPosition.moveToWordEndInternal(2, excludeSpace);\n        }\n    };\n    /**\n     * Extend selection to paragraph start\n     * @private\n     */\n    Selection.prototype.extendToParagraphStart = function () {\n        if (isNullOrUndefined(this.start)) {\n            return;\n        }\n        this.end.paragraphStartInternal(this, true);\n        this.upDownSelectionLength = this.end.location.x;\n        this.fireSelectionChanged(true);\n    };\n    /**\n     * Extend selection to paragraph end\n     * @private\n     */\n    Selection.prototype.extendToParagraphEnd = function () {\n        if (isNullOrUndefined(this.start)) {\n            return;\n        }\n        this.end.moveToParagraphEndInternal(this, true);\n        this.upDownSelectionLength = this.end.location.x;\n        this.fireSelectionChanged(true);\n    };\n    /**\n     * Move to next text position\n     * @private\n     */\n    Selection.prototype.moveNextPosition = function () {\n        if (isNullOrUndefined(this.start)) {\n            return;\n        }\n        if (this.isEmpty) {\n            this.start.moveNextPosition();\n            this.end.setPositionInternal(this.start);\n        }\n        this.updateForwardSelection();\n        this.upDownSelectionLength = this.start.location.x;\n        this.fireSelectionChanged(true);\n    };\n    /**\n     * Move to next paragraph\n     * @private\n     */\n    Selection.prototype.moveToNextParagraph = function () {\n        if (isNullOrUndefined(this.start)) {\n            return;\n        }\n        this.end.moveToNextParagraphStartInternal();\n        this.start.setPositionInternal(this.end);\n        this.upDownSelectionLength = this.end.location.x;\n        this.fireSelectionChanged(true);\n    };\n    /**\n     * Move to previous text position\n     * @private\n     */\n    Selection.prototype.movePreviousPosition = function () {\n        if (isNullOrUndefined(this.start)) {\n            return;\n        }\n        if (this.isEmpty) {\n            this.start.movePreviousPosition();\n            this.end.setPositionInternal(this.start);\n        }\n        this.updateBackwardSelection();\n        this.upDownSelectionLength = this.start.location.x;\n        this.fireSelectionChanged(true);\n    };\n    /**\n     * Move to previous paragraph\n     * @private\n     */\n    Selection.prototype.moveToPreviousParagraph = function () {\n        if (isNullOrUndefined(this.start)) {\n            return;\n        }\n        this.end.moveToPreviousParagraph(this);\n        this.start.setPositionInternal(this.end);\n        this.upDownSelectionLength = this.end.location.x;\n        this.fireSelectionChanged(true);\n    };\n    /**\n     * Extend selection to previous line\n     * @private\n     */\n    Selection.prototype.extendToPreviousLine = function () {\n        if (isNullOrUndefined(this.start)) {\n            return;\n        }\n        this.end.moveToPreviousLine(this, this.upDownSelectionLength);\n        this.fireSelectionChanged(true);\n    };\n    /**\n     * Extend selection to line end\n     * @private\n     */\n    Selection.prototype.extendToLineEnd = function () {\n        if (isNullOrUndefined(this.start)) {\n            return;\n        }\n        this.end.moveToLineEndInternal(this, true);\n        this.upDownSelectionLength = this.end.location.x;\n        this.fireSelectionChanged(true);\n    };\n    /**\n     * Extend to line start\n     * @private\n     */\n    Selection.prototype.extendToLineStart = function () {\n        if (isNullOrUndefined(this.start)) {\n            return;\n        }\n        this.end.moveToLineStartInternal(this, true);\n        this.upDownSelectionLength = this.end.location.x;\n        this.fireSelectionChanged(true);\n    };\n    /**\n     * @private\n     */\n    Selection.prototype.moveUp = function () {\n        if (isNullOrUndefined(this.start)) {\n            return;\n        }\n        if (!this.isEmpty) {\n            if (this.isForward) {\n                this.end.setPositionInternal(this.start);\n            }\n            else {\n                this.start.setPositionInternal(this.end);\n            }\n            this.upDownSelectionLength = this.start.location.x;\n        }\n        this.upDownSelectionLength = this.start.location.x;\n        this.start.moveUp(this, this.upDownSelectionLength);\n        this.end.setPositionInternal(this.start);\n        this.fireSelectionChanged(true);\n    };\n    /**\n     * @private\n     */\n    Selection.prototype.moveDown = function () {\n        if (isNullOrUndefined(this.start)) {\n            return;\n        }\n        if (!this.isEmpty) {\n            if (this.isForward) {\n                this.start.setPositionInternal(this.end);\n            }\n            else {\n                this.end.setPositionInternal(this.start);\n            }\n            this.upDownSelectionLength = this.start.location.x;\n        }\n        this.start.moveDown(this, this.upDownSelectionLength);\n        this.end.setPositionInternal(this.start);\n        this.fireSelectionChanged(true);\n    };\n    Selection.prototype.updateForwardSelection = function () {\n        if (!this.isEmpty) {\n            if (this.isForward) {\n                this.start.setPositionInternal(this.end);\n            }\n            else {\n                this.end.setPositionInternal(this.start);\n            }\n        }\n    };\n    Selection.prototype.updateBackwardSelection = function () {\n        if (!this.isEmpty) {\n            if (this.isForward) {\n                this.end.setPositionInternal(this.start);\n            }\n            else {\n                this.start.setPositionInternal(this.end);\n            }\n        }\n    };\n    /**\n     * @private\n     */\n    Selection.prototype.getFirstBlockInFirstCell = function (table) {\n        if (table.childWidgets.length > 0) {\n            var firstrow = table.childWidgets[0];\n            if (firstrow.childWidgets.length > 0) {\n                var firstcell = firstrow.childWidgets[0];\n                if (firstcell.childWidgets.length === 0) {\n                    return undefined;\n                }\n                return firstcell.childWidgets[0];\n            }\n        }\n        return undefined;\n    };\n    /**\n     * @private\n     */\n    // tslint:disable-next-line:max-line-length\n    Selection.prototype.getFirstCellInRegion = function (row, startCell, selectionLength, isMovePrevious) {\n        var cellStart = this.getCellLeft(row, startCell);\n        var cellEnd = cellStart + startCell.cellFormat.cellWidth;\n        var flag = true;\n        if (cellStart <= selectionLength && selectionLength < cellEnd) {\n            for (var k = 0; k < row.childWidgets.length; k++) {\n                var left = this.getCellLeft(row, row.childWidgets[k]);\n                if (HelperMethods.round(cellStart, 2) <= HelperMethods.round(left, 2) &&\n                    HelperMethods.round(left, 2) < HelperMethods.round(cellEnd, 2)) {\n                    flag = false;\n                    return row.childWidgets[k];\n                }\n            }\n        }\n        else {\n            for (var j = 0; j < row.childWidgets.length; j++) {\n                var cellLeft = this.getCellLeft(row, row.childWidgets[j]);\n                if (cellLeft <= selectionLength && cellLeft +\n                    row.childWidgets[j].cellFormat.cellWidth > selectionLength) {\n                    flag = false;\n                    return row.childWidgets[j];\n                }\n            }\n        }\n        if (flag) {\n            if (!isNullOrUndefined(row.previousRenderedWidget) && isMovePrevious) {\n                var previousWidget = row.previousRenderedWidget;\n                return this.getFirstCellInRegion(previousWidget, startCell, selectionLength, isMovePrevious);\n            }\n            else if (!isNullOrUndefined(row.nextRenderedWidget) && !isMovePrevious) {\n                return this.getFirstCellInRegion(row.nextRenderedWidget, startCell, selectionLength, isMovePrevious);\n            }\n        }\n        return row.childWidgets[0];\n    };\n    /**\n     * @private\n     */\n    Selection.prototype.getFirstParagraph = function (tableCell) {\n        while (tableCell.previousSplitWidget) {\n            tableCell = tableCell.previousSplitWidget;\n        }\n        var firstBlock = tableCell.firstChild;\n        return this.getFirstParagraphBlock(firstBlock);\n    };\n    /**\n     * Get last block in last cell\n     * @private\n     */\n    //Table\n    Selection.prototype.getLastBlockInLastCell = function (table) {\n        if (table.childWidgets.length > 0) {\n            var lastrow = table.childWidgets[table.childWidgets.length - 1];\n            var lastcell = lastrow.childWidgets[lastrow.childWidgets.length - 1];\n            return lastcell.childWidgets[lastcell.childWidgets.length - 1];\n        }\n        return undefined;\n    };\n    /**\n     * Move to line start\n     * @private\n     */\n    Selection.prototype.moveToLineStart = function () {\n        if (isNullOrUndefined(this.start)) {\n            return;\n        }\n        this.updateBackwardSelection();\n        this.start.moveToLineStartInternal(this, false);\n        this.end.setPositionInternal(this.start);\n        this.upDownSelectionLength = this.start.location.x;\n        this.fireSelectionChanged(true);\n    };\n    /**\n     * Move to line end\n     * @private\n     */\n    Selection.prototype.moveToLineEnd = function () {\n        if (isNullOrUndefined(this.start)) {\n            return;\n        }\n        this.updateForwardSelection();\n        this.start.moveToLineEndInternal(this, false);\n        this.end.setPositionInternal(this.start);\n        this.upDownSelectionLength = this.start.location.x;\n        this.fireSelectionChanged(true);\n    };\n    /**\n     * Get Page top\n     * @private\n     */\n    Selection.prototype.getPageTop = function (page) {\n        // tslint:disable-next-line:max-line-length\n        return (page.boundingRectangle.y - this.viewer.pageGap * (this.viewer.pages.indexOf(page) + 1)) * this.viewer.zoomFactor + this.viewer.pageGap * (this.viewer.pages.indexOf(page) + 1);\n    };\n    /**\n     * Move text position to cursor point\n     * @private\n     */\n    Selection.prototype.moveTextPosition = function (cursorPoint, textPosition) {\n        if (isNullOrUndefined(this.start)) {\n            return;\n        }\n        //Updates the text position based on the cursor position.\n        var widget = this.viewer.getLineWidgetInternal(cursorPoint, true);\n        if (!isNullOrUndefined(widget)) {\n            this.updateTextPositionWidget(widget, cursorPoint, textPosition, true);\n        }\n        this.upDownSelectionLength = textPosition.location.x;\n        var selectionStartIndex = this.start.getHierarchicalIndexInternal();\n        var selectionEndIndex = this.end.getHierarchicalIndexInternal();\n        if (selectionStartIndex !== selectionEndIndex) {\n            // Extends selection end to field begin or field end.\n            if (TextPosition.isForwardSelection(selectionStartIndex, selectionEndIndex)) {\n                textPosition.validateForwardFieldSelection(selectionStartIndex, selectionEndIndex);\n            }\n            else {\n                textPosition.validateBackwardFieldSelection(selectionStartIndex, selectionEndIndex);\n            }\n        }\n        this.fireSelectionChanged(true);\n    };\n    //Helper Method Implementation \n    //Document\n    /**\n     * Get document start position\n     * @private\n     */\n    Selection.prototype.getDocumentStart = function () {\n        var textPosition = undefined;\n        var block = this.viewer.pages[0].bodyWidgets[0].childWidgets[0];\n        return this.setPositionForBlock(block, true);\n    };\n    /**\n     * Get document end position\n     * @private\n     */\n    Selection.prototype.getDocumentEnd = function () {\n        var textPosition = undefined;\n        var documentStart = this.owner.documentStart;\n        var lastPage = this.viewer.pages[this.viewer.pages.length - 1];\n        if (!isNullOrUndefined(documentStart) && lastPage.bodyWidgets[0].childWidgets.length > 0) {\n            var block = undefined;\n            var section = lastPage.bodyWidgets[0];\n            var blocks = section.childWidgets;\n            var lastBlkItem = blocks.length - 1;\n            var lastBlock = blocks[lastBlkItem];\n            if (lastBlock instanceof BlockWidget) {\n                block = lastBlock;\n            }\n            textPosition = this.setPositionForBlock(block, false);\n        }\n        return textPosition;\n    };\n    //Keyboard shortcut internal API\n    /**\n     * @private\n     * Handles control end key.\n     */\n    Selection.prototype.handleControlEndKey = function () {\n        var documentEnd = undefined;\n        if (!isNullOrUndefined(this.owner.documentEnd)) {\n            documentEnd = this.owner.documentEnd;\n        }\n        if (!isNullOrUndefined(documentEnd)) {\n            this.owner.selection.selectContent(documentEnd, true);\n        }\n        this.checkForCursorVisibility();\n    };\n    /**\n     * @private\n     * Handles control home key.\n     */\n    Selection.prototype.handleControlHomeKey = function () {\n        var documentStart = undefined;\n        if (!isNullOrUndefined(this.owner.documentStart)) {\n            documentStart = this.owner.documentStart;\n        }\n        if (!isNullOrUndefined(documentStart)) {\n            this.owner.selection.selectContent(documentStart, true);\n        }\n        this.checkForCursorVisibility();\n    };\n    /**\n     * @private\n     * Handles control left key.\n     */\n    Selection.prototype.handleControlLeftKey = function () {\n        this.extendToWordStart(true);\n        this.checkForCursorVisibility();\n    };\n    /**\n     * @private\n     * Handles control right key.\n     */\n    Selection.prototype.handleControlRightKey = function () {\n        this.extendToWordEnd(true);\n        this.checkForCursorVisibility();\n    };\n    /**\n     * Handles control down key.\n     * @private\n     */\n    Selection.prototype.handleControlDownKey = function () {\n        this.moveToNextParagraph();\n        this.checkForCursorVisibility();\n    };\n    /**\n     * Handles control up key.\n     * @private\n     */\n    Selection.prototype.handleControlUpKey = function () {\n        this.moveToPreviousParagraph();\n        this.checkForCursorVisibility();\n    };\n    /**\n     * @private\n     * Handles shift left key.\n     */\n    Selection.prototype.handleShiftLeftKey = function () {\n        this.extendBackward();\n        this.checkForCursorVisibility();\n    };\n    /**\n     * Handles shift up key.\n     * @private\n     */\n    Selection.prototype.handleShiftUpKey = function () {\n        this.extendToPreviousLine();\n        this.checkForCursorVisibility();\n    };\n    /**\n     * Handles shift right key.\n     * @private\n     */\n    Selection.prototype.handleShiftRightKey = function () {\n        this.extendForward();\n        this.checkForCursorVisibility();\n    };\n    /**\n     * Handles shift down key.\n     * @private\n     */\n    Selection.prototype.handleShiftDownKey = function () {\n        this.extendToNextLine();\n        this.checkForCursorVisibility();\n    };\n    /**\n     * @private\n     * Handles control shift left key.\n     */\n    Selection.prototype.handleControlShiftLeftKey = function () {\n        this.extendToWordStart(false);\n        this.checkForCursorVisibility();\n    };\n    /**\n     * Handles control shift up key.\n     * @private\n     */\n    Selection.prototype.handleControlShiftUpKey = function () {\n        this.extendToParagraphStart();\n        this.checkForCursorVisibility();\n    };\n    /**\n     * Handles control shift right key\n     * @private\n     */\n    Selection.prototype.handleControlShiftRightKey = function () {\n        this.extendToWordEnd(false);\n        this.checkForCursorVisibility();\n    };\n    /**\n     * Handles control shift down key.\n     * @private\n     */\n    Selection.prototype.handleControlShiftDownKey = function () {\n        this.extendToParagraphEnd();\n        this.checkForCursorVisibility();\n    };\n    /**\n     * Handles left key.\n     * @private\n     */\n    Selection.prototype.handleLeftKey = function () {\n        this.movePreviousPosition();\n        this.checkForCursorVisibility();\n    };\n    /**\n     * Handles up key.\n     * @private\n     */\n    Selection.prototype.handleUpKey = function () {\n        this.isMoveDownOrMoveUp = true;\n        this.moveUp();\n        this.isMoveDownOrMoveUp = false;\n        this.checkForCursorVisibility();\n    };\n    /**\n     * Handles right key.\n     * @private\n     */\n    Selection.prototype.handleRightKey = function () {\n        this.moveNextPosition();\n        this.checkForCursorVisibility();\n    };\n    /**\n     * Handles end key.\n     * @private\n     */\n    Selection.prototype.handleEndKey = function () {\n        this.moveToLineEnd();\n        this.checkForCursorVisibility();\n    };\n    /**\n     * Handles home key.\n     * @private\n     */\n    Selection.prototype.handleHomeKey = function () {\n        this.moveToLineStart();\n        this.checkForCursorVisibility();\n    };\n    /**\n     * Handles down key.\n     * @private\n     */\n    Selection.prototype.handleDownKey = function () {\n        this.isMoveDownOrMoveUp = true;\n        this.moveDown();\n        this.isMoveDownOrMoveUp = false;\n        this.checkForCursorVisibility();\n    };\n    /**\n     * Handles shift end key.\n     * @private\n     */\n    Selection.prototype.handleShiftEndKey = function () {\n        this.extendToLineEnd();\n        this.checkForCursorVisibility();\n    };\n    /**\n     * Handles shift home key.\n     * @private\n     */\n    Selection.prototype.handleShiftHomeKey = function () {\n        this.extendToLineStart();\n        this.checkForCursorVisibility();\n    };\n    /**\n     * Handles control shift end key.\n     * @private\n     */\n    Selection.prototype.handleControlShiftEndKey = function () {\n        var documentEnd = undefined;\n        if (!isNullOrUndefined(this.owner.documentEnd)) {\n            documentEnd = this.owner.documentEnd;\n        }\n        if (!isNullOrUndefined(documentEnd)) {\n            this.end.setPosition(documentEnd.currentWidget, false);\n            this.fireSelectionChanged(true);\n        }\n        this.checkForCursorVisibility();\n    };\n    /**\n     * Handles control shift home key.\n     * @private\n     */\n    Selection.prototype.handleControlShiftHomeKey = function () {\n        var documentStart = undefined;\n        if (!isNullOrUndefined(this.owner.documentStart)) {\n            documentStart = this.owner.documentStart;\n        }\n        if (!isNullOrUndefined(documentStart)) {\n            this.end.setPositionInternal(documentStart);\n            this.fireSelectionChanged(true);\n        }\n        this.checkForCursorVisibility();\n    };\n    /**\n     * Handles tab key.\n     * @param isNavigateInCell\n     * @param isShiftTab\n     * @private\n     */\n    Selection.prototype.handleTabKey = function (isNavigateInCell, isShiftTab) {\n        var start = this.start;\n        if (isNullOrUndefined(start)) {\n            return;\n        }\n        if (start.paragraph.isInsideTable && this.end.paragraph.isInsideTable && (isNavigateInCell || isShiftTab)) {\n            //Perform tab navigation\n            if (isShiftTab) {\n                this.selectPreviousCell();\n            }\n            else {\n                this.selectNextCell();\n            }\n        }\n        else if ((isNavigateInCell || isShiftTab) && !isNullOrUndefined(start) && start.offset === this.getStartOffset(start.paragraph)\n            && !isNullOrUndefined(start.paragraph.paragraphFormat) && !isNullOrUndefined(start.paragraph.paragraphFormat.listFormat)\n            && start.paragraph.paragraphFormat.listFormat.listId !== -1 && !this.owner.isReadOnlyMode) {\n            this.owner.editorModule.updateListLevel(isShiftTab ? false : true);\n        }\n        else if (!this.owner.isReadOnlyMode) {\n            this.owner.editorModule.handleTextInput('\\t');\n        }\n        this.checkForCursorVisibility();\n    };\n    Selection.prototype.selectPreviousCell = function () {\n        var tableCell = this.start.paragraph.associatedCell;\n        var tableRow = tableCell.ownerRow;\n        var tableAdv = tableRow.ownerTable;\n        if (isNullOrUndefined(tableCell.previousWidget)) {\n            if (!isNullOrUndefined(tableRow.previousRenderedWidget)) {\n                //Move text selection or cursor to previous row's last cell\n                var prevRow = undefined;\n                if (tableRow.previousRenderedWidget instanceof TableRowWidget) {\n                    prevRow = tableRow.previousRenderedWidget;\n                }\n                this.selectTableCellInternal(prevRow.childWidgets[prevRow.childWidgets.length - 1], true);\n            }\n        }\n        else {\n            //Move text selection or cursor to next cell in current row\n            var prevCell = undefined;\n            if (tableCell.previousWidget instanceof TableCellWidget) {\n                prevCell = tableCell.previousWidget;\n            }\n            this.selectTableCellInternal(prevCell, true);\n        }\n    };\n    Selection.prototype.selectNextCell = function () {\n        var tableCell = this.start.paragraph.associatedCell;\n        var tableRow = tableCell.ownerRow;\n        var tableAdv = tableRow.ownerTable;\n        if (isNullOrUndefined(tableCell.nextWidget)) {\n            if (isNullOrUndefined(tableRow.nextRenderedWidget) && !this.owner.isReadOnlyMode) {\n                //Insert new row below                  \n                this.owner.editorModule.insertRow(false);\n            }\n            else {\n                //Move text selection or cursor to next row's first cell\n                var nextRow = undefined;\n                if (tableRow.nextRenderedWidget instanceof TableRowWidget) {\n                    nextRow = tableRow.nextRenderedWidget;\n                }\n                this.selectTableCellInternal(nextRow.childWidgets[0], true);\n            }\n            // }\n        }\n        else {\n            //Move text selection or cursor to next cell in current row\n            var nextCell = undefined;\n            if (tableCell.nextRenderedWidget instanceof TableCellWidget) {\n                nextCell = tableCell.nextRenderedWidget;\n            }\n            this.selectTableCellInternal(nextCell, true);\n        }\n    };\n    /**\n     * Select given table cell\n     * @private\n     */\n    Selection.prototype.selectTableCellInternal = function (tableCell, clearMultiSelection) {\n        var firstParagraph = this.getFirstParagraph(tableCell);\n        var lastParagraph = this.getLastParagraph(tableCell);\n        if (firstParagraph === lastParagraph && lastParagraph.isEmpty()) {\n            this.selectParagraph(lastParagraph, true);\n        }\n        else {\n            var firstLineWidget = lastParagraph.childWidgets[0];\n            this.start.setPosition(firstParagraph.childWidgets[0], true);\n            this.end.setPositionParagraph(firstLineWidget, firstLineWidget.getEndOffset());\n            this.fireSelectionChanged(true);\n        }\n    };\n    /**\n     * Select while table\n     * @private\n     */\n    Selection.prototype.selectTableInternal = function () {\n        var start = this.start;\n        var end = this.end;\n        if (!this.isForward) {\n            start = this.end;\n            end = this.start;\n        }\n        if (!isNullOrUndefined(start) && !isNullOrUndefined(end) && !isNullOrUndefined(this.getTable(start, end))) {\n            var containerCell = this.getContainerCellOf(start.paragraph.associatedCell, end.paragraph.associatedCell);\n            var table = containerCell.ownerTable;\n            var firstPara = this.getFirstParagraphBlock(table);\n            var lastPara = this.getLastParagraphBlock(table);\n            var offset = lastPara.lastChild.getEndOffset();\n            this.start.setPosition(firstPara.childWidgets[0], true);\n            this.end.setPositionParagraph(lastPara.lastChild, offset + 1);\n        }\n        this.selectPosition(this.start, this.end);\n    };\n    /**\n     * Select single column\n     * @private\n     */\n    Selection.prototype.selectColumnInternal = function () {\n        var startTextPos = this.start;\n        var endTextPos = this.end;\n        if (!this.isForward) {\n            startTextPos = this.end;\n            endTextPos = this.start;\n        }\n        // tslint:disable-next-line:max-line-length\n        if (!isNullOrUndefined(startTextPos) && !isNullOrUndefined(endTextPos) && !isNullOrUndefined(this.getTable(startTextPos, endTextPos))) {\n            var containerCell = this.getContainerCellOf(startTextPos.paragraph.associatedCell, endTextPos.paragraph.associatedCell);\n            if (containerCell.ownerTable.contains(endTextPos.paragraph.associatedCell)) {\n                var startCell = this.getSelectedCell(startTextPos.paragraph.associatedCell, containerCell);\n                var endCell = this.getSelectedCell(endTextPos.paragraph.associatedCell, containerCell);\n                if (this.containsCell(containerCell, endTextPos.paragraph.associatedCell)) {\n                    var row = startCell.ownerRow;\n                    var columnCells = containerCell.ownerTable.getColumnCellsForSelection(containerCell, containerCell);\n                    if (columnCells.length > 0) {\n                        var firstPara = this.getFirstParagraph(columnCells[0]);\n                        var lastPara = this.getLastParagraph(columnCells[columnCells.length - 1]);\n                        this.start.setPosition(firstPara.firstChild, true);\n                        var lastLine = lastPara.lastChild;\n                        this.end.setPositionParagraph(lastLine, lastLine.getEndOffset() + 1);\n                    }\n                }\n                else {\n                    var startCellColumnCells = containerCell.ownerTable.getColumnCellsForSelection(startCell, startCell);\n                    var endCellColumnCells = containerCell.ownerTable.getColumnCellsForSelection(endCell, endCell);\n                    if (startCellColumnCells.length > 0 && endCellColumnCells.length > 0) {\n                        var firstPara = this.getFirstParagraph(startCellColumnCells[0]);\n                        // tslint:disable-next-line:max-line-length\n                        var lastPara = this.getLastParagraph(endCellColumnCells[endCellColumnCells.length - 1]);\n                        this.start.setPosition(firstPara.firstChild, true);\n                        var lastLine = lastPara.lastChild;\n                        this.end.setPositionParagraph(lastLine, lastLine.getEndOffset() + 1);\n                    }\n                }\n            }\n        }\n        this.selectPosition(this.start, this.end);\n    };\n    /**\n     * Select single row\n     * @private\n     */\n    Selection.prototype.selectTableRow = function () {\n        var startPos = this.start;\n        var endPos = this.end;\n        if (!this.isForward) {\n            startPos = this.end;\n            endPos = this.start;\n        }\n        if (!isNullOrUndefined(startPos) && !isNullOrUndefined(endPos) && !isNullOrUndefined(this.getTable(startPos, endPos))) {\n            var containerCell = void 0;\n            containerCell = this.getContainerCellOf(startPos.paragraph.associatedCell, endPos.paragraph.associatedCell);\n            if (containerCell.ownerTable.contains(endPos.paragraph.associatedCell)) {\n                var startCell = this.getSelectedCell(startPos.paragraph.associatedCell, containerCell);\n                var endCell = this.getSelectedCell(endPos.paragraph.associatedCell, containerCell);\n                if (this.containsCell(containerCell, endPos.paragraph.associatedCell)) {\n                    var row = startCell.ownerRow;\n                    var firstPara = this.getFirstParagraph(row.childWidgets[0]);\n                    var lastPara = this.getLastParagraph(row.childWidgets[row.childWidgets.length - 1]);\n                    this.start.setPosition(firstPara.firstChild, true);\n                    this.end.setPositionParagraph(lastPara.lastChild, lastPara.lastChild.getEndOffset() + 1);\n                }\n                else {\n                    var firstPara = this.getFirstParagraph(startCell.ownerRow.childWidgets[0]);\n                    var lastPara = void 0;\n                    // tslint:disable-next-line:max-line-length\n                    lastPara = this.getLastParagraph(endCell.ownerRow.childWidgets[endCell.ownerRow.childWidgets.length - 1]);\n                    this.start.setPosition(firstPara.firstChild, true);\n                    this.end.setPositionParagraph(lastPara.lastChild, lastPara.lastChild.getEndOffset() + 1);\n                }\n            }\n        }\n        this.selectPosition(this.start, this.end);\n    };\n    /**\n     * Select single cell\n     * @private\n     */\n    Selection.prototype.selectTableCell = function () {\n        var start = this.start;\n        var end = this.end;\n        if (!this.isForward) {\n            start = this.end;\n            end = this.start;\n        }\n        if (isNullOrUndefined(this.getTable(start, end))) {\n            return;\n        }\n        if (this.isEmpty) {\n            if (start.paragraph.isInsideTable && !isNullOrUndefined(start.paragraph.associatedCell)) {\n                var firstPara = this.getFirstParagraph(start.paragraph.associatedCell);\n                var lastPara = this.getLastParagraph(end.paragraph.associatedCell);\n                if (firstPara === lastPara) {\n                    this.start.setPosition(lastPara.firstChild, true);\n                    this.end.setPositionParagraph(lastPara.lastChild, lastPara.lastChild.getEndOffset() + 1);\n                }\n                else {\n                    this.start.setPosition(firstPara.firstChild, true);\n                    this.end.setPositionParagraph(lastPara.lastChild, lastPara.lastChild.getEndOffset() + 1);\n                }\n            }\n        }\n        else {\n            var containerCell = this.getContainerCell(start.paragraph.associatedCell);\n            // tslint:disable-next-line:max-line-length\n            if (this.containsCell(containerCell, start.paragraph.associatedCell) && this.containsCell(containerCell, end.paragraph.associatedCell)) {\n                var firstPara = this.getFirstParagraph(containerCell);\n                var lastPara = this.getLastParagraph(containerCell);\n                if (!isNullOrUndefined(firstPara) && !isNullOrUndefined(lastPara)) {\n                    this.start.setPosition(firstPara.firstChild, true);\n                    this.end.setPositionParagraph(lastPara.lastChild, lastPara.lastChild.getEndOffset() + 1);\n                }\n            }\n        }\n        this.selectPosition(this.start, this.end);\n    };\n    /**\n     * @private\n     * Selects the entire document.\n     */\n    Selection.prototype.selectAll = function () {\n        var documentStart;\n        var documentEnd;\n        if (this.owner.enableHeaderAndFooter) {\n            var headerFooter = this.getContainerWidget(this.start.paragraph);\n            documentStart = this.setPositionForBlock(headerFooter.firstChild, true);\n            documentEnd = this.setPositionForBlock(headerFooter.lastChild, false);\n        }\n        else {\n            documentStart = this.owner.documentStart;\n            documentEnd = this.owner.documentEnd;\n        }\n        //Selects the entire document.        \n        if (!isNullOrUndefined(documentStart)) {\n            this.start.setPositionInternal(documentStart);\n            this.end.setPositionParagraph(documentEnd.currentWidget, documentEnd.offset + 1);\n            this.upDownSelectionLength = this.end.location.x;\n            this.fireSelectionChanged(true);\n        }\n    };\n    /**\n     * Extend selection backward\n     * @private\n     */\n    Selection.prototype.extendBackward = function () {\n        if (isNullOrUndefined(this.start)) {\n            return;\n        }\n        this.end.moveBackward();\n        this.upDownSelectionLength = this.end.location.x;\n        this.fireSelectionChanged(true);\n    };\n    /**\n     * Extent selection forward\n     * @private\n     */\n    Selection.prototype.extendForward = function () {\n        if (isNullOrUndefined(this.start)) {\n            return;\n        }\n        this.end.moveForward();\n        this.upDownSelectionLength = this.end.location.x;\n        this.fireSelectionChanged(true);\n    };\n    /**\n     * Extend selection to word start and end\n     * @private\n     */\n    Selection.prototype.extendToWordStartEnd = function () {\n        if ((this.start.paragraph.isInsideTable || this.end.paragraph.isInsideTable)\n            && (this.start.paragraph.associatedCell !== this.end.paragraph.associatedCell\n                || this.isCellSelected(this.start.paragraph.associatedCell, this.start, this.end))) {\n            return true;\n        }\n        return false;\n    };\n    /**\n     * Extend selection to word start\n     * @private\n     */\n    Selection.prototype.extendToWordStart = function (isNavigation) {\n        if (isNullOrUndefined(this.start)) {\n            return;\n        }\n        var isCellSelected = this.extendToWordStartEnd();\n        if (isCellSelected) {\n            this.end.moveToPreviousParagraphInTable(this);\n        }\n        else {\n            this.end.moveToWordStartInternal(isNavigation ? 0 : 1);\n        }\n        if (isNavigation) {\n            this.start.setPositionInternal(this.end);\n        }\n        this.upDownSelectionLength = this.end.location.x;\n        this.fireSelectionChanged(true);\n    };\n    /**\n     * Extent selection to word end\n     * @private\n     */\n    Selection.prototype.extendToWordEnd = function (isNavigation) {\n        if (isNullOrUndefined(this.start)) {\n            return;\n        }\n        var isCellSelect = this.extendToWordStartEnd();\n        if (isCellSelect) {\n            this.end.moveToNextParagraphInTable();\n        }\n        else {\n            this.end.moveToWordEndInternal(isNavigation ? 0 : 1, false);\n        }\n        if (isNavigation) {\n            this.start.setPositionInternal(this.end);\n        }\n        this.upDownSelectionLength = this.end.location.x;\n        this.fireSelectionChanged(true);\n    };\n    /**\n     * Extend selection to next line\n     * @private\n     */\n    Selection.prototype.extendToNextLine = function () {\n        if (isNullOrUndefined(this.start)) {\n            return;\n        }\n        this.end.moveToNextLine(this.upDownSelectionLength);\n        this.fireSelectionChanged(true);\n    };\n    //Selection Text get API\n    //Selection add, Highlight, remove API enda\n    Selection.prototype.getTextPosition = function (hierarchicalIndex) {\n        var textPosition = new TextPosition(this.owner);\n        textPosition.setPositionForCurrentIndex(hierarchicalIndex);\n        return textPosition;\n    };\n    /**\n     * Get Selected text\n     * @private\n     */\n    Selection.prototype.getText = function (includeObject) {\n        if (isNullOrUndefined(this.start) || isNullOrUndefined(this.end)\n            || isNullOrUndefined(this.start.paragraph) || isNullOrUndefined(this.end.paragraph)) {\n            return undefined;\n        }\n        var startPosition = this.start;\n        var endPosition = this.end;\n        if (startPosition.isAtSamePosition(endPosition)) {\n            return '';\n        }\n        return this.getTextInternal(startPosition, endPosition, includeObject);\n    };\n    /**\n     * Get selected text\n     * @private\n     */\n    Selection.prototype.getTextInternal = function (start, end, includeObject) {\n        if (start.isExistAfter(end)) {\n            var temp = end;\n            end = start;\n            start = temp;\n        }\n        var startPosition = start;\n        var endPosition = end;\n        // tslint:disable-next-line:max-line-length\n        if (!isNullOrUndefined(start) && !isNullOrUndefined(end) && !isNullOrUndefined(start.paragraph) && !isNullOrUndefined(end.paragraph)) {\n            var startIndex = 0;\n            var endIndex = 0;\n            var startOffset = start.offset;\n            var endOffset = end.offset;\n            var startInlineObj = start.currentWidget.getInline(startOffset, startIndex);\n            startIndex = startInlineObj.index;\n            var inline = startInlineObj.element;\n            // If the start position is at the beginning of field begin that has field end, then field code should be skipped.\n            if (inline instanceof FieldElementBox && !isNullOrUndefined(inline.fieldEnd)) {\n                var elementInfo = this.getRenderedInline(inline, startIndex);\n                inline = elementInfo.element;\n                startIndex = elementInfo.index;\n            }\n            var endInlineObj = end.currentWidget.getInline(endOffset, endIndex);\n            var endInline = endInlineObj.element;\n            endIndex = endInlineObj.index;\n            var text = '';\n            // Retrieves the text from start inline.\n            if (inline instanceof ImageElementBox && includeObject && startIndex === 0) {\n                text = ElementBox.objectCharacter;\n            }\n            else if (inline instanceof TextElementBox) {\n                // tslint:disable-next-line:max-line-length\n                text = ((isNullOrUndefined(inline.text)) || (inline.text) === '') || inline.text.length < startIndex ? text : inline.text.substring(startIndex);\n            }\n            if (startPosition.paragraph === endPosition.paragraph) {\n                if (inline instanceof ElementBox) {\n                    if (inline === endInline && inline instanceof TextElementBox) {\n                        text = text.length < endIndex - startIndex ? text : text.substring(0, endIndex - startIndex);\n                    }\n                    else if (inline.nextNode instanceof ElementBox) {\n                        // tslint:disable-next-line:max-line-length\n                        text = text + this.getTextInline(inline.nextNode, endPosition.paragraph, endInline, endIndex, includeObject);\n                    }\n                }\n            }\n            else {\n                if (inline instanceof ElementBox && inline.nextNode instanceof ElementBox) {\n                    text = text + this.getTextInline(inline.nextNode, endPosition.paragraph, undefined, 0, includeObject);\n                }\n                else {\n                    // tslint:disable-next-line:max-line-length\n                    var nextParagraphWidget = this.viewer.selection.getNextParagraphBlock(startPosition.paragraph);\n                    text = text + '\\r';\n                    while (!isNullOrUndefined(nextParagraphWidget) && nextParagraphWidget.isEmpty()) {\n                        text = text + '\\r';\n                        if (nextParagraphWidget === endPosition.paragraph) {\n                            return text;\n                        }\n                        nextParagraphWidget = this.viewer.selection.getNextParagraphBlock(nextParagraphWidget);\n                    }\n                    if (!isNullOrUndefined(nextParagraphWidget) && !nextParagraphWidget.isEmpty()) {\n                        // tslint:disable-next-line:max-line-length\n                        text = text + this.getTextInline(nextParagraphWidget.childWidgets[0].children[0], endPosition.paragraph, endInline, endIndex, includeObject);\n                    }\n                }\n            }\n            // If the selection includes end paragraph mark.\n            if (endOffset === (endPosition.currentWidget).getEndOffset() + 1) {\n                text = text + '\\r';\n            }\n            return text;\n        }\n        return undefined;\n    };\n    /**\n     * @private\n     */\n    // tslint:disable-next-line:max-line-length\n    Selection.prototype.getTextInline = function (inlineElement, endParagraphWidget, endInline, endIndex, includeObject) {\n        var text = '';\n        do {\n            if (inlineElement === endInline) {\n                if (inlineElement instanceof TextElementBox) {\n                    var span = inlineElement;\n                    if (!(isNullOrUndefined(span.text) || span.text === '')) {\n                        if (span.text.length < endIndex) {\n                            text = text + span.text;\n                        }\n                        else {\n                            text = text + span.text.substring(0, endIndex);\n                        }\n                    }\n                    // tslint:disable-next-line:max-line-length\n                }\n                else if (inlineElement instanceof ImageElementBox && includeObject && endIndex === inlineElement.length) {\n                    text = text + ElementBox.objectCharacter;\n                }\n                return text;\n            }\n            if (inlineElement instanceof TextElementBox) {\n                text = text + inlineElement.text;\n            }\n            else if (inlineElement instanceof ImageElementBox && includeObject) {\n                text = text + ElementBox.objectCharacter;\n            }\n            else if (inlineElement instanceof FieldElementBox && !isNullOrUndefined(inlineElement.fieldEnd)) {\n                if (!isNullOrUndefined(inlineElement.fieldSeparator)) {\n                    inlineElement = inlineElement.fieldSeparator;\n                }\n                else {\n                    inlineElement = inlineElement.fieldEnd;\n                }\n            }\n            if (isNullOrUndefined(inlineElement.nextNode)) {\n                break;\n            }\n            inlineElement = inlineElement.nextNode;\n        } while (!isNullOrUndefined(inlineElement));\n        if (endParagraphWidget === inlineElement.line.paragraph) {\n            return text;\n        }\n        // tslint:disable-next-line:max-line-length\n        var nextParagraphWidget = this.viewer.selection.getNextParagraphBlock(inlineElement.line.paragraph);\n        while (!isNullOrUndefined(nextParagraphWidget) && nextParagraphWidget.isEmpty()) {\n            text = text + '\\r';\n            if (nextParagraphWidget === endParagraphWidget) {\n                return text;\n            }\n            nextParagraphWidget = this.viewer.selection.getNextParagraphBlock(nextParagraphWidget);\n        }\n        if (!isNullOrUndefined(nextParagraphWidget) && !nextParagraphWidget.isEmpty()) {\n            var lineWidget = nextParagraphWidget.childWidgets[0];\n            // tslint:disable-next-line:max-line-length\n            text = text + '\\r' + this.getTextInline(lineWidget.children[0], endParagraphWidget, endInline, endIndex, includeObject);\n        }\n        return text;\n    };\n    /**\n     * Returns field code.\n     * @private\n     * @param fieldBegin\n     */\n    Selection.prototype.getFieldCode = function (fieldBegin) {\n        var fieldCode = '';\n        if (!(fieldBegin.fieldEnd instanceof FieldElementBox)) {\n            return fieldCode;\n        }\n        var paragraph = fieldBegin.paragraph;\n        var endParagraph = fieldBegin.fieldEnd.paragraph;\n        if (fieldBegin.fieldSeparator instanceof FieldElementBox) {\n            endParagraph = fieldBegin.fieldSeparator.paragraph;\n        }\n        var startLineIndex = fieldBegin.line.indexInOwner;\n        var startIndex = fieldBegin.indexInOwner;\n        do {\n            fieldCode += this.getFieldCodeInternal(paragraph, startLineIndex, startIndex);\n            if (paragraph === endParagraph) {\n                break;\n            }\n            paragraph = this.getNextParagraphBlock(paragraph);\n            startLineIndex = 0;\n            startIndex = 0;\n        } while (paragraph instanceof ParagraphWidget);\n        return fieldCode.trim();\n    };\n    Selection.prototype.getFieldCodeInternal = function (paragraph, startLineIndex, inlineIndex) {\n        var fieldCode = '';\n        for (var i = startLineIndex; i < paragraph.childWidgets.length; i++) {\n            var line = paragraph.childWidgets[i];\n            for (var i_1 = inlineIndex; i_1 < line.children.length; i_1++) {\n                var element = line.children[i_1];\n                if (element instanceof TextElementBox) {\n                    fieldCode += element.text;\n                }\n                if (element instanceof FieldElementBox\n                    && (element.fieldType === 2 || element.fieldType === 1)) {\n                    return fieldCode;\n                }\n            }\n            inlineIndex = 0;\n        }\n        return fieldCode;\n    };\n    /**\n     * @private\n     */\n    Selection.prototype.getTocFieldInternal = function () {\n        var paragraph = this.start.paragraph;\n        if (!this.isEmpty && !this.isForward) {\n            paragraph = this.end.paragraph;\n        }\n        while (paragraph instanceof ParagraphWidget && paragraph.childWidgets.length > 0) {\n            var line = paragraph.firstChild;\n            if (line.children.length > 0) {\n                var element = line.children[0];\n                var nextElement = element.nextNode;\n                if (element instanceof FieldElementBox && element.fieldType === 0 && nextElement instanceof TextElementBox\n                    && nextElement.text.trim().toLowerCase().indexOf('toc') === 0) {\n                    return element;\n                }\n            }\n            paragraph = paragraph.previousRenderedWidget;\n        }\n        return undefined;\n    };\n    /**\n     * Get next paragraph in bodyWidget\n     * @private\n     */\n    Selection.prototype.getNextParagraph = function (section) {\n        if (section.nextRenderedWidget instanceof BodyWidget) {\n            var block = section.nextRenderedWidget.childWidgets[0];\n            return this.getFirstParagraphBlock(block);\n        }\n        return undefined;\n    };\n    /**\n     * @private\n     */\n    Selection.prototype.getPreviousParagraph = function (section) {\n        if (section.previousRenderedWidget instanceof BodyWidget) {\n            var bodyWidget = section.previousRenderedWidget;\n            var block = bodyWidget.childWidgets[bodyWidget.childWidgets.length - 1];\n            return this.getLastParagraphBlock(block);\n        }\n        return undefined;\n    };\n    /**\n     * Get first paragraph in cell\n     * @private\n     */\n    Selection.prototype.getFirstParagraphInCell = function (cell) {\n        var firstBlock = cell.childWidgets[0];\n        if (firstBlock instanceof ParagraphWidget) {\n            return firstBlock;\n        }\n        else {\n            return this.getFirstParagraphInFirstCell(firstBlock);\n        }\n    };\n    /**\n     * Get first paragraph in first cell\n     * @private\n     */\n    Selection.prototype.getFirstParagraphInFirstCell = function (table) {\n        if (table.childWidgets.length > 0) {\n            var firstRow = table.childWidgets[0];\n            var cell = firstRow.childWidgets[0];\n            var block = cell.childWidgets[0];\n            return this.getFirstParagraphBlock(block);\n        }\n        return undefined;\n    };\n    /**\n     * Get last paragraph in last cell\n     * @private\n     */\n    Selection.prototype.getLastParagraphInLastCell = function (table) {\n        if (table.childWidgets.length > 0) {\n            var lastrow = table.lastChild;\n            var lastcell = lastrow.lastChild;\n            var lastBlock = lastcell.lastChild;\n            return this.getLastParagraphBlock(lastBlock);\n        }\n        return undefined;\n    };\n    /**\n     * Get last paragraph in first row\n     * @private\n     */\n    Selection.prototype.getLastParagraphInFirstRow = function (table) {\n        if (table.childWidgets.length > 0) {\n            var row = table.firstChild;\n            var lastcell = row.lastChild;\n            var lastBlock = lastcell.lastChild;\n            return this.getLastParagraphBlock(lastBlock);\n        }\n        return undefined;\n    };\n    /**\n     * Get Next start inline\n     * @private\n     */\n    Selection.prototype.getNextStartInline = function (line, offset) {\n        var indexInInline = 0;\n        var inlineObj = line.getInline(offset, indexInInline);\n        var inline = inlineObj.element;\n        indexInInline = inlineObj.index;\n        if (!isNullOrUndefined(inline) && indexInInline === inline.length && inline.nextNode instanceof FieldElementBox) {\n            var nextValidInline = this.getNextValidElement(inline.nextNode);\n            if (nextValidInline instanceof FieldElementBox && nextValidInline.fieldType === 0) {\n                inline = nextValidInline;\n            }\n        }\n        return inline;\n    };\n    /**\n     * Get previous text inline\n     * @private\n     */\n    Selection.prototype.getPreviousTextInline = function (inline) {\n        if (inline.previousNode instanceof TextElementBox) {\n            return inline.previousNode;\n        }\n        if (inline.previousNode instanceof FieldElementBox && HelperMethods.isLinkedFieldCharacter(inline.previousNode)) {\n            if (inline.previousNode.fieldType === 0 || inline.previousNode.fieldType === 1) {\n                return inline.previousNode;\n            }\n            return inline.previousNode.fieldBegin;\n        }\n        if (!isNullOrUndefined(inline.previousNode)) {\n            return this.getPreviousTextInline((inline.previousNode));\n        }\n        return undefined;\n    };\n    /**\n     * Get next text inline\n     * @private\n     */\n    Selection.prototype.getNextTextInline = function (inline) {\n        if (inline.nextNode instanceof TextElementBox) {\n            return inline.nextNode;\n        }\n        if (inline.nextNode instanceof FieldElementBox && (HelperMethods.isLinkedFieldCharacter(inline.nextNode))) {\n            if (inline.nextNode.fieldType === 1 || inline.nextNode.fieldType === 0) {\n                return inline.nextNode;\n            }\n            return inline.nextNode.fieldEnd;\n        }\n        if (!isNullOrUndefined(inline.nextNode)) {\n            return this.getNextTextInline((inline.nextNode));\n        }\n        return undefined;\n    };\n    /**\n     * Get container table\n     * @private\n     */\n    Selection.prototype.getContainerTable = function (block) {\n        if (block.isInsideTable) {\n            if (block.associatedCell.ownerTable.isInsideTable) {\n                block = this.getContainerTable(block.associatedCell.ownerTable);\n            }\n            else {\n                block = block.associatedCell.ownerTable;\n            }\n        }\n        if (block instanceof TableWidget) {\n            return block;\n        }\n        return undefined;\n    };\n    /**\n     * @private\n     */\n    Selection.prototype.isExistBefore = function (start, block) {\n        if (start.isInsideTable) {\n            var cell1 = start.associatedCell;\n            if (block.isInsideTable) {\n                var cell2 = block.associatedCell;\n                if (cell1 === cell2) {\n                    return cell1.childWidgets.indexOf(start) < cell1.childWidgets.indexOf(block);\n                }\n                if (cell1.ownerRow === cell2.ownerRow) {\n                    return cell1.cellIndex < cell2.cellIndex;\n                }\n                if (cell1.ownerTable === cell2.ownerTable) {\n                    return cell1.ownerRow.rowIndex < cell2.ownerRow.rowIndex;\n                }\n                //Checks if current block exists before the block.\n                var containerCell = this.getContainerCellOf(cell1, cell2);\n                if (containerCell.ownerTable.contains(cell2)) {\n                    cell1 = this.getSelectedCell(cell1, containerCell);\n                    cell2 = this.getSelectedCell(cell2, containerCell);\n                    if (cell1 === containerCell) {\n                        return this.isExistBefore(start, cell2.ownerTable);\n                    }\n                    if (cell2 === containerCell) {\n                        return this.isExistBefore(cell1.ownerTable, block);\n                    }\n                    if (containerCell.ownerRow === cell2.ownerRow) {\n                        return containerCell.cellIndex < cell2.cellIndex;\n                    }\n                    if (containerCell.ownerTable === cell2.ownerTable) {\n                        return containerCell.ownerRow.rowIndex < cell2.ownerRow.rowIndex;\n                    }\n                    return this.isExistBefore(cell1.ownerTable, cell2.ownerTable);\n                }\n                return this.isExistBefore(containerCell.ownerTable, this.getContainerTable(cell2.ownerTable));\n            }\n            else {\n                var ownerTable = this.getContainerTable(start);\n                return this.isExistBefore(ownerTable, block);\n            }\n        }\n        else if (block.isInsideTable) {\n            var ownerTable = this.getContainerTable(block);\n            return this.isExistBefore(start, ownerTable);\n        }\n        else {\n            {\n                if (start.containerWidget === block.containerWidget) {\n                    return start.index <\n                        block.index;\n                }\n                if (start.containerWidget instanceof BodyWidget && block.containerWidget instanceof BodyWidget) {\n                    //Splitted blocks                     \n                    var startPage = this.viewer.pages.indexOf(start.containerWidget.page);\n                    var endPage = this.viewer.pages.indexOf(block.containerWidget.page);\n                    return startPage < endPage;\n                }\n            }\n        }\n        return false;\n    };\n    /**\n     * @private\n     */\n    Selection.prototype.isExistAfter = function (start, block) {\n        if (start.isInsideTable) {\n            var cell1 = start.associatedCell;\n            //Current paragraph in cell, paragraph in cell\n            if (block.isInsideTable) {\n                var cell2 = block.associatedCell;\n                if (cell1 === cell2) {\n                    return cell1.childWidgets.indexOf(start) > cell1.childWidgets.indexOf(block);\n                }\n                if (cell1.ownerRow === cell2.ownerRow) {\n                    return cell1.cellIndex > cell2.cellIndex;\n                }\n                if (cell1.ownerTable === cell2.ownerTable) {\n                    return cell1.ownerRow.rowIndex > cell2.ownerRow.rowIndex;\n                }\n                //Checks if this block exists before block.\n                var containerCell = this.getContainerCellOf(cell1, cell2);\n                if (containerCell.ownerTable.contains(cell2)) {\n                    cell1 = this.getSelectedCell(cell1, containerCell);\n                    cell2 = this.getSelectedCell(cell2, containerCell);\n                    if (cell1 === containerCell) {\n                        return this.isExistAfter(start, cell2.ownerTable);\n                    }\n                    if (cell2 === containerCell) {\n                        return this.isExistAfter(cell1.ownerTable, block);\n                    }\n                    if (containerCell.ownerRow === cell2.ownerRow) {\n                        return containerCell.cellIndex > cell2.cellIndex;\n                    }\n                    if (containerCell.ownerTable === cell2.ownerTable) {\n                        return containerCell.ownerRow.rowIndex > cell2.ownerRow.rowIndex;\n                    }\n                    return this.isExistAfter(cell1.ownerTable, cell2.ownerTable);\n                }\n                return this.isExistAfter(containerCell.ownerTable, this.getContainerTable(cell2.ownerTable));\n            }\n            else {\n                var ownerTable = this.getContainerTable(start);\n                return this.isExistAfter(ownerTable, block);\n            }\n        }\n        else if (block.isInsideTable) {\n            var ownerTable = this.getContainerTable(block);\n            return this.isExistAfter(start, ownerTable);\n        }\n        else {\n            if (start.containerWidget === block.containerWidget) {\n                return start.index >\n                    block.index;\n            }\n            if (start.containerWidget instanceof BodyWidget && block.containerWidget instanceof BodyWidget) {\n                //Splitted blocks                     \n                var startPage = this.viewer.pages.indexOf(start.containerWidget.page);\n                var endPage = this.viewer.pages.indexOf(block.containerWidget.page);\n                return startPage > endPage;\n            }\n            //     if (start.owner instanceof WHeaderFooter) {\n            //         return (start.owner as WHeaderFooter).childWidgets.indexOf(start) \n            // > (block.owner as WHeaderFooter).childWidgets.indexOf(block);\n            //     } else if (start.section === block.section && start.section instanceof WSection) {\n            //         return (start.section as WSection).childWidgets.indexOf(start)\n            //  > (start.section as WSection).childWidgets.indexOf(block);\n            //     } else if (start.wordDocument instanceof WordDocument) {\n            // tslint:disable-next-line:max-line-length\n            //         return (start.wordDocument as WordDocument).sections.indexOf(start.section as WSection) > (start.wordDocument as WordDocument).sections.indexOf(block.section as WSection);\n        }\n        return false;\n    };\n    /**\n     * Return true if current inline in exist before inline\n     * @private\n     */\n    Selection.prototype.isExistBeforeInline = function (currentInline, inline) {\n        if (currentInline.line === inline.line) {\n            return currentInline.line.children.indexOf(currentInline) <\n                inline.line.children.indexOf(inline);\n        }\n        if (currentInline.line.paragraph === inline.line.paragraph) {\n            return currentInline.line.paragraph.childWidgets.indexOf(currentInline.line)\n                < inline.line.paragraph.childWidgets.indexOf(inline.line);\n        }\n        var startParagraph = currentInline.line.paragraph;\n        var endParagraph = inline.line.paragraph;\n        if (startParagraph.containerWidget === endParagraph.containerWidget) {\n            if (startParagraph.isInsideTable) {\n                return startParagraph.associatedCell.childWidgets.indexOf(startParagraph) <\n                    endParagraph.associatedCell.childWidgets.indexOf(endParagraph);\n            }\n            else if (startParagraph.containerWidget instanceof HeaderFooterWidget) {\n                // return ((currentInline.owner as WParagraph).owner as WHeaderFooter).blocks.indexOf(currentInline.owner as WParagraph) <\n                //     ((inline.owner as WParagraph).owner as WHeaderFooter).blocks.indexOf(inline.owner as WParagraph);\n            }\n            else {\n                return startParagraph.containerWidget.childWidgets.indexOf(startParagraph) <\n                    endParagraph.containerWidget.childWidgets.indexOf(endParagraph);\n            }\n        }\n        return this.isExistBefore(startParagraph, endParagraph);\n    };\n    /**\n     * Return true id current inline is exist after inline\n     * @private\n     */\n    Selection.prototype.isExistAfterInline = function (currentInline, inline) {\n        if (currentInline.line === inline.line) {\n            return currentInline.line.children.indexOf(currentInline) >\n                inline.line.children.indexOf(inline);\n        }\n        if (currentInline.line.paragraph === inline.line.paragraph) {\n            return currentInline.line.paragraph.childWidgets.indexOf(currentInline.line)\n                > inline.line.paragraph.childWidgets.indexOf(inline.line);\n        }\n        var startParagraph = currentInline.line.paragraph;\n        var endParagraph = inline.line.paragraph;\n        if (startParagraph.containerWidget === endParagraph.containerWidget) {\n            if (startParagraph.isInsideTable) {\n                return startParagraph.associatedCell.childWidgets.indexOf(startParagraph) >\n                    endParagraph.associatedCell.childWidgets.indexOf(endParagraph);\n            }\n            else if (startParagraph.containerWidget instanceof HeaderFooterWidget) {\n                // return ((currentInline.owner as WParagraph).owner as WHeaderFooter).blocks.indexOf(currentInline.owner as WParagraph) <\n                //     ((inline.owner as WParagraph).owner as WHeaderFooter).blocks.indexOf(inline.owner as WParagraph);\n            }\n            else {\n                return startParagraph.containerWidget.childWidgets.indexOf(startParagraph) >\n                    endParagraph.containerWidget.childWidgets.indexOf(endParagraph);\n            }\n        }\n        return this.isExistAfter(startParagraph, endParagraph);\n    };\n    /**\n     * Get next rendered block\n     * @private\n     */\n    Selection.prototype.getNextRenderedBlock = function (block) {\n        if (isNullOrUndefined(block.nextWidget)) {\n            return block.nextRenderedWidget;\n        }\n        return block.nextWidget;\n    };\n    /**\n     * Get next rendered block\n     * @private\n     */\n    Selection.prototype.getPreviousRenderedBlock = function (block) {\n        if (isNullOrUndefined(block.previousWidget)) {\n            return block.previousRenderedWidget;\n        }\n        return block.previousWidget;\n    };\n    /**\n     * Get Next paragraph in block\n     * @private\n     */\n    Selection.prototype.getNextParagraphBlock = function (block) {\n        if (block.nextRenderedWidget instanceof ParagraphWidget) {\n            return block.nextRenderedWidget;\n        }\n        else if (block.nextRenderedWidget instanceof TableWidget) {\n            return this.getFirstParagraphInFirstCell(block.nextRenderedWidget);\n        }\n        if (block.containerWidget instanceof TableCellWidget) {\n            return this.getNextParagraphCell(block.containerWidget);\n        }\n        else if (block.containerWidget instanceof BodyWidget) {\n            var bodyWidget = block.containerWidget;\n            return this.getNextParagraph(block.containerWidget);\n        }\n        else if (block.containerWidget instanceof HeaderFooterWidget && this.isMoveDownOrMoveUp) {\n            return this.getFirstBlockInNextHeaderFooter(block);\n        }\n        return undefined;\n    };\n    /**\n     * @private\n     */\n    Selection.prototype.getFirstBlockInNextHeaderFooter = function (block) {\n        var headerFooter = block.containerWidget;\n        var nextBlock;\n        if (headerFooter.headerFooterType.indexOf('Header') !== -1) {\n            nextBlock = headerFooter.page.footerWidget.firstChild;\n        }\n        else if (headerFooter.page.nextPage) {\n            nextBlock = headerFooter.page.nextPage.headerWidget.firstChild;\n        }\n        else {\n            return undefined;\n        }\n        if (nextBlock instanceof ParagraphWidget) {\n            return nextBlock;\n        }\n        else {\n            return this.getFirstBlockInFirstCell(nextBlock);\n        }\n    };\n    /**\n     * @private\n     */\n    Selection.prototype.getLastBlockInPreviousHeaderFooter = function (block) {\n        var headerFooter = block.containerWidget;\n        var previousBlock;\n        if (headerFooter.headerFooterType.indexOf('Footer') !== -1) {\n            previousBlock = headerFooter.page.headerWidget.lastChild;\n        }\n        else if (headerFooter.page.previousPage) {\n            previousBlock = headerFooter.page.previousPage.footerWidget.lastChild;\n        }\n        else {\n            return undefined;\n        }\n        if (previousBlock instanceof ParagraphWidget) {\n            return previousBlock;\n        }\n        else {\n            return this.getFirstBlockInFirstCell(previousBlock);\n        }\n    };\n    /**\n     * Get previous paragraph in block\n     * @private\n     */\n    Selection.prototype.getPreviousParagraphBlock = function (block) {\n        if (block.previousRenderedWidget instanceof ParagraphWidget) {\n            return block.previousRenderedWidget;\n        }\n        else if (block.previousRenderedWidget instanceof TableWidget) {\n            return this.getLastParagraphInLastCell((block.previousRenderedWidget));\n        }\n        if (block.containerWidget instanceof TableCellWidget) {\n            return this.getPreviousParagraphCell((block.containerWidget));\n        }\n        else if (block.containerWidget instanceof BodyWidget) {\n            return this.getPreviousParagraph(block.containerWidget);\n        }\n        else if (block.containerWidget instanceof HeaderFooterWidget && this.isMoveDownOrMoveUp) {\n            return this.getLastBlockInPreviousHeaderFooter(block);\n        }\n        return undefined;\n    };\n    /**\n     * Get first paragraph in block\n     * @private\n     */\n    Selection.prototype.getFirstParagraphBlock = function (block) {\n        if (block instanceof ParagraphWidget) {\n            return block;\n        }\n        else if (block instanceof TableWidget) {\n            return this.getFirstParagraphInFirstCell(block);\n        }\n        return undefined;\n    };\n    /**\n     * Get last paragraph in block\n     * @private\n     */\n    Selection.prototype.getLastParagraphBlock = function (block) {\n        if (block instanceof ParagraphWidget) {\n            return block;\n        }\n        else if (block instanceof TableWidget) {\n            return this.getLastParagraphInLastCell(block);\n        }\n        return undefined;\n    };\n    /**\n     * Return true if paragraph has valid inline\n     * @private\n     */\n    Selection.prototype.hasValidInline = function (paragraph, start, end) {\n        var index = paragraph.childWidgets.indexOf(start.line);\n        for (var i = index; i < paragraph.childWidgets.length; i++) {\n            for (var j = 0; j < paragraph.childWidgets[i].children.length; j++) {\n                var inline = paragraph.childWidgets[i].children[j];\n                if (inline.length === 0) {\n                    continue;\n                }\n                if (inline === end) {\n                    return false;\n                }\n                if (inline instanceof TextElementBox || inline instanceof ImageElementBox\n                    || (inline instanceof FieldElementBox && HelperMethods.isLinkedFieldCharacter(inline))) {\n                    return true;\n                }\n            }\n        }\n        return false;\n    };\n    /**\n     * Get paragraph length\n     * @private\n     */\n    Selection.prototype.getParagraphLength = function (paragraph, endLine, elementInfo) {\n        var length = 0;\n        for (var j = 0; j < paragraph.childWidgets.length; j++) {\n            var line = paragraph.childWidgets[j];\n            if (endLine instanceof LineWidget && endLine === line) {\n                if (elementInfo) {\n                    length += this.getLineLength(line, elementInfo);\n                }\n                break;\n            }\n            length += this.getLineLength(line);\n        }\n        return length;\n    };\n    /**\n     * Get Line length\n     * @private\n     */\n    Selection.prototype.getLineLength = function (line, elementInfo) {\n        var length = 0;\n        for (var i = 0; i < line.children.length; i++) {\n            var element = line.children[i];\n            if (element instanceof ListTextElementBox) {\n                continue;\n            }\n            if (elementInfo && elementInfo.element instanceof ElementBox && elementInfo.element === element) {\n                length += elementInfo.index;\n                break;\n            }\n            length += element.length;\n        }\n        return length;\n    };\n    /**\n     * Get line information\n     * @private\n     */\n    Selection.prototype.getLineInfo = function (paragraph, offset) {\n        var line = undefined;\n        var length = 0;\n        var childLength = paragraph.childWidgets.length;\n        for (var j = 0; j < childLength; j++) {\n            line = paragraph.childWidgets[j];\n            length = this.getLineLength(line);\n            if (offset <= length || j === childLength - 1) {\n                break;\n            }\n            else {\n                offset = offset - length;\n            }\n        }\n        return { 'line': line, 'offset': offset };\n    };\n    /**\n     * @private\n     */\n    Selection.prototype.getElementInfo = function (line, offset) {\n        var index = 0;\n        var element = undefined;\n        for (var i = 0; i < line.children.length; i++) {\n            element = line.children[i];\n            if (element instanceof ListTextElementBox) {\n                continue;\n            }\n            if (offset > element.length\n                && (!(offset === element.length + 1 && isNullOrUndefined(element.nextNode)))) {\n                offset = offset - element.length;\n            }\n            else {\n                break;\n            }\n        }\n        return { 'element': element, 'index': offset };\n    };\n    /**\n     * Get paragraph start offset\n     * @private\n     */\n    Selection.prototype.getStartOffset = function (paragraph) {\n        var startOffset = 0;\n        if (paragraph.childWidgets.length > 0) {\n            var childWidgets = paragraph.childWidgets[0];\n            return this.getStartLineOffset(childWidgets);\n        }\n        return startOffset;\n    };\n    /**\n     * @private\n     */\n    Selection.prototype.getStartLineOffset = function (line) {\n        var startOffset = 0;\n        for (var i = 0; i < line.children.length; i++) {\n            var inline = line.children[i];\n            if (inline.length === 0) {\n                continue;\n            }\n            if (inline instanceof TextElementBox || inline instanceof ImageElementBox || inline instanceof BookmarkElementBox\n                || (inline instanceof FieldElementBox && HelperMethods.isLinkedFieldCharacter(inline))) {\n                return startOffset;\n            }\n            if (inline instanceof ListTextElementBox) {\n                continue;\n            }\n            startOffset += inline.length;\n        }\n        return startOffset;\n    };\n    /**\n     * Get previous paragraph from selection\n     * @private\n     */\n    Selection.prototype.getPreviousSelectionCell = function (cell) {\n        if (!isNullOrUndefined(cell.previousRenderedWidget)) {\n            if (!this.isForward) {\n                var block = cell.previousRenderedWidget.childWidgets[0];\n                if (block instanceof ParagraphWidget) {\n                    return block;\n                }\n                else {\n                    return this.getFirstParagraphInLastRow(block);\n                }\n            }\n            else {\n                var widgets = cell.previousRenderedWidget.childWidgets;\n                var block = widgets[widgets.length - 1];\n                if (block instanceof ParagraphWidget) {\n                    return block;\n                }\n                else {\n                    // tslint:disable-next-line:max-line-length\n                    return this.getPreviousParagraphSelection(block.childWidgets[block.childWidgets.length - 1]);\n                }\n            }\n        }\n        return this.getPreviousSelectionRow(cell.ownerRow);\n    };\n    /**\n     * Get previous paragraph selection in selection\n     * @private\n     */\n    Selection.prototype.getPreviousSelectionRow = function (row) {\n        if (!isNullOrUndefined(row.previousRenderedWidget)) {\n            if (!this.isForward) {\n                var cell = row.previousRenderedWidget.childWidgets[0];\n                var block = cell.childWidgets[0];\n                return this.getFirstParagraphBlock(block);\n            }\n            else {\n                return this.getPreviousParagraphSelection(row.previousRenderedWidget);\n            }\n        }\n        return this.getPreviousSelectionBlock(row.ownerTable);\n    };\n    /**\n     * @private\n     */\n    Selection.prototype.getNextSelectionBlock = function (block) {\n        if (block.nextRenderedWidget instanceof ParagraphWidget) {\n            return block.nextRenderedWidget;\n        }\n        else if (block.nextRenderedWidget instanceof TableWidget) {\n            if (this.isEmpty || this.isForward) {\n                return this.getLastParagraphInFirstRow(block.nextRenderedWidget);\n            }\n            else {\n                return this.getNextParagraphSelection(block.nextRenderedWidget.childWidgets[0]);\n            }\n        }\n        if (block.containerWidget instanceof TableCellWidget) {\n            return this.getNextSelectionCell(block.containerWidget);\n        }\n        else if (block.containerWidget instanceof BodyWidget) {\n            return this.getNextSelection(block.containerWidget);\n        }\n        return undefined;\n    };\n    /**\n     * Get next paragraph from selected cell\n     * @private\n     */\n    Selection.prototype.getNextSelectionCell = function (cell) {\n        if (!isNullOrUndefined(cell.nextRenderedWidget)) {\n            if (this.isEmpty || this.isForward) {\n                // tslint:disable-next-line:max-line-length\n                var block = cell.nextRenderedWidget.childWidgets[cell.nextRenderedWidget.childWidgets.length - 1];\n                return this.getLastParagraphBlock(block);\n            }\n            else {\n                //Return first paragraph in cell. \n                var block = cell.nextRenderedWidget.childWidgets[0];\n                if (block instanceof ParagraphWidget) {\n                    return block;\n                }\n                else {\n                    return this.getNextParagraphSelection(block.childWidgets[0]);\n                }\n            }\n        }\n        return this.getNextSelectionRow(cell.ownerRow);\n    };\n    /**\n     * Get next paragraph in selection\n     * @private\n     */\n    Selection.prototype.getNextSelectionRow = function (row) {\n        if (!isNullOrUndefined(row.nextRenderedWidget)) {\n            var isForwardSelection = this.isEmpty || this.isForward;\n            if (isForwardSelection) {\n                // tslint:disable-next-line:max-line-length\n                var cell = row.nextRenderedWidget.childWidgets[row.nextRenderedWidget.childWidgets.length - 1];\n                var block = cell.childWidgets[cell.childWidgets.length - 1];\n                return this.getLastParagraphBlock(block);\n            }\n            else {\n                return this.getNextParagraphSelection(row.nextRenderedWidget);\n            }\n        }\n        return this.getNextSelectionBlock(row.ownerTable);\n    };\n    /**\n     * Get next block with selection\n     * @private\n     */\n    Selection.prototype.getNextSelection = function (section) {\n        if (section.nextRenderedWidget instanceof BodyWidget) {\n            var block = section.nextRenderedWidget.childWidgets[0];\n            if (block instanceof ParagraphWidget) {\n                return block;\n            }\n            else {\n                if (this.isEmpty || this.isForward) {\n                    return this.getLastParagraphInFirstRow(block);\n                }\n                else {\n                    return this.getNextParagraphSelection(block.childWidgets[0]);\n                }\n            }\n        }\n        return undefined;\n    };\n    /**\n     * @private\n     */\n    Selection.prototype.getNextParagraphSelection = function (row) {\n        //Iterate the exact cell based on UP/Down selection length.\n        var cell = row.childWidgets[0];\n        if (this.start.paragraph.isInsideTable\n            && row.ownerTable.contains(this.start.paragraph.associatedCell)) {\n            var startCell = this.getCellInTable(row.ownerTable, this.start.paragraph.associatedCell);\n            cell = this.getFirstCellInRegion(row, startCell, this.upDownSelectionLength, false);\n        }\n        var block = cell.childWidgets[0];\n        return this.getFirstParagraphBlock(block);\n    };\n    /**\n     * @private\n     */\n    Selection.prototype.getPreviousSelectionBlock = function (block) {\n        if (block.previousRenderedWidget instanceof ParagraphWidget) {\n            return block.previousRenderedWidget;\n        }\n        else if (block.previousRenderedWidget instanceof TableWidget) {\n            if (!this.isForward) {\n                return this.getFirstParagraphInLastRow(block.previousRenderedWidget);\n            }\n            else {\n                // tslint:disable-next-line:max-line-length\n                return this.getPreviousParagraphSelection(block.previousRenderedWidget.childWidgets[block.previousRenderedWidget.childWidgets.length - 1]);\n            }\n        }\n        if (block.containerWidget instanceof TableCellWidget) {\n            return this.getPreviousSelectionCell(block.containerWidget);\n        }\n        else if (block.containerWidget instanceof BodyWidget) {\n            return this.getPreviousSelection(block.containerWidget);\n        }\n        return undefined;\n    };\n    /**\n     * Get previous paragraph in selection\n     * @private\n     */\n    Selection.prototype.getPreviousSelection = function (section) {\n        if (section.previousRenderedWidget instanceof BodyWidget) {\n            var prevBodyWidget = section.previousRenderedWidget;\n            var block = prevBodyWidget.childWidgets[prevBodyWidget.childWidgets.length - 1];\n            if (block instanceof ParagraphWidget) {\n                return block;\n            }\n            else {\n                if (!this.isForward) {\n                    return this.getFirstParagraphInLastRow(block);\n                }\n                else {\n                    var tableWidget = block;\n                    // tslint:disable-next-line:max-line-length\n                    return this.getPreviousParagraphSelection(tableWidget.childWidgets[tableWidget.childWidgets.length - 1]);\n                }\n            }\n        }\n        return undefined;\n    };\n    /**\n     * @private\n     */\n    Selection.prototype.getPreviousParagraphSelection = function (row) {\n        //Iterate the exact cell based on UP/Down selection length.\n        var cell = row.childWidgets[row.childWidgets.length - 1];\n        if (this.start.paragraph.isInsideTable\n            && row.ownerTable.contains(this.start.paragraph.associatedCell)) {\n            var startCell = this.getCellInTable(row.ownerTable, this.start.paragraph.associatedCell);\n            cell = this.getLastCellInRegion(row, startCell, this.upDownSelectionLength, true);\n        }\n        var block = cell.childWidgets[cell.childWidgets.length - 1];\n        return this.getLastParagraphBlock(block);\n    };\n    /**\n     * Get last cell in the selected region\n     * @private\n     */\n    Selection.prototype.getLastCellInRegion = function (row, startCell, selLength, isMovePrev) {\n        var start = this.getCellLeft(row, startCell);\n        var end = start + startCell.cellFormat.cellWidth;\n        var flag = true;\n        if (start <= selLength && selLength < end) {\n            for (var i = row.childWidgets.length - 1; i >= 0; i--) {\n                var left = this.getCellLeft(row, row.childWidgets[i]);\n                if (HelperMethods.round(start, 2) <= HelperMethods.round(left, 2) &&\n                    HelperMethods.round(left, 2) < HelperMethods.round(end, 2)) {\n                    flag = false;\n                    return row.childWidgets[i];\n                }\n            }\n        }\n        else {\n            for (var i = row.childWidgets.length - 1; i >= 0; i--) {\n                var left = this.getCellLeft(row, row.childWidgets[i]);\n                if (left <= selLength && left + row.childWidgets[i].cellFormat.cellWidth > selLength) {\n                    flag = false;\n                    return row.childWidgets[i];\n                }\n            }\n        }\n        if (flag) {\n            if (!isNullOrUndefined(row.previousRenderedWidget) && isMovePrev) {\n                return this.getLastCellInRegion(row.previousRenderedWidget, startCell, selLength, isMovePrev);\n            }\n            else if (!isNullOrUndefined(row.nextRenderedWidget) && !isMovePrev) {\n                return this.getLastCellInRegion(row.nextRenderedWidget, startCell, selLength, isMovePrev);\n            }\n        }\n        return row.childWidgets[row.childWidgets.length - 1];\n    };\n    /**\n     * Get Container table\n     * @private\n     */\n    Selection.prototype.getCellInTable = function (table, tableCell) {\n        while (tableCell.ownerTable.isInsideTable) {\n            if (table.equals(tableCell.ownerTable)) {\n                return tableCell;\n            }\n            tableCell = tableCell.ownerTable.associatedCell;\n        }\n        return tableCell;\n    };\n    /**\n     * Get first paragraph in last row\n     * @private\n     */\n    Selection.prototype.getFirstParagraphInLastRow = function (table) {\n        if (table.childWidgets.length > 0) {\n            var lastRow = table.childWidgets[table.childWidgets.length - 1];\n            var lastCell = lastRow.childWidgets[0];\n            var lastBlock = lastCell.childWidgets[0];\n            return this.getFirstParagraphBlock(lastBlock);\n        }\n        return undefined;\n    };\n    /**\n     * Get previous valid offset\n     * @private\n     */\n    Selection.prototype.getPreviousValidOffset = function (paragraph, offset) {\n        if (offset === 0) {\n            return 0;\n        }\n        var validOffset = 0;\n        var count = 0;\n        for (var i = 0; i < paragraph.childWidgets.length; i++) {\n            var lineWidget = paragraph.childWidgets[i];\n            for (var j = 0; j < lineWidget.children.length; j++) {\n                var inline = lineWidget.children[j];\n                if (inline.length === 0) {\n                    continue;\n                }\n                if (offset <= count + inline.length) {\n                    return offset - 1 === count ? validOffset : offset - 1;\n                }\n                if (inline instanceof TextElementBox || inline instanceof ImageElementBox\n                    || (inline instanceof FieldElementBox && HelperMethods.isLinkedFieldCharacter(inline))) {\n                    validOffset = count + inline.length;\n                }\n                count += inline.length;\n            }\n        }\n        return offset - 1 === count ? validOffset : offset - 1;\n    };\n    /**\n     * Get next valid offset\n     * @private\n     */\n    Selection.prototype.getNextValidOffset = function (line, offset) {\n        var count = 0;\n        for (var i = 0; i < line.children.length; i++) {\n            var inline = line.children[i];\n            if (inline.length === 0 || inline instanceof ListTextElementBox) {\n                continue;\n            }\n            if (offset < count + inline.length) {\n                if (inline instanceof TextElementBox || inline instanceof ImageElementBox\n                    || (inline instanceof FieldElementBox && HelperMethods.isLinkedFieldCharacter(inline))) {\n                    return (offset > count ? offset : count) + 1;\n                }\n            }\n            count += inline.length;\n        }\n        return offset;\n    };\n    /**\n     * Get paragraph mark size info\n     * @private\n     */\n    Selection.prototype.getParagraphMarkSize = function (paragraph, topMargin, bottomMargin) {\n        var size = this.viewer.textHelper.getParagraphMarkSize(paragraph.characterFormat);\n        var baselineOffset = size.BaselineOffset;\n        var maxHeight = size.Height;\n        var maxBaselineOffset = baselineOffset;\n        if (paragraph instanceof ParagraphWidget) {\n            // let paragraphWidget: ParagraphWidget[] = paragraph.renderedElement() as ParagraphWidget[];\n            if (paragraph.childWidgets.length > 0) {\n                var lineWidget = paragraph.childWidgets[0];\n            }\n            //Gets line spacing.\n            var lineSpacing = this.viewer.layout.getLineSpacing(paragraph, maxHeight);\n            var beforeSpacing = this.viewer.layout.getBeforeSpacing(paragraph);\n            topMargin = maxBaselineOffset - baselineOffset;\n            bottomMargin = maxHeight - maxBaselineOffset - (size.Height - baselineOffset);\n            //Updates line spacing, paragraph after/ before spacing and aligns the text to base line offset.\n            var lineSpacingType = paragraph.paragraphFormat.lineSpacingType;\n            if (lineSpacingType === 'Multiple') {\n                if (lineSpacing > maxHeight) {\n                    bottomMargin += lineSpacing - maxHeight;\n                }\n                else {\n                    topMargin += lineSpacing - maxHeight;\n                }\n            }\n            else if (lineSpacingType === 'Exactly') {\n                topMargin += lineSpacing - (topMargin + size.Height + bottomMargin);\n            }\n            else if (lineSpacing > topMargin + size.Height + bottomMargin) {\n                topMargin += lineSpacing - (topMargin + size.Height + bottomMargin);\n            }\n            topMargin += beforeSpacing;\n            bottomMargin += paragraph.paragraphFormat.afterSpacing;\n        }\n        return { 'width': size.Width, 'height': size.Height, 'topMargin': topMargin, 'bottomMargin': bottomMargin };\n    };\n    /**\n     * @private\n     */\n    Selection.prototype.getPhysicalPositionInternal = function (line, offset, moveNextLine) {\n        if (line.paragraph.isEmpty()) {\n            var paragraphWidget = line.paragraph;\n            var left = paragraphWidget.x;\n            if (paragraphWidget.childWidgets.length > 0) {\n                var lineWidget = paragraphWidget.childWidgets[0];\n                left = this.getLeft(lineWidget);\n            }\n            var topMargin = 0;\n            var bottomMargin = 0;\n            var size = this.getParagraphMarkSize(line.paragraph, topMargin, bottomMargin);\n            if (offset > 0) {\n                left += size.width;\n            }\n            return new Point(left, paragraphWidget.y + topMargin);\n        }\n        else {\n            var indexInInline = 0;\n            var inlineObj = line.getInline(offset, indexInInline);\n            var inline = inlineObj.element; //return indexInInline must\n            indexInInline = inlineObj.index;\n            // tslint:disable-next-line:max-line-length\n            // if (inline.length === indexInInline && !isNullOrUndefined(inline.nextNode) && this.viewer.renderedElements.containsKey(inline) &&\n            //     this.viewer.renderedElements.get(inline).length > 0 && this.viewer.renderedElements.containsKey(inline.nextNode as WInline)\n            //     && this.viewer.renderedElements.get(inline.nextNode as WInline).length > 0 &&\n            // tslint:disable-next-line:max-line-length\n            //     (this.viewer.renderedElements.get(inline)[this.viewer.renderedElements.get(inline).length - 1] as ElementBox).line !== (this.viewer.renderedElements.get(inline.nextNode as WInline)[0] as ElementBox).line) {\n            //     //Handled specifically to move the cursor at start of next line.\n            //     inline = inline.nextNode as WInline;\n            //     indexInInline = 0;\n            // }\n            return this.getPhysicalPositionInline(inline, indexInInline, moveNextLine);\n        }\n    };\n    /**\n     * Highlight selected content\n     * @private\n     */\n    Selection.prototype.highlightSelectedContent = function (start, end) {\n        if (start.paragraph.isInsideTable && (!end.paragraph.isInsideTable\n            || (!start.paragraph.associatedCell.equals(end.paragraph.associatedCell))\n            || this.isCellSelected(start.paragraph.associatedCell, start, end))) {\n            this.highlightCell(start.paragraph.associatedCell, this, start, end);\n        }\n        else {\n            var inline = undefined;\n            var index = 0;\n            if (!this.owner.isReadOnlyMode && start.paragraph === end.paragraph) {\n                if (start.offset + 1 === end.offset) {\n                    var inlineObj = end.currentWidget.getInline(end.offset, index);\n                    inline = inlineObj.element; // return index value\n                    index = inlineObj.index;\n                    if (inline instanceof ImageElementBox) {\n                        var startOffset = start.currentWidget.getOffset(inline, 0);\n                        if (startOffset !== start.offset) {\n                            inline = undefined;\n                        }\n                    }\n                }\n                else {\n                    var indexInInline = 0;\n                    var startInlineObj = start.currentWidget.getInline(start.offset, indexInInline);\n                    var startInline = startInlineObj.element; //return indexInInline\n                    indexInInline = startInlineObj.index;\n                    if (indexInInline === startInline.length) {\n                        startInline = this.getNextRenderedElementBox(startInline, indexInInline);\n                    }\n                    var endInlineObj = end.currentWidget.getInline(end.offset, indexInInline);\n                    var endInline = endInlineObj.element; //return indexInInline\n                    indexInInline = endInlineObj.index;\n                    // tslint:disable-next-line:max-line-length\n                    if (startInline instanceof FieldElementBox && endInline instanceof FieldElementBox && !isNullOrUndefined(startInline.fieldSeparator)) {\n                        var fieldValue = startInline.fieldSeparator.nextNode;\n                        if (fieldValue instanceof ImageElementBox && fieldValue.nextNode === endInline) {\n                            inline = fieldValue;\n                        }\n                    }\n                }\n            }\n            if (!this.owner.isReadOnlyMode && inline instanceof ImageElementBox && this.owner.isDocumentLoaded) {\n                var elementBoxObj = this.getElementBoxInternal(inline, index);\n                var elementBox = elementBoxObj.element; //return index \n                index = elementBoxObj.index;\n                if (this.owner.enableImageResizerMode) {\n                    this.owner.imageResizerModule.positionImageResizer(elementBox);\n                    this.owner.imageResizerModule.showImageResizer();\n                }\n                if (this.viewer.isTouchInput) {\n                    this.viewer.touchStart.style.display = 'none';\n                    this.viewer.touchEnd.style.display = 'none';\n                }\n            }\n            else {\n                this.highlight(start.paragraph, start, end);\n            }\n        }\n    };\n    /**\n     * @private\n     */\n    Selection.prototype.highlight = function (paragraph, start, end) {\n        var selectionStartIndex = 0;\n        var selectionEndIndex = 0;\n        var startElement = undefined;\n        var endElement = undefined;\n        var startLineWidget = undefined;\n        var endLineWidget = undefined;\n        //return start Element and selection start index\n        var startLineObj = this.getStartLineWidget(paragraph, start, startElement, selectionStartIndex);\n        startElement = startLineObj.element;\n        if (isNullOrUndefined(startElement)) {\n            startLineWidget = paragraph.childWidgets[0];\n        }\n        else {\n            startLineWidget = startElement.line;\n        }\n        selectionStartIndex = startLineObj.index;\n        var endLineObj = this.getEndLineWidget(end, endElement, selectionEndIndex);\n        endElement = endLineObj.element;\n        if (endElement) {\n            endLineWidget = endElement.line;\n        }\n        else {\n            endLineWidget = end.paragraph.childWidgets[end.paragraph.childWidgets.length - 1];\n        }\n        selectionEndIndex = endLineObj.index;\n        var top = 0;\n        var left = 0;\n        if (!isNullOrUndefined(startLineWidget)) {\n            top = this.getTop(startLineWidget);\n            left = this.getLeftInternal(startLineWidget, startElement, selectionStartIndex);\n        }\n        if (!isNullOrUndefined(startLineWidget) && startLineWidget === endLineWidget) {\n            //Selection ends in current line.\n            var right = this.getLeftInternal(endLineWidget, endElement, selectionEndIndex);\n            this.createHighlightBorder(startLineWidget, right - left, left, top);\n        }\n        else {\n            if (!isNullOrUndefined(startLineWidget)) {\n                var x = startLineWidget.paragraph.x;\n                this.createHighlightBorder(startLineWidget, this.getWidth(startLineWidget, true) - (left - x), left, top);\n                var lineIndex = startLineWidget.paragraph.childWidgets.indexOf(startLineWidget);\n                //Iterates to last item of paragraph or selection end.                                             \n                this.highlightParagraph(paragraph, lineIndex + 1, endLineWidget, endElement, selectionEndIndex);\n                if (paragraph.childWidgets.indexOf(end.currentWidget) !== -1) {\n                    return;\n                }\n            }\n            this.highlightNextBlock(paragraph, start, end);\n        }\n    };\n    Selection.prototype.highlightNextBlock = function (paragraph, start, end) {\n        var block = paragraph.nextRenderedWidget;\n        if (!isNullOrUndefined(block)) {\n            if (block instanceof ParagraphWidget) {\n                this.highlight(block, start, end);\n            }\n            else {\n                this.highlightTable(block, start, end);\n            }\n        }\n    };\n    /**\n     * Get start line widget\n     * @private\n     */\n    // tslint:disable-next-line:max-line-length\n    Selection.prototype.getStartLineWidget = function (paragraph, start, startElement, selectionStartIndex) {\n        var offset = paragraph === start.paragraph ? start.offset : this.getStartOffset(paragraph);\n        var startInlineObj = undefined;\n        if (paragraph === start.paragraph) {\n            startInlineObj = start.currentWidget.getInline(offset, selectionStartIndex);\n        }\n        else {\n            startInlineObj = paragraph.firstChild.getInline(offset, selectionStartIndex);\n        }\n        startElement = startInlineObj.element; //return selectionStartIndex\n        selectionStartIndex = startInlineObj.index;\n        if (startElement instanceof FieldElementBox) {\n            var inlineInfo = this.getRenderedInline(startElement, selectionStartIndex);\n            startElement = inlineInfo.element;\n            selectionStartIndex = inlineInfo.index;\n        }\n        if (offset === this.getParagraphLength(start.paragraph) + 1) {\n            selectionStartIndex++;\n        }\n        return {\n            'index': selectionStartIndex, 'element': startElement\n        };\n    };\n    /**\n     * Get end line widget\n     * @private\n     */\n    Selection.prototype.getEndLineWidget = function (end, endElement, selectionEndIndex) {\n        var endInlineObj = end.currentWidget.getInline(end.offset, selectionEndIndex);\n        endElement = endInlineObj.element; //return selection end index\n        selectionEndIndex = endInlineObj.index;\n        if (endElement instanceof FieldElementBox) {\n            var inlineInfo = this.getRenderedInline(endElement, selectionEndIndex);\n            endElement = inlineInfo.element;\n            selectionEndIndex = inlineInfo.index;\n        }\n        var lineIndex = end.paragraph.childWidgets.indexOf(end.currentWidget);\n        if (lineIndex === end.paragraph.childWidgets.length - 1 && end.offset === this.getLineLength(end.currentWidget) + 1) {\n            selectionEndIndex = endElement ? endElement.length + 1 : 1;\n        }\n        return { 'index': selectionEndIndex, 'element': endElement };\n    };\n    /**\n     * Get line widget\n     * @private\n     */\n    Selection.prototype.getLineWidgetInternal = function (line, offset, moveToNextLine) {\n        var lineWidget = undefined;\n        if (line.children.length === 0 && line instanceof LineWidget) {\n            lineWidget = line;\n        }\n        else {\n            var indexInInline = 0;\n            var inlineInfo = line.getInline(offset, indexInInline);\n            var inline = inlineInfo.element;\n            indexInInline = inlineInfo.index;\n            lineWidget = inline instanceof ElementBox ? inline.line\n                : this.getLineWidgetInternalInline(inline, indexInInline, moveToNextLine);\n        }\n        return lineWidget;\n    };\n    /**\n     * Get last line widget\n     * @private\n     */\n    Selection.prototype.getLineWidgetParagraph = function (offset, line) {\n        var linewidget = undefined;\n        if (line.children.length === 0) {\n            linewidget = line;\n        }\n        else {\n            var indexInInline = 0;\n            var inlineInfo = line.getInline(offset, indexInInline);\n            var inline = inlineInfo.element;\n            indexInInline = inlineInfo.index;\n            linewidget = this.getLineWidget(inline, indexInInline);\n        }\n        return linewidget;\n    };\n    /**\n     * Highlight selected cell\n     * @private\n     */\n    /* tslint:disable */\n    // tslint:disable-next-line:max-line-length    \n    Selection.prototype.highlightCells = function (table, startCell, endCell) {\n        var start = this.getCellLeft(startCell.ownerRow, startCell);\n        var end = start + startCell.cellFormat.cellWidth;\n        var endCellLeft = this.getCellLeft(endCell.ownerRow, endCell);\n        var endCellRight = endCellLeft + endCell.cellFormat.cellWidth;\n        if (start > endCellLeft) {\n            start = endCellLeft;\n        }\n        if (end < endCellRight) {\n            end = endCellRight;\n        }\n        if (start > this.upDownSelectionLength) {\n            start = this.upDownSelectionLength;\n        }\n        if (end < this.upDownSelectionLength) {\n            end = this.upDownSelectionLength;\n        }\n        var tableWidgetCollection = table.getSplitWidgets();\n        var startTableIndex = tableWidgetCollection.indexOf(startCell.ownerRow.ownerTable);\n        var endTableIndex = tableWidgetCollection.indexOf(endCell.ownerRow.ownerTable);\n        if (startTableIndex === endTableIndex) {\n            var count = table.childWidgets.indexOf(endCell.ownerRow);\n            for (var i = table.childWidgets.indexOf(startCell.ownerRow); i <= count; i++) {\n                this.highlightRow(table.childWidgets[i], start, end);\n            }\n        }\n        else {\n            var startRowIndex = 0;\n            var endRowIndex = 0;\n            for (var i = startTableIndex; i <= endTableIndex; i++) {\n                table = tableWidgetCollection[i];\n                if (i === startTableIndex) {\n                    startRowIndex = table.childWidgets.indexOf(startCell.ownerRow);\n                }\n                else {\n                    startRowIndex = 0;\n                }\n                if (i === endTableIndex) {\n                    endRowIndex = table.childWidgets.indexOf(endCell.ownerRow);\n                }\n                else {\n                    endRowIndex = table.childWidgets.length - 1;\n                }\n                for (var j = startRowIndex; j <= endRowIndex; j++) {\n                    this.highlightRow(table.childWidgets[j], start, end);\n                }\n            }\n        }\n    };\n    /* tslint:enable */\n    /**\n     * highlight selected table\n     * @private\n     */\n    Selection.prototype.highlightTable = function (table, start, end) {\n        this.highlightInternal(table.childWidgets[0], start, end);\n        if (!end.paragraph.isInsideTable //Selection end is outside the table cell.\n            || !table.contains(end.paragraph.associatedCell)) {\n            this.highlightNextBlock(table, start, end);\n        }\n    };\n    /**\n     * Get cell left\n     * @private\n     */\n    Selection.prototype.getCellLeft = function (row, cell) {\n        var left = 0;\n        left += cell.x - cell.margin.left;\n        return left;\n    };\n    /**\n     * Get next paragraph for row\n     * @private\n     */\n    Selection.prototype.getNextParagraphRow = function (row) {\n        if (!isNullOrUndefined(row.nextRenderedWidget)) {\n            var cell = row.nextRenderedWidget.childWidgets[0];\n            var block = cell.childWidgets[0];\n            return this.getFirstParagraphBlock(block);\n        }\n        return this.getNextParagraphBlock(row.ownerTable);\n    };\n    /**\n     * Get previous paragraph from row\n     * @private\n     */\n    Selection.prototype.getPreviousParagraphRow = function (row) {\n        if (!isNullOrUndefined(row.previousRenderedWidget)) {\n            // tslint:disable-next-line:max-line-length\n            var cell = row.previousRenderedWidget.lastChild;\n            var block = cell.lastChild ? cell.lastChild : (cell.previousSplitWidget).lastChild;\n            return this.getLastParagraphBlock(block);\n        }\n        return this.getPreviousParagraphBlock(row.ownerTable);\n    };\n    /**\n     * Return true if row contain cell\n     * @private\n     */\n    Selection.prototype.containsRow = function (row, tableCell) {\n        if (row.childWidgets.indexOf(tableCell) !== -1) {\n            return true;\n        }\n        while (tableCell.ownerTable.isInsideTable) {\n            if (row.childWidgets.indexOf(tableCell) !== -1) {\n                return true;\n            }\n            tableCell = tableCell.ownerTable.associatedCell;\n        }\n        return row.childWidgets.indexOf(tableCell) !== -1;\n    };\n    /**\n     * Highlight selected row\n     * @private\n     */\n    Selection.prototype.highlightRow = function (row, start, end) {\n        for (var i = 0; i < row.childWidgets.length; i++) {\n            var left = this.getCellLeft(row, row.childWidgets[i]);\n            if (HelperMethods.round(start, 2) <= HelperMethods.round(left, 2) &&\n                HelperMethods.round(left, 2) < HelperMethods.round(end, 2)) {\n                this.highlightCellWidget(row.childWidgets[i]);\n            }\n        }\n    };\n    /**\n     * @private\n     */\n    // tslint:disable-next-line:max-line-length\n    Selection.prototype.highlightInternal = function (row, start, end) {\n        for (var i = 0; i < row.childWidgets.length; i++) {\n            this.highlightCellWidget(row.childWidgets[i]);\n        }\n        if (end.paragraph.isInsideTable && this.containsRow(row, end.paragraph.associatedCell)) {\n            return;\n        }\n        else if (row.nextRenderedWidget instanceof TableRowWidget) {\n            this.highlightInternal(row.nextRenderedWidget, start, end);\n        }\n    };\n    /**\n     * Get last paragraph in cell\n     * @private\n     */\n    Selection.prototype.getLastParagraph = function (cell) {\n        while (cell.nextSplitWidget) {\n            if (cell.nextSplitWidget.childWidgets.length > 0) {\n                cell = cell.nextSplitWidget;\n            }\n            else {\n                break;\n            }\n        }\n        var lastBlock;\n        if (cell.childWidgets.length > 0) {\n            lastBlock = cell.lastChild;\n        }\n        else {\n            lastBlock = cell.previousSplitWidget.lastChild;\n        }\n        return this.getLastParagraphBlock(lastBlock);\n    };\n    /**\n     * Return true is source cell contain cell\n     * @private\n     */\n    Selection.prototype.containsCell = function (sourceCell, cell) {\n        if (sourceCell.equals(cell)) {\n            return true;\n        }\n        while (cell.ownerTable.isInsideTable) {\n            if (sourceCell.equals(cell.ownerTable.associatedCell)) {\n                return true;\n            }\n            cell = cell.ownerTable.associatedCell;\n        }\n        return false;\n    };\n    /**\n     * Return true if cell is selected\n     * @private\n     */\n    Selection.prototype.isCellSelected = function (cell, startPosition, endPosition) {\n        var lastParagraph = this.getLastParagraph(cell);\n        // tslint:disable-next-line:max-line-length\n        var isAtCellEnd = lastParagraph === endPosition.paragraph && endPosition.offset === this.getParagraphLength(lastParagraph) + 1;\n        return isAtCellEnd || (!this.containsCell(cell, startPosition.paragraph.associatedCell) ||\n            !this.containsCell(cell, endPosition.paragraph.associatedCell));\n    };\n    /**\n     * Return Container cell\n     * @private\n     */\n    Selection.prototype.getContainerCellOf = function (cell, tableCell) {\n        while (cell.ownerTable.isInsideTable) {\n            if (cell.ownerTable.contains(tableCell)) {\n                return cell;\n            }\n            cell = cell.ownerTable.associatedCell;\n        }\n        return cell;\n    };\n    /**\n     * Get Selected cell\n     * @private\n     */\n    Selection.prototype.getSelectedCell = function (cell, containerCell) {\n        if (cell.ownerTable.equals(containerCell.ownerTable)) {\n            return cell;\n        }\n        while (cell.ownerTable.isInsideTable) {\n            if (cell.ownerTable.associatedCell.equals(containerCell)) {\n                return cell;\n            }\n            cell = cell.ownerTable.associatedCell;\n        }\n        return cell;\n    };\n    /**\n     * @private\n     */\n    Selection.prototype.getSelectedCells = function () {\n        var cells = [];\n        for (var i = 0; i < this.selectedWidgets.keys.length; i++) {\n            var widget = this.selectedWidgets.keys[i];\n            if (widget instanceof TableCellWidget) {\n                cells.push(widget);\n            }\n        }\n        return cells;\n    };\n    /**\n     * Get Next paragraph from cell\n     * @private\n     */\n    Selection.prototype.getNextParagraphCell = function (cell) {\n        if (cell.nextRenderedWidget && cell.nextRenderedWidget instanceof TableCellWidget) {\n            //Return first paragraph in cell.            \n            cell = cell.nextRenderedWidget;\n            var block = cell.firstChild;\n            if (block) {\n                return this.getFirstParagraphBlock(block);\n            }\n            else {\n                return this.getNextParagraphCell(cell);\n            }\n        }\n        return this.getNextParagraphRow(cell.containerWidget);\n    };\n    /**\n     * Get previous paragraph from cell\n     * @private\n     */\n    Selection.prototype.getPreviousParagraphCell = function (cell) {\n        if (!isNullOrUndefined(cell.previousRenderedWidget) && cell.previousRenderedWidget instanceof TableCellWidget) {\n            cell = cell.previousRenderedWidget;\n            var block = cell.lastChild;\n            return this.getLastParagraphBlock(block);\n        }\n        return this.getPreviousParagraphRow(cell.ownerRow);\n    };\n    /**\n     * Get cell's container cell\n     * @private\n     */\n    Selection.prototype.getContainerCell = function (cell) {\n        while (!isNullOrUndefined(cell.ownerTable) && cell.ownerTable.isInsideTable) {\n            cell = cell.ownerTable.associatedCell;\n        }\n        return cell;\n    };\n    /**\n     * Highlight selected cell\n     * @private\n     */\n    /* tslint:disable */\n    Selection.prototype.highlightCell = function (cell, selection, start, end) {\n        if (end.paragraph.isInsideTable) {\n            var containerCell = this.getContainerCellOf(cell, end.paragraph.associatedCell);\n            if (containerCell.ownerTable.contains(end.paragraph.associatedCell)) {\n                var startCell = this.getSelectedCell(cell, containerCell);\n                var endCell = this.getSelectedCell(end.paragraph.associatedCell, containerCell);\n                if (this.containsCell(containerCell, end.paragraph.associatedCell)) {\n                    /* tslint:enable */\n                    //Selection end is in container cell.\n                    if (this.isCellSelected(containerCell, start, end)) {\n                        this.highlightCellWidget(containerCell);\n                    }\n                    else {\n                        if (startCell === containerCell) {\n                            this.highlight(start.paragraph, start, end);\n                        }\n                        else {\n                            this.highlightContainer(startCell, start, end);\n                        }\n                    }\n                }\n                else {\n                    //Selection end is not in container cell.\n                    this.highlightCellWidget(containerCell);\n                    if (containerCell.ownerRow.equals(endCell.ownerRow)) {\n                        //Highlight other selected cells in current row.\n                        startCell = containerCell;\n                        while (!isNullOrUndefined(startCell.nextRenderedWidget)) {\n                            startCell = startCell.nextRenderedWidget;\n                            this.highlightCellWidget(startCell);\n                            if (startCell === endCell) {\n                                break;\n                            }\n                        }\n                    }\n                    else {\n                        this.highlightCells(containerCell.ownerTable, containerCell, endCell);\n                    }\n                }\n            }\n            else {\n                this.highlightContainer(containerCell, start, end);\n            }\n        }\n        else {\n            var cell1 = this.getContainerCell(cell);\n            this.highlightContainer(cell1, start, end);\n        }\n    };\n    /**\n     * @private\n     */\n    Selection.prototype.highlightContainer = function (cell, start, end) {\n        this.highlightInternal(cell.containerWidget, start, end);\n        this.highlightNextBlock(cell.ownerTable, start, end);\n    };\n    /**\n     * Get previous valid element\n     * @private\n     */\n    Selection.prototype.getPreviousValidElement = function (inline) {\n        var previousValidInline = undefined;\n        while (inline instanceof FieldElementBox) {\n            if (HelperMethods.isLinkedFieldCharacter(inline)) {\n                if (inline instanceof FieldElementBox && inline.fieldType === 0) {\n                    previousValidInline = inline;\n                }\n                else if (inline instanceof FieldElementBox && inline.fieldType === 1) {\n                    previousValidInline = inline;\n                    if (isNullOrUndefined(inline.fieldSeparator)) {\n                        inline = inline.fieldBegin;\n                        previousValidInline = inline;\n                    }\n                }\n                else {\n                    inline = inline.fieldBegin;\n                    previousValidInline = inline;\n                }\n            }\n            inline = inline.previousNode;\n        }\n        return isNullOrUndefined(previousValidInline) ? inline : previousValidInline;\n    };\n    /**\n     * Get next valid element\n     * @private\n     */\n    Selection.prototype.getNextValidElement = function (inline) {\n        var nextValidInline = undefined;\n        while (inline instanceof FieldElementBox) {\n            if (inline.fieldType === 0 && !isNullOrUndefined(inline.fieldEnd)) {\n                return isNullOrUndefined(nextValidInline) ? inline : nextValidInline;\n            }\n            else if (inline.fieldType === 1 && !isNullOrUndefined(inline.fieldBegin)) {\n                nextValidInline = inline;\n            }\n            inline = inline.nextNode;\n        }\n        return (isNullOrUndefined(nextValidInline) ? inline : nextValidInline);\n    };\n    /**\n     * Return next valid inline with index\n     * @private\n     */\n    Selection.prototype.validateTextPosition = function (inline, index) {\n        if (inline.length === index && inline.nextNode instanceof FieldElementBox) {\n            //If inline is last item within field, then set field end as text position.\n            var nextInline = this.getNextValidElement(inline.nextNode);\n            if (nextInline instanceof FieldElementBox && nextInline.fieldType === 1) {\n                inline = nextInline;\n                index = 1;\n            }\n        }\n        else if (index === 0 && inline.previousNode instanceof FieldElementBox) {\n            var prevInline = this.getPreviousValidElement(inline.previousNode);\n            inline = prevInline;\n            index = inline instanceof FieldElementBox ? 0 : inline.length;\n            if (inline instanceof FieldElementBox && inline.fieldType === 1) {\n                index++;\n            }\n        }\n        return { 'element': inline, 'index': index };\n    };\n    /**\n     * Get inline physical location\n     * @private\n     */\n    Selection.prototype.getPhysicalPositionInline = function (inline, index, moveNextLine) {\n        var element = undefined;\n        element = this.getElementBox(inline, index, moveNextLine).element;\n        var lineWidget = undefined;\n        if (isNullOrUndefined(element) || isNullOrUndefined(element.line)) {\n            if (inline instanceof FieldElementBox || inline instanceof BookmarkElementBox) {\n                return this.getFieldCharacterPosition(inline);\n            }\n            return new Point(0, 0);\n        }\n        var margin = element.margin;\n        var top = 0;\n        var left = 0;\n        if (element instanceof TextElementBox && element.text === '\\v' && isNullOrUndefined(inline.nextNode)) {\n            lineWidget = this.getNextLineWidget(element.line.paragraph, element);\n            index = 0;\n        }\n        else {\n            lineWidget = element.line;\n        }\n        top = this.getTop(lineWidget);\n        if (element instanceof ImageElementBox) {\n            var format = element.line.paragraph.characterFormat;\n            var previousInline = this.getPreviousTextElement(inline);\n            if (!isNullOrUndefined(previousInline)) {\n                format = previousInline.characterFormat;\n            }\n            else {\n                var nextInline = this.getNextTextElement(inline);\n                if (!isNullOrUndefined(nextInline)) {\n                    format = nextInline.characterFormat;\n                }\n            }\n            var measureObj = this.viewer.textHelper.getHeight(format);\n            if (element.margin.top + element.height - measureObj.BaselineOffset > 0) {\n                top += element.margin.top + element.height - measureObj.BaselineOffset;\n            }\n        }\n        else if (!(element instanceof FieldElementBox)) {\n            top += margin.top > 0 ? margin.top : 0;\n        }\n        left = (isNullOrUndefined(element) || isNullOrUndefined(lineWidget)) ? 0 : this.getLeftInternal(lineWidget, element, index);\n        return new Point(left, top);\n    };\n    /**\n     * Get field character position\n     * @private\n     */\n    Selection.prototype.getFieldCharacterPosition = function (firstInline) {\n        var nextValidInline = this.getNextValidElementForField(firstInline);\n        //If field separator/end exists at end of paragraph, then move to next paragraph.\n        if (isNullOrUndefined(nextValidInline)) {\n            var nextParagraph = firstInline.line.paragraph;\n            return this.getEndPosition(nextParagraph);\n        }\n        else {\n            return this.getPhysicalPositionInline(nextValidInline, 0, true);\n        }\n    };\n    /**\n     * @private\n     */\n    Selection.prototype.getNextValidElementForField = function (firstInline) {\n        if (firstInline instanceof FieldElementBox && firstInline.fieldType === 0\n            && HelperMethods.isLinkedFieldCharacter(firstInline)) {\n            var fieldBegin = firstInline;\n            if (isNullOrUndefined(fieldBegin.fieldSeparator)) {\n                firstInline = fieldBegin.fieldEnd;\n            }\n            else {\n                firstInline = fieldBegin.fieldSeparator;\n            }\n        }\n        var nextValidInline = undefined;\n        if (!isNullOrUndefined(firstInline.nextNode)) {\n            nextValidInline = this.getNextValidElement(firstInline.nextNode);\n        }\n        return nextValidInline;\n    };\n    /**\n     * Get paragraph end position\n     * @private\n     */\n    Selection.prototype.getEndPosition = function (widget) {\n        var left = widget.x;\n        var top = widget.y;\n        var lineWidget = undefined;\n        if (widget.childWidgets.length > 0) {\n            lineWidget = widget.childWidgets[widget.childWidgets.length - 1];\n            left += this.getWidth(lineWidget, false);\n        }\n        if (!isNullOrUndefined(lineWidget)) {\n            top = this.getTop(lineWidget);\n        }\n        var topMargin = 0;\n        var bottomMargin = 0;\n        var size = this.getParagraphMarkSize(widget, topMargin, bottomMargin);\n        return new Point(left, top + size.topMargin);\n    };\n    /**\n     * Get element box\n     * @private\n     */\n    Selection.prototype.getElementBox = function (currentInline, index, moveToNextLine) {\n        var elementBox = undefined;\n        if (!(currentInline instanceof FieldElementBox || currentInline instanceof BookmarkElementBox)) {\n            elementBox = currentInline;\n        }\n        return { 'element': elementBox, 'index': index };\n    };\n    /**\n     * @private\n     */\n    Selection.prototype.getPreviousTextElement = function (inline) {\n        if (inline.previousNode instanceof TextElementBox) {\n            return inline.previousNode;\n        }\n        if (!isNullOrUndefined(inline.previousNode)) {\n            return this.getPreviousTextElement(inline.previousNode);\n        }\n        return undefined;\n    };\n    /**\n     * Get next text inline\n     * @private\n     */\n    Selection.prototype.getNextTextElement = function (inline) {\n        if (inline.nextNode instanceof TextElementBox) {\n            return inline.nextNode;\n        }\n        if (!isNullOrUndefined(inline.nextNode)) {\n            return this.getNextTextElement(inline.nextNode);\n        }\n        return undefined;\n    };\n    /**\n     * @private\n     */\n    Selection.prototype.getNextRenderedElementBox = function (inline, indexInInline) {\n        if (inline instanceof FieldElementBox) {\n            var fieldBegin = inline;\n            if (fieldBegin.fieldType === 0) {\n                inline = this.getRenderedField(fieldBegin);\n                if (fieldBegin === inline) {\n                    return fieldBegin;\n                }\n            }\n            indexInInline = 1;\n        }\n        while (!isNullOrUndefined(inline) && indexInInline === inline.length && inline.nextNode instanceof FieldElementBox) {\n            var nextValidInline = this.getNextValidElement((inline.nextNode));\n            if (nextValidInline instanceof FieldElementBox && nextValidInline.fieldType === 0) {\n                var fieldBegin = nextValidInline;\n                inline = this.getRenderedField(fieldBegin);\n                if (!isNullOrUndefined(inline) && fieldBegin === inline) {\n                    return fieldBegin;\n                }\n                indexInInline = 1;\n            }\n            else {\n                inline = nextValidInline;\n            }\n        }\n        return inline;\n    };\n    /**\n     * @private\n     */\n    Selection.prototype.getElementBoxInternal = function (inline, index) {\n        var element = undefined;\n        element = inline;\n        return {\n            'element': element, 'index': index\n        };\n    };\n    /**\n     * Get Line widget\n     * @private\n     */\n    Selection.prototype.getLineWidget = function (inline, index) {\n        return this.getLineWidgetInternalInline(inline, index, true);\n    };\n    /**\n     * @private\n     */\n    Selection.prototype.getLineWidgetInternalInline = function (inline, index, moveToNextLine) {\n        var elementObj = this.getElementBox(inline, index, moveToNextLine);\n        var element = elementObj.element; //return index\n        index = elementObj.index;\n        if (!isNullOrUndefined(element)) {\n            if (moveToNextLine && element instanceof TextElementBox && element.text === '\\v' && index === 1) {\n                return this.getNextLineWidget(element.line.paragraph, element);\n            }\n            else {\n                return element.line;\n            }\n        }\n        var startInline = inline;\n        //ToDo: Check previous inline here.\n        var nextValidInline = this.getNextValidElementForField(startInline);\n        //If field separator/end exists at end of paragraph, then move to next paragraph.\n        if (isNullOrUndefined(nextValidInline)) {\n            var lineWidget = undefined;\n            var widget = startInline.line.paragraph;\n            if (widget.childWidgets.length > 0) {\n                lineWidget = widget.childWidgets[widget.childWidgets.length - 1];\n            }\n            return lineWidget;\n        }\n        else {\n            return this.getLineWidget(nextValidInline, 0);\n        }\n    };\n    /**\n     * Get next line widget\n     * @private\n     */\n    Selection.prototype.getNextLineWidget = function (paragraph, element) {\n        var lineWidget = undefined;\n        var widget = paragraph;\n        if (widget.childWidgets.length > 0) {\n            var widgetIndex = widget.childWidgets.indexOf(element.line);\n            if (widgetIndex === widget.childWidgets.length - 1) {\n                widget = paragraph;\n                // widget = paragraph.leafWidgets[paragraph.leafWidgets.length - 1];\n                widgetIndex = -1;\n            }\n            else if (widgetIndex > widget.childWidgets.length - 1) {\n                widget = this.getNextParagraphBlock(paragraph);\n                widgetIndex = -1;\n            }\n            else if (widgetIndex < 0) {\n                // widget = paragraph.leafWidgets[paragraph.leafWidgets.length - 1];\n                widget = paragraph;\n                widgetIndex = widget.childWidgets.indexOf(element.line);\n            }\n            lineWidget = widget.childWidgets[widgetIndex + 1];\n        }\n        return lineWidget;\n    };\n    /**\n     * Get Caret height\n     * @private\n     */\n    // tslint:disable-next-line:max-line-length\n    Selection.prototype.getCaretHeight = function (inline, index, format, isEmptySelection, topMargin, isItalic) {\n        var elementBoxInfo = this.getElementBox(inline, index, false);\n        var element = elementBoxInfo.element;\n        var currentInline = inline;\n        if (isNullOrUndefined(element)) {\n            if (currentInline instanceof FieldElementBox) {\n                return this.getFieldCharacterHeight(currentInline, format, isEmptySelection, topMargin, isItalic);\n            }\n            return { 'height': this.viewer.textHelper.getHeight(format).Height, 'topMargin': topMargin, 'isItalic': isItalic };\n        }\n        var margin = element.margin;\n        var heightElement = element.height;\n        var maxLineHeight = 0;\n        if (element instanceof ImageElementBox) {\n            var previousInline = this.getPreviousTextElement(inline);\n            var nextInline = this.getNextTextElement(inline);\n            if (isNullOrUndefined(previousInline) && isNullOrUndefined(nextInline)) {\n                var top_2 = 0;\n                var bottom = 0;\n                var paragarph = inline.line.paragraph;\n                var sizeInfo = this.getParagraphMarkSize(paragarph, top_2, bottom);\n                top_2 = sizeInfo.topMargin;\n                bottom = sizeInfo.bottomMargin;\n                maxLineHeight = sizeInfo.height;\n                isItalic = paragarph.characterFormat.italic;\n                if (!isEmptySelection) {\n                    maxLineHeight += paragarph.paragraphFormat.afterSpacing;\n                }\n            }\n            else if (isNullOrUndefined(previousInline)) {\n                isItalic = nextInline.characterFormat.italic;\n                return this.getCaretHeight(nextInline, 0, nextInline.characterFormat, isEmptySelection, topMargin, isItalic);\n            }\n            else {\n                if (!isNullOrUndefined(nextInline) && element instanceof ImageElementBox) {\n                    //Calculates the caret size using image character format.\n                    var textSizeInfo = this.viewer.textHelper.getHeight(element.characterFormat);\n                    var charHeight = textSizeInfo.Height;\n                    var baselineOffset = textSizeInfo.BaselineOffset;\n                    // tslint:disable-next-line:max-line-length\n                    maxLineHeight = (element.margin.top < 0 && baselineOffset > element.margin.top + element.height) ? element.margin.top + element.height + charHeight - baselineOffset : charHeight;\n                    if (!isEmptySelection) {\n                        maxLineHeight += element.margin.bottom;\n                    }\n                }\n                else {\n                    isItalic = previousInline.characterFormat.italic;\n                    // tslint:disable-next-line:max-line-length\n                    return this.getCaretHeight(previousInline, previousInline.length, previousInline.characterFormat, isEmptySelection, topMargin, isItalic);\n                }\n            }\n        }\n        else {\n            var baselineAlignment = format.baselineAlignment;\n            var elementHeight = heightElement;\n            if (baselineAlignment !== 'Normal' && isEmptySelection) {\n                //Set the caret height as sub/super script text height and updates the top margin for sub script text.\n                elementHeight = elementHeight / 1.5;\n                if (baselineAlignment === 'Subscript') {\n                    topMargin = heightElement - elementHeight;\n                }\n            }\n            maxLineHeight = (margin.top < 0 ? margin.top : 0) + elementHeight;\n            if (!isEmptySelection) {\n                maxLineHeight += margin.bottom;\n            }\n        }\n        if (!isEmptySelection) {\n            return { 'height': maxLineHeight, 'topMargin': topMargin, 'isItalic': isItalic };\n        }\n        var height = this.viewer.textHelper.getHeight(format).Height;\n        if (height > maxLineHeight) {\n            height = maxLineHeight;\n        }\n        return { 'height': height, 'topMargin': topMargin, 'isItalic': isItalic };\n    };\n    /**\n     * Get field characters height\n     * @private\n     */\n    // tslint:disable-next-line:max-line-length\n    Selection.prototype.getFieldCharacterHeight = function (startInline, format, isEmptySelection, topMargin, isItalic) {\n        var nextValidInline = this.getNextValidElementForField(startInline);\n        //If field separator/end exists at end of paragraph, then move to next paragraph.\n        if (isNullOrUndefined(nextValidInline)) {\n            var nextParagraph = startInline.line.paragraph;\n            var height = this.viewer.textHelper.getParagraphMarkSize(format).Height;\n            var top_3 = 0;\n            var bottom = 0;\n            var sizeInfo = this.getParagraphMarkSize(nextParagraph, top_3, bottom);\n            var maxLineHeight = sizeInfo.height;\n            top_3 = sizeInfo.topMargin;\n            bottom = sizeInfo.bottomMargin;\n            if (!isEmptySelection) {\n                maxLineHeight += bottom;\n                return { 'height': maxLineHeight, 'topMargin': topMargin, 'isItalic': isItalic };\n            }\n            if (height > maxLineHeight) {\n                height = maxLineHeight;\n            }\n            return { 'height': height, 'topMargin': topMargin, 'isItalic': isItalic };\n        }\n        else {\n            return this.getCaretHeight(nextValidInline, 0, format, isEmptySelection, topMargin, isItalic);\n        }\n    };\n    /**\n     * Get rendered inline\n     * @private\n     */\n    //FieldCharacter\n    Selection.prototype.getRenderedInline = function (inline, inlineIndex) {\n        var prevInline = this.getPreviousValidElement(inline);\n        while (prevInline instanceof FieldElementBox) {\n            prevInline = this.getPreviousTextElement(prevInline);\n            if (prevInline instanceof FieldElementBox) {\n                prevInline = prevInline.previousNode;\n            }\n        }\n        if (!isNullOrUndefined(prevInline)) {\n            inlineIndex = prevInline.length;\n            return { 'element': prevInline, 'index': inlineIndex };\n        }\n        inlineIndex = 0;\n        var nextInline = this.getNextRenderedElementBox(inline, 0);\n        if (nextInline instanceof FieldElementBox && nextInline.fieldType === 0) {\n            nextInline = nextInline.fieldSeparator;\n            nextInline = nextInline.nextNode;\n            while (nextInline instanceof FieldElementBox) {\n                if (nextInline instanceof FieldElementBox && nextInline.fieldType === 0\n                    && HelperMethods.isLinkedFieldCharacter(nextInline)) {\n                    if (isNullOrUndefined(nextInline.fieldSeparator)) {\n                        nextInline = nextInline.fieldEnd;\n                    }\n                    else {\n                        nextInline = nextInline.fieldSeparator;\n                    }\n                }\n                nextInline = nextInline.nextNode;\n            }\n        }\n        return { 'element': nextInline, 'index': inlineIndex };\n    };\n    //Field Begin\n    /**\n     * Get rendered field\n     * @private\n     */\n    Selection.prototype.getRenderedField = function (fieldBegin) {\n        var inline = fieldBegin;\n        if (isNullOrUndefined(fieldBegin.fieldSeparator)) {\n            inline = fieldBegin.fieldEnd;\n        }\n        else {\n            inline = fieldBegin.fieldSeparator;\n            var paragraph = inline.line.paragraph;\n            if (paragraph === fieldBegin.fieldEnd.line.paragraph\n                && !this.hasValidInline(paragraph, inline, fieldBegin.fieldEnd)) {\n                inline = fieldBegin.fieldEnd;\n            }\n            else {\n                return inline;\n            }\n        }\n        return inline;\n    };\n    /**\n     * Return true is inline is tha last inline\n     * @private\n     */\n    Selection.prototype.isLastRenderedInline = function (inline, index) {\n        while (index === inline.length && inline.nextNode instanceof FieldElementBox) {\n            var nextValidInline = this.getNextValidElement(inline.nextNode);\n            index = 0;\n            if (nextValidInline instanceof FieldElementBox && nextValidInline.fieldType === 0) {\n                inline = nextValidInline;\n            }\n            if (inline instanceof FieldElementBox && inline.fieldType === 0 && !isNullOrUndefined(inline.fieldEnd)) {\n                var fieldBegin = inline;\n                if (isNullOrUndefined(fieldBegin.fieldSeparator)) {\n                    inline = fieldBegin.fieldEnd;\n                    index = 1;\n                }\n                else {\n                    inline = fieldBegin.fieldSeparator;\n                    var paragraph = inline.line.paragraph;\n                    index = 1;\n                    if (paragraph === fieldBegin.fieldEnd.line.paragraph\n                        && !this.hasValidInline(paragraph, inline, fieldBegin.fieldEnd)) {\n                        inline = fieldBegin.fieldEnd;\n                    }\n                    else {\n                        break;\n                    }\n                }\n            }\n        }\n        return index === inline.length && isNullOrUndefined(inline.nextNode);\n    };\n    /**\n     * Get page\n     * @private\n     */\n    Selection.prototype.getPage = function (widget) {\n        var page = undefined;\n        if (widget.containerWidget instanceof BlockContainer) {\n            var bodyWidget = widget.containerWidget;\n            page = widget.containerWidget.page;\n        }\n        else if (!isNullOrUndefined(widget.containerWidget)) {\n            page = this.getPage(widget.containerWidget);\n        }\n        return page;\n    };\n    /**\n     * Clear Selection highlight\n     * @private\n     */\n    Selection.prototype.clearSelectionHighlightInSelectedWidgets = function () {\n        var isNonEmptySelection = false;\n        var widgets = this.selectedWidgets.keys;\n        for (var i = 0; i < widgets.length; i++) {\n            this.removeSelectionHighlight(widgets[i]);\n            isNonEmptySelection = true;\n        }\n        this.selectedWidgets.clear();\n        return isNonEmptySelection;\n    };\n    /**\n     * Clear selection highlight\n     * @private\n     */\n    Selection.prototype.clearChildSelectionHighlight = function (widget) {\n        for (var i = 0; i < widget.childWidgets.length; i++) {\n            if (widget.childWidgets[i] instanceof LineWidget) {\n                this.clearSelectionHighlightLineWidget(widget.childWidgets[i]);\n            }\n            else if (widget.childWidgets[i] instanceof TableCellWidget) {\n                this.clearSelectionHighlight(widget.childWidgets[i]);\n            }\n            else if (widget.childWidgets[i] instanceof Widget) {\n                this.clearChildSelectionHighlight(widget.childWidgets[i]);\n            }\n        }\n    };\n    /**\n     * Get line widget from paragraph widget\n     * @private\n     */\n    //Body Widget\n    Selection.prototype.getLineWidgetBodyWidget = function (widget, point) {\n        for (var i = 0; i < widget.childWidgets.length; i++) {\n            var childWidget = widget.childWidgets[i];\n            if (childWidget instanceof Widget && childWidget.y <= point.y\n                && (childWidget.y + childWidget.height) >= point.y) {\n                if (childWidget instanceof ParagraphWidget) {\n                    return this.getLineWidgetParaWidget(childWidget, point);\n                }\n                else {\n                    return this.getLineWidgetTableWidget(childWidget, point);\n                }\n            }\n        }\n        var line = undefined;\n        if (widget.childWidgets.length > 0) {\n            var firstChild = widget.childWidgets[0];\n            if (firstChild instanceof Widget && firstChild.y <= point.y) {\n                if (widget.childWidgets[widget.childWidgets.length - 1] instanceof ParagraphWidget) {\n                    // tslint:disable-next-line:max-line-length\n                    line = this.getLineWidgetParaWidget(widget.childWidgets[widget.childWidgets.length - 1], point);\n                }\n                else {\n                    // tslint:disable-next-line:max-line-length\n                    line = this.getLineWidgetTableWidget(widget.childWidgets[widget.childWidgets.length - 1], point);\n                }\n            }\n            else {\n                var childWidget = undefined;\n                if (firstChild instanceof Widget) {\n                    childWidget = firstChild;\n                }\n                if (!isNullOrUndefined(childWidget)) {\n                    if (childWidget instanceof ParagraphWidget) {\n                        line = this.getLineWidgetParaWidget(firstChild, point);\n                    }\n                    else {\n                        line = this.getLineWidgetTableWidget(firstChild, point);\n                    }\n                }\n            }\n        }\n        return line;\n    };\n    //ParagraphWidget\n    /**\n     * Get line widget from paragraph widget\n     * @private\n     */\n    Selection.prototype.getLineWidgetParaWidget = function (widget, point) {\n        var childWidgets = widget.childWidgets;\n        var top = widget.y;\n        for (var i = 0; i < childWidgets.length; i++) {\n            if (top <= point.y\n                && (top + childWidgets[i].height) >= point.y) {\n                return childWidgets[i];\n            }\n            top += childWidgets[i].height;\n        }\n        var lineWidget = undefined;\n        if (childWidgets.length > 0) {\n            if (widget.y <= point.y) {\n                lineWidget = childWidgets[childWidgets.length - 1];\n            }\n            else {\n                lineWidget = childWidgets[0];\n            }\n        }\n        return lineWidget;\n    };\n    /**\n     * highlight paragraph widget\n     * @private\n     */\n    // tslint:disable-next-line:max-line-length\n    Selection.prototype.highlightParagraph = function (widget, startIndex, endLine, endElement, endIndex) {\n        var top = 0;\n        for (var i = startIndex; i < widget.childWidgets.length; i++) {\n            var line = widget.childWidgets[i];\n            if (i === startIndex) {\n                top = this.getTop(line);\n            }\n            var left = this.getLeft(line);\n            if (line === endLine) {\n                //Selection ends in current line.\n                var right = this.getLeftInternal(endLine, endElement, endIndex);\n                this.createHighlightBorder(line, right - left, left, top);\n                return;\n            }\n            this.createHighlightBorder(line, this.getWidth(line, true) - (left - widget.x), left, top);\n            top += line.height;\n        }\n    };\n    //Table Widget\n    /**\n     * Get line widget form table widget\n     * @private\n     */\n    Selection.prototype.getLineWidgetTableWidget = function (widget, point) {\n        var lineWidget = undefined;\n        for (var i = 0; i < widget.childWidgets.length; i++) {\n            //Removed the height condition check to handle the vertically merged cells.\n            var childWidget = widget.childWidgets[i];\n            if (childWidget instanceof TableRowWidget && childWidget.y <= point.y) {\n                lineWidget = this.getLineWidgetRowWidget(childWidget, point);\n                var cellWidget = undefined;\n                if (!isNullOrUndefined(lineWidget) && lineWidget.paragraph.containerWidget instanceof TableCellWidget) {\n                    cellWidget = lineWidget.paragraph.containerWidget;\n                }\n                var cellSpacing = 0;\n                var rowSpan = 0;\n                if (!isNullOrUndefined(cellWidget)) {\n                    var tableWidget = cellWidget.ownerRow.containerWidget;\n                    cellSpacing = HelperMethods.convertPointToPixel(tableWidget.tableFormat.cellSpacing);\n                    rowSpan = cellWidget.cellFormat.rowSpan;\n                }\n                var leftCellSpacing = 0;\n                var rightCellSpacing = 0;\n                var topCellSpacing = 0;\n                var bottomCellSpacing = 0;\n                if (cellSpacing > 0) {\n                    leftCellSpacing = cellWidget.cellIndex === 0 ? cellSpacing : cellSpacing / 2;\n                    // tslint:disable-next-line:max-line-length\n                    rightCellSpacing = cellWidget.cellIndex === cellWidget.ownerRow.childWidgets.length - 1 ? cellSpacing : cellSpacing / 2;\n                    var rowWidget = undefined;\n                    if (cellWidget.containerWidget instanceof TableRowWidget) {\n                        rowWidget = cellWidget.containerWidget;\n                    }\n                    var tableWidget = undefined;\n                    if (cellWidget.containerWidget.containerWidget instanceof TableWidget) {\n                        tableWidget = cellWidget.containerWidget.containerWidget;\n                    }\n                    if (!isNullOrUndefined(rowWidget) && !isNullOrUndefined(tableWidget)) {\n                        topCellSpacing = cellWidget.ownerRow.rowIndex === 0 ? cellSpacing : cellSpacing / 2;\n                        if (cellWidget.ownerRow.rowIndex + rowSpan === cellWidget.ownerTable.childWidgets.length) {\n                            bottomCellSpacing = cellSpacing;\n                        }\n                        else {\n                            bottomCellSpacing = cellSpacing / 2;\n                        }\n                    }\n                }\n                if ((!isNullOrUndefined(lineWidget) && lineWidget.paragraph.x <= point.x\n                    && lineWidget.paragraph.x + lineWidget.width >= point.x\n                    && lineWidget.paragraph.y <= point.y && this.getTop(lineWidget) + lineWidget.height >= point.y)\n                    || (!isNullOrUndefined(cellWidget) && cellWidget.x - cellWidget.margin.left - leftCellSpacing <= point.x\n                        && cellWidget.x + cellWidget.width + cellWidget.margin.right + rightCellSpacing >= point.x\n                        && cellWidget.y - cellWidget.margin.top - topCellSpacing <= point.y\n                        && cellWidget.y + cellWidget.height + cellWidget.margin.bottom + bottomCellSpacing >= point.y)) {\n                    break;\n                }\n            }\n        }\n        return lineWidget;\n    };\n    //TableRowWidget\n    /**\n     * Get line widget fom row\n     * @private\n     */\n    Selection.prototype.getLineWidgetRowWidget = function (widget, point) {\n        for (var i = 0; i < widget.childWidgets.length; i++) {\n            var cellSpacing = 0;\n            cellSpacing = HelperMethods.convertPointToPixel(widget.ownerTable.tableFormat.cellSpacing);\n            var leftCellSpacing = 0;\n            var rightCellSpacing = 0;\n            if (cellSpacing > 0) {\n                leftCellSpacing = widget.childWidgets[i].columnIndex === 0 ? cellSpacing : cellSpacing / 2;\n                // tslint:disable-next-line:max-line-length\n                rightCellSpacing = widget.childWidgets[i].cellIndex === widget.childWidgets[i].ownerRow.childWidgets.length - 1 ? cellSpacing : cellSpacing / 2;\n            }\n            if (widget.childWidgets[i].x -\n                // tslint:disable-next-line:max-line-length\n                widget.childWidgets[i].margin.left - leftCellSpacing <= point.x && (widget.childWidgets[i].x +\n                // tslint:disable-next-line:max-line-length\n                widget.childWidgets[i].width) + widget.childWidgets[i].margin.right + rightCellSpacing >= point.x) {\n                return this.getLineWidgetCellWidget(widget.childWidgets[i], point);\n            }\n        }\n        var lineWidget = undefined;\n        if (widget.childWidgets.length > 0) {\n            if (widget.childWidgets[0].x <= point.x) {\n                lineWidget = this.getLineWidgetCellWidget(widget.childWidgets[widget.childWidgets.length - 1], point);\n            }\n            else {\n                lineWidget = this.getLineWidgetCellWidget(widget.childWidgets[0], point);\n            }\n        }\n        return lineWidget;\n    };\n    /**\n     * @private\n     */\n    Selection.prototype.getFirstBlock = function (cell) {\n        if (cell.childWidgets.length > 0) {\n            return cell.childWidgets[0];\n        }\n        return undefined;\n    };\n    //Table Cell Widget\n    /**\n     * Highlight selected cell widget\n     * @private\n     */\n    Selection.prototype.highlightCellWidget = function (widget) {\n        var widgets = [];\n        if (widget.previousSplitWidget || widget.nextSplitWidget) {\n            widgets = widget.getSplitWidgets();\n        }\n        else {\n            widgets.push(widget);\n        }\n        for (var i = 0; i < widgets.length; i++) {\n            widget = widgets[i];\n            //Clears Selection highlight of the child widgets.\n            this.clearChildSelectionHighlight(widget);\n            //Highlights the entire cell.\n            this.createHighlightBorderInsideTable(widget);\n        }\n    };\n    /**\n     * Clear selection highlight\n     * @private\n     */\n    Selection.prototype.clearSelectionHighlight = function (widget) {\n        if (this.selectedWidgets.containsKey(widget)) {\n            this.removeSelectionHighlight(widget);\n            this.selectedWidgets.remove(widget);\n        }\n    };\n    /**\n     * Get line widget from cell widget\n     * @private\n     */\n    Selection.prototype.getLineWidgetCellWidget = function (widget, point) {\n        for (var i = 0; i < widget.childWidgets.length; i++) {\n            if (widget.childWidgets[i].y <= point.y\n                && (widget.childWidgets[i].y + widget.childWidgets[i].height) >= point.y) {\n                if (widget.childWidgets[i] instanceof ParagraphWidget) {\n                    return this.getLineWidgetParaWidget(widget.childWidgets[i], point);\n                }\n                else {\n                    return this.getLineWidgetTableWidget(widget.childWidgets[i], point);\n                }\n            }\n        }\n        var lineWidget = undefined;\n        if (widget.childWidgets.length > 0) {\n            if (widget.childWidgets[0].y <= point.y) {\n                if (widget.childWidgets[widget.childWidgets.length - 1] instanceof ParagraphWidget) {\n                    // tslint:disable-next-line:max-line-length\n                    lineWidget = this.getLineWidgetParaWidget(widget.childWidgets[widget.childWidgets.length - 1], point);\n                }\n                else {\n                    lineWidget = this.getLineWidgetTableWidget(widget.childWidgets[0], point);\n                }\n            }\n        }\n        return lineWidget;\n    };\n    //LineWidget\n    /**\n     * update text position\n     * @private\n     */\n    Selection.prototype.updateTextPosition = function (widget, point) {\n        var caretPosition = point;\n        var element = undefined;\n        var index = 0;\n        var isImageSelected = false;\n        var isImageSelectedObj = this.updateTextPositionIn(widget, element, index, point, false);\n        if (!isNullOrUndefined(isImageSelectedObj)) {\n            element = isImageSelectedObj.element;\n            index = isImageSelectedObj.index;\n            caretPosition = isImageSelectedObj.caretPosition;\n            isImageSelected = isImageSelectedObj.isImageSelected;\n            this.isImageSelected = isImageSelected;\n        }\n        if (isImageSelected) {\n            this.selectInternal(widget, element, index, caretPosition);\n            if (index === 0) {\n                this.extendForward();\n            }\n            else {\n                this.extendBackward();\n            }\n        }\n        else {\n            this.selectInternal(widget, element, index, caretPosition);\n        }\n    };\n    /**\n     * @private\n     */\n    /* tslint:disable */\n    Selection.prototype.updateTextPositionIn = function (widget, inline, index, caretPosition, includeParagraphMark) {\n        var isImageSelected = false;\n        var top = this.getTop(widget);\n        var left = widget.paragraph.x;\n        var elementValues = this.getFirstElement(widget, left);\n        var element = elementValues.element;\n        left = elementValues.left;\n        if (isNullOrUndefined(element)) {\n            var topMargin = 0;\n            var bottomMargin = 0;\n            var size = this.getParagraphMarkSize(widget.paragraph, topMargin, bottomMargin);\n            topMargin = size.topMargin;\n            bottomMargin = size.bottomMargin;\n            var selectParaMark = this.viewer.mouseDownOffset.y >= top && this.viewer.mouseDownOffset.y < top + widget.height ? (this.viewer.mouseDownOffset.x < left + size.width) : true;\n            if (selectParaMark && includeParagraphMark && caretPosition.x > left + size.width / 2) {\n                left += size.width;\n                if (widget.children.length > 0) {\n                    inline = widget.children[widget.children.length - 1];\n                    index = inline.length;\n                }\n                index++;\n            }\n            caretPosition = new Point(left, topMargin > 0 ? top + topMargin : top);\n        }\n        else {\n            if (!isNullOrUndefined(element)) {\n                if (caretPosition.x > left + element.margin.left) {\n                    for (var i = widget.children.indexOf(element); i < widget.children.length; i++) {\n                        element = widget.children[i];\n                        if (caretPosition.x < left + element.margin.left + element.width || i === widget.children.length - 1) {\n                            break;\n                        }\n                        left += element.margin.left + element.width;\n                    }\n                    if (caretPosition.x > left + element.margin.left + element.width) {\n                        //Line End\n                        index = element instanceof TextElementBox ? element.length : 1;\n                        left += element.margin.left + element.width;\n                    }\n                    else if (element instanceof TextElementBox) {\n                        var x = caretPosition.x - left - element.margin.left;\n                        left += element.margin.left;\n                        var prevWidth = 0;\n                        var charIndex = 0;\n                        for (var i = 1; i <= element.length; i++) {\n                            var width = 0;\n                            if (i === element.length) {\n                                width = element.width;\n                            }\n                            else {\n                                width = this.viewer.textHelper.getWidth(element.text.substr(0, i), element.characterFormat);\n                            }\n                            if (x < width || i === element.length) {\n                                //Updates exact left position of the caret.\n                                var charWidth = width - prevWidth;\n                                if (x - prevWidth > charWidth / 2) {\n                                    left += width;\n                                    charIndex = i;\n                                }\n                                else {\n                                    left += prevWidth;\n                                    charIndex = i - 1;\n                                    if (i === 1 && element !== widget.children[0]) {\n                                        var curIndex = widget.children.indexOf(element);\n                                        if (!(widget.children[curIndex - 1] instanceof ListTextElementBox)) {\n                                            element = widget.children[curIndex - 1];\n                                            charIndex = element instanceof TextElementBox ? element.length : 1;\n                                        }\n                                    }\n                                }\n                                break;\n                            }\n                            prevWidth = width;\n                        }\n                        index = charIndex;\n                    }\n                    else {\n                        isImageSelected = element instanceof ImageElementBox;\n                        if (caretPosition.x - left - element.margin.left > element.width / 2) {\n                            index = 1;\n                            left += element.margin.left + element.width;\n                        }\n                        else if (element !== widget.children[0] && !isImageSelected) {\n                            var curIndex = widget.children.indexOf(element);\n                            if (!(widget.children[curIndex - 1] instanceof ListTextElementBox)) {\n                                element = widget.children[curIndex - 1];\n                                index = element instanceof TextElementBox ? element.length : 1;\n                            }\n                        }\n                    }\n                    if (element instanceof TextElementBox && element.text === '\\v') {\n                        index = 0;\n                    }\n                }\n                else {\n                    left += element.margin.left;\n                }\n                if (element instanceof TextElementBox) {\n                    top += element.margin.top > 0 ? element.margin.top : 0;\n                }\n                else {\n                    var textMetrics = this.viewer.textHelper.getHeight(element.characterFormat); //for ascent and descent\n                    var height = element.height;\n                    if (element instanceof BookmarkElementBox) {\n                        height = textMetrics.Height; //after text helper class\n                    }\n                    top += element.margin.top + height - textMetrics.BaselineOffset;\n                }\n                inline = element;\n                var inlineObj = this.validateTextPosition(inline, index);\n                inline = inlineObj.element;\n                index = inlineObj.index;\n                var isParagraphEnd = isNullOrUndefined(inline.nextNode) && index === inline.length;\n                var isLineEnd = isNullOrUndefined(inline.nextNode)\n                    && inline instanceof TextElementBox && inline.text === '\\v';\n                if (includeParagraphMark && inline.nextNode instanceof FieldElementBox && index === inline.length) {\n                    isParagraphEnd = this.isLastRenderedInline(inline, index);\n                }\n                if (includeParagraphMark && isParagraphEnd || isLineEnd) {\n                    var width = 0;\n                    //Include width of Paragraph mark.\n                    if (isParagraphEnd) {\n                        width = this.viewer.textHelper.getParagraphMarkWidth(widget.paragraph.characterFormat);\n                        var selectParaMark = this.viewer.mouseDownOffset.y >= top && this.viewer.mouseDownOffset.y < top + widget.height ? (this.viewer.mouseDownOffset.x < left + width) : true;\n                        if (selectParaMark && caretPosition.x > left + width / 2) {\n                            left += width;\n                            index = inline.length + 1;\n                        }\n                        //Include width of line break mark.\n                    }\n                    else if (isLineEnd) {\n                        width = element.width;\n                        left += width;\n                        index = inline.length;\n                    }\n                }\n                caretPosition = new Point(left, top);\n            }\n        }\n        return {\n            'element': inline,\n            'index': index,\n            'caretPosition': caretPosition,\n            'isImageSelected': isImageSelected\n        };\n    };\n    /* tslint:enable */\n    /**\n     * Get text length if the line widget\n     * @private\n     */\n    // public getTextLength(viewer: LayoutViewer, widget: LineWidget, element: ElementBox): number {\n    //     let length: number = 0;\n    //     let count: number = widget.children.indexOf(element);\n    //     if (widget.children.length > 0 && widget.children[0] instanceof ListTextElementBox) {\n    //         if (widget.children[1] instanceof ListTextElementBox) {\n    //             count -= 2;\n    //         } else {\n    //             count -= 1;\n    //         }\n    //     }\n    //     for (let i: number = 1; i < count; i++) {\n    //         length += widget.children[i].length;\n    //     }\n    //     return length;\n    // }\n    /**\n     * Get Line widget left\n     * @private\n     */\n    Selection.prototype.getLeft = function (widget) {\n        var left = widget.paragraph.x;\n        var paragraphFormat = widget.paragraph.paragraphFormat;\n        if (this.isParagraphFirstLine(widget) && !(paragraphFormat.textAlignment === 'Right')) {\n            left += HelperMethods.convertPointToPixel(paragraphFormat.firstLineIndent);\n        }\n        for (var i = 0; i < widget.children.length; i++) {\n            var element = widget.children[i];\n            if (element instanceof ListTextElementBox) {\n                if (i === 0) {\n                    left += element.margin.left + element.width;\n                }\n                else {\n                    left += element.width;\n                }\n            }\n            else {\n                left += element.margin.left;\n                break;\n            }\n        }\n        return left;\n    };\n    /**\n     * Get line widget top\n     * @private\n     */\n    Selection.prototype.getTop = function (widget) {\n        var top = widget.paragraph.y;\n        var count = widget.paragraph.childWidgets.indexOf(widget);\n        for (var i = 0; i < count; i++) {\n            top += widget.paragraph.childWidgets[i].height;\n        }\n        return top;\n    };\n    /**\n     * Get first element the widget\n     * @private\n     */\n    Selection.prototype.getFirstElement = function (widget, left) {\n        var firstLineIndent = 0;\n        if (this.isParagraphFirstLine(widget)) {\n            firstLineIndent = HelperMethods.convertPointToPixel(widget.paragraph.paragraphFormat.firstLineIndent);\n        }\n        left += firstLineIndent;\n        var element = undefined;\n        for (var i = 0; i < widget.children.length; i++) {\n            element = widget.children[i];\n            if (element instanceof ListTextElementBox) {\n                left += element.margin.left + element.width;\n                element = undefined;\n                // }\n                //  else if (element instanceof FieldElementBox || element instanceof BookmarkElementBox\n                //     || (element.nextNode instanceof FieldElementBox && ((element.nextNode as FieldElementBox).fieldType === 2))) {\n                //     element = undefined;\n            }\n            else {\n                break;\n            }\n        }\n        return { 'element': element, 'left': left };\n    };\n    /**\n     * Return inline index\n     * @private\n     */\n    //ElementBox\n    Selection.prototype.getIndexInInline = function (elementBox) {\n        var indexInInline = 0;\n        if (elementBox instanceof TextElementBox) {\n            var count = elementBox.line.children.indexOf(elementBox);\n            for (var i = 0; i < count; i++) {\n                var element = elementBox.line.children[i];\n                if (element instanceof FieldElementBox || element instanceof ListTextElementBox) {\n                    continue;\n                }\n                indexInInline += element.length;\n            }\n        }\n        return indexInInline;\n    };\n    /**\n     * Return true if widget is first inline of paragraph\n     * @private\n     */\n    Selection.prototype.isParagraphFirstLine = function (widget) {\n        if (isNullOrUndefined(widget.paragraph.previousSplitWidget) &&\n            widget === widget.paragraph.firstChild) {\n            return true;\n        }\n        return false;\n    };\n    /**\n     * @private\n     */\n    Selection.prototype.isParagraphLastLine = function (widget) {\n        if (isNullOrUndefined(widget.paragraph.nextSplitWidget)\n            && widget === widget.paragraph.lastChild) {\n            return true;\n        }\n        return false;\n    };\n    /**\n     * Return line widget width\n     * @private\n     */\n    Selection.prototype.getWidth = function (widget, includeParagraphMark) {\n        var width = 0;\n        if (this.isParagraphFirstLine(widget)) {\n            width += HelperMethods.convertPointToPixel(widget.paragraph.paragraphFormat.firstLineIndent);\n        }\n        for (var i = 0; i < widget.children.length; i++) {\n            width += widget.children[i].margin.left + widget.children[i].width;\n        }\n        if (includeParagraphMark && widget.paragraph.childWidgets.indexOf(widget) === widget.paragraph.childWidgets.length - 1\n            && isNullOrUndefined(widget.paragraph.nextSplitWidget)) {\n            width += this.viewer.textHelper.getParagraphMarkWidth(widget.paragraph.characterFormat);\n        }\n        return width;\n    };\n    /**\n     * Return line widget left\n     * @private\n     */\n    Selection.prototype.getLeftInternal = function (widget, elementBox, index) {\n        var left = widget.paragraph.x;\n        if (this.isParagraphFirstLine(widget)) {\n            // tslint:disable-next-line:max-line-length\n            left += HelperMethods.convertPointToPixel(widget.paragraph.paragraphFormat.firstLineIndent);\n        }\n        var count = widget.children.indexOf(elementBox);\n        if ((widget.children.length === 1 && widget.children[0] instanceof ListTextElementBox) || (widget.children.length === 2\n            && widget.children[0] instanceof ListTextElementBox && widget.children[1] instanceof ListTextElementBox)) {\n            count = widget.children.length;\n        }\n        for (var i = 0; i < count; i++) {\n            var widgetInternal = widget.children[i];\n            // if (widgetInternal instanceof FieldElementBox) {\n            //     continue;\n            // }\n            if (i === 1 && widget.children[i] instanceof ListTextElementBox) {\n                left += widget.children[i].width;\n            }\n            else {\n                left += widget.children[i].margin.left + widget.children[i].width;\n            }\n        }\n        if (!isNullOrUndefined(elementBox)) {\n            left += elementBox.margin.left;\n        }\n        if (elementBox instanceof TextElementBox) {\n            if (index === elementBox.length) {\n                left += elementBox.width;\n            }\n            else if (index > elementBox.length) {\n                // tslint:disable-next-line:max-line-length\n                left += elementBox.width + this.viewer.textHelper.getParagraphMarkWidth(elementBox.line.paragraph.characterFormat);\n            }\n            else {\n                // tslint:disable-next-line:max-line-length\n                left += this.viewer.textHelper.getWidth(elementBox.text.substr(0, index), elementBox.characterFormat);\n            }\n        }\n        else if (index > 0) {\n            if (!isNullOrUndefined(elementBox) && !(elementBox instanceof ListTextElementBox)) {\n                left += elementBox.width;\n                if (index === 2) {\n                    var paragraph = elementBox.line.paragraph;\n                    left += this.viewer.textHelper.getParagraphMarkWidth(paragraph.characterFormat);\n                }\n            }\n            else {\n                left += this.viewer.textHelper.getParagraphMarkWidth(widget.paragraph.characterFormat);\n            }\n        }\n        return left;\n    };\n    /**\n     * Return line widget start offset\n     * @private\n     */\n    Selection.prototype.getLineStartLeft = function (widget) {\n        var left = widget.paragraph.x;\n        if (this.isParagraphFirstLine(widget)) {\n            left += HelperMethods.convertPointToPixel(widget.paragraph.paragraphFormat.firstLineIndent);\n        }\n        if (widget.children.length > 0) {\n            left += widget.children[0].margin.left;\n        }\n        return left;\n    };\n    /**\n     * Update text position\n     * @private\n     */\n    Selection.prototype.updateTextPositionWidget = function (widget, point, textPosition, includeParagraphMark) {\n        var caretPosition = point;\n        var inline = undefined;\n        var index = 0;\n        var updatePositionObj;\n        updatePositionObj = this.updateTextPositionIn(widget, inline, index, caretPosition, includeParagraphMark);\n        inline = updatePositionObj.element;\n        index = updatePositionObj.index;\n        caretPosition = updatePositionObj.caretPosition;\n        textPosition.setPositionForSelection(widget, inline, index, caretPosition);\n    };\n    /**\n     * Clear selection highlight\n     * @private\n     */\n    Selection.prototype.clearSelectionHighlightLineWidget = function (widget) {\n        if (!isNullOrUndefined(this.owner) && this.selectedWidgets.length > 0) {\n            this.clearSelectionHighlight(this);\n        }\n    };\n    /**\n     * Return first element from line widget\n     * @private\n     */\n    Selection.prototype.getFirstElementInternal = function (widget) {\n        var element = undefined;\n        for (var i = 0; i < widget.children.length; i++) {\n            element = widget.children[i];\n            if (element instanceof ListTextElementBox) {\n                element = undefined;\n            }\n            else {\n                break;\n            }\n        }\n        return element;\n    };\n    //Selection API    \n    /**\n     * Select content between given range\n     * @private\n     */\n    Selection.prototype.selectRange = function (startPosition, endPosition) {\n        this.start.setPositionInternal(startPosition);\n        this.end.setPositionInternal(endPosition);\n        this.upDownSelectionLength = this.end.location.x;\n        this.fireSelectionChanged(true);\n    };\n    /**\n     * Selects current paragraph\n     * @private\n     */\n    Selection.prototype.selectParagraph = function (paragraph, positionAtStart) {\n        var line = paragraph.firstChild;\n        if (positionAtStart) {\n            this.start.setPosition(line, positionAtStart);\n        }\n        else {\n            var endOffset = line.getEndOffset();\n            this.start.setPositionParagraph(line, endOffset);\n        }\n        this.end.setPositionInternal(this.start);\n        this.upDownSelectionLength = this.start.location.x;\n        this.fireSelectionChanged(true);\n    };\n    /**\n     * @private\n     */\n    Selection.prototype.setPositionForBlock = function (block, selectFirstBlock) {\n        var position;\n        if (block instanceof TableWidget) {\n            if (selectFirstBlock) {\n                block = this.getFirstParagraphInFirstCell(block);\n            }\n            else {\n                block = this.getLastParagraphInLastCell(block);\n            }\n        }\n        if (block instanceof ParagraphWidget) {\n            position = new TextPosition(this.owner);\n            if (selectFirstBlock) {\n                position.setPosition(block.firstChild, true);\n            }\n            else {\n                var line = block.lastChild;\n                position.setPositionParagraph(line, line.getEndOffset());\n            }\n        }\n        return position;\n    };\n    /**\n     * Select content in given text position\n     * @private\n     */\n    Selection.prototype.selectContent = function (textPosition, clearMultiSelection) {\n        if (isNullOrUndefined(textPosition)) {\n            throw new Error('textPosition is undefined.');\n        }\n        this.start.setPositionInternal(textPosition);\n        this.end.setPositionInternal(textPosition);\n        this.upDownSelectionLength = this.end.location.x;\n        this.fireSelectionChanged(true);\n    };\n    /**\n     * Select paragraph\n     * @private\n     */\n    Selection.prototype.selectInternal = function (lineWidget, element, index, physicalLocation) {\n        this.start.setPositionForSelection(lineWidget, element, index, physicalLocation);\n        this.end.setPositionInternal(this.start);\n        this.upDownSelectionLength = physicalLocation.x;\n        this.fireSelectionChanged(true);\n    };\n    /**\n     * @private\n     */\n    Selection.prototype.selects = function (lineWidget, offset, skipSelectionChange) {\n        this.viewer.clearSelectionHighlight();\n        this.start.setPositionForLineWidget(lineWidget, offset);\n        this.end.setPositionInternal(this.start);\n        if (!skipSelectionChange) {\n            this.fireSelectionChanged(true);\n        }\n    };\n    /**\n     * Select content between start and end position\n     * @private\n     */\n    Selection.prototype.selectPosition = function (startPosition, endPosition) {\n        if (isNullOrUndefined(startPosition) || isNullOrUndefined(endPosition)) {\n            throw new Error('TextPosition cannot be undefined');\n        }\n        if (isNullOrUndefined(startPosition.paragraph)\n            || startPosition.offset > this.getParagraphLength(startPosition.paragraph) + 1) {\n            throw new Error('Start TextPosition is not valid.');\n        }\n        if (isNullOrUndefined(endPosition.paragraph)\n            || endPosition.offset > this.getParagraphLength(endPosition.paragraph) + 1) {\n            throw new Error('End TextPosition is not valid.');\n        }\n        if (startPosition.isAtSamePosition(endPosition)) {\n            // Select start position.\n            this.selectRange(startPosition, startPosition);\n        }\n        else {\n            // If both text position exists within same comment or outside comment, and not at same position.\n            if (startPosition.isExistBefore(endPosition)) {\n                // tslint:disable-next-line:max-line-length\n                endPosition.validateForwardFieldSelection(startPosition.getHierarchicalIndexInternal(), endPosition.getHierarchicalIndexInternal());\n            }\n            else {\n                // tslint:disable-next-line:max-line-length\n                startPosition.validateForwardFieldSelection(endPosition.getHierarchicalIndexInternal(), startPosition.getHierarchicalIndexInternal());\n            }\n            this.selectRange(startPosition, endPosition);\n        }\n    };\n    /**\n     * Notify selection change event\n     * @private\n     */\n    Selection.prototype.fireSelectionChanged = function (isSelectionChanged) {\n        if (!this.isEmpty) {\n            if (this.isForward) {\n                this.start.updatePhysicalPosition(true);\n                this.end.updatePhysicalPosition(false);\n            }\n            else {\n                this.start.updatePhysicalPosition(false);\n                this.end.updatePhysicalPosition(true);\n            }\n        }\n        if (!this.skipFormatRetrieval) {\n            this.retrieveCurrentFormatProperties();\n        }\n        this.viewer.clearSelectionHighlight();\n        this.hideToolTip();\n        if (this.owner.isLayoutEnabled && !this.owner.isShiftingEnabled) {\n            this.highlightSelection(true);\n        }\n        if (isSelectionChanged) {\n            if (this.start.paragraph.isInHeaderFooter && !this.owner.enableHeaderAndFooter) {\n                this.owner.enableHeaderAndFooter = true;\n            }\n            else if (!this.start.paragraph.isInHeaderFooter && this.owner.enableHeaderAndFooter) {\n                this.owner.enableHeaderAndFooter = false;\n            }\n            this.owner.fireSelectionChange();\n        }\n        this.viewer.updateFocus();\n    };\n    //Formats Retrieval\n    /**\n     * Retrieve all current selection format\n     * @private\n     */\n    Selection.prototype.retrieveCurrentFormatProperties = function () {\n        this.isRetrieveFormatting = true;\n        var startPosition = this.start;\n        var endPosition = this.end;\n        if (!this.isForward) {\n            startPosition = this.end;\n            endPosition = this.start;\n        }\n        this.retrieveImageFormat(startPosition, endPosition);\n        this.retrieveCharacterFormat(startPosition, endPosition);\n        this.retrieveParagraphFormat(startPosition, endPosition);\n        this.retrieveSectionFormat(startPosition, endPosition);\n        this.retrieveTableFormat(startPosition, endPosition);\n        if (!this.isImageSelected) {\n            this.imageFormat.clearImageFormat();\n        }\n        this.isRetrieveFormatting = false;\n        this.setCurrentContextType();\n    };\n    /**\n     * @private\n     */\n    Selection.prototype.retrieveImageFormat = function (start, end) {\n        var image;\n        if (start.currentWidget === end.currentWidget && start.offset + 1 === end.offset) {\n            var elementInfo = end.currentWidget.getInline(end.offset, 0);\n            image = elementInfo.element;\n            var index = elementInfo.index;\n            if (image instanceof ImageElementBox) {\n                var startOffset = start.currentWidget.getOffset(image, 0);\n                if (startOffset !== start.offset) {\n                    image = undefined;\n                }\n            }\n        }\n        if (image instanceof ImageElementBox) {\n            this.imageFormat.copyImageFormat(image);\n        }\n        else {\n            this.imageFormat.clearImageFormat();\n        }\n    };\n    Selection.prototype.setCurrentContextType = function () {\n        var contextIsinImage = this.imageFormat.image ? true : false;\n        var contextIsinTable = (isNullOrUndefined(this.tableFormat) || isNullOrUndefined(this.tableFormat.table)) ? false : true;\n        var style = this.start.paragraph.paragraphFormat.baseStyle;\n        if (style instanceof WParagraphStyle && style.name.toLowerCase().indexOf('toc') === 0) {\n            var tocField = this.getTocFieldInternal();\n            if (!isNullOrUndefined(tocField)) {\n                this.contextTypeInternal = 'TableOfContents';\n                return;\n            }\n        }\n        if (this.start.paragraph.isInHeaderFooter) {\n            var isInHeader = this.start.paragraph.bodyWidget.headerFooterType.indexOf('Header') !== -1;\n            if (contextIsinTable) {\n                if (contextIsinImage) {\n                    this.contextTypeInternal = isInHeader ? 'HeaderTableImage' : 'FooterTableImage';\n                }\n                else {\n                    this.contextTypeInternal = isInHeader ? 'HeaderTableText' : 'FooterTableText';\n                }\n            }\n            else {\n                if (contextIsinImage) {\n                    this.contextTypeInternal = isInHeader ? 'HeaderImage' : 'FooterImage';\n                }\n                else {\n                    this.contextTypeInternal = isInHeader ? 'HeaderText' : 'FooterText';\n                }\n            }\n        }\n        else {\n            if (contextIsinTable) {\n                this.contextTypeInternal = contextIsinImage ? 'TableImage' : 'TableText';\n            }\n            else {\n                this.contextTypeInternal = contextIsinImage ? 'Image' : 'Text';\n            }\n        }\n    };\n    //Table Format retrieval starts\n    /**\n     * Retrieve selection table format\n     * @private\n     */\n    Selection.prototype.retrieveTableFormat = function (start, end) {\n        var tableAdv = this.getTable(start, end);\n        if (!isNullOrUndefined(tableAdv)) {\n            this.tableFormat.copyFormat(tableAdv.tableFormat);\n            this.tableFormat.table = tableAdv;\n            this.retrieveCellFormat(start, end);\n            this.retrieveRowFormat(start, end);\n        }\n        else {\n            //When the selection is out of table\n            this.tableFormat.clearFormat();\n        }\n    };\n    /**\n     * Retrieve selection cell format\n     * @private\n     */\n    Selection.prototype.retrieveCellFormat = function (start, end) {\n        if (start.paragraph.isInsideTable && end.paragraph.isInsideTable) {\n            this.cellFormat.copyFormat(start.paragraph.associatedCell.cellFormat);\n            this.getCellFormat(start.paragraph.associatedCell.ownerTable, start, end);\n        }\n        else {\n            //When the selection is out of table\n            this.cellFormat.clearCellFormat();\n        }\n    };\n    /**\n     * Retrieve selection row format\n     * @private\n     */\n    Selection.prototype.retrieveRowFormat = function (start, end) {\n        if (start.paragraph.isInsideTable && end.paragraph.isInsideTable) {\n            this.rowFormat.copyFormat(start.paragraph.associatedCell.ownerRow.rowFormat);\n            this.getRowFormat(start.paragraph.associatedCell.ownerTable, start, end);\n        }\n        else {\n            //When the selection is out of table\n            this.rowFormat.clearRowFormat();\n        }\n    };\n    /**\n     * Get selected cell format\n     * @private\n     */\n    Selection.prototype.getCellFormat = function (table, start, end) {\n        if (start.paragraph.associatedCell.equals(end.paragraph.associatedCell)) {\n            return;\n        }\n        var isStarted = false;\n        for (var i = 0; i < table.childWidgets.length; i++) {\n            var row = table.childWidgets[i];\n            if (row === start.paragraph.associatedCell.ownerRow) {\n                isStarted = true;\n            }\n            if (isStarted) {\n                for (var j = 0; j < row.childWidgets.length; j++) {\n                    var cell = row.childWidgets[j];\n                    if (this.isCellSelected(cell, start, end)) {\n                        this.cellFormat.combineFormat(cell.cellFormat);\n                    }\n                    if (cell === end.paragraph.associatedCell) {\n                        this.cellFormat.combineFormat(cell.cellFormat);\n                        return;\n                    }\n                }\n            }\n        }\n    };\n    /**\n     * Get selected row format\n     * @private\n     */\n    Selection.prototype.getRowFormat = function (table, start, end) {\n        var tableRow = start.paragraph.associatedCell.ownerRow;\n        if (tableRow === end.paragraph.associatedCell.ownerRow) {\n            return;\n        }\n        for (var i = table.childWidgets.indexOf(tableRow) + 1; i < table.childWidgets.length; i++) {\n            var tempTableRow = table.childWidgets[i];\n            this.rowFormat.combineFormat(tempTableRow.rowFormat);\n            if (tempTableRow === end.paragraph.associatedCell.ownerRow) {\n                return;\n            }\n        }\n    };\n    /**\n     * Return table with given text position\n     * @private\n     */\n    Selection.prototype.getTable = function (startPosition, endPosition) {\n        if (!isNullOrUndefined(startPosition.paragraph.associatedCell) && !isNullOrUndefined(endPosition.paragraph.associatedCell)) {\n            var startTable = startPosition.paragraph.associatedCell.ownerTable;\n            var endTable = startPosition.paragraph.associatedCell.ownerTable;\n            if (startTable === endTable) {\n                return startTable;\n            }\n            else {\n                if (startTable.contains(startPosition.paragraph.associatedCell)) {\n                    return startTable;\n                }\n                else if (endTable.contains(startPosition.paragraph.associatedCell)) {\n                    return endTable;\n                }\n                else if (!startTable.isInsideTable || !endTable.isInsideTable) {\n                    return undefined;\n                }\n                else {\n                    do {\n                        startTable = startTable.associatedCell.ownerTable;\n                        if (startTable === endTable || startTable.contains(endTable.associatedCell)) {\n                            return startTable;\n                        }\n                        else if (endTable.contains(startTable.associatedCell)) {\n                            return endTable;\n                        }\n                    } while (!isNullOrUndefined(startTable.associatedCell));\n                }\n            }\n        }\n        return undefined;\n    };\n    Selection.prototype.getContainerWidget = function (block) {\n        var bodyWidget;\n        if (block.containerWidget instanceof BlockContainer) {\n            bodyWidget = block.containerWidget;\n        }\n        else {\n            bodyWidget = block.containerWidget;\n            while (!(bodyWidget instanceof BlockContainer)) {\n                bodyWidget = bodyWidget.containerWidget;\n            }\n        }\n        return bodyWidget;\n    };\n    //Table format retrieval ends\n    //Section format retrieval starts\n    /**\n     * Retrieve selection section format\n     * @private\n     */\n    Selection.prototype.retrieveSectionFormat = function (start, end) {\n        var startParaSection = this.getContainerWidget(start.paragraph);\n        var endParaSection = this.getContainerWidget(end.paragraph);\n        if (!isNullOrUndefined(startParaSection)) {\n            this.sectionFormat.copyFormat(startParaSection.sectionFormat);\n            var startPageIndex = this.viewer.pages.indexOf(startParaSection.page);\n            var endPageIndex = this.viewer.pages.indexOf(endParaSection.page);\n            for (var i = startPageIndex + 1; i <= endPageIndex; i++) {\n                this.sectionFormat.combineFormat(this.viewer.pages[i].bodyWidgets[0].sectionFormat);\n            }\n        }\n    };\n    //section format retrieval ends.\n    //Paragraph format retrieval implementation starts.\n    /**\n     * Retrieve selection paragraph format\n     * @private\n     */\n    Selection.prototype.retrieveParagraphFormat = function (start, end) {\n        this.getParagraphFormatForSelection(start.paragraph, this, start, end);\n    };\n    /**\n     * @private\n     */\n    Selection.prototype.getParagraphFormatForSelection = function (paragraph, selection, start, end) {\n        //Selection start in cell.\n        if (start.paragraph.isInsideTable && (!end.paragraph.isInsideTable\n            || start.paragraph.associatedCell !== end.paragraph.associatedCell\n            || this.isCellSelected(start.paragraph.associatedCell, start, end))) {\n            this.getParagraphFormatInternalInCell(start.paragraph.associatedCell, start, end);\n        }\n        else {\n            this.getParagraphFormatInternalInParagraph(paragraph, start, end);\n        }\n    };\n    /**\n     * @private\n     */\n    // tslint:disable-next-line:max-line-length\n    Selection.prototype.getParagraphFormatInternalInParagraph = function (paragraph, start, end) {\n        if (start.paragraph === paragraph) {\n            this.paragraphFormat.copyFormat(paragraph.paragraphFormat);\n        }\n        else {\n            this.paragraphFormat.combineFormat(paragraph.paragraphFormat);\n        }\n        if (end.paragraph === paragraph) {\n            return;\n        }\n        var block = this.getNextRenderedBlock(paragraph);\n        if (!isNullOrUndefined(block)) {\n            this.getParagraphFormatInternalInBlock(block, start, end);\n        }\n    };\n    /**\n     * @private\n     */\n    Selection.prototype.getParagraphFormatInternalInBlock = function (block, start, end) {\n        if (block instanceof ParagraphWidget) {\n            this.getParagraphFormatInternalInParagraph(block, start, end);\n        }\n        else {\n            this.getParagraphFormatInternalInTable(block, start, end);\n        }\n    };\n    /**\n     * @private\n     */\n    Selection.prototype.getParagraphFormatInternalInTable = function (table, start, end) {\n        for (var i = 0; i < table.childWidgets.length; i++) {\n            var tableRow = table.childWidgets[i];\n            for (var j = 0; j < tableRow.childWidgets.length; j++) {\n                this.getParagraphFormatInCell(tableRow.childWidgets[j]);\n            }\n            if (end.paragraph.isInsideTable && this.containsRow(tableRow, end.paragraph.associatedCell)) {\n                return;\n            }\n        }\n        var block = this.getNextRenderedBlock(table);\n        //Goto the next block.\n        this.getParagraphFormatInternalInBlock(block, start, end);\n    };\n    /**\n     * Get paragraph format in cell\n     * @private\n     */\n    Selection.prototype.getParagraphFormatInCell = function (cell) {\n        for (var i = 0; i < cell.childWidgets.length; i++) {\n            this.getParagraphFormatInBlock(cell.childWidgets[i]);\n        }\n    };\n    /**\n     * @private\n     */\n    Selection.prototype.getParagraphFormatInBlock = function (block) {\n        if (block instanceof ParagraphWidget) {\n            this.getParagraphFormatInParagraph(block);\n        }\n        else {\n            this.getParagraphFormatInTable(block);\n        }\n    };\n    /**\n     * @private\n     */\n    Selection.prototype.getParagraphFormatInTable = function (tableAdv) {\n        for (var i = 0; i < tableAdv.childWidgets.length; i++) {\n            var tableRow = tableAdv.childWidgets[i];\n            for (var j = 0; j < tableRow.childWidgets.length; j++) {\n                this.getParagraphFormatInCell(tableRow.childWidgets[j]);\n            }\n        }\n    };\n    /**\n     * @private\n     */\n    Selection.prototype.getParagraphFormatInParagraph = function (paragraph) {\n        this.paragraphFormat.combineFormat(paragraph.paragraphFormat);\n    };\n    /**\n     * Get paragraph format in cell\n     * @private\n     */\n    Selection.prototype.getParagraphFormatInternalInCell = function (cellAdv, start, end) {\n        if (end.paragraph.isInsideTable) {\n            var containerCell = this.getContainerCellOf(cellAdv, end.paragraph.associatedCell);\n            if (containerCell.ownerTable.contains(end.paragraph.associatedCell)) {\n                var startCell = this.getSelectedCell(cellAdv, containerCell);\n                var endCell = this.getSelectedCell(end.paragraph.associatedCell, containerCell);\n                if (this.containsCell(containerCell, end.paragraph.associatedCell)) {\n                    //Selection end is in container cell.\n                    if (this.isCellSelected(containerCell, start, end)) {\n                        this.getParagraphFormatInCell(containerCell);\n                    }\n                    else {\n                        if (startCell === containerCell) {\n                            this.getParagraphFormatInternalInParagraph(start.paragraph, start, end);\n                        }\n                        else {\n                            this.getParagraphFormatInRow(startCell.ownerRow, start, end);\n                        }\n                    }\n                }\n                else {\n                    //Format other selected cells in current table.\n                    this.getParaFormatForCell(containerCell.ownerTable, containerCell, endCell);\n                }\n            }\n            else {\n                this.getParagraphFormatInRow(containerCell.ownerRow, start, end);\n            }\n        }\n        else {\n            var cell = this.getContainerCell(cellAdv);\n            this.getParagraphFormatInRow(cell.ownerRow, start, end);\n        }\n    };\n    /**\n     * @private\n     */\n    Selection.prototype.getParaFormatForCell = function (table, startCell, endCell) {\n        var startCellIn = this.getCellLeft(startCell.ownerRow, startCell);\n        var endCellIn = startCellIn + startCell.cellFormat.cellWidth;\n        var endCellLeft = this.getCellLeft(endCell.ownerRow, endCell);\n        var endCellRight = endCellLeft + endCell.cellFormat.cellWidth;\n        if (startCellIn > endCellLeft) {\n            startCellIn = endCellLeft;\n        }\n        if (endCellIn < endCellRight) {\n            endCellIn = endCellRight;\n        }\n        if (startCellIn > this.upDownSelectionLength) {\n            startCellIn = this.upDownSelectionLength;\n        }\n        if (startCellIn < this.upDownSelectionLength) {\n            startCellIn = this.upDownSelectionLength;\n        }\n        var count = table.childWidgets.indexOf(endCell.ownerRow);\n        for (var i = table.childWidgets.indexOf(startCell.ownerRow); i <= count; i++) {\n            var tableRow = table.childWidgets[i];\n            for (var j = 0; j < tableRow.childWidgets.length; j++) {\n                var cell = tableRow.childWidgets[j];\n                var left = this.getCellLeft(tableRow, cell);\n                if (HelperMethods.round(startCellIn, 2) <= HelperMethods.round(left, 2)\n                    && HelperMethods.round(left, 2) < HelperMethods.round(endCellIn, 2)) {\n                    this.getParagraphFormatInCell(cell);\n                }\n            }\n        }\n    };\n    /**\n     * Get paragraph format ins row\n     * @private\n     */\n    Selection.prototype.getParagraphFormatInRow = function (tableRow, start, end) {\n        for (var i = tableRow.rowIndex; i < tableRow.ownerTable.childWidgets.length; i++) {\n            var row = tableRow.ownerTable.childWidgets[i];\n            for (var j = 0; j < row.childWidgets.length; j++) {\n                this.getParagraphFormatInCell(row.childWidgets[j]);\n            }\n            if (end.paragraph.isInsideTable && this.containsRow(row, end.paragraph.associatedCell)) {\n                return;\n            }\n        }\n        var block = this.getNextRenderedBlock(tableRow.ownerTable);\n        //Goto the next block.\n        this.getParagraphFormatInternalInBlock(block, start, end);\n    };\n    // paragraph format retrieval implementation ends\n    // Character format retrieval implementation starts.\n    /**\n     * Retrieve Selection character format\n     * @private\n     */\n    Selection.prototype.retrieveCharacterFormat = function (start, end) {\n        this.characterFormat.copyFormat(start.paragraph.characterFormat);\n        if (start.paragraph === end.paragraph && start.currentWidget.isLastLine()\n            && start.offset === this.getLineLength(start.currentWidget) && start.offset + 1 === end.offset) {\n            return;\n        }\n        var para = start.paragraph;\n        if (start.offset === this.getParagraphLength(para) && !this.isEmpty) {\n            para = this.getNextParagraphBlock(para);\n        }\n        while (!isNullOrUndefined(para) && para !== end.paragraph && para.isEmpty()) {\n            para = this.getNextParagraphBlock(para);\n        }\n        var offset = para === start.paragraph ? start.offset : 0;\n        var indexInInline = 0;\n        if (!isNullOrUndefined(para) && !para.isEmpty()) {\n            var position = new TextPosition(this.owner);\n            var elemInfo = start.currentWidget.getInline(offset, indexInInline);\n            var physicalLocation = this.getPhysicalPositionInternal(start.currentWidget, offset, true);\n            position.setPositionForSelection(start.currentWidget, elemInfo.element, elemInfo.index, physicalLocation);\n            this.getCharacterFormatForSelection(para, this, position, end);\n        }\n    };\n    /**\n     * @private\n     */\n    // tslint:disable-next-line:max-line-length\n    Selection.prototype.getCharacterFormatForSelection = function (paragraph, selection, startPosition, endPosition) {\n        //Selection start in cell.\n        if (startPosition.paragraph instanceof ParagraphWidget && startPosition.paragraph.isInsideTable\n            && (!endPosition.paragraph.isInsideTable\n                || startPosition.paragraph.associatedCell !== endPosition.paragraph.associatedCell\n                || this.isCellSelected(startPosition.paragraph.associatedCell, startPosition, endPosition))) {\n            this.getCharacterFormatInTableCell(startPosition.paragraph.associatedCell, selection, startPosition, endPosition);\n        }\n        else {\n            this.getCharacterFormat(paragraph, startPosition, endPosition);\n        }\n    };\n    /**\n     * Get Character format\n     * @private\n     */\n    //Format Retrieval\n    Selection.prototype.getCharacterFormatForTableRow = function (tableRowAdv, start, end) {\n        for (var i = tableRowAdv.rowIndex; i < tableRowAdv.ownerTable.childWidgets.length; i++) {\n            var tableRow = tableRowAdv.ownerTable.childWidgets[i];\n            for (var j = 0; j < tableRow.childWidgets.length; j++) {\n                this.getCharacterFormatForSelectionCell(tableRow.childWidgets[j], start, end);\n            }\n            if (end.paragraph.isInsideTable && this.containsRow(tableRow, end.paragraph.associatedCell)) {\n                return;\n            }\n        }\n        var block = this.getNextRenderedBlock(tableRowAdv.ownerTable);\n        // //Goto the next block.\n        this.getCharacterFormatForBlock(block, start, end);\n    };\n    /**\n     * Get Character format in table\n     * @private\n     */\n    Selection.prototype.getCharacterFormatInTableCell = function (tableCell, selection, start, end) {\n        if (end.paragraph.isInsideTable) {\n            var containerCell = this.getContainerCellOf(tableCell, end.paragraph.associatedCell);\n            if (containerCell.ownerTable.contains(end.paragraph.associatedCell)) {\n                var startCell = this.getSelectedCell(tableCell, containerCell);\n                var endCell = this.getSelectedCell(end.paragraph.associatedCell, containerCell);\n                if (this.containsCell(containerCell, end.paragraph.associatedCell)) {\n                    //Selection end is in container cell.\n                    if (this.isCellSelected(containerCell, start, end)) {\n                        this.getCharacterFormatForSelectionCell(containerCell, start, end);\n                    }\n                    else {\n                        if (startCell === containerCell) {\n                            this.getCharacterFormat(start.paragraph, start, end);\n                        }\n                        else {\n                            this.getCharacterFormatForTableRow(startCell.ownerRow, start, end);\n                        }\n                    }\n                }\n                else {\n                    //Format other selected cells in current table.\n                    this.getCharacterFormatInternalInTable(containerCell.ownerTable, containerCell, endCell, start, end);\n                }\n            }\n            else {\n                this.getCharacterFormatForTableRow(containerCell.ownerRow, start, end);\n            }\n        }\n        else {\n            var cell = this.getContainerCell(tableCell);\n            this.getCharacterFormatForTableRow(cell.ownerRow, start, end);\n        }\n    };\n    /**\n     * @private\n     */\n    // tslint:disable-next-line:max-line-length\n    Selection.prototype.getCharacterFormatInternalInTable = function (table, startCell, endCell, startPosition, endPosition) {\n        var startIn = this.getCellLeft(startCell.ownerRow, startCell);\n        var endIn = startIn + startCell.cellFormat.cellWidth;\n        var endCellLeft = this.getCellLeft(endCell.ownerRow, endCell);\n        var endCellRight = endCellLeft + endCell.cellFormat.cellWidth;\n        if (startIn > endCellLeft) {\n            startIn = endCellLeft;\n        }\n        if (endIn < endCellRight) {\n            endIn = endCellRight;\n        }\n        if (startIn > this.upDownSelectionLength) {\n            startIn = this.upDownSelectionLength;\n        }\n        if (endIn < this.upDownSelectionLength) {\n            endIn = this.upDownSelectionLength;\n        }\n        var count = table.childWidgets.indexOf(endCell.ownerRow);\n        for (var i = table.childWidgets.indexOf(startCell.ownerRow); i <= count; i++) {\n            var row = table.childWidgets[i];\n            for (var j = 0; j < row.childWidgets.length; j++) {\n                var cell = row.childWidgets[j];\n                var left = this.getCellLeft(row, cell);\n                if (HelperMethods.round(startIn, 2) <= HelperMethods.round(left, 2) &&\n                    HelperMethods.round(left, 2) < HelperMethods.round(endIn, 2)) {\n                    this.getCharacterFormatForSelectionCell(cell, startPosition, endPosition);\n                }\n            }\n        }\n    };\n    /**\n     * Get character format with in selection\n     * @private\n     */\n    Selection.prototype.getCharacterFormat = function (paragraph, start, end) {\n        if (paragraph !== start.paragraph && paragraph !== end.paragraph) {\n            this.getCharacterFormatInternal(paragraph, this);\n            return;\n        }\n        if (end.paragraph === paragraph && start.paragraph !== paragraph && end.offset === 0) {\n            return;\n        }\n        var startOffset = 0;\n        var length = this.getParagraphLength(paragraph);\n        if (paragraph === start.paragraph) {\n            startOffset = start.offset;\n            //Sets selection character format.            \n            var isUpdated = this.setCharacterFormat(paragraph, start, end, length);\n            if (isUpdated) {\n                return;\n            }\n        }\n        var startLineWidget = paragraph.childWidgets.indexOf(start.currentWidget) !== -1 ?\n            paragraph.childWidgets.indexOf(start.currentWidget) : 0;\n        var endLineWidget = paragraph.childWidgets.indexOf(end.currentWidget) !== -1 ?\n            paragraph.childWidgets.indexOf(end.currentWidget) : paragraph.childWidgets.length - 1;\n        var endOffset = end.offset;\n        if (paragraph !== end.paragraph) {\n            endOffset = length;\n        }\n        var isFieldStartSelected = false;\n        for (var i = startLineWidget; i <= endLineWidget; i++) {\n            var lineWidget = paragraph.childWidgets[i];\n            if (i !== startLineWidget) {\n                startOffset = this.getStartLineOffset(lineWidget);\n            }\n            if (lineWidget === end.currentWidget) {\n                endOffset = end.offset;\n            }\n            else {\n                endOffset = this.getLineLength(lineWidget);\n            }\n            var count = 0;\n            for (var j = 0; j < lineWidget.children.length; j++) {\n                var inline = lineWidget.children[j];\n                if (startOffset >= count + inline.length) {\n                    count += inline.length;\n                    continue;\n                }\n                if (inline instanceof FieldElementBox && inline.fieldType === 0\n                    && HelperMethods.isLinkedFieldCharacter(inline)) {\n                    var nextInline = isNullOrUndefined(inline.fieldSeparator) ?\n                        inline.fieldEnd : inline.fieldSeparator;\n                    do {\n                        count += inline.length;\n                        inline = inline.nextNode;\n                        i++;\n                    } while (!isNullOrUndefined(inline) && inline !== nextInline);\n                    isFieldStartSelected = true;\n                }\n                if (inline instanceof FieldElementBox && inline.fieldType === 1\n                    && HelperMethods.isLinkedFieldCharacter(inline) && isFieldStartSelected) {\n                    var fieldInline = inline.fieldBegin;\n                    do {\n                        this.characterFormat.combineFormat(fieldInline.characterFormat);\n                        fieldInline = fieldInline.nextNode;\n                    } while (!(fieldInline instanceof FieldElementBox));\n                }\n                if (inline instanceof TextElementBox) {\n                    this.characterFormat.combineFormat(inline.characterFormat);\n                }\n                if (isNullOrUndefined(inline) || endOffset <= count + inline.length) {\n                    break;\n                }\n                count += inline.length;\n            }\n        }\n        if (end.paragraph === paragraph) {\n            return;\n        }\n        var block = this.getNextRenderedBlock(paragraph);\n        if (!isNullOrUndefined(block)) {\n            this.getCharacterFormatForBlock(block, start, end);\n        }\n    };\n    Selection.prototype.setCharacterFormat = function (para, startPos, endPos, length) {\n        var index = 0;\n        var startOffset = startPos.offset;\n        var inlineAndIndex = startPos.currentWidget.getInline(startOffset, index);\n        index = inlineAndIndex.index;\n        var inline = inlineAndIndex.element;\n        if (isNullOrUndefined(inline)) {\n            var currentLineIndex = startPos.paragraph.childWidgets.indexOf(startPos.currentWidget);\n            if (startPos.currentWidget.previousLine) {\n                inline = startPos.currentWidget.previousLine.children[startPos.currentWidget.previousLine.children.length - 1];\n                this.characterFormat.copyFormat(inline.characterFormat);\n                return true;\n            }\n        }\n        if (startOffset < length) {\n            if (this.isEmpty) {\n                if (inline instanceof TextElementBox || (inline instanceof FieldElementBox\n                    && (inline.fieldType === 0 || inline.fieldType === 1))) {\n                    var previousNode = this.getPreviousTextElement(inline);\n                    if (startOffset === 0 && previousNode) {\n                        inline = previousNode;\n                    }\n                    this.characterFormat.copyFormat(inline.characterFormat);\n                }\n                else {\n                    if (!isNullOrUndefined(this.getPreviousTextElement(inline))) {\n                        this.characterFormat.copyFormat(this.getPreviousTextElement(inline).characterFormat);\n                    }\n                    else if (!isNullOrUndefined(this.getNextTextElement(inline))) {\n                        this.characterFormat.copyFormat(this.getNextTextElement(inline).characterFormat);\n                    }\n                    else {\n                        this.characterFormat.copyFormat(para.characterFormat);\n                    }\n                }\n                return true;\n            }\n            else {\n                if (index === inline.length && !isNullOrUndefined(inline.nextNode)) {\n                    this.characterFormat.copyFormat(this.getNextValidCharacterFormat(inline));\n                }\n                else if (inline instanceof TextElementBox) {\n                    this.characterFormat.copyFormat(inline.characterFormat);\n                }\n                else if (inline instanceof FieldElementBox) {\n                    this.characterFormat.copyFormat(this.getNextValidCharacterFormatOfField(inline));\n                }\n            }\n        }\n        else {\n            if (length === endPos.offset) {\n                if (inline instanceof TextElementBox || inline instanceof FieldElementBox) {\n                    this.characterFormat.copyFormat(inline.characterFormat);\n                }\n                else if (!isNullOrUndefined(inline)) {\n                    inline = this.getPreviousTextElement(inline);\n                    if (!isNullOrUndefined(inline)) {\n                        this.characterFormat.copyFormat(inline.characterFormat);\n                    }\n                }\n                else {\n                    this.characterFormat.copyFormat(para.characterFormat);\n                }\n                return true;\n            }\n        }\n        return false;\n    };\n    /**\n     * @private\n     */\n    Selection.prototype.getCharacterFormatForBlock = function (block, start, end) {\n        if (block instanceof ParagraphWidget) {\n            this.getCharacterFormat(block, start, end);\n        }\n        else {\n            this.getCharacterFormatInTable(block, start, end);\n        }\n    };\n    /**\n     * @private\n     */\n    Selection.prototype.getCharacterFormatInTable = function (table, start, end) {\n        for (var i = 0; i < table.childWidgets.length; i++) {\n            var row = table.childWidgets[i];\n            for (var j = 0; j < row.childWidgets.length; j++) {\n                this.getCharacterFormatForSelectionCell(row.childWidgets[j], start, end);\n            }\n            if (end.paragraph.isInsideTable && this.containsRow(row, end.paragraph.associatedCell)) {\n                return;\n            }\n        }\n        var blockAdv = this.getNextRenderedBlock(table);\n        // //Goto the next block.\n        this.getCharacterFormatForBlock(blockAdv, start, end);\n    };\n    /**\n     * Get character format in selection\n     * @private\n     */\n    Selection.prototype.getCharacterFormatForSelectionCell = function (cell, start, end) {\n        for (var i = 0; i < cell.childWidgets.length; i++) {\n            this.getCharacterFormatForBlock(cell.childWidgets[i], start, end);\n        }\n    };\n    /**\n     * @private\n     */\n    Selection.prototype.getCharacterFormatInternal = function (paragraph, selection) {\n        for (var i = 0; i < paragraph.childWidgets.length; i++) {\n            var linewidget = paragraph.childWidgets[i];\n            for (var j = 0; j < linewidget.children.length; j++) {\n                var element = linewidget.children[j];\n                if (!(element instanceof ImageElementBox || element instanceof FieldElementBox)) {\n                    selection.characterFormat.combineFormat(element.characterFormat);\n                }\n            }\n        }\n    };\n    /**\n     * Get next valid character format from inline\n     * @private\n     */\n    Selection.prototype.getNextValidCharacterFormat = function (inline) {\n        var startInline = this.getNextTextElement(inline);\n        if (isNullOrUndefined(startInline)) {\n            return inline.characterFormat;\n        }\n        var fieldBegin = undefined;\n        if (startInline instanceof FieldElementBox) {\n            if (fieldBegin.fieldType === 0) {\n                fieldBegin = startInline;\n            }\n        }\n        if (isNullOrUndefined(fieldBegin)) {\n            return startInline.characterFormat;\n        }\n        else {\n            return this.getNextValidCharacterFormatOfField(fieldBegin);\n        }\n    };\n    /**\n     * Get next valid paragraph format from field\n     * @private\n     */\n    Selection.prototype.getNextValidCharacterFormatOfField = function (fieldBegin) {\n        var startInline = fieldBegin;\n        if (HelperMethods.isLinkedFieldCharacter(fieldBegin)) {\n            if (isNullOrUndefined(fieldBegin.fieldSeparator)) {\n                startInline = fieldBegin.fieldEnd;\n            }\n            else {\n                startInline = fieldBegin.fieldSeparator;\n            }\n        }\n        var nextValidInline = undefined;\n        if (!isNullOrUndefined(startInline.nextNode)) {\n            //Check the next node is a valid and returns inline.\n            nextValidInline = this.getNextValidElement(startInline.nextNode);\n        }\n        //If field separator/end exists at end of paragraph, then move to next paragraph.\n        if (isNullOrUndefined(nextValidInline)) {\n            return startInline.characterFormat;\n        }\n        return nextValidInline.characterFormat;\n    };\n    /**\n     * Return true if cursor point with in selection range\n     * @private\n     */\n    Selection.prototype.checkCursorIsInSelection = function (widget, point) {\n        if (isNullOrUndefined(this.start) || this.isEmpty || isNullOrUndefined(widget)) {\n            return false;\n        }\n        var isSelected = false;\n        do {\n            if (this.selectedWidgets.containsKey(widget)) {\n                var top_4 = void 0;\n                var left = void 0;\n                if (widget instanceof LineWidget) {\n                    top_4 = this.owner.selection.getTop(widget);\n                    left = this.owner.selection.getLeft(widget);\n                }\n                else {\n                    top_4 = widget.y;\n                    left = widget.x;\n                }\n                var widgetInfo = this.selectedWidgets.get(widget);\n                isSelected = widgetInfo.left <= point.x && top_4 <= point.y &&\n                    top_4 + widget.height >= point.y && widgetInfo.left + widgetInfo.width >= point.x;\n            }\n            widget = (widget instanceof LineWidget) ? widget.paragraph : widget.containerWidget;\n        } while (!isNullOrUndefined(widget) && !isSelected);\n        return isSelected;\n    };\n    /**\n     * Copy paragraph for to selection paragraph format\n     * @private\n     */\n    Selection.prototype.copySelectionParagraphFormat = function () {\n        var format = new WParagraphFormat();\n        this.paragraphFormat.copyToFormat(format);\n        return format;\n    };\n    /**\n     * Get hyperlink display text\n     * @private\n     */\n    // tslint:disable-next-line\n    Selection.prototype.getHyperlinkDisplayText = function (paragraph, fieldSeparator, fieldEnd, isNestedField, format) {\n        var para = paragraph;\n        if (para !== fieldEnd.line.paragraph) {\n            isNestedField = true;\n            return { displayText: '<<Selection in Document>>', 'isNestedField': isNestedField, 'format': format };\n        }\n        var displayText = '';\n        var lineIndex = para.childWidgets.indexOf(fieldSeparator.line);\n        var index = para.childWidgets[lineIndex].children.indexOf(fieldSeparator);\n        for (var j = lineIndex; j < para.childWidgets.length; j++) {\n            var lineWidget = para.childWidgets[j];\n            if (j !== lineIndex) {\n                index = -1;\n            }\n            for (var i = index + 1; i < lineWidget.children.length; i++) {\n                var inline = lineWidget.children[i];\n                if (inline === fieldEnd) {\n                    return { 'displayText': displayText, 'isNestedField': isNestedField, 'format': format };\n                }\n                if (inline instanceof TextElementBox) {\n                    displayText += inline.text;\n                    format = inline.characterFormat;\n                }\n                else if (inline instanceof FieldElementBox) {\n                    if (inline instanceof FieldElementBox && inline.fieldType === 0\n                        && !isNullOrUndefined(inline.fieldEnd)) {\n                        if (isNullOrUndefined(inline.fieldSeparator)) {\n                            index = lineWidget.children.indexOf(inline.fieldEnd);\n                        }\n                        else {\n                            index = lineWidget.children.indexOf(inline.fieldSeparator);\n                        }\n                    }\n                }\n                else {\n                    isNestedField = true;\n                    return { 'displayText': '<<Selection in Document>>', 'isNestedField': isNestedField, 'format': format };\n                }\n            }\n        }\n        return { 'displayText': displayText, 'isNestedField': isNestedField, 'format': format };\n    };\n    /**\n     * Navigates hyperlink on mouse Event.\n     * @private\n     */\n    Selection.prototype.navigateHyperLinkOnEvent = function (cursorPoint, isTouchInput) {\n        var _this = this;\n        var widget = this.viewer.getLineWidget(cursorPoint);\n        if (!isNullOrUndefined(widget)) {\n            var hyperLinkField = this.getHyperLinkFieldInCurrentSelection(widget, cursorPoint);\n            //Invokes Hyperlink navigation events.\n            if (!isNullOrUndefined(hyperLinkField)) {\n                this.viewer.updateTextPositionForSelection(cursorPoint, 1);\n                this.fireRequestNavigate(hyperLinkField);\n                setTimeout(function () {\n                    if (_this.viewer) {\n                        _this.viewer.isTouchInput = isTouchInput;\n                        _this.viewer.updateFocus();\n                        _this.viewer.isTouchInput = false;\n                    }\n                });\n            }\n        }\n    };\n    /**\n     * @private\n     */\n    Selection.prototype.getLinkText = function (fieldBegin) {\n        var hyperlink = new Hyperlink(fieldBegin, this);\n        var link = hyperlink.navigationLink;\n        if (hyperlink.localReference.length > 0) {\n            if (hyperlink.localReference[0] === '_' && (isNullOrUndefined(link) || link.length === 0)) {\n                link = 'Current Document';\n            }\n            else {\n                link += '#' + hyperlink.localReference;\n            }\n        }\n        hyperlink.destroy();\n        return link;\n    };\n    /**\n     * Set Hyperlink content to tool tip element\n     * @private\n     */\n    Selection.prototype.setHyperlinkContentToToolTip = function (fieldBegin, widget, xPos) {\n        if (fieldBegin) {\n            if (this.owner.contextMenuModule &&\n                this.owner.contextMenuModule.contextMenuInstance.element.style.display === 'block') {\n                return;\n            }\n            if (!this.toolTipElement) {\n                this.toolTipElement = createElement('div', { className: 'e-de-tooltip' });\n                this.viewer.viewerContainer.appendChild(this.toolTipElement);\n            }\n            this.toolTipElement.style.display = 'block';\n            var l10n = new L10n('documenteditor', this.owner.defaultLocale);\n            l10n.setLocale(this.owner.locale);\n            var toolTipText = l10n.getConstant('Click to follow link');\n            if (this.owner.useCtrlClickToFollowHyperlink) {\n                toolTipText = 'Ctrl+' + toolTipText;\n            }\n            var linkText = this.getLinkText(fieldBegin);\n            this.toolTipElement.innerHTML = linkText + '</br><b>' + toolTipText + '</b>';\n            var widgetTop = this.getTop(widget) * this.viewer.zoomFactor;\n            var page = this.getPage(widget.paragraph);\n            var containerWidth = this.viewer.viewerContainer.getBoundingClientRect().width + this.viewer.viewerContainer.scrollLeft;\n            var left = page.boundingRectangle.x + xPos * this.viewer.zoomFactor;\n            if ((left + this.toolTipElement.clientWidth + 10) > containerWidth) {\n                left = left - ((this.toolTipElement.clientWidth - (containerWidth - left)) + 15);\n            }\n            var top_5 = this.getPageTop(page) + (widgetTop - this.toolTipElement.offsetHeight);\n            top_5 = top_5 > this.viewer.viewerContainer.scrollTop ? top_5 : top_5 + widget.height + this.toolTipElement.offsetHeight;\n            this.showToolTip(left, top_5);\n            if (!isNullOrUndefined(this.toolTipField) && fieldBegin !== this.toolTipField) {\n                this.toolTipObject.position = { X: left, Y: top_5 };\n            }\n            this.toolTipObject.show();\n            this.toolTipField = fieldBegin;\n        }\n        else {\n            this.hideToolTip();\n        }\n    };\n    /**\n     * Show hyperlink tooltip\n     * @private\n     */\n    Selection.prototype.showToolTip = function (x, y) {\n        if (!this.toolTipObject) {\n            this.toolTipObject = new Popup(this.toolTipElement, {\n                height: 'auto',\n                width: 'auto',\n                relateTo: this.viewer.viewerContainer.parentElement,\n                position: { X: x, Y: y }\n            });\n        }\n    };\n    /**\n     * Hide tooltip object\n     * @private\n     */\n    Selection.prototype.hideToolTip = function () {\n        this.toolTipField = undefined;\n        if (this.toolTipObject) {\n            this.toolTipObject.hide();\n            this.toolTipObject.destroy();\n            this.toolTipObject = undefined;\n            this.toolTipElement.style.display = 'none';\n        }\n    };\n    /**\n     * Return hyperlink field\n     * @private\n     */\n    Selection.prototype.getHyperLinkFieldInCurrentSelection = function (widget, cursorPosition) {\n        var inline = undefined;\n        var top = this.getTop(widget);\n        var lineStartLeft = this.getLineStartLeft(widget);\n        if (cursorPosition.y < top || cursorPosition.y > top + widget.height\n            || cursorPosition.x < lineStartLeft || cursorPosition.x > lineStartLeft + widget.paragraph.width) {\n            return undefined;\n        }\n        var left = widget.paragraph.x;\n        var elementValues = this.getFirstElement(widget, left);\n        left = elementValues.left;\n        var element = elementValues.element;\n        if (isNullOrUndefined(element)) {\n            var width = this.viewer.textHelper.getParagraphMarkWidth(widget.paragraph.characterFormat);\n            if (cursorPosition.x <= lineStartLeft + width || cursorPosition.x >= lineStartLeft + width) {\n                //Check if paragraph is within a field result.\n                var checkedFields = [];\n                var field = this.getHyperLinkFields(widget.paragraph, checkedFields);\n                checkedFields = [];\n                checkedFields = undefined;\n                return field;\n            }\n        }\n        else {\n            if (cursorPosition.x > left + element.margin.left) {\n                for (var i = widget.children.indexOf(element); i < widget.children.length; i++) {\n                    element = widget.children[i];\n                    if (cursorPosition.x < left + element.margin.left + element.width || i === widget.children.length - 1) {\n                        break;\n                    }\n                    left += element.margin.left + element.width;\n                }\n            }\n            inline = element;\n            var width = element.margin.left + element.width;\n            if (isNullOrUndefined(inline.nextNode)) {\n                //Include width of Paragraph mark.\n                width += this.viewer.textHelper.getParagraphMarkWidth(inline.line.paragraph.characterFormat);\n            }\n            if (cursorPosition.x <= left + width) {\n                //Check if inline is within a field result.\n                var checkedFields = [];\n                var field = this.getHyperLinkFieldInternal(inline.line.paragraph, inline, checkedFields);\n                checkedFields = [];\n                checkedFields = undefined;\n                return field;\n            }\n        }\n        return undefined;\n    };\n    /**\n     * Return field if paragraph contain hyperlink field\n     * @private\n     */\n    Selection.prototype.getHyperlinkField = function () {\n        if (isNullOrUndefined(this.end)) {\n            return undefined;\n        }\n        var index = 0;\n        var currentInline = this.end.currentWidget.getInline(this.end.offset, index);\n        index = currentInline.index;\n        var inline = currentInline.element;\n        var checkedFields = [];\n        var field = undefined;\n        if (isNullOrUndefined(inline)) {\n            field = this.getHyperLinkFields(this.end.paragraph, checkedFields);\n        }\n        else {\n            var paragraph = inline.line.paragraph;\n            field = this.getHyperLinkFieldInternal(paragraph, inline, checkedFields);\n        }\n        checkedFields = [];\n        return field;\n    };\n    /**\n     * @private\n     */\n    Selection.prototype.getHyperLinkFields = function (paragraph, checkedFields) {\n        for (var i = 0; i < this.viewer.fields.length; i++) {\n            if (checkedFields.indexOf(this.viewer.fields[i]) !== -1 || isNullOrUndefined(this.viewer.fields[i].fieldSeparator)) {\n                continue;\n            }\n            else {\n                checkedFields.push(this.viewer.fields[i]);\n            }\n            var field = this.getFieldCode(this.viewer.fields[i]);\n            field = field.trim().toLowerCase();\n            if (field.match('hyperlink ') && this.paragraphIsInFieldResult(this.viewer.fields[i], paragraph)) {\n                return this.viewer.fields[i];\n            }\n        }\n        // if (paragraph.containerWidget instanceof BodyWidget && !(paragraph instanceof WHeaderFooter)) {\n        //     return this.getHyperLinkFields((paragraph.con as WCompositeNode), checkedFields);\n        // }\n        return undefined;\n    };\n    /**\n     * @private\n     */\n    Selection.prototype.getHyperLinkFieldInternal = function (paragraph, inline, fields) {\n        for (var i = 0; i < this.viewer.fields.length; i++) {\n            if (fields.indexOf(this.viewer.fields[i]) !== -1 || isNullOrUndefined(this.viewer.fields[i].fieldSeparator)) {\n                continue;\n            }\n            else {\n                fields.push(this.viewer.fields[i]);\n            }\n            var fieldCode = this.getFieldCode(this.viewer.fields[i]);\n            fieldCode = fieldCode.trim().toLowerCase();\n            if (fieldCode.match('hyperlink ') && (this.inlineIsInFieldResult(this.viewer.fields[i], inline) || this.isImageField())) {\n                return this.viewer.fields[i];\n            }\n        }\n        if (paragraph.containerWidget instanceof BodyWidget && !(paragraph instanceof HeaderFooterWidget)) {\n            return this.getHyperLinkFieldInternal(paragraph.containerWidget, inline, fields);\n        }\n        return undefined;\n    };\n    /**\n     * @private\n     */\n    Selection.prototype.getBlock = function (currentIndex) {\n        if (currentIndex === '' || isNullOrUndefined(currentIndex)) {\n            return undefined;\n        }\n        var index = { index: currentIndex };\n        var page = this.start.getPage(index);\n        var bodyIndex = index.index.indexOf(';');\n        var value = index.index.substring(0, bodyIndex);\n        index.index = index.index.substring(bodyIndex).replace(';', '');\n        var bodyWidget = page.bodyWidgets[parseInt(value, 10)];\n        return this.getBlockInternal(bodyWidget, index.index);\n    };\n    /**\n     * Return Block relative to position\n     * @private\n     */\n    Selection.prototype.getBlockInternal = function (widget, position) {\n        if (position === '' || isNullOrUndefined(position)) {\n            return undefined;\n        }\n        var index = position.indexOf(';');\n        var value = position.substring(0, index);\n        position = position.substring(index).replace(';', '');\n        var node = widget;\n        // if (node instanceof Widget && value === 'HF') {\n        //     //Gets the block in Header footers.\n        //     let blockObj: BlockInfo = this.getBlock((node as WSection).headersFooters, position);\n        // tslint:disable-next-line:max-line-length\n        //     return { 'node': (!isNullOrUndefined(blockObj)) ? blockObj.node : undefined, 'position': (!isNullOrUndefined(blockObj)) ? blockObj.position : undefined };\n        // }\n        index = parseInt(value, 10);\n        if (index >= 0 && index < widget.childWidgets.length) {\n            var child = widget.childWidgets[(index)];\n            if (position.indexOf(';') >= 0) {\n                if (child instanceof ParagraphWidget) {\n                    if (position.indexOf(';') >= 0) {\n                        position = '0';\n                    }\n                    return child;\n                }\n                if (child instanceof BlockWidget) {\n                    var blockObj = this.getBlockInternal(child, position);\n                    return blockObj;\n                }\n            }\n            else {\n                return child;\n            }\n        }\n        else {\n            return node;\n        }\n        return node;\n    };\n    /**\n     * Return true if inline is in field result\n     * @private\n     */\n    Selection.prototype.inlineIsInFieldResult = function (fieldBegin, inline) {\n        if (!isNullOrUndefined(fieldBegin.fieldEnd) && !isNullOrUndefined(fieldBegin.fieldSeparator)) {\n            if (this.isExistBeforeInline(fieldBegin.fieldSeparator, inline)) {\n                return this.isExistAfterInline(fieldBegin.fieldEnd, inline);\n            }\n        }\n        return false;\n    };\n    /**\n     * Retrieve true if paragraph is in field result\n     * @private\n     */\n    Selection.prototype.paragraphIsInFieldResult = function (fieldBegin, paragraph) {\n        if (!isNullOrUndefined(fieldBegin.fieldEnd) && !isNullOrUndefined(fieldBegin.fieldSeparator)) {\n            var fieldParagraph = fieldBegin.fieldSeparator.line.paragraph;\n            if (fieldBegin.fieldSeparator.line.paragraph === paragraph\n                || this.isExistBefore(fieldParagraph, paragraph)) {\n                var currentParagraph = fieldBegin.fieldEnd.line.paragraph;\n                return (currentParagraph !== paragraph && this.isExistAfter(fieldParagraph, paragraph));\n            }\n        }\n        return false;\n    };\n    /**\n     * Return true if image is In field\n     * @private\n     */\n    Selection.prototype.isImageField = function () {\n        if (this.start.paragraph.isEmpty() || this.end.paragraph.isEmpty()) {\n            return false;\n        }\n        var startPosition = this.start;\n        var endPosition = this.end;\n        if (!this.isForward) {\n            startPosition = this.end;\n            endPosition = this.start;\n        }\n        var indexInInline = 0;\n        var inlineInfo = startPosition.paragraph.getInline(startPosition.offset, indexInInline);\n        var inline = inlineInfo.element;\n        indexInInline = inlineInfo.index;\n        if (indexInInline === inline.length) {\n            inline = this.getNextRenderedElementBox(inline, indexInInline);\n        }\n        inlineInfo = endPosition.paragraph.getInline(endPosition.offset, indexInInline);\n        var endInline = inlineInfo.element;\n        indexInInline = inlineInfo.index;\n        if (inline instanceof FieldElementBox && inline.fieldType === 0\n            && endInline instanceof FieldElementBox && endInline.fieldType === 1 && inline.fieldSeparator) {\n            var fieldValue = inline.fieldSeparator.nextNode;\n            if (fieldValue instanceof ImageElementBox && fieldValue.nextNode === endInline) {\n                return true;\n            }\n        }\n        return false;\n    };\n    /**\n     * Select List Text\n     * @private\n     */\n    Selection.prototype.selectListText = function () {\n        var lineWidget = this.viewer.selectionLineWidget;\n        var endOffset = '0';\n        var selectionIndex = lineWidget.getHierarchicalIndex(endOffset);\n        var startPosition = this.getTextPosition(selectionIndex);\n        var endPosition = this.getTextPosition(selectionIndex);\n        this.selectRange(startPosition, endPosition);\n        this.highlightListText(this.viewer.selectionLineWidget);\n        this.contextTypeInternal = 'List';\n    };\n    /**\n     * Manually select the list text\n     * @private\n     */\n    Selection.prototype.highlightListText = function (linewidget) {\n        var width = linewidget.children[0].width;\n        var left = this.viewer.getLeftValue(linewidget);\n        var top = linewidget.paragraph.y;\n        this.createHighlightBorder(linewidget, width, left, top);\n        this.viewer.isListTextSelected = true;\n    };\n    /**\n     * @private\n     */\n    Selection.prototype.updateImageSize = function (imageFormat) {\n        this.owner.isShiftingEnabled = true;\n        var startPosition = this.start;\n        var endPosition = this.end;\n        if (!this.isForward) {\n            startPosition = this.end;\n            endPosition = this.start;\n        }\n        var inline = null;\n        var index = 0;\n        var paragraph = startPosition.paragraph;\n        if (paragraph === endPosition.paragraph\n            && startPosition.offset + 1 === endPosition.offset) {\n            var inlineObj = paragraph.getInline(endPosition.offset, index);\n            inline = inlineObj.element;\n            index = inlineObj.index;\n        }\n        if (inline instanceof ImageElementBox) {\n            var width = inline.width;\n            var height = inline.height;\n            inline.width = imageFormat.width;\n            inline.height = imageFormat.height;\n            imageFormat.width = width;\n            imageFormat.height = height;\n            if (paragraph != null && paragraph.containerWidget != null && this.owner.editorModule) {\n                var lineIndex = paragraph.childWidgets.indexOf(inline.line);\n                var elementIndex = inline.line.children.indexOf(inline);\n                this.viewer.layout.reLayoutParagraph(paragraph, lineIndex, elementIndex);\n                this.highlightSelection(false);\n            }\n        }\n    };\n    /**\n     * Gets selected table content\n     * @private\n     */\n    Selection.prototype.getSelectedCellsInTable = function (table, startCell, endCell) {\n        var startColumnIndex = startCell.columnIndex;\n        var endColumnIndex = endCell.columnIndex + endCell.cellFormat.columnSpan - 1;\n        var startRowindex = startCell.ownerRow.index;\n        var endRowIndex = endCell.ownerRow.index;\n        var cells = [];\n        for (var i = 0; i < table.childWidgets.length; i++) {\n            var row = table.childWidgets[i];\n            if (row.index >= startRowindex && row.index <= endRowIndex) {\n                for (var j = 0; j < row.childWidgets.length; j++) {\n                    var cell = row.childWidgets[j];\n                    if (cell.columnIndex >= startColumnIndex && cell.columnIndex <= endColumnIndex) {\n                        cells.push(cell);\n                    }\n                }\n            }\n            if (row.index > endRowIndex) {\n                break;\n            }\n        }\n        return cells;\n        // return html;\n    };\n    /**\n     * Copies the selected content to clipboard.\n     */\n    Selection.prototype.copy = function () {\n        if (this.isEmpty) {\n            return;\n        }\n        this.copySelectedContent(false);\n    };\n    /**\n     * @private\n     */\n    Selection.prototype.copySelectedContent = function (isCut) {\n        if (isNullOrUndefined(this.owner.sfdtExportModule)) {\n            return;\n        }\n        var startPosition = this.start;\n        var endPosition = this.end;\n        if (!this.isForward) {\n            startPosition = this.end;\n            endPosition = this.start;\n        }\n        /* tslint:disable:no-any */\n        // tslint:disable-next-line:max-line-length\n        var document = this.owner.sfdtExportModule.write(startPosition.currentWidget, startPosition.offset, endPosition.currentWidget, endPosition.offset, true);\n        /* tslint:enable:no-any */\n        if (this.owner.editorModule) {\n            this.owner.editorModule.copiedData = JSON.stringify(document);\n        }\n        var html = this.htmlWriter.writeHtml(document);\n        this.copyToClipboard(html);\n        if (isCut && this.owner.editorModule) {\n            this.owner.editorModule.handleCut(this);\n        }\n        this.viewer.updateFocus();\n    };\n    /**\n     * Copy content to clipboard\n     * @private\n     */\n    Selection.prototype.copyToClipboard = function (htmlContent) {\n        window.getSelection().removeAllRanges();\n        var div = document.createElement('div');\n        div.style.left = '-10000px';\n        div.style.top = '-10000px';\n        div.innerHTML = htmlContent;\n        document.body.appendChild(div);\n        var range = document.createRange();\n        range.selectNodeContents(div);\n        window.getSelection().addRange(range);\n        var copySuccess = false;\n        try {\n            copySuccess = document.execCommand('copy');\n        }\n        catch (e) {\n            // Copying data to Clipboard can potentially fail - for example, if another application is holding Clipboard open.\n        }\n        finally {\n            window.getSelection().removeAllRanges();\n            div.parentNode.removeChild(div);\n            this.viewer.viewerContainer.focus();\n        }\n        return copySuccess;\n    };\n    // Caret implementation starts\n    /**\n     * Shows caret in current selection position.\n     * @private\n     */\n    Selection.prototype.showCaret = function () {\n        // tslint:disable-next-line:max-line-length\n        var page = !isNullOrUndefined(this.viewer.currentPage) ? this.viewer.currentPage : this.viewer.currentRenderingPage;\n        if (isNullOrUndefined(page) || this.viewer.isRowOrCellResizing || this.owner.enableImageResizerMode && this.owner.imageResizerModule.isImageResizerVisible) {\n            return;\n        }\n        var left = page.boundingRectangle.x;\n        var right = page.boundingRectangle.width * this.viewer.zoomFactor + left;\n        if (!this.owner.enableImageResizerMode || !this.owner.imageResizerModule.isImageResizerVisible) {\n            // tslint:disable-next-line:max-line-length\n            if (this.isEmpty && (!this.owner.isReadOnlyMode || this.owner.enableCursorOnReadOnly)) {\n                var caretLeft = parseInt(this.caret.style.left.replace('px', ''), 10);\n                if (caretLeft < left || caretLeft > right) {\n                    this.caret.style.display = 'none';\n                }\n                else {\n                    this.caret.style.display = 'block';\n                }\n            }\n            else if (this.isImageSelected && !this.owner.enableImageResizerMode) {\n                this.caret.style.display = 'block';\n            }\n            else {\n                if (this.caret.style.display === 'block' || isNullOrUndefined(this)) {\n                    this.caret.style.display = 'none';\n                }\n            }\n        }\n        if (!isNullOrUndefined(this) && this.viewer.isTouchInput && !this.owner.isReadOnlyMode) {\n            var caretStartLeft = parseInt(this.viewer.touchStart.style.left.replace('px', ''), 10) + 14;\n            var caretEndLeft = parseInt(this.viewer.touchEnd.style.left.replace('px', ''), 10) + 14;\n            var page_1 = this.getSelectionPage(this.start);\n            if (page_1) {\n                if (caretEndLeft < left || caretEndLeft > right) {\n                    this.viewer.touchEnd.style.display = 'none';\n                }\n                else {\n                    this.viewer.touchEnd.style.display = 'block';\n                }\n                if (!this.isEmpty) {\n                    left = page_1.boundingRectangle.x;\n                    right = page_1.boundingRectangle.width * this.viewer.zoomFactor + left;\n                }\n                if (caretStartLeft < left || caretStartLeft > right) {\n                    this.viewer.touchStart.style.display = 'none';\n                }\n                else {\n                    this.viewer.touchStart.style.display = 'block';\n                }\n            }\n        }\n        else {\n            this.viewer.touchStart.style.display = 'none';\n            this.viewer.touchEnd.style.display = 'none';\n        }\n    };\n    /**\n     * To set the editable div caret position\n     * @private\n     */\n    Selection.prototype.setEditableDivCaretPosition = function (index) {\n        this.viewer.editableDiv.focus();\n        var child = this.viewer.editableDiv.childNodes[this.viewer.editableDiv.childNodes.length - 1];\n        if (child) {\n            var range = document.createRange();\n            range.setStart(child, index);\n            range.collapse(true);\n            window.getSelection().removeAllRanges();\n            window.getSelection().addRange(range);\n        }\n    };\n    /**\n     * Initializes caret.\n     * @private\n     */\n    Selection.prototype.initCaret = function () {\n        this.caret = createElement('div', {\n            styles: 'position:absolute',\n            className: 'e-de-blink-cursor e-de-cursor-animation'\n        });\n        this.viewer.viewerContainer.appendChild(this.caret);\n    };\n    /**\n     * Updates caret position.\n     * @private\n     */\n    Selection.prototype.updateCaretPosition = function () {\n        var caretPosition = this.end.location;\n        var page = this.getSelectionPage(this.end);\n        if (page) {\n            this.caret.style.left = page.boundingRectangle.x + (Math.round(caretPosition.x) * this.viewer.zoomFactor) + 'px';\n            var caretInfo = this.updateCaretSize(this.owner.selection.end);\n            var topMargin = caretInfo.topMargin;\n            var caretHeight = caretInfo.height;\n            var viewer = this.viewer;\n            // tslint:disable-next-line:max-line-length\n            var pageTop = (page.boundingRectangle.y - viewer.pageGap * (this.viewer.pages.indexOf(page) + 1)) * this.viewer.zoomFactor + viewer.pageGap * (this.viewer.pages.indexOf(page) + 1);\n            this.caret.style.top = pageTop + (Math.round(caretPosition.y + topMargin) * this.viewer.zoomFactor) + 'px';\n            if (this.owner.selection.characterFormat.baselineAlignment === 'Subscript') {\n                this.caret.style.top = parseFloat(this.caret.style.top) + (parseFloat(this.caret.style.height) / 2) + 'px';\n            }\n            if (this.viewer.isTouchInput || this.viewer.touchStart.style.display !== 'none') {\n                // tslint:disable-next-line:max-line-length\n                this.viewer.touchStart.style.left = page.boundingRectangle.x + (Math.round(caretPosition.x) * this.viewer.zoomFactor - 14) + 'px';\n                this.viewer.touchStart.style.top = pageTop + ((caretPosition.y + caretInfo.height) * this.viewer.zoomFactor) + 'px';\n                // tslint:disable-next-line:max-line-length\n                this.viewer.touchEnd.style.left = page.boundingRectangle.x + (Math.round(caretPosition.x) * this.viewer.zoomFactor - 14) + 'px';\n                this.viewer.touchEnd.style.top = pageTop + ((caretPosition.y + caretInfo.height) * this.viewer.zoomFactor) + 'px';\n            }\n        }\n    };\n    /**\n     * Gets current selected page\n     */\n    Selection.prototype.getSelectionPage = function (position) {\n        var lineWidget = this.getLineWidgetInternal(position.currentWidget, position.offset, true);\n        if (lineWidget) {\n            return this.getPage(lineWidget.paragraph);\n        }\n        return undefined;\n    };\n    /**\n     * Updates caret size.\n     * @private\n     */\n    Selection.prototype.updateCaretSize = function (textPosition, skipUpdate) {\n        var topMargin = 0;\n        var isItalic = false;\n        var caret;\n        var index = 0;\n        var caretHeight = 0;\n        if (this.characterFormat.italic) {\n            isItalic = this.characterFormat.italic;\n        }\n        if (textPosition.paragraph.isEmpty()) {\n            var paragraph = textPosition.paragraph;\n            var bottomMargin = 0;\n            var paragraphInfo = this.getParagraphMarkSize(paragraph, topMargin, bottomMargin);\n            topMargin = paragraphInfo.topMargin;\n            bottomMargin = paragraphInfo.bottomMargin;\n            var height = paragraphInfo.height;\n            caretHeight = topMargin < 0 ? topMargin + height : height;\n            if (!skipUpdate) {\n                this.caret.style.height = caretHeight * this.viewer.zoomFactor + 'px';\n            }\n            topMargin = 0;\n        }\n        else {\n            var inlineInfo = textPosition.currentWidget.getInline(textPosition.offset, index);\n            index = inlineInfo.index;\n            var inline = inlineInfo.element;\n            if (!isNullOrUndefined(inline)) {\n                caret = this.getCaretHeight(inline, index, inline.characterFormat, true, topMargin, isItalic);\n                caretHeight = caret.height;\n                if (!skipUpdate) {\n                    this.caret.style.height = caret.height * this.viewer.zoomFactor + 'px';\n                }\n            }\n        }\n        if (!skipUpdate) {\n            if (isItalic) {\n                this.caret.style.transform = 'rotate(13deg)';\n            }\n            else {\n                this.caret.style.transform = '';\n            }\n        }\n        return {\n            'topMargin': topMargin,\n            'height': caretHeight\n        };\n    };\n    /**\n     * Updates caret to page.\n     * @private\n     */\n    Selection.prototype.updateCaretToPage = function (startPosition, endPage) {\n        if (!isNullOrUndefined(endPage)) {\n            this.viewer.selectionEndPage = endPage;\n            if (this.owner.selection.isEmpty) {\n                this.viewer.selectionStartPage = endPage;\n            }\n            else {\n                // tslint:disable-next-line:max-line-length\n                var startLineWidget = this.getLineWidgetParagraph(startPosition.offset, startPosition.paragraph.childWidgets[0]);\n                //Gets start page.\n                var startPage = this.getPage(startLineWidget.paragraph);\n                if (!isNullOrUndefined(startPage)) {\n                    this.viewer.selectionStartPage = startPage;\n                }\n            }\n        }\n        this.checkForCursorVisibility();\n    };\n    /**\n     * Gets caret bottom position.\n     * @private\n     */\n    Selection.prototype.getCaretBottom = function (textPosition, isEmptySelection) {\n        var bottom = textPosition.location.y;\n        if (textPosition.paragraph.isEmpty()) {\n            var paragraph = textPosition.paragraph;\n            var topMargin = 0;\n            var bottomMargin = 0;\n            var sizeInfo = this.getParagraphMarkSize(paragraph, topMargin, bottomMargin);\n            topMargin = sizeInfo.topMargin;\n            bottomMargin = sizeInfo.bottomMargin;\n            bottom += sizeInfo.height;\n            bottom += topMargin;\n            if (!isEmptySelection) {\n                bottom += bottomMargin;\n            }\n        }\n        else {\n            var index = 0;\n            var inlineInfo = textPosition.paragraph.getInline(textPosition.offset, index);\n            var inline = inlineInfo.element;\n            index = inlineInfo.index;\n            var topMargin = 0;\n            var isItalic = false;\n            // tslint:disable-next-line:max-line-length\n            var caretHeightInfo = this.getCaretHeight(inline, index, inline.characterFormat, false, topMargin, isItalic);\n            topMargin = caretHeightInfo.topMargin;\n            isItalic = caretHeightInfo.isItalic;\n            bottom += caretHeightInfo.height;\n            if (isEmptySelection) {\n                bottom -= HelperMethods.convertPointToPixel(textPosition.paragraph.paragraphFormat.afterSpacing);\n            }\n        }\n        return bottom;\n    };\n    /**\n     * Checks for cursor visibility.\n     * @param isTouch\n     * @private\n     */\n    Selection.prototype.checkForCursorVisibility = function () {\n        this.showCaret();\n    };\n    // caret implementation ends\n    /**\n     * Keyboard shortcuts\n     * @private\n     */\n    // tslint:disable:max-func-body-length\n    Selection.prototype.onKeyDownInternal = function (event, ctrl, shift, alt) {\n        var key = event.which || event.keyCode;\n        if (ctrl && !shift && !alt) {\n            this.viewer.isControlPressed = true;\n            switch (key) {\n                // case 9:\n                //     event.preventDefault();\n                //     if (this.owner.acceptTab) {\n                //         this.selection.handleTabKey(false, false);\n                //     }\n                //     break;\n                case 35:\n                    this.handleControlEndKey();\n                    break;\n                case 36:\n                    this.handleControlHomeKey();\n                    break;\n                case 37:\n                    this.handleControlLeftKey();\n                    break;\n                case 38:\n                    this.handleControlUpKey();\n                    break;\n                case 39:\n                    this.handleControlRightKey();\n                    break;\n                case 40:\n                    this.handleControlDownKey();\n                    break;\n                case 65:\n                    this.owner.selection.selectAll();\n                    break;\n                case 67:\n                    event.preventDefault();\n                    this.copy();\n                    break;\n                case 70:\n                    event.preventDefault();\n                    if (!isNullOrUndefined(this.owner.optionsPaneModule)) {\n                        this.owner.optionsPaneModule.showHideOptionsPane(true);\n                    }\n                    break;\n            }\n        }\n        else if (shift && !ctrl && !alt) {\n            switch (key) {\n                case 35:\n                    this.handleShiftEndKey();\n                    event.preventDefault();\n                    break;\n                case 36:\n                    this.handleShiftHomeKey();\n                    event.preventDefault();\n                    break;\n                case 37:\n                    this.handleShiftLeftKey();\n                    event.preventDefault();\n                    break;\n                case 38:\n                    this.handleShiftUpKey();\n                    event.preventDefault();\n                    break;\n                case 39:\n                    this.handleShiftRightKey();\n                    event.preventDefault();\n                    break;\n                case 40:\n                    this.handleShiftDownKey();\n                    event.preventDefault();\n                    break;\n            }\n        }\n        else if (shift && ctrl && !alt) {\n            switch (key) {\n                case 35:\n                    this.handleControlShiftEndKey();\n                    break;\n                case 36:\n                    this.handleControlShiftHomeKey();\n                    break;\n                case 37:\n                    this.handleControlShiftLeftKey();\n                    break;\n                case 38:\n                    this.handleControlShiftUpKey();\n                    break;\n                case 39:\n                    this.handleControlShiftRightKey();\n                    break;\n                case 40:\n                    this.handleControlShiftDownKey();\n                    break;\n            }\n        }\n        else {\n            switch (key) {\n                // case 9:\n                //     event.preventDefault();\n                //     if (this.owner.acceptTab) {\n                //         this.handleTabKey(true, false);\n                //     }\n                //     break;             \n                case 33:\n                    event.preventDefault();\n                    this.viewer.viewerContainer.scrollTop -= this.viewer.visibleBounds.height;\n                    break;\n                case 34:\n                    event.preventDefault();\n                    this.viewer.viewerContainer.scrollTop += this.viewer.visibleBounds.height;\n                    break;\n                case 35:\n                    this.handleEndKey();\n                    event.preventDefault();\n                    break;\n                case 36:\n                    this.handleHomeKey();\n                    event.preventDefault();\n                    break;\n                case 37:\n                    this.handleLeftKey();\n                    event.preventDefault();\n                    break;\n                case 38:\n                    this.handleUpKey();\n                    event.preventDefault();\n                    break;\n                case 39:\n                    this.handleRightKey();\n                    event.preventDefault();\n                    break;\n                case 40:\n                    this.handleDownKey();\n                    event.preventDefault();\n                    break;\n            }\n        }\n        if (!this.owner.isReadOnlyMode) {\n            this.owner.editorModule.onKeyDownInternal(event, ctrl, shift, alt);\n        }\n        if (this.owner.searchModule) {\n            // tslint:disable-next-line:max-line-length\n            if (!isNullOrUndefined(this.owner.searchModule.searchHighlighters) && this.owner.searchModule.searchHighlighters.length > 0) {\n                this.owner.searchModule.searchResults.clear();\n            }\n        }\n        if (event.keyCode === 27 || event.which === 27) {\n            if (!isNullOrUndefined(this.owner.optionsPaneModule)) {\n                this.owner.optionsPaneModule.showHideOptionsPane(false);\n            }\n            if (this.owner.enableHeaderAndFooter) {\n                this.disableHeaderFooter();\n            }\n        }\n    };\n    //#region Enable or disable Header Footer\n    /**\n     * @private\n     */\n    Selection.prototype.checkAndEnableHeaderFooter = function (point, pagePoint) {\n        var page = this.viewer.currentPage;\n        if (this.isCursorInsidePageRect(point, page)) {\n            if (this.isCursorInHeaderRegion(point, page)) {\n                if (this.owner.enableHeaderAndFooter) {\n                    return false;\n                }\n                return this.enableHeadersFootersRegion(page.headerWidget);\n            }\n            if (this.isCursorInFooterRegion(point, page)) {\n                if (this.owner.enableHeaderAndFooter) {\n                    return false;\n                }\n                return this.enableHeadersFootersRegion(page.footerWidget);\n            }\n        }\n        if (this.owner.enableHeaderAndFooter) {\n            this.owner.enableHeaderAndFooter = false;\n            this.viewer.updateTextPositionForSelection(pagePoint, 1);\n            return true;\n        }\n        return false;\n    };\n    /**\n     * @private\n     */\n    Selection.prototype.isCursorInsidePageRect = function (point, page) {\n        if ((this.viewer.containerLeft + point.x) >= page.boundingRectangle.x &&\n            (this.viewer.containerLeft + point.x) <= (page.boundingRectangle.x + (page.boundingRectangle.width * this.viewer.zoomFactor))) {\n            return true;\n        }\n        return false;\n    };\n    /**\n     * @private\n     */\n    Selection.prototype.isCursorInHeaderRegion = function (point, page) {\n        var pageTop = this.getPageTop(page);\n        var headerHeight = 0;\n        if (page.headerWidget) {\n            headerHeight = (page.headerWidget.y + page.headerWidget.height);\n        }\n        var height = Math.max(headerHeight, HelperMethods.convertPointToPixel(page.bodyWidgets[0].sectionFormat.topMargin))\n            * this.viewer.zoomFactor;\n        if ((this.viewer.containerTop + point.y) >= pageTop && (this.viewer.containerTop + point.y) <= pageTop + height) {\n            return true;\n        }\n        return false;\n    };\n    /**\n     * @private\n     */\n    Selection.prototype.isCursorInFooterRegion = function (point, page) {\n        var pageRect = page.boundingRectangle;\n        var pageTop = this.getPageTop(page);\n        var pageBottom = pageTop + (pageRect.height * this.viewer.zoomFactor);\n        var footerDistance = HelperMethods.convertPointToPixel(page.bodyWidgets[0].sectionFormat.footerDistance);\n        var footerHeight = 0;\n        if (page.footerWidget) {\n            footerHeight = page.footerWidget.height;\n        }\n        // tslint:disable-next-line:max-line-length\n        var height = (pageRect.height -\n            Math.max(footerHeight + footerDistance, HelperMethods.convertPointToPixel(page.bodyWidgets[0].sectionFormat.bottomMargin))) * this.viewer.zoomFactor;\n        if ((this.viewer.containerTop + point.y) <= pageBottom && (this.viewer.containerTop + point.y) >= pageTop + height) {\n            return true;\n        }\n        return false;\n    };\n    /**\n     * @private\n     */\n    Selection.prototype.enableHeadersFootersRegion = function (widget) {\n        this.owner.enableHeaderAndFooter = true;\n        this.updateTextPositionForBlockContainer(widget);\n        return true;\n    };\n    /**\n     * @private\n     */\n    Selection.prototype.updateTextPositionForBlockContainer = function (widget) {\n        var block = widget.firstChild;\n        if (block instanceof TableWidget) {\n            block = this.getFirstBlockInFirstCell(block);\n        }\n        this.selectParagraph(block, true);\n    };\n    /**\n     * Disable Header footer\n     * @private\n     */\n    Selection.prototype.disableHeaderFooter = function () {\n        var page = this.getPage(this.start.paragraph);\n        this.updateTextPositionForBlockContainer(page.bodyWidgets[0]);\n        this.owner.enableHeaderAndFooter = false;\n    };\n    //#endregion\n    /**\n     * @private\n     */\n    Selection.prototype.destroy = function () {\n        if (!isNullOrUndefined(this.contextTypeInternal)) {\n            this.contextTypeInternal = undefined;\n        }\n        this.caret = undefined;\n        this.contextTypeInternal = undefined;\n        this.upDownSelectionLength = undefined;\n        this.viewer = undefined;\n        this.owner = undefined;\n    };\n    /**\n     * Navigates to the specified bookmark.\n     * @param name\n     * @param moveToStart\n     * @private\n     */\n    Selection.prototype.navigateBookmark = function (name, moveToStart) {\n        var bookmarks = this.viewer.bookmarks;\n        if (bookmarks.containsKey(name)) {\n            //bookmark start element\n            var bookmrkElmnt = bookmarks.get(name);\n            var offset = bookmrkElmnt.line.getOffset(bookmrkElmnt, 1);\n            var startPosition = new TextPosition(this.viewer.owner);\n            startPosition.setPositionParagraph(bookmrkElmnt.line, offset);\n            if (moveToStart) {\n                this.viewer.selection.selectRange(startPosition, startPosition);\n            }\n            else {\n                //bookmark end element\n                var bookmrkEnd = bookmrkElmnt.reference;\n                var endoffset = bookmrkEnd.line.getOffset(bookmrkEnd, 0);\n                var endPosition = new TextPosition(this.viewer.owner);\n                endPosition.setPositionParagraph(bookmrkEnd.line, endoffset);\n                //selects the bookmark range\n                this.viewer.selection.selectRange(startPosition, endPosition);\n            }\n        }\n    };\n    /**\n     * Selects the specified bookmark.\n     * @param name\n     */\n    Selection.prototype.selectBookmark = function (name) {\n        this.navigateBookmark(name);\n    };\n    /**\n     * Returns the toc field from the selection.\n     * @private\n     */\n    Selection.prototype.getTocField = function () {\n        var paragraph = this.start.paragraph;\n        var tocPara = undefined;\n        while ((paragraph !== undefined && this.isTocStyle(paragraph))) {\n            tocPara = paragraph;\n            paragraph = paragraph.previousRenderedWidget;\n        }\n        if (tocPara !== undefined) {\n            var lineWidget = tocPara.childWidgets[0];\n            if (lineWidget !== undefined) {\n                return lineWidget.children[0];\n            }\n        }\n        return undefined;\n    };\n    /**\n     * Returns true if the paragraph has toc style.\n     */\n    Selection.prototype.isTocStyle = function (paragraph) {\n        var style = paragraph.paragraphFormat.baseStyle;\n        return (style !== undefined && (style.name.toLowerCase().indexOf('toc') !== -1));\n    };\n    return Selection;\n}());\nexport { Selection };\n","import { Dictionary } from '../../base/dictionary';\nimport { isNullOrUndefined } from '@syncfusion/ej2-base';\nimport { TextPosition } from '../selection/selection-helper';\nimport { TextElementBox, ParagraphWidget, ListTextElementBox, FieldElementBox } from '../viewer/page';\n/**\n * @private\n */\nvar TextSearch = /** @class */ (function () {\n    function TextSearch(owner) {\n        this.wordBefore = '\\\\b';\n        this.wordAfter = '\\\\b';\n        this.isHeader = false;\n        this.isFooter = false;\n        this.owner = owner;\n    }\n    Object.defineProperty(TextSearch.prototype, \"viewer\", {\n        get: function () {\n            return this.owner.viewer;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    TextSearch.prototype.find = function (pattern, findOption) {\n        return this.findNext(pattern, findOption, '0;0;0');\n    };\n    // tslint:disable-next-line:max-line-length   \n    TextSearch.prototype.findNext = function (pattern, findOption, hierarchicalPosition) {\n        if (typeof pattern === 'string') {\n            pattern = this.stringToRegex(pattern, findOption);\n        }\n        if (hierarchicalPosition === undefined) {\n            hierarchicalPosition = '0;0;0';\n        }\n        this.owner.searchModule.textSearchResults.clearResults();\n        var results = this.owner.searchModule.textSearchResults;\n        this.findDocument(results, pattern, true, findOption, hierarchicalPosition);\n        return results.length > 0, results.currentSearchResult;\n    };\n    TextSearch.prototype.stringToRegex = function (textToFind, option) {\n        if (textToFind.indexOf('\\\\') > -1) {\n            textToFind = textToFind.split('\\\\').join('\\\\\\\\');\n        }\n        if (textToFind.indexOf('.') > -1) {\n            textToFind = '\\\\' + textToFind;\n        }\n        if (option === 'WholeWord' || option === 'CaseSensitiveWholeWord') {\n            textToFind = this.wordBefore + textToFind + this.wordAfter;\n        }\n        return new RegExp(textToFind, (option === 'CaseSensitive' || option === 'CaseSensitiveWholeWord') ? 'g' : 'ig');\n    };\n    TextSearch.prototype.isPatternEmpty = function (pattern) {\n        var wordEmpty = this.wordBefore + this.wordAfter;\n        var patternRegExp = pattern.toString();\n        return (patternRegExp.length === 0 || patternRegExp === wordEmpty);\n    };\n    // tslint:disable-next-line:max-line-length     \n    TextSearch.prototype.findAll = function (pattern, findOption, hierarchicalPosition) {\n        if (typeof pattern === 'string') {\n            pattern = this.stringToRegex(pattern, findOption);\n        }\n        if (hierarchicalPosition === undefined) {\n            hierarchicalPosition = '0;0;0';\n        }\n        this.owner.searchModule.textSearchResults.clearResults();\n        var results = this.owner.searchModule.textSearchResults;\n        this.findDocument(results, pattern, false, findOption, hierarchicalPosition);\n        if (results.length > 0 && results.currentIndex < 0) {\n            results.currentIndex = 0;\n        }\n        if (!isNullOrUndefined(results.currentSearchResult)) {\n            var eventArgs = { source: this.viewer.owner };\n            this.viewer.owner.trigger('searchResultsChange', eventArgs);\n            return results;\n        }\n        return undefined;\n    };\n    // tslint:disable-next-line:max-line-length     \n    TextSearch.prototype.findDocument = function (results, pattern, isFirstMatch, findOption, hierachicalPosition) {\n        if (this.isPatternEmpty(pattern)) {\n            return;\n        }\n        if (findOption === undefined) {\n            findOption = 'None';\n        }\n        var inline = undefined;\n        var selectionEnd = undefined;\n        if (hierachicalPosition !== undefined) {\n            selectionEnd = this.owner.selection.end;\n        }\n        if (hierachicalPosition !== undefined && isFirstMatch && selectionEnd !== undefined && selectionEnd.paragraph !== undefined) {\n            if (selectionEnd.paragraph instanceof ParagraphWidget) {\n                var indexInInline = 0;\n                // tslint:disable-next-line:max-line-length \n                // IndexInInline Handled specifically for simple find operation to start from starting point\n                var inlineElement = selectionEnd.currentWidget.getInline(this.owner.selection.start.offset, indexInInline);\n                inline = inlineElement.element;\n                indexInInline = inlineElement.index;\n                if (!isNullOrUndefined(inline)) {\n                    var nextParagraphWidget = undefined;\n                    // tslint:disable-next-line:max-line-length  \n                    nextParagraphWidget = this.findInline(inline, pattern, findOption, indexInInline, isFirstMatch, results, selectionEnd);\n                    while (results.length === 0 && !isNullOrUndefined(nextParagraphWidget)) {\n                        while (!isNullOrUndefined(nextParagraphWidget) && nextParagraphWidget.childWidgets.length === 0) {\n                            // tslint:disable-next-line:max-line-length \n                            nextParagraphWidget = this.owner.selection.getNextParagraph(nextParagraphWidget.containerWidget);\n                        }\n                        if (isNullOrUndefined(nextParagraphWidget)) {\n                            break;\n                        }\n                        var lineWidget = nextParagraphWidget.childWidgets[0];\n                        if (lineWidget.children[0] instanceof ListTextElementBox) {\n                            inline = (lineWidget.children[2] instanceof TextElementBox) ? lineWidget.children[2] : undefined;\n                        }\n                        else {\n                            inline = lineWidget.children[0];\n                        }\n                        if (isNullOrUndefined(inline)) {\n                            break;\n                        }\n                        // tslint:disable-next-line:max-line-length  \n                        nextParagraphWidget = this.findInline(inline, pattern, findOption, 0, isFirstMatch, results, selectionEnd);\n                    }\n                    if (results.length > 0) {\n                        return;\n                    }\n                }\n            }\n        }\n        var section;\n        section = this.viewer.pages[0].bodyWidgets[0];\n        while (!isNullOrUndefined(section) && section.childWidgets.length === 0) {\n            section = section.nextWidget;\n        }\n        if (isNullOrUndefined(section) || section.childWidgets.length === 0) {\n            return;\n        }\n        this.isHeader = false;\n        this.isFooter = false;\n        this.findInlineText(section, pattern, findOption, isFirstMatch, results, selectionEnd);\n        for (var i = 0; i < this.viewer.pages.length; i++) {\n            var headerWidget = this.viewer.pages[i].headerWidget;\n            if (!isNullOrUndefined(headerWidget)) {\n                this.isHeader = true;\n                this.isFooter = false;\n                this.findInlineText(headerWidget, pattern, findOption, isFirstMatch, results, selectionEnd);\n            }\n        }\n        for (var i = 0; i < this.viewer.pages.length; i++) {\n            var footerWidget = this.viewer.pages[i].footerWidget;\n            if (!isNullOrUndefined(footerWidget)) {\n                this.isHeader = false;\n                this.isFooter = true;\n                this.findInlineText(footerWidget, pattern, findOption, isFirstMatch, results, selectionEnd);\n            }\n        }\n        if (isFirstMatch && !isNullOrUndefined(results) && results.length > 0) {\n            return;\n        }\n    };\n    // tslint:disable-next-line:max-line-length\n    TextSearch.prototype.findInlineText = function (section, pattern, findOption, isFirstMatch, results, selectionEnd) {\n        var paragraphWidget = this.owner.selection.getFirstParagraphBlock(section.childWidgets[0]);\n        // tslint:disable-next-line:max-line-length \n        while (!isNullOrUndefined(paragraphWidget) && paragraphWidget.childWidgets.length === 1 && paragraphWidget.childWidgets[0].children.length === 0) {\n            paragraphWidget = this.owner.selection.getNextParagraphBlock(paragraphWidget);\n        }\n        while (!isNullOrUndefined(paragraphWidget) && paragraphWidget.childWidgets.length > 0) {\n            var inlineElement = paragraphWidget.childWidgets[0];\n            var inlineEle = inlineElement.children[0];\n            if (isNullOrUndefined(inlineEle)) {\n                break;\n            }\n            this.findInline(inlineEle, pattern, findOption, 0, isFirstMatch, results, selectionEnd);\n            paragraphWidget = this.owner.selection.getNextParagraphBlock(paragraphWidget);\n            // tslint:disable-next-line:max-line-length \n            while (!isNullOrUndefined(paragraphWidget) && (paragraphWidget.childWidgets.length === 1) && paragraphWidget.childWidgets[0].children.length === 0) {\n                paragraphWidget = this.owner.selection.getNextParagraphBlock(paragraphWidget);\n            }\n        }\n        if (isFirstMatch && !isNullOrUndefined(results) && results.length > 0) {\n            return;\n        }\n    };\n    // tslint:disable-next-line:max-line-length     \n    TextSearch.prototype.findInline = function (inlineElement, pattern, option, indexInInline, isFirstMatch, results, selectionEnd) {\n        var inlines = inlineElement;\n        var stringBuilder = '';\n        var spans = new Dictionary();\n        //tslint:disable no-constant-condition\n        do {\n            // tslint:disable-next-line:max-line-length \n            if (inlineElement instanceof TextElementBox && (!isNullOrUndefined(inlineElement.text) && inlineElement.text !== '')) {\n                spans.add(inlineElement, stringBuilder.length);\n                // IndexInInline Handled specifically for simple find operation to start from starting point\n                if (inlineElement === inlines) {\n                    stringBuilder = stringBuilder + (inlineElement.text.substring(indexInInline));\n                }\n                else {\n                    stringBuilder = stringBuilder + (inlineElement.text);\n                }\n            }\n            else if (inlineElement instanceof FieldElementBox) {\n                var fieldBegin = inlineElement;\n                if (!isNullOrUndefined(fieldBegin.fieldEnd)) {\n                    // tslint:disable-next-line:max-line-length \n                    inlineElement = isNullOrUndefined(fieldBegin.fieldSeparator) ? fieldBegin.fieldEnd : fieldBegin.fieldSeparator;\n                }\n            }\n            if (!isNullOrUndefined(inlineElement) && isNullOrUndefined(inlineElement.nextNode)) {\n                break;\n            }\n            if (!isNullOrUndefined(inlineElement)) {\n                inlineElement = inlineElement.nextNode;\n            }\n        } while (true);\n        var text = stringBuilder.toString();\n        var matches = [];\n        var matchObject;\n        //tslint:disable no-conditional-assignment\n        while (!isNullOrUndefined(matchObject = pattern.exec(text))) {\n            matches.push(matchObject);\n        }\n        for (var i = 0; i < matches.length; i++) {\n            var match = matches[i];\n            var result = results.addResult();\n            var spanKeys = spans.keys;\n            for (var i_1 = 0; i_1 < spanKeys.length; i_1++) {\n                var span = spanKeys[i_1];\n                var startIndex = spans.get(span);\n                var spanLength = span.length;\n                // IndexInInline Handled specifically for simple find operation to start from starting point\n                if (span === inlines) {\n                    spanLength -= indexInInline;\n                }\n                if (isNullOrUndefined(result.start) && match.index < startIndex + spanLength) {\n                    var index = match.index - startIndex;\n                    // IndexInInline Handled specifically for simple find operation to start from starting point\n                    if (span === inlines) {\n                        index += indexInInline;\n                    }\n                    var offset = (span.line).getOffset(span, index);\n                    result.start = this.getTextPosition(span.line, offset.toString());\n                    result.start.location = this.owner.selection.getPhysicalPositionInternal(span.line, offset, true);\n                    result.start.setPositionParagraph(span.line, offset);\n                }\n                if (match.index + match[0].length <= startIndex + spanLength) {\n                    var index = (match.index + match[0].length) - startIndex;\n                    // IndexInInline Handled specifically for simple find operation to start from starting point\n                    if (span === inlines) {\n                        index += indexInInline;\n                    }\n                    var offset = (span.line).getOffset(span, index);\n                    result.end = this.getTextPosition(span.line, offset.toString());\n                    result.end.location = this.owner.selection.getPhysicalPositionInternal(span.line, offset, true);\n                    result.end.setPositionParagraph(span.line, offset);\n                    break;\n                }\n            }\n            result.isHeader = this.isHeader;\n            result.isFooter = this.isFooter;\n            if (isFirstMatch) {\n                results.currentIndex = 0;\n                return undefined;\n            }\n            else if (results.currentIndex < 0 && selectionEnd.isExistBefore(result.start)) {\n                results.currentIndex = results.indexOf(result);\n            }\n        }\n        // tslint:disable-next-line:max-line-length\n        var paragraphWidget = this.owner.selection.getNextParagraphBlock(inlineElement.line.paragraph);\n        return paragraphWidget;\n    };\n    TextSearch.prototype.getTextPosition = function (lineWidget, hierarchicalIndex) {\n        var textPosition = new TextPosition(this.owner);\n        var index = textPosition.getHierarchicalIndex(lineWidget, hierarchicalIndex);\n        textPosition.setPositionForCurrentIndex(index);\n        return textPosition;\n    };\n    return TextSearch;\n}());\nexport { TextSearch };\n/**\n * @private\n */\nvar SearchWidgetInfo = /** @class */ (function () {\n    function SearchWidgetInfo(left, width) {\n        this.leftInternal = 0;\n        this.widthInternal = 0;\n        this.leftInternal = left;\n        this.widthInternal = width;\n    }\n    Object.defineProperty(SearchWidgetInfo.prototype, \"left\", {\n        get: function () {\n            return this.leftInternal;\n        },\n        set: function (value) {\n            this.leftInternal = value;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(SearchWidgetInfo.prototype, \"width\", {\n        get: function () {\n            return this.widthInternal;\n        },\n        set: function (value) {\n            this.widthInternal = value;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    return SearchWidgetInfo;\n}());\nexport { SearchWidgetInfo };\n","/**\n * @private\n */\nvar TextSearchResult = /** @class */ (function () {\n    function TextSearchResult(owner) {\n        this.startIn = undefined;\n        this.endIn = undefined;\n        this.owner = owner;\n    }\n    Object.defineProperty(TextSearchResult.prototype, \"viewer\", {\n        get: function () {\n            return this.owner.viewer;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(TextSearchResult.prototype, \"start\", {\n        get: function () {\n            return this.startIn;\n        },\n        set: function (value) {\n            this.startIn = value;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(TextSearchResult.prototype, \"end\", {\n        get: function () {\n            return this.endIn;\n        },\n        set: function (value) {\n            this.endIn = value;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(TextSearchResult.prototype, \"text\", {\n        get: function () {\n            return this.viewer.selection.getTextInternal(this.start, this.end, false);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    TextSearchResult.prototype.destroy = function () {\n        this.start = undefined;\n        this.end = undefined;\n    };\n    return TextSearchResult;\n}());\nexport { TextSearchResult };\n","import { isNullOrUndefined } from '@syncfusion/ej2-base';\nimport { TextSearchResult } from './text-search-result';\n/**\n * @private\n */\nvar TextSearchResults = /** @class */ (function () {\n    function TextSearchResults(owner) {\n        this.currentIndex = -1;\n        this.owner = owner;\n    }\n    Object.defineProperty(TextSearchResults.prototype, \"length\", {\n        get: function () {\n            if (this.innerList === undefined) {\n                return 0;\n            }\n            return this.innerList.length;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(TextSearchResults.prototype, \"currentSearchResult\", {\n        get: function () {\n            if (this.innerList === undefined || this.currentIndex < 0 || this.currentIndex >= this.length) {\n                return undefined;\n            }\n            return this.innerList[this.currentIndex];\n        },\n        enumerable: true,\n        configurable: true\n    });\n    TextSearchResults.prototype.addResult = function () {\n        var textSearchResult = new TextSearchResult(this.owner);\n        if (isNullOrUndefined(this.innerList)) {\n            this.innerList = [];\n        }\n        this.innerList.push(textSearchResult);\n        return textSearchResult;\n    };\n    TextSearchResults.prototype.clearResults = function () {\n        this.currentIndex = -1;\n        if (!isNullOrUndefined(this.innerList)) {\n            for (var i = this.innerList.length - 1; i >= 0; i--) {\n                this.innerList[i].destroy();\n                this.innerList.splice(i, 1);\n            }\n        }\n    };\n    TextSearchResults.prototype.indexOf = function (result) {\n        if (isNullOrUndefined(this.innerList)) {\n            return -1;\n        }\n        return this.innerList.indexOf(result);\n    };\n    TextSearchResults.prototype.destroy = function () {\n        if (!isNullOrUndefined(this.innerList)) {\n            this.clearResults();\n        }\n        this.innerList = undefined;\n    };\n    return TextSearchResults;\n}());\nexport { TextSearchResults };\n","/**\n * Search Result info\n */\nvar SearchResults = /** @class */ (function () {\n    /**\n     * @private\n     */\n    function SearchResults(search) {\n        this.searchModule = search;\n    }\n    Object.defineProperty(SearchResults.prototype, \"length\", {\n        /**\n         * Gets the length of search results.\n         */\n        get: function () {\n            return this.searchModule.textSearchResults.length;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(SearchResults.prototype, \"index\", {\n        /**\n         * Gets the index of current search result.\n         */\n        get: function () {\n            return this.searchModule.textSearchResults.currentIndex;\n        },\n        /**\n         * Set the index of current search result.\n         */\n        set: function (value) {\n            if (this.length === 0 || value < 0 || value > this.searchModule.textSearchResults.length - 1) {\n                return;\n            }\n            this.searchModule.textSearchResults.currentIndex = value;\n            this.navigate(value);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    /**\n     * Replace text in current search result.\n     * @param textToReplace text to replace\n     * @private\n     */\n    SearchResults.prototype.replace = function (textToReplace) {\n        if (this.index === -1) {\n            return;\n        }\n        this.searchModule.replaceInternal(textToReplace);\n    };\n    /**\n     * Replace all the instance of search result.\n     * @param textToReplace text to replace\n     */\n    SearchResults.prototype.replaceAll = function (textToReplace) {\n        if (this.index === -1) {\n            return;\n        }\n        this.searchModule.replaceAllInternal(textToReplace);\n    };\n    /**\n     * @private\n     */\n    SearchResults.prototype.navigate = function (index) {\n        this.searchModule.navigate(this.searchModule.textSearchResults.currentSearchResult);\n        this.searchModule.highlight(this.searchModule.textSearchResults);\n    };\n    /**\n     * Clears all the instance of search result.\n     */\n    SearchResults.prototype.clear = function () {\n        this.searchModule.textSearchResults.clearResults();\n        this.searchModule.clearSearchHighlight();\n        this.searchModule.viewer.renderVisiblePages();\n    };\n    return SearchResults;\n}());\nexport { SearchResults };\n","import { Dictionary } from '../../base/dictionary';\nimport { isNullOrUndefined } from '@syncfusion/ej2-base';\nimport { TextPosition } from '../selection/selection-helper';\nimport { TextElementBox, FieldElementBox } from '../viewer/page';\nimport { SearchWidgetInfo } from './text-search';\nimport { TextSearch } from '../search/text-search';\nimport { TextSearchResults } from '../search/text-search-results';\nimport { SearchResults } from './search-results';\n/**\n * Search module\n */\nvar Search = /** @class */ (function () {\n    /**\n     * @private\n     */\n    function Search(owner) {\n        /**\n         * @private\n         */\n        this.searchHighlighters = undefined;\n        this.isHandledOddPageHeader = undefined;\n        this.isHandledEvenPageHeader = undefined;\n        this.isHandledOddPageFooter = undefined;\n        this.isHandledEvenPageFooter = undefined;\n        this.owner = owner;\n        this.searchHighlighters = new Dictionary();\n        this.textSearch = new TextSearch(this.owner);\n        this.textSearchResults = new TextSearchResults(this.owner);\n        this.searchResultsInternal = new SearchResults(this);\n    }\n    Object.defineProperty(Search.prototype, \"viewer\", {\n        /**\n         * @private\n         */\n        get: function () {\n            return this.owner.viewer;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(Search.prototype, \"searchResults\", {\n        /**\n         * Gets the search results object.\n         */\n        get: function () {\n            return this.searchResultsInternal;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    /**\n     * Get the module name.\n     */\n    Search.prototype.getModuleName = function () {\n        return 'Search';\n    };\n    //#region Find & Find All\n    /**\n     * Finds the immediate occurrence of specified text from cursor position in the document.\n     * @param  {string} text\n     * @param  {FindOption} findOption? - Default value of â€˜findOptionsâ€™ parameter is 'None'.\n     * @private\n     */\n    Search.prototype.find = function (text, findOptions) {\n        if (isNullOrUndefined(findOptions)) {\n            findOptions = 'None';\n        }\n        var result = this.textSearch.find(text, findOptions);\n        if (!isNullOrUndefined(result)) {\n            this.navigate(result);\n        }\n    };\n    /**\n     * Finds all occurrence of specified text in the document.\n     * @param  {string} text\n     * @param  {FindOption} findOption? - Default value of â€˜findOptionsâ€™ parameter is 'None'.\n     */\n    Search.prototype.findAll = function (text, findOptions) {\n        if (isNullOrUndefined(text || text === '')) {\n            return;\n        }\n        if (isNullOrUndefined(findOptions)) {\n            findOptions = 'None';\n        }\n        var results = this.textSearch.findAll(text, findOptions);\n        if (!isNullOrUndefined(results) && results.length > 0) {\n            this.navigate(results.innerList[results.currentIndex]);\n            this.highlight(results);\n        }\n    };\n    //#endregion\n    //#region Replace and Replace All   \n    /**\n     * Replace the searched string with specified string\n     * @param  {string} replaceText\n     * @param  {TextSearchResult} result\n     * @param  {TextSearchResults} results\n     * @private\n     */\n    Search.prototype.replace = function (replaceText, result, results) {\n        if (isNullOrUndefined(this.viewer.owner) || this.viewer.owner.isReadOnlyMode || isNullOrUndefined(results)) {\n            return 0;\n        }\n        if (!isNullOrUndefined(this.viewer)) {\n            this.clearSearchHighlight();\n        }\n        this.navigate(result);\n        var endPosition = this.viewer.selection.start;\n        var index = results.indexOf(result);\n        if (index < 0) {\n            return 0;\n        }\n        this.owner.editorModule.insertText(replaceText, true);\n        var endTextPosition = result.end;\n        var startPosition = new TextPosition(this.viewer.owner);\n        startPosition.setPositionParagraph(endTextPosition.currentWidget, endPosition.offset - replaceText.length);\n        this.viewer.selection.selectRange(endPosition, startPosition);\n        var eventArgs = { source: this.viewer.owner };\n        this.viewer.owner.trigger('searchResultsChange', eventArgs);\n        return 1;\n    };\n    /**\n     * Find the textToFind string in current document and replace the specified string.\n     * @param  {string} textToFind\n     * @param  {string} textToReplace\n     * @param  {FindOption} findOptions? - Default value of â€˜findOptionsâ€™ parameter is FindOption.None.\n     * @private\n     */\n    Search.prototype.replaceInternal = function (textToReplace, findOptions) {\n        if ((textToReplace === '' || isNullOrUndefined(textToReplace))) {\n            return;\n        }\n        if (isNullOrUndefined(findOptions)) {\n            findOptions = 'None';\n        }\n        var textToFind = this.textSearchResults.currentSearchResult.text;\n        var pattern = this.viewer.owner.searchModule.textSearch.stringToRegex(textToFind, findOptions);\n        var index = this.owner.selection.end.getHierarchicalIndexInternal();\n        var result = this.viewer.owner.searchModule.textSearch.findNext(pattern, findOptions, index);\n        if (!isNullOrUndefined(result)) {\n            this.navigate(result);\n            this.textSearchResults.addResult();\n            this.textSearchResults.innerList[0] = result;\n            this.replace(textToReplace, result, this.textSearchResults);\n            index = this.owner.selection.end.getHierarchicalIndexInternal();\n            result = this.textSearch.findNext(textToFind, findOptions, index);\n            if (result) {\n                this.textSearchResults.addResult();\n                this.textSearchResults.innerList[0] = result;\n                this.navigate(result);\n            }\n        }\n    };\n    /**\n     * Replace all the searched string with specified string\n     * @param  {string} replaceText\n     * @param  {TextSearchResults} results\n     * @private\n     */\n    Search.prototype.replaceAll = function (replaceText, results) {\n        if (isNullOrUndefined(this.viewer.owner) || this.viewer.owner.isReadOnlyMode || isNullOrUndefined(results)) {\n            return 0;\n        }\n        if (this.owner.editorHistory) {\n            this.owner.editorHistory.initComplexHistory(this.owner.selection, 'ReplaceAll');\n        }\n        var count = results.length;\n        this.viewer.owner.isLayoutEnabled = false;\n        for (var i = count - 1; i >= 0; i--) {\n            this.navigate(results.innerList[i]);\n            this.owner.editorModule.insertText(replaceText, true);\n            results.innerList[i].destroy();\n        }\n        if (this.owner.editorHistory && !isNullOrUndefined(this.owner.editorHistory.currentHistoryInfo)) {\n            this.owner.editorHistory.updateComplexHistory();\n        }\n        else {\n            this.owner.editorModule.updateComplexWithoutHistory(2);\n        }\n        this.searchResults.clear();\n        return count;\n    };\n    /**\n     * Find the textToFind string in current document and replace the specified string.\n     * @param  {string} textToFind\n     * @param  {string} textToReplace\n     * @param  {FindOption} findOptions? - Default value of â€˜findOptionsâ€™ parameter is FindOption.None.\n     * @private\n     */\n    Search.prototype.replaceAllInternal = function (textToReplace, findOptions) {\n        if ((textToReplace === '' || isNullOrUndefined(textToReplace))) {\n            return;\n        }\n        if (isNullOrUndefined(findOptions)) {\n            findOptions = 'None';\n        }\n        if (this.textSearchResults.length > 0) {\n            this.navigate(this.textSearchResults.innerList[this.textSearchResults.currentIndex]);\n            this.highlight(this.textSearchResults);\n            this.replaceAll(textToReplace, this.textSearchResults);\n        }\n    };\n    //#endregion\n    //#region Highlight Search Result\n    /**\n     * @private\n     */\n    Search.prototype.navigate = function (textSearchResult) {\n        if (textSearchResult) {\n            var start = textSearchResult.start;\n            var end = textSearchResult.end;\n            if (!isNullOrUndefined(this.owner) && !isNullOrUndefined(this.owner.selection) && !isNullOrUndefined(start) &&\n                !isNullOrUndefined(end) && !isNullOrUndefined(start.paragraph) && !isNullOrUndefined(end.paragraph)) {\n                this.owner.selection.selectRange(start, end);\n            }\n        }\n    };\n    /**\n     * @private\n     */\n    Search.prototype.highlight = function (textSearchResults) {\n        this.searchHighlighters = new Dictionary();\n        for (var i = 0; i < textSearchResults.innerList.length; i++) {\n            var result = textSearchResults.innerList[i];\n            this.highlightResult(result);\n        }\n        this.viewer.renderVisiblePages();\n    };\n    /**\n     * @private\n     */\n    Search.prototype.highlightResult = function (result) {\n        this.highlightSearchResult(result.start.paragraph, result.start, result.end);\n    };\n    /**\n     * Highlight search result\n     * @private\n     */\n    Search.prototype.highlightSearchResult = function (paragraph, start, end) {\n        var selectionStartIndex = 0;\n        var selectionEndIndex = 0;\n        var startElement = null;\n        var endElement = null;\n        // tslint:disable-next-line:max-line-length\n        var lineWidget = this.viewer.selection.getStartLineWidget(paragraph, start, startElement, selectionStartIndex);\n        selectionStartIndex = lineWidget.index;\n        startElement = lineWidget.element;\n        var startLineWidget = startElement ? startElement.line : paragraph.childWidgets[0];\n        var endLine = this.viewer.selection.getEndLineWidget(end, endElement, selectionEndIndex);\n        selectionEndIndex = endLine.index;\n        endElement = endLine.element;\n        var endLineWidget = endElement ? endElement.line :\n            end.paragraph.childWidgets[end.paragraph.childWidgets.length - 1];\n        var top = this.viewer.selection.getTop(startLineWidget);\n        var left = this.viewer.selection.getLeftInternal(startLineWidget, startElement, selectionStartIndex);\n        if (!isNullOrUndefined(startLineWidget) && startLineWidget === endLineWidget) {\n            //find result ends in current line.\n            var right = this.viewer.selection.getLeftInternal(endLineWidget, endElement, selectionEndIndex);\n            this.createHighlightBorder(startLineWidget, right - left, left, top);\n        }\n        else {\n            if (!isNullOrUndefined(startLineWidget)) {\n                if (paragraph !== startLineWidget.paragraph) {\n                    paragraph = startLineWidget.paragraph;\n                }\n                // tslint:disable-next-line:max-line-length\n                this.createHighlightBorder(startLineWidget, this.viewer.selection.getWidth(startLineWidget, true) - (left - startLineWidget.paragraph.x), left, top);\n                var lineIndex = startLineWidget.paragraph.childWidgets.indexOf(startLineWidget);\n                //Iterates to last item of paragraph or search result end.\n                var startParagraphWidget = void 0;\n                for (var i = 0; i < paragraph.childWidgets.length; i++) {\n                    if (paragraph === startLineWidget.paragraph) {\n                        lineIndex += 1;\n                    }\n                    this.highlightSearchResultParaWidget(paragraph, lineIndex, endLineWidget, endElement, selectionEndIndex);\n                    if (paragraph === endLineWidget.paragraph) {\n                        return;\n                    }\n                    else {\n                        lineIndex = 0;\n                    }\n                }\n            }\n        }\n    };\n    /**\n     * @private\n     */\n    Search.prototype.createHighlightBorder = function (lineWidget, width, left, top) {\n        var findHighLight = this.addSearchHighlightBorder(lineWidget);\n        var page = this.viewer.owner.selection.getPage(lineWidget.paragraph);\n        var pageTop = page.boundingRectangle.y;\n        var pageLeft = page.boundingRectangle.x;\n        findHighLight.left = Math.ceil(left);\n        top = Math.ceil(top);\n        findHighLight.width = Math.floor(width);\n        var height = Math.floor(lineWidget.height);\n        var context = this.viewer.containerContext;\n    };\n    /**\n     * Adds search highlight border.\n     * @private\n     */\n    Search.prototype.addSearchHighlightBorder = function (lineWidget) {\n        var highlighters = undefined;\n        if (this.searchHighlighters.containsKey(lineWidget)) {\n            highlighters = this.searchHighlighters.get(lineWidget);\n        }\n        else {\n            highlighters = [];\n            this.searchHighlighters.add(lineWidget, highlighters);\n        }\n        var searchHighlight = new SearchWidgetInfo(0, 0);\n        highlighters.push(searchHighlight);\n        return searchHighlight;\n    };\n    /**\n     * @private\n     */\n    // tslint:disable-next-line:max-line-length\n    Search.prototype.highlightSearchResultParaWidget = function (widget, startIndex, endLine, endElement, endIndex) {\n        var top = 0;\n        for (var j = startIndex; j < widget.childWidgets.length; j++) {\n            var lineWidget = widget.childWidgets[j];\n            if (j === startIndex) {\n                top = this.viewer.selection.getTop(lineWidget);\n            }\n            var left = this.viewer.selection.getLeft(lineWidget);\n            if (lineWidget === endLine) {\n                //Search result ends in current line.\n                var right = this.viewer.selection.getLeftInternal(endLine, endElement, endIndex);\n                this.createHighlightBorder(lineWidget, right - left, left, top);\n                return;\n            }\n            this.createHighlightBorder(lineWidget, this.viewer.selection.getWidth(lineWidget, true) - (left - widget.x), left, top);\n            top += lineWidget.height;\n        }\n    };\n    //#endregion\n    //#region Get find result view\n    /**\n     * @private\n     */\n    Search.prototype.addSearchResultItems = function (result) {\n        if (isNullOrUndefined(result) || result === '') {\n            return;\n        }\n        if (isNullOrUndefined(this.owner.findResultsList)) {\n            this.owner.findResultsList = [];\n        }\n        this.owner.findResultsList.push(result);\n    };\n    /**\n     * @private\n     */\n    Search.prototype.addFindResultView = function (textSearchResults) {\n        for (var i = 0; i < textSearchResults.innerList.length; i++) {\n            var result = textSearchResults.innerList[i];\n            this.addFindResultViewForSearch(result);\n        }\n        this.isHandledOddPageHeader = true;\n        this.isHandledOddPageFooter = true;\n        this.isHandledEvenPageHeader = true;\n        this.isHandledEvenPageFooter = true;\n    };\n    /**\n     * @private\n     */\n    // tslint:disable:max-func-body-length\n    Search.prototype.addFindResultViewForSearch = function (result) {\n        if (result.start != null && result.end != null && result.start.paragraph != null && result.end.paragraph != null) {\n            var prefixText = void 0;\n            var suffixtext = void 0;\n            var currentText = void 0;\n            var startIndex = 0;\n            var inlineObj = result.start.currentWidget.getInline(result.start.offset, startIndex);\n            var inline = inlineObj.element;\n            startIndex = inlineObj.index;\n            var prefix = '';\n            var lastIndex = 0;\n            if (inline instanceof FieldElementBox) {\n                var elementInfo = this.owner.selection.getRenderedInline(inline, startIndex);\n                if (elementInfo.element.nextNode instanceof TextElementBox) {\n                    inline = elementInfo.element.nextNode;\n                    startIndex = elementInfo.index;\n                }\n                else {\n                    inline = elementInfo.element;\n                    startIndex = elementInfo.index;\n                }\n            }\n            var boxObj = this.owner.selection.getElementBoxInternal(inline, startIndex);\n            var box = boxObj.element;\n            startIndex = boxObj.index;\n            if (box != null) {\n                if (box instanceof TextElementBox && startIndex > 0) {\n                    prefix = box.text.substring(0, startIndex);\n                }\n                var boxIndex = box.line.children.indexOf(box);\n                // tslint:disable-next-line:max-line-length\n                lastIndex = prefix.lastIndexOf(' ');\n                while (lastIndex < 0 && boxIndex > 0 && box.line.children[boxIndex - 1] instanceof TextElementBox) {\n                    prefix = box.line.children[boxIndex - 1].text + prefix;\n                    boxIndex--;\n                    lastIndex = prefix.lastIndexOf(' ');\n                }\n            }\n            var shiftIndex = prefix.lastIndexOf('\\v');\n            if (shiftIndex > 0) {\n                prefix = prefix.substring(0, shiftIndex);\n            }\n            else {\n                lastIndex = prefix.lastIndexOf(' ');\n                prefixText = lastIndex < 0 ? prefix : prefix.substring(lastIndex + 1);\n            }\n            currentText = result.text;\n            var endIndex = 0;\n            var endInlineObj = result.end.currentWidget.getInline(result.end.offset, endIndex);\n            var endInline = endInlineObj.element;\n            endIndex = endInlineObj.index;\n            suffixtext = '';\n            //Checks prefix element box is empty\n            if (boxObj != null) {\n                // Gets the element box using endIndex of the text and set as suffix\n                boxObj = this.owner.selection.getElementBoxInternal(endInline, endIndex);\n                box = boxObj.element;\n                endIndex = boxObj.index;\n            }\n            //Checks suffix element box is empty.\n            if (box != null) {\n                if (box instanceof TextElementBox && endIndex < box.length) {\n                    suffixtext = box.text.substring(endIndex);\n                }\n                var boxIndex = box.line.children.indexOf(box);\n                // tslint:disable-next-line:max-line-length\n                while (boxIndex + 1 < box.line.children.length && (box.line.children[boxIndex + 1] instanceof TextElementBox) || (box.line.children[boxIndex + 1] instanceof FieldElementBox)) {\n                    if (box.line.children[boxIndex + 1] instanceof FieldElementBox) {\n                        boxIndex = boxIndex + 2;\n                    }\n                    else {\n                        suffixtext = suffixtext + box.line.children[boxIndex + 1].text;\n                        boxIndex = boxIndex + 1;\n                    }\n                }\n            }\n            lastIndex = suffixtext.lastIndexOf(' ');\n            suffixtext = suffixtext === '\\v' ? suffixtext = '' : suffixtext;\n            var headerFooterString = '';\n            if (result.isHeader) {\n                headerFooterString = '<span class=\"e-de-header-footer-list\">' + 'Header' + ': ' + '</span>';\n            }\n            else if (result.isFooter) {\n                headerFooterString = '<span class=\"e-de-header-footer-list\">' + 'Footer' + ': ' + '</span>';\n            }\n            else {\n                headerFooterString = '';\n                headerFooterString = '';\n                this.isHandledOddPageHeader = true;\n                this.isHandledEvenPageHeader = true;\n                this.isHandledOddPageFooter = true;\n                this.isHandledEvenPageFooter = true;\n            }\n            var listElement = '';\n            var page = result.viewer.selection.getPage(result.start.paragraph);\n            if (isNullOrUndefined(this.isHandledEvenPageHeader) && isNullOrUndefined(this.isHandledEvenPageFooter)) {\n                this.isHandledEvenPageHeader = true;\n                this.isHandledEvenPageFooter = true;\n            }\n            else if (isNullOrUndefined(this.isHandledOddPageHeader) && isNullOrUndefined(this.isHandledOddPageFooter)) {\n                this.isHandledOddPageHeader = true;\n                this.isHandledOddPageFooter = true;\n            }\n            if (result.isHeader) {\n                if (page.headerWidget.headerFooterType === 'FirstPageHeader' && page.bodyWidgets[0].sectionFormat.differentFirstPage) {\n                    // tslint:disable-next-line:max-line-length\n                    listElement = '<li tabindex=0 class=\"e-de-search-result-item e-de-op-search-txt\">' + headerFooterString + prefix + '<span class=\"e-de-op-search-word\" style=\"pointer-events:none\">' + result.text + '</span>' + suffixtext + '</li>';\n                }\n                else if (page.headerWidget.headerFooterType === 'EvenHeader' && this.isHandledEvenPageHeader) {\n                    // tslint:disable-next-line:max-line-length\n                    listElement = '<li tabindex=0 class=\"e-de-search-result-item e-de-op-search-txt\">' + headerFooterString + prefix + '<span class=\"e-de-op-search-word\" style=\"pointer-events:none\">' + result.text + '</span>' + suffixtext + '</li>';\n                    this.isHandledEvenPageHeader = false;\n                    // tslint:disable-next-line:max-line-length\n                }\n                else if (page.headerWidget.headerFooterType === 'OddHeader' && this.isHandledOddPageHeader) {\n                    listElement = '<li tabindex=0 class=\"e-de-search-result-item e-de-op-search-txt\">' + headerFooterString + prefix + '<span class=\"e-de-op-search-word\" style=\"pointer-events:none\">' + result.text + '</span>' + suffixtext + '</li>';\n                    this.isHandledOddPageHeader = false;\n                }\n            }\n            else if (result.isFooter) {\n                if (page.footerWidget.headerFooterType === 'FirstPageFooter' && page.bodyWidgets[0].sectionFormat.differentFirstPage) {\n                    // tslint:disable-next-line:max-line-length\n                    listElement = '<li tabindex=0 class=\"e-de-search-result-item e-de-op-search-txt\">' + headerFooterString + prefix + '<span class=\"e-de-op-search-word\" style=\"pointer-events:none\">' + result.text + '</span>' + suffixtext + '</li>';\n                }\n                else if (page.footerWidget.headerFooterType === 'EvenFooter' && this.isHandledEvenPageFooter) {\n                    // tslint:disable-next-line:max-line-length\n                    listElement = '<li tabindex=0 class=\"e-de-search-result-item e-de-op-search-txt\">' + headerFooterString + prefix + '<span class=\"e-de-op-search-word\" style=\"pointer-events:none\">' + result.text + '</span>' + suffixtext + '</li>';\n                    this.isHandledEvenPageFooter = false;\n                    // tslint:disable-next-line:max-line-length\n                }\n                else if (page.footerWidget.headerFooterType === 'OddFooter' && this.isHandledOddPageFooter) {\n                    listElement = '<li tabindex=0 class=\"e-de-search-result-item e-de-op-search-txt\">' + headerFooterString + prefix + '<span class=\"e-de-op-search-word\" style=\"pointer-events:none\">' + result.text + '</span>' + suffixtext + '</li>';\n                    this.isHandledOddPageFooter = false;\n                }\n                // tslint:disable-next-line:max-line-length\n            }\n            else if (!result.isHeader && !result.isFooter) {\n                listElement = '<li tabindex=0 class=\"e-de-search-result-item e-de-op-search-txt\">' + headerFooterString + prefix + '<span class=\"e-de-op-search-word\" style=\"pointer-events:none\">' + result.text + '</span>' + suffixtext + '</li>';\n            }\n            this.addSearchResultItems(listElement);\n        }\n    };\n    //#endregion\n    /**\n     * Clears search highlight.\n     * @private\n     */\n    Search.prototype.clearSearchHighlight = function () {\n        if (!isNullOrUndefined(this.searchHighlighters)) {\n            this.searchHighlighters.clear();\n            this.searchHighlighters = undefined;\n        }\n        var eventArgs = { source: this.viewer.owner };\n        this.viewer.owner.trigger('searchResultsChange', eventArgs);\n    };\n    /**\n     * @private\n     */\n    Search.prototype.destroy = function () {\n        if (this.textSearchResults) {\n            this.textSearchResults.destroy();\n        }\n    };\n    return Search;\n}());\nexport { Search };\n","import { createElement, isNullOrUndefined, L10n, setCulture } from '@syncfusion/ej2-base';\nimport { HelperMethods } from '../editor/editor-helper';\nimport { CheckBox } from '@syncfusion/ej2-buttons';\nimport { Tab } from '@syncfusion/ej2-navigations';\n/**\n * Options Pane class.\n */\nvar OptionsPane = /** @class */ (function () {\n    /**\n     * Constructor for Options pane module\n     * @param {LayoutViewer} layoutViewer\n     * @private\n     */\n    function OptionsPane(layoutViewer) {\n        var _this = this;\n        /**\n         * @private\n         */\n        this.isOptionsPaneShow = false;\n        this.findOption = 'None';\n        this.matchCase = undefined;\n        this.wholeWord = undefined;\n        // private regular: CheckBox = undefined;\n        this.searchText = 'Navigation';\n        this.resultsText = 'Results';\n        this.messageDivText = 'No matches';\n        this.replaceButtonText = 'Replace';\n        this.replaceAllButtonText = 'Replace All';\n        this.focusedIndex = -1;\n        this.focusedElement = [];\n        this.isOptionsPane = true;\n        this.replacePaneText = 'Replace';\n        this.findPaneText = 'Find';\n        this.matchDivReplaceText = 'No matches';\n        /**\n         * @private\n         */\n        this.tabInstance = undefined;\n        /**\n         * @private\n         */\n        this.isReplace = false;\n        /**\n         * Gets selected tab item which tab is selected.\n         * @param {SelectEventArgs} args - Specifies which tab will be opened.\n         * @private\n         */\n        this.selectedTabItem = function (args) {\n            if (args.previousIndex !== args.selectedIndex) {\n                var previousTab = document.querySelector('#e-content_' + args.previousIndex);\n                var nextTab = document.querySelector('#e-content_' + args.selectedIndex);\n                nextTab.insertBefore(previousTab.firstElementChild, nextTab.firstChild);\n            }\n            if (args.selectedIndex === 0 && !isNullOrUndefined(document.querySelector('#e-content_' + args.selectedIndex))) {\n                _this.isOptionsPane = true;\n                _this.onFindPane();\n            }\n            if (args.selectedIndex === 1 && !isNullOrUndefined(document.querySelector('#e-content_' + args.selectedIndex))) {\n                _this.isOptionsPane = false;\n                _this.onReplacePane();\n            }\n        };\n        this.searchOptionChange = function () {\n            _this.clearSearchResultItems();\n            _this.viewer.owner.searchModule.clearSearchHighlight();\n            var inputText = _this.searchInput.value;\n            if (inputText === '') {\n                return;\n            }\n            var pattern = _this.viewer.owner.searchModule.textSearch.stringToRegex(inputText, _this.findOption);\n            var endSelection = _this.viewer.selection.end;\n            var selectionIndex = endSelection.getHierarchicalIndexInternal();\n            _this.results = _this.viewer.owner.searchModule.textSearch.findAll(pattern, _this.findOption, selectionIndex);\n            if (_this.results != null && _this.results.length > 0) {\n                _this.navigateSearchResult();\n            }\n            else {\n                _this.viewer.renderVisiblePages();\n                _this.messageDiv.innerHTML = _this.localeValue.getConstant('No matches');\n                _this.resultContainer.style.display = 'block';\n                _this.resultsListBlock.style.display = 'none';\n                _this.clearFocusElement();\n                _this.resultsListBlock.innerHTML = '';\n            }\n        };\n        /**\n         * Apply find option based on whole words value.\n         * @param {ChangeEventArgs} args - Specifies the search options value.\n         * @private\n         */\n        this.wholeWordsChange = function (args) {\n            if (_this.matchInput.checked && _this.wholeInput.checked) {\n                _this.findOption = 'CaseSensitiveWholeWord';\n            }\n            else if (_this.matchInput.checked && !(_this.wholeInput.checked)) {\n                _this.findOption = 'CaseSensitive';\n            }\n            else if (!(_this.matchInput.checked) && _this.wholeInput.checked) {\n                _this.findOption = 'WholeWord';\n            }\n            else {\n                _this.findOption = 'None';\n            }\n            _this.searchOptionChange();\n        };\n        /**\n         * Apply find option based on match value.\n         * @param {ChangeEventArgs} args - Specifies the search options value.\n         * @private\n         */\n        this.matchChange = function (args) {\n            if (_this.matchInput.checked && _this.wholeInput.checked) {\n                _this.findOption = 'CaseSensitiveWholeWord';\n            }\n            else if (!(_this.matchInput.checked) && _this.wholeInput.checked) {\n                _this.findOption = 'WholeWord';\n            }\n            else if (_this.matchInput.checked && !(_this.wholeInput.checked)) {\n                _this.findOption = 'CaseSensitive';\n            }\n            else {\n                _this.findOption = 'None';\n            }\n            _this.searchOptionChange();\n        };\n        /**\n         * Apply find options based on regular value.\n         * @param {ChangeEventArgs} args - Specifies the search options value.\n         * @private\n         */\n        // public regularChange = (args: ChangeEventArgs): void => {\n        //     if (args.checked) {\n        //         this.matchCase.element.parentElement.parentElement.classList.add('e-checkbox-disabled');\n        //         this.wholeWord.element.parentElement.parentElement.classList.add('e-checkbox-disabled');\n        //         this.matchCase.checked = false;\n        //         this.wholeWord.checked = false;\n        //         this.findOption = 'None';\n        //         this.onKeyDownInternal();\n        //     } else {\n        //         this.matchCase.element.parentElement.parentElement.classList.remove('e-checkbox-disabled');\n        //         this.wholeWord.element.parentElement.parentElement.classList.remove('e-checkbox-disabled');\n        //     }\n        // }\n        // tslint:enable:no-any \n        /**\n         * Binding events from the element when optins pane creation.\n         * @private\n         */\n        this.onWireEvents = function () {\n            _this.searchIcon.addEventListener('click', _this.searchIconClickInternal);\n            _this.navigateToNextResult.addEventListener('click', _this.navigateNextResultButtonClick);\n            _this.navigateToPreviousResult.addEventListener('click', _this.navigatePreviousResultButtonClick);\n            _this.searchInput.addEventListener('keydown', _this.onKeyDown);\n            _this.searchInput.addEventListener('keyup', _this.onEnableDisableReplaceButton);\n            _this.resultsListBlock.addEventListener('click', _this.resultListBlockClick);\n            _this.closeButton.addEventListener('click', _this.close);\n            _this.replaceButton.addEventListener('click', _this.onReplaceButtonClick);\n            _this.replaceAllButton.addEventListener('click', _this.onReplaceAllButtonClick);\n        };\n        /**\n         * Enable find pane only.\n         * @private\n         */\n        this.onFindPane = function () {\n            _this.replaceDiv.style.display = 'none';\n            _this.occurrenceDiv.style.display = 'none';\n            if (!isNullOrUndefined(_this.results) && _this.results.length === 0) {\n                _this.resultsListBlock.innerHTML = '';\n                _this.resultsListBlock.style.display = 'none';\n                _this.messageDiv.innerHTML = _this.localeValue.getConstant('No matches');\n            }\n            _this.resultsListBlock.style.height = _this.resultsListBlock.offsetHeight + _this.replaceTabContentDiv.offsetHeight + 'px';\n            _this.replaceTabContentDiv.style.display = 'none';\n            _this.findDiv.style.display = 'block';\n            _this.messageDiv.style.display = 'block';\n            _this.focusedElement = [];\n            // tslint:disable-next-line:max-line-length\n            _this.focusedElement.push(_this.closeButton, _this.findTabButtonHeader, _this.replaceTabButtonHeader, _this.searchInput, _this.searchIcon, _this.navigateToPreviousResult, _this.navigateToNextResult, _this.matchInput, _this.wholeInput);\n            _this.focusedIndex = 3;\n            _this.searchInput.select();\n            _this.getMessageDivHeight();\n        };\n        this.onEnableDisableReplaceButton = function () {\n            if (_this.searchInput.value.length !== 0) {\n                _this.replaceButton.disabled = false;\n                _this.replaceAllButton.disabled = false;\n            }\n            else {\n                _this.replaceButton.disabled = true;\n                _this.replaceAllButton.disabled = true;\n            }\n        };\n        /**\n         * Enable replace pane only.\n         * @private\n         */\n        this.onReplacePane = function () {\n            _this.findDiv.style.display = 'block';\n            _this.replaceDiv.style.display = 'block';\n            _this.replaceTabContentDiv.style.display = 'block';\n            _this.resultsListBlock.style.height = _this.resultsListBlock.offsetHeight - _this.replaceTabContentDiv.offsetHeight + 'px';\n            _this.isOptionsPane = false;\n            if (_this.searchInput.value.length !== 0) {\n                _this.replaceButton.disabled = false;\n                _this.replaceAllButton.disabled = false;\n            }\n            else {\n                _this.replaceButton.disabled = true;\n                _this.replaceAllButton.disabled = true;\n            }\n            _this.focusedElement = [];\n            // tslint:disable-next-line:max-line-length\n            _this.focusedElement.push(_this.closeButton, _this.findTabButtonHeader, _this.replaceTabButtonHeader, _this.searchInput, _this.searchIcon, _this.navigateToPreviousResult, _this.navigateToNextResult, _this.matchInput, _this.wholeInput, _this.replaceWith, _this.replaceButton, _this.replaceAllButton);\n            _this.focusedIndex = 9;\n            if (_this.searchInput.value === '') {\n                _this.searchInput.select();\n            }\n            else {\n                _this.replaceWith.select();\n            }\n            _this.getMessageDivHeight();\n        };\n        /**\n         * Fires on key down on options pane.\n         * @param {KeyboardEvent} event - Specifies the focus of current element.\n         * @private\n         */\n        this.onKeyDownOnOptionPane = function (event) {\n            // if (event.keyCode === 70) {\n            //     event.preventDefault();\n            //     return;\n            // }\n            if (event.keyCode === 9) {\n                event.preventDefault();\n                var focusIndex = undefined;\n                if (event.shiftKey) {\n                    focusIndex = (_this.focusedIndex === 0 || isNullOrUndefined(_this.focusedIndex)) ?\n                        _this.focusedElement.length - 1 : _this.focusedIndex - 1;\n                }\n                else {\n                    focusIndex = (_this.focusedElement.length - 1 === _this.focusedIndex || isNullOrUndefined(_this.focusedIndex)) ?\n                        0 : _this.focusedIndex + 1;\n                }\n                var element = _this.focusedElement[focusIndex];\n                element.focus();\n                if (element instanceof HTMLInputElement) {\n                    element.select();\n                }\n                _this.focusedIndex = focusIndex;\n                if (element instanceof HTMLLIElement) {\n                    _this.scrollToPosition(element);\n                }\n            }\n            else if (event.keyCode === 13) {\n                // tslint:disable-next-line:max-line-length\n                if (event.target !== _this.searchInput && event.target !== _this.closeButton) {\n                    event.preventDefault();\n                    var index = _this.focusedElement.indexOf(event.target);\n                    if (index !== -1) {\n                        var list = _this.focusedElement[index];\n                        list.click();\n                        list.focus();\n                        _this.focusedIndex = index;\n                    }\n                }\n            }\n            else if (event.keyCode === 40 || event.keyCode === 38) {\n                if (_this.resultsListBlock.style.display !== 'none') {\n                    var index = void 0;\n                    var element = void 0;\n                    if (event.keyCode === 40) {\n                        if (_this.focusedIndex > 7) {\n                            if (_this.focusedIndex + 1 < _this.focusedElement.length) {\n                                element = _this.focusedElement[_this.focusedIndex + 1];\n                                element.focus();\n                                _this.focusedIndex = _this.focusedIndex + 1;\n                            }\n                        }\n                        else {\n                            index = (_this.focusedElement.length - _this.resultsListBlock.children.length) + _this.results.currentIndex + 1;\n                            if (index < _this.focusedElement.length) {\n                                element = _this.focusedElement[index];\n                                element.focus();\n                                _this.focusedIndex = index;\n                            }\n                        }\n                    }\n                    else {\n                        if (_this.focusedIndex > 8) {\n                            index = _this.focusedIndex - 1;\n                            element = _this.focusedElement[index];\n                            element.focus();\n                            _this.focusedIndex = index;\n                        }\n                    }\n                }\n            }\n        };\n        /**\n         * Fires on replace.\n         * @private\n         */\n        this.onReplaceButtonClick = function () {\n            var optionsPane = _this.optionsPane;\n            var findText = _this.searchInput.value;\n            var replaceText = _this.replaceWith.value;\n            var results = _this.viewer.owner.searchModule.textSearchResults;\n            if (findText !== '' && !isNullOrUndefined(findText)) {\n                if (_this.viewer.owner.selection != null) {\n                    var selectionText = _this.viewer.owner.selection.text;\n                    if (!_this.viewer.owner.selection.isEmpty) {\n                        if (_this.viewer.owner.selection.isForward) {\n                            _this.viewer.owner.selection.selectContent(_this.viewer.owner.selection.start, true);\n                        }\n                        else {\n                            _this.viewer.owner.selection.selectContent(_this.viewer.owner.selection.end, true);\n                        }\n                    }\n                    if (!isNullOrUndefined(results) && !isNullOrUndefined(results.currentSearchResult)) {\n                        var result = results.currentSearchResult;\n                        _this.viewer.owner.searchModule.navigate(result);\n                        if (result.text === selectionText) {\n                            var replace = isNullOrUndefined(replaceText) ? '' : replaceText;\n                            _this.viewer.owner.searchModule.replace(replace, result, results);\n                            var pattern = _this.viewer.owner.searchModule.textSearch.stringToRegex(findText, _this.findOption);\n                            var endSelection = _this.viewer.selection.end;\n                            var index = endSelection.getHierarchicalIndexInternal();\n                            // tslint:disable-next-line:max-line-length\n                            _this.viewer.owner.searchModule.textSearchResults = _this.viewer.owner.searchModule.textSearch.findAll(pattern, _this.findOption, index);\n                            _this.results = _this.viewer.owner.searchModule.textSearchResults;\n                            if (!isNullOrUndefined(_this.results) && !isNullOrUndefined(_this.results.currentSearchResult)) {\n                                _this.viewer.owner.searchModule.navigate(_this.results.currentSearchResult);\n                            }\n                            else {\n                                _this.messageDiv.style.display = 'block';\n                                _this.messageDiv.innerHTML = _this.localeValue.getConstant(_this.matchDivReplaceText);\n                            }\n                            _this.viewer.owner.findResultsList = [];\n                            if (!isNullOrUndefined(_this.results) && _this.results.innerList.length > 0) {\n                                _this.navigateSearchResult();\n                            }\n                            else {\n                                _this.resultsListBlock.innerHTML = '';\n                            }\n                        }\n                    }\n                    else {\n                        _this.messageDiv.style.display = 'block';\n                        _this.messageDiv.innerHTML = _this.localeValue.getConstant(_this.matchDivReplaceText);\n                    }\n                }\n            }\n        };\n        /**\n         * Fires on replace all.\n         * @private\n         */\n        this.onReplaceAllButtonClick = function () {\n            _this.replaceAll();\n            _this.resultsListBlock.style.display = 'none';\n            _this.messageDiv.innerHTML = '';\n        };\n        /**\n         * Fires on search icon.\n         * @private\n         */\n        this.searchIconClickInternal = function () {\n            // tslint:disable:no-any \n            var inputElement = document.getElementById(_this.viewer.owner.containerId + '_option_search_text_box');\n            // tslint:enable:no-any\n            var text = inputElement.value;\n            if (text === '') {\n                return;\n            }\n            if (_this.searchIcon.classList.contains('e-de-op-search-close-icon')) {\n                _this.searchIcon.classList.add('e-de-op-search-icon');\n                _this.searchIcon.classList.remove('e-de-op-search-close-icon');\n                inputElement.value = '';\n                _this.messageDiv.innerHTML = _this.localeValue.getConstant('No matches');\n                _this.resultContainer.style.display = 'block';\n                _this.resultsListBlock.style.display = 'none';\n                _this.matchDiv.style.display = 'none';\n                _this.occurrenceDiv.style.display = 'none';\n                _this.onEnableDisableReplaceButton();\n                _this.clearFocusElement();\n                _this.resultsListBlock.innerHTML = '';\n                _this.clearSearchResultItems();\n                _this.viewer.owner.searchModule.clearSearchHighlight();\n                _this.viewer.renderVisiblePages();\n                return;\n            }\n            if (_this.searchIcon.classList.contains('e-de-op-search-icon') && text.length >= 1) {\n                _this.searchIcon.classList.add('e-de-op-search-close-icon');\n                _this.searchIcon.classList.remove('e-de-op-search-icon');\n                _this.onEnableDisableReplaceButton();\n            }\n            _this.clearSearchResultItems();\n            _this.viewer.owner.searchModule.clearSearchHighlight();\n            var patterns = _this.viewer.owner.searchModule.textSearch.stringToRegex(text, _this.findOption);\n            var endSelection = _this.viewer.selection.end;\n            var index = endSelection.getHierarchicalIndexInternal();\n            _this.results = _this.viewer.owner.searchModule.textSearch.findAll(patterns, _this.findOption, index);\n            if (_this.results != null && _this.results.length > 0) {\n                _this.navigateSearchResult();\n                _this.getMessageDivHeight();\n                var resultsContainerHeight = _this.viewer.owner.getDocumentEditorElement().offsetHeight - 215;\n                _this.resultsListBlock.style.height = resultsContainerHeight + 'px';\n            }\n            else {\n                _this.messageDiv.innerHTML = _this.localeValue.getConstant('No matches');\n                _this.resultContainer.style.display = 'block';\n                _this.resultsListBlock.style.display = 'none';\n                _this.clearFocusElement();\n                _this.resultsListBlock.innerHTML = '';\n            }\n        };\n        /**\n         * Fires on getting next results.\n         * @private\n         */\n        this.navigateNextResultButtonClick = function () {\n            if (document.getElementById(_this.viewer.owner.containerId + '_list_box_container') != null &&\n                document.getElementById(_this.viewer.owner.containerId + '_list_box_container').style.display !== 'none') {\n                if (_this.results.currentIndex < _this.results.length - 1) {\n                    _this.results.currentIndex = _this.results.currentIndex + 1;\n                    var currentelement = _this.results.innerList[_this.results.currentIndex];\n                    // tslint:disable-next-line:max-line-length\n                    _this.messageDiv.innerHTML = _this.localeValue.getConstant('Result') + ' ' + (_this.results.currentIndex + 1) + ' ' + _this.localeValue.getConstant('of') + ' ' + _this.resultsListBlock.children.length;\n                    for (var i = 0; i < _this.resultsListBlock.children.length; i++) {\n                        var list = _this.resultsListBlock.children[i];\n                        if (list.classList.contains('e-de-search-result-hglt')) {\n                            list.classList.remove('e-de-search-result-hglt');\n                            list.children[0].classList.remove('e-de-op-search-word-text');\n                            list.classList.add('e-de-search-result-item');\n                        }\n                    }\n                    var listElement = _this.resultsListBlock.children[_this.results.currentIndex];\n                    if (listElement.classList.contains('e-de-search-result-item')) {\n                        listElement.classList.remove('e-de-search-result-item');\n                        listElement.classList.add('e-de-search-result-hglt');\n                        listElement.children[0].classList.add('e-de-op-search-word-text');\n                        _this.scrollToPosition(listElement);\n                    }\n                    _this.viewer.owner.searchModule.navigate(currentelement);\n                    _this.viewer.owner.searchModule.highlight(_this.results);\n                }\n                else {\n                    var currentelement = _this.results.innerList[0];\n                    _this.results.currentIndex = 0;\n                    // tslint:disable-next-line:max-line-length\n                    _this.messageDiv.innerHTML = _this.localeValue.getConstant('Result') + ' ' + (_this.results.currentIndex + 1) + ' ' + _this.localeValue.getConstant('of') + ' ' + _this.resultsListBlock.children.length;\n                    for (var j = 0; j < _this.resultsListBlock.children.length; j++) {\n                        var lists = _this.resultsListBlock.children[j];\n                        if (lists.classList.contains('e-de-search-result-hglt')) {\n                            lists.classList.remove('e-de-search-result-hglt');\n                            lists.children[0].classList.remove('e-de-op-search-word-text');\n                            lists.classList.add('e-de-search-result-item');\n                        }\n                    }\n                    var listElementsDiv = _this.resultsListBlock.children[_this.results.currentIndex];\n                    if (listElementsDiv.classList.contains('e-de-search-result-item')) {\n                        listElementsDiv.classList.remove('e-de-search-result-item');\n                        listElementsDiv.classList.add('e-de-search-result-hglt');\n                        listElementsDiv.children[0].classList.add('e-de-op-search-word-text');\n                        _this.scrollToPosition(listElementsDiv);\n                    }\n                    _this.viewer.owner.searchModule.navigate(currentelement);\n                    _this.viewer.owner.searchModule.highlight(_this.results);\n                }\n                _this.focusedIndex = _this.focusedElement.indexOf(_this.navigateToNextResult);\n            }\n        };\n        /**\n         * Fires on getting previous results.\n         * @private\n         */\n        this.navigatePreviousResultButtonClick = function () {\n            if (document.getElementById(_this.viewer.owner.containerId + '_list_box_container') != null &&\n                document.getElementById(_this.viewer.owner.containerId + '_list_box_container').style.display !== 'none') {\n                if (_this.results.currentIndex === 0) {\n                    _this.results.currentIndex = _this.results.length - 1;\n                    // tslint:disable-next-line:max-line-length\n                    _this.messageDiv.innerHTML = _this.localeValue.getConstant('Result') + ' ' + (_this.results.length) + ' ' + _this.localeValue.getConstant('of') + ' ' + _this.resultsListBlock.children.length;\n                    for (var index = 0; index < _this.resultsListBlock.children.length; index++) {\n                        var list = _this.resultsListBlock.children[index];\n                        if (list.classList.contains('e-de-search-result-hglt')) {\n                            list.classList.remove('e-de-search-result-hglt');\n                            list.children[0].classList.remove('e-de-op-search-word-text');\n                            list.classList.add('e-de-search-result-item');\n                        }\n                    }\n                    var liElement = _this.resultsListBlock.children[_this.results.currentIndex];\n                    if (liElement.classList.contains('e-de-search-result-item')) {\n                        liElement.classList.remove('e-de-search-result-item');\n                        liElement.classList.add('e-de-search-result-hglt');\n                        liElement.children[0].classList.add('e-de-op-search-word-text');\n                        _this.scrollToPosition(liElement);\n                    }\n                    var currentelement = _this.results.innerList[_this.results.currentIndex];\n                    _this.viewer.owner.searchModule.navigate(currentelement);\n                    _this.viewer.owner.searchModule.highlight(_this.results);\n                }\n                else {\n                    // tslint:disable-next-line:max-line-length\n                    _this.messageDiv.innerHTML = _this.localeValue.getConstant('Result') + ' ' + (_this.results.currentIndex) + ' ' + _this.localeValue.getConstant('of') + ' ' + _this.resultsListBlock.children.length;\n                    _this.results.currentIndex = _this.results.currentIndex - 1;\n                    for (var j = 0; j < _this.resultsListBlock.children.length; j++) {\n                        var list = _this.resultsListBlock.children[j];\n                        if (list.classList.contains('e-de-search-result-hglt')) {\n                            list.classList.remove('e-de-search-result-hglt');\n                            list.children[0].classList.remove('e-de-op-search-word-text');\n                            list.classList.add('e-de-search-result-item');\n                        }\n                    }\n                    var listElements = _this.resultsListBlock.children[_this.results.currentIndex];\n                    if (listElements.classList.contains('e-de-search-result-item')) {\n                        listElements.classList.remove('e-de-search-result-item');\n                        listElements.classList.add('e-de-search-result-hglt');\n                        listElements.children[0].classList.add('e-de-op-search-word-text');\n                        _this.scrollToPosition(listElements);\n                    }\n                    var currentelement = _this.results.innerList[_this.results.currentIndex];\n                    _this.viewer.owner.searchModule.navigate(currentelement);\n                    _this.viewer.owner.searchModule.highlight(_this.results);\n                }\n                _this.focusedIndex = _this.focusedElement.indexOf(_this.navigateToPreviousResult);\n            }\n        };\n        /**\n         * Fires on key down\n         * @param {KeyboardEvent} event - Speficies key down actions.\n         * @private\n         */\n        this.onKeyDown = function (event) {\n            var code = event.which || event.keyCode;\n            if (code === 13 && event.keyCode !== 9 && event.keyCode !== 40) {\n                event.preventDefault();\n                _this.findDiv.style.height = '';\n                _this.onKeyDownInternal();\n            }\n            else if (code === 8 && (_this.searchInput.value.length === 0)) {\n                _this.resultContainer.style.display = 'block';\n            }\n            else if (event.keyCode !== 9 && event.keyCode !== 40 && event.keyCode !== 27) {\n                _this.viewer.owner.searchModule.clearSearchHighlight();\n                _this.clearSearchResultItems();\n                _this.viewer.renderVisiblePages();\n                _this.resultsListBlock.style.display = 'none';\n                _this.messageDiv.innerHTML = _this.localeValue.getConstant('No matches');\n                _this.resultContainer.style.display = 'none';\n                _this.clearFocusElement();\n                _this.resultsListBlock.innerHTML = '';\n                if (_this.searchIcon.classList.contains('e-de-op-search-close-icon')) {\n                    _this.searchIcon.classList.add('e-de-op-search-icon');\n                    _this.searchIcon.classList.remove('e-de-op-search-close-icon');\n                }\n            }\n            else if (code === 27 && event.keyCode === 27) {\n                _this.showHideOptionsPane(false);\n            }\n        };\n        /**\n         * Close the optios pane.\n         * @private\n         */\n        this.close = function () {\n            _this.clearFocusElement();\n            _this.showHideOptionsPane(false);\n            _this.resultsListBlock.innerHTML = '';\n            _this.focusedIndex = 1;\n            _this.isOptionsPane = true;\n        };\n        /**\n         * Fires on results list block.\n         * @param {MouseEvent} args - Specifies which list was clicked.\n         * @private\n         */\n        this.resultListBlockClick = function (args) {\n            var currentlist = args.target;\n            var element = _this.resultsListBlock.children;\n            var index = 0;\n            for (var i = 0; i < element.length; i++) {\n                var list_1 = element[i];\n                if (list_1.classList.contains('e-de-search-result-hglt')) {\n                    list_1.classList.remove('e-de-search-result-hglt');\n                    list_1.children[0].classList.remove('e-de-op-search-word-text');\n                    list_1.classList.add('e-de-search-result-item');\n                }\n            }\n            var list;\n            for (var i = 0; i < element.length; i++) {\n                if (currentlist === element[i]) {\n                    index = i;\n                    list = element[i];\n                    if (list.classList.contains('e-de-search-result-item')) {\n                        list.classList.remove('e-de-search-result-item');\n                        list.classList.add('e-de-search-result-hglt');\n                        list.children[0].classList.add('e-de-op-search-word-text');\n                        _this.focusedIndex = _this.focusedElement.indexOf(list);\n                    }\n                }\n            }\n            var currentelement = _this.results.innerList[index];\n            _this.results.currentIndex = index;\n            // tslint:disable-next-line:max-line-length\n            _this.messageDiv.innerHTML = _this.localeValue.getConstant('Result') + ' ' + (index + 1) + ' ' + _this.localeValue.getConstant('of') + ' ' + _this.resultsListBlock.children.length;\n            _this.viewer.owner.searchModule.navigate(currentelement);\n            _this.viewer.owner.searchModule.highlight(_this.results);\n            list.focus();\n        };\n        this.viewer = layoutViewer;\n    }\n    /**\n     * Get the module name.\n     */\n    OptionsPane.prototype.getModuleName = function () {\n        return 'OptionsPane';\n    };\n    /**\n     * Initialize the options pane.\n     * @param {L10n} localeValue - Specifies the localization based on culture.\n     * @private\n     */\n    // tslint:disable:max-func-body-length\n    OptionsPane.prototype.initOptionsPane = function (localeValue) {\n        var viewer = this.viewer;\n        this.localeValue = localeValue;\n        this.optionsPane = createElement('div', { className: 'e-de-op', styles: 'display:none;' });\n        this.optionsPane.addEventListener('keydown', this.onKeyDownOnOptionPane);\n        this.searchDiv = createElement('div', {\n            className: this.viewer.owner.containerId + '_searchDiv e-de-op-header',\n            innerHTML: localeValue.getConstant(this.searchText)\n        });\n        this.optionsPane.appendChild(this.searchDiv);\n        // tslint:disable-next-line:max-line-length\n        this.closeButton = createElement('button', { className: 'e-de-op-close-button e-de-op-icon-btn e-btn e-flat e-icon-btn', id: 'close' });\n        this.optionsPane.appendChild(this.closeButton);\n        var closeSpan = createElement('span', { className: 'e-de-op-close-icon e-btn-icon e-icons' });\n        this.closeButton.appendChild(closeSpan);\n        this.focusedElement.push(this.closeButton);\n        this.findTab = createElement('div', { id: this.viewer.owner.containerId + '_findTabDiv', className: 'e-de-op-tab' });\n        this.optionsPane.appendChild(this.findTab);\n        var tabHeader = createElement('div', { className: 'e-tab-header' });\n        this.findTab.appendChild(tabHeader);\n        this.findTabButton = createElement('div', { innerHTML: localeValue.getConstant(this.findPaneText) });\n        this.focusedElement.push(this.findTabButtonHeader);\n        tabHeader.appendChild(this.findTabButton);\n        this.replaceTabButton = createElement('div', { innerHTML: localeValue.getConstant(this.replacePaneText) });\n        this.focusedElement.push(this.replaceTabButtonHeader);\n        tabHeader.appendChild(this.replaceTabButton);\n        var tabContent = createElement('div', { className: 'e-content' });\n        var findTabContent = createElement('div', { id: 'findTabContent' });\n        tabContent.appendChild(findTabContent);\n        this.findTabContentDiv = createElement('div', { className: 'e-de-search-tab-content' });\n        this.searchTextBoxContainer = createElement('div', { className: 'e-input-group e-de-op-input-group' });\n        this.findTabContentDiv.appendChild(this.searchTextBoxContainer);\n        // tslint:disable-next-line:max-line-length\n        this.searchInput = createElement('input', { className: 'e-input e-de-search-input', id: this.viewer.owner.containerId + '_option_search_text_box', attrs: { placeholder: 'Search for' }, styles: 'font-size:14px;' });\n        this.searchTextBoxContainer.appendChild(this.searchInput);\n        this.searchIcon = createElement('span', {\n            className: 'e-de-op-icon e-de-op-search-icon e-input-group-icon e-icon',\n            id: this.viewer.owner.containerId + '_search-icon'\n        });\n        this.searchIcon.tabIndex = 0;\n        this.searchTextBoxContainer.appendChild(this.searchIcon);\n        this.focusedElement.push(this.searchIcon);\n        // tslint:disable-next-line:max-line-length\n        this.navigateToPreviousResult = createElement('span', { className: 'e-de-op-icon e-de-op-nav-btn e-arrow-up e-spin-up e-btn-icon e-icon e-input-group-icon' });\n        this.navigateToPreviousResult.tabIndex = 0;\n        this.searchTextBoxContainer.appendChild(this.navigateToPreviousResult);\n        this.focusedElement.push(this.navigateToPreviousResult);\n        // tslint:disable-next-line:max-line-length\n        this.navigateToNextResult = createElement('span', { className: 'e-de-op-icon e-de-op-nav-btn e-arrow-down e-spin-down e-btn-icon e-icon e-input-group-icon' });\n        this.navigateToNextResult.tabIndex = 0;\n        this.searchTextBoxContainer.appendChild(this.navigateToNextResult);\n        this.focusedElement.push(this.navigateToNextResult);\n        var div = createElement('div', { className: 'e-de-op-more-less' });\n        this.matchInput = createElement('input', {\n            attrs: { type: 'checkbox' },\n            id: this.viewer.owner.containerId + '_matchCase'\n        });\n        div.appendChild(this.matchInput);\n        this.matchCase = new CheckBox({ label: 'Match case', checked: false, change: this.matchChange });\n        this.matchCase.appendTo(this.matchInput);\n        this.focusedElement.push(this.matchInput);\n        this.matchInput.tabIndex = 0;\n        this.wholeInput = createElement('input', {\n            attrs: { type: 'checkbox' },\n            id: this.viewer.owner.containerId + '_wholeWord',\n        });\n        div.appendChild(this.wholeInput);\n        this.wholeWord = new CheckBox({ label: 'Whole words', checked: false, change: this.wholeWordsChange });\n        this.wholeWord.appendTo(this.wholeInput);\n        this.focusedElement.push(this.wholeInput);\n        this.wholeInput.tabIndex = 0;\n        this.findTabContentDiv.appendChild(div);\n        var replaceTabContent = createElement('div');\n        tabContent.appendChild(replaceTabContent);\n        this.replaceTabContentDiv = createElement('div', { className: 'e-de-op-replacetabcontentdiv', styles: 'display:none;' });\n        tabContent.appendChild(this.replaceTabContentDiv);\n        this.findTabContentDiv.appendChild(this.replaceTabContentDiv);\n        this.createReplacePane();\n        this.findDiv = createElement('div', { className: 'findDiv', styles: 'height:250px;display:block;' });\n        findTabContent.appendChild(this.findTabContentDiv);\n        this.resultContainer = createElement('div', { styles: 'width:85%;display:block;', className: 'e-de-op-result-container' });\n        this.findDiv.appendChild(this.resultContainer);\n        // tslint:disable-next-line:max-line-length\n        this.messageDiv = createElement('div', { className: this.viewer.owner.containerId + '_messageDiv e-de-op-msg', innerHTML: this.localeValue.getConstant(this.messageDivText), id: this.viewer.owner.containerId + '_search_status' });\n        this.resultContainer.appendChild(this.messageDiv);\n        // tslint:disable-next-line:max-line-length\n        this.resultsListBlock = createElement('div', { id: this.viewer.owner.containerId + '_list_box_container', styles: 'display:none;width:270px;list-style:none;padding-right:5px;overflow:auto;', className: 'e-de-result-list-block' });\n        this.findDiv.appendChild(this.resultsListBlock);\n        this.findTabContentDiv.appendChild(this.findDiv);\n        this.findTab.appendChild(tabContent);\n        this.tabInstance = new Tab({ selected: this.selectedTabItem });\n        this.tabInstance.appendTo(this.findTab);\n        var findHeader = this.tabInstance.element.getElementsByClassName('e-item e-toolbar-item')[0];\n        this.findTabButtonHeader = findHeader.getElementsByClassName('e-tab-wrap')[0];\n        this.findTabButtonHeader.classList.add('e-de-op-find-tab-header');\n        this.findTabButtonHeader.tabIndex = 0;\n        var replaceHeader = this.tabInstance.element.getElementsByClassName('e-item e-toolbar-item')[1];\n        this.replaceTabButtonHeader = replaceHeader.getElementsByClassName('e-tab-wrap')[0];\n        this.replaceTabButtonHeader.classList.add('e-de-op-replace-tab-header');\n        this.replaceTabButtonHeader.tabIndex = 0;\n        this.onWireEvents();\n    };\n    /**\n     * Create replace pane instances.\n     */\n    OptionsPane.prototype.createReplacePane = function () {\n        this.replaceDiv = createElement('div');\n        this.replaceTabContentDiv.appendChild(this.replaceDiv);\n        this.replaceWith = createElement('input', {\n            className: 'e-de-op-replacewith e-input', styles: 'font-size:14px;',\n            attrs: { placeholder: 'Replace with' }\n        });\n        this.replaceDiv.appendChild(this.replaceWith);\n        var replaceButtonDiv = createElement('div', { styles: 'text-align:right;', className: 'e-de-op-dlg-footer' });\n        this.replaceDiv.appendChild(replaceButtonDiv);\n        this.replaceButton = createElement('button', {\n            className: 'e-control e-btn e-flat e-replace',\n            styles: 'font-size:12px;margin-right:10px;',\n            innerHTML: this.localeValue.getConstant(this.replaceButtonText)\n        });\n        replaceButtonDiv.appendChild(this.replaceButton);\n        this.replaceAllButton = createElement('button', {\n            className: 'e-control e-btn e-flat e-replaceall',\n            styles: 'font-size:12px;',\n            innerHTML: this.localeValue.getConstant(this.replaceAllButtonText)\n        });\n        replaceButtonDiv.appendChild(this.replaceAllButton);\n        this.matchDiv = createElement('div', { styles: 'display:none;padding-top:10px;' });\n        this.replaceDiv.appendChild(this.matchDiv);\n        var emptyDiv6 = createElement('div', { className: 'e-de-op-search-replacediv' });\n        this.replaceDiv.appendChild(emptyDiv6);\n        this.occurrenceDiv = createElement('div', { styles: 'display:none;' });\n        this.replaceDiv.appendChild(this.occurrenceDiv);\n    };\n    OptionsPane.prototype.navigateSearchResult = function () {\n        this.viewer.owner.searchModule.navigate(this.results.innerList[this.results.currentIndex]);\n        this.viewer.owner.searchModule.highlight(this.results);\n        this.viewer.owner.searchModule.addFindResultView(this.results);\n        this.resultsListBlock.style.display = 'block';\n        this.resultContainer.style.display = 'block';\n        var lists = this.viewer.owner.findResultsList;\n        var text = '';\n        for (var i = 0; i < lists.length; i++) {\n            text += lists[i];\n        }\n        this.clearFocusElement();\n        this.resultsListBlock.innerHTML = text;\n        for (var i = 0; i < this.resultsListBlock.children.length; i++) {\n            this.focusedElement.push(this.resultsListBlock.children[i]);\n        }\n        var currentIndexValue = this.results.currentIndex;\n        // tslint:disable-next-line:max-line-length\n        this.messageDiv.innerHTML = this.localeValue.getConstant('Result') + ' ' + (currentIndexValue + 1) + ' ' + this.localeValue.getConstant('of') + ' ' + this.resultsListBlock.children.length;\n        var listElement = this.resultsListBlock.children[currentIndexValue];\n        if (listElement.classList.contains('e-de-search-result-item')) {\n            listElement.classList.remove('e-de-search-result-item');\n            listElement.classList.add('e-de-search-result-hglt');\n            listElement.children[0].classList.add('e-de-op-search-word-text');\n            this.scrollToPosition(listElement);\n        }\n    };\n    /**\n     * Fires on key down actions done.\n     * @private\n     */\n    OptionsPane.prototype.onKeyDownInternal = function () {\n        // tslint:disable-next-line:max-line-length\n        var inputElement = document.getElementById(this.viewer.owner.containerId + '_option_search_text_box');\n        inputElement.blur();\n        var text = inputElement.value;\n        if (text === '') {\n            return;\n        }\n        if (text.length >= 1 && this.searchIcon.classList.contains('e-de-op-search-icon')) {\n            this.searchIcon.classList.add('e-de-op-search-close-icon');\n            this.searchIcon.classList.remove('e-de-op-search-icon');\n        }\n        var resultsContainerHeight = this.viewer.owner.getDocumentEditorElement().offsetHeight - 215;\n        this.clearSearchResultItems();\n        this.viewer.owner.searchModule.clearSearchHighlight();\n        var pattern = this.viewer.owner.searchModule.textSearch.stringToRegex(text, this.findOption);\n        var endSelection = this.viewer.selection.end;\n        var index = endSelection.getHierarchicalIndexInternal();\n        this.results = this.viewer.owner.searchModule.textSearch.findAll(pattern, this.findOption, index);\n        var results = this.results;\n        if (isNullOrUndefined(results)) {\n            this.viewer.renderVisiblePages();\n        }\n        if (results != null && results.length > 0) {\n            if ((this.focusedElement.indexOf(this.navigateToPreviousResult) === -1) && this.isOptionsPane) {\n                this.focusedElement.push(this.navigateToPreviousResult);\n            }\n            if ((this.focusedElement.indexOf(this.navigateToNextResult) === -1) && this.isOptionsPane) {\n                this.focusedElement.push(this.navigateToNextResult);\n            }\n            this.viewer.owner.searchModule.navigate(this.results.innerList[this.results.currentIndex]);\n            this.viewer.owner.searchModule.highlight(results);\n            this.viewer.owner.searchModule.addFindResultView(results);\n            // if (this.isOptionsPane) {\n            this.resultsListBlock.style.display = 'block';\n            this.resultsListBlock.style.height = resultsContainerHeight + 'px';\n            this.resultContainer.style.display = 'block';\n            var list = this.viewer.owner.findResultsList;\n            var text_1 = '';\n            this.clearFocusElement();\n            this.resultsListBlock.innerHTML = '';\n            for (var i = 0; i < list.length; i++) {\n                text_1 += list[i];\n            }\n            this.resultsListBlock.innerHTML = text_1;\n            for (var i = 0; i < this.resultsListBlock.children.length; i++) {\n                this.focusedElement.push(this.resultsListBlock.children[i]);\n            }\n            var lists = this.resultsListBlock.children;\n            var currentIndex = this.results.currentIndex;\n            // tslint:disable-next-line:max-line-length\n            this.messageDiv.innerHTML = this.localeValue.getConstant('Result') + ' ' + (currentIndex + 1) + ' ' + this.localeValue.getConstant('of') + ' ' + this.resultsListBlock.children.length;\n            var listElement = this.resultsListBlock.children[currentIndex];\n            if (listElement.classList.contains('e-de-search-result-item')) {\n                listElement.classList.remove('e-de-search-result-item');\n                listElement.classList.add('e-de-search-result-hglt');\n                listElement.children[0].classList.add('e-de-op-search-word-text');\n            }\n            this.navigateToNextResult.focus();\n            this.focusedIndex = 6;\n            this.getMessageDivHeight();\n            // } else {\n            //this.focusedIndex = 4;\n            // }\n        }\n        else {\n            this.messageDiv.innerHTML = this.localeValue.getConstant('No matches');\n            this.resultContainer.style.display = 'block';\n            this.resultsListBlock.style.display = 'none';\n            this.clearFocusElement();\n            this.resultsListBlock.innerHTML = '';\n        }\n    };\n    OptionsPane.prototype.getMessageDivHeight = function () {\n        if (!this.isOptionsPane && this.messageDiv.classList.contains('e-de-op-msg')) {\n            this.messageDiv.classList.add('e-de-op-replace-messagediv');\n            this.messageDiv.classList.remove('e-de-op-msg');\n        }\n        else if (this.isOptionsPane && this.messageDiv.classList.contains('e-de-op-replace-messagediv')) {\n            this.messageDiv.classList.add('e-de-op-msg');\n            this.messageDiv.classList.remove('e-de-op-replace-messagediv');\n        }\n    };\n    /**\n     * Replace all.\n     * @private\n     */\n    OptionsPane.prototype.replaceAll = function () {\n        var optionsPane = this.optionsPane;\n        var findText = this.searchInput.value;\n        var replaceText = this.replaceWith.value;\n        if (findText !== '' && !isNullOrUndefined(findText)) {\n            var pattern = this.viewer.owner.searchModule.textSearch.stringToRegex(findText, this.findOption);\n            var endSelection = this.viewer.selection.end;\n            var index = endSelection.getHierarchicalIndexInternal();\n            var results = this.viewer.owner.searchModule.textSearch.findAll(pattern, this.findOption, index);\n            var replace = isNullOrUndefined(replaceText) ? '' : replaceText;\n            var count = isNullOrUndefined(results) ? 0 : results.length;\n            this.viewer.owner.searchModule.replaceAll(replace, results);\n            this.matchDiv.style.display = 'block';\n            this.matchDiv.innerHTML = this.localeValue.getConstant('All Done') + '!';\n            this.occurrenceDiv.style.display = 'block';\n            // tslint:disable-next-line:max-line-length\n            this.occurrenceDiv.innerHTML = this.localeValue.getConstant('We replaced all') + ' ' + count + ' ' + this.localeValue.getConstant('instances') + ' ' + this.localeValue.getConstant('of') + ' \"' + findText + '\" ' + this.localeValue.getConstant('with') + ' \"' + replaceText + '\" ';\n        }\n    };\n    /**\n     * Scrolls to position.\n     * @param {HTMLElement} list - Specifies the list element.\n     * @private\n     */\n    OptionsPane.prototype.scrollToPosition = function (list) {\n        var rect = list.getBoundingClientRect();\n        var top;\n        if (rect.top > 0) {\n            top = rect.top - list.parentElement.getBoundingClientRect().top;\n            if ((list.parentElement.offsetHeight - top) <= list.offsetHeight) {\n                if (Math.ceil(top + list.offsetHeight) === list.parentElement.scrollHeight) {\n                    list.parentElement.scrollTop = top;\n                }\n                list.parentElement.scrollTop = list.parentElement.scrollTop + (list.parentElement.offsetHeight / 100) * 30;\n            }\n            else if (top < 0) {\n                list.parentElement.scrollTop = list.parentElement.scrollTop - (list.parentElement.offsetHeight / 100) * 30;\n            }\n        }\n        else {\n            list.parentElement.scrollTop = 0;\n        }\n    };\n    /**\n     * Clear the focus elements.\n     * @private\n     */\n    OptionsPane.prototype.clearFocusElement = function () {\n        for (var i = 0; i < this.resultsListBlock.children.length; i++) {\n            var index = this.focusedElement.indexOf(this.resultsListBlock.children[i]);\n            if (index !== -1) {\n                this.focusedElement.splice(index, 1);\n            }\n        }\n        this.focusedIndex = 0;\n    };\n    /**\n     * Show or hide option pane based on boolean value.\n     * @param {boolean} show - Specifies showing or hiding the options pane.\n     * @private\n     */\n    OptionsPane.prototype.showHideOptionsPane = function (show) {\n        if (!isNullOrUndefined(this.viewer.owner.selectionModule)) {\n            if (show) {\n                this.localeValue = new L10n('documenteditor', this.viewer.owner.defaultLocale);\n                this.localeValue.setLocale(this.viewer.owner.locale);\n                setCulture(this.viewer.owner.locale);\n                if (isNullOrUndefined(this.optionsPane)) {\n                    this.initOptionsPane(this.localeValue);\n                    //Add Option Pane\n                    var element = document.getElementById(this.viewer.owner.element.id);\n                    var optionPaneContainer = document.createElement('div');\n                    optionPaneContainer.className = 'e-documenteditor-optionspane';\n                    optionPaneContainer.setAttribute('style', 'display:inline-flex');\n                    optionPaneContainer.appendChild(this.viewer.owner.optionsPaneModule.optionsPane);\n                    this.viewer.owner.getDocumentEditorElement().appendChild(optionPaneContainer);\n                    optionPaneContainer.appendChild(this.viewer.viewerContainer);\n                    element.appendChild(optionPaneContainer);\n                }\n                this.optionsPane.style.display = 'block';\n                if (this.viewer.owner.isReadOnlyMode) {\n                    this.tabInstance.hideTab(1);\n                }\n                else {\n                    this.tabInstance.hideTab(1, false);\n                }\n                if (this.isReplace && !this.viewer.owner.isReadOnlyMode) {\n                    this.tabInstance.select(1);\n                    this.isReplace = false;\n                    this.isOptionsPane = false;\n                }\n                else {\n                    this.tabInstance.select(0);\n                }\n                this.searchDiv.innerHTML = this.localeValue.getConstant(this.searchText);\n                this.isOptionsPaneShow = true;\n                // tslint:disable-next-line:max-line-length\n                var textBox = document.getElementById(this.viewer.owner.getDocumentEditorElement().id + '_option_search_text_box');\n                var selectedText = this.viewer.owner.selection.text;\n                if (!isNullOrUndefined(selectedText)) {\n                    var char = ['\\v', '\\r'];\n                    var index = HelperMethods.indexOfAny(selectedText, char);\n                    selectedText = index < 0 ? selectedText : selectedText.substring(0, index);\n                }\n                textBox.value = selectedText;\n                textBox.select();\n                this.messageDiv.innerHTML = '';\n                if (this.searchIcon.classList.contains('e-de-op-search-close-icon')) {\n                    this.searchIcon.classList.add('e-de-op-search-icon');\n                    this.searchIcon.classList.remove('e-de-op-search-close-icon');\n                }\n                this.viewer.selection.caret.style.display = 'none';\n                this.focusedIndex = 3;\n                this.focusedElement = [];\n                if (this.isOptionsPane) {\n                    // tslint:disable-next-line:max-line-length\n                    this.focusedElement.push(this.closeButton, this.findTabButtonHeader, this.replaceTabButtonHeader, this.searchInput, this.searchIcon, this.navigateToPreviousResult, this.navigateToNextResult, this.matchInput, this.wholeInput);\n                }\n                else {\n                    // tslint:disable-next-line:max-line-length\n                    this.focusedElement.push(this.closeButton, this.findTabButtonHeader, this.replaceTabButtonHeader, this.searchInput, this.searchIcon, this.navigateToPreviousResult, this.navigateToNextResult, this.matchInput, this.wholeInput, this.replaceWith, this.replaceButton, this.replaceAllButton);\n                }\n                this.viewer.updateViewerSize();\n            }\n            else {\n                if (!isNullOrUndefined(this.optionsPane)) {\n                    this.clearSearchResultItems();\n                    this.viewer.owner.searchModule.clearSearchHighlight();\n                    this.isOptionsPaneShow = false;\n                    var resultListBox = document.getElementById(this.viewer.owner.containerId + '_list_box_container');\n                    var message = document.getElementById(this.viewer.owner.containerId + '_search_status');\n                    if (!isNullOrUndefined(resultListBox) && !isNullOrUndefined(message)) {\n                        resultListBox.style.display = 'none';\n                        this.clearFocusElement();\n                        resultListBox.innerHTML = '';\n                        message.innerHTML = this.localeValue.getConstant('No matches');\n                    }\n                }\n                this.viewer.updateViewerSize();\n                if (!isNullOrUndefined(this.optionsPane)) {\n                    if (this.optionsPane.style.display !== 'none') {\n                        this.viewer.selection.updateCaretPosition();\n                        this.optionsPane.style.display = 'none';\n                    }\n                }\n                this.viewer.updateFocus();\n                this.viewer.selection.caret.style.display = 'block';\n            }\n        }\n    };\n    /**\n     * Clears search results.\n     * @private\n     */\n    OptionsPane.prototype.clearSearchResultItems = function () {\n        if (!isNullOrUndefined(this.viewer.owner.findResultsList)) {\n            this.viewer.owner.findResultsList = [];\n        }\n    };\n    /**\n     * Dispose the internal objects which are maintained.\n     * @private\n     */\n    OptionsPane.prototype.destroy = function () {\n        if (this.optionsPane) {\n            this.optionsPane.innerHTML = '';\n            this.optionsPane = undefined;\n        }\n        if (this.resultsListBlock) {\n            this.resultsListBlock.innerHTML = '';\n            this.resultsListBlock = undefined;\n        }\n        if (this.messageDiv) {\n            this.messageDiv.innerHTML = '';\n            this.messageDiv = undefined;\n        }\n        if (this.resultContainer) {\n            this.resultContainer.innerHTML = '';\n        }\n        this.resultContainer = undefined;\n        if (this.searchInput) {\n            this.searchInput.value = '';\n            this.searchInput = undefined;\n        }\n        if (this.searchDiv) {\n            this.searchDiv.innerHTML = '';\n            this.searchDiv = undefined;\n        }\n        if (this.searchTextBoxContainer) {\n            this.searchTextBoxContainer.innerHTML = '';\n            this.searchTextBoxContainer = undefined;\n        }\n        if (this.replaceWith) {\n            this.replaceWith.innerHTML = '';\n            this.replaceWith = undefined;\n        }\n        if (this.findDiv) {\n            this.findDiv.innerHTML = '';\n            this.findDiv = undefined;\n        }\n        if (this.replaceButton) {\n            this.replaceButton.innerHTML = '';\n            this.replaceButton = undefined;\n        }\n        if (this.replaceAllButton) {\n            this.replaceAllButton.innerHTML = '';\n            this.replaceAllButton = undefined;\n        }\n        if (this.matchInput) {\n            this.matchInput.innerHTML = '';\n            this.matchCase = undefined;\n        }\n        if (this.wholeInput) {\n            this.wholeInput.innerHTML = '';\n            this.wholeWord = undefined;\n        }\n        // if (this.regularInput) {\n        //     this.regularInput.innerHTML = '';\n        //     this.regular = undefined;\n        // }\n        if (!isNullOrUndefined(this.results)) {\n            this.results.destroy();\n        }\n        if (this.focusedElement) {\n            this.focusedElement = [];\n        }\n        this.focusedElement = undefined;\n        this.destroyInternal();\n    };\n    /**\n     * Dispose the internal objects which are maintained.\n     */\n    OptionsPane.prototype.destroyInternal = function () {\n        if (this.searchText) {\n            this.searchText = undefined;\n        }\n        if (this.resultsText) {\n            this.resultsText = undefined;\n        }\n        if (this.messageDivText) {\n            this.messageDivText = undefined;\n        }\n        if (this.replaceButtonText) {\n            this.replaceButtonText = undefined;\n        }\n        if (this.replaceAllButtonText) {\n            this.replaceAllButtonText = undefined;\n        }\n    };\n    return OptionsPane;\n}());\nexport { OptionsPane };\n","import { TableWidget } from '../index';\nimport { isNullOrUndefined } from '@syncfusion/ej2-base';\nimport { Point, HelperMethods } from './editor-helper';\n/**\n * @private\n */\nvar TableResizer = /** @class */ (function () {\n    /**\n     * @private\n     */\n    function TableResizer(node) {\n        this.resizeNode = 0;\n        this.resizerPosition = 0;\n        this.currentResizingTable = undefined;\n        this.owner = node;\n        this.startingPoint = new Point(0, 0);\n    }\n    Object.defineProperty(TableResizer.prototype, \"viewer\", {\n        /**\n         * @private\n         */\n        get: function () {\n            return this.owner.viewer;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    /**\n     * Gets module name.\n     */\n    TableResizer.prototype.getModuleName = function () {\n        return 'TableResizer';\n    };\n    /**\n     * @private\n     */\n    TableResizer.prototype.updateResizingHistory = function (touchPoint) {\n        if (this.owner.editorHistory) {\n            this.owner.editorHistory.updateResizingHistory(touchPoint, this);\n        }\n        this.viewer.isRowOrCellResizing = false;\n        this.resizerPosition = -1;\n    };\n    TableResizer.prototype.handleResize = function (point) {\n        this.owner.viewer.isRowOrCellResizing = true;\n        this.startingPoint.x = point.x;\n        this.startingPoint.y = point.y;\n        //Initialize resizing history.\n        this.owner.editorHistory.initResizingHistory(point, this);\n    };\n    //Table Resizing implementation starts\n    /**\n     * @private\n     */\n    TableResizer.prototype.isInRowResizerArea = function (touchPoint) {\n        var position = this.getRowReSizerPosition(undefined, touchPoint);\n        if (position === -1) {\n            return false;\n        }\n        else {\n            this.resizeNode = 1;\n            this.resizerPosition = position;\n            return true;\n        }\n    };\n    TableResizer.prototype.isInCellResizerArea = function (touchPoint) {\n        var position = this.getCellReSizerPosition(touchPoint);\n        if (position === -1) {\n            return false;\n        }\n        else {\n            this.resizeNode = 0;\n            this.resizerPosition = position;\n            return true;\n        }\n    };\n    /**\n     * Gets cell resizer position.\n     * @param {Point} point\n     * @private\n     */\n    TableResizer.prototype.getCellReSizerPosition = function (touchPoint) {\n        var position = -1;\n        var resizerBoundaryWidth = 2;\n        var tableWidget = this.getTableWidget(touchPoint);\n        var cellWidget = this.getTableCellWidget(touchPoint);\n        var cellSpacing = isNullOrUndefined(tableWidget) ? 0 : tableWidget.tableFormat.cellSpacing;\n        if (tableWidget && cellSpacing > 0) {\n            this.currentResizingTable = tableWidget;\n            // tslint:disable-next-line:max-line-length\n            if (this.viewer.isInsideRect(tableWidget.x - HelperMethods.convertPointToPixel(tableWidget.leftBorderWidth) - 0.25, tableWidget.y, HelperMethods.convertPointToPixel(tableWidget.leftBorderWidth) + 0.5, tableWidget.height, touchPoint)) {\n                return position = 0;\n            }\n            var startingPointX = tableWidget.x;\n            for (var i = 0; i < tableWidget.tableHolder.columns.length; i++) {\n                var preferredWidth = HelperMethods.convertPointToPixel(tableWidget.tableHolder.columns[i].preferredWidth);\n                // tslint:disable-next-line:max-line-length\n                if ((this.viewer.isInsideRect(startingPointX - 1, tableWidget.y, tableWidget.leftBorderWidth + resizerBoundaryWidth, tableWidget.height, touchPoint))) {\n                    return position = i > 0 ? i : 0;\n                    // tslint:disable-next-line:max-line-length\n                }\n                else if (i > 0 && (this.viewer.isInsideRect(startingPointX + preferredWidth - resizerBoundaryWidth / 2, tableWidget.y, resizerBoundaryWidth, tableWidget.height, touchPoint))) {\n                    return position = (i + 1);\n                }\n                startingPointX = startingPointX + preferredWidth;\n            }\n        }\n        else {\n            if (!isNullOrUndefined(cellWidget)) {\n                this.currentResizingTable = cellWidget.ownerTable;\n                // tslint:disable-next-line:max-line-length\n                if (this.viewer.isInsideRect(cellWidget.x - cellWidget.margin.left - resizerBoundaryWidth / 2, cellWidget.y - cellWidget.margin.top, resizerBoundaryWidth, cellWidget.height, touchPoint)) {\n                    return position = cellWidget.columnIndex;\n                    // tslint:disable-next-line:max-line-length\n                }\n                else if (isNullOrUndefined(cellWidget.nextRenderedWidget)\n                    && this.viewer.isInsideRect(cellWidget.x + cellWidget.margin.right + cellWidget.width - resizerBoundaryWidth / 2, cellWidget.y - cellWidget.margin.top, resizerBoundaryWidth, cellWidget.height, touchPoint)) {\n                    return position = (cellWidget.columnIndex + cellWidget.cellFormat.columnSpan);\n                }\n                else if (cellWidget.childWidgets.length > 0) {\n                    return this.getCellReSizerPositionInternal(cellWidget, touchPoint); // Gets the nested table resizer position.\n                }\n            }\n        }\n        return position;\n    };\n    /**\n     * Gets cell resizer position.\n     * @param {TableCellWidget} cellWidget\n     * @param {Point} touchPoint\n     */\n    TableResizer.prototype.getCellReSizerPositionInternal = function (cellWidget, touchPoint) {\n        var position = -1;\n        var childTableWidget = this.getTableWidgetFromWidget(touchPoint, cellWidget);\n        var childCellWidget = undefined;\n        if (!isNullOrUndefined(childTableWidget) && childTableWidget.tableFormat.cellSpacing > 0) {\n            this.currentResizingTable = childTableWidget;\n            // tslint:disable-next-line:max-line-length\n            if (this.viewer.isInsideRect(childTableWidget.x - childTableWidget.leftBorderWidth - 0.25, childTableWidget.y, childTableWidget.leftBorderWidth + 0.5, childTableWidget.height, touchPoint)) {\n                return position = 0;\n            }\n            var startingPointX = childTableWidget.x;\n            for (var i = 0; i < childTableWidget.tableHolder.columns.length; i++) {\n                // tslint:disable-next-line:max-line-length\n                var preferredWidth = HelperMethods.convertPointToPixel(childTableWidget.tableHolder.columns[i].preferredWidth);\n                // tslint:disable-next-line:max-line-length\n                if ((this.viewer.isInsideRect(startingPointX - 1, childTableWidget.y, childTableWidget.leftBorderWidth + 2, childTableWidget.height, touchPoint))) {\n                    return position = i > 0 ? i : 0;\n                    // tslint:disable-next-line:max-line-length\n                }\n                else if (i > 0 && (this.viewer.isInsideRect(startingPointX + preferredWidth - 1, childTableWidget.y, 2, childTableWidget.height, touchPoint))) {\n                    return position = (i + 1);\n                }\n                startingPointX = startingPointX + preferredWidth;\n            }\n        }\n        else {\n            if (!isNullOrUndefined(childTableWidget)) {\n                childCellWidget = childTableWidget.getTableCellWidget(touchPoint);\n            }\n            if (!isNullOrUndefined(childCellWidget)) {\n                this.currentResizingTable = childCellWidget.ownerTable;\n                // tslint:disable-next-line:max-line-length\n                if (this.viewer.isInsideRect(childCellWidget.x - childCellWidget.margin.left - 1, childCellWidget.y - childCellWidget.margin.top, 2, childCellWidget.height, touchPoint)) {\n                    return position = childCellWidget.columnIndex;\n                }\n                else if (isNullOrUndefined(childCellWidget.nextRenderedWidget)\n                    // tslint:disable-next-line:max-line-length\n                    && this.viewer.isInsideRect(childCellWidget.x + childCellWidget.margin.right + childCellWidget.width - 1, childCellWidget.y - childCellWidget.margin.top, 2, childCellWidget.height, touchPoint)) {\n                    return position = (childCellWidget.columnIndex + childCellWidget.cellFormat.columnSpan);\n                }\n                else if (childCellWidget.childWidgets.length > 0) {\n                    return this.getCellReSizerPositionInternal(childCellWidget, touchPoint);\n                }\n            }\n        }\n        return position;\n    };\n    TableResizer.prototype.getRowReSizerPosition = function (widget, touchPoint) {\n        var tableWidget = undefined;\n        var cellWidget = undefined;\n        if (isNullOrUndefined(widget)) {\n            tableWidget = this.getTableWidget(touchPoint);\n            cellWidget = this.getTableCellWidget(touchPoint);\n        }\n        else {\n            tableWidget = this.getTableWidgetFromWidget(touchPoint, widget);\n        }\n        var cellSpacing = isNullOrUndefined(tableWidget) ? 0 : tableWidget.tableFormat.cellSpacing;\n        if (tableWidget && cellSpacing > 0) {\n            this.currentResizingTable = tableWidget;\n            // tslint:disable-next-line:max-line-length\n            if (this.owner.viewer.isInsideRect(tableWidget.x, tableWidget.y + tableWidget.height - cellSpacing, this.getActualWidth(tableWidget.lastChild), (isNullOrUndefined(tableWidget.nextSplitWidget) ? tableWidget.bottomBorderWidth + cellSpacing : 0), touchPoint)) {\n                return tableWidget.lastChild.rowIndex;\n            }\n            for (var i = 0; i < tableWidget.childWidgets.length; i++) {\n                //Need to consider for splitted widgets\n                var rowWidget = tableWidget.childWidgets[i];\n                if (tableWidget.childWidgets.indexOf(rowWidget) > -1\n                    // tslint:disable-next-line:max-line-length\n                    && (this.owner.viewer.isInsideRect(rowWidget.x, rowWidget.y + rowWidget.height + cellSpacing / 2, this.getActualWidth(rowWidget), cellSpacing / 2, touchPoint))) {\n                    return rowWidget.rowIndex;\n                }\n            }\n        }\n        else {\n            if (tableWidget && cellWidget) {\n                cellWidget = this.getTableCellWidget(touchPoint);\n            }\n            if (cellWidget) {\n                var rowWidget = cellWidget.containerWidget;\n                var height = 0;\n                if (rowWidget.rowIndex === rowWidget.ownerTable.childWidgets.length - 1) {\n                    height = rowWidget.bottomBorderWidth + 2;\n                }\n                else {\n                    height = rowWidget.nextRenderedWidget.topBorderWidth + 2;\n                }\n                // tslint:disable-next-line:max-line-length\n                if (this.owner.viewer.isInsideRect(rowWidget.x, rowWidget.y + rowWidget.height - height, rowWidget.width, height * 2, touchPoint)) {\n                    this.currentResizingTable = rowWidget.ownerTable;\n                    return rowWidget.rowIndex;\n                }\n                else {\n                    if (cellWidget.childWidgets.length > 0) {\n                        return this.getRowReSizerPosition(cellWidget, touchPoint);\n                    }\n                }\n            }\n        }\n        return -1;\n    };\n    /**\n     * To handle Table Row and cell resize\n     * @param touchPoint\n     * @private\n     */\n    TableResizer.prototype.handleResizing = function (touchPoint) {\n        var dragValue = 0;\n        if (this.resizeNode === 0) {\n            dragValue = touchPoint.x - this.startingPoint.x;\n            this.resizeTableCellColumn(dragValue);\n        }\n        else {\n            dragValue = touchPoint.y - this.startingPoint.y;\n            this.resizeTableRow(dragValue);\n        }\n    };\n    TableResizer.prototype.resizeTableRow = function (dragValue) {\n        var table = this.currentResizingTable;\n        if (isNullOrUndefined(table) || dragValue === 0) {\n            return;\n        }\n        var selection = this.owner.selection;\n        if (table.isInsideTable) {\n            this.owner.isLayoutEnabled = false; //Layouting is disabled to skip the child table layouting. \n        }\n        if (this.resizerPosition > -1) {\n            var row = table.childWidgets[this.resizerPosition];\n            this.updateRowHeight(row, dragValue);\n            selection.selectPosition(selection.start, selection.end);\n        }\n        if (table.isInsideTable) {\n            var parentTable = this.owner.viewer.layout.getParentTable(table);\n            this.owner.isLayoutEnabled = true; //layouting is enabled to layout the parent table of the nested table.\n            table = parentTable;\n        }\n        this.startingPoint.y += HelperMethods.convertPointToPixel(dragValue);\n        this.owner.viewer.layout.reLayoutTable(table);\n        this.owner.editorModule.reLayout(this.owner.selection);\n    };\n    /**\n     * Gets the table widget from given cursor point\n     * @param cursorPoint\n     */\n    TableResizer.prototype.getTableWidget = function (cursorPoint) {\n        var widget = undefined;\n        var currentPage = this.owner.viewer.currentPage;\n        if (!isNullOrUndefined(currentPage)) {\n            for (var i = 0; i < currentPage.bodyWidgets.length; i++) {\n                var bodyWidget = currentPage.bodyWidgets[i];\n                widget = this.getTableWidgetFromWidget(cursorPoint, bodyWidget);\n                if (!isNullOrUndefined(widget)) {\n                    break;\n                }\n            }\n        }\n        return widget;\n    };\n    TableResizer.prototype.getTableWidgetFromWidget = function (point, widget) {\n        for (var j = 0; j < widget.childWidgets.length; j++) {\n            if (widget.childWidgets[j] instanceof TableWidget) {\n                var childWidget = widget.childWidgets[j];\n                if (childWidget.y <= point.y && (childWidget.y + childWidget.height) >= point.y) {\n                    return childWidget;\n                }\n            }\n        }\n        return undefined;\n    };\n    /**\n     * Return the table cell widget from the given cursor point\n     * @param cursorPoint\n     * @private\n     */\n    TableResizer.prototype.getTableCellWidget = function (cursorPoint) {\n        var widget = undefined;\n        var currentPage = this.owner.viewer.currentPage;\n        if (!isNullOrUndefined(currentPage)) {\n            for (var i = 0; i < currentPage.bodyWidgets.length; i++) {\n                var bodyWidget = currentPage.bodyWidgets[i];\n                widget = bodyWidget.getTableCellWidget(cursorPoint);\n                if (!isNullOrUndefined(widget)) {\n                    break;\n                }\n            }\n        }\n        return widget;\n    };\n    TableResizer.prototype.updateRowHeight = function (row, dragValue) {\n        var rowFormat = row.rowFormat;\n        if (rowFormat.heightType === 'Auto') {\n            rowFormat.heightType = 'AtLeast';\n            var row_1 = rowFormat.ownerBase;\n            var currentHeight = this.owner.viewer.layout.getRowHeight(row_1, [row_1]);\n            //the minimum height of the Row in MS word is 2.7 points which is equal to 3.6 pixel.\n            if (currentHeight + dragValue >= 2.7 && rowFormat.height !== currentHeight + dragValue) {\n                rowFormat.height = currentHeight + dragValue;\n            }\n        }\n        else {\n            //the minimum height of the Row in MS word is 2.7 points which is equal to 3.6 pixel.\n            if (rowFormat.height + dragValue >= 2.7 && rowFormat.height !== rowFormat.height + dragValue) {\n                rowFormat.height = rowFormat.height + dragValue;\n            }\n        }\n    };\n    //Resize Table cell\n    TableResizer.prototype.resizeTableCellColumn = function (dragValue) {\n        var table = this.currentResizingTable;\n        if (isNullOrUndefined(table) || dragValue === 0 || isNullOrUndefined(table.childWidgets)) {\n            return;\n        }\n        var selectionFlag = true;\n        var selection = this.owner.selection;\n        this.owner.editor.setOffsetValue(selection);\n        table = table.combineWidget(this.viewer);\n        this.owner.isLayoutEnabled = false;\n        // table.PreserveGrid = true;\n        this.setPreferredWidth(table);\n        var containerWidth = table.getOwnerWidth(true);\n        var newIndent = table.leftIndent;\n        var tableAlignment = table.tableFormat.tableAlignment;\n        if (!selection.isEmpty) {\n            selectionFlag = this.resizeColumnWithSelection(selection, table, dragValue);\n        }\n        if (!selectionFlag) {\n            this.owner.isLayoutEnabled = true;\n            return;\n        }\n        if (this.resizerPosition === 0) {\n            // Todo: need to handle the resizing of first column and table indent.\n            var columnIndex = this.resizerPosition;\n            var rightColumn = table.tableHolder.columns[columnIndex];\n            var width = rightColumn.preferredWidth;\n            if (dragValue > 0) {\n                var prevDragValue = dragValue;\n                do {\n                    var newWidth = HelperMethods.round(rightColumn.preferredWidth - dragValue, 1);\n                    if (newWidth >= rightColumn.minWidth) {\n                        rightColumn.preferredWidth = newWidth;\n                        newIndent = table.leftIndent + dragValue;\n                        newIndent = newIndent >= -1440 ? (newIndent <= 1440 ? newIndent : 1440) : -1440;\n                        break;\n                    }\n                    else {\n                        prevDragValue = dragValue;\n                        dragValue += newWidth - rightColumn.minWidth;\n                    }\n                } while (dragValue !== prevDragValue);\n            }\n            else {\n                var prevDragValue = dragValue;\n                do {\n                    var newWidth = HelperMethods.round(rightColumn.preferredWidth - dragValue, 1);\n                    if (newWidth <= 2112) {\n                        rightColumn.preferredWidth = newWidth;\n                        newIndent = table.leftIndent + dragValue;\n                        newIndent = newIndent >= -1440 ? (newIndent <= 1440 ? newIndent : 1440) : -1440;\n                        break;\n                    }\n                    else {\n                        prevDragValue = dragValue;\n                        dragValue -= newWidth - 2112;\n                    }\n                } while (dragValue !== prevDragValue);\n            }\n            var dragOffset = dragValue;\n            // tslint:disable-next-line:max-line-length\n            if (tableAlignment !== 'Left' && (table.tableHolder.getTotalWidth() > containerWidth) && table.tableFormat.preferredWidthType === 'Auto') {\n                if (table.tableHolder.isFitColumns(containerWidth, table.tableHolder.tableWidth, table.tableFormat.preferredWidthType === 'Auto')) {\n                    // tslint:disable-next-line:max-line-length\n                    table.tableHolder.fitColumns(containerWidth, table.tableHolder.tableWidth, table.tableFormat.preferredWidthType === 'Auto');\n                }\n                else {\n                    rightColumn.preferredWidth = width;\n                }\n                dragOffset = 0;\n            }\n            if (tableAlignment === 'Center'\n                && (table.tableHolder.getTotalWidth() < containerWidth || table.tableFormat.preferredWidthType !== 'Auto')) {\n                dragOffset = dragOffset / 2;\n            }\n            table.tableFormat.leftIndent = tableAlignment === 'Left' ? newIndent : 0;\n            table.tableHolder.tableWidth = table.tableHolder.getTotalWidth();\n            this.updateCellPreferredWidths(table);\n            this.updateGridValue(table, true, dragOffset);\n        }\n        else if (table !== null && this.resizerPosition === table.tableHolder.columns.length) {\n            // Todo: need to handle the resizing of last column and table width.\n            this.resizeColumnAtLastColumnIndex(table, dragValue, containerWidth);\n        }\n        else {\n            if (this.resizerPosition === -1) {\n                this.owner.isLayoutEnabled = true;\n                return;\n            }\n            this.resizeCellAtMiddle(table, dragValue);\n        }\n        // table.PreserveGrid = false;\n        this.owner.isLayoutEnabled = true;\n        selection.selectPosition(selection.start, selection.end);\n    };\n    /**\n     * Resize Selected Cells\n     */\n    TableResizer.prototype.resizeColumnWithSelection = function (selection, table, dragValue) {\n        var newIndent = table.leftIndent;\n        var cellwidget = this.getTableCellWidget(this.startingPoint);\n        if (cellwidget && (selection.selectedWidgets.containsKey(cellwidget) || (cellwidget.previousWidget\n            && selection.selectedWidgets.containsKey((cellwidget.previousWidget))))) {\n            var selectedCells = selection.getSelectedCells();\n            if (this.resizerPosition === 0) {\n                this.resizeColumnAtStart(table, dragValue, selectedCells);\n            }\n            else if (table !== null && this.resizerPosition === table.tableHolder.columns.length) {\n                var leftColumnCollection = this.getColumnCells(table, this.resizerPosition, true);\n                for (var i = 0; i < leftColumnCollection.length; i++) {\n                    var cell = leftColumnCollection[i];\n                    if (selectedCells.indexOf(cell) !== -1) {\n                        this.increaseOrDecreaseWidth(cell, dragValue, true);\n                    }\n                }\n                //Updates the grid after value for all the rows.\n                this.updateRowsGridAfterWidth(table);\n                table.updateWidth(dragValue);\n                this.updateGridValue(table, true, dragValue);\n            }\n            else {\n                if (this.resizerPosition === -1) {\n                    return false;\n                }\n                var columnIndex = this.resizerPosition;\n                var leftColumnCollection = this.getColumnCells(table, columnIndex, true);\n                var rightColumnCollection = this.getColumnCells(table, columnIndex, false);\n                var isColumnResizing = this.isColumnSelected(table, columnIndex);\n                if (leftColumnCollection.length > 0 && !isColumnResizing) {\n                    for (var i = 0; i < leftColumnCollection.length; i++) {\n                        if (selectedCells.indexOf(leftColumnCollection[i]) === -1) {\n                            leftColumnCollection.splice(i, 1);\n                            i--;\n                        }\n                    }\n                }\n                if (rightColumnCollection.length > 0 && !isColumnResizing) {\n                    for (var i = 0; i < rightColumnCollection.length; i++) {\n                        if (selectedCells.indexOf(rightColumnCollection[i]) === -1) {\n                            rightColumnCollection.splice(i, 1);\n                            i--;\n                        }\n                    }\n                }\n                //Getting the adjacent cell collections for left side selected cells in the right column collection.\n                if (leftColumnCollection.length === 0 && rightColumnCollection.length > 0) {\n                    for (var i = 0; i < rightColumnCollection.length; i++) {\n                        var cell = rightColumnCollection[i];\n                        if (cell.previousWidget) {\n                            leftColumnCollection.push(cell.previousWidget);\n                        }\n                    }\n                }\n                else if (rightColumnCollection.length === 0 && leftColumnCollection.length > 0) {\n                    for (var i = 0; i < leftColumnCollection.length; i++) {\n                        var cell = leftColumnCollection[i];\n                        if (cell.nextWidget) {\n                            rightColumnCollection.push(cell.nextWidget);\n                        }\n                    }\n                }\n                this.changeWidthOfCells(table, leftColumnCollection, rightColumnCollection, dragValue, true);\n                this.updateGridValue(table, true, dragValue);\n            }\n            selection.selectPosition(selection.start, selection.end);\n        }\n        return false;\n    };\n    /**\n     * Resize selected cells at resizer position 0\n     */\n    TableResizer.prototype.resizeColumnAtStart = function (table, dragValue, selectedCells) {\n        var newIndent = table.leftIndent;\n        var rightColumnCollection = this.getColumnCells(table, this.resizerPosition, false);\n        var offset = 0;\n        var selectedRow = selectedCells[0].ownerRow;\n        var rowFormat = selectedRow.rowFormat;\n        if (rowFormat.beforeWidth > 0) {\n            var newGridBefore = rowFormat.beforeWidth + dragValue;\n            if (newGridBefore > 0) {\n                this.updateGridBefore(selectedRow, dragValue);\n            }\n            else {\n                var leastGridBefore = this.getLeastGridBefore(table, selectedRow);\n                if (newGridBefore < leastGridBefore && offset !== newGridBefore) {\n                    newIndent = table.leftIndent + newGridBefore;\n                    table.tableFormat.leftIndent = newIndent >= -1440 ? (newIndent <= 1440 ? newIndent : 1440) : -1440;\n                    for (var i = 0; i < table.childWidgets.length; i++) {\n                        var tableRow = table.childWidgets[i];\n                        if (selectedRow !== tableRow) {\n                            this.updateGridBefore(tableRow, -newGridBefore);\n                        }\n                    }\n                }\n            }\n        }\n        else {\n            if (dragValue < 0) {\n                newIndent = table.leftIndent + dragValue;\n                table.tableFormat.leftIndent = newIndent >= -1440 ? (newIndent <= 1440 ? newIndent : 1440) : -1440;\n                this.updateWidthForCells(table, selectedCells, dragValue);\n            }\n            else {\n                var leastGridBefore = this.getLeastGridBefore(table, selectedRow);\n                var currentTableIndent = table.tableFormat.leftIndent;\n                if (currentTableIndent === 0) {\n                    for (var i = 0; i < table.childWidgets.length; i++) {\n                        var tableRow = table.childWidgets[i];\n                        if (selectedCells.indexOf(tableRow.childWidgets[0]) !== -1) {\n                            this.updateGridBefore(tableRow, dragValue);\n                            this.increaseOrDecreaseWidth(tableRow.childWidgets[0], dragValue, false);\n                        }\n                    }\n                }\n                else {\n                    var difference = leastGridBefore - dragValue;\n                    if (difference > 0) {\n                        newIndent = table.leftIndent + dragValue;\n                        table.tableFormat.leftIndent = newIndent >= -1440 ? (newIndent <= 1440 ? newIndent : 1440) : -1440;\n                        this.updateWidthForCells(table, selectedCells, dragValue);\n                    }\n                    else {\n                        newIndent = table.leftIndent + leastGridBefore;\n                        table.tableFormat.leftIndent = newIndent >= -1440 ? (newIndent <= 1440 ? newIndent : 1440) : -1440;\n                        for (var i = 0; i < table.childWidgets.length; i++) {\n                            var tableRow = table.childWidgets[i];\n                            if (selectedCells.indexOf(tableRow.childWidgets[0]) !== -1) {\n                                this.increaseOrDecreaseWidth(tableRow.childWidgets[0], dragValue, false);\n                                this.updateGridBefore(tableRow, dragValue - leastGridBefore);\n                            }\n                            else {\n                                this.updateGridBefore(tableRow, -leastGridBefore);\n                            }\n                        }\n                    }\n                }\n            }\n        }\n        this.updateGridValue(table, true, dragValue);\n    };\n    TableResizer.prototype.updateWidthForCells = function (table, selectedCells, dragValue) {\n        for (var i = 0; i < table.childWidgets.length; i++) {\n            var tableRow = table.childWidgets[i];\n            if (selectedCells.indexOf(tableRow.childWidgets[0]) !== -1) {\n                this.increaseOrDecreaseWidth(tableRow.childWidgets[0], dragValue, false);\n            }\n            else {\n                this.updateGridBefore(tableRow, -dragValue);\n            }\n        }\n    };\n    /**\n     * Resize selected cells at last column\n     */\n    TableResizer.prototype.resizeColumnAtLastColumnIndex = function (table, dragValue, containerWidth) {\n        var tableAlignment = table.tableFormat.tableAlignment;\n        var preferredWidth = table.tableFormat.preferredWidth;\n        var hasTableWidth = preferredWidth;\n        var columnIndex = this.resizerPosition;\n        var leftColumn = table.tableHolder.columns[columnIndex - 1];\n        var prevDragValue = 0;\n        while (dragValue !== prevDragValue) {\n            var newWidth = HelperMethods.round(leftColumn.preferredWidth + dragValue, 1);\n            if (newWidth >= leftColumn.minWidth) {\n                leftColumn.preferredWidth = newWidth;\n                prevDragValue = dragValue;\n            }\n            else {\n                prevDragValue = dragValue;\n                dragValue -= newWidth - leftColumn.minWidth;\n            }\n        }\n        this.updateCellPreferredWidths(table);\n        if (hasTableWidth || table.tableHolder.getTotalWidth() > containerWidth) {\n            table.updateWidth(dragValue);\n            table.tableHolder.tableWidth = table.tableHolder.getTotalWidth();\n        }\n        var dragOffset = dragValue;\n        if (tableAlignment === 'Right') {\n            dragOffset = 0;\n        }\n        else if (tableAlignment === 'Center') {\n            dragOffset = dragOffset / 2;\n        }\n        this.updateGridValue(table, true, dragOffset);\n    };\n    /**\n     *  Resize selected cells at middle column\n     */\n    TableResizer.prototype.resizeCellAtMiddle = function (table, dragValue) {\n        var columnIndex = this.resizerPosition;\n        var leftColumn = table.tableHolder.columns[columnIndex - 1];\n        var rightColumn = table.tableHolder.columns[columnIndex];\n        if (dragValue > 0) {\n            var isContinue = true;\n            while (isContinue) {\n                var newWidth = HelperMethods.round(rightColumn.preferredWidth - dragValue, 1);\n                if (newWidth >= rightColumn.minWidth) {\n                    rightColumn.preferredWidth = newWidth;\n                    leftColumn.preferredWidth = leftColumn.preferredWidth + dragValue;\n                    isContinue = false;\n                }\n                else {\n                    dragValue += newWidth - rightColumn.minWidth;\n                }\n            }\n        }\n        else {\n            var isContinue = true;\n            while (isContinue) {\n                var newWidth = HelperMethods.round(leftColumn.preferredWidth + dragValue, 1);\n                if (newWidth >= leftColumn.minWidth) {\n                    leftColumn.preferredWidth = newWidth;\n                    rightColumn.preferredWidth = rightColumn.preferredWidth - dragValue;\n                    isContinue = false;\n                }\n                else {\n                    dragValue -= newWidth - leftColumn.minWidth;\n                }\n            }\n        }\n        // Update the cell widths based on the columns preferred width\n        this.updateCellPreferredWidths(table);\n        // table.tableFormat.AllowAutoFit = false;\n        table.tableHolder.tableWidth = table.tableHolder.getTotalWidth();\n        this.updateGridValue(table, false, dragValue);\n    };\n    TableResizer.prototype.updateGridValue = function (table, isUpdate, dragValue) {\n        if (isUpdate) {\n            table.calculateGrid();\n            table.isGridUpdated = false;\n        }\n        table.buildTableColumns();\n        table.isGridUpdated = true;\n        this.viewer.owner.isLayoutEnabled = true;\n        if (table.isInsideTable) {\n            var parentTable = this.viewer.layout.getParentTable(table);\n            this.viewer.layout.reLayoutTable(parentTable); // Need to optmize this.\n        }\n        else {\n            this.viewer.layout.reLayoutTable(table);\n        }\n        this.owner.editor.getOffsetValue(this.viewer.selection);\n        this.owner.editorModule.reLayout(this.owner.selection);\n        if (dragValue) {\n            this.startingPoint.x += HelperMethods.convertPointToPixel(dragValue);\n            this.resizerPosition = this.getCellReSizerPosition(this.startingPoint);\n        }\n    };\n    TableResizer.prototype.getColumnCells = function (table, columnIndex, isLeftSideCollection) {\n        var cells = [];\n        for (var i = 0; i < table.childWidgets.length; i++) {\n            var row = table.childWidgets[i];\n            for (var j = 0; j < row.childWidgets.length; j++) {\n                var cell = row.childWidgets[j];\n                if (isLeftSideCollection) {\n                    if (cell.columnIndex + cell.cellFormat.columnSpan === columnIndex) {\n                        cells.push(cell);\n                    }\n                }\n                else {\n                    if (cell.columnIndex === columnIndex) {\n                        cells.push(cell);\n                    }\n                }\n            }\n        }\n        return cells;\n    };\n    TableResizer.prototype.updateGridBefore = function (row, offset) {\n        if (row.rowFormat.beforeWidth + offset !== row.rowFormat.beforeWidth) {\n            row.rowFormat.beforeWidth = row.rowFormat.beforeWidth + offset;\n            row.rowFormat.gridBeforeWidth = row.rowFormat.beforeWidth;\n        }\n    };\n    TableResizer.prototype.getLeastGridBefore = function (table, ignoreRow) {\n        var gridBefore = 0;\n        var flag = 0;\n        for (var i = 0; i < table.childWidgets.length; i++) {\n            var row = table.childWidgets[i];\n            if (row !== ignoreRow) {\n                if (flag === 0) {\n                    gridBefore = row.rowFormat.beforeWidth;\n                    flag++;\n                }\n                if (row.rowFormat.beforeWidth <= gridBefore) {\n                    gridBefore = row.rowFormat.beforeWidth;\n                }\n            }\n        }\n        return gridBefore;\n    };\n    TableResizer.prototype.increaseOrDecreaseWidth = function (cell, dragValue, isIncrease) {\n        var preferredWidth = cell.cellFormat.preferredWidth;\n        if (cell.cellFormat.preferredWidthType === 'Auto') {\n            preferredWidth = cell.cellFormat.cellWidth;\n            cell.cellFormat.preferredWidthType = 'Point';\n        }\n        var minimumWidth = cell.ownerColumn.minWidth;\n        if (cell.cellFormat.preferredWidthType === 'Percent') {\n            minimumWidth = cell.convertPointToPercent(minimumWidth);\n        }\n        // Margins properties usedd for internal purpose.\n        if (isIncrease) {\n            cell.cellFormat.preferredWidth = preferredWidth + dragValue > minimumWidth ? preferredWidth + dragValue : minimumWidth;\n        }\n        else {\n            cell.cellFormat.preferredWidth = preferredWidth - dragValue > minimumWidth ? preferredWidth - dragValue : minimumWidth;\n        }\n    };\n    // tslint:disable-next-line:max-line-length\n    TableResizer.prototype.changeWidthOfCells = function (table, leftColumnCollection, rightColumnCollection, dragValue, isSelection) {\n        if (leftColumnCollection.length > 0) {\n            var flag = false;\n            for (var i = 0; i < leftColumnCollection.length; i++) {\n                var cell = leftColumnCollection[i];\n                this.increaseOrDecreaseWidth(cell, dragValue, true);\n                if (cell.cellIndex === cell.ownerRow.childWidgets.length - 1) {\n                    flag = true;\n                }\n            }\n            if (flag) {\n                this.updateRowsGridAfterWidth(table);\n            }\n        }\n        if (rightColumnCollection.length > 0) {\n            var diff = 0;\n            for (var i = 0; i < rightColumnCollection.length; i++) {\n                var cell = rightColumnCollection[i];\n                if (cell.cellIndex === 0) {\n                    var newGridBefore = cell.ownerRow.rowFormat.beforeWidth + dragValue;\n                    if (newGridBefore >= 0) {\n                        this.updateGridBefore(cell.ownerRow, dragValue);\n                    }\n                    else {\n                        if (diff !== newGridBefore) {\n                            diff = newGridBefore;\n                        }\n                        cell.ownerRow.rowFormat.gridBeforeWidth = 0;\n                        cell.ownerRow.rowFormat.gridBeforeWidthType = 'Auto';\n                    }\n                }\n                this.increaseOrDecreaseWidth(cell, dragValue, false);\n            }\n            if (diff !== 0) {\n                var newIndent = table.leftIndent + diff;\n                table.tableFormat.leftIndent = newIndent >= -1440 ? (newIndent <= 1440 ? newIndent : 1440) : -1440;\n                for (var j = 0; j < table.childWidgets.length; j++) {\n                    var row = table.childWidgets[j];\n                    if (rightColumnCollection.indexOf(row.childWidgets[0]) === -1) {\n                        this.updateGridBefore(row, diff > 0 ? diff : -diff);\n                    }\n                }\n            }\n        }\n    };\n    TableResizer.prototype.updateRowsGridAfterWidth = function (table) {\n        var maxRowWidth = this.getMaxRowWidth(table, true);\n        for (var i = 0; i < table.childWidgets.length; i++) {\n            var row = table.childWidgets[i];\n            var currentRowWidth = this.getRowWidth(row, true);\n            if (maxRowWidth >= currentRowWidth && row.rowFormat.afterWidth !== maxRowWidth - currentRowWidth) {\n                var value = maxRowWidth - currentRowWidth;\n                row.rowFormat.gridAfterWidth = value;\n                row.rowFormat.afterWidth = value;\n            }\n        }\n    };\n    TableResizer.prototype.getRowWidth = function (row, toUpdateGridAfter) {\n        var rowWidth = 0;\n        if (toUpdateGridAfter) {\n            rowWidth = rowWidth + row.rowFormat.beforeWidth;\n        }\n        for (var i = 0; i < row.childWidgets.length; i++) {\n            var cell = row.childWidgets[i];\n            rowWidth += cell.cellFormat.cellWidth;\n        }\n        return rowWidth;\n    };\n    TableResizer.prototype.getMaxRowWidth = function (table, toUpdateGridAfter) {\n        var width = 0;\n        for (var i = 0; i < table.childWidgets.length; i++) {\n            var row = table.childWidgets[i];\n            var rowWidth = 0;\n            if (toUpdateGridAfter) {\n                rowWidth = rowWidth + row.rowFormat.beforeWidth;\n            }\n            for (var i_1 = 0; i_1 < row.childWidgets.length; i_1++) {\n                var cell = row.childWidgets[i_1];\n                rowWidth += cell.cellFormat.cellWidth;\n            }\n            if (width < rowWidth) {\n                width = rowWidth;\n            }\n        }\n        return width;\n    };\n    TableResizer.prototype.isColumnSelected = function (table, columnIndex) {\n        var selection = this.owner.selection;\n        var selectedCells = selection.getSelectedCells();\n        var leftColumnCells = this.getColumnCells(table, columnIndex, true);\n        var rightColumnCells = this.getColumnCells(table, columnIndex, false);\n        var isColumnSelected = false;\n        for (var i = 0; i < leftColumnCells.length; i++) {\n            var columnCell = leftColumnCells[i];\n            isColumnSelected = selectedCells.indexOf(columnCell) !== -1 ? true : false;\n        }\n        if (!isColumnSelected) {\n            for (var i = 0; i < rightColumnCells.length; i++) {\n                var columnCell = rightColumnCells[i];\n                isColumnSelected = selectedCells.indexOf(columnCell) !== -1 ? true : false;\n            }\n        }\n        return isColumnSelected;\n    };\n    TableResizer.prototype.applyProperties = function (table, tableHistoryInfo) {\n        if (isNullOrUndefined(tableHistoryInfo)) {\n            return;\n        }\n        table = table;\n        // PreserveGrid = true;\n        if (tableHistoryInfo.tableHolder) {\n            table.tableHolder = tableHistoryInfo.tableHolder.clone();\n        }\n        if (tableHistoryInfo.tableFormat !== null) {\n            table.tableFormat.leftIndent = tableHistoryInfo.tableFormat.leftIndent;\n            table.tableFormat.preferredWidth = tableHistoryInfo.tableFormat.preferredWidth;\n            table.tableFormat.preferredWidthType = tableHistoryInfo.tableFormat.preferredWidthType;\n        }\n        for (var i = 0; i < table.childWidgets.length; i++) {\n            var row = table.childWidgets[i];\n            var rowFormat = tableHistoryInfo.rows[i];\n            row.rowFormat.gridBefore = rowFormat.gridBefore;\n            row.rowFormat.gridBeforeWidth = rowFormat.gridBeforeWidth;\n            row.rowFormat.gridBeforeWidthType = rowFormat.gridBeforeWidthType;\n            row.rowFormat.gridAfter = rowFormat.gridAfter;\n            row.rowFormat.gridAfterWidth = rowFormat.gridAfterWidth;\n            row.rowFormat.gridAfterWidthType = rowFormat.gridAfterWidthType;\n            for (var j = 0; j < row.childWidgets.length; j++) {\n                var cell = row.childWidgets[j];\n                var cellFormat = rowFormat.cells[j];\n                cell.columnIndex = cellFormat.columnIndex;\n                cell.cellFormat.columnSpan = cellFormat.columnSpan;\n                cell.cellFormat.preferredWidth = cellFormat.preferredWidth;\n                cell.cellFormat.preferredWidthType = cellFormat.preferredWidthType;\n            }\n        }\n        var containerWidth = table.getOwnerWidth(true);\n        var tableWidth = table.getTableClientWidth(containerWidth);\n        //Sets the width to cells\n        table.setWidthToCells(tableWidth, table.tableFormat.preferredWidthType === 'Auto');\n        // PreserveGrid = false;\n    };\n    /**\n     * Return table row width\n     */\n    TableResizer.prototype.getActualWidth = function (row) {\n        var width = 0;\n        if (row.childWidgets.length > 0) {\n            for (var i = 0; i < row.childWidgets.length; i++) {\n                width += row.childWidgets[i].cellFormat.cellWidth;\n            }\n        }\n        return width;\n    };\n    TableResizer.prototype.setPreferredWidth = function (table) {\n        for (var i = 0; i < table.childWidgets.length; i++) {\n            var rw = table.childWidgets[i];\n            var rowFormat = rw.rowFormat;\n            if (rowFormat.gridBefore > 0) {\n                rowFormat.gridBeforeWidth = rowFormat.beforeWidth;\n                rowFormat.gridBeforeWidthType = 'Point';\n            }\n            for (var j = 0; j < rw.childWidgets.length; j++) {\n                var cell = rw.childWidgets[j];\n                cell.cellFormat.preferredWidth = cell.cellFormat.cellWidth;\n                cell.cellFormat.preferredWidthType = 'Point';\n            }\n            if (rowFormat.gridAfter > 0) {\n                rowFormat.gridAfterWidth = rowFormat.afterWidth;\n                rowFormat.gridAfterWidthType = 'Point';\n            }\n        }\n    };\n    TableResizer.prototype.updateCellPreferredWidths = function (table) {\n        var tableWidth = table.tableHolder.tableWidth;\n        var isAutoFit = table.tableFormat.preferredWidthType === 'Auto';\n        for (var i = 0; i < table.childWidgets.length; i++) {\n            var row = table.childWidgets[i];\n            if (row.rowFormat.gridBefore > 0) {\n                var width = table.tableHolder.getCellWidth(0, row.rowFormat.gridBefore, tableWidth, isAutoFit);\n                this.updateGridBeforeWidth(width, row);\n            }\n            for (var j = 0; j < row.childWidgets.length; j++) {\n                var cell = row.childWidgets[j];\n                cell.updateWidth(table.tableHolder.getCellWidth(cell.columnIndex, cell.cellFormat.columnSpan, tableWidth, isAutoFit));\n            }\n            if (row.rowFormat.gridAfter > 0) {\n                // tslint:disable-next-line:max-line-length\n                this.updateGridAfterWidth(table.tableHolder.getCellWidth(row.childWidgets.length, row.rowFormat.gridAfter, tableWidth, isAutoFit), row);\n            }\n        }\n    };\n    /**\n     * Update grid before width value\n     */\n    TableResizer.prototype.updateGridBeforeWidth = function (width, row) {\n        var rowFormat = row.rowFormat;\n        if (width !== rowFormat.beforeWidth) {\n            rowFormat.beforeWidth = width;\n            if (rowFormat.gridBeforeWidthType === 'Auto') {\n                rowFormat.gridBeforeWidthType = 'Point';\n            }\n            if (rowFormat.gridBeforeWidthType === 'Point') {\n                rowFormat.gridBeforeWidth = rowFormat.beforeWidth;\n            }\n            else {\n                // The value is calculated from the pixel values hence, its converted to percent using method. \n                var ownerWidth = row.ownerTable.getTableClientWidth(row.ownerTable.getOwnerWidth(true));\n                var value = row.ownerTable.convertPointToPercent(rowFormat.beforeWidth, ownerWidth);\n                rowFormat.gridBeforeWidth = value;\n            }\n        }\n    };\n    /**\n     * Update grid after width value\n     */\n    TableResizer.prototype.updateGridAfterWidth = function (width, row) {\n        var rowFormat = row.rowFormat;\n        if (width !== rowFormat.afterWidth) {\n            rowFormat.afterWidth = width;\n        }\n        if (rowFormat.gridAfterWidthType === 'Auto') {\n            rowFormat.gridAfterWidthType = 'Point';\n        }\n        if (rowFormat.gridAfterWidthType === 'Point') {\n            rowFormat.gridAfterWidth = rowFormat.afterWidth;\n        }\n        else {\n            // The value is calculated from the pixel values hence, its converted to percent using method. \n            var ownerWidth = row.ownerTable.getTableClientWidth(row.ownerTable.getOwnerWidth(true));\n            var value = row.ownerTable.convertPointToPercent(rowFormat.afterWidth, ownerWidth);\n            rowFormat.gridAfterWidth = value;\n        }\n    };\n    return TableResizer;\n}());\nexport { TableResizer };\n","import { TextPosition, ImageFormat } from '../selection/selection-helper';\nimport { ParagraphWidget, LineWidget, ElementBox, TextElementBox, Margin, ImageElementBox, BlockWidget, BlockContainer, BodyWidget, TableWidget, TableCellWidget, TableRowWidget, Widget, ListTextElementBox, BookmarkElementBox, HeaderFooterWidget, FieldTextElementBox, TabElementBox } from '../viewer/page';\nimport { WCharacterFormat } from '../format/character-format';\nimport { HelperMethods } from './editor-helper';\nimport { isNullOrUndefined, Browser, classList } from '@syncfusion/ej2-base';\nimport { WParagraphFormat, WSectionFormat, WListFormat, WTableFormat, WRowFormat, WCellFormat, WBorder, WBorders, WTabStop } from '../index';\nimport { WList } from '../list/list';\nimport { WAbstractList } from '../list/abstract-list';\nimport { WListLevel } from '../list/list-level';\nimport { WLevelOverride } from '../list/level-override';\nimport { FieldElementBox } from '../viewer/page';\nimport { WCharacterStyle } from '../format/style';\nimport { TableResizer } from './table-resizer';\nimport { WParagraphStyle } from '../format/style';\n/**\n * Editor module\n */\nvar Editor = /** @class */ (function () {\n    /**\n     * Initialize the editor module\n     * @param  {LayoutViewer} viewer\n     * @private\n     */\n    function Editor(viewer) {\n        var _this = this;\n        this.nodes = [];\n        this.editHyperlinkInternal = false;\n        this.startParagraph = undefined;\n        this.endParagraph = undefined;\n        /**\n         * @private\n         */\n        this.isHandledComplex = false;\n        /**\n         * @private\n         */\n        this.tableResize = undefined;\n        /**\n         * @private\n         */\n        this.tocStyles = {};\n        this.refListNumber = undefined;\n        this.incrementListNumber = -1;\n        this.removedBookmarkElements = [];\n        /**\n         * @private\n         */\n        this.tocBookmarkId = 0;\n        /**\n         * @private\n         */\n        this.copiedData = undefined;\n        this.pageRefFields = {};\n        /**\n         * @private\n         */\n        this.isInsertingTOC = false;\n        /**\n         * @private\n         */\n        this.isBordersAndShadingDialog = false;\n        /**\n         * @private\n         */\n        this.onTextInputInternal = function (event) {\n            if (Browser.isDevice) {\n                var viewer = _this.viewer;\n                var nbsp = new RegExp(String.fromCharCode(160), 'g');\n                var lineFeed = new RegExp(String.fromCharCode(10), 'g');\n                viewer.prefix = viewer.prefix.replace(nbsp, ' ').replace(lineFeed, ' ');\n                var text = viewer.editableDiv.textContent.replace(nbsp, ' ').replace(lineFeed, ' ');\n                var textBoxText = text.substring(2);\n                if (viewer.isCompositionStart && viewer.isCompositionUpdated) {\n                    viewer.isCompositionUpdated = false;\n                    if (!viewer.owner.isReadOnlyMode && viewer.owner.isDocumentLoaded) {\n                        if (viewer.prefix.substring(2) !== textBoxText) {\n                            if (_this.selection.isEmpty) {\n                                // tslint:disable-next-line:max-line-length\n                                _this.selection.start.setPositionForLineWidget(viewer.selection.start.currentWidget, _this.selection.start.offset - (viewer.prefix.length - 2));\n                                _this.handleTextInput(textBoxText);\n                                viewer.prefix = '@' + String.fromCharCode(160) + textBoxText;\n                            }\n                            else {\n                                _this.handleTextInput(textBoxText);\n                                viewer.prefix = '@' + String.fromCharCode(160) + textBoxText;\n                            }\n                        }\n                    }\n                    return;\n                }\n                else if (viewer.isCompositionStart && viewer.isCompositionEnd && viewer.suffix === '') {\n                    if (viewer.prefix.substring(2) !== textBoxText) {\n                        if (_this.selection.isEmpty && viewer.isCompositionStart) {\n                            viewer.isCompositionStart = false;\n                            // tslint:disable-next-line:max-line-length\n                            _this.selection.start.setPositionForLineWidget(viewer.selection.start.currentWidget, _this.selection.start.offset - viewer.prefix.substring(2).length);\n                            _this.selection.retrieveCurrentFormatProperties();\n                            if (viewer.suffix === '' || textBoxText === '') {\n                                _this.handleTextInput(textBoxText);\n                            }\n                        }\n                        else if (!_this.selection.isEmpty) {\n                            viewer.isCompositionStart = false;\n                            _this.handleTextInput(textBoxText);\n                        }\n                    }\n                    else if (textBoxText === '') {\n                        viewer.isCompositionStart = false;\n                        _this.handleBackKey();\n                    }\n                    else if (viewer.prefix.substring(2) === textBoxText && viewer.suffix === '') {\n                        viewer.isCompositionStart = false;\n                        _this.handleTextInput(' ');\n                    }\n                    viewer.isCompositionEnd = false;\n                    return;\n                }\n                else if (viewer.isCompositionEnd || viewer.isCompositionStart && !viewer.compositionUpdated) {\n                    if (textBoxText.length < viewer.prefix.length &&\n                        textBoxText === viewer.prefix.substring(2, viewer.prefix.length - 1) || viewer.editableDiv.innerText.length < 2) {\n                        _this.handleBackKey();\n                        return;\n                    }\n                    else if (viewer.suffix !== '' &&\n                        viewer.editableDiv.innerText[viewer.editableDiv.innerText.length - 1] !== String.fromCharCode(160)) {\n                        viewer.isCompositionStart = false;\n                        //When cursor is placed in between a word and chosen a word from predicted words.\n                        // tslint:disable-next-line:max-line-length\n                        _this.selection.start.setPositionForLineWidget(viewer.selection.start.currentWidget, _this.selection.start.offset - (viewer.prefix.length - 2));\n                        _this.selection.end.setPositionForLineWidget(viewer.selection.end.currentWidget, _this.selection.end.offset + viewer.suffix.length);\n                        //Retrieve the character format properties. Since the selection was changed manually.\n                        _this.selection.retrieveCurrentFormatProperties();\n                        _this.handleTextInput(textBoxText);\n                        return;\n                    }\n                }\n                // tslint:disable-next-line:max-line-length\n                if (text !== '\\r' && text !== '\\b' && text !== '\\u001B' && !viewer.owner.isReadOnlyMode && viewer.isControlPressed === false) {\n                    if (text === '@' || text[0] !== '@' || text === '' || text.length < viewer.prefix.length &&\n                        textBoxText === viewer.prefix.substring(2, viewer.prefix.length - 1)) {\n                        _this.handleBackKey();\n                        if (viewer.editableDiv.innerText.length < 2) {\n                            _this.predictText();\n                        }\n                    }\n                    else if (text.indexOf(viewer.prefix) === 0 && text.length > viewer.prefix.length) {\n                        _this.handleTextInput(text.substring(viewer.prefix.length));\n                    }\n                    else if (text.indexOf(viewer.prefix) === -1 && text[text.length - 1] !== String.fromCharCode(160)\n                        && text[text.length - 1] !== ' ') {\n                        if ((textBoxText.charAt(0).toLowerCase() + textBoxText.slice(1)) === viewer.prefix.substring(2)) {\n                            // tslint:disable-next-line:max-line-length\n                            _this.selection.start.setPositionParagraph(viewer.selection.start.currentWidget, _this.selection.start.offset - (viewer.prefix.length - 2));\n                        }\n                        _this.handleTextInput(textBoxText);\n                    }\n                    else if (text.length !== 2) {\n                        _this.handleTextInput(' ');\n                    }\n                }\n            }\n            else {\n                var text = _this.viewer.editableDiv.innerText;\n                if (text !== String.fromCharCode(160)) {\n                    // tslint:disable-next-line:max-line-length\n                    if (text !== '\\r' && text !== '\\b' && text !== '\\u001B' && !_this.owner.isReadOnlyMode && _this.viewer.isControlPressed === false) {\n                        _this.handleTextInput(text);\n                    }\n                }\n                else {\n                    _this.handleTextInput(' ');\n                }\n                _this.viewer.editableDiv.innerText = '';\n            }\n        };\n        /**\n         * Fired on paste.\n         * @param {ClipboardEvent} event\n         * @private\n         */\n        this.onPaste = function (event) {\n            if (!_this.owner.isReadOnlyMode) {\n                _this.pasteInternal(event);\n            }\n            event.preventDefault();\n        };\n        this.viewer = viewer;\n        this.tableResize = new TableResizer(this.viewer.owner);\n    }\n    Object.defineProperty(Editor.prototype, \"editorHistory\", {\n        get: function () {\n            return this.viewer.owner.editorHistory;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(Editor.prototype, \"selection\", {\n        get: function () {\n            if (this.viewer) {\n                return this.viewer.selection;\n            }\n            return undefined;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(Editor.prototype, \"owner\", {\n        get: function () {\n            return this.viewer.owner;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Editor.prototype.getModuleName = function () {\n        return 'Editor';\n    };\n    Editor.prototype.insertField = function (code, result) {\n        var fieldCode = code;\n        if (isNullOrUndefined(result)) {\n            fieldCode = HelperMethods.trimStart(fieldCode);\n            if (fieldCode.substring(0, 10) === 'MERGEFIELD') {\n                fieldCode = fieldCode.substring(10).trim();\n                var index = fieldCode.indexOf('\\\\*');\n                result = 'Â«' + fieldCode.substring(0, index).trim() + 'Â»';\n            }\n        }\n        var paragraph = new ParagraphWidget();\n        var line = new LineWidget(paragraph);\n        var fieldBegin = new FieldElementBox(0);\n        line.children.push(fieldBegin);\n        var fieldCodeSpan = new TextElementBox();\n        fieldCodeSpan.text = code;\n        line.children.push(fieldCodeSpan);\n        var fieldSeparator = new FieldElementBox(2);\n        fieldSeparator.fieldBegin = fieldBegin;\n        fieldBegin.fieldSeparator = fieldSeparator;\n        line.children.push(fieldSeparator);\n        var fieldResultSpan = new TextElementBox();\n        fieldResultSpan.text = result;\n        line.children.push(fieldResultSpan);\n        var fieldEnd = new FieldElementBox(1);\n        fieldEnd.fieldSeparator = fieldSeparator;\n        fieldEnd.fieldBegin = fieldBegin;\n        fieldBegin.fieldEnd = fieldEnd;\n        fieldSeparator.fieldEnd = fieldEnd;\n        line.children.push(fieldEnd);\n        fieldBegin.line = line;\n        paragraph.childWidgets.push(line);\n        this.viewer.fields.push(fieldBegin);\n        var widgets = [];\n        widgets.push(paragraph);\n        this.pasteContentsInternal(widgets);\n    };\n    /**\n     * To update style for paragraph\n     * @param style - style name\n     * @param clearDirectFormatting - Removes manual formatting (formatting not applied using a style)\n     * from the selected text, to match the formatting of the applied style. Default value is false.\n     */\n    Editor.prototype.applyStyle = function (style, clearDirectFormatting) {\n        clearDirectFormatting = isNullOrUndefined(clearDirectFormatting) ? false : clearDirectFormatting;\n        if (clearDirectFormatting) {\n            this.initComplexHistory('ApplyStyle');\n            this.clearFormatting();\n        }\n        var styleObj = this.viewer.styles.findByName(style);\n        if (styleObj !== undefined) {\n            this.onApplyParagraphFormat('styleName', styleObj, false, true);\n        }\n        else {\n            // tslint:disable-next-line:max-line-length\n            this.viewer.owner.parser.parseStyle(JSON.parse(this.getCompleteStyles()), JSON.parse(this.viewer.preDefinedStyles.get(style)), this.viewer.styles);\n            this.applyStyle(style);\n        }\n        if (this.editorHistory && this.editorHistory.currentHistoryInfo && this.editorHistory.currentHistoryInfo.action === 'ApplyStyle') {\n            this.editorHistory.updateComplexHistory();\n        }\n    };\n    // Public Implementation Starts\n    /**\n     * Moves the selected content in the document editor control to clipboard.\n     */\n    Editor.prototype.cut = function () {\n        if (this.owner.isReadOnlyMode || this.selection.isEmpty) {\n            return;\n        }\n        this.selection.copySelectedContent(true);\n    };\n    /**\n     * Notify content change event\n     * @private\n     */\n    Editor.prototype.fireContentChange = function () {\n        if (this.viewer.owner.isLayoutEnabled && !this.viewer.owner.isShiftingEnabled) {\n            this.viewer.owner.fireContentChange();\n        }\n    };\n    /**\n     * Update physical location for text position\n     * @private\n     */\n    Editor.prototype.updateSelectionTextPosition = function (isSelectionChanged) {\n        this.getOffsetValue(this.selection);\n        this.selection.start.updatePhysicalPosition(true);\n        if (this.selection.isEmpty) {\n            this.selection.end.setPositionInternal(this.selection.start);\n        }\n        else {\n            this.selection.end.updatePhysicalPosition(true);\n        }\n        this.selection.upDownSelectionLength = this.selection.end.location.x;\n        this.selection.fireSelectionChanged(isSelectionChanged);\n    };\n    /**\n     * Predict text\n     * @private\n     */\n    Editor.prototype.predictText = function () {\n        this.viewer.suffix = '';\n        if (this.selection.start.paragraph.isEmpty() || this.selection.start.offset === 0 &&\n            this.selection.start.currentWidget.isFirstLine() || this.selection.end.offset === 0 &&\n            this.selection.end.currentWidget.isFirstLine()) {\n            this.viewer.prefix = '';\n        }\n        else {\n            this.getPrefixAndSuffix();\n        }\n        this.viewer.prefix = '@' + String.fromCharCode(160) + this.viewer.prefix; // &nbsp;\n        this.viewer.editableDiv.innerText = this.viewer.prefix;\n        this.viewer.selection.setEditableDivCaretPosition(this.viewer.prefix.length);\n    };\n    /**\n     * Gets prefix and suffix.\n     * @private\n     */\n    /* tslint:disable:max-func-body-length */\n    Editor.prototype.getPrefixAndSuffix = function () {\n        var viewer = this.viewer;\n        if (this.selection.text !== '') {\n            viewer.prefix = '';\n            return;\n        }\n        else {\n            var startIndex = 0;\n            var inlineInfo = this.selection.start.currentWidget.getInline(this.selection.start.offset, startIndex);\n            var inline = inlineInfo.element;\n            startIndex = inlineInfo.index;\n            if (inline !== undefined) {\n                var boxInfo = this.selection.getElementBoxInternal(inline, startIndex);\n                var box = boxInfo.element;\n                startIndex = boxInfo.index;\n                var spaceIndex = 0;\n                if (!isNullOrUndefined(box)) {\n                    var prefixAdded = false;\n                    if (box instanceof TextElementBox && startIndex > 0 && box.line.isFirstLine()) {\n                        viewer.prefix = '';\n                    }\n                    if (!(inline instanceof TextElementBox)) {\n                        inline = this.selection.getPreviousTextElement(inline);\n                    }\n                    /* tslint:disable:no-conditional-assignment */\n                    while ((spaceIndex = viewer.prefix.lastIndexOf(' ')) < 0 && inline instanceof TextElementBox) {\n                        if (inline.previousNode instanceof TextElementBox && viewer.prefix.indexOf(' ') === -1) {\n                            if (!prefixAdded) {\n                                viewer.prefix = inline.text.substring(0, startIndex);\n                                prefixAdded = true;\n                            }\n                            else {\n                                viewer.prefix = inline.text + viewer.prefix;\n                            }\n                            inline = inline.previousNode;\n                            // If the line has no elements then break the loop to avoid the exception.\n                            if (inline instanceof ListTextElementBox) {\n                                break;\n                            }\n                            if (!(inline instanceof TextElementBox)) {\n                                inline = this.selection.getPreviousTextElement(inline);\n                            }\n                        }\n                        else if (!(inline.previousNode instanceof TextElementBox)) {\n                            if (!prefixAdded) {\n                                viewer.prefix = inline.text.substring(0, startIndex);\n                                prefixAdded = true;\n                            }\n                            else {\n                                viewer.prefix = inline.text + viewer.prefix;\n                            }\n                            break;\n                        }\n                    }\n                    if (!(viewer.prefix.length > 1 && viewer.prefix[viewer.prefix.length - 1] === ' ' &&\n                        viewer.prefix[viewer.prefix.length - 2] === '.')) {\n                        spaceIndex = viewer.prefix.lastIndexOf(' ');\n                    }\n                    else {\n                        spaceIndex = -1;\n                        viewer.prefix = '';\n                    }\n                    viewer.prefix = spaceIndex < 0 ? viewer.prefix : viewer.prefix.substring(spaceIndex);\n                    if (viewer.prefix.indexOf(' ') === 0 && viewer.prefix.length >= 1) {\n                        viewer.prefix = viewer.prefix.substring(1);\n                    }\n                    // suffix text prediction\n                    var endIndex = 0;\n                    var endInlineInfo = this.selection.end.currentWidget.getInline(this.selection.end.offset, endIndex);\n                    var endInline = endInlineInfo.element;\n                    endIndex = endInlineInfo.index;\n                    boxInfo = this.selection.getElementBoxInternal(endInline, endIndex);\n                    box = boxInfo.element;\n                    endIndex = boxInfo.index;\n                    if (box) {\n                        var suffixAdded = false;\n                        if (box instanceof TextElementBox && endIndex < box.length) {\n                            viewer.suffix = '';\n                        }\n                        // boxIndex = renderedElements.get(endInline).indexOf(box);\n                        while ((spaceIndex = viewer.suffix.indexOf(' ')) < 0 && endInline instanceof TextElementBox) {\n                            if (endInline.nextNode instanceof TextElementBox && viewer.suffix.indexOf(' ') === -1) {\n                                if (!suffixAdded) {\n                                    viewer.suffix = box.text.substring(endIndex);\n                                    suffixAdded = true;\n                                }\n                                else {\n                                    viewer.suffix = viewer.suffix + endInline.text;\n                                }\n                                endInline = endInline.nextNode;\n                            }\n                            else if (!(endInline.nextNode instanceof TextElementBox)) {\n                                if (!suffixAdded) {\n                                    viewer.suffix = box.text.substring(endIndex);\n                                    suffixAdded = true;\n                                }\n                                else {\n                                    viewer.suffix = viewer.suffix + endInline.text;\n                                }\n                                break;\n                            }\n                        }\n                        spaceIndex = viewer.suffix.indexOf(' ');\n                        viewer.suffix = spaceIndex < 0 ? viewer.suffix : viewer.suffix.substring(0, spaceIndex);\n                    }\n                }\n            }\n        }\n    };\n    /**\n     * key action\n     * @private\n     */\n    // tslint:disable:max-func-body-length\n    Editor.prototype.onKeyDownInternal = function (event, ctrl, shift, alt) {\n        var key = event.which || event.keyCode;\n        if (ctrl && !shift && !alt) {\n            this.viewer.isControlPressed = true;\n            switch (key) {\n                case 9:\n                    event.preventDefault();\n                    if (this.owner.acceptTab) {\n                        this.selection.handleTabKey(false, false);\n                    }\n                    break;\n                case 13:\n                    event.preventDefault();\n                    this.insertPageBreak();\n                    break;\n                case 48:\n                    event.preventDefault();\n                    this.onApplyParagraphFormat('beforeSpacing', 0, false, false);\n                    break;\n                case 49:\n                    event.preventDefault();\n                    if (!this.owner.isReadOnlyMode) {\n                        this.onApplyParagraphFormat('lineSpacing', 1, false, false);\n                    }\n                    break;\n                case 50:\n                    event.preventDefault();\n                    if (!this.owner.isReadOnlyMode) {\n                        this.onApplyParagraphFormat('lineSpacing', 2, false, false);\n                    }\n                    break;\n                case 53:\n                    event.preventDefault();\n                    if (!this.owner.isReadOnlyMode) {\n                        this.onApplyParagraphFormat('lineSpacing', 1.5, false, false);\n                    }\n                    break;\n                case 66:\n                    event.preventDefault();\n                    if (!this.owner.isReadOnlyMode) {\n                        this.toggleBold();\n                    }\n                    break;\n                case 68:\n                    event.preventDefault();\n                    if (!this.owner.isReadOnlyMode && this.owner.fontDialogModule) {\n                        this.owner.fontDialogModule.showFontDialog();\n                    }\n                    break;\n                case 69:\n                    if (!this.owner.isReadOnlyMode) {\n                        this.toggleTextAlignment('Center');\n                    }\n                    event.preventDefault();\n                    break;\n                case 72:\n                    event.preventDefault();\n                    if (!this.owner.isReadOnly && this.owner.optionsPaneModule) {\n                        this.owner.optionsPaneModule.isReplace = true;\n                        this.owner.optionsPaneModule.showHideOptionsPane(true);\n                    }\n                    break;\n                case 73:\n                    event.preventDefault();\n                    if (!this.owner.isReadOnlyMode) {\n                        this.toggleItalic();\n                    }\n                    break;\n                case 74:\n                    if (!this.owner.isReadOnlyMode) {\n                        this.toggleTextAlignment('Justify');\n                    }\n                    event.preventDefault();\n                    break;\n                case 75:\n                    event.preventDefault();\n                    if (this.owner.hyperlinkDialogModule && !this.owner.isReadOnlyMode) {\n                        this.owner.hyperlinkDialogModule.show();\n                    }\n                    break;\n                case 76:\n                    if (!this.owner.isReadOnlyMode) {\n                        this.toggleTextAlignment('Left');\n                    }\n                    event.preventDefault();\n                    break;\n                case 77:\n                    if (!this.owner.isReadOnlyMode) {\n                        this.owner.selection.increaseIndent();\n                    }\n                    event.preventDefault();\n                    break;\n                case 78:\n                    event.preventDefault();\n                    if (!this.owner.isReadOnlyMode) {\n                        this.owner.openBlank();\n                    }\n                    break;\n                case 82:\n                    if (!this.owner.isReadOnlyMode) {\n                        this.toggleTextAlignment('Right');\n                    }\n                    event.preventDefault();\n                    break;\n                case 85:\n                    event.preventDefault();\n                    if (!this.owner.isReadOnlyMode) {\n                        this.owner.selection.toggleUnderline('Single');\n                    }\n                    break;\n                case 88:\n                    event.preventDefault();\n                    if (!this.owner.isReadOnlyMode) {\n                        this.owner.editor.cut();\n                    }\n                    break;\n                case 89:\n                    if (this.owner.enableEditorHistory) {\n                        this.editorHistory.redo();\n                        event.preventDefault();\n                    }\n                    break;\n                case 90:\n                    if (this.owner.enableEditorHistory) {\n                        this.editorHistory.undo();\n                        event.preventDefault();\n                    }\n                    break;\n                case 219:\n                    event.preventDefault();\n                    if (!this.owner.isReadOnlyMode) {\n                        this.onApplyCharacterFormat('fontSize', 'decrement', true);\n                    }\n                    break;\n                case 221:\n                    event.preventDefault();\n                    if (!this.owner.isReadOnlyMode) {\n                        this.onApplyCharacterFormat('fontSize', 'increment', true);\n                    }\n                    break;\n                case 187:\n                    event.preventDefault();\n                    if (!this.owner.isReadOnlyMode) {\n                        this.toggleBaselineAlignment('Subscript');\n                    }\n                    break;\n            }\n        }\n        else if (shift && !ctrl && !alt) {\n            switch (key) {\n                case 9:\n                    event.preventDefault();\n                    if (this.owner.acceptTab) {\n                        this.selection.handleTabKey(false, true);\n                    }\n                    break;\n                case 13:\n                    this.handleShiftEnter();\n                    event.preventDefault();\n                    break;\n            }\n        }\n        else if (shift && ctrl && !alt) {\n            switch (key) {\n                case 68:\n                    if (!this.owner.isReadOnlyMode) {\n                        this.owner.selection.toggleUnderline('Double');\n                    }\n                    break;\n                case 77:\n                    if (!this.owner.isReadOnlyMode) {\n                        this.owner.selection.decreaseIndent();\n                    }\n                    event.preventDefault();\n                    break;\n                case 188:\n                    event.preventDefault();\n                    if (!this.owner.isReadOnlyMode) {\n                        this.onApplyCharacterFormat('fontSize', 'decrement', true);\n                    }\n                    break;\n                case 190:\n                    event.preventDefault();\n                    if (!this.owner.isReadOnlyMode) {\n                        this.onApplyCharacterFormat('fontSize', 'increment', true);\n                    }\n                    break;\n                case 187:\n                    event.preventDefault();\n                    if (!this.owner.isReadOnlyMode) {\n                        this.toggleBaselineAlignment('Superscript');\n                    }\n            }\n        }\n        else if (!shift && ctrl && alt) {\n            switch (key) {\n                case 72:\n                    event.preventDefault();\n                    if (!this.owner.isReadOnlyMode && this.owner.isDocumentLoaded) {\n                        this.toggleHighlightColor();\n                    }\n                    break;\n            }\n        }\n        else {\n            switch (key) {\n                case 8:\n                    event.preventDefault();\n                    this.handleBackKey();\n                    break;\n                case 9:\n                    event.preventDefault();\n                    if (this.owner.acceptTab) {\n                        this.selection.handleTabKey(true, false);\n                    }\n                    break;\n                case 13:\n                    event.preventDefault();\n                    this.handleEnterKey();\n                    break;\n                case 46:\n                    this.handleDelete();\n                    event.preventDefault();\n                    break;\n            }\n        }\n    };\n    /**\n     * @private\n     */\n    Editor.prototype.handleShiftEnter = function () {\n        if (!this.owner.isReadOnlyMode) {\n            this.handleTextInput('\\v');\n        }\n        this.selection.checkForCursorVisibility();\n    };\n    /**\n     * Handles back key.\n     * @private\n     */\n    Editor.prototype.handleBackKey = function () {\n        if (!this.owner.isReadOnlyMode) {\n            this.owner.editorModule.onBackSpace();\n        }\n        this.selection.checkForCursorVisibility();\n    };\n    /**\n     * Handles delete\n     * @private\n     */\n    Editor.prototype.handleDelete = function () {\n        if (!this.owner.isReadOnlyMode) {\n            this.owner.editorModule.onDelete();\n        }\n        this.selection.checkForCursorVisibility();\n    };\n    /**\n     * Handles enter key.\n     * @private\n     */\n    Editor.prototype.handleEnterKey = function () {\n        if (!this.owner.isReadOnlyMode) {\n            if (Browser.isDevice) {\n                this.viewer.isCompositionStart = false;\n            }\n            this.owner.editorModule.onEnter();\n        }\n        this.selection.checkForCursorVisibility();\n    };\n    /**\n     * @private\n     */\n    Editor.prototype.handleTextInput = function (text) {\n        var _this = this;\n        if (!this.owner.isReadOnlyMode) {\n            if (this.animationTimer) {\n                clearTimeout(this.animationTimer);\n            }\n            classList(this.selection.caret, [], ['e-de-cursor-animation']);\n            this.owner.editorModule.insertText(text, false);\n            /* tslint:disable:align */\n            this.animationTimer = setTimeout(function () {\n                if (_this.animationTimer) {\n                    clearTimeout(_this.animationTimer);\n                }\n                if (_this.selection && _this.selection.caret) {\n                    classList(_this.selection.caret, ['e-de-cursor-animation'], []);\n                }\n            }, 600);\n        }\n        this.selection.checkForCursorVisibility();\n    };\n    /**\n     * Copies to format.\n     * @param  {WCharacterFormat} format\n     * @private\n     */\n    Editor.prototype.copyInsertFormat = function (format, copy) {\n        var insertFormat = new WCharacterFormat();\n        var sFormat = this.selection.characterFormat;\n        if (copy) {\n            insertFormat.copyFormat(format);\n        }\n        if (!isNullOrUndefined(sFormat.bold) && format.bold !== sFormat.bold) {\n            insertFormat.bold = sFormat.bold;\n        }\n        if (!isNullOrUndefined(sFormat.italic) && format.italic !== sFormat.italic) {\n            insertFormat.italic = sFormat.italic;\n        }\n        if (sFormat.fontSize > 0 && format.fontSize !== sFormat.fontSize) {\n            insertFormat.fontSize = sFormat.fontSize;\n        }\n        if (!isNullOrUndefined(sFormat.fontFamily) && format.fontFamily !== sFormat.fontFamily) {\n            insertFormat.fontFamily = sFormat.fontFamily;\n        }\n        if (!isNullOrUndefined(sFormat.highlightColor) && format.highlightColor !== sFormat.highlightColor) {\n            insertFormat.highlightColor = sFormat.highlightColor;\n        }\n        if (!isNullOrUndefined(sFormat.baselineAlignment) && format.baselineAlignment !== sFormat.baselineAlignment) {\n            insertFormat.baselineAlignment = sFormat.baselineAlignment;\n        }\n        if (!isNullOrUndefined(sFormat.fontColor) && format.fontColor !== sFormat.fontColor) {\n            insertFormat.fontColor = sFormat.fontColor;\n        }\n        if (!isNullOrUndefined(sFormat.underline) && format.underline !== sFormat.underline) {\n            insertFormat.underline = sFormat.underline;\n        }\n        if (!isNullOrUndefined(sFormat.strikethrough) && format.strikethrough !== sFormat.strikethrough) {\n            insertFormat.strikethrough = sFormat.strikethrough;\n        }\n        return insertFormat;\n    };\n    /**\n     * Inserts the specified text at cursor position\n     * @param  {string} text\n     * @param  {boolean} isReplace\n     * @private\n     */\n    //tslint:disable: max-func-body-length\n    Editor.prototype.insertText = function (text, isReplace) {\n        var selection = this.viewer.selection;\n        var insertPosition;\n        var isRemoved = true;\n        this.isListTextSelected();\n        this.initHistory('Insert');\n        var paragraphInfo = this.getParagraphInfo(selection.start);\n        this.viewer.selection.editPosition = this.getHierarchicalIndex(paragraphInfo.paragraph, paragraphInfo.offset.toString());\n        if ((!selection.isEmpty && !this.viewer.selection.isImageSelected) ||\n            this.viewer.isListTextSelected && selection.contextType === 'List') {\n            selection.isSkipLayouting = true;\n            selection.skipFormatRetrieval = true;\n            isRemoved = this.removeSelectedContents(selection);\n            selection.skipFormatRetrieval = false;\n            selection.isSkipLayouting = false;\n        }\n        paragraphInfo = this.getParagraphInfo(selection.start);\n        if (isRemoved) {\n            selection.owner.isShiftingEnabled = true;\n            this.updateInsertPosition();\n            insertPosition = selection.start;\n            if (insertPosition.paragraph.isEmpty()) {\n                var span = new TextElementBox();\n                var insertFormat = this.copyInsertFormat(insertPosition.paragraph.characterFormat, true);\n                span.characterFormat.copyFormat(insertFormat);\n                span.text = text;\n                span.line = insertPosition.paragraph.childWidgets[0];\n                span.margin = new Margin(0, 0, 0, 0);\n                span.line.children.push(span);\n                if ((insertPosition.paragraph.paragraphFormat.textAlignment === 'Center'\n                    || insertPosition.paragraph.paragraphFormat.textAlignment === 'Right') &&\n                    insertPosition.paragraph.paragraphFormat.listFormat.listId === -1) {\n                    insertPosition.paragraph.x = this.viewer.clientActiveArea.x;\n                }\n                this.viewer.layout.reLayoutParagraph(insertPosition.paragraph, 0, 0);\n            }\n            else {\n                var indexInInline = 0;\n                var inlineObj = insertPosition.currentWidget.getInline(insertPosition.offset, indexInInline);\n                var inline = inlineObj.element;\n                indexInInline = inlineObj.index;\n                // Todo: compare selection format\n                var insertFormat = this.copyInsertFormat(inline.characterFormat, true);\n                if (insertFormat.isSameFormat(inline.characterFormat)) {\n                    this.insertTextInline(inline, selection, text, indexInInline);\n                }\n                else {\n                    var tempSpan = new TextElementBox();\n                    tempSpan.text = text;\n                    tempSpan.line = inline.line;\n                    tempSpan.characterFormat.copyFormat(insertFormat);\n                    var insertIndex = inline.indexInOwner;\n                    if (indexInInline === inline.length) {\n                        inline.line.children.splice(insertIndex + 1, 0, tempSpan);\n                    }\n                    else if (indexInInline === 0) {\n                        inline.line.children.splice(insertIndex, 0, tempSpan);\n                    }\n                    else {\n                        if (inline instanceof TextElementBox) {\n                            var splittedSpan = new TextElementBox();\n                            splittedSpan.line = inline.line;\n                            splittedSpan.characterFormat.copyFormat(inline.characterFormat);\n                            splittedSpan.text = inline.text.substring(indexInInline);\n                            inline.text = inline.text.slice(0, indexInInline);\n                            inline.line.children.splice(insertIndex + 1, 0, splittedSpan);\n                        }\n                        inline.line.children.splice(insertIndex + 1, 0, tempSpan);\n                    }\n                    this.viewer.layout.reLayoutParagraph(insertPosition.paragraph, inline.line.indexInOwner, 0);\n                }\n            }\n            this.setPositionParagraph(paragraphInfo.paragraph, paragraphInfo.offset + text.length, true);\n            this.updateEndPosition();\n            // tslint:disable-next-line:max-line-length\n            if (!isNullOrUndefined(this.editorHistory) && !isNullOrUndefined(this.editorHistory.currentHistoryInfo) && (this.editorHistory.currentHistoryInfo.action === 'ListSelect') &&\n                this.viewer.isListTextSelected) {\n                this.editorHistory.updateHistory();\n                this.editorHistory.updateComplexHistory();\n            }\n            // if (!isNullOrUndefined(selection.currentHistoryInfo) && (selection.currentHistoryInfo.action === 'MultiSelection')) {\n            //     this.updateComplexHistory();\n            // } else {           \n            this.reLayout(selection);\n            // }\n        }\n        else {\n            // selection.selectContent(selection.start, true);\n        }\n        // insertFormat.destroy();\n        if (!isReplace && isRemoved && (text === ' ' || text === '\\t' || text === '\\v')) {\n            var hyperlinkField = selection.getHyperlinkField();\n            var isSelectionOnHyperlink = !isNullOrUndefined(hyperlinkField);\n            var isList = false;\n            if (!(text === '\\v')) {\n                isList = this.checkAndConvertList(selection, text === '\\t');\n            }\n            if (isSelectionOnHyperlink) {\n                return;\n            }\n            if (!isList) {\n                //Checks if the previous text is URL, then it is auto formatted to hyperlink.\n                this.checkAndConvertToHyperlink(selection, false);\n            }\n        }\n    };\n    /**\n     * Insert Section break at cursor position\n     */\n    Editor.prototype.insertSectionBreak = function () {\n        var selection = this.viewer.selection;\n        if (isNullOrUndefined(selection) || this.owner.isReadOnlyMode || selection.start.paragraph.isInHeaderFooter) {\n            return;\n        }\n        this.initHistory('SectionBreak');\n        if (!selection.isEmpty) {\n            selection.selectContent(selection.isForward ? selection.start : selection.end, true);\n        }\n        this.viewer.owner.isShiftingEnabled = true;\n        this.updateInsertPosition();\n        this.insertSection(selection, true);\n        this.updateEndPosition();\n        this.reLayout(selection, true);\n    };\n    /**\n     * @private\n     */\n    Editor.prototype.insertSection = function (selection, selectFirstBlock) {\n        var newSectionFormat = this.selection.start.paragraph.bodyWidget.sectionFormat.cloneFormat();\n        var lastBlock;\n        var firstBlock;\n        if (selection.start.paragraph.isInsideTable) {\n            var table = this.viewer.layout.getParentTable(selection.start.paragraph);\n            table = table.combineWidget(this.viewer);\n            var insertBefore = false;\n            if (selection.start.paragraph.associatedCell.rowIndex === 0) {\n                insertBefore = true;\n            }\n            var newParagraph = new ParagraphWidget();\n            var previousBlock = table.previousRenderedWidget;\n            if (!insertBefore) {\n                lastBlock = this.splitTable(table, selection.start.paragraph.associatedCell.ownerRow);\n                this.viewer.layout.layoutBodyWidgetCollection(lastBlock.index, lastBlock.containerWidget, lastBlock, false);\n                lastBlock = lastBlock.getSplitWidgets().pop();\n            }\n            else {\n                lastBlock = table;\n            }\n            var insertIndex = 0;\n            if ((isNullOrUndefined(previousBlock) || !previousBlock.bodyWidget.equals(lastBlock.bodyWidget)) && insertBefore) {\n                insertIndex = 0;\n                newParagraph.index = 0;\n            }\n            else {\n                insertIndex = lastBlock.indexInOwner + 1;\n                newParagraph.index = lastBlock.index + 1;\n            }\n            lastBlock.containerWidget.childWidgets.splice(insertIndex, 0, newParagraph);\n            newParagraph.containerWidget = lastBlock.containerWidget;\n            this.updateNextBlocksIndex(newParagraph, true);\n            this.viewer.layout.layoutBodyWidgetCollection(newParagraph.index, newParagraph.containerWidget, newParagraph, false);\n            lastBlock = newParagraph;\n        }\n        else {\n            var paragraphInfo = this.getParagraphInfo(selection.start);\n            var selectionStart = this.getHierarchicalIndex(paragraphInfo.paragraph, paragraphInfo.offset.toString());\n            //Split Paragraph\n            this.splitParagraphInternal(selection, selection.start.paragraph, selection.start.currentWidget, selection.start.offset);\n            this.setPositionForCurrentIndex(selection.start, selectionStart);\n            lastBlock = selection.start.paragraph.getSplitWidgets().pop();\n        }\n        //Split body widget\n        firstBlock = this.splitBodyWidget(lastBlock.bodyWidget, newSectionFormat, lastBlock).firstChild;\n        if (firstBlock instanceof TableWidget) {\n            firstBlock.updateRowIndex(0);\n        }\n        this.viewer.layout.layoutBodyWidgetCollection(firstBlock.index, firstBlock.containerWidget, firstBlock, false);\n        if (firstBlock instanceof TableWidget) {\n            firstBlock = selection.getFirstParagraphInFirstCell(firstBlock);\n        }\n        if (selectFirstBlock) {\n            selection.selectParagraph(firstBlock, true);\n        }\n        return firstBlock;\n    };\n    Editor.prototype.splitBodyWidget = function (bodyWidget, sectionFormat, startBlock) {\n        var sectionIndex;\n        //Move blocks after the start block to next body widget\n        var newBodyWidget = this.viewer.layout.moveBlocksToNextPage(startBlock);\n        //Update SectionIndex for splitted body widget\n        this.updateSectionIndex(sectionFormat, newBodyWidget, true);\n        // insert New header footer widget in to section index \n        this.insertRemoveHeaderFooter(newBodyWidget.sectionIndex, true);\n        //update header and footer for splitted widget\n        this.viewer.layout.layoutHeaderFooter(newBodyWidget, this.viewer, newBodyWidget.page);\n        //Update Child item index from 0 for new Section\n        this.updateBlockIndex(0, newBodyWidget.firstChild);\n        // Start sinfting from first block\n        this.viewer.updateClientArea(newBodyWidget.sectionFormat, newBodyWidget.page);\n        return newBodyWidget;\n    };\n    Editor.prototype.insertRemoveHeaderFooter = function (sectionIndex, insert) {\n        if (this.viewer.headersFooters[sectionIndex]) {\n            // Need to handle further\n        }\n        else {\n            this.viewer.headersFooters[sectionIndex] = {};\n        }\n    };\n    Editor.prototype.updateBlockIndex = function (blockIndex, block) {\n        var blocks;\n        var sectionIndex = block.bodyWidget.sectionIndex;\n        do {\n            blocks = block.getSplitWidgets();\n            for (var i = 0; i < blocks.length; i++) {\n                blocks[i].index = blockIndex;\n            }\n            blockIndex++;\n            block = blocks.pop().nextRenderedWidget;\n        } while (!isNullOrUndefined(block) && block.bodyWidget.sectionIndex === sectionIndex);\n    };\n    Editor.prototype.updateSectionIndex = function (sectionFormat, startBodyWidget, increaseIndex) {\n        var currentSectionIndex = startBodyWidget.sectionIndex;\n        var blockIndex = 0;\n        var bodyWidget = startBodyWidget;\n        do {\n            if (bodyWidget.index === currentSectionIndex && sectionFormat) {\n                bodyWidget.sectionFormat = sectionFormat;\n            }\n            if (increaseIndex) {\n                bodyWidget.index++;\n            }\n            else {\n                bodyWidget.index--;\n            }\n            bodyWidget = bodyWidget.nextRenderedWidget;\n        } while (bodyWidget);\n    };\n    //Auto convert List\n    Editor.prototype.checkAndConvertList = function (selection, isTab) {\n        var list = selection.paragraphFormat.getList();\n        if (!isNullOrUndefined(list)) {\n            return false;\n        }\n        var convertList = false;\n        var isLeadingZero = false;\n        var indexInInline = 0;\n        var inlineObj = selection.start.currentWidget.getInline(selection.start.offset - 1, indexInInline);\n        var inline = inlineObj.element;\n        indexInInline = inlineObj.index;\n        if (!(inline instanceof TextElementBox)) {\n            return false;\n        }\n        var span = inline;\n        var text = span.text.substring(0, indexInInline);\n        var tabValue = 0;\n        var length = 0;\n        while (!isNullOrUndefined(span.previousNode)) {\n            // tslint:disable-next-line:max-line-length\n            if (span.previousNode instanceof TextElementBox && (span.previousNode.text === '\\t' || span.previousNode.text.trim().length === 0)) {\n                (span.previousNode.text === '\\t') ? tabValue += 36 : length = span.previousNode.text.length * 2.5;\n                span = span.previousNode;\n                continue;\n            }\n            return false;\n        }\n        span = inline;\n        var index = 0;\n        var tabIndex = text.lastIndexOf('\\t');\n        index = (tabIndex >= 0) ? tabIndex + 1 : text.lastIndexOf(' ') + 1;\n        while (span.previousNode instanceof TextElementBox && index === 0) {\n            span = span.previousNode;\n            var previousText = span.text;\n            tabIndex = previousText.lastIndexOf('\\t');\n            index = (tabIndex >= 0) ? tabIndex + 1 : previousText.lastIndexOf(' ') + 1;\n            text = span.text + text;\n            text = text.substring(index);\n        }\n        text = HelperMethods.trimStart(text);\n        var numberFormat = text.substring(1, 2);\n        var listLevelPattern = this.getListLevelPattern(text.substring(0, 1));\n        if (listLevelPattern !== 'None' && this.checkNumberFormat(numberFormat, listLevelPattern === 'Bullet', text)) {\n            convertList = true;\n        }\n        else if (this.checkLeadingZero(text)) {\n            isLeadingZero = true;\n            convertList = true;\n        }\n        if (convertList) {\n            this.initComplexHistory('AutoList');\n            var paragraph = inline.paragraph;\n            // tslint:disable-next-line:max-line-length\n            selection.start.setPositionParagraph(paragraph.childWidgets[0], paragraph.childWidgets[0].getOffset(inline, indexInInline + 1));\n            selection.end.setPositionParagraph(paragraph.childWidgets[0], 0);\n            this.initHistory('Delete');\n            this.deleteSelectedContents(selection, false);\n            this.reLayout(selection, false);\n            var followCharacter = isTab ? 'Tab' : 'Space';\n            numberFormat = !isLeadingZero ? '%1' + numberFormat : '%1' + text.substring(text.length - 1, text.length);\n            var leadingZeroText = text.substring(text.length - 3, text.length - 1);\n            listLevelPattern = !isLeadingZero ? listLevelPattern : this.getListLevelPattern(leadingZeroText);\n            var listLevel = new WListLevel(undefined);\n            listLevel.listLevelPattern = listLevelPattern;\n            if (listLevelPattern === 'Bullet') {\n                if (text === '*') {\n                    listLevel.numberFormat = '\\uf0b7';\n                    listLevel.characterFormat.fontFamily = 'Symbol';\n                }\n                else if (text === '-') {\n                    listLevel.numberFormat = '-';\n                }\n            }\n            else {\n                listLevel.numberFormat = numberFormat;\n            }\n            listLevel.followCharacter = followCharacter;\n            var leftIndent = selection.paragraphFormat.leftIndent;\n            if (tabValue !== 0 || length !== 0) {\n                listLevel.paragraphFormat.leftIndent = leftIndent + 18 + tabValue + length;\n            }\n            else if (indexInInline > 2) {\n                listLevel.paragraphFormat.leftIndent = leftIndent + (indexInInline - 2) * 2.5 + 18;\n            }\n            else if (leftIndent > 0) {\n                listLevel.paragraphFormat.leftIndent = leftIndent + 18;\n            }\n            else {\n                listLevel.paragraphFormat.leftIndent = 36;\n            }\n            listLevel.paragraphFormat.firstLineIndent = -18;\n            if ((!isLeadingZero && text.substring(0, 1) === '0') || leadingZeroText === '00') {\n                listLevel.startAt = 0;\n            }\n            else {\n                listLevel.startAt = 1;\n            }\n            this.autoConvertList(selection, listLevel);\n            if (this.editorHistory && !isNullOrUndefined(this.editorHistory.currentHistoryInfo)) {\n                this.editorHistory.updateComplexHistory();\n            }\n            else {\n                this.reLayout(selection);\n            }\n        }\n        return convertList;\n    };\n    Editor.prototype.getListLevelPattern = function (value) {\n        switch (value) {\n            case '0':\n            case '1':\n                return 'Arabic';\n            case 'I':\n                return 'UpRoman';\n            case 'i':\n                return 'LowRoman';\n            case 'A':\n                return 'UpLetter';\n            case 'a':\n                return 'LowLetter';\n            case '*':\n            case '-':\n                return 'Bullet';\n            case '00':\n            case '01':\n                return 'LeadingZero';\n            default:\n                return 'None';\n        }\n    };\n    Editor.prototype.autoConvertList = function (selection, listLevel) {\n        var start = selection.start;\n        if (!selection.isForward) {\n            start = selection.end;\n        }\n        var newList = new WList();\n        if (this.viewer.lists.length > 0) {\n            newList.listId = this.viewer.lists[this.viewer.lists.length - 1].listId + 1;\n        }\n        else {\n            newList.listId = 0;\n        }\n        var newAbstractList = new WAbstractList();\n        var layout = this.viewer;\n        if (layout.abstractLists.length > 0) {\n            newAbstractList.abstractListId = layout.abstractLists[layout.abstractLists.length - 1].abstractListId + 1;\n        }\n        else {\n            newAbstractList.abstractListId = 0;\n        }\n        newList.abstractListId = newAbstractList.abstractListId;\n        layout.abstractLists.push(newAbstractList);\n        newAbstractList.levels.push(listLevel);\n        listLevel.ownerBase = newAbstractList;\n        selection.paragraphFormat.setList(newList);\n        selection.paragraphFormat.listLevelNumber = 0;\n    };\n    Editor.prototype.checkNumberFormat = function (numberFormat, isBullet, text) {\n        if (isBullet) {\n            return numberFormat === '';\n        }\n        else {\n            var index = text.indexOf(numberFormat);\n            return (numberFormat === '.' || numberFormat === ')'\n                || numberFormat === '>' || numberFormat === '-') && text.substring(index, text.length - 1) === '';\n        }\n    };\n    Editor.prototype.checkLeadingZero = function (text) {\n        var j;\n        var isZero = false;\n        for (var i = 0; i <= text.length - 1; i++) {\n            if (text.charAt(i) === '0') {\n                isZero = true;\n                continue;\n            }\n            j = i;\n            break;\n        }\n        var numberFormat = undefined;\n        if (text.charAt(j) === '1') {\n            numberFormat = text.charAt(j + 1);\n        }\n        else {\n            numberFormat = text.charAt(j);\n        }\n        return isZero && this.checkNumberFormat(numberFormat, false, text);\n    };\n    Editor.prototype.getPageFromBlockWidget = function (block) {\n        var page = undefined;\n        if (block.containerWidget instanceof BodyWidget) {\n            page = block.containerWidget.page;\n        }\n        else if (block.containerWidget instanceof HeaderFooterWidget) {\n            page = block.containerWidget.page;\n        }\n        else if (block.containerWidget instanceof TableCellWidget) {\n            page = block.containerWidget.bodyWidget.page;\n        }\n        return page;\n    };\n    /**\n     * @private\n     */\n    Editor.prototype.insertTextInline = function (element, selection, text, index) {\n        if (element instanceof TextElementBox) {\n            element.text = HelperMethods.insert(element.text, index, text);\n            var paragraph = element.line.paragraph;\n            var lineIndex = paragraph.childWidgets.indexOf(element.line);\n            var elementIndex = element.line.children.indexOf(element);\n            this.viewer.layout.reLayoutParagraph(paragraph, lineIndex, elementIndex);\n        }\n        else if (element instanceof ImageElementBox) {\n            this.insertImageText(element, selection, text, index);\n        }\n        else if (element instanceof FieldElementBox) {\n            if (element.fieldType === 0) {\n                this.insertFieldBeginText(element, selection, text, index);\n            }\n            else if (element.fieldType === 2) {\n                this.insertFieldSeparatorText(element, selection, text, index);\n            }\n            else {\n                this.insertFieldEndText(element, selection, text, index);\n            }\n        }\n        else if (element instanceof BookmarkElementBox) {\n            this.insertBookMarkText(element, selection, text, index);\n        }\n    };\n    Editor.prototype.insertFieldBeginText = function (fieldBegin, selection, text, index) {\n        var spanObj = new TextElementBox();\n        spanObj.text = text;\n        var lineIndex = fieldBegin.line.paragraph.childWidgets.indexOf(fieldBegin.line);\n        var spanIndex = fieldBegin.line.children.indexOf(fieldBegin);\n        spanObj.characterFormat.copyFormat(fieldBegin.characterFormat);\n        fieldBegin.line.children.splice(spanIndex, 0, spanObj);\n        spanObj.line = fieldBegin.line;\n        this.viewer.layout.reLayoutParagraph(fieldBegin.line.paragraph, lineIndex, spanIndex);\n    };\n    Editor.prototype.insertBookMarkText = function (element, selection, text, index) {\n        var spanObj = new TextElementBox();\n        spanObj.text = text;\n        var lineIndex = element.line.paragraph.childWidgets.indexOf(element.line);\n        var spanIndex = element.line.children.indexOf(element);\n        spanObj.characterFormat.copyFormat(element.characterFormat);\n        element.line.children.splice(spanIndex, 0, spanObj);\n        spanObj.line = element.line;\n        this.viewer.layout.reLayoutParagraph(element.line.paragraph, lineIndex, spanIndex);\n    };\n    Editor.prototype.insertFieldSeparatorText = function (fieldSeparator, selection, text, index) {\n        var previousInline = selection.getPreviousTextInline(fieldSeparator);\n        var nextInline = selection.getNextTextInline(fieldSeparator);\n        var span = new TextElementBox();\n        span.text = text;\n        var spanIndex = fieldSeparator.line.children.indexOf(fieldSeparator);\n        if (index === fieldSeparator.length) {\n            spanIndex++;\n        }\n        if (isNullOrUndefined(previousInline) && isNullOrUndefined(nextInline)) {\n            span.characterFormat.copyFormat(fieldSeparator.line.paragraph.characterFormat);\n        }\n        else if (isNullOrUndefined(previousInline)) {\n            span.characterFormat.copyFormat(nextInline.characterFormat);\n        }\n        else {\n            span.characterFormat.copyFormat(previousInline.characterFormat);\n        }\n        fieldSeparator.line.children.splice(spanIndex, 0, span);\n        span.line = fieldSeparator.line;\n        var lineIndex = fieldSeparator.line.paragraph.childWidgets.indexOf(fieldSeparator.line);\n        this.viewer.layout.reLayoutParagraph(fieldSeparator.line.paragraph, lineIndex, spanIndex);\n    };\n    Editor.prototype.insertFieldEndText = function (fieldEnd, selection, text, index) {\n        var span = new TextElementBox();\n        span.text = text;\n        var spanIndex = fieldEnd.line.children.indexOf(fieldEnd);\n        span.characterFormat.copyFormat(fieldEnd.characterFormat);\n        fieldEnd.line.children.splice(spanIndex + 1, 0, span);\n        span.line = fieldEnd.line;\n        var lineIndex = fieldEnd.line.paragraph.childWidgets.indexOf(fieldEnd.line);\n        this.viewer.layout.reLayoutParagraph(fieldEnd.line.paragraph, lineIndex, spanIndex);\n    };\n    Editor.prototype.insertImageText = function (image, selection, text, index) {\n        var previousInlineObj = selection.getPreviousTextInline(image);\n        var nextInlineObj = selection.getNextTextInline(image);\n        var line = image.line;\n        var element = new TextElementBox();\n        var paragraph = line.paragraph;\n        var lineIndex = paragraph.childWidgets.indexOf(line);\n        element.text = text;\n        var spanIndex = line.children.indexOf(image);\n        if (index === image.length) {\n            spanIndex++;\n        }\n        if (isNullOrUndefined(previousInlineObj) && isNullOrUndefined(nextInlineObj)) {\n            element.characterFormat.copyFormat(paragraph.characterFormat);\n        }\n        else if (isNullOrUndefined(previousInlineObj)) {\n            element.characterFormat.copyFormat(nextInlineObj.characterFormat);\n        }\n        else {\n            element.characterFormat.copyFormat(previousInlineObj.characterFormat);\n        }\n        line.children.splice(spanIndex, 0, element);\n        element.line = line;\n        this.viewer.layout.reLayoutParagraph(paragraph, lineIndex, spanIndex);\n    };\n    /**\n     * @private\n     */\n    Editor.prototype.isListTextSelected = function () {\n        if (this.viewer.isListTextSelected) {\n            this.initComplexHistory('ListSelect');\n            // tslint:disable-next-line:max-line-length\n            if (this.viewer.selection.start.paragraph.paragraphFormat.listFormat && this.viewer.selection.start.paragraph.paragraphFormat.listFormat.listId !== -1) {\n                this.onApplyList(undefined);\n            }\n        }\n    };\n    //Auto Format and insert Hyperlink Implementation starts\n    Editor.prototype.checkAndConvertToHyperlink = function (selection, isEnter, paragraph) {\n        var text;\n        var span;\n        if (isEnter) {\n            span = paragraph.lastChild.children[paragraph.lastChild.children.length - 1];\n            text = span.text;\n        }\n        else {\n            var indexInInline = 0;\n            var inlineObj = selection.start.currentWidget.getInline(selection.start.offset - 1, indexInInline);\n            var inline = inlineObj.element;\n            indexInInline = inlineObj.index;\n            if (!(inline instanceof TextElementBox)) {\n                return;\n            }\n            span = inline;\n            text = span.text.substring(0, indexInInline);\n        }\n        var index = 0;\n        var tabCharIndex = text.lastIndexOf('\\t');\n        index = (tabCharIndex >= 0) ? tabCharIndex + 1 : text.lastIndexOf(' ') + 1;\n        while (span.previousNode instanceof TextElementBox && index === 0) {\n            span = span.previousNode;\n            var previousText = span.text;\n            tabCharIndex = previousText.lastIndexOf('\\t');\n            index = (tabCharIndex >= 0) ? tabCharIndex + 1 : previousText.lastIndexOf(' ') + 1;\n            text = span.text + text;\n        }\n        text = text.substring(index);\n        var lowerCaseText = text.toLowerCase();\n        var containsURL = false;\n        if (lowerCaseText.substring(0, 8) === 'file:///'\n            || (lowerCaseText.substring(0, 7) === 'http://' && lowerCaseText.length > 7)\n            || (lowerCaseText.substring(0, 8) === 'https://' && lowerCaseText.length > 8)\n            || (lowerCaseText.substring(0, 4) === 'www.' && lowerCaseText.length > 4)\n            || (lowerCaseText.substring(0, 3) === '\\\\' && lowerCaseText.length > 3)\n            || (lowerCaseText.substring(0, 7) === 'mailto:' && lowerCaseText.length > 7)) {\n            containsURL = true;\n            if (lowerCaseText.substring(0, 4) === 'www.' && lowerCaseText.length > 4) {\n                text = 'http://' + text;\n            }\n        }\n        else {\n            var atIndex = text.indexOf('@');\n            var dotIndex = text.indexOf('.');\n            if (atIndex > 0 && atIndex < dotIndex && dotIndex < text.length - 1) {\n                containsURL = true;\n                text = 'mailto:' + text;\n            }\n        }\n        if (containsURL) {\n            var startPos = new TextPosition(this.viewer.owner);\n            startPos.setPositionParagraph(span.line, span.line.getOffset(span, index));\n            var endPos = new TextPosition(this.viewer.owner);\n            if (isEnter) {\n                endPos.setPositionParagraph(span.line, span.line.getEndOffset());\n            }\n            else {\n                if (selection.end.currentWidget.children.length === 0 && selection.end.offset === 0) {\n                    var prevLine = selection.end.currentWidget.previousLine;\n                    endPos.setPositionParagraph(prevLine, prevLine.getEndOffset());\n                }\n                else {\n                    endPos.setPositionParagraph(selection.end.currentWidget, selection.end.offset - 1);\n                }\n            }\n            this.autoFormatHyperlink(selection, text, startPos, endPos);\n        }\n    };\n    Editor.prototype.autoFormatHyperlink = function (selection, url, startPosition, endPosition) {\n        this.initComplexHistory('AutoFormatHyperlink');\n        var blockInfo = this.getParagraphInfo(startPosition);\n        var start = this.getHierarchicalIndex(blockInfo.paragraph, blockInfo.offset.toString());\n        if (this.editorHistory && this.editorHistory.currentHistoryInfo) {\n            this.editorHistory.currentHistoryInfo.insertPosition = start;\n        }\n        // Moves the selection to URL text start and end position.\n        selection.start.setPositionInternal(startPosition);\n        selection.end.setPositionInternal(endPosition);\n        // Preserves the character format for hyperlink field.\n        var temp = this.getCharacterFormat(selection);\n        var format = new WCharacterFormat();\n        format.copyFormat(temp);\n        var fieldEnd = this.createHyperlinkElement(url, startPosition, endPosition, format);\n        // Moves the selection to the end of field end position.\n        selection.start.setPositionParagraph(fieldEnd.line, (fieldEnd.line).getOffset(fieldEnd, 1));\n        // Moves to next text position. (To achieve common behavior for space and enter).\n        selection.start.moveNextPosition();\n        selection.end.setPositionInternal(selection.start);\n        blockInfo = this.getParagraphInfo(selection.end);\n        var end = this.getHierarchicalIndex(blockInfo.paragraph, blockInfo.offset.toString());\n        if (this.editorHistory && this.editorHistory.currentHistoryInfo) {\n            this.editorHistory.currentHistoryInfo.endPosition = end;\n            this.editorHistory.updateComplexHistory();\n            this.reLayout(selection);\n        }\n        else {\n            this.updateComplexWithoutHistory(0, start, end);\n        }\n    };\n    Editor.prototype.appylingHyperlinkFormat = function (selection) {\n        this.initHistory('Underline');\n        this.updateCharacterFormatWithUpdate(selection, 'underline', 'Single', false);\n        if (this.editorHistory) {\n            this.editorHistory.updateHistory();\n        }\n        this.reLayout(selection, false);\n        // Applies font color for field result.\n        this.initHistory('FontColor');\n        this.updateCharacterFormatWithUpdate(selection, 'fontColor', '#0563c1', false);\n        if (this.editorHistory) {\n            this.editorHistory.updateHistory();\n        }\n        this.reLayout(selection, false);\n    };\n    // tslint:disable-next-line:max-line-length\n    Editor.prototype.createHyperlinkElement = function (url, startPosition, endPosition, format) {\n        var selection = this.selection;\n        this.viewer.layout.allowLayout = false;\n        this.appylingHyperlinkFormat(selection);\n        this.viewer.layout.allowLayout = true;\n        // Adds the field end at the URL text end position.\n        var fieldEnd = new FieldElementBox(1);\n        fieldEnd.characterFormat.copyFormat(format);\n        fieldEnd.line = selection.end.currentWidget;\n        selection.start.setPositionInternal(selection.end);\n        // this.insertElementInCurrentLine(selection, fieldEnd, true);\n        this.initInsertInline(fieldEnd);\n        // Moves the selection to URL text start position.        \n        selection.start.setPositionInternal(startPosition);\n        selection.end.setPositionInternal(selection.start);\n        // Adds field begin, field code and field separator at the URL text start position.\n        var begin = this.insertHyperlinkfield(selection, format, url);\n        var lineIndex = selection.start.paragraph.childWidgets.indexOf(begin.line);\n        var index = begin.line.children.indexOf(begin);\n        fieldEnd.linkFieldCharacter(this.viewer);\n        this.viewer.layout.reLayoutParagraph(selection.start.paragraph, lineIndex, index);\n        return fieldEnd;\n    };\n    Editor.prototype.insertHyperlinkfield = function (selection, format, url, isBookmark) {\n        // Adds field begin, field code and field separator at the URL text start position.\n        var begin = new FieldElementBox(0);\n        begin.characterFormat.copyFormat(format);\n        begin.line = selection.start.currentWidget;\n        this.initInsertInline(begin);\n        var span = new TextElementBox();\n        span.characterFormat.copyFormat(format);\n        if (isBookmark) {\n            span.text = ' HYPERLINK \\\\l \\\"' + url + '\\\" ';\n        }\n        else {\n            span.text = ' HYPERLINK \\\"' + url + '\\\" ';\n        }\n        span.line = selection.start.currentWidget;\n        this.initInsertInline(span);\n        var separator = new FieldElementBox(2);\n        separator.characterFormat.copyFormat(format);\n        separator.line = selection.start.currentWidget;\n        this.initInsertInline(separator);\n        return begin;\n    };\n    Editor.prototype.unLinkFieldCharacter = function (inline) {\n        if (inline instanceof FieldElementBox && inline.fieldType === 0) {\n            if (inline.fieldEnd) {\n                if (this.viewer) {\n                    this.viewer.fieldToLayout = inline;\n                    this.viewer.fieldEndParagraph = inline.line.paragraph;\n                }\n                // inline.line.paragraph.addFieldCharacter(inline.fieldEnd);\n                inline.fieldEnd = undefined;\n            }\n        }\n        if (inline instanceof FieldElementBox && inline.fieldType === 2) {\n            if (!isNullOrUndefined(inline.fieldEnd)) {\n                if (this.viewer) {\n                    this.viewer.fieldToLayout = inline.fieldBegin;\n                    this.viewer.fieldEndParagraph = inline.line.paragraph;\n                }\n                inline.fieldBegin.fieldSeparator = undefined;\n                inline.fieldEnd.fieldSeparator = undefined;\n            }\n        }\n        else if (inline instanceof FieldElementBox && inline.fieldType === 1) {\n            if (inline.fieldBegin) {\n                if (!isNullOrUndefined(this.viewer)) {\n                    this.viewer.fieldToLayout = inline.fieldBegin;\n                    this.viewer.fieldEndParagraph = inline.line.paragraph;\n                }\n                var fieldIndex = this.viewer.fields.indexOf(inline.fieldBegin);\n                if (fieldIndex !== -1) {\n                    this.viewer.fields.splice(fieldIndex, 1);\n                }\n                inline.fieldBegin = undefined;\n            }\n        }\n    };\n    Editor.prototype.getCharacterFormat = function (selection) {\n        if (selection.start.paragraph.isEmpty()) {\n            return selection.start.paragraph.characterFormat;\n        }\n        else {\n            var info = selection.start.currentWidget.getInline(selection.start.offset, 0);\n            return info.element.characterFormat;\n        }\n    };\n    /**\n     * Insert Hyperlink\n     * @param  {string} url\n     * @param  {string} displayText\n     * @param  {boolean} remove\n     * @private\n     */\n    Editor.prototype.insertHyperlink = function (url, displayText, remove, isBookmark) {\n        var selection = this.viewer.selection;\n        if (selection.start.paragraph.associatedCell !== selection.end.paragraph.associatedCell) {\n            return;\n        }\n        if (remove) {\n            //Empty selection Hyperlink insert\n            this.insertHyperlinkInternal(selection, url, displayText, isBookmark);\n        }\n        else {\n            //Non-Empty Selection- change the selected text to Field       \n            // this.preservedFontCol = this.getFontColor();\n            var startPosition = selection.start;\n            var endPosition = selection.end;\n            if (!selection.isForward) {\n                startPosition = selection.end;\n                endPosition = selection.start;\n            }\n            var fieldStartPosition = new TextPosition(this.viewer.owner);\n            fieldStartPosition.setPositionInternal(startPosition);\n            var temp = this.getCharacterFormat(selection);\n            var format = new WCharacterFormat(undefined);\n            format.copyFormat(temp);\n            this.initComplexHistory('InsertHyperlink');\n            var blockInfo = this.getParagraphInfo(startPosition);\n            var start = this.getHierarchicalIndex(blockInfo.paragraph, blockInfo.offset.toString());\n            if (this.editorHistory && this.editorHistory.currentHistoryInfo) {\n                // tslint:disable-next-line:max-line-length\n                this.editorHistory.currentHistoryInfo.insertPosition = this.getHierarchicalIndex(blockInfo.paragraph, blockInfo.offset.toString());\n            }\n            this.appylingHyperlinkFormat(selection);\n            this.viewer.layout.allowLayout = true;\n            startPosition.setPositionInternal(endPosition);\n            // Adds the field end at the URL text end position.\n            var fieldEnd = new FieldElementBox(1);\n            fieldEnd.characterFormat.copyFormat(format);\n            fieldEnd.line = selection.end.currentWidget;\n            startPosition.setPositionInternal(endPosition);\n            // this.insertElementInCurrentLine(selection, fieldEnd, true);\n            this.initInsertInline(fieldEnd);\n            // Moves the selection to URL text start position.        \n            startPosition.setPositionInternal(fieldStartPosition);\n            endPosition.setPositionInternal(startPosition);\n            // Adds field begin, field code and field separator at the URL text start position.\n            var begin = this.insertHyperlinkfield(selection, format, url, isBookmark);\n            fieldEnd.linkFieldCharacter(this.viewer);\n            var lineIndex = selection.start.paragraph.childWidgets.indexOf(begin.line);\n            var index = begin.line.children.indexOf(begin);\n            this.viewer.layout.reLayoutParagraph(selection.start.paragraph, lineIndex, index);\n            var lineWidget = fieldEnd.line;\n            selection.selects(lineWidget, lineWidget.getOffset(fieldEnd, fieldEnd.length), true);\n            blockInfo = this.getParagraphInfo(endPosition);\n            var end = this.getHierarchicalIndex(blockInfo.paragraph, blockInfo.offset.toString());\n            if (this.editorHistory && this.editorHistory.currentHistoryInfo) {\n                // tslint:disable-next-line:max-line-length\n                this.editorHistory.currentHistoryInfo.endPosition = this.getHierarchicalIndex(blockInfo.paragraph, blockInfo.offset.toString());\n                this.editorHistory.updateComplexHistory();\n            }\n            else {\n                this.updateComplexWithoutHistory(1, start, end);\n            }\n        }\n    };\n    Editor.prototype.insertHyperlinkInternal = function (selection, url, displayText, isBookmark) {\n        if (isNullOrUndefined(selection.start)) {\n            return;\n        }\n        if (this.editHyperlink(selection, url, displayText)) {\n            return;\n        }\n        this.initHistory('InsertHyperlink');\n        var isRemoved = true;\n        if (!selection.isEmpty) {\n            isRemoved = this.removeSelectedContents(selection);\n        }\n        if (isRemoved) {\n            // Preserves the character format for hyperlink field.\n            var temp = this.getCharacterFormat(selection);\n            var format = new WCharacterFormat();\n            format.copyFormat(temp);\n            this.insertHyperlinkByFormat(selection, url, displayText, format, isBookmark);\n        }\n        //else\n        //    this.Select(Start, true);\n    };\n    // tslint:disable-next-line:max-line-length\n    Editor.prototype.insertHyperlinkByFormat = function (selection, url, displayText, format, isBookmark) {\n        this.updateInsertPosition();\n        selection.owner.isShiftingEnabled = true;\n        var indexInInline = 0;\n        var initial = indexInInline;\n        var element = [];\n        var fieldBegin = new FieldElementBox(0);\n        element.push(fieldBegin);\n        var span = new TextElementBox();\n        if (isBookmark) {\n            span.text = ' HYPERLINK \\\\l \\\"' + url + '\\\" ';\n        }\n        else {\n            span.text = ' HYPERLINK \\\"' + url + '\\\" ';\n        }\n        element.push(span);\n        var fieldSeparator = new FieldElementBox(2);\n        element.push(fieldSeparator);\n        if (!isNullOrUndefined(displayText) && displayText !== '') {\n            span = new TextElementBox();\n            span.characterFormat.underline = 'Single';\n            span.characterFormat.fontColor = '#0563c1';\n            span.text = displayText;\n            element.push(span);\n        }\n        var fieldEnd = new FieldElementBox(1);\n        element.push(fieldEnd);\n        this.insertElement(element);\n        var paragraph = selection.start.paragraph;\n        fieldEnd.linkFieldCharacter(this.viewer);\n        if (this.viewer.fields.indexOf(fieldBegin) === -1) {\n            this.viewer.fields.push(fieldBegin);\n        }\n        var offset = fieldEnd.line.getOffset(fieldEnd, 1);\n        selection.selects(fieldEnd.line, fieldEnd.line.getOffset(fieldEnd, fieldEnd.length), true);\n        this.updateEndPosition();\n        this.reLayout(selection, true);\n    };\n    Editor.prototype.initInsertInline = function (element, insertHyperlink) {\n        this.initHistory('InsertInline');\n        this.insertInlineInSelection(this.viewer.selection, element);\n        if (this.editorHistory) {\n            this.editorHistory.updateHistory();\n        }\n    };\n    /**\n     * @private\n     */\n    Editor.prototype.insertElementInCurrentLine = function (selection, inline, isReLayout) {\n        if (this.checkIsNotRedoing()) {\n            selection.owner.isShiftingEnabled = true;\n        }\n        if (!selection.isEmpty) {\n            this.removeSelectedContents(selection);\n        }\n        this.updateInsertPosition();\n        this.insertElement([inline]);\n        if (this.checkEndPosition(selection)) {\n            this.updateHistoryPosition(selection.start, false);\n        }\n        this.fireContentChange();\n    };\n    /**\n     * Edit Hyperlink\n     * @param  {Selection} selection\n     * @param  {string} url\n     * @param  {string} displayText\n     * @private\n     */\n    Editor.prototype.editHyperlink = function (selection, url, displayText, isBookmark) {\n        var fieldBegin = selection.getHyperlinkField();\n        if (isNullOrUndefined(fieldBegin)) {\n            return false;\n        }\n        this.initHistory('InsertHyperlink');\n        this.editHyperlinkInternal = isNullOrUndefined(this.editorHistory)\n            || (this.editorHistory && isNullOrUndefined(this.editorHistory.currentBaseHistoryInfo));\n        var fieldResult = '';\n        var isNestedField = false;\n        // Preserves the character format for hyperlink field.\n        var temp = this.getCharacterFormat(selection);\n        var format = new WCharacterFormat();\n        format.copyFormat(temp);\n        var fieldSeparator = undefined;\n        if (!isNullOrUndefined(fieldBegin.fieldSeparator)) {\n            fieldSeparator = fieldBegin.fieldSeparator;\n            // tslint:disable-next-line:max-line-length\n            var fieldObj = selection.getHyperlinkDisplayText(fieldBegin.fieldSeparator.line.paragraph, fieldBegin.fieldSeparator, fieldBegin.fieldEnd, isNestedField, format);\n            fieldResult = fieldObj.displayText;\n            isNestedField = fieldObj.isNestedField;\n            format = fieldObj.format;\n        }\n        var offset = fieldBegin.line.getOffset(fieldBegin, 0);\n        selection.start.setPositionParagraph(fieldBegin.line, offset);\n        offset = fieldBegin.fieldEnd.line.getOffset(fieldBegin.fieldEnd, 1);\n        selection.end.setPositionParagraph(fieldBegin.fieldEnd.line, offset);\n        this.deleteSelectedContents(selection, false);\n        if (!isNestedField && fieldResult !== displayText || isNullOrUndefined(fieldSeparator)) {\n            this.insertHyperlinkByFormat(selection, url, displayText, format, isBookmark);\n        }\n        else {\n            //Modify the new hyperlink url. Inserts field begin, url and field separator.\n            this.updateInsertPosition();\n            var newFieldBegin = new FieldElementBox(0);\n            newFieldBegin.characterFormat.copyFormat(fieldBegin.characterFormat);\n            newFieldBegin.line = selection.start.currentWidget;\n            this.insertInlineInternal(newFieldBegin);\n            var span = new TextElementBox();\n            span.characterFormat.copyFormat(fieldBegin.characterFormat);\n            if (isBookmark) {\n                span.text = ' HYPERLINK \\\\l \\\"' + url + '\\\" ';\n            }\n            else {\n                span.text = ' HYPERLINK \\\"' + url + '\\\" ';\n            }\n            span.line = selection.start.currentWidget;\n            this.insertInlineInternal(span);\n            var nodes = this.editorHistory && this.editorHistory.currentBaseHistoryInfo ?\n                this.editorHistory.currentBaseHistoryInfo.removedNodes : this.nodes;\n            this.insertClonedFieldResult(selection, nodes, fieldSeparator);\n            var fieldEnd = selection.end.currentWidget.getInline(selection.end.offset, 0).element;\n            fieldEnd.linkFieldCharacter(this.viewer);\n            var paragraph = newFieldBegin.line.paragraph;\n            var lineIndex = newFieldBegin.line.paragraph.childWidgets.indexOf(newFieldBegin.line);\n            var elementIndex = newFieldBegin.line.children.indexOf(newFieldBegin);\n            this.viewer.layout.reLayoutParagraph(paragraph, lineIndex, elementIndex);\n            selection.selects(newFieldBegin.fieldEnd.line, offset, true);\n            this.updateEndPosition();\n            this.reLayout(selection, true);\n        }\n        this.editHyperlinkInternal = false;\n        this.nodes = [];\n        return true;\n    };\n    /* tslint:disable:no-any */\n    Editor.prototype.insertClonedFieldResult = function (selection, nodes, fieldSeparator) {\n        var fieldEnd;\n        var isStarted = false;\n        for (var i = nodes.length - 1; i > -1; i--) {\n            var node = nodes[i];\n            /* tslint:enable:no-any */\n            if (!isStarted) {\n                if (fieldSeparator === node) {\n                    isStarted = true;\n                }\n                else {\n                    if (node instanceof ParagraphWidget && node === fieldSeparator.line.paragraph) {\n                        isStarted = true;\n                        var paragraph = undefined;\n                        if (i === nodes.length - 1) {\n                            paragraph = selection.start.paragraph;\n                            var fieldParagraph = fieldSeparator.line.paragraph;\n                            this.getClonedFieldResultWithSel(fieldParagraph, selection, fieldSeparator);\n                        }\n                        else {\n                            paragraph = this.getClonedFieldResult(fieldSeparator.line.paragraph, fieldSeparator);\n                            this.insertParagraph(paragraph, true);\n                        }\n                        selection.selectParagraph(selection.getNextParagraphBlock(paragraph), true);\n                    }\n                    continue;\n                }\n            }\n            if (node instanceof ElementBox) {\n                this.insertInlineInternal(node.clone());\n            }\n            else if (node instanceof BlockWidget) {\n                this.insertBlock(node.clone());\n            }\n            // else if (node instanceof WSection)\n            //     editor.insertSection((node as WSection)._Clone());\n        }\n    };\n    Editor.prototype.getClonedFieldResultWithSel = function (paragraph, selection, fieldSeparator) {\n        var lineIndex = paragraph.childWidgets.indexOf(fieldSeparator.line);\n        var elementIndex = paragraph.childWidgets[lineIndex].children.indexOf(fieldSeparator);\n        for (var j = lineIndex; j < paragraph.childWidgets.length; j++) {\n            var lineWidget = paragraph.childWidgets[j];\n            if (j !== lineIndex) {\n                elementIndex = 0;\n            }\n            for (var i = elementIndex; i < lineWidget.children.length; i++) {\n                this.insertInlineInternal(lineWidget.children[i].clone());\n            }\n        }\n    };\n    Editor.prototype.getClonedFieldResult = function (curParagraph, fieldSeparator) {\n        var paragraph = new ParagraphWidget();\n        paragraph.characterFormat.copyFormat(curParagraph.characterFormat);\n        paragraph.paragraphFormat.copyFormat(curParagraph.paragraphFormat);\n        var lineIndex = curParagraph.childWidgets.indexOf(fieldSeparator.line);\n        var elementIndex = curParagraph.childWidgets[lineIndex].children.indexOf(fieldSeparator);\n        for (var j = lineIndex; j < curParagraph.childWidgets.length; j++) {\n            var lineWidget = curParagraph.childWidgets[j];\n            if (j !== lineIndex) {\n                elementIndex = 0;\n            }\n            for (var i = elementIndex; i < lineWidget.children.length; i++) {\n                paragraph.childWidgets[0].children.push(lineWidget.children[i]);\n            }\n        }\n        return paragraph;\n    };\n    /**\n     * Removes the hyperlink if selection is within hyperlink.\n     */\n    Editor.prototype.removeHyperlink = function () {\n        if (this.owner.isReadOnlyMode) {\n            return;\n        }\n        var selection = this.selection;\n        var fieldBegin = selection.getHyperlinkField();\n        if (isNullOrUndefined(fieldBegin)) {\n            return;\n        }\n        var fieldEnd = fieldBegin.fieldEnd;\n        var fieldSeparator = fieldBegin.fieldSeparator;\n        var fieldStartPosition = new TextPosition(selection.owner);\n        // tslint:disable-next-line:max-line-length\n        fieldStartPosition.setPositionParagraph(fieldBegin.line, (fieldBegin.line).getOffset(fieldBegin, 0));\n        var fieldSeparatorPosition = new TextPosition(selection.owner);\n        // tslint:disable-next-line:max-line-length\n        fieldSeparatorPosition.setPositionParagraph(fieldSeparator.line, (fieldSeparator.line).getOffset(fieldSeparator, fieldSeparator.length));\n        this.initComplexHistory('RemoveHyperlink');\n        selection.start.setPositionParagraph(fieldEnd.line, (fieldEnd.line).getOffset(fieldEnd, 0));\n        selection.end.setPositionInternal(selection.start);\n        this.onDelete();\n        selection.start.setPositionInternal(fieldSeparatorPosition);\n        this.initHistory('Underline');\n        this.updateCharacterFormatWithUpdate(selection, 'underline', 'None', false);\n        if (this.editorHistory) {\n            this.editorHistory.updateHistory();\n        }\n        // Applies font color for field result.\n        this.initHistory('FontColor');\n        this.updateCharacterFormatWithUpdate(selection, 'fontColor', undefined, false);\n        if (this.editorHistory) {\n            this.editorHistory.updateHistory();\n        }\n        this.reLayout(selection, false);\n        selection.end.setPositionInternal(selection.start);\n        selection.start.setPositionInternal(fieldStartPosition);\n        this.initHistory('Delete');\n        this.deleteSelectedContents(selection, false);\n        this.reLayout(selection, true);\n        if (this.editorHistory && !isNullOrUndefined(this.editorHistory.currentHistoryInfo)) {\n            this.editorHistory.updateComplexHistory();\n        }\n    };\n    //Paste Implementation starts\n    /**\n     * Paste copied clipboard content on Paste event\n     * @param  {ClipboardEvent} event\n     * @param  {any} pasteWindow?\n     * @private\n     */\n    /* tslint:disable:no-any */\n    Editor.prototype.pasteInternal = function (event, pasteWindow) {\n        if (this.viewer.owner.enableLocalPaste) {\n            this.pasteLocal();\n        }\n        else {\n            if (isNullOrUndefined(pasteWindow)) {\n                pasteWindow = window;\n            }\n            /* tslint:enable:no-any */\n            var textContent = '';\n            var clipbordData = pasteWindow.clipboardData ? pasteWindow.clipboardData : event.clipboardData;\n            textContent = clipbordData.getData('Text');\n            if (textContent !== '') {\n                this.pasteContents(textContent);\n                this.viewer.editableDiv.innerHTML = '';\n            }\n        }\n        this.viewer.updateFocus();\n    };\n    /**\n     * Pastes the data present in local clipboard if any.\n     */\n    Editor.prototype.pasteLocal = function () {\n        /* tslint:disable:no-any */\n        if (this.copiedData && this.owner.enableLocalPaste) {\n            var document_1 = JSON.parse(this.copiedData);\n            this.pasteContents(document_1);\n        }\n    };\n    Editor.prototype.getBlocks = function (pasteContent) {\n        var widgets = [];\n        if (typeof (pasteContent) === 'string') {\n            var startParagraph = this.selection.start.paragraph;\n            if (!this.selection.isForward) {\n                startParagraph = this.selection.end.paragraph;\n            }\n            var arr = [];\n            var txt = pasteContent;\n            txt = txt.replace(/\\r\\n/g, '\\r');\n            arr = txt.split('\\r');\n            for (var i = 0; i < arr.length; i++) {\n                var insertFormat = this.copyInsertFormat(startParagraph.characterFormat, false);\n                var insertParaFormat = this.viewer.selection.copySelectionParagraphFormat();\n                var paragraph = new ParagraphWidget();\n                paragraph.paragraphFormat.copyFormat(insertParaFormat);\n                var line = new LineWidget(paragraph);\n                if (arr[i].length > 0) {\n                    var textElement = new TextElementBox();\n                    textElement.characterFormat.copyFormat(insertFormat);\n                    textElement.text = arr[i];\n                    line.children.push(textElement);\n                    textElement.line = line;\n                }\n                paragraph.childWidgets.push(line);\n                widgets.push(paragraph);\n            }\n        }\n        else {\n            for (var i = 0; i < pasteContent.sections.length; i++) {\n                this.viewer.owner.parser.parseBody(pasteContent.sections[i].blocks, widgets);\n            }\n        }\n        return widgets;\n    };\n    Editor.prototype.pasteContents = function (content) {\n        this.pasteContentsInternal(this.getBlocks(content));\n    };\n    Editor.prototype.pasteContentsInternal = function (widgets) {\n        /* tslint:enable:no-any */\n        var selection = this.viewer.selection;\n        var isRemoved = true;\n        this.initComplexHistory('Paste');\n        if (this.viewer.isListTextSelected) {\n            var paragraph = selection.start.paragraph;\n            if (paragraph.paragraphFormat.listFormat && paragraph.paragraphFormat.listFormat.listId !== -1) {\n                this.onApplyList(undefined);\n            }\n        }\n        this.initHistory('Paste');\n        if (!selection.isEmpty || this.viewer.isListTextSelected) {\n            isRemoved = this.removeSelectedContentInternal(selection, selection.start, selection.end);\n        }\n        if (isRemoved) {\n            this.pasteContent(widgets);\n        }\n        else if (this.editorHistory) {\n            this.editorHistory.currentBaseHistoryInfo = undefined;\n        }\n        if (this.editorHistory && this.editorHistory.currentHistoryInfo) {\n            this.editorHistory.updateHistory();\n            this.editorHistory.updateComplexHistory();\n        }\n        else {\n            this.reLayout(selection, selection.isEmpty);\n        }\n    };\n    /* tslint:disable:no-any */\n    Editor.prototype.pasteContent = function (widgets) {\n        /* tslint:enable:no-any */\n        this.viewer.owner.isShiftingEnabled = true;\n        this.updateInsertPosition();\n        this.viewer.owner.isLayoutEnabled = true;\n        this.viewer.owner.isPastingContent = true;\n        this.pasteCopiedData(widgets);\n        this.updateEndPosition();\n        this.viewer.owner.isPastingContent = false;\n        this.viewer.selection.fireSelectionChanged(true);\n    };\n    Editor.prototype.pasteCopiedData = function (widgets) {\n        for (var j = 0; j < widgets.length; j++) {\n            var widget = widgets[j];\n            if (widget instanceof ParagraphWidget && widget.childWidgets.length === 0) {\n                widget.childWidgets[0] = new LineWidget(widget);\n            }\n            if (j === widgets.length - 1 && widget instanceof ParagraphWidget) {\n                var newParagraph = widget;\n                if (newParagraph.childWidgets.length > 0\n                    && newParagraph.childWidgets[0].children.length > 0) {\n                    this.insertElement(newParagraph.childWidgets[0].children);\n                }\n            }\n            else if (widget instanceof BlockWidget) {\n                var startParagraph = this.selection.start.paragraph;\n                if (widget instanceof TableWidget && startParagraph.isInsideTable) {\n                    var table = widget;\n                    //Handled to resize table based on parent cell width.\n                    var clientWidth = startParagraph.getContainerWidth();\n                    table.fitCellsToClientArea(clientWidth);\n                }\n                if (widget instanceof TableWidget && startParagraph.isEmpty()\n                    && startParagraph.previousWidget instanceof TableWidget) {\n                    this.insertTableRows(widget, startParagraph.previousWidget);\n                }\n                else {\n                    this.insertBlockInternal(widget);\n                }\n            }\n        }\n    };\n    /**\n     * Insert Table on undo\n     * @param  {WTable} table\n     * @param  {WTable} newTable\n     * @param  {boolean} moveRows\n     * @private\n     */\n    Editor.prototype.insertTableInternal = function (table, newTable, moveRows) {\n        //Gets the index of current table.\n        var insertIndex = table.getIndex();\n        if (moveRows) {\n            //Moves the rows to table.\n            for (var i = 0, index = 0; i < table.childWidgets.length; i++, index++) {\n                var row = table.childWidgets[i];\n                newTable.childWidgets.splice(index, 0, row);\n                row.containerWidget = newTable;\n                table.childWidgets.splice(i, 1);\n                i--;\n            }\n        }\n        var owner = table.containerWidget;\n        this.removeBlock(table);\n        //Inserts table in the current table position.        \n        var blockAdvCollection = owner.childWidgets;\n        blockAdvCollection.splice(insertIndex, 0, newTable);\n        newTable.index = table.index;\n        table.containerWidget = undefined;\n        newTable.containerWidget = owner;\n        newTable.isGridUpdated = false;\n        newTable.buildTableColumns();\n        newTable.isGridUpdated = true;\n        this.viewer.layout.clearTableWidget(newTable, true, true);\n        this.updateNextBlocksIndex(newTable, true);\n        this.viewer.layout.linkFieldInTable(newTable);\n        this.viewer.layout.layoutBodyWidgetCollection(newTable.index, owner, newTable, false);\n    };\n    /**\n     * Insert Table on undo\n     * @param  {Selection} selection\n     * @param  {WBlock} block\n     * @param  {WTable} table\n     * @private\n     */\n    Editor.prototype.insertBlockTable = function (selection, block, table) {\n        var offset = selection.start.offset;\n        var lineIndex = selection.start.paragraph.childWidgets.indexOf(selection.start.currentWidget);\n        if (block instanceof ParagraphWidget && offset > 0) {\n            //Moves the inline items before selection start to the inserted paragraph.\n            // tslint:disable-next-line:max-line-length\n            this.moveInlines(selection.start.paragraph, block, 0, 0, selection.start.paragraph.firstChild, offset, selection.start.currentWidget);\n            selection.selectParagraph(selection.start.paragraph, true);\n            if (this.checkInsertPosition(selection)) {\n                this.updateHistoryPosition(this.getHierarchicalIndex(block, offset.toString()), true);\n            }\n        }\n        if (offset > 0 && this.checkInsertPosition(selection)) {\n            this.updateHistoryPosition(selection.start, true);\n        }\n        var index = table.indexInOwner;\n        table.containerWidget.childWidgets.splice(index, 0, block);\n        block.containerWidget = table.containerWidget;\n        block.index = table.index;\n        this.updateNextBlocksIndex(block, true);\n        this.viewer.layout.layoutBodyWidgetCollection(block.index, block.containerWidget, block, false);\n        if (this.checkInsertPosition(selection)) {\n            var paragraph = undefined;\n            if (block instanceof ParagraphWidget) {\n                paragraph = block;\n            }\n            if (block instanceof TableWidget) {\n                paragraph = selection.getFirstParagraphInFirstCell(block);\n            }\n            this.updateHistoryPosition(this.getHierarchicalIndex(paragraph, '0'), true);\n        }\n    };\n    /**\n     * On cut handle selected content remove and relayout\n     * @param  {Selection} selection\n     * @param  {TextPosition} startPosition\n     * @param  {TextPosition} endPosition\n     * @private\n     */\n    Editor.prototype.handleCut = function (selection) {\n        var startPosition = selection.start;\n        var endPosition = selection.end;\n        if (!selection.isForward) {\n            startPosition = selection.end;\n            endPosition = selection.start;\n        }\n        // this.owner.isShiftingEnabled = true;\n        var blockInfo = this.getParagraphInfo(startPosition);\n        selection.editPosition = this.getHierarchicalIndex(blockInfo.paragraph, blockInfo.offset.toString());\n        var image = undefined;\n        if (startPosition.paragraph === endPosition.paragraph && startPosition.offset + 1 === endPosition.offset) {\n            //Gets selected image and copy image to clipboard.\n            var index = 0;\n            var currentInline = startPosition.paragraph.getInline(endPosition.offset, index);\n            var inline = currentInline.element;\n            image = inline;\n        }\n        this.initHistory('Cut');\n        selection.owner.isShiftingEnabled = true;\n        if (this.editorHistory && this.editorHistory.currentBaseHistoryInfo) {\n            if (this.checkInsertPosition(selection)) {\n                this.updateHistoryPosition(selection.editPosition, true);\n            }\n        }\n        this.deleteSelectedContent(endPosition.paragraph, selection, startPosition, endPosition, 3);\n        var textPosition = new TextPosition(selection.owner);\n        this.setPositionForCurrentIndex(textPosition, selection.editPosition);\n        selection.selectContent(textPosition, true);\n        if (this.editorHistory && this.editorHistory.currentBaseHistoryInfo) {\n            if (this.checkEndPosition(selection)) {\n                this.updateHistoryPosition(selection.end, false);\n            }\n        }\n        this.reLayout(selection);\n    };\n    Editor.prototype.insertInlineInternal = function (element) {\n        var selection = this.selection;\n        var length = element.length;\n        var paragraphInfo = this.getParagraphInfo(selection.start);\n        if (selection.start.paragraph.isEmpty()) {\n            var paragraph = selection.start.paragraph;\n            if ((paragraph.paragraphFormat.textAlignment === 'Center' || paragraph.paragraphFormat.textAlignment === 'Right')\n                && paragraph.paragraphFormat.listFormat.listId === -1) {\n                paragraph.x = this.viewer.clientActiveArea.x;\n            }\n            paragraph.childWidgets[0].children.push(element);\n            element.line = paragraph.childWidgets[0];\n            element.linkFieldCharacter(this.viewer);\n            this.viewer.layout.reLayoutParagraph(paragraph, 0, 0);\n        }\n        else {\n            var indexInInline = 0;\n            var inlineObj = selection.start.currentWidget.getInline(selection.start.offset, indexInInline);\n            var curInline = inlineObj.element;\n            indexInInline = inlineObj.index;\n            this.insertElementInternal(curInline, element, indexInInline, true);\n        }\n        this.setPositionParagraph(paragraphInfo.paragraph, paragraphInfo.offset + length, true);\n    };\n    Editor.prototype.insertElement = function (element) {\n        var selection = this.selection;\n        var length = 0;\n        var paragraph = undefined;\n        var lineIndex = -1;\n        var lineWidget = undefined;\n        var insertIndex = 0;\n        var paragraphInfo = this.getParagraphInfo(selection.start);\n        if (selection.start.paragraph.isEmpty()) {\n            paragraph = selection.start.paragraph;\n            lineWidget = paragraph.childWidgets[0];\n            lineIndex = 0;\n        }\n        else {\n            var indexInInline = 0;\n            var inlineObj = selection.start.currentWidget.getInline(selection.start.offset, indexInInline);\n            var curInline = inlineObj.element;\n            indexInInline = inlineObj.index;\n            paragraph = curInline.line.paragraph;\n            lineIndex = paragraph.childWidgets.indexOf(curInline.line);\n            insertIndex = curInline.indexInOwner;\n            lineWidget = curInline.line;\n            if (indexInInline === curInline.length) {\n                insertIndex++;\n            }\n            else if (indexInInline === 0) {\n                if (isNullOrUndefined(curInline.previousNode)) {\n                    insertIndex = 0;\n                }\n            }\n            else {\n                insertIndex++;\n                var prevElement = new TextElementBox();\n                prevElement.characterFormat.copyFormat(curInline.characterFormat);\n                prevElement.text = curInline.text.substring(indexInInline);\n                curInline.text = curInline.text.substr(0, indexInInline);\n                lineWidget.children.splice(insertIndex, 0, prevElement);\n                prevElement.line = curInline.line;\n            }\n        }\n        for (var i = 0; i < element.length; i++) {\n            length += element[i].length;\n            lineWidget.children.splice(insertIndex, 0, element[i]);\n            element[i].line = lineWidget;\n            element[i].linkFieldCharacter(this.viewer);\n            insertIndex++;\n        }\n        this.viewer.layout.reLayoutParagraph(paragraph, lineIndex, 0);\n        this.setPositionParagraph(paragraphInfo.paragraph, paragraphInfo.offset + length, true);\n    };\n    Editor.prototype.insertElementInternal = function (element, newElement, index, relayout) {\n        var line = element.line;\n        var paragraph = line.paragraph;\n        var lineIndex = line.indexInOwner;\n        var insertIndex = element.indexInOwner;\n        if (index === element.length) {\n            insertIndex++;\n            line.children.splice(insertIndex, 0, newElement);\n        }\n        else if (index === 0) {\n            if (isNullOrUndefined(element.previousNode)) {\n                element.line.children.splice(0, 0, newElement);\n                insertIndex = 0;\n            }\n            else {\n                element.line.children.splice(insertIndex, 0, newElement);\n            }\n        }\n        else {\n            insertIndex++;\n            var textElement = new TextElementBox();\n            textElement.characterFormat.copyFormat(element.characterFormat);\n            textElement.text = element.text.substring(index);\n            element.text = element.text.substr(0, index);\n            line.children.splice(insertIndex, 0, textElement);\n            textElement.line = element.line;\n            //Inserts the new inline.\n            line.children.splice(insertIndex, 0, newElement);\n            insertIndex -= 1;\n        }\n        newElement.line = element.line;\n        newElement.linkFieldCharacter(this.viewer);\n        if (relayout) {\n            this.viewer.layout.reLayoutParagraph(paragraph, lineIndex, insertIndex);\n        }\n    };\n    /**\n     * Insert Block on undo\n     * @param  {Selection} selection\n     * @param  {WBlock} block\n     * @private\n     */\n    Editor.prototype.insertBlock = function (block) {\n        var isRemoved = true;\n        var selection = this.selection;\n        if (!selection.isEmpty) {\n            isRemoved = this.removeSelectedContents(selection);\n        }\n        if (!isRemoved) {\n            selection.selectContent(selection.start, false);\n        }\n        this.insertBlockInternal(block);\n        if (this.checkInsertPosition(selection)) {\n            var paragraph = undefined;\n            if (block instanceof ParagraphWidget) {\n                paragraph = block;\n            }\n            else {\n                paragraph = this.selection.getFirstParagraphInFirstCell(block);\n            }\n            // tslint:disable-next-line:max-line-length\n            this.updateHistoryPosition(this.getHierarchicalIndex(paragraph, '0'), true);\n        }\n        this.fireContentChange();\n    };\n    /**\n     * Insert new Block on specific index\n     * @param  {Selection} selection\n     * @param  {BlockWidget} block\n     * @private\n     */\n    Editor.prototype.insertBlockInternal = function (block) {\n        var selection = this.selection;\n        var isRemoved = true;\n        var startPara = this.selection.start.paragraph;\n        if (!selection.start.isAtParagraphStart) {\n            if (block instanceof ParagraphWidget) {\n                this.insertNewParagraphWidget(block, false);\n                return;\n            }\n            this.updateInsertPosition();\n            startPara = startPara.combineWidget(this.viewer);\n            // tslint:disable-next-line:max-line-length\n            this.splitParagraph(startPara, startPara.firstChild, 0, selection.start.currentWidget, selection.start.offset, false);\n            selection.selectParagraph(this.selection.start.paragraph, true);\n        }\n        var bodyWidget = selection.start.paragraph.containerWidget;\n        var blockIndex = selection.start.paragraph.index;\n        var insertIndex = bodyWidget.childWidgets.indexOf(selection.start.paragraph);\n        if (!isNullOrUndefined(bodyWidget)) {\n            bodyWidget.childWidgets.splice(insertIndex, 0, block);\n            block.containerWidget = bodyWidget;\n            block.index = blockIndex;\n            block.height = 0;\n            if (block instanceof TableWidget) {\n                block.isGridUpdated = false;\n                block.buildTableColumns();\n                block.isGridUpdated = true;\n            }\n            this.updateNextBlocksIndex(block, true);\n            this.viewer.layout.layoutBodyWidgetCollection(blockIndex, bodyWidget, block, false);\n        }\n    };\n    /**\n     * Inserts the image with specified size at cursor position in the document editor.\n     * @param {string} imageString  Base64 string, web URL or file URL.\n     * @param {number} width? Image width\n     * @param {number} height? Image height\n     */\n    Editor.prototype.insertImage = function (imageString, width, height) {\n        if (this.owner.isReadOnlyMode) {\n            return;\n        }\n        if (isNullOrUndefined(width)) {\n            width = 100;\n        }\n        if (isNullOrUndefined(height)) {\n            height = 100;\n        }\n        this.insertPicture(imageString, width, height);\n    };\n    /**\n     * Inserts a table of specified size at cursor position\n     *  in the document editor.\n     * @param {number} rows Default value of â€˜rowsâ€™ parameter is 1.\n     * @param {number} columns Default value of â€˜columnsâ€™ parameter is 1.\n     */\n    Editor.prototype.insertTable = function (rows, columns) {\n        var startPos = this.selection.start;\n        if (this.owner.isReadOnlyMode) {\n            return;\n        }\n        rows = rows || 1;\n        columns = columns || 1;\n        var table = this.createTable(rows, columns);\n        var clientWidth = startPos.paragraph.getContainerWidth();\n        table.splitWidthToTableCells(clientWidth);\n        var prevBlock = startPos.paragraph.previousWidget;\n        if (startPos.currentWidget.isFirstLine() && startPos.offset === 0 && prevBlock instanceof TableWidget) {\n            this.insertTableRows(table, prevBlock);\n            table.destroy();\n            return;\n        }\n        else {\n            this.initHistory('InsertTable');\n            this.viewer.owner.isShiftingEnabled = true;\n            this.insertBlock(table);\n        }\n        var startLine = this.selection.getFirstParagraphInFirstCell(table).childWidgets[0];\n        startPos.setPosition(startLine, true);\n        this.selection.end.setPositionInternal(startPos);\n        var lastParagraph = this.selection.getLastParagraphInLastCell(table);\n        var endOffset = lastParagraph.getLength() + 1;\n        if (this.editorHistory && this.editorHistory.currentBaseHistoryInfo) {\n            // tslint:disable-next-line:max-line-length\n            this.editorHistory.currentBaseHistoryInfo.endPosition = this.getHierarchicalIndex(lastParagraph, endOffset.toString());\n        }\n        this.reLayout(this.selection);\n    };\n    /**\n     * Inserts the specified number of rows to the table above or below to the row at cursor position.\n     * @param {boolean} above The above parameter is optional and if omitted,\n     * it takes the value as false and inserts below the row at cursor position.\n     * @param {number} count The count parameter is optional and if omitted, it takes the value as 1.\n     */\n    Editor.prototype.insertRow = function (above, count) {\n        var rowPlacement = above ? 'Above' : 'Below';\n        if (this.owner.isReadOnlyMode) {\n            return;\n        }\n        var startPos = this.selection.isForward ? this.selection.start : this.selection.end;\n        var endPos = this.selection.isForward ? this.selection.end : this.selection.start;\n        if (startPos.paragraph.isInsideTable) {\n            if (this.checkIsNotRedoing()) {\n                this.initHistory(rowPlacement === 'Above' ? 'InsertRowAbove' : 'InsertRowBelow');\n            }\n            this.viewer.owner.isShiftingEnabled = true;\n            var startCell = this.getOwnerCell(this.selection.isForward).getSplitWidgets()[0];\n            var endCell = this.getOwnerCell(!this.selection.isForward).getSplitWidgets()[0];\n            var table = startCell.ownerTable.combineWidget(this.viewer);\n            var row = rowPlacement === 'Below' ? endCell.ownerRow : startCell.ownerRow;\n            if (this.editorHistory) {\n                var clonedTable = this.cloneTableToHistoryInfo(table);\n            }\n            var rowCount = count ? count : this.getRowCountToInsert();\n            var rows = [];\n            var index = row.rowIndex;\n            if (rowPlacement === 'Below') {\n                index++;\n                var isAffectedByRowSpannedCell = isNullOrUndefined(endCell.previousWidget)\n                    || endCell.columnIndex === endCell.previousWidget.columnIndex + 1;\n                var isRowSpanEnd = endCell.cellIndex !== endCell.columnIndex && isAffectedByRowSpannedCell\n                    && row.rowIndex + startCell.cellFormat.rowSpan - 1 === endCell.ownerRow.rowIndex;\n                if (!isRowSpanEnd) {\n                    if (endCell.cellFormat.rowSpan > 1) {\n                        if (!isNullOrUndefined(row.nextWidget) && row.nextWidget instanceof TableRowWidget) {\n                            endCell.cellFormat.rowSpan += rowCount;\n                            row = row.nextWidget;\n                        }\n                    }\n                }\n            }\n            for (var i = 0; i < rowCount; i++) {\n                var cellCountInfo = this.updateRowspan(row, rowPlacement === 'Below' ? endCell : startCell, rowPlacement);\n                var newRow = this.createRowAndColumn(cellCountInfo.count, i);\n                newRow.rowFormat.copyFormat(row.rowFormat);\n                this.updateCellFormatForInsertedRow(newRow, cellCountInfo.cellFormats);\n                rows.push(newRow);\n            }\n            table.insertTableRowsInternal(rows, index);\n            var cell = undefined;\n            var paragraph = undefined;\n            if ((table.childWidgets[index] instanceof TableRowWidget)) {\n                cell = table.childWidgets[index].firstChild;\n                paragraph = this.selection.getFirstParagraph(cell);\n            }\n            else {\n                var widget = undefined;\n                while (!(widget instanceof TableWidget)) {\n                    widget = table.nextRenderedWidget;\n                }\n                paragraph = this.selection.getFirstParagraphInFirstCell(widget);\n            }\n            this.viewer.layout.reLayoutTable(table);\n            this.selection.selectParagraph(paragraph, true);\n        }\n        this.reLayout(this.selection, true);\n    };\n    Editor.prototype.updateCellFormatForInsertedRow = function (newRow, cellFormats) {\n        for (var i = 0; i < newRow.childWidgets.length; i++) {\n            newRow.childWidgets[i].cellFormat.copyFormat(cellFormats[i]);\n            newRow.childWidgets[i].cellFormat.rowSpan = 1;\n        }\n    };\n    Editor.prototype.updateRowspan = function (row, startCell, rowPlacement) {\n        var spannedCells = row.getPreviousRowSpannedCells(true);\n        var count = 0;\n        var cellFormats = [];\n        for (var i = 0; i < row.childWidgets.length; i++) {\n            var cell = row.childWidgets[i];\n            var isCellIncluded = false;\n            // Need to check with all the row spanned cells. if the start cell contains rowspan greater than 1, \n            // and when inserting below, need to increment rowspan for all row spanned cells by 1 except\n            // if the spanned cells is placed in the same column or cell to be cloned has the same row index of cloned cell row index.\n            // and when inserting above, if cloned cell placed in the same row of start cell or\n            // if the cloned cell has equal column index, need to skip updating rowspan value of cloned cell.\n            // else update row span value for spanned cell except \n            // if the spanned cells is placed in the same column or cell to be cloned has the same row index of cloned cell row index.\n            var isRowSpanned = (isNullOrUndefined(cell.previousWidget)\n                || cell.columnIndex !== cell.previousWidget.columnIndex + 1);\n            for (var j = 0; j < spannedCells.length; j++) {\n                if (isRowSpanned) {\n                    var spannedCell = spannedCells[j];\n                    var clonedRowIndex = spannedCell.ownerRow.rowIndex + spannedCell.cellFormat.rowSpan - 1;\n                    if (cell.columnIndex < spannedCell.columnIndex && cell.cellIndex !== cell.columnIndex) {\n                        isCellIncluded = true;\n                        count++;\n                        cellFormats.push(cell.cellFormat);\n                    }\n                    if (startCell.cellFormat.rowSpan === 1) {\n                        // Need to check whether cell is affected by a row spanned cell. if cell is placed on the row where it is affected \n                        // by row spanned cell, then if we are inserting row below, need to add new cell with spanned cell width\n                        // or if we are inserting above, need to update row span value of the spanned cell.\n                        // if cell is placed inbetween the spanned cell , \n                        // then if we are inserting below, need to update row span value of spanned cell or\n                        // if we are inserting above, need to skip updating row span value except\n                        // if start cell is placed on the same row of spanned cell or if start cell placed in the same column.\n                        if (clonedRowIndex > cell.ownerRow.rowIndex) {\n                            if (rowPlacement === 'Above'\n                                && spannedCell.ownerRow === startCell.ownerRow) {\n                                continue;\n                            }\n                            else {\n                                spannedCell.cellFormat.rowSpan += 1;\n                                spannedCells.splice(j, 1);\n                                j--;\n                            }\n                        }\n                        else if (cell.cellIndex !== cell.columnIndex && isRowSpanned && clonedRowIndex === cell.ownerRow.rowIndex) {\n                            if (rowPlacement === 'Above') {\n                                spannedCell.cellFormat.rowSpan += 1;\n                                spannedCells.splice(j, 1);\n                                j--;\n                            }\n                            else {\n                                count++;\n                                cellFormats.push(spannedCell.cellFormat);\n                                spannedCells.splice(j, 1);\n                                j--;\n                            }\n                        }\n                    }\n                    else {\n                        if (spannedCell !== startCell) {\n                            if (rowPlacement === 'Above'\n                                && (spannedCell.ownerRow === startCell.ownerRow || spannedCell.columnIndex === startCell.columnIndex)) {\n                                continue;\n                            }\n                            else {\n                                if (spannedCell.columnIndex !== startCell.columnIndex\n                                    && spannedCell.ownerRow.rowIndex !== cell.ownerRow.rowIndex\n                                    && (clonedRowIndex > startCell.ownerRow.rowIndex\n                                        || (rowPlacement === 'Above' && clonedRowIndex === startCell.ownerRow.rowIndex))) {\n                                    spannedCell.cellFormat.rowSpan += 1;\n                                    spannedCells.splice(j, 1);\n                                    j--;\n                                }\n                            }\n                        }\n                    }\n                }\n            }\n            if (spannedCells.indexOf(cell) === -1 && cell.cellFormat.rowSpan > 1) {\n                isCellIncluded = true;\n            }\n            if (!isCellIncluded) {\n                count++;\n                cellFormats.push(cell.cellFormat);\n            }\n        }\n        return { count: count, cellFormats: cellFormats };\n    };\n    Editor.prototype.insertTableRows = function (table, prevBlock) {\n        this.initHistory('InsertRowBelow');\n        table.containerWidget = prevBlock.containerWidget;\n        prevBlock = prevBlock.combineWidget(this.viewer);\n        if (this.editorHistory) {\n            var clonedTable = this.cloneTableToHistoryInfo(prevBlock);\n        }\n        var row = prevBlock.childWidgets[prevBlock.childWidgets.length - 1];\n        prevBlock.insertTableRowsInternal(table.childWidgets, prevBlock.childWidgets.length);\n        var paragraph = this.selection.getFirstParagraph(row.nextWidget.childWidgets[0]);\n        this.viewer.layout.reLayoutTable(prevBlock);\n        this.selection.selectParagraph(paragraph, true);\n        if (this.editorHistory && this.editorHistory.currentBaseHistoryInfo) {\n            this.updateHistoryPosition(this.selection.start, true);\n            this.updateHistoryPosition(this.selection.end, false);\n        }\n        this.reLayout(this.selection);\n    };\n    /**\n     * Inserts the specified number of columns to the table left or right to the column at cursor position.\n     * @param {number} left The left parameter is optional and if omitted, it takes the value as false and\n     * inserts to the right of column at cursor position.\n     * @param {number} count The count parameter is optional and if omitted, it takes the value as 1.\n     */\n    Editor.prototype.insertColumn = function (left, count) {\n        if (this.owner.isReadOnlyMode) {\n            return;\n        }\n        var columnPlacement = left ? 'Left' : 'Right';\n        if (this.selection.start.paragraph.isInsideTable) {\n            if (this.checkIsNotRedoing()) {\n                this.initHistory(columnPlacement === 'Left' ? 'InsertColumnLeft' : 'InsertColumnRight');\n            }\n            this.selection.owner.isShiftingEnabled = true;\n            var startCell = this.getOwnerCell(this.selection.isForward);\n            var endCell = this.getOwnerCell(!this.selection.isForward);\n            var table = startCell.ownerRow.ownerTable.combineWidget(this.viewer);\n            if (this.editorHistory) {\n                //Clones the entire table to preserve in history.\n                var clonedTable = this.cloneTableToHistoryInfo(table);\n            }\n            this.selection.owner.isLayoutEnabled = false;\n            var cellIndex = startCell.columnIndex;\n            if (columnPlacement === 'Right') {\n                cellIndex = endCell.columnIndex + endCell.cellFormat.columnSpan;\n            }\n            var startParagraph = undefined;\n            var newCell = undefined;\n            var columnCount = count ? count : this.getColumnCountToInsert();\n            var rowSpannedCells = [];\n            var rowSpanCellIndex = cellIndex;\n            for (var i = 0; i < columnCount; i++) {\n                for (var j = 0; j < table.childWidgets.length; j++) {\n                    var row = table.childWidgets[j];\n                    newCell = this.createColumn(this.selection.getLastParagraph(startCell));\n                    newCell.index = j;\n                    newCell.rowIndex = row.rowIndex;\n                    newCell.containerWidget = row;\n                    newCell.cellFormat.copyFormat(startCell.cellFormat);\n                    newCell.cellFormat.rowSpan = 1;\n                    if (isNullOrUndefined(startParagraph)) {\n                        startParagraph = this.selection.getFirstParagraph(newCell);\n                    }\n                    if (cellIndex === 0) {\n                        row.childWidgets.splice(cellIndex, 0, newCell);\n                    }\n                    else {\n                        var isCellInserted = false;\n                        for (var j_1 = 0; j_1 < row.childWidgets.length; j_1++) {\n                            var rowCell = row.childWidgets[j_1];\n                            // Add the row spanned cells to colection for adding column before / after row spnned cells.\n                            if (rowCell.cellFormat.rowSpan > 1) {\n                                rowSpannedCells.push(rowCell);\n                            }\n                            if (rowCell.columnIndex + rowCell.cellFormat.columnSpan === cellIndex) {\n                                row.childWidgets.splice(rowCell.cellIndex + 1, 0, newCell);\n                                isCellInserted = true;\n                            }\n                            else if (cellIndex > rowCell.columnIndex && rowCell.columnIndex + rowCell.cellFormat.columnSpan > cellIndex\n                                && cellIndex < rowCell.columnIndex + rowCell.cellFormat.columnSpan) {\n                                row.childWidgets.splice(rowCell.cellIndex, 0, newCell);\n                                isCellInserted = true;\n                            }\n                            if (isCellInserted) {\n                                break;\n                            }\n                        }\n                        // If the cell is not inserted for row, then check for row spanned cells.\n                        if (!isCellInserted) {\n                            if (rowSpannedCells.length > 0) {\n                                for (var k = 0; k < rowSpannedCells.length; k++) {\n                                    var rowSpannedCell = rowSpannedCells[k];\n                                    if (rowSpannedCell.ownerRow !== row\n                                        && row.rowIndex <= rowSpannedCell.ownerRow.rowIndex + rowSpannedCell.cellFormat.rowSpan - 1) {\n                                        if (rowSpannedCell.columnIndex + rowSpannedCell.cellFormat.columnSpan === cellIndex) {\n                                            if (rowSpannedCell.cellIndex > row.childWidgets.length) {\n                                                row.childWidgets.push(newCell);\n                                            }\n                                            else {\n                                                row.childWidgets.splice(rowSpannedCell.cellIndex, 0, newCell);\n                                            }\n                                            isCellInserted = true;\n                                        }\n                                        else if (cellIndex > rowSpannedCell.columnIndex &&\n                                            rowSpannedCell.columnIndex + rowSpannedCell.cellFormat.columnSpan > cellIndex\n                                            && cellIndex < rowSpannedCell.columnIndex + rowSpannedCell.cellFormat.columnSpan) {\n                                            row.childWidgets.splice(rowSpannedCell.columnIndex, 0, newCell);\n                                            isCellInserted = true;\n                                        }\n                                    }\n                                    if (isCellInserted) {\n                                        break;\n                                    }\n                                }\n                            }\n                        }\n                    }\n                }\n            }\n            table.updateRowIndex(0);\n            var parentTable = this.viewer.layout.getParentTable(table);\n            if (parentTable) {\n                parentTable.fitChildToClientArea();\n            }\n            else {\n                table.fitChildToClientArea();\n            }\n            this.selection.owner.isLayoutEnabled = true;\n            table.isGridUpdated = false;\n            table.buildTableColumns();\n            table.isGridUpdated = true;\n            this.viewer.layout.reLayoutTable(table);\n            this.selection.start.setPosition(startParagraph.firstChild, true);\n            this.selection.end.setPosition(this.selection.getLastParagraph(newCell).firstChild, false);\n            if (this.checkIsNotRedoing() || isNullOrUndefined(this.editorHistory)) {\n                this.reLayout(this.selection);\n            }\n        }\n    };\n    /**\n     * Creates table with specified rows and columns.\n     * @private\n     */\n    Editor.prototype.createTable = function (rows, columns) {\n        var startPara = this.selection.start.paragraph;\n        var table = new TableWidget();\n        table.tableFormat = new WTableFormat(table);\n        table.tableFormat.preferredWidthType = 'Auto';\n        table.tableFormat.initializeTableBorders();\n        var index = 0;\n        while (index < rows) {\n            var tableRow = this.createRowAndColumn(columns, index);\n            tableRow.rowFormat.heightType = 'Auto';\n            tableRow.containerWidget = table;\n            table.childWidgets.push(tableRow);\n            index++;\n        }\n        return table;\n    };\n    Editor.prototype.createRowAndColumn = function (columns, rowIndex) {\n        var startPara = this.selection.start.paragraph;\n        var tableRow = new TableRowWidget();\n        tableRow.rowFormat = new WRowFormat(tableRow);\n        tableRow.index = rowIndex;\n        for (var i = 0; i < columns; i++) {\n            var tableCell = this.createColumn(startPara);\n            tableCell.index = i;\n            tableCell.rowIndex = rowIndex;\n            tableCell.containerWidget = tableRow;\n            tableRow.childWidgets.push(tableCell);\n        }\n        return tableRow;\n    };\n    Editor.prototype.createColumn = function (paragraph) {\n        var tableCell = new TableCellWidget();\n        var para = new ParagraphWidget();\n        para.paragraphFormat.copyFormat(paragraph.paragraphFormat);\n        para.characterFormat.copyFormat(paragraph.characterFormat);\n        para.containerWidget = tableCell;\n        tableCell.childWidgets.push(para);\n        tableCell.cellFormat = new WCellFormat(tableCell);\n        return tableCell;\n    };\n    Editor.prototype.getColumnCountToInsert = function () {\n        var count = 1;\n        var start = this.selection.start;\n        var end = this.selection.end;\n        if (!this.selection.isForward) {\n            start = this.selection.end;\n            end = this.selection.start;\n        }\n        if (start && end && this.selection.getTable(start, end)) {\n            if (start.paragraph.associatedCell === end.paragraph.associatedCell) {\n                return count = 1;\n            }\n            if (start.paragraph.associatedCell.ownerRow === end.paragraph.associatedCell.ownerRow) {\n                return count = count + end.paragraph.associatedCell.cellIndex - start.paragraph.associatedCell.cellIndex;\n            }\n            else {\n                count = 0;\n                // tslint:disable-next-line:max-line-length\n                var selectedCells = start.paragraph.associatedCell.ownerTable.getColumnCellsForSelection(start.paragraph.associatedCell, end.paragraph.associatedCell);\n                for (var i = 0; i < selectedCells.length; i++) {\n                    if (start.paragraph.associatedCell.ownerRow === selectedCells[i].ownerRow) {\n                        count++;\n                    }\n                }\n            }\n        }\n        return count === 0 ? 1 : count;\n    };\n    Editor.prototype.getRowCountToInsert = function () {\n        var count = 1;\n        var start = this.selection.start;\n        var end = this.selection.end;\n        if (!this.selection.isForward) {\n            start = this.selection.end;\n            end = this.selection.start;\n        }\n        if (!isNullOrUndefined(start) && !isNullOrUndefined(end) && !isNullOrUndefined(this.selection.getTable(start, end))) {\n            if (start.paragraph.associatedCell === end.paragraph.associatedCell ||\n                start.paragraph.associatedCell.ownerRow === end.paragraph.associatedCell.ownerRow) {\n                return count = 1;\n            }\n            else {\n                return count = count +\n                    this.getOwnerRow(!this.selection.isForward).rowIndex - this.getOwnerRow(this.selection.isForward).rowIndex;\n            }\n        }\n        return count === 0 ? 1 : count;\n    };\n    Editor.prototype.getOwnerCell = function (isStart) {\n        var cell = undefined;\n        var startCell = isStart ? this.selection.start.paragraph.associatedCell\n            : this.selection.end.paragraph.associatedCell;\n        var endCell = isStart ? this.selection.end.paragraph.associatedCell\n            : this.selection.start.paragraph.associatedCell;\n        cell = startCell;\n        var owner = cell.ownerTable;\n        while (!isNullOrUndefined(owner) && owner.containerWidget instanceof TableCellWidget && owner !== endCell.ownerTable) {\n            cell = owner.containerWidget;\n            owner = cell.ownerTable;\n        }\n        return cell;\n    };\n    Editor.prototype.getOwnerRow = function (isStart) {\n        var row;\n        var startRow = isStart ? this.selection.start.paragraph.associatedCell.ownerRow\n            : this.selection.end.paragraph.associatedCell.ownerRow;\n        var endRow = isStart ? this.selection.end.paragraph.associatedCell.ownerRow\n            : this.selection.start.paragraph.associatedCell.ownerRow;\n        row = startRow;\n        var owner = row.ownerTable;\n        while (!isNullOrUndefined(owner) && owner.containerWidget instanceof TableCellWidget && owner !== endRow.ownerTable) {\n            row = owner.containerWidget.ownerRow;\n            owner = row.ownerTable;\n        }\n        return row;\n    };\n    Editor.prototype.getOwnerTable = function (isStart) {\n        var table = undefined;\n        var startTable = this.selection.start.paragraph.associatedCell.ownerTable;\n        var endTable = this.selection.end.paragraph.associatedCell.ownerTable;\n        table = isStart ? startTable : endTable;\n        while (table.containerWidget instanceof TableCellWidget && table !== (isStart ? endTable : startTable)) {\n            table = table.containerWidget.ownerTable;\n        }\n        return table;\n    };\n    /**\n     * Merge Selected cells\n     * @private\n     */\n    Editor.prototype.mergeSelectedCellsInTable = function () {\n        if (!this.canMergeCells()) {\n            return;\n        }\n        if (this.checkIsNotRedoing()) {\n            this.initHistory('MergeCells');\n        }\n        this.selection.owner.isShiftingEnabled = true;\n        var startPosition = this.selection.start;\n        var endPosition = this.selection.end;\n        if (!this.selection.isForward) {\n            startPosition = this.selection.end;\n            endPosition = this.selection.start;\n        }\n        var startOwnerCell = this.getOwnerCell(this.selection.isForward);\n        var endOwnerCell = this.getOwnerCell(!this.selection.isForward);\n        var containerCell = this.selection.getContainerCellOf(startOwnerCell, endOwnerCell);\n        if (containerCell.ownerTable.contains(endOwnerCell)) {\n            if (!this.selection.containsCell(containerCell, endOwnerCell)) {\n                //Start and End are in different cells.               \n                var table = startOwnerCell.ownerTable.combineWidget(this.viewer);\n                startOwnerCell = this.selection.getSelectedCell(startOwnerCell, containerCell);\n                endOwnerCell = this.selection.getSelectedCell(endOwnerCell, containerCell);\n                //Merges the selected cells.               \n                var mergedCell = this.mergeSelectedCells(table, startOwnerCell, endOwnerCell);\n                var lastParagraph = this.selection.getLastParagraph(mergedCell);\n                endPosition.setPosition(lastParagraph.lastChild, false);\n            }\n        }\n        if (this.checkIsNotRedoing() || isNullOrUndefined(this.editorHistory)) {\n            this.reLayout(this.selection, false);\n        }\n    };\n    Editor.prototype.mergeSelectedCells = function (table, startCell, endCell) {\n        //Clones the entire table to preserve in history.\n        var clonedTable = this.cloneTableToHistoryInfo(table);\n        this.selection.owner.isLayoutEnabled = false;\n        //Merges the selected cells.\n        var start = this.selection.getCellLeft(startCell.ownerRow, startCell);\n        var end = start + startCell.cellFormat.cellWidth;\n        var endCellLeft = this.selection.getCellLeft(endCell.ownerRow, endCell);\n        var endCellRight = endCellLeft + endCell.cellFormat.cellWidth;\n        var cellInfo = this.updateSelectedCellsInTable(start, end, endCellLeft, endCellRight);\n        start = cellInfo.start;\n        end = cellInfo.end;\n        var count = table.childWidgets.indexOf(endCell.ownerRow);\n        var rowStartIndex = table.childWidgets.indexOf(startCell.ownerRow);\n        var mergedCell = undefined;\n        for (var i = rowStartIndex; i <= count; i++) {\n            var row = table.childWidgets[i];\n            for (var j = 0; j < row.childWidgets.length; j++) {\n                var cell = row.childWidgets[j];\n                var cellStart = this.selection.getCellLeft(row, cell);\n                if (HelperMethods.round(start, 2) <= HelperMethods.round(cellStart, 2)\n                    && HelperMethods.round(cellStart, 2) < HelperMethods.round(end, 2)) {\n                    if (isNullOrUndefined(mergedCell)) {\n                        mergedCell = cell;\n                    }\n                    else {\n                        if (i === rowStartIndex) {\n                            mergedCell.cellFormat.preferredWidth += cell.cellFormat.preferredWidth;\n                            mergedCell.cellFormat.columnSpan += cell.cellFormat.columnSpan;\n                            this.mergeBorders(mergedCell, cell);\n                        }\n                        for (var k = 0; k < cell.childWidgets.length; k++) {\n                            var block = cell.childWidgets[k];\n                            if (cell.childWidgets.length === 1 && block instanceof ParagraphWidget\n                                && block.childWidgets.length === 0) {\n                                break;\n                            }\n                            mergedCell.childWidgets.push(block.clone());\n                        }\n                        row.childWidgets.splice(j, 1);\n                        cell.destroy();\n                        j--;\n                    }\n                }\n            }\n            if (row.childWidgets.length === 0) {\n                var rowIndex = table.childWidgets.indexOf(row);\n                row.updateRowBySpannedCells();\n                table.childWidgets.splice(rowIndex, 1);\n                row.destroy();\n                count--;\n                i--;\n            }\n        }\n        if (!isNullOrUndefined(mergedCell) && rowStartIndex < count) {\n            mergedCell.cellFormat.rowSpan = count - rowStartIndex + 1;\n        }\n        this.updateBlockIndexAfterMerge(mergedCell);\n        table.updateRowIndex(0);\n        table.calculateGrid();\n        table.isGridUpdated = false;\n        table.buildTableColumns();\n        table.isGridUpdated = true;\n        this.viewer.layout.reLayoutTable(table);\n        //Layouts the table after merging cells.\n        this.selection.owner.isLayoutEnabled = true;\n        return mergedCell;\n    };\n    Editor.prototype.mergeBorders = function (mergedCell, tableCell) {\n        var mergedCellborders = undefined;\n        var cellBorders = null;\n        if (!isNullOrUndefined(mergedCell.cellFormat.borders)) {\n            mergedCellborders = mergedCell.cellFormat.borders;\n        }\n        if (!isNullOrUndefined(tableCell.cellFormat.borders)) {\n            cellBorders = tableCell.cellFormat.borders;\n        }\n        if (isNullOrUndefined(mergedCellborders) && isNullOrUndefined(cellBorders)) {\n            return;\n        }\n        if (isNullOrUndefined(mergedCellborders)) {\n            mergedCellborders = new WBorders(mergedCell.cellFormat);\n            mergedCellborders.copyFormat(cellBorders);\n        }\n        else if (isNullOrUndefined(cellBorders)) {\n            return;\n        }\n        else {\n            if (mergedCell.ownerRow.rowIndex === tableCell.ownerRow.rowIndex) {\n                mergedCellborders.top = mergedCell.getBorderBasedOnPriority(mergedCellborders.top, cellBorders.bottom);\n                mergedCellborders.bottom = mergedCell.getBorderBasedOnPriority(mergedCellborders.bottom, cellBorders.bottom);\n            }\n        }\n    };\n    Editor.prototype.updateBlockIndexAfterMerge = function (cell) {\n        for (var i = 0; i < cell.childWidgets.length; i++) {\n            cell.childWidgets[i].index = i;\n        }\n    };\n    /**\n     * Determines whether merge cell operation can be done.\n     */\n    Editor.prototype.canMergeCells = function () {\n        if (this.selection.isEmpty || !this.selection.start.paragraph.isInsideTable || !this.selection.end.paragraph.isInsideTable) {\n            return false;\n        }\n        var startPos = this.selection.start;\n        var endPos = this.selection.end;\n        if (!this.selection.isForward) {\n            startPos = this.selection.end;\n            endPos = this.selection.start;\n        }\n        var startCell = this.getOwnerCell(this.selection.isForward);\n        var endCell = this.getOwnerCell(!this.selection.isForward);\n        var containerCell = this.selection.getContainerCellOf(startCell, endCell);\n        if (containerCell.ownerTable.contains(endCell)) {\n            if (!this.selection.containsCell(containerCell, endCell)) {\n                startCell = this.selection.getSelectedCell(startCell, containerCell);\n                endCell = this.selection.getSelectedCell(endCell, containerCell);\n                var rowSpan = 1;\n                if (startCell.ownerRow === endCell.ownerRow) {\n                    var startCellIndex = startCell.ownerRow.childWidgets.indexOf(startCell);\n                    for (var i = startCellIndex; i <= startCell.ownerRow.childWidgets.indexOf(endCell); i++) {\n                        var cell = startCell.ownerRow.childWidgets[i];\n                        var prevCell = cell.previousWidget;\n                        if (i !== startCellIndex) {\n                            if (cell.cellFormat.rowSpan !== rowSpan) {\n                                return false;\n                            }\n                            if (!isNullOrUndefined(prevCell)\n                                && cell.columnIndex !== (prevCell.cellFormat.columnSpan + prevCell.columnIndex)) {\n                                return false;\n                            }\n                        }\n                        rowSpan = cell.cellFormat.rowSpan;\n                    }\n                    return true;\n                }\n                return this.canMergeSelectedCellsInTable(startCell.ownerTable, startCell, endCell);\n            }\n        }\n        return false;\n    };\n    Editor.prototype.canMergeSelectedCellsInTable = function (table, startCell, endCell) {\n        var count = table.childWidgets.indexOf(endCell.ownerRow);\n        var rowStartIndex = table.childWidgets.indexOf(startCell.ownerRow);\n        var startLeft = this.selection.getCellLeft(startCell.ownerRow, startCell);\n        var endLeft = startLeft + startCell.cellFormat.cellWidth;\n        var endCellLeft = this.selection.getCellLeft(endCell.ownerRow, endCell);\n        var endCellRight = endCellLeft + endCell.cellFormat.cellWidth;\n        var cellInfo = this.updateSelectedCellsInTable(startLeft, endLeft, endCellLeft, endCellRight);\n        startLeft = cellInfo.start;\n        endLeft = cellInfo.end;\n        var selectionLeft = 0;\n        var selectionRight = 0;\n        var isRowLeftWithinSel = false;\n        var isRowRightWithinSel = false;\n        var rowSpannedCells = [];\n        for (var i = rowStartIndex; i <= count; i++) {\n            var row = table.childWidgets[i];\n            var rowLeft = 0;\n            var rowRight = 0;\n            var isStarted = false;\n            for (var j = 0; j < row.childWidgets.length; j++) {\n                var cell = row.childWidgets[j];\n                var cellStart = this.selection.getCellLeft(row, cell);\n                if (this.checkCellWithInSelection(startLeft, endLeft, cellStart)) {\n                    isRowLeftWithinSel = false;\n                    isRowRightWithinSel = false;\n                    if (cell.cellFormat.rowSpan > 1) {\n                        rowSpannedCells.push(cell);\n                    }\n                    if (!isStarted) {\n                        rowLeft = cellStart;\n                        rowRight = cellStart;\n                        isStarted = true;\n                    }\n                    var prevCell = cell.previousWidget;\n                    if (rowRight !== 0 && HelperMethods.round(rowRight, 0) !== HelperMethods.round(cellStart, 0)) {\n                        rowRight = cellStart;\n                    }\n                    rowRight += HelperMethods.convertPointToPixel(cell.cellFormat.cellWidth);\n                    var isPrevCellWithinSel = this.checkPrevOrNextCellIsWithinSel(startLeft, endLeft, cell, true);\n                    var isNextCellWithinSel = this.checkPrevOrNextCellIsWithinSel(startLeft, endLeft, cell, false);\n                    // When selected cell not having row spanned cells and column index is not having immediate cell index value,\n                    // then returned false.\n                    var isNoRowSpan = rowSpannedCells.length === 0 || rowSpannedCells.length === 1 && rowSpannedCells[0] === cell;\n                    // checks whether current cell is with in selection.\n                    var isCellWithInSel = this.checkCurrentCell(rowSpannedCells, cell, isPrevCellWithinSel, isNextCellWithinSel);\n                    // when last selected row not having equal row span then returned false.\n                    if (i === count && !isNullOrUndefined(prevCell) && cell.cellFormat.rowSpan > prevCell.cellFormat.rowSpan\n                        && !isCellWithInSel) {\n                        return false;\n                    }\n                    if (i !== rowStartIndex) {\n                        for (var m = 0; m < rowSpannedCells.length; m++) {\n                            {\n                                var rowSpan = (rowSpannedCells[m].ownerRow.rowIndex + rowSpannedCells[m].cellFormat.rowSpan) - 1;\n                                if (rowSpan >= row.rowIndex) {\n                                    if (rowSpannedCells[m].columnIndex > cell.columnIndex) {\n                                        isRowRightWithinSel = true;\n                                    }\n                                    else {\n                                        isRowLeftWithinSel = true;\n                                    }\n                                    if (i === count && rowSpannedCells[m] !== cell\n                                        && rowSpan > (cell.ownerRow.rowIndex + cell.cellFormat.rowSpan - 1)) {\n                                        return false;\n                                    }\n                                    if (rowSpan === row.rowIndex && !this.checkPrevOrNextCellIsWithinSel(startLeft, endLeft, cell, false)) {\n                                        rowSpannedCells.splice(rowSpannedCells.indexOf(rowSpannedCells[m]), 1);\n                                    }\n                                }\n                            }\n                        }\n                    }\n                    if (isPrevCellWithinSel && !isNullOrUndefined(prevCell)\n                        && isNoRowSpan\n                        && (cell.columnIndex !== prevCell.columnIndex + 1 && this.checkCellWidth(cell))) {\n                        return false;\n                    }\n                }\n            }\n            if (i === rowStartIndex) {\n                selectionLeft = rowLeft;\n                selectionRight = rowRight;\n            }\n            else {\n                if (rowRight > 0 && rowLeft > 0) {\n                    if (!((isRowLeftWithinSel || Math.round(selectionLeft) === Math.round(rowLeft))\n                        && (isRowRightWithinSel || Math.round(selectionRight) === Math.round(rowRight)))) {\n                        return false;\n                    }\n                }\n                if (i === count) {\n                    return true;\n                }\n            }\n        }\n        return false;\n    };\n    Editor.prototype.checkCellWidth = function (cell) {\n        var prevCell = cell.previousWidget;\n        var cellLeft = this.viewer.selection.getCellLeft(cell.ownerRow, cell);\n        var prevCellLeft = this.viewer.selection.getCellLeft(cell.ownerRow, prevCell);\n        var left = prevCellLeft + HelperMethods.convertPointToPixel(prevCell.cellFormat.cellWidth);\n        if (HelperMethods.round(left, 2) !== HelperMethods.round(cellLeft, 2)) {\n            return true;\n        }\n        return false;\n    };\n    ;\n    Editor.prototype.checkCellWithInSelection = function (startLeft, endLeft, cellStart) {\n        if (HelperMethods.round(startLeft, 2) <= HelperMethods.round(cellStart, 2)\n            && HelperMethods.round(cellStart, 2) < HelperMethods.round(endLeft, 2)) {\n            return true;\n        }\n        return false;\n    };\n    ;\n    Editor.prototype.checkPrevOrNextCellIsWithinSel = function (startLeft, endLeft, cell, isPrev) {\n        var prevOrNextCell = isPrev ? cell.previousWidget : cell.nextWidget;\n        var cellStart = 0;\n        if (isNullOrUndefined(prevOrNextCell)) {\n            return false;\n        }\n        cellStart = this.viewer.selection.getCellLeft(prevOrNextCell.ownerRow, prevOrNextCell);\n        return this.checkCellWithInSelection(startLeft, endLeft, cellStart);\n    };\n    // tslint:disable-next-line:max-line-length\n    Editor.prototype.checkCurrentCell = function (rowSpannedCells, cell, isPrevCellWithInSel, isNextCellWithinSel) {\n        var cellOwner = cell.ownerRow;\n        if (rowSpannedCells.length > 0) {\n            for (var i = 0; i < rowSpannedCells.length; i++) {\n                var spannedCellOwner = rowSpannedCells[i].ownerRow;\n                var rowSpan = (spannedCellOwner.rowIndex + rowSpannedCells[i].cellFormat.rowSpan) - 1;\n                if (rowSpannedCells[i] === cell && (rowSpannedCells.length === 1 || this.checkRowSpannedCells(rowSpannedCells, cell))\n                    && !(isNextCellWithinSel || isPrevCellWithInSel)) {\n                    return true;\n                }\n                if (rowSpannedCells[i] !== cell && spannedCellOwner.rowIndex < cellOwner.rowIndex\n                    && rowSpan === (cellOwner.rowIndex + cell.cellFormat.rowSpan - 1)) {\n                    return true;\n                }\n            }\n        }\n        return false;\n    };\n    Editor.prototype.checkRowSpannedCells = function (rowSpannedCells, cell) {\n        for (var i = 0; i < rowSpannedCells.length; i++) {\n            if (rowSpannedCells[i] !== cell && rowSpannedCells[i].columnIndex === cell.columnIndex) {\n                return true;\n            }\n        }\n        return false;\n    };\n    /**\n     * @private\n     */\n    Editor.prototype.insertNewParagraphWidget = function (newParagraph, insertAfter) {\n        this.updateInsertPosition();\n        this.insertParagraph(newParagraph, insertAfter);\n        if (!insertAfter) {\n            var nextParagraph = void 0;\n            var currentParagraph = newParagraph;\n            do {\n                nextParagraph = this.selection.getNextParagraphBlock(currentParagraph);\n                currentParagraph = nextParagraph;\n            } while (nextParagraph && nextParagraph.equals(newParagraph));\n            if (!isNullOrUndefined(nextParagraph)) {\n                this.selection.selectParagraph(nextParagraph, true);\n            }\n            else {\n                this.selection.selectParagraph(newParagraph, true);\n            }\n        }\n        this.fireContentChange();\n    };\n    Editor.prototype.insertParagraph = function (newParagraph, insertAfter) {\n        var lineWidget = this.selection.start.currentWidget;\n        var offset = this.selection.start.offset;\n        var currentParagraph = this.selection.start.paragraph;\n        currentParagraph = currentParagraph.combineWidget(this.viewer);\n        if (insertAfter) {\n            // tslint:disable-next-line:max-line-length\n            var length_1 = this.selection.getLineLength(currentParagraph.lastChild);\n            var insertIndex_1 = newParagraph.firstChild ? newParagraph.firstChild.children.length : 0;\n            // tslint:disable-next-line:max-line-length\n            this.moveInlines(currentParagraph, newParagraph, insertIndex_1, offset, lineWidget, length_1, currentParagraph.lastChild);\n        }\n        else if (offset > 0) {\n            this.moveInlines(currentParagraph, newParagraph, 0, 0, currentParagraph.firstChild, offset, lineWidget);\n        }\n        var splittedWidget = currentParagraph.getSplitWidgets();\n        currentParagraph = insertAfter ? splittedWidget[splittedWidget.length - 1] : splittedWidget[0];\n        var insertIndex = currentParagraph.containerWidget.childWidgets.indexOf(currentParagraph);\n        if (insertAfter) {\n            insertIndex++;\n        }\n        var bodyWidget = currentParagraph.containerWidget;\n        newParagraph.index = currentParagraph.index;\n        newParagraph.containerWidget = bodyWidget;\n        bodyWidget.childWidgets.splice(insertIndex, 0, newParagraph);\n        this.updateNextBlocksIndex(insertAfter ? currentParagraph : newParagraph, true);\n        newParagraph.height = 0;\n        this.viewer.layout.layoutBodyWidgetCollection(newParagraph.index, bodyWidget, newParagraph, false);\n    };\n    // tslint:disable-next-line:max-line-length\n    Editor.prototype.moveInlines = function (currentParagraph, newParagraph, insertIndex, startOffset, startLine, endOffset, endLine) {\n        if (newParagraph.childWidgets.length === 0) {\n            var line = new LineWidget(newParagraph);\n            newParagraph.childWidgets.push(line);\n        }\n        var isMoved = false;\n        this.viewer.layout.clearListElementBox(currentParagraph);\n        this.viewer.layout.clearListElementBox(newParagraph);\n        for (var j = 0; j < currentParagraph.childWidgets.length; j++) {\n            var lineWidget = currentParagraph.childWidgets[j];\n            if (startLine === lineWidget && endLine === lineWidget) {\n                insertIndex = this.moveContent(lineWidget, startOffset, endOffset, insertIndex, newParagraph);\n                break;\n            }\n            if (endLine === lineWidget) {\n                insertIndex = this.moveContent(lineWidget, 0, endOffset, insertIndex, newParagraph);\n                break;\n            }\n            else if (startLine === lineWidget) {\n                isMoved = true;\n                // tslint:disable-next-line:max-line-length\n                insertIndex = this.moveContent(lineWidget, startOffset, this.viewer.selection.getLineLength(lineWidget), insertIndex, newParagraph);\n            }\n            else if (isMoved) {\n                insertIndex = this.moveContent(lineWidget, 0, this.viewer.selection.getLineLength(lineWidget), insertIndex, newParagraph);\n            }\n        }\n        this.removeEmptyLine(currentParagraph);\n        if (!currentParagraph.isInsideTable) {\n            this.viewer.layout.reLayoutParagraph(currentParagraph, 0, 0);\n        }\n    };\n    /**\n     * @private\n     */\n    //tslint:disable-next-line:max-line-length\n    Editor.prototype.moveContent = function (lineWidget, startOffset, endOffset, insertIndex, paragraph) {\n        var count = 0;\n        var lineIndex = lineWidget.paragraph.childWidgets.indexOf(lineWidget);\n        for (var i = 0; i < lineWidget.children.length; i++) {\n            var inline = lineWidget.children[i];\n            if (startOffset >= count + inline.length || inline instanceof ListTextElementBox) {\n                if (!(inline instanceof ListTextElementBox)) {\n                    count += inline.length;\n                }\n                continue;\n            }\n            var startIndex = 0;\n            if (startOffset > count) {\n                startIndex = startOffset - count;\n            }\n            var endIndex = endOffset - count;\n            if (endIndex > inline.length) {\n                endIndex = inline.length;\n            }\n            if (startIndex > 0) {\n                count += startIndex;\n            }\n            if (startIndex === 0 && endIndex === inline.length) {\n                paragraph.firstChild.children.splice(insertIndex, 0, inline);\n                inline.line = paragraph.firstChild;\n                insertIndex++;\n                // if (editAction < 4) {\n                // this.unLinkFieldCharacter(inline);\n                lineWidget.children.splice(i, 1);\n                i--;\n                // }\n            }\n            else if (inline instanceof TextElementBox) {\n                // if (editAction < 4) {\n                var span = new TextElementBox();\n                span.characterFormat.copyFormat(inline.characterFormat);\n                span.text = inline.text.substr(startIndex, endIndex - startIndex);\n                paragraph.firstChild.children.splice(insertIndex, 0, span);\n                span.line = paragraph.firstChild;\n                insertIndex++;\n                inline.text = inline.text.slice(0, startIndex) + inline.text.slice(endIndex);\n            }\n            if (endOffset <= count + endIndex - startIndex) {\n                break;\n            }\n            count += endIndex - startIndex;\n        }\n        return insertIndex;\n    };\n    /**\n     * update complex changes when history is not preserved\n     * @param  {number} action?\n     * @param  {string} start?\n     * @param  {string} end?\n     * @private\n     */\n    Editor.prototype.updateComplexWithoutHistory = function (action, start, end) {\n        var selection = this.viewer.selection;\n        if (action === 0) {\n            var startPosition = new TextPosition(selection.owner);\n            this.setPositionForCurrentIndex(startPosition, start);\n            this.viewer.layout.reLayoutParagraph(startPosition.paragraph, 0, 0);\n            this.setPositionForCurrentIndex(selection.start, end);\n            this.setPositionForCurrentIndex(selection.end, end);\n        }\n        if (action === 1) {\n            var startPosition = new TextPosition(selection.owner);\n            this.setPositionForCurrentIndex(startPosition, start);\n            var endPosition = new TextPosition(selection.owner);\n            this.setPositionForCurrentIndex(endPosition, end);\n            this.viewer.layout.reLayoutParagraph(startPosition.paragraph, 0, 0);\n            if (endPosition.paragraph !== startPosition.paragraph) {\n                this.viewer.layout.reLayoutParagraph(endPosition.paragraph, 0, 0);\n            }\n        }\n        if (selection.owner.isShiftingEnabled) {\n            this.viewer.layout.shiftLayoutedItems();\n            if (this.viewer.owner.enableHeaderAndFooter) {\n                this.updateHeaderFooterWidget();\n            }\n        }\n        selection.owner.isShiftingEnabled = false;\n        selection.start.updatePhysicalPosition(true);\n        if (selection.isEmpty) {\n            selection.end.setPositionInternal(selection.start);\n        }\n        else {\n            selection.end.updatePhysicalPosition(true);\n        }\n        selection.upDownSelectionLength = selection.end.location.x;\n        selection.fireSelectionChanged(true);\n        this.viewer.updateFocus();\n        this.viewer.updateScrollBars();\n        this.fireContentChange();\n        this.isHandledComplex = true;\n    };\n    /**\n     * reLayout\n     * @param selection\n     * @param isSelectionChanged\n     * @private\n     */\n    Editor.prototype.reLayout = function (selection, isSelectionChanged) {\n        if (this.editorHistory && this.editorHistory.isHandledComplexHistory()) {\n            if (isNullOrUndefined(this.editorHistory.currentBaseHistoryInfo)\n                || (this.editorHistory.currentBaseHistoryInfo\n                    && !(this.editorHistory.currentBaseHistoryInfo.action === 'ClearCharacterFormat'\n                        || this.editorHistory.currentBaseHistoryInfo.action === 'ClearParagraphFormat'))) {\n                this.startParagraph = undefined;\n                this.endParagraph = undefined;\n            }\n            this.isHandledComplex = false;\n            return;\n        }\n        if (isNullOrUndefined(this.viewer.blockToShift)) {\n            this.viewer.removeEmptyPages();\n            this.viewer.layout.updateFieldElements();\n            this.viewer.updateScrollBars();\n            if (!selection.owner.isShiftingEnabled) {\n                selection.fireSelectionChanged(true);\n                this.startParagraph = undefined;\n                this.endParagraph = undefined;\n            }\n        }\n        if (isNullOrUndefined(isSelectionChanged)) {\n            isSelectionChanged = selection.isEmpty;\n        }\n        if (selection.owner.isShiftingEnabled) {\n            selection.owner.isShiftingEnabled = false;\n            selection.owner.isLayoutEnabled = true;\n            this.viewer.layout.shiftLayoutedItems();\n            if (this.viewer.owner.enableHeaderAndFooter) {\n                this.updateHeaderFooterWidget();\n            }\n            this.getOffsetValue(selection);\n            selection.upDownSelectionLength = selection.end.location.x;\n            selection.fireSelectionChanged(true);\n            this.viewer.updateFocus();\n            this.startParagraph = undefined;\n            this.endParagraph = undefined;\n            this.viewer.layout.allowLayout = true;\n        }\n        if (this.editorHistory && this.editorHistory.currentBaseHistoryInfo &&\n            ((this.editorHistory.currentBaseHistoryInfo.action !== 'RowResizing'\n                && this.editorHistory.currentBaseHistoryInfo.action !== 'CellResizing')\n                || (this.editorHistory.isUndoing || this.editorHistory.isRedoing))) {\n            if (this.editorHistory.currentBaseHistoryInfo.modifiedProperties.length > 0) {\n                this.editorHistory.currentBaseHistoryInfo.updateSelection();\n            }\n            this.editorHistory.updateHistory();\n        }\n        this.fireContentChange();\n    };\n    /**\n     * @private\n     */\n    Editor.prototype.updateHeaderFooterWidget = function () {\n        this.updateHeaderFooterWidgetToPage(this.selection.start.paragraph.bodyWidget);\n        this.shiftPageContent(this.selection.start.paragraph.bodyWidget);\n    };\n    /**\n     * @private\n     */\n    Editor.prototype.updateHeaderFooterWidgetToPage = function (node) {\n        var currentPage = node.page;\n        node = this.viewer.layout.updateHeaderFooterToParent(node);\n        var isEvenPage = (node.headerFooterType === 'EvenHeader' || node.headerFooterType === 'EvenFooter');\n        for (var i = 0; i < this.viewer.pages.length; i++) {\n            var page = this.viewer.pages[i];\n            if ((i + 1 === 1) && page.bodyWidgets[0].sectionFormat.differentFirstPage &&\n                node.headerFooterType.indexOf('FirstPage') !== -1) {\n                return;\n            }\n            if (page.index === 0 && page.bodyWidgets[0].sectionFormat.differentFirstPage &&\n                node.headerFooterType.indexOf('FirstPage') === -1) {\n                continue;\n            }\n            if (currentPage !== page) {\n                if (page.bodyWidgets[0].sectionFormat.differentOddAndEvenPages) {\n                    if (isEvenPage && (i + 1) % 2 === 0) {\n                        this.updateHeaderFooterWidgetToPageInternal(page, node, node.headerFooterType.indexOf('Header') !== -1);\n                    }\n                    else if ((!isEvenPage && (i + 1) % 2 !== 0)) {\n                        if (page.bodyWidgets[0].sectionFormat.differentFirstPage && (i + 1 !== 1)) {\n                            this.updateHeaderFooterWidgetToPageInternal(page, node, node.headerFooterType.indexOf('Header') !== -1);\n                        }\n                    }\n                }\n                else {\n                    this.updateHeaderFooterWidgetToPageInternal(page, node, node.headerFooterType.indexOf('Header') !== -1);\n                }\n            }\n        }\n    };\n    /**\n     * @private\n     */\n    Editor.prototype.updateHeaderFooterWidgetToPageInternal = function (page, widget, isHeader) {\n        if (widget.page !== page) {\n            var hfWidget = widget.clone();\n            hfWidget.page = page;\n            this.viewer.updateHFClientArea(hfWidget.sectionFormat, isHeader);\n            hfWidget = this.viewer.layout.layoutHeaderFooterItems(this.viewer, hfWidget);\n            var headerOrFooter = void 0;\n            if (isHeader) {\n                headerOrFooter = page.headerWidget;\n                page.headerWidget = hfWidget;\n            }\n            else {\n                headerOrFooter = page.footerWidget;\n                page.footerWidget = hfWidget;\n            }\n            this.removeFieldInWidget(headerOrFooter);\n            headerOrFooter.destroy();\n        }\n    };\n    /**\n     * @private\n     */\n    Editor.prototype.removeFieldInWidget = function (widget) {\n        for (var i = 0; i < widget.childWidgets.length; i++) {\n            this.removeFieldInBlock(widget.childWidgets[i]);\n        }\n    };\n    /**\n     * @private\n     */\n    Editor.prototype.removeFieldInBlock = function (block) {\n        if (block instanceof TableWidget) {\n            this.removeFieldTable(block);\n        }\n        else {\n            this.removeField(block);\n        }\n    };\n    /**\n     * @private\n     */\n    Editor.prototype.removeFieldTable = function (table) {\n        for (var i = 0; i < table.childWidgets.length; i++) {\n            var row = table.childWidgets[i];\n            for (var j = 0; j < row.childWidgets.length; j++) {\n                this.removeFieldInWidget(row.childWidgets[j]);\n            }\n        }\n    };\n    /**\n     * @private\n     */\n    Editor.prototype.shiftPageContent = function (headerFooter) {\n        var type = headerFooter.headerFooterType;\n        var pageIndex;\n        if (type === 'FirstPageHeader' || type === 'FirstPageFooter') {\n            pageIndex = 0;\n        }\n        else if (headerFooter.sectionFormat.differentOddAndEvenPages) {\n            if (headerFooter.sectionFormat.differentFirstPage) {\n                pageIndex = (type === 'EvenHeader' || type === 'EvenFooter') ? 1 : 2;\n            }\n            else {\n                pageIndex = (type.indexOf('Even') === -1) ? 0 : 1;\n            }\n        }\n        else {\n            pageIndex = headerFooter.sectionFormat.differentFirstPage ? 1 : 0;\n            if (pageIndex === 1 && this.viewer.pages.length === 1) {\n                pageIndex = 0;\n            }\n        }\n        var page = this.viewer.pages[pageIndex];\n        if (type.indexOf('Header') !== -1) {\n            var firstBlock = page.bodyWidgets[0].firstChild;\n            var top_1 = HelperMethods.convertPointToPixel(headerFooter.sectionFormat.topMargin);\n            var headerDistance = HelperMethods.convertPointToPixel(headerFooter.sectionFormat.headerDistance);\n            top_1 = Math.max(headerDistance + page.headerWidget.height, top_1);\n            if (firstBlock.y !== top_1) {\n                this.viewer.updateClientArea(page.bodyWidgets[0].sectionFormat, page);\n                firstBlock = firstBlock.combineWidget(this.viewer);\n                var prevWidget = firstBlock.previousRenderedWidget;\n                if (prevWidget) {\n                    this.viewer.cutFromTop(prevWidget.y + prevWidget.height);\n                    if (firstBlock.containerWidget !== prevWidget.containerWidget) {\n                        // tslint:disable-next-line:max-line-length\n                        this.viewer.layout.updateContainerWidget(firstBlock, prevWidget.containerWidget, prevWidget.indexInOwner + 1, false);\n                    }\n                }\n                this.viewer.blockToShift = firstBlock;\n            }\n        }\n        else {\n            this.checkAndShiftFromBottom(page, headerFooter);\n        }\n        if (this.viewer.blockToShift) {\n            this.viewer.renderedLists.clear();\n            this.viewer.layout.shiftLayoutedItems();\n        }\n    };\n    /**\n     * @private\n     */\n    Editor.prototype.checkAndShiftFromBottom = function (page, footerWidget) {\n        var bodyWidget = page.bodyWidgets[0];\n        var blockToShift;\n        for (var i = 0; i < bodyWidget.childWidgets.length; i++) {\n            var block = bodyWidget.childWidgets[i];\n            if (block.y + block.height > footerWidget.y) {\n                blockToShift = block;\n                break;\n            }\n            if (bodyWidget.childWidgets.length - 1 === i && block.y + block.height < footerWidget.y) {\n                blockToShift = block;\n                break;\n            }\n        }\n        this.viewer.updateClientArea(bodyWidget.sectionFormat, page);\n        this.viewer.cutFromTop(blockToShift.y);\n        this.viewer.blockToShift = blockToShift;\n    };\n    //Paste Implementation ends\n    //Character Format apply implementation starts\n    /**\n     * Change HighlightColor\n     * @param  {HighlightColor} highlightColor\n     * Applies character format for selection.\n     * @param {string} property\n     * @param {Object} value\n     * @param {boolean} update\n     * @private\n     */\n    Editor.prototype.onApplyCharacterFormat = function (property, value, update) {\n        var selection = this.viewer.selection;\n        if (selection.owner.isReadOnlyMode || !selection.owner.isDocumentLoaded) {\n            return;\n        }\n        update = isNullOrUndefined(update) ? false : update;\n        var action = (property[0].toUpperCase() + property.slice(1));\n        var paragraph = selection.start.paragraph;\n        var lastLine = paragraph.childWidgets[paragraph.childWidgets.length - 1];\n        if (selection.isEmpty && selection.contextType !== 'List') {\n            selection.skipFormatRetrieval = true;\n            if (selection.end.isAtParagraphEnd) {\n                this.initHistory(action);\n                this.viewer.owner.isShiftingEnabled = true;\n                this.applyCharFormatValue(paragraph.characterFormat, property, value, update);\n                this.reLayout(this.viewer.selection);\n                this.viewer.updateFocus();\n            }\n            else {\n                selection.fireSelectionChanged(true);\n            }\n            selection.skipFormatRetrieval = false;\n            return;\n        }\n        this.setOffsetValue(selection);\n        this.initHistory(action);\n        // Todo: Complete Microsoft Word behavior on apply formatting in empty selection\n        // if (selection.isEmpty) {\n        //     this.viewer.owner.isShiftingEnabled = true;\n        //     this.applyCharFormatValue(paragraph.characterFormat, property, value, update);\n        //     this.reLayout(this.viewer.selection);\n        //     this.viewer.updateFocus();\n        //     return;\n        // }\n        if (selection.contextType === 'List') {\n            // this.updateCharacterFormatForListText(selection, action, value, update);\n            this.applyCharacterFormatForListText(selection, property, value, update);\n        }\n        else {\n            //Iterate and update format.\n            this.updateSelectionCharacterFormatting(property, value, update);\n        }\n    };\n    /**\n     * @private\n     */\n    // tslint:disable-next-line:max-line-length\n    Editor.prototype.applyCharacterFormatForListText = function (selection, property, values, update) {\n        var listLevel = this.getListLevel(selection.start.paragraph);\n        if (isNullOrUndefined(listLevel)) {\n            return;\n        }\n        var characterFormat = listLevel.characterFormat;\n        switch (property) {\n            case 'bold':\n                this.applyListCharacterFormatByValue(selection, characterFormat, 'bold', !(characterFormat.bold));\n                break;\n            case 'italic':\n                this.applyListCharacterFormatByValue(selection, characterFormat, 'italic', !(characterFormat.italic));\n                break;\n            case 'fontColor':\n                this.applyListCharacterFormatByValue(selection, characterFormat, 'fontColor', values);\n                break;\n            case 'fontFamily':\n                this.applyListCharacterFormatByValue(selection, characterFormat, 'fontFamily', values);\n                break;\n            case 'fontSize':\n                this.applyListCharacterFormatByValue(selection, characterFormat, 'fontSize', values);\n                break;\n            case 'highlightColor':\n                this.applyListCharacterFormatByValue(selection, characterFormat, 'highlightColor', values);\n                break;\n            case 'baselineAlignment':\n                if (characterFormat.baselineAlignment === values) {\n                    values = 'Normal';\n                }\n                this.applyListCharacterFormatByValue(selection, characterFormat, 'baselineAlignment', values);\n                break;\n            case 'strikethrough':\n                if (characterFormat.strikethrough === values) {\n                    values = 'None';\n                }\n                this.applyListCharacterFormatByValue(selection, characterFormat, 'strikethrough', values);\n                break;\n            case 'underline':\n                if (characterFormat.underline === values) {\n                    values = 'None';\n                }\n                this.applyListCharacterFormatByValue(selection, characterFormat, 'underline', values);\n                break;\n            case 'characterFormat':\n                this.applyListCharacterFormatByValue(selection, characterFormat, undefined, values);\n                break;\n        }\n    };\n    Editor.prototype.applyListCharacterFormatByValue = function (selection, format, property, value) {\n        this.initHistory('ListCharacterFormat');\n        this.applyCharFormatValue(format, property, value, false);\n        this.editorHistory.updateHistory();\n        this.reLayout(selection);\n        this.fireContentChange();\n    };\n    /**\n     * @private\n     */\n    Editor.prototype.updateListCharacterFormat = function (selection, property, value) {\n        this.updateListTextSelRange(selection, property, value, false);\n    };\n    Editor.prototype.updateListTextSelRange = function (selection, property, value, update) {\n        this.viewer.owner.isShiftingEnabled = true;\n        var startPositionInternal = selection.start;\n        var endPositionInternal = selection.end;\n        if (!selection.isForward) {\n            startPositionInternal = selection.end;\n            endPositionInternal = selection.start;\n        }\n        this.initHistoryPosition(selection, startPositionInternal);\n        var listLevel = this.getListLevel(selection.start.paragraph);\n        this.applyCharFormatValue(listLevel.characterFormat, property, value, update);\n        this.startSelectionReLayouting(startPositionInternal.paragraph, selection, startPositionInternal, endPositionInternal);\n    };\n    /**\n     * @private\n     */\n    Editor.prototype.getListLevel = function (paragraph) {\n        var currentList = undefined;\n        var listLevelNumber = 0;\n        if (!isNullOrUndefined(paragraph.paragraphFormat) && !isNullOrUndefined(paragraph.paragraphFormat.listFormat)) {\n            currentList = this.viewer.getListById(paragraph.paragraphFormat.listFormat.listId);\n            listLevelNumber = paragraph.paragraphFormat.listFormat.listLevelNumber;\n        }\n        if (!isNullOrUndefined(currentList) &&\n            !isNullOrUndefined(this.viewer.getAbstractListById(currentList.abstractListId))\n            // && !isNullOrUndefined(this.viewer.getAbstractListById(currentList.abstractListId).levels.getItem(listLevelNumber))) {\n            && !isNullOrUndefined(this.viewer.getAbstractListById(currentList.abstractListId).levels)) {\n            return this.viewer.layout.getListLevel(currentList, listLevelNumber);\n        }\n        return undefined;\n    };\n    Editor.prototype.updateInsertPosition = function () {\n        var selection = this.viewer.selection;\n        var position = selection.start;\n        if (!selection.isForward) {\n            position = selection.end;\n        }\n        if (this.editorHistory && !isNullOrUndefined(this.editorHistory.currentBaseHistoryInfo)\n            && !isNullOrUndefined(position)) {\n            if (isNullOrUndefined(this.editorHistory.currentBaseHistoryInfo.insertPosition)) {\n                this.updateHistoryPosition(position, true);\n            }\n        }\n    };\n    /**\n     * preserve paragraph and offset value for selection\n     * @private\n     */\n    Editor.prototype.setOffsetValue = function (selection) {\n        var info = this.getParagraphInfo(selection.start);\n        this.startParagraph = info.paragraph;\n        this.startOffset = info.offset;\n        info = this.getParagraphInfo(selection.end);\n        this.endParagraph = info.paragraph;\n        this.endOffset = info.offset;\n    };\n    /**\n     * Toggles the highlight color property of selected contents.\n     * @param {HighlightColor} highlightColor Default value of â€˜underlineâ€™ parameter is Yellow.\n     */\n    Editor.prototype.toggleHighlightColor = function (highlightColor) {\n        var selection = this.viewer.selection;\n        if (isNullOrUndefined(highlightColor) || highlightColor === 'NoColor') {\n            highlightColor = 'Yellow';\n        }\n        //In Ms Word the highlight color is took from the ribbon. So we Have given yellow as constant.\n        if (selection.characterFormat.highlightColor === highlightColor) {\n            highlightColor = 'NoColor';\n        }\n        this.selection.characterFormat.highlightColor = highlightColor;\n    };\n    /**\n     * Toggles the subscript formatting of selected contents.\n     */\n    Editor.prototype.toggleSubscript = function () {\n        if (!this.owner.isReadOnlyMode) {\n            var value = this.selection.characterFormat.baselineAlignment === 'Subscript' ? 'Normal' : 'Subscript';\n            this.selection.characterFormat.baselineAlignment = value;\n        }\n    };\n    /**\n     * Toggles the superscript formatting of selected contents.\n     */\n    Editor.prototype.toggleSuperscript = function () {\n        if (!this.owner.isReadOnlyMode) {\n            var value = this.selection.characterFormat.baselineAlignment === 'Superscript' ? 'Normal' : 'Superscript';\n            this.selection.characterFormat.baselineAlignment = value;\n        }\n    };\n    /**\n     * Toggles the text alignment property of selected contents.\n     * @param {TextAlignment} textAlignment Default value of â€˜textAlignment parameter is TextAlignment.Left.\n     */\n    /**\n     * Increases the left indent of selected paragraphs to a factor of 36 points.\n     */\n    Editor.prototype.increaseIndent = function () {\n        if (!this.owner.isReadOnlyMode) {\n            this.onApplyParagraphFormat('leftIndent', this.viewer.defaultTabWidth, true, false);\n        }\n    };\n    /**\n     * Decreases the left indent of selected paragraphs to a factor of 36 points.\n     */\n    Editor.prototype.decreaseIndent = function () {\n        if (!this.owner.isReadOnlyMode) {\n            this.onApplyParagraphFormat('leftIndent', -this.viewer.defaultTabWidth, true, false);\n        }\n    };\n    /**\n     * Clears the list format for selected paragraphs.\n     */\n    Editor.prototype.clearList = function () {\n        this.selection.owner.editorModule.onApplyList(undefined);\n    };\n    /**\n     * Applies the bullet list to selected paragraphs.\n     * @param {string} bullet Bullet character\n     * @param {string} fontFamily Bullet font family\n     */\n    Editor.prototype.applyBullet = function (bullet, fontFamily) {\n        if (!this.owner.isReadOnlyMode) {\n            this.applyBulletOrNumbering(bullet, 'Bullet', fontFamily);\n        }\n    };\n    /**\n     * Applies the numbering list to selected paragraphs.\n     * @param numberFormat  â€œ%nâ€ representations in â€˜numberFormatâ€™ parameter will be replaced by respective list levelâ€™s value.\n     * `â€œ%1)â€ will be displayed as â€œ1)â€ `\n     * @param listLevelPattern  Default value of â€˜listLevelPatternâ€™ parameter is ListLevelPattern.Arabic\n     */\n    Editor.prototype.applyNumbering = function (numberFormat, listLevelPattern) {\n        if (!this.owner.isReadOnlyMode) {\n            this.applyBulletOrNumbering(numberFormat, listLevelPattern, 'Verdana');\n        }\n    };\n    /**\n     * Toggles the baseline alignment property of selected contents.\n     * @param  {Selection} selection\n     * @param  {BaselineAlignment} baseAlignment\n     */\n    Editor.prototype.toggleBaselineAlignment = function (baseAlignment) {\n        this.updateProperty(2, baseAlignment);\n    };\n    /**\n     * Clears the formatting.\n     */\n    Editor.prototype.clearFormatting = function () {\n        var selection = this.viewer.selection;\n        this.initComplexHistory('ClearFormat');\n        // let startIndex: string = selection.start.getHierarchicalIndexInternal();\n        // let endIndex: string = selection.end.getHierarchicalIndexInternal();\n        if (selection.isEmpty) {\n            selection.start.moveToParagraphStartInternal(selection, false);\n            selection.end.moveToParagraphEndInternal(selection, false);\n        }\n        this.setOffsetValue(selection);\n        if (this.editorHistory) {\n            this.editorHistory.initializeHistory('ClearCharacterFormat');\n        }\n        this.updateSelectionCharacterFormatting('ClearCharacterFormat', undefined, false);\n        this.getOffsetValue(selection);\n        if (this.editorHistory) {\n            this.editorHistory.updateHistory();\n        }\n        this.setOffsetValue(selection);\n        if (this.editorHistory) {\n            this.editorHistory.initializeHistory('ClearParagraphFormat');\n        }\n        this.updateParagraphFormatInternal('ClearParagraphFormat', undefined, false);\n        if (this.editorHistory) {\n            this.editorHistory.updateHistory();\n        }\n        this.getOffsetValue(selection);\n        if (this.editorHistory && !isNullOrUndefined(this.editorHistory.currentHistoryInfo)) {\n            this.editorHistory.updateComplexHistory();\n        }\n        this.startParagraph = undefined;\n        this.endParagraph = undefined;\n        // else {\n        //     this.checkAndUpdatedSelection(startIndex, endIndex);\n        // }\n    };\n    /**\n     * Toggles the specified property. If property is assigned already. Then property will be changed\n     * @param  {Selection} selection\n     * @param  {number} type\n     * @param  {Object} value\n     * @private\n     */\n    Editor.prototype.updateProperty = function (type, value) {\n        var selection = this.selection;\n        if (selection.owner.isReadOnlyMode || !selection.owner.isDocumentLoaded) {\n            return;\n        }\n        var startPosition = selection.start;\n        var endPosition = selection.end;\n        if (!selection.isForward) {\n            startPosition = selection.end;\n            endPosition = selection.start;\n        }\n        var indexInInline = 0;\n        var inlineObj = startPosition.currentWidget.getInline(startPosition.offset, indexInInline);\n        var inline = inlineObj.element;\n        indexInInline = inlineObj.index;\n        var paragraph = startPosition.paragraph;\n        if (!isNullOrUndefined(inline) && inline.length === indexInInline && !this.selection.isEmpty) {\n            inline = inline.nextNode;\n        }\n        if (type === 1) {\n            var currentUnderline = 'None';\n            if (!isNullOrUndefined(inline)) {\n                currentUnderline = inline.characterFormat.underline;\n            }\n            else if (!isNullOrUndefined(paragraph)) {\n                currentUnderline = paragraph.characterFormat.underline;\n            }\n            this.selection.characterFormat.underline = value === currentUnderline ? 'None' : value;\n        }\n        else {\n            var script = 'Normal';\n            if (!isNullOrUndefined(inline)) {\n                script = inline.characterFormat.baselineAlignment;\n            }\n            else if (!isNullOrUndefined(paragraph)) {\n                script = paragraph.characterFormat.baselineAlignment;\n            }\n            if (script === value) {\n                value = 'Normal';\n            }\n            this.selection.characterFormat.baselineAlignment = value;\n        }\n    };\n    Editor.prototype.getCompleteStyles = function () {\n        var completeStylesString = '{\"styles\":[';\n        for (var _i = 0, _a = this.viewer.preDefinedStyles.getItem(); _i < _a.length; _i++) {\n            var name_1 = _a[_i];\n            completeStylesString += (this.viewer.preDefinedStyles.get(name_1) + ',');\n        }\n        return completeStylesString.slice(0, -1) + ']}';\n    };\n    /**\n     * Initialize default styles\n     * @private\n     */\n    Editor.prototype.intializeDefaultStyles = function () {\n        var existingStyles = this.owner.getStyleNames('Paragraph');\n        var defaultStyleNames = ['Normal', 'Heading 1', 'Heading 2', 'Heading 3', 'Heading 4', 'Heading 5', 'Heading 6'];\n        var styleNames = defaultStyleNames.filter(function (val) {\n            return existingStyles.indexOf(val) === -1;\n        });\n        for (var _i = 0, styleNames_1 = styleNames; _i < styleNames_1.length; _i++) {\n            var name_2 = styleNames_1[_i];\n            this.createStyle(this.viewer.preDefinedStyles.get(name_2));\n        }\n    };\n    /**\n     * Creates a new instance of Style.\n     */\n    Editor.prototype.createStyle = function (styleString) {\n        this.createStyleIn(styleString);\n    };\n    /**\n     * Create a Style.\n     * @private\n     */\n    Editor.prototype.createStyleIn = function (styleString) {\n        /* tslint:disable:no-any */\n        var style = JSON.parse(styleString);\n        var styleObj = this.viewer.styles.findByName(style.name);\n        if (styleObj !== undefined) {\n            //Create a new style with new name and add it to collection.\n            style.name = this.getUniqueStyleName(style.name);\n        }\n        this.viewer.owner.parser.parseStyle(JSON.parse(this.getCompleteStyles()), style, this.viewer.styles);\n        return this.viewer.styles.findByName(style.name);\n    };\n    /**\n     * @private\n     */\n    Editor.prototype.getUniqueStyleName = function (name) {\n        var uniqueName = this.getUniqueName(name);\n        var style = this.viewer.styles.findByName(uniqueName);\n        while (!isNullOrUndefined(style)) {\n            uniqueName = this.getUniqueStyleName(style.name);\n            style = this.viewer.styles.findByName(uniqueName);\n        }\n        return uniqueName;\n    };\n    Editor.prototype.getUniqueName = function (name) {\n        var matchArray = name.match(/\\d+$/);\n        var returnName;\n        if (!isNullOrUndefined(matchArray) && matchArray.length > 0) {\n            return name.replace(matchArray[0], (parseInt(matchArray[0], 10) + 1).toString());\n        }\n        else {\n            return name + '_1';\n        }\n    };\n    /**\n     * Update Character format for selection\n     * @private\n     */\n    Editor.prototype.updateSelectionCharacterFormatting = function (property, values, update) {\n        if (isNullOrUndefined(property)) {\n            property = 'CharacterFormat';\n        }\n        switch (property) {\n            case 'bold':\n                this.updateCharacterFormat('bold', values);\n                break;\n            case 'italic':\n                this.updateCharacterFormat('italic', values);\n                break;\n            case 'fontColor':\n                this.updateCharacterFormat('fontColor', values);\n                break;\n            case 'fontFamily':\n                this.updateCharacterFormat('fontFamily', values);\n                break;\n            case 'fontSize':\n                this.updateCharacterFormatWithUpdate(this.viewer.selection, 'fontSize', values, update);\n                break;\n            case 'highlightColor':\n                this.updateCharacterFormat('highlightColor', values);\n                break;\n            case 'baselineAlignment':\n                this.updateCharacterFormat('baselineAlignment', values);\n                break;\n            case 'strikethrough':\n                this.updateCharacterFormat('strikethrough', values);\n                break;\n            case 'underline':\n                this.updateCharacterFormat('underline', values);\n                break;\n            case 'styleName':\n                this.updateCharacterFormatWithUpdate(this.viewer.selection, 'styleName', values, true);\n                break;\n            case 'CharacterFormat':\n                this.updateCharacterFormat(undefined, values);\n                break;\n            case 'ClearCharacterFormat':\n                this.updateCharacterFormat(undefined, values);\n                break;\n        }\n        this.reLayout(this.viewer.selection);\n    };\n    /**\n     * Update character format for selection range\n     * @param  {SelectionRange} selectionRange\n     * @param  {string} property\n     * @param  {Object} value\n     * @returns void\n     * @private\n     */\n    Editor.prototype.updateCharacterFormat = function (property, value) {\n        this.updateCharacterFormatWithUpdate(this.viewer.selection, property, value, false);\n    };\n    Editor.prototype.updateCharacterFormatWithUpdate = function (selection, property, value, update) {\n        this.viewer.owner.isShiftingEnabled = true;\n        var startPosition = selection.start;\n        var endPosition = selection.end;\n        if (!selection.isForward) {\n            startPosition = selection.end;\n            endPosition = selection.start;\n        }\n        this.applyCharFormatSelectedContent(startPosition.paragraph, selection, startPosition, endPosition, property, value, update);\n    };\n    // tslint:disable-next-line:max-line-length\n    Editor.prototype.applyCharFormatSelectedContent = function (paragraph, selection, start, end, property, value, update) {\n        //Selection start in cell.\n        if (start.paragraph.isInsideTable && (!end.paragraph.isInsideTable\n            || start.paragraph.associatedCell !== end.paragraph.associatedCell\n            || selection.isCellSelected(start.paragraph.associatedCell, start, end))) {\n            var cell = void 0;\n            start.paragraph.associatedCell.ownerTable.combineWidget(this.viewer);\n            if (this.checkInsertPosition(selection)) {\n                this.updateHistoryPosition(start, true);\n            }\n            cell = start.paragraph.associatedCell;\n            this.applyCharFormatCell(cell, selection, start, end, property, value, update);\n            var table = cell.ownerTable;\n            // tslint:disable-next-line:max-line-length\n            this.viewer.layout.layoutBodyWidgetCollection(table.index, table.containerWidget, table, false);\n        }\n        else {\n            this.applyCharFormat(paragraph, selection, start, end, property, value, update);\n        }\n    };\n    // tslint:disable-next-line:max-line-length\n    Editor.prototype.applyCharFormatForSelectedPara = function (paragraph, selection, property, value, update) {\n        for (var i = 0; i < paragraph.childWidgets.length; i++) {\n            var line = paragraph.childWidgets[i];\n            for (var j = 0; j < line.children.length; j++) {\n                var element = line.children[j];\n                this.applyCharFormatValue(element.characterFormat, property, value, update);\n            }\n        }\n        this.applyCharFormatValue(paragraph.characterFormat, property, value, update);\n    };\n    Editor.prototype.splittedLastParagraph = function (paragraph) {\n        var splittedWidets = paragraph.getSplitWidgets();\n        return splittedWidets[splittedWidets.length - 1];\n    };\n    // tslint:disable-next-line:max-line-length\n    Editor.prototype.getNextParagraphForCharacterFormatting = function (block, start, end, property, value, update) {\n        var widgetCollection = block.getSplitWidgets();\n        block = widgetCollection[widgetCollection.length - 1];\n        block = this.viewer.selection.getNextRenderedBlock(block);\n        if (!isNullOrUndefined(block)) {\n            if (block instanceof ParagraphWidget) {\n                this.applyCharFormat(block, this.viewer.selection, start, end, property, value, update);\n            }\n            else {\n                this.applyCharFormatForTable(0, block, this.viewer.selection, start, end, property, value, update);\n            }\n        }\n    };\n    // tslint:disable-next-line:max-line-length\n    Editor.prototype.applyCharFormat = function (paragraph, selection, start, end, property, value, update) {\n        paragraph = paragraph.combineWidget(this.viewer);\n        var startOffset = 0;\n        var length = selection.getParagraphLength(paragraph);\n        var startLineWidget = paragraph.childWidgets.indexOf(start.currentWidget) !== -1 ?\n            paragraph.childWidgets.indexOf(start.currentWidget) : 0;\n        var endOffset = end.offset;\n        var endLineWidget = paragraph.childWidgets.indexOf(end.currentWidget) !== -1 ?\n            paragraph.childWidgets.indexOf(end.currentWidget) : paragraph.childWidgets.length - 1;\n        if (!isNullOrUndefined(selection)) {\n            if (paragraph === start.paragraph) {\n                startOffset = start.offset;\n            }\n        }\n        if (!paragraph.equals(end.paragraph)) {\n            this.applyCharFormatValue(paragraph.characterFormat, property, value, update);\n            endOffset = length;\n        }\n        else {\n            var lastLine = paragraph.childWidgets[paragraph.childWidgets.length - 1];\n            if (selection.isParagraphLastLine(lastLine) && end.currentWidget === lastLine\n                && ((endOffset === selection.getLineLength(lastLine) + 1) || (selection.isEmpty && selection.end.isAtParagraphEnd))) {\n                this.applyCharFormatValue(paragraph.characterFormat, property, value, update);\n            }\n        }\n        // let count: number = 0;\n        for (var i = startLineWidget; i <= endLineWidget; i++) {\n            var line = paragraph.childWidgets[i];\n            if (i !== startLineWidget) {\n                startOffset = selection.getStartLineOffset(line);\n            }\n            if (line === end.currentWidget) {\n                endOffset = end.offset;\n            }\n            else {\n                endOffset = selection.getLineLength(line);\n            }\n            var count = 0;\n            for (var j = 0; j < line.children.length; j++) {\n                var inlineObj = line.children[j];\n                if (inlineObj instanceof ListTextElementBox) {\n                    continue;\n                }\n                if (startOffset >= count + inlineObj.length) {\n                    count += inlineObj.length;\n                    continue;\n                }\n                var startIndex = 0;\n                if (startOffset > count) {\n                    startIndex = startOffset - count;\n                }\n                var endIndex = endOffset - count;\n                var inlineLength = inlineObj.length;\n                if (endIndex > inlineLength) {\n                    endIndex = inlineLength;\n                }\n                j += this.applyCharFormatInline(inlineObj, selection, startIndex, endIndex, property, value, update);\n                if (endOffset <= count + inlineLength) {\n                    break;\n                }\n                count += inlineLength;\n            }\n        }\n        var endParagraph = end.paragraph;\n        this.viewer.layout.reLayoutParagraph(paragraph, startLineWidget, 0);\n        if (paragraph.equals(endParagraph)) {\n            return;\n        }\n        this.getNextParagraphForCharacterFormatting(paragraph, start, end, property, value, update);\n    };\n    /**\n     * Toggles the bold property of selected contents.\n     */\n    Editor.prototype.toggleBold = function () {\n        if (this.viewer.owner.isReadOnlyMode) {\n            return;\n        }\n        var value = this.getCurrentSelectionValue('bold');\n        this.selection.characterFormat.bold = value;\n    };\n    /**\n     * Toggles the bold property of selected contents.\n     */\n    Editor.prototype.toggleItalic = function () {\n        if (this.viewer.owner.isReadOnlyMode) {\n            return;\n        }\n        var value = this.getCurrentSelectionValue('italic');\n        this.selection.characterFormat.italic = value;\n    };\n    Editor.prototype.getCurrentSelectionValue = function (property) {\n        var value = false;\n        if ((property === 'bold' || property === 'italic')) {\n            var index = 0;\n            var start = this.selection.start;\n            if (!this.selection.isForward) {\n                start = this.selection.end;\n            }\n            var lineWidget = start.currentWidget;\n            var inlineObj = lineWidget.getInline(start.offset, index);\n            var inline = inlineObj.element;\n            // inline.ownerBase\n            index = inlineObj.index;\n            var characterFormat = lineWidget.paragraph.characterFormat;\n            if (!isNullOrUndefined(inline)) {\n                if (!this.selection.isEmpty && index === inline.length) {\n                    characterFormat = isNullOrUndefined(inline.nextNode) ? lineWidget.paragraph.characterFormat\n                        : inline.nextNode.characterFormat;\n                }\n                else {\n                    characterFormat = inline.characterFormat;\n                }\n            }\n            if (property === 'bold') {\n                value = !(characterFormat.bold);\n            }\n            if (property === 'italic') {\n                value = !(characterFormat.italic);\n            }\n        }\n        return value;\n    };\n    /**\n     * Toggles the underline property of selected contents.\n     * @param underline Default value of â€˜underlineâ€™ parameter is Single.\n     */\n    Editor.prototype.toggleUnderline = function (underline) {\n        if (!this.owner.isReadOnlyMode) {\n            this.updateProperty(1, underline);\n        }\n    };\n    /**\n     * Toggles the strike through property of selected contents.\n     * @param {Strikethrough} strikethrough Default value of strikethrough parameter is SingleStrike.\n     */\n    Editor.prototype.toggleStrikethrough = function (strikethrough) {\n        if (!this.owner.isReadOnlyMode) {\n            var value = void 0;\n            if (isNullOrUndefined(strikethrough)) {\n                value = this.selection.characterFormat.strikethrough === 'SingleStrike' ? 'None' : 'SingleStrike';\n            }\n            else {\n                value = strikethrough;\n            }\n            this.selection.characterFormat.strikethrough = value;\n        }\n    };\n    Editor.prototype.updateFontSize = function (format, value) {\n        if (typeof (value) === 'number' && !(value < 0 && format.fontSize === 1)) {\n            return format.fontSize + value;\n        }\n        var fontsizeCollection = [8, 9, 10, 11, 12, 14, 16, 18, 20, 24, 26, 28, 36, 48, 72];\n        if (typeof (value) === 'string' && value === 'increment') {\n            if (format.fontSize < 8) {\n                return format.fontSize + 1;\n            }\n            else if (format.fontSize >= 72 && format.fontSize < 80) {\n                return 80;\n            }\n            else if (format.fontSize >= 80) {\n                return format.fontSize + 10;\n            }\n            else {\n                for (var i = 0; i < fontsizeCollection.length; i++) {\n                    if (format.fontSize < fontsizeCollection[i]) {\n                        return fontsizeCollection[i];\n                    }\n                }\n            }\n        }\n        else if (typeof (value) === 'string' && value === 'decrement' && format.fontSize > 1) {\n            if (format.fontSize <= 8) {\n                return format.fontSize - 1;\n            }\n            else if (format.fontSize > 72 && format.fontSize <= 80) {\n                return 72;\n            }\n            else if (format.fontSize > 80) {\n                return format.fontSize - 10;\n            }\n            else {\n                for (var i = 0; i < fontsizeCollection.length; i++) {\n                    if (format.fontSize <= fontsizeCollection[i]) {\n                        return fontsizeCollection[i - 1];\n                    }\n                }\n            }\n        }\n        return format.fontSize;\n    };\n    // Inline\n    // tslint:disable-next-line:max-line-length\n    Editor.prototype.applyCharFormatInline = function (inline, selection, startIndex, endIndex, property, value, update) {\n        if (startIndex === 0 && endIndex === inline.length) {\n            this.applyCharFormatValue(inline.characterFormat, property, value, update);\n            return 0;\n        }\n        else if (inline instanceof TextElementBox) {\n            return this.formatInline(inline, selection, startIndex, endIndex, property, value, update);\n        }\n        return 0;\n    };\n    // tslint:disable-next-line:max-line-length\n    Editor.prototype.formatInline = function (inline, selection, startIndex, endIndex, property, value, update) {\n        var x = 0;\n        var node = inline;\n        var index = inline.line.children.indexOf(node);\n        var paragraph = inline.paragraph;\n        var lineIndex = paragraph.childWidgets.indexOf(inline.line);\n        var textElement;\n        if (startIndex > 0) {\n            textElement = new TextElementBox();\n            textElement.characterFormat.copyFormat(inline.characterFormat);\n            textElement.line = inline.line;\n            textElement.text = inline.text.substr(startIndex, endIndex - startIndex);\n            this.applyCharFormatValue(textElement.characterFormat, property, value, update);\n            index++;\n            node.line.children.splice(index, 0, textElement);\n            x++;\n            // this.addToLinkedFields(span);                      \n        }\n        if (endIndex < node.length) {\n            textElement = new TextElementBox();\n            textElement.characterFormat.copyFormat(inline.characterFormat);\n            textElement.text = node.text.substring(endIndex);\n            textElement.line = inline.line;\n            index++;\n            node.line.children.splice(index, 0, textElement);\n            x++;\n            // this.addToLinkedFields(span);                       \n        }\n        if (startIndex === 0) {\n            inline.text = inline.text.substr(0, endIndex);\n            this.applyCharFormatValue(inline.characterFormat, property, value, update);\n        }\n        else {\n            inline.text = inline.text.substr(0, startIndex);\n        }\n        return x;\n    };\n    // Cell\n    // tslint:disable-next-line:max-line-length\n    Editor.prototype.applyCharFormatCell = function (cell, selection, start, end, property, value, update) {\n        if (end.paragraph.isInsideTable) {\n            var containerCell = selection.getContainerCellOf(cell, end.paragraph.associatedCell);\n            if (containerCell.ownerTable.contains(end.paragraph.associatedCell)) {\n                var startCell = selection.getSelectedCell(cell, containerCell);\n                var endCell = selection.getSelectedCell(end.paragraph.associatedCell, containerCell);\n                if (selection.containsCell(containerCell, end.paragraph.associatedCell)) {\n                    //Selection end is in container cell.\n                    if (selection.isCellSelected(containerCell, start, end)) {\n                        value = this.getCharacterFormatValueOfCell(cell, selection, value, property);\n                        this.applyCharFormatForSelectedCell(containerCell, selection, property, value, update);\n                    }\n                    else {\n                        if (startCell === containerCell) {\n                            this.applyCharFormat(start.paragraph, selection, start, end, property, value, update);\n                        }\n                        else {\n                            this.applyCharFormatRow(startCell.ownerRow, selection, start, end, property, value, update);\n                        }\n                    }\n                }\n                else {\n                    this.applyCharFormatForTableCell(containerCell.ownerTable, selection, containerCell, endCell, property, value, update);\n                }\n            }\n            else {\n                this.applyCharFormatRow(containerCell.ownerRow, selection, start, end, property, value, update);\n            }\n        }\n        else {\n            var tableCell = selection.getContainerCell(cell);\n            this.applyCharFormatRow(tableCell.ownerRow, selection, start, end, property, value, update);\n        }\n    };\n    // tslint:disable-next-line:max-line-length\n    Editor.prototype.applyCharFormatForSelectedCell = function (cell, selection, property, value, update) {\n        for (var i = 0; i < cell.childWidgets.length; i++) {\n            var block = cell.childWidgets[i];\n            if (block instanceof ParagraphWidget) {\n                this.applyCharFormatForSelectedPara(block, selection, property, value, update);\n            }\n            else {\n                this.applyCharFormatForSelTable(block, selection, property, value, update);\n            }\n        }\n    };\n    // Row\n    // tslint:disable-next-line:max-line-length\n    Editor.prototype.applyCharFormatRow = function (row, selection, start, end, property, value, update) {\n        value = this.getCharacterFormatValueOfCell(row.childWidgets[0], selection, value, property);\n        this.applyCharFormatForTable(row.rowIndex, row.ownerTable, selection, start, end, property, value, update);\n    };\n    // Table\n    // tslint:disable-next-line:max-line-length\n    Editor.prototype.applyCharFormatForTable = function (index, table, selection, start, end, property, value, update) {\n        table = table.combineWidget(this.viewer);\n        for (var i = index; i < table.childWidgets.length; i++) {\n            var row = table.childWidgets[i];\n            for (var j = 0; j < row.childWidgets.length; j++) {\n                this.applyCharFormatForSelectedCell(row.childWidgets[j], selection, property, value, update);\n            }\n            if (end.paragraph.isInsideTable && selection.containsRow(row, end.paragraph.associatedCell)) {\n                this.viewer.layout.layoutBodyWidgetCollection(table.index, table.containerWidget, table, false);\n                return;\n            }\n        }\n        this.viewer.layout.layoutBodyWidgetCollection(table.index, table.containerWidget, table, false);\n        this.getNextParagraphForCharacterFormatting(table, start, end, property, value, update);\n    };\n    // tslint:disable-next-line:max-line-length\n    Editor.prototype.applyCharFormatForSelTable = function (tableWidget, selection, property, value, update) {\n        for (var i = 0; i < tableWidget.childWidgets.length; i++) {\n            var row = tableWidget.childWidgets[i];\n            for (var j = 0; j < row.childWidgets.length; j++) {\n                this.applyCharFormatForSelectedCell(row.childWidgets[j], selection, property, value, update);\n            }\n        }\n    };\n    // tslint:disable-next-line:max-line-length\n    Editor.prototype.applyCharFormatForTableCell = function (table, selection, startCell, endCell, property, value, update) {\n        var startCellLeft = selection.getCellLeft(startCell.ownerRow, startCell);\n        var startCellRight = startCellLeft + startCell.cellFormat.cellWidth;\n        var endCellLeft = selection.getCellLeft(endCell.ownerRow, endCell);\n        var endCellRight = endCellLeft + endCell.cellFormat.cellWidth;\n        var cellInfo = this.updateSelectedCellsInTable(startCellLeft, startCellRight, endCellLeft, endCellRight);\n        startCellLeft = cellInfo.start;\n        startCellRight = cellInfo.end;\n        var count = table.childWidgets.indexOf(endCell.ownerRow);\n        var isStarted = false;\n        for (var i = table.childWidgets.indexOf(startCell.ownerRow); i <= count; i++) {\n            var row = table.childWidgets[i];\n            for (var j = 0; j < row.childWidgets.length; j++) {\n                var left = selection.getCellLeft(row, row.childWidgets[j]);\n                if (HelperMethods.round(startCellLeft, 2) <= HelperMethods.round(left, 2) &&\n                    HelperMethods.round(left, 2) < HelperMethods.round(startCellRight, 2)) {\n                    if (!isStarted) {\n                        value = this.getCharacterFormatValueOfCell(row.childWidgets[j], selection, value, property);\n                        isStarted = true;\n                    }\n                    this.applyCharFormatForSelectedCell(row.childWidgets[j], selection, property, value, update);\n                }\n            }\n        }\n    };\n    Editor.prototype.updateSelectedCellsInTable = function (start, end, endCellLeft, endCellRight) {\n        var selection = this.viewer.selection;\n        if (start > endCellLeft) {\n            start = endCellLeft;\n        }\n        if (end < endCellRight) {\n            end = endCellRight;\n        }\n        if (start > selection.upDownSelectionLength) {\n            start = selection.upDownSelectionLength;\n        }\n        if (end < selection.upDownSelectionLength) {\n            end = selection.upDownSelectionLength;\n        }\n        return { start: start, end: end };\n    };\n    Editor.prototype.getCharacterFormatValueOfCell = function (cell, selection, value, property) {\n        if (typeof (value) === 'boolean' || (value === undefined && (property === 'bold' || property === 'italic'))) {\n            var firstParagraph = selection.getFirstParagraph(cell);\n            var format = firstParagraph.characterFormat;\n            if (firstParagraph.childWidgets.length > 0 && firstParagraph.childWidgets[0].children.length > 0) {\n                format = firstParagraph.childWidgets[0].children[0].characterFormat;\n            }\n            value = !format.getPropertyValue(property);\n        }\n        return value;\n    };\n    /**\n     * Apply Character format for selection\n     * @private\n     */\n    Editor.prototype.applyCharFormatValueInternal = function (selection, format, property, value) {\n        this.applyCharFormatValue(format, property, value, false);\n    };\n    Editor.prototype.copyInlineCharacterFormat = function (sourceFormat, destFormat) {\n        destFormat.uniqueCharacterFormat = sourceFormat.uniqueCharacterFormat;\n        destFormat.baseCharStyle = sourceFormat.baseCharStyle;\n    };\n    Editor.prototype.applyCharFormatValue = function (format, property, value, update) {\n        if (update && property === 'fontSize') {\n            value = this.updateFontSize(format, value);\n        }\n        if (this.editorHistory && !isNullOrUndefined(this.editorHistory.currentBaseHistoryInfo)) {\n            value = this.editorHistory.currentBaseHistoryInfo.addModifiedProperties(format, property, value);\n        }\n        if (value instanceof WCharacterFormat) {\n            if (this.editorHistory && (this.editorHistory.isUndoing || this.editorHistory.isRedoing)) {\n                this.copyInlineCharacterFormat(value, format);\n            }\n            else {\n                format.copyFormat(value);\n            }\n            return;\n        }\n        if (isNullOrUndefined(value)) {\n            format.clearFormat();\n            return;\n        }\n        if (property === 'bold') {\n            format.bold = value;\n        }\n        else if (property === 'italic') {\n            format.italic = value;\n        }\n        else if (property === 'fontColor') {\n            format.fontColor = value;\n        }\n        else if (property === 'fontFamily') {\n            format.fontFamily = value;\n        }\n        else if (property === 'fontSize') {\n            format.fontSize = value;\n        }\n        else if (property === 'highlightColor') {\n            format.highlightColor = value;\n        }\n        else if (property === 'baselineAlignment') {\n            format.baselineAlignment = value;\n        }\n        else if (property === 'strikethrough') {\n            format.strikethrough = value;\n        }\n        else if (property === 'underline') {\n            format.underline = value;\n        }\n        else if (property === 'styleName') {\n            format.baseCharStyle = value;\n        }\n    };\n    /**\n     * @private\n     */\n    Editor.prototype.onImageFormat = function (elementBox, width, height) {\n        var modifiedFormat = new ImageFormat(elementBox);\n        if (this.editorHistory) {\n            this.editorHistory.initializeHistory('ImageResizing');\n            this.editorHistory.currentBaseHistoryInfo.modifiedProperties.push(modifiedFormat);\n        }\n        this.setOffsetValue(this.selection);\n        elementBox.width = width;\n        elementBox.height = height;\n        // tslint:disable-next-line:max-line-length\n        this.viewer.layout.reLayoutParagraph(elementBox.line.paragraph, elementBox.line.indexInOwner, 0);\n        this.reLayout(this.selection, false);\n        if (this.viewer.owner.imageResizerModule) {\n            this.viewer.owner.imageResizerModule.positionImageResizer(elementBox);\n        }\n    };\n    /**\n     * Toggles the text alignment of selected paragraphs.\n     * @param  {TextAlignment} textAlignment\n     */\n    Editor.prototype.toggleTextAlignment = function (textAlignment) {\n        if (this.viewer.owner.isReadOnlyMode || !this.viewer.owner.isDocumentLoaded) {\n            return;\n        }\n        // Toggle performed based on current selection format similar to MS word behavior.\n        // tslint:disable-next-line:max-line-length\n        if (!isNullOrUndefined(this.viewer.selection.paragraphFormat.textAlignment) && this.viewer.selection.paragraphFormat.textAlignment === textAlignment) {\n            if (textAlignment === 'Left') {\n                this.onApplyParagraphFormat('textAlignment', 'Justify', false, true);\n            }\n            else {\n                this.onApplyParagraphFormat('textAlignment', 'Left', false, true);\n            }\n        }\n        else {\n            this.onApplyParagraphFormat('textAlignment', textAlignment, false, true);\n        }\n    };\n    /**\n     * Applies paragraph format for the selection ranges.\n     * @param {string} property\n     * @param {Object} value\n     * @param {boolean} update\n     * @param {boolean} isSelectionChanged\n     * @private\n     */\n    Editor.prototype.onApplyParagraphFormat = function (property, value, update, isSelectionChanged) {\n        var action = (property[0].toUpperCase() + property.slice(1));\n        this.viewer.owner.isShiftingEnabled = true;\n        var selection = this.viewer.selection;\n        this.initHistory(action);\n        if (this.viewer.owner.isReadOnlyMode || !this.viewer.owner.isDocumentLoaded) {\n            return;\n        }\n        if (property === 'leftIndent') {\n            if (selection.paragraphFormat.listId !== -1 && update) {\n                this.updateListLevel(value > 0);\n                return;\n            }\n        }\n        if (selection.isEmpty) {\n            this.setOffsetValue(selection);\n            if (update && property === 'leftIndent') {\n                value = this.getIndentIncrementValue(selection.start.paragraph, value);\n            }\n            var para = selection.start.paragraph.combineWidget(this.viewer);\n            this.applyParaFormatProperty(para, property, value, update);\n            this.layoutItemBlock(para, false);\n        }\n        else {\n            //Iterate and update formatting's.      \n            this.setOffsetValue(selection);\n            this.updateSelectionParagraphFormatting(property, value, update);\n        }\n        this.reLayout(selection);\n    };\n    /**\n     * Update the list level\n     * @param  {boolean} increaseLevel\n     * @private\n     */\n    Editor.prototype.updateListLevel = function (increaseLevel) {\n        // Increment or Decrement list level for Multilevel lists.\n        var viewer = this.viewer;\n        var listFormat = this.viewer.selection.start.paragraph.paragraphFormat.listFormat;\n        var paragraphFormat = this.viewer.selection.start.paragraph.paragraphFormat;\n        var list = viewer.getListById(paragraphFormat.listFormat.listId);\n        var listLevel = viewer.layout.getListLevel(list, paragraphFormat.listFormat.listLevelNumber);\n        var levelNumber;\n        if (increaseLevel) {\n            levelNumber = paragraphFormat.listFormat.listLevelNumber + 1;\n        }\n        else {\n            levelNumber = paragraphFormat.listFormat.listLevelNumber - 1;\n        }\n        var nextListLevel = viewer.layout.getListLevel(list, levelNumber);\n        if (!isNullOrUndefined(nextListLevel)) {\n            this.onApplyListInternal(list, levelNumber);\n            viewer.selection.start.updatePhysicalPosition(true);\n            viewer.selection.end.updatePhysicalPosition(true);\n            viewer.selection.updateCaretPosition();\n        }\n    };\n    /**\n     * Applies list\n     * @param  {WList} list\n     * @param  {number} listLevelNumber\n     * @private\n     */\n    Editor.prototype.onApplyListInternal = function (list, listLevelNumber) {\n        var selection = this.viewer.selection;\n        var listFormat = new WListFormat();\n        if (!isNullOrUndefined(list) && listLevelNumber >= 0 && listLevelNumber < 9) {\n            listFormat.listId = list.listId;\n            listFormat.listLevelNumber = listLevelNumber;\n        }\n        this.onApplyParagraphFormat('listFormat', listFormat, false, false);\n    };\n    /**\n     * Apply paragraph format to selection range\n     * @private\n     */\n    Editor.prototype.updateSelectionParagraphFormatting = function (property, value, update) {\n        var selection = this.viewer.selection;\n        if (property === 'leftIndent' && update) {\n            if (!isNullOrUndefined(selection.start) && selection.start.isExistBefore(selection.end)) {\n                value = this.getIndentIncrementValue(selection.start.paragraph, value);\n            }\n            else {\n                value = this.getIndentIncrementValue(selection.end.paragraph, value);\n            }\n        }\n        this.updateParagraphFormatInternal(property, value, update);\n    };\n    Editor.prototype.getIndentIncrementValue = function (currentParagraph, incrementFactor) {\n        var currentParagraphIndent = currentParagraph.paragraphFormat.leftIndent;\n        if (currentParagraphIndent < 0) {\n            // In MS Word, if the current paragraph left indent is lesser that or equal to 0\n            // then performing decrement indent will set left indent to 0. \n            if (incrementFactor < 0 || currentParagraphIndent + incrementFactor >= 0) {\n                return -currentParagraphIndent;\n            }\n            else {\n                var incrementValue = -this.getIndentIncrementValueInternal(-currentParagraphIndent, -incrementFactor);\n                return incrementValue % incrementFactor === 0 ? incrementValue : incrementValue + incrementFactor;\n            }\n        }\n        else {\n            return this.getIndentIncrementValueInternal(currentParagraphIndent, incrementFactor);\n        }\n    };\n    Editor.prototype.getIndentIncrementValueInternal = function (position, incrementFactor) {\n        var tabValue = Math.abs(incrementFactor);\n        if (position === 0 || tabValue === 0) {\n            return incrementFactor > 0 ? tabValue : 0;\n        }\n        else {\n            var diff = ((Math.round(position) * 100) % (Math.round(tabValue) * 100)) / 100;\n            var cnt = (Math.round(position) - diff) / Math.round(tabValue);\n            var fPosition = cnt * tabValue;\n            if (incrementFactor > 0) {\n                fPosition += tabValue;\n            }\n            return (fPosition - position) === 0 ? incrementFactor : fPosition - position;\n        }\n    };\n    Editor.prototype.updateParagraphFormatInternal = function (property, value, update) {\n        if (isNullOrUndefined(property)) {\n            property = 'ParagraphFormat';\n        }\n        switch (property) {\n            case 'afterSpacing':\n                this.updateParagraphFormat('afterSpacing', value, false);\n                break;\n            case 'beforeSpacing':\n                this.updateParagraphFormat('beforeSpacing', value, false);\n                break;\n            case 'rightIndent':\n                this.updateParagraphFormat('rightIndent', value, false);\n                break;\n            case 'leftIndent':\n                this.updateParagraphFormat('leftIndent', value, update);\n                break;\n            case 'firstLineIndent':\n                this.updateParagraphFormat('firstLineIndent', value, false);\n                break;\n            case 'lineSpacing':\n                this.updateParagraphFormat('lineSpacing', value, false);\n                break;\n            case 'lineSpacingType':\n                this.updateParagraphFormat('lineSpacingType', value, false);\n                break;\n            case 'textAlignment':\n                this.updateParagraphFormat('textAlignment', value, false);\n                break;\n            case 'listFormat':\n                this.updateParagraphFormat('listFormat', value, false);\n                break;\n            case 'ParagraphFormat':\n                this.updateParagraphFormat(undefined, value, false);\n                break;\n            case 'styleName':\n                this.updateParagraphFormat('styleName', value, false);\n                break;\n            case 'ClearParagraphFormat':\n                // this.initializeHistory('ClearParagraphFormat', selectionRange);\n                this.updateParagraphFormat(undefined, value, false);\n                break;\n        }\n    };\n    /**\n     * Update paragraph format on undo\n     * @param  {SelectionRange} selectionRange\n     * @param  {string} property\n     * @param  {Object} value\n     * @param  {boolean} update\n     * @private\n     */\n    Editor.prototype.updateParagraphFormat = function (property, value, update) {\n        var selection = this.viewer.selection;\n        var startPosition = selection.start;\n        var endPosition = selection.end;\n        if (!selection.isForward) {\n            startPosition = selection.end;\n            endPosition = selection.start;\n        }\n        // this.updateInsertPosition(selection, startPosition);\n        this.applyParaFormatSelectedContent(startPosition, endPosition, property, value, update);\n        // this.startSelectionReLayouting(startPosition.paragraph, selection, startPosition, endPosition);\n    };\n    Editor.prototype.applyParaFormatSelectedContent = function (start, end, property, value, update) {\n        var selection = this.viewer.selection;\n        if (start.paragraph.isInsideTable && (!end.paragraph.isInsideTable\n            || start.paragraph.associatedCell !== end.paragraph.associatedCell\n            || selection.isCellSelected(start.paragraph.associatedCell, start, end))) {\n            var cell = void 0;\n            start.paragraph.associatedCell.ownerTable.combineWidget(this.viewer);\n            if (this.checkInsertPosition(selection)) {\n                this.updateHistoryPosition(start, true);\n            }\n            cell = start.paragraph.associatedCell;\n            this.applyParaFormatInCell(cell, start, end, property, value, update);\n            var table = cell.ownerTable;\n            this.viewer.layout.layoutBodyWidgetCollection(table.index, table.containerWidget, table, false);\n        }\n        else {\n            // tslint:disable-next-line:max-line-length\n            if (!isNullOrUndefined(value) && !this.selection.isEmpty && property === 'styleName' && this.applyCharacterStyle(start.paragraph, start, end, property, value, update)) {\n                return;\n            }\n            else {\n                this.applyParaFormat(start.paragraph, start, end, property, value, update);\n            }\n        }\n    };\n    /**\n     * Apply Paragraph format\n     * @private\n     */\n    Editor.prototype.applyParaFormatProperty = function (paragraph, property, value, update) {\n        var format = paragraph.paragraphFormat;\n        if (update && property === 'leftIndent') {\n            value = format.leftIndent + value;\n        }\n        if (property === 'listFormat' && value instanceof WListFormat) {\n            var listFormat = value;\n            if (!listFormat.hasValue('listLevelNumber')) {\n                listFormat.listLevelNumber = format.listFormat.listLevelNumber;\n            }\n        }\n        if (this.editorHistory && !isNullOrUndefined(this.editorHistory.currentBaseHistoryInfo)) {\n            value = this.editorHistory.currentBaseHistoryInfo.addModifiedPropertiesForParagraphFormat(format, property, value);\n        }\n        if (value instanceof WParagraphFormat) {\n            if (isNullOrUndefined(property)) {\n                if (this.editorHistory && (this.editorHistory.isUndoing || this.editorHistory.isRedoing)) {\n                    this.copyParagraphFormat(value, format);\n                }\n                else {\n                    format.copyFormat(value);\n                }\n            }\n            else if (property === 'listFormat') {\n                format.listFormat = value.listFormat;\n                // this.handleListFormat(format, value as WParagraphFormat);\n            }\n        }\n        if (isNullOrUndefined(value)) {\n            format.clearFormat();\n            this.viewer.layout.reLayoutParagraph(format.ownerBase, 0, 0);\n            return;\n        }\n        if (property === 'afterSpacing') {\n            format.afterSpacing = value;\n        }\n        else if (property === 'beforeSpacing') {\n            format.beforeSpacing = value;\n        }\n        else if (property === 'leftIndent') {\n            format.leftIndent = value;\n        }\n        else if (property === 'lineSpacingType') {\n            format.lineSpacingType = value;\n        }\n        else if (property === 'lineSpacing') {\n            format.lineSpacing = value;\n        }\n        else if (property === 'rightIndent') {\n            format.rightIndent = value;\n        }\n        else if (property === 'firstLineIndent') {\n            format.firstLineIndent = value;\n        }\n        else if (property === 'textAlignment') {\n            format.textAlignment = value;\n            this.viewer.layout.allowLayout = false;\n        }\n        else if (property === 'styleName') {\n            if (typeof (value) === 'string') {\n                value = this.viewer.styles.findByName(value);\n            }\n            format.ApplyStyle(value);\n        }\n        else if (property === 'listFormat') {\n            if (value instanceof WParagraphFormat) {\n                this.copyFromListLevelParagraphFormat(format, value);\n                value = value.listFormat;\n            }\n            format.listFormat.copyFormat(value);\n            this.viewer.layout.clearListElementBox(format.ownerBase);\n            this.onListFormatChange(format.ownerBase, value, format);\n            this.layoutItemBlock(format.ownerBase, false);\n            return;\n        }\n    };\n    Editor.prototype.copyParagraphFormat = function (sourceFormat, destFormat) {\n        destFormat.uniqueParagraphFormat = sourceFormat.uniqueParagraphFormat;\n        destFormat.listFormat = sourceFormat.listFormat;\n        destFormat.baseStyle = sourceFormat.baseStyle;\n    };\n    Editor.prototype.onListFormatChange = function (paragraph, listFormat, paraFormat) {\n        if (listFormat instanceof WListFormat) {\n            var currentFormat = listFormat;\n            // currentFormat.setOwnerBase(paraFormat);\n            this.updateListParagraphFormat(paragraph, listFormat);\n        }\n    };\n    Editor.prototype.updateListParagraphFormat = function (paragraph, listFormat) {\n        var list = this.viewer.getListById(listFormat.listId);\n        var listlevel = undefined;\n        if (!isNullOrUndefined(list)) {\n            listlevel = this.viewer.layout.getListLevel(list, listFormat.listLevelNumber);\n        }\n        var isUpdateIndent = !this.editorHistory || (this.editorHistory && !this.editorHistory.isUndoing);\n        if (isUpdateIndent) {\n            if (paragraph instanceof ParagraphWidget && !isNullOrUndefined(listlevel)\n                && !isNullOrUndefined(listlevel.paragraphFormat) && !isNullOrUndefined(paragraph.containerWidget)) {\n                this.copyFromListLevelParagraphFormat(paragraph.paragraphFormat, listlevel.paragraphFormat);\n            }\n            else if (isNullOrUndefined(list)) {\n                paragraph.paragraphFormat.leftIndent = undefined;\n                paragraph.paragraphFormat.firstLineIndent = undefined;\n            }\n        }\n    };\n    /**\n     * Copies list level paragraph format\n     * @param  {WParagraphFormat} oldFormat\n     * @param  {WParagraphFormat} newFormat\n     * @private\n     */\n    Editor.prototype.copyFromListLevelParagraphFormat = function (oldFormat, newFormat) {\n        if (!isNullOrUndefined(newFormat.leftIndent)) {\n            oldFormat.leftIndent = newFormat.leftIndent;\n        }\n        if (!isNullOrUndefined(newFormat.firstLineIndent)) {\n            oldFormat.firstLineIndent = newFormat.firstLineIndent;\n        }\n    };\n    /**\n     * @private\n     */\n    Editor.prototype.applyContinueNumbering = function (selection) {\n        this.editorHistory.initializeHistory('ContinueNumbering');\n        this.applyContinueNumberingInternal(selection);\n    };\n    /**\n     * @private\n     */\n    Editor.prototype.applyContinueNumberingInternal = function (selection) {\n        var paragraph = selection.start.paragraph;\n        var numberingInfo = this.getContinueNumberingInfo(paragraph);\n        var paraFormat = this.getParagraphFormat(paragraph, numberingInfo.listLevelNumber, numberingInfo.listPattern);\n        this.changeListId(numberingInfo.currentList, paragraph, paraFormat, numberingInfo.listLevelNumber, numberingInfo.listPattern);\n        this.reLayout(selection, false);\n        if (this.editorHistory && !isNullOrUndefined(this.editorHistory.currentBaseHistoryInfo)) {\n            this.editorHistory.updateHistory();\n        }\n        this.viewer.updateFocus();\n    };\n    /**\n     * @private\n     */\n    Editor.prototype.getContinueNumberingInfo = function (paragraph) {\n        var currentList = undefined;\n        var listLevelNumber = 0;\n        var listPattern = 'None';\n        if (!isNullOrUndefined(paragraph.paragraphFormat)\n            && !isNullOrUndefined(paragraph.paragraphFormat.listFormat)) {\n            currentList = this.viewer.getListById(paragraph.paragraphFormat.listFormat.listId);\n            listLevelNumber = paragraph.paragraphFormat.listFormat.listLevelNumber;\n        }\n        var viewer = this.viewer;\n        if (listLevelNumber !== 0 && !isNullOrUndefined(currentList) &&\n            !isNullOrUndefined(viewer.getAbstractListById(currentList.abstractListId))\n            && !isNullOrUndefined(viewer.getAbstractListById(currentList.abstractListId).levels[listLevelNumber])) {\n            var listLevel = this.viewer.layout.getListLevel(currentList, listLevelNumber);\n            if (!isNullOrUndefined(listLevel)) {\n                listPattern = listLevel.listLevelPattern;\n            }\n        }\n        return {\n            currentList: currentList,\n            listLevelNumber: listLevelNumber,\n            listPattern: listPattern\n        };\n    };\n    /**\n     * @private\n     */\n    Editor.prototype.revertContinueNumbering = function (selection, format) {\n        var paragraph = selection.start.paragraph;\n        var numberingInfo = this.getContinueNumberingInfo(paragraph);\n        this.changeListId(numberingInfo.currentList, paragraph, format, numberingInfo.listLevelNumber, numberingInfo.listPattern);\n        this.reLayout(selection, false);\n        if (!isNullOrUndefined(this.editorHistory.currentBaseHistoryInfo)) {\n            this.editorHistory.updateHistory();\n        }\n    };\n    Editor.prototype.changeListId = function (list, block, format, levelNum, listType) {\n        if (isNullOrUndefined(block)) {\n            return;\n        }\n        if (block instanceof ParagraphWidget) {\n            if (list.listId === block.paragraphFormat.listFormat.listId\n                && levelNum === block.paragraphFormat.listFormat.listLevelNumber) {\n                var baseHistoryInfo = this.editorHistory.currentBaseHistoryInfo;\n                if (!isNullOrUndefined(baseHistoryInfo)) {\n                    format = baseHistoryInfo.addModifiedPropertiesForContinueNumbering(block.paragraphFormat, format);\n                }\n                block.paragraphFormat.copyFormat(format);\n                this.viewer.layout.reLayoutParagraph(block, 0, 0);\n            }\n        }\n        return this.changeListId(list, block.nextRenderedWidget, format, levelNum, listType);\n    };\n    Editor.prototype.getParagraphFormat = function (paragraph, levelNumber, listType) {\n        if (!isNullOrUndefined(paragraph.previousRenderedWidget)) {\n            if (paragraph.previousRenderedWidget instanceof ParagraphWidget) {\n                if (!isNullOrUndefined(paragraph.previousRenderedWidget.paragraphFormat.listFormat)\n                    && paragraph.previousRenderedWidget.paragraphFormat.listFormat.listId !== -1) {\n                    var listLevel = this.getListLevel(paragraph.previousRenderedWidget);\n                    if (levelNumber === 0) {\n                        return paragraph.previousRenderedWidget.paragraphFormat;\n                    }\n                    else if (listType === listLevel.listLevelPattern\n                        || this.checkNumberArabic(listType, listLevel.listLevelPattern)) {\n                        return paragraph.previousRenderedWidget.paragraphFormat;\n                    }\n                    else {\n                        return this.getParagraphFormat(paragraph.previousRenderedWidget, levelNumber, listType);\n                    }\n                }\n                else {\n                    return this.getParagraphFormat(paragraph.previousRenderedWidget, levelNumber, listType);\n                }\n            }\n        }\n        return undefined;\n    };\n    Editor.prototype.checkNumberArabic = function (listType, levelPattern) {\n        if ((listType === 'Number' && levelPattern === 'Arabic')\n            || (levelPattern === 'Number' && listType === 'Arabic')) {\n            return true;\n        }\n        return false;\n    };\n    /**\n     * @private\n     */\n    Editor.prototype.applyRestartNumbering = function (selection) {\n        this.editorHistory.initializeHistory('RestartNumbering');\n        this.restartListAt(selection);\n    };\n    /**\n     * @private\n     */\n    Editor.prototype.restartListAt = function (selection) {\n        var currentListLevel = this.getListLevel(selection.start.paragraph);\n        var list = new WList();\n        list.listId = this.viewer.lists[(this.viewer.lists.length - 1)].listId + 1;\n        var abstractList = new WAbstractList();\n        abstractList.abstractListId = this.viewer.abstractLists[(this.viewer.abstractLists.length - 1)].abstractListId + 1;\n        list.abstractListId = abstractList.abstractListId;\n        this.viewer.abstractLists.push(abstractList);\n        this.createListLevels(abstractList, currentListLevel, list);\n        this.viewer.lists.push(list);\n        this.restartListAtInternal(selection, list.listId);\n    };\n    /**\n     * @private\n     */\n    Editor.prototype.restartListAtInternal = function (selection, listId) {\n        var numberingInfo = this.getContinueNumberingInfo(selection.start.paragraph);\n        this.changeRestartNumbering(numberingInfo.currentList, selection.start.paragraph, listId);\n        this.reLayout(selection, false);\n        if (this.editorHistory && !isNullOrUndefined(this.editorHistory.currentBaseHistoryInfo)) {\n            this.editorHistory.updateHistory();\n        }\n        this.incrementListNumber = -1;\n        this.refListNumber = undefined;\n        this.viewer.updateFocus();\n    };\n    Editor.prototype.changeRestartNumbering = function (list, block, listId) {\n        if (isNullOrUndefined(block)) {\n            return;\n        }\n        if (block instanceof ParagraphWidget) {\n            if (list.listId === block.paragraphFormat.listFormat.listId) {\n                var baseHistoryInfo = this.editorHistory.currentBaseHistoryInfo;\n                if (!isNullOrUndefined(baseHistoryInfo)) {\n                    listId = baseHistoryInfo.addModifiedPropertiesForRestartNumbering(block.paragraphFormat.listFormat, listId);\n                }\n                block.paragraphFormat.listFormat.listId = listId;\n                if (this.refListNumber !== block.paragraphFormat.listFormat.listLevelNumber) {\n                    this.incrementListNumber += 1;\n                    this.refListNumber = block.paragraphFormat.listFormat.listLevelNumber;\n                }\n                block.paragraphFormat.listFormat.listLevelNumber = this.incrementListNumber;\n                this.viewer.layout.reLayoutParagraph(block, 0, 0);\n            }\n        }\n        return this.changeRestartNumbering(list, block.nextRenderedWidget, listId);\n    };\n    Editor.prototype.createListLevels = function (abstractList, currentListLevel, list) {\n        var levelPattern = currentListLevel.listLevelPattern;\n        var levelPatterns = [];\n        var currentAbstractList = currentListLevel.ownerBase;\n        for (var i = 0; i < 3; i++) {\n            var listLevel = currentAbstractList.levels[i];\n            if (!isNullOrUndefined(listLevel)) {\n                levelPatterns.push(listLevel.listLevelPattern);\n            }\n        }\n        var indexOfLevelPattern = levelPatterns.indexOf(levelPattern) === -1 ? 0 : levelPatterns.indexOf(levelPattern);\n        for (var i = 0; i < currentAbstractList.levels.length; i++) {\n            var listLevel = new WListLevel(abstractList);\n            if (i === 0) {\n                listLevel.listLevelPattern = levelPattern;\n            }\n            else {\n                if (indexOfLevelPattern === 0 || indexOfLevelPattern < levelPatterns.length - 1) {\n                    indexOfLevelPattern++;\n                }\n                else {\n                    indexOfLevelPattern = 0;\n                }\n                listLevel.listLevelPattern = levelPatterns[indexOfLevelPattern];\n            }\n            listLevel.numberFormat = '%' + (i + 1) + '.';\n            listLevel.startAt = 1;\n            listLevel.characterFormat.copyFormat(currentListLevel.characterFormat);\n            listLevel.paragraphFormat.copyFormat(currentListLevel.paragraphFormat);\n            listLevel.restartLevel = i;\n            abstractList.levels.push(listLevel);\n        }\n    };\n    // tslint:disable-next-line:max-line-length\n    Editor.prototype.applyParaFormat = function (paragraph, start, end, property, value, update) {\n        this.setOffsetValue(this.selection);\n        paragraph = paragraph.combineWidget(this.viewer);\n        //Apply Paragraph Format for spitted paragraph\n        this.applyParaFormatProperty(paragraph, property, value, update);\n        this.layoutItemBlock(paragraph, false);\n        this.getOffsetValue(this.selection);\n        if (paragraph.equals(end.paragraph)) {\n            return;\n        }\n        this.getNextParagraphForFormatting(paragraph, start, end, property, value, update);\n    };\n    /*Â tslint:disable-next-line:max-line-length */\n    Editor.prototype.applyCharacterStyle = function (paragraph, start, end, property, value, update) {\n        var paragraphWidget = paragraph.getSplitWidgets();\n        if ((end.paragraph === paragraph || paragraphWidget.indexOf(end.paragraph) !== -1)) {\n            if (((value.type === 'Paragraph') && ((value.link) instanceof WCharacterStyle)) || (value.type === 'Character')) {\n                var obj = (value.type === 'Character') ? value : value.link;\n                this.updateSelectionCharacterFormatting(property, obj, update);\n                return true;\n            }\n        }\n        return false;\n    };\n    // Cell\n    // tslint:disable-next-line:max-line-length\n    Editor.prototype.applyParaFormatInCell = function (cell, start, end, property, value, update) {\n        var selection = this.viewer.selection;\n        if (end.paragraph.isInsideTable) {\n            var cellContainer = selection.getContainerCellOf(cell, end.paragraph.associatedCell);\n            if (cellContainer.ownerTable.contains(end.paragraph.associatedCell)) {\n                var startCell = selection.getSelectedCell(cell, cellContainer);\n                var endCell = selection.getSelectedCell(end.paragraph.associatedCell, cellContainer);\n                if (selection.containsCell(cellContainer, end.paragraph.associatedCell)) {\n                    //Selection end is in container cell.\n                    if (selection.isCellSelected(cellContainer, start, end)) {\n                        value = this.getParaFormatValueInCell(cellContainer, property, value);\n                        this.applyParaFormatCellInternal(cellContainer, property, value, update);\n                    }\n                    else {\n                        if (startCell === cellContainer) {\n                            this.applyParaFormat(start.paragraph, start, end, property, value, update);\n                        }\n                        else {\n                            this.applyParagraphFormatRow(startCell.ownerRow, start, end, property, value, update);\n                        }\n                    }\n                }\n                else {\n                    //Format other selected cells in current table.\n                    this.applyParaFormatTableCell(cellContainer.ownerTable, cellContainer, endCell, property, value, update);\n                }\n            }\n            else {\n                this.applyParagraphFormatRow(cellContainer.ownerRow, start, end, property, value, update);\n            }\n        }\n        else {\n            var wCell = selection.getContainerCell(cell);\n            this.applyParagraphFormatRow(wCell.ownerRow, start, end, property, value, update);\n        }\n    };\n    Editor.prototype.applyParaFormatCellInternal = function (cell, property, value, update) {\n        for (var i = 0; i < cell.childWidgets.length; i++) {\n            var block = cell.childWidgets[i];\n            if (block instanceof ParagraphWidget) {\n                this.applyParaFormatProperty(block, property, value, update);\n            }\n            else {\n                this.applyParagraphFormatTableInternal(block, property, value, update);\n            }\n        }\n    };\n    Editor.prototype.getParaFormatValueInCell = function (cell, property, value) {\n        if (typeof value === 'boolean') {\n            var firstPara = this.viewer.selection.getFirstParagraph(cell);\n            value = !firstPara.paragraphFormat.getPropertyValue(property);\n        }\n        return value;\n    };\n    // Row\n    // tslint:disable-next-line:max-line-length\n    Editor.prototype.applyParagraphFormatRow = function (wRow, start, end, property, value, update) {\n        value = this.getParaFormatValueInCell(wRow.childWidgets[0], property, value);\n        for (var i = wRow.rowIndex; i < wRow.ownerTable.childWidgets.length; i++) {\n            var row = wRow.ownerTable.childWidgets[i];\n            for (var j = 0; j < row.childWidgets.length; j++) {\n                this.applyParaFormatCellInternal(row.childWidgets[j], property, value, update);\n            }\n            if (end.paragraph.isInsideTable && this.viewer.selection.containsRow(row, end.paragraph.associatedCell)) {\n                return;\n            }\n        }\n        this.getNextParagraphForFormatting(wRow.ownerTable, start, end, property, value, update);\n    };\n    // Table\n    // tslint:disable-next-line:max-line-length\n    Editor.prototype.applyParaFormatTableCell = function (table, startCell, endCell, property, value, update) {\n        var selection = this.viewer.selection;\n        var startValue = selection.getCellLeft(startCell.ownerRow, startCell);\n        var endValue = startValue + startCell.cellFormat.cellWidth;\n        var endCellLeft = selection.getCellLeft(endCell.ownerRow, endCell);\n        var endCellRight = endCellLeft + endCell.cellFormat.cellWidth;\n        var cellInfo = this.updateSelectedCellsInTable(startValue, endValue, endCellLeft, endCellRight);\n        startValue = cellInfo.start;\n        endValue = cellInfo.end;\n        var count = table.childWidgets.indexOf(endCell.ownerRow);\n        var isStarted = false;\n        for (var m = table.childWidgets.indexOf(startCell.ownerRow); m <= count; m++) {\n            var row = table.childWidgets[m];\n            for (var j = 0; j < row.childWidgets.length; j++) {\n                var left = selection.getCellLeft(row, row.childWidgets[j]);\n                if (Math.round(startValue) <= Math.round(left) && Math.round(left) < Math.round(endValue)) {\n                    if (!isStarted) {\n                        value = this.getParaFormatValueInCell(row.childWidgets[j], property, value);\n                        isStarted = true;\n                    }\n                    this.applyParaFormatCellInternal(row.childWidgets[j], property, value, update);\n                }\n            }\n        }\n    };\n    // tslint:disable-next-line:max-line-length\n    Editor.prototype.applyParaFormatTable = function (table, start, end, property, value, update) {\n        table = table.combineWidget(this.viewer);\n        var selection = this.viewer.selection;\n        for (var m = 0; m < table.childWidgets.length; m++) {\n            var tableRow = table.childWidgets[m];\n            for (var k = 0; k < tableRow.childWidgets.length; k++) {\n                this.applyParaFormatCellInternal(tableRow.childWidgets[k], property, value, update);\n            }\n            if (end.paragraph.isInsideTable && selection.containsRow(tableRow, end.paragraph.associatedCell)) {\n                this.viewer.layout.layoutBodyWidgetCollection(table.index, table.containerWidget, table, false);\n                return;\n            }\n        }\n        this.viewer.layout.layoutBodyWidgetCollection(table.index, table.containerWidget, table, false);\n        this.getNextParagraphForFormatting(table, start, end, property, value, update);\n    };\n    // tslint:disable-next-line:max-line-length\n    Editor.prototype.getNextParagraphForFormatting = function (block, start, end, property, value, update) {\n        var widgetCollection = block.getSplitWidgets();\n        block = widgetCollection[widgetCollection.length - 1];\n        block = this.viewer.selection.getNextRenderedBlock(block);\n        if (!isNullOrUndefined(block)) {\n            if (block instanceof ParagraphWidget) {\n                this.applyParaFormat(block, start, end, property, value, update);\n            }\n            else {\n                this.applyParaFormatTable(block, start, end, property, value, update);\n            }\n        }\n    };\n    Editor.prototype.applyParagraphFormatTableInternal = function (table, property, value, update) {\n        for (var x = 0; x < table.childWidgets.length; x++) {\n            var row = table.childWidgets[x];\n            for (var y = 0; y < row.childWidgets.length; y++) {\n                this.applyParaFormatCellInternal(row.childWidgets[y], property, value, update);\n            }\n        }\n    };\n    //Paragraph Format apply implementation Ends\n    // Apply Selection Section Format Option Implementation Starts\n    /**\n     * Apply section format selection changes\n     * @param  {string} property\n     * @param  {Object} value\n     * @private\n     */\n    Editor.prototype.onApplySectionFormat = function (property, value) {\n        if (!isNullOrUndefined(property)) {\n            var action = (property[0].toUpperCase() + property.slice(1));\n            this.initHistory(action);\n        }\n        else {\n            this.initHistory('SectionFormat');\n        }\n        this.updateSectionFormat(property, value);\n    };\n    /**\n     * Update section format\n     * @param  {string} property\n     * @param  {Object} value\n     * @returns TextPosition\n     * @private\n     */\n    Editor.prototype.updateSectionFormat = function (property, value) {\n        var selection = this.viewer.selection;\n        selection.owner.isShiftingEnabled = true;\n        var startPosition = selection.start;\n        var endPosition = selection.end;\n        if (!selection.isForward) {\n            startPosition = selection.end;\n            endPosition = selection.start;\n        }\n        var startPageIndex;\n        var endPageIndex;\n        this.viewer.clearContent();\n        var startSectionIndex = startPosition.paragraph.containerWidget.index;\n        var endSectionIndex = endPosition.paragraph.containerWidget.index;\n        for (var i = 0; i < this.viewer.pages.length; i++) {\n            if (this.viewer.pages[i].bodyWidgets[0].index === startSectionIndex) {\n                startPageIndex = i;\n                break;\n            }\n        }\n        for (var i = startPageIndex; i < this.viewer.pages.length; i++) {\n            var bodyWidget = this.viewer.pages[i].bodyWidgets[0];\n            endPageIndex = i;\n            if ((bodyWidget.index === startSectionIndex)) {\n                continue;\n            }\n            else if ((bodyWidget.index >= startSectionIndex) && bodyWidget.index <= endSectionIndex) {\n                continue;\n            }\n            else {\n                endPageIndex = i - 1;\n                break;\n            }\n        }\n        // let startPageIndex: number = this.viewer.pages.indexOf((selection.start.paragraph.containerWidget as BodyWidget).page);\n        // let endPageIndex: number = this.viewer.pages.indexOf((selection.end.paragraph.containerWidget as BodyWidget).page);\n        var update = true;\n        var index = 0;\n        for (var i = startPageIndex; i <= endPageIndex; i++) {\n            if (index !== this.viewer.pages[i].bodyWidgets[0].index && !update) {\n                update = true;\n            }\n            this.applyPropertyValueForSection(this.viewer.pages[i].bodyWidgets[0].sectionFormat, property, value, update);\n            index = this.viewer.pages[i].bodyWidgets[0].index;\n            update = false;\n        }\n        this.layoutWholeDocument();\n        this.fireContentChange();\n    };\n    //Apply Selection Table Format option implementation starts\n    /**\n     * Apply table format property changes\n     * @param  {string} property\n     * @param  {Object} value\n     * @private\n     */\n    Editor.prototype.onApplyTableFormat = function (property, value) {\n        var action = this.getTableFormatAction(property);\n        this.viewer.owner.isShiftingEnabled = true;\n        var selection = this.viewer.selection;\n        var table = selection.start.paragraph.associatedCell.ownerTable;\n        table = table.combineWidget(this.viewer);\n        if (selection.isEmpty) {\n            this.initHistory(action);\n            this.applyTablePropertyValue(selection, property, value, table);\n        }\n        else {\n            this.updateSelectionTableFormat(this.selection, action, value);\n        }\n        table.calculateGrid();\n        this.selection.owner.isLayoutEnabled = true;\n        this.viewer.layout.reLayoutTable(table);\n        this.reLayout(selection, false);\n    };\n    Editor.prototype.getTableFormatAction = function (property) {\n        switch (property) {\n            case 'tableAlignment':\n                return 'TableAlignment';\n            case 'leftIndent':\n                return 'TableLeftIndent';\n            case 'leftMargin':\n                return 'DefaultCellLeftMargin';\n            case 'rightMargin':\n                return 'DefaultCellRightMargin';\n            case 'bottomMargin':\n                return 'DefaultCellBottomMargin';\n            case 'topMargin':\n                return 'DefaultCellTopMargin';\n            case 'preferredWidth':\n                return 'TablePreferredWidth';\n            case 'preferredWidthType':\n                return 'TablePreferredWidthType';\n            case 'shading':\n                return 'Shading';\n            default:\n                return 'DefaultCellSpacing';\n        }\n    };\n    // Apply Selection Row Format Option Implementation Starts\n    /**\n     * Apply table row format property changes\n     * @param  {string} property\n     * @param  {Object} value\n     * @private\n     */\n    Editor.prototype.onApplyTableRowFormat = function (property, value) {\n        var action = this.getRowAction(property);\n        this.viewer.owner.isShiftingEnabled = true;\n        var selection = this.viewer.selection;\n        if (selection.isEmpty) {\n            this.initHistory(action);\n            var table = selection.start.paragraph.associatedCell.ownerRow.ownerTable;\n            this.applyRowPropertyValue(selection, property, value, selection.start.paragraph.associatedCell.ownerRow);\n        }\n        else {\n            this.updateSelectionTableFormat(this.selection, action, value);\n        }\n        this.reLayout(selection, false);\n    };\n    Editor.prototype.getRowAction = function (property) {\n        switch (property) {\n            case 'height':\n                return 'RowHeight';\n            case 'heightType':\n                return 'RowHeightType';\n            case 'isHeader':\n                return 'RowHeader';\n            default:\n                return 'AllowBreakAcrossPages';\n        }\n    };\n    /**\n     * Apply table cell property changes\n     * @param  {string} property\n     * @param  {Object} value\n     * @private\n     */\n    Editor.prototype.onApplyTableCellFormat = function (property, value) {\n        var action = this.getTableCellAction(property);\n        this.viewer.owner.isShiftingEnabled = true;\n        var selection = this.viewer.selection;\n        var table = selection.start.paragraph.associatedCell.ownerTable;\n        table = table.combineWidget(this.viewer);\n        if (selection.isEmpty) {\n            this.initHistory(action);\n            this.applyCellPropertyValue(selection, property, value, selection.start.paragraph.associatedCell.cellFormat);\n            table.calculateGrid();\n            this.selection.owner.isLayoutEnabled = true;\n            this.viewer.layout.reLayoutTable(table);\n        }\n        else {\n            this.updateSelectionTableFormat(this.selection, action, value);\n        }\n        this.reLayout(selection, false);\n    };\n    Editor.prototype.getTableCellAction = function (property) {\n        switch (property) {\n            case 'verticalAlignment':\n                return 'CellContentVerticalAlignment';\n            case 'leftMargin':\n                return 'CellLeftMargin';\n            case 'rightMargin':\n                return 'CellRightMargin';\n            case 'bottomMargin':\n                return 'CellBottomMargin';\n            case 'topMargin':\n                return 'CellTopMargin';\n            case 'preferredWidth':\n                return 'CellPreferredWidth';\n            case 'shading':\n                return 'Shading';\n            default:\n                return 'CellPreferredWidthType';\n        }\n    };\n    Editor.prototype.applyPropertyValueForSection = function (sectionFormat, property, value, update) {\n        var selection = this.viewer.selection;\n        if (update && this.editorHistory && !isNullOrUndefined(this.editorHistory.currentBaseHistoryInfo)) {\n            value = this.editorHistory.currentBaseHistoryInfo.addModifiedPropertiesForSection(sectionFormat, property, value);\n        }\n        if (isNullOrUndefined(value)) {\n            return;\n        }\n        if (value instanceof WSectionFormat) {\n            if (isNullOrUndefined(property)) {\n                sectionFormat.copyFormat(value, this.editorHistory);\n            }\n            return;\n        }\n        if (property === 'pageHeight') {\n            sectionFormat.pageHeight = value;\n        }\n        else if (property === 'pageWidth') {\n            sectionFormat.pageWidth = value;\n        }\n        else if (property === 'leftMargin') {\n            sectionFormat.leftMargin = value;\n        }\n        else if (property === 'rightMargin') {\n            sectionFormat.rightMargin = value;\n        }\n        else if (property === 'topMargin') {\n            sectionFormat.topMargin = value;\n        }\n        else if (property === 'bottomMargin') {\n            sectionFormat.bottomMargin = value;\n        }\n        else if (property === 'differentFirstPage') {\n            sectionFormat.differentFirstPage = value;\n        }\n        else if (property === 'differentOddAndEvenPages') {\n            sectionFormat.differentOddAndEvenPages = value;\n        }\n        else if (property === 'headerDistance') {\n            sectionFormat.headerDistance = value;\n        }\n        else if (property === 'footerDistance') {\n            sectionFormat.footerDistance = value;\n        }\n    };\n    /**\n     * @private\n     */\n    Editor.prototype.layoutWholeDocument = function () {\n        var startPosition = this.viewer.selection.start;\n        var endPosition = this.viewer.selection.end;\n        if (startPosition.isExistAfter(endPosition)) {\n            startPosition = this.viewer.selection.end;\n            endPosition = this.viewer.selection.start;\n        }\n        var startInfo = this.getParagraphInfo(startPosition);\n        var endInfo = this.getParagraphInfo(startPosition);\n        var startIndex = this.getHierarchicalIndex(startInfo.paragraph, startInfo.offset.toString());\n        var endIndex = this.getHierarchicalIndex(endInfo.paragraph, endInfo.offset.toString());\n        this.viewer.renderedLists.clear();\n        // this.viewer.owner.isLayoutEnabled = true;\n        var sections = this.combineSection();\n        this.viewer.clearContent();\n        this.viewer.layout.layoutItems(sections);\n        this.viewer.owner.isShiftingEnabled = false;\n        this.setPositionForCurrentIndex(startPosition, startIndex);\n        this.setPositionForCurrentIndex(endPosition, endIndex);\n        this.viewer.selection.selectPosition(startPosition, endPosition);\n        this.reLayout(this.viewer.selection);\n    };\n    Editor.prototype.combineSection = function () {\n        var sections = [];\n        var nextSection = this.viewer.pages[0].bodyWidgets[0];\n        do {\n            nextSection = this.combineSectionChild(nextSection, sections);\n        } while (nextSection);\n        return sections;\n    };\n    Editor.prototype.combineSectionChild = function (bodyWidget, sections) {\n        var previousBodyWidget = bodyWidget;\n        var temp = new BodyWidget();\n        temp.sectionFormat = bodyWidget.sectionFormat;\n        temp.index = previousBodyWidget.index;\n        do {\n            previousBodyWidget = bodyWidget;\n            if (bodyWidget.lastChild) {\n                bodyWidget.lastChild.combineWidget(this.viewer);\n            }\n            bodyWidget = bodyWidget.nextRenderedWidget;\n            for (var j = 0; j < previousBodyWidget.childWidgets.length; j++) {\n                var block = previousBodyWidget.childWidgets[j];\n                if (block instanceof TableWidget) {\n                    this.viewer.layout.clearTableWidget(block, true, true);\n                }\n                else {\n                    block.x = 0;\n                    block.y = 0;\n                    block.width = 0;\n                    block.height = 0;\n                }\n                temp.childWidgets.push(block);\n                previousBodyWidget.childWidgets.splice(j, 1);\n                j--;\n                block.containerWidget = temp;\n            }\n            previousBodyWidget.page.destroy();\n            // this.viewer.pages.splice(previousBodyWidget.page.index, 1);\n        } while (bodyWidget && previousBodyWidget.equals(bodyWidget));\n        sections.push(temp);\n        return bodyWidget;\n    };\n    Editor.prototype.updateSelectionTableFormat = function (selection, action, value) {\n        switch (action) {\n            case 'TableAlignment':\n                this.editorHistory.initializeHistory('TableAlignment');\n                this.updateTableFormat(selection, 'tableAlignment', value);\n                break;\n            case 'TableLeftIndent':\n                this.editorHistory.initializeHistory('TableLeftIndent');\n                this.updateTableFormat(selection, 'leftIndent', value);\n                break;\n            case 'DefaultCellSpacing':\n                this.editorHistory.initializeHistory('DefaultCellSpacing');\n                this.updateTableFormat(selection, 'cellSpacing', value);\n                break;\n            case 'DefaultCellLeftMargin':\n                this.editorHistory.initializeHistory('DefaultCellLeftMargin');\n                this.updateTableFormat(selection, 'leftMargin', value);\n                break;\n            case 'DefaultCellRightMargin':\n                this.editorHistory.initializeHistory('DefaultCellRightMargin');\n                this.updateTableFormat(selection, 'rightMargin', value);\n                break;\n            case 'DefaultCellTopMargin':\n                this.editorHistory.initializeHistory('DefaultCellTopMargin');\n                this.updateTableFormat(selection, 'topMargin', value);\n                break;\n            case 'TablePreferredWidth':\n                this.editorHistory.initializeHistory('TablePreferredWidth');\n                this.updateTableFormat(selection, 'preferredWidth', value);\n                break;\n            case 'TablePreferredWidthType':\n                this.editorHistory.initializeHistory('TablePreferredWidthType');\n                this.updateTableFormat(selection, 'preferredWidthType', value);\n                break;\n            case 'DefaultCellBottomMargin':\n                this.editorHistory.initializeHistory('DefaultCellBottomMargin');\n                this.updateTableFormat(selection, 'bottomMargin', value);\n                break;\n            case 'CellContentVerticalAlignment':\n                this.editorHistory.initializeHistory('CellContentVerticalAlignment');\n                this.updateCellFormat(selection, 'verticalAlignment', value);\n                break;\n            case 'CellLeftMargin':\n                this.editorHistory.initializeHistory('CellLeftMargin');\n                this.updateCellFormat(selection, 'leftMargin', value);\n                break;\n            case 'CellRightMargin':\n                this.editorHistory.initializeHistory('CellRightMargin');\n                this.updateCellFormat(selection, 'rightMargin', value);\n                break;\n            case 'CellTopMargin':\n                this.editorHistory.initializeHistory('CellTopMargin');\n                this.updateCellFormat(selection, 'topMargin', value);\n                break;\n            case 'CellBottomMargin':\n                this.editorHistory.initializeHistory('CellBottomMargin');\n                this.updateCellFormat(selection, 'bottomMargin', value);\n                break;\n            case 'CellPreferredWidth':\n                this.editorHistory.initializeHistory('CellPreferredWidth');\n                this.updateCellFormat(selection, 'preferredWidth', value);\n                break;\n            case 'CellPreferredWidthType':\n                this.editorHistory.initializeHistory('CellPreferredWidthType');\n                this.updateCellFormat(selection, 'preferredWidthType', value);\n                break;\n            case 'Shading':\n                this.editorHistory.initializeHistory('Shading');\n                this.updateCellFormat(selection, 'shading', value);\n                break;\n            case 'RowHeight':\n                this.editorHistory.initializeHistory('RowHeight');\n                this.updateRowFormat(selection, 'height', value);\n                break;\n            case 'RowHeightType':\n                this.editorHistory.initializeHistory('RowHeightType');\n                this.updateRowFormat(selection, 'heightType', value);\n                break;\n            case 'RowHeader':\n                this.editorHistory.initializeHistory('RowHeader');\n                this.updateRowFormat(selection, 'isHeader', value);\n                break;\n            case 'AllowBreakAcrossPages':\n                this.editorHistory.initializeHistory('AllowBreakAcrossPages');\n                this.updateRowFormat(selection, 'allowBreakAcrossPages', value);\n                break;\n        }\n    };\n    // Update Table Properties\n    /**\n     * Update Table Format on undo\n     * @param  {Selection} selection\n     * @param  {SelectionRange} selectionRange\n     * @param  {string} property\n     * @param  {object} value\n     * @private\n     */\n    Editor.prototype.updateTableFormat = function (selection, property, value) {\n        var tableStartPosition = selection.start;\n        var tableEndPosition = selection.end;\n        if (!selection.isForward) {\n            tableStartPosition = selection.end;\n            tableEndPosition = selection.start;\n        }\n        this.initHistoryPosition(selection, tableStartPosition);\n        // tslint:disable-next-line:max-line-length\n        this.applyTablePropertyValue(selection, property, value, tableStartPosition.paragraph.associatedCell.ownerTable);\n    };\n    /**\n     * update cell format on undo\n     * @param  {Selection} selection\n     * @param  {SelectionRange} selectionRange\n     * @param  {string} property\n     * @param  {Object} value\n     * @private\n     */\n    Editor.prototype.updateCellFormat = function (selection, property, value) {\n        selection.owner.isShiftingEnabled = true;\n        var newStartPosition = selection.start;\n        var newEndPosition = selection.end;\n        if (!selection.isForward) {\n            newStartPosition = selection.end;\n            newEndPosition = selection.start;\n        }\n        this.initHistoryPosition(selection, newStartPosition);\n        this.updateFormatForCell(selection, property, value);\n    };\n    /**\n     * update row format on undo\n     * @param  {Selection} selection\n     * @param  {SelectionRange} selectionRange\n     * @param  {string} property\n     * @param  {Object} value\n     * @private\n     */\n    Editor.prototype.updateRowFormat = function (selection, property, value) {\n        var rowStartPosition = selection.start;\n        var rowEndPosition = selection.end;\n        if (!selection.isForward) {\n            rowStartPosition = selection.end;\n            rowEndPosition = selection.start;\n        }\n        this.initHistoryPosition(selection, rowStartPosition);\n        // tslint:disable-next-line:max-line-length\n        this.applyRowFormat(rowStartPosition.paragraph.associatedCell.ownerRow, rowStartPosition, rowEndPosition, property, value);\n    };\n    Editor.prototype.initHistoryPosition = function (selection, position) {\n        if (this.viewer.owner.editorHistoryModule && !isNullOrUndefined(this.editorHistory.currentBaseHistoryInfo)) {\n            if (!isNullOrUndefined(position)) {\n                if (isNullOrUndefined(this.editorHistory.currentBaseHistoryInfo.insertPosition)) {\n                    this.editorHistory.currentBaseHistoryInfo.insertPosition = position.getHierarchicalIndexInternal();\n                }\n            }\n            else if (isNullOrUndefined(this.editorHistory.currentBaseHistoryInfo.insertPosition)) {\n                this.editorHistory.currentBaseHistoryInfo.insertPosition = selection.start.getHierarchicalIndexInternal();\n            }\n        }\n    };\n    Editor.prototype.startSelectionReLayouting = function (paragraph, selection, start, end) {\n        selection.owner.isLayoutEnabled = true;\n        if (start.paragraph.isInsideTable) {\n            var table = start.paragraph.associatedCell.ownerTable;\n            while (table.isInsideTable) {\n                table = table.associatedCell.ownerTable;\n            }\n            this.reLayoutSelectionOfTable(table, selection, start, end);\n        }\n        else {\n            this.reLayoutSelection(paragraph, selection, start, end);\n        }\n    };\n    Editor.prototype.reLayoutSelectionOfTable = function (table, selection, start, end) {\n        var isEnded = false;\n        this.viewer.layout.layoutBodyWidgetCollection(table.index, table.containerWidget, table, false);\n        // If the selection ends in the current table, need to stop relayouting.\n        if (!isNullOrUndefined(end.paragraph.associatedCell) && table.contains(end.paragraph.associatedCell)) {\n            return true;\n        }\n        var block = selection.getNextRenderedBlock(table);\n        // Relayout the next block.\n        if (!isNullOrUndefined(block)) {\n            isEnded = this.reLayoutSelectionOfBlock(block, selection, start, end);\n        }\n        return isEnded;\n    };\n    Editor.prototype.reLayoutSelection = function (paragraph, selection, start, end) {\n        if (start.paragraph === paragraph) {\n            var startOffset = start.offset;\n            var length_2 = selection.getParagraphLength(paragraph);\n            var indexInInline = 0;\n            var index = 0;\n            var inlineObj = paragraph.getInline(start.offset, indexInInline);\n            var inline = inlineObj.element;\n            indexInInline = inlineObj.index;\n            if (!isNullOrUndefined(inline)) {\n                if (indexInInline === inline.length && !isNullOrUndefined(inline.nextNode)) {\n                    inline = inline.nextNode;\n                }\n                index = inline.line.children.indexOf(inline);\n            }\n            var lineIndex = 0;\n            if (start.currentWidget.paragraph === paragraph) {\n                lineIndex = paragraph.childWidgets.indexOf(start.currentWidget);\n                index = start.currentWidget.children.indexOf(inline);\n            }\n            // If selection start inline is at new inline, need to relayout from the previous inline.\n            if (inline instanceof TextElementBox && !inline.line && index > 0) {\n                this.viewer.layout.reLayoutParagraph(paragraph, lineIndex, index - 1);\n            }\n            else {\n                this.viewer.layout.reLayoutParagraph(paragraph, lineIndex, index);\n            }\n        }\n        else {\n            this.viewer.layout.reLayoutParagraph(paragraph, 0, 0);\n        }\n        // If the selection ends at the current paragraph, need to stop relayouting.\n        if (end.paragraph === paragraph) {\n            return true;\n        }\n        // _Relayout the next block.\n        var block = selection.getNextRenderedBlock(paragraph);\n        if (!isNullOrUndefined(block)) {\n            return this.reLayoutSelectionOfBlock(block, selection, start, end);\n        }\n        return false;\n    };\n    //Relayouting Start    \n    Editor.prototype.reLayoutSelectionOfBlock = function (block, selection, start, end) {\n        if (block instanceof ParagraphWidget) {\n            return this.reLayoutSelection(block, selection, start, end);\n        }\n        else {\n            return undefined;\n            // return this.reLayoutSelectionOfTable(block as TableWidget, selection, start, end);\n        }\n    };\n    /**\n     * @private\n     */\n    Editor.prototype.layoutItemBlock = function (block, shiftNextWidget) {\n        var section = undefined;\n        if (block.containerWidget instanceof BlockContainer) {\n            section = block.containerWidget;\n            var index = section.childWidgets.indexOf(block);\n            if (!isNullOrUndefined(this.viewer.owner)\n                && this.viewer.owner.isLayoutEnabled) {\n                // tslint:disable-next-line:max-line-length\n                this.viewer.layout.layoutBodyWidgetCollection(block.index, section, block, false);\n            }\n        }\n        else if (block.containerWidget instanceof TableCellWidget) {\n            var cell = block.containerWidget;\n            cell = this.viewer.selection.getContainerCell(cell);\n            if (!isNullOrUndefined(this.viewer.owner)\n                && this.viewer.owner.isLayoutEnabled) {\n                this.viewer.layout.reLayoutTable(block);\n            }\n        }\n    };\n    /**\n     * @private\n     */\n    Editor.prototype.removeSelectedContents = function (selection) {\n        return this.removeSelectedContentInternal(selection, selection.start, selection.end);\n    };\n    Editor.prototype.removeSelectedContentInternal = function (selection, startPosition, endPosition) {\n        var startPos = startPosition;\n        var endPos = endPosition;\n        if (!startPosition.isExistBefore(endPosition)) {\n            startPos = endPosition;\n            endPos = startPosition;\n        }\n        // tslint:disable-next-line:max-line-length\n        if (startPos.paragraph === endPos.paragraph && startPos.paragraph.childWidgets.indexOf(startPos.currentWidget) === startPos.paragraph.childWidgets.length - 1 &&\n            startPos.offset === selection.getParagraphLength(startPos.paragraph) && startPos.offset + 1 === endPos.offset) {\n            selection.owner.isShiftingEnabled = true;\n            selection.selectContent(startPos, true);\n            return true;\n        }\n        var paragraphInfo = this.getParagraphInfo(startPos);\n        selection.editPosition = this.getHierarchicalIndex(paragraphInfo.paragraph, paragraphInfo.offset.toString());\n        var isRemoved = this.removeSelectedContent(endPos.paragraph, selection, startPos, endPos);\n        var textPosition = new TextPosition(selection.owner);\n        this.setPositionForCurrentIndex(textPosition, selection.editPosition);\n        selection.selectContent(textPosition, true);\n        return isRemoved;\n    };\n    Editor.prototype.removeSelectedContent = function (paragraph, selection, start, end) {\n        //If end is not table end and start is outside the table, then skip removing the contents and move caret to start position.\n        if (end.paragraph.isInsideTable\n            && end.paragraph !== selection.getLastParagraphInLastCell(end.paragraph.associatedCell.ownerTable)\n            && (!start.paragraph.isInsideTable || start.paragraph.associatedCell.ownerTable !== end.paragraph.associatedCell.ownerTable)) {\n            return false;\n        }\n        selection.owner.isShiftingEnabled = true;\n        this.deleteSelectedContent(paragraph, selection, start, end, 2);\n        return true;\n    };\n    // tslint:disable-next-line:max-line-length\n    Editor.prototype.deleteSelectedContent = function (paragraph, selection, start, end, editAction) {\n        var indexInInline = 0;\n        var inlineObj = start.currentWidget.getInline(start.offset, indexInInline);\n        var inline = inlineObj.element;\n        indexInInline = inlineObj.index;\n        // if (!isNullOrUndefined(inline)) {\n        //     inline = selection.getNextRenderedInline(inline, indexInInline);\n        // }\n        // if (inline instanceof WFieldBegin && !isNullOrUndefined((inline as WFieldBegin).fieldEnd)) {\n        // tslint:disable-next-line:max-line-length\n        //     let fieldEndOffset: number = ((inline as WFieldBegin).fieldEnd.owner as WParagraph).getOffset((inline as WFieldBegin).fieldEnd, 1);\n        //     let fieldEndIndex: string = WordDocument.getHierarchicalIndexOf((inline as WFieldBegin).fieldEnd.owner as WParagraph, fieldEndOffset.toString());\n        //     let selectionEndIndex: string = end.getHierarchicalIndexInternal();\n        //     if (!TextPosition.isForwardSelection(fieldEndIndex, selectionEndIndex)) {\n        //         //If selection end is after field begin, moves selection start to field separator.\n        //         start.moveToInline((inline as WFieldBegin).fieldSeparator, 1);\n        //         selection.editPosition = start.getHierarchicalIndexInternal();\n        //         if (!isNullOrUndefined(selection.currentBaseHistoryInfo)) {\n        //             selection.currentBaseHistoryInfo.insertPosition = selection.editPosition;\n        //         }\n        //     }\n        // }\n        indexInInline = 0;\n        inlineObj = end.currentWidget.getInline(end.offset, indexInInline);\n        inline = inlineObj.element;\n        indexInInline = inlineObj.index;\n        // if (!isNullOrUndefined(inline)) {\n        //     inline = selection.getNextRenderedInline(inline, indexInInline);\n        // }\n        // if (inline instanceof WFieldEnd && !isNullOrUndefined((inline as WFieldEnd).fieldBegin)) {\n        // tslint:disable-next-line:max-line-length\n        //     let fieldBeginOffset: number = ((inline as WFieldEnd).fieldBegin.owner as WParagraph).getOffset((inline as WFieldEnd).fieldBegin, 0);\n        //     let fieldBeginIndex: string = WordDocument.getHierarchicalIndexOf((inline as WFieldEnd).fieldBegin.owner as WParagraph, fieldBeginOffset.toString());\n        //     let selectionStartIndex: string = start.getHierarchicalIndexInternal();\n        //     if (!TextPosition.isForwardSelection(selectionStartIndex, fieldBeginIndex)) {\n        //         //If field begin is before selection start, move selection end to inline item before field end.\n        //         let prevInline: WInline = selection.getPreviousTextInline(inline);\n        //         if (isNullOrUndefined(prevInline)) {\n        //             end.moveBackward();\n        //         } else {\n        //             end.moveToInline(prevInline, prevInline.length);\n        //         }\n        //     }\n        // }\n        if (end.paragraph !== paragraph) {\n            this.deleteSelectedContent(end.paragraph, selection, start, end, editAction);\n            return;\n        }\n        //  Selection start in cell.\n        if (end.paragraph.isInsideTable && (!start.paragraph.isInsideTable\n            || start.paragraph.associatedCell !== end.paragraph.associatedCell\n            || selection.isCellSelected(end.paragraph.associatedCell, start, end))) {\n            end.paragraph.associatedCell.ownerTable.combineWidget(this.viewer);\n            this.deleteTableCell(end.paragraph.associatedCell, selection, start, end, editAction);\n        }\n        else {\n            this.deletePara(paragraph, start, end, editAction);\n        }\n    };\n    /**\n     * Merge the selected cells.\n     */\n    Editor.prototype.mergeCells = function () {\n        if (this.owner.isReadOnlyMode || !this.owner.isDocumentLoaded) {\n            return;\n        }\n        if (!isNullOrUndefined(this.viewer) && !this.selection.isEmpty) {\n            this.mergeSelectedCellsInTable();\n        }\n    };\n    /**\n     * Deletes the entire table at selection.\n     */\n    Editor.prototype.deleteTable = function () {\n        if (this.owner.isReadOnlyMode) {\n            return;\n        }\n        var startPos = this.selection.isForward ? this.selection.start : this.selection.end;\n        if (startPos.paragraph.isInsideTable) {\n            var table = this.getOwnerTable(this.selection.isForward).combineWidget(this.viewer);\n            this.selection.owner.isShiftingEnabled = true;\n            if (this.checkIsNotRedoing()) {\n                this.initHistory('DeleteTable');\n                //Sets the insert position in history info as current table.    \n                this.updateHistoryPosition(startPos, true);\n            }\n            var paragraph = this.getParagraphForSelection(table);\n            if (this.editorHistory && this.editorHistory.currentBaseHistoryInfo) {\n                this.editorHistory.currentBaseHistoryInfo.removedNodes.push(table.clone());\n            }\n            this.removeBlock(table);\n            this.selection.selectParagraph(paragraph, true);\n            if (this.checkIsNotRedoing() || isNullOrUndefined(this.editorHistory)) {\n                this.reLayout(this.selection);\n            }\n        }\n    };\n    /**\n     * Deletes the selected column(s).\n     */\n    Editor.prototype.deleteColumn = function () {\n        if (this.owner.isReadOnlyMode) {\n            return;\n        }\n        var startPos = this.selection.isForward ? this.selection.start : this.selection.end;\n        var endPos = this.selection.isForward ? this.selection.end : this.selection.start;\n        if (startPos.paragraph.isInsideTable) {\n            this.selection.owner.isShiftingEnabled = true;\n            if (this.checkIsNotRedoing()) {\n                this.initHistory('DeleteColumn');\n            }\n            var startCell = this.getOwnerCell(this.selection.isForward);\n            var endCell = this.getOwnerCell(!this.selection.isForward);\n            var table = startCell.ownerTable.combineWidget(this.viewer);\n            if (this.editorHistory && this.editorHistory.currentBaseHistoryInfo) {\n                this.cloneTableToHistoryInfo(table);\n            }\n            var paragraph = undefined;\n            if (endCell.nextWidget) {\n                var nextCell = endCell.nextWidget;\n                paragraph = this.selection.getFirstParagraph(nextCell);\n            }\n            else if (startCell.previousWidget) {\n                var previousCell = startCell.previousWidget;\n                paragraph = this.selection.getFirstParagraph(previousCell);\n            }\n            if (isNullOrUndefined(paragraph)) {\n                paragraph = this.getParagraphForSelection(table);\n            }\n            //retrieve the cell collection based on start and end cell to remove. \n            var deleteCells = table.getColumnCellsForSelection(startCell, endCell);\n            for (var i = 0; i < table.childWidgets.length; i++) {\n                var row = table.childWidgets[i];\n                if (row.childWidgets.length === 1) {\n                    if (deleteCells.indexOf(row.childWidgets[0]) >= 0) {\n                        table.childWidgets.splice(table.childWidgets.indexOf(row), 1);\n                        row.destroy();\n                        i--;\n                    }\n                }\n                else {\n                    for (var j = 0; j < row.childWidgets.length; j++) {\n                        var tableCell = row.childWidgets[j];\n                        if (deleteCells.indexOf(tableCell) >= 0) {\n                            row.childWidgets.splice(j, 1);\n                            tableCell.destroy();\n                            j--;\n                        }\n                    }\n                    if (row.childWidgets.length === 0) {\n                        table.childWidgets.splice(table.childWidgets.indexOf(row), 1);\n                        row.destroy();\n                        i--;\n                    }\n                }\n            }\n            if (table.childWidgets.length === 0) {\n                // Before disposing table reset the paragrph.\n                paragraph = this.getParagraphForSelection(table);\n                this.removeBlock(table);\n                if (this.editorHistory && this.editorHistory.currentBaseHistoryInfo) {\n                    this.editorHistory.currentBaseHistoryInfo.action = 'DeleteTable';\n                }\n                table.destroy();\n            }\n            else {\n                table.isGridUpdated = false;\n                table.buildTableColumns();\n                table.isGridUpdated = true;\n                this.viewer.layout.reLayoutTable(table);\n            }\n            this.selection.selectParagraph(paragraph, true);\n            if (isNullOrUndefined(this.editorHistory) || this.checkIsNotRedoing()) {\n                this.reLayout(this.selection, true);\n            }\n        }\n    };\n    /**\n     * Deletes the selected row(s).\n     */\n    Editor.prototype.deleteRow = function () {\n        if (this.owner.isReadOnlyMode) {\n            return;\n        }\n        var startPos = !this.selection.isForward ? this.selection.end : this.selection.start;\n        var endPos = !this.selection.isForward ? this.selection.start : this.selection.end;\n        if (startPos.paragraph.isInsideTable) {\n            var startCell = this.getOwnerCell(this.selection.isForward);\n            var endCell = this.getOwnerCell(!this.selection.isForward);\n            if (this.checkIsNotRedoing()) {\n                this.initHistory('DeleteRow');\n            }\n            this.selection.owner.isShiftingEnabled = true;\n            var table = startCell.ownerTable.combineWidget(this.viewer);\n            var row = this.getOwnerRow(true);\n            if (this.editorHistory && this.editorHistory.currentBaseHistoryInfo) {\n                this.cloneTableToHistoryInfo(table);\n            }\n            var paragraph = undefined;\n            if (row.nextWidget) {\n                var nextCell = row.nextWidget.childWidgets[0];\n                paragraph = this.selection.getFirstParagraph(nextCell);\n            }\n            if (isNullOrUndefined(paragraph)) {\n                paragraph = this.getParagraphForSelection(table);\n            }\n            if (!this.selection.isEmpty) {\n                //tslint:disable-next-line:max-line-length\n                var containerCell = this.selection.getContainerCellOf(startCell, endCell);\n                if (containerCell.ownerTable.contains(endCell)) {\n                    startCell = this.selection.getSelectedCell(startCell, containerCell);\n                    endCell = this.selection.getSelectedCell(endCell, containerCell);\n                    if (this.selection.containsCell(containerCell, endCell)) {\n                        row = startCell.ownerRow;\n                        this.removeRow(row);\n                    }\n                    else {\n                        row = startCell.ownerRow;\n                        var endRow = endCell.ownerRow;\n                        //Update the selection paragraph.\n                        paragraph = undefined;\n                        if (endRow.nextWidget) {\n                            var nextCell = endRow.nextWidget.childWidgets[0];\n                            paragraph = this.selection.getFirstParagraph(nextCell);\n                        }\n                        if (isNullOrUndefined(paragraph)) {\n                            paragraph = this.getParagraphForSelection(table);\n                        }\n                        for (var i = 0; i < table.childWidgets.length; i++) {\n                            var tableRow = table.childWidgets[i];\n                            if (tableRow.rowIndex >= row.rowIndex && tableRow.rowIndex <= endRow.rowIndex) {\n                                table.childWidgets.splice(i, 1);\n                                tableRow.destroy();\n                                i--;\n                            }\n                        }\n                        if (table.childWidgets.length === 0) {\n                            this.removeBlock(table);\n                            if (this.editorHistory && this.editorHistory.currentBaseHistoryInfo) {\n                                this.editorHistory.currentBaseHistoryInfo.action = 'DeleteTable';\n                            }\n                            table.destroy();\n                        }\n                        else {\n                            this.updateTable(table);\n                        }\n                    }\n                }\n            }\n            else {\n                this.removeRow(row);\n            }\n            this.selection.selectParagraph(paragraph, true);\n            if (isNullOrUndefined(this.editorHistory) || this.checkIsNotRedoing()) {\n                this.reLayout(this.selection, true);\n            }\n        }\n    };\n    Editor.prototype.removeRow = function (row) {\n        var table = row.ownerTable;\n        if (table.childWidgets.length === 1) {\n            this.removeBlock(table);\n            if (this.editorHistory && this.editorHistory.currentBaseHistoryInfo) {\n                this.editorHistory.currentBaseHistoryInfo.action = 'Delete';\n            }\n            table.destroy();\n        }\n        else {\n            table.childWidgets.splice(table.childWidgets.indexOf(row), 1);\n            row.destroy();\n            this.updateTable(table);\n        }\n    };\n    Editor.prototype.updateTable = function (table) {\n        table.updateRowIndex(0);\n        table.isGridUpdated = false;\n        table.buildTableColumns();\n        table.isGridUpdated = true;\n        this.viewer.layout.reLayoutTable(table);\n    };\n    Editor.prototype.getParagraphForSelection = function (table) {\n        var paragraph = undefined;\n        var nextWidget = table.nextWidget ? table.nextWidget : table.nextRenderedWidget;\n        var previousWidget = table.previousWidget ? table.previousWidget : table.previousRenderedWidget;\n        if (nextWidget) {\n            paragraph = nextWidget instanceof ParagraphWidget ? nextWidget\n                : this.selection.getFirstParagraphInFirstCell(nextWidget);\n        }\n        else if (previousWidget) {\n            paragraph = previousWidget instanceof ParagraphWidget ? previousWidget\n                : this.selection.getLastParagraphInLastCell(previousWidget);\n        }\n        return paragraph;\n    };\n    Editor.prototype.deletePara = function (paragraph, start, end, editAction) {\n        paragraph = paragraph.combineWidget(this.viewer);\n        var selection = this.viewer.selection;\n        var paragraphStart = selection.getStartOffset(paragraph);\n        var endParagraphStartOffset = selection.getStartOffset(end.paragraph);\n        var startOffset = paragraphStart;\n        var endOffset = 0;\n        var isCombineNextParagraph = false;\n        var lastLinelength = this.selection.getLineLength(paragraph.lastChild);\n        var currentParagraph = paragraph;\n        var section = paragraph.bodyWidget instanceof BodyWidget ? paragraph.bodyWidget : undefined;\n        var startLine = undefined;\n        var endLineWidget = undefined;\n        if (paragraph === start.paragraph) {\n            startOffset = start.offset;\n            startLine = start.currentWidget;\n            if (end.paragraph.isInsideTable) {\n                isCombineNextParagraph = this.isEndInAdjacentTable(paragraph, end.paragraph);\n            }\n        }\n        else {\n            startLine = paragraph.firstChild;\n        }\n        if (paragraph !== start.paragraph && selection.isSkipLayouting) {\n            selection.isSkipLayouting = false;\n        }\n        if (paragraph === end.paragraph) {\n            endLineWidget = end.currentWidget;\n            endOffset = end.offset;\n        }\n        else {\n            endLineWidget = paragraph.lastChild;\n            endOffset = this.viewer.selection.getLineLength(paragraph.lastChild);\n        }\n        var block = paragraph.previousRenderedWidget;\n        if (startOffset > paragraphStart && start.currentWidget === paragraph.lastChild &&\n            startOffset === lastLinelength && (paragraph === end.paragraph && end.offset === startOffset + 1 ||\n            paragraph.nextRenderedWidget === end.paragraph && end.offset === endParagraphStartOffset) ||\n            (this.editorHistory && this.editorHistory.isUndoing && this.editorHistory.currentHistoryInfo &&\n                this.editorHistory.currentHistoryInfo.action === 'PageBreak' && block && block.isPageBreak())) {\n            isCombineNextParagraph = true;\n        }\n        if (end.paragraph === paragraph && end.currentWidget !== paragraph.lastChild ||\n            (end.currentWidget === paragraph.lastChild && end.offset <= selection.getLineLength(paragraph.lastChild))) {\n            var isStartParagraph = start.paragraph === paragraph;\n            if (end.currentWidget.isFirstLine() && end.offset > paragraphStart || !end.currentWidget.isFirstLine()) {\n                //If selection end with this paragraph and selection doesnot include paragraph mark.               \n                this.removeInlines(paragraph, startLine, startOffset, endLineWidget, endOffset, editAction);\n                //Removes the splitted paragraph.\n            }\n            if (!isNullOrUndefined(block) && !isStartParagraph) {\n                var nextSection = block.bodyWidget instanceof BodyWidget ? block.bodyWidget : undefined;\n                if (nextSection && !section.equals(nextSection) && section.index !== nextSection.index) {\n                    this.deleteSection(selection, nextSection, section, editAction);\n                }\n                this.deleteBlock(block, selection, start, end, editAction);\n            }\n        }\n        else if (start.paragraph === paragraph && (start.currentWidget !== paragraph.firstChild ||\n            (start.currentWidget === paragraph.firstChild && startOffset > paragraphStart))) {\n            // If selection start is after paragraph start\n            //And selection does not end with this paragraph Or selection include paragraph mark.\n            if (editAction === 4) {\n                return;\n            }\n            else {\n                currentParagraph = this.splitParagraph(paragraph, paragraph.firstChild, 0, startLine, startOffset, true);\n                this.insertParagraphPaste(paragraph, currentParagraph, start, end, isCombineNextParagraph, editAction);\n                this.addRemovedNodes(paragraph);\n                return;\n            }\n        }\n        else {\n            var newParagraph = undefined;\n            var previousBlock = paragraph.previousWidget;\n            var prevParagraph = (previousBlock instanceof ParagraphWidget) ? previousBlock : undefined;\n            var nextWidget = paragraph.nextRenderedWidget;\n            if (editAction < 4) {\n                //Checks whether this is last paragraph of owner text body and previousBlock is not paragraph.\n                newParagraph = this.checkAndInsertBlock(paragraph, start, end, editAction, prevParagraph);\n                this.removeBlock(paragraph);\n                if (this.viewer.blockToShift === paragraph) {\n                    this.viewer.blockToShift = undefined;\n                }\n                this.addRemovedNodes(paragraph);\n                if (!isNullOrUndefined(newParagraph)) {\n                    selection.editPosition = this.getHierarchicalIndex(newParagraph, '0');\n                    var offset = selection.getParagraphLength(newParagraph) + 1;\n                    if (this.editorHistory && !isNullOrUndefined(this.editorHistory.currentBaseHistoryInfo)) {\n                        //tslint:disable-next-line:max-line-length\n                        this.editorHistory.currentBaseHistoryInfo.endPosition = this.getHierarchicalIndex(newParagraph, offset.toString());\n                    }\n                }\n                else if (paragraph === start.paragraph && isNullOrUndefined(nextWidget) && !isNullOrUndefined(prevParagraph)) {\n                    var offset = this.selection.getParagraphLength(prevParagraph);\n                    // if (isNullOrUndefined(block)) {\n                    selection.editPosition = this.getHierarchicalIndex(prevParagraph, offset.toString());\n                    if (this.editorHistory && !isNullOrUndefined(this.editorHistory.currentBaseHistoryInfo)) {\n                        this.updateHistoryPosition(selection.editPosition, true);\n                        this.editorHistory.currentBaseHistoryInfo.endPosition = selection.editPosition;\n                    }\n                    // } else {\n                    //     let offset: number = selection.getParagraphLength(paragraph) + 1;\n                    //     if (block instanceof ParagraphWidget) {\n                    //         prevParagraph = block as ParagraphWidget;\n                    //     }\n                    //     // if (block instanceof WTable) {\n                    //     //     prevParagraph = (block as WTable).getFirstParagraphInFirstCell();\n                    //     // }\n                    //     selection.editPosition = prevLineWidget.getHierarchicalIndex('0');\n                    // }\n                }\n            }\n            if (start.paragraph !== paragraph && !isNullOrUndefined(block)) {\n                var nextSection = block.bodyWidget instanceof BodyWidget ? block.bodyWidget : undefined;\n                // if (section !== nextSection) {\n                //     this.deleteSection(selection, section, nextSection, editAction);\n                // }\n                this.deleteBlock(block, selection, start, end, editAction);\n            }\n        }\n        this.insertParagraphPaste(paragraph, currentParagraph, start, end, isCombineNextParagraph, editAction);\n    };\n    Editor.prototype.deleteSection = function (selection, section, nextSection, editAction) {\n        if (editAction < 4) {\n            this.combineSectionInternal(selection, section, nextSection);\n        }\n        //Copies the section properties, if this is last paragraph of section.\n        if (editAction > 2) {\n            section.sectionFormat.copyFormat(nextSection.sectionFormat);\n        }\n    };\n    Editor.prototype.combineSectionInternal = function (selection, section, nextSection) {\n        // if (section.sectionFormat.isEqualFormat(nextSection.sectionFormat)) {\n        // } else {\n        var bodyWidget = section.getSplitWidgets()[0];\n        var currentSection = [];\n        this.combineSectionChild(bodyWidget, currentSection);\n        bodyWidget = currentSection[0];\n        var lastBlockIndex = bodyWidget.lastChild.index;\n        this.updateBlockIndex(lastBlockIndex + 1, nextSection.firstChild);\n        var insertIndex = 0;\n        var containerWidget = nextSection;\n        for (var i = 0; i < bodyWidget.childWidgets.length; i++) {\n            var block = bodyWidget.childWidgets.splice(i, 1)[0];\n            containerWidget.childWidgets.splice(insertIndex, 0, block);\n            block.containerWidget = containerWidget;\n            this.viewer.layout.layoutBodyWidgetCollection(block.index, block.bodyWidget, block, false);\n            block = block.getSplitWidgets().pop();\n            containerWidget = block.containerWidget;\n            insertIndex = block.indexInOwner + 1;\n            i--;\n        }\n        this.updateSectionIndex(undefined, nextSection, false);\n        this.addRemovedNodes(bodyWidget);\n        // this.insert\n        // }\n    };\n    //tslint:disable:max-line-length\n    /**\n     * @private\n     */\n    Editor.prototype.checkAndInsertBlock = function (block, start, end, editAction, previousParagraph) {\n        if (block instanceof ParagraphWidget && block === start.paragraph || block instanceof TableWidget) {\n            var newParagraph = void 0; //Adds an empty paragraph, to ensure minimal content.\n            if (isNullOrUndefined(block.nextWidget) && (isNullOrUndefined(previousParagraph) || previousParagraph.nextRenderedWidget instanceof TableWidget)) {\n                newParagraph = new ParagraphWidget();\n                if (editAction === 1 && block instanceof ParagraphWidget) {\n                    newParagraph.characterFormat.copyFormat(block.characterFormat);\n                    newParagraph.paragraphFormat.copyFormat(block.paragraphFormat);\n                }\n                newParagraph.index = block.index + 1;\n                newParagraph.containerWidget = block.containerWidget;\n                this.viewer.layout.layoutBodyWidgetCollection(newParagraph.index, newParagraph.bodyWidget, newParagraph, false);\n                if (block.containerWidget instanceof Widget) {\n                    block.containerWidget.childWidgets.push(newParagraph);\n                }\n            }\n            return newParagraph;\n        }\n        return undefined;\n    };\n    // tslint:disable-next-line:max-line-length\n    Editor.prototype.splitParagraph = function (paragraphAdv, startLine, startOffset, endLine, endOffset, removeBlock) {\n        var paragraph = new ParagraphWidget();\n        paragraph.paragraphFormat = new WParagraphFormat(paragraph);\n        paragraph.characterFormat = new WCharacterFormat(paragraph);\n        paragraph.paragraphFormat.copyFormat(paragraphAdv.paragraphFormat);\n        paragraph.characterFormat.copyFormat(paragraphAdv.characterFormat);\n        var lineWidget = new LineWidget(paragraph);\n        paragraph.childWidgets.push(lineWidget);\n        var blockIndex = paragraphAdv.index;\n        var insertIndex = paragraphAdv.indexInOwner;\n        this.moveInlines(paragraphAdv, paragraph, 0, startOffset, startLine, endOffset, endLine);\n        //Inserts new paragraph in the current text position.\n        paragraphAdv.containerWidget.childWidgets.splice(insertIndex, 0, paragraph);\n        paragraph.index = blockIndex;\n        paragraph.containerWidget = paragraphAdv.containerWidget;\n        this.updateNextBlocksIndex(paragraph, true);\n        if (removeBlock) {\n            this.removeBlock(paragraphAdv);\n        }\n        // tslint:disable-next-line:max-line-length\n        this.viewer.layout.layoutBodyWidgetCollection(blockIndex, paragraph.containerWidget, paragraph, false);\n        return paragraph;\n    };\n    /**\n     * @private\n     */\n    Editor.prototype.removeBlock = function (block) {\n        var index;\n        var blockCollection;\n        var containerWidget;\n        this.removeFieldInBlock(block);\n        if (block.isInsideTable) {\n            containerWidget = block.associatedCell;\n            index = block.associatedCell.childWidgets.indexOf(block);\n            blockCollection = block.associatedCell.childWidgets;\n            this.updateNextBlocksIndex(block, false);\n            block.associatedCell.childWidgets.splice(index, 1);\n            block.containerWidget = undefined;\n            this.viewer.layout.layoutBodyWidgetCollection(block.index, containerWidget, block, false);\n        }\n        else {\n            containerWidget = block.containerWidget;\n            index = containerWidget.childWidgets.indexOf(block);\n            blockCollection = containerWidget.childWidgets;\n            this.updateNextBlocksIndex(block, false);\n            containerWidget.childWidgets.splice(index, 1);\n            block.containerWidget = undefined;\n            containerWidget.height -= block.height;\n            this.viewer.layout.layoutBodyWidgetCollection(block.index, containerWidget, block, false);\n        }\n    };\n    Editor.prototype.removeField = function (block) {\n        for (var i = 0; i < this.viewer.fields.length; i++) {\n            var field = this.viewer.fields[i];\n            if (field.line.paragraph === block) {\n                this.viewer.fields.splice(i, 1);\n                i--;\n            }\n        }\n    };\n    Editor.prototype.addRemovedNodes = function (node) {\n        if (node instanceof FieldElementBox && node.fieldType === 0) {\n            if (this.viewer.fields.indexOf(node) !== -1) {\n                this.viewer.fields.splice(this.viewer.fields.indexOf(node), 1);\n            }\n        }\n        if (this.editorHistory && !isNullOrUndefined(this.editorHistory.currentBaseHistoryInfo)) {\n            this.editorHistory.currentBaseHistoryInfo.removedNodes.push(node);\n        }\n        else if (this.editHyperlinkInternal) {\n            this.nodes.push(node);\n        }\n    };\n    Editor.prototype.deleteBlock = function (block, selection, start, end, editAction) {\n        if (block instanceof ParagraphWidget) {\n            this.deletePara(block, start, end, editAction);\n        }\n        else {\n            this.deleteTableBlock(block, selection, start, end, editAction);\n        }\n    };\n    // tslint:disable-next-line:max-line-length\n    Editor.prototype.deleteTableCell = function (cellAdv, selection, start, end, editAction) {\n        var deletePreviousBlock = !(start.paragraph.isInsideTable && cellAdv.ownerTable.contains(start.paragraph.associatedCell));\n        var previousBlock = cellAdv.ownerTable.previousRenderedWidget;\n        if (start.paragraph.isInsideTable) {\n            var containerCell = selection.getContainerCellOf(cellAdv, start.paragraph.associatedCell);\n            if (containerCell.ownerTable.contains(start.paragraph.associatedCell)) {\n                var startCell = selection.getSelectedCell(cellAdv, containerCell);\n                var endCell = selection.getSelectedCell(start.paragraph.associatedCell, containerCell);\n                if (selection.containsCell(containerCell, start.paragraph.associatedCell)) {\n                    //Selection end is in container cell.\n                    if (selection.isCellSelected(containerCell, start, end)) {\n                        //Container cell is completely selected.\n                        this.updateEditPosition(containerCell, selection);\n                        if (editAction === 1) {\n                            //Specifically handled for backspace. Delete selected cell in current table.\n                            this.deleteCellsInTable(cellAdv.ownerRow.ownerTable, selection, start, end, editAction);\n                        }\n                        else {\n                            //Delete contents within table cell or Copy contents within table cell to clipboard.\n                            var isCellCleared = this.deleteCell(containerCell, selection, editAction, true);\n                            if (!isCellCleared && editAction !== 2 && this.editorHistory) {\n                                this.editorHistory.currentBaseHistoryInfo = undefined;\n                            }\n                        }\n                    }\n                    else {\n                        if (startCell === containerCell) {\n                            this.deletePara(end.paragraph, start, end, editAction);\n                        }\n                        else {\n                            this.deleteContainer(startCell, selection, start, end, editAction);\n                        }\n                    }\n                }\n                else {\n                    if (editAction === 2) {\n                        //Delete contents within table cell.\n                        this.deleteCell(cellAdv, selection, 2, false);\n                    }\n                    else {\n                        //Delete other selected cells in current table.\n                        this.deleteCellsInTable(containerCell.ownerTable, selection, start, end, editAction);\n                    }\n                }\n            }\n            else {\n                //Selection end is different table.\n                this.deleteContainer(containerCell, selection, start, end, editAction);\n            }\n        }\n        else {\n            //Selection end is outside table.\n            var cell = selection.getContainerCell(cellAdv);\n            this.deleteContainer(cell, selection, start, end, editAction);\n        }\n        if (deletePreviousBlock) {\n            var sectionAdv = previousBlock.bodyWidget instanceof BodyWidget ? previousBlock.bodyWidget : undefined;\n            // this.deleteContent(cellAdv.ownerTable, selection, editAction);\n            if (!isNullOrUndefined(previousBlock)) {\n                // let nextSection: WSection = blockAdv.section instanceof WSection ? blockAdv.section as WSection : undefined;\n                // if (sectionAdv !== nextSection) {\n                //     this.deleteSection(selection, sectionAdv, nextSection, editAction);\n                // }\n                //Goto the next block.\n                this.deleteBlock(previousBlock, selection, start, end, editAction);\n            }\n        }\n    };\n    // tslint:disable-next-line:max-line-length\n    Editor.prototype.deleteCellsInTable = function (table, selection, start, end, editAction) {\n        var clonedTable = undefined;\n        var isDeleteCells = false;\n        var action = 'Delete';\n        var startCell = start.paragraph.associatedCell;\n        var endCell = end.paragraph.associatedCell;\n        if (this.editorHistory && !isNullOrUndefined(this.editorHistory.currentBaseHistoryInfo)) {\n            action = this.editorHistory.currentBaseHistoryInfo.action;\n            //tslint:disable-next-line:max-line-length\n            isDeleteCells = this.editorHistory.currentBaseHistoryInfo.action === 'BackSpace' || this.editorHistory.currentBaseHistoryInfo.action === 'DeleteCells'\n                || this.editorHistory.currentBaseHistoryInfo.action === 'InsertTable' || (isNullOrUndefined(startCell.ownerRow.previousWidget)\n                && isNullOrUndefined(endCell.ownerRow.nextWidget) && this.editorHistory.currentBaseHistoryInfo.action === 'Cut');\n            this.editorHistory.currentBaseHistoryInfo.action = isDeleteCells ? 'DeleteCells' : 'ClearCells';\n            clonedTable = this.cloneTableToHistoryInfo(table);\n            selection.owner.isLayoutEnabled = false;\n        }\n        var startColumnIndex = startCell.columnIndex;\n        var endColumnIndex = endCell.columnIndex + endCell.cellFormat.columnSpan - 1;\n        var startRowIndex = startCell.rowIndex;\n        var endRowIndex = endCell.rowIndex;\n        var cells = [];\n        var isStarted = false;\n        var isCellCleared = false;\n        for (var i = 0; i < table.childWidgets.length; i++) {\n            var row = table.childWidgets[i];\n            if (row.index >= startRowIndex && row.index <= endRowIndex) {\n                for (var j = 0; j < row.childWidgets.length; j++) {\n                    var cell = row.childWidgets[j];\n                    if (cell.columnIndex >= startColumnIndex && cell.columnIndex <= endColumnIndex) {\n                        if (!isStarted) {\n                            this.updateEditPosition(cell, selection);\n                            isStarted = true;\n                        }\n                        if (isDeleteCells) {\n                            //Specific for Backspace and Cut if selection includes all rows.\n                            var cell_1 = row.childWidgets[j];\n                            this.updateNextBlocksIndex(cell_1, false);\n                            row.childWidgets.splice(j, 1);\n                            j--;\n                        }\n                        else if (editAction < 4) {\n                            isCellCleared = this.deleteCell(cell, selection, editAction, false);\n                        }\n                    }\n                }\n                if (row.childWidgets.length === 0) {\n                    this.updateNextBlocksIndex(table.childWidgets[i], false);\n                    table.childWidgets.splice(i, 1);\n                    i--;\n                    endRowIndex--;\n                }\n            }\n        }\n        //Layouts the table after delete cells.\n        selection.owner.isLayoutEnabled = true;\n        if (table.childWidgets.length === 0) {\n            selection.editPosition = this.getHierarchicalIndex(table, '0');\n            this.setActionInternal(selection, action);\n            this.removeBlock(table);\n        }\n        else {\n            // Before lay outing need to update table grid.\n            table.isGridUpdated = false;\n            table.buildTableColumns();\n            table.isGridUpdated = true;\n            this.viewer.layout.reLayoutTable(table);\n        }\n    };\n    Editor.prototype.deleteCell = function (cell, selection, editAction, copyChildToClipboard) {\n        //Checks whether this is last paragraph of owner textbody.\n        var block = cell.childWidgets[0];\n        if (cell.childWidgets.length === 1 && block instanceof ParagraphWidget && block.isEmpty()) {\n            return false;\n        }\n        for (var i = 0; i < cell.childWidgets.length; i++) {\n            block = cell.childWidgets[i];\n            if (editAction < 4) {\n                //Checks whether this is last paragraph of owner textbody.\n                if (block instanceof ParagraphWidget && cell.childWidgets.length === 1) {\n                    //Preserves empty paragraph, to ensure minimal content.\n                    var paragraph = block;\n                    //Removes all the inlines in the paragraph.\n                    for (var j = 0; j < paragraph.childWidgets.length; j++) {\n                        var inline = paragraph.childWidgets[j];\n                        for (var k = 0; k < inline.children.length; k++) {\n                            var element = inline.children[k];\n                            this.unLinkFieldCharacter(element);\n                            inline.children.splice(k, 1);\n                            // this.layoutInlineCollection(true, paragraph.inlines.indexOf(inline), paragraph.inlines, inline);\n                            k--;\n                            if (this.checkClearCells(selection)) {\n                                this.addRemovedNodes(element);\n                            }\n                        }\n                        if (paragraph.childWidgets.length > 1) {\n                            paragraph.childWidgets.splice(j, 1);\n                            j--;\n                        }\n                    }\n                    if (this.checkClearCells(selection)) {\n                        //Add Index for line Widget\n                        selection.editPosition = this.getHierarchicalIndex(paragraph, '0');\n                        this.updateHistoryPosition(selection.editPosition, true);\n                    }\n                    break;\n                }\n                this.removeBlock(block);\n                i--;\n                if (this.checkClearCells(selection)) {\n                    this.addRemovedNodes(block);\n                }\n            }\n        }\n        return true;\n    };\n    Editor.prototype.deleteContainer = function (cell, selection, start, end, editAction) {\n        var ownerTable = cell.ownerTable;\n        if (selection.containsRow(ownerTable.lastChild, end.paragraph.associatedCell)) {\n            this.deleteContent(ownerTable, selection, editAction);\n        }\n        else {\n            for (var i = 0; i < ownerTable.childWidgets.length; i++) {\n                var row = ownerTable.childWidgets[i];\n                if (editAction < 4) {\n                    this.updateNextBlocksIndex(row, false);\n                    ownerTable.childWidgets.splice(i, 1);\n                    this.addRemovedNodes(row);\n                    i--;\n                }\n                if (end.paragraph.isInsideTable && selection.containsRow(row, end.paragraph.associatedCell)) {\n                    this.viewer.layout.reLayoutTable(ownerTable);\n                    return;\n                }\n            }\n        }\n    };\n    Editor.prototype.deleteTableBlock = function (table, selection, start, end, editAction) {\n        table = table.combineWidget(this.viewer);\n        if (start.paragraph.isInsideTable && table.contains(start.paragraph.associatedCell)) {\n            var block = table.previousRenderedWidget;\n            // tslint:disable-next-line:max-line-length\n            var previousBlock = this.checkAndInsertBlock(table, start, end, editAction, block instanceof ParagraphWidget ? block : undefined);\n            if (selection.containsRow(table.firstChild, start.paragraph.associatedCell)) {\n                this.deleteContent(table, selection, editAction);\n            }\n            else {\n                var newTable = this.splitTable(table, start.paragraph.associatedCell.ownerRow);\n                this.deleteContent(table, selection, editAction);\n                this.viewer.layout.layoutBodyWidgetCollection(newTable.index, newTable.containerWidget, newTable, false);\n            }\n            if (!isNullOrUndefined(previousBlock)) {\n                selection.editPosition = this.getHierarchicalIndex(previousBlock, '0');\n                if (this.editorHistory && !isNullOrUndefined(this.editorHistory.currentBaseHistoryInfo)) {\n                    this.editorHistory.currentBaseHistoryInfo.endPosition = selection.editPosition;\n                }\n            }\n        }\n        else {\n            var blockAdv = table.previousRenderedWidget;\n            var sectionAdv = table.bodyWidget instanceof BodyWidget ? table.bodyWidget : undefined;\n            this.deleteContent(table, selection, editAction);\n            if (!isNullOrUndefined(blockAdv)) {\n                // let nextSection: WSection = blockAdv.section instanceof WSection ? blockAdv.section as WSection : undefined;\n                // if (sectionAdv !== nextSection) {\n                //     this.deleteSection(selection, sectionAdv, nextSection, editAction);\n                // }\n                //Goto the next block.\n                this.deleteBlock(blockAdv, selection, start, end, editAction);\n            }\n        }\n    };\n    Editor.prototype.splitTable = function (table, splitEndRow) {\n        var newTable = new TableWidget();\n        newTable.tableFormat.copyFormat(table.tableFormat);\n        newTable.index = table.index;\n        //Moves the rows to new table.\n        for (var i = 0; i < table.childWidgets.length; i++) {\n            var row = table.childWidgets[i];\n            if (row === splitEndRow) {\n                break;\n            }\n            newTable.childWidgets.push(row);\n            row.containerWidget = newTable;\n            table.childWidgets.splice(i, 1);\n            i--;\n        }\n        //Inserts new table in the current text position.\n        var insertIndex = table.getIndex();\n        table.containerWidget.childWidgets.splice(insertIndex, 0, newTable);\n        newTable.containerWidget = table.containerWidget;\n        this.updateNextBlocksIndex(newTable, true);\n        return newTable;\n    };\n    Editor.prototype.updateEditPosition = function (cell, selection) {\n        var firstParagraph = selection.getFirstParagraphInCell(cell);\n        selection.editPosition = this.getHierarchicalIndex(firstParagraph, '0');\n    };\n    /**\n     * @private\n     */\n    Editor.prototype.deleteContent = function (table, selection, editAction) {\n        if (editAction < 4) {\n            this.removeBlock(table);\n            this.addRemovedNodes(table);\n        }\n    };\n    Editor.prototype.setActionInternal = function (selection, action) {\n        if (this.viewer.owner.enableHistoryMode && !isNullOrUndefined(this.editorHistory.currentBaseHistoryInfo)) {\n            this.editorHistory.currentBaseHistoryInfo.action = action;\n        }\n    };\n    Editor.prototype.checkClearCells = function (selection) {\n        // tslint:disable-next-line:max-line-length\n        return this.editorHistory && this.editorHistory.currentBaseHistoryInfo && this.editorHistory.currentBaseHistoryInfo.action !== 'ClearCells';\n    };\n    Editor.prototype.isEndInAdjacentTable = function (paragraph, endParagraph) {\n        var start = this.getHierarchicalIndex(paragraph, '');\n        var end = this.getHierarchicalIndex(endParagraph, '');\n        var selectionStart = start.split(';');\n        var selectionEnd = end.split(';');\n        return selectionStart.length < selectionEnd.length;\n    };\n    Editor.prototype.cloneTableToHistoryInfo = function (table) {\n        if (this.editorHistory && !isNullOrUndefined(this.editorHistory.currentBaseHistoryInfo)) {\n            //Clones the entire table to preserve in history.\n            var clonedTable = table.clone();\n            //Preserves the cloned table in history info, for future undo operation.\n            this.editorHistory.currentBaseHistoryInfo.removedNodes.push(clonedTable);\n            //Sets the insert position in history info as current table.\n            if (this.viewer.selection.start.paragraph.isInsideTable &&\n                this.viewer.selection.start.paragraph.associatedCell.ownerTable === table) {\n                this.updateHistoryPosition(this.getHierarchicalIndex(table, '0'), true);\n            }\n            return clonedTable;\n        }\n        return undefined;\n    };\n    // tslint:disable-next-line:max-line-length\n    Editor.prototype.insertParagraphPaste = function (paragraph, currentParagraph, start, end, isCombineNextParagraph, editAction) {\n        if (this.editorHistory && (this.editorHistory.isUndoing || this.editorHistory.isRedoing) && this.editorHistory.currentBaseHistoryInfo.action === 'Paste') {\n            var nextParagraph = this.selection.getNextParagraphBlock(currentParagraph);\n            if (nextParagraph) {\n                if (start.offset > 0 && nextParagraph === end.paragraph && paragraph === start.paragraph\n                    && this.editorHistory.currentBaseHistoryInfo.action === 'Paste') {\n                    //Combines the current paragraph with end paragraph specific for undo/redo paste action.\n                    var insertIndex = 0;\n                    this.removeBlock(currentParagraph);\n                    this.viewer.layout.clearListElementBox(nextParagraph);\n                    this.viewer.layout.clearListElementBox(currentParagraph);\n                    for (var i = 0; i < currentParagraph.childWidgets.length; i++) {\n                        var line = currentParagraph.childWidgets[i];\n                        nextParagraph.childWidgets.splice(insertIndex, 0, line);\n                        currentParagraph.childWidgets.splice(i, 1);\n                        i--;\n                        insertIndex++;\n                        line.paragraph = nextParagraph;\n                    }\n                    this.viewer.layout.reLayoutParagraph(nextParagraph, 0, 0);\n                    isCombineNextParagraph = false;\n                    var offset = this.selection.editPosition.substring(this.selection.editPosition.lastIndexOf(';') + 1);\n                    this.selection.editPosition = this.getHierarchicalIndex(nextParagraph, offset);\n                }\n            }\n        }\n        if (isCombineNextParagraph) {\n            this.deleteParagraphMark(currentParagraph, this.selection, editAction);\n        }\n    };\n    // tslint:disable-next-line:max-line-length\n    Editor.prototype.removeInlines = function (paragraph, startLine, startOffset, endLine, endOffset, editAction) {\n        var isRemoved = false;\n        this.viewer.layout.clearListElementBox(paragraph);\n        var startIndex = paragraph.childWidgets.indexOf(startLine);\n        for (var i = paragraph.childWidgets.length - 1; i >= 0; i--) {\n            var lineWidget = paragraph.childWidgets[i];\n            if (startLine === lineWidget && endLine === lineWidget) {\n                this.removeContent(lineWidget, startOffset, endOffset);\n                isRemoved = true;\n                break;\n            }\n            if (endLine === lineWidget) {\n                isRemoved = true;\n                this.removeContent(lineWidget, 0, endOffset);\n            }\n            else if (startLine === lineWidget) {\n                this.removeContent(lineWidget, startOffset, this.viewer.selection.getLineLength(lineWidget));\n                break;\n            }\n            else if (isRemoved) {\n                this.removeContent(lineWidget, 0, this.viewer.selection.getLineLength(lineWidget));\n            }\n        }\n        if (isRemoved) {\n            this.removeEmptyLine(paragraph);\n            this.viewer.layout.reLayoutParagraph(paragraph, 0, 0);\n        }\n    };\n    /**\n     * @private\n     */\n    Editor.prototype.removeContent = function (lineWidget, startOffset, endOffset) {\n        var count = this.selection.getLineLength(lineWidget);\n        for (var i = lineWidget.children.length - 1; i >= 0; i--) {\n            var inline = lineWidget.children[i];\n            if (endOffset <= count - inline.length) {\n                count -= inline.length;\n                continue;\n            }\n            var endIndex = inline.length;\n            if (count > endOffset && (count - endIndex < endOffset)) {\n                endIndex = endOffset - (count - inline.length);\n            }\n            var startIndex = 0;\n            if (count - inline.length < startOffset) {\n                startIndex = startOffset - (count - inline.length);\n            }\n            if (count > endOffset) {\n                count -= (inline.length - endIndex);\n            }\n            if (startIndex === 0 && endIndex === inline.length) {\n                if (!(this.editorHistory && (this.editorHistory.isUndoing || this.editorHistory.isRedoing))) {\n                    if (inline instanceof BookmarkElementBox) {\n                        this.removedBookmarkElements.push(inline);\n                    }\n                }\n                // if (editAction < 4) {\n                this.unLinkFieldCharacter(inline);\n                this.addRemovedNodes(lineWidget.children[i]);\n                lineWidget.children.splice(i, 1);\n                // }\n            }\n            else if (inline instanceof TextElementBox) {\n                // if (editAction < 4) {\n                var span = new TextElementBox();\n                span.characterFormat.copyFormat(inline.characterFormat);\n                span.text = inline.text.substr(startIndex, endIndex - startIndex);\n                this.addRemovedNodes(span);\n                inline.text = inline.text.slice(0, startIndex) + inline.text.slice(endIndex);\n            }\n            if (startOffset >= count - (endIndex - startIndex)) {\n                break;\n            }\n            count -= (endIndex - startIndex);\n        }\n    };\n    /**\n     * @private\n     */\n    Editor.prototype.removeEmptyLine = function (paragraph) {\n        if (paragraph.childWidgets.length > 1) {\n            for (var i = 0; i < paragraph.childWidgets.length; i++) {\n                var lineWidget = paragraph.childWidgets[i];\n                if (lineWidget.children.length === 0 && paragraph.childWidgets.length > 1) {\n                    paragraph.childWidgets.splice(i, 1);\n                    i--;\n                }\n            }\n        }\n    };\n    //#endregion\n    /**\n     * clone the list level\n     * @param  {WListLevel} source\n     * @private\n     */\n    Editor.prototype.cloneListLevel = function (source) {\n        var listLevel = new WListLevel(undefined);\n        this.copyListLevel(listLevel, source);\n        return listLevel;\n    };\n    /**\n     * Copies the list level\n     * @param  {WListLevel} destination\n     * @param  {WListLevel} listLevel\n     * @private\n     */\n    Editor.prototype.copyListLevel = function (destination, listLevel) {\n        if (!isNullOrUndefined(listLevel.paragraphFormat)) {\n            destination.paragraphFormat = new WParagraphFormat(destination);\n            destination.paragraphFormat.copyFormat(listLevel.paragraphFormat);\n        }\n        if (!isNullOrUndefined(listLevel.characterFormat)) {\n            destination.characterFormat = new WCharacterFormat(destination);\n            destination.characterFormat.copyFormat(listLevel.characterFormat);\n        }\n        if (!isNullOrUndefined(listLevel.followCharacter)) {\n            destination.followCharacter = listLevel.followCharacter;\n        }\n        if (!isNullOrUndefined(listLevel.listLevelPattern)) {\n            destination.listLevelPattern = listLevel.listLevelPattern;\n        }\n        if (!isNullOrUndefined(listLevel.numberFormat)) {\n            destination.numberFormat = listLevel.numberFormat;\n        }\n        if (!isNullOrUndefined(listLevel.restartLevel)) {\n            destination.restartLevel = listLevel.restartLevel;\n        }\n        if (!isNullOrUndefined(listLevel.startAt)) {\n            destination.startAt = listLevel.startAt;\n        }\n    };\n    /**\n     * Clone level override\n     * @param  {WLevelOverride} source\n     * @private\n     */\n    Editor.prototype.cloneLevelOverride = function (source) {\n        var levelOverride = new WLevelOverride();\n        if (!isNullOrUndefined(source.startAt)) {\n            levelOverride.startAt = source.startAt;\n        }\n        if (!isNullOrUndefined(source.overrideListLevel)) {\n            levelOverride.overrideListLevel = source.overrideListLevel;\n        }\n        if (!isNullOrUndefined(source.levelNumber)) {\n            levelOverride.levelNumber = source.levelNumber;\n        }\n        return levelOverride;\n    };\n    /**\n     * Update List Paragraph\n     * @private\n     */\n    Editor.prototype.updateListParagraphs = function () {\n        this.viewer.listParagraphs = [];\n        for (var j = 0; j < this.viewer.pages.length; j++) {\n            var bodyWidget = this.viewer.pages[j].bodyWidgets[0];\n            for (var i = 0; i < bodyWidget.childWidgets.length; i++) {\n                this.updateListParagraphsInBlock(bodyWidget.childWidgets[i]);\n            }\n        }\n    };\n    /**\n     * @private\n     */\n    Editor.prototype.updateListParagraphsInBlock = function (block) {\n        if (block instanceof ParagraphWidget) {\n            if (!isNullOrUndefined(block.paragraphFormat)\n                && !isNullOrUndefined(block.paragraphFormat.listFormat)\n                && !isNullOrUndefined(block.paragraphFormat.listFormat.listId)) {\n                if (isNullOrUndefined(this.viewer.listParagraphs)) {\n                    this.viewer.listParagraphs = [];\n                }\n                this.viewer.listParagraphs.push(block);\n            }\n        }\n        else if (block instanceof TableWidget) {\n            for (var i = 0; i < block.childWidgets.length; i++) {\n                for (var j = 0; j < block.childWidgets[i].childWidgets.length; j++) {\n                    var cell = block.childWidgets[i].childWidgets[j];\n                    for (var k = 0; k < cell.childWidgets.length; k++) {\n                        this.updateListParagraphsInBlock(cell.childWidgets[k]);\n                    }\n                }\n            }\n        }\n    };\n    /**\n     * Applies list format\n     * @param  {WList} list\n     * @private\n     */\n    Editor.prototype.onApplyList = function (list) {\n        var selection = this.viewer.selection;\n        this.setOffsetValue(this.viewer.selection);\n        this.initHistory('ListFormat');\n        var format = new WListFormat();\n        if (!isNullOrUndefined(list)) {\n            format.listId = list.listId;\n        }\n        this.viewer.owner.isShiftingEnabled = true;\n        if (selection.isEmpty) {\n            this.applyParaFormatProperty(selection.start.paragraph, 'listFormat', format, false);\n            this.layoutItemBlock(selection.start.paragraph, false);\n        }\n        else {\n            this.updateSelectionParagraphFormatting('listFormat', format, false);\n        }\n        this.reLayout(selection);\n    };\n    /**\n     * Applies bullets or numbering list\n     * @param  {string} format\n     * @param  {ListLevelPattern} listLevelPattern\n     * @param  {string} fontFamily\n     * @private\n     */\n    Editor.prototype.applyBulletOrNumbering = function (format, listLevelPattern, fontFamily) {\n        var selection = this.viewer.selection;\n        var list = selection.paragraphFormat.getList();\n        var isUpdate = false;\n        var start = selection.start;\n        if (!selection.isForward) {\n            start = selection.end;\n        }\n        var currentParagraph = start.paragraph;\n        if (isNullOrUndefined(list)) {\n            while (!isNullOrUndefined(currentParagraph.previousWidget) && currentParagraph.previousWidget instanceof ParagraphWidget\n                && currentParagraph.previousWidget.isEmpty() && currentParagraph.previousWidget.paragraphFormat.listFormat.listId === -1) {\n                currentParagraph = currentParagraph.previousWidget;\n            }\n            if (currentParagraph.previousWidget && currentParagraph.previousWidget instanceof ParagraphWidget\n                && currentParagraph.previousWidget.paragraphFormat.listFormat.listId !== -1) {\n                currentParagraph = currentParagraph.previousWidget;\n                list = this.viewer.getListById(currentParagraph.paragraphFormat.listFormat.listId);\n                isUpdate = true;\n            }\n        }\n        var startListLevel = undefined;\n        if (!isNullOrUndefined(list)) {\n            var tempList = this.viewer.getListById(currentParagraph.paragraphFormat.listFormat.listId);\n            startListLevel = this.viewer.layout.getListLevel(tempList, currentParagraph.paragraphFormat.listFormat.listLevelNumber);\n        }\n        if (isNullOrUndefined(list) || (!isNullOrUndefined(list) && ((startListLevel.listLevelPattern !== listLevelPattern) ||\n            startListLevel.numberFormat !== format || (startListLevel.characterFormat.fontFamily !== fontFamily\n            && startListLevel.listLevelPattern === 'Bullet')))) {\n            isUpdate = false;\n            list = new WList();\n            if (this.viewer.lists.length > 0) {\n                list.listId = this.viewer.lists[this.viewer.lists.length - 1].listId + 1;\n            }\n            else {\n                list.listId = 0;\n            }\n            var abstractList = new WAbstractList();\n            if (this.viewer.abstractLists.length > 0) {\n                abstractList.abstractListId = this.viewer.abstractLists[this.viewer.abstractLists.length - 1].abstractListId + 1;\n            }\n            else {\n                abstractList.abstractListId = 0;\n            }\n            list.abstractListId = abstractList.abstractListId;\n            list.abstractList = abstractList;\n            this.viewer.abstractLists.push(abstractList);\n            if (format === 'bullet' || format === 'multiLevel' || format === 'numbering') {\n                this.addListLevels(abstractList, format, selection);\n            }\n            else {\n                var listLevel = new WListLevel(abstractList);\n                listLevel.listLevelPattern = listLevelPattern;\n                listLevel.numberFormat = format;\n                if (listLevelPattern !== 'Bullet') {\n                    listLevel.startAt = 1;\n                }\n                else {\n                    listLevel.characterFormat.fontFamily = fontFamily;\n                }\n                listLevel.paragraphFormat.leftIndent = 36;\n                listLevel.paragraphFormat.firstLineIndent = -18;\n                abstractList.levels.push(listLevel);\n                selection.paragraphFormat.listLevelNumber = 0;\n            }\n            selection.paragraphFormat.setList(list);\n        }\n        else if (!isNullOrUndefined(list) && isUpdate) {\n            selection.paragraphFormat.setList(list);\n        }\n        else {\n            selection.paragraphFormat.setList(undefined);\n        }\n    };\n    Editor.prototype.addListLevels = function (abstractListAdv, listName, selection) {\n        var bulletCharacters = ['\\uf076', '\\uf0d8', '\\uf0a7', '\\uf0b7', '\\uf0a8'];\n        for (var i = abstractListAdv.levels.length; i < 9; i++) {\n            var listLevel = new WListLevel(abstractListAdv);\n            if (listName.match('bullet')) {\n                listLevel.listLevelPattern = 'Bullet';\n                listLevel.numberFormat = bulletCharacters[i < 5 ? i % 5 : i % 5 + 1];\n                listLevel.characterFormat.fontFamily = i < 3 || i === 5 ? 'Wingdings' : 'Symbol';\n            }\n            else {\n                if (listName.match('multiLevel')) {\n                    for (var j = 0; j < i + 1; j++) {\n                        listLevel.numberFormat += '%' + (j + 1).toString() + '.';\n                    }\n                    listLevel.listLevelPattern = 'Number';\n                }\n                else {\n                    listLevel.numberFormat = '%' + (i + 1).toString() + ')';\n                    listLevel.listLevelPattern = i % 3 === 0 ? 'Number'\n                        : i % 3 === 1 ? 'LowLetter' : 'LowRoman';\n                }\n                listLevel.startAt = 1;\n                listLevel.restartLevel = i;\n            }\n            if (i === 0) {\n                listLevel.paragraphFormat.leftIndent = 36;\n            }\n            else {\n                listLevel.paragraphFormat.leftIndent = 36 * i;\n            }\n            listLevel.paragraphFormat.firstLineIndent = -18;\n            abstractListAdv.levels.push(listLevel);\n            selection.paragraphFormat.listLevelNumber = i;\n        }\n    };\n    /**\n     * Insert page break at cursor position\n     */\n    Editor.prototype.insertPageBreak = function () {\n        if (!this.owner.isReadOnlyMode) {\n            if (this.viewer.selection.start.paragraph.isInsideTable ||\n                this.viewer.selection.start.paragraph.isInHeaderFooter) {\n                return;\n            }\n            this.initComplexHistory('PageBreak');\n            this.onEnter(true);\n            if (this.editorHistory && this.editorHistory.currentHistoryInfo != null) {\n                this.editorHistory.updateComplexHistory();\n            }\n            this.selection.checkForCursorVisibility();\n        }\n    };\n    /**\n     * @private\n     */\n    Editor.prototype.onEnter = function (isInsertPageBreak) {\n        var selection = this.viewer.selection;\n        if (selection.isEmpty) {\n            //ToDo: Need to handle the CTRL + Enter (Page Break) and SHIFT + Enter (Line Break) behavior.\n            var hyperlinkField = selection.getHyperlinkField();\n            var isSelectionOnHyperlink = !isNullOrUndefined(hyperlinkField);\n            if (isSelectionOnHyperlink) {\n                selection.fireRequestNavigate(hyperlinkField);\n                return;\n            }\n            var paragraph = selection.start.paragraph;\n            if (paragraph.isEmpty() && paragraph.paragraphFormat.listFormat.listId !== -1) {\n                // tslint:disable-next-line:max-line-length\n                this.onApplyListInternal(this.viewer.getListById(paragraph.paragraphFormat.listFormat.listId), paragraph.paragraphFormat.listFormat.listLevelNumber - 1);\n                return;\n            }\n        }\n        this.initHistory('Enter');\n        var isRemoved = true;\n        if (!selection.isEmpty) {\n            // this.initHistoryWithSelection(selection, 'Enter');\n            isRemoved = this.removeSelectedContents(selection);\n        }\n        if (isRemoved) {\n            selection.owner.isShiftingEnabled = true;\n            this.updateInsertPosition();\n            var blockInfo = this.getParagraphInfo(selection.start);\n            var initialStart = this.getHierarchicalIndex(blockInfo.paragraph, blockInfo.offset.toString());\n            this.splitParagraphInternal(selection, selection.start.paragraph, selection.start.currentWidget, selection.start.offset);\n            this.setPositionForCurrentIndex(selection.start, initialStart);\n            if (isInsertPageBreak) {\n                var currentParagraph = selection.start.paragraph;\n                var breakParagraph = new ParagraphWidget();\n                breakParagraph.characterFormat.copyFormat(currentParagraph.characterFormat);\n                breakParagraph.paragraphFormat.copyFormat(currentParagraph.paragraphFormat);\n                var pageBreak = new TextElementBox();\n                pageBreak.text = '\\f';\n                var line = new LineWidget(breakParagraph);\n                line.children.push(pageBreak);\n                pageBreak.line = line;\n                breakParagraph.childWidgets.push(line);\n                this.insertParagraph(breakParagraph, true);\n                selection.selectParagraph(breakParagraph, true);\n            }\n            var nextNode = selection.start.paragraph.nextWidget;\n            if (isNullOrUndefined(nextNode)) {\n                nextNode = selection.getNextRenderedBlock(selection.start.paragraph);\n            }\n            selection.selectParagraph(nextNode, true);\n            this.updateEndPosition();\n            if (isInsertPageBreak && this.editorHistory) {\n                this.owner.editorHistory.updateHistory();\n            }\n            // if (!isNullOrUndefined(selection.currentHistoryInfo)) {\n            //     this.updateComplexHistory();\n            // } else {\n            this.reLayout(selection);\n            // }\n            var paragraph = selection.start.paragraph.previousWidget;\n            if (!isNullOrUndefined(paragraph) && !paragraph.isEmpty() &&\n                // tslint:disable-next-line:max-line-length\n                paragraph.lastChild.children[paragraph.lastChild.children.length - 1] instanceof TextElementBox) {\n                this.checkAndConvertToHyperlink(selection, true, paragraph);\n            }\n        }\n    };\n    Editor.prototype.splitParagraphInternal = function (selection, paragraphAdv, currentLine, offset) {\n        var insertIndex = 0;\n        var blockIndex = paragraphAdv.index;\n        var paragraph = new ParagraphWidget();\n        var lineWidget = new LineWidget(paragraph);\n        paragraph.childWidgets.push(lineWidget);\n        //Copies the format to new paragraph.\n        paragraph.paragraphFormat.ownerBase = paragraph;\n        if (currentLine === paragraphAdv.lastChild && offset === selection.getLineLength(currentLine)) {\n            // tslint:disable-next-line:max-line-length\n            if (paragraphAdv.paragraphFormat.baseStyle\n                && paragraphAdv.paragraphFormat.baseStyle.name !== 'Normal' && paragraphAdv.paragraphFormat.baseStyle.next instanceof WParagraphStyle) {\n                if (paragraphAdv.paragraphFormat.baseStyle.name === paragraphAdv.paragraphFormat.baseStyle.next.name) {\n                    paragraph.paragraphFormat.copyFormat(paragraphAdv.paragraphFormat);\n                    paragraph.characterFormat.copyFormat(paragraphAdv.characterFormat);\n                }\n                else {\n                    paragraph.paragraphFormat.baseStyle = paragraphAdv.paragraphFormat.baseStyle.next;\n                }\n                this.selection.skipFormatRetrieval = false;\n            }\n            else {\n                paragraph.paragraphFormat.copyFormat(paragraphAdv.paragraphFormat);\n                paragraph.characterFormat.copyFormat(paragraphAdv.characterFormat);\n            }\n            //ToDo in future: Need to skip copying formattings to new paragraph, if the style for following paragraph is same style.\n            insertIndex++;\n            blockIndex++;\n        }\n        else {\n            paragraph.paragraphFormat.copyFormat(paragraphAdv.paragraphFormat);\n            paragraph.characterFormat.copyFormat(paragraphAdv.characterFormat);\n            if (offset > 0 || !currentLine.isFirstLine()) {\n                paragraphAdv = paragraphAdv.combineWidget(this.viewer);\n                this.moveInlines(paragraphAdv, paragraph, 0, 0, paragraphAdv.firstChild, offset, currentLine);\n            }\n            paragraphAdv = paragraphAdv.getSplitWidgets()[0];\n        }\n        insertIndex += paragraphAdv.getIndex();\n        var container = paragraphAdv.containerWidget;\n        var childNodes = container.childWidgets;\n        childNodes.splice(insertIndex, 0, paragraph);\n        paragraph.containerWidget = container;\n        paragraph.index = blockIndex;\n        this.updateNextBlocksIndex(paragraph, true);\n        // tslint:disable-next-line:max-line-length\n        this.viewer.layout.layoutBodyWidgetCollection(blockIndex, container, paragraph, false);\n    };\n    /**\n     * @private\n     */\n    Editor.prototype.updateNextBlocksIndex = function (block, increaseIndex) {\n        var nextIndex = block.containerWidget.childWidgets.indexOf(block) + 1;\n        if (block.containerWidget instanceof BodyWidget) {\n            var currentSectionIndex = block.containerWidget.index;\n            for (var j = this.viewer.pages.indexOf(block.containerWidget.page); j < this.viewer.pages.length; j++) {\n                var page = this.viewer.pages[j];\n                if (page.bodyWidgets[0].index === currentSectionIndex) {\n                    for (var k = nextIndex; k < page.bodyWidgets[0].childWidgets.length; k++) {\n                        var childWidget = page.bodyWidgets[0].childWidgets[k];\n                        this.updateIndex(childWidget, increaseIndex);\n                    }\n                    nextIndex = 0;\n                }\n                else {\n                    return;\n                }\n            }\n        }\n        else if (block.containerWidget instanceof TableCellWidget) {\n            var cells = block.containerWidget.getSplitWidgets();\n            var currentCellIndex = cells.indexOf(block.containerWidget);\n            for (var x = currentCellIndex; x < cells.length; x++) {\n                var blocks = cells[x].childWidgets;\n                for (var y = nextIndex; y < blocks.length; y++) {\n                    this.updateIndex(blocks[y], increaseIndex);\n                }\n                currentCellIndex = 0;\n                nextIndex = 0;\n            }\n        }\n        else if (block.containerWidget instanceof TableRowWidget) {\n            for (var i = nextIndex; i < block.containerWidget.childWidgets.length; i++) {\n                var cell = block.containerWidget.childWidgets[i];\n                if (cell.rowIndex === block.containerWidget.index) {\n                    this.updateIndex(cell, increaseIndex);\n                }\n            }\n        }\n        else if (block.containerWidget instanceof TableWidget) {\n            for (var i = nextIndex; i < block.containerWidget.childWidgets.length; i++) {\n                var row = block.containerWidget.childWidgets[i];\n                this.updateIndex(row, increaseIndex);\n                for (var j = 0; j < row.childWidgets.length; j++) {\n                    row.childWidgets[j].rowIndex = row.index;\n                }\n            }\n            //update Row index of all the cell\n        }\n        else if (block.containerWidget instanceof HeaderFooterWidget) {\n            for (var i = nextIndex; i < block.containerWidget.childWidgets.length; i++) {\n                var nextBlock = block.containerWidget.childWidgets[i];\n                this.updateIndex(nextBlock, increaseIndex);\n            }\n        }\n    };\n    Editor.prototype.updateIndex = function (widget, increment) {\n        if (increment) {\n            widget.index++;\n        }\n        else {\n            widget.index--;\n        }\n    };\n    Editor.prototype.updateEndPosition = function () {\n        var selection = this.viewer.selection;\n        if (this.editorHistory && !isNullOrUndefined(this.editorHistory.currentBaseHistoryInfo)) {\n            this.updateHistoryPosition(selection.start, false);\n        }\n    };\n    /**\n     * @private\n     */\n    Editor.prototype.onBackSpace = function () {\n        var selection = this.viewer.selection;\n        if (selection.isEmpty) {\n            this.singleBackspace(selection, false);\n        }\n        else {\n            this.initHistory('BackSpace');\n            var skipBackSpace = this.deleteSelectedContents(selection, true);\n            if (this.editorHistory && this.editorHistory.currentBaseHistoryInfo) {\n                if (skipBackSpace) {\n                    this.editorHistory.currentBaseHistoryInfo = undefined;\n                }\n                else {\n                    if (this.checkEndPosition(selection)) {\n                        this.updateHistoryPosition(selection.end, false);\n                    }\n                    this.reLayout(selection);\n                }\n            }\n        }\n    };\n    /**\n     * @private\n     */\n    Editor.prototype.insertRemoveBookMarkElements = function () {\n        var isHandledComplexHistory = false;\n        for (var i = 0; i < this.removedBookmarkElements.length; i++) {\n            var bookMark = this.removedBookmarkElements[i];\n            if (bookMark.bookmarkType === 0) {\n                var bookMarkStart = bookMark;\n                if (bookMarkStart && bookMarkStart.reference && this.removedBookmarkElements.indexOf(bookMarkStart.reference) !== -1) {\n                    var endIndex = this.removedBookmarkElements.indexOf(bookMarkStart.reference);\n                    var startIndex = this.removedBookmarkElements.indexOf(bookMarkStart);\n                    this.removedBookmarkElements.splice(endIndex, 1);\n                    this.removedBookmarkElements.splice(startIndex, 1);\n                }\n                else {\n                    this.initComplexHistory(this.editorHistory.currentBaseHistoryInfo.action);\n                    this.editorHistory.updateHistory();\n                    this.initInsertInline(bookMarkStart.clone());\n                    this.editorHistory.updateComplexHistory();\n                    isHandledComplexHistory = true;\n                }\n            }\n            else {\n                var bookMarkEnd = bookMark;\n                if (bookMarkEnd && bookMarkEnd.reference && this.removedBookmarkElements.indexOf(bookMarkEnd.reference) !== -1) {\n                    var endIndex = this.removedBookmarkElements.indexOf(bookMarkEnd.reference);\n                    var startIndex = this.removedBookmarkElements.indexOf(bookMarkEnd);\n                    this.removedBookmarkElements.splice(endIndex, 1);\n                    this.removedBookmarkElements.splice(startIndex, 1);\n                }\n                else {\n                    this.initComplexHistory(this.editorHistory.currentBaseHistoryInfo.action);\n                    this.editorHistory.updateHistory();\n                    this.initInsertInline(bookMarkEnd.clone());\n                    this.editorHistory.updateComplexHistory();\n                    isHandledComplexHistory = true;\n                }\n            }\n        }\n        this.removedBookmarkElements = [];\n        return isHandledComplexHistory;\n    };\n    /**\n     * @private\n     */\n    Editor.prototype.deleteSelectedContents = function (selection, isBackSpace) {\n        var skipBackSpace = this.deleteSelectedContentInternal(selection, isBackSpace, selection.start, selection.end);\n        var textPosition = new TextPosition(selection.owner);\n        var blockInfo = this.getParagraph({ index: selection.editPosition });\n        var lineInfo = this.getLineInfo(blockInfo.paragraph, blockInfo.offset);\n        textPosition.setPositionForLineWidget(lineInfo.line, lineInfo.offset);\n        selection.selectContent(textPosition, true);\n        return skipBackSpace;\n    };\n    /**\n     * @private\n     */\n    Editor.prototype.singleBackspace = function (selection, isRedoing) {\n        var history = this.editorHistory;\n        // If backspace is pressed after auto format to hyperlink is done, need to undo auto format.\n        if (history && !isRedoing && !history.canRedo() && history.canUndo()) {\n            var historyInfo = history.undoStack[history.undoStack.length - 1];\n            var startBlockInfo = this.getParagraphInfo(selection.start);\n            var endBlockInfo = this.getParagraphInfo(selection.end);\n            // tslint:disable-next-line:max-line-length\n            if (historyInfo.action === 'AutoFormatHyperlink' && historyInfo.insertPosition === this.getHierarchicalIndex(startBlockInfo.paragraph, startBlockInfo.offset.toString()) &&\n                historyInfo.endPosition === this.getHierarchicalIndex(endBlockInfo.paragraph, endBlockInfo.offset.toString())) {\n                history.undo();\n                return;\n            }\n        }\n        var paragraph = selection.start.paragraph;\n        var currentLineWidget = selection.start.currentWidget;\n        var offset = selection.start.offset;\n        var indexInInline = 0;\n        var inlineObj = currentLineWidget.getInline(offset, indexInInline);\n        var inline = inlineObj.element;\n        indexInInline = inlineObj.index;\n        var previousInline = inline;\n        if (inline instanceof FieldElementBox && inline.fieldType === 2) {\n            if (HelperMethods.isLinkedFieldCharacter(inline)) {\n                var begin = inline.fieldBegin;\n                var end = inline.fieldEnd;\n                selection.start.setPositionParagraph(begin.line, begin.line.getOffset(begin, 0));\n                selection.end.setPositionParagraph(end.line, end.line.getOffset(end, 0) + 1);\n                selection.fireSelectionChanged(true);\n                return;\n            }\n        }\n        if (inline instanceof FieldElementBox && inline.fieldType === 1) {\n            var prevInline = selection.getPreviousValidElement(inline);\n            if (prevInline instanceof FieldElementBox) {\n                inline = prevInline.fieldBegin;\n                paragraph = inline.line.paragraph;\n                offset = inline.line.getOffset(inline, 0);\n                selection.end.setPositionParagraph(inline.line, offset); //Selects the entire field.\n                selection.fireSelectionChanged(true);\n                return;\n            }\n            else if (prevInline !== inline) {\n                inline = prevInline; //Updates the offset to delete next content.\n                paragraph = inline.line.paragraph;\n                offset = inline.line.getOffset(inline, inline.length);\n            }\n        }\n        if (inline && (inline instanceof BookmarkElementBox && inline.bookmarkType === 1\n            || inline.previousNode instanceof BookmarkElementBox)) {\n            if (inline instanceof BookmarkElementBox) {\n                inline = inline.previousNode;\n                paragraph = inline.line.paragraph;\n                offset = inline.line.getOffset(inline, inline.length);\n            }\n            if (inline.length === 1 && inline.nextNode instanceof BookmarkElementBox && inline.previousNode instanceof BookmarkElementBox) {\n                var begin = inline.previousNode;\n                var end = inline.nextNode;\n                selection.start.setPositionParagraph(begin.line, begin.line.getOffset(begin, 0));\n                selection.end.setPositionParagraph(end.line, end.line.getOffset(end, 0) + 1);\n                this.initHistory('BackSpace');\n                this.deleteSelectedContents(selection, true);\n                if (this.checkEndPosition(selection)) {\n                    this.updateHistoryPosition(selection.end, false);\n                }\n                this.reLayout(selection);\n                return;\n            }\n        }\n        if (!isRedoing) {\n            this.initHistory('BackSpace');\n        }\n        if (offset === selection.getStartOffset(paragraph) && selection.start.currentWidget.isFirstLine()) {\n            if (paragraph.paragraphFormat.listFormat && paragraph.paragraphFormat.listFormat.listId !== -1) {\n                this.onApplyList(undefined);\n                return;\n            }\n            if (paragraph.paragraphFormat.firstLineIndent !== 0) {\n                this.onApplyParagraphFormat('firstLineIndent', 0, false, false);\n                return;\n            }\n            if (paragraph.paragraphFormat.leftIndent !== 0) {\n                this.onApplyParagraphFormat('leftIndent', 0, false, false);\n                return;\n            }\n            if (paragraph.paragraphFormat.textAlignment !== 'Left') {\n                this.onApplyParagraphFormat('textAlignment', 'Left', false, true);\n                return;\n            }\n            if (paragraph.previousRenderedWidget instanceof ParagraphWidget) {\n                selection.owner.isShiftingEnabled = true;\n                var previousParagraph = paragraph.previousRenderedWidget;\n                // if (isNullOrUndefined(previousParagraph)) {\n                //     previousParagraph = this.viewer.selection.getPreviousBlock(paragraph) as ParagraphWidget;\n                // }\n                if (previousParagraph.isEmpty()) {\n                    this.removeBlock(previousParagraph);\n                    this.addRemovedNodes(previousParagraph);\n                }\n                else {\n                    this.removeBlock(paragraph);\n                    var endOffset = this.viewer.selection.getLineLength(previousParagraph.lastChild);\n                    var previousIndex = previousParagraph.childWidgets.length - 1;\n                    var lineWidget = void 0;\n                    if (!paragraph.isEmpty()) {\n                        for (var i = 0; i < paragraph.childWidgets.length; i++) {\n                            lineWidget = paragraph.childWidgets[i];\n                            previousParagraph.childWidgets.push(lineWidget);\n                            paragraph.childWidgets.splice(i, 1);\n                            i--;\n                            lineWidget.paragraph = previousParagraph;\n                        }\n                    }\n                    this.viewer.layout.reLayoutParagraph(previousParagraph, previousIndex, 0);\n                    selection.selects(previousParagraph.childWidgets[previousIndex], endOffset, true);\n                    this.addRemovedNodes(paragraph);\n                }\n                this.setPositionForHistory();\n                // if (!isRedoing) {\n                this.reLayout(selection);\n                // }\n            }\n            else {\n                if (this.editorHistory) {\n                    this.editorHistory.currentBaseHistoryInfo = undefined;\n                }\n            }\n        }\n        else {\n            if (!isRedoing) {\n                selection.owner.isShiftingEnabled = true;\n            }\n            var paragraphInfo = this.getParagraphInfo(selection.start);\n            var lineWidget = selection.start.currentWidget;\n            var removeOffset = offset - 1;\n            if (removeOffset < 0) {\n                lineWidget = lineWidget.previousLine;\n                removeOffset = this.viewer.selection.getLineLength(lineWidget) + removeOffset;\n            }\n            this.removeAtOffset(lineWidget, selection, removeOffset);\n            this.setPositionParagraph(paragraphInfo.paragraph, paragraphInfo.offset - 1, false);\n            this.setPositionForHistory();\n            if (!isRedoing) {\n                this.reLayout(selection);\n            }\n            else {\n                this.fireContentChange();\n            }\n        }\n    };\n    Editor.prototype.setPositionForHistory = function (editPosition) {\n        var selection = this.viewer.selection;\n        if (this.editorHistory && !isNullOrUndefined(this.editorHistory.currentBaseHistoryInfo)) {\n            if (isNullOrUndefined(editPosition)) {\n                this.updateHistoryPosition(selection.start, true);\n                this.editorHistory.currentBaseHistoryInfo.endPosition = this.editorHistory.currentBaseHistoryInfo.insertPosition;\n            }\n            else {\n                this.editorHistory.currentBaseHistoryInfo.insertPosition = editPosition;\n                this.editorHistory.currentBaseHistoryInfo.endPosition = editPosition;\n            }\n        }\n    };\n    Editor.prototype.removeAtOffset = function (lineWidget, selection, offset) {\n        var count = 0;\n        var lineIndex = lineWidget.paragraph.childWidgets.indexOf(lineWidget);\n        for (var i = 0; i < lineWidget.children.length; i++) {\n            var inline = lineWidget.children[i];\n            if (inline instanceof ListTextElementBox) {\n                continue;\n            }\n            if (offset < count + inline.length) {\n                var indexInInline = offset - count;\n                if (offset === count && inline.length === 1) {\n                    this.unLinkFieldCharacter(inline);\n                    lineWidget.children.splice(i, 1);\n                    this.viewer.layout.reLayoutParagraph(lineWidget.paragraph, lineIndex, i);\n                    this.addRemovedNodes(inline);\n                }\n                else {\n                    var span = new TextElementBox();\n                    span.characterFormat.copyFormat(inline.characterFormat);\n                    span.text = inline.text.substr(indexInInline, 1);\n                    inline.text = HelperMethods.remove(inline.text, indexInInline, 1);\n                    this.viewer.layout.reLayoutParagraph(lineWidget.paragraph, lineIndex, i);\n                    this.addRemovedNodes(span);\n                }\n                break;\n            }\n            count += inline.length;\n        }\n    };\n    /**\n     * @private\n     */\n    Editor.prototype.onDelete = function () {\n        var selection = this.viewer.selection;\n        if (selection.isEmpty) {\n            this.singleDelete(selection, false);\n        }\n        else {\n            // this.initComplexHistory('MultiSelection');\n            // for (let i: number = 0; i < selection.selectionRanges.length; i++) {\n            // let selectionRange: SelectionRange = selection.selectionRanges.getRange(i);\n            this.initHistory('Delete');\n            this.deleteSelectedContentInternal(selection, false, selection.start, selection.end);\n            var textPosition = new TextPosition(selection.owner);\n            this.setPositionForCurrentIndex(textPosition, selection.editPosition);\n            selection.selectContent(textPosition, true);\n            // if (this.viewer.owner.enableEditorHistory) {\n            this.reLayout(selection);\n            // }\n            // this.updateSelectionRangeOffSet(selection.start, selection.end);\n            // }\n            // let textPosition: TextPosition = new TextPosition(selection.owner, this.viewer);\n            // this.setPositionForCurrentIndex(textPosition,selection.editPosition);\n            // selection.selectContent(textPosition, true);\n            // if (!isNullOrUndefined(selection.currentHistoryInfo)) {\n            //     this.updateComplexHistory();\n            // } else {\n            //     this.updateComplexWithoutHistory();\n            // }\n        }\n    };\n    /**\n     * Remove single character on right of cursor position\n     * @param  {Selection} selection\n     * @param  {boolean} isRedoing\n     * @private\n     */\n    Editor.prototype.singleDelete = function (selection, isRedoing) {\n        // tslint:disable-next-line:max-line-length\n        var paragraph = selection.start.paragraph;\n        var offset = selection.start.offset;\n        var indexInInline = 0;\n        var inlineObj = paragraph.getInline(selection.start.offset, indexInInline);\n        var inline = inlineObj.element;\n        indexInInline = inlineObj.index;\n        if (paragraph.paragraphFormat.listFormat && paragraph.paragraphFormat.listFormat.listId !== -1 &&\n            this.viewer.isListTextSelected && selection.contextType === 'List') {\n            this.onApplyList(undefined);\n            return;\n        }\n        if (!isNullOrUndefined(inline) && indexInInline === inline.length && !isNullOrUndefined(inline.nextNode)) {\n            inline = inline.nextNode;\n            indexInInline = 0;\n        }\n        if (!isNullOrUndefined(inline)) {\n            var nextRenderedInline = undefined;\n            var nextInline = selection.getNextValidElement(inline);\n            if (nextInline instanceof ElementBox) {\n                nextRenderedInline = nextInline;\n            }\n            if (!isNullOrUndefined(nextRenderedInline) && nextRenderedInline instanceof FieldElementBox\n                && nextRenderedInline.fieldType === 0) {\n                inline = nextRenderedInline.fieldEnd;\n                paragraph = inline.line.paragraph;\n                offset = inline.line.getOffset(inline, 1);\n                selection.end.setPositionParagraph(inline.line, offset);\n                selection.fireSelectionChanged(true);\n                return;\n            }\n            else if (inline !== nextRenderedInline) {\n                inline = nextRenderedInline;\n                paragraph = inline.line.paragraph;\n                offset = inline.line.getOffset(inline, 0);\n                if (inline instanceof FieldElementBox && inline.fieldType === 1) {\n                    offset++;\n                }\n            }\n        }\n        if (inline && (inline instanceof BookmarkElementBox && inline.bookmarkType === 0\n            || inline.nextNode instanceof BookmarkElementBox)) {\n            if (inline instanceof BookmarkElementBox) {\n                inline = inline.nextNode;\n                paragraph = inline.line.paragraph;\n                offset = inline.line.getOffset(inline, 0);\n            }\n            if (inline.length === 1 && inline.nextNode instanceof BookmarkElementBox\n                && inline.previousNode instanceof BookmarkElementBox) {\n                var bookMarkBegin = inline.previousNode;\n                var bookMarkEnd = inline.nextNode;\n                selection.start.setPositionParagraph(bookMarkBegin.line, bookMarkBegin.line.getOffset(bookMarkBegin, 0));\n                selection.end.setPositionParagraph(bookMarkEnd.line, bookMarkEnd.line.getOffset(bookMarkEnd, 0) + 1);\n                this.initHistory('Delete');\n                this.deleteSelectedContentInternal(selection, false, selection.start, selection.end);\n                var textPosition = new TextPosition(selection.owner);\n                this.setPositionForCurrentIndex(textPosition, selection.editPosition);\n                selection.selectContent(textPosition, true);\n                this.reLayout(selection);\n                return;\n            }\n        }\n        if (selection.start.currentWidget.isLastLine() && offset === this.viewer.selection.getLineLength(selection.start.currentWidget)) {\n            if (paragraph.isInsideTable && isNullOrUndefined(paragraph.nextWidget)) {\n                return;\n            }\n            var previousParagraph = undefined;\n            var newParagraph = undefined;\n            var nextParagraph = selection.getNextParagraphBlock(paragraph);\n            if (isNullOrUndefined(nextParagraph)) {\n                if (offset > 0) {\n                    return;\n                }\n                else {\n                    if (paragraph.previousWidget instanceof ParagraphWidget) {\n                        previousParagraph = paragraph.previousWidget;\n                    }\n                    if (paragraph.previousWidget instanceof TableWidget) {\n                        return;\n                    }\n                    if (isNullOrUndefined(previousParagraph)) {\n                        return;\n                        //Adds an empty paragraph, to ensure minimal content.\n                    }\n                }\n            }\n            if (!isRedoing) {\n                this.initHistory('Delete');\n            }\n            var blockInfo = this.getParagraphInfo(selection.start);\n            selection.editPosition = this.getHierarchicalIndex(blockInfo.paragraph, blockInfo.offset.toString());\n            if (this.checkInsertPosition(selection)) {\n                this.setPositionForHistory(selection.editPosition);\n            }\n            selection.owner.isShiftingEnabled = true;\n            if (paragraph.isEmpty()) {\n                this.removeBlock(paragraph);\n                this.addRemovedNodes(paragraph);\n                if (isNullOrUndefined(nextParagraph)) {\n                    if (isNullOrUndefined(previousParagraph)) {\n                        // selection.selectParagraph(newParagraph, true, true);\n                        var paraEndOffset = selection.getParagraphLength(newParagraph) + 1;\n                        if (this.editorHistory && !isNullOrUndefined(this.editorHistory.currentBaseHistoryInfo)) {\n                            this.updateHistoryPosition(selection.start, true);\n                            //tslint:disable-next-line:max-line-length\n                            this.editorHistory.currentBaseHistoryInfo.endPosition = this.getHierarchicalIndex(newParagraph, paraEndOffset.toString());\n                        }\n                    }\n                    else {\n                        selection.selectParagraph(previousParagraph, false);\n                        this.setPositionForHistory();\n                    }\n                }\n                else {\n                    selection.selectParagraph(nextParagraph, true);\n                }\n            }\n            else {\n                paragraph = paragraph.combineWidget(this.viewer);\n                // tslint:disable-next-line:max-line-length\n                var currentParagraph = this.splitParagraph(paragraph, paragraph.firstChild, 0, selection.start.currentWidget, selection.start.offset, true);\n                this.deleteParagraphMark(currentParagraph, selection, 0);\n                this.addRemovedNodes(paragraph);\n                this.setPositionForCurrentIndex(selection.start, selection.editPosition);\n                selection.selectContent(selection.start, true);\n            }\n            // if (!isRedoing) {\n            this.reLayout(selection);\n            // }\n        }\n        else {\n            this.singleDeleteInternal(selection, isRedoing, paragraph);\n        }\n    };\n    Editor.prototype.singleDeleteInternal = function (selection, isRedoing, paragraph) {\n        if (!isRedoing) {\n            selection.owner.isShiftingEnabled = true;\n            this.initHistory('Delete');\n        }\n        if (this.checkInsertPosition(selection)) {\n            this.updateHistoryPosition(selection.start, true);\n            this.editorHistory.currentBaseHistoryInfo.endPosition = this.editorHistory.currentBaseHistoryInfo.insertPosition;\n        }\n        var paragraphInfo = this.getParagraphInfo(selection.start);\n        var lineWidget = selection.start.currentWidget;\n        var removeOffset = selection.start.offset;\n        var lineLength = selection.getLineLength(selection.start.currentWidget);\n        if (removeOffset >= lineLength) {\n            lineWidget = lineWidget.nextLine;\n            removeOffset = removeOffset - lineLength;\n        }\n        this.removeAtOffset(lineWidget, selection, removeOffset);\n        this.setPositionParagraph(paragraphInfo.paragraph, paragraphInfo.offset, false);\n        if (!isRedoing) {\n            this.reLayout(selection);\n        }\n        else {\n            this.fireContentChange();\n        }\n    };\n    Editor.prototype.deleteParagraphMark = function (paragraph, selection, editAction) {\n        if (isNullOrUndefined(paragraph.containerWidget)) {\n            return;\n        }\n        paragraph = paragraph.combineWidget(this.viewer);\n        var nextParagraph = selection.getNextParagraphBlock(paragraph);\n        if (paragraph.isInsideTable && isNullOrUndefined(paragraph.nextWidget) || isNullOrUndefined(nextParagraph)) {\n            return;\n        }\n        //BodyWidget\n        var section = paragraph.containerWidget instanceof BodyWidget ? paragraph.containerWidget : undefined;\n        var table = undefined;\n        if (selection.getNextRenderedBlock(paragraph) instanceof TableWidget) {\n            table = selection.getNextRenderedBlock(paragraph);\n        }\n        else {\n            table = undefined;\n        }\n        if (nextParagraph.isInsideTable && !isNullOrUndefined(table) && table.contains(nextParagraph.associatedCell)) {\n            if (editAction < 4) {\n                // let nextSection: BodyWidget = table.containerWidget instanceof BodyWidget ? table.containerWidget : undefined;\n                // if (section !== nextSection) {\n                //     this.combineSection(section, selection, nextSection);\n                // }\n                var offset = 0;\n                this.removeBlock(paragraph);\n                this.viewer.layout.clearListElementBox(nextParagraph);\n                this.viewer.layout.clearListElementBox(paragraph);\n                for (var i = paragraph.childWidgets.length - 1; i >= 0; i--) {\n                    var line = paragraph.childWidgets[i];\n                    for (var j = line.children.length - 1; j >= 0; j--) {\n                        var element = line.children[j];\n                        offset += element.length;\n                        nextParagraph.firstChild.children.unshift(element);\n                        element.line = nextParagraph.firstChild;\n                        // this.layoutInlineCollection(false, 0, nextParagraph.inlines, inline);\n                    }\n                }\n                this.viewer.layout.reLayoutParagraph(nextParagraph, 0, 0);\n                if (offset > 0) {\n                    selection.editPosition = this.getHierarchicalIndex(nextParagraph, offset.toString());\n                }\n            }\n        }\n        else {\n            if (editAction < 4) {\n                // let nextSection: WSection = nextParagraph.section instanceof WSection ? nextParagraph.section as WSection : undefined;\n                // if (section !== nextSection) {\n                //     this.combineSection(section, selection, nextSection);\n                // }\n                var prevLength = paragraph.childWidgets.length - 1;\n                var nextPara = nextParagraph.getSplitWidgets();\n                nextParagraph = nextParagraph.combineWidget(this.viewer);\n                this.viewer.layout.clearListElementBox(nextParagraph);\n                this.viewer.layout.clearListElementBox(paragraph);\n                this.updateEditPositionOnMerge(paragraph, nextParagraph);\n                for (var i = 0; i < nextParagraph.childWidgets.length; i++) {\n                    var inline = nextParagraph.childWidgets[i];\n                    nextParagraph.childWidgets.splice(i, 1);\n                    paragraph.childWidgets.push(inline);\n                    inline.paragraph = paragraph;\n                    i--;\n                }\n                if (nextParagraph.childWidgets.length === 0) {\n                    nextParagraph.childWidgets.push(new LineWidget(nextParagraph));\n                }\n                this.removeBlock(nextParagraph);\n                this.viewer.layout.reLayoutParagraph(paragraph, 0, 0);\n                this.addRemovedNodes(nextParagraph);\n            }\n        }\n    };\n    Editor.prototype.updateEditPositionOnMerge = function (currentParagraph, nextParagraph) {\n        if (this.viewer.selection.editPosition === this.getHierarchicalIndex(nextParagraph, '0') &&\n            nextParagraph.nextRenderedWidget === undefined) {\n            // tslint:disable-next-line:max-line-length\n            this.viewer.selection.editPosition = this.getHierarchicalIndex(currentParagraph, this.viewer.selection.getLineLength(currentParagraph.lastChild).toString());\n        }\n    };\n    Editor.prototype.checkEndPosition = function (selection) {\n        return (this.editorHistory && !isNullOrUndefined(this.editorHistory.currentBaseHistoryInfo)\n            && isNullOrUndefined(this.editorHistory.currentBaseHistoryInfo.endPosition));\n    };\n    Editor.prototype.checkInsertPosition = function (selection) {\n        return (this.editorHistory && !isNullOrUndefined(this.editorHistory.currentBaseHistoryInfo)\n            && isNullOrUndefined(this.editorHistory.currentBaseHistoryInfo.insertPosition));\n    };\n    Editor.prototype.checkIsNotRedoing = function () {\n        return this.viewer.owner.enableHistoryMode && !this.editorHistory.isRedoing;\n    };\n    // tslint:disable-next-line:max-line-length\n    Editor.prototype.deleteSelectedContentInternal = function (selection, isBackSpace, startPosition, endPosition) {\n        var startPos = startPosition;\n        var endPos = endPosition;\n        if (!startPosition.isExistBefore(endPosition)) {\n            startPos = endPosition;\n            endPos = startPosition;\n        }\n        var blockInfo = this.getParagraphInfo(startPos);\n        selection.editPosition = this.getHierarchicalIndex(blockInfo.paragraph, blockInfo.offset.toString());\n        var skipBackSpace = false;\n        if (isBackSpace && startPos.isInSameParagraph(endPos)) {\n            //Handled specifically to skip removal of contents, if selection is only paragraph mark and next rendered block is table.\n            if (startPos.offset < endPos.offset && startPos.offset === selection.getParagraphLength(endPos.paragraph)) {\n                var nextBlock = selection.getNextRenderedBlock(startPos.paragraph);\n                skipBackSpace = nextBlock instanceof TableWidget;\n            }\n            //Handled specifically to remove paragraph completely (Delete behavior), if the selected paragraph is empty.\n            if (endPos.offset === 1 && endPos.offset > selection.getParagraphLength(endPos.paragraph)\n                && !(endPos.paragraph.isInsideTable && isNullOrUndefined(endPos.paragraph.nextWidget))) {\n                isBackSpace = false;\n            }\n        }\n        if (!skipBackSpace) {\n            selection.owner.isShiftingEnabled = true;\n            if (this.checkInsertPosition(selection)) {\n                this.editorHistory.currentBaseHistoryInfo.insertPosition = selection.editPosition;\n            }\n            var editAction = (isBackSpace ? 1 : 0);\n            this.deleteSelectedContent(endPos.paragraph, selection, startPos, endPos, editAction);\n        }\n        return skipBackSpace;\n    };\n    /**\n     * Init EditorHistory\n     * @private\n     */\n    Editor.prototype.initHistory = function (action) {\n        if (this.viewer.owner.enableHistoryMode) {\n            this.editorHistory.initializeHistory(action);\n        }\n    };\n    /**\n     * Init Complex EditorHistory\n     * @private\n     */\n    Editor.prototype.initComplexHistory = function (action) {\n        if (this.viewer.owner.enableHistoryMode) {\n            this.editorHistory.initComplexHistory(this.viewer.selection, action);\n        }\n    };\n    //Insert Picture implementation starts\n    /**\n     * Insert image\n     * @param  {string} base64String\n     * @param  {number} width\n     * @param  {number} height\n     * @private\n     */\n    Editor.prototype.insertPicture = function (base64String, width, height) {\n        var imageElementBox = new ImageElementBox(true);\n        imageElementBox.imageString = base64String;\n        imageElementBox.width = width;\n        imageElementBox.height = height;\n        this.insertPictureInternal(imageElementBox);\n    };\n    Editor.prototype.insertPictureInternal = function (imageElementBox) {\n        var selection = this.viewer.selection;\n        this.initHistory('InsertInline');\n        this.fitImageToPage(selection, imageElementBox);\n        this.insertInlineInSelection(selection, imageElementBox);\n        this.reLayout(selection);\n    };\n    Editor.prototype.fitImageToPage = function (selection, imageElementBox) {\n        var section = selection.start.paragraph.bodyWidget;\n        var pageWidth = section.sectionFormat.pageWidth - section.sectionFormat.leftMargin - section.sectionFormat.rightMargin;\n        var pageHeight = section.sectionFormat.pageHeight - section.sectionFormat.topMargin - section.sectionFormat.topMargin;\n        //Resizes image to page size.\n        if (imageElementBox.width > pageWidth) {\n            imageElementBox.height = imageElementBox.height * pageWidth / imageElementBox.width;\n            imageElementBox.width = pageWidth;\n        }\n        if (imageElementBox.height > pageHeight) {\n            imageElementBox.width = imageElementBox.width * pageHeight / imageElementBox.height;\n            imageElementBox.height = pageHeight;\n        }\n    };\n    //Insert Picture implementation ends\n    /**\n     * @private\n     */\n    Editor.prototype.insertInlineInSelection = function (selection, elementBox) {\n        if (this.checkIsNotRedoing()) {\n            selection.owner.isShiftingEnabled = true;\n        }\n        if (!selection.isEmpty) {\n            this.removeSelectedContents(selection);\n        }\n        this.updateInsertPosition();\n        this.insertInlineInternal(elementBox);\n        if (this.checkEndPosition(selection)) {\n            this.updateHistoryPosition(selection.start, false);\n        }\n        this.fireContentChange();\n    };\n    /**\n     * @private\n     */\n    Editor.prototype.onPortrait = function () {\n        var sectionFormat = new WSectionFormat();\n        var width = this.viewer.selection.sectionFormat.pageWidth;\n        var height = this.viewer.selection.sectionFormat.pageHeight;\n        if (width > height) {\n            sectionFormat.pageWidth = height;\n            sectionFormat.pageHeight = width;\n        }\n        this.onApplySectionFormat(undefined, sectionFormat);\n    };\n    /**\n     * @private\n     */\n    Editor.prototype.onLandscape = function () {\n        var sectionFormat = new WSectionFormat();\n        var width = this.viewer.selection.sectionFormat.pageWidth;\n        var height = this.viewer.selection.sectionFormat.pageHeight;\n        if (width < height) {\n            sectionFormat.pageWidth = height;\n            sectionFormat.pageHeight = width;\n        }\n        this.onApplySectionFormat(undefined, sectionFormat);\n    };\n    Editor.prototype.copyValues = function () {\n        var format = new WSectionFormat();\n        format.bottomMargin = this.viewer.selection.sectionFormat.bottomMargin;\n        format.topMargin = this.viewer.selection.sectionFormat.topMargin;\n        format.leftMargin = this.viewer.selection.sectionFormat.leftMargin;\n        format.rightMargin = this.viewer.selection.sectionFormat.rightMargin;\n        format.pageHeight = this.viewer.selection.sectionFormat.pageHeight;\n        format.pageWidth = this.viewer.selection.sectionFormat.pageWidth;\n        format.footerDistance = this.viewer.selection.sectionFormat.footerDistance;\n        format.headerDistance = this.viewer.selection.sectionFormat.headerDistance;\n        return format;\n    };\n    /**\n     * @private\n     */\n    Editor.prototype.changeMarginValue = function (property) {\n        var sectionFormat = this.copyValues();\n        if (property === 'lastCustomSetting' || property === 'normal') {\n            sectionFormat.topMargin = 72;\n            sectionFormat.bottomMargin = 72;\n            sectionFormat.leftMargin = 72;\n            sectionFormat.rightMargin = 72;\n        }\n        else if (property === 'narrow') {\n            sectionFormat.topMargin = 36;\n            sectionFormat.bottomMargin = 36;\n            sectionFormat.leftMargin = 36;\n            sectionFormat.rightMargin = 36;\n        }\n        else if (property === 'moderate') {\n            sectionFormat.topMargin = 72;\n            sectionFormat.bottomMargin = 72;\n            sectionFormat.leftMargin = 54;\n            sectionFormat.rightMargin = 54;\n        }\n        else if (property === 'wide') {\n            sectionFormat.topMargin = 72;\n            sectionFormat.bottomMargin = 72;\n            sectionFormat.leftMargin = 144;\n            sectionFormat.rightMargin = 144;\n        }\n        else if (property === 'mirrored') {\n            sectionFormat.topMargin = 72;\n            sectionFormat.bottomMargin = 72;\n            sectionFormat.leftMargin = 90;\n            sectionFormat.rightMargin = 72;\n        }\n        else if (property === 'office2003Default') {\n            sectionFormat.topMargin = 72;\n            sectionFormat.bottomMargin = 72;\n            sectionFormat.leftMargin = 90;\n            sectionFormat.rightMargin = 90;\n        }\n        this.onApplySectionFormat(undefined, sectionFormat);\n    };\n    /**\n     * @private\n     */\n    Editor.prototype.onPaperSize = function (property) {\n        var sectionFormat = this.copyValues();\n        var width = this.viewer.selection.sectionFormat.pageWidth;\n        var height = this.viewer.selection.sectionFormat.pageHeight;\n        if (property === 'letter') {\n            if (width < height) {\n                sectionFormat.pageWidth = 611.9;\n                sectionFormat.pageHeight = 791.9;\n            }\n            else {\n                sectionFormat.pageWidth = 791.9;\n                sectionFormat.pageHeight = 611.9;\n            }\n        }\n        else if (property === 'tabloid') {\n            if (width < height) {\n                sectionFormat.pageWidth = 791.9;\n                sectionFormat.pageHeight = 1223.9;\n            }\n            else {\n                sectionFormat.pageWidth = 1223.9;\n                sectionFormat.pageHeight = 791.9;\n            }\n        }\n        else if (property === 'legal') {\n            if (width < height) {\n                sectionFormat.pageWidth = 611.9;\n                sectionFormat.pageHeight = 1007.9;\n            }\n            else {\n                sectionFormat.pageWidth = 1007.9;\n                sectionFormat.pageHeight = 611.9;\n            }\n        }\n        else if (property === 'statement') {\n            if (width < height) {\n                sectionFormat.pageWidth = 396;\n                sectionFormat.pageHeight = 611.9;\n            }\n            else {\n                sectionFormat.pageWidth = 611.9;\n                sectionFormat.pageHeight = 396;\n            }\n        }\n        else if (property === 'executive') {\n            if (width < height) {\n                sectionFormat.pageWidth = 521.9;\n                sectionFormat.pageHeight = 755.9;\n            }\n            else {\n                sectionFormat.pageWidth = 755.9;\n                sectionFormat.pageHeight = 521.9;\n            }\n        }\n        else if (property === 'a3') {\n            if (width < height) {\n                sectionFormat.pageWidth = 841.8;\n                sectionFormat.pageHeight = 1190.4;\n            }\n            else {\n                sectionFormat.pageWidth = 1190.4;\n                sectionFormat.pageHeight = 841.8;\n            }\n        }\n        else if (property === 'a4') {\n            if (width < height) {\n                sectionFormat.pageWidth = 595.2;\n                sectionFormat.pageHeight = 841.8;\n            }\n            else {\n                sectionFormat.pageWidth = 841.8;\n                sectionFormat.pageHeight = 595.2;\n            }\n        }\n        else if (property === 'a5') {\n            if (width < height) {\n                sectionFormat.pageWidth = 419.5;\n                sectionFormat.pageHeight = 595.2;\n            }\n            else {\n                sectionFormat.pageWidth = 595.2;\n                sectionFormat.pageHeight = 419.5;\n            }\n        }\n        else if (property === 'b4') {\n            if (width < height) {\n                sectionFormat.pageWidth = 728.4;\n                sectionFormat.pageHeight = 1031.7;\n            }\n            else {\n                sectionFormat.pageWidth = 1031.7;\n                sectionFormat.pageHeight = 728.4;\n            }\n        }\n        else if (property === 'b5') {\n            if (width < height) {\n                sectionFormat.pageWidth = 515.8;\n                sectionFormat.pageHeight = 728.4;\n            }\n            else {\n                sectionFormat.pageWidth = 728.4;\n                sectionFormat.pageHeight = 515.8;\n            }\n        }\n        this.onApplySectionFormat(undefined, sectionFormat);\n    };\n    //Update List Items\n    /**\n     * @private\n     */\n    Editor.prototype.updateListItemsTillEnd = function (blockAdv, updateNextBlockList) {\n        var block = updateNextBlockList ? this.viewer.selection.getNextRenderedBlock(blockAdv) : blockAdv;\n        while (!isNullOrUndefined(block)) {\n            //Updates the list value of the rendered paragraph. \n            this.updateRenderedListItems(block);\n            block = block.getSplitWidgets().pop().nextRenderedWidget;\n        }\n    };\n    /**\n     * @private\n     */\n    Editor.prototype.updateWholeListItems = function (block) {\n        this.viewer.renderedLists.clear();\n        var sectionIndex = block.bodyWidget.index;\n        var currentBlock;\n        for (var j = 0; j < this.viewer.pages.length; j++) {\n            var page = this.viewer.pages[j];\n            if (page.bodyWidgets[0].index === sectionIndex) {\n                currentBlock = page.bodyWidgets[0].firstChild;\n                break;\n            }\n        }\n        var isListUpdated = false;\n        do {\n            isListUpdated = this.updateListItems(currentBlock, block);\n            if (isListUpdated) {\n                break;\n            }\n            currentBlock = currentBlock.getSplitWidgets().pop().nextRenderedWidget;\n        } while (currentBlock);\n    };\n    Editor.prototype.updateListItems = function (blockAdv, block) {\n        var isListUpdated = false;\n        if (blockAdv instanceof ParagraphWidget) {\n            isListUpdated = this.updateListItemsForPara(blockAdv, block);\n        }\n        else {\n            isListUpdated = this.updateListItemsForTable(blockAdv, block);\n        }\n        return isListUpdated;\n    };\n    Editor.prototype.updateListItemsForTable = function (table, block) {\n        if (block instanceof TableWidget && table.equals(block)) {\n            return true;\n        }\n        var row = table.firstChild;\n        do {\n            var isListUpdated = this.updateListItemsForRow(row, block);\n            if (isListUpdated) {\n                return true;\n            }\n            row = row.getSplitWidgets().pop().nextRenderedWidget;\n        } while (row);\n        return false;\n    };\n    Editor.prototype.updateListItemsForRow = function (row, block) {\n        if (block.isInsideTable && row.childWidgets.indexOf(this.viewer.selection.getContainerCell(block.associatedCell)) !== -1) {\n            //Returns as list updated, inorder to start list numbering from first list paragraph of this row.\n            return true;\n        }\n        var cell = row.firstChild;\n        do {\n            this.updateListItemsForCell(cell, block);\n            cell = cell.nextRenderedWidget;\n        } while (cell);\n        return false;\n    };\n    Editor.prototype.updateListItemsForCell = function (cell, block) {\n        if (cell.childWidgets.length === 0) {\n            return;\n        }\n        var currentBlock = cell.firstChild;\n        do {\n            this.updateListItems(currentBlock, block);\n            currentBlock = currentBlock.getSplitWidgets().pop().nextRenderedWidget;\n        } while (currentBlock);\n    };\n    // public abstract updateListParagraphs(): void;\n    /**\n     * @private\n     */\n    Editor.prototype.updateRenderedListItems = function (block) {\n        if (block instanceof ParagraphWidget) {\n            this.updateRenderedListItemsForPara(block);\n        }\n        else {\n            this.updateRenderedListItemsForTable(block);\n        }\n    };\n    Editor.prototype.updateRenderedListItemsForTable = function (table) {\n        var row = table.firstChild;\n        do {\n            this.updateRenderedListItemsForRow(row);\n            row = row.getSplitWidgets().pop().nextRenderedWidget;\n        } while (row);\n    };\n    Editor.prototype.updateRenderedListItemsForRow = function (row) {\n        var cell = row.firstChild;\n        do {\n            this.updateRenderedListItemsForCell(cell);\n            cell = cell.nextRenderedWidget;\n        } while (cell);\n    };\n    Editor.prototype.updateRenderedListItemsForCell = function (cell) {\n        if (cell.childWidgets.length === 0) {\n            return;\n        }\n        var currentBlock = cell.firstChild;\n        do {\n            this.updateRenderedListItems(currentBlock);\n            currentBlock = currentBlock.getSplitWidgets().pop().nextRenderedWidget;\n        } while (currentBlock);\n    };\n    Editor.prototype.updateListItemsForPara = function (paragraph, block) {\n        if (paragraph.equals(block)) {\n            return true;\n        }\n        else {\n            var currentList = undefined;\n            var listLevelNumber = 0;\n            if (!isNullOrUndefined(paragraph.paragraphFormat) && !isNullOrUndefined(paragraph.paragraphFormat.listFormat)) {\n                currentList = this.viewer.getListById(paragraph.paragraphFormat.listFormat.listId);\n                listLevelNumber = paragraph.paragraphFormat.listFormat.listLevelNumber;\n            }\n            // tslint:disable-next-line:max-line-length\n            if (!isNullOrUndefined(currentList) && !isNullOrUndefined(this.viewer.getAbstractListById(currentList.abstractListId))\n                // tslint:disable-next-line:max-line-length\n                && !isNullOrUndefined(this.viewer.getAbstractListById(currentList.abstractListId).levels[listLevelNumber])) {\n                var currentListLevel = this.viewer.layout.getListLevel(currentList, listLevelNumber);\n                //Updates the list numbering from document start for reLayouting.\n                if (currentListLevel.listLevelPattern !== 'Bullet') {\n                    this.viewer.layout.getListNumber(paragraph.paragraphFormat.listFormat);\n                }\n            }\n        }\n        return false;\n    };\n    Editor.prototype.updateRenderedListItemsForPara = function (paragraph) {\n        if (!isNullOrUndefined(this.viewer.getListById(paragraph.paragraphFormat.listFormat.listId))) {\n            var currentList = this.viewer.getListById(paragraph.paragraphFormat.listFormat.listId);\n            var listLevelNumber = paragraph.paragraphFormat.listFormat.listLevelNumber;\n            if (!isNullOrUndefined(currentList) && !isNullOrUndefined(this.viewer.getAbstractListById(currentList.abstractListId))\n                // tslint:disable-next-line:max-line-length\n                && !isNullOrUndefined(this.viewer.getAbstractListById(currentList.abstractListId).levels[paragraph.paragraphFormat.listFormat.listLevelNumber])) {\n                var currentListLevel = this.viewer.layout.getListLevel(currentList, listLevelNumber);\n                //Updates the list numbering from document start for reLayouting.\n                if (currentListLevel.listLevelPattern !== 'Bullet') {\n                    var element = undefined;\n                    if (paragraph.childWidgets.length > 0) {\n                        var lineWidget = paragraph.childWidgets[0];\n                        if (lineWidget.children.length > 0) {\n                            element = lineWidget.children[0];\n                        }\n                    }\n                    if (!isNullOrUndefined(element)) {\n                        element.text = this.viewer.layout.getListNumber(paragraph.paragraphFormat.listFormat);\n                    }\n                }\n            }\n        }\n    };\n    /**\n     * Get logical offset of paragraph.\n     * @private\n     */\n    Editor.prototype.getParagraphInfo = function (position) {\n        return this.getParagraphInfoInternal(position.currentWidget, position.offset);\n    };\n    /**\n     * @private\n     */\n    Editor.prototype.getParagraphInfoInternal = function (line, lineOffset) {\n        var paragraph = line.paragraph;\n        var offset = this.selection.getParagraphLength(paragraph, line) + lineOffset;\n        var previous = paragraph.previousSplitWidget;\n        while (previous instanceof ParagraphWidget) {\n            paragraph = previous;\n            offset += this.viewer.selection.getParagraphLength(paragraph);\n            previous = paragraph.previousSplitWidget;\n        }\n        return { 'paragraph': paragraph, 'offset': offset };\n    };\n    /**\n     * Get offset value to update in selection\n     * @private\n     */\n    Editor.prototype.getOffsetValue = function (selection) {\n        if (this.startParagraph) {\n            var lineInfo = this.getLineInfo(this.startParagraph, this.startOffset);\n            selection.start.setPositionFromLine(lineInfo.line, lineInfo.offset);\n        }\n        selection.start.updatePhysicalPosition(true);\n        if (selection.isEmpty) {\n            selection.end.setPositionInternal(selection.start);\n        }\n        else {\n            if (this.endParagraph) {\n                var lineInfo = this.getLineInfo(this.endParagraph, this.endOffset);\n                selection.end.setPositionFromLine(lineInfo.line, lineInfo.offset);\n            }\n            selection.end.updatePhysicalPosition(true);\n        }\n    };\n    /**\n     * Get offset value to update in selection\n     * @private\n     */\n    Editor.prototype.getLineInfo = function (paragraph, offset) {\n        var position = undefined;\n        var element = undefined;\n        var length = this.selection.getParagraphLength(paragraph);\n        var next = paragraph.nextSplitWidget;\n        if (offset > length + 1 && isNullOrUndefined(next)) {\n            offset = length;\n        }\n        while (offset > length && next instanceof ParagraphWidget) {\n            offset -= length;\n            paragraph = next;\n            length = this.selection.getParagraphLength(paragraph);\n            next = paragraph.nextSplitWidget;\n        }\n        return this.selection.getLineInfo(paragraph, offset);\n    };\n    /**\n     * @private\n     */\n    Editor.prototype.setPositionParagraph = function (paragraph, offset, skipSelectionChange) {\n        var selection = this.viewer.selection;\n        var lineInfo = this.getLineInfo(paragraph, offset);\n        selection.start.setPositionFromLine(lineInfo.line, lineInfo.offset);\n        selection.end.setPositionInternal(selection.start);\n        if (!skipSelectionChange) {\n            selection.fireSelectionChanged(true);\n        }\n    };\n    /**\n     * @private\n     */\n    Editor.prototype.setPositionForCurrentIndex = function (textPosition, editPosition) {\n        var blockInfo = this.getParagraph({ index: editPosition });\n        var lineInfo = this.getLineInfo(blockInfo.paragraph, blockInfo.offset);\n        textPosition.setPositionForLineWidget(lineInfo.line, lineInfo.offset);\n    };\n    /**\n     * @private\n     */\n    Editor.prototype.insertPageNumber = function (numberFormat) {\n        if (isNullOrUndefined(numberFormat)) {\n            numberFormat = '';\n        }\n        else {\n            numberFormat = ' \\\\*' + numberFormat;\n        }\n        var fieldCode = 'PAGE ' + numberFormat + ' \\\\* MERGEFORMAT';\n        this.createFields(fieldCode);\n    };\n    /**\n     * @private\n     */\n    Editor.prototype.insertPageCount = function (numberFormat) {\n        if (isNullOrUndefined(numberFormat)) {\n            numberFormat = '';\n        }\n        else {\n            numberFormat = ' \\*' + numberFormat;\n        }\n        var fieldCode = 'NUMPAGES ' + numberFormat + ' \\* MERGEFORMAT';\n        this.createFields(fieldCode);\n    };\n    Editor.prototype.createFields = function (fieldCode) {\n        var paragraph = new ParagraphWidget();\n        var line = new LineWidget(paragraph);\n        var fieldBegin = new FieldElementBox(0);\n        line.children.push(fieldBegin);\n        var fieldtext = new FieldTextElementBox();\n        fieldtext.fieldBegin = fieldBegin;\n        fieldtext.text = '1';\n        var text = new TextElementBox();\n        text.text = fieldCode;\n        line.children.push(text);\n        var fieldSeparator = new FieldElementBox(2);\n        fieldSeparator.fieldBegin = fieldBegin;\n        fieldBegin.fieldSeparator = fieldSeparator;\n        line.children.push(fieldSeparator);\n        line.children.push(fieldtext);\n        var fieldEnd = new FieldElementBox(1);\n        fieldEnd.fieldBegin = fieldBegin;\n        fieldEnd.fieldSeparator = fieldSeparator;\n        fieldSeparator.fieldEnd = fieldEnd;\n        fieldBegin.fieldEnd = fieldEnd;\n        line.children.push(fieldEnd);\n        fieldBegin.line = line;\n        paragraph.childWidgets.push(line);\n        var widgets = [];\n        widgets.push(paragraph);\n        this.viewer.fields.push(fieldBegin);\n        this.pasteContentsInternal(widgets);\n    };\n    /**\n     * @private\n     */\n    Editor.prototype.insertBookmark = function (name) {\n        var bookmark = new BookmarkElementBox(0);\n        bookmark.name = name;\n        var bookmarkEnd = new BookmarkElementBox(1);\n        bookmarkEnd.name = name;\n        bookmark.reference = bookmarkEnd;\n        bookmarkEnd.reference = bookmark;\n        this.viewer.bookmarks.add(name, bookmark);\n        this.initComplexHistory('InsertBookmark');\n        this.insertElements([bookmarkEnd], [bookmark]);\n        if (this.editorHistory) {\n            this.editorHistory.updateComplexHistoryInternal();\n        }\n        this.selection.start.setPositionForSelection(bookmark.line, bookmark, 1, this.selection.start.location);\n        this.selection.end.setPositionForSelection(bookmarkEnd.line, bookmarkEnd, 0, this.selection.end.location);\n        this.selection.fireSelectionChanged(true);\n        this.fireContentChange();\n    };\n    /**\n     * @private\n     */\n    Editor.prototype.deleteBookmark = function (bookmarkName) {\n        var bookmarks = this.viewer.bookmarks;\n        var bookmark = bookmarks.get(bookmarkName);\n        if (bookmark instanceof BookmarkElementBox) {\n            var bookmarkEnd = bookmark.reference;\n            this.initHistory('DeleteBookmark');\n            if (this.editorHistory) {\n                this.editorHistory.currentBaseHistoryInfo.setBookmarkInfo(bookmark);\n                this.editorHistory.updateHistory();\n            }\n            this.deleteBookmarkInternal(bookmark);\n        }\n        this.fireContentChange();\n    };\n    /**\n     * @private\n     */\n    Editor.prototype.deleteBookmarkInternal = function (bookmark) {\n        this.viewer.bookmarks.remove(bookmark.name);\n        bookmark.line.children.splice(bookmark.indexInOwner, 1);\n        bookmark.reference.line.children.splice(bookmark.reference.indexInOwner, 1);\n    };\n    /**\n     * @private\n     */\n    Editor.prototype.getSelectionInfo = function () {\n        var start = this.selection.start;\n        var end = this.selection.end;\n        var isEmpty = this.selection.isEmpty;\n        if (!this.selection.isForward) {\n            start = this.selection.end;\n            end = this.selection.start;\n        }\n        var startElementInfo = start.currentWidget.getInline(start.offset, 0);\n        var endElementInfo = end.currentWidget.getInline(end.offset, 0);\n        // tslint:disable-next-line:max-line-length\n        return { 'start': start.clone(), 'end': end.clone(), 'startElementInfo': startElementInfo, 'endElementInfo': endElementInfo, 'isEmpty': isEmpty };\n    };\n    /**\n     * @private\n     */\n    Editor.prototype.insertElements = function (endElements, startElements) {\n        var info = this.getSelectionInfo();\n        if (!isNullOrUndefined(startElements)) {\n            this.insertElementsInternal(info.start, startElements);\n        }\n        if (!isNullOrUndefined(endElements)) {\n            this.insertElementsInternal(info.end, endElements);\n        }\n    };\n    /**\n     * @private\n     */\n    Editor.prototype.insertElementsInternal = function (position, elements) {\n        this.selection.selectPosition(position, position);\n        this.initHistory('InsertElements');\n        this.updateInsertPosition();\n        var indexInInline = 0;\n        var paragraphInfo = this.getParagraphInfo(this.selection.start);\n        if (this.selection.start.paragraph.isEmpty()) {\n            var paragraph = this.selection.start.paragraph;\n            paragraph.childWidgets[0].children.push(elements[0]);\n            elements[0].line = paragraph.childWidgets[0];\n            elements[0].linkFieldCharacter(this.viewer);\n            this.viewer.layout.reLayoutParagraph(paragraph, 0, 0);\n            this.setPositionParagraph(paragraphInfo.paragraph, paragraphInfo.offset + length, true);\n            position.setPositionForSelection(elements[0].line, elements[0], elements[0].length, this.selection.start.location);\n            this.selection.selectPosition(position, position);\n        }\n        else {\n            var inlineObj = this.selection.start.currentWidget.getInline(this.viewer.selection.start.offset, indexInInline);\n            var curInline = inlineObj.element;\n            indexInInline = inlineObj.index;\n            var firstElement = elements[0];\n            this.insertElementInternal(curInline, firstElement, indexInInline, true);\n            var index = firstElement.indexInOwner;\n            var lastElement = firstElement;\n            for (var i = 1; i < elements.length; i++) {\n                lastElement = elements[i];\n                firstElement.line.children.splice(index + i, 0, lastElement);\n            }\n            position.setPositionForSelection(lastElement.line, lastElement, lastElement.length, this.selection.start.location);\n            this.selection.selectPosition(position, position);\n        }\n        if (this.editorHistory) {\n            if (this.checkEndPosition()) {\n                this.updateHistoryPosition(this.selection.start, false);\n            }\n            this.editorHistory.updateHistory();\n        }\n    };\n    /**\n     * @private\n     */\n    Editor.prototype.getHierarchicalIndex = function (block, offset) {\n        var index;\n        if (block) {\n            if (block instanceof HeaderFooterWidget) {\n                var hfString = block.headerFooterType.indexOf('Header') !== -1 ? 'H' : 'F';\n                var pageIndex = block.page.index.toString();\n                var headerFooterIndex = this.viewer.getHeaderFooter(block.headerFooterType).toString();\n                var sectionIndex = block.page.sectionIndex;\n                index = sectionIndex + ';' + hfString + ';' + pageIndex + ';' + offset;\n            }\n            else {\n                index = block.index + ';' + offset;\n            }\n            if (block.containerWidget) {\n                if (block instanceof TableCellWidget && block.rowIndex !== block.containerWidget.index) {\n                    index = block.rowIndex + ';' + index;\n                    block = block.containerWidget;\n                }\n                return this.getHierarchicalIndex(block.containerWidget, index);\n            }\n        }\n        return index;\n    };\n    /**\n     * @private\n     */\n    Editor.prototype.getBlock = function (position) {\n        var bodyWidget = this.getBodyWidget(position);\n        return this.getBlockInternal(bodyWidget, position);\n    };\n    /**\n     * Return Block relative to position\n     * @private\n     */\n    Editor.prototype.getBlockInternal = function (widget, position) {\n        if (position.index === '' || isNullOrUndefined(position)) {\n            return undefined;\n        }\n        var index = position.index.indexOf(';');\n        var value = position.index.substring(0, index);\n        position.index = position.index.substring(index).replace(';', '');\n        var node = widget;\n        // if (node instanceof WSection && value === 'HF') {\n        //     //Gets the block in Header footers.\n        //     let blockObj: BlockInfo = this.getBlock((node as WSection).headerFooters, position);\n        // tslint:disable-next-line:max-line-length\n        //     return { 'node': (!isNullOrUndefined(blockObj)) ? blockObj.node : undefined, 'position': (!isNullOrUndefined(blockObj)) ? blockObj.position : undefined };\n        // }\n        index = parseInt(value, 10);\n        var childWidget = this.getBlockByIndex(widget, index);\n        if (childWidget) {\n            var child = childWidget;\n            if (position.index.indexOf(';') >= 0) {\n                if (child instanceof ParagraphWidget) {\n                    if (position.index.indexOf(';') >= 0) {\n                        position.index = '0';\n                    }\n                    return { 'node': child, 'position': position };\n                }\n                if (child instanceof Widget) {\n                    var blockObj = this.getBlockInternal(child, position);\n                    // tslint:disable-next-line:max-line-length\n                    return { 'node': (!isNullOrUndefined(blockObj)) ? blockObj.node : undefined, 'position': (!isNullOrUndefined(blockObj)) ? blockObj.position : undefined };\n                }\n            }\n            else {\n                return { 'node': child, 'position': position };\n            }\n        }\n        else {\n            return { 'node': node, 'position': position };\n        }\n        return { 'node': node, 'position': position };\n    };\n    /**\n     * @private\n     */\n    Editor.prototype.getParagraph = function (position) {\n        var paragraph = this.getParagraphInternal(this.getBodyWidget(position), position);\n        return { paragraph: paragraph, offset: parseInt(position.index, 10) };\n    };\n    /**\n     * Get paragraph relative to position\n     * @private\n     */\n    Editor.prototype.getParagraphInternal = function (container, position) {\n        if (isNullOrUndefined(position.index)) {\n            return undefined;\n        }\n        // let ins: Widget = container;\n        var index = position.index.indexOf(';');\n        var value = '0';\n        if (index >= 0) {\n            value = position.index.substring(0, index);\n            position.index = position.index.substring(index).replace(';', '');\n        }\n        // if (container instanceof BodyWidget && value === 'HF') {\n        //     return this.getParagraph(container.headerFooters, position);\n        // }\n        index = parseInt(value, 10);\n        if (container instanceof TableRowWidget && index >= container.childWidgets.length) {\n            position.index = '0;0';\n            index = container.childWidgets.length - 1;\n        }\n        var childWidget = this.getBlockByIndex(container, index);\n        if (childWidget) {\n            var child = childWidget;\n            if (child instanceof ParagraphWidget) {\n                if (position.index.indexOf(';') > 0) {\n                    position.index = '0';\n                }\n                return child;\n            }\n            if (child instanceof Widget) {\n                if (position.index.indexOf(';') > 0) {\n                    return this.getParagraphInternal(child, position);\n                }\n                else {\n                    //If table is shifted to previous text position then return the first paragraph within table.\n                    if (child instanceof TableWidget) {\n                        return this.viewer.selection.getFirstParagraphInFirstCell(child);\n                    }\n                    return undefined;\n                }\n            }\n        }\n        else if (container) {\n            var nextWidget = container.getSplitWidgets().pop().nextRenderedWidget;\n            if (nextWidget instanceof Widget) {\n                position.index = '0';\n                if (nextWidget instanceof TableWidget) {\n                    return this.viewer.selection.getFirstParagraphInFirstCell(nextWidget);\n                }\n                return nextWidget;\n            }\n        }\n        return undefined;\n    };\n    Editor.prototype.getBodyWidget = function (position) {\n        var index = position.index.indexOf(';');\n        var value = position.index.substring(0, index);\n        position.index = position.index.substring(index).replace(';', '');\n        var sectionIndex = parseInt(value, 10);\n        index = parseInt(value, 10);\n        index = position.index.indexOf(';');\n        value = position.index.substring(0, index);\n        // position = position.substring(index).replace(';', '');\n        if (value === 'H' || value === 'F') {\n            return this.getHeaderFooterWidget(position);\n        }\n        index = parseInt(value, 10);\n        return this.getBodyWidgetInternal(sectionIndex, index);\n    };\n    Editor.prototype.getHeaderFooterWidget = function (position) {\n        //HEADER OR FOOTER WIDGET\n        var index = position.index.indexOf(';');\n        var value = position.index.substring(0, index);\n        position.index = position.index.substring(index).replace(';', '');\n        var isHeader = value === 'H';\n        index = position.index.indexOf(';');\n        value = position.index.substring(0, index);\n        position.index = position.index.substring(index).replace(';', '');\n        index = parseInt(value, 10);\n        var page = this.viewer.pages[index];\n        if (isHeader) {\n            return page.headerWidget;\n        }\n        else {\n            return page.footerWidget;\n        }\n    };\n    Editor.prototype.getBodyWidgetInternal = function (sectionIndex, blockIndex) {\n        for (var i = 0; i < this.viewer.pages.length; i++) {\n            var bodyWidget = this.viewer.pages[i].bodyWidgets[0];\n            if (bodyWidget.index === sectionIndex) {\n                if (bodyWidget.firstChild.index <= blockIndex && bodyWidget.lastChild.index >= blockIndex) {\n                    return bodyWidget;\n                }\n            }\n            if (bodyWidget.index > sectionIndex) {\n                break;\n            }\n        }\n        return undefined;\n    };\n    /**\n     * @private\n     */\n    Editor.prototype.getBlockByIndex = function (container, blockIndex) {\n        var childWidget;\n        if (container) {\n            for (var j = 0; j < container.childWidgets.length; j++) {\n                if (container.childWidgets[j].index === blockIndex) {\n                    childWidget = container.childWidgets[j];\n                    break;\n                }\n            }\n            if (!childWidget && !(container instanceof HeaderFooterWidget)) {\n                return this.getBlockByIndex(container.nextSplitWidget, blockIndex);\n            }\n        }\n        return childWidget;\n    };\n    /**\n     * @private\n     */\n    Editor.prototype.updateHistoryPosition = function (position, isInsertPosition) {\n        if (this.editorHistory && !isNullOrUndefined(this.editorHistory.currentBaseHistoryInfo)) {\n            var hierarchicalIndex = void 0;\n            if (position instanceof TextPosition) {\n                var blockInfo = this.getParagraphInfo(position);\n                hierarchicalIndex = this.getHierarchicalIndex(blockInfo.paragraph, blockInfo.offset.toString());\n            }\n            else {\n                hierarchicalIndex = position;\n            }\n            if (isInsertPosition) {\n                this.editorHistory.currentBaseHistoryInfo.insertPosition = hierarchicalIndex;\n            }\n            else {\n                this.editorHistory.currentBaseHistoryInfo.endPosition = hierarchicalIndex;\n            }\n        }\n    };\n    /**\n     * Applies the borders based on given settings.\n     * @param {BorderSettings} settings\n     */\n    Editor.prototype.applyBorders = function (settings) {\n        this.initHistory('Borders');\n        var startPos = this.selection.isForward ? this.selection.start : this.selection.end;\n        var endPos = this.selection.isForward ? this.selection.end : this.selection.start;\n        var table = startPos.paragraph.associatedCell.ownerTable;\n        table = table.combineWidget(this.viewer);\n        if (this.editorHistory) {\n            var clonedTable = this.cloneTableToHistoryInfo(table);\n        }\n        var startCell = startPos.paragraph.associatedCell;\n        var endCell = endPos.paragraph.associatedCell;\n        var cells;\n        var border = this.getBorder(settings.borderColor, settings.lineWidth, settings.borderStyle);\n        if (this.selection.isEmpty) {\n            //Apply borders for current selected cell initially.                    \n            if (settings.type === 'OutsideBorders' || settings.type === 'AllBorders' ||\n                settings.type === 'LeftBorder') {\n                endCell.cellFormat.borders.left.copyFormat(border);\n            }\n            if (settings.type === 'OutsideBorders' || settings.type === 'AllBorders' ||\n                settings.type === 'TopBorder') {\n                endCell.cellFormat.borders.top.copyFormat(border);\n            }\n            if (settings.type === 'OutsideBorders' || settings.type === 'AllBorders' ||\n                settings.type === 'RightBorder') {\n                endCell.cellFormat.borders.right.copyFormat(border);\n            }\n            if (settings.type === 'OutsideBorders' || settings.type === 'AllBorders' ||\n                settings.type === 'BottomBorder') {\n                endCell.cellFormat.borders.bottom.copyFormat(border);\n            }\n            if (settings.type === 'AllBorders' || settings.type === 'InsideBorders'\n                || settings.type === 'InsideVerticalBorder') {\n                endCell.cellFormat.borders.vertical.copyFormat(border);\n            }\n            if (settings.type === 'AllBorders' || settings.type === 'InsideBorders'\n                || settings.type === 'InsideHorizontalBorder') {\n                endCell.cellFormat.borders.horizontal.copyFormat(border);\n            }\n            if (settings.type === 'NoBorder') {\n                this.clearAllBorderValues(endCell.cellFormat.borders);\n            }\n        }\n        else {\n            if (settings.type === 'OutsideBorders' || settings.type === 'TopBorder') {\n                var selectedCell = this.getTopBorderCellsOnSelection();\n                for (var i = 0; i < selectedCell.length; i++) {\n                    selectedCell[i].cellFormat.borders.top.copyFormat(border);\n                }\n            }\n            if (settings.type === 'OutsideBorders' || settings.type === 'LeftBorder') {\n                var selectedCell = this.getLeftBorderCellsOnSelection();\n                for (var i = 0; i < selectedCell.length; i++) {\n                    selectedCell[i].cellFormat.borders.left.copyFormat(border);\n                }\n            }\n            if (settings.type === 'OutsideBorders' || settings.type === 'RightBorder') {\n                var selectedCell = this.getRightBorderCellsOnSelection();\n                for (var i = 0; i < selectedCell.length; i++) {\n                    selectedCell[i].cellFormat.borders.right.copyFormat(border);\n                }\n            }\n            if (settings.type === 'OutsideBorders' || settings.type === 'BottomBorder') {\n                var selectedCell = this.getBottomBorderCellsOnSelection();\n                for (var i = 0; i < selectedCell.length; i++) {\n                    selectedCell[i].cellFormat.borders.bottom.copyFormat(border);\n                }\n            }\n        }\n        //Apply Only borders property to selected cells      \n        if (settings.type === 'BottomBorder' || settings.type === 'AllBorders' || settings.type === 'OutsideBorders'\n            || settings.type === 'NoBorder') {\n            cells = this.getAdjacentCellToApplyBottomBorder();\n            for (var i = 0; i < cells.length; i++) {\n                var cell = cells[i];\n                if (settings.type === 'NoBorder') {\n                    cell.cellFormat.borders.top.copyFormat(this.clearBorder());\n                }\n                else {\n                    cell.cellFormat.borders.top.copyFormat(border);\n                }\n            }\n        }\n        if (settings.type === 'AllBorders' || settings.type === 'OutsideBorders' || settings.type === 'RightBorder'\n            || settings.type === 'NoBorder') {\n            cells = this.getAdjacentCellToApplyRightBorder();\n            for (var i = 0; i < cells.length; i++) {\n                var cell = cells[i];\n                if (settings.type === 'NoBorder') {\n                    cell.cellFormat.borders.left.copyFormat(this.clearBorder());\n                }\n                else {\n                    cell.cellFormat.borders.left.copyFormat(border);\n                }\n            }\n        }\n        if (settings.type === 'AllBorders' || settings.type === 'NoBorder') {\n            this.applyAllBorders(border, settings.type);\n        }\n        if (settings.type === 'InsideBorders' || settings.type === 'InsideVerticalBorder'\n            || settings.type === 'InsideHorizontalBorder' || settings.type === 'NoBorder') {\n            this.applyInsideBorders(border, settings.type, table);\n        }\n        this.updateGridForTableDialog(table, false);\n        this.reLayout(this.selection, false);\n        this.editorHistory.updateHistory();\n    };\n    Editor.prototype.applyAllBorders = function (border, borderType) {\n        var cells = this.selection.getSelectedCells();\n        for (var i = 0; i < cells.length; i++) {\n            if (borderType === 'NoBorder') {\n                cells[i].cellFormat.borders.left.copyFormat(this.clearBorder());\n                cells[i].cellFormat.borders.right.copyFormat(this.clearBorder());\n                cells[i].cellFormat.borders.top.copyFormat(this.clearBorder());\n                cells[i].cellFormat.borders.bottom.copyFormat(this.clearBorder());\n            }\n            else {\n                cells[i].cellFormat.borders.left.copyFormat(border);\n                cells[i].cellFormat.borders.right.copyFormat(border);\n                cells[i].cellFormat.borders.top.copyFormat(border);\n                cells[i].cellFormat.borders.bottom.copyFormat(border);\n            }\n        }\n    };\n    Editor.prototype.applyInsideBorders = function (border, borderType, table) {\n        var cells = this.selection.getSelectedCells();\n        for (var i = 0; i < cells.length; i++) {\n            var cell = cells[i];\n            var isLastSelectedRow = cell.ownerRow === cells[cells.length - 1].ownerRow;\n            var isLastRightCell = (cell.columnIndex + cell.cellFormat.columnSpan - 1) === cells[cells.length - 1].columnIndex;\n            if (borderType === 'NoBorder') {\n                cell.cellFormat.borders.right.copyFormat(this.clearBorder());\n                cell.cellFormat.borders.bottom.copyFormat(this.clearBorder());\n            }\n            else {\n                if (!isLastRightCell && borderType !== 'InsideHorizontalBorder') {\n                    cell.cellFormat.borders.right.copyFormat(border);\n                }\n                if (!isLastSelectedRow && borderType !== 'InsideVerticalBorder') {\n                    cell.cellFormat.borders.bottom.copyFormat(border);\n                }\n            }\n            if (!isLastSelectedRow && borderType !== 'InsideVerticalBorder') {\n                // Apply adjacent bottom borders.\n                var nextRowIndex = cell.ownerRow.rowIndex + cell.cellFormat.rowSpan;\n                var nextRow = table.childWidgets[nextRowIndex];\n                if (nextRow) {\n                    var selectedCells = this.getAdjacentBottomBorderOnEmptyCells(nextRow, cell, true);\n                    for (var j = 0; j < selectedCells.length; j++) {\n                        if (borderType === 'NoBorder') {\n                            selectedCells[j].cellFormat.borders.top.copyFormat(this.clearBorder());\n                        }\n                        else {\n                            selectedCells[j].cellFormat.borders.top.copyFormat(border);\n                        }\n                    }\n                }\n            }\n            if (!isLastRightCell && borderType !== 'InsideHorizontalBorder') {\n                // Apply adjacent right borders.\n                var rightBorderCells = this.getSelectedCellsNextWidgets(cell, table);\n                for (var k = 0; k < rightBorderCells.length; k++) {\n                    if (borderType === 'NoBorder') {\n                        rightBorderCells[k].cellFormat.borders.left.copyFormat(this.clearBorder());\n                    }\n                    else {\n                        rightBorderCells[k].cellFormat.borders.left.copyFormat(border);\n                    }\n                }\n            }\n        }\n    };\n    /**\n     * @private\n     */\n    Editor.prototype.getTopBorderCellsOnSelection = function () {\n        var startPos = this.selection.isForward ? this.selection.start : this.selection.end;\n        var startCell = startPos.paragraph.associatedCell;\n        var topBorderCells = [];\n        var cells = this.selection.getSelectedCells();\n        for (var i = 0; i < cells.length; i++) {\n            if (cells[i].ownerRow === startCell.ownerRow) {\n                topBorderCells.push(cells[i]);\n            }\n        }\n        return topBorderCells;\n    };\n    /**\n     * @private\n     */\n    Editor.prototype.getLeftBorderCellsOnSelection = function () {\n        var startPos = this.selection.isForward ? this.selection.start : this.selection.end;\n        var startCell = startPos.paragraph.associatedCell;\n        var cells = this.selection.getSelectedCells();\n        var leftBorderCells = [];\n        for (var i = 0; i < cells.length; i++) {\n            if (cells[i].columnIndex === startCell.columnIndex) {\n                leftBorderCells.push(cells[i]);\n            }\n        }\n        return leftBorderCells;\n    };\n    /**\n     * @private\n     */\n    Editor.prototype.getRightBorderCellsOnSelection = function () {\n        var cells = this.selection.getSelectedCells();\n        var rightBorderCells = [];\n        for (var i = 0; i < cells.length; i++) {\n            if ((cells[i].columnIndex + cells[i].cellFormat.columnSpan - 1) === cells[cells.length - 1].columnIndex) {\n                rightBorderCells.push(cells[i]);\n            }\n        }\n        return rightBorderCells;\n    };\n    /**\n     * @private\n     */\n    Editor.prototype.getBottomBorderCellsOnSelection = function () {\n        var endPos = this.selection.isForward ? this.selection.end : this.selection.start;\n        var endCell = endPos.paragraph.associatedCell;\n        var cells = this.selection.getSelectedCells();\n        var bottomBorderCells = [];\n        for (var i = 0; i < cells.length; i++) {\n            if (cells[i].ownerRow === endCell.ownerRow) {\n                bottomBorderCells.push(cells[i]);\n            }\n        }\n        return bottomBorderCells;\n    };\n    /**\n     * @private\n     */\n    Editor.prototype.clearAllBorderValues = function (borders) {\n        var border = this.clearBorder();\n        borders.bottom.copyFormat(border);\n        borders.left.copyFormat(border);\n        borders.right.copyFormat(border);\n        borders.top.copyFormat(border);\n        borders.vertical.copyFormat(border);\n        borders.horizontal.copyFormat(border);\n    };\n    Editor.prototype.clearBorder = function () {\n        var border = new WBorder();\n        border.lineStyle = 'Cleared';\n        return border;\n    };\n    /**\n     * @private\n     */\n    Editor.prototype.getAdjacentCellToApplyBottomBorder = function () {\n        var cells = [];\n        var startPos = this.selection.start;\n        var endPos = this.selection.end;\n        if (!this.selection.isForward) {\n            startPos = this.selection.end;\n            endPos = this.selection.start;\n        }\n        var table = startPos.paragraph.associatedCell.ownerTable;\n        table = table.combineWidget(this.viewer);\n        var startCell = startPos.paragraph.associatedCell;\n        var endCell = endPos.paragraph.associatedCell;\n        var nextRowIndex = endCell.ownerRow.rowIndex + endCell.cellFormat.rowSpan;\n        var nextRow = table.childWidgets[nextRowIndex];\n        if (nextRow) {\n            if (endCell.cellFormat.columnSpan > 1) {\n                for (var i = endCell.columnIndex; i < endCell.columnIndex + endCell.cellFormat.columnSpan; i++) {\n                    cells.push(nextRow.childWidgets[i]);\n                }\n            }\n            else {\n                cells = this.getAdjacentBottomBorderOnEmptyCells(nextRow, endCell);\n                if (!this.selection.isEmpty) {\n                    for (var i = 0; i < nextRow.childWidgets.length; i++) {\n                        var nextCellColIndex = nextRow.childWidgets[i].columnIndex;\n                        if (nextCellColIndex >= startCell.columnIndex && nextCellColIndex <= endCell.columnIndex) {\n                            cells.push(nextRow.childWidgets[i]);\n                        }\n                    }\n                }\n            }\n        }\n        return cells;\n    };\n    Editor.prototype.getAdjacentBottomBorderOnEmptyCells = function (nextRow, cell, isSingleCell) {\n        var cells = [];\n        if (cell.cellFormat.columnSpan > 1) {\n            for (var i = cell.columnIndex; i < cell.columnIndex + cell.cellFormat.columnSpan; i++) {\n                cells.push(nextRow.childWidgets[i]);\n            }\n        }\n        else {\n            if (this.selection.isEmpty || isSingleCell) {\n                for (var i = 0; i < nextRow.childWidgets.length; i++) {\n                    if (nextRow.childWidgets[i].columnIndex === cell.columnIndex) {\n                        cells.push(nextRow.childWidgets[i]);\n                    }\n                }\n            }\n        }\n        return cells;\n    };\n    /**\n     * @private\n     */\n    Editor.prototype.getAdjacentCellToApplyRightBorder = function () {\n        var cells = [];\n        var startPosIn = this.selection.start;\n        var endPosIn = this.selection.end;\n        if (!this.selection.isForward) {\n            startPosIn = this.selection.end;\n            endPosIn = this.selection.start;\n        }\n        var table = startPosIn.paragraph.associatedCell.ownerTable;\n        table = table.combineWidget(this.viewer);\n        var startCell = startPosIn.paragraph.associatedCell;\n        var endCell = endPosIn.paragraph.associatedCell;\n        if (this.selection.isEmpty) {\n            var selectedCell = startPosIn.paragraph.associatedCell;\n            cells = this.getSelectedCellsNextWidgets(selectedCell, table);\n        }\n        else {\n            // tslint:disable-next-line:max-line-length\n            var selectedCells = this.getRightBorderCellsOnSelection();\n            for (var i = 0; i < selectedCells.length; i++) {\n                var cell = selectedCells[i];\n                cells = cells.concat(this.getSelectedCellsNextWidgets(cell, table));\n            }\n        }\n        return cells;\n    };\n    Editor.prototype.getSelectedCellsNextWidgets = function (selectedCell, table) {\n        var cells = [];\n        if (selectedCell.nextWidget) {\n            cells.push(selectedCell.nextWidget);\n        }\n        if (selectedCell.cellFormat.rowSpan > 1) {\n            var nextRowIndex = selectedCell.ownerRow.rowIndex + selectedCell.cellFormat.rowSpan;\n            for (var i = selectedCell.ownerRow.rowIndex + 1; i < nextRowIndex; i++) {\n                var nextRow = table.childWidgets[i];\n                if (nextRow) {\n                    for (var j = 0; j < nextRow.childWidgets.length; j++) {\n                        if (nextRow.childWidgets[j].columnIndex ===\n                            selectedCell.nextWidget.columnIndex) {\n                            cells.push(nextRow.childWidgets[j]);\n                        }\n                    }\n                }\n            }\n        }\n        return cells;\n    };\n    /**\n     * @private\n     */\n    Editor.prototype.getBorder = function (borderColor, lineWidth, borderStyle) {\n        var border = new WBorder();\n        border.color = borderColor || '#000000';\n        border.lineWidth = lineWidth || 1;\n        border.lineStyle = borderStyle || 'Single';\n        return border;\n    };\n    /**\n     * Applies borders\n     * @param  {WBorders} sourceBorders\n     * @param  {WBorders} applyBorders\n     * @private\n     */\n    Editor.prototype.applyBordersInternal = function (sourceBorders, applyBorders) {\n        if (!isNullOrUndefined(sourceBorders) && !isNullOrUndefined(sourceBorders)) {\n            if (!isNullOrUndefined(sourceBorders.top)) {\n                this.applyBorder(sourceBorders.top, applyBorders.top);\n            }\n            if (!isNullOrUndefined(sourceBorders.bottom)) {\n                this.applyBorder(sourceBorders.bottom, applyBorders.bottom);\n            }\n            if (!isNullOrUndefined(sourceBorders.left)) {\n                this.applyBorder(sourceBorders.left, applyBorders.left);\n            }\n            if (!isNullOrUndefined(sourceBorders.right)) {\n                this.applyBorder(sourceBorders.right, applyBorders.right);\n            }\n            if (!isNullOrUndefined(sourceBorders.horizontal)) {\n                this.applyBorder(sourceBorders.horizontal, applyBorders.horizontal);\n            }\n            if (!isNullOrUndefined(sourceBorders.vertical)) {\n                this.applyBorder(sourceBorders.vertical, applyBorders.vertical);\n            }\n            if (!isNullOrUndefined(sourceBorders.diagonalUp)) {\n                this.applyBorder(sourceBorders.diagonalUp, applyBorders.diagonalUp);\n            }\n            if (!isNullOrUndefined(sourceBorders.diagonalDown)) {\n                this.applyBorder(sourceBorders.diagonalDown, applyBorders.diagonalDown);\n            }\n        }\n    };\n    /**\n     * Apply shading to table\n     * @param  {WShading} sourceShading\n     * @param  {WShading} applyShading\n     * @private\n     */\n    Editor.prototype.applyShading = function (sourceShading, applyShading) {\n        if (!isNullOrUndefined(applyShading) && !isNullOrUndefined(sourceShading)) {\n            if (!isNullOrUndefined(applyShading.backgroundColor)\n                && sourceShading.backgroundColor !== applyShading.backgroundColor) {\n                sourceShading.backgroundColor = applyShading.backgroundColor;\n            }\n            if (!isNullOrUndefined(applyShading.foregroundColor)\n                && sourceShading.foregroundColor !== applyShading.foregroundColor) {\n                sourceShading.foregroundColor = applyShading.foregroundColor;\n            }\n            if (!isNullOrUndefined(applyShading.textureStyle)\n                && sourceShading.textureStyle !== applyShading.textureStyle) {\n                sourceShading.textureStyle = applyShading.textureStyle;\n            }\n        }\n    };\n    Editor.prototype.applyBorder = function (sourceBorder, applyBorder) {\n        if (!isNullOrUndefined(sourceBorder) && !isNullOrUndefined(applyBorder)) {\n            if (!isNullOrUndefined(applyBorder.color)\n                && sourceBorder.color !== applyBorder.color) {\n                sourceBorder.color = applyBorder.color;\n            }\n            if (!isNullOrUndefined(applyBorder.lineStyle)\n                && sourceBorder.lineStyle !== applyBorder.lineStyle) {\n                sourceBorder.lineStyle = applyBorder.lineStyle;\n            }\n            if (!isNullOrUndefined(applyBorder.lineWidth)\n                && sourceBorder.lineWidth !== applyBorder.lineWidth) {\n                sourceBorder.lineWidth = applyBorder.lineWidth;\n            }\n            if (!isNullOrUndefined(applyBorder.shadow)\n                && sourceBorder.shadow !== applyBorder.shadow) {\n                sourceBorder.shadow = applyBorder.shadow;\n            }\n            if (!isNullOrUndefined(applyBorder.space)\n                && sourceBorder.space !== applyBorder.space) {\n                sourceBorder.space = applyBorder.space;\n            }\n        }\n    };\n    /**\n     * Apply Table Format changes\n     * @param  {Selection} selection\n     * @param  {WTableFormat} format\n     * @private\n     */\n    Editor.prototype.onTableFormat = function (format) {\n        if (!isNullOrUndefined(this.selection.tableFormat)) {\n            this.viewer.owner.isShiftingEnabled = true;\n            this.editorHistory.initializeHistory('TableFormat');\n            var table = this.selection.start.paragraph.associatedCell.ownerTable.combineWidget(this.viewer);\n            this.applyTableFormat(table, undefined, format);\n            this.reLayout(this.selection, false);\n        }\n    };\n    /**\n     * @private\n     */\n    Editor.prototype.applyTableFormat = function (table, property, value) {\n        this.applyTablePropertyValue(this.viewer.selection, undefined, value, table);\n    };\n    // tslint:disable-next-line:max-line-length\n    Editor.prototype.applyTablePropertyValue = function (selection, property, value, table) {\n        var sourceFormat = table.tableFormat;\n        if (!isNullOrUndefined(this.editorHistory.currentBaseHistoryInfo)) {\n            value = this.editorHistory.currentBaseHistoryInfo.addModifiedTableProperties(sourceFormat, property, value);\n        }\n        if (value instanceof WTableFormat) {\n            if (isNullOrUndefined(property)) {\n                this.handleTableFormat(sourceFormat, value);\n            }\n            return;\n        }\n        if (property === 'preferredWidth') {\n            sourceFormat.preferredWidth = value;\n        }\n        else if (property === 'leftIndent') {\n            sourceFormat.leftIndent = value;\n        }\n        else if (property === 'tableAlignment') {\n            sourceFormat.tableAlignment = value;\n        }\n        else if (property === 'cellSpacing') {\n            sourceFormat.cellSpacing = value;\n        }\n        else if (property === 'leftMargin') {\n            sourceFormat.leftMargin = value;\n        }\n        else if (property === 'rightMargin') {\n            sourceFormat.rightMargin = value;\n        }\n        else if (property === 'topMargin') {\n            sourceFormat.topMargin = value;\n        }\n        else if (property === 'bottomMargin') {\n            sourceFormat.bottomMargin = value;\n        }\n        else if (property === 'preferredWidthType') {\n            sourceFormat.preferredWidthType = value;\n        }\n        if (property === 'shading') {\n            sourceFormat.shading = value;\n        }\n        else if (property === 'borders') {\n            sourceFormat.borders = value;\n        }\n        // if (!isNullOrUndefined(table)) {\n        //     this.layoutItemBlock(table, true);\n        // }\n    };\n    Editor.prototype.handleTableFormat = function (tableFormat, applyFormat) {\n        if (this.isBordersAndShadingDialog || this.editorHistory.isUndoing\n            || this.editorHistory.isRedoing) {\n            if (!isNullOrUndefined(tableFormat.borders)) {\n                this.applyBordersInternal(tableFormat.borders, applyFormat.borders);\n            }\n            if (!isNullOrUndefined(tableFormat.shading)) {\n                this.applyShading(tableFormat.shading, applyFormat.shading);\n            }\n        }\n        if (!this.isBordersAndShadingDialog) {\n            if (applyFormat.hasValue('preferredWidth') && applyFormat.preferredWidth !== tableFormat.preferredWidth) {\n                tableFormat.preferredWidth = applyFormat.preferredWidth;\n            }\n            if (applyFormat.hasValue('preferredWidthType') && applyFormat.preferredWidthType !== tableFormat.preferredWidthType) {\n                tableFormat.preferredWidthType = applyFormat.preferredWidthType;\n            }\n            if (applyFormat.hasValue('tableAlignment') && applyFormat.tableAlignment !== tableFormat.tableAlignment) {\n                tableFormat.tableAlignment = applyFormat.tableAlignment;\n            }\n            if (applyFormat.hasValue('leftIndent') && applyFormat.leftIndent !== tableFormat.leftIndent) {\n                tableFormat.leftIndent = applyFormat.leftIndent;\n            }\n        }\n        this.updateGridForTableDialog(tableFormat.ownerBase, false);\n    };\n    Editor.prototype.updateGridForTableDialog = function (table, shiftNextItem) {\n        if (table.tableHolder) {\n            table.updateRowIndex(0);\n            table.calculateGrid();\n            table.isGridUpdated = false;\n        }\n        this.viewer.layout.reLayoutTable(table);\n    };\n    /**\n     * Applies Row Format Changes\n     * @param  {Selection} selection\n     * @param  {WRowFormat} format\n     * @param  {WRow} row\n     * @private\n     */\n    Editor.prototype.onRowFormat = function (format) {\n        if (isNullOrUndefined(this.selection) || isNullOrUndefined(format)) {\n            return;\n        }\n        this.editorHistory.initializeHistory('RowFormat');\n        this.viewer.owner.isShiftingEnabled = true;\n        var rowStartPos = this.selection.isForward ? this.selection.start : this.selection.end;\n        var rowEndPos = this.selection.isForward ? this.selection.end : this.selection.start;\n        var table = rowStartPos.paragraph.associatedCell.ownerTable.combineWidget(this.viewer);\n        this.applyRowFormat(rowStartPos.paragraph.associatedCell.ownerRow, rowStartPos, rowEndPos, undefined, format);\n        this.reLayout(this.selection, false);\n    };\n    Editor.prototype.applyRowFormat = function (row, start, end, property, value) {\n        this.applyRowPropertyValue(this.viewer.selection, property, value, row);\n        if (end.paragraph.associatedCell.ownerRow === row) {\n            return;\n        }\n        var newRow = row.nextWidget;\n        if (!isNullOrUndefined(newRow)) {\n            this.applyRowFormat(newRow, start, end, property, value);\n        }\n    };\n    Editor.prototype.applyRowPropertyValue = function (selection, property, value, row) {\n        var applyFormat = row.rowFormat;\n        if (!isNullOrUndefined(this.editorHistory.currentBaseHistoryInfo)) {\n            value = this.editorHistory.currentBaseHistoryInfo.addModifiedRowProperties(applyFormat, property, value);\n        }\n        if (value instanceof WRowFormat) {\n            if (isNullOrUndefined(property)) {\n                this.handleRowFormat(value, applyFormat);\n            }\n            return;\n        }\n        if (property === 'heightType') {\n            applyFormat.heightType = value;\n        }\n        else if (property === 'height') {\n            applyFormat.height = value;\n        }\n        else if (property === 'isHeader') {\n            applyFormat.isHeader = value;\n        }\n        else if (property === 'allowBreakAcrossPages') {\n            applyFormat.allowBreakAcrossPages = value;\n        }\n        if (!isNullOrUndefined(row.ownerTable)) {\n            this.layoutItemBlock(row.ownerTable, true);\n        }\n    };\n    Editor.prototype.handleRowFormat = function (format, applyFormat) {\n        if (format.hasValue('allowBreakAcrossPages') && format.allowBreakAcrossPages !== applyFormat.allowBreakAcrossPages) {\n            applyFormat.allowBreakAcrossPages = format.allowBreakAcrossPages;\n        }\n        if (format.hasValue('isHeader') && format.isHeader !== applyFormat.isHeader) {\n            applyFormat.isHeader = format.isHeader;\n        }\n        if (format.hasValue('heightType') && format.heightType !== applyFormat.heightType) {\n            applyFormat.heightType = format.heightType;\n        }\n        if (format.hasValue('height') && format.height !== applyFormat.height) {\n            applyFormat.height = format.height;\n        }\n        this.updateGridForTableDialog(applyFormat.ownerBase.ownerTable, true);\n    };\n    /**\n     * Applies Cell Format changes\n     * @param  {Selection} selection\n     * @param  {WCellFormat} format\n     * @param  {WCell} cell\n     * @private\n     */\n    Editor.prototype.onCellFormat = function (format) {\n        if (isNullOrUndefined(this.selection) || isNullOrUndefined(format)) {\n            return;\n        }\n        this.editorHistory.initializeHistory('CellFormat');\n        this.updateFormatForCell(this.selection, undefined, format);\n        this.reLayout(this.selection, false);\n    };\n    /**\n     * @private\n     */\n    Editor.prototype.updateCellMargins = function (selection, value) {\n        var cellStartPosition = selection.start;\n        var cellEndPosition = selection.end;\n        if (!selection.isForward) {\n            cellStartPosition = selection.end;\n            cellEndPosition = selection.start;\n        }\n        this.initHistoryPosition(selection, cellStartPosition);\n        // tslint:disable-next-line:max-line-length\n        this.viewer.owner.cellOptionsDialogModule.applyCellmarginsValue(cellStartPosition.paragraph.associatedCell.ownerRow, cellStartPosition, cellEndPosition, value);\n    };\n    /**\n     * @private\n     */\n    Editor.prototype.updateFormatForCell = function (selection, property, value) {\n        var start = selection.start;\n        var end = selection.end;\n        if (!selection.isForward) {\n            start = selection.end;\n            end = selection.start;\n        }\n        var startCell = start.paragraph.associatedCell;\n        var endCell = end.paragraph.associatedCell;\n        var cells;\n        var table = startCell.ownerTable.combineWidget(this.viewer);\n        var appliedFormat;\n        for (var k = startCell.columnIndex; k <= endCell.columnIndex; k++) {\n            cells = this.getSelectedCellInColumn(startCell.ownerTable, startCell.ownerRow.rowIndex, k, endCell.ownerRow.rowIndex);\n            for (var i = 0; i < cells.length; i++) {\n                appliedFormat = this.applyCellPropertyValue(this.viewer.selection, property, value, cells[i].cellFormat);\n            }\n        }\n        this.updateGridForTableDialog(table, false);\n    };\n    /**\n     * @private\n     */\n    Editor.prototype.getSelectedCellInColumn = function (table, rowStartIndex, columnIndex, rowEndIndex) {\n        var cells = [];\n        for (var i = rowStartIndex; i <= rowEndIndex; i++) {\n            var row = table.childWidgets[i];\n            for (var j = 0; j < row.childWidgets.length; j++) {\n                if (row.childWidgets[j].columnIndex === columnIndex) {\n                    cells.push(row.childWidgets[j]);\n                }\n            }\n        }\n        return cells;\n    };\n    Editor.prototype.getColumnCells = function (table, columnIndex, isLeftSideCollection) {\n        var cells = [];\n        for (var k = 0; k < table.childWidgets.length; k++) {\n            var row = table.childWidgets[k];\n            for (var i = 0; i < row.childWidgets.length; i++) {\n                var cell = row.childWidgets[i];\n                if (isLeftSideCollection) {\n                    if (cell.columnIndex + cell.cellFormat.columnSpan === columnIndex) {\n                        cells.push(cell);\n                    }\n                }\n                else {\n                    if (cell.columnIndex === columnIndex) {\n                        cells.push(cell);\n                    }\n                }\n            }\n        }\n        return cells;\n    };\n    /**\n     * @private\n     */\n    Editor.prototype.getTableWidth = function (table) {\n        if (table.tableFormat.preferredWidth !== 0 || table.tableFormat.preferredWidthType === 'Percent') {\n            if (table.tableFormat.preferredWidthType === 'Auto' || table.tableFormat.preferredWidthType === 'Point') {\n                return table.tableFormat.preferredWidth;\n            }\n            else {\n                if (table.tableFormat.preferredWidth === 0) {\n                    return 0;\n                }\n                else {\n                    return HelperMethods.convertPixelToPoint(this.viewer.clientArea.width) / 100 * table.tableFormat.preferredWidth;\n                }\n            }\n        }\n        return HelperMethods.convertPixelToPoint(this.viewer.layout.getTableWidth(table));\n    };\n    Editor.prototype.applyCellPropertyValue = function (selection, property, value, applyFormat) {\n        if (!isNullOrUndefined(this.editorHistory.currentBaseHistoryInfo)) {\n            value = this.editorHistory.currentBaseHistoryInfo.addModifiedCellProperties(applyFormat, property, value);\n        }\n        if (value instanceof WCellFormat) {\n            if (isNullOrUndefined(property)) {\n                this.handleCellFormat(value, applyFormat);\n            }\n            return value;\n        }\n        if (property === 'leftMargin') {\n            applyFormat.leftMargin = value;\n        }\n        else if (property === 'topMargin') {\n            applyFormat.topMargin = value;\n        }\n        else if (property === 'rightMargin') {\n            applyFormat.rightMargin = value;\n        }\n        else if (property === 'bottomMargin') {\n            applyFormat.bottomMargin = value;\n        }\n        else if (property === 'preferredWidth') {\n            applyFormat.preferredWidth = value;\n            applyFormat.cellWidth = value;\n        }\n        else if (property === 'cellWidth') {\n            applyFormat.cellWidth = value;\n        }\n        else if (property === 'columnSpan') {\n            applyFormat.columnSpan = value;\n        }\n        else if (property === 'rowSpan') {\n            applyFormat.rowSpan = value;\n        }\n        else if (property === 'preferredWidthType') {\n            applyFormat.preferredWidthType = value;\n        }\n        else if (property === 'verticalAlignment') {\n            applyFormat.verticalAlignment = value;\n        }\n        if (property === 'shading') {\n            applyFormat.shading = value;\n        }\n        else if (property === 'borders') {\n            applyFormat.borders = value;\n        }\n        return undefined;\n    };\n    Editor.prototype.handleCellFormat = function (cellFormat, applyFormat) {\n        if (!isNullOrUndefined(cellFormat) && !isNullOrUndefined(applyFormat)) {\n            if (this.isBordersAndShadingDialog) {\n                if (!isNullOrUndefined(cellFormat.borders)) {\n                    this.applyBordersInternal(applyFormat.borders, cellFormat.borders);\n                }\n                if (!isNullOrUndefined(cellFormat.shading)) {\n                    this.applyShading(applyFormat.shading, cellFormat.shading);\n                }\n                // this.layoutRow((applyFormat.ownerBase as TableCellWidget).ownerRow, this.viewer, false);\n            }\n            else {\n                if (cellFormat.hasValue('preferredWidth') && applyFormat.preferredWidth !== cellFormat.preferredWidth) {\n                    applyFormat.preferredWidth = cellFormat.preferredWidth;\n                }\n                if (cellFormat.hasValue('preferredWidthType') && applyFormat.preferredWidthType !== cellFormat.preferredWidthType) {\n                    applyFormat.preferredWidthType = cellFormat.preferredWidthType;\n                }\n                if (cellFormat.hasValue('verticalAlignment') && applyFormat.verticalAlignment !== cellFormat.verticalAlignment) {\n                    applyFormat.verticalAlignment = cellFormat.verticalAlignment;\n                }\n            }\n        }\n    };\n    /**\n     * @private\n     */\n    Editor.prototype.destroy = function () {\n        this.viewer = undefined;\n        this.nodes = [];\n    };\n    Editor.prototype.isTocField = function (element) {\n        if (element instanceof FieldElementBox) {\n            var nextElement = element.nextNode;\n            if (element instanceof FieldElementBox && element.fieldType === 0 && nextElement instanceof TextElementBox\n                && nextElement.text.trim().toLowerCase().indexOf('toc') === 0) {\n                return true;\n            }\n        }\n        return false;\n    };\n    /**\n     * Updates the table of contents.\n     * @private\n     */\n    Editor.prototype.updateToc = function (tocField) {\n        if (isNullOrUndefined(tocField)) {\n            tocField = this.selection.getTocFieldInternal();\n        }\n        if (!this.isTocField(tocField)) {\n            return;\n        }\n        // Decode field code to get parameters\n        var code = this.selection.getFieldCode(tocField);\n        if (code.toLocaleLowerCase().indexOf('toc') !== -1) {\n            this.insertTableOfContents(this.validateTocSettings(this.getTocSettings(code, tocField)));\n        }\n    };\n    Editor.prototype.getTocSettings = function (code, tocField) {\n        var tocSettings = {};\n        tocSettings.includePageNumber = true;\n        tocSettings.rightAlign = true;\n        // Decode field code to get parameters\n        if (code.toLowerCase() === 'toc \\\\mergeformat') {\n            tocSettings.startLevel = 1;\n            tocSettings.endLevel = 3;\n        }\n        else {\n            var swtiches = code.split('\\\\');\n            for (var i = 0; i < swtiches.length; i++) {\n                var swtch = swtiches[i];\n                if (swtch.length === 0) {\n                    continue;\n                }\n                switch (swtch[0]) {\n                    case 'o':\n                        if (!isNullOrUndefined(swtch.match(/\\d+/g))) {\n                            var levels = swtch.match(/\\d+/g).map(Number);\n                            tocSettings.startLevel = levels[0];\n                            tocSettings.endLevel = levels[1];\n                        }\n                        else {\n                            tocSettings.startLevel = 1;\n                            tocSettings.endLevel = 9;\n                        }\n                        break;\n                    case 'h':\n                        tocSettings.includeHyperlink = true;\n                        break;\n                    case 'n':\n                        tocSettings.includePageNumber = false;\n                        break;\n                    case 'p':\n                        tocSettings.rightAlign = false;\n                        break;\n                    case 'u':\n                        tocSettings.includeOutlineLevels = true;\n                        break;\n                    case 't':\n                        this.decodeTSwitch(tocSettings, swtch);\n                        break;\n                }\n            }\n        }\n        //assigns tab leader.\n        var tabs = tocField.paragraph.paragraphFormat.getUpdatedTabs();\n        if (tabs.length > 0) {\n            tocSettings.tabLeader = tabs[tabs.length - 1].tabLeader;\n        }\n        if (tocSettings.rightAlign && isNullOrUndefined(tocSettings.tabLeader)) {\n            tocSettings.tabLeader = 'Dot';\n        }\n        return tocSettings;\n    };\n    Editor.prototype.decodeTSwitch = function (tocSettings, tSwitch) {\n        tocSettings.levelSettings = {};\n        tSwitch = tSwitch.replace('t', '');\n        tSwitch = tSwitch.replace('\"', '');\n        tSwitch = tSwitch.replace('\"', '');\n        tSwitch = tSwitch.trim();\n        var levels = tSwitch.split(',');\n        for (var index = 0; index < levels.length; index++) {\n            tocSettings.levelSettings[levels[index]] = parseInt(levels[index + 1], 10);\n            index++;\n        }\n    };\n    /**\n     * Inserts, modifies or updates the table of contents based on given settings.\n     * @param {TableOfContentsSettings} tableOfContentsSettings\n     */\n    Editor.prototype.insertTableOfContents = function (tableOfContentsSettings) {\n        this.isInsertingTOC = true;\n        this.initComplexHistory('TOC');\n        if (isNullOrUndefined(tableOfContentsSettings)) {\n            //Initializes with default value.\n            tableOfContentsSettings = {};\n            tableOfContentsSettings.startLevel = 1;\n            tableOfContentsSettings.endLevel = 3;\n            tableOfContentsSettings.includeHyperlink = true;\n            tableOfContentsSettings.includeOutlineLevels = true;\n            tableOfContentsSettings.includePageNumber = true;\n            tableOfContentsSettings.rightAlign = true;\n            tableOfContentsSettings.tabLeader = 'Dot';\n        }\n        var tocField = undefined;\n        var code = undefined;\n        if (this.selection.contextType === 'TableOfContents') {\n            tocField = this.selection.getTocFieldInternal();\n        }\n        if (tocField instanceof FieldElementBox) {\n            this.selection.start.setPositionForSelection(tocField.line, tocField, 0, this.selection.start.location);\n            this.selection.end.setPositionForSelection(tocField.fieldEnd.line, tocField.fieldEnd, 2, this.selection.end.location);\n            this.onDelete();\n        }\n        // Build TOC field code based on parameter\n        code = this.constructTocFieldCode(tableOfContentsSettings);\n        var isStartParagraph = this.selection.start.isAtParagraphStart;\n        var blockInfo = this.getParagraphInfo(this.selection.start);\n        var initialStart = this.getHierarchicalIndex(blockInfo.paragraph, blockInfo.offset.toString());\n        // Build TOC fields\n        // tslint:disable-next-line:max-line-length\n        var widgets = this.buildToc(this.validateTocSettings(tableOfContentsSettings), code, true, isStartParagraph);\n        if (widgets.length > 0) {\n            var tocLastPara = new ParagraphWidget();\n            var tocLastLine = new LineWidget(tocLastPara);\n            tocLastPara.childWidgets.push(tocLastLine);\n            var index = 0;\n            if (!isStartParagraph) {\n                index = 1;\n            }\n            var line = widgets[index].childWidgets[0];\n            var fieldBegin = line.children[0];\n            this.appendEndField(fieldBegin, tocLastLine);\n            widgets.push(tocLastPara);\n            this.appendEmptyPara(widgets);\n        }\n        this.setPositionForCurrentIndex(this.selection.start, initialStart);\n        this.selection.end.setPositionInternal(this.selection.start);\n        this.pasteContentsInternal(widgets);\n        this.isInsertingTOC = false;\n        this.updatePageRef();\n        if (this.editorHistory) {\n            this.editorHistory.updateComplexHistoryInternal();\n        }\n    };\n    Editor.prototype.appendEmptyPara = function (widgets) {\n        var emptyPara = new ParagraphWidget();\n        var emptyLine = new LineWidget(emptyPara);\n        emptyPara.childWidgets.push(emptyLine);\n        widgets.push(emptyPara);\n    };\n    Editor.prototype.constructTocFieldCode = function (tocSettings) {\n        var tocFieldCode = 'TOC';\n        //appends styles level\n        // tslint:disable-next-line:max-line-length\n        if (!isNullOrUndefined(tocSettings.startLevel) && tocSettings.startLevel !== 0 && !isNullOrUndefined(tocSettings.endLevel) && tocSettings.endLevel !== 0) {\n            tocFieldCode = tocFieldCode + ' \\\\o \"' + tocSettings.startLevel + '-' + tocSettings.endLevel + '\"';\n        }\n        if (tocSettings.includePageNumber && !tocSettings.rightAlign) {\n            tocFieldCode = tocFieldCode + ' \\\\p \" \"';\n        }\n        if (!tocSettings.includePageNumber) {\n            tocFieldCode = tocFieldCode + ' \\\\n';\n        }\n        if (tocSettings.includeHyperlink) {\n            tocFieldCode = tocFieldCode + ' \\\\h \\\\z';\n        }\n        if (tocSettings.includeOutlineLevels) {\n            tocFieldCode = tocFieldCode + ' \\\\u';\n        }\n        var tSwitch = this.constructTSwitch(tocSettings);\n        if (tSwitch.length > 6) {\n            tocFieldCode = tocFieldCode + tSwitch;\n        }\n        return tocFieldCode;\n    };\n    Editor.prototype.constructTSwitch = function (tocSettings) {\n        var tSwitch = '';\n        var prefix = ' \\\\t ';\n        if (!isNullOrUndefined(tocSettings.levelSettings)) {\n            for (var _i = 0, _a = Object.keys(tocSettings.levelSettings); _i < _a.length; _i++) {\n                var key = _a[_i];\n                tSwitch = tSwitch + key + ',' + tocSettings.levelSettings[key].toString() + ',';\n            }\n        }\n        tSwitch = tSwitch.slice(0, -1);\n        tSwitch = prefix + '\"' + tSwitch + '\"';\n        return tSwitch;\n    };\n    /**\n     * Appends the end filed to the given line.\n     */\n    Editor.prototype.appendEndField = function (fieldBegin, lineWidget) {\n        var fieldEnd = new FieldElementBox(1);\n        fieldEnd.fieldSeparator = fieldBegin.fieldSeparator;\n        fieldBegin.fieldSeparator.fieldEnd = fieldEnd;\n        fieldEnd.fieldBegin = fieldBegin;\n        fieldEnd.fieldBegin.fieldEnd = fieldEnd;\n        fieldEnd.line = lineWidget;\n        lineWidget.children.push(fieldEnd);\n    };\n    Editor.prototype.validateTocSettings = function (tocSettings) {\n        if (isNullOrUndefined(tocSettings.startLevel) || tocSettings.startLevel < 1) {\n            tocSettings.startLevel = 1;\n        }\n        if (isNullOrUndefined(tocSettings.endLevel) || tocSettings.endLevel < tocSettings.endLevel) {\n            tocSettings.endLevel = tocSettings.startLevel > 3 ? tocSettings.startLevel : 3;\n        }\n        if (isNullOrUndefined(tocSettings.includeHyperlink)) {\n            tocSettings.includeHyperlink = false;\n        }\n        if (isNullOrUndefined(tocSettings.includePageNumber)) {\n            tocSettings.includePageNumber = false;\n        }\n        if (isNullOrUndefined(tocSettings.rightAlign)) {\n            tocSettings.rightAlign = false;\n        }\n        if (isNullOrUndefined(tocSettings.levelSettings)) {\n            tocSettings.levelSettings = {};\n        }\n        return tocSettings;\n    };\n    /**\n     * Builds the TOC\n     * @private\n     */\n    // tslint:disable-next-line:max-line-length\n    Editor.prototype.buildToc = function (tocSettings, fieldCode, isFirstPara, isStartParagraph) {\n        var tocDomBody = this.viewer.pages[0].bodyWidgets[0];\n        var widgets = [];\n        this.createHeadingLevels(tocSettings);\n        if (tocSettings.includeOutlineLevels) {\n            this.createOutlineLevels(tocSettings);\n        }\n        var widget = tocDomBody.childWidgets[0];\n        while (widget !== undefined) {\n            // tslint:disable-next-line:max-line-length\n            if (widget instanceof ParagraphWidget && (this.isHeadingStyle(widget) || (tocSettings.includeOutlineLevels && this.isOutlineLevelStyle(widget)))) {\n                var bookmarkName = this.insertTocBookmark(widget);\n                // tslint:disable-next-line:max-line-length\n                this.createTOCWidgets(widget, widgets, fieldCode, bookmarkName, tocSettings, isFirstPara, isStartParagraph);\n                isFirstPara = false;\n            }\n            widget = this.selection.getNextParagraphBlock(widget);\n        }\n        this.tocStyles = {};\n        return widgets;\n    };\n    Editor.prototype.createOutlineLevels = function (settings) {\n        for (var i = settings.startLevel; i <= settings.endLevel; i++) {\n            var levelStyle = 'Level' + i.toString();\n            if (isNullOrUndefined(this.tocStyles[levelStyle])) {\n                this.tocStyles[levelStyle] = i;\n            }\n        }\n    };\n    /**\n     * Creates TOC heading styles\n     * @param start - lower heading level\n     * @param end - higher heading level\n     */\n    Editor.prototype.createHeadingLevels = function (settings) {\n        var normalStyle = 'Normal';\n        for (var i = settings.startLevel; i <= settings.endLevel; i++) {\n            var headingStyle = 'Heading ' + i.toString();\n            if (isNullOrUndefined(this.tocStyles[headingStyle])) {\n                this.tocStyles[headingStyle] = i;\n            }\n        }\n        if (!isNullOrUndefined(settings.levelSettings)) {\n            for (var _i = 0, _a = Object.keys(settings.levelSettings); _i < _a.length; _i++) {\n                var key = _a[_i];\n                this.tocStyles[key] = settings.levelSettings[key];\n            }\n        }\n    };\n    /**\n     * Checks the current style is heading style.\n     */\n    Editor.prototype.isHeadingStyle = function (para) {\n        var style = para.paragraphFormat.baseStyle;\n        if (style !== undefined) {\n            return isNullOrUndefined(this.tocStyles[style.name]) ? false : true;\n        }\n        return false;\n    };\n    Editor.prototype.isOutlineLevelStyle = function (para) {\n        var styleName = para.paragraphFormat.outlineLevel;\n        return isNullOrUndefined(this.tocStyles[styleName]) ? false : true;\n    };\n    /**\n     * Creates TOC field element.\n     */\n    Editor.prototype.createTocFieldElement = function (lineWidget, fieldCode) {\n        //begin\n        var fieldBegin = new FieldElementBox(0);\n        fieldBegin.hasFieldEnd = true;\n        fieldBegin.line = lineWidget;\n        lineWidget.children.push(fieldBegin);\n        //format toc\n        var textElement = new TextElementBox();\n        textElement.text = fieldCode;\n        textElement.line = lineWidget;\n        lineWidget.children.push(textElement);\n        //field separator\n        var fieldSeparator = new FieldElementBox(2);\n        fieldSeparator.fieldBegin = fieldBegin;\n        fieldSeparator.fieldBegin.fieldSeparator = fieldSeparator;\n        fieldSeparator.line = lineWidget;\n        lineWidget.children.push(fieldSeparator);\n        return fieldBegin;\n    };\n    /**\n     * Updates TOC para\n     */\n    // tslint:disable-next-line:max-line-length\n    Editor.prototype.createTOCWidgets = function (widget, widgets, fieldCode, bookmarkName, tocSettings, isFirstPara, isStartParagraph) {\n        var fieldBegin = undefined;\n        var tocPara = undefined;\n        var tocLine = undefined;\n        // tslint:disable-next-line:max-line-length\n        if (widgets.length === 1 && widgets[0].childWidgets[0].children.length === 3 && !isNullOrUndefined(isFirstPara) && !isFirstPara) {\n            tocLine = widgets[0].childWidgets[0];\n        }\n        else {\n            tocPara = new ParagraphWidget();\n            var styleName = undefined;\n            //Adds toc syles into paragraph\n            var headingStyleName = widget.paragraphFormat.baseStyle.name;\n            if (tocSettings.includeOutlineLevels && isNullOrUndefined(this.tocStyles[headingStyleName])) {\n                styleName = widget.paragraphFormat.outlineLevel;\n            }\n            else {\n                styleName = headingStyleName;\n            }\n            var tocStyleName = 'Toc' + this.tocStyles[styleName];\n            var paraStyle = this.viewer.styles.findByName(tocStyleName, 'Paragraph');\n            if (isNullOrUndefined(paraStyle)) {\n                // tslint:disable-next-line:max-line-length\n                this.viewer.owner.parser.parseStyle(JSON.parse(this.getCompleteStyles()), JSON.parse(this.viewer.preDefinedStyles.get(tocStyleName)), this.viewer.styles);\n                paraStyle = this.viewer.styles.findByName(tocStyleName, 'Paragraph');\n            }\n            tocPara.paragraphFormat.ApplyStyle(paraStyle);\n            //Creates right tab for page number.\n            if (tocSettings.rightAlign && tocSettings.includePageNumber) {\n                var tabStop = new WTabStop();\n                tabStop.position = HelperMethods.convertPixelToPoint(this.viewer.clientArea.width);\n                tabStop.tabLeader = tocSettings.tabLeader;\n                tabStop.deletePosition = 0;\n                tabStop.tabJustification = 'Right';\n                tocPara.paragraphFormat.tabs.push(tabStop);\n            }\n            tocLine = new LineWidget(tocPara);\n            tocPara.childWidgets.push(tocLine);\n        }\n        //creates toc field element if it is insert\n        if ((isFirstPara !== undefined) && isFirstPara) {\n            if (!isNullOrUndefined(isStartParagraph) && !isStartParagraph) {\n                this.appendEmptyPara(widgets);\n            }\n            this.createTocFieldElement(tocLine, fieldCode);\n        }\n        var text = '';\n        for (var lineIndex = 0; lineIndex < widget.childWidgets.length; lineIndex++) {\n            var lineWidget = widget.childWidgets[lineIndex];\n            for (var elementIndex = 0; elementIndex < lineWidget.children.length; elementIndex++) {\n                var element = lineWidget.children[elementIndex];\n                if (element instanceof TextElementBox || element instanceof ListTextElementBox) {\n                    var temp = element.text;\n                    var tabChar = '\\t';\n                    if (temp.indexOf(tabChar) !== -1) {\n                        temp = temp.replace(new RegExp(tabChar, 'g'), ' ');\n                    }\n                    text = text + temp;\n                }\n            }\n        }\n        if (text !== '') {\n            // inserts hyperlink\n            if (tocSettings.includeHyperlink && (bookmarkName !== undefined)) {\n                fieldBegin = this.insertTocHyperlink(tocLine, bookmarkName, text);\n            }\n            else {\n                var span = new TextElementBox();\n                span.text = text;\n                span.line = tocLine;\n                tocLine.children.push(span);\n            }\n            //inserts page number\n            if (tocSettings.includePageNumber && (bookmarkName !== undefined)) {\n                if (tocSettings.rightAlign) {\n                    var tabText = new TabElementBox();\n                    tabText.text = '\\t';\n                    tabText.line = tocLine;\n                    tocLine.children.push(tabText);\n                }\n                var pageField = this.insertTocPageNumber(bookmarkName, tocLine, tocSettings.rightAlign, widget);\n                this.appendEndField(pageField, tocLine);\n            }\n            if (tocSettings.includeHyperlink && fieldBegin !== undefined) {\n                this.appendEndField(fieldBegin, tocLine);\n            }\n        }\n        if (!isNullOrUndefined(tocPara) && (text !== '' || isFirstPara)) {\n            widgets.push(tocPara);\n        }\n    };\n    /**\n     * Inserts toc hyperlink.\n     */\n    Editor.prototype.insertTocHyperlink = function (lineWidget, bookmarkName, text) {\n        var fieldCode = ' HYPERLINK \\\\l \\\"' + bookmarkName + '\\\" ';\n        var fieldBegin = this.createTocFieldElement(lineWidget, fieldCode);\n        //text element.\n        var span = new TextElementBox();\n        span.text = text;\n        span.line = lineWidget;\n        lineWidget.children.push(span);\n        return fieldBegin;\n    };\n    /**\n     * Inserts toc page number.\n     */\n    // tslint:disable-next-line:max-line-length\n    Editor.prototype.insertTocPageNumber = function (bookMarkname, lineWidget, isRightAlign, widget) {\n        var fieldCode = ' PAGEREF' + bookMarkname + ' \\\\h ';\n        var fieldBegin = this.createTocFieldElement(lineWidget, fieldCode);\n        var text = (this.viewer.pages.indexOf(widget.bodyWidget.page) + 1).toString();\n        //text element.\n        var span = new FieldTextElementBox();\n        span.fieldBegin = fieldBegin;\n        if (!isRightAlign) {\n            text = ' ' + text;\n        }\n        span.text = text;\n        span.line = lineWidget;\n        lineWidget.children.push(span);\n        this.pageRefFields[bookMarkname] = span;\n        return fieldBegin;\n    };\n    Editor.prototype.updatePageRef = function () {\n        for (var _i = 0, _a = Object.keys(this.pageRefFields); _i < _a.length; _i++) {\n            var key = _a[_i];\n            var bookmark = this.viewer.bookmarks.get(key);\n            var pageRef = (bookmark.paragraph.bodyWidget.page.index + 1).toString();\n            var span = this.pageRefFields[key];\n            if (pageRef !== span.text) {\n                span.text = pageRef;\n                var paragraph = span.paragraph;\n                var lineIndex = paragraph.childWidgets.indexOf(span.line);\n                var elementIndex = span.line.children.indexOf(span);\n                this.viewer.layout.reLayoutParagraph(paragraph, lineIndex, elementIndex);\n            }\n        }\n    };\n    /**\n     * Inserts toc bookmark.\n     */\n    Editor.prototype.insertTocBookmark = function (widget) {\n        var bookmarkName = undefined;\n        var lineLength = widget.childWidgets.length;\n        if (lineLength > 0) {\n            var startLine = widget.childWidgets[0];\n            var endLine = widget.childWidgets[lineLength - 1];\n            if ((startLine !== undefined) && (endLine !== undefined)) {\n                var startElement = startLine.children[0];\n                //Returns the bookmark if already present for paragraph.\n                // tslint:disable-next-line:max-line-length\n                if (!isNullOrUndefined(startElement) && startElement instanceof BookmarkElementBox && startElement.bookmarkType === 0 && (startElement.name.toLowerCase().match('^_toc'))) {\n                    return startElement.name;\n                }\n                var endElement = endLine.children[endLine.children.length - 1];\n                if ((startElement !== undefined) && (endElement !== undefined)) {\n                    this.selection.start.setPositionForSelection(startLine, startElement, 0, this.selection.start.location);\n                    this.selection.end.setPositionForSelection(endLine, endElement, endElement.length, this.selection.end.location);\n                    bookmarkName = this.generateBookmarkName();\n                    this.insertBookmark(bookmarkName);\n                }\n            }\n        }\n        return bookmarkName;\n    };\n    /**\n     * Generates bookmark id.\n     */\n    Editor.prototype.generateBookmarkName = function () {\n        this.tocBookmarkId++;\n        var count = 10 - this.tocBookmarkId.toString().length;\n        var formatString = '';\n        while (count - 1 > 0) {\n            formatString = '0' + formatString;\n            count--;\n        }\n        var bookmarkName = '_Toc' + formatString + this.tocBookmarkId;\n        return bookmarkName;\n    };\n    /**\n     * Change cell content alignment\n     * @private\n     */\n    Editor.prototype.onCellContentAlignment = function (verticalAlignment, textAlignment) {\n        this.owner.isShiftingEnabled = true;\n        var selection = this.owner.selection;\n        if (selection.isEmpty && selection.start.paragraph.isInsideTable) {\n            if (this.owner.editorHistory) {\n                this.owner.editorHistory.initComplexHistory(selection, 'MultiSelection');\n            }\n            //Selecting the table cell to update the all the paragraph format.\n            selection.selectTableCell();\n            this.initHistory('CellContentVerticalAlignment');\n            var cellFormat = selection.start.paragraph.associatedCell.cellFormat;\n            this.applyCellPropertyValue(selection, 'verticalAlignment', verticalAlignment, cellFormat);\n            this.reLayout(selection, false);\n            this.initHistory('TextAlignment');\n            this.updateParagraphFormat('textAlignment', textAlignment, false);\n            this.reLayout(this.owner.selection, false);\n            if (this.owner.editorHistory) {\n                this.owner.editorHistory.updateComplexHistory();\n            }\n        }\n        else {\n            if (this.owner.editorHistory) {\n                this.owner.editorHistory.initComplexHistory(selection, 'MultiSelection');\n            }\n            if (!isNullOrUndefined(selection.getTable(selection.start, selection.end))) {\n                //Table cell vertical alignment.\n                this.updateSelectionTableFormat(selection, 'CellContentVerticalAlignment', verticalAlignment);\n                this.reLayout(this.owner.selection, false);\n                this.initHistory('TextAlignment');\n                //Paragraph text alignment.\n                this.updateSelectionParagraphFormatting('textAlignment', textAlignment, false);\n                this.reLayout(selection, false);\n            }\n            if (this.owner.editorHistory) {\n                this.owner.editorHistory.updateComplexHistory();\n            }\n        }\n    };\n    return Editor;\n}());\nexport { Editor };\n","import { WTableHolder } from '../viewer/page';\n/**\n * @private\n */\nvar ModifiedLevel = /** @class */ (function () {\n    function ModifiedLevel(owner, modified) {\n        this.ownerListLevelIn = undefined;\n        this.modifiedListLevelIn = undefined;\n        this.ownerListLevel = owner;\n        this.modifiedListLevel = modified;\n    }\n    Object.defineProperty(ModifiedLevel.prototype, \"ownerListLevel\", {\n        /**\n         * @private\n         */\n        get: function () {\n            return this.ownerListLevelIn;\n        },\n        /**\n         * @private\n         */\n        set: function (value) {\n            this.ownerListLevelIn = value;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(ModifiedLevel.prototype, \"modifiedListLevel\", {\n        /**\n         * @private\n         */\n        get: function () {\n            return this.modifiedListLevelIn;\n        },\n        /**\n         * @private\n         */\n        set: function (value) {\n            this.modifiedListLevelIn = value;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    /**\n     * @private\n     */\n    ModifiedLevel.prototype.destroy = function () {\n        this.ownerListLevel = undefined;\n        this.modifiedListLevel = undefined;\n    };\n    return ModifiedLevel;\n}());\nexport { ModifiedLevel };\n/**\n * @private\n */\nvar ModifiedParagraphFormat = /** @class */ (function () {\n    function ModifiedParagraphFormat(ownerFormat, modifiedFormat) {\n        this.ownerFormatIn = undefined;\n        this.modifiedFormatIn = undefined;\n        this.ownerFormat = ownerFormat;\n        this.modifiedFormat = modifiedFormat;\n    }\n    Object.defineProperty(ModifiedParagraphFormat.prototype, \"ownerFormat\", {\n        /**\n         * @private\n         */\n        get: function () {\n            return this.ownerFormatIn;\n        },\n        /**\n         * @private\n         */\n        set: function (value) {\n            this.ownerFormatIn = value;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(ModifiedParagraphFormat.prototype, \"modifiedFormat\", {\n        /**\n         * hidden\n         */\n        get: function () {\n            return this.modifiedFormatIn;\n        },\n        /**\n         * @private\n         */\n        set: function (value) {\n            this.modifiedFormatIn = value;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    /**\n     * @private\n     */\n    ModifiedParagraphFormat.prototype.destroy = function () {\n        this.ownerFormat = undefined;\n        this.modifiedFormat.destroy();\n        this.modifiedFormat = undefined;\n    };\n    return ModifiedParagraphFormat;\n}());\nexport { ModifiedParagraphFormat };\n/**\n * @private\n */\nvar RowHistoryFormat = /** @class */ (function () {\n    function RowHistoryFormat(startingPoint, rowFormat) {\n        this.startingPoint = startingPoint;\n        this.rowFormat = rowFormat;\n        this.rowHeightType = rowFormat.heightType;\n    }\n    RowHistoryFormat.prototype.revertChanges = function (isRedo, owner) {\n        //backup current format values.\n        var currentRowHeightType = this.rowFormat.heightType;\n        //Restore old values.\n        owner.editorModule.tableResize.updateRowHeight(this.rowFormat.ownerBase, isRedo ? this.displacement : (-this.displacement));\n        owner.viewer.layout.reLayoutTable(this.rowFormat.ownerBase.ownerTable);\n        if (this.rowFormat.heightType !== this.rowHeightType) {\n            this.rowFormat.heightType = this.rowHeightType;\n        }\n        //backup the current format values for redo.\n        this.rowHeightType = currentRowHeightType;\n    };\n    return RowHistoryFormat;\n}());\nexport { RowHistoryFormat };\n/**\n * @private\n */\nvar TableHistoryInfo = /** @class */ (function () {\n    function TableHistoryInfo(table, owner) {\n        this.tableHolder = new WTableHolder();\n        this.tableFormat = new TableFormatHistoryInfo();\n        this.rows = [];\n        this.owner = owner;\n        this.copyProperties(table);\n    }\n    TableHistoryInfo.prototype.copyProperties = function (table) {\n        if (table.tableHolder) {\n            this.tableHolder = table.tableHolder.clone();\n        }\n        if (table.tableFormat) {\n            this.tableFormat.leftIndent = table.tableFormat.leftIndent;\n            this.tableFormat.preferredWidth = table.tableFormat.preferredWidth;\n            this.tableFormat.preferredWidthType = table.tableFormat.preferredWidthType;\n        }\n        for (var i = 0; i < table.childWidgets.length; i++) {\n            var row = table.childWidgets[i];\n            var rowFormat = new RowFormatHistoryInfo();\n            rowFormat.gridBefore = row.rowFormat.gridBefore;\n            rowFormat.gridBeforeWidth = row.rowFormat.gridBeforeWidth;\n            rowFormat.gridBeforeWidthType = row.rowFormat.gridBeforeWidthType;\n            rowFormat.gridAfter = row.rowFormat.gridAfter;\n            rowFormat.gridAfterWidth = row.rowFormat.gridAfterWidth;\n            rowFormat.gridAfterWidthType = row.rowFormat.gridAfterWidthType;\n            for (var j = 0; j < row.childWidgets.length; j++) {\n                var cell = row.childWidgets[j];\n                var cellFormat = new CellFormatHistoryInfo();\n                cellFormat.columnIndex = cell.columnIndex;\n                cellFormat.columnSpan = cell.cellFormat.columnSpan;\n                cellFormat.preferredWidth = cell.cellFormat.preferredWidth;\n                cellFormat.preferredWidthType = cell.cellFormat.preferredWidthType;\n                rowFormat.cells.push(cellFormat);\n            }\n            this.rows.push(rowFormat);\n        }\n        this.tableHierarchicalIndex = this.owner.editorModule.getHierarchicalIndex(table, '0');\n    };\n    TableHistoryInfo.prototype.destroy = function () {\n        this.tableHierarchicalIndex = undefined;\n        if (this.tableHolder) {\n            this.tableHolder.destroy();\n            this.tableHolder = undefined;\n        }\n        if (this.tableFormat) {\n            this.tableFormat = null;\n        }\n        if (this.rows) {\n            this.rows = [];\n            this.rows = undefined;\n        }\n    };\n    return TableHistoryInfo;\n}());\nexport { TableHistoryInfo };\n/**\n * @private\n */\nvar TableFormatHistoryInfo = /** @class */ (function () {\n    function TableFormatHistoryInfo() {\n        /* tslint:disable:no-empty */\n    }\n    return TableFormatHistoryInfo;\n}());\nexport { TableFormatHistoryInfo };\n/**\n * @private\n */\nvar RowFormatHistoryInfo = /** @class */ (function () {\n    function RowFormatHistoryInfo() {\n        this.cells = [];\n    }\n    return RowFormatHistoryInfo;\n}());\nexport { RowFormatHistoryInfo };\n/**\n * @private\n */\nvar CellFormatHistoryInfo = /** @class */ (function () {\n    function CellFormatHistoryInfo() {\n        /* tslint:disable:no-empty */\n    }\n    return CellFormatHistoryInfo;\n}());\nexport { CellFormatHistoryInfo };\n/**\n * @private\n */\nvar CellHistoryFormat = /** @class */ (function () {\n    function CellHistoryFormat(point) {\n        this.startingPoint = point; // starting point preserved to calculate the displacement on after cell resizing finished.\n    }\n    return CellHistoryFormat;\n}());\nexport { CellHistoryFormat };\n","import { WParagraphFormat } from '../format/paragraph-format';\nimport { WSectionFormat } from '../format/section-format';\nimport { WCharacterFormat } from '../format/character-format';\nimport { WListFormat } from '../format/list-format';\nimport { ModifiedLevel, RowHistoryFormat, TableHistoryInfo } from './history-helper';\nimport { BlockWidget, ParagraphWidget, BodyWidget, TableCellWidget, TableWidget, TableRowWidget, HeaderFooterWidget } from '../viewer/page';\nimport { Dictionary } from '../../base/dictionary';\nimport { TextPosition, ImageFormat } from '../index';\nimport { isNullOrUndefined } from '@syncfusion/ej2-base';\nimport { ElementBox } from '../viewer/page';\nimport { WTableFormat, WRowFormat, WCellFormat, WParagraphStyle } from '../format/index';\n/**\n * @private\n */\nvar BaseHistoryInfo = /** @class */ (function () {\n    function BaseHistoryInfo(node) {\n        this.ownerIn = node;\n        this.viewer = node.viewer;\n        this.modifiedPropertiesIn = [];\n        this.modifiedNodeLength = [];\n        this.removedNodesIn = [];\n    }\n    Object.defineProperty(BaseHistoryInfo.prototype, \"owner\", {\n        //Properties\n        //gets owner control\n        /**\n         * gets the owner control\n         * @private\n         */\n        get: function () { return this.ownerIn; },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(BaseHistoryInfo.prototype, \"editorHistory\", {\n        /**\n         * gets or sets action\n         * @private\n         */\n        get: function () {\n            return this.owner.editorHistory;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(BaseHistoryInfo.prototype, \"action\", {\n        /**\n         * gets or sets action\n         * @private\n         */\n        get: function () { return this.actionIn; },\n        set: function (value) { this.actionIn = value; },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(BaseHistoryInfo.prototype, \"modifiedProperties\", {\n        /**\n         * gets modified properties\n         * @returns Object\n         * @private\n         */\n        get: function () { return this.modifiedPropertiesIn; },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(BaseHistoryInfo.prototype, \"removedNodes\", {\n        /**\n         * @private\n         */\n        get: function () {\n            return this.removedNodesIn;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(BaseHistoryInfo.prototype, \"selectionStart\", {\n        /**\n         * Gets or Sets the selection start\n         * @private\n         */\n        //gets or sets selection start\n        get: function () { return this.selectionStartIn; },\n        set: function (value) { this.selectionStartIn = value; },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(BaseHistoryInfo.prototype, \"selectionEnd\", {\n        /**\n         * Gets or Sets the selection end\n         * @private\n         */\n        get: function () { return this.selectionEndIn; },\n        set: function (value) { this.selectionEndIn = value; },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(BaseHistoryInfo.prototype, \"insertPosition\", {\n        /**\n         * Gets or sets the insert position\n         * @private\n         */\n        get: function () { return this.insertPositionIn; },\n        set: function (value) { this.insertPositionIn = value; },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(BaseHistoryInfo.prototype, \"endPosition\", {\n        /**\n         * Gets or sets end position\n         * @private\n         */\n        get: function () { return this.endPositionIn; },\n        set: function (value) { this.endPositionIn = value; },\n        enumerable: true,\n        configurable: true\n    });\n    /**\n     * Update the selection\n     * @param selection\n     * @private\n     */\n    BaseHistoryInfo.prototype.updateSelection = function () {\n        var blockInfo = this.owner.editorModule.getParagraphInfo(this.owner.selection.start);\n        this.selectionStart = this.owner.editorModule.getHierarchicalIndex(blockInfo.paragraph, blockInfo.offset.toString());\n        blockInfo = this.owner.editorModule.getParagraphInfo(this.owner.selection.end);\n        this.selectionEnd = this.owner.editorModule.getHierarchicalIndex(blockInfo.paragraph, blockInfo.offset.toString());\n    };\n    BaseHistoryInfo.prototype.setBookmarkInfo = function (bookmark) {\n        this.removedNodes.push({ 'bookmark': bookmark, 'startIndex': bookmark.indexInOwner, 'endIndex': bookmark.reference.indexInOwner });\n    };\n    BaseHistoryInfo.prototype.revertBookmark = function () {\n        var bookmarkInfo = this.removedNodes[0];\n        var bookmark = bookmarkInfo.bookmark;\n        if (this.editorHistory.isUndoing) {\n            this.viewer.bookmarks.add(bookmark.name, bookmark);\n            bookmark.line.children.splice(bookmarkInfo.startIndex, 0, bookmark);\n            bookmark.reference.line.children.splice(bookmarkInfo.endIndex, 0, bookmark.reference);\n            this.editorHistory.recordChanges(this);\n        }\n        else {\n            this.owner.editorModule.deleteBookmarkInternal(bookmark);\n            this.editorHistory.undoStack.push(this);\n        }\n    };\n    /**\n     * Reverts this instance\n     * @private\n     */\n    // tslint:disable: max-func-body-length\n    BaseHistoryInfo.prototype.revert = function () {\n        if (this.action === 'DeleteBookmark') {\n            this.revertBookmark();\n            return;\n        }\n        this.owner.isShiftingEnabled = true;\n        var selectionStartTextPosition = undefined;\n        var selectionEndTextPosition = undefined;\n        var start = this.selectionStart;\n        var end = this.selectionEnd;\n        var isForwardSelection = TextPosition.isForwardSelection(start, end);\n        if (this.modifiedProperties.length > 0 || this.action === 'Selection' || this.action === 'ClearCharacterFormat'\n            || this.action === 'ClearParagraphFormat') {\n            selectionStartTextPosition = this.getTextPosition(start);\n            selectionEndTextPosition = this.getTextPosition(end);\n            this.revertModifiedProperties(selectionStartTextPosition, selectionEndTextPosition);\n        }\n        else {\n            var deletedNodes = this.removedNodes;\n            this.removedNodesIn = [];\n            var isForward = TextPosition.isForwardSelection(this.insertPosition, this.endPosition);\n            var insertTextPosition = this.getTextPosition(isForward ? this.insertPosition : this.endPosition);\n            var endTextPosition = this.getTextPosition(isForward ? this.endPosition : this.insertPosition);\n            if (insertTextPosition.isAtSamePosition(endTextPosition)) {\n                this.owner.selection.selectContent(insertTextPosition, true);\n            }\n            else {\n                this.owner.selection.selectPosition(insertTextPosition, endTextPosition);\n            }\n            if (this.action === 'InsertHyperlink' && this.editorHistory.isRedoing) {\n                var fieldBegin = this.owner.selection.getHyperlinkField();\n                if (!isNullOrUndefined(fieldBegin)) {\n                    var offset = (fieldBegin.line).getOffset(fieldBegin, 0);\n                    insertTextPosition.setPositionParagraph(fieldBegin.line, offset);\n                    this.owner.selection.start.setPositionInternal(insertTextPosition);\n                    offset = fieldBegin.fieldEnd.line.getOffset(fieldBegin.fieldEnd, 1);\n                    endTextPosition.setPositionParagraph(fieldBegin.fieldEnd.line, offset);\n                }\n            }\n            this.editorHistory.currentBaseHistoryInfo = this;\n            this.selectionStart = this.insertPosition;\n            this.insertPosition = undefined;\n            this.selectionEnd = this.endPosition;\n            this.endPosition = undefined;\n            var isRemoveContent = false;\n            if (!insertTextPosition.isAtSamePosition(endTextPosition)) {\n                isRemoveContent = this.action === 'BackSpace' || this.action === 'Delete' || this.action === 'ClearCells'\n                    || this.action === 'DeleteCells';\n                if (!(isRemoveContent) && this.action !== 'MergeCells' && this.action !== 'InsertRowAbove'\n                    && this.action !== 'InsertRowBelow' && this.action !== 'InsertColumnLeft'\n                    && this.action !== 'InsertColumnRight' && this.action !== 'Borders'\n                    && this.action !== 'DeleteTable' && this.action !== 'DeleteColumn' && this.action !== 'DeleteRow') {\n                    this.owner.selection.end.setPositionInternal(endTextPosition);\n                    if (!this.owner.selection.isEmpty) {\n                        if (this.editorHistory.isRedoing) {\n                            this.owner.editorModule.removeSelectedContents(this.owner.selection);\n                        }\n                        else {\n                            this.owner.editorModule.deleteSelectedContents(this.owner.selection, true);\n                        }\n                    }\n                }\n            }\n            var isRedoAction = this.editorHistory.isRedoing && !isRemoveContent;\n            this.revertModifiedNodes(deletedNodes, isRedoAction, isForwardSelection ? start : end, start === end);\n            if (isRemoveContent) {\n                this.removeContent(insertTextPosition, endTextPosition);\n            }\n            //this.owner.editorModule.reLayout(this.viewer.selection);\n        }\n        var isSelectionChanged = false;\n        if ((this.editorHistory.isUndoing && isNullOrUndefined(this.editorHistory.currentHistoryInfo)) ||\n            ((this.action === 'InsertRowAbove' || this.action === 'Borders' || this.action === 'InsertRowBelow'\n                || this.action === 'InsertColumnLeft'\n                || this.action === 'InsertColumnRight') && (this.editorHistory.isRedoing\n                || this.editorHistory.currentHistoryInfo.action === 'Paste'))) {\n            selectionStartTextPosition = this.getTextPosition(start);\n            selectionEndTextPosition = this.getTextPosition(end);\n            this.owner.selection.selectRange(selectionStartTextPosition, selectionEndTextPosition);\n            isSelectionChanged = true;\n        }\n        // Updates insert position of history info instance.\n        this.insertPosition = start;\n        this.endPosition = end;\n        this.owner.editorModule.reLayout(this.owner.selection, this.owner.selection.isEmpty);\n        if (isSelectionChanged) {\n            this.viewer.scrollToPosition(this.owner.selection.start, this.owner.selection.end);\n        }\n        this.highlightListText();\n    };\n    BaseHistoryInfo.prototype.highlightListText = function () {\n        if (!isNullOrUndefined(this.editorHistory.currentHistoryInfo)) {\n            // tslint:disable-next-line:max-line-length\n            if (this.action === 'ListCharacterFormat' || (this.editorHistory.currentHistoryInfo.action === 'ListSelect' && this.action === 'ListFormat')) {\n                var selectionStartTextPosition = this.getTextPosition(this.selectionStart);\n                var widget = selectionStartTextPosition.currentWidget;\n                this.viewer.selection.highlightListText(widget);\n            }\n        }\n    };\n    BaseHistoryInfo.prototype.removeContent = function (insertTextPosition, endTextPosition) {\n        //If the base parent of the insert text position and end text position is null \n        //then the paragraphs already removed.\n        //Example scenario: In table editing that is delete cells operation \n        // we will backed up the entire table ad it will be replaced on undo operation.\n        //At that time if the positions are in table \n        //which is already replaced in undo (revert modified nodes method) then the base parent of the paragraph will be null.\n        //So again, selecting the content and deleting is unnecessary\n        // and it will cause improper position updates and null reference exceptions. \n        if ((!isNullOrUndefined(insertTextPosition.paragraph.containerWidget) &&\n            insertTextPosition.paragraph.containerWidget instanceof BodyWidget &&\n            (!isNullOrUndefined(endTextPosition.paragraph.containerWidget)\n                && endTextPosition.paragraph.containerWidget instanceof BodyWidget))\n            || (!isNullOrUndefined(insertTextPosition.paragraph.containerWidget)\n                && !isNullOrUndefined(endTextPosition.paragraph.containerWidget)\n                && insertTextPosition.paragraph.containerWidget instanceof TableCellWidget\n                && endTextPosition.paragraph.containerWidget instanceof TableCellWidget\n                && !isNullOrUndefined(insertTextPosition.paragraph.bodyWidget))) {\n            //Removes if any empty paragraph is added while delete.\n            this.owner.selection.selectRange(insertTextPosition, endTextPosition);\n            var isDelete = (this.action === 'BackSpace') ? true : false;\n            this.owner.editorModule.deleteSelectedContents(this.owner.selection, isDelete);\n        }\n    };\n    BaseHistoryInfo.prototype.revertModifiedProperties = function (start, end) {\n        if (this.action === 'CellFormat' || this.action === 'CellOptions' || this.action === 'TableOptions') {\n            this.owner.isShiftingEnabled = false;\n        }\n        this.owner.selection.selectRange(start, end);\n        if (this.action === 'RowResizing' || this.action === 'CellResizing') {\n            this.revertResizing();\n        }\n        else if (this.action === 'CellOptions' || this.action === 'TableOptions') {\n            this.revertTableDialogProperties(this.action);\n        }\n        else if (this.action !== 'Selection') {\n            this.revertProperties();\n        }\n    };\n    // Redoes the Action\n    BaseHistoryInfo.prototype.redoAction = function () {\n        var editor = this.owner.editorModule;\n        switch (this.action) {\n            case 'BackSpace':\n                editor.singleBackspace(this.owner.selection, true);\n                break;\n            case 'Delete':\n                editor.singleDelete(this.owner.selection, true);\n                break;\n            case 'DeleteTable':\n                editor.deleteTable();\n                break;\n            case 'DeleteColumn':\n                editor.deleteColumn();\n                break;\n            case 'DeleteRow':\n                editor.deleteRow();\n                break;\n            case 'MergeCells':\n                editor.mergeSelectedCellsInTable();\n                break;\n            case 'InsertRowAbove':\n                editor.insertRow(true);\n                break;\n            case 'InsertRowBelow':\n                editor.insertRow(false);\n                break;\n            case 'InsertColumnLeft':\n                editor.insertColumn(true);\n                break;\n            case 'InsertColumnRight':\n                editor.insertColumn(true);\n                break;\n            case 'SectionBreak':\n                editor.insertSection(this.owner.selection, true);\n                break;\n        }\n    };\n    /**\n     * Revert the modified nodes\n     * @param  {WNode[]} deletedNodes\n     * @param  {boolean} isRedoAction\n     * @param  {string} start\n     * @param  {boolean} isEmptySelection\n     */\n    BaseHistoryInfo.prototype.revertModifiedNodes = function (deletedNodes, isRedoAction, start, isEmptySelection) {\n        if (isRedoAction && (this.action === 'BackSpace' || this.action === 'Delete' || this.action === 'DeleteTable'\n            || this.action === 'DeleteColumn' || this.action === 'DeleteRow' || this.action === 'InsertRowAbove' ||\n            this.action === 'InsertRowBelow' || this.action === 'InsertColumnLeft' || this.action === 'InsertColumnRight'\n            || this.action === 'MergeCells' || this.action === 'SectionBreak')) {\n            this.redoAction();\n            if (this.action === 'SectionBreak') {\n                return;\n            }\n        }\n        if (deletedNodes.length > 0) {\n            if ((this.editorHistory.isUndoing && (this.action === 'DeleteCells' || this.action === 'DeleteColumn'\n                || this.action === 'DeleteRow' || this.action === 'MergeCells'))\n                || (this.action === 'InsertRowAbove' || this.action === 'InsertRowBelow' || this.action === 'InsertColumnLeft'\n                    || this.action === 'ClearCells' || this.action === 'InsertColumnRight' || this.action === 'Borders')) {\n                var insertIndex = this.selectionStart;\n                var block = this.owner.editorModule.getBlock({ index: insertIndex }).node;\n                var lastNode = deletedNodes[deletedNodes.length - 1];\n                if ((block instanceof TableWidget || block.previousRenderedWidget instanceof TableWidget || block.isInsideTable)\n                    && lastNode instanceof TableWidget) {\n                    if (block instanceof ParagraphWidget && !block.isInsideTable) {\n                        block = block.previousRenderedWidget;\n                    }\n                    block = block.combineWidget(this.viewer);\n                    this.owner.editorModule.insertTableInternal(block, lastNode, false);\n                    deletedNodes.splice(deletedNodes.indexOf(lastNode), 1);\n                }\n                else if (lastNode instanceof TableWidget) {\n                    this.owner.editorModule.insertBlock(lastNode);\n                }\n            }\n            else {\n                var initialStart = start;\n                var block = this.owner.editorModule.getBlock({ index: initialStart }).node;\n                // initialStart = blockObj.position;\n                if (deletedNodes.length > 0 && (this.action === 'BackSpace' && isEmptySelection\n                    || (!(block instanceof TableWidget) && !(block instanceof HeaderFooterWidget)))) {\n                    var lastNode = deletedNodes[0];\n                    if (this.action === 'SectionBreak' && lastNode instanceof BodyWidget ||\n                        !isNullOrUndefined(this.editorHistory.currentHistoryInfo) &&\n                            this.editorHistory.currentHistoryInfo.action === 'PageBreak') {\n                        lastNode = deletedNodes[1];\n                    }\n                    if (lastNode instanceof ParagraphWidget && this.owner.selection.start.offset > 0) {\n                        this.owner.editorModule.insertNewParagraphWidget(lastNode, true);\n                        deletedNodes.splice(deletedNodes.indexOf(lastNode), 1);\n                        if (isNullOrUndefined(block)) {\n                            // tslint:disable-next-line:max-line-length\n                            var nextBlock = this.viewer.selection.getNextParagraphBlock(lastNode.getSplitWidgets().pop());\n                            this.owner.selection.getNextRenderedBlock(lastNode);\n                            if (isNullOrUndefined(nextBlock)) {\n                                //Sets the selection as starting of last paragraph.\n                                this.owner.selection.selectParagraph(lastNode, true);\n                            }\n                        }\n                    }\n                    if (lastNode instanceof TableWidget && this.owner.selection.start.offset > 0) {\n                        var firstBlock = deletedNodes[deletedNodes.length - 1];\n                        if (firstBlock instanceof ParagraphWidget) {\n                            this.owner.editorModule.insertNewParagraphWidget(firstBlock, true);\n                            deletedNodes.splice(deletedNodes.indexOf(firstBlock), 1);\n                            if (isNullOrUndefined(block)) {\n                                // tslint:disable-next-line:max-line-length\n                                var nextBlock = this.viewer.selection.getNextParagraphBlock(firstBlock.getSplitWidgets().pop());\n                                if (isNullOrUndefined(nextBlock)) {\n                                    //Sets the selection as starting of last paragraph.\n                                    this.owner.selection.selectParagraph(firstBlock, true);\n                                }\n                            }\n                        }\n                    }\n                }\n                if (deletedNodes.length > 0) {\n                    var firstNode = deletedNodes[deletedNodes.length - 1];\n                    if (block instanceof TableWidget) {\n                        block = block.combineWidget(this.viewer);\n                        if (firstNode instanceof TableWidget) {\n                            this.owner.editorModule.insertTableInternal(block, firstNode, true);\n                            deletedNodes.splice(deletedNodes.indexOf(firstNode), 1);\n                            this.insertPosition = start;\n                            var nextWidget = firstNode.getSplitWidgets().pop();\n                            if (nextWidget.nextRenderedWidget instanceof TableWidget) {\n                                block = nextWidget.nextRenderedWidget;\n                            }\n                            else {\n                                initialStart = start;\n                                block = this.owner.editorModule.getBlock({ index: initialStart }).node;\n                            }\n                        }\n                    }\n                    //Checks if first node is paragraph and current insert position is paragraph end.\n                    // tslint:disable-next-line:max-line-length\n                    if (firstNode instanceof ParagraphWidget && this.owner.selection.start.offset > 0\n                        && this.owner.selection.start.offset === this.owner.selection.getLineLength(this.owner.selection.start.paragraph.lastChild)) {\n                        var editor = this.owner.editorModule;\n                        editor.insertNewParagraphWidget(firstNode, false);\n                        deletedNodes.splice(deletedNodes.indexOf(firstNode), 1);\n                        //Removes the intermediate empty paragraph instance.\n                        if (this.action !== 'Paste') {\n                            editor.removeBlock(this.owner.selection.start.paragraph);\n                        }\n                        // tslint:disable-next-line:max-line-length\n                        var paragraph = this.viewer.selection.getNextParagraphBlock(firstNode.getSplitWidgets().pop());\n                        if (!isNullOrUndefined(paragraph)) {\n                            this.owner.selection.selectParagraph(paragraph, true);\n                        }\n                    }\n                    else if (deletedNodes[0] instanceof TableWidget && deletedNodes.length !== 1) {\n                        var nextNode = deletedNodes[1];\n                        if (nextNode instanceof ParagraphWidget && nextNode.isEmpty()) {\n                            deletedNodes.splice(deletedNodes.indexOf(nextNode), 1);\n                        }\n                    }\n                }\n                if (deletedNodes.length > 0) {\n                    if (block instanceof TableWidget) {\n                        block = block.combineWidget(this.viewer);\n                    }\n                    this.insertRemovedNodes(deletedNodes, block);\n                }\n            }\n        }\n    };\n    BaseHistoryInfo.prototype.insertRemovedNodes = function (deletedNodes, block) {\n        for (var i = deletedNodes.length - 1, index = 0; i > -1; i--) {\n            var node = deletedNodes[i];\n            if (node instanceof ElementBox) {\n                this.owner.editorModule.insertInlineInSelection(this.owner.selection, node);\n            }\n            else if (node instanceof BlockWidget) {\n                if (node instanceof TableRowWidget) {\n                    if (block instanceof TableWidget) {\n                        block.childWidgets.splice(index, 0, node);\n                        this.owner.editorModule.updateNextBlocksIndex(node, true);\n                        if (i === 0 || !(deletedNodes[i - 1] instanceof TableRowWidget)) {\n                            // tslint:disable-next-line:max-line-length\n                            this.viewer.layout.layoutBodyWidgetCollection(block.index, block.containerWidget, block, false);\n                        }\n                    }\n                }\n                else if (block instanceof TableWidget) {\n                    this.owner.editorModule.insertBlockTable(this.owner.selection, node, block);\n                }\n                else {\n                    this.owner.editorModule.insertBlock(node);\n                }\n            }\n            else if (node instanceof BodyWidget) {\n                this.owner.editorModule.insertSection(this.owner.selection, false);\n            }\n        }\n        deletedNodes = [];\n    };\n    BaseHistoryInfo.prototype.revertResizing = function () {\n        this.editorHistory.currentBaseHistoryInfo = this;\n        if (this.action === 'RowResizing') {\n            if (this.modifiedProperties[0] instanceof RowHistoryFormat) {\n                // tslint:disable-next-line:max-line-length\n                this.modifiedProperties[0].revertChanges(this.editorHistory.isRedoing, this.owner);\n            }\n        }\n        else {\n            if (this.modifiedProperties[0] instanceof TableHistoryInfo) {\n                //selected cell resizing the condition checks done based on the selected widgets only. so need to highlight the selection.\n                if (this.owner.selection.selectedWidgets.length === 0) {\n                    this.owner.selection.highlightSelection(true);\n                }\n                var prevTableHistoryInfo = this.modifiedProperties[0];\n                var position = prevTableHistoryInfo.tableHierarchicalIndex;\n                var block = this.owner.editorModule.getBlock({ index: position }).node;\n                if (block instanceof TableWidget) {\n                    var tableResize = this.owner.editorModule.tableResize;\n                    this.owner.editor.setOffsetValue(this.owner.selection);\n                    block = block.combineWidget(this.owner.viewer);\n                    tableResize.currentResizingTable = block;\n                    this.modifiedProperties.splice(0, 1);\n                    if (this.editorHistory.isUndoing || this.editorHistory.isRedoing) {\n                        var tableHistoryInfoCurrent = new TableHistoryInfo(block, this.owner);\n                        this.modifiedProperties.splice(0, 0, tableHistoryInfoCurrent);\n                        this.owner.isLayoutEnabled = false;\n                        tableResize.applyProperties(tableResize.currentResizingTable, prevTableHistoryInfo);\n                        tableResize.currentResizingTable.isGridUpdated = true;\n                        this.owner.isLayoutEnabled = true;\n                        tableResize.updateGridValue(tableResize.currentResizingTable, false);\n                        prevTableHistoryInfo.destroy();\n                        prevTableHistoryInfo = undefined;\n                    }\n                }\n            }\n        }\n    };\n    BaseHistoryInfo.prototype.revertTableDialogProperties = function (action) {\n        this.owner.isShiftingEnabled = false;\n        this.editorHistory.currentBaseHistoryInfo = this;\n        this.currentPropertyIndex = 0;\n        if (action === 'CellOptions') {\n            var selection = this.owner.selection;\n            var cellFormat = this.modifiedProperties[0];\n            this.owner.editorModule.updateCellMargins(selection, cellFormat);\n        }\n        else if (action === 'TableOptions') {\n            this.owner.tableOptionsDialogModule.applyTableOptionsHelper(this.modifiedProperties[0]);\n        }\n        this.currentPropertyIndex = 0;\n        this.owner.isShiftingEnabled = true;\n    };\n    BaseHistoryInfo.prototype.getTextPosition = function (hierarchicalIndex) {\n        var textPosition = new TextPosition(this.owner);\n        var blockInfo = this.owner.editorModule.getParagraph({ index: hierarchicalIndex });\n        var lineInfo = this.owner.editorModule.getLineInfo(blockInfo.paragraph, blockInfo.offset);\n        textPosition.setPositionForLineWidget(lineInfo.line, lineInfo.offset);\n        return textPosition;\n    };\n    /**\n     * Add modified properties for section format\n     * @param  {WSectionFormat} format\n     * @param  {string} property\n     * @param  {Object} value\n     * @private\n     */\n    BaseHistoryInfo.prototype.addModifiedPropertiesForSection = function (format, property, value) {\n        if (this.editorHistory.isUndoing || this.editorHistory.isRedoing) {\n            var modifiedProperties = this.modifiedProperties;\n            var previousFormat = (this.currentPropertyIndex < modifiedProperties.length ?\n                modifiedProperties[this.currentPropertyIndex] : modifiedProperties[modifiedProperties.length - 1]);\n            if (isNullOrUndefined(property)) {\n                value = previousFormat;\n                if (this.currentPropertyIndex < this.modifiedProperties.length) {\n                    this.modifiedProperties[this.currentPropertyIndex] = format.cloneFormat();\n                }\n                else {\n                    this.modifiedProperties[this.modifiedProperties.length - 1] = format.cloneFormat();\n                }\n            }\n            else {\n                value = previousFormat.getPropertyValue(property);\n                previousFormat.copyFormat(format);\n            }\n            this.currentPropertyIndex++;\n        }\n        else {\n            if (isNullOrUndefined(property)) {\n                this.modifiedProperties.push(format.cloneFormat());\n            }\n            else {\n                var currentFormat = new WSectionFormat();\n                currentFormat.copyFormat(format);\n                this.modifiedProperties.push(currentFormat);\n            }\n        }\n        return value;\n    };\n    /**\n     * Add the modified properties for character format\n     * @param  {WCharacterFormat} format\n     * @param  {string} property\n     * @param  {Object} value\n     * @private\n     */\n    BaseHistoryInfo.prototype.addModifiedProperties = function (format, property, value) {\n        if (this.editorHistory.isUndoing || this.editorHistory.isRedoing) {\n            // tslint:disable-next-line:max-line-length           \n            var previousFormat = (this.currentPropertyIndex < this.modifiedProperties.length ? this.modifiedProperties[this.currentPropertyIndex] : this.modifiedProperties[this.modifiedProperties.length - 1]);\n            var skipRemove = false;\n            if (format.ownerBase instanceof ElementBox) {\n                var prevLength = this.modifiedNodeLength[this.currentPropertyIndex];\n                if (format.ownerBase.length < prevLength) {\n                    skipRemove = true;\n                    this.modifiedNodeLength[this.currentPropertyIndex] = format.ownerBase.length;\n                    this.modifiedNodeLength.splice(this.currentPropertyIndex + 1, 0, prevLength - format.ownerBase.length);\n                    //Adds a copy of character format at next position for splitted inline.\n                    var nextFormat = new WCharacterFormat(undefined);\n                    nextFormat.copyFormat(previousFormat);\n                    this.modifiedProperties.splice(this.currentPropertyIndex + 1, 0, nextFormat);\n                }\n            }\n            if (this.action === 'ClearCharacterFormat') {\n                if (this.editorHistory.isUndoing) {\n                    value = previousFormat;\n                    if (!skipRemove) {\n                        this.modifiedProperties.splice(this.currentPropertyIndex, 1);\n                        this.currentPropertyIndex--;\n                    }\n                }\n                else {\n                    this.modifiedProperties.push(format.cloneFormat());\n                }\n            }\n            else {\n                value = previousFormat;\n                if (this.currentPropertyIndex < this.modifiedProperties.length) {\n                    this.modifiedProperties[this.currentPropertyIndex] = format.cloneFormat();\n                }\n                else {\n                    this.modifiedProperties[this.modifiedProperties.length - 1] = format.cloneFormat();\n                }\n            }\n            this.currentPropertyIndex++;\n        }\n        else {\n            if (isNullOrUndefined(property)) {\n                this.modifiedProperties.push(format.cloneFormat());\n            }\n            else {\n                var currentFormat = new WCharacterFormat(undefined);\n                currentFormat.copyFormat(format);\n                this.modifiedProperties.push(currentFormat);\n            }\n            if (format.ownerBase instanceof ElementBox) {\n                this.modifiedNodeLength.push(format.ownerBase.length);\n            }\n            else {\n                this.modifiedNodeLength.push(0);\n            }\n        }\n        return value;\n    };\n    /**\n     * Add the modified properties for paragraph format\n     * @param  {WParagraphFormat} format\n     * @param  {string} property\n     * @param  {Object} value\n     * @private\n     */\n    BaseHistoryInfo.prototype.addModifiedPropertiesForParagraphFormat = function (format, property, value) {\n        if (this.editorHistory.isUndoing || this.editorHistory.isRedoing) {\n            // tslint:disable-next-line:max-line-length\n            var previousFormat = (this.currentPropertyIndex < this.modifiedProperties.length ? this.modifiedProperties[this.currentPropertyIndex] : this.modifiedProperties[this.modifiedProperties.length - 1]);\n            if (this.action === 'ClearParagraphFormat') {\n                if (this.editorHistory.isUndoing) {\n                    value = previousFormat;\n                    this.modifiedProperties.splice(this.currentPropertyIndex, 1);\n                    this.currentPropertyIndex--;\n                }\n                else {\n                    this.modifiedProperties.push(format.cloneFormat());\n                }\n                this.currentPropertyIndex++;\n                return value;\n            }\n            if (isNullOrUndefined(property)) {\n                value = previousFormat;\n                if (this.currentPropertyIndex < this.modifiedProperties.length) {\n                    this.modifiedProperties[this.currentPropertyIndex] = format.cloneFormat();\n                }\n                else {\n                    this.modifiedProperties[this.modifiedProperties.length - 1] = format.cloneFormat();\n                }\n                this.currentPropertyIndex++;\n                return value;\n            }\n            if (property === 'listFormat') {\n                value = new WParagraphFormat(undefined);\n                value.copyFormat(previousFormat);\n                previousFormat.listFormat = new WListFormat();\n                previousFormat.listFormat.copyFormat(format.listFormat);\n                this.currentPropertyIndex++;\n                return value;\n            }\n            if (property === 'styleName') {\n                if (!isNullOrUndefined(previousFormat.baseStyle)) {\n                    value = new WParagraphStyle();\n                    value.copyStyle(previousFormat.baseStyle);\n                    this.currentPropertyIndex++;\n                    return value;\n                }\n                else {\n                    return undefined;\n                }\n            }\n            value = previousFormat.getPropertyValue(property);\n            previousFormat.copyFormat(format);\n            this.currentPropertyIndex++;\n        }\n        else {\n            if (isNullOrUndefined(property)) {\n                this.modifiedProperties.push(format.cloneFormat());\n            }\n            else {\n                var currentFormat = new WParagraphFormat(undefined);\n                currentFormat.copyFormat(format);\n                this.modifiedProperties.push(currentFormat);\n            }\n        }\n        return value;\n    };\n    /**\n     * @private\n     */\n    BaseHistoryInfo.prototype.addModifiedPropertiesForContinueNumbering = function (paragraphFormat, value) {\n        if (this.editorHistory.isUndoing || this.editorHistory.isRedoing) {\n            // tslint:disable-next-line:max-line-length\n            var previousFormat = (this.currentPropertyIndex < this.modifiedProperties.length ? this.modifiedProperties[this.currentPropertyIndex] : this.modifiedProperties[this.modifiedProperties.length - 1]);\n            value = previousFormat;\n            if (this.currentPropertyIndex < this.modifiedProperties.length) {\n                this.modifiedProperties[this.currentPropertyIndex] = paragraphFormat.cloneFormat();\n            }\n            else {\n                this.modifiedProperties[this.modifiedProperties.length - 1] = paragraphFormat.cloneFormat();\n            }\n            this.currentPropertyIndex++;\n            return value;\n        }\n        else {\n            var currentFormat = new WParagraphFormat();\n            currentFormat.copyFormat(paragraphFormat);\n            this.modifiedProperties.push(currentFormat);\n        }\n        return value;\n    };\n    /**\n     * @param listFormat\n     * @param value\n     * @private\n     */\n    BaseHistoryInfo.prototype.addModifiedPropertiesForRestartNumbering = function (listFormat, value) {\n        if (this.editorHistory.isUndoing || this.editorHistory.isRedoing) {\n            // tslint:disable-next-line:max-line-length\n            var listId = (this.currentPropertyIndex < this.modifiedProperties.length ? this.modifiedProperties[this.currentPropertyIndex] : this.modifiedProperties[this.modifiedProperties.length - 1]);\n            value = listId;\n            if (this.currentPropertyIndex < this.modifiedProperties.length) {\n                this.modifiedProperties[this.currentPropertyIndex] = listFormat.listId;\n            }\n            else {\n                this.modifiedProperties[this.modifiedProperties.length - 1] = listFormat.listId;\n            }\n            this.currentPropertyIndex++;\n            return value;\n        }\n        else {\n            this.modifiedProperties.push(listFormat.listId);\n        }\n        return value;\n    };\n    /**\n     * Add modified properties for list format\n     * @param  {WListLevel} listLevel\n     * @private\n     */\n    BaseHistoryInfo.prototype.addModifiedPropertiesForList = function (listLevel) {\n        var value;\n        if (this.editorHistory.isUndoing || this.editorHistory.isRedoing) {\n            // tslint:disable-next-line:max-line-length\n            var previousLevel = (this.currentPropertyIndex < this.modifiedProperties.length ? this.modifiedProperties[this.currentPropertyIndex] : this.modifiedProperties[this.modifiedProperties.length - 1]);\n            value = previousLevel;\n            previousLevel = new ModifiedLevel(listLevel, this.owner.editorModule.cloneListLevel(listLevel));\n            if (this.currentPropertyIndex < this.modifiedProperties.length) {\n                this.modifiedProperties[this.currentPropertyIndex] = previousLevel;\n            }\n            else {\n                this.modifiedProperties[this.modifiedProperties.length - 1] = previousLevel;\n            }\n            this.currentPropertyIndex++;\n        }\n        else {\n            this.modifiedProperties.push(new ModifiedLevel(listLevel, this.owner.editorModule.cloneListLevel(listLevel)));\n            value = listLevel;\n        }\n        return value;\n    };\n    /**\n     * Revert the properties\n     * @param  {SelectionRange} selectionRange\n     */\n    BaseHistoryInfo.prototype.revertProperties = function () {\n        this.editorHistory.currentBaseHistoryInfo = this;\n        this.currentPropertyIndex = 0;\n        var property = this.getProperty();\n        this.viewer.owner.editorModule.setOffsetValue(this.viewer.selection);\n        if (this.action === 'ClearCharacterFormat' || this.modifiedProperties[0] instanceof WCharacterFormat) {\n            if (this.action === 'ListCharacterFormat') {\n                this.owner.editorModule.updateListCharacterFormat(this.viewer.selection, property, undefined);\n                return;\n            }\n            this.owner.editorModule.updateSelectionCharacterFormatting(property, undefined, false);\n        }\n        else if (this.action === 'ClearParagraphFormat' || this.modifiedProperties[0] instanceof WParagraphFormat) {\n            if (this.action === 'ContinueNumbering') {\n                // tslint:disable-next-line:max-line-length\n                this.owner.editorModule.revertContinueNumbering(this.owner.selection, this.modifiedProperties[0]);\n                return;\n            }\n            if (this.action === 'StyleName' && this.modifiedProperties[0] instanceof WParagraphFormat) {\n                // tslint:disable-next-line:max-line-length\n                this.owner.editorModule.updateSelectionParagraphFormatting(property, this.modifiedProperties[0].baseStyle, false);\n                return;\n            }\n            this.owner.editorModule.updateSelectionParagraphFormatting(property, undefined, false);\n        }\n        else if (this.modifiedProperties[0] instanceof WSectionFormat) {\n            this.owner.editorModule.updateSectionFormat(property, undefined);\n        }\n        else if (this.action === 'RestartNumbering') {\n            this.owner.editorModule.restartListAtInternal(this.owner.selection, this.modifiedProperties[0]);\n            return;\n        }\n        else if (this.modifiedProperties[0] instanceof ImageFormat) {\n            this.owner.selection.updateImageSize(this.modifiedProperties[0]);\n        }\n        else if (this.modifiedProperties[0] instanceof ModifiedLevel) {\n            var modified = new Dictionary();\n            for (var i = 0; i < this.modifiedProperties.length; i++) {\n                var modifiedLevel = this.modifiedProperties[i];\n                // modified.modifiedLevels.add(modifiedLevel.ownerListLevel.levelNumber, modifiedLevel);\n                modified.add(i, modifiedLevel);\n            }\n            this.editorHistory.updateListChanges(modified);\n            modified.destroy();\n            modified = undefined;\n        }\n        else if (this.modifiedProperties[0] instanceof WTableFormat) {\n            this.owner.editorModule.updateTableFormat(this.owner.selection, property, undefined);\n        }\n        else if (this.modifiedProperties[0] instanceof WCellFormat) {\n            this.owner.isShiftingEnabled = true;\n            this.owner.editorModule.updateCellFormat(this.owner.selection, property, undefined);\n        }\n        else if (this.modifiedProperties[0] instanceof WRowFormat) {\n            this.owner.editorModule.updateRowFormat(this.owner.selection, property, undefined);\n        }\n        this.currentPropertyIndex = 0;\n        if (this.action === 'ClearCharacterFormat' || this.action === 'ClearParagraphFormat') {\n            this.owner.editorModule.getOffsetValue(this.viewer.selection);\n        }\n    };\n    /**\n     * Add modified properties for cell options dialog\n     * @param  {WCellFormat} format\n     * @param  {WTable} table\n     * @private\n     */\n    BaseHistoryInfo.prototype.addModifiedCellOptions = function (applyFormat, format, table) {\n        var currentFormat;\n        if (isNullOrUndefined(applyFormat.bottomMargin) && isNullOrUndefined(applyFormat.topMargin)\n            && isNullOrUndefined(applyFormat.rightMargin) && isNullOrUndefined(applyFormat.leftMargin)) {\n            currentFormat = this.copyCellOptions(table.tableFormat);\n        }\n        else {\n            currentFormat = this.copyCellOptions(applyFormat);\n        }\n        if (this.editorHistory.isUndoing || this.editorHistory.isRedoing) {\n            // tslint:disable-next-line:max-line-length\n            var previousFormat = (this.currentPropertyIndex < this.modifiedProperties.length ? this.modifiedProperties[this.currentPropertyIndex] : this.modifiedProperties[this.modifiedProperties.length - 1]);\n            format = previousFormat;\n            if (this.currentPropertyIndex < this.modifiedProperties.length) {\n                this.modifiedProperties[this.currentPropertyIndex] = this.copyCellOptions(applyFormat);\n            }\n            else {\n                this.modifiedProperties[this.modifiedProperties.length - 1] = this.copyCellOptions(applyFormat);\n            }\n            this.currentPropertyIndex++;\n            return format;\n        }\n        else {\n            this.modifiedProperties.push(currentFormat);\n        }\n        return format;\n    };\n    BaseHistoryInfo.prototype.copyCellOptions = function (format) {\n        var cellFormat = new WCellFormat();\n        cellFormat.topMargin = format.topMargin;\n        cellFormat.rightMargin = format.rightMargin;\n        cellFormat.bottomMargin = format.bottomMargin;\n        cellFormat.leftMargin = format.leftMargin;\n        return cellFormat;\n    };\n    /**\n     * Add modified properties for cell options dialog\n     * @param  {WTableFormat} format\n     * @private\n     */\n    BaseHistoryInfo.prototype.addModifiedTableOptions = function (format) {\n        var currentFormat = this.copyTableOptions(format);\n        if (this.editorHistory.isUndoing || this.editorHistory.isRedoing) {\n            // tslint:disable-next-line:max-line-length           \n            var previousFormat = (this.currentPropertyIndex < this.modifiedProperties.length ? this.modifiedProperties[this.currentPropertyIndex] : this.modifiedProperties[this.modifiedProperties.length - 1]);\n            if (this.currentPropertyIndex < this.modifiedProperties.length) {\n                this.modifiedProperties.splice(this.currentPropertyIndex, 1, currentFormat);\n            }\n            else {\n                this.modifiedProperties.splice(this.modifiedProperties.length - 1, 1, currentFormat);\n            }\n            this.currentPropertyIndex++;\n        }\n        else {\n            this.modifiedProperties.push(currentFormat);\n        }\n    };\n    BaseHistoryInfo.prototype.copyTableOptions = function (format) {\n        var tableFormat = new WTableFormat();\n        tableFormat.topMargin = format.topMargin;\n        tableFormat.rightMargin = format.rightMargin;\n        tableFormat.bottomMargin = format.bottomMargin;\n        tableFormat.leftMargin = format.leftMargin;\n        tableFormat.cellSpacing = format.cellSpacing;\n        return tableFormat;\n    };\n    BaseHistoryInfo.prototype.getProperty = function () {\n        switch (this.action) {\n            case 'Bold':\n                return 'bold';\n            case 'Italic':\n                return 'italic';\n            case 'FontColor':\n                return 'fontColor';\n            case 'FontFamily':\n                return 'fontFamily';\n            case 'FontSize':\n                return 'fontSize';\n            case 'HighlightColor':\n                return 'highlightColor';\n            case 'BaselineAlignment':\n                return 'baselineAlignment';\n            case 'Strikethrough':\n                return 'strikethrough';\n            case 'Underline':\n                return 'underline';\n            case 'AfterSpacing':\n                return 'afterSpacing';\n            case 'BeforeSpacing':\n                return 'beforeSpacing';\n            case 'LeftIndent':\n                return 'leftIndent';\n            case 'RightIndent':\n                return 'rightIndent';\n            case 'FirstLineIndent':\n                return 'firstLineIndent';\n            case 'LineSpacingType':\n                return 'lineSpacingType';\n            case 'LineSpacing':\n                return 'lineSpacing';\n            case 'TextAlignment':\n                return 'textAlignment';\n            case 'ListFormat':\n                return 'listFormat';\n            case 'PageHeight':\n                return 'pageHeight';\n            case 'PageWidth':\n                return 'pageWidth';\n            case 'TableAlignment':\n                return 'tableAlignment';\n            case 'TableLeftIndent':\n                return 'leftIndent';\n            case 'DefaultCellSpacing':\n                return 'cellSpacing';\n            case 'LeftMargin':\n            case 'CellLeftMargin':\n            case 'DefaultCellLeftMargin':\n                return 'leftMargin';\n            case 'RightMargin':\n            case 'CellRightMargin':\n            case 'DefaultCellRightMargin':\n                return 'rightMargin';\n            case 'TopMargin':\n            case 'CellTopMargin':\n            case 'DefaultCellTopMargin':\n                return 'topMargin';\n            case 'BottomMargin':\n            case 'CellBottomMargin':\n            case 'DefaultCellBottomMargin':\n                return 'bottomMargin';\n            case 'CellContentVerticalAlignment':\n                return 'verticalAlignment';\n            case 'RowHeight':\n                return 'height';\n            case 'RowHeightType':\n                return 'heightType';\n            case 'RowHeader':\n                return 'isHeader';\n            case 'AllowBreakAcrossPages':\n                return 'allowBreakAcrossPages';\n            case 'TablePreferredWidth':\n            case 'CellPreferredWidth':\n                return 'preferredWidth';\n            case 'TablePreferredWidthType':\n            case 'CellPreferredWidthType':\n                return 'preferredWidthType';\n            case 'Shading':\n                return 'shading';\n            case 'StyleName':\n                return 'styleName';\n        }\n        return undefined;\n    };\n    BaseHistoryInfo.prototype.getCharacterPropertyValue = function (property, modifiedProperty) {\n        var value;\n        if (property === 'bold') {\n            value = modifiedProperty.bold;\n        }\n        else if (property === 'italic') {\n            value = modifiedProperty.italic;\n        }\n        else if (property === 'fontColor') {\n            value = modifiedProperty.fontColor;\n        }\n        else if (property === 'fontFamily') {\n            value = modifiedProperty.fontFamily;\n        }\n        else if (property === 'fontSize') {\n            value = modifiedProperty.fontSize;\n        }\n        else if (property === 'highlightColor') {\n            value = modifiedProperty.highlightColor;\n        }\n        else if (property === 'baselineAlignment') {\n            value = modifiedProperty.baselineAlignment;\n        }\n        else if (property === 'strikethrough') {\n            value = modifiedProperty.strikethrough;\n        }\n        else if (property === 'underline') {\n            value = modifiedProperty.underline;\n        }\n        return value;\n    };\n    /**\n     * Add modified properties for table format\n     * @param  {WTableFormat} format\n     * @param  {string} property\n     * @param  {Object} value\n     * @private\n     */\n    BaseHistoryInfo.prototype.addModifiedTableProperties = function (format, property, value) {\n        if (this.editorHistory.isUndoing || this.editorHistory.isRedoing) {\n            // tslint:disable-next-line:max-line-length\n            var previousTableFormat = (this.currentPropertyIndex < this.modifiedProperties.length ? this.modifiedProperties[this.currentPropertyIndex] : this.modifiedProperties[this.modifiedProperties.length - 1]);\n            if (isNullOrUndefined(property)) {\n                value = previousTableFormat;\n                if (this.currentPropertyIndex < this.modifiedProperties.length) {\n                    this.modifiedProperties[this.currentPropertyIndex] = format.cloneFormat();\n                }\n                else {\n                    this.modifiedProperties[this.modifiedProperties.length - 1] = format.cloneFormat();\n                }\n                this.currentPropertyIndex++;\n                return value;\n            }\n            if (property === 'shading') {\n                value = previousTableFormat.shading;\n            }\n            else {\n                value = previousTableFormat.getPropertyValue(property);\n            }\n            previousTableFormat.copyFormat(format);\n            this.currentPropertyIndex++;\n        }\n        else {\n            var currentFormat = new WTableFormat();\n            currentFormat.copyFormat(format);\n            this.modifiedProperties.push(currentFormat);\n        }\n        return value;\n    };\n    /**\n     * Add modified properties for row format\n     * @param  {WRowFormat} rowFormat\n     * @param  {string} property\n     * @param  {Object} value\n     * @private\n     */\n    BaseHistoryInfo.prototype.addModifiedRowProperties = function (rowFormat, property, value) {\n        if (this.editorHistory.isUndoing || this.editorHistory.isRedoing) {\n            // tslint:disable-next-line:max-line-length\n            var previousFormat = (this.currentPropertyIndex < this.modifiedProperties.length ? this.modifiedProperties[this.currentPropertyIndex] : this.modifiedProperties[this.modifiedProperties.length - 1]);\n            if (isNullOrUndefined(property)) {\n                value = previousFormat;\n                if (this.currentPropertyIndex < this.modifiedProperties.length) {\n                    this.modifiedProperties[this.currentPropertyIndex] = rowFormat.cloneFormat();\n                }\n                else {\n                    this.modifiedProperties[this.modifiedProperties.length - 1] = rowFormat.cloneFormat();\n                }\n                this.currentPropertyIndex++;\n                return value;\n            }\n            value = previousFormat.getPropertyValue(property);\n            previousFormat.copyFormat(rowFormat);\n            this.currentPropertyIndex++;\n        }\n        else {\n            var currentFormat = new WRowFormat();\n            currentFormat.copyFormat(rowFormat);\n            this.modifiedProperties.push(currentFormat);\n        }\n        return value;\n    };\n    /**\n     * Add modified properties for cell format\n     * @param  {WCellFormat} cellFormat\n     * @param  {string} property\n     * @param  {Object} value\n     * @private\n     */\n    BaseHistoryInfo.prototype.addModifiedCellProperties = function (cellFormat, property, value) {\n        if (this.editorHistory.isUndoing || this.editorHistory.isRedoing) {\n            // tslint:disable-next-line:max-line-length\n            var previousFormat = (this.currentPropertyIndex < this.modifiedProperties.length ? this.modifiedProperties[this.currentPropertyIndex] : this.modifiedProperties[this.modifiedProperties.length - 1]);\n            if (isNullOrUndefined(property)) {\n                value = previousFormat;\n                if (this.currentPropertyIndex < this.modifiedProperties.length) {\n                    this.modifiedProperties[this.currentPropertyIndex] = cellFormat.cloneFormat();\n                }\n                else {\n                    this.modifiedProperties[this.modifiedProperties.length - 1] = cellFormat.cloneFormat();\n                }\n                this.currentPropertyIndex++;\n                return value;\n            }\n            if (property === 'shading') {\n                value = previousFormat.shading;\n            }\n            else {\n                value = previousFormat.getPropertyValue(property);\n            }\n            previousFormat.copyFormat(cellFormat);\n            this.currentPropertyIndex++;\n        }\n        else {\n            var currentFormat = new WCellFormat();\n            currentFormat.copyFormat(cellFormat);\n            this.modifiedProperties.push(currentFormat);\n        }\n        return value;\n    };\n    /**\n     * @private\n     */\n    BaseHistoryInfo.prototype.destroy = function () {\n        this.selectionStart = undefined;\n        this.selectionEnd = undefined;\n        this.insertPosition = undefined;\n        this.endPosition = undefined;\n        if (!isNullOrUndefined(this.modifiedNodeLength)) {\n            this.modifiedNodeLength = [];\n            this.modifiedNodeLength = undefined;\n        }\n        if (!isNullOrUndefined(this.modifiedProperties)) {\n            for (var i = 0; i < this.modifiedProperties.length; i++) {\n                var property = this.modifiedProperties[i];\n                if (property instanceof WCharacterFormat) {\n                    property.destroy();\n                }\n                else if (property instanceof WParagraphFormat) {\n                    property.destroy();\n                }\n                else if (property instanceof WSectionFormat) {\n                    property.destroy();\n                }\n                else if (property instanceof ModifiedLevel) {\n                    property.destroy();\n                }\n                this.modifiedProperties.splice(this.modifiedProperties.indexOf(property), 1);\n                i--;\n            }\n            this.modifiedPropertiesIn = undefined;\n        }\n        if (!isNullOrUndefined(this.removedNodes)) {\n            for (var i = 0; i < this.removedNodes.length; i++) {\n                var node = this.removedNodes[i];\n                if (node instanceof ParagraphWidget) {\n                    node.destroyInternal(this.viewer);\n                }\n                else if (node instanceof ElementBox) {\n                    node.destroy();\n                }\n                this.removedNodes.splice(this.removedNodes.indexOf(node), 1);\n                i--;\n            }\n            this.removedNodesIn = undefined;\n        }\n        this.ownerIn = undefined;\n    };\n    return BaseHistoryInfo;\n}());\nexport { BaseHistoryInfo };\n","import { isNullOrUndefined } from '@syncfusion/ej2-base';\nimport { PageLayoutViewer } from '../index';\nimport { Dictionary } from '../../base/dictionary';\nimport { ImageFormat } from '../selection/selection-helper';\nimport { Point, HelperMethods } from './editor-helper';\nimport { BaseHistoryInfo } from '../editor-history/base-history-info';\n/**\n * Image resizer implementation.\n */\nvar ImageResizer = /** @class */ (function () {\n    /**\n     * Constructor for image resizer module.\n     * @param {DocumentEditor} node\n     * @param {LayoutViewer} viewer\n     * @private\n     */\n    function ImageResizer(node, viewer) {\n        /**\n         * @private\n         */\n        this.resizeContainerDiv = undefined;\n        /**\n         * @private\n         */\n        this.topLeftRect = undefined;\n        /**\n         * @private\n         */\n        this.topMiddleRect = undefined;\n        /**\n         * @private\n         */\n        this.topRightRect = undefined;\n        /**\n         * @private\n         */\n        this.bottomLeftRect = undefined;\n        /**\n         * @private\n         */\n        this.bottomMiddleRect = undefined;\n        /**\n         * @private\n         */\n        this.bottomRightRect = undefined;\n        /**\n         * @private\n         */\n        this.leftMiddleRect = undefined;\n        /**\n         * @private\n         */\n        this.rightMiddleRect = undefined;\n        /**\n         * @private\n         */\n        this.topLeftRectParent = undefined;\n        /**\n         * @private\n         */\n        this.topMiddleRectParent = undefined;\n        /**\n         * @private\n         */\n        this.topRightRectParent = undefined;\n        /**\n         * @private\n         */\n        this.bottomLeftRectParent = undefined;\n        /**\n         * @private\n         */\n        this.bottomMiddleRectParent = undefined;\n        /**\n         * @private\n         */\n        this.bottomRightRectParent = undefined;\n        /**\n         * @private\n         */\n        this.leftMiddleRectParent = undefined;\n        /**\n         * @private\n         */\n        this.rightMiddleRectParent = undefined;\n        /**\n         * @private\n         */\n        this.resizeMarkSizeIn = 7;\n        /**\n         * @private\n         */\n        this.selectedImageWidget = undefined;\n        /**\n         * @private\n         */\n        this.baseHistoryInfo = undefined;\n        /**\n         * @private\n         */\n        this.isImageResizing = false;\n        /**\n         * @private\n         */\n        this.isImageResizerVisible = false;\n        /**\n         * @private\n         */\n        this.isImageMoveToNextPage = false;\n        /**\n         * @private\n         */\n        this.selectedResizeElement = undefined;\n        /**\n         * @private\n         */\n        this.topValue = undefined;\n        /**\n         * @private\n         */\n        this.leftValue = undefined;\n        this.owner = node;\n        this.selectedImageWidget = new Dictionary();\n        this.viewer = viewer;\n        this.imageResizerPoints = new ImageResizingPoints();\n        if (isNullOrUndefined(this.imageResizerDiv) && this.viewer && this.viewer.pageContainer) {\n            this.initializeImageResizer();\n        }\n    }\n    Object.defineProperty(ImageResizer.prototype, \"currentImageElementBox\", {\n        /**\n         * Gets or Sets the current image element box.\n         * @private\n         */\n        get: function () {\n            return this.currentImageElementBoxIn;\n        },\n        /**\n         * @private\n         */\n        set: function (value) {\n            this.currentImageElementBoxIn = value;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(ImageResizer.prototype, \"resizeMarkSize\", {\n        /**\n         * Gets or Sets the resize mark size.\n         * @private\n         */\n        get: function () {\n            return this.resizeMarkSizeIn;\n        },\n        /**\n         * @private\n         */\n        set: function (value) {\n            this.resizeMarkSizeIn = value;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    /**\n     * Gets module name.\n     */\n    ImageResizer.prototype.getModuleName = function () {\n        return 'ImageResizer';\n    };\n    //Image Resizing Methods\n    /**\n     * Sets image resizer position.\n     * @param {number} x - Specifies for image resizer left value.\n     * @param {number} y - Specifies for image resizer top value.\n     * @param {number} width - Specifies for image resizer width value.\n     * @param {number} height - Specifies for image resizer height value.\n     * @private\n     */\n    ImageResizer.prototype.setImageResizerPositions = function (x, y, width, height) {\n        this.imageResizerDivElement.style.top = y.toString() + 'px';\n        this.imageResizerDivElement.style.left = x.toString() + 'px';\n        this.imageResizerDivElement.style.borderWidth = '0px';\n        this.imageResizerDivElement.style.height = height + 'px';\n        this.imageResizerDivElement.style.width = width + 'px';\n        this.imageResizerDivElement.style.backgroundColor = 'transparent';\n        this.imageResizerDivElement.style.overflow = 'hidden';\n        this.imageResizerDivElement.style.position = 'absolute';\n    };\n    /**\n     * Creates image resizer DOM element.\n     * @private\n     */\n    ImageResizer.prototype.initializeImageResizer = function () {\n        this.imageResizerDivElement = document.createElement('div');\n        this.imageResizerDivElement.style.zIndex = '1';\n        this.imageResizerDivElement.style.display = 'none';\n        this.viewer.pageContainer.appendChild(this.imageResizerDivElement);\n    };\n    /**\n     * Position an image resizer\n     * @param {ImageElementBox} elementBox - Specifies the image position.\n     * @private\n     */\n    ImageResizer.prototype.positionImageResizer = function (elementBox) {\n        this.selectedImageWidget.clear();\n        // Initializes the image resizer on demand, i.e at the time of selecting an image for the first time.\n        var resizeDiv;\n        if (!isNullOrUndefined(this.viewer.currentPage)) {\n            resizeDiv = this.imageResizerDivElement;\n        }\n        if (!isNullOrUndefined(resizeDiv) && !resizeDiv.contains(this.imageResizerDiv)) {\n            this.imageResizerDiv = this.initResizeMarks(resizeDiv, this);\n        }\n        this.imageResizerDiv.style.width = (elementBox.width) + 'px';\n        this.imageResizerDiv.style.height = (elementBox.height) + 'px';\n        this.currentImageElementBox = elementBox;\n        var lineWidget = elementBox.line;\n        var top = this.viewer.selection.getTop(lineWidget) + elementBox.margin.top;\n        var left = this.viewer.selection.getLeftInternal(lineWidget, elementBox, 0);\n        var page = this.viewer.selection.getPage(lineWidget.paragraph);\n        this.currentPage = page;\n        var x = 0;\n        var y = 0;\n        if (!isNullOrUndefined(resizeDiv)) {\n            this.imageResizerDivElement.style.display = 'block';\n            resizeDiv.style.width = page.boundingRectangle.width + 'px';\n            resizeDiv.style.height = page.boundingRectangle.height + 'px';\n            resizeDiv.style.left = page.boundingRectangle.x + 'px';\n            resizeDiv.style.top = page.boundingRectangle.y + 'px';\n            resizeDiv.style.borderWidth = '0px';\n            resizeDiv.style.backgroundColor = 'transparent';\n            resizeDiv.style.overflow = 'hidden';\n            resizeDiv.style.position = 'absolute';\n        }\n        var horizontalWidth = 0;\n        var pageWidth = this.viewer.getPageWidth(page);\n        var pagelayout = this.viewer;\n        // tslint:disable-next-line:max-line-length\n        horizontalWidth = parseFloat(this.imageResizerDivElement.style.width);\n        x = (this.viewer.visibleBounds.width - horizontalWidth * this.viewer.zoomFactor) / 2;\n        if (x < 30) {\n            x = 30;\n        }\n        if (pageWidth < horizontalWidth) {\n            x += (horizontalWidth - pageWidth) * this.viewer.zoomFactor / 2;\n        }\n        // tslint:disable-next-line:max-line-length           \n        y = page.boundingRectangle.y * this.viewer.zoomFactor + (this.viewer.pages.indexOf(page) + 1) * 20 * (1 - this.viewer.zoomFactor);\n        var currentPageDiv = this.imageResizerDivElement;\n        var currentPageDivWidth = parseFloat(currentPageDiv.style.width);\n        var currentPageDivHeight = parseFloat(currentPageDiv.style.height);\n        var imageResizerDivWidth = parseFloat(this.imageResizerDiv.style.width);\n        var imageResizerDivHeight = parseFloat(this.imageResizerDiv.style.height);\n        var margin = (this.resizeMarkSize - 1) / 2;\n        var width = imageResizerDivWidth + 2 * margin;\n        var height = imageResizerDivHeight + 2 * margin;\n        if (width > (currentPageDivWidth - left) * this.viewer.zoomFactor + margin) {\n            width = (currentPageDivWidth - left) * this.viewer.zoomFactor;\n        }\n        if (height > (currentPageDivHeight - top) * this.viewer.zoomFactor + margin) {\n            height = (currentPageDivHeight - top) * this.viewer.zoomFactor;\n        }\n        // if (width < imageResizerDivHeight + margin || height < imageResizerDivHeight + margin) {\n        // }\n        // tslint:disable-next-line:max-line-length\n        this.imageResizerDivElement.style.width = parseInt(this.imageResizerDivElement.style.width.replace('px', ''), 10) * this.viewer.zoomFactor + 'px';\n        this.imageResizerDivElement.style.height = parseInt(this.imageResizerDivElement.style.height.replace('px', ''), 10) * this.viewer.zoomFactor + 'px';\n        height = this.viewer.render.getScaledValue(elementBox.height);\n        width = this.viewer.render.getScaledValue(elementBox.width);\n        left = this.viewer.render.getScaledValue(left);\n        top = this.viewer.render.getScaledValue(top);\n        this.setImageResizerPosition(left, top, width, height, this);\n        if (!this.selectedImageWidget.containsKey(lineWidget)) {\n            var selectedImageInfo = new SelectedImageInfo(elementBox.height, elementBox.width);\n            this.selectedImageWidget.add(lineWidget, selectedImageInfo);\n        }\n    };\n    /**\n     * Shows the image resizer.\n     * @private\n     */\n    ImageResizer.prototype.showImageResizer = function () {\n        if (!isNullOrUndefined(this.imageResizerDivElement)) {\n            this.imageResizerDivElement.style.display = '';\n        }\n        if (!isNullOrUndefined(this.resizeContainerDiv)) {\n            this.resizeContainerDiv.style.display = '';\n        }\n        if (!isNullOrUndefined(this.bottomLeftRect)) {\n            this.bottomLeftRect.style.display = '';\n            this.bottomLeftRectParent.style.display = '';\n        }\n        if (!isNullOrUndefined(this.bottomRightRect)) {\n            this.bottomRightRect.style.display = '';\n            this.bottomRightRectParent.style.display = '';\n        }\n        if (!isNullOrUndefined(this.bottomMiddleRect)) {\n            this.bottomMiddleRect.style.display = '';\n            this.bottomMiddleRectParent.style.display = '';\n        }\n        if (!isNullOrUndefined(this.rightMiddleRect)) {\n            this.rightMiddleRect.style.display = '';\n            this.rightMiddleRectParent.style.display = '';\n        }\n        if (!isNullOrUndefined(this.topRightRect)) {\n            this.topRightRect.style.display = '';\n            this.topRightRectParent.style.display = '';\n        }\n        if (!isNullOrUndefined(this.topLeftRect)) {\n            this.topLeftRect.style.display = '';\n            this.topLeftRectParent.style.display = '';\n        }\n        if (!isNullOrUndefined(this.leftMiddleRect)) {\n            this.leftMiddleRect.style.display = '';\n            this.leftMiddleRectParent.style.display = '';\n        }\n        if (!isNullOrUndefined(this.topMiddleRect)) {\n            this.topMiddleRect.style.display = '';\n            this.topMiddleRectParent.style.display = '';\n        }\n        this.isImageResizerVisible = true;\n    };\n    /**\n     * Hides the image resizer.\n     * @private\n     */\n    ImageResizer.prototype.hideImageResizer = function () {\n        if (!isNullOrUndefined(this.imageResizerDivElement)) {\n            this.imageResizerDivElement.style.display = 'none';\n        }\n        if (!isNullOrUndefined(this.resizeContainerDiv)) {\n            this.resizeContainerDiv.style.display = 'none';\n        }\n        if (!isNullOrUndefined(this.bottomLeftRect)) {\n            this.bottomLeftRect.style.display = 'none';\n            this.bottomLeftRectParent.style.display = 'none';\n        }\n        if (!isNullOrUndefined(this.bottomRightRect)) {\n            this.bottomRightRect.style.display = 'none';\n            this.bottomRightRectParent.style.display = 'none';\n        }\n        if (!isNullOrUndefined(this.bottomMiddleRect)) {\n            this.bottomMiddleRect.style.display = 'none';\n            this.bottomMiddleRectParent.style.display = 'none';\n        }\n        if (!isNullOrUndefined(this.rightMiddleRect)) {\n            this.rightMiddleRect.style.display = 'none';\n            this.rightMiddleRectParent.style.display = 'none';\n        }\n        if (!isNullOrUndefined(this.topRightRect)) {\n            this.topRightRect.style.display = 'none';\n            this.topRightRectParent.style.display = 'none';\n        }\n        if (!isNullOrUndefined(this.topLeftRect)) {\n            this.topLeftRect.style.display = 'none';\n            this.topLeftRectParent.style.display = 'none';\n        }\n        if (!isNullOrUndefined(this.leftMiddleRect)) {\n            this.leftMiddleRect.style.display = 'none';\n            this.leftMiddleRectParent.style.display = 'none';\n        }\n        if (!isNullOrUndefined(this.topMiddleRect)) {\n            this.topMiddleRect.style.display = 'none';\n            this.topMiddleRectParent.style.display = 'none';\n        }\n        this.isImageResizerVisible = false;\n        this.currentPage = undefined;\n    };\n    /**\n     * Initialize the resize marks.\n     * @param {HTMLElement} resizeDiv - Specifies to appending resizer container div element.\n     * @param {ImageResizer} imageResizer - Specifies to creating div element of each position.\n     * @private\n     */\n    // tslint:disable:max-func-body-length\n    ImageResizer.prototype.initResizeMarks = function (resizeDiv, imageResizer) {\n        this.initResizeContainerDiv(imageResizer);\n        resizeDiv.appendChild(imageResizer.resizeContainerDiv);\n        imageResizer.topRightRectParent = document.createElement('div');\n        imageResizer.topRightRectParent.style.cursor = 'ne-resize';\n        imageResizer.topRightRectParent.id = this.viewer.owner.containerId + '_TopRightRectParent';\n        this.applyProperties(imageResizer.topRightRectParent);\n        imageResizer.topRightRectParent.style.width = !this.viewer.isTouchInput ? '14px' : '30px';\n        imageResizer.topRightRectParent.style.height = !this.viewer.isTouchInput ? '14px' : '30px';\n        imageResizer.topRightRectParent.style.opacity = '-1';\n        resizeDiv.appendChild(imageResizer.topRightRectParent);\n        imageResizer.topRightRect = document.createElement('div');\n        imageResizer.topRightRect.id = this.viewer.owner.containerId + '_TopRightRect';\n        imageResizer.topRightRect.style.cursor = 'ne-resize';\n        this.applyProperties(imageResizer.topRightRect);\n        resizeDiv.appendChild(imageResizer.topRightRect);\n        imageResizer.topLeftRectParent = document.createElement('div');\n        imageResizer.topLeftRectParent.style.cursor = 'nw-resize';\n        imageResizer.topLeftRectParent.id = this.viewer.owner.containerId + '_TopLeftRectParent';\n        this.applyProperties(imageResizer.topLeftRectParent);\n        imageResizer.topLeftRectParent.style.width = !this.viewer.isTouchInput ? '14px' : '30px';\n        imageResizer.topLeftRectParent.style.height = !this.viewer.isTouchInput ? '14px' : '30px';\n        imageResizer.topLeftRectParent.style.opacity = '-1';\n        resizeDiv.appendChild(imageResizer.topLeftRectParent);\n        imageResizer.topLeftRect = document.createElement('div');\n        imageResizer.topLeftRect.id = this.viewer.owner.containerId + '_TopLeftRect';\n        imageResizer.topLeftRect.style.cursor = 'nw-resize';\n        this.applyProperties(imageResizer.topLeftRect);\n        resizeDiv.appendChild(imageResizer.topLeftRect);\n        imageResizer.topMiddleRectParent = document.createElement('div');\n        imageResizer.topMiddleRectParent.style.cursor = 'n-resize';\n        imageResizer.topMiddleRectParent.id = this.viewer.owner.containerId + '_TopMiddleRectParent';\n        this.applyProperties(imageResizer.topMiddleRectParent);\n        imageResizer.topMiddleRectParent.style.width = !this.viewer.isTouchInput ? '14px' : '30px';\n        imageResizer.topMiddleRectParent.style.height = !this.viewer.isTouchInput ? '14px' : '30px';\n        imageResizer.topMiddleRectParent.style.opacity = '-1';\n        resizeDiv.appendChild(imageResizer.topMiddleRectParent);\n        imageResizer.topMiddleRect = document.createElement('div');\n        imageResizer.topMiddleRect.id = this.viewer.owner.containerId + '_TopMiddleRect';\n        imageResizer.topMiddleRect.style.cursor = 'n-resize';\n        this.applyProperties(imageResizer.topMiddleRect);\n        resizeDiv.appendChild(imageResizer.topMiddleRect);\n        imageResizer.bottomRightRectParent = document.createElement('div');\n        imageResizer.bottomRightRectParent.style.cursor = 'se-resize';\n        imageResizer.bottomRightRectParent.id = this.viewer.owner.containerId + '_BottomRightRectParent';\n        this.applyProperties(imageResizer.bottomRightRectParent);\n        imageResizer.bottomRightRectParent.style.width = !this.viewer.isTouchInput ? '14px' : '30px';\n        imageResizer.bottomRightRectParent.style.height = !this.viewer.isTouchInput ? '14px' : '30px';\n        imageResizer.bottomRightRectParent.style.opacity = '-1';\n        resizeDiv.appendChild(imageResizer.bottomRightRectParent);\n        imageResizer.bottomRightRect = document.createElement('div');\n        imageResizer.bottomRightRect.id = this.viewer.owner.containerId + '_BottomRightRect';\n        imageResizer.bottomRightRect.style.cursor = 'se-resize';\n        this.applyProperties(imageResizer.bottomRightRect);\n        resizeDiv.appendChild(imageResizer.bottomRightRect);\n        imageResizer.bottomLeftRectParent = document.createElement('div');\n        imageResizer.bottomLeftRectParent.style.cursor = 'sw-resize';\n        imageResizer.bottomLeftRectParent.id = this.viewer.owner.containerId + '_BottomLeftRectParent';\n        this.applyProperties(imageResizer.bottomLeftRectParent);\n        imageResizer.bottomLeftRectParent.style.width = !this.viewer.isTouchInput ? '14px' : '30px';\n        imageResizer.bottomLeftRectParent.style.height = !this.viewer.isTouchInput ? '14px' : '30px';\n        imageResizer.bottomLeftRectParent.style.opacity = '-1';\n        resizeDiv.appendChild(imageResizer.bottomLeftRectParent);\n        imageResizer.bottomLeftRect = document.createElement('div');\n        imageResizer.bottomLeftRect.id = this.viewer.owner.containerId + '_BottomLeftRect';\n        imageResizer.bottomLeftRect.style.cursor = 'sw-resize';\n        this.applyProperties(imageResizer.bottomLeftRect);\n        resizeDiv.appendChild(imageResizer.bottomLeftRect);\n        imageResizer.bottomMiddleRectParent = document.createElement('div');\n        imageResizer.bottomMiddleRectParent.style.cursor = 's-resize';\n        imageResizer.bottomMiddleRectParent.id = this.viewer.owner.containerId + '_BottomMiddleRectParent';\n        this.applyProperties(imageResizer.bottomMiddleRectParent);\n        imageResizer.bottomMiddleRectParent.style.width = !this.viewer.isTouchInput ? '14px' : '30px';\n        imageResizer.bottomMiddleRectParent.style.height = !this.viewer.isTouchInput ? '14px' : '30px';\n        imageResizer.bottomMiddleRectParent.style.opacity = '-1';\n        resizeDiv.appendChild(imageResizer.bottomMiddleRectParent);\n        imageResizer.bottomMiddleRect = document.createElement('div');\n        imageResizer.bottomMiddleRect.id = this.viewer.owner.containerId + '_BottomMiddleRect';\n        imageResizer.bottomMiddleRect.style.cursor = 's-resize';\n        this.applyProperties(imageResizer.bottomMiddleRect);\n        resizeDiv.appendChild(imageResizer.bottomMiddleRect);\n        imageResizer.rightMiddleRectParent = document.createElement('div');\n        imageResizer.rightMiddleRectParent.style.cursor = 'e-resize';\n        imageResizer.rightMiddleRectParent.id = this.viewer.owner.containerId + '_RightMiddleRectParent';\n        this.applyProperties(imageResizer.rightMiddleRectParent);\n        imageResizer.rightMiddleRectParent.style.width = !this.viewer.isTouchInput ? '14px' : '30px';\n        imageResizer.rightMiddleRectParent.style.height = !this.viewer.isTouchInput ? '14px' : '30px';\n        imageResizer.rightMiddleRectParent.style.opacity = '-1';\n        resizeDiv.appendChild(imageResizer.rightMiddleRectParent);\n        imageResizer.rightMiddleRect = document.createElement('div');\n        imageResizer.rightMiddleRect.id = this.viewer.owner.containerId + '_RightMiddleRect';\n        imageResizer.rightMiddleRect.style.cursor = 'e-resize';\n        this.applyProperties(imageResizer.rightMiddleRect);\n        resizeDiv.appendChild(imageResizer.rightMiddleRect);\n        imageResizer.leftMiddleRectParent = document.createElement('div');\n        imageResizer.leftMiddleRectParent.style.cursor = 'w-resize';\n        imageResizer.leftMiddleRectParent.id = this.viewer.owner.containerId + '_LeftMiddleRectParent';\n        this.applyProperties(imageResizer.leftMiddleRectParent);\n        imageResizer.leftMiddleRectParent.style.width = !this.viewer.isTouchInput ? '14px' : '30px';\n        imageResizer.leftMiddleRectParent.style.height = !this.viewer.isTouchInput ? '14px' : '30px';\n        imageResizer.leftMiddleRectParent.style.opacity = '-1';\n        resizeDiv.appendChild(imageResizer.leftMiddleRectParent);\n        imageResizer.leftMiddleRect = document.createElement('div');\n        imageResizer.leftMiddleRect.id = this.viewer.owner.containerId + '_LeftMiddleRect';\n        imageResizer.leftMiddleRect.style.cursor = 'w-resize';\n        this.applyProperties(imageResizer.leftMiddleRect);\n        resizeDiv.appendChild(imageResizer.leftMiddleRect);\n        return imageResizer.resizeContainerDiv;\n    };\n    /**\n     * Sets the image resizer position.\n     * @param {number} left - Specifies for image resizer left value.\n     * @param {number} top - Specifies for image resizer top value.\n     * @param {number} width - Specifies for image resizer width value.\n     * @param {number} height - Specifies for image resizer height value.\n     * @param {ImageResizer} imageResizer - Specifies for image resizer.\n     * @private\n     */\n    ImageResizer.prototype.setImageResizerPosition = function (left, top, width, height, imageResizer) {\n        //Positions Updating For Image Resize Div\n        imageResizer.resizeContainerDiv.style.width = width + 'px';\n        imageResizer.resizeContainerDiv.style.height = height + 'px';\n        imageResizer.resizeContainerDiv.style.left = left - 1 + 'px';\n        imageResizer.resizeContainerDiv.style.top = top + 'px';\n        //Positions Updating For Image Resizing Points\n        imageResizer.topRightRect.style.left = ((left + width) - 5) + 'px';\n        imageResizer.topRightRect.style.top = (top - 4) + 'px';\n        imageResizer.topLeftRect.style.left = (left - 5) + 'px';\n        imageResizer.topLeftRect.style.top = (top - 4) + 'px';\n        imageResizer.topMiddleRect.style.left = ((parseFloat(imageResizer.topLeftRect.style.left) + (width / 2)) - 4) + 'px';\n        imageResizer.topMiddleRect.style.top = (top - 4) + 'px';\n        imageResizer.bottomRightRect.style.left = imageResizer.topRightRect.style.left;\n        imageResizer.bottomRightRect.style.top = (parseFloat(imageResizer.topRightRect.style.top) + height) + 'px';\n        imageResizer.bottomLeftRect.style.left = imageResizer.topLeftRect.style.left;\n        imageResizer.bottomLeftRect.style.top = (parseFloat(imageResizer.topLeftRect.style.top) + height) + 'px';\n        imageResizer.bottomMiddleRect.style.left = imageResizer.topMiddleRect.style.left;\n        imageResizer.bottomMiddleRect.style.top = (parseFloat(imageResizer.topMiddleRect.style.top) + height) + 'px';\n        imageResizer.rightMiddleRect.style.left = ((left + width) - 4) + 'px';\n        imageResizer.rightMiddleRect.style.top = (parseFloat(imageResizer.topRightRect.style.top) + (height / 2)) + 'px';\n        imageResizer.leftMiddleRect.style.left = imageResizer.topLeftRect.style.left;\n        imageResizer.leftMiddleRect.style.top = (parseFloat(imageResizer.topLeftRect.style.top) + (height / 2)) + 'px';\n        imageResizer.topRightRectParent.style.left = !this.viewer.isTouchInput ? ((left + width) - 8) + 'px' : ((left + width) - 15) + 'px';\n        imageResizer.topRightRectParent.style.top = !this.viewer.isTouchInput ? (top - 7) + 'px' : (top - 15) + 'px';\n        imageResizer.topLeftRectParent.style.left = !this.viewer.isTouchInput ? (left - 8) + 'px' : (left - 15) + 'px';\n        imageResizer.topLeftRectParent.style.top = !this.viewer.isTouchInput ? (top - 7) + 'px' : (top - 15) + 'px';\n        imageResizer.topMiddleRectParent.style.left = ((parseFloat(imageResizer.topLeftRectParent.style.left) + (width / 2)) - 4) + 'px';\n        imageResizer.topMiddleRectParent.style.top = !this.viewer.isTouchInput ? (top - 7) + 'px' : (top - 15) + 'px';\n        imageResizer.bottomRightRectParent.style.left = imageResizer.topRightRectParent.style.left;\n        imageResizer.bottomRightRectParent.style.top = (parseFloat(imageResizer.topRightRectParent.style.top) + height) + 'px';\n        imageResizer.bottomLeftRectParent.style.left = imageResizer.topLeftRectParent.style.left;\n        imageResizer.bottomLeftRectParent.style.top = (parseFloat(imageResizer.topLeftRectParent.style.top) + height) + 'px';\n        imageResizer.bottomMiddleRectParent.style.left = imageResizer.topMiddleRectParent.style.left;\n        imageResizer.bottomMiddleRectParent.style.top = (parseFloat(imageResizer.topMiddleRectParent.style.top) + height) + 'px';\n        // tslint:disable-next-line:max-line-length \n        imageResizer.rightMiddleRectParent.style.left = !this.viewer.isTouchInput ? ((left + width) - 7) + 'px' : ((left + width) - 15) + 'px';\n        imageResizer.rightMiddleRectParent.style.top = (parseFloat(imageResizer.topRightRectParent.style.top) + (height / 2)) + 'px';\n        imageResizer.leftMiddleRectParent.style.left = imageResizer.topLeftRectParent.style.left;\n        imageResizer.leftMiddleRectParent.style.top = (parseFloat(imageResizer.topLeftRectParent.style.top) + (height / 2)) + 'px';\n        this.setImageResizingPoints(imageResizer);\n        if (this.viewer.isTouchInput) {\n            this.applyPropertiesForTouch();\n        }\n        else {\n            this.applyPropertiesForMouse();\n        }\n    };\n    /**\n     * Sets the image resizing points.\n     * @param {ImageResizer} imageResizer - Specifies for position of each resizing elements.\n     * @private\n     */\n    ImageResizer.prototype.setImageResizingPoints = function (imageResizer) {\n        this.imageResizerPoints.resizeContainerDiv.x = parseFloat(imageResizer.resizeContainerDiv.style.left);\n        this.imageResizerPoints.resizeContainerDiv.y = parseFloat(imageResizer.resizeContainerDiv.style.top);\n        this.imageResizerPoints.bottomLeftRectParent.x = parseFloat(imageResizer.bottomLeftRectParent.style.left);\n        this.imageResizerPoints.bottomLeftRectParent.y = parseFloat(imageResizer.bottomLeftRectParent.style.top);\n        this.imageResizerPoints.bottomRightRectParent.x = parseFloat(imageResizer.bottomRightRectParent.style.left);\n        this.imageResizerPoints.bottomRightRectParent.y = parseFloat(imageResizer.bottomRightRectParent.style.top);\n        this.imageResizerPoints.bottomMiddleRectParent.x = parseFloat(imageResizer.bottomMiddleRectParent.style.left);\n        this.imageResizerPoints.bottomMiddleRectParent.y = parseFloat(imageResizer.bottomMiddleRectParent.style.top);\n        this.imageResizerPoints.topLeftRectParent.x = parseFloat(imageResizer.topLeftRectParent.style.left);\n        this.imageResizerPoints.topLeftRectParent.y = parseFloat(imageResizer.topLeftRectParent.style.top);\n        this.imageResizerPoints.topRightRectParent.x = parseFloat(imageResizer.topRightRectParent.style.left);\n        this.imageResizerPoints.topRightRectParent.y = parseFloat(imageResizer.topRightRectParent.style.top);\n        this.imageResizerPoints.topMiddleRectParent.x = parseFloat(imageResizer.topMiddleRectParent.style.left);\n        this.imageResizerPoints.topMiddleRectParent.y = parseFloat(imageResizer.topMiddleRectParent.style.top);\n        this.imageResizerPoints.leftMiddleRectParent.x = parseFloat(imageResizer.leftMiddleRectParent.style.left);\n        this.imageResizerPoints.leftMiddleRectParent.y = parseFloat(imageResizer.leftMiddleRectParent.style.top);\n        this.imageResizerPoints.rightMiddleRectParent.x = parseFloat(imageResizer.rightMiddleRectParent.style.left);\n        this.imageResizerPoints.rightMiddleRectParent.y = parseFloat(imageResizer.rightMiddleRectParent.style.top);\n    };\n    /**\n     * Initialize the resize container div element.\n     * @param {ImageResizer} imageResizer - Specifies for creating resize container div element.\n     * @private\n     */\n    ImageResizer.prototype.initResizeContainerDiv = function (imageResizer) {\n        imageResizer.resizeContainerDiv = document.createElement('div');\n        imageResizer.resizeContainerDiv.id = this.viewer.owner.containerId + '_ResizeDivElement';\n        imageResizer.resizeContainerDiv.style.position = 'absolute';\n        imageResizer.resizeContainerDiv.style.border = '1px solid #bfbfbf';\n        imageResizer.resizeContainerDiv.style.zIndex = '30';\n        imageResizer.resizeContainerDiv.style.backgroundColor = 'transparent';\n        imageResizer.resizeContainerDiv.style.display = 'block';\n    };\n    /**\n     * Apply the properties of each resize rectangle element.\n     * @param {HTMLDivElement} resizeRectElement - Specifies for applying properties to resize rectangle element.\n     * @private\n     */\n    ImageResizer.prototype.applyProperties = function (resizeRectElement) {\n        resizeRectElement.style.position = 'absolute';\n        resizeRectElement.style.width = '8px';\n        resizeRectElement.style.height = '8px';\n        resizeRectElement.style.fontSize = '0px';\n        resizeRectElement.style.zIndex = ' 551';\n        resizeRectElement.style.backgroundColor = '#ffffff';\n        resizeRectElement.style.border = '1px solid #bfbfbf';\n        resizeRectElement.style.boxShadow = '0 1px 2px 0 #bfbfbf 0.35';\n        resizeRectElement.style.color = '#000000';\n    };\n    /**\n     * Handles an image resizing.\n     * @param {number} x  - Specifies for left value while resizing.\n     * @param {number} y - Specifies for top value while resizing.\n     */\n    ImageResizer.prototype.handleImageResizing = function (touchPoint, prevX, prevY) {\n        prevX = prevX / this.viewer.zoomFactor;\n        prevY = prevY / this.viewer.zoomFactor;\n        this.leftValue = isNullOrUndefined(this.leftValue) ? prevX : this.leftValue;\n        this.topValue = isNullOrUndefined(this.topValue) ? prevY : this.topValue;\n        var points;\n        switch (this.selectedResizeElement.id.split('_')[1]) {\n            case 'TopRightRectParent':\n                points = this.topRightResizing(touchPoint);\n                prevX = points.left;\n                prevY = points.top;\n                break;\n            case 'TopLeftRectParent':\n                points = this.topLeftResizing(touchPoint);\n                prevX = -points.left;\n                prevY = -points.top;\n                break;\n            case 'TopMiddleRectParent':\n                prevX = 0;\n                prevY = this.topMiddleResizing(touchPoint);\n                break;\n            case 'BottomRightRectParent':\n                points = this.bottomRightResizing(touchPoint);\n                prevX = points.left;\n                prevY = points.top;\n                break;\n            case 'BottomLeftRectParent':\n                points = this.bottomLeftResizing(touchPoint);\n                prevX = -points.left;\n                prevY = -points.top;\n                break;\n            case 'BottomMiddleRectParent':\n                prevY = touchPoint.y - prevY;\n                prevX = 0;\n                break;\n            case 'RightMiddleRectParent':\n                prevX = touchPoint.x - prevX;\n                prevY = 0;\n                break;\n            case 'LeftMiddleRectParent':\n                prevX = this.leftMiddleResizing(touchPoint);\n                prevY = 0;\n                break;\n            default:\n                break;\n        }\n        if (prevX !== 0 || prevY !== 0) {\n            var widget = this.currentImageElementBox.line.paragraph;\n            var image = this.currentImageElementBox;\n            if (!isNullOrUndefined(widget) && widget.isInsideTable) {\n                var cellWidget = widget.containerWidget;\n                if (!isNullOrUndefined(cellWidget)) {\n                    var rowWidget = cellWidget.containerWidget;\n                    var imageHeight = HelperMethods.convertPointToPixel(image.height);\n                    var widgetHeight = rowWidget.height - imageHeight;\n                    if (prevY > 0 && rowWidget.y + widgetHeight + imageHeight + prevY > this.viewer.clientArea.bottom) {\n                        this.isImageMoveToNextPage = true;\n                    }\n                }\n            }\n            // tslint:disable-next-line:max-line-length \n            if (this.owner.enableHistoryMode) {\n                this.initHistoryForImageResizer(this.currentImageElementBox);\n            }\n            if (!isNullOrUndefined(this.currentImageElementBox)) {\n                // tslint:disable-next-line:max-line-length   \n                var width = this.currentImageElementBox.width + prevX > 10 ? this.currentImageElementBox.width + prevX : 10;\n                // tslint:disable-next-line:max-line-length \n                var height = this.currentImageElementBox.height + prevY > 10 ? this.currentImageElementBox.height + prevY : 10;\n                if (this.selectedResizeElement.id.split('_')[1] === 'BottomRightRectParent'\n                    || this.selectedResizeElement.id.split('_')[1] === 'TopRightRectParent'\n                    || this.selectedResizeElement.id.split('_')[1] === 'BottomLeftRectParent'\n                    || this.selectedResizeElement.id.split('_')[1] === 'TopLeftRectParent') {\n                    height = this.currentImageElementBox.height / this.currentImageElementBox.width * width;\n                    width = this.currentImageElementBox.width / this.currentImageElementBox.height * height;\n                }\n                this.currentImageElementBox.width = width;\n                this.currentImageElementBox.height = height;\n                var owner = this.currentImageElementBox.line.paragraph;\n                this.positionImageResizer(this.currentImageElementBox);\n            }\n            this.isImageResizing = true;\n        }\n    };\n    /**\n     * Handles image resizing on mouse.\n     * @param {MouseEvent} event - Specifies for image resizing using mouse event.\n     * @private\n     */\n    ImageResizer.prototype.handleImageResizingOnMouse = function (event) {\n        if (!isNullOrUndefined(this.selectedResizeElement)) {\n            var prevX = parseFloat(this.selectedResizeElement.style.left);\n            var prevY = parseFloat(this.selectedResizeElement.style.top);\n            var cursorPoint = new Point(event.offsetX, event.offsetY);\n            var touchPoint = this.viewer.findFocusedPage(cursorPoint, true);\n            this.handleImageResizing(touchPoint, prevX, prevY);\n        }\n    };\n    ImageResizer.prototype.topMiddleResizing = function (touchPoint) {\n        var prevY;\n        if (this.topValue >= touchPoint.y) {\n            prevY = this.topValue / touchPoint.y;\n            this.topValue = touchPoint.y;\n            if (this.viewer instanceof PageLayoutViewer) {\n                if (this.topValue <= this.viewer.pageGap) {\n                    prevY = 1;\n                }\n            }\n        }\n        else {\n            prevY = -(touchPoint.y / this.topValue);\n            this.topValue = touchPoint.y;\n            if (this.topValue === 0) {\n                prevY = -1;\n            }\n        }\n        return prevY;\n    };\n    ImageResizer.prototype.leftMiddleResizing = function (touchPoint) {\n        var prevX;\n        if (this.leftValue >= touchPoint.x) {\n            prevX = this.leftValue / touchPoint.x;\n            this.leftValue = touchPoint.x;\n            if (this.leftValue === 0) {\n                prevX = 1;\n                this.leftValue = parseFloat(this.selectedResizeElement.style.left);\n            }\n        }\n        else {\n            prevX = -(touchPoint.x / this.leftValue);\n            this.leftValue = touchPoint.x;\n        }\n        return prevX;\n    };\n    ImageResizer.prototype.topRightResizing = function (touchPoint) {\n        var points;\n        if (this.leftValue <= touchPoint.x && this.topValue >= touchPoint.y) {\n            points = this.getOuterResizingPoint(touchPoint);\n        }\n        else {\n            points = this.getInnerResizingPoint(touchPoint);\n        }\n        return points;\n    };\n    ImageResizer.prototype.topLeftResizing = function (touchPoint) {\n        var points;\n        if (this.leftValue >= touchPoint.x && this.topValue >= touchPoint.y) {\n            points = this.getOuterResizingPoint(touchPoint);\n        }\n        else {\n            points = this.getInnerResizingPoint(touchPoint);\n        }\n        return points;\n    };\n    ImageResizer.prototype.bottomRightResizing = function (touchPoint) {\n        var points;\n        if (this.leftValue <= touchPoint.x && this.topValue <= touchPoint.y) {\n            points = this.getOuterResizingPoint(touchPoint);\n        }\n        else {\n            points = this.getInnerResizingPoint(touchPoint);\n        }\n        return points;\n    };\n    ImageResizer.prototype.bottomLeftResizing = function (touchPoint) {\n        var points;\n        if (this.leftValue >= touchPoint.x && this.topValue <= touchPoint.y) {\n            points = this.getOuterResizingPoint(touchPoint);\n        }\n        else {\n            points = this.getInnerResizingPoint(touchPoint);\n        }\n        return points;\n    };\n    ImageResizer.prototype.getOuterResizingPoint = function (touchPoint) {\n        var prevX;\n        var prevY;\n        prevX = touchPoint.x - this.leftValue;\n        this.leftValue = touchPoint.x;\n        prevY = touchPoint.y - this.topValue;\n        this.topValue = touchPoint.y;\n        return { left: prevX, top: prevY };\n    };\n    ImageResizer.prototype.getInnerResizingPoint = function (touchPoint) {\n        var prevX;\n        var prevY;\n        prevX = -(this.leftValue - touchPoint.x);\n        this.leftValue = touchPoint.x;\n        prevY = -(this.topValue - touchPoint.y);\n        this.topValue = touchPoint.y;\n        return { left: prevX, top: prevY };\n    };\n    /**\n     * Handles image resizing on touch.\n     * @param {TouchEvent} touchEvent - Specifies for image resizing using touch event.\n     * @private\n     */\n    ImageResizer.prototype.handleImageResizingOnTouch = function (touchEvent) {\n        if (!isNullOrUndefined(this.selectedResizeElement)) {\n            var prevX = parseFloat(this.selectedResizeElement.style.left) + 24;\n            var prevY = parseFloat(this.selectedResizeElement.style.top) + 24;\n            var touch = touchEvent.touches;\n            var cursorPoint = new Point(touch[0].clientX, touch[0].clientY);\n            var touchPoint = this.viewer.findFocusedPage(cursorPoint, true);\n            if (isNullOrUndefined(this.currentImageElementBox) || isNullOrUndefined(this.currentImageElementBox)) {\n                return;\n            }\n            this.handleImageResizing(touchPoint, prevX, prevY);\n        }\n    };\n    /**\n     * Gets the image point of mouse.\n     * @param {Point} touchPoint - Specifies for resizer cursor position.\n     * @private\n     */\n    ImageResizer.prototype.getImagePoint = function (touchPoint) {\n        var x = this.viewer.render.getScaledValue(touchPoint.x, 1);\n        var y = this.viewer.render.getScaledValue(touchPoint.y, 2);\n        touchPoint = new Point(x, y);\n        var imageResizingPoints = this.imageResizerPoints;\n        var resizePosition = '';\n        var selectedElement = undefined;\n        var bottomMiddle = imageResizingPoints.bottomMiddleRectParent;\n        var bottomRight = imageResizingPoints.bottomRightRectParent;\n        var bottomLeft = imageResizingPoints.bottomLeftRectParent;\n        var topMiddle = imageResizingPoints.topMiddleRectParent;\n        var topRight = imageResizingPoints.topRightRectParent;\n        var topLeft = imageResizingPoints.topLeftRectParent;\n        var rightMiddle = imageResizingPoints.rightMiddleRectParent;\n        var leftMiddle = imageResizingPoints.leftMiddleRectParent;\n        if (!isNullOrUndefined(this.bottomMiddleRectParent) && this.bottomMiddleRectParent.style.display !== 'none') {\n            // tslint:disable-next-line:max-line-length   \n            if ((touchPoint.x > bottomMiddle.x && touchPoint.x <= bottomMiddle.x + 15) && (touchPoint.y > bottomMiddle.y && touchPoint.y <= bottomMiddle.y + 15)) {\n                selectedElement = this.bottomMiddleRectParent;\n                resizePosition = 's-resize';\n                // tslint:disable-next-line:max-line-length   \n            }\n            else if ((touchPoint.x > bottomRight.x && touchPoint.x <= bottomRight.x + 15) && (touchPoint.y > bottomRight.y && touchPoint.y <= bottomRight.y + 15)) {\n                selectedElement = this.bottomRightRectParent;\n                resizePosition = 'se-resize';\n                // tslint:disable-next-line:max-line-length   \n            }\n            else if ((touchPoint.x > bottomLeft.x && touchPoint.x <= bottomLeft.x + 15) && (touchPoint.y > bottomLeft.y && touchPoint.y <= bottomLeft.y + 15)) {\n                selectedElement = this.bottomLeftRectParent;\n                resizePosition = 'sw-resize';\n                // tslint:disable-next-line:max-line-length   \n            }\n            else if ((touchPoint.x > topMiddle.x && touchPoint.x <= topMiddle.x + 15) && (touchPoint.y > topMiddle.y && touchPoint.y <= topMiddle.y + 15)) {\n                selectedElement = this.topMiddleRectParent;\n                resizePosition = 'n-resize';\n                // tslint:disable-next-line:max-line-length   \n            }\n            else if ((touchPoint.x > topRight.x && touchPoint.x <= topRight.x + 15) && (touchPoint.y > topRight.y && touchPoint.y <= topRight.y + 15)) {\n                selectedElement = this.topRightRectParent;\n                resizePosition = 'ne-resize';\n                // tslint:disable-next-line:max-line-length   \n            }\n            else if ((touchPoint.x > topLeft.x && touchPoint.x <= topLeft.x + 15) && (touchPoint.y > topLeft.y && touchPoint.y <= topLeft.y + 15)) {\n                selectedElement = this.topLeftRectParent;\n                resizePosition = 'nw-resize';\n                // tslint:disable-next-line:max-line-length   \n            }\n            else if ((touchPoint.x > leftMiddle.x && touchPoint.x <= leftMiddle.x + 15) && (touchPoint.y > leftMiddle.y && touchPoint.y <= leftMiddle.y + 15)) {\n                selectedElement = this.leftMiddleRectParent;\n                resizePosition = 'w-resize';\n                // tslint:disable-next-line:max-line-length   \n            }\n            else if ((touchPoint.x > rightMiddle.x && touchPoint.x <= rightMiddle.x + 15) && (touchPoint.y > rightMiddle.y && touchPoint.y <= rightMiddle.y + 15)) {\n                selectedElement = this.rightMiddleRectParent;\n                resizePosition = 'e-resize';\n                // tslint:disable-next-line:max-line-length   \n            }\n            else if (!isNullOrUndefined(this.resizeContainerDiv) && (touchPoint.x > parseFloat(this.resizeContainerDiv.style.left)\n                && touchPoint.x <= (parseFloat(this.resizeContainerDiv.style.left) + parseFloat(this.resizeContainerDiv.style.width)))\n                && (touchPoint.y > parseFloat(this.resizeContainerDiv.style.top)\n                    // tslint:disable-next-line:max-line-length \n                    && touchPoint.y <= (parseFloat(this.resizeContainerDiv.style.top) + parseFloat(this.resizeContainerDiv.style.height)))) {\n                resizePosition = 'move';\n            }\n        }\n        return { 'selectedElement': selectedElement, 'resizePosition': resizePosition };\n    };\n    ImageResizer.prototype.applyPropertiesForMouse = function () {\n        if (!isNullOrUndefined(this.bottomLeftRectParent)) {\n            this.bottomMiddleRectParent.style.width = '14px';\n            this.bottomMiddleRectParent.style.height = '14px';\n            this.bottomRightRectParent.style.width = '14px';\n            this.bottomRightRectParent.style.height = '14px';\n            this.bottomLeftRectParent.style.width = '14px';\n            this.bottomLeftRectParent.style.height = '14px';\n            this.topMiddleRectParent.style.width = '14px';\n            this.topMiddleRectParent.style.height = '14px';\n            this.topRightRectParent.style.width = '14px';\n            this.topRightRectParent.style.height = '14px';\n            this.topLeftRectParent.style.width = '14px';\n            this.topLeftRectParent.style.height = '14px';\n            this.leftMiddleRectParent.style.width = '14px';\n            this.leftMiddleRectParent.style.height = '14px';\n            this.rightMiddleRectParent.style.width = '14px';\n            this.rightMiddleRectParent.style.height = '14px';\n        }\n    };\n    /**\n     * Gets the image point of touch.\n     * @param {Point} touchPoints - Specifies for resizer cursor position.\n     * @private\n     */\n    ImageResizer.prototype.getImagePointOnTouch = function (touchPoints) {\n        var x = this.viewer.render.getScaledValue(touchPoints.x, 1);\n        var y = this.viewer.render.getScaledValue(touchPoints.y, 2);\n        touchPoints = new Point(x, y);\n        var imageResizingPointsOnTouch = this.imageResizerPoints;\n        var resizePosition = '';\n        var selectedElements = undefined;\n        var bottomMiddle = imageResizingPointsOnTouch.bottomMiddleRectParent;\n        var bottomRight = imageResizingPointsOnTouch.bottomRightRectParent;\n        var bottomLeft = imageResizingPointsOnTouch.bottomLeftRectParent;\n        var topMiddle = imageResizingPointsOnTouch.topMiddleRectParent;\n        var topRight = imageResizingPointsOnTouch.topRightRectParent;\n        var topLeft = imageResizingPointsOnTouch.topLeftRectParent;\n        var rightMiddle = imageResizingPointsOnTouch.rightMiddleRectParent;\n        var leftMiddle = imageResizingPointsOnTouch.leftMiddleRectParent;\n        if (!isNullOrUndefined(this.bottomMiddleRectParent) && this.bottomMiddleRectParent.style.display !== 'none') {\n            // tslint:disable-next-line:max-line-length   \n            if ((touchPoints.x > bottomMiddle.x && touchPoints.x <= bottomMiddle.x + 25) && (touchPoints.y > bottomMiddle.y && touchPoints.y <= bottomMiddle.y + 25)) {\n                selectedElements = this.bottomMiddleRectParent;\n                resizePosition = 's-resize';\n                // tslint:disable-next-line:max-line-length   \n            }\n            else if ((touchPoints.x > bottomRight.x && touchPoints.x <= bottomRight.x + 25) && (touchPoints.y > bottomRight.y && touchPoints.y <= bottomRight.y + 25)) {\n                selectedElements = this.bottomRightRectParent;\n                resizePosition = 'se-resize';\n                // tslint:disable-next-line:max-line-length   \n            }\n            else if ((touchPoints.x > bottomLeft.x && touchPoints.x <= bottomLeft.x + 25) && (touchPoints.y > bottomLeft.y && touchPoints.y <= bottomLeft.y + 25)) {\n                selectedElements = this.bottomLeftRectParent;\n                resizePosition = 'sw-resize';\n                // tslint:disable-next-line:max-line-length   \n            }\n            else if ((touchPoints.x > topMiddle.x && touchPoints.x <= topMiddle.x + 25) && (touchPoints.y > topMiddle.y && touchPoints.y <= topMiddle.y + 25)) {\n                selectedElements = this.topMiddleRectParent;\n                resizePosition = 'n-resize';\n                // tslint:disable-next-line:max-line-length   \n            }\n            else if ((touchPoints.x > topRight.x && touchPoints.x <= topRight.x + 25) && (touchPoints.y > topRight.y && touchPoints.y <= topRight.y + 25)) {\n                selectedElements = this.topRightRectParent;\n                resizePosition = 'ne-resize';\n                // tslint:disable-next-line:max-line-length   \n            }\n            else if ((touchPoints.x > topLeft.x && touchPoints.x <= topLeft.x + 25) && (touchPoints.y > topLeft.y && touchPoints.y <= topLeft.y + 25)) {\n                selectedElements = this.topLeftRectParent;\n                resizePosition = 'nw-resize';\n                // tslint:disable-next-line:max-line-length   \n            }\n            else if ((touchPoints.x > leftMiddle.x && touchPoints.x <= leftMiddle.x + 25) && (touchPoints.y > leftMiddle.y && touchPoints.y <= leftMiddle.y + 25)) {\n                selectedElements = this.leftMiddleRectParent;\n                resizePosition = 'w-resize';\n                // tslint:disable-next-line:max-line-length   \n            }\n            else if ((touchPoints.x > rightMiddle.x && touchPoints.x <= rightMiddle.x + 25) && (touchPoints.y > rightMiddle.y && touchPoints.y <= rightMiddle.y + 25)) {\n                selectedElements = this.rightMiddleRectParent;\n                resizePosition = 'e-resize';\n                // tslint:disable-next-line:max-line-length   \n            }\n            else if (!isNullOrUndefined(this.resizeContainerDiv) && (touchPoints.x > parseFloat(this.resizeContainerDiv.style.left)\n                && touchPoints.x <= (parseFloat(this.resizeContainerDiv.style.left) + parseFloat(this.resizeContainerDiv.style.width)))\n                && (touchPoints.y > parseFloat(this.resizeContainerDiv.style.top)\n                    // tslint:disable-next-line:max-line-length \n                    && touchPoints.y <= (parseFloat(this.resizeContainerDiv.style.top) + parseFloat(this.resizeContainerDiv.style.height)))) {\n                resizePosition = 'move';\n            }\n        }\n        return { 'selectedElement': selectedElements, 'resizePosition': resizePosition };\n    };\n    ImageResizer.prototype.applyPropertiesForTouch = function () {\n        if (!isNullOrUndefined(this.bottomLeftRectParent)) {\n            this.bottomMiddleRectParent.style.width = '30px';\n            this.bottomMiddleRectParent.style.height = '30px';\n            this.bottomRightRectParent.style.width = '30px';\n            this.bottomRightRectParent.style.height = '30px';\n            this.bottomLeftRectParent.style.width = '30px';\n            this.bottomLeftRectParent.style.height = '30px';\n            this.topMiddleRectParent.style.width = '30px';\n            this.topMiddleRectParent.style.height = '30px';\n            this.topRightRectParent.style.width = '30px';\n            this.topRightRectParent.style.height = '30px';\n            this.topLeftRectParent.style.width = '30px';\n            this.topLeftRectParent.style.height = '30px';\n            this.leftMiddleRectParent.style.width = '30px';\n            this.leftMiddleRectParent.style.height = '30px';\n            this.rightMiddleRectParent.style.width = '30px';\n            this.rightMiddleRectParent.style.height = '30px';\n        }\n    };\n    /**\n     * @private\n     */\n    ImageResizer.prototype.mouseUpInternal = function () {\n        this.currentImageElementBox.width = parseFloat(this.imageResizerDiv.style.width) / this.viewer.zoomFactor;\n        this.currentImageElementBox.height = parseFloat(this.imageResizerDiv.style.height) / this.viewer.zoomFactor;\n        this.owner.isShiftingEnabled = true;\n        this.owner.editorModule.setOffsetValue(this.owner.selection);\n        this.viewer.layout.reLayoutParagraph(this.currentImageElementBox.line.paragraph, 0, 0);\n        this.owner.editorModule.reLayout(this.owner.selection, true);\n        this.viewer.updateScrollBars();\n    };\n    /**\n     * Initialize history for image resizer.\n     * @param {ImageResizer} imageResizer - Specifies for image resizer.\n     * @param {WImage} imageContainer - Specifies for an image.\n     * @private\n     */\n    ImageResizer.prototype.initHistoryForImageResizer = function (imageContainer) {\n        if (!isNullOrUndefined(this.owner) && isNullOrUndefined(this.baseHistoryInfo)) {\n            this.baseHistoryInfo = new BaseHistoryInfo(this.owner);\n            this.baseHistoryInfo.action = 'ImageResizing';\n            this.baseHistoryInfo.updateSelection();\n            this.baseHistoryInfo.modifiedProperties.push(new ImageFormat(imageContainer));\n        }\n    };\n    /**\n     * Updates histroy for image resizer.\n     * @private\n     */\n    ImageResizer.prototype.updateHistoryForImageResizer = function () {\n        if (!isNullOrUndefined(this.owner) && !isNullOrUndefined(this.baseHistoryInfo)) {\n            var imageFormat = this.baseHistoryInfo.modifiedProperties[0];\n            if (this.currentImageElementBox.width === imageFormat.width\n                && this.currentImageElementBox.height === imageFormat.height) {\n                this.baseHistoryInfo.modifiedProperties.pop();\n            }\n            else {\n                //Records the image size modifications\n                this.owner.editorHistory.recordChanges(this.baseHistoryInfo);\n            }\n            //Fires the content changed event for the image size modifications\n            this.baseHistoryInfo = undefined;\n        }\n    };\n    /**\n     * Updates image resize container when applying zooming\n     * @private\n     */\n    ImageResizer.prototype.updateImageResizerPosition = function () {\n        if (!isNullOrUndefined(this.currentImageElementBox)) {\n            var elementBox = this.currentImageElementBox;\n            var lineWidget = elementBox.line;\n            var top_1 = this.viewer.selection.getTop(lineWidget) + elementBox.margin.top;\n            var left = this.viewer.selection.getLeftInternal(lineWidget, elementBox, 0);\n            var topValue = top_1 * this.viewer.zoomFactor;\n            var leftValue = left * this.viewer.zoomFactor;\n            var height = this.viewer.render.getScaledValue(elementBox.height, 2);\n            var width = this.viewer.render.getScaledValue(elementBox.width, 1);\n            this.setImageResizerPosition(leftValue, topValue, width, height, this);\n        }\n    };\n    /**\n     * Dispose the internal objects which are maintained.\n     * @private\n     */\n    ImageResizer.prototype.destroy = function () {\n        if (!isNullOrUndefined(this.resizeContainerDiv)) {\n            this.resizeContainerDiv.innerHTML = '';\n        }\n        if (!isNullOrUndefined(this.topLeftRect)) {\n            this.topLeftRect.innerHTML = '';\n        }\n        if (!isNullOrUndefined(this.topMiddleRect)) {\n            this.topMiddleRect.innerHTML = '';\n        }\n        if (!isNullOrUndefined(this.topRightRect)) {\n            this.topRightRect.innerHTML = '';\n        }\n        if (!isNullOrUndefined(this.bottomLeftRect)) {\n            this.bottomLeftRect.innerHTML = '';\n        }\n        if (!isNullOrUndefined(this.bottomMiddleRect)) {\n            this.bottomMiddleRect.innerHTML = '';\n        }\n        if (!isNullOrUndefined(this.bottomRightRect)) {\n            this.bottomRightRect.innerHTML = '';\n        }\n        if (!isNullOrUndefined(this.leftMiddleRect)) {\n            this.leftMiddleRect.innerHTML = '';\n        }\n        if (!isNullOrUndefined(this.rightMiddleRect)) {\n            this.rightMiddleRect.innerHTML = '';\n        }\n        if (!isNullOrUndefined(this.imageResizerDiv)) {\n            this.imageResizerDiv.innerHTML = '';\n        }\n        if (!isNullOrUndefined(this.selectedImageWidget)) {\n            this.selectedImageWidget.destroy();\n        }\n        if (!isNullOrUndefined(this.imageResizerDivElement)) {\n            this.imageResizerDivElement.innerHTML = '';\n        }\n        this.imageResizerDivElement = undefined;\n        this.resizeContainerDiv = undefined;\n        this.topLeftRect = undefined;\n        this.topMiddleRect = undefined;\n        this.topRightRect = undefined;\n        this.bottomLeftRect = undefined;\n        this.bottomMiddleRect = undefined;\n        this.bottomRightRect = undefined;\n        this.leftMiddleRect = undefined;\n        this.rightMiddleRect = undefined;\n        this.imageResizerDiv = undefined;\n        this.selectedImageWidget = undefined;\n        this.isImageResizing = false;\n        this.isImageResizerVisible = false;\n        this.currentImageElementBoxIn = undefined;\n        //this.baseHistoryInfo = undefined;\n        this.resizeMarkSizeIn = undefined;\n        this.viewer = undefined;\n        this.owner = undefined;\n    };\n    return ImageResizer;\n}());\nexport { ImageResizer };\n/**\n * @private\n */\nvar ImageResizingPoints = /** @class */ (function () {\n    /**\n     * Constructor for image resizing points class.\n     */\n    function ImageResizingPoints() {\n        /**\n         * @private\n         */ this.resizeContainerDiv = new Point(0, 0);\n        /**\n         * @private\n         */\n        this.topLeftRectParent = new Point(0, 0);\n        /**\n         * @private\n         */\n        this.topMiddleRectParent = new Point(0, 0);\n        /**\n         * @private\n         */\n        this.topRightRectParent = new Point(0, 0);\n        /**\n         * @private\n         */\n        this.bottomLeftRectParent = new Point(0, 0);\n        /**\n         * @private\n         */\n        this.bottomMiddleRectParent = new Point(0, 0);\n        /**\n         * @private\n         */\n        this.bottomRightRectParent = new Point(0, 0);\n        /**\n         * @private\n         */\n        this.leftMiddleRectParent = new Point(0, 0);\n        /**\n         * @private\n         */\n        this.rightMiddleRectParent = new Point(0, 0);\n        var text = 'DocumentEditor';\n    }\n    return ImageResizingPoints;\n}());\nexport { ImageResizingPoints };\n/**\n * @private\n */\nvar SelectedImageInfo = /** @class */ (function () {\n    /**\n     * Constructor for selected image info class.\n     * @param {number} height - Specifies for height value.\n     * @param {number} width - Specifies for width value.\n     */\n    function SelectedImageInfo(height, width) {\n        this.heightIn = 0;\n        this.widthIn = 0;\n        this.heightIn = height;\n        this.widthIn = width;\n    }\n    Object.defineProperty(SelectedImageInfo.prototype, \"height\", {\n        /**\n         * Gets or Sets the height value.\n         * @private\n         */\n        get: function () {\n            return this.heightIn;\n        },\n        /**\n         * @private\n         */\n        set: function (value) {\n            this.heightIn = value;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(SelectedImageInfo.prototype, \"width\", {\n        /**\n         * Gets or Sets the width value.\n         * @private\n         */\n        get: function () {\n            return this.widthIn;\n        },\n        /**\n         * @private\n         */\n        set: function (value) {\n            this.widthIn = value;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    return SelectedImageInfo;\n}());\nexport { SelectedImageInfo };\n","var __extends = (this && this.__extends) || (function () {\n    var extendStatics = Object.setPrototypeOf ||\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nimport { isNullOrUndefined } from '@syncfusion/ej2-base';\nimport { BaseHistoryInfo } from './base-history-info';\n/**\n * EditorHistory preservation class\n */\n/**\n * @private\n */\nvar HistoryInfo = /** @class */ (function (_super) {\n    __extends(HistoryInfo, _super);\n    function HistoryInfo(node, isChild) {\n        var _this = _super.call(this, node) || this;\n        _this.isChildHistoryInfo = false;\n        _this.isChildHistoryInfo = isChild;\n        return _this;\n    }\n    Object.defineProperty(HistoryInfo.prototype, \"hasAction\", {\n        /**\n         * @private\n         */\n        get: function () {\n            return !isNullOrUndefined(this.modifiedActions);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    /**\n     * Adds the modified actions\n     * @param  {BaseHistoryInfo} baseHistoryInfo\n     * @private\n     */\n    HistoryInfo.prototype.addModifiedAction = function (baseHistoryInfo) {\n        // For complex actions such as Replace text, Insert/Remove Hyperlink etc.\n        if (!(this.editorHistory.isUndoing || this.editorHistory.isRedoing)) {\n            if (isNullOrUndefined(this.modifiedActions)) {\n                this.modifiedActions = [];\n            }\n            this.modifiedActions.push(baseHistoryInfo);\n        }\n    };\n    /**\n     * Reverts this instance\n     * @private\n     */\n    HistoryInfo.prototype.revert = function () {\n        this.editorHistory.currentHistoryInfo = this;\n        if (this.action === 'BordersAndShading') {\n            this.owner.editorModule.isBordersAndShadingDialog = true;\n        }\n        if (!isNullOrUndefined(this.modifiedActions)) {\n            if (this.editorHistory.isUndoing) {\n                var i = this.modifiedActions.length;\n                while (i > 0) {\n                    var baseHistoryInfo = this.modifiedActions[i - 1];\n                    baseHistoryInfo.revert();\n                    i = i - 1;\n                }\n            }\n            else {\n                var i = 0;\n                while (i < this.modifiedActions.length) {\n                    var baseHistoryInfo = this.modifiedActions[i];\n                    baseHistoryInfo.revert();\n                    i = i + 1;\n                }\n            }\n        }\n        if (!this.isChildHistoryInfo) {\n            this.editorHistory.updateComplexHistory();\n        }\n        else {\n            this.editorHistory.updateComplexHistoryInternal();\n        }\n    };\n    /**\n     * @private\n     */\n    HistoryInfo.prototype.destroy = function () {\n        if (!isNullOrUndefined(this.modifiedActions)) {\n            while (this.modifiedActions.length > 0) {\n                var baseHistoryInfo = this.modifiedActions[this.modifiedActions.length - 1];\n                baseHistoryInfo.destroy();\n                this.modifiedActions.splice(this.modifiedActions.indexOf(baseHistoryInfo), 1);\n            }\n            this.modifiedActions = undefined;\n        }\n        _super.prototype.destroy.call(this);\n    };\n    return HistoryInfo;\n}(BaseHistoryInfo));\nexport { HistoryInfo };\n","import { Dictionary } from '../../base/dictionary';\nimport { TextPosition } from '../selection/selection-helper';\nimport { isNullOrUndefined } from '@syncfusion/ej2-base';\nimport { BaseHistoryInfo, } from './base-history-info';\nimport { ModifiedParagraphFormat, ModifiedLevel, RowHistoryFormat, TableHistoryInfo } from './history-helper';\nimport { HistoryInfo } from './history-info';\nimport { WParagraphFormat } from '../format/paragraph-format';\nimport { HelperMethods } from '../editor/editor-helper';\n/**\n *  `EditorHistory` Module class is used to handle history preservation\n */\nvar EditorHistory = /** @class */ (function () {\n    /**\n     * @private\n     */\n    function EditorHistory(node) {\n        //Fields\n        this.undoStackIn = [];\n        this.redoStackIn = [];\n        this.historyInfoStack = [];\n        /**\n         * @private\n         */\n        this.isUndoing = false;\n        /**\n         * @private\n         */\n        this.isRedoing = false;\n        this.owner = node;\n        this.viewer = node.viewer;\n        this.modifiedParaFormats = new Dictionary();\n        this.undoLimitIn = 500;\n        this.redoLimitIn = 500;\n    }\n    Object.defineProperty(EditorHistory.prototype, \"currentHistoryInfo\", {\n        /**\n         * @private\n         */\n        get: function () {\n            return this.historyInfoStack && this.historyInfoStack.length > 0 ?\n                this.historyInfoStack[this.historyInfoStack.length - 1] : undefined;\n        },\n        set: function (value) {\n            if (value instanceof HistoryInfo) {\n                this.historyInfoStack.push(value);\n            }\n            else {\n                this.historyInfoStack.pop();\n            }\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(EditorHistory.prototype, \"undoStack\", {\n        //Properties\n        /**\n         * gets undo stack\n         * @private\n         */\n        get: function () { return this.undoStackIn; },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(EditorHistory.prototype, \"redoStack\", {\n        /**\n         * gets redo stack\n         * @private\n         */\n        get: function () { return this.redoStackIn; },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(EditorHistory.prototype, \"undoLimit\", {\n        /**\n         * Gets or Sets the limit of undo operations can be done.\n         */\n        get: function () {\n            return isNullOrUndefined(this.undoLimitIn) ? 0 : this.undoLimitIn;\n        },\n        set: function (value) {\n            if (value < 0) {\n                throw new Error('The limit should be greater than or equal to zero.');\n            }\n            this.undoLimitIn = value;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(EditorHistory.prototype, \"redoLimit\", {\n        /**\n         * Gets or Sets the limit of redo operations can be done.\n         */\n        get: function () {\n            return isNullOrUndefined(this.redoLimitIn) ? 0 : this.redoLimitIn;\n        },\n        set: function (value) {\n            if (value < 0) {\n                throw new Error('The limit should be greater than or equal to zero.');\n            }\n            this.redoLimitIn = value;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    /**\n     * @private\n     */\n    EditorHistory.prototype.getModuleName = function () {\n        return 'EditorHistory';\n    };\n    /**\n     * Determines whether undo operation can be done.\n     * @returns boolean\n     */\n    EditorHistory.prototype.canUndo = function () {\n        return !isNullOrUndefined(this.undoStack) && this.undoStack.length > 0;\n    };\n    /**\n     * Determines whether redo operation can be done.\n     * @returns boolean\n     */\n    EditorHistory.prototype.canRedo = function () {\n        return !isNullOrUndefined(this.redoStack) && this.redoStack.length > 0;\n    };\n    //EditorHistory Initialization    \n    /**\n     * initialize EditorHistory\n     * @param  {Selection} selection\n     * @param  {Action} action\n     * @param  {SelectionRange} selectionRange\n     * @private\n     */\n    EditorHistory.prototype.initializeHistory = function (action) {\n        this.currentBaseHistoryInfo = new BaseHistoryInfo(this.owner);\n        this.currentBaseHistoryInfo.action = action;\n        this.currentBaseHistoryInfo.updateSelection();\n    };\n    /**\n     * Initialize complex history\n     * @param  {Selection} selection\n     * @param  {Action} action\n     * @private\n     */\n    EditorHistory.prototype.initComplexHistory = function (selection, action) {\n        this.currentHistoryInfo = new HistoryInfo(selection.owner, !isNullOrUndefined(this.currentHistoryInfo));\n        this.currentHistoryInfo.action = action;\n        this.currentHistoryInfo.updateSelection();\n    };\n    /**\n     * @private\n     */\n    EditorHistory.prototype.initResizingHistory = function (startingPoint, tableResize) {\n        if (tableResize.resizeNode === 1) {\n            this.initializeHistory('RowResizing');\n            if (!isNullOrUndefined(this.currentBaseHistoryInfo)) {\n                // tslint:disable-next-line:max-line-length\n                this.currentBaseHistoryInfo.modifiedProperties.push(new RowHistoryFormat(startingPoint, tableResize.currentResizingTable.childWidgets[tableResize.resizerPosition].rowFormat));\n            }\n        }\n        else {\n            this.initializeHistory('CellResizing');\n            if (this.currentBaseHistoryInfo) {\n                tableResize.currentResizingTable = tableResize.currentResizingTable.combineWidget(this.viewer);\n                var tableHistoryInfo = new TableHistoryInfo(tableResize.currentResizingTable, this.owner);\n                tableHistoryInfo.startingPoint = startingPoint;\n                this.currentBaseHistoryInfo.modifiedProperties.push(tableHistoryInfo);\n            }\n        }\n    };\n    /**\n     * Update resizing history\n     * @param  {Point} point\n     * @param  {Selection} selection\n     * @private\n     */\n    EditorHistory.prototype.updateResizingHistory = function (point, tableResize) {\n        if (tableResize.resizeNode === 1) {\n            if (!isNullOrUndefined(this.currentBaseHistoryInfo)) {\n                var rowHistoryFormat = this.currentBaseHistoryInfo.modifiedProperties[0];\n                if (rowHistoryFormat.startingPoint.y === point.y) {\n                    this.currentBaseHistoryInfo.modifiedProperties.length = 0;\n                }\n                else {\n                    rowHistoryFormat.displacement = HelperMethods.convertPixelToPoint(point.y - rowHistoryFormat.startingPoint.y);\n                    this.recordChanges(this.currentBaseHistoryInfo);\n                    this.currentBaseHistoryInfo = undefined;\n                }\n            }\n        }\n        else {\n            if (!isNullOrUndefined(this.currentBaseHistoryInfo)) {\n                var cellHistoryFormat = this.currentBaseHistoryInfo.modifiedProperties[0];\n                if (cellHistoryFormat.startingPoint.x === point.x) {\n                    this.currentBaseHistoryInfo.modifiedProperties.length = 0;\n                }\n                else {\n                    cellHistoryFormat.displacement = HelperMethods.convertPixelToPoint(point.x - cellHistoryFormat.startingPoint.x);\n                    cellHistoryFormat.endIndex = tableResize.getCellReSizerPosition(point);\n                    this.owner.editorHistory.recordChanges(this.currentBaseHistoryInfo);\n                    this.currentBaseHistoryInfo = undefined;\n                }\n            }\n        }\n    };\n    /**\n     * Record the changes\n     * @param  {BaseHistoryInfo} baseHistoryInfo\n     * @private\n     */\n    EditorHistory.prototype.recordChanges = function (baseHistoryInfo) {\n        if (!this.owner.enableHistoryMode) {\n            return;\n        }\n        if (this.isUndoing) {\n            if (isNullOrUndefined(this.redoStack)) {\n                this.redoStackIn = [];\n            }\n            if (this.redoStack.length === this.redoLimit && this.redoLimit > 0) {\n                var count = this.undoLimit > 20 ? 10 : 1;\n                this.redoStackIn.splice(0, count);\n            }\n            if (this.redoStack.length < this.redoLimit) {\n                this.redoStack.push(baseHistoryInfo);\n            }\n        }\n        else {\n            if (!this.isRedoing) {\n                this.clearRedoStack();\n            }\n            if (isNullOrUndefined(this.undoStack)) {\n                this.undoStackIn = [];\n            }\n            if (this.undoStack.length === this.undoLimit && this.undoLimit > 0) {\n                var count = this.undoLimit > 20 ? 10 : 1;\n                this.undoStackIn.splice(0, count);\n            }\n            if (this.undoStack.length < this.undoLimit) {\n                this.undoStackIn.push(baseHistoryInfo);\n            }\n        }\n    };\n    /**\n     * update EditorHistory\n     * @private\n     */\n    EditorHistory.prototype.updateHistory = function () {\n        if (this.viewer.owner.enableHistoryMode && !isNullOrUndefined(this.currentBaseHistoryInfo)) {\n            //Updates the current end position\n            if (!isNullOrUndefined(this.currentBaseHistoryInfo)\n                && isNullOrUndefined(this.currentBaseHistoryInfo.endPosition)) {\n                this.currentBaseHistoryInfo.endPosition = this.currentBaseHistoryInfo.insertPosition;\n            }\n            if (!isNullOrUndefined(this.currentHistoryInfo)) {\n                this.currentHistoryInfo.addModifiedAction(this.currentBaseHistoryInfo);\n            }\n            else {\n                this.recordChanges(this.currentBaseHistoryInfo);\n            }\n            this.currentBaseHistoryInfo = undefined;\n        }\n    };\n    /**\n     * @private\n     */\n    EditorHistory.prototype.isHandledComplexHistory = function () {\n        var isHandledComplexHistory = false;\n        if (!(this.isUndoing || this.isRedoing)) {\n            isHandledComplexHistory = this.owner.editorModule.insertRemoveBookMarkElements();\n        }\n        if (this.viewer.owner.enableHistoryMode && !isNullOrUndefined(this.currentHistoryInfo)) {\n            this.updateHistory();\n            isHandledComplexHistory = true;\n        }\n        else if (this.owner.editorModule.isHandledComplex) {\n            isHandledComplexHistory = true;\n        }\n        return isHandledComplexHistory;\n    };\n    /**\n     * Update complex history\n     * @private\n     */\n    EditorHistory.prototype.updateComplexHistory = function () {\n        var selection = this.viewer.selection;\n        if (this.currentHistoryInfo.hasAction) {\n            if (this.currentHistoryInfo.action === 'AutoFormatHyperlink') {\n                var startPosition = new TextPosition(selection.owner);\n                this.owner.editorModule.setPositionForCurrentIndex(startPosition, this.currentHistoryInfo.insertPosition);\n                // this.reLayoutParagraph(startPosition.paragraph, 0);\n                if (selection.owner.editorHistory.isUndoing) {\n                    this.owner.editorModule.setPositionForCurrentIndex(selection.start, this.currentHistoryInfo.selectionStart);\n                    this.owner.editorModule.setPositionForCurrentIndex(selection.end, this.currentHistoryInfo.selectionEnd);\n                }\n                else {\n                    this.owner.editorModule.setPositionForCurrentIndex(selection.start, this.currentHistoryInfo.endPosition);\n                    this.owner.editorModule.setPositionForCurrentIndex(selection.end, this.currentHistoryInfo.endPosition);\n                }\n            }\n            if (this.currentHistoryInfo.action === 'InsertHyperlink') {\n                var startPosition = new TextPosition(selection.owner);\n                this.owner.editorModule.setPositionForCurrentIndex(startPosition, this.currentHistoryInfo.insertPosition);\n                var endPosition = new TextPosition(selection.owner);\n                this.owner.editorModule.setPositionForCurrentIndex(endPosition, this.currentHistoryInfo.endPosition);\n                this.viewer.layout.reLayoutParagraph(startPosition.paragraph, 0, 0);\n                if (endPosition.paragraph !== startPosition.paragraph) {\n                    this.viewer.layout.reLayoutParagraph(endPosition.paragraph, 0, 0);\n                }\n            }\n            if (this.currentHistoryInfo.action === 'ReplaceAll') {\n                this.owner.editorModule.layoutWholeDocument();\n            }\n            else if (selection.owner.isShiftingEnabled) {\n                this.viewer.layout.shiftLayoutedItems();\n                if (this.owner.enableHeaderAndFooter) {\n                    this.owner.editorModule.updateHeaderFooterWidget();\n                }\n                this.viewer.removeEmptyPages();\n            }\n        }\n        selection.owner.isShiftingEnabled = false;\n        selection.owner.isLayoutEnabled = true;\n        // // selection.addMultipleSelectionRanges();\n        selection.start.updatePhysicalPosition(true);\n        if (selection.isEmpty) {\n            selection.end.setPositionInternal(selection.start);\n        }\n        else {\n            selection.end.updatePhysicalPosition(true);\n        }\n        selection.upDownSelectionLength = selection.end.location.x;\n        this.viewer.updateScrollBars();\n        selection.fireSelectionChanged(true);\n        this.viewer.updateFocus();\n        this.updateComplexHistoryInternal();\n        this.owner.editorModule.fireContentChange();\n    };\n    /**\n     * @private\n     */\n    EditorHistory.prototype.updateComplexHistoryInternal = function () {\n        if (!isNullOrUndefined(this.currentHistoryInfo)) {\n            //Updates the current end position\n            if (isNullOrUndefined(this.currentHistoryInfo.endPosition)) {\n                this.currentHistoryInfo.endPosition = this.currentHistoryInfo.insertPosition;\n            }\n            if (this.historyInfoStack.length > 1) {\n                var historyInfo = this.historyInfoStack[this.historyInfoStack.length - 2];\n                historyInfo.addModifiedAction(this.currentHistoryInfo);\n            }\n            else {\n                this.recordChanges(this.currentHistoryInfo);\n            }\n            this.currentHistoryInfo = undefined;\n        }\n    };\n    //List history preservation undo API\n    /**\n     * update list changes for history preservation\n     * @param  {Selection} selection\n     * @param  {WAbstractList} currentAbstractList\n     * @param  {WList} list\n     * @private\n     */\n    EditorHistory.prototype.updateListChangesInHistory = function (currentAbstractList, list) {\n        this.currentBaseHistoryInfo = new BaseHistoryInfo(this.viewer.owner);\n        this.currentBaseHistoryInfo.action = 'List';\n        this.currentBaseHistoryInfo.updateSelection();\n        var collection = new Dictionary();\n        for (var i = 0; i < currentAbstractList.levels.length; i++) {\n            var levels = this.viewer.getAbstractListById(list.abstractListId).levels[i];\n            var value = this.currentBaseHistoryInfo.addModifiedPropertiesForList(levels);\n            var modifiedLevel = new ModifiedLevel(levels, currentAbstractList.levels[i]);\n            if (!isNullOrUndefined(levels)) {\n                this.viewer.owner.editorModule.copyListLevel(levels, currentAbstractList.levels[i]);\n            }\n            collection.add(i, modifiedLevel);\n        }\n        return collection;\n    };\n    /**\n     * Apply list changes\n     * @param  {Selection} selection\n     * @param  {Dictionary<number, ModifiedLevel>} modifiedLevelsInternal\n     * @private\n     */\n    EditorHistory.prototype.applyListChanges = function (selection, modifiedLevelsInternal) {\n        if (isNullOrUndefined(this.modifiedParaFormats)) {\n            this.modifiedParaFormats = new Dictionary();\n        }\n        var collection = [];\n        for (var i = 0; i < this.viewer.listParagraphs.length; i++) {\n            var paragraph = this.viewer.listParagraphs[i];\n            var paraFormat = paragraph.paragraphFormat;\n            var currentList = this.viewer.getListById(paraFormat.listFormat.listId);\n            var listLevel = this.viewer.layout.getListLevel(currentList, paraFormat.listFormat.listLevelNumber);\n            // tslint:disable-next-line:max-line-length\n            if (modifiedLevelsInternal.containsKey(paraFormat.listFormat.listLevelNumber)\n                && modifiedLevelsInternal.get(paraFormat.listFormat.listLevelNumber).ownerListLevel === listLevel) {\n                var modifiedFormat = new WParagraphFormat(null);\n                modifiedFormat.leftIndent = paraFormat.leftIndent;\n                modifiedFormat.firstLineIndent = paraFormat.firstLineIndent;\n                var modified = new ModifiedParagraphFormat(paraFormat, modifiedFormat);\n                collection.push(modified);\n                this.owner.editorModule.copyFromListLevelParagraphFormat(paraFormat, listLevel.paragraphFormat);\n            }\n        }\n        this.modifiedParaFormats.add(this.currentBaseHistoryInfo, collection);\n    };\n    /**\n     * Update list changes\n     * @param  {Dictionary<number, ModifiedLevel>} modifiedCollection\n     * @param  {Selection} selection\n     * @private\n     */\n    EditorHistory.prototype.updateListChanges = function (modifiedCollection) {\n        this.viewer.owner.isLayoutEnabled = false;\n        this.owner.editorModule.updateListParagraphs();\n        for (var i = 0; i < modifiedCollection.keys.length; i++) {\n            var levelNumber = modifiedCollection.keys[0];\n            var modifiedLevel = modifiedCollection.get(levelNumber);\n            if (!isNullOrUndefined(this.currentBaseHistoryInfo)) {\n                // tslint:disable-next-line:max-line-length\n                modifiedLevel = this.currentBaseHistoryInfo.addModifiedPropertiesForList(modifiedLevel.ownerListLevel);\n            }\n            this.owner.editorModule.copyListLevel(modifiedLevel.ownerListLevel, modifiedLevel.modifiedListLevel);\n        }\n        this.revertListChanges();\n        this.viewer.owner.isLayoutEnabled = true;\n        this.viewer.renderedLists.clear();\n        this.viewer.pages = [];\n        this.viewer.layout.layout();\n        var selection = this.viewer.selection;\n        selection.start.updatePhysicalPosition(true);\n        if (selection.isEmpty) {\n            selection.end.setPositionInternal(selection.start);\n        }\n        else {\n            selection.end.updatePhysicalPosition(true);\n        }\n        selection.upDownSelectionLength = selection.end.location.x;\n        selection.fireSelectionChanged(false);\n        this.updateHistory();\n    };\n    /**\n     * Revert list changes\n     * @param  {Selection} selection\n     */\n    EditorHistory.prototype.revertListChanges = function () {\n        // tslint:disable-next-line:max-line-length\n        if (!isNullOrUndefined(this.currentBaseHistoryInfo)\n            && this.viewer.owner.editorHistory.modifiedParaFormats.containsKey(this.currentBaseHistoryInfo)) {\n            // tslint:disable-next-line:max-line-length\n            var collection = this.modifiedParaFormats.get(this.currentBaseHistoryInfo);\n            for (var i = 0; i < collection.length; i++) {\n                var modified = new WParagraphFormat(null);\n                modified.leftIndent = collection[i].ownerFormat.leftIndent;\n                modified.firstLineIndent = collection[i].ownerFormat.firstLineIndent;\n                collection[i].ownerFormat.copyFormat(collection[i].modifiedFormat);\n                collection[i].modifiedFormat.leftIndent = modified.leftIndent;\n                collection[i].modifiedFormat.firstLineIndent = modified.firstLineIndent;\n            }\n        }\n    };\n    /**\n     * Reverts the last editing action.\n     */\n    EditorHistory.prototype.undo = function () {\n        if (this.owner.isReadOnlyMode || !this.canUndo() || !this.owner.enableHistoryMode) {\n            return;\n        }\n        //this.owner.ClearTextSearchResults();\n        var historyInfo = this.undoStack.pop();\n        this.isUndoing = true;\n        historyInfo.revert();\n        this.isUndoing = false;\n        this.owner.selection.checkForCursorVisibility();\n        this.owner.editorModule.isBordersAndShadingDialog = false;\n    };\n    /**\n     * Performs the last reverted action.\n     */\n    EditorHistory.prototype.redo = function () {\n        if (this.owner.isReadOnlyMode || !this.canRedo() || !this.owner.enableHistoryMode) {\n            return;\n        }\n        //this.owner.ClearTextSearchResults();\n        var historyInfo = this.redoStack.pop();\n        if (historyInfo.action === 'BordersAndShading') {\n            this.owner.editorModule.isBordersAndShadingDialog = true;\n        }\n        this.isRedoing = true;\n        historyInfo.revert();\n        this.isRedoing = false;\n        this.owner.selection.checkForCursorVisibility();\n        this.owner.editorModule.isBordersAndShadingDialog = false;\n    };\n    /**\n     * @private\n     */\n    EditorHistory.prototype.destroy = function () {\n        this.clearHistory();\n        this.undoStackIn = undefined;\n        this.redoStackIn = undefined;\n    };\n    EditorHistory.prototype.clearHistory = function () {\n        this.clearUndoStack();\n        this.clearRedoStack();\n    };\n    EditorHistory.prototype.clearUndoStack = function () {\n        if (this.canUndo()) {\n            while (this.undoStack.length > 0) {\n                var historyInfo = this.undoStack.pop();\n                historyInfo.destroy();\n                historyInfo = undefined;\n            }\n        }\n    };\n    EditorHistory.prototype.clearRedoStack = function () {\n        if (this.canRedo()) {\n            while (this.redoStack.length > 0) {\n                var historyInfo = this.redoStack.pop();\n                historyInfo.destroy();\n                historyInfo = undefined;\n            }\n        }\n    };\n    return EditorHistory;\n}());\nexport { EditorHistory };\n","import { ZipArchive, ZipArchiveItem } from '@syncfusion/ej2-compression';\nimport { XmlWriter } from '@syncfusion/ej2-file-utils';\nimport { isNullOrUndefined } from '@syncfusion/ej2-base';\nimport { Dictionary } from '../../index';\n/**\n * Exports the document to Word format.\n */\nvar WordExport = /** @class */ (function () {\n    function WordExport() {\n        //Part path\n        this.documentPath = 'word/document.xml';\n        this.stylePath = 'word/styles.xml';\n        this.numberingPath = 'word/numbering.xml';\n        this.settingsPath = 'word/settings.xml';\n        this.headerPath = 'word/header';\n        this.footerPath = 'word/footer';\n        //private commentsPath: string = 'word/comments.xml';\n        this.imagePath = 'word/media/image';\n        // private footnotesPath: string = 'word/footnotes.xml';\n        // private endnotesPath: string = 'word/endnotes.xml';\n        this.appPath = 'docProps/app.xml';\n        this.corePath = 'docProps/core.xml';\n        // private CustomPath: string = 'docProps/custom.xml';\n        // private FontTablePath: string = 'word/fontTable.xml';\n        this.contentTypesPath = '[Content_Types].xml';\n        // private ChartsPath: string = 'word/charts/';\n        // private DefaultEmbeddingPath: string = 'word/embeddings/';\n        // private EmbeddingPath:string = 'word\\embeddings\\';\n        // private DrawingPath:string = 'word\\drawings\\';\n        // private ThemePath: string = 'word/theme/theme1.xml';\n        // private FontsPath:string = 'word\\fonts\\';\n        // private DiagramPath:string = \"word/diagrams/';\n        // private ControlPath:string = \"word/activeX/';\n        // private VbaProject: string = 'vbaProject.bin';\n        // private VbaData: string = 'vbaData.xml';\n        // private VbaProjectPath: string = 'word/vbaProject.bin';\n        // private VbaDataPath: string = 'word/vbaData.xml';\n        // private CustomXMLPath:string = 'customXml\\';\n        //Relationship path\n        this.generalRelationPath = '_rels/.rels';\n        this.wordRelationPath = 'word/_rels/document.xml.rels';\n        // private FontRelationPath: string = 'word/_rels/fontTable.xml.rels';\n        // private CommentsRelationPath: string = 'word/_rels/comments.xml.rels';\n        // private FootnotesRelationPath: string = 'word/_rels/footnotes.xml.rels';\n        // private EndnotesRelationPath: string = 'word/_rels/endnotes.xml.rels';\n        // private NumberingRelationPath: string = 'word/_rels/numbering.xml.rels';\n        this.headerRelationPath = 'word/_rels/header';\n        this.footerRelationPath = 'word/_rels/footer';\n        // private SettingsRelationpath: string = 'word/_rels/settings.xml.rels';\n        // private VbaProjectRelsPath: string = 'word/_rels/vbaProject.bin.rels';\n        //Content type of the parts\n        this.xmlContentType = 'application/xml';\n        this.fontContentType = 'application/vnd.openxmlformats-officedocument.obfuscatedFont';\n        this.documentContentType = 'application/vnd.openxmlformats-officedocument.wordprocessingml.document.main+xml';\n        // private TemplateContentType: string = 'application/vnd.openxmlformats-officedocument.wordprocessingml.template.main+xml';\n        // private CommentsContentType: string = 'application/vnd.openxmlformats-officedocument.wordprocessingml.comments+xml';\n        this.settingsContentType = 'application/vnd.openxmlformats-officedocument.wordprocessingml.settings+xml';\n        // private EndnoteContentType: string = 'application/vnd.openxmlformats-officedocument.wordprocessingml.endnotes+xml';\n        // private FontTableContentType: string = 'application/vnd.openxmlformats-officedocument.wordprocessingml.fontTable+xml';\n        this.footerContentType = 'application/vnd.openxmlformats-officedocument.wordprocessingml.footer+xml';\n        // private FootnoteContentType: string = 'application/vnd.openxmlformats-officedocument.wordprocessingml.footnotes+xml';\n        // private GlossaryDocumentContentType: string = 'application/vnd.openxmlformats-officedocument.wordprocessingml.document.glossary+xml';\n        this.headerContentType = 'application/vnd.openxmlformats-officedocument.wordprocessingml.header+xml';\n        this.numberingContentType = 'application/vnd.openxmlformats-officedocument.wordprocessingml.numbering+xml';\n        this.stylesContentType = 'application/vnd.openxmlformats-officedocument.wordprocessingml.styles+xml';\n        this.webSettingsContentType = 'application/vnd.openxmlformats-officedocument.wordprocessingml.webSettings+xml';\n        this.appContentType = 'application/vnd.openxmlformats-officedocument.extended-properties+xml';\n        this.coreContentType = 'application/vnd.openxmlformats-package.core-properties+xml';\n        this.customContentType = 'application/vnd.openxmlformats-officedocument.custom-properties+xml';\n        this.customXmlContentType = 'application/vnd.openxmlformats-officedocument.customXmlProperties+xml';\n        this.relationContentType = 'application/vnd.openxmlformats-package.relationships+xml';\n        // private DiagramColor: string = 'application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml';\n        // private DiagramData: string = 'application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml';\n        // private DiagramLayout: string = 'application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml';\n        // private DiagramStyle: string = 'application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml';\n        // private ChartsContentType: string = 'application/vnd.openxmlformats-officedocument.drawingml.chart+xml';\n        // private ThemeContentType: string = 'application/vnd.openxmlformats-officedocument.theme+xml';\n        // private ChartDrawingContentType: string = 'application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml';\n        // private ActiveXContentType: string = 'application/vnd.ms-office.activeX+xml';\n        // private ActiveXBinContentType: string = 'application/vnd.ms-office.activeX';\n        this.tableStyleContentType = 'application/vnd.openxmlformats-officedocument.presentationml.tableStyles+xml';\n        // private ChartStyleContentType: string = 'application/vnd.ms-office.chartstyle+xml';\n        // private ChartColorStyleContentType: string = 'application/vnd.ms-office.chartcolorstyle+xml';\n        // private VbaProjectContentType: string = 'application/vnd.ms-office.vbaProject';\n        // private VbaDataContentType: string = 'application/vnd.ms-word.vbaData+xml';\n        // private MacroDocumentContentType: string = 'application/vnd.ms-word.document.macroEnabled.main+xml';\n        // private MacroTemplateContentType: string = 'application/vnd.ms-word.template.macroEnabledTemplate.main+xml';\n        // private OleObjectContentType: string = 'application/vnd.openxmlformats-officedocument.oleObject';\n        // Relationship types of document parts\n        // private AltChunkRelType: string = 'http://schemas.openxmlformats.org/officeDocument/2006/relationships/aFChunk';\n        // private CommentsRelType: string = 'http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments';\n        this.settingsRelType = 'http://schemas.openxmlformats.org/officeDocument/2006/relationships/settings';\n        // private EndnoteRelType: string = 'http://schemas.openxmlformats.org/officeDocument/2006/relationships/endnotes';\n        // private FontTableRelType: string = 'http://schemas.openxmlformats.org/officeDocument/2006/relationships/fontTable';\n        this.footerRelType = 'http://schemas.openxmlformats.org/officeDocument/2006/relationships/footer';\n        // private FootnoteRelType: string = 'http://schemas.openxmlformats.org/officeDocument/2006/relationships/footnotes';\n        this.headerRelType = 'http://schemas.openxmlformats.org/officeDocument/2006/relationships/header';\n        this.documentRelType = 'http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument';\n        this.numberingRelType = 'http://schemas.openxmlformats.org/officeDocument/2006/relationships/numbering';\n        this.stylesRelType = 'http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles';\n        // private OleObjectRelType: string = 'http://schemas.openxmlformats.org/officeDocument/2006/relationships/oleObject';\n        // private ChartRelType: string = 'http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart';\n        // private ThemeRelType: string = 'http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme';\n        this.fontRelType = 'http://schemas.openxmlformats.org/officeDocument/2006/relationships/font';\n        this.tableStyleRelType = 'http://schemas.openxmlformats.org/officeDocument/2006/relationships/tableStyles';\n        this.coreRelType = 'http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties';\n        this.appRelType = 'http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties';\n        this.customRelType = 'http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties';\n        this.imageRelType = 'http://schemas.openxmlformats.org/officeDocument/2006/relationships/image';\n        this.hyperlinkRelType = 'http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink';\n        this.controlRelType = 'http://schemas.openxmlformats.org/officeDocument/2006/relationships/control';\n        this.packageRelType = 'http://schemas.openxmlformats.org/officeDocument/2006/relationships/package';\n        // private VbaProjectRelType: string = 'http://schemas.microsoft.com/office/2006/relationships/vbaProject';\n        // private VbaDataRelType: string = 'http://schemas.microsoft.com/office/2006/relationships/wordVbaData';\n        this.customXmlRelType = 'http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml';\n        this.customUIRelType = 'http://schemas.microsoft.com/office/2006/relationships/ui/extensibility';\n        this.attachedTemplateRelType = 'http://schemas.openxmlformats.org/officeDocument/2006/relationships/attachedTemplate';\n        // private ChartColorStyleRelType: string = 'http://schemas.microsoft.com/office/2011/relationships/chartColorStyle';\n        // private ChartStyleRelType: string = 'http://schemas.microsoft.com/office/2011/relationships/chartStyle';\n        // private ChartUserShapesRelType: string = 'http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartUserShapes';\n        // private ChartContentType: string = 'http://schemas.openxmlformats.org/officeDocument/2006/relationships/package';\n        // Namespaces\n        // private PKG_namespace: string = 'http://schemas.microsoft.com/office/2006/xmlPackage';\n        this.wNamespace = 'http://schemas.openxmlformats.org/wordprocessingml/2006/main';\n        this.wpNamespace = 'http://schemas.openxmlformats.org/drawingml/2006/wordprocessingDrawing';\n        this.pictureNamespace = 'http://schemas.openxmlformats.org/drawingml/2006/picture';\n        this.aNamespace = 'http://schemas.openxmlformats.org/drawingml/2006/main';\n        this.a14Namespace = 'http://schemas.microsoft.com/office/drawing/2010/main';\n        // private SVG_namespace: string = 'http://schemas.microsoft.com/office/drawing/2016/SVG/main';\n        this.rNamespace = 'http://schemas.openxmlformats.org/officeDocument/2006/relationships';\n        this.rpNamespace = 'http://schemas.openxmlformats.org/package/2006/relationships';\n        this.vNamespace = 'urn:schemas-microsoft-com:vml';\n        this.oNamespace = 'urn:schemas-microsoft-com:office:office';\n        this.xmlNamespace = 'http://www.w3.org/XML/1998/namespace';\n        this.w10Namespace = 'urn:schemas-microsoft-com:office:word';\n        this.cpNamespace = 'http://schemas.openxmlformats.org/package/2006/metadata/core-properties';\n        this.dcNamespace = 'http://purl.org/dc/elements/1.1/';\n        // private DCTERMS_namespace: string = 'http://purl.org/dc/terms/';\n        // private XSI_namespace: string = 'http://www.w3.org/2001/XMLSchema-instance';\n        this.docPropsNamespace = 'http://schemas.openxmlformats.org/officeDocument/2006/extended-properties';\n        this.veNamespace = 'http://schemas.openxmlformats.org/markup-compatibility/2006';\n        this.mNamespace = 'http://schemas.openxmlformats.org/officeDocument/2006/math';\n        this.wneNamespace = 'http://schemas.microsoft.com/office/word/2006/wordml';\n        // private DCMI_namespace: string = 'http://purl.org/dc/dcmitype/';\n        this.customPropsNamespace = 'http://schemas.openxmlformats.org/officeDocument/2006/custom-properties';\n        this.vtNamespace = 'http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes';\n        this.chartNamespace = 'http://schemas.openxmlformats.org/drawingml/2006/chart';\n        this.slNamespace = 'http://schemas.openxmlformats.org/schemaLibrary/2006/main';\n        //2003WML namespace\n        // private amlNamespace: string = 'http://schemas.microsoft.com/aml/2001/core';\n        this.dtNamespace = 'uuid:C2F41010-65B3-11d1-A29F-00AA00C14882';\n        this.wmlNamespace = 'http://schemas.microsoft.com/office/word/2003/wordml';\n        //2010 namespaces\n        this.w14Namespace = 'http://schemas.microsoft.com/office/word/2010/wordml';\n        this.wpCanvasNamespace = 'http://schemas.microsoft.com/office/word/2010/wordprocessingCanvas';\n        this.wpDrawingNamespace = 'http://schemas.microsoft.com/office/word/2010/wordprocessingDrawing';\n        this.wpGroupNamespace = 'http://schemas.microsoft.com/office/word/2010/wordprocessingGroup';\n        this.wpInkNamespace = 'http://schemas.microsoft.com/office/word/2010/wordprocessingInk';\n        this.wpShapeNamespace = 'http://schemas.microsoft.com/office/word/2010/wordprocessingShape';\n        //2013 namespaces\n        this.w15Namespace = 'http://schemas.microsoft.com/office/word/2012/wordml';\n        this.diagramNamespace = 'http://schemas.openxmlformats.org/drawingml/2006/diagram';\n        //Encryption namespaces\n        this.eNamespace = 'http://schemas.microsoft.com/office/2006/encryption';\n        this.pNamespace = 'http://schemas.microsoft.com/office/2006/keyEncryptor/password';\n        this.certNamespace = 'http://schemas.microsoft.com/office/2006/keyEncryptor/certificate';\n        // Dls xml tags\n        this.cRelationshipsTag = 'Relationships';\n        this.cRelationshipTag = 'Relationship';\n        this.cIdTag = 'Id';\n        this.cTypeTag = 'Type';\n        this.cTargetTag = 'Target';\n        this.cUserShapesTag = 'userShapes';\n        this.cExternalData = 'externalData';\n        this.twipsInOnePoint = 20;\n        this.twentiethOfPoint = 20;\n        this.borderMultiplier = 8;\n        this.percentageFactor = 50;\n        this.emusPerPoint = 12700;\n        // private const TOC_SYMBOL:string = (char)0x01;\n        // private const FOOTNOTE_SYMBOL:string = (char)0x02;\n        // private const PAGENUMBER_SYMBOL:string = (char)0xB;\n        // private DEF_FIT_TEXT_TO_SHAPE: string = 'mso-fit-shape-to-text:t';\n        // Document tags\n        this.cConditionalTableStyleTag = 'tblStylePr';\n        this.cTableFormatTag = 'tblPr';\n        this.cTowFormatTag = 'trPr';\n        this.cCellFormatTag = 'tcPr';\n        this.cParagraphFormatTag = 'pPr';\n        this.cCharacterFormatTag = 'rPr';\n        this.packageType = 'http://schemas.microsoft.com/office/2006/xmlPackage';\n        this.relsPartPath = '/_rels/.rels';\n        this.documentRelsPartPath = '/word/_rels/document.xml.rels';\n        this.webSettingsPath = '/word/webSettings.xml';\n        this.wordMLDocumentPath = '/word/document.xml';\n        this.wordMLStylePath = '/word/styles.xml';\n        this.wordMLNumberingPath = '/word/numbering.xml';\n        this.wordMLSettingsPath = '/word/settings.xml';\n        this.wordMLHeaderPath = '/word/header';\n        this.wordMLFooterPath = '/word/footer';\n        this.wordMLCommentsPath = '/word/comments.xml';\n        this.wordMLImagePath = '/word/media/image';\n        this.wordMLFootnotesPath = '/word/footnotes.xml';\n        this.wordMLEndnotesPath = '/word/endnotes.xml';\n        this.wordMLAppPath = '/docProps/app.xml';\n        this.wordMLCorePath = '/docProps/core.xml';\n        this.wordMLCustomPath = '/docProps/custom.xml';\n        this.wordMLFontTablePath = '/word/fontTable.xml';\n        this.wordMLChartsPath = '/word/charts/';\n        this.wordMLDefaultEmbeddingPath = '/word/embeddings/';\n        this.wordMLEmbeddingPath = '/word/embeddings/';\n        this.wordMLDrawingPath = '/word/drawings/';\n        this.wordMLThemePath = '/word/theme/theme1.xml';\n        this.wordMLFontsPath = '/word/fonts/';\n        this.wordMLDiagramPath = '/word/diagrams/';\n        this.wordMLControlPath = '/word/activeX/';\n        this.wordMLVbaProject = '/vbaProject.bin';\n        this.wordMLVbaData = '/vbaData.xml';\n        this.wordMLVbaProjectPath = '/word/vbaProject.bin';\n        this.wordMLVbaDataPath = '/word/vbaData.xml';\n        // private WordMLCustomXMLPath: string = '/customXml/';\n        this.wordMLWebSettingsPath = '/word/webSettings.xml';\n        this.wordMLCustomItemProp1Path = '/customXml/itemProps1.xml';\n        // private WordMLCustomXMLRelPath: string = '/customXml/_rels/item1.xml.rels';\n        this.wordMLFootnoteRelPath = '/word/_rels/footnotes.xml.rels';\n        this.wordMLEndnoteRelPath = '/word/_rels/endnotes.xml.rels';\n        this.wordMLSettingsRelPath = '/word/_rels/settings.xml.rels';\n        this.wordMLNumberingRelPath = '/word/_rels/numbering.xml.rels';\n        this.wordMLFontTableRelPath = '/word/_rels/fontTable.xml.rels';\n        this.wordMLCustomXmlPropsRelType = 'http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps';\n        this.wordMLControlRelType = 'http://schemas.microsoft.com/office/2006/relationships/activeXControlBinary';\n        this.wordMLDiagramContentType = 'application/vnd.ms-office.drawingml.diagramDrawing+xml';\n        this.lastSection = false;\n        this.mRelationShipID = 0;\n        this.mDocPrID = 0;\n        this.mDifferentFirstPage = false;\n        this.mBookmarks = undefined;\n        /* tslint:enable:no-any */\n    }\n    WordExport.prototype.getModuleName = function () {\n        return 'WordExport';\n    };\n    Object.defineProperty(WordExport.prototype, \"bookmarks\", {\n        // Gets the bookmark name\n        get: function () {\n            if (isNullOrUndefined(this.mBookmarks)) {\n                this.mBookmarks = [];\n            }\n            return this.mBookmarks;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(WordExport.prototype, \"documentImages\", {\n        // Gets the collection of images present in the document body\n        get: function () {\n            if (this.mDocumentImages === undefined) {\n                this.mDocumentImages = new Dictionary();\n            }\n            return this.mDocumentImages;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(WordExport.prototype, \"externalImages\", {\n        // Gets the collection of images present in the document body\n        get: function () {\n            if (this.mExternalLinkImages === undefined) {\n                this.mExternalLinkImages = new Dictionary();\n            }\n            return this.mExternalLinkImages;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(WordExport.prototype, \"headerFooterImages\", {\n        // Gets the collections of images present in the HeaderFooters\n        get: function () {\n            if (this.mHeaderFooterImages === undefined) {\n                this.mHeaderFooterImages = new Dictionary();\n            }\n            return this.mHeaderFooterImages;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(WordExport.prototype, \"headersFooters\", {\n        /// Gets the HeaderFooter Collection\n        get: function () {\n            if (this.mHeaderFooterColl === undefined) {\n                this.mHeaderFooterColl = new Dictionary();\n            }\n            return this.mHeaderFooterColl;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    /**\n     * @private\n     */\n    WordExport.prototype.save = function (viewer, fileName) {\n        this.serialize(viewer);\n        this.mArchive.save(fileName + '.docx').then(function (mArchive) {\n            mArchive.destroy();\n        });\n        this.close();\n    };\n    /**\n     * @private\n     */\n    WordExport.prototype.saveAsBlob = function (viewer) {\n        var _this = this;\n        this.serialize(viewer);\n        return new Promise(function (resolve, reject) {\n            _this.mArchive.saveAsBlob().then(function (blob) {\n                _this.mArchive.destroy();\n                blob = new Blob([blob], { type: 'application/vnd.openxmlformats-officedocument.wordprocessingml.document' });\n                resolve(blob);\n            });\n        });\n    };\n    /**\n     * @private\n     */\n    WordExport.prototype.destroy = function () {\n        this.clearDocument();\n        this.mRelationShipID = undefined;\n        this.mDocPrID = undefined;\n        this.mDifferentFirstPage = undefined;\n        if (this.mArchive) {\n            this.mArchive.destroy();\n            this.mArchive = undefined;\n        }\n    };\n    // Saves the word document in the stream\n    WordExport.prototype.serialize = function (viewer) {\n        /* tslint:disable:no-any */\n        var document = viewer.owner.sfdtExportModule.write();\n        this.setDocument(document);\n        this.mArchive = new ZipArchive();\n        this.mArchive.compressionLevel = 'Normal';\n        this.mVerticalMerge = new Dictionary();\n        this.mGridSpans = new Dictionary();\n        var contenttype;\n        //document.xml\n        this.serializeDocument();\n        //Styles.xml\n        this.serializeStyles();\n        //numbering.xml\n        this.serializeNumberings();\n        //theme.xml\n        // if (m_document.DocHasThemes && !isNullOrUndefined(m_document.Themes))\n        //     SerializeThemes();\n        // else\n        // this.serializeDefaultThemes();\n        //settings.xml\n        this.serializeSettings();\n        //core.xml\n        this.serializeCoreProperties();\n        //app.xml\n        this.serializeAppProperties();\n        //fontTable.xml\n        this.serializeFontTable(contenttype);\n        //custom.xml\n        // if (!isNullOrUndefined(this.wordDocument.CustomDocumentProperties) && m_document.CustomDocumentProperties.length > 0) {\n        //     SerializeCustomProperties();\n        // }\n        //Settings Relations\n        this.serializeSettingsRelation();\n        //Numbering relation if the document has picture bullet\n        // if (PictureBullets.length > 0) {\n        //     SerializeNumberingsRelation();\n        // }\n        this.serializeHeaderFooters();\n        //document relations\n        this.serializeDocumentRelations();\n        // // Add controls to archieve.\n        // if (ControlsPathNames.length > 0) {\n        //     AddControlsToZip(m_document.DocxPackage);\n        // }\n        // if (!isNullOrUndefined(m_document.CustomUIPartContainer))\n        //     AddPartContainerToArchive(m_document.CustomUIPartContainer);\n        // if (!isNullOrUndefined(m_document.CustomXMLContainer))\n        //     AddPartContainerToArchive(m_document.CustomXMLContainer);\n        //general relations\n        this.serializeGeneralRelations();\n        //[ContentTypes].xml\n        this.serializeContentTypes(contenttype);\n        // Clears the internal fields maintained for serializing.\n        this.clearDocument();\n    };\n    // Sets the document\n    WordExport.prototype.setDocument = function (document) {\n        this.document = document;\n        this.mSections = document.sections;\n        this.mLists = document.lists;\n        this.mAbstractLists = document.abstractLists;\n        this.defCharacterFormat = document.characterFormat;\n        this.defParagraphFormat = document.paragraphFormat;\n        this.defaultTabWidthValue = document.defaultTabWidth;\n        this.mStyles = document.styles;\n    };\n    // Clears the document\n    WordExport.prototype.clearDocument = function () {\n        // Owner Nodes\n        this.section = undefined;\n        this.lastSection = undefined;\n        this.blockOwner = undefined;\n        this.paragraph = undefined;\n        this.table = undefined;\n        this.row = undefined;\n        this.headerFooter = undefined;\n        this.document = undefined;\n        this.mSections = undefined;\n        this.mLists = undefined;\n        this.mAbstractLists = undefined;\n        this.defCharacterFormat = undefined;\n        this.defParagraphFormat = undefined;\n        this.defaultTabWidthValue = undefined;\n        this.mRelationShipID = 0;\n        this.mDocPrID = 0;\n        this.mDifferentFirstPage = false;\n        if (this.mHeaderFooterColl) {\n            this.mHeaderFooterColl.destroy();\n            this.mHeaderFooterColl = undefined;\n        }\n        if (this.mVerticalMerge) {\n            this.mVerticalMerge.destroy();\n            this.mVerticalMerge = undefined;\n        }\n        if (this.mGridSpans) {\n            this.mGridSpans.destroy();\n            this.mGridSpans = undefined;\n        }\n        if (this.mDocumentImages) {\n            this.mDocumentImages.destroy();\n            this.mDocumentImages = undefined;\n        }\n        if (this.mExternalLinkImages) {\n            this.mExternalLinkImages.destroy();\n            this.mExternalLinkImages = undefined;\n        }\n        if (this.mHeaderFooterImages) {\n            this.mHeaderFooterImages.destroy();\n            this.mHeaderFooterImages = undefined;\n        }\n    };\n    // Serializes the document elements (document.xml)\n    WordExport.prototype.serializeDocument = function () {\n        var writer = new XmlWriter();\n        writer.writeStartElement('w', 'document', this.wNamespace);\n        this.writeCommonAttributeStrings(writer);\n        this.serializeDocumentBody(writer);\n        writer.writeEndElement(); //end of document tag\n        var archiveItem = new ZipArchiveItem(writer.buffer, this.documentPath);\n        this.mArchive.addItem(archiveItem);\n    };\n    WordExport.prototype.writeCommonAttributeStrings = function (writer) {\n        writer.writeAttributeString('xmlns', 'wpc', undefined, this.wpCanvasNamespace);\n        this.writeCustom(writer);\n        writer.writeAttributeString('xmlns', 'wp14', undefined, this.wpDrawingNamespace);\n        writer.writeAttributeString('xmlns', 'wp', undefined, this.wpNamespace);\n        writer.writeAttributeString('xmlns', 'w10', undefined, this.w10Namespace);\n        writer.writeAttributeString('xmlns', 'w', undefined, this.wNamespace);\n        this.writeDup(writer);\n        writer.writeAttributeString('xmlns', 'wne', undefined, this.wneNamespace);\n        writer.writeAttributeString('xmlns', 'wps', undefined, this.wpShapeNamespace);\n        writer.writeAttributeString('mc', 'Ignorable', undefined, 'w14 w15 wp14');\n    };\n    WordExport.prototype.writeDup = function (writer) {\n        writer.writeAttributeString('xmlns', 'w14', undefined, this.w14Namespace);\n        writer.writeAttributeString('xmlns', 'w15', undefined, this.w15Namespace);\n        writer.writeAttributeString('xmlns', 'wpg', undefined, this.wpGroupNamespace);\n        writer.writeAttributeString('xmlns', 'wpi', undefined, this.wpInkNamespace);\n    };\n    WordExport.prototype.writeCustom = function (writer) {\n        writer.writeAttributeString('xmlns', 'mc', undefined, this.veNamespace);\n        writer.writeAttributeString('xmlns', 'o', undefined, this.oNamespace);\n        writer.writeAttributeString('xmlns', 'r', undefined, this.rNamespace);\n        writer.writeAttributeString('xmlns', 'm', undefined, this.mNamespace);\n        writer.writeAttributeString('xmlns', 'v', undefined, this.vNamespace);\n    };\n    // Serializes the document body\n    WordExport.prototype.serializeDocumentBody = function (writer) {\n        writer.writeStartElement(undefined, 'body', this.wNamespace);\n        var count = this.document.sections.length;\n        for (var i = 0; i < count; i++) {\n            this.section = this.document.sections[i];\n            this.lastSection = i === count - 1;\n            this.serializeSection(writer, this.section, i === count - 1);\n            this.section = undefined;\n        }\n        writer.writeEndElement();\n    };\n    // Serializes the Section.\n    WordExport.prototype.serializeSection = function (writer, section, last) {\n        this.blockOwner = section;\n        this.serializeBodyItems(writer, section.blocks, last);\n        if (last) {\n            this.serializeSectionProperties(writer, section);\n        }\n        this.blockOwner = undefined;\n    };\n    // Serialize the section properties.\n    WordExport.prototype.serializeSectionProperties = function (writer, section) {\n        writer.writeStartElement('w', 'sectPr', this.wNamespace);\n        if (section.headersFooters) {\n            this.serializeHFReference(writer, section.headersFooters);\n        }\n        // if (IsNeedToSerializeSectionFootNoteProperties(section))\n        //     SerializeFootnoteProperties(section);\n        // if (IsNeedToSerializeSectionEndNoteProperties(section))\n        //     SerializeEndnoteProperties(section);\n        this.serializeSectionType(writer, 'nextPage');\n        this.serializePageSetup(writer, section.sectionFormat);\n        this.serializeColumns(writer, section);\n        // this.serializeSectionProtection(section);\n        // if (section.PageSetup.VerticalAlignment !== PageAlignment.Top) {\n        //     writer.writeStartElement('vAlign', this.wNamespace);\n        //     switch (section.PageSetup.VerticalAlignment) {\n        //         case PageAlignment.Top:\n        //             writer.WriteAttributeString('val', this.wNamespace, 'top');\n        //             break;\n        //         case PageAlignment.Middle:\n        //             writer.WriteAttributeString('val', this.wNamespace, 'center');\n        //             break;\n        //         case PageAlignment.Justified:\n        //             writer.WriteAttributeString('val', this.wNamespace, 'both');\n        //             break;\n        //         case PageAlignment.Bottom:\n        //             writer.WriteAttributeString('val', this.wNamespace, 'bottom');\n        //             break;\n        //     }\n        //     writer.WriteEndElement();\n        // }\n        if (section.sectionFormat !== undefined && section.sectionFormat.differentFirstPage) {\n            writer.writeStartElement(undefined, 'titlePg', this.wNamespace);\n            writer.writeEndElement();\n        }\n        // SerializeTextDirection(section);\n        // if (section.PageSetup.Bidi) {\n        //     writer.WriteStartElement('bidi', this.wNamespace);\n        //     writer.WriteEndElement();\n        // }\n        //rtlGutter\n        // SerializeDocGrid(section);\n        //printerSettings\n        writer.writeEndElement(); //end of sectPr tag\n    };\n    // Serialize the column properties of section.\n    WordExport.prototype.serializeColumns = function (writer, section) {\n        writer.writeStartElement(undefined, 'cols', this.wNamespace);\n        writer.writeAttributeString(undefined, 'equalWidth', this.wNamespace, '1');\n        writer.writeAttributeString(undefined, 'space', this.wNamespace, '0');\n        writer.writeEndElement();\n        // ColumnCollection columns = section.Columns;\n        // writer.WriteStartElement('cols', this.wNamespace);\n        // if (columns.length > 0)\n        // {\n        //     writer.WriteAttributeString('num', this.wNamespace, columns.length.ToString());\n        // }\n        // if (section.PageSetup.DrawLinesBetweenCols)\n        //     writer.WriteAttributeString('sep', this.wNamespace, '1');\n        // if (columns.OwnerSection.PageSetup.EqualColumnWidth)\n        // {\n        //     writer.WriteAttributeString('equalWidth', this.wNamespace, '1');\n        //     //When the column count is negative, MS word just reset the column's count to zero\n        //     //To avoid index out of exception, checked the columns count\n        // tslint:disable-next-line:max-line-length\n        //     writer.WriteAttributeString('space', this.wNamespace, ToString(columns.length > 0 ? columns[0].Space * this.TwentiethOfPoint : 0));\n        // }\n        // else if (columns.length > 0)\n        // {\n        //     writer.WriteAttributeString('equalWidth', this.wNamespace, '0');\n        //     foreach (Column column in columns)\n        //     {\n        //         writer.WriteStartElement('col', this.wNamespace);\n        //         writer.WriteAttributeString('w', this.wNamespace, ToString(column.Width * this.TwentiethOfPoint));\n        // tslint:disable-next-line:max-line-length\n        //         writer.WriteAttributeString('space', this.wNamespace, ToString(column.Space * this.TwentiethOfPoint));\n        //         writer.WriteEndElement();\n        //     }\n        // }\n        // writer.WriteEndElement();\n    };\n    // Serialize the page setup properties.\n    WordExport.prototype.serializePageSetup = function (writer, pageSetup) {\n        if (pageSetup !== undefined) {\n            this.serializePageSize(writer, pageSetup);\n            this.serializePageMargins(writer, pageSetup);\n        }\n        // // StartElement paperSrc (if any)\n        // if (pageSetup.FirstPageTray > 0 || pageSetup.OtherPagesTray > 0) {\n        //     writer.WriteStartElement('paperSrc', this.wNamespace);\n        //     if (pageSetup.FirstPageTray > 0) {\n        //         writer.WriteAttributeString('first', this.wNamespace, pageSetup.FirstPageTray.ToString());\n        //     }\n        //     if (pageSetup.OtherPagesTray > 0) {\n        //         writer.WriteAttributeString('other', this.wNamespace, pageSetup.OtherPagesTray.ToString());\n        //     }\n        //     writer.WriteEndElement();\n        // }\n        writer.writeStartElement(undefined, 'pgBorders', this.wNamespace);\n        // //zOrder\n        // if (pageSetup.PageBordersApplyType === PageBordersApplyType.FirstPage)\n        //     writer.WriteAttributeString('display', this.wNamespace, 'firstPage');\n        // else if (pageSetup.PageBordersApplyType === PageBordersApplyType.AllExceptFirstPage)\n        //     writer.WriteAttributeString('display', this.wNamespace, 'notFirstPage');\n        // if (pageSetup.PageBorderOffsetFrom === PageBorderOffsetFrom.PageEdge) {\n        //     writer.WriteAttributeString('offsetFrom', this.wNamespace, 'page');\n        // }\n        // //Serializing zOrder of the front page border\n        // if (!pageSetup.IsFrontPageBorder) {\n        //     writer.WriteAttributeString('zOrder', this.wNamespace, 'back');\n        // }\n        // SerializePageBorders(pageSetup.Borders);\n        writer.writeEndElement();\n        // this.serializeLineNumberType(writer, pageSetup);\n        //this.serializePageNumberType(writer, pageSetup);\n    };\n    // serialize the page size\n    WordExport.prototype.serializePageSize = function (writer, pageSetup) {\n        writer.writeStartElement(undefined, 'pgSz', this.wNamespace);\n        // tslint:disable-next-line:max-line-length\n        writer.writeAttributeString(undefined, 'w', this.wNamespace, this.roundToTwoDecimal(pageSetup.pageWidth * this.twentiethOfPoint).toString());\n        // tslint:disable-next-line:max-line-length\n        writer.writeAttributeString(undefined, 'h', this.wNamespace, this.roundToTwoDecimal(pageSetup.pageHeight * this.twentiethOfPoint).toString());\n        // if (pageSetup.Orientation === PageOrientation.Landscape)\n        // {\n        //     writer.WriteAttributeString('orient', this.wNamespace, 'landscape');\n        // }\n        writer.writeEndElement();\n    };\n    // Serialize the border.\n    WordExport.prototype.serializePageMargins = function (writer, pageSetup) {\n        writer.writeStartElement(undefined, 'pgMar', this.wNamespace);\n        var marginValue = Math.round(pageSetup.topMargin * this.twentiethOfPoint);\n        writer.writeAttributeString(undefined, 'top', this.wNamespace, marginValue.toString());\n        marginValue = Math.round(pageSetup.rightMargin * this.twentiethOfPoint);\n        writer.writeAttributeString(undefined, 'right', this.wNamespace, marginValue.toString());\n        marginValue = Math.round(pageSetup.bottomMargin * this.twentiethOfPoint);\n        writer.writeAttributeString(undefined, 'bottom', this.wNamespace, marginValue.toString());\n        marginValue = Math.round(pageSetup.leftMargin * this.twentiethOfPoint);\n        writer.writeAttributeString(undefined, 'left', this.wNamespace, marginValue.toString());\n        // tslint:disable-next-line:max-line-length\n        writer.writeAttributeString(undefined, 'header', this.wNamespace, this.roundToTwoDecimal(pageSetup.headerDistance * this.twentiethOfPoint).toString());\n        // tslint:disable-next-line:max-line-length\n        writer.writeAttributeString(undefined, 'footer', this.wNamespace, this.roundToTwoDecimal(pageSetup.footerDistance * this.twentiethOfPoint).toString());\n        writer.writeAttributeString(undefined, 'gutter', this.wNamespace, '0');\n        writer.writeEndElement();\n    };\n    // Serialize the section type.\n    WordExport.prototype.serializeSectionType = function (writer, sectionBreakCode) {\n        writer.writeStartElement('w', 'type', this.wNamespace);\n        writer.writeAttributeString('w', 'val', this.wNamespace, sectionBreakCode); //GetSectionBreakCode(sectionBreakCode));\n        writer.writeEndElement();\n    };\n    // Serialize the heeader/footer reference.\n    WordExport.prototype.serializeHFReference = function (writer, headersFooters) {\n        var hfId = '';\n        if (headersFooters !== undefined) {\n            this.mDifferentFirstPage = this.section.sectionFormat.differentOddAndEvenPages;\n            var hf = headersFooters.firstPageHeader;\n            if (hf && hf.blocks && hf.blocks.length > 0) {\n                writer.writeStartElement(undefined, 'headerReference', this.wNamespace);\n                writer.writeAttributeString(undefined, 'type', this.wNamespace, 'first');\n                hfId = this.getNextRelationShipID();\n                writer.writeAttributeString(undefined, 'id', this.rNamespace, hfId);\n                this.addHeaderFooter(hf, 'FirstPageHeader', hfId);\n                writer.writeEndElement();\n            }\n            hf = headersFooters.firstPageFooter;\n            if (hf && hf.blocks && hf.blocks.length > 0) {\n                writer.writeStartElement(undefined, 'footerReference', this.wNamespace);\n                writer.writeAttributeString(undefined, 'type', this.wNamespace, 'first');\n                hfId = this.getNextRelationShipID();\n                writer.writeAttributeString(undefined, 'id', this.rNamespace, hfId);\n                this.addHeaderFooter(hf, 'FirstPageFooter', hfId);\n                writer.writeEndElement();\n            }\n            hf = headersFooters.evenHeader;\n            if (hf && hf.blocks && hf.blocks.length > 0) {\n                writer.writeStartElement(undefined, 'headerReference', this.wNamespace);\n                writer.writeAttributeString(undefined, 'type', this.wNamespace, 'even');\n                hfId = this.getNextRelationShipID();\n                writer.writeAttributeString(undefined, 'id', this.rNamespace, hfId);\n                this.addHeaderFooter(hf, 'EvenHeader', hfId);\n                writer.writeEndElement();\n            }\n            hf = headersFooters.evenFooter;\n            if (hf && hf.blocks && hf.blocks.length > 0) {\n                writer.writeStartElement(undefined, 'footerReference', this.wNamespace);\n                writer.writeAttributeString(undefined, 'type', this.wNamespace, 'even');\n                hfId = this.getNextRelationShipID();\n                writer.writeAttributeString(undefined, 'id', this.rNamespace, hfId);\n                this.addHeaderFooter(hf, 'EvenFooter', hfId);\n                writer.writeEndElement();\n            }\n            hf = headersFooters.header;\n            if (hf && hf.blocks && hf.blocks.length > 0) {\n                writer.writeStartElement(undefined, 'headerReference', this.wNamespace);\n                writer.writeAttributeString(undefined, 'type', this.wNamespace, 'default');\n                hfId = this.getNextRelationShipID();\n                writer.writeAttributeString(undefined, 'id', this.rNamespace, hfId);\n                this.addHeaderFooter(hf, 'OddHeader', hfId);\n                writer.writeEndElement();\n            }\n            hf = headersFooters.footer;\n            if (hf && hf.blocks && hf.blocks.length > 0) {\n                writer.writeStartElement(undefined, 'footerReference', this.wNamespace);\n                writer.writeAttributeString(undefined, 'type', this.wNamespace, 'default');\n                hfId = this.getNextRelationShipID();\n                writer.writeAttributeString(undefined, 'id', this.rNamespace, hfId);\n                this.addHeaderFooter(hf, 'OddFooter', hfId);\n                writer.writeEndElement();\n            }\n        }\n    };\n    // Adds the header footer details to the collection.\n    WordExport.prototype.addHeaderFooter = function (hf, hfType, id) {\n        var hfColl = new Dictionary();\n        this.headersFooters.add(hfType, hfColl);\n        this.headersFooters.get(hfType).add(id, hf);\n    };\n    // Serializes the bodyItems\n    WordExport.prototype.serializeBodyItems = function (writer, blockCollection, isLastSection) {\n        for (var i = 0; i < blockCollection.length; i++) {\n            this.serializeBodyItem(writer, blockCollection[i], isLastSection);\n        }\n    };\n    // Serialize the TextBody item\n    WordExport.prototype.serializeBodyItem = function (writer, item, isLastSection) {\n        if (isNullOrUndefined(item)) {\n            throw new Error('BodyItem should not be undefined');\n        }\n        if (item.hasOwnProperty('inlines')) {\n            this.paragraph = item;\n            this.serializeParagraph(writer, item, isLastSection);\n            this.paragraph = undefined;\n        }\n        else {\n            var table = item;\n            for (var i = 0; i < table.rows.length; i++) {\n                if (table.rows[i].cells.length > 0) {\n                    this.serializeTable(writer, table);\n                    break;\n                }\n            }\n        }\n    };\n    // Serialize the paragraph\n    WordExport.prototype.serializeParagraph = function (writer, paragraph, isLastSection) {\n        if (isNullOrUndefined(paragraph)) {\n            throw new Error('Paragraph should not be undefined');\n        }\n        var sec = this.blockOwner;\n        //Need to write the Section Properties if the Paragraph is last item in the section\n        if (!isLastSection && sec.hasOwnProperty('sectionFormat')\n            && sec.blocks.indexOf(paragraph) === sec.blocks.length - 1) {\n            writer.writeStartElement('w', 'p', this.wNamespace);\n            writer.writeStartElement(undefined, 'pPr', this.wNamespace);\n            this.serializeSectionProperties(writer, sec);\n            writer.writeEndElement();\n            writer.writeEndElement();\n        }\n        // if (paragraph.ParagraphFormat.PageBreakAfter && !IsPageBreakNeedToBeSkipped(paragraph as Entity))\n        //     paragraph.InsertBreak(BreakType.PageBreak);\n        // if (paragraph.ParagraphFormat.ColumnBreakAfter && !IsPageBreakNeedToBeSkipped(paragraph as Entity))\n        //     paragraph.InsertBreak(BreakType.ColumnBreak);\n        //Splits the paragraph based on the newline character\n        // paragraph.SplitTextRange();\n        writer.writeStartElement('w', 'p', this.wNamespace);\n        writer.writeStartElement(undefined, 'pPr', this.wNamespace);\n        this.serializeParagraphFormat(writer, paragraph.paragraphFormat, paragraph);\n        writer.writeEndElement(); //end of pPr\n        // Serialize watermark if paragraph is the first item of Header document.\n        // EnsureWatermark(paragraph);\n        this.serializeParagraphItems(writer, paragraph.inlines);\n        writer.writeEndElement(); //end of paragraph tag.\n    };\n    // Serialize the paragraph items\n    WordExport.prototype.serializeParagraphItems = function (writer, paraItems) {\n        var previousNode = undefined;\n        for (var i = 0; i < paraItems.length; i++) {\n            var item = paraItems[i];\n            if (item.hasOwnProperty('fieldType')) {\n                this.serializeFieldCharacter(writer, item);\n            }\n            else if (item.hasOwnProperty('imageString')) {\n                this.serializePicture(writer, item);\n            }\n            else if (item.hasOwnProperty('bookmarkType')) {\n                this.serializeBookMark(writer, item);\n            }\n            else {\n                this.serializeTextRange(writer, item, previousNode);\n            }\n            previousNode = item;\n        }\n    };\n    // Serialize the book mark\n    WordExport.prototype.serializeBookMark = function (writer, bookmark) {\n        var bookmarkId = this.getBookmarkId(bookmark.name);\n        var bookmarkName = bookmark.name;\n        if (bookmark.bookmarkType === 0) {\n            writer.writeStartElement('w', 'bookmarkStart', this.wNamespace);\n            writer.writeAttributeString('w', 'name', this.wNamespace, bookmarkName);\n        }\n        else if (bookmark.bookmarkType === 1) {\n            writer.writeStartElement('w', 'bookmarkEnd', this.wNamespace);\n        }\n        writer.writeAttributeString('w', 'id', this.wNamespace, bookmarkId.toString());\n        writer.writeEndElement();\n    };\n    WordExport.prototype.getBookmarkId = function (name) {\n        var index = this.bookmarks.indexOf(name);\n        if (index < 0) {\n            index = this.bookmarks.length;\n            this.bookmarks.push(name);\n        }\n        return index;\n    };\n    // Serialize the picture.\n    WordExport.prototype.serializePicture = function (writer, image) {\n        if (image.width >= 0 && image.height >= 0) {\n            writer.writeStartElement(undefined, 'r', this.wNamespace);\n            this.serializeCharacterFormat(writer, image.characterFormat);\n            this.serializeDrawing(writer, image);\n            writer.writeEndElement(); //end of run element\n        }\n    };\n    // Serialize the drawing element.\n    WordExport.prototype.serializeDrawing = function (writer, image) {\n        writer.writeStartElement(undefined, 'drawing', this.wNamespace);\n        this.serializeInlinePicture(writer, image);\n        writer.writeEndElement();\n    };\n    // Serialize the inline picture.\n    WordExport.prototype.serializeInlinePicture = function (writer, image) {\n        writer.writeStartElement(undefined, 'inline', this.wpNamespace);\n        writer.writeStartElement(undefined, 'extent', this.wpNamespace);\n        var cx = Math.round(image.width * this.emusPerPoint);\n        writer.writeAttributeString(undefined, 'cx', undefined, cx.toString());\n        var cy = Math.round(image.height * this.emusPerPoint);\n        writer.writeAttributeString(undefined, 'cy', undefined, cy.toString());\n        writer.writeEndElement();\n        // double borderWidth = (double)picture.PictureShape.PictureDescriptor.BorderLeft.LineWidth / DLSConstants.BorderLineFactor;\n        // if (borderWidth > 0 && picture.DocxProps.length === 0) {\n        //     long leftTop = 0, rightBottom = 0;\n        //     picture.PictureShape.GetEffectExtent(borderWidth, ref leftTop, ref rightBottom);\n        //     m_writer.WriteStartElement('effectExtent', WP_namespace);\n        //     m_writer.WriteAttributeString('l', leftTop.ToString(CultureInfo.InvariantCulture));\n        //     m_writer.WriteAttributeString('t', leftTop.ToString(CultureInfo.InvariantCulture));\n        //     m_writer.WriteAttributeString('r', rightBottom.ToString(CultureInfo.InvariantCulture));\n        //     m_writer.WriteAttributeString('b', rightBottom.ToString(CultureInfo.InvariantCulture));\n        //     m_writer.WriteEndElement();\n        // }\n        //this.serializePicProperties(writer, image);\n        this.serializeDrawingGraphics(writer, image);\n        writer.writeEndElement();\n    };\n    WordExport.prototype.startsWith = function (sourceString, startString) {\n        return startString.length > 0 && sourceString.substring(0, startString.length) === startString;\n    };\n    // Serialize the graphics element for pictures.\n    WordExport.prototype.serializeDrawingGraphics = function (writer, picture) {\n        var id = '';\n        id = this.updateShapeId(picture);\n        // picture.ShapeId = this.getNextDocPrID();\n        // Processing picture\n        writer.writeStartElement('wp', 'docPr', this.wpNamespace);\n        writer.writeAttributeString(undefined, 'id', undefined, (this.mDocPrID++).toString());\n        // if (!isNullOrUndefined(picture.AlternativeText))\n        //     m_writer.WriteAttributeString('descr', picture.AlternativeText);\n        writer.writeAttributeString(undefined, 'name', undefined, '1'.toString());\n        // if (!string.IsNullOrEmpty(picture.Title))\n        //     m_writer.WriteAttributeString('title', picture.Title);\n        // else\n        writer.writeAttributeString(undefined, 'title', undefined, '');\n        // if (!picture.Visible)\n        //     m_writer.WriteAttributeString('hidden', '1');\n        // SerializePictureHyperlink(picture);\n        writer.writeEndElement();\n        writer.writeStartElement('a', 'graphic', this.aNamespace);\n        writer.writeStartElement('a', 'graphicData', this.aNamespace);\n        writer.writeAttributeString(undefined, 'uri', undefined, this.pictureNamespace);\n        writer.writeStartElement('pic', 'pic', this.pictureNamespace);\n        writer.writeStartElement('pic', 'nvPicPr', this.pictureNamespace);\n        writer.writeStartElement('pic', 'cNvPr', this.pictureNamespace);\n        writer.writeAttributeString(undefined, 'id', undefined, '0');\n        writer.writeAttributeString(undefined, 'name', undefined, '');\n        writer.writeAttributeString(undefined, 'descr', undefined, '');\n        writer.writeEndElement();\n        writer.writeStartElement('pic', 'cNvPicPr', this.pictureNamespace);\n        writer.writeStartElement('a', 'picLocks', this.aNamespace);\n        writer.writeAttributeString(undefined, 'noChangeAspect', undefined, '1');\n        writer.writeAttributeString(undefined, 'noChangeArrowheads', undefined, '1');\n        writer.writeEndElement();\n        writer.writeEndElement();\n        writer.writeEndElement();\n        writer.writeStartElement('pic', 'blipFill', this.pictureNamespace);\n        writer.writeStartElement('a', 'blip', this.aNamespace);\n        if (this.startsWith(picture.imageString, 'data:image')) {\n            writer.writeAttributeString('r', 'embed', this.rNamespace, id);\n        }\n        else {\n            if (this.documentImages.containsKey(id)) {\n                //Remove the image document images collection for this particular key\n                //If the picture image data has href means MS Word contains the image in media folder as well as \n                //it is having external relationship id\n                // if (!this.startsWith(picture.imageString, 'data:image')) {\n                this.documentImages.remove(id);\n                this.externalImages.add(id, picture.imageString);\n                writer.writeAttributeString(undefined, 'link', this.rNamespace, id);\n            }\n        }\n        //End Element Blip\n        writer.writeEndElement();\n        writer.writeStartElement('a', 'srcRect', this.aNamespace);\n        writer.writeEndElement();\n        writer.writeStartElement('a', 'stretch', this.aNamespace);\n        writer.writeStartElement('a', 'fillRect', this.aNamespace);\n        writer.writeEndElement();\n        writer.writeEndElement();\n        writer.writeEndElement();\n        writer.writeStartElement('pic', 'spPr', this.pictureNamespace);\n        writer.writeAttributeString(undefined, 'bwMode', undefined, 'auto');\n        writer.writeStartElement('a', 'xfrm', this.aNamespace);\n        // if (picture.Rotation !== 0)\n        //     m_writer.WriteAttributeString('rot', picture.Rotation.ToString());\n        writer.writeStartElement('a', 'off', this.aNamespace);\n        writer.writeAttributeString(undefined, 'x', undefined, '0');\n        writer.writeAttributeString(undefined, 'y', undefined, '0');\n        writer.writeEndElement();\n        writer.writeStartElement('a', 'ext', this.aNamespace);\n        var cx = Math.round((picture.width * this.emusPerPoint));\n        writer.writeAttributeString(undefined, 'cx', undefined, cx.toString());\n        var cy = Math.round((picture.height * this.emusPerPoint));\n        writer.writeAttributeString(undefined, 'cy', undefined, cy.toString());\n        writer.writeEndElement();\n        writer.writeEndElement();\n        writer.writeStartElement('a', 'prstGeom', this.aNamespace);\n        writer.writeAttributeString(undefined, 'prst', undefined, 'rect');\n        writer.writeStartElement('a', 'avLst', this.aNamespace);\n        writer.writeEndElement();\n        writer.writeEndElement();\n        //When the picture border has been added next to effect list\n        //if not, Picture border has not been preserved\n        // if (picture.HasBorder)\n        // {\n        //     if (picture.TextWrappingStyle === TextWrappingStyle.Inline && picture.IsShape)\n        //         SerializeInlineShapeLine(picture.PictureShape);\n        //     else\n        //         SerializeShapeLine(picture.PictureShape);\n        // }\n        // if (picture.DocxProps.length > 0)\n        //     SerializeDocxProps(picture.DocxProps, 'effectLst');\n        writer.writeEndElement();\n        writer.writeEndElement();\n        writer.writeEndElement();\n        writer.writeEndElement();\n    };\n    /// Update the shape id.\n    WordExport.prototype.updateShapeId = function (picture) {\n        var id = '';\n        var tOwner = this.paragraph;\n        // Adding picture byte data to the corresponding picture collection \n        // depending on its owner subdocument\n        if (this.headerFooter) {\n            id = this.updateHFImageRels(this.headerFooter, picture);\n        }\n        else {\n            if (id === '') {\n                if (tOwner.hasOwnProperty('sectionFormat') || tOwner.hasOwnProperty('inlines')) {\n                    id = this.addImageRelation(this.documentImages, picture);\n                    // if (owner is WFootnote)\n                    // {\n                    //     if ((owner as WFootnote).FootnoteType === FootnoteType.Footnote)\n                    //         id = AddImageRelation(FootnoteImages, picture.ImageRecord);\n                    //     else\n                    //         id = AddImageRelation(EndnoteImages, picture.ImageRecord);\n                    // }\n                    // if (owner is WComment)\n                    //     id = AddImageRelation(CommentImages, picture.ImageRecord);\n                }\n            }\n        }\n        return id;\n    };\n    // Adds the image relation.\n    WordExport.prototype.addImageRelation = function (imageCollection, image) {\n        var relationId = '';\n        // if (imageCollection.ContainsValue(imageRecord)) {\n        //     foreach(string key in imageCollection.keys)\n        //     {\n        //         if (imageRecord === imageCollection[key]) {\n        //             relationId = key;\n        //             break;\n        //         }\n        //     }\n        // }\n        // else {\n        relationId = this.getNextRelationShipID();\n        imageCollection.add(relationId, image);\n        // }\n        return relationId;\n    };\n    // Update the HeaderFooter image relations.\n    WordExport.prototype.updateHFImageRels = function (hf, image) {\n        var id = '';\n        // UpdateImages(image);\n        var headerId = '';\n        var types = this.headersFooters.keys;\n        for (var i = 0; i < types.length; i++) {\n            var hfColl = this.headersFooters.get(types[i]);\n            var hfKeys = hfColl.keys;\n            for (var j = 0; j < hfKeys.length; j++) {\n                if (hfColl.get(hfKeys[j]) === hf) {\n                    headerId = hfKeys[j];\n                    var headerImages = void 0;\n                    if (this.headerFooterImages.containsKey(headerId)) {\n                        headerImages = this.headerFooterImages.get(headerId);\n                        id = this.addImageRelation(headerImages, image);\n                    }\n                    else {\n                        headerImages = new Dictionary();\n                        id = this.addImageRelation(headerImages, image);\n                        this.headerFooterImages.add(headerId, headerImages);\n                    }\n                }\n            }\n        }\n        return id;\n    };\n    // Serialize the table\n    WordExport.prototype.serializeTable = function (writer, table) {\n        if (table.rows.length <= 0) {\n            return;\n        }\n        var owner = this.table;\n        this.table = table;\n        writer.writeStartElement(undefined, 'tbl', this.wNamespace);\n        var tableFormat = table.rows[0].rowFormat;\n        this.serializeTableFormat(writer, tableFormat, table);\n        this.serializeTableGrid(writer, table);\n        this.serializeTableRows(writer, table.rows);\n        writer.writeEndElement();\n        this.table = owner;\n    };\n    // Serialize the table grid\n    WordExport.prototype.serializeTableGrid = function (writer, table) {\n        writer.writeStartElement(undefined, 'tblGrid', this.wNamespace);\n        if (table.grid.length !== 0) {\n            this.serializeGridColumns(writer, table.grid);\n        }\n        writer.writeEndElement();\n    };\n    // Serialize the table rows\n    WordExport.prototype.serializeTableRows = function (writer, rows) {\n        if (rows.length > 0) {\n            for (var i = 0; i < rows.length; i++) {\n                var row = rows[i];\n                if (row.cells.length > 0) {\n                    this.serializeRow(writer, row);\n                }\n            }\n        }\n    };\n    // Serialize the table row\n    WordExport.prototype.serializeRow = function (writer, row) {\n        var owner = this.row;\n        this.row = row;\n        writer.writeStartElement(undefined, 'tr', this.wNamespace);\n        this.serializeRowFormat(writer, row);\n        this.serializeCells(writer, row.cells);\n        writer.writeEndElement(); //end od table row 'tr'\n        this.row = owner;\n    };\n    // Serialize the row format\n    WordExport.prototype.serializeRowFormat = function (writer, row) {\n        writer.writeStartElement(undefined, 'trPr', this.wNamespace);\n        //Serialize Row Height\n        if (row.rowFormat.height > 0) {\n            writer.writeStartElement(undefined, 'trHeight', this.wNamespace);\n            if (row.rowFormat.heightType === 'Exactly') {\n                writer.writeAttributeString('w', 'hRule', this.wNamespace, 'exact');\n            }\n            else if (row.rowFormat.heightType === 'AtLeast') {\n                writer.writeAttributeString('w', 'hRule', this.wNamespace, 'atLeast');\n            }\n            var height = this.roundToTwoDecimal(row.rowFormat.height * this.twentiethOfPoint).toString();\n            writer.writeAttributeString('w', 'val', this.wNamespace, height);\n            writer.writeEndElement();\n        }\n        var rowFormat = row.rowFormat;\n        // //Serialize 'gridBefore' element\n        var gridBefore = rowFormat.gridBefore;\n        if (gridBefore > 0) {\n            writer.writeStartElement(undefined, 'gridBefore', this.wNamespace);\n            writer.writeAttributeString('w', 'val', this.wNamespace, gridBefore.toString());\n            writer.writeEndElement();\n        }\n        // //Serialize 'gridAfter' element\n        var gridAfter = rowFormat.gridAfter;\n        if (gridAfter > 0) {\n            writer.writeStartElement(undefined, 'gridAfter', this.wNamespace);\n            writer.writeAttributeString('w', 'val', this.wNamespace, gridAfter.toString());\n            writer.writeEndElement();\n        }\n        // //Serialize 'wBefore' element \n        if (gridBefore > 0) {\n            writer.writeStartElement(undefined, 'wBefore', this.wNamespace);\n            switch (rowFormat.gridBeforeWidthType) {\n                case 'Percent':\n                    var width = this.roundToTwoDecimal(rowFormat.gridBeforeWidth * this.percentageFactor).toString();\n                    writer.writeAttributeString('w', 'val', this.wNamespace, width);\n                    writer.writeAttributeString('w', 'type', this.wNamespace, 'pct');\n                    break;\n                case 'Point':\n                    var pointWidth = this.roundToTwoDecimal(rowFormat.gridBeforeWidth * this.twipsInOnePoint).toString();\n                    writer.writeAttributeString('w', 'val', this.wNamespace, pointWidth);\n                    writer.writeAttributeString('w', 'type', this.wNamespace, 'dxa');\n                    break;\n            }\n            writer.writeEndElement();\n        }\n        //Serialize 'wAfter' element\n        if (gridAfter > 0) {\n            writer.writeStartElement(undefined, 'wAfter', this.wNamespace);\n            switch (rowFormat.gridAfterWidthType) {\n                case 'Percent':\n                    var width = this.roundToTwoDecimal(rowFormat.gridAfterWidth * this.percentageFactor).toString();\n                    writer.writeAttributeString('w', 'val', this.wNamespace, width);\n                    writer.writeAttributeString('w', 'type', this.wNamespace, 'pct');\n                    break;\n                case 'Point':\n                    var pointWidth = this.roundToTwoDecimal(rowFormat.gridAfterWidth * this.twipsInOnePoint).toString();\n                    writer.writeAttributeString('w', 'val', this.wNamespace, pointWidth);\n                    writer.writeAttributeString('w', 'type', this.wNamespace, 'dxa');\n                    break;\n            }\n            writer.writeEndElement();\n        }\n        //Serialize 'cantSplit' element \n        if (!rowFormat.allowBreakAcrossPages) {\n            writer.writeStartElement(undefined, 'cantSplit', this.wNamespace);\n            writer.writeEndElement();\n        }\n        // //Serialize 'tblHeader' element \n        if (rowFormat.isHeader) {\n            writer.writeStartElement(undefined, 'tblHeader', this.wNamespace);\n            writer.writeEndElement();\n        }\n        writer.writeEndElement();\n    };\n    // serialize the table cells\n    WordExport.prototype.serializeCells = function (writer, cells) {\n        for (var i = 0; i < cells.length; i++) {\n            this.serializeCell(writer, cells[i]);\n        }\n    };\n    // Serialize the table cell\n    WordExport.prototype.serializeCell = function (writer, cell) {\n        var owner = this.blockOwner;\n        this.blockOwner = cell;\n        writer.writeStartElement(undefined, 'tc', this.wNamespace);\n        this.serializeCellFormat(writer, cell.cellFormat);\n        if (cell.blocks.length > 0) {\n            var itemIndex = 0;\n            var item = undefined;\n            while (itemIndex < cell.blocks.length) {\n                item = cell.blocks[itemIndex];\n                this.serializeBodyItem(writer, item, false);\n                itemIndex += 1;\n            }\n        }\n        else {\n            writer.writeStartElement(undefined, 'p', this.wNamespace);\n            writer.writeStartElement(undefined, 'pPr', this.wNamespace);\n            writer.writeStartElement(undefined, 'pStyle', this.wNamespace);\n            writer.writeAttributeString('w', 'val', this.wNamespace, 'Normal');\n            writer.writeEndElement(); //end of pStyle\n            writer.writeEndElement(); //end of pPr\n            writer.writeEndElement(); //end of P\n        }\n        writer.writeEndElement(); //end of table cell 'tc'        \n        this.blockOwner = owner;\n    };\n    // Serialize the cell formatting\n    WordExport.prototype.serializeCellFormat = function (writer, cellFormat) {\n        var cell = this.blockOwner;\n        //Get the table fomat\n        var tf = this.table.tableFormat;\n        //Get the row format\n        var rf = this.row.rowFormat;\n        writer.writeStartElement(undefined, 'tcPr', this.wNamespace);\n        //w:cnfStyle -   Table Cell Conditional Formatting\n        // SerializeCnfStyleElement(cell);\n        //w:tcW -    Preferred Table Cell Width\n        this.serializeCellWidth(writer, cell);\n        //w:hMerge -    Horizontally Merged Cell and w:vMerge -    Vertically Merged Cell\n        this.serializeCellMerge(writer, cellFormat);\n        //w:gridSpan -   Grid Columns Spanned by Current Table Cell\n        this.serializeGridSpan(writer, cell);\n        //w:tcBorders -    Table Cell Borders\n        writer.writeStartElement(undefined, 'tcBorders', this.wNamespace);\n        this.serializeBorders(writer, cellFormat.borders, 8);\n        writer.writeEndElement();\n        //w:shd -  Table Cell Shading\n        this.serializeShading(writer, cell.cellFormat.shading);\n        // //w:noWrap -   Don't Wrap Cell Content\n        // if (cellFormat.HasValue(CellFormat.TextWrapKey)) {\n        //     m_writer.WriteStartElement('noWrap', W_namespace);\n        //     if (cellFormat.TextWrap)\n        //         m_writer.WriteAttributeString('w', 'val', W_namespace, 'false');\n        //     m_writer.WriteEndElement();\n        // }\n        // //w:tcMar -  Single Table Cell Margins\n        // if (!cellFormat.SamePaddingsAsTable) {\n        //     m_writer.WriteStartElement('tcMar', W_namespace);\n        //     SerializePaddings(cellFormat.Paddings);\n        //     m_writer.WriteEndElement();\n        // }\n        //w:textDirection -   Table Cell Text Flow Direction\n        this.serializeTableCellDirection(writer, cellFormat);\n        // //w:tcFitText -  Fit Text Within Cell\n        // if (cellFormat.FitText) {\n        //     m_writer.WriteStartElement('tcFitText', W_namespace);\n        //     m_writer.WriteEndElement();\n        // }\n        // //w:hideMark \n        // if (cellFormat.HideMark) {\n        //     m_writer.WriteStartElement('hideMark', W_namespace);\n        //     m_writer.WriteEndElement();\n        // }\n        //w:vAlign -  Table Cell Vertical Alignment\n        // if (cellFormat.HasValue(CellFormat.VrAlignmentKey))\n        this.serializeCellVerticalAlign(writer, cellFormat.verticalAlignment);\n        // //w:hideMark -   Ignore End Of Cell Marker In Row Height Calculation\n        // SerializeDocxProps(tempDocxProps, 'hideMark');\n        // //w:cellIns -    Table Cell Insertion\n        // SerializeDocxProps(tempDocxProps, 'cellIns');\n        // //w:cellDel -    Table Cell Deletion\n        // SerializeDocxProps(tempDocxProps, 'cellDel');\n        // //w:cellMerge -   Vertically Merged/Split Table Cells\n        // SerializeDocxProps(tempDocxProps, 'cellMerge');\n        // if (cellFormat.OldPropertiesHash.length > 0 && !m_isAlternativeCellFormat) {\n        //     m_isAlternativeCellFormat = true;\n        //     SerializeTrackChangeProps('tcPrChange', cellFormat.FormatChangeAuthorName, cellFormat.FormatChangeDateTime);\n        //     Dictionary < int, object > oldPropertyHash = new Dictionary<int, object>(cellFormat.OldPropertiesHash);\n        //     Dictionary < int, object > propertyHash = new Dictionary<int, object>(cellFormat.PropertiesHash);\n        //     cellFormat.PropertiesHash.Clear();\n        //     cellFormat.OldPropertiesHash.Clear();\n        //     foreach(KeyValuePair < int, object > keyValue in oldPropertyHash)\n        //     cellFormat.PropertiesHash[keyValue.Key] = keyValue.Value;\n        //     SerializeCellFormat(cellFormat);\n        //     cellFormat.PropertiesHash.Clear();\n        //     foreach(KeyValuePair < int, object > keyValue in propertyHash)\n        //     cellFormat.PropertiesHash[keyValue.Key] = keyValue.Value;\n        //     foreach(KeyValuePair < int, object > keyValue in oldPropertyHash)\n        //     cellFormat.OldPropertiesHash[keyValue.Key] = keyValue.Value;\n        //     m_writer.WriteEndElement();\n        //     m_isAlternativeCellFormat = false;\n        // }\n        writer.writeEndElement();\n    };\n    // Serialize the cell width\n    WordExport.prototype.serializeCellWidth = function (writer, cell) {\n        var cf = cell.cellFormat;\n        writer.writeStartElement(undefined, 'tcW', this.wNamespace);\n        if (cf.preferredWidthType === 'Percent') {\n            writer.writeAttributeString(undefined, 'type', this.wNamespace, 'pct');\n            // tslint:disable-next-line:max-line-length\n            writer.writeAttributeString(undefined, 'w', this.wNamespace, this.roundToTwoDecimal(cf.preferredWidth * this.percentageFactor).toString());\n        }\n        else if (cf.preferredWidthType === 'Point') {\n            // tslint:disable-next-line:max-line-length\n            writer.writeAttributeString(undefined, 'w', this.wNamespace, this.roundToTwoDecimal(cf.preferredWidth * this.twipsInOnePoint).toString());\n            writer.writeAttributeString(undefined, 'type', this.wNamespace, 'dxa');\n        }\n        else {\n            writer.writeAttributeString(undefined, 'type', this.wNamespace, 'auto');\n            writer.writeAttributeString(undefined, 'w', this.wNamespace, '0');\n        }\n        writer.writeEndElement();\n    };\n    // Serialize cell merge\n    WordExport.prototype.serializeCellMerge = function (writer, cellFormat) {\n        var cell = this.blockOwner;\n        var isserialized = false;\n        var collKey;\n        var currentIndex = cell.columnIndex;\n        var cellIndex = this.row.cells.indexOf(cell);\n        var prevIndex = cellIndex > 0 ? this.row.cells[cellIndex - 1].columnIndex : cell.columnIndex;\n        if (cell.columnIndex === cellIndex) {\n            collKey = cell.columnIndex;\n            isserialized = true;\n        }\n        else {\n            isserialized = false;\n        }\n        if (!isserialized) {\n            if (cellIndex === 0) {\n                currentIndex = cell.columnIndex;\n                prevIndex = -1;\n            }\n            for (var i = prevIndex; i < currentIndex; i++) {\n                collKey = prevIndex + 1;\n                prevIndex += 1;\n                if (this.mVerticalMerge.containsKey(collKey)) {\n                    this.createMerge(writer, collKey, cell);\n                }\n            }\n        }\n        if (cellFormat.rowSpan > 1) {\n            writer.writeStartElement(undefined, 'vMerge', this.wNamespace);\n            this.mVerticalMerge.add(collKey, cellFormat.rowSpan - 1);\n            if (cellFormat.columnSpan > 1) {\n                this.mGridSpans.add(collKey, cellFormat.columnSpan);\n            }\n            writer.writeAttributeString('w', 'val', this.wNamespace, 'restart');\n            writer.writeEndElement();\n        }\n        else if (this.mVerticalMerge.containsKey(collKey) && isserialized) {\n            this.createMerge(writer, collKey, cell);\n        }\n        else if (this.mVerticalMerge.containsKey(cellIndex + 1) && isserialized && cell.nextNode === undefined) {\n            collKey = cell.columnIndex + 1;\n            writer.writeEndElement();\n            writer.writeStartElement('w', 'p', this.wNamespace);\n            writer.writeEndElement();\n            writer.writeEndElement();\n            writer.writeStartElement(undefined, 'tc', this.wNamespace);\n            writer.writeStartElement(undefined, 'tcPr', this.wNamespace);\n            this.serializeColumnSpan(collKey, writer);\n            writer.writeStartElement(undefined, 'vMerge', this.wNamespace);\n            writer.writeAttributeString('w', 'val', this.wNamespace, 'continue');\n            writer.writeEndElement();\n            this.checkMergeCell(collKey);\n        }\n    };\n    WordExport.prototype.createMerge = function (writer, collKey, cell) {\n        this.serializeColumnSpan(collKey, writer);\n        writer.writeStartElement(undefined, 'vMerge', this.wNamespace);\n        writer.writeAttributeString('w', 'val', this.wNamespace, 'continue');\n        writer.writeEndElement();\n        writer.writeEndElement(); //end tcPr\n        writer.writeStartElement('w', 'p', this.wNamespace);\n        writer.writeEndElement();\n        writer.writeEndElement(); //end tc\n        writer.writeStartElement(undefined, 'tc', this.wNamespace);\n        writer.writeStartElement(undefined, 'tcPr', this.wNamespace);\n        this.serializeCellWidth(writer, cell);\n        this.checkMergeCell(collKey);\n    };\n    WordExport.prototype.serializeColumnSpan = function (collKey, writer) {\n        if (this.mGridSpans.keys.length > 0 && this.mGridSpans.containsKey(collKey)) {\n            writer.writeStartElement(undefined, 'gridSpan', this.wNamespace);\n            writer.writeAttributeString('w', 'val', this.wNamespace, this.mGridSpans.get(collKey).toString());\n            writer.writeEndElement();\n        }\n    };\n    WordExport.prototype.checkMergeCell = function (collKey) {\n        if ((this.mVerticalMerge.get(collKey) - 1) === 0) {\n            this.mVerticalMerge.remove(collKey);\n            if (this.mGridSpans.keys.length > 0 && this.mGridSpans.containsKey(collKey)) {\n                this.mGridSpans.remove(collKey);\n            }\n        }\n        else {\n            this.mVerticalMerge.set(collKey, this.mVerticalMerge.get(collKey) - 1);\n        }\n    };\n    // Serialize the grid span element of cell.\n    WordExport.prototype.serializeGridSpan = function (writer, cell) {\n        // int gridSpan = cell.cellFormat.GridSpan;\n        if (cell.cellFormat.columnSpan > 1) {\n            var num = cell.cellFormat.columnSpan;\n            writer.writeStartElement(undefined, 'gridSpan', this.wNamespace);\n            writer.writeAttributeString('w', 'val', this.wNamespace, num.toString());\n            writer.writeEndElement();\n        }\n    };\n    // Serialize the table cell direction\n    WordExport.prototype.serializeTableCellDirection = function (writer, cellFormat) {\n        // if (cellFormat..textDirection !== TextDirection.Horizontal)\n        // {\n        //     m_writer.WriteStartElement('textDirection', W_namespace);\n        //     switch (cellFormat.TextDirection)\n        //     {\n        //         case TextDirection.Horizontal:\n        //             m_writer.WriteAttributeString('w', 'val', W_namespace, 'lrTb');\n        //             break;\n        //         case TextDirection.VerticalBottomToTop:\n        //             m_writer.WriteAttributeString('w', 'val', W_namespace, 'btLr');\n        //             break;\n        //         case TextDirection.VerticalTopToBottom:\n        //             m_writer.WriteAttributeString('w', 'val', W_namespace, 'tbRl');\n        //             break;\n        //         case TextDirection.HorizontalFarEast:\n        //             m_writer.WriteAttributeString('w', 'val', W_namespace, 'lrTbV');\n        //             break;\n        //         case TextDirection.Vertical:\n        //             m_writer.WriteAttributeString('w', 'val', W_namespace, 'tbLrV');\n        //             break;\n        //         case TextDirection.VerticalFarEast:\n        //             m_writer.WriteAttributeString('w', 'val', W_namespace, 'tbRlV');\n        //             break;\n        //     }\n        //     m_writer.WriteEndElement();\n        // }\n    };\n    // Serialize the cell vertical alignment\n    WordExport.prototype.serializeCellVerticalAlign = function (writer, alignment) {\n        writer.writeStartElement(undefined, 'vAlign', this.wNamespace);\n        switch (alignment) {\n            case 'Top':\n                writer.writeAttributeString('w', 'val', this.wNamespace, 'top');\n                break;\n            case 'Center':\n                writer.writeAttributeString('w', 'val', this.wNamespace, 'center');\n                break;\n            default:\n                writer.writeAttributeString('w', 'val', this.wNamespace, 'bottom');\n                break;\n        }\n        writer.writeEndElement();\n    };\n    // Serialize the table grid columns.\n    WordExport.prototype.serializeGridColumns = function (writer, grid) {\n        for (var i = 1, count = grid.length; i < count; i++) {\n            var gridValue = Math.round(grid[i] * 20);\n            writer.writeStartElement(undefined, 'gridCol', this.wNamespace);\n            writer.writeAttributeString(undefined, 'w', this.wNamespace, gridValue.toString());\n            writer.writeEndElement();\n        }\n    };\n    // Serialize the row formattings.\n    // Table parameter is passed for serializing table format and undefined for serializing row format.\n    WordExport.prototype.serializeTableFormat = function (writer, format, table) {\n        // if (!isNullOrUndefined(table))\n        // {\n        //     List<Stream> tempDocxProps = new List<Stream>();\n        //     for (int i = 0, cnt = table.DocxTableFormat.NodeArray.length; i < cnt; i++)\n        //         tempDocxProps.Add(table.DocxTableFormat.NodeArray[i]);\n        writer.writeStartElement(undefined, 'tblPr', this.wNamespace);\n        //     SerializeTableStlye(format);\n        //     if (format.WrapTextAround &&!((table.OwnerTextBody.Owner is WTextBox) || \n        //(table.OwnerTextBody.Owner is WComment) || (table.OwnerTextBody.Owner is WFootnote)))\n        //     {\n        //         SerializeTablePositioning(format.Positioning);\n        //         if (!format.Positioning.AllowOverlap)\n        //         {\n        //             m_writer.WriteStartElement('tblOverlap', W_namespace);\n        //             m_writer.WriteAttributeString('val', W_namespace, 'never');\n        //             m_writer.WriteEndElement();\n        //         }\n        //     }\n        //     if (format.Bidi)\n        //     {\n        //         m_writer.WriteStartElement('bidiVisual', W_namespace);\n        //         m_writer.WriteEndElement();\n        //     }\n        //     SerializeDocxProps(tempDocxProps, 'tblStyleRowBandSize');\n        //     SerializeDocxProps(tempDocxProps, 'tblStyleColBandSize');\n        this.serializeTableWidth(writer, table);\n        this.serializeTableAlignment(writer, table.tableFormat);\n        this.serializeCellSpacing(writer, table.tableFormat);\n        this.serializeTableIndentation(writer, table.tableFormat);\n        this.serializeTableBorders(writer, table.tableFormat);\n        this.serializeShading(writer, table.tableFormat.shading);\n        this.serializeTblLayout(writer, table.tableFormat);\n        // this.serializeTableCellMargin(writer, table.tableFormat);\n        //     SerializeTableLook(table);\n        //         if (!isNullOrUndefined(table.Title))\n        //             SerializeTableTitle(table);\n        //         if (!isNullOrUndefined(table.Description))\n        //             SerializeTableDescription(table);\n        // }\n        // else\n        // {\n        //     SerializeCellSpacing(format);\n        //     SerializeTableIndentation(format);\n        //     SerializeTableBorders(format);\n        //     SerializeTableShading(format);\n        //     SerializeTblLayout(format);\n        //     SerializeTableCellMargin(format);\n        // }\n        // if (!isNullOrUndefined(format.OwnerBase) && format.OwnerBase is WTable\n        //   && format.OldPropertiesHash.length > 0 && !m_isAlternativeTableFormat)\n        // {\n        //     m_isAlternativeTableFormat = true;\n        //     SerializeTrackChangeProps('tblPrChange', format.FormatChangeAuthorName, format.FormatChangeDateTime);\n        //     SerializeTableTrackChanges(format, format.OwnerBase as WTable);\n        //     m_writer.WriteEndElement();\n        //     m_isAlternativeTableFormat = false;\n        // }\n        // if (!isNullOrUndefined(format.OwnerRow) && format.OldPropertiesHash.length > 0)\n        // {\n        //     SerializeTrackChangeProps('tblPrExChange', format.FormatChangeAuthorName, format.FormatChangeDateTime);\n        //     SerializeTableTrackChanges(format, undefined);\n        //     m_writer.WriteEndElement();\n        // }\n        // SerializeTblTrackChanges(format);\n        if (!isNullOrUndefined(table)) {\n            writer.writeEndElement(); //end of tblPr\n        }\n    };\n    // Serialize the table borders\n    WordExport.prototype.serializeShading = function (writer, format) {\n        // if (format.textureStyle !== 'TextureNone') {\n        writer.writeStartElement(undefined, 'shd', this.wNamespace);\n        writer.writeAttributeString(undefined, 'fill', this.wNamespace, this.getColor(format.backgroundColor));\n        if (format.foregroundColor === 'empty') {\n            writer.writeAttributeString(undefined, 'color', this.wNamespace, 'auto');\n        }\n        else {\n            writer.writeAttributeString(undefined, 'color', this.wNamespace, this.getColor(format.foregroundColor));\n        }\n        writer.writeAttributeString('w', 'val', this.wNamespace, this.getTextureStyle(format.textureStyle));\n        writer.writeEndElement();\n        // }\n    };\n    WordExport.prototype.getTextureStyle = function (textureStyle) {\n        switch (textureStyle) {\n            case 'Texture5Percent':\n            case 'Texture2Pt5Percent':\n            case 'Texture7Pt5Percent':\n                return 'pct5';\n            case 'Texture10Percent':\n                return 'pct10';\n            case 'Texture12Pt5Percent':\n                return 'pct12';\n            case 'Texture15Percent':\n            case 'Texture17Pt5Percent':\n                return 'pct15';\n            case 'Texture20Percent':\n            case 'Texture22Pt5Percent':\n                return 'pct20';\n            case 'Texture25Percent':\n            case 'Texture27Pt5Percent':\n                return 'pct25';\n            case 'Texture30Percent':\n            case 'Texture32Pt5Percent':\n                return 'pct30';\n            case 'Texture35Percent':\n                return 'pct35';\n            case 'Texture37Pt5Percent':\n                return 'pct37';\n            case 'Texture40Percent':\n            case 'Texture42Pt5Percent':\n                return 'pct40';\n            case 'Texture45Percent':\n            case 'Texture47Pt5Percent':\n                return 'pct45';\n            case 'Texture50Percent':\n            case 'Texture52Pt5Percent':\n                return 'pct50';\n            case 'Texture55Percent':\n            case 'Texture57Pt5Percent':\n                return 'pct55';\n            case 'Texture60Percent':\n                return 'pct60';\n            case 'Texture62Pt5Percent':\n                return 'pct62';\n            case 'Texture65Percent':\n            case 'Texture67Pt5Percent':\n                return 'pct65';\n            case 'Texture70Percent':\n            case 'Texture72Pt5Percent':\n                return 'pct70';\n            case 'Texture75Percent':\n            case 'Texture77Pt5Percent':\n                return 'pct75';\n            case 'Texture80Percent':\n            case 'Texture82Pt5Percent':\n                return 'pct80';\n            case 'Texture85Percent':\n                return 'pct85';\n            case 'Texture87Pt5Percent':\n                return 'pct87';\n            case 'Texture90Percent':\n            case 'Texture92Pt5Percent':\n                return 'pct90';\n            case 'Texture95Percent':\n            case 'Texture97Pt5Percent':\n                return 'pct95';\n            case 'TextureCross':\n                return 'thinHorzCross';\n            case 'TextureDarkCross':\n                return 'horzCross';\n            case 'TextureDarkDiagonalCross':\n                return 'diagCross';\n            case 'TextureDarkDiagonalDown':\n                return 'reverseDiagStripe';\n            case 'TextureDarkDiagonalUp':\n                return 'diagStripe';\n            case 'TextureDarkHorizontal':\n                return 'horzStripe';\n            case 'TextureDarkVertical':\n                return 'vertStripe';\n            case 'TextureDiagonalCross':\n                return 'thinDiagCross';\n            case 'TextureDiagonalDown':\n                return 'thinReverseDiagStripe';\n            case 'TextureDiagonalUp':\n                return 'thinDiagStripe';\n            case 'TextureHorizontal':\n                return 'thinHorzStripe';\n            case 'TextureSolid':\n                return 'solid';\n            case 'TextureVertical':\n                return 'thinVertStripe';\n            default:\n                return 'clear';\n        }\n    };\n    // Serialize the table borders\n    WordExport.prototype.serializeTableBorders = function (writer, format) {\n        var borders = format.borders;\n        // if (IsNoneBorder(borders))\n        //     return;\n        writer.writeStartElement(undefined, 'tblBorders', this.wNamespace);\n        this.serializeBorders(writer, format.borders, 8);\n        writer.writeEndElement();\n    };\n    // Serialize the borders.\n    WordExport.prototype.serializeBorders = function (writer, borders, multipler) {\n        this.serializeBorder(writer, borders.top, 'top', multipler);\n        this.serializeBorder(writer, borders.left, 'left', multipler);\n        this.serializeBorder(writer, borders.bottom, 'bottom', multipler);\n        this.serializeBorder(writer, borders.right, 'right', multipler);\n        this.serializeBorder(writer, borders.horizontal, 'insideH', multipler);\n        this.serializeBorder(writer, borders.vertical, 'insideV', multipler);\n        this.serializeBorder(writer, borders.diagonalDown, 'tl2br', multipler);\n        this.serializeBorder(writer, borders.diagonalUp, 'tr2bl', multipler);\n    };\n    // Serialize the table layout element\n    WordExport.prototype.serializeTblLayout = function (writer, format) {\n        //TODO: AUTO size property is not mapped yet\n        // if (!format.IsAutoResized)\n        // {\n        //     writer.writeStartElement(undefined, 'tblLayout', this.wNamespace);\n        //     writer.writeAttributeString(undefined, 'type', this.wNamespace, 'fixed');\n        //     writer.writeEndElement();\n        // }\n    };\n    // Serializes the Border\n    WordExport.prototype.serializeBorder = function (writer, border, tagName, multiplier) {\n        var borderStyle = border.lineStyle;\n        var sz = (border.lineWidth * multiplier);\n        var space = border.space;\n        if (borderStyle === 'Cleared') {\n            writer.writeStartElement(undefined, tagName, this.wNamespace);\n            writer.writeAttributeString('w', 'val', this.wNamespace, 'nil');\n            writer.writeEndElement();\n            return;\n        }\n        else if ((borderStyle === 'None' && !border.hasNoneStyle) || sz <= 0) {\n            return;\n        }\n        writer.writeStartElement(undefined, tagName, this.wNamespace);\n        writer.writeAttributeString('w', 'val', this.wNamespace, this.getBorderStyle(borderStyle));\n        // if (border.color === '#000000')\n        // {\n        //     writer.writeAttributeString(undefined, 'color', this.wNamespace, 'auto');\n        // }\n        // else\n        // {\n        writer.writeAttributeString(undefined, 'color', this.wNamespace, this.getColor(border.color));\n        // }\n        writer.writeAttributeString(undefined, 'sz', this.wNamespace, this.roundToTwoDecimal(sz).toString());\n        writer.writeAttributeString(undefined, 'space', this.wNamespace, space.toString());\n        if (border.shadow) {\n            writer.writeAttributeString(undefined, 'shadow', this.wNamespace, 'on');\n        }\n        writer.writeEndElement();\n    };\n    // Get the border style as string\n    WordExport.prototype.getBorderStyle = function (borderStyle) {\n        switch (borderStyle) {\n            case 'Cleared':\n                return 'cleared';\n            case 'DashSmallGap':\n                return 'dashSmallGap';\n            case 'Triple':\n                return 'triple';\n            case 'Dot':\n                return 'dotted';\n            case 'DashDot':\n                return 'dotDash';\n            case 'DashLargeGap':\n                return 'dashed';\n            case 'DashDotDot':\n                return 'dotDotDash';\n            case 'Double':\n                return 'double';\n            case 'ThinThickSmallGap':\n                return 'thinThickSmallGap';\n            case 'ThickThinSmallGap':\n                return 'thickThinSmallGap';\n            case 'ThinThickThinSmallGap':\n                return 'thinThickThinSmallGap';\n            case 'ThickThinMediumGap':\n                return 'thickThinMediumGap';\n            case 'ThinThickMediumGap':\n                return 'thinThickMediumGap';\n            case 'ThinThickThinMediumGap':\n                return 'thinThickThinMediumGap';\n            case 'ThickThinLargeGap':\n                return 'thickThinLargeGap';\n            case 'ThinThickLargeGap':\n                return 'thinThickLargeGap';\n            case 'ThinThickThinLargeGap':\n                return 'thinThickThinLargeGap';\n            case 'Thick':\n                return 'thick';\n            case 'SingleWavy':\n                return 'wave';\n            case 'DoubleWavy':\n                return 'doubleWave';\n            case 'DashDotStroked':\n                return 'dashDotStroked';\n            case 'Engrave3D':\n                return 'threeDEngrave';\n            case 'Emboss3D':\n                return 'threeDEmboss';\n            case 'Outset':\n                return 'outset';\n            case 'Inset':\n                return 'inset';\n            // case 'None':\n            //     return 'none';\n            default:\n                return 'single';\n        }\n    };\n    // Serialize the table indentation.\n    WordExport.prototype.serializeTableIndentation = function (writer, format) {\n        writer.writeStartElement(undefined, 'tblInd', this.wNamespace);\n        var tableIndent = Math.round(format.leftIndent * this.twipsInOnePoint);\n        writer.writeAttributeString(undefined, 'w', this.wNamespace, tableIndent.toString());\n        writer.writeAttributeString(undefined, 'type', this.wNamespace, 'dxa');\n        writer.writeEndElement();\n    };\n    // Serialize the cell spacing.\n    WordExport.prototype.serializeCellSpacing = function (writer, format) {\n        if (!isNullOrUndefined(format.cellSpacing) && format.cellSpacing >= 0) {\n            writer.writeStartElement(undefined, 'tblCellSpacing', this.wNamespace);\n            // tslint:disable-next-line:max-line-length\n            writer.writeAttributeString(undefined, 'w', this.wNamespace, this.roundToTwoDecimal(format.cellSpacing * this.twentiethOfPoint).toString());\n            writer.writeAttributeString(undefined, 'type', this.wNamespace, 'dxa');\n            writer.writeEndElement();\n        }\n    };\n    // Serialize the table width\n    WordExport.prototype.serializeTableWidth = function (writer, table) {\n        writer.writeStartElement(undefined, 'tblW', this.wNamespace);\n        if (table.tableFormat.preferredWidthType === 'Percent') {\n            // tslint:disable-next-line:max-line-length\n            writer.writeAttributeString(undefined, 'w', this.wNamespace, (table.tableFormat.preferredWidth * this.percentageFactor).toString());\n            writer.writeAttributeString(undefined, 'type', this.wNamespace, 'pct');\n        }\n        else if (table.tableFormat.preferredWidthType === 'Point') {\n            var tableWidth = Math.round(table.tableFormat.preferredWidth * this.twipsInOnePoint);\n            writer.writeAttributeString(undefined, 'w', this.wNamespace, tableWidth.toString());\n            writer.writeAttributeString(undefined, 'type', this.wNamespace, 'dxa');\n        }\n        else {\n            writer.writeAttributeString(undefined, 'w', this.wNamespace, '0');\n            writer.writeAttributeString(undefined, 'type', this.wNamespace, 'auto');\n        }\n        writer.writeEndElement();\n    };\n    // Serialize the table alignment\n    WordExport.prototype.serializeTableAlignment = function (writer, format) {\n        writer.writeStartElement(undefined, 'jc', this.wNamespace);\n        switch (format.tableAlignment) {\n            case 'Right':\n                writer.writeAttributeString('w', 'val', this.wNamespace, 'right');\n                break;\n            case 'Center':\n                writer.writeAttributeString('w', 'val', this.wNamespace, 'center');\n                break;\n            default:\n                writer.writeAttributeString('w', 'val', this.wNamespace, 'left');\n                break;\n        }\n        writer.writeEndElement();\n    };\n    // Serialize the field\n    WordExport.prototype.serializeFieldCharacter = function (writer, field) {\n        writer.writeStartElement(undefined, 'r', this.wNamespace);\n        this.serializeCharacterFormat(writer, field.characterFormat);\n        writer.writeStartElement(undefined, 'fldChar', this.wNamespace);\n        var type = field.fieldType === 0 ? 'begin'\n            : field.fieldType === 1 ? 'end' : 'separate';\n        writer.writeAttributeString(undefined, 'fldCharType', this.wNamespace, type);\n        writer.writeEndElement();\n        writer.writeEndElement();\n    };\n    // Serialize the text range.\n    WordExport.prototype.serializeTextRange = function (writer, span, previousNode) {\n        writer.writeStartElement('w', 'r', this.wNamespace);\n        this.serializeCharacterFormat(writer, span.characterFormat);\n        if (span.text === '\\t') {\n            writer.writeElementString(undefined, 'tab', this.wNamespace, undefined);\n        }\n        else if (span.text === '\\v') {\n            writer.writeElementString(undefined, 'br', this.wNamespace, undefined);\n        }\n        else if (span.text === '\\f') {\n            writer.writeStartElement(undefined, 'br', this.wNamespace);\n            writer.writeAttributeString('w', 'type', this.wNamespace, 'page');\n            writer.writeEndElement();\n        }\n        else {\n            var isField = !isNullOrUndefined(previousNode)\n                && previousNode.hasOwnProperty('fieldType') && previousNode.fieldType !== 2;\n            writer.writeStartElement(undefined, isField ? 'instrText' : 't', this.wNamespace);\n            writer.writeAttributeString('xml', 'space', this.xmlNamespace, 'preserve');\n            writer.writeString(span.text);\n            writer.writeEndElement();\n        }\n        writer.writeEndElement();\n    };\n    // Serializes the paragraph format\n    WordExport.prototype.serializeParagraphFormat = function (writer, paragraphFormat, paragraph) {\n        if (!isNullOrUndefined(paragraphFormat.styleName)) {\n            writer.writeStartElement(undefined, 'pStyle', this.wNamespace);\n            writer.writeAttributeString('w', 'val', this.wNamespace, paragraphFormat.styleName);\n            writer.writeEndElement(); //end of pStyle\n        }\n        if (!isNullOrUndefined(paragraph)) {\n            this.serializeListFormat(writer, paragraph.paragraphFormat.listFormat);\n        }\n        else {\n            this.serializeListFormat(writer, paragraphFormat.listFormat);\n        }\n        this.serializeParagraphSpacing(writer, paragraphFormat);\n        this.serializeIndentation(writer, paragraphFormat);\n        this.serializeParagraphAlignment(writer, paragraphFormat.textAlignment);\n        if (!isNullOrUndefined(paragraphFormat.tabs) && paragraphFormat.tabs.length > 0) {\n            this.serializeTabs(writer, paragraphFormat.tabs);\n        }\n    };\n    // Serialize Tabs\n    WordExport.prototype.serializeTabs = function (writer, tabStops) {\n        writer.writeStartElement('w', 'tabs', this.wNamespace);\n        for (var i = 0; i < tabStops.length; i++) {\n            this.serializeTab(writer, tabStops[i]);\n        }\n        writer.writeEndElement();\n    };\n    WordExport.prototype.serializeTab = function (writer, tabStop) {\n        var position = 0;\n        writer.writeStartElement('w', 'tab', this.wNamespace);\n        if (tabStop.position === 0 && tabStop.deletePosition !== 0) {\n            position = tabStop.deletePosition * this.twentiethOfPoint;\n            writer.writeAttributeString('w', 'val', this.wNamespace, 'clear');\n        }\n        else {\n            position = tabStop.position * this.twentiethOfPoint;\n            writer.writeAttributeString('w', 'val', this.wNamespace, this.getTabJustification(tabStop.tabJustification));\n        }\n        if (!isNullOrUndefined(tabStop.tabLeader) && (tabStop.tabLeader !== 'None')) {\n            writer.writeAttributeString('w', 'leader', this.wNamespace, this.getTabLeader(tabStop.tabLeader));\n        }\n        writer.writeAttributeString('w', 'pos', this.wNamespace, position.toString() + '');\n        writer.writeEndElement();\n    };\n    WordExport.prototype.getTabLeader = function (tabLeader) {\n        switch (tabLeader) {\n            case 'Dot':\n                return 'dot';\n            case 'Hyphen':\n                return 'hyphen';\n            case 'Underscore':\n                return 'underscore';\n            default:\n                return 'none';\n        }\n    };\n    WordExport.prototype.getTabJustification = function (tabJustification) {\n        switch (tabJustification) {\n            case 'Bar':\n                return 'bar';\n            case 'Center':\n                return 'center';\n            case 'Decimal':\n                return 'decimal';\n            case 'Left':\n                return 'left';\n            case 'List':\n                return 'num';\n            case 'Right':\n                return 'right';\n            default:\n                return 'clear';\n        }\n    };\n    // // Seraializes the pargraph list format\n    // private serializeListParagraph(writer: XmlWriter, paragraph: any): void {\n    //     if (!isNullOrUndefined(paragraph.paragraphFormat.listFormat)) {\n    //         this.serializeListFormat(writer, paragraph.paragraphFormat.listFormat);\n    //     }\n    // }\n    // Serialize the list format\n    WordExport.prototype.serializeListFormat = function (writer, lf) {\n        // let pStyleName = undefined;\n        // if (lf.CurrentListStyle.IsBuiltInStyle && !isNullOrUndefined(lf.OwnerParagraph))\n        // {\n        //     pStyleName = lf.OwnerParagraph.StyleName;\n        // }\n        // int listId = GetListId(lf);\n        // if (!isNullOrUndefined(pStyleName) && string.IsNullOrEmpty(lf.LFOStyleName)) \n        // {\n        //     WordDocument doc = lf.OwnerParagraph.Document;\n        //     WParagraphStyle style = doc.Styles.FindByName(pStyleName, StyleType.ParagraphStyle) as WParagraphStyle;\n        //     if (style.ListIndex === -1)\n        //     {\n        //         ListStyle lstStyle = lf.OwnerParagraph.Document.ListStyles.FindByName(lf.CustomStyleName);\n        //         style.ListIndex = listId;\n        //         if (lstStyle.Levels.length > 1)\n        //         {\n        //             style.ListLevel = lf.ListLevelNumber;\n        //         }\n        //         pStyleName = pStyleName.Replace(' ', '');\n        //         lstStyle.Levels[lf.ListLevelNumber].ParaStyleName = pStyleName;\n        //     }\n        // }\n        // else\n        // {\n        // if (!isNullOrUndefined(lf.listId) && !isNullOrUndefined(lf.listLevelNumber)) {\n        //     this.serializeNumPr(writer, lf.listId, lf.listLevelNumber);\n        // }\n        // }\n        if (!isNullOrUndefined(lf.listId) || !isNullOrUndefined(lf.listLevelNumber)) {\n            writer.writeStartElement(undefined, 'numPr', this.wNamespace);\n            if (!isNullOrUndefined(lf.listLevelNumber) && lf.listLevelNumber !== -1) {\n                writer.writeStartElement(undefined, 'ilvl', this.wNamespace);\n                writer.writeAttributeString('w', 'val', this.wNamespace, lf.listLevelNumber.toString());\n                writer.writeEndElement();\n            }\n            if (!isNullOrUndefined(lf.listId) && lf.listId !== -1) {\n                writer.writeStartElement(undefined, 'numId', this.wNamespace);\n                writer.writeAttributeString('w', 'val', this.wNamespace, (lf.listId + 1).toString());\n                writer.writeEndElement();\n            }\n            writer.writeEndElement();\n        }\n    };\n    // // Serializes the numbering properties to the paragraph\n    // private serializeNumPr(writer: XmlWriter, listId: number, listLevel: number): void {\n    //     writer.writeStartElement(undefined, 'numPr', this.wNamespace);\n    //     if (listLevel !== -1) {\n    //         writer.writeStartElement(undefined, 'ilvl', this.wNamespace);\n    //         writer.writeAttributeString('w', 'val', this.wNamespace, listLevel.toString());\n    //         writer.writeEndElement();\n    //     }\n    //     if (listId !== -1) {\n    //         writer.writeStartElement(undefined, 'numId', this.wNamespace);\n    //         writer.writeAttributeString('w', 'val', this.wNamespace, listId.toString());\n    //         writer.writeEndElement();\n    //     }\n    //     writer.writeEndElement();\n    // }\n    WordExport.prototype.serializeParagraphAlignment = function (writer, txtAlignment) {\n        if (!isNullOrUndefined(txtAlignment)) {\n            writer.writeStartElement(undefined, 'jc', this.wNamespace);\n            var alignment = void 0;\n            switch (txtAlignment) {\n                case 'Center':\n                    alignment = 'center';\n                    break;\n                case 'Right':\n                    alignment = 'right';\n                    break;\n                case 'Justify':\n                    alignment = 'both';\n                    break;\n                default:\n                    alignment = 'left';\n                    break;\n            }\n            writer.writeAttributeString('w', 'val', this.wNamespace, alignment);\n            writer.writeEndElement();\n        }\n    };\n    // Serializes the paragraph spacings\n    WordExport.prototype.serializeParagraphSpacing = function (writer, paragraphFormat) {\n        writer.writeStartElement(undefined, 'spacing', this.wNamespace);\n        // if (paragraphFormat.HasValue(WParagraphFormat.BeforeLinesKey))\n        // {\n        //     short beforeLines = (short)Math.Round(paragraphFormat.BeforeLines * DLSConstants.HundredthsUnit);\n        //     writer.WriteAttributeString('beforeLines', this.wNamespace, ToString((float)beforeLines));               \n        // }\n        // if (paragraphFormat.HasValue(WParagraphFormat.AfterLinesKey))\n        // {\n        //     short afterLines = (short)Math.Round(paragraphFormat.AfterLines * DLSConstants.HundredthsUnit);\n        //     writer.WriteAttributeString('afterLines', this.wNamespace, ToString((float)afterLines));                 \n        // }\n        // tslint:disable-next-line:max-line-length\n        if (!isNullOrUndefined(paragraphFormat.beforeSpacing)) {\n            writer.writeAttributeString(undefined, 'before', this.wNamespace, this.roundToTwoDecimal(paragraphFormat.beforeSpacing * this.twentiethOfPoint).toString());\n        }\n        //TODO:ISSUEFIX(paragraphFormat.beforeSpacing * this.twentiethOfPoint).toString());\n        // if (paragraphFormat.HasValue(WParagraphFormat.SpacingBeforeAutoKey))\n        // {\n        //     if (paragraphFormat.SpaceBeforeAuto)\n        //     {\n        //         writer.WriteAttributeString('beforeAutospacing', this.wNamespace, '1');\n        //     }\n        //     else\n        //     {\n        //         writer.WriteAttributeString('beforeAutospacing', this.wNamespace, '0');\n        //     }\n        // }\n        if (!isNullOrUndefined(paragraphFormat.afterSpacing)) {\n            // tslint:disable-next-line:max-line-length\n            writer.writeAttributeString(undefined, 'after', this.wNamespace, this.roundToTwoDecimal(paragraphFormat.afterSpacing * this.twentiethOfPoint).toString());\n        }\n        //TODO:ISSUEFIX(paragraphFormat.afterSpacing * this.twentiethOfPoint).toString());\n        // if (paragraphFormat.HasValue(WParagraphFormat.SpacingAfterAutoKey))\n        // {\n        //     if (paragraphFormat.SpaceAfterAuto)\n        //     {\n        //         writer.WriteAttributeString('afterAutospacing', this.wNamespace, '1');\n        //     }\n        //     else\n        //     {\n        //         writer.WriteAttributeString('afterAutospacing', this.wNamespace, '0');\n        //     }\n        // }\n        writer.writeAttributeString(undefined, 'line', this.wNamespace, '240');\n        //TODO:ISSUEFIX((paragraphFormat.lineSpacing) * this.twentiethOfPoint).toString());\n        switch (paragraphFormat.lineSpacingType) {\n            case 'AtLeast':\n                writer.writeAttributeString(undefined, 'lineRule', this.wNamespace, 'atLeast');\n                break;\n            case 'Exactly':\n                writer.writeAttributeString(undefined, 'lineRule', this.wNamespace, 'exact');\n                break;\n            default:\n                writer.writeAttributeString(undefined, 'lineRule', this.wNamespace, 'auto');\n                break;\n        }\n        writer.writeEndElement();\n    };\n    // Serializes the paragraph indentation\n    WordExport.prototype.serializeIndentation = function (writer, paragraphFormat) {\n        writer.writeStartElement(undefined, 'ind', this.wNamespace);\n        if (!isNullOrUndefined(paragraphFormat.leftIndent)) {\n            // tslint:disable-next-line:max-line-length\n            writer.writeAttributeString(undefined, 'left', this.wNamespace, this.roundToTwoDecimal(paragraphFormat.leftIndent * this.twipsInOnePoint).toString());\n        }\n        if (!isNullOrUndefined(paragraphFormat.rightIndent)) {\n            // tslint:disable-next-line:max-line-length\n            writer.writeAttributeString(undefined, 'right', this.wNamespace, this.roundToTwoDecimal(paragraphFormat.rightIndent * this.twipsInOnePoint).toString());\n        }\n        if (!isNullOrUndefined(paragraphFormat.firstLineIndent)) {\n            if (paragraphFormat.firstLineIndent < 0) {\n                // tslint:disable-next-line:max-line-length\n                writer.writeAttributeString(undefined, 'hanging', this.wNamespace, this.roundToTwoDecimal(-1 * paragraphFormat.firstLineIndent * this.twipsInOnePoint).toString());\n            }\n            else {\n                // tslint:disable-next-line:max-line-length\n                writer.writeAttributeString(undefined, 'firstLine', this.wNamespace, this.roundToTwoDecimal(paragraphFormat.firstLineIndent * this.twipsInOnePoint).toString());\n            }\n        }\n        writer.writeEndElement();\n    };\n    // Serialize the styles (styles.xml)\n    WordExport.prototype.serializeStyles = function () {\n        var writer = new XmlWriter();\n        writer.writeStartElement('w', 'styles', this.wNamespace);\n        writer.writeAttributeString('xmlns', 'mc', undefined, this.veNamespace);\n        writer.writeAttributeString('xmlns', 'r', undefined, this.rNamespace);\n        writer.writeAttributeString('xmlns', 'w', undefined, this.wNamespace);\n        writer.writeAttributeString('xmlns', 'w14', undefined, this.w14Namespace);\n        writer.writeAttributeString('xmlns', 'w15', undefined, this.w15Namespace);\n        writer.writeAttributeString('mc', 'Ignorable', undefined, 'w14 w15');\n        //writes the document defaults, latent styles and default styles.\n        this.serializeDefaultStyles(writer);\n        //writes the document styles\n        this.serializeDocumentStyles(writer);\n        writer.writeEndElement(); //end of styles tag\n        var zipArchiveItem = new ZipArchiveItem(writer.buffer, this.stylePath);\n        this.mArchive.addItem(zipArchiveItem); //this.stylePath, styleStream, false, FileAttributes.Archive);\n    };\n    // Serializes the default styles (document default paragraph and character format)\n    WordExport.prototype.serializeDefaultStyles = function (writer) {\n        writer.writeStartElement(undefined, 'docDefaults', this.wNamespace);\n        //if (HasDefaultCharFormat())\n        //{\n        writer.writeStartElement(undefined, 'rPrDefault', this.wNamespace);\n        // if (!isNullOrUndefined(this.mDocument.characterFormat)) {\n        this.serializeCharacterFormat(writer, this.defCharacterFormat);\n        writer.writeEndElement(); // end of rPrDefault\n        // }\n        // else {\n        //     writer.writeStartElement(undefined, 'rPr', this.wNamespace);\n        //     writer.writeStartElement(undefined, 'rFonts', this.wNamespace);\n        //     if (!string.IsNullOrEmpty(m_document.StandardAsciiFont))\n        //         writer.WriteAttributeString('ascii', this.wNamespace, m_document.StandardAsciiFont);\n        //     if (!string.IsNullOrEmpty(m_document.StandardFarEastFont))\n        //         writer.WriteAttributeString('eastAsia', this.wNamespace, m_document.StandardFarEastFont);\n        //     if (!string.IsNullOrEmpty(m_document.StandardNonFarEastFont))\n        //         writer.WriteAttributeString('hAnsi', this.wNamespace, m_document.StandardNonFarEastFont);\n        //     if (!string.IsNullOrEmpty(m_document.StandardBidiFont))\n        //         writer.WriteAttributeString('cs', this.wNamespace, m_document.StandardBidiFont);\n        //     writer.WriteEndElement();\n        //     float fontSize = GetDefFontSize(m_document, WCharacterFormat.FontSizeKey);\n        //     if (fontSize !== 0f)\n        //     {\n        //         writer.WriteStartElement('sz', this.wNamespace);\n        //         writer.WriteAttributeString('val', this.wNamespace, (fontSize * 2).ToString(CultureInfo.InvariantCulture));\n        //         writer.WriteEndElement();\n        //     }\n        //     fontSize = GetDefFontSize(m_document, WCharacterFormat.FontSizeBidiKey);\n        //     if (fontSize !== 0f)\n        //     {\n        //         writer.WriteStartElement('szCs', this.wNamespace);\n        //         writer.WriteAttributeString('val', this.wNamespace, (fontSize * 2).ToString(CultureInfo.InvariantCulture));\n        //         writer.WriteEndElement();\n        //     }\n        //     writer.WriteEndElement();\n        // }\n        // writer.WriteEndElement();\n        // //}\n        writer.writeStartElement(undefined, 'pPrDefault', this.wNamespace);\n        if (!isNullOrUndefined(this.defParagraphFormat)) {\n            writer.writeStartElement(undefined, 'pPr', this.wNamespace);\n            this.serializeParagraphFormat(writer, this.defParagraphFormat, undefined);\n            writer.writeEndElement(); //end of pPr\n        }\n        writer.writeEndElement(); //end of pPrDefault\n        // writer.WriteEndElement();\n        // SerializeLatentStyles();\n        // //Default styles\n        // if (m_document.Styles.length === 0 || isNullOrUndefined(m_document.Styles.FindByName('Normal')))\n        // {\n        //     SerializeDefaultParagraphStyle();\n        // }\n        // if (!IsDocumentContainsDefaultTableStyle())\n        // {\n        //     SerializeTableNormalStyle();\n        // }\n        // if (isNullOrUndefined(m_document.Styles.FindByName('No List')) && isNullOrUndefined(m_document.Styles.FindByName('NoList')))\n        //     SerializeNoListStyle();\n        // tslint:disable-next-line:max-line-length\n        // if (isNullOrUndefined(m_document.Styles.FindByName('Table Grid')) && isNullOrUndefined(m_document.Styles.FindByName('TableGrid')))\n        // {\n        //     SerializeTableGridStyle();\n        // }\n        // }        \n        writer.writeEndElement();\n    };\n    WordExport.prototype.serializeDocumentStyles = function (writer) {\n        for (var i = 0; i < this.mStyles.length; i++) {\n            var style = this.mStyles[i];\n            writer.writeStartElement(undefined, 'style', this.wNamespace);\n            var type = style.type === 'Paragraph' ? 'paragraph' : 'character';\n            writer.writeAttributeString('w', 'type', this.wNamespace, type);\n            writer.writeAttributeString('w', 'styleId', this.wNamespace, style.name);\n            //name\n            writer.writeStartElement(undefined, 'name', this.wNamespace);\n            writer.writeAttributeString('w', 'val', this.wNamespace, style.name);\n            writer.writeEndElement();\n            //basedOn\n            if (!isNullOrUndefined(style.basedOn)) {\n                writer.writeStartElement(undefined, 'basedOn', this.wNamespace);\n                writer.writeAttributeString('w', 'val', this.wNamespace, style.basedOn);\n                writer.writeEndElement();\n            }\n            //next\n            if (!isNullOrUndefined(style.next)) {\n                writer.writeStartElement(undefined, 'next', this.wNamespace);\n                writer.writeAttributeString('w', 'val', this.wNamespace, style.next);\n                writer.writeEndElement();\n            }\n            //link\n            if (!isNullOrUndefined(style.link)) {\n                writer.writeStartElement(undefined, 'link', this.wNamespace);\n                writer.writeAttributeString('w', 'val', this.wNamespace, style.link);\n                writer.writeEndElement();\n            }\n            if (style.type === 'Paragraph') {\n                writer.writeStartElement(undefined, 'pPr', this.wNamespace);\n                this.serializeParagraphFormat(writer, style.paragraphFormat, undefined);\n                writer.writeEndElement();\n            }\n            // let value = (style.characterFormat as WCharacterFormat).newgetCharacterFormat();\n            this.serializeCharacterFormat(writer, style.characterFormat);\n            writer.writeEndElement(); //end of Style\n        }\n    };\n    // Serializes the Character format\n    WordExport.prototype.serializeCharacterFormat = function (writer, characterFormat) {\n        writer.writeStartElement(undefined, 'rPr', this.wNamespace);\n        if (!isNullOrUndefined(characterFormat.styleName)) {\n            writer.writeStartElement(undefined, 'rStyle', this.wNamespace);\n            writer.writeAttributeString('w', 'val', this.wNamespace, characterFormat.styleName);\n            writer.writeEndElement();\n        }\n        if (!isNullOrUndefined(characterFormat.fontFamily)) {\n            writer.writeStartElement(undefined, 'rFonts', this.wNamespace);\n            writer.writeAttributeString(undefined, 'ascii', this.wNamespace, characterFormat.fontFamily);\n            writer.writeAttributeString(undefined, 'hAnsi', this.wNamespace, characterFormat.fontFamily);\n            writer.writeAttributeString(undefined, 'eastAsia', this.wNamespace, characterFormat.fontFamily);\n            writer.writeAttributeString(undefined, 'cs', this.wNamespace, characterFormat.fontFamily);\n            writer.writeEndElement(); //end         \n        }\n        if (!isNullOrUndefined(characterFormat.bold)) {\n            this.serializeBoolProperty(writer, 'b', characterFormat.bold);\n        }\n        if (!isNullOrUndefined(characterFormat.italic)) {\n            this.serializeBoolProperty(writer, 'i', characterFormat.italic);\n        }\n        if (!isNullOrUndefined(characterFormat.strikethrough)) {\n            switch (characterFormat.strikethrough) {\n                case 'SingleStrike':\n                    this.serializeBoolProperty(writer, 'strike', true);\n                    break;\n                case 'DoubleStrike':\n                    this.serializeBoolProperty(writer, 'dstrike', true);\n                    break;\n                default:\n                    this.serializeBoolProperty(writer, 'strike', false);\n                    this.serializeBoolProperty(writer, 'dstrike', false);\n                    break;\n            }\n        }\n        if (!isNullOrUndefined(characterFormat.fontColor)) {\n            writer.writeStartElement(undefined, 'color', this.wNamespace);\n            writer.writeAttributeString('w', 'val', this.wNamespace, this.getColor(characterFormat.fontColor));\n            writer.writeEndElement();\n        }\n        if (!isNullOrUndefined(characterFormat.fontSize)) {\n            writer.writeStartElement(undefined, 'sz', this.wNamespace);\n            // tslint:disable-next-line:max-line-length\n            writer.writeAttributeString('w', 'val', this.wNamespace, this.roundToTwoDecimal(characterFormat.fontSize * 2).toString());\n            writer.writeEndElement();\n        }\n        if (!isNullOrUndefined(characterFormat.highlightColor) && characterFormat.highlightColor !== 'NoColor') {\n            writer.writeStartElement(undefined, 'highlight', this.wNamespace);\n            writer.writeAttributeString('w', 'val', this.wNamespace, this.getHighlightColor(characterFormat.highlightColor));\n            writer.writeEndElement();\n        }\n        if (!isNullOrUndefined(characterFormat.underline) && characterFormat.underline !== 'None') {\n            writer.writeStartElement(undefined, 'u', this.wNamespace);\n            writer.writeAttributeString('w', 'val', this.wNamespace, this.getUnderlineStyle(characterFormat.underline));\n            writer.writeEndElement();\n        }\n        if (!isNullOrUndefined(characterFormat.baselineAlignment)) {\n            writer.writeStartElement(undefined, 'vertAlign', this.wNamespace);\n            switch (characterFormat.baselineAlignment) {\n                case 'Subscript':\n                    writer.writeAttributeString('w', 'val', this.wNamespace, 'subscript');\n                    break;\n                case 'Superscript':\n                    writer.writeAttributeString('w', 'val', this.wNamespace, 'superscript');\n                    break;\n                default:\n                    writer.writeAttributeString('w', 'val', this.wNamespace, 'baseline');\n                    break;\n            }\n            writer.writeEndElement();\n        }\n        writer.writeEndElement(); //end of rPrChange\n    };\n    WordExport.prototype.getColor = function (color) {\n        if (color.length > 0) {\n            if (color[0] === '#') {\n                color = color.substr(1);\n            }\n            if (color.length > 6) {\n                color = color.substr(0, 6);\n            }\n        }\n        return color;\n    };\n    // Get the underline style as string\n    WordExport.prototype.getUnderlineStyle = function (underlineStyle) {\n        switch (underlineStyle) {\n            case 'DotDotDashHeavy':\n                return 'dashDotDotHeavy';\n            case 'DotDashHeavy':\n                return 'dashDotHeavy';\n            case 'DashHeavy':\n                return 'dashedHeavy';\n            case 'DashLong':\n                return 'dashLong';\n            case 'DashLongHeavy':\n                return 'dashLongHeavy';\n            case 'DotDash':\n                return 'dotDash';\n            case 'DotDotDash':\n                return 'dotDotDash';\n            case 'Dotted':\n                return 'dotted';\n            case 'DottedHeavy':\n                return 'dottedHeavy';\n            case 'Double':\n                return 'double';\n            case 'Single':\n                return 'single';\n            case 'Thick':\n                return 'thick';\n            case 'Wavy':\n                return 'wave';\n            case 'WavyDouble':\n                return 'wavyDouble';\n            case 'WavyHeavy':\n                return 'wavyHeavy';\n            case 'Words':\n                return 'words';\n            default:\n                return 'dash';\n        }\n    };\n    WordExport.prototype.getHighlightColor = function (highlight) {\n        switch (highlight) {\n            // Highlights the content with bright green (#ff00ff00) color.\n            case 'BrightGreen':\n                return 'green';\n            // Highlights the content with turquoise (#ff00ffff) color.\n            case 'Turquoise':\n                return 'cyan';\n            // Highlights the content with pink (#ffff00ff) color.\n            case 'Pink':\n                return 'magenta';\n            // Highlights the content with blue (#ff0000ff) color.\n            case 'Blue':\n                return 'blue';\n            // Highlights the content with red (#ffff0000) color.\n            case 'Red':\n                return 'red';\n            // Highlights the content with dark blue (#ff000080) color.\n            case 'DarkBlue':\n                return 'darkBlue';\n            // Highlights the content with teal (#ff008080) color.\n            case 'Teal':\n                return 'darkCyan';\n            // Highlights the content with green (#ff008000) color.\n            case 'Green':\n                return 'darkGreen';\n            // Highlights the content with violet (#ff800080) color.\n            case 'Violet':\n                return 'darkMagenta';\n            // Highlights the content with dark red (#ff800000) color.\n            case 'DarkRed':\n                return 'darkRed';\n            // Highlights the content with dark yellow (#ff808000)  color.\n            case 'DarkYellow':\n                return 'darkYellow';\n            // Highlights the content with gray 50 (#ff808080) color.\n            case 'Gray50':\n                return 'darkGray';\n            // Highlights the content with gray 25 (#ffc0c0c0) color.\n            case 'Gray25':\n                return 'lightGray';\n            // Highlights the content with black (#ff000000) color.\n            case 'Black':\n                return 'black';\n            // Highlights the content with yellow (#ffffff00) color.\n            default:\n                return 'yellow';\n        }\n    };\n    /*private toggleFirstCahar(text: string) {\n        return text.charAt(0).toLowerCase() + text.slice(1);\n    }*/\n    // Serializes the bool character format property\n    WordExport.prototype.serializeBoolProperty = function (writer, tag, value) {\n        writer.writeStartElement(undefined, tag, this.wNamespace);\n        if (!value) {\n            writer.writeAttributeString(undefined, 'val', this.wNamespace, '0');\n        }\n        writer.writeEndElement();\n    };\n    // Serialize the list styles and numberings (numberings.xml)\n    WordExport.prototype.serializeNumberings = function () {\n        if (this.document.lists.length === 0) {\n            return;\n        }\n        var writer = new XmlWriter();\n        writer.writeStartElement('w', 'numbering', this.wNamespace);\n        this.writeCommonAttributeStrings(writer);\n        // this.serializePictureBullets(writer, this.mDocument.lists);\n        this.serializeAbstractListStyles(writer, this.document.abstractLists);\n        this.serializeListInstances(writer, this.document.lists);\n        // SerializeListOverrides(writer, this.mDocument.ridesm_document.ListOverrides);\n        writer.writeEndElement();\n        var zipArchiveItem = new ZipArchiveItem(writer.buffer, this.numberingPath);\n        this.mArchive.addItem(zipArchiveItem);\n    };\n    // Serializes the abstract list styles\n    WordExport.prototype.serializeAbstractListStyles = function (writer, listStyles) {\n        for (var i = 0; i < listStyles.length; i++) {\n            var abstractList = listStyles[i];\n            writer.writeStartElement(undefined, 'abstractNum', this.wNamespace);\n            writer.writeAttributeString(undefined, 'abstractNumId', this.wNamespace, abstractList.abstractListId.toString());\n            writer.writeStartElement(undefined, 'nsid', this.wNamespace);\n            writer.writeAttributeString(undefined, 'val', this.wNamespace, this.generateHex());\n            writer.writeEndElement();\n            for (var ilvl = 0, cnt = abstractList.levels.length; ilvl < cnt; ilvl++) {\n                this.serializeListLevel(writer, abstractList.levels[ilvl], ilvl);\n            }\n            writer.writeEndElement(); //end of abstractNum\n        }\n    };\n    // Serializes the list styles\n    WordExport.prototype.serializeListInstances = function (writer, listStyles) {\n        for (var i = 0; i < listStyles.length; i++) {\n            var list = listStyles[i];\n            writer.writeStartElement(undefined, 'num', this.wNamespace);\n            writer.writeAttributeString(undefined, 'numId', this.wNamespace, (list.listId + 1).toString());\n            writer.writeStartElement(undefined, 'abstractNumId', this.wNamespace);\n            writer.writeAttributeString(undefined, 'val', this.wNamespace, list.abstractListId.toString());\n            writer.writeEndElement();\n            writer.writeEndElement();\n        }\n    };\n    WordExport.prototype.generateHex = function () {\n        return (Math.floor(Math.random() * (4000000000 - 270000000)) + 270000000).toString(16).toUpperCase();\n    };\n    WordExport.prototype.roundToTwoDecimal = function (num) {\n        return Math.round(num); // * 100) / 100;\n    };\n    // Serialize the list level\n    WordExport.prototype.serializeListLevel = function (writer, listLevel, levelIndex) {\n        writer.writeStartElement(undefined, 'lvl', this.wNamespace);\n        writer.writeAttributeString(undefined, 'ilvl', this.wNamespace, levelIndex.toString());\n        writer.writeStartElement(undefined, 'start', this.wNamespace);\n        writer.writeAttributeString(undefined, 'val', this.wNamespace, listLevel.startAt.toString());\n        writer.writeEndElement();\n        writer.writeStartElement(undefined, 'numFmt', this.wNamespace);\n        writer.writeAttributeString(undefined, 'val', this.wNamespace, this.getLevelPattern(listLevel.listLevelPattern));\n        writer.writeEndElement();\n        if (listLevel.restartLevel > 0) {\n            writer.writeStartElement(undefined, 'lvlRestart', this.wNamespace);\n            writer.writeAttributeString(undefined, 'val', this.wNamespace, '0');\n            writer.writeEndElement();\n        }\n        // if (!isNullOrUndefined(listLevel.paragraphFormat)) {\n        //     string name = listLevel.ParaStyleName.Substring(0, 1).ToUpper() + listLevel.ParaStyleName.Remove(0, 1);\n        //     writer.WriteStartElement('pStyle', this.wNamespace);\n        //     writer.WriteAttributeString('val', this.wNamespace, name);\n        //     writer.WriteEndElement();\n        // }\n        // if (listLevel.IsLegalStyleNumbering) {\n        //     writer.WriteStartElement('isLgl', this.wNamespace);\n        //     writer.WriteEndElement();\n        // }\n        this.serializeLevelFollow(writer, listLevel);\n        this.serializeLevelText(writer, listLevel, levelIndex + 1);\n        // SerializeLegacyProperties(listLevel);\n        // if (listLevel.PicBulletId > 0) {\n        //     writer.WriteStartElement('lvlPicBulletId', this.wNamespace);\n        //     writer.WriteAttributeString('val', this.wNamespace, listLevel.PicBulletId.ToString());\n        //     writer.WriteEndElement();\n        // }\n        // //lvlJc\n        // if (listLevel.NumberAlignment !== ListNumberAlignment.Left) {\n        //     writer.WriteStartElement('lvlJc', this.wNamespace);\n        //     string alignment = string.Empty;\n        //     if (listLevel.NumberAlignment === ListNumberAlignment.Right) {\n        //         alignment = 'right';\n        //     }\n        //     else {\n        //         alignment = 'center';\n        //     }\n        //     writer.WriteAttributeString('val', this.wNamespace, alignment);\n        //     writer.WriteEndElement();\n        // }\n        writer.writeStartElement(undefined, 'pPr', this.wNamespace);\n        this.serializeParagraphFormat(writer, listLevel.paragraphFormat, undefined);\n        writer.writeEndElement(); //end of pPr\n        this.serializeCharacterFormat(writer, listLevel.characterFormat);\n        writer.writeEndElement();\n    };\n    WordExport.prototype.getLevelPattern = function (levelPattern) {\n        var patternType;\n        switch (levelPattern) {\n            case 'Arabic':\n                patternType = 'decimal';\n                break;\n            case 'UpRoman':\n                patternType = 'upperRoman';\n                break;\n            case 'LowRoman':\n                patternType = 'lowerRoman';\n                break;\n            case 'UpLetter':\n                patternType = 'upperLetter';\n                break;\n            case 'LowLetter':\n                patternType = 'lowerLetter';\n                break;\n            // case 'Ordinal':\n            //     patternType = 'ordinal';\n            //     break;\n            // case 'Number':\n            //     patternType = 'cardinalText';\n            //     break;\n            // case 'OrdinalText':\n            //     patternType = 'ordinalText';\n            //     break;\n            // case 'LeadingZero':\n            //     patternType = 'decimalZero';\n            //     break;\n            // case 'Bullet':\n            default:\n                patternType = 'bullet';\n                break;\n        }\n        return patternType;\n    };\n    // Serializes the level text\n    WordExport.prototype.serializeLevelText = function (writer, listLevel, lvlIndex) {\n        writer.writeStartElement(undefined, 'lvlText', this.wNamespace);\n        writer.writeAttributeString(undefined, 'val', this.wNamespace, (listLevel.numberFormat));\n        writer.writeEndElement();\n    };\n    // Serialize the level follow character\n    WordExport.prototype.serializeLevelFollow = function (writer, listLevel) {\n        var fc;\n        //TODO:Type issue returns number instead of string\n        if (listLevel.followCharacter === 'Tab') {\n            fc = 'tab';\n        }\n        else if (listLevel.followCharacter === 'Space') {\n            fc = 'space';\n        }\n        else {\n            fc = 'nothing';\n        }\n        writer.writeStartElement(undefined, 'suff', this.wNamespace);\n        writer.writeAttributeString(undefined, 'val', this.wNamespace, fc);\n        writer.writeEndElement();\n    };\n    WordExport.prototype.serializeSettings = function () {\n        var writer = new XmlWriter();\n        writer.writeStartElement('w', 'settings', this.wNamespace);\n        this.writeCustom(writer);\n        // writer.writeAttributeString('xmlns', 'mc', undefined, this.veNamespace);\n        // writer.writeAttributeString('xmlns', 'o', undefined, this.oNamespace);\n        // writer.writeAttributeString('xmlns', 'r', undefined, this.rNamespace);\n        // writer.writeAttributeString('xmlns', 'm', undefined, this.mNamespace);\n        // writer.writeAttributeString('xmlns', 'v', undefined, this.vNamespace);\n        writer.writeAttributeString('xmlns', 'w10', undefined, this.w10Namespace);\n        writer.writeAttributeString('xmlns', 'w14', undefined, this.w14Namespace);\n        writer.writeAttributeString('xmlns', 'w15', undefined, this.w15Namespace);\n        writer.writeAttributeString('xmlns', 'sl', undefined, this.slNamespace);\n        writer.writeAttributeString('mc', 'Ignorable', undefined, 'w14 w15');\n        // //w:writeProtection - Write Protection\n        // if (m_document.WriteProtected)\n        // {\n        //     writer.writeStartElement('w', 'writeProtection', this.wNamespace);\n        //     writer.writeAttributeString('recommended', this.wNamespace, '1');\n        //     writer.writeEndElement();\n        // }\n        //w:view - Document View Setting\n        // if (this.mDocument.ViewSetup.DocumentViewType !== DocumentViewType.PrintLayout &&\n        //   m_document.ViewSetup.DocumentViewType !== DocumentViewType.NormalLayout)\n        // {\n        //     writer.writeStartElement('view', this.wNamespace);\n        //     string viewTypeStr = string.Empty;\n        //     if (m_document.ViewSetup.DocumentViewType === DocumentViewType.OutlineLayout)\n        //     {\n        //         viewTypeStr = 'outline';\n        //     }\n        //     else if (m_document.ViewSetup.DocumentViewType === DocumentViewType.WebLayout)\n        //     {\n        //         viewTypeStr = 'web';\n        //     }\n        //     writer.writeAttributeString('val', this.wNamespace, viewTypeStr);\n        //     writer.writeEndElement();\n        // }\n        //w:zoom - Magnification Setting\n        writer.writeStartElement('w', 'zoom', this.wNamespace);\n        // switch (m_document.ViewSetup.ZoomType)\n        // {\n        //     case ZoomType.FullPage:\n        //         writer.writeAttributeString('w', 'val', this.wNamespace, 'fullPage');\n        //         break;\n        //     case ZoomType.PageWidth:\n        //         writer.writeAttributeString('w', 'val', this.wNamespace, 'bestFit');\n        //         break;\n        //     case ZoomType.TextFit:\n        //         writer.writeAttributeString('w', 'val', this.wNamespace, 'textFit');\n        //         break;\n        // default:\n        writer.writeAttributeString('w', 'val', this.wNamespace, 'none');\n        // break;\n        // }\n        writer.writeAttributeString('w', 'percent', this.wNamespace, '100');\n        writer.writeEndElement();\n        //w:displayBackgroundShape - Display Background Objects When Displaying Document\n        // if (m_document.Background.Type !== BackgroundType.NoBackground)\n        // {\n        writer.writeStartElement(undefined, 'displayBackgroundShape', this.wNamespace);\n        writer.writeEndElement();\n        // }\n        //w:defaultTabStop - Distance Between Automatic Tab Stops\n        writer.writeStartElement(undefined, 'defaultTabStop', this.wNamespace);\n        var tabWidth = Math.round(this.defaultTabWidthValue * this.twipsInOnePoint);\n        writer.writeAttributeString(undefined, 'val', this.wNamespace, tabWidth.toString());\n        writer.writeEndElement();\n        //w:evenAndOddHeaders - Different Even/Odd Page Headers and Footers        \n        if (this.mDifferentFirstPage) {\n            writer.writeStartElement(undefined, 'evenAndOddHeaders', this.wNamespace);\n            writer.writeEndElement();\n        }\n        //w:footnotePr - Document-Wide Footnote Properties and w:endnotePr - Document-Wide Endnote Properties\n        // SerializeFootnoteSettings();\n        //w:compat - Compatibility Settings\n        writer.writeStartElement(undefined, 'compat', this.wNamespace);\n        writer.writeStartElement(undefined, 'compatSetting', this.wNamespace);\n        writer.writeAttributeString(undefined, 'name', this.wNamespace, 'compatibilityMode');\n        writer.writeAttributeString(undefined, 'uri', this.wNamespace, 'http://schemas.microsoft.com/office/word');\n        writer.writeAttributeString(undefined, 'val', this.wNamespace, '15');\n        writer.writeEndElement();\n        writer.writeEndElement();\n        writer.writeEndElement();\n        var zipArchiveItem = new ZipArchiveItem(writer.buffer, this.settingsPath);\n        this.mArchive.addItem(zipArchiveItem);\n    };\n    WordExport.prototype.serializeCoreProperties = function () {\n        //implementation\n    };\n    WordExport.prototype.serializeAppProperties = function () {\n        //implementation\n    };\n    WordExport.prototype.serializeFontTable = function (contentType) {\n        //implementation\n    };\n    WordExport.prototype.serializeSettingsRelation = function () {\n        //implementation\n    };\n    WordExport.prototype.serializeHeaderFooters = function () {\n        this.serializeHeaderFooter('EvenFooter');\n        this.serializeHeaderFooter('EvenHeader');\n        this.serializeHeaderFooter('FirstPageFooter');\n        this.serializeHeaderFooter('FirstPageHeader');\n        this.serializeHeaderFooter('OddFooter');\n        this.serializeHeaderFooter('OddHeader');\n    };\n    // Serializes the Header/Footer\n    WordExport.prototype.serializeHeaderFooter = function (hfType) {\n        if (this.headersFooters.length === 0) {\n            return;\n        }\n        var headerFooterPath;\n        var headerFooterRelsPath;\n        if (!this.headersFooters.containsKey(hfType)) {\n            return;\n        }\n        var hfColl = this.headersFooters.get(hfType);\n        var hf = undefined;\n        for (var i = 0; i < hfColl.keys.length; i++) {\n            var id = hfColl.keys[i];\n            hf = hfColl.get(id);\n            if (hfType === 'EvenHeader' || hfType === 'FirstPageHeader' ||\n                hfType === 'OddHeader') {\n                headerFooterPath = this.headerPath + id.replace('rId', '') + '.xml';\n                headerFooterRelsPath = this.headerRelationPath + id.replace('rId', '') + '.xml.rels';\n                this.serializeHeader(hf, id, headerFooterPath, headerFooterRelsPath);\n            }\n            else {\n                headerFooterPath = this.footerPath + id.replace('rId', '') + '.xml';\n                headerFooterRelsPath = this.footerRelationPath + id.replace('rId', '') + '.xml.rels';\n                this.serializeFooter(hf, id, headerFooterPath, headerFooterRelsPath);\n            }\n        }\n    };\n    // Serialize the header part\n    WordExport.prototype.serializeHeader = function (header, id, headerFooterPath, headerFooterRelsPath) {\n        this.headerFooter = header;\n        var writer = new XmlWriter();\n        writer.writeStartElement('w', 'hdr', this.wNamespace);\n        this.writeHFCommonAttributes(writer);\n        var owner = this.blockOwner;\n        this.blockOwner = header;\n        this.serializeBodyItems(writer, header.blocks, true);\n        this.blockOwner = owner;\n        writer.writeEndElement();\n        var zipArchiveItem = new ZipArchiveItem(writer.buffer, headerFooterPath);\n        this.mArchive.addItem(zipArchiveItem);\n        this.serializeHFRelations(id, headerFooterRelsPath);\n        this.headerFooter = undefined;\n    };\n    // Serializes the HeaderFooter relations\n    WordExport.prototype.serializeHFRelations = function (hfId, headerFooterRelsPath) {\n        var hasHFImage = this.headerFooterImages.containsKey(hfId);\n        // let hasHFHyperlinks = HeaderFooterHyperlinks.ContainsKey(hfId);\n        // let hasHFInclPics = HeaderFooterInclPicUrls.ContainsKey(hfId);\n        // let hasHFAlternateChunks = HeaderFooterAlternateChunks.ContainsKey(hfId);\n        if (hasHFImage) {\n            var writer = new XmlWriter();\n            writer.writeStartElement(undefined, 'Relationships', this.rpNamespace);\n            this.serializeImagesRelations(this.headerFooterImages.get(hfId), writer);\n            // if (hasHFHyperlinks)\n            //     SerializeHyperlinkRelations(stream, HeaderFooterHyperlinks[hfId]);\n            // if (hasHFAlternateChunks)\n            //     SerializeAltChunkRelations(stream, HeaderFooterAlternateChunks[hfId]);\n            // if (hasHFInclPics)\n            //     SerializeIncludePictureUrlRelations(stream, HeaderFooterInclPicUrls[hfId]);\n            // if (HFOleContainers.ContainsKey(hfId))\n            // {\n            //     AddOLEToZip(HFOleContainers[hfId]);\n            // }\n            // if (HFRelations.ContainsKey(hfId))\n            //     SerializeHFCommonRelations(stream, HFRelations[hfId]);\n            writer.writeEndElement();\n            var zipArchiveItem = new ZipArchiveItem(writer.buffer, headerFooterRelsPath);\n            this.mArchive.addItem(zipArchiveItem);\n        }\n        else {\n            return;\n        }\n    };\n    WordExport.prototype.writeHFCommonAttributes = function (writer) {\n        writer.writeAttributeString('xmlns', 'v', undefined, this.vNamespace);\n        writer.writeAttributeString('xmlns', 'w10', undefined, this.w10Namespace);\n        writer.writeAttributeString('xmlns', 'o', undefined, this.oNamespace);\n        writer.writeAttributeString('xmlns', 've', undefined, this.veNamespace);\n        writer.writeAttributeString('xmlns', 'r', undefined, this.rNamespace);\n        writer.writeAttributeString('xmlns', 'm', undefined, this.mNamespace);\n        writer.writeAttributeString('xmlns', 'wne', undefined, this.wneNamespace);\n        writer.writeAttributeString('xmlns', 'a', undefined, this.aNamespace);\n        writer.writeAttributeString('xmlns', 'pic', undefined, this.pictureNamespace);\n        writer.writeAttributeString('xmlns', 'wp', undefined, this.wpNamespace);\n        writer.writeAttributeString('xmlns', 'wpc', undefined, this.wpCanvasNamespace);\n        writer.writeAttributeString('xmlns', 'wp14', undefined, this.wpDrawingNamespace);\n        this.writeDup(writer);\n        writer.writeAttributeString('xmlns', 'wps', undefined, this.wpShapeNamespace);\n        writer.writeAttributeString('ve', 'Ignorable', undefined, 'w14 w15 wp14');\n    };\n    // Serailize the footer and its relations\n    WordExport.prototype.serializeFooter = function (footer, id, headerFooterPath, headerFooterRelsPath) {\n        this.headerFooter = footer;\n        var writer = new XmlWriter();\n        writer.writeStartElement('w', 'ftr', this.wNamespace);\n        this.writeHFCommonAttributes(writer);\n        this.serializeBodyItems(writer, footer.blocks, true);\n        writer.writeEndElement();\n        var zipArchiveItem = new ZipArchiveItem(writer.buffer, headerFooterPath);\n        this.mArchive.addItem(zipArchiveItem);\n        this.serializeHFRelations(id, headerFooterRelsPath);\n    };\n    WordExport.prototype.serializeDocumentRelations = function () {\n        var writer = new XmlWriter();\n        writer.writeStartElement(undefined, 'Relationships', this.rpNamespace);\n        this.serializeRelationShip(writer, this.getNextRelationShipID(), this.stylesRelType, 'styles.xml');\n        this.serializeRelationShip(writer, this.getNextRelationShipID(), this.settingsRelType, 'settings.xml');\n        // this.serializeRelationShip(writer, this.getNextRelationShipID(), this.ThemeRelType, 'theme/theme1.xml');\n        if (this.document.lists.length > 0) {\n            this.serializeRelationShip(writer, this.getNextRelationShipID(), this.numberingRelType, 'numbering.xml');\n        }\n        this.serializeHeaderFooterRelations(writer);\n        // if (HasFontTable) {\n        //     SerializeRelationShip(docRelstream, GetNextRelationShipID(), this.FontTableRelType, 'fontTable.xml');\n        // }\n        // SerializeIncludePictureUrlRelations(docRelstream, InclPicFieldUrl);\n        // //// Creating relationships for every hyperlink and image containing in the document\n        this.serializeImagesRelations(this.documentImages, writer);\n        // SerializeSvgImageRelation();\n        //this.serializeExternalLinkImages(writer);\n        // if (HasHyperlink && HyperlinkTargets.length > 0) {\n        //     SerializeHyperlinkRelations(docRelstream, HyperlinkTargets);\n        // }\n        // if (m_document.HasMacros\n        //     && IsMacroEnabled)\n        //     SerializeRelationShip(docRelstream, GetNextRelationShipID(), this.VbaProjectRelType, this.VbaProject);\n        writer.writeEndElement();\n        var zipArchiveItem = new ZipArchiveItem(writer.buffer, this.wordRelationPath);\n        this.mArchive.addItem(zipArchiveItem);\n        this.headerFooter = undefined;\n    };\n    // Serializes the image relations\n    WordExport.prototype.serializeImagesRelations = function (images, writer) {\n        if (images.length > 0) {\n            var imagePath = '';\n            var base64ImageString = void 0;\n            var keys = images.keys;\n            for (var i = 0; i < keys.length; i++) {\n                var mImage = images.get(keys[i]);\n                base64ImageString = mImage.imageString;\n                if (isNullOrUndefined(base64ImageString)) {\n                    imagePath = this.imagePath + '/0.jpeg';\n                    this.serializeRelationShip(writer, keys[i], this.imageRelType, imagePath.replace('word/', ''));\n                }\n                else {\n                    var extension = '';\n                    var formatClippedString = '';\n                    if (this.startsWith(base64ImageString, 'data:image/bmp;base64,')) {\n                        extension = '.bmp';\n                        formatClippedString = base64ImageString.replace('data:image/bmp;base64,', '');\n                    }\n                    else if (this.startsWith(base64ImageString, 'data:image/x-emf;base64,')) {\n                        extension = '.emf';\n                        formatClippedString = base64ImageString.replace('data:image/x-emf;base64,', '');\n                    }\n                    else if (this.startsWith(base64ImageString, 'data:image/exif;base64,')) {\n                        extension = '.exif';\n                        formatClippedString = base64ImageString.replace('data:image/exif;base64,', '');\n                    }\n                    else if (this.startsWith(base64ImageString, 'data:image/gif;base64,')) {\n                        extension = '.gif';\n                        formatClippedString = base64ImageString.replace('data:image/gif;base64,', '');\n                    }\n                    else if (this.startsWith(base64ImageString, 'data:image/icon;base64,')) {\n                        extension = '.ico';\n                        formatClippedString = base64ImageString.replace('data:image/icon;base64,', '');\n                    }\n                    else if (this.startsWith(base64ImageString, 'data:image/jpeg;base64,')) {\n                        extension = '.jpeg';\n                        formatClippedString = base64ImageString.replace('data:image/jpeg;base64,', '');\n                    }\n                    else if (this.startsWith(base64ImageString, 'data:image/jpg;base64,')) {\n                        extension = '.jpg';\n                        formatClippedString = base64ImageString.replace('data:image/jpg;base64,', '');\n                    }\n                    else if (this.startsWith(base64ImageString, 'data:image/png;base64,')) {\n                        extension = '.png';\n                        formatClippedString = base64ImageString.replace('data:image/png;base64,', '');\n                    }\n                    else if (this.startsWith(base64ImageString, 'data:image/tiff;base64,')) {\n                        extension = '.tif';\n                        formatClippedString = base64ImageString.replace('data:image/tiff;base64,', '');\n                    }\n                    else if (this.startsWith(base64ImageString, 'data:image/x-wmf;base64,')) {\n                        extension = '.wmf';\n                        formatClippedString = base64ImageString.replace('data:image/x-wmf;base64,', '');\n                    }\n                    else {\n                        extension = '.jpeg';\n                    }\n                    imagePath = this.imagePath + keys[i] + extension;\n                    this.serializeRelationShip(writer, keys[i], this.imageRelType, imagePath.replace('word/', ''));\n                    //if (m_archive.Find(imagePath.Replace('\\\\', '/')) === -1)\n                    // {\n                    var imageBlob = new Blob([this.encodedString(formatClippedString)]);\n                    var zipArchiveItem = new ZipArchiveItem(imageBlob, imagePath);\n                    // let TestArchive = new ZipArchive();\n                    this.mArchive.addItem(zipArchiveItem);\n                    // TestArchive.save('image.zip').then(function (): void {\n                    //     TestArchive.destroy();\n                    // });\n                    // }\n                }\n            }\n        }\n    };\n    /**\n     * @private\n     */\n    WordExport.prototype.encodedString = function (input) {\n        var keyStr = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=';\n        var chr1;\n        var chr2;\n        var chr3;\n        var enc1;\n        var enc2;\n        var enc3;\n        var enc4;\n        var i = 0;\n        var resultIndex = 0;\n        /*let dataUrlPrefix: string = 'data:';*/\n        input = input.replace(/[^A-Za-z0-9\\+\\/\\=]/g, '');\n        var totalLength = input.length * 3 / 4;\n        if (input.charAt(input.length - 1) === keyStr.charAt(64)) {\n            totalLength--;\n        }\n        if (input.charAt(input.length - 2) === keyStr.charAt(64)) {\n            totalLength--;\n        }\n        if (totalLength % 1 !== 0) {\n            // totalLength is not an integer, the length does not match a valid\n            // base64 content. That can happen if:\n            // - the input is not a base64 content\n            // - the input is *almost* a base64 content, with a extra chars at the\n            // beginning or at the end\n            // - the input uses a base64 variant (base64url for example)\n            throw new Error('Invalid base64 input, bad content length.');\n        }\n        var output = new Uint8Array(totalLength | 0);\n        while (i < input.length) {\n            enc1 = keyStr.indexOf(input.charAt(i++));\n            enc2 = keyStr.indexOf(input.charAt(i++));\n            enc3 = keyStr.indexOf(input.charAt(i++));\n            enc4 = keyStr.indexOf(input.charAt(i++));\n            chr1 = (enc1 << 2) | (enc2 >> 4);\n            chr2 = ((enc2 & 15) << 4) | (enc3 >> 2);\n            chr3 = ((enc3 & 3) << 6) | enc4;\n            output[resultIndex++] = chr1;\n            if (enc3 !== 64) {\n                output[resultIndex++] = chr2;\n            }\n            if (enc4 !== 64) {\n                output[resultIndex++] = chr3;\n            }\n        }\n        return output;\n    };\n    WordExport.prototype.serializeExternalLinkImages = function (writer) {\n        var imagePath = '';\n        var keys = this.externalImages.keys;\n        for (var i = 0; i < this.externalImages.keys.length; i++) {\n            this.serializeRelationShip(writer, keys[i], this.imageRelType, this.externalImages.get(keys[i]));\n        }\n    };\n    // Serializes the HeaderFooters relations to the document relations stream\n    WordExport.prototype.serializeHeaderFooterRelations = function (writer) {\n        this.serializeHFRelation(writer, 'EvenFooter');\n        this.serializeHFRelation(writer, 'EvenHeader');\n        this.serializeHFRelation(writer, 'FirstPageFooter');\n        this.serializeHFRelation(writer, 'FirstPageHeader');\n        this.serializeHFRelation(writer, 'OddFooter');\n        this.serializeHFRelation(writer, 'OddHeader');\n    };\n    // Serializes the headers footers relations.\n    WordExport.prototype.serializeHFRelation = function (writer, hfType) {\n        var headerFooterPath = '';\n        var relType;\n        if (!this.headersFooters.containsKey(hfType)) {\n            return;\n        }\n        var hfColl = this.headersFooters.get(hfType);\n        for (var i = 0; i < hfColl.keys.length; i++) {\n            var id = hfColl.keys[i];\n            if (hfType === 'EvenHeader' || hfType === 'FirstPageHeader' ||\n                hfType === 'OddHeader') {\n                headerFooterPath = 'header' + id.replace('rId', '') + '.xml';\n                relType = this.headerRelType;\n            }\n            else {\n                headerFooterPath = 'footer' + id.replace('rId', '') + '.xml';\n                relType = this.footerRelType;\n            }\n            this.serializeRelationShip(writer, id, relType, headerFooterPath);\n        }\n    };\n    // Serializes the relationship\n    WordExport.prototype.serializeRelationShip = function (writer, relationshipID, relationshipType, targetPath) {\n        writer.writeStartElement(undefined, 'Relationship', undefined);\n        writer.writeAttributeString(undefined, 'Id', undefined, relationshipID);\n        writer.writeAttributeString(undefined, 'Type', undefined, relationshipType);\n        writer.writeAttributeString(undefined, 'Target', undefined, targetPath.replace('\\\\', '/').replace('\\v', ''));\n        // tslint:disable-next-line:max-line-length\n        if (relationshipType === this.hyperlinkRelType || this.startsWith(targetPath, 'http://') || this.startsWith(targetPath, 'https://') || this.startsWith(targetPath, 'file:///')) {\n            // Uri targetUri;\n            // if ((!targetPath.StartsWith('file:///')) && Uri.TryCreate(targetPath, UriKind.Absolute, out targetUri))\n            // {\n            //     //Handled using Try catch to avoid exception if the Host name type is None because in \n            //Silverlight 'HostNameType' property is not available.\n            //     try\n            //     {\n            //         m_writer.WriteAttributeString('Target', targetUri.AbsoluteUri);\n            //     }\n            //     catch\n            //     {\n            //         m_writer.WriteAttributeString('Target', targetPath.Replace('\\\\', '/').Replace(ControlChar.LineBreak, string.Empty));\n            //     }\n            // }\n            // else\n            // {\n            //     m_writer.WriteAttributeString('Target', targetPath.Replace('\\\\', '/').Replace(ControlChar.LineBreak, string.Empty));\n            // }\n            writer.writeAttributeString(undefined, 'TargetMode', undefined, 'External');\n        }\n        writer.writeEndElement();\n    };\n    // Get the next relationship ID\n    WordExport.prototype.getNextRelationShipID = function () {\n        return 'rId' + (++this.mRelationShipID);\n    };\n    WordExport.prototype.serializeGeneralRelations = function () {\n        var writer = new XmlWriter();\n        this.resetRelationShipID();\n        writer.writeStartElement(undefined, 'Relationships', this.rpNamespace);\n        this.serializeRelationShip(writer, this.getNextRelationShipID(), this.documentRelType, this.documentPath);\n        // this.serializeRelationShip(writer, this.getNextRelationShipID(), this.AppRelType, this.appPath);\n        // this.serializeRelationShip(writer, this.getNextRelationShipID(), this.CoreRelType, this.corePath);\n        //End of Relationships tag\n        writer.writeEndElement();\n        var zipArchiveItem = new ZipArchiveItem(writer.buffer, this.generalRelationPath);\n        this.mArchive.addItem(zipArchiveItem);\n    };\n    WordExport.prototype.serializeContentTypes = function (contentType) {\n        var writer = new XmlWriter();\n        writer.writeStartElement(undefined, 'Types', 'http://schemas.openxmlformats.org/package/2006/content-types');\n        //if (m_hasOleObject)\n        //{\n        //    //<Default Extension='bin' ContentType='application/vnd.openxmlformats-officedocument.oleObject'/>\n        //    SerializeDefaultContentType(contentStream, 'bin', 'application/vnd.openxmlformats-officedocument.oleObject');\n        //}\n        this.serializeDefaultContentType(writer, 'rels', this.relationContentType);\n        this.serializeDefaultContentType(writer, 'xml', this.xmlContentType);\n        // if (m_hasEmbedFonts && !string.IsNullOrEmpty(type))\n        // {\n        //     SerializeDefaultContentType(contentStream,type, this.fontContentType);\n        // }\n        if (this.documentImages.length > 0 || this.externalImages.length > 0 || this.headerFooterImages.length > 0) {\n            this.serializeDefaultContentType(writer, 'png', 'image/png');\n            this.serializeDefaultContentType(writer, 'bmp', 'image/bmp');\n            this.serializeDefaultContentType(writer, 'emf', 'image/x-emf');\n            this.serializeDefaultContentType(writer, 'wmf', 'image/x-wmf');\n            this.serializeDefaultContentType(writer, 'gif', 'image/gif');\n            this.serializeDefaultContentType(writer, 'ico', 'image/x-icon');\n            this.serializeDefaultContentType(writer, 'tif', 'image/tiff');\n            this.serializeDefaultContentType(writer, 'tiff', 'image/tiff');\n            this.serializeDefaultContentType(writer, 'jpeg', 'image/jpeg');\n            this.serializeDefaultContentType(writer, 'jpg', 'image/jpeg');\n            this.serializeDefaultContentType(writer, 'svg', 'image/svg+xml');\n        }\n        // if (m_document.HasMacros\n        //     && IsMacroEnabled && !m_isSkipBinExtension)\n        // {\n        //     SerializeDefaultContentType(contentStream, 'bin', this.VbaProjectContentType);\n        //     m_isSkipBinExtension = true;\n        // }\n        // if (m_hasOleObject)\n        // {\n        //     SerializeOleContentType(contentStream);\n        // }\n        //document.xml\n        this.serializeOverrideContentType(writer, this.documentPath, this.documentContentType);\n        // tslint:disable-next-line:max-line-length\n        //<Override PartName='/word/numbering.xml' ContentType='application/vnd.openxmlformats-officedocument.wordprocessingml.numbering+xml'/>\n        // if (HasNumbering) {\n        this.serializeOverrideContentType(writer, this.numberingPath, this.numberingContentType);\n        // }\n        //Add the header/footer Alternate chunks\n        // if (HeaderFooterAlternateChunks.length > 0) {\n        //     foreach(Dictionary < string, string > item in m_headerFooterAlternateChunks.Values)\n        //     AddAlternateChunkItem(item);\n        // }\n        //styles.xml\n        this.serializeOverrideContentType(writer, this.stylePath, this.stylesContentType);\n        //settings.xml\n        this.serializeOverrideContentType(writer, this.settingsPath, this.settingsContentType);\n        //             //core.xml\n        //             SerializeOverrideContentType(contentStream, this.corePath, this.CoreContentType);\n        //             //app.xml\n        //             SerializeOverrideContentType(contentStream, this.appPath, this.AppContentType);\n        //             //custom.xml\n        //             if (!isNullOrUndefined(m_document.CustomDocumentProperties) && m_document.CustomDocumentProperties.length > 0)\n        //                 SerializeOverrideContentType(contentStream, this.CustomPath, this.CustomContentType);\n        // #if Chart\n        //             if (m_hasChart)\n        //                 SerializeChartContentType(contentStream);\n        // #endif\n        this.serializeHFContentTypes(writer);\n        // WriteXmlItemsContentTypes(contentStream);\n        //End of Types tag\n        writer.writeEndElement();\n        var zipArchiveItem = new ZipArchiveItem(writer.buffer, this.contentTypesPath);\n        this.mArchive.addItem(zipArchiveItem);\n    };\n    // Serializes the HeaderFooter content types\n    WordExport.prototype.serializeHFContentTypes = function (writer) {\n        this.serializeHeaderFootersContentType(writer, 'EvenFooter');\n        this.serializeHeaderFootersContentType(writer, 'EvenHeader');\n        this.serializeHeaderFootersContentType(writer, 'FirstPageFooter');\n        this.serializeHeaderFootersContentType(writer, 'FirstPageHeader');\n        this.serializeHeaderFootersContentType(writer, 'OddFooter');\n        this.serializeHeaderFootersContentType(writer, 'OddHeader');\n    };\n    // Serializes the HeaderFooter content types.\n    WordExport.prototype.serializeHeaderFootersContentType = function (writer, headerFooterType) {\n        var contentType;\n        var partName;\n        if (!this.headersFooters.containsKey(headerFooterType)) {\n            return;\n        }\n        var hfColl = this.headersFooters.get(headerFooterType);\n        for (var i = 0; i < hfColl.keys.length; i++) {\n            var id = hfColl.keys[i];\n            if (headerFooterType === 'EvenHeader' || headerFooterType === 'FirstPageHeader' ||\n                headerFooterType === 'OddHeader') {\n                partName = this.headerPath + id.replace('rId', '') + '.xml';\n                contentType = this.headerContentType;\n            }\n            else {\n                partName = this.footerPath + id.replace('rId', '') + '.xml';\n                contentType = this.footerContentType;\n            }\n            this.serializeOverrideContentType(writer, partName, contentType);\n        }\n    };\n    // Serializes the Override content type.\n    WordExport.prototype.serializeOverrideContentType = function (writer, partName, contentType) {\n        writer.writeStartElement(undefined, 'Override', undefined);\n        writer.writeAttributeString(undefined, 'PartName', undefined, '/' + partName.replace('\\\\', '/'));\n        writer.writeAttributeString(undefined, 'ContentType', undefined, contentType);\n        writer.writeEndElement();\n    };\n    // Serializes the default content type\n    WordExport.prototype.serializeDefaultContentType = function (writer, extension, contentType) {\n        writer.writeStartElement(undefined, 'Default', undefined);\n        writer.writeAttributeString(undefined, 'Extension', undefined, extension);\n        writer.writeAttributeString(undefined, 'ContentType', undefined, contentType);\n        writer.writeEndElement();\n    };\n    // Reset the relationship id counter\n    WordExport.prototype.resetRelationShipID = function () {\n        this.mRelationShipID = 0;\n    };\n    WordExport.prototype.close = function () {\n        //Implement\n    };\n    return WordExport;\n}());\nexport { WordExport };\n","import { StreamWriter } from '@syncfusion/ej2-file-utils';\nimport { isNullOrUndefined } from '@syncfusion/ej2-base';\n/**\n * Exports the document to Text format.\n */\nvar TextExport = /** @class */ (function () {\n    function TextExport() {\n        this.text = '';\n        this.curSectionIndex = 0;\n        this.inField = false;\n    }\n    TextExport.prototype.getModuleName = function () {\n        return 'TextExport';\n    };\n    /**\n     * @private\n     */\n    TextExport.prototype.save = function (viewer, fileName) {\n        this.serialize(viewer);\n        var writer = new StreamWriter();\n        this.writeInternal(writer);\n        writer.save(fileName + '.txt');\n    };\n    /**\n     * @private\n     */\n    TextExport.prototype.saveAsBlob = function (viewer) {\n        this.serialize(viewer);\n        var streamWriter = new StreamWriter();\n        this.writeInternal(streamWriter);\n        var blob = streamWriter.buffer;\n        streamWriter.destroy();\n        var promise;\n        return new Promise(function (resolve, reject) {\n            resolve(blob);\n        });\n    };\n    TextExport.prototype.serialize = function (viewer) {\n        var document = viewer.owner.sfdtExportModule.write();\n        this.setDocument(document);\n    };\n    TextExport.prototype.setDocument = function (document) {\n        this.document = document;\n        this.mSections = document.sections;\n    };\n    TextExport.prototype.writeInternal = function (streamWriter) {\n        var section = undefined;\n        var sectionCount = this.document.sections.length - 1;\n        var isLastSection = false;\n        this.updateLastParagraph();\n        for (var i = 0; i <= sectionCount; i++) {\n            section = this.document.sections[i];\n            isLastSection = (i === sectionCount) ? true : false;\n            this.writeBody(streamWriter, section.blocks);\n            this.writeNewLine(streamWriter);\n            this.writeSectionEnd(section, isLastSection);\n        }\n        for (var j = 0; j <= sectionCount; j++) {\n            section = this.document.sections[j];\n            this.writeHeadersFooters(streamWriter, section);\n        }\n    };\n    /// <summary>\n    /// Writes the specified document content to the text file.\n    /// </summary>\n    TextExport.prototype.writeBody = function (streamWriter, body) {\n        var bodyItemsCount = body.length - 1;\n        var bodyItem = undefined;\n        for (var i = 0; i <= bodyItemsCount; i++) {\n            bodyItem = body[i];\n            if (bodyItem.hasOwnProperty('inlines')) {\n                var isLastPara = (bodyItem === this.lastPara) ? true : false;\n                this.writeParagraph(streamWriter, bodyItem, isLastPara);\n            }\n            else {\n                this.writeTable(streamWriter, bodyItem);\n            }\n        }\n    };\n    TextExport.prototype.writeParagraph = function (streamWriter, paragraph, isLastPara) {\n        for (var i = 0; i < paragraph.inlines.length; i++) {\n            var item = paragraph.inlines[i];\n            if (item.hasOwnProperty('fieldType')) {\n                this.inField = item.fieldType === 0;\n            }\n            else if (item.hasOwnProperty('text') && !this.inField) {\n                this.writeText(streamWriter, item.text);\n            }\n        }\n        if (!isLastPara) {\n            this.writeNewLine(streamWriter);\n        }\n    };\n    /// }\n    /// <summary>\n    /// Writes the specified table text content to the text file.\n    /// </summary>\n    TextExport.prototype.writeTable = function (streamWriter, table) {\n        for (var i = 0; i < table.rows.length; i++) {\n            var row = table.rows[i];\n            for (var j = 0; j < row.cells.length; j++) {\n                var cell = row.cells[j];\n                this.writeBody(streamWriter, cell.blocks);\n            }\n        }\n    };\n    /// <summary>\n    /// Writes the specified Header Footer text content to the text file.\n    /// </summary>\n    TextExport.prototype.writeHeadersFooters = function (streamWriter, section) {\n        var headersFooters = section.headersFooters;\n        if (isNullOrUndefined(headersFooters)) {\n            return;\n        }\n        this.writeHeaderFooter(streamWriter, section.headersFooters.header);\n        this.writeHeaderFooter(streamWriter, section.headersFooters.footer);\n        this.writeHeaderFooter(streamWriter, section.headersFooters.evenFooter);\n        this.writeHeaderFooter(streamWriter, section.headersFooters.evenHeader);\n        this.writeHeaderFooter(streamWriter, section.headersFooters.firstPageHeader);\n        this.writeHeaderFooter(streamWriter, section.headersFooters.firstPageFooter);\n    };\n    TextExport.prototype.writeHeaderFooter = function (streamWriter, headerFooter) {\n        if (headerFooter && headerFooter.blocks) {\n            this.writeBody(streamWriter, headerFooter.blocks);\n        }\n    };\n    /// <summary>\n    /// Writes the end of the section.\n    /// </summary>\n    TextExport.prototype.writeSectionEnd = function (section, lastSection) {\n        this.curSectionIndex++;\n    };\n    TextExport.prototype.writeNewLine = function (writer) {\n        writer.writeLine('');\n    };\n    TextExport.prototype.writeText = function (writer, text) {\n        writer.write(text);\n    };\n    TextExport.prototype.updateLastParagraph = function () {\n        var cnt = this.document.sections.length;\n        var sec;\n        if (cnt > 0) {\n            sec = this.document.sections[cnt - 1];\n        }\n        if (!isNullOrUndefined(sec)) {\n            var paragraphs = [];\n            for (var i = 0; i < sec.blocks.length; i++) {\n                if (sec.blocks[i].hasOwnProperty('inlines')) {\n                    paragraphs.push(sec.blocks[i]);\n                }\n            }\n            var pCount = paragraphs.length;\n            if (pCount > 0) {\n                this.lastPara = paragraphs[pCount - 1];\n            }\n        }\n    };\n    /**\n     * @private\n     */\n    TextExport.prototype.destroy = function () {\n        this.document = undefined;\n        this.lastPara = undefined;\n        this.mSections = undefined;\n        this.sections = undefined;\n    };\n    return TextExport;\n}());\nexport { TextExport };\n","import { LineWidget, ParagraphWidget, BodyWidget, TextElementBox, FieldElementBox, TableRowWidget, TableCellWidget, ImageElementBox, ListTextElementBox, BookmarkElementBox } from '../viewer/page';\nimport { BlockWidget } from '../viewer/page';\nimport { isNullOrUndefined } from '@syncfusion/ej2-base';\nimport { HelperMethods } from '../editor/editor-helper';\nimport { StreamWriter } from '@syncfusion/ej2-file-utils';\n/**\n * Exports the document to Sfdt format.\n */\nvar SfdtExport = /** @class */ (function () {\n    /**\n     * @private\n     */\n    function SfdtExport(owner) {\n        /* tslint:disable:no-any */\n        this.endLine = undefined;\n        this.endOffset = undefined;\n        this.endCell = undefined;\n        this.startColumnIndex = undefined;\n        this.endColumnIndex = undefined;\n        this.lists = undefined;\n        this.viewer = undefined;\n        this.document = undefined;\n        this.writeInlineStyles = undefined;\n        this.viewer = owner;\n    }\n    SfdtExport.prototype.getModuleName = function () {\n        return 'SfdtExport';\n    };\n    SfdtExport.prototype.clear = function () {\n        this.writeInlineStyles = undefined;\n        this.endLine = undefined;\n        this.lists = undefined;\n        this.document = undefined;\n    };\n    /**\n     * Serialize the data as Syncfusion document text.\n     * @private\n     */\n    SfdtExport.prototype.serialize = function () {\n        return JSON.stringify(this.write());\n    };\n    /**\n     * @private\n     */\n    SfdtExport.prototype.saveAsBlob = function (viewer) {\n        var streamWriter = new StreamWriter();\n        streamWriter.write(this.serialize());\n        var blob = streamWriter.buffer;\n        streamWriter.destroy();\n        var promise;\n        return new Promise(function (resolve, reject) {\n            resolve(blob);\n        });\n    };\n    // tslint:disable-next-line:max-line-length\n    /**\n     * @private\n     */\n    SfdtExport.prototype.write = function (line, startOffset, endLine, endOffset, writeInlineStyles) {\n        if (writeInlineStyles) {\n            this.writeInlineStyles = true;\n        }\n        this.lists = [];\n        this.document = {};\n        this.document.sections = [];\n        this.document.characterFormat = this.writeCharacterFormat(this.viewer.characterFormat);\n        this.document.paragraphFormat = this.writeParagraphFormat(this.viewer.paragraphFormat);\n        if (line instanceof LineWidget && endLine instanceof LineWidget) {\n            // For selection\n            var startPara = line.paragraph;\n            var endPara = endLine.paragraph;\n            var startCell = startPara.associatedCell;\n            var endCell = endPara.associatedCell;\n            // Creates section\n            var bodyWidget = startPara.bodyWidget;\n            var section = this.createSection(line.paragraph.bodyWidget);\n            this.document.sections.push(section);\n            if (startCell === endCell || isNullOrUndefined(endCell)) {\n                this.endLine = endLine;\n                this.endOffset = endOffset;\n            }\n            else {\n                // Todo: Handle nested table cases\n                if (startCell instanceof TableCellWidget) {\n                    var startTable = startCell.getContainerTable();\n                    var endTable = endCell.getContainerTable();\n                    if (startTable.tableFormat === endTable.tableFormat) {\n                        this.endCell = endCell;\n                        this.endColumnIndex = this.endCell.columnIndex + this.endCell.cellFormat.columnSpan;\n                        this.startColumnIndex = startCell.columnIndex;\n                    }\n                }\n                else {\n                    this.endCell = endCell;\n                }\n            }\n            if (startCell === endCell || isNullOrUndefined(startCell)) {\n                var paragraph = this.createParagraph(line.paragraph);\n                section.blocks.push(paragraph);\n                if (!this.writeParagraph(line.paragraph, paragraph, section.blocks, line.indexInOwner, startOffset)) {\n                    // Todo:continue in next section\n                }\n            }\n            else {\n                var table = this.createTable(startCell.ownerTable);\n                section.blocks.push(table);\n                this.writeTable(startCell.ownerTable, table, startCell.ownerRow.indexInOwner, section.blocks);\n            }\n        }\n        else {\n            if (this.viewer.pages.length > 0) {\n                var page = this.viewer.pages[0];\n                if (page.bodyWidgets.length > 0) {\n                    this.writeBodyWidget(page.bodyWidgets[0], 0);\n                }\n            }\n        }\n        this.writeStyles(this.viewer);\n        this.writeLists(this.viewer);\n        var doc = this.document;\n        this.clear();\n        return doc;\n    };\n    SfdtExport.prototype.writeBodyWidget = function (bodyWidget, index) {\n        if (!(bodyWidget instanceof BodyWidget)) {\n            return true;\n        }\n        var section = this.createSection(bodyWidget);\n        this.document.sections.push(section);\n        this.writeHeaderFooters(this.viewer.headersFooters[bodyWidget.index], section);\n        if (this.writeBlock(bodyWidget.childWidgets[index], 0, section.blocks)) {\n            return true;\n        }\n        var next = bodyWidget;\n        do {\n            bodyWidget = next;\n            next = next.nextRenderedWidget;\n        } while (next instanceof BodyWidget && next.index === bodyWidget.index);\n        return this.writeBodyWidget(next, index);\n    };\n    SfdtExport.prototype.writeHeaderFooters = function (hfs, section) {\n        if (isNullOrUndefined(hfs)) {\n            return;\n        }\n        section.headersFooters.header = this.writeHeaderFooter(hfs[0]);\n        section.headersFooters.footer = this.writeHeaderFooter(hfs[1]);\n        section.headersFooters.evenHeader = this.writeHeaderFooter(hfs[2]);\n        section.headersFooters.evenFooter = this.writeHeaderFooter(hfs[3]);\n        section.headersFooters.firstPageHeader = this.writeHeaderFooter(hfs[4]);\n        section.headersFooters.firstPageFooter = this.writeHeaderFooter(hfs[5]);\n    };\n    SfdtExport.prototype.writeHeaderFooter = function (widget) {\n        if (isNullOrUndefined(widget)) {\n            return undefined;\n        }\n        var headerFooter = {};\n        if (widget && widget.childWidgets && widget.childWidgets.length > 0) {\n            headerFooter.blocks = [];\n            this.writeBlock(widget.firstChild, 0, headerFooter.blocks);\n        }\n        return headerFooter;\n    };\n    SfdtExport.prototype.createSection = function (bodyWidget) {\n        var section = {};\n        section.sectionFormat = {};\n        section.sectionFormat.pageWidth = bodyWidget.sectionFormat.pageWidth;\n        section.sectionFormat.pageHeight = bodyWidget.sectionFormat.pageHeight;\n        section.sectionFormat.leftMargin = bodyWidget.sectionFormat.leftMargin;\n        section.sectionFormat.rightMargin = bodyWidget.sectionFormat.rightMargin;\n        section.sectionFormat.topMargin = bodyWidget.sectionFormat.topMargin;\n        section.sectionFormat.bottomMargin = bodyWidget.sectionFormat.bottomMargin;\n        section.sectionFormat.differentFirstPage = bodyWidget.sectionFormat.differentFirstPage;\n        section.sectionFormat.differentOddAndEvenPages = bodyWidget.sectionFormat.differentOddAndEvenPages;\n        section.sectionFormat.headerDistance = bodyWidget.sectionFormat.headerDistance;\n        section.sectionFormat.footerDistance = bodyWidget.sectionFormat.footerDistance;\n        section.blocks = [];\n        section.headersFooters = {};\n        return section;\n    };\n    SfdtExport.prototype.writeBlock = function (widget, index, blocks) {\n        if (!(widget instanceof BlockWidget)) {\n            return true;\n        }\n        if (widget instanceof ParagraphWidget) {\n            var paragraph = this.createParagraph(widget);\n            blocks.push(paragraph);\n            if (this.writeParagraph(widget, paragraph, blocks)) {\n                return true;\n            }\n        }\n        else {\n            var tableWidget = widget;\n            var table = this.createTable(tableWidget);\n            blocks.push(table);\n            if (this.writeTable(tableWidget, table, 0, blocks)) {\n                return true;\n            }\n        }\n        return false;\n    };\n    SfdtExport.prototype.writeNextBlock = function (widget, blocks) {\n        var next = widget.nextRenderedWidget;\n        if (next instanceof BlockWidget && next.containerWidget.index === widget.containerWidget.index) {\n            return this.writeBlock(widget.nextRenderedWidget, 0, blocks);\n        }\n        return false;\n    };\n    SfdtExport.prototype.writeParagraph = function (paragraphWidget, paragraph, blocks, lineIndex, start) {\n        if (isNullOrUndefined(lineIndex)) {\n            lineIndex = 0;\n        }\n        if (isNullOrUndefined(start)) {\n            start = 0;\n        }\n        var next = paragraphWidget;\n        while (next instanceof ParagraphWidget) {\n            if (this.writeLines(next, lineIndex, start, paragraph.inlines)) {\n                return true;\n            }\n            lineIndex = 0;\n            start = 0;\n            paragraphWidget = next;\n            next = paragraphWidget.nextSplitWidget;\n        }\n        return this.writeNextBlock(paragraphWidget, blocks);\n    };\n    SfdtExport.prototype.writeInlines = function (line, inlines) {\n        for (var i = 0; i < line.children.length; i++) {\n            var element = line.children[i];\n            if (element instanceof ListTextElementBox) {\n                continue;\n            }\n            var inline = this.writeInline(element);\n            if (!isNullOrUndefined(inline)) {\n                inlines.push(inline);\n            }\n        }\n    };\n    SfdtExport.prototype.writeInline = function (element) {\n        var inline = {};\n        inline.characterFormat = this.writeCharacterFormat(element.characterFormat);\n        if (element instanceof FieldElementBox) {\n            inline.fieldType = element.fieldType;\n        }\n        else if (element instanceof ImageElementBox) {\n            inline.imageString = element.imageString;\n            inline.width = HelperMethods.convertPixelToPoint(element.width);\n            inline.height = HelperMethods.convertPixelToPoint(element.height);\n        }\n        else if (element instanceof BookmarkElementBox) {\n            inline.bookmarkType = element.bookmarkType;\n            inline.name = element.name;\n        }\n        else if (element instanceof TextElementBox) {\n            inline.text = element.text;\n        }\n        else {\n            inline = undefined;\n        }\n        return inline;\n    };\n    SfdtExport.prototype.writeLines = function (paragraph, lineIndex, offset, inlines) {\n        var startIndex = lineIndex;\n        var endParagraph = this.endLine instanceof LineWidget && this.endLine.paragraph === paragraph;\n        var endIndex = endParagraph ? this.endLine.indexInOwner : paragraph.childWidgets.length - 1;\n        for (var i = startIndex; i <= endIndex; i++) {\n            var child = paragraph.childWidgets[i];\n            if (this.endLine === child || (lineIndex === i && offset !== 0)) {\n                this.writeLine(child, offset, inlines);\n            }\n            else {\n                this.writeInlines(child, inlines);\n            }\n        }\n        return endParagraph;\n    };\n    SfdtExport.prototype.writeLine = function (line, offset, inlines) {\n        var isEnd = line === this.endLine;\n        var started = false;\n        var ended = false;\n        var length = 0;\n        for (var j = 0; j < line.children.length; j++) {\n            var element = line.children[j];\n            if (element instanceof ListTextElementBox) {\n                continue;\n            }\n            var inline = undefined;\n            length += element.length;\n            started = length > offset;\n            ended = isEnd && length >= this.endOffset;\n            if (!started) {\n                continue;\n            }\n            inline = this.writeInline(element);\n            inlines[inlines.length] = inline;\n            if (length > offset || ended) {\n                if (inline.hasOwnProperty('text')) {\n                    var startIndex = length - element.length;\n                    var indexInInline = offset - startIndex;\n                    var endIndex = ended ? this.endOffset - startIndex : element.length;\n                    inline.text = inline.text.substring(indexInInline, endIndex);\n                }\n                offset = -1;\n            }\n            if (ended) {\n                break;\n            }\n        }\n    };\n    SfdtExport.prototype.createParagraph = function (paragraphWidget) {\n        var paragraph = {};\n        paragraph.paragraphFormat = this.writeParagraphFormat(paragraphWidget.paragraphFormat);\n        paragraph.characterFormat = this.writeCharacterFormat(paragraphWidget.characterFormat);\n        paragraph.inlines = [];\n        return paragraph;\n    };\n    /**\n     * @private\n     */\n    SfdtExport.prototype.writeCharacterFormat = function (format, isInline) {\n        var characterFormat = {};\n        HelperMethods.writeCharacterFormat(characterFormat, isInline, format);\n        if (this.writeInlineStyles && !isInline) {\n            characterFormat.inlineFormat = this.writeCharacterFormat(format, true);\n        }\n        return characterFormat;\n    };\n    SfdtExport.prototype.writeParagraphFormat = function (format, isInline) {\n        var paragraphFormat = {};\n        paragraphFormat.leftIndent = isInline ? format.leftIndent : format.getValue('leftIndent');\n        paragraphFormat.rightIndent = isInline ? format.rightIndent : format.getValue('rightIndent');\n        paragraphFormat.firstLineIndent = isInline ? format.firstLineIndent : format.getValue('firstLineIndent');\n        paragraphFormat.textAlignment = isInline ? format.textAlignment : format.getValue('textAlignment');\n        paragraphFormat.beforeSpacing = isInline ? format.beforeSpacing : format.getValue('beforeSpacing');\n        paragraphFormat.afterSpacing = isInline ? format.afterSpacing : format.getValue('afterSpacing');\n        paragraphFormat.lineSpacing = isInline ? format.lineSpacing : format.getValue('lineSpacing');\n        paragraphFormat.lineSpacingType = isInline ? format.lineSpacingType : format.getValue('lineSpacingType');\n        paragraphFormat.styleName = !isNullOrUndefined(format.baseStyle) ? format.baseStyle.name : undefined;\n        paragraphFormat.outlineLevel = isInline ? format.outlineLevel : format.getValue('outlineLevel');\n        paragraphFormat.listFormat = this.writeListFormat(format.listFormat, isInline);\n        paragraphFormat.tabs = this.writeTabs(format.tabs);\n        if (this.writeInlineStyles && !isInline) {\n            paragraphFormat.inlineFormat = this.writeParagraphFormat(format, true);\n        }\n        return paragraphFormat;\n    };\n    SfdtExport.prototype.writeTabs = function (tabStops) {\n        if (isNullOrUndefined(tabStops) || tabStops.length < 1) {\n            return undefined;\n        }\n        var tabs = [];\n        for (var i = 0; i < tabStops.length; i++) {\n            var tabStop = tabStops[i];\n            var tab = {};\n            tab.position = tabStop.position;\n            tab.deletePosition = tabStop.deletePosition;\n            tab.tabJustification = tabStop.tabJustification;\n            tab.tabLeader = tabStop.tabLeader;\n            tabs.push(tab);\n        }\n        return tabs;\n    };\n    /**\n     * @private\n     */\n    SfdtExport.prototype.writeListFormat = function (format, isInline) {\n        var listFormat = {};\n        var listIdValue = format.getValue('listId');\n        if (!isNullOrUndefined(listIdValue) && listIdValue > -1) {\n            listFormat.listId = listIdValue;\n            listFormat.listLevelNumber = format.getValue('listLevelNumber');\n            if (this.lists.indexOf(format.listId) < 0) {\n                this.lists.push(format.listId);\n            }\n        }\n        return listFormat;\n    };\n    SfdtExport.prototype.writeTable = function (tableWidget, table, index, blocks) {\n        var widget = tableWidget.childWidgets[index];\n        if (widget instanceof TableRowWidget) {\n            if (this.writeRow(widget, table.rows)) {\n                return true;\n            }\n        }\n        var next = tableWidget;\n        do {\n            tableWidget = next;\n            next = tableWidget.nextSplitWidget;\n        } while (next instanceof BlockWidget);\n        return this.writeNextBlock(tableWidget, blocks);\n    };\n    SfdtExport.prototype.writeRow = function (rowWidget, rows) {\n        if (!(rowWidget instanceof TableRowWidget)) {\n            return false;\n        }\n        var row = this.createRow(rowWidget);\n        rows.push(row);\n        for (var i = 0; i < rowWidget.childWidgets.length; i++) {\n            var widget = rowWidget.childWidgets[i];\n            if (widget instanceof TableCellWidget) {\n                if (rowWidget.index === widget.rowIndex\n                    && (isNullOrUndefined(this.startColumnIndex) || widget.columnIndex >= this.startColumnIndex)\n                    && (isNullOrUndefined(this.endColumnIndex) || widget.columnIndex < this.endColumnIndex)) {\n                    if (this.writeCell(widget, row.cells)) {\n                        return true;\n                    }\n                }\n            }\n        }\n        var next = rowWidget;\n        do {\n            rowWidget = next;\n            next = rowWidget.nextRenderedWidget;\n        } while (next instanceof TableRowWidget && next.index === rowWidget.index);\n        return this.writeRow(next, rows);\n    };\n    SfdtExport.prototype.writeCell = function (cellWidget, cells) {\n        var cell = this.createCell(cellWidget);\n        cells.push(cell);\n        if (this.writeBlock(cellWidget.firstChild, 0, cell.blocks)) {\n            return true;\n        }\n        return this.endCell instanceof TableCellWidget ? this.endCell.cellFormat === cellWidget.cellFormat : false;\n    };\n    SfdtExport.prototype.createTable = function (tableWidget) {\n        var table = {};\n        table.rows = [];\n        table.grid = [];\n        for (var i = 0; i < tableWidget.tableHolder.columns.length; i++) {\n            table.grid[i] = tableWidget.tableHolder.columns[i].preferredWidth;\n        }\n        table.tableFormat = this.writeTableFormat(tableWidget.tableFormat);\n        table.description = tableWidget.description;\n        table.title = tableWidget.title;\n        return table;\n    };\n    SfdtExport.prototype.createRow = function (rowWidget) {\n        var row = {};\n        row.cells = [];\n        row.rowFormat = this.writeRowFormat(rowWidget.rowFormat);\n        return row;\n    };\n    SfdtExport.prototype.createCell = function (cellWidget) {\n        var cell = {};\n        cell.blocks = [];\n        cell.cellFormat = this.writeCellFormat(cellWidget.cellFormat);\n        cell.columnIndex = cellWidget.columnIndex;\n        return cell;\n    };\n    SfdtExport.prototype.writeShading = function (wShading) {\n        var shading = {};\n        shading.backgroundColor = wShading.backgroundColor;\n        shading.foregroundColor = wShading.foregroundColor;\n        shading.textureStyle = wShading.textureStyle;\n        return shading;\n    };\n    SfdtExport.prototype.writeBorder = function (wBorder) {\n        var border = {};\n        border.color = wBorder.color;\n        border.hasNoneStyle = wBorder.hasNoneStyle;\n        border.lineStyle = wBorder.lineStyle;\n        border.lineWidth = wBorder.lineWidth;\n        border.shadow = wBorder.shadow;\n        border.space = wBorder.space;\n        return border;\n    };\n    SfdtExport.prototype.writeBorders = function (wBorders) {\n        var borders = {};\n        borders.top = this.writeBorder(wBorders.top);\n        borders.left = this.writeBorder(wBorders.left);\n        borders.right = this.writeBorder(wBorders.right);\n        borders.bottom = this.writeBorder(wBorders.bottom);\n        borders.diagonalDown = this.writeBorder(wBorders.diagonalDown);\n        borders.diagonalUp = this.writeBorder(wBorders.diagonalUp);\n        borders.horizontal = this.writeBorder(wBorders.horizontal);\n        borders.vertical = this.writeBorder(wBorders.vertical);\n        return borders;\n    };\n    SfdtExport.prototype.writeCellFormat = function (wCellFormat) {\n        var cellFormat = {};\n        cellFormat.borders = this.writeBorders(wCellFormat.borders);\n        cellFormat.shading = this.writeShading(wCellFormat.shading);\n        cellFormat.topMargin = wCellFormat.topMargin;\n        cellFormat.rightMargin = wCellFormat.rightMargin;\n        cellFormat.leftMargin = wCellFormat.leftMargin;\n        cellFormat.bottomMargin = wCellFormat.bottomMargin;\n        cellFormat.preferredWidth = wCellFormat.preferredWidth;\n        cellFormat.preferredWidthType = wCellFormat.preferredWidthType;\n        cellFormat.cellWidth = wCellFormat.cellWidth;\n        cellFormat.columnSpan = wCellFormat.columnSpan;\n        cellFormat.rowSpan = wCellFormat.rowSpan;\n        cellFormat.verticalAlignment = wCellFormat.verticalAlignment;\n        return cellFormat;\n    };\n    SfdtExport.prototype.writeRowFormat = function (wRowFormat) {\n        var rowFormat = {};\n        rowFormat.height = wRowFormat.height;\n        rowFormat.allowBreakAcrossPages = wRowFormat.allowBreakAcrossPages;\n        rowFormat.heightType = wRowFormat.heightType;\n        rowFormat.isHeader = wRowFormat.isHeader;\n        rowFormat.borders = this.writeBorders(wRowFormat.borders);\n        rowFormat.gridBefore = wRowFormat.gridBefore;\n        rowFormat.gridBeforeWidth = wRowFormat.gridBeforeWidth;\n        rowFormat.gridBeforeWidthType = wRowFormat.gridBeforeWidthType;\n        rowFormat.gridAfter = wRowFormat.gridAfter;\n        rowFormat.gridAfterWidth = wRowFormat.gridAfterWidth;\n        rowFormat.gridAfterWidthType = wRowFormat.gridAfterWidthType;\n        return rowFormat;\n    };\n    SfdtExport.prototype.writeTableFormat = function (wTableFormat) {\n        var tableFormat = {};\n        tableFormat.borders = this.writeBorders(wTableFormat.borders);\n        tableFormat.shading = this.writeShading(wTableFormat.shading);\n        tableFormat.cellSpacing = wTableFormat.cellSpacing;\n        tableFormat.leftIndent = wTableFormat.leftIndent;\n        tableFormat.tableAlignment = wTableFormat.tableAlignment;\n        tableFormat.topMargin = wTableFormat.topMargin;\n        tableFormat.rightMargin = wTableFormat.rightMargin;\n        tableFormat.leftMargin = wTableFormat.leftMargin;\n        tableFormat.bottomMargin = wTableFormat.bottomMargin;\n        tableFormat.preferredWidth = wTableFormat.preferredWidth;\n        tableFormat.preferredWidthType = wTableFormat.preferredWidthType;\n        return tableFormat;\n    };\n    SfdtExport.prototype.writeStyles = function (viewer) {\n        var styles = [];\n        this.document.styles = [];\n        for (var i = 0; i < viewer.styles.length; i++) {\n            this.document.styles.push(this.writeStyle(viewer.styles.getItem(i)));\n        }\n    };\n    SfdtExport.prototype.writeStyle = function (style) {\n        var wStyle = {};\n        wStyle.name = style.name;\n        if (style.type === 'Paragraph') {\n            wStyle.type = 'Paragraph';\n            wStyle.paragraphFormat = this.writeParagraphFormat(style.paragraphFormat);\n            wStyle.characterFormat = this.writeCharacterFormat(style.characterFormat);\n        }\n        if (style.type === 'Character') {\n            wStyle.type = 'Character';\n            wStyle.characterFormat = this.writeCharacterFormat(style.characterFormat);\n        }\n        if (!isNullOrUndefined(style.basedOn)) {\n            wStyle.basedOn = style.basedOn.name;\n        }\n        if (!isNullOrUndefined(style.link)) {\n            wStyle.link = style.link.name;\n        }\n        if (!isNullOrUndefined(style.next)) {\n            wStyle.next = style.next.name;\n        }\n        return wStyle;\n    };\n    SfdtExport.prototype.writeLists = function (viewer) {\n        var abstractLists = [];\n        this.document.lists = [];\n        for (var i = 0; i < viewer.lists.length; i++) {\n            var list = viewer.lists[i];\n            if (this.lists.indexOf(list.listId) > -1) {\n                this.document.lists.push(this.writeList(list));\n                if (abstractLists.indexOf(list.abstractListId) < 0) {\n                    abstractLists.push(list.abstractListId);\n                }\n            }\n        }\n        this.document.abstractLists = [];\n        for (var i = 0; i < viewer.abstractLists.length; i++) {\n            var abstractList = viewer.abstractLists[i];\n            if (this.lists.indexOf(abstractList.abstractListId) > -1) {\n                this.document.abstractLists.push(this.writeAbstractList(abstractList));\n            }\n        }\n    };\n    SfdtExport.prototype.writeAbstractList = function (wAbstractList) {\n        var abstractList = {};\n        abstractList.abstractListId = wAbstractList.abstractListId;\n        abstractList.levels = [];\n        for (var i = 0; i < wAbstractList.levels.length; i++) {\n            abstractList.levels[i] = this.writeListLevel(wAbstractList.levels[i]);\n        }\n        return abstractList;\n    };\n    SfdtExport.prototype.writeList = function (wList) {\n        var list = {};\n        list.abstractListId = wList.abstractListId;\n        //list.levelOverrides = wList.levelOverrides;\n        list.listId = wList.listId;\n        return list;\n    };\n    SfdtExport.prototype.writeListLevel = function (wListLevel) {\n        var listLevel = {};\n        listLevel.characterFormat = this.writeCharacterFormat(wListLevel.characterFormat);\n        listLevel.paragraphFormat = this.writeParagraphFormat(wListLevel.paragraphFormat);\n        listLevel.followCharacter = wListLevel.followCharacter;\n        listLevel.listLevelPattern = wListLevel.listLevelPattern;\n        listLevel.numberFormat = wListLevel.numberFormat;\n        listLevel.restartLevel = wListLevel.restartLevel;\n        listLevel.startAt = wListLevel.startAt;\n        return listLevel;\n    };\n    /**\n     * @private\n     */\n    SfdtExport.prototype.destroy = function () {\n        this.lists = undefined;\n        this.endLine = undefined;\n        this.endOffset = undefined;\n        this.viewer = undefined;\n    };\n    return SfdtExport;\n}());\nexport { SfdtExport };\n","import { createElement, isNullOrUndefined, L10n, setCulture } from '@syncfusion/ej2-base';\nimport { DropDownList } from '@syncfusion/ej2-dropdowns';\nimport { CheckBox } from '@syncfusion/ej2-buttons';\n/**\n * The Hyperlink dialog is used to insert or edit hyperlink at selection.\n */\n/* tslint:disable:max-line-length */\nvar HyperlinkDialog = /** @class */ (function () {\n    /**\n     * @private\n     */\n    function HyperlinkDialog(viewer) {\n        var _this = this;\n        this.displayText = '';\n        this.navigationUrl = undefined;\n        this.bookmarkDropdown = undefined;\n        this.bookmarkCheckbox = undefined;\n        this.bookmarks = [];\n        /**\n         * @private\n         */\n        this.onKeyUpOnUrlBox = function (event) {\n            if (event.keyCode === 13) {\n                if (_this.displayTextBox.value !== '' && _this.urlTextBox.value !== '') {\n                    _this.onInsertHyperlink();\n                }\n                return;\n            }\n            var selectedText = _this.owner.selection.text;\n            var urlValue = _this.urlTextBox.value;\n            if (urlValue.substring(0, 4).toLowerCase() === 'www.') {\n                _this.urlTextBox.value = 'http://' + urlValue;\n            }\n            if (_this.displayText === '') {\n                _this.displayTextBox.value = urlValue;\n            }\n            _this.enableOrDisableInsertButton();\n        };\n        /**\n         * @private\n         */\n        this.onKeyUpOnDisplayBox = function () {\n            _this.displayText = _this.displayTextBox.value;\n            _this.enableOrDisableInsertButton();\n        };\n        /**\n         * @private\n         */\n        this.onInsertButtonClick = function () {\n            _this.onInsertHyperlink();\n        };\n        /**\n         * @private\n         */\n        this.onCancelButtonClick = function () {\n            _this.owner.dialog.hide();\n            _this.clearValue();\n        };\n        /**\n         * @private\n         */\n        this.loadHyperlinkDialog = function () {\n            _this.owner.updateFocus();\n            _this.bookmarks = [];\n            for (var i = 0; i < _this.owner.bookmarks.keys.length; i++) {\n                var bookmark = _this.owner.bookmarks.keys[i];\n                if (bookmark.indexOf('_') !== 0) {\n                    _this.bookmarks.push(bookmark);\n                }\n            }\n            var fieldBegin = _this.owner.selection.getHyperlinkField();\n            if (!isNullOrUndefined(fieldBegin)) {\n                if (!isNullOrUndefined(fieldBegin.fieldSeparator)) {\n                    var format = undefined;\n                    // tslint:disable-next-line:max-line-length\n                    var fieldObj = _this.owner.selection.getHyperlinkDisplayText(fieldBegin.fieldSeparator.line.paragraph, fieldBegin.fieldSeparator, fieldBegin.fieldEnd, false, format);\n                    _this.displayText = fieldObj.displayText;\n                    _this.displayTextBox.disabled = fieldObj.isNestedField;\n                }\n                _this.displayTextBox.value = _this.displayText;\n                var link = _this.owner.selection.getLinkText(fieldBegin);\n                _this.urlTextBox.value = _this.navigationUrl = link;\n                _this.owner.dialog.header = _this.localObj.getConstant('Edit Hyperlink');\n            }\n            else {\n                _this.displayText = _this.owner.selection.getText(true);\n                if (_this.displayText !== '') {\n                    if (_this.displayText.indexOf(String.fromCharCode(65532)) !== -1 ||\n                        _this.displayText.indexOf('\\r') !== -1 && (_this.displayText.lastIndexOf('\\r') !== -1 &&\n                            _this.displayText.slice(0, -1).indexOf('\\r') !== -1)) {\n                        _this.displayTextBox.value = '<<Selection in document>>';\n                        _this.displayTextBox.disabled = true;\n                    }\n                    else {\n                        _this.displayTextBox.value = _this.displayText;\n                    }\n                }\n            }\n            _this.bookmarkDiv.style.display = 'none';\n            _this.addressText.style.display = 'block';\n            _this.urlTextBox.style.display = 'block';\n            _this.bookmarkCheckbox.checked = false;\n            _this.bookmarkDropdown.dataSource = _this.owner.bookmarks.keys;\n            _this.insertButton = document.getElementsByClassName('e-hyper-insert')[0];\n            _this.enableOrDisableInsertButton();\n            _this.urlTextBox.focus();\n            if (_this.owner.selection.caret.style.display !== 'none') {\n                _this.owner.selection.caret.style.display = 'none';\n            }\n        };\n        /**\n         * @private\n         */\n        this.closeHyperlinkDialog = function () {\n            _this.clearValue();\n            _this.owner.updateFocus();\n        };\n        /* tslint:disable:no-any */\n        this.onUseBookmarkChange = function (args) {\n            if (args.checked) {\n                _this.bookmarkDiv.style.display = 'block';\n                _this.bookmarkDropdown.dataSource = _this.bookmarks;\n                _this.addressText.style.display = 'none';\n                _this.urlTextBox.style.display = 'none';\n            }\n            else {\n                _this.bookmarkDiv.style.display = 'none';\n                _this.addressText.style.display = 'block';\n                _this.urlTextBox.style.display = 'block';\n            }\n        };\n        this.onBookmarkchange = function (args) {\n            if (_this.bookmarkDropdown.value !== '') {\n                _this.insertButton.disabled = false;\n            }\n        };\n        this.owner = viewer;\n    }\n    /**\n     * @private\n     */\n    HyperlinkDialog.prototype.getModuleName = function () {\n        return 'HyperlinkDialog';\n    };\n    /**\n     * @private\n     */\n    HyperlinkDialog.prototype.initHyperlinkDialog = function (localValue) {\n        var instance = this;\n        var id = this.owner.owner.containerId + '_insert_hyperlink';\n        this.target = createElement('div', { id: id, className: 'e-de-hyperlink' });\n        var container = createElement('div');\n        var displayText = createElement('div', { className: 'e-de-hyperlink-dlg-title', innerHTML: localValue.getConstant('Text to display') });\n        this.displayTextBox = createElement('input', { id: this.owner.owner.containerId + '_display_text', className: 'e-input e-de-hyperlink-dlg-input' });\n        this.displayTextBox.addEventListener('keyup', instance.onKeyUpOnDisplayBox);\n        container.appendChild(displayText);\n        container.appendChild(this.displayTextBox);\n        this.addressText = createElement('div', { className: 'e-de-hyperlink-dlg-title', innerHTML: localValue.getConstant('Address') });\n        this.urlTextBox = createElement('input', { id: this.owner.owner.containerId + '_url_text', className: 'e-input e-de-hyperlink-dlg-input', attrs: { autofocus: 'true' } });\n        this.urlTextBox.addEventListener('input', instance.onKeyUpOnUrlBox);\n        this.urlTextBox.addEventListener('keyup', instance.onKeyUpOnUrlBox);\n        container.appendChild(this.addressText);\n        container.appendChild(this.urlTextBox);\n        this.bookmarkDiv = createElement('div', { styles: 'display:none;' });\n        var bookmarkText = createElement('div', { className: 'e-de-hyperlink-dlg-title', innerHTML: localValue.getConstant('Bookmark') });\n        var bookmarkTextElement = createElement('div', { className: 'e-de-hyperlink-dlg-bookmark' });\n        // tslint:disable-next-line:max-line-length\n        var bookmarkValue = createElement('input', { id: 'e-de-hyperlink-dlg-bookmark-value' });\n        bookmarkTextElement.appendChild(bookmarkValue);\n        // tslint:disable-next-line:max-line-length\n        this.bookmarkDropdown = new DropDownList({ dataSource: [], change: this.onBookmarkchange, popupHeight: '230px', width: '230px', noRecordsTemplate: localValue.getConstant('No bookmarks found') });\n        this.bookmarkDropdown.appendTo(bookmarkValue);\n        this.bookmarkDiv.appendChild(bookmarkText);\n        this.bookmarkDiv.appendChild(bookmarkTextElement);\n        container.appendChild(this.bookmarkDiv);\n        // tslint:disable-next-line:max-line-length\n        var bookmarkCheckDiv = createElement('div', { className: 'e-de-hyperlink-bookmark-check e-de-hyperlink-dlg-title' });\n        var bookmarkCheck = createElement('input', { attrs: { type: 'checkbox' }, id: this.target.id + '_bookmark', className: this.target.id + '_bookmarkcheck' });\n        bookmarkCheckDiv.appendChild(bookmarkCheck);\n        this.bookmarkCheckbox = new CheckBox({ label: localValue.getConstant('Use bookmarks'), change: this.onUseBookmarkChange });\n        this.bookmarkCheckbox.appendTo(bookmarkCheck);\n        container.appendChild(bookmarkCheckDiv);\n        this.target.appendChild(container);\n    };\n    /**\n     * @private\n     */\n    HyperlinkDialog.prototype.show = function () {\n        this.localObj = new L10n('documenteditor', this.owner.owner.defaultLocale);\n        this.localObj.setLocale(this.owner.owner.locale);\n        setCulture(this.owner.owner.locale);\n        if (!this.target) {\n            this.initHyperlinkDialog(this.localObj);\n        }\n        this.owner.dialog.header = this.localObj.getConstant('Insert Hyperlink');\n        this.owner.dialog.height = 'auto';\n        this.owner.dialog.width = 'auto';\n        this.owner.dialog.content = this.target;\n        this.owner.dialog.buttons = [{\n                click: this.onInsertButtonClick,\n                buttonModel: { content: this.localObj.getConstant('Ok'), cssClass: 'e-flat e-hyper-insert', isPrimary: true }\n            },\n            {\n                click: this.onCancelButtonClick,\n                buttonModel: { content: this.localObj.getConstant('Cancel'), cssClass: 'e-flat e-hyper-cancel' }\n            }];\n        this.owner.dialog.dataBind();\n        this.owner.dialog.beforeOpen = this.loadHyperlinkDialog;\n        this.owner.dialog.close = this.closeHyperlinkDialog;\n        this.owner.dialog.show();\n    };\n    /**\n     * @private\n     */\n    HyperlinkDialog.prototype.hide = function () {\n        this.closeHyperlinkDialog();\n    };\n    HyperlinkDialog.prototype.enableOrDisableInsertButton = function () {\n        if (!isNullOrUndefined(this.insertButton)) {\n            // tslint:disable-next-line:max-line-length\n            this.insertButton.disabled = (this.urlTextBox.value === '' || this.displayTextBox.value === '');\n        }\n    };\n    /**\n     * @private\n     */\n    HyperlinkDialog.prototype.onInsertHyperlink = function () {\n        var displayText = this.displayTextBox.value.trim();\n        var address = this.urlTextBox.value.trim();\n        var isBookmark = false;\n        if (!isNullOrUndefined(this.bookmarkDropdown.value) && this.bookmarkDropdown.value !== '') {\n            address = this.bookmarkDropdown.value;\n            isBookmark = true;\n        }\n        if (address === '') {\n            this.owner.dialog.hide();\n            return;\n        }\n        if (displayText === '' && address !== '') {\n            displayText = address;\n        }\n        else {\n            displayText = this.displayTextBox.value;\n        }\n        if (!isNullOrUndefined(this.navigationUrl)) {\n            this.owner.owner.editorModule.editHyperlink(this.owner.selection, address, displayText, isBookmark);\n        }\n        else {\n            var remove = this.owner.selection.text !== displayText && !this.displayTextBox.disabled;\n            this.owner.owner.editorModule.insertHyperlink(address, displayText, remove, isBookmark);\n        }\n        this.owner.dialog.hide();\n        this.navigationUrl = undefined;\n    };\n    /* tslint:enable:no-any */\n    /**\n     * @private\n     */\n    HyperlinkDialog.prototype.clearValue = function () {\n        this.displayTextBox.value = '';\n        this.urlTextBox.value = '';\n        this.displayText = '';\n        this.displayTextBox.disabled = false;\n        this.bookmarks = [];\n    };\n    /**\n     * @private\n     */\n    HyperlinkDialog.prototype.destroy = function () {\n        if (this.displayTextBox) {\n            this.displayTextBox.innerHTML = '';\n            this.displayTextBox = undefined;\n        }\n        if (this.urlTextBox) {\n            this.urlTextBox.parentElement.removeChild(this.urlTextBox);\n            this.urlTextBox = undefined;\n        }\n        this.owner = undefined;\n        if (!isNullOrUndefined(this.target)) {\n            if (this.target.parentElement) {\n                this.target.parentElement.removeChild(this.target);\n            }\n            this.target.innerHTML = '';\n            this.target = undefined;\n        }\n    };\n    return HyperlinkDialog;\n}());\nexport { HyperlinkDialog };\n","import { NumericTextBox } from '@syncfusion/ej2-inputs';\nimport { L10n, createElement, setCulture, isNullOrUndefined } from '@syncfusion/ej2-base';\n/**\n * The Table dialog is used to insert table at selection.\n */\nvar TableDialog = /** @class */ (function () {\n    /**\n     * @private\n     */\n    function TableDialog(viewer) {\n        var _this = this;\n        /**\n         * @private\n         */\n        this.keyUpInsertTable = function (event) {\n            if (event.keyCode === 13) {\n                if (_this.rowsCountBox.value !== '' && _this.columnsCountBox.value !== '') {\n                    _this.onInsertTableClick();\n                }\n            }\n        };\n        /**\n         * @private\n         */\n        this.onCancelButtonClick = function () {\n            _this.owner.dialog.hide();\n        };\n        /**\n         * @private\n         */\n        this.onInsertTableClick = function () {\n            var rowCount = _this.rowValueTextBox.value;\n            var columnCount = _this.columnValueTexBox.value;\n            if (!(isNullOrUndefined(rowCount) && isNullOrUndefined(columnCount))) {\n                _this.owner.owner.editor.insertTable(rowCount, columnCount);\n            }\n            _this.owner.dialog.hide();\n        };\n        this.owner = viewer;\n    }\n    TableDialog.prototype.getModuleName = function () {\n        return 'TableDialog';\n    };\n    /**\n     * @private\n     */\n    TableDialog.prototype.initTableDialog = function (localValue) {\n        var instance = this;\n        var id = this.owner.owner.containerId + '_insert_Table';\n        this.target = createElement('div', { id: id, className: 'e-de-insert-table' });\n        var parentDiv = createElement('div');\n        var columnContainer = createElement('div', {\n            className: 'e-de-insert-table-dlg-sub-header', innerHTML: localValue.getConstant('Number of columns')\n        });\n        var columnValue = createElement('div', { className: 'e-de-insert-table-dlg-input' });\n        this.columnsCountBox = createElement('input', {\n            attrs: { type: 'text' }, id: this.owner.owner.containerId + '_column'\n        });\n        columnValue.appendChild(this.columnsCountBox);\n        var rowContainer = createElement('div', {\n            className: 'e-de-insert-table-dlg-sub-header', innerHTML: localValue.getConstant('Number of rows')\n        });\n        var rowValue = createElement('div', { className: 'e-de-insert-table-dlg-input' });\n        this.rowsCountBox = createElement('input', {\n            attrs: { type: 'text' }, id: this.owner.owner.containerId + 'row'\n        });\n        rowValue.appendChild(this.rowsCountBox);\n        parentDiv.appendChild(columnContainer);\n        parentDiv.appendChild(columnValue);\n        parentDiv.appendChild(rowContainer);\n        parentDiv.appendChild(rowValue);\n        this.target.appendChild(parentDiv);\n        this.columnsCountBox.addEventListener('keyup', instance.keyUpInsertTable);\n        this.rowsCountBox.addEventListener('keyup', instance.keyUpInsertTable);\n        this.rowValueTextBox = new NumericTextBox({\n            format: '#',\n            value: 2,\n            min: 1,\n            max: 32767,\n            enablePersistence: false\n        });\n        this.rowValueTextBox.appendTo(this.rowsCountBox);\n        this.columnValueTexBox = new NumericTextBox({\n            format: '#',\n            value: 2,\n            min: 1,\n            max: 63,\n            enablePersistence: false\n        });\n        this.columnValueTexBox.appendTo(this.columnsCountBox);\n    };\n    /**\n     * @private\n     */\n    TableDialog.prototype.show = function () {\n        var localValue = new L10n('documenteditor', this.owner.owner.defaultLocale);\n        localValue.setLocale(this.owner.owner.locale);\n        setCulture(this.owner.owner.locale);\n        if (!this.target) {\n            this.initTableDialog(localValue);\n        }\n        if (this.owner.selection.caret.style.display !== 'none') {\n            this.owner.selection.caret.style.display = 'none';\n        }\n        this.owner.dialog.header = localValue.getConstant('Insert Table');\n        this.owner.dialog.height = 'auto';\n        this.owner.dialog.width = 'auto';\n        this.owner.dialog.content = this.target;\n        this.owner.dialog.beforeOpen = this.owner.updateFocus;\n        this.owner.dialog.buttons = [{\n                click: this.onInsertTableClick,\n                buttonModel: { content: localValue.getConstant('Ok'), cssClass: 'e-flat e-table-ok', isPrimary: true }\n            },\n            {\n                click: this.onCancelButtonClick,\n                buttonModel: { content: localValue.getConstant('Cancel'), cssClass: 'e-flat e-table-cancel' }\n            }];\n        this.rowValueTextBox.value = 2;\n        this.columnValueTexBox.value = 2;\n        this.owner.dialog.close = this.owner.updateFocus;\n        this.owner.dialog.dataBind();\n        this.owner.dialog.show();\n    };\n    /**\n     * @private\n     */\n    TableDialog.prototype.destroy = function () {\n        if (this.columnsCountBox) {\n            if (this.columnsCountBox.parentElement) {\n                this.columnsCountBox.parentElement.removeChild(this.columnsCountBox);\n            }\n            this.columnsCountBox = undefined;\n        }\n        if (this.rowsCountBox) {\n            if (this.rowsCountBox.parentElement) {\n                this.rowsCountBox.parentElement.removeChild(this.rowsCountBox);\n            }\n            this.rowsCountBox = undefined;\n        }\n        if (this.columnValueTexBox) {\n            this.columnValueTexBox.destroy();\n            this.columnValueTexBox = undefined;\n        }\n        if (this.rowValueTextBox) {\n            this.rowValueTextBox.destroy();\n            this.rowValueTextBox = undefined;\n        }\n        this.columnsCountBox = undefined;\n        this.rowsCountBox = undefined;\n        this.owner = undefined;\n        if (!isNullOrUndefined(this.target)) {\n            if (this.target.parentElement) {\n                this.target.parentElement.removeChild(this.target);\n            }\n            for (var i = 0; i < this.target.childNodes.length; i++) {\n                this.target.removeChild(this.target.childNodes[i]);\n                i--;\n            }\n            this.target = undefined;\n        }\n    };\n    return TableDialog;\n}());\nexport { TableDialog };\n","import { ListView } from '@syncfusion/ej2-lists';\nimport { Button } from '@syncfusion/ej2-buttons';\nimport { createElement, L10n, setCulture } from '@syncfusion/ej2-base';\n/**\n * The Bookmark dialog is used to add, navigate or delete bookmarks.\n */\nvar BookmarkDialog = /** @class */ (function () {\n    /**\n     * @private\n     */\n    function BookmarkDialog(viewer) {\n        var _this = this;\n        this.addBookmark = function () {\n            _this.owner.owner.editorModule.insertBookmark(_this.textBoxInput.value);\n            _this.owner.dialog.hide();\n        };\n        /* tslint:disable:no-any */\n        this.selectHandler = function (args) {\n            _this.textBoxInput.value = args.text;\n            /* tslint:disable:no-any */\n            var value = document.getElementById('bookmark_text_box');\n            value.setSelectionRange(0, args.text.length);\n            value.focus();\n        };\n        this.gotoBookmark = function () {\n            _this.owner.selection.selectBookmark(_this.textBoxInput.value);\n        };\n        this.deleteBookmark = function () {\n            _this.owner.owner.editorModule.deleteBookmark(_this.textBoxInput.value);\n            _this.show();\n        };\n        this.owner = viewer;\n    }\n    /**\n     * @private\n     */\n    BookmarkDialog.prototype.getModuleName = function () {\n        return 'BookmarkDialog';\n    };\n    /**\n     * @private\n     */\n    BookmarkDialog.prototype.initBookmarkDialog = function (localValue, bookmarks) {\n        var instance = this;\n        var id = this.owner.owner.containerId + '_insert_bookmark';\n        this.target = createElement('div', { id: id, className: 'e-de-bookmark' });\n        var headerValue = localValue.getConstant('Bookmark name') + ':';\n        var dlgFields = createElement('div', { innerHTML: headerValue, className: 'e-bookmark-dlgfields' });\n        this.target.appendChild(dlgFields);\n        var commonDiv = createElement('div', { className: 'e-bookmark-common' });\n        this.target.appendChild(commonDiv);\n        var searchDiv = createElement('div', { className: 'e-bookmark-list' });\n        commonDiv.appendChild(searchDiv);\n        var textBoxDiv = createElement('div', { className: 'e-bookmark-textboxdiv' });\n        searchDiv.appendChild(textBoxDiv);\n        // tslint:disable-next-line:max-line-length\n        this.textBoxInput = createElement('input', { className: 'e-input e-bookmark-textbox-input', id: 'bookmark_text_box' });\n        this.textBoxInput.setAttribute('type', 'text');\n        textBoxDiv.appendChild(this.textBoxInput);\n        var listviewDiv = createElement('div', { className: 'e-bookmark-listViewDiv', id: 'bookmark_listview' });\n        searchDiv.appendChild(listviewDiv);\n        var arts = this.owner.bookmarks.keys;\n        this.listviewInstance = new ListView({\n            dataSource: bookmarks,\n            cssClass: 'e-bookmark-listview',\n        });\n        this.listviewInstance.appendTo(listviewDiv);\n        this.listviewInstance.addEventListener('select', this.selectHandler);\n        var buttonDiv = createElement('div', { className: 'e-bookmark-button' });\n        commonDiv.appendChild(buttonDiv);\n        var addbuttonDiv = createElement('div', { className: 'e-bookmark-addbutton' });\n        buttonDiv.appendChild(addbuttonDiv);\n        var addButtonElement = createElement('button', { innerHTML: 'Add', id: 'add' });\n        addbuttonDiv.appendChild(addButtonElement);\n        var addbutton = new Button({ cssClass: 'e-button-custom' });\n        addbutton.appendTo(addButtonElement);\n        addButtonElement.addEventListener('click', this.addBookmark);\n        var deleteButtonDiv = createElement('div', { className: 'e-bookmark-deletebutton' });\n        buttonDiv.appendChild(deleteButtonDiv);\n        var deleteButtonElement = createElement('button', { innerHTML: 'Delete', id: 'delete' });\n        deleteButtonDiv.appendChild(deleteButtonElement);\n        var deletebutton = new Button({ cssClass: 'e-button-custom' });\n        deletebutton.appendTo(deleteButtonElement);\n        deleteButtonElement.addEventListener('click', this.deleteBookmark);\n        var gotoButtonDiv = createElement('div', { className: 'e-bookmark-gotobutton' });\n        buttonDiv.appendChild(gotoButtonDiv);\n        var gotoButtonElement = createElement('button', { innerHTML: 'Go To', id: 'goto' });\n        gotoButtonDiv.appendChild(gotoButtonElement);\n        var gotobutton = new Button({ cssClass: 'e-button-custom' });\n        gotobutton.appendTo(gotoButtonElement);\n        gotoButtonElement.addEventListener('click', this.gotoBookmark);\n    };\n    /**\n     * @private\n     */\n    BookmarkDialog.prototype.show = function () {\n        var bookmarks = this.owner.getBookmarks();\n        var localObj = new L10n('documenteditor', this.owner.owner.defaultLocale);\n        localObj.setLocale(this.owner.owner.locale);\n        setCulture(this.owner.owner.locale);\n        // if (!this.target) {\n        this.initBookmarkDialog(localObj, bookmarks);\n        //}\n        this.owner.dialog.header = 'Bookmark';\n        this.owner.dialog.height = 'auto';\n        this.owner.dialog.width = 'auto';\n        this.owner.dialog.content = this.target;\n        this.owner.dialog.beforeOpen = this.owner.updateFocus;\n        this.owner.dialog.close = this.owner.updateFocus;\n        this.owner.dialog.buttons = [{\n                click: this.removeObjects.bind(this),\n                buttonModel: { content: localObj.getConstant('Cancel'), cssClass: 'e-flat e-hyper-insert', isPrimary: true }\n            }];\n        this.owner.dialog.dataBind();\n        this.owner.dialog.show();\n    };\n    BookmarkDialog.prototype.removeObjects = function () {\n        this.owner.dialog.hide();\n    };\n    /**\n     * @private\n     */\n    BookmarkDialog.prototype.destroy = function () {\n        if (this.textBoxInput) {\n            this.textBoxInput.remove();\n            this.textBoxInput = undefined;\n        }\n        if (this.listviewInstance) {\n            this.listviewInstance.destroy();\n            this.listviewInstance = undefined;\n        }\n    };\n    return BookmarkDialog;\n}());\nexport { BookmarkDialog };\n","import { L10n, setCulture, createElement, isNullOrUndefined } from '@syncfusion/ej2-base';\nimport { CheckBox, Button } from '@syncfusion/ej2-buttons';\nimport { DropDownList } from '@syncfusion/ej2-dropdowns';\nimport { NumericTextBox } from '@syncfusion/ej2-inputs';\nimport { ListView } from '@syncfusion/ej2-lists';\n/**\n * The Table of contents dialog is used to insert or edit table of contents at selection.\n */\nvar TableOfContentsDialog = /** @class */ (function () {\n    /**\n     * @private\n     */\n    function TableOfContentsDialog(viewer) {\n        var _this = this;\n        /**\n         * @private\n         */\n        this.loadTableofContentDialog = function () {\n            _this.owner.updateFocus();\n            _this.pageNumber.checked = true;\n            _this.rightAlign.disabled = false;\n            _this.rightAlign.checked = true;\n            _this.tabLeader.enabled = true;\n            _this.hyperlink.checked = true;\n            _this.style.checked = true;\n            _this.outline.checked = true;\n            _this.outline.disabled = false;\n            _this.showLevel.enabled = true;\n        };\n        /**\n         * @private\n         */\n        this.closeTableOfContentDialog = function () {\n            _this.unWireEventsAndBindings();\n            _this.owner.updateFocus();\n        };\n        /**\n         * @private\n         */\n        this.onCancelButtonClick = function () {\n            _this.owner.dialog.hide();\n            _this.unWireEventsAndBindings();\n        };\n        /* tslint:disable:no-any */\n        this.selectHandler = function (args) {\n            _this.textBoxInput.value = args.text;\n            /* tslint:disable:no-any */\n            var value = document.getElementById('toclist');\n            value.setSelectionRange(0, args.text.length);\n            value.focus();\n        };\n        this.showStyleDialog = function () {\n            if (!isNullOrUndefined(_this.owner.owner.styleDialogModule)) {\n                _this.owner.owner.styleDialogModule.show(_this.textBoxInput.value);\n            }\n        };\n        this.changeShowLevelValue = function (event) {\n            var levels = event.value;\n            var values = [];\n            switch (levels) {\n                case 1:\n                    values = ['1', null, null, null, null, null, null, null, null];\n                    _this.changeByValue(values);\n                    break;\n                case 2:\n                    values = ['1', '2', null, null, null, null, null, null, null];\n                    _this.changeByValue(values);\n                    break;\n                case 3:\n                    values = ['1', '2', '3', null, null, null, null, null, null];\n                    _this.changeByValue(values);\n                    break;\n                case 4:\n                    values = ['1', '2', '3', '4', null, null, null, null, null];\n                    _this.changeByValue(values);\n                    break;\n                case 5:\n                    values = ['1', '2', '3', '4', '5', null, null, null, null];\n                    _this.changeByValue(values);\n                    break;\n                case 6:\n                    values = ['1', '2', '3', '4', '5', '6', null, null, null];\n                    _this.changeByValue(values);\n                    break;\n                case 7:\n                    values = ['1', '2', '3', '4', '5', '6', '7', null, null];\n                    _this.changeByValue(values);\n                    break;\n                case 8:\n                    values = ['1', '2', '3', '4', '5', '6', '7', '8', null];\n                    _this.changeByValue(values);\n                    break;\n                case 9:\n                    values = ['1', '2', '3', '4', '5', '6', '7', '8', '9'];\n                    _this.changeByValue(values);\n                    break;\n            }\n        };\n        this.changeByValue = function (headings) {\n            _this.heading1.value = headings[0];\n            _this.heading2.value = headings[1];\n            _this.heading3.value = headings[2];\n            _this.heading4.value = headings[3];\n            _this.heading5.value = headings[4];\n            _this.heading6.value = headings[5];\n            _this.heading7.value = headings[6];\n            _this.heading8.value = headings[7];\n            _this.heading9.value = headings[8];\n        };\n        this.reset = function () {\n            _this.showLevel.enabled = true;\n            _this.showLevel.value = 3;\n            _this.outline.disabled = false;\n            _this.outline.checked = true;\n            var values = ['1', '2', '3', null, null, null, null, null, null];\n            _this.changeByValue(values);\n            _this.normal.value = null;\n        };\n        this.changeStyle = function (args) {\n            var headingValue = args.srcElement.value;\n            var value = _this.getElementValue(args.srcElement);\n            if (headingValue !== value && headingValue !== '') {\n                _this.showLevel.enabled = false;\n            }\n            else {\n                _this.showLevel.enabled = true;\n                _this.checkLevel();\n            }\n        };\n        this.changeHeadingStyle = function (args) {\n            var headingValue = args.srcElement.value;\n            if (headingValue === '') {\n                _this.showLevel.enabled = true;\n            }\n            else {\n                _this.showLevel.enabled = false;\n            }\n            if (_this.normal === args.srcElement) {\n                _this.outline.checked = false;\n                _this.outline.disabled = true;\n            }\n        };\n        /**\n         * @private\n         */\n        this.changePageNumberValue = function (args) {\n            if (args.checked) {\n                _this.rightAlign.checked = true;\n                _this.rightAlign.disabled = false;\n                _this.tabLeader.enabled = true;\n            }\n            else {\n                _this.rightAlign.disabled = true;\n                _this.tabLeader.enabled = false;\n            }\n        };\n        /**\n         * @private\n         */\n        this.changeRightAlignValue = function (args) {\n            if (args.checked) {\n                _this.tabLeader.enabled = true;\n            }\n            else {\n                _this.tabLeader.enabled = false;\n            }\n        };\n        /**\n         * @private\n         */\n        this.changeStyleValue = function (args) {\n            if (args.checked) {\n                _this.heading1.disabled = false;\n                _this.heading2.disabled = false;\n                _this.heading3.disabled = false;\n                _this.heading4.disabled = false;\n                _this.heading5.disabled = false;\n                _this.heading6.disabled = false;\n                _this.heading7.disabled = false;\n                _this.heading8.disabled = false;\n                _this.heading9.disabled = false;\n                _this.normal.disabled = false;\n            }\n            else {\n                _this.heading1.disabled = true;\n                _this.heading2.disabled = true;\n                _this.heading3.disabled = true;\n                _this.heading4.disabled = true;\n                _this.heading5.disabled = true;\n                _this.heading6.disabled = true;\n                _this.heading7.disabled = true;\n                _this.heading8.disabled = true;\n                _this.heading9.disabled = true;\n                _this.normal.disabled = true;\n            }\n        };\n        /**\n         * @private\n         */\n        this.applyTableOfContentProperties = function () {\n            var tocSettings = {\n                startLevel: 1,\n                endLevel: _this.showLevel.value,\n                includeHyperlink: _this.hyperlink.checked,\n                includePageNumber: _this.pageNumber.checked,\n                rightAlign: _this.rightAlign.checked,\n                tabLeader: _this.tabLeader.value,\n                includeOutlineLevels: _this.outline.checked\n            };\n            _this.applyLevelSetting(tocSettings);\n            _this.owner.owner.editorModule.insertTableOfContents(tocSettings);\n            _this.owner.dialog.hide();\n        };\n        /**\n         * @private\n         */\n        this.unWireEventsAndBindings = function () {\n            _this.pageNumber.checked = false;\n            _this.rightAlign.checked = false;\n            _this.tabLeader.value = '';\n            _this.hyperlink.checked = false;\n            _this.style.checked = false;\n            _this.outline.checked = false;\n            _this.normal.value = '';\n        };\n        this.owner = viewer;\n    }\n    TableOfContentsDialog.prototype.getModuleName = function () {\n        return 'TableOfContentsDialog';\n    };\n    /*tslint:disable max-func-body-length*/\n    /**\n     * @private\n     */\n    TableOfContentsDialog.prototype.initTableOfContentDialog = function (locale) {\n        var instance = this;\n        var ownerId = this.owner.owner.containerId;\n        var id = ownerId + '_toc_dialog';\n        this.target = createElement('div', { id: id, className: 'e-de-toc-dlg-container' });\n        this.owner.owner.element.appendChild(this.target);\n        // tslint:disable-next-line:max-line-length\n        var generalDiv = createElement('div', { id: 'general_div', className: 'e-de-toc-dlg-sub-container' });\n        this.target.appendChild(generalDiv);\n        // tslint:disable-next-line:max-line-length\n        var genLabel = createElement('div', { id: ownerId + '_genLabel', className: 'e-de-toc-dlg-main-heading', styles: 'margin-bottom: 13px;', innerHTML: locale.getConstant('General') });\n        generalDiv.appendChild(genLabel);\n        // tslint:disable-next-line:max-line-length\n        var leftGeneralDiv = createElement('div', { id: 'left_general', styles: 'float:left;position:relative;' });\n        generalDiv.appendChild(leftGeneralDiv);\n        // tslint:disable-next-line:max-line-length\n        var rightGeneralDiv = createElement('div', { styles: 'position:relative;', className: 'e-de-toc-dlg-right-general-div' });\n        generalDiv.appendChild(rightGeneralDiv);\n        // tslint:disable-next-line:max-line-length\n        var leftBottomGeneralDiv = createElement('div', { id: 'leftBottom_general', styles: 'float:left;position:absolute;top:210px;' });\n        generalDiv.appendChild(leftBottomGeneralDiv);\n        // tslint:disable-next-line:max-line-length\n        var rightBottomGeneralDiv = createElement('div', { className: 'e-de-toc-dlg-right-sub-container', styles: 'float:right;' });\n        generalDiv.appendChild(rightBottomGeneralDiv);\n        // tslint:disable-next-line:max-line-length\n        var pageNumberDiv = createElement('div', { id: 'pageNumber_div', className: 'e-de-toc-dlg-sub-container' });\n        var pageNumber = createElement('input', {\n            attrs: { 'type': 'checkbox' }, id: this.target.id + '_pageNumber'\n        });\n        pageNumberDiv.appendChild(pageNumber);\n        // tslint:disable-next-line:max-line-length\n        var rightAlignDiv = createElement('div', { id: 'rightAlign_div', className: 'e-de-toc-dlg-sub-container' });\n        var rightAlign = createElement('input', {\n            attrs: { 'type': 'checkbox' }, id: this.target.id + '_rightAlign'\n        });\n        rightAlignDiv.appendChild(rightAlign);\n        // tslint:disable-next-line:max-line-length\n        this.pageNumber = new CheckBox({ label: locale.getConstant('Show page numbers'), checked: true, change: this.changePageNumberValue });\n        // tslint:disable-next-line:max-line-length\n        this.rightAlign = new CheckBox({ label: locale.getConstant('Right align page numbers'), checked: true, change: this.changeRightAlignValue });\n        this.pageNumber.appendTo(pageNumber);\n        this.rightAlign.appendTo(rightAlign);\n        var tabDiv = createElement('div', { id: 'tab_div', className: 'e-de-toc-dlg-tab-div' });\n        // tslint:disable-next-line:max-line-length\n        var tabLeaderLabelDiv = createElement('div', { id: 'tabLeaderLabel_div' });\n        // tslint:disable-next-line:max-line-length\n        var tabLeaderLabel = createElement('label', { id: ownerId + '_tabLeaderLabel', className: 'e-de-toc-dlg-heading', innerHTML: locale.getConstant('Tab leader') + ':' });\n        tabLeaderLabelDiv.appendChild(tabLeaderLabel);\n        var tabLeaderDiv = createElement('div', { id: 'tabLeader_div' });\n        var tabLeader = createElement('select', {\n            id: ownerId + '_tabLeader',\n            innerHTML: '<option value=\"None\">' + '(' + locale.getConstant('None').toLocaleLowerCase() + ')' +\n                '</option><option value=\"Dot\" selected>' + '....................' +\n                '</option><option value=\"Hyphen\">' + '-------------------' +\n                '</option><option value=\"Underscore\">' + '____________' + '</option>'\n        });\n        tabLeaderDiv.appendChild(tabLeader);\n        tabDiv.appendChild(tabLeaderLabelDiv);\n        tabDiv.appendChild(tabLeaderDiv);\n        leftGeneralDiv.appendChild(pageNumberDiv);\n        leftGeneralDiv.appendChild(rightAlignDiv);\n        leftGeneralDiv.appendChild(tabDiv);\n        this.tabLeader = new DropDownList({ width: 210 });\n        this.tabLeader.appendTo(tabLeader);\n        var hyperlink = createElement('input', {\n            attrs: { 'type': 'checkbox' }, id: this.target.id + '_hyperlink'\n        });\n        rightGeneralDiv.appendChild(hyperlink);\n        this.hyperlink = new CheckBox({ label: locale.getConstant('Use hyperlinks instead of page numbers'), checked: true });\n        this.hyperlink.appendTo(hyperlink);\n        // tslint:disable-next-line:max-line-length\n        var showDiv = createElement('div', { id: 'show_div', className: 'e-de-toc-dlg-style-label' });\n        // tslint:disable-next-line:max-line-length\n        var showLevelLabelDiv = createElement('div', { id: 'showLevelLabel_div', className: 'e-de-toc-dlg-show-level-div' });\n        // tslint:disable-next-line:max-line-length\n        var showLevelLabel = createElement('label', { id: ownerId + '_showLevelLabel', className: 'e-de-toc-dlg-heading', innerHTML: locale.getConstant('Show levels') + ':' });\n        showLevelLabelDiv.appendChild(showLevelLabel);\n        // tslint:disable-next-line:max-line-length\n        var showLevelDiv = createElement('div', { id: 'showLevel_div', className: 'e-de-toc-dlg-showlevel-div' });\n        // tslint:disable-next-line:max-line-length\n        var showLevel = createElement('input', { id: ownerId + '_showLevel', attrs: { 'type': 'text' } });\n        showLevelDiv.appendChild(showLevel);\n        showDiv.appendChild(showLevelLabelDiv);\n        showDiv.appendChild(showLevelDiv);\n        rightGeneralDiv.appendChild(showDiv);\n        this.showLevel = new NumericTextBox({ format: '#', value: 3, min: 1, max: 9, width: 210, change: this.changeShowLevelValue });\n        this.showLevel.appendTo(showLevel);\n        // tslint:disable-next-line:max-line-length\n        var buildTableDiv = createElement('div', { id: 'buildTable_div', className: 'e-de-toc-dlg-sub-container' });\n        // tslint:disable-next-line:max-line-length\n        var buildTableLabel = createElement('div', { id: ownerId + '_buildTableLabel', className: 'e-de-toc-dlg-main-heading e-de-toc-dlg-build-table', styles: 'margin-bottom: 13px;', innerHTML: locale.getConstant('Build table of contents from') + ':' });\n        leftBottomGeneralDiv.appendChild(buildTableDiv);\n        leftBottomGeneralDiv.appendChild(buildTableLabel);\n        var style = createElement('input', {\n            attrs: { 'type': 'checkbox' }, id: this.target.id + '_style',\n        });\n        leftBottomGeneralDiv.appendChild(style);\n        this.style = new CheckBox({ label: locale.getConstant('Styles'), checked: true, change: this.changeStyleValue });\n        this.style.appendTo(style);\n        var table = createElement('TABLE', { styles: 'margin-top:3px;' });\n        var tr1 = createElement('tr');\n        var td1 = createElement('td', { styles: 'width:120px;padding-left:10px;' });\n        var availableLabel = createElement('label', {\n            // tslint:disable-next-line:max-line-length\n            innerHTML: locale.getConstant('Available styles'), className: 'e-de-toc-dlg-main-heading e-de-toc-dlg-sub-level-heading', id: this.target.id + '_availableLabel'\n        });\n        td1.appendChild(availableLabel);\n        var td2 = createElement('td');\n        var tocLabel = createElement('label', {\n            innerHTML: locale.getConstant('TOC level') + ':', className: 'e-de-toc-dlg-main-heading e-de-toc-dlg-sub-level-heading',\n            id: this.target.id + '_tocLabel'\n        });\n        td2.appendChild(tocLabel);\n        tr1.appendChild(td1);\n        tr1.appendChild(td2);\n        table.appendChild(tr1);\n        // tslint:disable-next-line:max-line-length\n        var tableDiv = createElement('div', { id: 'table_div', className: 'e-de-toc-table-div' });\n        var table1 = createElement('TABLE');\n        var tr2 = createElement('tr');\n        var td3 = createElement('td');\n        var heading1Label = createElement('label', {\n            innerHTML: locale.getConstant('Heading') + ' 1',\n            className: 'e-de-toc-dlg-sub-heading', id: this.target.id + '_heading1Label'\n        });\n        td3.appendChild(heading1Label);\n        var td4 = createElement('td');\n        this.heading1 = createElement('input', { id: '_heading1', className: 'e-input e-de-toc-dlg-toc-level' });\n        this.heading1.value = '1';\n        this.heading1.addEventListener('keyup', this.changeStyle);\n        td4.appendChild(this.heading1);\n        tr2.appendChild(td3);\n        tr2.appendChild(td4);\n        var tr3 = createElement('tr');\n        var td5 = createElement('td');\n        var heading2Label = createElement('label', {\n            innerHTML: locale.getConstant('Heading') + ' 2',\n            className: 'e-de-toc-dlg-sub-heading', id: this.target.id + '_heading2Label'\n        });\n        td5.appendChild(heading2Label);\n        var td6 = createElement('td');\n        this.heading2 = createElement('input', { id: '_heading2', className: 'e-input e-de-toc-dlg-toc-level' });\n        this.heading2.value = '2';\n        this.heading2.addEventListener('keyup', this.changeStyle);\n        td6.appendChild(this.heading2);\n        tr3.appendChild(td5);\n        tr3.appendChild(td6);\n        var tr4 = createElement('tr');\n        var td7 = createElement('td');\n        var heading3Label = createElement('label', {\n            innerHTML: locale.getConstant('Heading') + ' 3',\n            className: 'e-de-toc-dlg-sub-heading', id: this.target.id + '_heading3Label'\n        });\n        td7.appendChild(heading3Label);\n        var td8 = createElement('td');\n        this.heading3 = createElement('input', { id: '_heading3', className: 'e-input e-de-toc-dlg-toc-level' });\n        this.heading3.value = '3';\n        this.heading3.addEventListener('keyup', this.changeStyle);\n        td8.appendChild(this.heading3);\n        tr4.appendChild(td7);\n        tr4.appendChild(td8);\n        var tr5 = createElement('tr');\n        var td9 = createElement('td');\n        var heading4Label = createElement('label', {\n            innerHTML: locale.getConstant('Heading') + ' 4',\n            className: 'e-de-toc-dlg-sub-heading', id: this.target.id + '_heading4Label'\n        });\n        td9.appendChild(heading4Label);\n        var td10 = createElement('td');\n        this.heading4 = createElement('input', { id: '_heading4', className: 'e-input e-de-toc-dlg-toc-level' });\n        this.heading4.addEventListener('keyup', this.changeStyle);\n        td10.appendChild(this.heading4);\n        tr5.appendChild(td9);\n        tr5.appendChild(td10);\n        var tr6 = createElement('tr');\n        var td11 = createElement('td');\n        var heading5Label = createElement('label', {\n            innerHTML: locale.getConstant('Heading') + ' 5',\n            className: 'e-de-toc-dlg-sub-heading', id: this.target.id + '_heading5Label'\n        });\n        td11.appendChild(heading5Label);\n        var td12 = createElement('td');\n        this.heading5 = createElement('input', { id: '_heading5', className: 'e-input e-de-toc-dlg-toc-level' });\n        this.heading5.addEventListener('keyup', this.changeStyle);\n        td12.appendChild(this.heading5);\n        tr6.appendChild(td11);\n        tr6.appendChild(td12);\n        var tr7 = createElement('tr');\n        var td13 = createElement('td');\n        var heading6Label = createElement('label', {\n            innerHTML: locale.getConstant('Heading') + ' 6',\n            className: 'e-de-toc-dlg-sub-heading', id: this.target.id + '_heading6Label'\n        });\n        td13.appendChild(heading6Label);\n        var td14 = createElement('td');\n        this.heading6 = createElement('input', { id: '_heading6', className: 'e-input e-de-toc-dlg-toc-level' });\n        this.heading6.addEventListener('keyup', this.changeStyle);\n        td14.appendChild(this.heading6);\n        tr7.appendChild(td13);\n        tr7.appendChild(td14);\n        var tr8 = createElement('tr');\n        var td15 = createElement('td');\n        var heading7Label = createElement('label', {\n            innerHTML: locale.getConstant('Heading') + ' 7',\n            className: 'e-de-toc-dlg-sub-heading', id: this.target.id + '_heading7Label'\n        });\n        td15.appendChild(heading7Label);\n        var td16 = createElement('td');\n        this.heading7 = createElement('input', { id: '_heading7', className: 'e-input e-de-toc-dlg-toc-level' });\n        this.heading7.addEventListener('keyup', this.changeStyle);\n        td16.appendChild(this.heading7);\n        tr8.appendChild(td15);\n        tr8.appendChild(td16);\n        var tr9 = createElement('tr');\n        var td17 = createElement('td');\n        var heading8Label = createElement('label', {\n            innerHTML: locale.getConstant('Heading') + ' 8',\n            className: 'e-de-toc-dlg-sub-heading', id: this.target.id + '_heading8Label'\n        });\n        td17.appendChild(heading8Label);\n        var td18 = createElement('td');\n        this.heading8 = createElement('input', { id: '_heading8', className: 'e-input e-de-toc-dlg-toc-level' });\n        this.heading8.addEventListener('keyup', this.changeStyle);\n        td18.appendChild(this.heading8);\n        tr9.appendChild(td17);\n        tr9.appendChild(td18);\n        var tr10 = createElement('tr');\n        var td19 = createElement('td');\n        var heading9Label = createElement('label', {\n            innerHTML: locale.getConstant('Heading') + ' 9',\n            className: 'e-de-toc-dlg-sub-heading', id: this.target.id + '_heading9Label'\n        });\n        td19.appendChild(heading9Label);\n        var td20 = createElement('td');\n        this.heading9 = createElement('input', { id: '_heading9', className: 'e-input e-de-toc-dlg-toc-level' });\n        this.heading9.addEventListener('keyup', this.changeStyle);\n        td20.appendChild(this.heading9);\n        tr10.appendChild(td19);\n        tr10.appendChild(td20);\n        var tr12 = createElement('tr');\n        var td23 = createElement('td');\n        var normalLabel = createElement('label', {\n            innerHTML: locale.getConstant('Normal'),\n            className: 'e-de-toc-dlg-sub-heading', id: this.target.id + '_normalLabel'\n        });\n        td23.appendChild(normalLabel);\n        var td24 = createElement('td');\n        this.normal = createElement('input', { id: '_normal', className: 'e-input e-de-toc-dlg-toc-level' });\n        this.normal.addEventListener('keyup', this.changeHeadingStyle);\n        td24.appendChild(this.normal);\n        tr12.appendChild(td23);\n        tr12.appendChild(td24);\n        table1.appendChild(tr2);\n        table1.appendChild(tr3);\n        table1.appendChild(tr4);\n        table1.appendChild(tr5);\n        table1.appendChild(tr6);\n        table1.appendChild(tr7);\n        table1.appendChild(tr8);\n        table1.appendChild(tr9);\n        table1.appendChild(tr10);\n        table1.appendChild(tr12);\n        tableDiv.appendChild(table1);\n        var stylesLevelDiv = createElement('div', { className: 'e-de-toc-styles-table-div' });\n        stylesLevelDiv.appendChild(table);\n        stylesLevelDiv.appendChild(tableDiv);\n        leftBottomGeneralDiv.appendChild(stylesLevelDiv);\n        //leftBottomGeneralDiv.appendChild(table); leftBottomGeneralDiv.appendChild(tableDiv);\n        var fieldsDiv = createElement('div', { id: 'fields_div', styles: 'display: flex;' });\n        leftBottomGeneralDiv.appendChild(fieldsDiv);\n        var outDiv = createElement('div', { id: 'out_div' });\n        // tslint:disable-next-line:max-line-length\n        var outlineDiv = createElement('div', { id: 'outline_div', className: 'e-de-toc-dlg-sub-container e-de-toc-dlg-outline-levels' });\n        var outline = createElement('input', {\n            attrs: { 'type': 'checkbox' }, id: '_outline'\n        });\n        outlineDiv.appendChild(outline);\n        outDiv.appendChild(outlineDiv);\n        fieldsDiv.appendChild(outDiv);\n        this.outline = new CheckBox({ label: locale.getConstant('Outline levels'), checked: true });\n        this.outline.appendTo(outline);\n        var resetButtonDiv = createElement('div', { className: 'e-de-toc-reset-button' });\n        fieldsDiv.appendChild(resetButtonDiv);\n        var resetElement = createElement('button', { innerHTML: 'Reset', id: 'reset' });\n        resetButtonDiv.appendChild(resetElement);\n        var resetButton = new Button({ cssClass: 'e-btn e-flat' });\n        resetButton.appendTo(resetElement);\n        resetElement.addEventListener('click', this.reset);\n        // tslint:disable-next-line:max-line-length\n        var tocStylesDiv = createElement('div', { id: 'tocStyles_div', className: 'e-de-toc-dlg-sub-container' });\n        // tslint:disable-next-line:max-line-length\n        var tocStylesLabel = createElement('div', {\n            id: ownerId + '_tocStylesLabel', className: 'e-de-toc-dlg-main-heading e-de-toc-dlg-styles',\n            innerHTML: locale.getConstant('Styles') + ':'\n        });\n        rightBottomGeneralDiv.appendChild(tocStylesDiv);\n        rightBottomGeneralDiv.appendChild(tocStylesLabel);\n        var textBoxDiv = createElement('div', { className: 'e-de-toc-dlg-style-input' });\n        rightBottomGeneralDiv.appendChild(textBoxDiv);\n        this.textBoxInput = createElement('input', { className: 'e-input', id: 'toclist' });\n        this.textBoxInput.setAttribute('type', 'text');\n        textBoxDiv.appendChild(this.textBoxInput);\n        var listViewDiv = createElement('div', { className: 'e-de-toc-list-view' });\n        var styleValues = ['TOC 1', 'TOC 2', 'TOC 3', 'TOC 4', 'TOC 5', 'TOC 6', 'TOC 7', 'TOC 8', 'TOC 9'];\n        this.listViewInstance = new ListView({ dataSource: styleValues, cssClass: 'e-toc-list-view' });\n        this.listViewInstance.appendTo(listViewDiv);\n        this.listViewInstance.addEventListener('select', this.selectHandler);\n        rightBottomGeneralDiv.appendChild(listViewDiv);\n        var modifyButtonDiv = createElement('div', { className: 'e-de-toc-modify-button' });\n        rightBottomGeneralDiv.appendChild(modifyButtonDiv);\n        var modifyElement = createElement('button', { innerHTML: 'Modify', id: 'modify' });\n        modifyButtonDiv.appendChild(modifyElement);\n        var modifyButton = new Button({ cssClass: 'e-btn e-flat' });\n        modifyButton.appendTo(modifyElement);\n        modifyElement.addEventListener('click', this.showStyleDialog);\n    };\n    /**\n     * @private\n     */\n    TableOfContentsDialog.prototype.show = function () {\n        var localValue = new L10n('documenteditor', this.owner.owner.defaultLocale);\n        localValue.setLocale(this.owner.owner.locale);\n        setCulture(this.owner.owner.locale);\n        if (!this.target) {\n            this.initTableOfContentDialog(localValue);\n        }\n        this.owner.dialog.header = localValue.getConstant('Table of Contents');\n        this.owner.dialog.width = 'auto';\n        this.owner.dialog.height = 'auto';\n        this.owner.dialog.content = this.target;\n        this.owner.dialog.beforeOpen = this.loadTableofContentDialog;\n        this.owner.dialog.close = this.closeTableOfContentDialog;\n        this.owner.dialog.buttons = [{\n                click: this.applyTableOfContentProperties,\n                buttonModel: { content: localValue.getConstant('Ok'), cssClass: 'e-flat e-toc-okay', isPrimary: true }\n            },\n            {\n                click: this.onCancelButtonClick,\n                buttonModel: { content: localValue.getConstant('Cancel'), cssClass: 'e-flat e-toc-cancel' }\n            }];\n        this.owner.dialog.dataBind();\n        this.owner.dialog.show();\n    };\n    TableOfContentsDialog.prototype.checkLevel = function () {\n        if (this.heading1.value !== '') {\n            this.showLevel.value = 1;\n        }\n        if (this.heading2.value !== '') {\n            this.showLevel.value = 2;\n        }\n        if (this.heading3.value !== '') {\n            this.showLevel.value = 3;\n        }\n        if (this.heading4.value !== '') {\n            this.showLevel.value = 4;\n        }\n        if (this.heading5.value !== '') {\n            this.showLevel.value = 5;\n        }\n        if (this.heading6.value !== '') {\n            this.showLevel.value = 6;\n        }\n        if (this.heading7.value !== '') {\n            this.showLevel.value = 7;\n        }\n        if (this.heading8.value !== '') {\n            this.showLevel.value = 8;\n        }\n        if (this.heading9.value !== '') {\n            this.showLevel.value = 9;\n        }\n    };\n    TableOfContentsDialog.prototype.getElementValue = function (element) {\n        switch (element) {\n            case this.heading1:\n                return '1';\n            case this.heading2:\n                return '2';\n            case this.heading3:\n                return '3';\n            case this.heading4:\n                return '4';\n            case this.heading5:\n                return '5';\n            case this.heading6:\n                return '6';\n            case this.heading7:\n                return '7';\n            case this.heading8:\n                return '8';\n            case this.heading9:\n                return '9';\n            default:\n                return '1';\n        }\n    };\n    TableOfContentsDialog.prototype.getHeadingLevel = function (index) {\n        switch (index) {\n            case 1:\n                return parseInt(this.heading1.value);\n            case 2:\n                return parseInt(this.heading2.value);\n            case 3:\n                return parseInt(this.heading3.value);\n            case 4:\n                return parseInt(this.heading4.value);\n            case 5:\n                return parseInt(this.heading5.value);\n            case 6:\n                return parseInt(this.heading6.value);\n            case 7:\n                return parseInt(this.heading7.value);\n            case 8:\n                return parseInt(this.heading8.value);\n            case 9:\n                return parseInt(this.heading9.value);\n            default:\n                return 0;\n        }\n    };\n    TableOfContentsDialog.prototype.applyLevelSetting = function (tocSettings) {\n        tocSettings.levelSettings = {};\n        var headingPrefix = 'Heading ';\n        var newStartLevel = 0;\n        var newEndLevel = 0;\n        var isEndLevel = false;\n        for (var i = 1; i <= tocSettings.endLevel; i++) {\n            var outlineLevel = this.getHeadingLevel(i);\n            if (i === outlineLevel) {\n                if (newStartLevel === 0) {\n                    newStartLevel = i;\n                    isEndLevel = false;\n                }\n                if (!isEndLevel) {\n                    newEndLevel = i;\n                }\n            }\n            else {\n                isEndLevel = true;\n                if (outlineLevel !== 0) {\n                    var headingStyle = headingPrefix + i.toString();\n                    tocSettings.levelSettings[headingStyle] = outlineLevel;\n                }\n            }\n        }\n        tocSettings.startLevel = newStartLevel;\n        tocSettings.endLevel = newEndLevel;\n        if (this.normal.value !== '') {\n            tocSettings.levelSettings['Normal'] = +this.normal.value;\n        }\n    };\n    /**\n     * @private\n     */\n    TableOfContentsDialog.prototype.destroy = function () {\n        if (this.pageNumber) {\n            this.pageNumber.destroy();\n            this.pageNumber = undefined;\n        }\n        if (this.rightAlign) {\n            this.rightAlign.destroy();\n            this.rightAlign = undefined;\n        }\n        if (this.tabLeader) {\n            this.tabLeader.destroy();\n            this.tabLeader = undefined;\n        }\n        if (this.showLevel) {\n            this.showLevel.destroy();\n            this.showLevel = undefined;\n        }\n        if (this.hyperlink) {\n            this.hyperlink.destroy();\n            this.hyperlink = undefined;\n        }\n        if (this.style) {\n            this.style.destroy();\n            this.style = undefined;\n        }\n        if (this.outline) {\n            this.outline.destroy();\n            this.outline = undefined;\n        }\n        if (this.listViewInstance) {\n            this.listViewInstance.destroy();\n            this.listViewInstance = undefined;\n        }\n        this.heading1 = undefined;\n        this.heading2 = undefined;\n        this.heading3 = undefined;\n        this.heading4 = undefined;\n        this.heading5 = undefined;\n        this.heading6 = undefined;\n        this.heading7 = undefined;\n        this.heading8 = undefined;\n        this.heading9 = undefined;\n        this.normal = undefined;\n        this.textBoxInput = undefined;\n        this.owner = undefined;\n        if (!isNullOrUndefined(this.target)) {\n            if (this.target.parentElement) {\n                this.target.parentElement.removeChild(this.target);\n            }\n            for (var count = 0; count < this.target.childNodes.length; count++) {\n                this.target.removeChild(this.target.childNodes[count]);\n                count--;\n            }\n            this.target = undefined;\n        }\n    };\n    return TableOfContentsDialog;\n}());\nexport { TableOfContentsDialog };\n","import { NumericTextBox } from '@syncfusion/ej2-inputs';\nimport { createElement, L10n, setCulture } from '@syncfusion/ej2-base';\nimport { DropDownList } from '@syncfusion/ej2-dropdowns';\nimport { CheckBox, RadioButton } from '@syncfusion/ej2-buttons';\nimport { isNullOrUndefined } from '@syncfusion/ej2-base';\nimport { WSectionFormat } from './../../implementation/format/index';\nimport { Tab } from '@syncfusion/ej2-navigations';\n/**\n * The Page setup dialog is used to modify formatting of selected sections.\n */\nvar PageSetupDialog = /** @class */ (function () {\n    /**\n     * @private\n     */\n    function PageSetupDialog(viewer) {\n        var _this = this;\n        this.isPortrait = true;\n        /**\n         * @private\n         */\n        this.loadPageSetupDialog = function () {\n            _this.owner.updateFocus();\n            var sectionFormat = _this.owner.selection.sectionFormat;\n            _this.topMarginBox.value = sectionFormat.topMargin;\n            _this.leftMarginBox.value = sectionFormat.leftMargin;\n            _this.bottomMarginBox.value = sectionFormat.bottomMargin;\n            _this.rightMarginBox.value = sectionFormat.rightMargin;\n            _this.widthBox.value = sectionFormat.pageWidth;\n            _this.heightBox.value = sectionFormat.pageHeight;\n            _this.checkBox1.checked = sectionFormat.differentOddAndEvenPages;\n            _this.checkBox2.checked = sectionFormat.differentFirstPage;\n            _this.headerBox.value = sectionFormat.headerDistance;\n            _this.footerBox.value = sectionFormat.footerDistance;\n            if (_this.widthBox.value > _this.heightBox.value) {\n                _this.landscape.checked = true;\n            }\n            else {\n                _this.portrait.checked = true;\n            }\n        };\n        /**\n         * @private\n         */\n        this.closePageSetupDialog = function () {\n            _this.unWireEventsAndBindings();\n            _this.owner.updateFocus();\n        };\n        /**\n         * @private\n         */\n        this.onCancelButtonClick = function () {\n            _this.owner.dialog.hide();\n            _this.unWireEventsAndBindings();\n        };\n        /**\n         * @private\n         */\n        this.keyUpInsertPageSettings = function (event) {\n            if (event.keyCode === 13) {\n                _this.applyPageSetupProperties();\n            }\n        };\n        /**\n         * @private\n         */\n        this.applyPageSetupProperties = function () {\n            var sectionFormat = new WSectionFormat();\n            sectionFormat.bottomMargin = _this.bottomMarginBox.value;\n            sectionFormat.topMargin = _this.topMarginBox.value;\n            sectionFormat.leftMargin = _this.leftMarginBox.value;\n            sectionFormat.rightMargin = _this.rightMarginBox.value;\n            sectionFormat.pageWidth = _this.widthBox.value;\n            sectionFormat.pageHeight = _this.heightBox.value;\n            sectionFormat.differentOddAndEvenPages = _this.checkBox1.checked;\n            sectionFormat.differentFirstPage = _this.checkBox2.checked;\n            sectionFormat.headerDistance = _this.headerBox.value;\n            sectionFormat.footerDistance = _this.footerBox.value;\n            _this.owner.owner.editorModule.onApplySectionFormat(undefined, sectionFormat);\n            _this.owner.dialog.hide();\n        };\n        /**\n         * @private\n         */\n        this.changeByPaperSize = function (event) {\n            var value = event.value;\n            var sectionFormat = _this.owner.selection.sectionFormat;\n            var width = sectionFormat.pageWidth;\n            var height = sectionFormat.pageHeight;\n            if (_this.owner.selection.sectionFormat.pageWidth > _this.owner.selection.sectionFormat.pageHeight || _this.landscape.checked) {\n                _this.isPortrait = false;\n            }\n            else {\n                _this.isPortrait = true;\n            }\n            if (value === 'letter') {\n                if (_this.isPortrait) {\n                    _this.widthBox.value = 612;\n                    _this.heightBox.value = 792;\n                }\n                else {\n                    _this.widthBox.value = 792;\n                    _this.heightBox.value = 612;\n                }\n            }\n            else if (value === 'tabloid') {\n                if (_this.isPortrait) {\n                    _this.widthBox.value = 792;\n                    _this.heightBox.value = 1224;\n                }\n                else {\n                    _this.widthBox.value = 1224;\n                    _this.heightBox.value = 792;\n                }\n            }\n            else if (value === 'legal') {\n                if (_this.isPortrait) {\n                    _this.widthBox.value = 612;\n                    _this.heightBox.value = 1008;\n                }\n                else {\n                    _this.widthBox.value = 1008;\n                    _this.heightBox.value = 612;\n                }\n            }\n            else if (value === 'statement') {\n                if (_this.isPortrait) {\n                    _this.widthBox.value = 392;\n                    _this.heightBox.value = 612;\n                }\n                else {\n                    _this.widthBox.value = 612;\n                    _this.heightBox.value = 392;\n                }\n            }\n            else if (value === 'executive') {\n                if (_this.isPortrait) {\n                    _this.widthBox.value = 522;\n                    _this.heightBox.value = 756;\n                }\n                else {\n                    _this.widthBox.value = 756;\n                    _this.heightBox.value = 522;\n                }\n            }\n            else if (value === 'a3') {\n                if (_this.isPortrait) {\n                    _this.widthBox.value = 841.9;\n                    _this.heightBox.value = 1190.55;\n                }\n                else {\n                    _this.widthBox.value = 1190.55;\n                    _this.heightBox.value = 841.9;\n                }\n            }\n            else if (value === 'a4') {\n                if (_this.isPortrait) {\n                    _this.widthBox.value = 595.3;\n                    _this.heightBox.value = 841.9;\n                }\n                else {\n                    _this.widthBox.value = 841.9;\n                    _this.heightBox.value = 595.3;\n                }\n            }\n            else if (value === 'a5') {\n                if (_this.isPortrait) {\n                    _this.widthBox.value = 419.55;\n                    _this.heightBox.value = 595.3;\n                }\n                else {\n                    _this.widthBox.value = 595.3;\n                    _this.heightBox.value = 419.55;\n                }\n            }\n            else if (value === 'b4') {\n                if (_this.isPortrait) {\n                    _this.widthBox.value = 728.5;\n                    _this.heightBox.value = 1031.8;\n                }\n                else {\n                    _this.widthBox.value = 1031.8;\n                    _this.heightBox.value = 728.5;\n                }\n            }\n            else if (value === 'b5') {\n                if (_this.isPortrait) {\n                    _this.widthBox.value = 515.9;\n                    _this.heightBox.value = 728.5;\n                }\n                else {\n                    _this.widthBox.value = 728.5;\n                    _this.heightBox.value = 515.9;\n                }\n            }\n            else if (value === 'customsize') {\n                if (_this.isPortrait) {\n                    _this.widthBox.value = 515.9;\n                    _this.heightBox.value = 728.5;\n                }\n                else {\n                    _this.widthBox.value = 728.5;\n                    _this.heightBox.value = 515.9;\n                }\n            }\n        };\n        /**\n         * @private\n         */\n        this.onPortrait = function (event) {\n            _this.landscape.checked = false;\n            var width = _this.widthBox.value;\n            var height = _this.heightBox.value;\n            if (width > height) {\n                _this.widthBox.value = height;\n                _this.heightBox.value = width;\n            }\n        };\n        /**\n         * @private\n         */\n        this.onLandscape = function (event) {\n            _this.portrait.checked = false;\n            var width = _this.widthBox.value;\n            var height = _this.heightBox.value;\n            if (width < height) {\n                _this.widthBox.value = height;\n                _this.heightBox.value = width;\n            }\n        };\n        /**\n         * @private\n         */\n        this.unWireEventsAndBindings = function () {\n            _this.paperSize.value = undefined;\n            _this.topMarginBox.value = undefined;\n            _this.bottomMarginBox.value = undefined;\n            _this.leftMarginBox.value = undefined;\n            _this.rightMarginBox.value = undefined;\n            _this.headerBox.value = undefined;\n            _this.footerBox.value = undefined;\n            _this.widthBox.value = undefined;\n            _this.heightBox.value = undefined;\n            _this.checkBox1.checked = false;\n            _this.checkBox2.checked = false;\n            _this.portrait.checked = false;\n            _this.landscape.checked = false;\n        };\n        this.owner = viewer;\n    }\n    PageSetupDialog.prototype.getModuleName = function () {\n        return 'PageSetupDialog';\n    };\n    /**\n     * @private\n     */\n    PageSetupDialog.prototype.initPageSetupDialog = function (locale) {\n        var id = this.owner.owner.containerId + '_pagesetup_dialog';\n        this.target = createElement('div', { id: id, className: 'e-de-pagesetup-dlg-container' });\n        this.owner.owner.element.appendChild(this.target);\n        var ejtabContainer = createElement('div', { id: this.target.id + '_MarginTabContainer' });\n        this.target.appendChild(ejtabContainer);\n        this.marginTab = createElement('div', {\n            id: this.target.id + '_marginPropertyTab', styles: 'position: relative;width:400px;'\n        });\n        this.paperTab = createElement('div', {\n            id: this.target.id + '_paperSizePropertyTab', styles: 'position: relative;width:400px;'\n        });\n        this.layoutTab = createElement('div', {\n            id: this.target.id + '_CellPropertiesDialogTab', styles: 'position: relative;width:400px;'\n        });\n        // tslint:disable-next-line:max-line-length\n        var ejtab = createElement('div', { id: this.target.id + '_PageSetupDialogTab', className: 'e-de-page-setup-ppty-tab' });\n        var headerContainer = createElement('div', { className: 'e-tab-header' });\n        var marginHeader = createElement('div', {\n            id: this.target.id + '_marginHeader', innerHTML: locale.getConstant('Margin')\n        });\n        var paperHeader = createElement('div', {\n            id: this.target.id + '_paperHeader', innerHTML: locale.getConstant('Paper')\n        });\n        var layoutHeader = createElement('div', {\n            id: this.target.id + '_layoutHeader', innerHTML: locale.getConstant('Layout')\n        });\n        headerContainer.appendChild(marginHeader);\n        headerContainer.appendChild(paperHeader);\n        headerContainer.appendChild(layoutHeader);\n        var contentContainer = createElement('div', { className: 'e-content' });\n        var marginContent = createElement('div', { id: this.target.id + '_marginContent' });\n        var paperContent = createElement('div', { id: this.target.id + '_paperContent' });\n        var layoutContent = createElement('div', { id: this.target.id + '_layoutContent' });\n        marginContent.appendChild(this.marginTab);\n        paperContent.appendChild(this.paperTab);\n        layoutContent.appendChild(this.layoutTab);\n        contentContainer.appendChild(marginContent);\n        contentContainer.appendChild(paperContent);\n        contentContainer.appendChild(layoutContent);\n        ejtab.appendChild(headerContainer);\n        ejtab.appendChild(contentContainer);\n        ejtabContainer.appendChild(ejtab);\n        this.initMarginProperties(this.marginTab, locale);\n        this.initPaperSizeProperties(this.paperTab, locale);\n        this.initLayoutProperties(this.layoutTab, locale);\n        var tabObj = new Tab({}, ejtab);\n        this.target.addEventListener('keyup', this.keyUpInsertPageSettings);\n        var marginTabHeader = tabObj.element.getElementsByClassName('e-item e-toolbar-item')[0];\n        var marginTabHeaderItem = marginTabHeader.getElementsByClassName('e-tab-wrap')[0];\n        marginTabHeaderItem.classList.add('e-de-page-setup-dlg-margin-tab-header');\n    };\n    /**\n     * @private\n     */\n    PageSetupDialog.prototype.initMarginProperties = function (element, locale) {\n        var marginDiv = createElement('div', {\n            id: 'margin_div',\n            className: 'e-de-page-setup-dlg-sub-container', styles: 'height:135px;'\n        });\n        // tslint:disable-next-line:max-line-length\n        var leftMarginDiv = createElement('div', { id: 'left_margin', className: 'e-de-page-setup-dlg-left-sub-container' });\n        marginDiv.appendChild(leftMarginDiv);\n        // tslint:disable-next-line:max-line-length\n        var rightMarginDiv = createElement('div', { className: 'e-de-page-setup-dlg-right-sub-container' });\n        marginDiv.appendChild(rightMarginDiv);\n        var topLabel = createElement('label', {\n            innerHTML: locale.getConstant('Top'), className: 'e-de-page-setup-dlg-sub-header',\n            id: this.target.id + '_TopLabel', styles: 'padding-top:0px;width:190px;'\n        });\n        var topTextBox = createElement('input', {\n            attrs: { 'type': 'text' }, id: this.target.id + '_Top'\n        });\n        var bottomBoxLabel = createElement('label', {\n            innerHTML: locale.getConstant('Bottom'),\n            className: 'e-de-page-setup-dlg-sub-title-header', id: this.target.id + '_bottomLabel'\n        });\n        var bottomTextBox = createElement('input', {\n            attrs: { 'type': 'text' },\n            id: this.target.id + '_bottom'\n        });\n        leftMarginDiv.appendChild(topLabel);\n        leftMarginDiv.appendChild(topTextBox);\n        leftMarginDiv.appendChild(bottomBoxLabel);\n        leftMarginDiv.appendChild(bottomTextBox);\n        var leftBoxLabel = createElement('label', {\n            innerHTML: locale.getConstant('Left'), className: 'e-de-page-setup-dlg-sub-header', styles: 'padding-top:0px;width:190px;',\n            id: this.target.id + '_leftLabel'\n        });\n        var leftTextBox = createElement('input', {\n            attrs: { 'type': 'text' }, id: this.target.id + '_left'\n        });\n        var rightLabel = createElement('label', {\n            innerHTML: locale.getConstant('Right'),\n            id: this.target.id + '_rightLabel', className: 'e-de-page-setup-dlg-sub-title-header'\n        });\n        var rightTextBox = createElement('input', {\n            attrs: { 'type': 'text' },\n            id: this.target.id + '_right'\n        });\n        rightMarginDiv.appendChild(leftBoxLabel);\n        rightMarginDiv.appendChild(leftTextBox);\n        rightMarginDiv.appendChild(rightLabel);\n        rightMarginDiv.appendChild(rightTextBox);\n        element.appendChild(marginDiv);\n        this.topMarginBox = new NumericTextBox({ value: 71, width: 170, decimals: 2 });\n        this.topMarginBox.appendTo(topTextBox);\n        this.leftMarginBox = new NumericTextBox({ value: 73, width: 170, decimals: 2 });\n        this.leftMarginBox.appendTo(leftTextBox);\n        this.bottomMarginBox = new NumericTextBox({ value: 72, width: 170, decimals: 2 });\n        this.bottomMarginBox.appendTo(bottomTextBox);\n        this.rightMarginBox = new NumericTextBox({ value: 74, width: 170, decimals: 2 });\n        this.rightMarginBox.appendTo(rightTextBox);\n        // tslint:disable-next-line:max-line-length\n        var orientationDiv = createElement('div', { id: 'orientation_div', className: 'e-de-page-setup-dlg-sub-container-port' });\n        // tslint:disable-next-line:max-line-length\n        var orientationLabeldiv = createElement('div', { id: '_orientationLabelDiv', className: 'e-de-page-setup-dlg-sub-label', innerHTML: locale.getConstant('Orientation') });\n        var orientationPropDiv = createElement('div', { id: '_orientationPropDiv', styles: 'display: flex;', className: 'e-de-page-setup-dlg-orientation-prop' });\n        var portraitDiv = createElement('div', { id: '_portraitDiv', styles: 'padding-right: 30px;' });\n        var portrait = createElement('input', {\n            attrs: { 'type': 'radiobutton' }, id: this.target.id + '_portrait'\n        });\n        var landscapeDiv = createElement('div', { id: '_landscapeDiv' });\n        var landscape = createElement('input', {\n            attrs: { 'type': 'radiobutton' }, id: this.target.id + '_landscape'\n        });\n        portraitDiv.appendChild(portrait);\n        landscapeDiv.appendChild(landscape);\n        orientationPropDiv.appendChild(portraitDiv);\n        orientationPropDiv.appendChild(landscapeDiv);\n        orientationDiv.appendChild(orientationLabeldiv);\n        orientationDiv.appendChild(orientationPropDiv);\n        this.portrait = new RadioButton({ label: locale.getConstant('Portrait'), checked: true, change: this.onPortrait });\n        this.landscape = new RadioButton({ label: locale.getConstant('Landscape'), change: this.onLandscape });\n        this.portrait.appendTo(portrait);\n        this.landscape.appendTo(landscape);\n        element.appendChild(orientationDiv);\n    };\n    /**\n     * @private\n     */\n    PageSetupDialog.prototype.initPaperSizeProperties = function (element, locale) {\n        var sizeDiv = createElement('div', {\n            id: 'size_div',\n            className: 'e-de-page-setup-dlg-sub-size-container'\n        });\n        // tslint:disable-next-line:max-line-length\n        var leftSizeDiv = createElement('div', { id: 'left_size', className: 'e-de-page-setup-dlg-left-sub-container' });\n        sizeDiv.appendChild(leftSizeDiv);\n        // tslint:disable-next-line:max-line-length\n        var rightSizeDiv = createElement('div', { className: 'e-de-page-setup-dlg-right-sub-container' });\n        sizeDiv.appendChild(rightSizeDiv);\n        var widthLabel = createElement('label', {\n            innerHTML: locale.getConstant('Width'), className: 'e-de-page-setup-dlg-sub-header',\n            id: this.target.id + '_widthLabel', styles: 'padding-top:0px;width:190px;'\n        });\n        var widthTextBox = createElement('input', {\n            attrs: { 'type': 'text' }, id: this.target.id + '_Width'\n        });\n        leftSizeDiv.appendChild(widthLabel);\n        leftSizeDiv.appendChild(widthTextBox);\n        var heightLabel = createElement('label', {\n            innerHTML: locale.getConstant('Height'), className: 'e-de-page-setup-dlg-sub-header', styles: 'padding-top:0px;width:190px;',\n            id: this.target.id + '_heightLabel'\n        });\n        var heightTextBox = createElement('input', {\n            attrs: { 'type': 'text' }, id: this.target.id + '_height'\n        });\n        rightSizeDiv.appendChild(heightLabel);\n        rightSizeDiv.appendChild(heightTextBox);\n        element.appendChild(sizeDiv);\n        this.widthBox = new NumericTextBox({ value: 612, width: 170, decimals: 2 });\n        this.widthBox.appendTo(widthTextBox);\n        this.heightBox = new NumericTextBox({ value: 792, width: 170, decimals: 2 });\n        this.heightBox.appendTo(heightTextBox);\n        // tslint:disable-next-line:max-line-length\n        var paperSizeDiv = createElement('div', { id: '_paperSizeDiv', styles: 'height:37px;', className: 'e-de-page-setup-dlg-sub-container' });\n        var paperSize = createElement('select', {\n            id: this.target.id + '_papersize', styles: 'width:170px;padding-bottom: 20px;',\n            innerHTML: '<option value=\"letter\">' + locale.getConstant('Letter') +\n                '</option><option value=\"tabloid\">' + locale.getConstant('Tabloid') +\n                '</option><option value=\"legal\">' + locale.getConstant('Legal') +\n                '</option><option value=\"statement\">' + locale.getConstant('Statement') +\n                '</option><option value=\"executive\">' + locale.getConstant('Executive') +\n                '</option><option value=\"a3\">' + locale.getConstant('A3') +\n                '</option><option value=\"a4\">' + locale.getConstant('A4') +\n                '</option><option value=\"a5\">' + locale.getConstant('A5') +\n                '</option><option value=\"b4\">' + locale.getConstant('B4') +\n                '</option><option value=\"b5\">' + locale.getConstant('B5') +\n                '</option><option value=\"customsize\">' + locale.getConstant('Custom Size') + '</option>'\n        });\n        paperSizeDiv.appendChild(paperSize);\n        this.paperSize = new DropDownList({ change: this.changeByPaperSize, width: '170px' });\n        this.paperSize.appendTo(paperSize);\n        element.appendChild(paperSizeDiv);\n    };\n    /**\n     * @private\n     */\n    PageSetupDialog.prototype.initLayoutProperties = function (element, locale) {\n        // tslint:disable-next-line:max-line-length\n        var layoutDiv = createElement('div', { id: '_layoutDiv', className: 'e-de-page-setup-dlg-layout-sub-container', });\n        // tslint:disable-next-line:max-line-length\n        var firstPageDiv = createElement('div', { id: '_firstPageDiv', styles: 'height: 27px;', className: 'e-de-page-setup-dlg-first-page-prop' });\n        var checkBox1 = createElement('input', {\n            attrs: { 'type': 'checkbox' }, id: this.target.id + '_oddoreven'\n        });\n        firstPageDiv.appendChild(checkBox1);\n        // tslint:disable-next-line:max-line-length\n        var oddOrEvenDiv = createElement('div', { id: '_oddOrEvenDiv', styles: 'height: 27px;', className: 'e-de-page-setup-dlg-odd-or-even-prop' });\n        var checkBox2 = createElement('input', {\n            attrs: { 'type': 'checkbox' }, id: this.target.id + '_even'\n        });\n        oddOrEvenDiv.appendChild(checkBox2);\n        layoutDiv.appendChild(firstPageDiv);\n        layoutDiv.appendChild(oddOrEvenDiv);\n        this.checkBox1 = new CheckBox({ label: locale.getConstant('Different odd and even') });\n        this.checkBox2 = new CheckBox({ label: locale.getConstant('Different first page') });\n        this.checkBox1.appendTo(checkBox1);\n        this.checkBox2.appendTo(checkBox2);\n        element.appendChild(layoutDiv);\n        // tslint:disable-next-line:max-line-length\n        var textLabelDiv = createElement('div', { id: '_textLabelDiv', className: 'e-de-page-setup-dlg-sub-label' });\n        var textLabel = createElement('label', {\n            innerHTML: locale.getConstant('From edge'), id: this.target.id + '_textLabel'\n        });\n        textLabelDiv.appendChild(textLabel);\n        element.appendChild(textLabelDiv);\n        // tslint:disable-next-line:max-line-length\n        var propertyDiv = createElement('div', { id: '_headerFooeterPropDiv', className: 'e-de-page-setup-dlg-sub-container', styles: 'height: 65px;' });\n        // tslint:disable-next-line:max-line-length\n        var leftLayoutDiv = createElement('div', { id: '_leftLayoutDiv', className: 'e-de-page-setup-dlg-left-layout-container' });\n        propertyDiv.appendChild(leftLayoutDiv);\n        // tslint:disable-next-line:max-line-length\n        var rightLayoutDiv = createElement('div', { className: 'e-de-page-setup-dlg-right-layout-container' });\n        propertyDiv.appendChild(rightLayoutDiv);\n        var headerLabel = createElement('label', {\n            innerHTML: locale.getConstant('Header'), className: 'e-de-page-setup-dlg-sub-header',\n            id: this.target.id + '_headerLabel', styles: 'padding-top:0px;width:190px;'\n        });\n        var headerBox = createElement('input', {\n            attrs: { 'type': 'text' }, id: this.target.id + '_header'\n        });\n        leftLayoutDiv.appendChild(headerLabel);\n        leftLayoutDiv.appendChild(headerBox);\n        var footerLabel = createElement('label', {\n            innerHTML: locale.getConstant('Footer'), className: 'e-de-page-setup-dlg-sub-header', styles: 'padding-top:0px;width:190px;',\n            id: this.target.id + '_footerLabel'\n        });\n        var footerBox = createElement('input', {\n            attrs: { 'type': 'text' }, id: this.target.id + '_footer'\n        });\n        rightLayoutDiv.appendChild(footerLabel);\n        rightLayoutDiv.appendChild(footerBox);\n        element.appendChild(propertyDiv);\n        this.headerBox = new NumericTextBox({ value: 612, width: 170, decimals: 2 });\n        this.headerBox.appendTo(headerBox);\n        this.footerBox = new NumericTextBox({ value: 792, width: 170, decimals: 2 });\n        this.footerBox.appendTo(footerBox);\n    };\n    /**\n     * @private\n     */\n    PageSetupDialog.prototype.show = function () {\n        var localValue = new L10n('documenteditor', this.owner.owner.defaultLocale);\n        localValue.setLocale(this.owner.owner.locale);\n        setCulture(this.owner.owner.locale);\n        if (!this.target) {\n            this.initPageSetupDialog(localValue);\n        }\n        this.owner.dialog.header = localValue.getConstant('Page Setup');\n        this.owner.dialog.width = 'auto';\n        this.owner.dialog.height = 'auto';\n        this.owner.dialog.content = this.target;\n        this.owner.dialog.beforeOpen = this.loadPageSetupDialog;\n        this.owner.dialog.close = this.closePageSetupDialog;\n        this.owner.dialog.buttons = [{\n                click: this.applyPageSetupProperties,\n                buttonModel: { content: localValue.getConstant('Ok'), cssClass: 'e-flat e-layout-ppty-okay', isPrimary: true }\n            },\n            {\n                click: this.onCancelButtonClick,\n                buttonModel: { content: localValue.getConstant('Cancel'), cssClass: 'e-flat e-layout-ppty-cancel' }\n            }];\n        this.owner.dialog.dataBind();\n        this.owner.dialog.show();\n    };\n    /**\n     * @private\n     */\n    PageSetupDialog.prototype.destroy = function () {\n        if (this.topMarginBox) {\n            this.topMarginBox.destroy();\n            this.topMarginBox = undefined;\n        }\n        if (this.leftMarginBox) {\n            this.leftMarginBox.destroy();\n            this.leftMarginBox = undefined;\n        }\n        if (this.bottomMarginBox) {\n            this.bottomMarginBox.destroy();\n            this.bottomMarginBox = undefined;\n        }\n        if (this.rightMarginBox) {\n            this.rightMarginBox.destroy();\n            this.rightMarginBox = undefined;\n        }\n        if (this.headerBox) {\n            this.headerBox.destroy();\n            this.headerBox = undefined;\n        }\n        if (this.footerBox) {\n            this.footerBox.destroy();\n            this.footerBox = undefined;\n        }\n        if (this.widthBox) {\n            this.widthBox.destroy();\n            this.widthBox = undefined;\n        }\n        if (this.heightBox) {\n            this.heightBox.destroy();\n            this.heightBox = undefined;\n        }\n        if (this.paperSize) {\n            this.paperSize.destroy();\n            this.paperSize = undefined;\n        }\n        if (this.checkBox1) {\n            this.checkBox1.destroy();\n            this.checkBox1 = undefined;\n        }\n        if (this.checkBox2) {\n            this.checkBox2.destroy();\n            this.checkBox2 = undefined;\n        }\n        if (this.portrait) {\n            this.portrait.destroy();\n            this.portrait = undefined;\n        }\n        if (this.landscape) {\n            this.landscape.destroy();\n            this.landscape = undefined;\n        }\n        this.owner = undefined;\n        if (!isNullOrUndefined(this.target)) {\n            if (this.target.parentElement) {\n                this.target.parentElement.removeChild(this.target);\n            }\n            for (var s = 0; s < this.target.childNodes.length; s++) {\n                this.target.removeChild(this.target.childNodes[s]);\n                s--;\n            }\n            this.target = undefined;\n        }\n    };\n    return PageSetupDialog;\n}());\nexport { PageSetupDialog };\n","import { NumericTextBox } from '@syncfusion/ej2-inputs';\nimport { createElement, L10n, setCulture } from '@syncfusion/ej2-base';\nimport { isNullOrUndefined } from '@syncfusion/ej2-base';\nimport { DropDownList } from '@syncfusion/ej2-dropdowns';\nimport { WParagraphFormat } from '../index';\n/**\n * The Paragraph dialog is used to modify formatting of selected paragraphs.\n */\nvar ParagraphDialog = /** @class */ (function () {\n    /**\n     * @private\n     */\n    function ParagraphDialog(viewer) {\n        var _this = this;\n        //paragraph Format properties\n        this.leftIndent = undefined;\n        this.rightIndent = undefined;\n        this.beforeSpacing = undefined;\n        this.afterSpacing = undefined;\n        this.textAlignment = undefined;\n        this.firstLineIndent = undefined;\n        this.lineSpacingIn = undefined;\n        this.lineSpacingType = undefined;\n        this.paragraphFormat = undefined;\n        /**\n         * @private\n         */\n        this.keyUpParagraphSettings = function (event) {\n            if (event.keyCode === 13) {\n                _this.applyParagraphFormat();\n            }\n        };\n        this.changeBeforeSpacing = function (event) {\n            _this.beforeSpacing = event.value;\n        };\n        this.changeAfterSpacing = function (event) {\n            _this.afterSpacing = event.value;\n        };\n        this.changeLeftIndent = function (event) {\n            _this.leftIndent = event.value;\n        };\n        this.changeRightIndent = function (event) {\n            _this.rightIndent = event.value;\n        };\n        this.changeLineSpacingValue = function (event) {\n            _this.lineSpacingIn = event.value;\n        };\n        this.changeFirstLineIndent = function (event) {\n            _this.firstLineIndent = event.value;\n        };\n        this.changeByTextAlignment = function (args) {\n            _this.textAlignment = args.value;\n        };\n        /**\n         * @private\n         */\n        this.changeByValue = function (event) {\n            var paragraphFormat = _this.owner.selection.paragraphFormat;\n            switch (_this.special.index) {\n                case 0:\n                    if (paragraphFormat.firstLineIndent !== 0) {\n                        _this.byIn.value = 0;\n                    }\n                    break;\n                case 1:\n                    if (paragraphFormat.firstLineIndent === 0 || isNullOrUndefined(paragraphFormat.firstLineIndent)) {\n                        _this.byIn.value = 0.1;\n                    }\n                    else if (paragraphFormat.firstLineIndent < 0) {\n                        _this.byIn.value = -(paragraphFormat.firstLineIndent);\n                    }\n                    break;\n                case 2:\n                    if (paragraphFormat.firstLineIndent === 0 || isNullOrUndefined(paragraphFormat.firstLineIndent)) {\n                        paragraphFormat.firstLineIndent = -0.1;\n                    }\n                    else if (paragraphFormat.firstLineIndent > 0) {\n                        _this.byIn.value = -(paragraphFormat.firstLineIndent);\n                    }\n                    break;\n            }\n        };\n        /**\n         * @private\n         */\n        this.changeBySpacing = function (event) {\n            if (isNullOrUndefined(_this.lineSpacing)) {\n                return;\n            }\n            switch (_this.lineSpacing.index) {\n                case 0:\n                    _this.lineSpacingType = 'AtLeast';\n                    _this.atIn.value = 12;\n                    break;\n                case 1:\n                    _this.lineSpacingType = 'Exactly';\n                    _this.atIn.value = 12;\n                    break;\n                case 2:\n                    _this.lineSpacingType = 'Multiple';\n                    _this.atIn.value = 1;\n                    break;\n            }\n        };\n        /* tslint:enable */\n        /**\n         * @private\n         */\n        this.loadParagraphDialog = function () {\n            var selectionFormat;\n            if (_this.paragraphFormat) {\n                selectionFormat = _this.paragraphFormat;\n            }\n            else {\n                selectionFormat = _this.owner.selection.paragraphFormat;\n            }\n            var alignValue = _this.alignment.index;\n            if (selectionFormat.textAlignment === 'Center') {\n                alignValue = 0;\n            }\n            else if (selectionFormat.textAlignment === 'Left') {\n                alignValue = 1;\n            }\n            else if (selectionFormat.textAlignment === 'Right') {\n                alignValue = 2;\n            }\n            else {\n                alignValue = 3;\n            }\n            _this.alignment.index = alignValue;\n            _this.beforeSpacingIn.value = selectionFormat.beforeSpacing;\n            _this.afterSpacingIn.value = selectionFormat.afterSpacing;\n            _this.leftIndentIn.value = selectionFormat.leftIndent;\n            _this.rightIndentIn.value = selectionFormat.rightIndent;\n            _this.byIn.value = selectionFormat.firstLineIndent;\n            var lineSpaceValue = _this.lineSpacing.index;\n            if (selectionFormat.lineSpacingType === 'AtLeast') {\n                lineSpaceValue = 0;\n            }\n            else if (selectionFormat.lineSpacingType === 'Exactly') {\n                lineSpaceValue = 1;\n            }\n            else {\n                lineSpaceValue = 2;\n            }\n            _this.lineSpacing.index = lineSpaceValue;\n            _this.atIn.value = selectionFormat.lineSpacing;\n            if (_this.owner.selection.caret.style.display !== 'none') {\n                _this.owner.selection.caret.style.display = 'none';\n            }\n        };\n        /**\n         * @private\n         */\n        this.applyParagraphFormat = function () {\n            var paraFormat;\n            var isApply;\n            if (_this.paragraphFormat) {\n                paraFormat = _this.paragraphFormat;\n                isApply = false;\n            }\n            else {\n                paraFormat = new WParagraphFormat();\n                isApply = true;\n            }\n            if (!isNullOrUndefined(_this.beforeSpacing)) {\n                paraFormat.beforeSpacing = _this.beforeSpacing;\n            }\n            if (!isNullOrUndefined(_this.afterSpacing)) {\n                paraFormat.afterSpacing = _this.afterSpacing;\n            }\n            if (!isNullOrUndefined(_this.lineSpacingType)) {\n                paraFormat.lineSpacingType = _this.lineSpacingType;\n            }\n            if (!isNullOrUndefined(_this.leftIndent)) {\n                paraFormat.leftIndent = _this.leftIndent;\n            }\n            if (!isNullOrUndefined(_this.rightIndent)) {\n                paraFormat.rightIndent = _this.rightIndent;\n            }\n            if (!isNullOrUndefined(_this.lineSpacingIn)) {\n                paraFormat.lineSpacing = _this.lineSpacingIn;\n            }\n            if (!isNullOrUndefined(_this.firstLineIndent)) {\n                paraFormat.firstLineIndent = _this.firstLineIndent;\n            }\n            if (!isNullOrUndefined(_this.textAlignment)) {\n                paraFormat.textAlignment = _this.textAlignment;\n            }\n            if (isApply) {\n                _this.onParagraphFormat(paraFormat);\n            }\n            else {\n                _this.owner.owner.styleDialogModule.updateParagraphFormat();\n            }\n            _this.owner.dialog.hide();\n        };\n        /**\n         * @private\n         */\n        this.closeParagraphDialog = function () {\n            _this.leftIndent = undefined;\n            _this.afterSpacing = undefined;\n            _this.beforeSpacing = undefined;\n            _this.firstLineIndent = undefined;\n            _this.textAlignment = undefined;\n            _this.rightIndent = undefined;\n            _this.lineSpacingIn = undefined;\n            _this.lineSpacingType = undefined;\n            _this.paragraphFormat = undefined;\n            _this.owner.dialog.hide();\n            _this.owner.updateFocus();\n        };\n        this.owner = viewer;\n    }\n    /**\n     * @private\n     */\n    ParagraphDialog.prototype.getModuleName = function () {\n        return 'ParagraphDialog';\n    };\n    /*tslint:disable max-func-body-length*/\n    /**\n     * @private\n     */\n    ParagraphDialog.prototype.initParagraphDialog = function (locale) {\n        var instance = this;\n        var ownerId = this.owner.owner.containerId;\n        var id = ownerId + '_paragraph_dialog';\n        this.target = createElement('div', { id: id, className: 'e-de-para-dlg-container' });\n        // tslint:disable-next-line:max-line-length\n        var div = createElement('div', { id: 'property_div', styles: 'width:400px;' });\n        var generalDiv = createElement('div', { id: 'genral_div', styles: 'width:200px;height:85px;', className: 'e-de-para-dlg-sub-container' });\n        // tslint:disable-next-line:max-line-length\n        var genLabel = createElement('div', { id: ownerId + '_genLabel', className: 'e-de-para-dlg-heading', innerHTML: locale.getConstant('General') });\n        var alignLabel = createElement('div', { id: ownerId + '_AlignLabel', className: 'e-de-dlg-sub-header', innerHTML: locale.getConstant('Alignment') });\n        var alignment = createElement('select', {\n            id: ownerId + '_Alignment',\n            innerHTML: '<option value=\"Center\">' + locale.getConstant('Center') +\n                '</option><option value=\"Left\">' + locale.getConstant('Left') +\n                '</option><option value=\"Right\">' + locale.getConstant('Right') +\n                '</option><option value=\"Justify\">' + locale.getConstant('Justify') + '</option>'\n        });\n        generalDiv.appendChild(genLabel);\n        generalDiv.appendChild(alignLabel);\n        generalDiv.appendChild(alignment);\n        // tslint:disable-next-line:max-line-length\n        var indentionDiv = createElement('div', { id: 'indention_div', styles: 'width: 400px;height: 150px;', className: 'e-de-para-dlg-sub-container' });\n        var leftIndentionDiv = createElement('div', { id: 'left_indention', styles: 'float:left;position:relative;' });\n        indentionDiv.appendChild(leftIndentionDiv);\n        // tslint:disable-next-line:max-line-length\n        var rightIndentionDiv = createElement('div', { className: 'e-de-para-dlg-right-sub-container', styles: 'float:right;position:relative;' });\n        indentionDiv.appendChild(rightIndentionDiv);\n        // tslint:disable-next-line:max-line-length\n        var spacingDiv = createElement('div', { id: 'spacing_div', styles: 'width: 400px;height: 150px;', className: 'e-de-para-dlg-sub-container' });\n        var leftSpacingDiv = createElement('div', { id: 'left_spacing', styles: 'float:left;position:relative;' });\n        spacingDiv.appendChild(leftSpacingDiv);\n        // tslint:disable-next-line:max-line-length\n        var rightSpacingDiv = createElement('div', { className: 'e-de-para-dlg-right-sub-container', styles: 'float:right;position:relative;' });\n        spacingDiv.appendChild(rightSpacingDiv);\n        // tslint:disable-next-line:max-line-length\n        var indentLabel = createElement('div', {\n            id: ownerId + '_indentLabel', className: 'e-de-para-dlg-heading', innerHTML: locale.getConstant('Indentation')\n        });\n        var beforeTextLabel = createElement('div', {\n            id: ownerId + '_bfTextLabel',\n            className: 'e-de-dlg-sub-header', innerHTML: locale.getConstant('Before text')\n        });\n        // tslint:disable-next-line:max-line-length\n        var leftIndent = createElement('input', { id: ownerId + '_leftIndent', attrs: { 'type': 'text' } });\n        var specialLabel = createElement('div', { id: ownerId + '_specialLabel', className: 'e-de-dlg-sub-header', innerHTML: locale.getConstant('Special') });\n        var special = createElement('select', {\n            id: ownerId + '_special',\n            innerHTML: '<option value=\"None\">' + locale.getConstant('None') +\n                '</option><option value=\"First Line\">' + locale.getConstant('First line') +\n                '</option><option value=\"Hanging\">' + locale.getConstant('Hanging') + '</option> '\n        });\n        leftIndentionDiv.appendChild(indentLabel);\n        leftIndentionDiv.appendChild(beforeTextLabel);\n        leftIndentionDiv.appendChild(leftIndent);\n        leftIndentionDiv.appendChild(specialLabel);\n        leftIndentionDiv.appendChild(special);\n        // tslint:disable-next-line:max-line-length\n        var afterTextLabel = createElement('div', { id: ownerId + '_afTextLabel', className: 'e-de-dlg-sub-header', innerHTML: locale.getConstant('After text') });\n        var rightIndent = createElement('input', { id: ownerId + '_rightIndent', attrs: { 'type': 'text' } });\n        // tslint:disable-next-line:max-line-length\n        var byLabel = createElement('label', { id: ownerId + '_byLabel', className: 'e-de-dlg-sub-header', innerHTML: locale.getConstant('By') });\n        var by = createElement('input', { id: ownerId + '_By', attrs: { 'type': 'text' } });\n        rightIndentionDiv.appendChild(afterTextLabel);\n        rightIndentionDiv.appendChild(rightIndent);\n        rightIndentionDiv.appendChild(byLabel);\n        rightIndentionDiv.appendChild(by);\n        // tslint:disable-next-line:max-line-length\n        var spaceLabel = createElement('div', { innerHTML: locale.getConstant('Spacing'), className: 'e-de-para-dlg-heading', id: ownerId + '_spaceLabel' });\n        var beforeLabel = createElement('div', { className: 'e-de-dlg-sub-header', innerHTML: locale.getConstant('Before'), id: ownerId + '_beforeLabel' });\n        // tslint:disable-next-line:max-line-length\n        var beforeSpacing = createElement('input', { id: ownerId + '_beforeSpacing', attrs: { 'type': 'text' } });\n        var lineSpaceLabel = createElement('div', { id: ownerId + '_lineSpaceLabel', className: 'e-de-dlg-sub-header', innerHTML: locale.getConstant('Line Spacing') });\n        // tslint:disable-next-line:max-line-length\n        var lineSpacing = createElement('select', {\n            id: ownerId + '_lineSpacing', styles: 'width:180px;',\n            innerHTML: '<option value=\"At least\">' + locale.getConstant('At least') +\n                '</option><option value=\"Exactly\">' + locale.getConstant('Exactly') +\n                '</option><option value=\"Multiple\">' + locale.getConstant('Multiple') + '</option>'\n        });\n        leftSpacingDiv.appendChild(spaceLabel);\n        leftSpacingDiv.appendChild(beforeLabel);\n        leftSpacingDiv.appendChild(beforeSpacing);\n        leftSpacingDiv.appendChild(lineSpaceLabel);\n        leftSpacingDiv.appendChild(lineSpacing);\n        // tslint:disable-next-line:max-line-length\n        var afterLabel = createElement('div', { innerHTML: locale.getConstant('After'), className: 'e-de-dlg-sub-header', id: ownerId + '_afterLabel' });\n        var afterSpacing = createElement('input', { id: ownerId + '_afterSpacing', attrs: { 'type': 'text' } });\n        // tslint:disable-next-line:max-line-length\n        var atLabel = createElement('div', { innerHTML: locale.getConstant('At'), id: ownerId + '_atLabel', className: 'e-de-dlg-sub-header' });\n        var lineSpacingAt = createElement('input', { id: ownerId + '_lineSpacingAt', attrs: { 'type': 'text' } });\n        rightSpacingDiv.appendChild(afterLabel);\n        rightSpacingDiv.appendChild(afterSpacing);\n        rightSpacingDiv.appendChild(atLabel);\n        rightSpacingDiv.appendChild(lineSpacingAt);\n        div.appendChild(generalDiv);\n        div.appendChild(indentionDiv);\n        div.appendChild(spacingDiv);\n        this.target.appendChild(div);\n        this.leftIndentIn = new NumericTextBox({\n            format: 'n1', value: 0, min: -1584, max: 1584, width: 180, enablePersistence: false, change: this.changeLeftIndent\n        });\n        this.leftIndentIn.appendTo(leftIndent);\n        this.rightIndentIn = new NumericTextBox({\n            format: 'n1', value: 0, min: -1584, max: 1584, width: 180, enablePersistence: false, change: this.changeRightIndent\n        });\n        this.rightIndentIn.appendTo(rightIndent);\n        this.byIn = new NumericTextBox({\n            format: 'n1', value: 0, min: 0, max: 1584, width: 180, enablePersistence: false, change: this.changeFirstLineIndent\n        });\n        this.byIn.appendTo(by);\n        this.beforeSpacingIn = new NumericTextBox({\n            format: 'n1', value: 0, min: 0, max: 1584, width: 180, step: 6, enablePersistence: false,\n            change: this.changeBeforeSpacing\n        });\n        this.beforeSpacingIn.appendTo(beforeSpacing);\n        this.afterSpacingIn = new NumericTextBox({\n            format: 'n1', value: 0, min: 0, max: 1584, width: 180, step: 6, enablePersistence: false,\n            change: this.changeAfterSpacing\n        });\n        this.afterSpacingIn.appendTo(afterSpacing);\n        this.atIn = new NumericTextBox({\n            format: 'n1', value: 0, min: 1, max: 1584, width: 180, step: 0.5, enablePersistence: false, change: this.changeLineSpacingValue\n        });\n        this.special = new DropDownList({ change: this.changeByValue, width: 180 });\n        this.special.appendTo(special);\n        this.lineSpacing = new DropDownList({ change: this.changeBySpacing, width: '180px' });\n        this.lineSpacing.appendTo(lineSpacing);\n        this.alignment = new DropDownList({ width: 180, change: this.changeByTextAlignment });\n        this.alignment.appendTo(alignment);\n        this.atIn.appendTo(lineSpacingAt);\n        this.target.addEventListener('keyup', instance.keyUpParagraphSettings);\n    };\n    /**\n     * Applies Paragraph Format\n     * @param  {WParagraphFormat} paragraphFormat\n     * @private\n     */\n    ParagraphDialog.prototype.onParagraphFormat = function (paragraphFormat) {\n        this.owner.owner.editorModule.initHistory('ParagraphFormat');\n        var selection = this.owner.selection;\n        this.owner.owner.isShiftingEnabled = true;\n        if (this.owner.selection.isEmpty) {\n            this.owner.owner.editorModule.applyParaFormatProperty(selection.start.paragraph, undefined, paragraphFormat, false);\n            this.owner.owner.editor.layoutItemBlock(selection.start.paragraph, false);\n        }\n        else {\n            this.owner.owner.editorModule.updateSelectionParagraphFormatting('ParagraphFormat', paragraphFormat, false);\n        }\n        this.owner.owner.editorModule.reLayout(selection);\n    };\n    /**\n     * @private\n     */\n    ParagraphDialog.prototype.show = function (paragraphFormat) {\n        if (paragraphFormat) {\n            this.paragraphFormat = paragraphFormat;\n        }\n        var local = new L10n('documenteditor', this.owner.owner.defaultLocale);\n        local.setLocale(this.owner.owner.locale);\n        setCulture(this.owner.owner.locale);\n        if (!this.target) {\n            this.initParagraphDialog(local);\n        }\n        this.loadParagraphDialog();\n        this.owner.dialog.header = 'Paragraph';\n        this.owner.dialog.content = this.target;\n        this.owner.dialog.height = 'auto';\n        this.owner.dialog.width = 'auto';\n        this.owner.dialog.buttons = [{\n                click: this.applyParagraphFormat,\n                buttonModel: { content: local.getConstant('Ok'), cssClass: 'e-flat e-para-okay', isPrimary: true }\n            },\n            {\n                click: this.closeParagraphDialog,\n                buttonModel: { content: local.getConstant('Cancel'), cssClass: 'e-flat e-para-cancel' }\n            }];\n        this.owner.dialog.beforeOpen = this.owner.updateFocus;\n        this.owner.dialog.close = this.owner.updateFocus;\n        this.owner.dialog.dataBind();\n        this.owner.dialog.show();\n    };\n    /**\n     * @private\n     */\n    ParagraphDialog.prototype.destroy = function () {\n        if (this.afterSpacingIn) {\n            this.afterSpacingIn.destroy();\n            this.afterSpacingIn = undefined;\n        }\n        if (this.beforeSpacingIn) {\n            this.beforeSpacingIn.destroy();\n            this.beforeSpacingIn = undefined;\n        }\n        if (this.leftIndentIn) {\n            this.leftIndentIn.destroy();\n            this.leftIndentIn = undefined;\n        }\n        if (this.rightIndentIn) {\n            this.rightIndentIn.destroy();\n            this.rightIndentIn = undefined;\n        }\n        if (this.byIn) {\n            this.byIn.destroy();\n            this.byIn = undefined;\n        }\n        if (this.atIn) {\n            this.atIn.destroy();\n            this.atIn = undefined;\n        }\n        if (this.alignment) {\n            this.alignment.change = undefined;\n            this.alignment.destroy();\n        }\n        this.alignment = undefined;\n        if (this.lineSpacing) {\n            this.lineSpacing.change = undefined;\n            this.lineSpacing.destroy();\n        }\n        this.lineSpacing = undefined;\n        if (this.special) {\n            this.special.change = undefined;\n            this.special.destroy();\n        }\n        this.special = undefined;\n        this.owner = undefined;\n        if (!isNullOrUndefined(this.target)) {\n            if (this.target.parentElement) {\n                this.target.parentElement.removeChild(this.target);\n            }\n            for (var q = 0; q < this.target.childNodes.length; q++) {\n                this.target.removeChild(this.target.childNodes[q]);\n                q--;\n            }\n            this.target = undefined;\n        }\n    };\n    return ParagraphDialog;\n}());\nexport { ParagraphDialog };\n","import { WCharacterFormat, WParagraphFormat } from '../format/index';\nimport { WList } from '../list/list';\nimport { WAbstractList } from '../list/abstract-list';\nimport { WListLevel } from '../list/list-level';\nimport { isNullOrUndefined } from '@syncfusion/ej2-base';\n/**\n * List view model implementation\n * @private\n */\nvar ListViewModel = /** @class */ (function () {\n    /**\n     * @private\n     */\n    function ListViewModel() {\n        this.listIn = undefined;\n        this.levelNumberIn = undefined;\n        /**\n         * @private\n         */\n        this.dialog = undefined;\n        this.levelNumber = 0;\n    }\n    Object.defineProperty(ListViewModel.prototype, \"levelNumber\", {\n        /**\n         * @private\n         */\n        get: function () {\n            return this.levelNumberIn;\n        },\n        /**\n         * @private\n         */\n        set: function (value) {\n            this.levelNumberIn = value;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(ListViewModel.prototype, \"list\", {\n        /**\n         * @private\n         */\n        get: function () {\n            return this.listIn;\n        },\n        /**\n         * @private\n         */\n        set: function (value) {\n            if (isNullOrUndefined(value)) {\n                this.createList();\n            }\n            else {\n                this.listIn = value;\n            }\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(ListViewModel.prototype, \"listLevel\", {\n        /**\n         * @private\n         */\n        get: function () {\n            if (!isNullOrUndefined(this.list) && this.levelNumber >= 0 && this.levelNumber < 9) {\n                if (!isNullOrUndefined(this.dialog.owner.getAbstractListById(this.list.abstractListId))) {\n                    if (this.dialog.owner.getAbstractListById(this.list.abstractListId).levels.length <= this.levelNumber) {\n                        this.addListLevels();\n                    }\n                    return this.dialog.owner.getAbstractListById(this.list.abstractListId).levels[this.levelNumber];\n                }\n                else {\n                    this.dialog.owner.lists.push(this.list);\n                    var abstractList = this.list.abstractList;\n                    if (!this.list.abstractList) {\n                        abstractList = new WAbstractList();\n                        abstractList.abstractListId = this.list.abstractListId;\n                    }\n                    var listLevelAdv = new WListLevel(abstractList);\n                    listLevelAdv.characterFormat = new WCharacterFormat(listLevelAdv);\n                    listLevelAdv.paragraphFormat = new WParagraphFormat(listLevelAdv);\n                    listLevelAdv.paragraphFormat.leftIndent = (1) * 48;\n                    listLevelAdv.paragraphFormat.firstLineIndent = -24;\n                    listLevelAdv.numberFormat = '%' + (1).toString() + '.';\n                    listLevelAdv.listLevelPattern = 'UpRoman';\n                    listLevelAdv.followCharacter = 'Tab';\n                    listLevelAdv.startAt = 1;\n                    listLevelAdv.restartLevel = 1;\n                    this.dialog.owner.abstractLists.push(abstractList);\n                    return this.dialog.owner.getAbstractListById(this.list.abstractListId).levels[0];\n                    // return this.dialog.owner.getAbstractListById(this.list.abstractListId).levels.getItem(0);\n                }\n            }\n            return undefined;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(ListViewModel.prototype, \"listLevelPattern\", {\n        /**\n         * @private\n         */\n        get: function () {\n            if (!isNullOrUndefined(this.listLevel)) {\n                return this.listLevel.listLevelPattern;\n            }\n            return 'Arabic';\n        },\n        /**\n         * @private\n         */\n        set: function (value) {\n            if (!isNullOrUndefined(this.listLevel)) {\n                this.listLevel.listLevelPattern = value;\n            }\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(ListViewModel.prototype, \"followCharacter\", {\n        /**\n         * @private\n         */\n        get: function () {\n            if (!isNullOrUndefined(this.listLevel)) {\n                return this.listLevel.followCharacter;\n            }\n            return 'None';\n        },\n        /**\n         * @private\n         */\n        set: function (value) {\n            if (!isNullOrUndefined(this.listLevel)) {\n                this.listLevel.followCharacter = value;\n            }\n        },\n        enumerable: true,\n        configurable: true\n    });\n    ListViewModel.prototype.createList = function () {\n        this.list = new WList();\n        this.list.listId = this.dialog.owner.lists.length + 1;\n        var abstractList = new WAbstractList();\n        abstractList.abstractListId = this.dialog.owner.abstractLists.length + 1;\n        this.list.abstractListId = abstractList.abstractListId;\n        this.dialog.owner.lists.push(this.list);\n        var listLevel = new WListLevel(abstractList);\n        listLevel.paragraphFormat = new WParagraphFormat(listLevel);\n        listLevel.paragraphFormat.leftIndent = 48;\n        listLevel.paragraphFormat.firstLineIndent = -24;\n        listLevel.characterFormat = new WCharacterFormat(listLevel);\n        listLevel.numberFormat = '%1.';\n        listLevel.startAt = 1;\n        abstractList.levels.push(listLevel);\n        this.dialog.owner.abstractLists.push(abstractList);\n    };\n    ListViewModel.prototype.addListLevels = function () {\n        if (!isNullOrUndefined(this.list) && !isNullOrUndefined(this.list.abstractListId)) {\n            for (var i = this.dialog.owner.getAbstractListById(this.list.abstractListId).levels.length; i < 9; i++) {\n                var listLevelAdv = new WListLevel(this.dialog.owner.getAbstractListById(this.list.abstractListId));\n                listLevelAdv.characterFormat = new WCharacterFormat(listLevelAdv);\n                listLevelAdv.paragraphFormat = new WParagraphFormat(listLevelAdv);\n                listLevelAdv.paragraphFormat.leftIndent = (i + 1) * 48;\n                listLevelAdv.paragraphFormat.firstLineIndent = -24;\n                listLevelAdv.numberFormat = '%' + (i + 1).toString() + '.';\n                listLevelAdv.listLevelPattern = 'Arabic';\n                listLevelAdv.followCharacter = 'Tab';\n                listLevelAdv.startAt = 1;\n                listLevelAdv.restartLevel = i;\n                (this.dialog.owner).getAbstractListById(this.list.abstractListId).levels.push(listLevelAdv);\n            }\n        }\n    };\n    /**\n     * @private\n     */\n    ListViewModel.prototype.destroy = function () {\n        this.list = undefined;\n        this.followCharacter = undefined;\n        this.levelNumber = undefined;\n        this.listLevelPattern = undefined;\n    };\n    return ListViewModel;\n}());\nexport { ListViewModel };\n","import { NumericTextBox } from '@syncfusion/ej2-inputs';\nimport { createElement, L10n, setCulture } from '@syncfusion/ej2-base';\nimport { isNullOrUndefined } from '@syncfusion/ej2-base';\n// tslint:disable-next-line:max-line-length\nimport { WCharacterFormat, WParagraphFormat } from '../format/index';\nimport { WAbstractList } from '../list/abstract-list';\nimport { WLevelOverride } from '../list/level-override';\nimport { DropDownList } from '@syncfusion/ej2-dropdowns';\nimport { Tooltip } from '@syncfusion/ej2-popups';\nimport { ListViewModel } from './list-view-model';\n/**\n * The List dialog is used to create or modify lists.\n */\n/* tslint:disable:no-any */\nvar ListDialog = /** @class */ (function () {\n    /**\n     * @private\n     */\n    function ListDialog(viewer) {\n        var _this = this;\n        /**\n         * @private\n         */\n        this.dialog = undefined;\n        this.target = undefined;\n        /**\n         * @private\n         */\n        this.owner = undefined;\n        this.viewModel = undefined;\n        this.startAt = undefined;\n        this.textIndent = undefined;\n        this.alignedAt = undefined;\n        this.listLevelElement = undefined;\n        this.followNumberWith = undefined;\n        this.numberStyle = undefined;\n        this.numberFormat = undefined;\n        this.restartBy = undefined;\n        /**\n         * @private\n         */\n        this.isListCharacterFormat = false;\n        this.onTextIndentChanged = function (args) {\n            _this.viewModel.listLevel.paragraphFormat.leftIndent = args.value;\n        };\n        this.onStartValueChanged = function (args) {\n            _this.viewModel.listLevel.startAt = args.value;\n        };\n        this.onListLevelValueChanged = function (args) {\n            _this.viewModel.levelNumber = parseInt(args.value.slice(args.value.length - 1), 10) - 1;\n            if (isNullOrUndefined(_this.listLevel)) {\n                return;\n            }\n            if (isNullOrUndefined(_this.listLevel.characterFormat)) {\n                _this.listLevel.characterFormat = new WCharacterFormat(_this.viewModel.listLevel);\n            }\n            if (!isNullOrUndefined(_this.listLevel.paragraphFormat)) {\n                _this.listLevel.paragraphFormat = new WParagraphFormat(_this.viewModel.listLevel);\n            }\n            _this.updateDialogValues();\n            _this.updateRestartLevelBox();\n        };\n        this.onNumberFormatChanged = function (args) {\n            _this.viewModel.listLevel.numberFormat = args.target.value;\n        };\n        this.onAlignedAtValueChanged = function (args) {\n            _this.viewModel.listLevel.paragraphFormat.firstLineIndent = args.value;\n        };\n        this.onFollowCharacterValueChanged = function (args) {\n            if (args.value) {\n                _this.viewModel.followCharacter = args.value;\n            }\n        };\n        this.onLevelPatternValueChanged = function (args) {\n            _this.viewModel.listLevelPattern = args.value;\n            var numberFormat = '%' + (_this.levelNumber + 1).toString();\n            // tslint:disable-next-line:max-line-length\n            var numberFormatTextBox = document.getElementById(_this.owner.owner.containerId + '_numberFormat');\n            if (_this.listLevel.listLevelPattern === 'Bullet') {\n                _this.listLevel.numberFormat = '\\uf0b7';\n                numberFormatTextBox.value = _this.listLevel.numberFormat;\n                _this.listLevel.characterFormat.fontFamily = 'Wingdings';\n            }\n            else {\n                if (_this.listLevel.listLevelPattern === 'None') {\n                    _this.listLevel.numberFormat = '';\n                }\n                if (!_this.listLevel.numberFormat.match(numberFormat) && _this.listLevel.listLevelPattern !== 'None') {\n                    _this.listLevel.numberFormat = numberFormat + '.';\n                }\n                numberFormatTextBox.value = _this.listLevel.numberFormat;\n            }\n        };\n        this.loadListDialog = function () {\n            _this.owner.updateFocus();\n            if (isNullOrUndefined(_this.owner.owner)) {\n                return;\n            }\n            _this.viewModel = new ListViewModel();\n            _this.viewModel.dialog = _this;\n            if (_this.owner.selection.paragraphFormat.listLevelNumber > 0) {\n                _this.viewModel.levelNumber = _this.owner.selection.paragraphFormat.listLevelNumber;\n            }\n            _this.viewModel.list = _this.owner.selection.paragraphFormat.getList();\n            if (isNullOrUndefined(_this.listLevel)) {\n                return;\n            }\n            if (isNullOrUndefined(_this.listLevel.characterFormat)) {\n                _this.listLevel.characterFormat = new WCharacterFormat(_this.viewModel.listLevel);\n            }\n            if (isNullOrUndefined(_this.listLevel.paragraphFormat)) {\n                _this.listLevel.paragraphFormat = new WParagraphFormat(_this.viewModel.listLevel);\n            }\n            _this.updateDialogValues();\n            if (_this.owner.selection.caret.style.display !== 'none') {\n                _this.owner.selection.caret.style.display = 'none';\n            }\n        };\n        this.showFontDialog = function () {\n            _this.owner.owner.fontDialogModule.showFontDialog(_this.listLevel.characterFormat);\n        };\n        this.onApplyList = function () {\n            if (!isNullOrUndefined(_this.owner)) {\n                _this.owner.selection.paragraphFormat.setList(_this.list);\n            }\n            _this.owner.dialog2.hide();\n            _this.owner.updateFocus();\n        };\n        this.onCancelButtonClick = function () {\n            _this.disposeBindingForListUI();\n            _this.owner.dialog2.hide();\n            _this.owner.updateFocus();\n            _this.isListCharacterFormat = false;\n        };\n        this.closeListDialog = function () {\n            _this.disposeBindingForListUI();\n            _this.owner.updateFocus();\n            _this.isListCharacterFormat = false;\n        };\n        this.owner = viewer;\n        this.viewModel = new ListViewModel();\n    }\n    Object.defineProperty(ListDialog.prototype, \"listLevel\", {\n        /**\n         * @private\n         */\n        get: function () {\n            if (!isNullOrUndefined(this.viewModel)) {\n                return this.viewModel.listLevel;\n            }\n            return undefined;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(ListDialog.prototype, \"list\", {\n        /**\n         * @private\n         */\n        get: function () {\n            if (!isNullOrUndefined(this.viewModel)) {\n                return this.viewModel.list;\n            }\n            return undefined;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(ListDialog.prototype, \"levelNumber\", {\n        /**\n         * @private\n         */\n        get: function () {\n            if (this.listLevel.ownerBase instanceof WLevelOverride) {\n                return this.listLevel.ownerBase.levelNumber;\n                // tslint:disable-next-line:max-line-length\n            }\n            else if (this.listLevel.ownerBase instanceof WAbstractList && !isNullOrUndefined(this.listLevel.ownerBase.levels)) {\n                return this.listLevel.ownerBase.levels.indexOf(this.listLevel);\n            }\n            else {\n                return -1;\n            }\n        },\n        enumerable: true,\n        configurable: true\n    });\n    /**\n     * @private\n     */\n    ListDialog.prototype.getModuleName = function () {\n        return 'ListDialog';\n    };\n    /**\n     * @private\n     */\n    ListDialog.prototype.showListDialog = function () {\n        var locale = new L10n('documenteditor', this.owner.owner.defaultLocale);\n        locale.setLocale(this.owner.owner.locale);\n        setCulture(this.owner.owner.locale);\n        if (!this.target) {\n            this.initListDialog(locale);\n        }\n        this.isListCharacterFormat = true;\n        this.owner.dialog2.header = locale.getConstant('Define new Multilevel list');\n        this.owner.dialog2.height = 'auto';\n        this.owner.dialog2.width = 'auto';\n        this.owner.dialog2.content = this.target;\n        this.owner.dialog2.buttons = [{\n                click: this.showFontDialog,\n                buttonModel: { content: locale.getConstant('Font'), cssClass: 'e-flat e-list-dlg-font e-font' }\n            }, {\n                click: this.onApplyList,\n                buttonModel: { content: locale.getConstant('Ok'), cssClass: 'e-flat e-list-dlg', isPrimary: true }\n            },\n            {\n                click: this.onCancelButtonClick,\n                buttonModel: { content: locale.getConstant('Cancel'), cssClass: 'e-flat e-list-dlg' }\n            }];\n        this.owner.dialog2.dataBind();\n        this.owner.dialog2.beforeOpen = this.loadListDialog;\n        this.owner.dialog2.close = this.closeListDialog;\n        this.owner.dialog2.position = { X: 'center', Y: 'top' };\n        this.owner.dialog2.show();\n    };\n    /**\n     * Shows the table properties dialog\n     * @private\n     */\n    ListDialog.prototype.initListDialog = function (locale) {\n        var instance = this;\n        var containerId = this.owner.owner.containerId;\n        var id = containerId + '_insert_list';\n        this.target = createElement('div', { id: id, className: 'e-de-list-dlg' });\n        this.owner.owner.element.appendChild(this.target);\n        // tslint:disable-next-line:max-line-length\n        var listLevelDiv = createElement('div', { innerHTML: '<label id=\"' + containerId + '_listLevellabel\" style=\"display:block;\" class=e-de-list-ddl-header-list-level>' + locale.getConstant('List level') + '</label><label id=\"' + containerId + '_modifyLabel\" style=\"display:block;\" class=e-de-list-ddl-subheader>' + locale.getConstant('Choose level to modify') + '</label><select style=\"height:20px;width:43%\" id=\"' + containerId + '_listLevel\"><option>' + locale.getConstant('Level') + ' 1' + '</option><option>' + locale.getConstant('Level') + ' 2' + '</option><option>' + locale.getConstant('Level') + ' 3' + '</option><option>' + locale.getConstant('Level') + ' 4' + '</option><option>' + locale.getConstant('Level') + ' 5' + '</option><option>' + locale.getConstant('Level') + ' 6' + '</option><option>' + locale.getConstant('Level') + ' 7' + '</option><option>' + locale.getConstant('Level') + ' 8' + '</option><option>' + locale.getConstant('Level') + ' 9' + '</option></select>' });\n        this.target.appendChild(listLevelDiv);\n        var div = createElement('div');\n        // tslint:disable-next-line:max-line-length\n        var numberStyleDiv = createElement('div', { innerHTML: '<div style=\"float:left;display:block;\"><label id=\"' + containerId + '_numberFormatLabel\" style=\"display:block;\" class=e-de-list-ddl-header>' + locale.getConstant('Number format') + '</label><label id=\"' + containerId + '_numberStyleLabel\" style=\"display:block;\" class=e-de-list-ddl-subheader>' + locale.getConstant('Number style for this level') + '</label><select style=\"height:20px;width:100%\" id=\"' + containerId + '_numberStyle\"><option>' + locale.getConstant('Arabic') + '</option><option>' + locale.getConstant('UpRoman') + '</option><option>' + locale.getConstant('LowRoman') + '</option><option>' + locale.getConstant('UpLetter') + '</option><option>' + locale.getConstant('LowLetter') + '</option><option>' + locale.getConstant('Number') + '</option><option>' + locale.getConstant('Leading zero') + '</option><option>' + locale.getConstant('Bullet') + '</option><option>' + locale.getConstant('Ordinal') + '</option><option>' + locale.getConstant('Ordinal Text') + '</option><option>' + locale.getConstant('Special') + '</option><option>' + locale.getConstant('For East') + '</option></select><label id=\"' + containerId + '_startAtLabel\" style=\"display:block;\" class=e-de-list-ddl-subheaderbottom>' + locale.getConstant('Start at') + '</label><input type=\"text\" id=\"' + containerId + '_startAt\">' });\n        div.appendChild(numberStyleDiv);\n        // tslint:disable-next-line:max-line-length\n        var numberFormatDiv = createElement('div', { className: 'e-de-list-dlg-subdiv', innerHTML: '<div><div><label id=\"' + containerId + '_formatLabel\" style=\"display:inline-block;width:86%\" class=e-de-list-ddl-subheader>' + locale.getConstant('Enter formatting for number') + '</label><button id=\"' + containerId + '_list_info\" class=\"e-control e-btn e-primary e-de-list-format-info\">i</button></div><input style=width:180px; type=\"text\" id=\"' + containerId + '_numberFormat\" class=e-input></div><label id=\"' + containerId + '_restartLabel\" style=\"display:block;\" class=e-de-list-ddl-subheaderbottom>' + locale.getConstant('Restart list after') + '</label><select style=\"height:20px;width:100%\" id=\"' + containerId + '_restartBy\"><option>' + locale.getConstant('No Restart') + '</option></select></div>' });\n        div.appendChild(numberFormatDiv);\n        this.target.appendChild(div);\n        // tslint:disable-next-line:max-line-length\n        var indentsDiv = createElement('div', { innerHTML: '<div style=\"float:left;display:block;\"><label id=\"' + containerId + '_IndentsLabel\" style=\"display:block;\" class=e-de-list-ddl-header>' + locale.getConstant('Position') + '</label><label id=\"' + containerId + '_textIndentLabel\" style=\"display:block;\" class=e-de-list-ddl-subheader>' + locale.getConstant('Text indent at') + '</label><input type=\"text\" id=\"' + containerId + '_textIndent\"><label id=\"' + containerId + '_followCharacterLabel\" style=\"display:block;\" class=e-de-list-ddl-subheaderbottom>' + locale.getConstant('Follow number with') + '</label><select style=\"height:20px;width:100%\" id=\"' + containerId + '_followCharacter\"><option>' + locale.getConstant('Tab character') + '</option><option>' + locale.getConstant('Space') + '</option><option>' + locale.getConstant('Nothing') + '</option></select></div><div class=\"e-de-list-dlg-div\"><label id=\"' + containerId + '_alignedAtLabel\" style=\"display:block;\" class=e-de-list-ddl-subheader>' + locale.getConstant('Aligned at') + '</label><input type=\"text\" id=\"' + containerId + '_alignedAt\"></div>', });\n        this.target.appendChild(indentsDiv);\n        var startAtTextBox = document.getElementById(containerId + '_startAt');\n        var textIndentAtTextBox = document.getElementById(containerId + '_textIndent');\n        var alignedAtTextBox = document.getElementById(containerId + '_alignedAt');\n        this.startAt = new NumericTextBox({\n            format: '#',\n            decimals: 0,\n            min: 0,\n            max: 50,\n            width: '180px',\n            enablePersistence: false,\n        });\n        this.startAt.addEventListener('change', instance.onStartValueChanged);\n        this.startAt.appendTo(startAtTextBox);\n        this.textIndent = new NumericTextBox({\n            format: '#',\n            decimals: 0,\n            min: 0,\n            max: 1584,\n            width: '180px',\n            step: 4,\n            enablePersistence: false\n        });\n        this.textIndent.addEventListener('change', instance.onTextIndentChanged);\n        this.textIndent.appendTo(textIndentAtTextBox);\n        this.alignedAt = new NumericTextBox({\n            format: '#',\n            max: 1584,\n            step: 6,\n            width: '180px',\n            enablePersistence: false\n        });\n        this.alignedAt.addEventListener('change', instance.onAlignedAtValueChanged);\n        this.alignedAt.appendTo(alignedAtTextBox);\n        var listLevel = document.getElementById(containerId + '_listLevel');\n        this.listLevelElement = new DropDownList({ popupHeight: '150px', width: '180px', change: instance.onListLevelValueChanged });\n        this.listLevelElement.appendTo(listLevel);\n        var followCharacterElement = document.getElementById(containerId + '_followCharacter');\n        this.followNumberWith = new DropDownList({ popupHeight: '150px', width: '180px', change: instance.onFollowCharacterValueChanged });\n        this.followNumberWith.appendTo(followCharacterElement);\n        var numberStyleEle = document.getElementById(containerId + '_numberStyle');\n        this.numberStyle = new DropDownList({ popupHeight: '150px', width: '180px', change: instance.onLevelPatternValueChanged });\n        this.numberStyle.appendTo(numberStyleEle);\n        this.numberFormat = document.getElementById(containerId + '_numberFormat');\n        this.numberFormat.addEventListener('change', instance.onNumberFormatChanged);\n        var restartElement = document.getElementById(containerId + '_restartBy');\n        this.restartBy = new DropDownList({ popupHeight: '150px', width: '180px' });\n        this.restartBy.appendTo(restartElement);\n        var button = document.getElementById(containerId + '_list_info');\n        this.formatInfoToolTip = new Tooltip({ width: 200 });\n        // tslint:disable-next-line:max-line-length\n        this.formatInfoToolTip.content = locale.getConstant('Number format tooltip information');\n        this.formatInfoToolTip.position = 'RightTop';\n        this.formatInfoToolTip.appendTo(button);\n    };\n    ListDialog.prototype.updateRestartLevelBox = function () {\n        var containerId = this.owner.owner.containerId;\n        var listLevel = document.getElementById(containerId + '_listLevel');\n        var restartBy = document.getElementById(containerId + '_restartBy');\n        for (var i = 0; i < restartBy.options.length; i) {\n            restartBy.options.remove(i);\n        }\n        if (listLevel.selectedIndex === 0) {\n            var option = document.createElement('option');\n            option.value = 'No Restart';\n            option.innerHTML = 'No Restart';\n            restartBy.appendChild(option);\n        }\n        else {\n            for (var i = listLevel.selectedIndex; i > 0; i--) {\n                var option_1 = document.createElement('option');\n                option_1.value = 'Level ' + i;\n                option_1.innerHTML = 'Level ' + i;\n                restartBy.appendChild(option_1);\n            }\n            var option = document.createElement('option');\n            option.value = 'No Restart';\n            option.innerHTML = 'No Restart';\n            restartBy.appendChild(option);\n        }\n        restartBy.selectedIndex = 0;\n    };\n    ListDialog.prototype.listPatternConverter = function (listLevelPattern) {\n        switch (listLevelPattern) {\n            case 'Arabic': return 0;\n            case 'UpRoman': return 1;\n            case 'LowRoman': return 2;\n            case 'UpLetter': return 3;\n            case 'LowLetter': return 4;\n            case 'Number': return 5;\n            case 'LeadingZero': return 6;\n            case 'Bullet': return 7;\n            case 'Ordinal': return 8;\n            case 'OrdinalText': return 9;\n            case 'Special': return 10;\n            case 'FarEast': return 11;\n            default: return 12;\n        }\n    };\n    ListDialog.prototype.followCharacterConverter = function (followCharacter) {\n        switch (followCharacter) {\n            case 'Tab':\n                return 0;\n            case 'Space':\n                return 1;\n            default:\n                return 2;\n        }\n    };\n    ListDialog.prototype.updateDialogValues = function () {\n        // tslint:disable-next-line:max-line-length\n        var restartByTextBox = document.getElementById(this.owner.owner.containerId + '_restartBy');\n        this.startAt.value = this.viewModel.listLevel.startAt;\n        this.textIndent.value = this.viewModel.listLevel.paragraphFormat.leftIndent;\n        this.alignedAt.value = this.viewModel.listLevel.paragraphFormat.firstLineIndent;\n        this.followNumberWith.index = this.followCharacterConverter(this.viewModel.followCharacter);\n        this.numberFormat.value = this.viewModel.listLevel.numberFormat;\n        this.numberStyle.index = this.listPatternConverter(this.viewModel.listLevelPattern);\n        this.listLevelElement.index = this.viewModel.levelNumber;\n        this.viewModel.levelNumber = this.viewModel.levelNumber;\n    };\n    ListDialog.prototype.disposeBindingForListUI = function () {\n        this.followNumberWith.index = -1;\n        this.numberFormat.value = ' ';\n        this.numberStyle.index = -1;\n        this.listLevelElement.index = -1;\n        this.restartBy.index = -1;\n        this.viewModel.destroy();\n    };\n    /**\n     * @private\n     */\n    ListDialog.prototype.destroy = function () {\n        if (this.alignedAt) {\n            this.alignedAt.destroy();\n        }\n        this.alignedAt = undefined;\n        this.dialog = undefined;\n        if (this.followNumberWith) {\n            this.followNumberWith.destroy();\n        }\n        this.followNumberWith = undefined;\n        if (this.listLevelElement) {\n            this.listLevelElement.destroy();\n        }\n        this.listLevelElement = undefined;\n        if (this.textIndent) {\n            this.textIndent.destroy();\n        }\n        this.textIndent = undefined;\n        if (this.startAt) {\n            this.startAt.destroy();\n        }\n        this.startAt = undefined;\n        if (this.numberStyle) {\n            this.numberStyle.destroy();\n        }\n        this.numberStyle = undefined;\n        this.numberFormat = undefined;\n        if (this.restartBy) {\n            this.restartBy.destroy();\n        }\n        this.restartBy = undefined;\n        if (!isNullOrUndefined(this.target)) {\n            if (this.target.parentElement) {\n                this.target.parentElement.removeChild(this.target);\n            }\n            for (var l = 0; l < this.target.childNodes.length; l++) {\n                this.target.removeChild(this.target.childNodes[l]);\n                l--;\n            }\n            this.target = undefined;\n        }\n        this.owner = undefined;\n        this.viewModel = undefined;\n    };\n    return ListDialog;\n}());\nexport { ListDialog };\n/* tslint:enable:no-any */ \n","import { createElement, isNullOrUndefined, L10n, setCulture } from '@syncfusion/ej2-base';\nimport { DropDownList, ComboBox } from '@syncfusion/ej2-dropdowns';\nimport { Button } from '@syncfusion/ej2-buttons';\nimport { WCharacterStyle, WParagraphStyle } from '../../implementation/format/style';\nimport { BulletsAndNumberingDialog } from './index';\nimport { WAbstractList } from '../list/abstract-list';\nimport { ColorPicker } from '@syncfusion/ej2-inputs';\nimport { DropDownButton } from '@syncfusion/ej2-splitbuttons';\n/**\n * The Style dialog is used to create or modify styles.\n */\nvar StyleDialog = /** @class */ (function () {\n    /**\n     * @private\n     */\n    function StyleDialog(viewer) {\n        var _this = this;\n        this.target = undefined;\n        this.styleType = undefined;\n        this.styleBasedOn = undefined;\n        this.styleParagraph = undefined;\n        this.onlyThisDocument = undefined;\n        this.template = undefined;\n        this.fontFamily = undefined;\n        this.fontSize = undefined;\n        this.characterFormat = undefined;\n        this.paragraphFormat = undefined;\n        /* tslint:disable-next-line:no-any */\n        this.openDialog = function (args) {\n            switch (args.item.id) {\n                case 'style_font':\n                    _this.showFontDialog();\n                    break;\n                case 'style_paragraph':\n                    _this.showParagraphDialog();\n                    break;\n                case 'style_numbering':\n                    _this.showNumberingBulletDialog();\n                    break;\n            }\n        };\n        this.setBoldProperty = function () {\n            _this.characterFormat.bold = !_this.characterFormat.bold;\n            _this.fontButtonClicked(undefined);\n        };\n        this.setItalicProperty = function () {\n            _this.characterFormat.italic = !_this.characterFormat.italic;\n            _this.fontButtonClicked(undefined);\n        };\n        this.setUnderlineProperty = function () {\n            _this.characterFormat.underline = _this.characterFormat.underline === 'None' ? 'Single' : 'None';\n            _this.fontButtonClicked(undefined);\n        };\n        /* tslint:disable-next-line:no-any */\n        this.fontButtonClicked = function (args) {\n            if (_this.characterFormat.bold) {\n                if (!_this.bold.classList.contains('e-active')) {\n                    _this.bold.classList.add('e-active');\n                }\n            }\n            else {\n                if (_this.bold.classList.contains('e-active')) {\n                    _this.bold.classList.remove('e-active');\n                }\n            }\n            if (_this.characterFormat.italic) {\n                if (!_this.italic.classList.contains('e-active')) {\n                    _this.italic.classList.add('e-active');\n                }\n            }\n            else {\n                if (_this.italic.classList.contains('e-active')) {\n                    _this.italic.classList.remove('e-active');\n                }\n            }\n            if (_this.characterFormat.underline !== undefined && _this.characterFormat.underline !== 'None') {\n                if (!_this.underline.classList.contains('e-active')) {\n                    _this.underline.classList.add('e-active');\n                    _this.characterFormat.underline = 'Single';\n                }\n            }\n            else {\n                if (_this.underline.classList.contains('e-active')) {\n                    _this.underline.classList.remove('e-active');\n                    _this.characterFormat.underline = 'None';\n                }\n            }\n        };\n        /* tslint:disable-next-line:no-any */\n        this.fontSizeUpdate = function (args) {\n            _this.characterFormat.fontSize = args.value;\n        };\n        /* tslint:disable-next-line:no-any */\n        this.fontFamilyChanged = function (args) {\n            _this.characterFormat.fontFamily = args.value;\n        };\n        /* tslint:disable-next-line:no-any */\n        this.fontColorUpdate = function (args) {\n            _this.characterFormat.fontColor = args.currentValue.rgba;\n        };\n        this.setLeftAlignment = function () {\n            if (_this.paragraphFormat.textAlignment === 'Left') {\n                _this.paragraphFormat.textAlignment = 'Justify';\n            }\n            else {\n                _this.paragraphFormat.textAlignment = 'Left';\n            }\n            _this.updateParagraphFormat();\n        };\n        this.setRightAlignment = function () {\n            if (_this.paragraphFormat.textAlignment === 'Right') {\n                _this.paragraphFormat.textAlignment = 'Left';\n            }\n            else {\n                _this.paragraphFormat.textAlignment = 'Right';\n            }\n            _this.updateParagraphFormat();\n        };\n        this.setCenterAlignment = function () {\n            if (_this.paragraphFormat.textAlignment === 'Center') {\n                _this.paragraphFormat.textAlignment = 'Left';\n            }\n            else {\n                _this.paragraphFormat.textAlignment = 'Center';\n            }\n            _this.updateParagraphFormat();\n        };\n        this.setJustifyAlignment = function () {\n            if (_this.paragraphFormat.textAlignment === 'Justify') {\n                _this.paragraphFormat.textAlignment = 'Left';\n            }\n            else {\n                _this.paragraphFormat.textAlignment = 'Justify';\n            }\n            _this.updateParagraphFormat();\n        };\n        this.increaseBeforeAfterSpacing = function () {\n            _this.paragraphFormat.beforeSpacing += 6;\n            _this.paragraphFormat.afterSpacing += 6;\n        };\n        this.decreaseBeforeAfterSpacing = function () {\n            if (_this.paragraphFormat.beforeSpacing >= 6) {\n                _this.paragraphFormat.beforeSpacing -= 6;\n            }\n            else {\n                _this.paragraphFormat.beforeSpacing = 0;\n            }\n            if (_this.paragraphFormat.afterSpacing >= 6) {\n                _this.paragraphFormat.afterSpacing -= 6;\n            }\n            else {\n                _this.paragraphFormat.afterSpacing = 0;\n            }\n        };\n        /**\n         * @private\n         */\n        this.updateNextStyle = function (args) {\n            var typedName = args.srcElement.value;\n            if (_this.getTypeValue() === 'Paragraph' && !isNullOrUndefined(typedName) && typedName !== '' && !_this.isUserNextParaUpdated) {\n                var styles = _this.owner.owner.viewer.styles.getStyleNames(_this.getTypeValue());\n                if (_this.isEdit) {\n                    styles = styles.filter(function (e) { return e !== _this.editStyleName; });\n                }\n                styles.push(typedName);\n                _this.styleParagraph.dataSource = styles;\n                _this.styleParagraph.index = null;\n                _this.styleParagraph.index = styles.indexOf(typedName);\n                _this.styleParagraph.dataBind();\n            }\n        };\n        /**\n         * @private\n         */\n        this.updateOkButton = function () {\n            var styleName = _this.target.getElementsByClassName('e-input e-de-style-dlg-name-input').item(0).value;\n            _this.enableOrDisableOkButton();\n        };\n        /**\n         * @private\n         */\n        /* tslint:disable-next-line:no-any */\n        this.styleTypeChange = function (args) {\n            if (args.isInteracted) {\n                var type = void 0;\n                if (args.value === 'Character') {\n                    _this.style = new WCharacterStyle();\n                    type = 'Character';\n                }\n                if (args.value === 'Paragraph' || args.value === 'Linked(Paragraph and Character)') {\n                    _this.style = new WParagraphStyle();\n                    type = 'Paragraph';\n                }\n                _this.toggleDisable();\n                _this.updateStyleNames(type);\n            }\n        };\n        /* tslint:disable-next-line:no-any */\n        this.styleBasedOnChange = function (args) {\n            //Based on change\n        };\n        /**\n         * @private\n         */\n        /* tslint:disable-next-line:no-any */\n        this.styleParagraphChange = function (args) {\n            if (args.isInteracted) {\n                _this.isUserNextParaUpdated = true;\n            }\n            //Next change\n        };\n        /**\n         * @private\n         */\n        this.showFontDialog = function () {\n            if (!isNullOrUndefined(_this.owner.owner.fontDialogModule)) {\n                _this.owner.owner.showFontDialog(_this.characterFormat);\n            }\n            _this.updateCharacterFormat();\n        };\n        /**\n         * @private\n         */\n        this.showParagraphDialog = function () {\n            if (!isNullOrUndefined(_this.owner.owner.paragraphDialogModule)) {\n                _this.owner.owner.showParagraphDialog(_this.paragraphFormat);\n            }\n        };\n        /**\n         * @private\n         */\n        this.showNumberingBulletDialog = function () {\n            _this.numberingBulletDialog = new BulletsAndNumberingDialog(_this.owner.owner.viewer);\n            if (_this.style instanceof WParagraphStyle && (!isNullOrUndefined(_this.style.paragraphFormat))) {\n                // tslint:disable-next-line:max-line-length\n                _this.numberingBulletDialog.showNumberBulletDialog(_this.style.paragraphFormat.listFormat, _this.abstractList);\n            }\n        };\n        /**\n         * @private\n         */\n        this.onOkButtonClick = function () {\n            var styleName = _this.styleNameElement.value;\n            if (styleName.length > 0) {\n                var style = _this.owner.owner.viewer.styles.findByName(styleName);\n                var name_1;\n                if (!isNullOrUndefined(style)) {\n                    _this.style.type = _this.getTypeValue();\n                    _this.style.basedOn = _this.owner.owner.viewer.styles.findByName(_this.styleBasedOn.value);\n                    if (_this.styleType.value === 'Paragraph' || _this.styleType.value === 'Linked(Paragraph and Character)') {\n                        _this.style.next = _this.owner.owner.viewer.styles.findByName(_this.styleParagraph.value);\n                        _this.style.characterFormat.mergeFormat(style.characterFormat);\n                        _this.style.paragraphFormat.mergeFormat(style.paragraphFormat);\n                        _this.updateList();\n                        // tslint:disable-next-line:max-line-length\n                        _this.style.link = (_this.styleType.value === 'Linked(Paragraph and Character)') ? _this.createLinkStyle(styleName, _this.isEdit) : undefined;\n                    }\n                    //Updating existing style implementation\n                    _this.style.name = style.name;\n                    name_1 = style.name;\n                    style = _this.style;\n                    _this.owner.owner.isShiftingEnabled = true;\n                    _this.owner.owner.editorModule.layoutWholeDocument();\n                    _this.owner.owner.isShiftingEnabled = false;\n                }\n                else {\n                    /* tslint:disable-next-line:no-any */\n                    var basedOn = _this.owner.owner.viewer.styles.findByName(_this.styleBasedOn.value);\n                    if (_this.styleType.value === 'Paragraph' || _this.styleType.value === 'Linked(Paragraph and Character)') {\n                        if (styleName === _this.styleParagraph.value) {\n                            _this.style.next = _this.style;\n                        }\n                        else {\n                            _this.style.next = _this.owner.owner.viewer.styles.findByName(_this.styleParagraph.value);\n                        }\n                        _this.updateList();\n                    }\n                    // tslint:disable-next-line:max-line-length\n                    _this.style.link = (_this.styleType.value === 'Linked(Paragraph and Character)') ? _this.createLinkStyle(styleName) : undefined;\n                    _this.style.type = _this.getTypeValue();\n                    _this.style.name = styleName;\n                    _this.style.basedOn = basedOn;\n                    /* tslint:disable-next-line:no-any */\n                    _this.owner.owner.viewer.styles.push(_this.style);\n                    name_1 = styleName;\n                    _this.owner.owner.editorModule.applyStyle(name_1);\n                }\n                _this.owner.owner.viewer.dialog2.hide();\n            }\n            else {\n                throw new Error('Enter valid Style name');\n            }\n            if (_this.style) {\n                //this.style.destroy();\n            }\n        };\n        /* tslint:disable-next-line:no-any */\n        this.loadStyleDialog = function (args) {\n            _this.owner.owner.viewer.updateFocus();\n            _this.isUserNextParaUpdated = false;\n            /*Â tslint:disable-next-line:max-line-length */\n            _this.styleNameElement = _this.target.getElementsByClassName('e-input e-de-style-dlg-name-input').item(0);\n            _this.styleNameElement.value = null;\n            if (!_this.isEdit) {\n                _this.styleType.index = 0; //Set to paragraph            \n            }\n            var name;\n            if (_this.isEdit) {\n                _this.styleNameElement.value = _this.editStyleName;\n                name = _this.editStyleName;\n            }\n            /*Â tslint:disable-next-line:max-line-length */\n            _this.okButton = _this.owner.dialog2.element.getElementsByClassName('e-flat e-style-okay').item(0);\n            _this.enableOrDisableOkButton();\n            _this.updateStyleNames(_this.getTypeValue(), name);\n            _this.updateCharacterFormat(_this.style.characterFormat);\n            _this.updateParagraphFormat(_this.style.paragraphFormat);\n        };\n        /**\n         * @private\n         */\n        this.onCancelButtonClick = function () {\n            if (!_this.isEdit && _this.style) {\n                _this.style.destroy();\n            }\n            _this.owner.owner.viewer.dialog2.hide();\n        };\n        /**\n         * @private\n         */\n        this.closeStyleDialog = function () {\n            _this.owner.owner.viewer.updateFocus();\n        };\n        this.owner = viewer;\n    }\n    /**\n     * @private\n     */\n    StyleDialog.prototype.getModuleName = function () {\n        return 'StyleDialog';\n    };\n    /**\n     * @private\n     */\n    //tslint:disable: max-func-body-length\n    StyleDialog.prototype.initStyleDialog = function (localValue) {\n        var instance = this;\n        var id = this.owner.owner.containerId + '_style';\n        this.target = createElement('div', { id: id, className: 'e-de-style-dialog' });\n        var container = createElement('div');\n        // tslint:disable-next-line:max-line-length\n        var properties = createElement('div', { className: 'e-de-style-properties', innerHTML: localValue.getConstant('Properties') });\n        container.appendChild(properties);\n        var styleNameTypeDiv = createElement('div', { styles: 'display:flex', className: 'e-de-style-nametype-div' });\n        container.appendChild(styleNameTypeDiv);\n        var nameWholeDiv = createElement('div', { className: 'e-de-style-left-div' });\n        styleNameTypeDiv.appendChild(nameWholeDiv);\n        var name = createElement('div', { className: 'e-de-style-name', innerHTML: localValue.getConstant('Name') + ':' });\n        nameWholeDiv.appendChild(name);\n        // tslint:disable-next-line:max-line-length\n        var nameValue = createElement('input', { id: this.owner.owner.containerId + '_style_name', styles: 'width:210px;', className: 'e-input e-de-style-dlg-name-input' });\n        nameValue.addEventListener('keyup', this.updateOkButton);\n        nameValue.addEventListener('input', this.updateOkButton);\n        nameValue.addEventListener('blur', this.updateNextStyle);\n        nameWholeDiv.appendChild(nameValue);\n        var styleTypeWholeDiv = createElement('div');\n        styleNameTypeDiv.appendChild(styleTypeWholeDiv);\n        // tslint:disable-next-line:max-line-length\n        var styleType = createElement('div', { className: 'e-de-style-styletype', innerHTML: localValue.getConstant('Style type') + ':' });\n        styleTypeWholeDiv.appendChild(styleType);\n        var styleTypeDivElement = createElement('div', { className: 'e-de-style-style-type-div' });\n        var styleTypeValue = createElement('select', { id: 'e-de-style-style-type' });\n        // tslint:disable-next-line:max-line-length\n        styleTypeValue.innerHTML = '<option>Paragraph</option><option>Character</option><option>Linked(Paragraph and Character)</option>'; //<option>Linked(Paragraph and Character)</option><option>Table</option><option>List</option>';\n        styleTypeDivElement.appendChild(styleTypeValue);\n        this.styleType = new DropDownList({ change: this.styleTypeChange, popupHeight: '253px', width: '210px' });\n        this.styleType.appendTo(styleTypeValue);\n        styleTypeWholeDiv.appendChild(styleTypeDivElement);\n        // tslint:disable-next-line:max-line-length\n        var styleBasedParaDiv = createElement('div', { styles: 'display:flex', className: 'e-de-style-based-para-div' });\n        container.appendChild(styleBasedParaDiv);\n        var styleBasedOnWholeDiv = createElement('div', { className: 'e-de-style-left-div' });\n        styleBasedParaDiv.appendChild(styleBasedOnWholeDiv);\n        // tslint:disable-next-line:max-line-length\n        var styleBasedOn = createElement('div', { className: 'e-de-style-style-based-on', innerHTML: localValue.getConstant('Style based on') + ':' });\n        styleBasedOnWholeDiv.appendChild(styleBasedOn);\n        var styleBasedOnDivElement = createElement('div', { className: 'e-de-style-style-based-on-div' });\n        // tslint:disable-next-line:max-line-length\n        var styleBasedOnValue = createElement('input', { id: 'e-de-style-style-based-on-value' });\n        //styleBasedOnValue.innerHTML = '<option>Normal</option><option>Heading 1</option><option>Heading 2</option><option>Heading 3</option><option>Heading 4</option><option>Heading 5</option><option>Heading 6</option>';\n        styleBasedOnDivElement.appendChild(styleBasedOnValue);\n        this.styleBasedOn = new DropDownList({ dataSource: [], select: this.styleBasedOnChange, popupHeight: '253px', width: '210px' });\n        this.styleBasedOn.appendTo(styleBasedOnValue);\n        styleBasedOnWholeDiv.appendChild(styleBasedOnDivElement);\n        var styleParagraphWholeDiv = createElement('div', { className: 'e-de-style-left-div' });\n        styleBasedParaDiv.appendChild(styleParagraphWholeDiv);\n        // tslint:disable-next-line:max-line-length\n        var styleParagraph = createElement('div', { className: 'e-de-style-style-paragraph', innerHTML: localValue.getConstant('Style for following paragraph') + ':' });\n        styleParagraphWholeDiv.appendChild(styleParagraph);\n        var styleParagraphDivElement = createElement('div', { className: 'e-de-style-style-paragraph-div' });\n        // tslint:disable-next-line:max-line-length\n        var styleParagraphValue = createElement('input', { id: 'e-de-style-style-paragraph-value' });\n        // tslint:disable-next-line:max-line-length\n        //styleParagraphValue.innerHTML = '<option>Normal</option><option>Heading 1</option><option>Heading 2</option><option>Heading 3</option><option>Heading 4</option><option>Heading 5</option><option>Heading 6</option>';\n        styleParagraphDivElement.appendChild(styleParagraphValue);\n        this.styleParagraph = new DropDownList({ dataSource: [], select: this.styleParagraphChange, popupHeight: '253px', width: '210px' });\n        this.styleParagraph.appendTo(styleParagraphValue);\n        styleParagraphWholeDiv.appendChild(styleParagraphDivElement);\n        // tslint:disable-next-line:max-line-length\n        var formatting = createElement('div', { className: 'e-de-style-formatting', innerHTML: localValue.getConstant('Formatting') });\n        container.appendChild(formatting);\n        var optionsDiv = createElement('div', { className: 'e-de-style-options-div' });\n        container.appendChild(optionsDiv);\n        var fontOptionsDiv = createElement('div', { styles: 'display:flex;margin-bottom: 15px;' });\n        optionsDiv.appendChild(fontOptionsDiv);\n        this.createFontOptions(fontOptionsDiv);\n        var paragraphOptionsDiv = createElement('div', { styles: 'display:flex', className: 'e-style-paragraph' });\n        optionsDiv.appendChild(paragraphOptionsDiv);\n        this.createParagraphOptions(paragraphOptionsDiv);\n        // let radioOptionsDiv: HTMLElement = createElement('div', { styles: 'display:flex' });\n        // container.appendChild(radioOptionsDiv);\n        // let onlyThisDocumentDiv: HTMLElement = createElement('div', { className: 'e-de-style-radio-button' });\n        // tslint:disable-next-line:max-line-length\n        // let onlyThisDocument: HTMLInputElement = createElement('input', { className: 'e-de-style-only-this-doc', attrs: { type: 'radio' } }) as HTMLInputElement;\n        // onlyThisDocumentDiv.appendChild(onlyThisDocument);\n        // tslint:disable-next-line:max-line-length\n        // this.onlyThisDocument = new RadioButton({ label: 'Only in this document', value: 'only in this document', checked: true, name: 'styles' });\n        // this.onlyThisDocument.appendTo(onlyThisDocument);\n        // radioOptionsDiv.appendChild(onlyThisDocumentDiv);\n        // let templateDiv: HTMLElement = createElement('div', { className: 'e-de-style-radio-button' });\n        // tslint:disable-next-line:max-line-length\n        // let template: HTMLInputElement = createElement('input', { className: 'e-de-style-temp', attrs: { type: 'radio' } }) as HTMLInputElement;\n        // templateDiv.appendChild(template);\n        // this.template = new RadioButton({ label: 'Template', value: 'template', name: 'styles' });\n        // this.template.appendTo(template);\n        // radioOptionsDiv.appendChild(templateDiv);\n        this.createFormatDropdown(container, localValue);\n        this.target.appendChild(container);\n    };\n    StyleDialog.prototype.createFormatDropdown = function (parentDiv, localValue) {\n        var _this = this;\n        var formatBtn = createElement('button', { id: 'style_format_dropdown', innerHTML: localValue.getConstant('Format') });\n        formatBtn.style.height = '35px';\n        parentDiv.appendChild(formatBtn);\n        var items = [{ text: localValue.getConstant('Font') + '..', id: 'style_font' },\n            { text: localValue.getConstant('Paragraph') + '..', id: 'style_paragraph' },\n            { text: localValue.getConstant('Numbering') + '..', id: 'style_numbering' }];\n        var dropDownbtn = new DropDownButton({\n            items: items, cssClass: 'e-de-style-format-dropdwn',\n            beforeItemRender: function (args) {\n                if (_this.styleType.value === 'Character') {\n                    if (args.item.text === 'Paragraph') {\n                        args.element.classList.add('e-disabled');\n                    }\n                    if (args.item.text === 'Numbering') {\n                        args.element.classList.add('e-disabled');\n                    }\n                }\n                else {\n                    if (args.item.text === 'Paragraph') {\n                        args.element.classList.remove('e-disabled');\n                    }\n                    if (args.item.text === 'Numbering') {\n                        args.element.classList.remove('e-disabled');\n                    }\n                }\n            }\n        });\n        dropDownbtn.appendTo(formatBtn);\n        dropDownbtn.addEventListener('select', this.openDialog);\n    };\n    StyleDialog.prototype.createFontOptions = function (parentDiv) {\n        var fontFamilyElement = createElement('select', { id: this.target.id + '_fontName' });\n        fontFamilyElement.innerHTML = '<option>Arial</option><option>Calibri</option><option>Candara</option>' +\n            '<option>Comic Sans MS</option><option>Consolas</option><option>Constantia</option><option>Corbel</option>' +\n            '<option>Courier New</option><option>Ebrima</option><option>Franklin Gothic</option>' +\n            '<option>Gabriola</option><option>Gadugi</option><option>Georgia</option><option>Impact</option>' +\n            '<option>Javanese Text</option><option>Microsoft Sans Serif</option><option>MS Gothic</option><option>MS UI Gothic</option>' +\n            '<option>Segoe Print</option><option>Times New Roman</option><option>Verdana</option><option>Segoe UI</option>' +\n            '<option>Algerian</option><option>Cambria</option><option>Georgia</option><option>Consolas</option>';\n        parentDiv.appendChild(fontFamilyElement);\n        this.fontFamily = new ComboBox({\n            width: '123px', popupWidth: '123px',\n            cssClass: 'e-style-font-fmaily-right', change: this.fontFamilyChanged\n        });\n        this.fontFamily.showClearButton = false;\n        this.fontFamily.appendTo(fontFamilyElement);\n        var fontSizeElement = createElement('input');\n        parentDiv.appendChild(fontSizeElement);\n        var sizeDataSource = [8, 9, 10, 11, 12, 14, 16, 18, 20, 22, 24, 26, 28, 36, 48, 72];\n        this.fontSize = new ComboBox({\n            dataSource: sizeDataSource, width: '73px', cssClass: 'e-style-font-fmaily-right',\n            change: this.fontSizeUpdate\n        });\n        this.fontSize.showClearButton = false;\n        this.fontSize.appendTo(fontSizeElement);\n        var fontGroupButton = createElement('div', { className: 'e-de-style-font-group-button' });\n        parentDiv.appendChild(fontGroupButton);\n        // tslint:disable-next-line:max-line-length\n        this.bold = this.createButtonElement(fontGroupButton, 'e-de-bold', 'e-de-style-bold-button-size', this.owner.owner.containerId + '_style_bold');\n        this.bold.addEventListener('click', this.setBoldProperty);\n        // tslint:disable-next-line:max-line-length\n        this.italic = this.createButtonElement(fontGroupButton, 'e-de-italic', 'e-de-style-icon-button-size', this.owner.owner.containerId + '_style_italic');\n        this.italic.addEventListener('click', this.setItalicProperty);\n        // tslint:disable-next-line:max-line-length\n        this.underline = this.createButtonElement(fontGroupButton, 'e-de-underline', 'e-de-style-icon-button-size', this.owner.owner.containerId + '_style_underline');\n        this.underline.addEventListener('click', this.setUnderlineProperty);\n        var fontColorElement = createElement('input', { attrs: { type: 'color' }, className: 'e-de-style-icon-button-size' });\n        parentDiv.appendChild(fontColorElement);\n        this.fontColor = new ColorPicker({ cssClass: 'e-de-style-font-color-picker', change: this.fontColorUpdate });\n        this.fontColor.appendTo(fontColorElement);\n    };\n    StyleDialog.prototype.createParagraphOptions = function (parentDiv) {\n        var _this = this;\n        var alignmentDiv = createElement('div', { className: 'e-de-style-paragraph-group-button' });\n        parentDiv.appendChild(alignmentDiv);\n        this.leftAlign = this.createButtonElement(alignmentDiv, 'e-de-align-left', 'e-de-style-icon-button-size');\n        this.leftAlign.addEventListener('click', this.setLeftAlignment);\n        this.centerAlign = this.createButtonElement(alignmentDiv, 'e-de-align-center', 'e-de-style-icon-button-size');\n        this.centerAlign.addEventListener('click', this.setCenterAlignment);\n        this.rightAlign = this.createButtonElement(alignmentDiv, 'e-de-align-right', 'e-de-style-icon-button-size');\n        this.rightAlign.addEventListener('click', this.setRightAlignment);\n        this.justify = this.createButtonElement(alignmentDiv, 'e-de-justify', 'e-de-style-icon-button-last-size');\n        this.justify.addEventListener('click', this.setJustifyAlignment);\n        var lineSpacingDiv = createElement('div', { className: 'e-de-style-paragraph-group-button' });\n        parentDiv.appendChild(lineSpacingDiv);\n        this.singleLineSpacing = this.createButtonElement(lineSpacingDiv, 'e-de-single-spacing', 'e-de-style-icon-button-first-size');\n        this.singleLineSpacing.addEventListener('click', function () {\n            _this.paragraphFormat.lineSpacing = 1;\n            _this.updateParagraphFormat();\n        });\n        // tslint:disable-next-line:max-line-length\n        this.onePointFiveLineSpacing = this.createButtonElement(lineSpacingDiv, 'e-de-one-point-five-spacing', 'e-de-style-icon-button-size');\n        this.onePointFiveLineSpacing.addEventListener('click', function () {\n            _this.paragraphFormat.lineSpacing = 1.5;\n            _this.updateParagraphFormat();\n        });\n        this.doubleLineSpacing = this.createButtonElement(lineSpacingDiv, 'e-de-double-spacing', 'e-de-style-icon-button-last-size');\n        this.doubleLineSpacing.addEventListener('click', function () {\n            _this.paragraphFormat.lineSpacing = 2;\n            _this.updateParagraphFormat();\n        });\n        var spacingDiv = createElement('div', { className: 'e-de-style-paragraph-group-button' });\n        parentDiv.appendChild(spacingDiv);\n        var beforeSpacing = this.createButtonElement(spacingDiv, 'e-de-before-spacing', 'e-de-style-icon-button-first-size');\n        var afterSpacing = this.createButtonElement(spacingDiv, 'e-de-after-spacing', 'e-de-style-icon-button-last-size');\n        beforeSpacing.addEventListener('click', this.increaseBeforeAfterSpacing);\n        afterSpacing.addEventListener('click', this.decreaseBeforeAfterSpacing);\n        var indentingDiv = createElement('div', { className: 'e-de-style-paragraph-indent-group-button' });\n        parentDiv.appendChild(indentingDiv);\n        var decreaseIndent = this.createButtonElement(indentingDiv, 'e-de-indent', 'e-de-style-icon-button-first-size');\n        decreaseIndent.addEventListener('click', function () {\n            if (_this.paragraphFormat.leftIndent >= 36) {\n                _this.paragraphFormat.leftIndent -= 36;\n            }\n            else {\n                _this.paragraphFormat.leftIndent = 0;\n            }\n        });\n        var increaseindent = this.createButtonElement(indentingDiv, 'e-de-outdent', 'e-de-style-icon-button-size');\n        increaseindent.addEventListener('click', function () {\n            _this.paragraphFormat.leftIndent += 36;\n        });\n    };\n    StyleDialog.prototype.createButtonElement = function (parentDiv, iconCss, className, id) {\n        var buttonElement = createElement('button');\n        if (!isNullOrUndefined(id)) {\n            buttonElement.id = id;\n        }\n        parentDiv.appendChild(buttonElement);\n        var button = new Button({ iconCss: iconCss, cssClass: className });\n        button.appendTo(buttonElement);\n        return buttonElement;\n    };\n    StyleDialog.prototype.toggleDisable = function () {\n        if (this.styleType.value === 'Character') {\n            this.styleParagraph.enabled = false;\n            // tslint:disable-next-line:max-line-length\n            this.target.getElementsByClassName('e-style-paragraph').item(0).setAttribute('style', 'display:flex;pointer-events:none;opacity:0.5');\n        }\n        else {\n            this.styleParagraph.enabled = true;\n            this.target.getElementsByClassName('e-style-paragraph').item(0).removeAttribute('style');\n            this.target.getElementsByClassName('e-style-paragraph').item(0).setAttribute('style', 'display:flex');\n        }\n        this.styleBasedOn.enabled = true;\n    };\n    /**\n     * @private\n     */\n    StyleDialog.prototype.show = function (styleName, header) {\n        var localObj = new L10n('documenteditor', this.owner.owner.defaultLocale);\n        this.isEdit = (!isNullOrUndefined(styleName) && styleName.length > 0) ? true : false;\n        this.editStyleName = styleName;\n        this.abstractList = new WAbstractList();\n        // tslint:disable-next-line:max-line-length\n        var style = this.owner.owner.viewer.styles.findByName(styleName);\n        this.style = !this.isEdit ? new WParagraphStyle() : style ? style : this.getStyle(styleName);\n        localObj.setLocale(this.owner.owner.locale);\n        setCulture(this.owner.owner.locale);\n        if (!this.target) {\n            this.initStyleDialog(localObj);\n        }\n        if (isNullOrUndefined(header)) {\n            header = localObj.getConstant('Create New Style');\n        }\n        this.owner.owner.viewer.dialog2.header = header;\n        this.owner.owner.viewer.dialog2.height = 'auto';\n        this.owner.owner.viewer.dialog2.width = 'auto';\n        this.owner.owner.viewer.dialog2.content = this.target;\n        this.owner.owner.viewer.dialog2.buttons = [{\n                click: this.onOkButtonClick,\n                buttonModel: { content: localObj.getConstant('Ok'), cssClass: 'e-flat e-style-okay', isPrimary: true }\n            },\n            {\n                click: this.onCancelButtonClick,\n                buttonModel: { content: localObj.getConstant('Cancel'), cssClass: 'e-flat e-style-cancel' }\n            }];\n        this.toggleDisable();\n        this.owner.owner.viewer.dialog2.dataBind();\n        this.owner.owner.viewer.dialog2.beforeOpen = this.loadStyleDialog;\n        this.owner.owner.viewer.dialog2.close = this.closeStyleDialog;\n        this.owner.owner.viewer.dialog2.position = { X: 'center', Y: 'center' };\n        this.owner.owner.viewer.dialog2.show();\n    };\n    StyleDialog.prototype.updateList = function () {\n        var listId = this.style.paragraphFormat.listFormat.listId;\n        if (listId > -1) {\n            if (this.owner.owner.viewer.lists.filter(function (a) { return (a.listId === listId); }).length === 0) {\n                this.owner.owner.viewer.lists.push(this.style.paragraphFormat.listFormat.list);\n            }\n            else {\n                this.owner.owner.viewer.lists = this.owner.owner.viewer.lists.filter(function (a) { return (a.listId !== listId); });\n                this.owner.owner.viewer.lists.push(this.style.paragraphFormat.listFormat.list);\n            }\n        }\n        if (this.abstractList.abstractListId !== -1) {\n            this.owner.owner.viewer.abstractLists.push(this.abstractList);\n        }\n    };\n    StyleDialog.prototype.createLinkStyle = function (name, isEdit) {\n        var charStyle;\n        if (isEdit) {\n            charStyle = this.owner.owner.viewer.styles.findByName((name + ' Char'), 'Character');\n        }\n        else {\n            charStyle = new WCharacterStyle();\n        }\n        charStyle.type = 'Character';\n        charStyle.name = name + ' Char';\n        charStyle.characterFormat = this.style.characterFormat.cloneFormat();\n        charStyle.basedOn = this.style.basedOn;\n        if (!isEdit) {\n            this.owner.owner.viewer.styles.push(charStyle);\n        }\n        return this.owner.owner.viewer.styles.findByName(charStyle.name, 'Character');\n    };\n    /**\n     * @private\n     */\n    StyleDialog.prototype.updateCharacterFormat = function (characterFormat) {\n        if (!isNullOrUndefined(characterFormat)) {\n            this.characterFormat = characterFormat;\n        }\n        this.fontFamily.value = this.characterFormat.fontFamily;\n        this.fontSize.value = this.characterFormat.fontSize;\n        this.fontColor.value = this.characterFormat.fontColor;\n        this.fontButtonClicked(undefined);\n    };\n    /**\n     * @private\n     */\n    StyleDialog.prototype.updateParagraphFormat = function (paragraphFOrmat) {\n        if (!isNullOrUndefined(paragraphFOrmat)) {\n            this.paragraphFormat = paragraphFOrmat;\n        }\n        if (this.paragraphFormat.textAlignment === 'Left') {\n            if (!this.leftAlign.classList.contains('e-active')) {\n                this.leftAlign.classList.add('e-active');\n            }\n            if (this.rightAlign.classList.contains('e-active')) {\n                this.rightAlign.classList.remove('e-active');\n            }\n            if (this.centerAlign.classList.contains('e-active')) {\n                this.centerAlign.classList.remove('e-active');\n            }\n            if (this.justify.classList.contains('e-active')) {\n                this.justify.classList.remove('e-active');\n            }\n        }\n        else if (this.paragraphFormat.textAlignment === 'Right') {\n            if (this.leftAlign.classList.contains('e-active')) {\n                this.leftAlign.classList.remove('e-active');\n            }\n            if (!this.rightAlign.classList.contains('e-active')) {\n                this.rightAlign.classList.add('e-active');\n            }\n            if (this.centerAlign.classList.contains('e-active')) {\n                this.centerAlign.classList.remove('e-active');\n            }\n            if (this.justify.classList.contains('e-active')) {\n                this.justify.classList.remove('e-active');\n            }\n        }\n        else if (this.paragraphFormat.textAlignment === 'Center') {\n            if (this.leftAlign.classList.contains('e-active')) {\n                this.leftAlign.classList.remove('e-active');\n            }\n            if (this.rightAlign.classList.contains('e-active')) {\n                this.rightAlign.classList.remove('e-active');\n            }\n            if (!this.centerAlign.classList.contains('e-active')) {\n                this.centerAlign.classList.add('e-active');\n            }\n            if (this.justify.classList.contains('e-active')) {\n                this.justify.classList.remove('e-active');\n            }\n        }\n        else if (this.paragraphFormat.textAlignment === 'Justify') {\n            if (this.leftAlign.classList.contains('e-active')) {\n                this.leftAlign.classList.remove('e-active');\n            }\n            if (this.rightAlign.classList.contains('e-active')) {\n                this.rightAlign.classList.remove('e-active');\n            }\n            if (this.centerAlign.classList.contains('e-active')) {\n                this.centerAlign.classList.remove('e-active');\n            }\n            if (!this.justify.classList.contains('e-active')) {\n                this.justify.classList.add('e-active');\n            }\n        }\n        if (this.paragraphFormat.lineSpacing === 1) {\n            this.singleLineSpacing.classList.add('e-active');\n            this.onePointFiveLineSpacing.classList.remove('e-active');\n            this.doubleLineSpacing.classList.remove('e-active');\n        }\n        else if (this.paragraphFormat.lineSpacing === 1.5) {\n            this.singleLineSpacing.classList.remove('e-active');\n            this.onePointFiveLineSpacing.classList.add('e-active');\n            this.doubleLineSpacing.classList.remove('e-active');\n        }\n        else if (this.paragraphFormat.lineSpacing === 2) {\n            this.singleLineSpacing.classList.remove('e-active');\n            this.onePointFiveLineSpacing.classList.remove('e-active');\n            this.doubleLineSpacing.classList.add('e-active');\n        }\n        else {\n            this.singleLineSpacing.classList.remove('e-active');\n            this.onePointFiveLineSpacing.classList.remove('e-active');\n            this.doubleLineSpacing.classList.remove('e-active');\n        }\n    };\n    StyleDialog.prototype.enableOrDisableOkButton = function () {\n        if (!isNullOrUndefined(this.okButton)) {\n            this.okButton.disabled = (this.styleNameElement.value === '');\n        }\n    };\n    StyleDialog.prototype.getTypeValue = function () {\n        var type;\n        if (this.styleType.value === 'Linked(Paragraph and Character)' || this.styleType.value === 'Paragraph') {\n            return 'Paragraph';\n        }\n        else {\n            return 'Character';\n        }\n    };\n    StyleDialog.prototype.updateStyleNames = function (type, name) {\n        var styles = this.owner.owner.viewer.styles.getStyleNames(type);\n        this.styleParagraph.dataSource = styles;\n        this.styleParagraph.index = null;\n        if (name) {\n            this.styleBasedOn.dataSource = styles.filter(function (e) { return e !== name; });\n            this.styleBasedOn.index = null;\n            var style = this.getStyle(name);\n            if (style.basedOn instanceof String || isNullOrUndefined(style.basedOn)) {\n                this.styleBasedOn.enabled = false;\n            }\n            else {\n                /*Â tslint:disable-next-line:max-line-length */\n                this.styleBasedOn.index = styles.indexOf(style.basedOn.name) > -1 ? styles.indexOf(style.basedOn.name) : 0;\n            }\n            if (style.type === 'Paragraph') {\n                if (!isNullOrUndefined(style.link)) {\n                    this.styleType.index = 2;\n                }\n                else {\n                    this.styleType.index = 0;\n                }\n            }\n            else {\n                this.styleType.index = 1;\n            }\n            if (!isNullOrUndefined(style.next)) {\n                var nxtName = style.next.name;\n                var index = 0;\n                if (styles.indexOf(nxtName) > -1) {\n                    index = styles.indexOf(nxtName);\n                }\n                this.styleParagraph.index = index;\n                this.isUserNextParaUpdated = (nxtName === name) ? false : true;\n            }\n        }\n        else {\n            this.styleBasedOn.dataSource = styles;\n            this.styleBasedOn.index = null;\n            var basedOnIndex = 0;\n            if (this.owner.owner.selectionModule) {\n                var styleName = void 0;\n                if (type === 'Character') {\n                    styleName = this.owner.owner.selection.characterFormat.styleName;\n                }\n                else {\n                    styleName = this.owner.owner.selection.paragraphFormat.styleName;\n                }\n                basedOnIndex = styles.indexOf(styleName);\n            }\n            this.styleBasedOn.index = basedOnIndex;\n            this.styleParagraph.index = 0;\n        }\n        if (this.isEdit) {\n            this.styleType.enabled = false;\n        }\n        else {\n            this.styleType.enabled = true;\n        }\n        this.styleBasedOn.dataBind();\n        this.styleParagraph.dataBind();\n    };\n    StyleDialog.prototype.getStyle = function (styleName) {\n        /* tslint:disable-next-line:max-line-length */\n        if (isNullOrUndefined(this.owner.owner.viewer.styles.findByName(styleName))) {\n            /* tslint:disable-next-line:max-line-length */\n            this.owner.owner.editor.createStyle(this.owner.owner.viewer.preDefinedStyles.get(styleName));\n        }\n        return this.owner.owner.viewer.styles.findByName(styleName);\n    };\n    /**\n     * @private\n     */\n    StyleDialog.prototype.destroy = function () {\n        this.owner = undefined;\n        if (!isNullOrUndefined(this.target)) {\n            if (this.target.parentElement) {\n                this.target.parentElement.removeChild(this.target);\n            }\n            for (var n = 0; n < this.target.childNodes.length; n++) {\n                this.target.removeChild(this.target.childNodes[n]);\n                n--;\n            }\n            this.target = undefined;\n        }\n        if (this.styleType) {\n            this.styleType.destroy();\n        }\n        this.styleType = undefined;\n        if (this.styleBasedOn) {\n            this.styleBasedOn.destroy();\n        }\n        this.styleBasedOn = undefined;\n        if (this.styleParagraph) {\n            this.styleParagraph.destroy();\n        }\n        this.styleParagraph = undefined;\n        if (this.onlyThisDocument) {\n            this.onlyThisDocument.destroy();\n        }\n        this.onlyThisDocument = undefined;\n        if (this.template) {\n            this.template.destroy();\n        }\n        this.template = undefined;\n        if (this.style) {\n            this.style = undefined;\n        }\n        if (this.abstractList) {\n            this.abstractList = undefined;\n        }\n        if (this.numberingBulletDialog) {\n            this.numberingBulletDialog.destroy();\n        }\n        this.numberingBulletDialog = undefined;\n    };\n    return StyleDialog;\n}());\nexport { StyleDialog };\n","import { createElement, isNullOrUndefined, L10n, setCulture } from '@syncfusion/ej2-base';\nimport { Tab } from '@syncfusion/ej2-navigations';\nimport { WList } from '../list/list';\nimport { WAbstractList } from '../list/abstract-list';\nimport { WListLevel } from '../list/list-level';\nimport { WListFormat } from '../../implementation/format/list-format';\n/**\n * The Bullets and Numbering dialog is used to apply list format for a paragraph style.\n */\n/* tslint:disable:no-any */\nvar BulletsAndNumberingDialog = /** @class */ (function () {\n    /**\n     * @private\n     */\n    function BulletsAndNumberingDialog(layoutViewer) {\n        var _this = this;\n        this.isBullet = false;\n        /**\n         * @private\n         */\n        this.numberListClick = function (args) {\n            _this.isBullet = false;\n            _this.setActiveElement(args);\n            if (args.currentTarget.classList.contains('e-de-list-numbered-none')) {\n                _this.numberFormat = undefined;\n                _this.listLevelPattern = undefined;\n            }\n            else if (args.currentTarget.classList.contains('e-de-list-numbered-number-dot')) {\n                _this.numberFormat = '%1.';\n                _this.listLevelPattern = 'Arabic';\n            }\n            else if (args.currentTarget.classList.contains('e-de-list-numbered-number-brace')) {\n                _this.numberFormat = '%1)';\n                _this.listLevelPattern = 'Arabic';\n            }\n            else if (args.currentTarget.classList.contains('e-de-list-numbered-up-roman')) {\n                _this.numberFormat = '%1.';\n                _this.listLevelPattern = 'UpRoman';\n            }\n            else if (args.currentTarget.classList.contains('e-de-list-numbered-up-letter')) {\n                _this.numberFormat = '%1.';\n                _this.listLevelPattern = 'UpLetter';\n            }\n            else if (args.currentTarget.classList.contains('e-de-list-numbered-low-letter-brace')) {\n                _this.numberFormat = '%1)';\n                _this.listLevelPattern = 'LowLetter';\n            }\n            else if (args.currentTarget.classList.contains('e-de-numbered-low-letter-dot')) {\n                _this.numberFormat = '%1.';\n                _this.listLevelPattern = 'LowLetter';\n            }\n            else if (args.currentTarget.classList.contains('e-de-list-numbered-low-roman')) {\n                _this.numberFormat = '%1.';\n                _this.listLevelPattern = 'LowRoman';\n            }\n        };\n        /**\n         * @private\n         */\n        this.bulletListClick = function (args) {\n            _this.isBullet = true;\n            _this.setActiveElement(args);\n            if (args.currentTarget.classList.contains('e-bullet-none')) {\n                _this.symbol = undefined;\n                _this.fontFamily = undefined;\n            }\n            else if (args.currentTarget.classList.contains('e-bullet-dot')) {\n                _this.symbol = '\\uf0b7';\n                _this.fontFamily = 'Symbol';\n            }\n            else if (args.currentTarget.classList.contains('e-bullet-circle')) {\n                _this.symbol = '\\uf06f' + '\\u0020';\n                _this.fontFamily = 'Symbol';\n            }\n            else if (args.currentTarget.classList.contains('e-bullet-square')) {\n                _this.symbol = '\\uf0a7';\n                _this.fontFamily = 'Wingdings';\n            }\n            else if (args.currentTarget.classList.contains('e-bullet-flower')) {\n                _this.symbol = '\\uf076';\n                _this.fontFamily = 'Wingdings';\n            }\n            else if (args.currentTarget.classList.contains('e-bullet-arrow')) {\n                _this.symbol = '\\uf0d8';\n                _this.fontFamily = 'Wingdings';\n            }\n            else if (args.currentTarget.classList.contains('e-bullet-tick')) {\n                _this.symbol = '\\uf0fc';\n                _this.fontFamily = 'Wingdings';\n            }\n        };\n        /**\n         * @private\n         */\n        this.loadNumberingBulletDialog = function () {\n            //Load \n            _this.owner.updateFocus();\n        };\n        /**\n         * @private\n         */\n        this.closeNumberingBulletDialog = function () {\n            _this.unWireEventsAndBindings();\n            _this.owner.updateFocus();\n        };\n        /**\n         * @private\n         */\n        this.onCancelButtonClick = function () {\n            _this.isBullet = false;\n            _this.listLevelPattern = undefined;\n            _this.numberFormat = undefined;\n            _this.symbol = undefined;\n            _this.fontFamily = undefined;\n            _this.owner.dialog.hide();\n            _this.unWireEventsAndBindings();\n        };\n        /**\n         * @private\n         */\n        this.onOkButtonClick = function () {\n            if (_this.owner.owner.viewer.lists.length > 0) {\n                _this.listFormat.list.listId = _this.owner.owner.viewer.lists[_this.owner.owner.viewer.lists.length - 1].listId + 1;\n                _this.listFormat.listId = _this.listFormat.list.listId;\n            }\n            else {\n                _this.listFormat.list.listId = 0;\n                _this.listFormat.listId = 0;\n            }\n            if (_this.owner.owner.viewer.abstractLists.length > 0) {\n                /*Â tslint:disable-next-line:max-line-length */\n                _this.abstractList.abstractListId = _this.owner.owner.viewer.abstractLists[_this.owner.owner.viewer.abstractLists.length - 1].abstractListId + 1;\n            }\n            else {\n                _this.abstractList.abstractListId = 0;\n            }\n            _this.listFormat.list.abstractListId = _this.abstractList.abstractListId;\n            var listLevel = new WListLevel(_this.abstractList);\n            listLevel.listLevelPattern = !isNullOrUndefined(_this.listLevelPattern) ? _this.listLevelPattern : 'Bullet';\n            listLevel.numberFormat = _this.isBullet ? _this.symbol : _this.numberFormat;\n            if (listLevel.listLevelPattern !== 'Bullet') {\n                listLevel.startAt = 1;\n            }\n            listLevel.characterFormat.fontFamily = !isNullOrUndefined(_this.fontFamily) ? _this.fontFamily : 'Verdana';\n            listLevel.paragraphFormat.leftIndent = 36;\n            listLevel.paragraphFormat.firstLineIndent = -18;\n            _this.abstractList.levels.push(listLevel);\n            _this.listFormat.listLevelNumber = 0;\n            _this.listFormat.list.abstractList = _this.abstractList;\n            _this.owner.dialog.hide();\n        };\n        this.owner = layoutViewer;\n    }\n    /**\n     * @private\n     */\n    BulletsAndNumberingDialog.prototype.getModuleName = function () {\n        return 'BulletsAndNumberingDialog';\n    };\n    /**\n     * @private\n     */\n    BulletsAndNumberingDialog.prototype.initNumberingBulletDialog = function (locale) {\n        var instance = this;\n        var id = this.owner.owner.containerId;\n        this.target = createElement('div', { id: id + '_insertNumberBulletDialog', className: 'e-de-number-bullet-dlg' });\n        var tabTarget = createElement('div', { id: id + '_tabNumberBulletDialog', className: 'e-de-tab-number-bullet-dlg' });\n        this.target.appendChild(tabTarget);\n        this.createNumberList(id);\n        this.createBulletList(id);\n        //Initialize Tab component\n        var tabObj = new Tab({\n            items: [\n                {\n                    header: { 'text': locale.getConstant('Numbering') },\n                    /*Â tslint:disable-next-line:max-line-length */\n                    content: ('#' + id + '_Number'),\n                },\n                {\n                    header: { 'text': locale.getConstant('Bullets') },\n                    /*Â tslint:disable-next-line:max-line-length */\n                    content: ('#' + id + '_Bullet'),\n                },\n            ],\n            heightAdjustMode: 'None',\n            width: 272,\n        });\n        //Render initialized Tab component\n        tabObj.appendTo(tabTarget);\n        this.owner.owner.element.appendChild(this.target);\n        tabObj.refresh();\n    };\n    BulletsAndNumberingDialog.prototype.createNumberList = function (id) {\n        var numberListDiv = createElement('div', { className: 'e-de-style-numbered-list', id: id + '_Number' });\n        numberListDiv.style.display = 'none';\n        numberListDiv.style.height = '270px';\n        var ulTag = createElement('ul', {\n            styles: 'display: block; outline: 0px;',\n            id: 'listMenu',\n            className: 'e-de-ui-wfloating-menu e-de-ui-bullets-menu e-de-list-container e-de-list-thumbnail'\n        });\n        numberListDiv.appendChild(ulTag);\n        var numberedNone = this.createNumberNoneListTag(ulTag);\n        var numberedNumberDot = this.createNumberListTag(ulTag, '1.', '2.', '3.', 'e-de-list-numbered-number-dot');\n        var numberedNumberBrace = this.createNumberListTag(ulTag, '1)', '2)', '3)', 'e-de-list-numbered-number-brace');\n        var numberedUpRoman = this.createNumberListTag(ulTag, 'I.', 'II.', 'III.', 'e-de-list-numbered-up-roman');\n        var numberedUpLettter = this.createNumberListTag(ulTag, 'A.', 'B.', 'C.', 'e-de-list-numbered-up-letter');\n        var numberedLowLetterDot = this.createNumberListTag(ulTag, 'a.', 'b.', 'c.', 'e-de-numbered-low-letter-dot');\n        var numberedLowLetterBrace = this.createNumberListTag(ulTag, 'a)', 'b)', 'c)', 'e-de-list-numbered-low-letter-brace');\n        var numberedLowRoman = this.createNumberListTag(ulTag, 'i.', 'ii.', 'iii.', 'e-de-list-numbered-low-roman');\n        numberedNone.addEventListener('click', this.numberListClick);\n        numberedNumberDot.addEventListener('click', this.numberListClick);\n        numberedNumberBrace.addEventListener('click', this.numberListClick);\n        numberedUpRoman.addEventListener('click', this.numberListClick);\n        numberedUpLettter.addEventListener('click', this.numberListClick);\n        numberedLowLetterBrace.addEventListener('click', this.numberListClick);\n        numberedLowLetterDot.addEventListener('click', this.numberListClick);\n        numberedLowRoman.addEventListener('click', this.numberListClick);\n        this.target.appendChild(numberListDiv);\n    };\n    BulletsAndNumberingDialog.prototype.createNumberListTag = function (ulTag, text1, text2, text3, className) {\n        var liTag = createElement('li', {\n            styles: 'display:block',\n            className: 'e-de-ui-wfloating-menuitem e-de-ui-wfloating-menuitem-md e-de-list-items  e-de-list-item-size ' + className\n        });\n        ulTag.appendChild(liTag);\n        /*Â tslint:disable-next-line:max-line-length */\n        var innerHTML = '<div>' + text1 + '<span class=\"e-de-ui-list-line\"></span></div><div>' + text2 + '<span class=\"e-de-ui-list-line\">';\n        innerHTML += '</span></div><div>' + text3 + '<span class=\"e-de-ui-list-line\"> </span></div >';\n        var liInnerDiv = createElement('div', {\n            className: 'e-de-ui-list-header-presetmenu',\n            id: 'e-de-ui-zlist0', innerHTML: innerHTML\n        });\n        liTag.style.cssFloat = 'left';\n        liTag.appendChild(liInnerDiv);\n        return liTag;\n    };\n    BulletsAndNumberingDialog.prototype.createNumberNoneListTag = function (ulTag) {\n        var liTag = createElement('li', {\n            styles: 'display:block',\n            /*Â tslint:disable-next-line:max-line-length */\n            className: 'e-de-ui-wfloating-menuitem e-de-ui-wfloating-menuitem-md e-de-list-items  e-de-list-item-size e-de-list-numbered-none'\n        });\n        ulTag.appendChild(liTag);\n        var innerHTML = '<div class=\"e-de-ui-bullets e-de-bullet-icons\">None</div>';\n        var liInnerDiv = createElement('div', {\n            className: 'e-de-ui-list-header-presetmenu',\n            id: 'e-de-ui-zlist0', innerHTML: innerHTML\n        });\n        liTag.style.cssFloat = 'left';\n        liTag.appendChild(liInnerDiv);\n        return liTag;\n    };\n    BulletsAndNumberingDialog.prototype.createBulletListTag = function (ulTag, iconCss, className) {\n        var liTag = createElement('li', {\n            styles: 'display:block;',\n            className: 'e-de-ui-wfloating-menuitem e-de-ui-wfloating-bullet-menuitem-md e-de-list-items  e-de-list-item-size ' + className\n        });\n        ulTag.appendChild(liTag);\n        /*Â tslint:disable-next-line:max-line-length */\n        var liInnerDiv = createElement('div', { className: 'e-de-ui-bullet-list-header-presetmenu e-de-bullet-icon-size', id: 'e-de-ui-zlist0' });\n        var liNextDiv = createElement('div', { className: iconCss });\n        liInnerDiv.appendChild(liNextDiv);\n        liTag.appendChild(liInnerDiv);\n        return liTag;\n    };\n    BulletsAndNumberingDialog.prototype.createBulletList = function (id) {\n        var bulletListDiv = createElement('div', { className: 'e-de-ui-bullet-list-header-presetmenu', id: id + '_Bullet' });\n        bulletListDiv.style.display = 'none';\n        bulletListDiv.style.height = '270px';\n        var ulTag = createElement('ul', {\n            styles: 'display: block; outline: 0px;', id: 'listMenu',\n            className: 'e-de-ui-wfloating-menu e-de-ui-bullets-menu e-de-list-container e-de-list-thumbnail'\n        });\n        bulletListDiv.appendChild(ulTag);\n        var bulletNone = this.createBulletListTag(ulTag, 'e-de-icon-bullet-list-none e-de-bullet-icons', 'e-bullet-none');\n        var bulletDot = this.createBulletListTag(ulTag, 'e-de-icon-bullet-list-dot e-de-bullet-icons', 'e-bullet-dot');\n        /*Â tslint:disable-next-line:max-line-length */\n        var bulletCircle = this.createBulletListTag(ulTag, 'e-de-icon-bullet-list-circle e-de-bullet-icons', 'e-bullet-circle');\n        var bulletSquare = this.createBulletListTag(ulTag, 'e-de-icon-bullet-list-square e-de-bullet-icons', 'e-bullet-square');\n        /*Â tslint:disable-next-line:max-line-length */\n        var bulletFlower = this.createBulletListTag(ulTag, 'e-de-icon-bullet-list-flower e-de-bullet-icons', 'e-bullet-flower');\n        var bulletArrow = this.createBulletListTag(ulTag, 'e-de-icon-bullet-list-arrow e-de-bullet-icons', 'e-bullet-arrow');\n        var bulletTick = this.createBulletListTag(ulTag, 'e-de-icon-bullet-list-tick e-de-bullet-icons', 'e-bullet-tick');\n        bulletNone.addEventListener('click', this.bulletListClick);\n        bulletDot.addEventListener('click', this.bulletListClick);\n        bulletCircle.addEventListener('click', this.bulletListClick);\n        bulletSquare.addEventListener('click', this.bulletListClick);\n        bulletFlower.addEventListener('click', this.bulletListClick);\n        bulletArrow.addEventListener('click', this.bulletListClick);\n        bulletTick.addEventListener('click', this.bulletListClick);\n        // bulletListDiv.appendChild(table1);        \n        this.target.appendChild(bulletListDiv);\n    };\n    /**\n     * @private\n     */\n    BulletsAndNumberingDialog.prototype.showNumberBulletDialog = function (listFormat, abstractList) {\n        if (!isNullOrUndefined(listFormat)) {\n            this.listFormat = listFormat;\n        }\n        else {\n            this.listFormat = new WListFormat();\n        }\n        if (isNullOrUndefined(this.listFormat.list)) {\n            this.listFormat.list = new WList();\n        }\n        if (!isNullOrUndefined(abstractList)) {\n            this.abstractList = abstractList;\n        }\n        else {\n            this.abstractList = new WAbstractList();\n        }\n        var locale = new L10n('documenteditor', this.owner.owner.defaultLocale);\n        locale.setLocale(this.owner.owner.locale);\n        setCulture(this.owner.owner.locale);\n        if (!this.target) {\n            this.initNumberingBulletDialog(locale);\n        }\n        this.owner.dialog.header = locale.getConstant('Numbering and Bullets');\n        this.owner.dialog.width = 'auto';\n        this.owner.dialog.height = 'auto';\n        this.owner.dialog.content = this.target;\n        this.owner.dialog.beforeOpen = this.loadNumberingBulletDialog;\n        this.owner.dialog.close = this.closeNumberingBulletDialog;\n        this.owner.dialog.position = { X: 'center', Y: 'center' };\n        this.owner.dialog.buttons = [{\n                click: this.onOkButtonClick,\n                buttonModel: { content: locale.getConstant('Ok'), cssClass: 'e-flat e-numbering-bullet-okay', isPrimary: true }\n            },\n            {\n                click: this.onCancelButtonClick,\n                buttonModel: { content: locale.getConstant('Cancel'), cssClass: 'e-flat e-numbering-bullet-cancel' }\n            }];\n        this.owner.dialog.dataBind();\n        this.owner.dialog.show();\n    };\n    BulletsAndNumberingDialog.prototype.setActiveElement = function (args) {\n        var html = args.currentTarget.parentElement;\n        for (var i = 0; i < html.childElementCount; i++) {\n            if (html.childNodes[i].classList.contains('e-de-list-active')) {\n                html.childNodes[i].classList.remove('e-de-list-active');\n            }\n        }\n        args.currentTarget.classList.add('e-de-list-active');\n    };\n    /**\n     * @private\n     */\n    BulletsAndNumberingDialog.prototype.unWireEventsAndBindings = function () {\n        //Unwire events\n    };\n    /**\n     * @private\n     */\n    BulletsAndNumberingDialog.prototype.destroy = function () {\n        this.owner = undefined;\n        if (this.listFormat) {\n            this.listFormat.destroy();\n            this.listFormat = undefined;\n        }\n        if (this.abstractList) {\n            this.abstractList.destroy();\n            this.abstractList = undefined;\n        }\n        if (this.target && this.target.parentElement) {\n            this.target.parentElement.removeChild(this.target);\n            for (var m = 0; m < this.target.childNodes.length; m++) {\n                this.target.removeChild(this.target.childNodes[m]);\n                m--;\n            }\n            this.target = undefined;\n        }\n    };\n    return BulletsAndNumberingDialog;\n}());\nexport { BulletsAndNumberingDialog };\n/* tslint:enable:no-any */ \n","import { createElement, isNullOrUndefined, L10n, setCulture } from '@syncfusion/ej2-base';\nimport { DropDownList, ComboBox } from '@syncfusion/ej2-dropdowns';\nimport { CheckBox } from '@syncfusion/ej2-buttons';\nimport { WCharacterFormat } from '../format/character-format';\nimport { ColorPicker } from '@syncfusion/ej2-inputs';\n/**\n * The Font dialog is used to modify formatting of selected text.\n */\n/* tslint:disable:no-any */\nvar FontDialog = /** @class */ (function () {\n    /**\n     * @private\n     */\n    function FontDialog(layoutViewer) {\n        var _this = this;\n        this.fontStyleInternal = undefined;\n        this.fontNameList = undefined;\n        this.fontStyleText = undefined;\n        this.fontSizeText = undefined;\n        this.colorPicker = undefined;\n        this.underlineDrop = undefined;\n        this.strikethroughBox = undefined;\n        this.doublestrikethrough = undefined;\n        this.superscript = undefined;\n        this.subscript = undefined;\n        //Character Format Property\n        this.bold = undefined;\n        this.italic = undefined;\n        this.underline = undefined;\n        this.strikethrough = undefined;\n        this.baselineAlignment = undefined;\n        this.fontSize = undefined;\n        this.fontFamily = undefined;\n        this.fontColor = undefined;\n        /**\n         * @private\n         */\n        this.characterFormat = undefined;\n        /**\n         * @private\n         */\n        this.loadFontDialog = function () {\n            _this.owner.updateFocus();\n            var characterFormat;\n            if (_this.characterFormat) {\n                characterFormat = _this.characterFormat;\n            }\n            else {\n                characterFormat = _this.owner.owner.selection.characterFormat;\n            }\n            _this.fontNameList.value = characterFormat.fontFamily;\n            if (!characterFormat.bold && !characterFormat.italic) {\n                _this.fontStyleText.value = _this.fontSizeText.value;\n                _this.fontStyleText.index = 0;\n            }\n            else if (characterFormat.bold && !characterFormat.italic) {\n                _this.fontStyleText.value = _this.fontSizeText.value;\n                _this.fontStyleText.index = 1;\n            }\n            else if (!characterFormat.bold && characterFormat.italic) {\n                _this.fontStyleText.value = _this.fontSizeText.value;\n                _this.fontStyleText.index = 2;\n            }\n            else if (characterFormat.bold && characterFormat.italic) {\n                _this.fontStyleText.value = _this.fontSizeText.value;\n                _this.fontStyleText.index = 3;\n            }\n            if (!isNullOrUndefined(characterFormat.fontSize)) {\n                for (var i = 0; i <= 15; i++) {\n                    var items = _this.fontSizeText.getItems();\n                    if (characterFormat.fontSize.toString() === items[i].innerHTML) {\n                        _this.fontSizeText.value = characterFormat.fontSize;\n                        _this.fontSizeText.index = i;\n                        break;\n                    }\n                }\n            }\n            if (!isNullOrUndefined(characterFormat.fontColor)) {\n                _this.colorPicker.value = characterFormat.fontColor;\n            }\n            else {\n                _this.colorPicker.value = '#000000';\n            }\n            if (characterFormat.underline === 'None') {\n                _this.underlineDrop.index = 0;\n            }\n            else if (characterFormat.underline === 'Single') {\n                _this.underlineDrop.index = 1;\n            }\n            if (characterFormat.strikethrough === 'SingleStrike') {\n                _this.strikethroughBox.checked = true;\n            }\n            else if (characterFormat.strikethrough === 'DoubleStrike') {\n                _this.doublestrikethrough.checked = true;\n            }\n            else {\n                _this.strikethroughBox.checked = false;\n                _this.doublestrikethrough.checked = false;\n            }\n            if (characterFormat.baselineAlignment === 'Superscript') {\n                _this.superscript.checked = true;\n            }\n            else if (characterFormat.baselineAlignment === 'Subscript') {\n                _this.subscript.checked = true;\n            }\n            else {\n                _this.superscript.checked = false;\n                _this.subscript.checked = false;\n            }\n            if (_this.owner.selection.caret.style.display !== 'none') {\n                _this.owner.selection.caret.style.display = 'none';\n            }\n        };\n        /**\n         * @private\n         */\n        this.closeFontDialog = function () {\n            _this.unWireEventsAndBindings();\n            _this.owner.updateFocus();\n        };\n        /**\n         * @private\n         */\n        this.onCancelButtonClick = function () {\n            _this.owner.dialog.hide();\n            _this.unWireEventsAndBindings();\n        };\n        /**\n         * @private\n         */\n        this.onInsertFontFormat = function () {\n            var format;\n            if (_this.characterFormat) {\n                format = _this.characterFormat;\n            }\n            else {\n                format = new WCharacterFormat(undefined);\n            }\n            if (!isNullOrUndefined(_this.bold)) {\n                format.bold = _this.bold;\n            }\n            if (!isNullOrUndefined(_this.italic)) {\n                format.italic = _this.italic;\n            }\n            if (!isNullOrUndefined(_this.fontSize) && _this.fontSize > 0) {\n                format.fontSize = _this.fontSize;\n            }\n            if (!isNullOrUndefined(_this.fontColor)) {\n                format.fontColor = _this.fontColor;\n            }\n            if (!isNullOrUndefined(_this.baselineAlignment)) {\n                format.baselineAlignment = _this.baselineAlignment;\n            }\n            if (!isNullOrUndefined(_this.strikethrough)) {\n                format.strikethrough = _this.strikethrough;\n            }\n            if (!isNullOrUndefined(_this.underline)) {\n                format.underline = _this.underline;\n            }\n            if (!isNullOrUndefined(_this.fontFamily)) {\n                format.fontFamily = _this.fontFamily;\n            }\n            if (!_this.characterFormat) {\n                _this.onCharacterFormat(_this.owner.selection, format);\n            }\n            else {\n                _this.owner.owner.styleDialogModule.updateCharacterFormat();\n            }\n            _this.owner.dialog.hide();\n        };\n        this.fontSizeUpdate = function (args) {\n            _this.fontSize = args.value;\n        };\n        this.fontStyleUpdate = function (args) {\n            _this.fontStyle = args.value;\n        };\n        this.fontFamilyUpdate = function (args) {\n            _this.fontFamily = args.value;\n        };\n        this.underlineUpdate = function (args) {\n            _this.underline = args.value;\n        };\n        this.fontColorUpdate = function (args) {\n            if (!isNullOrUndefined(args.currentValue)) {\n                _this.fontColor = args.currentValue.hex;\n            }\n        };\n        this.singleStrikeUpdate = function (args) {\n            _this.enableCheckBoxProperty(args);\n            if (args.checked) {\n                _this.strikethrough = 'SingleStrike';\n            }\n            else {\n                _this.strikethrough = 'None';\n            }\n        };\n        this.doubleStrikeUpdate = function (args) {\n            _this.enableCheckBoxProperty(args);\n            if (args.checked) {\n                _this.strikethrough = 'DoubleStrike';\n            }\n            else {\n                _this.strikethrough = 'None';\n            }\n        };\n        this.superscriptUpdate = function (args) {\n            _this.enableCheckBoxProperty(args);\n            if (args.checked) {\n                _this.baselineAlignment = 'Superscript';\n            }\n            else {\n                _this.baselineAlignment = 'Normal';\n            }\n        };\n        this.subscriptUpdate = function (args) {\n            _this.enableCheckBoxProperty(args);\n            if (args.checked) {\n                _this.baselineAlignment = 'Subscript';\n            }\n            else {\n                _this.baselineAlignment = 'Normal';\n            }\n        };\n        this.owner = layoutViewer;\n    }\n    Object.defineProperty(FontDialog.prototype, \"fontStyle\", {\n        /**\n         * @private\n         */\n        get: function () {\n            return this.fontStyleInternal;\n        },\n        /**\n         * @private\n         */\n        set: function (value) {\n            this.fontStyleInternal = value;\n            switch (this.fontStyle) {\n                case 'Bold':\n                    this.bold = true;\n                    this.italic = false;\n                    break;\n                case 'Italic':\n                    this.bold = false;\n                    this.italic = true;\n                    break;\n                case 'BoldItalic':\n                    this.bold = true;\n                    this.italic = true;\n                    break;\n                case 'Regular':\n                    this.bold = false;\n                    this.italic = false;\n                    break;\n            }\n        },\n        enumerable: true,\n        configurable: true\n    });\n    /**\n     * @private\n     */\n    FontDialog.prototype.getModuleName = function () {\n        return 'FontDialog';\n    };\n    FontDialog.prototype.createInputElement = function (type, id, className) {\n        var element = createElement('input', {\n            attrs: { type: type },\n            id: id,\n            className: className\n        });\n        return element;\n    };\n    /**\n     * @private\n     */\n    FontDialog.prototype.initFontDialog = function (locale) {\n        var instance = this;\n        var effectLabel;\n        var strikeThroughElement;\n        var superScriptElement;\n        var subScriptElement;\n        var doubleStrikeThroughElement;\n        var id = this.owner.owner.containerId;\n        this.target = createElement('div', { id: id + '_insertFontDialog', className: 'e-de-font-dlg' });\n        var fontDiv = this.getFontDiv(locale);\n        this.target.appendChild(fontDiv);\n        var sizeDiv = this.getFontSizeDiv(locale);\n        this.target.appendChild(sizeDiv);\n        var colorDiv = createElement('div', { id: id + '_fontColor', styles: 'margin-top:15px;' });\n        this.fontColorDiv = createElement('div', { id: id + '_fontColorDiv', className: 'e-de-font-dlg-display' });\n        var fontColorLabel = createElement('label', {\n            className: 'e-de-font-dlg-header-font-color e-de-font-color-margin', innerHTML: locale.getConstant('Font color')\n        });\n        this.fontColorDiv.appendChild(fontColorLabel);\n        var fontColorElement = this.createInputElement('color', this.target.id + '_ColorDiv', 'e-de-font-dlg-color');\n        this.fontColorDiv.appendChild(fontColorElement);\n        colorDiv.appendChild(this.fontColorDiv);\n        this.target.appendChild(colorDiv);\n        var fontEffectsDiv = createElement('div', { id: id + '_fontEffectsDiv' });\n        var fontEffectSubDiv1 = createElement('div', {\n            className: 'e-de-font-color-label e-de-font-dlg-display',\n            id: this.target.id + '_fontEffectsSubDiv1'\n        });\n        effectLabel = createElement('label', { className: 'e-de-font-dlg-header-effects', innerHTML: locale.getConstant('Effects') });\n        fontEffectSubDiv1.appendChild(effectLabel);\n        strikeThroughElement = this.createInputElement('checkbox', this.target.id + '_strikeThrough', '');\n        fontEffectSubDiv1.appendChild(strikeThroughElement);\n        superScriptElement = this.createInputElement('checkbox', this.target.id + '_superScript', '');\n        fontEffectSubDiv1.appendChild(superScriptElement);\n        fontEffectsDiv.appendChild(fontEffectSubDiv1);\n        var fontEffectSubDiv2 = createElement('div', { className: 'e-de-font-checkbox', id: id + '_fontEffectsSubDiv2' });\n        subScriptElement = this.createInputElement('checkbox', this.target.id + '_subScript', '');\n        fontEffectSubDiv2.appendChild(subScriptElement);\n        doubleStrikeThroughElement = this.createInputElement('checkbox', this.target.id + '_doubleStrikeThrough', '');\n        fontEffectSubDiv2.appendChild(doubleStrikeThroughElement);\n        fontEffectsDiv.appendChild(fontEffectSubDiv2);\n        this.target.appendChild(fontEffectsDiv);\n        this.owner.owner.element.appendChild(this.target);\n        this.colorPicker = new ColorPicker({\n            change: this.fontColorUpdate, value: '#000000',\n        });\n        this.colorPicker.appendTo(fontColorElement);\n        this.strikethroughBox = new CheckBox({\n            change: this.singleStrikeUpdate,\n            cssClass: 'e-de-font-content-label',\n            label: locale.getConstant('Strikethrough')\n        });\n        this.strikethroughBox.appendTo(strikeThroughElement);\n        this.doublestrikethrough = new CheckBox({\n            change: this.doubleStrikeUpdate,\n            cssClass: 'e-de-font-content-checkbox-label',\n            label: locale.getConstant('Double strikethrough')\n        });\n        this.doublestrikethrough.appendTo(doubleStrikeThroughElement);\n        this.subscript = new CheckBox({\n            label: locale.getConstant('Subscript'),\n            change: this.subscriptUpdate\n        });\n        this.subscript.appendTo(subScriptElement);\n        this.superscript = new CheckBox({\n            label: locale.getConstant('Superscript'),\n            cssClass: 'e-de-font-content-label', change: this.superscriptUpdate\n        });\n        this.superscript.appendTo(superScriptElement);\n    };\n    FontDialog.prototype.getFontSizeDiv = function (locale) {\n        var fontSize;\n        var sizeDiv;\n        var id = this.owner.owner.containerId;\n        sizeDiv = createElement('div', { id: id + '_fontSizeAndUnderlineDiv', className: 'e-de-font-dlg-padding e-de-font-dlg-display' });\n        var sizeSubDiv1 = createElement('div', { id: id + '_fontSizeAndUnderlineSubDiv1' });\n        var sizeLabel = createElement('label', { className: 'e-de-font-dlg-header', innerHTML: locale.getConstant('Size') });\n        var styles = 'font-family:Roboto;font-size:14px;opacity:0.8;';\n        fontSize = createElement('select', { id: this.target.id + '_fontSize', styles: styles });\n        fontSize.innerHTML = '<option>8</option><option>9</option><option>10</option><option>11</option><option>12</option>' +\n            '<option>14</option><option>16</option><option>18</option><option>20</option><option>24</option><option>26</option>' +\n            '<option>28</option><option>36</option><option>48</option><option>72</option><option>96</option>';\n        sizeSubDiv1.appendChild(sizeLabel);\n        sizeSubDiv1.appendChild(fontSize);\n        sizeDiv.appendChild(sizeSubDiv1);\n        var sizeSubDiv2 = createElement('div', {\n            className: 'e-de-font-dlg-cb-right',\n            id: id + '_fontSizeAndUnderlineSubDiv2'\n        });\n        var html = locale.getConstant('Underline style');\n        var underlineLabel = createElement('label', { className: 'e-de-font-dlg-header', innerHTML: html });\n        var underlineElement;\n        underlineElement = createElement('select', { id: this.target.id + '_underLine', styles: styles });\n        underlineElement.innerHTML = '<option>' + locale.getConstant('None') + '</option><option>________</option>';\n        sizeSubDiv2.appendChild(underlineLabel);\n        sizeSubDiv2.appendChild(underlineElement);\n        sizeDiv.appendChild(sizeSubDiv2);\n        this.fontSizeText = new ComboBox({ change: this.fontSizeUpdate, popupHeight: '170px', width: '170px' });\n        this.fontSizeText.showClearButton = false;\n        this.fontSizeText.appendTo(fontSize);\n        this.underlineDrop = new DropDownList({ change: this.underlineUpdate, popupHeight: '100px', width: '170px' });\n        this.underlineDrop.appendTo(underlineElement);\n        return sizeDiv;\n    };\n    FontDialog.prototype.getFontDiv = function (locale) {\n        var id = this.owner.owner.containerId;\n        var fontDiv = createElement('div', { id: id + '_fontDiv', className: 'e-de-font-dlg-display' });\n        var fontSubDiv1 = createElement('div', { id: id + '_fontSubDiv1' });\n        var fontNameLabel = createElement('label', {\n            className: 'e-de-font-dlg-header',\n            innerHTML: locale.getConstant('Font')\n        });\n        var fontNameValues = createElement('select', { id: this.target.id + '_fontName' });\n        fontNameValues.innerHTML = '<option>Arial</option><option>Calibri</option><option>Candara</option><option>Comic Sans MS</option>' +\n            '<option>Consolas</option><option>Constantia</option><option>Corbel</option>' +\n            '<option>Courier New</option><option>Ebrima</option><option>Franklin Gothic</option>' +\n            '<option>Gabriola</option><option>Gadugi</option><option>Georgia</option><option>Impact</option>' +\n            '<option>Javanese Text</option><option>Microsoft Sans Serif</option><option>MS Gothic</option><option>MS UI Gothic</option>' +\n            '<option>Segoe Print</option><option>Times New Roman</option><option>Verdana</option><option>Segoe UI</option>' +\n            '<option>Algerian</option><option>Cambria</option><option>Georgia</option><option>Consolas</option>';\n        fontSubDiv1.appendChild(fontNameLabel);\n        fontSubDiv1.appendChild(fontNameValues);\n        fontDiv.appendChild(fontSubDiv1);\n        var fontSubDiv2;\n        var fontStyleLabel;\n        var fontStyleValues;\n        fontSubDiv2 = createElement('div', { className: 'e-de-font-dlg-cb-right', id: id + '_fontSubDiv2', styles: 'float:right;' });\n        fontStyleLabel = createElement('label', { className: 'e-de-font-dlg-header', innerHTML: locale.getConstant('Font style') });\n        var fontStyle = 'font-family:Roboto;font-size:14px;opacity:0.8;';\n        fontStyleValues = createElement('select', { id: this.target.id + '_fontStyle', styles: fontStyle });\n        fontStyleValues.innerHTML = '<option>' +\n            locale.getConstant('Regular') + '</option><option>' + locale.getConstant('Bold') + '</option><option>' +\n            locale.getConstant('Italic') + '</option><option>' + locale.getConstant('Bold') + locale.getConstant('Italic') + '</option>';\n        fontSubDiv2.appendChild(fontStyleLabel);\n        fontSubDiv2.appendChild(fontStyleValues);\n        fontDiv.appendChild(fontSubDiv2);\n        this.fontNameList = new ComboBox({ change: this.fontFamilyUpdate, popupHeight: '200px', width: '170px' });\n        this.fontNameList.showClearButton = false;\n        this.fontNameList.appendTo(fontNameValues);\n        this.fontStyleText = new DropDownList({ change: this.fontStyleUpdate, popupHeight: '170px', width: '170px' });\n        this.fontStyleText.appendTo(fontStyleValues);\n        return fontDiv;\n    };\n    /**\n     * @private\n     */\n    FontDialog.prototype.showFontDialog = function (characterFormat) {\n        if (characterFormat) {\n            this.characterFormat = characterFormat;\n        }\n        var locale = new L10n('documenteditor', this.owner.owner.defaultLocale);\n        locale.setLocale(this.owner.owner.locale);\n        setCulture(this.owner.owner.locale);\n        if (!this.target) {\n            this.initFontDialog(locale);\n        }\n        this.owner.dialog.header = locale.getConstant('Font');\n        this.owner.dialog.width = 'auto';\n        this.owner.dialog.height = 'auto';\n        this.owner.dialog.content = this.target;\n        this.owner.dialog.beforeOpen = this.loadFontDialog;\n        this.owner.dialog.close = this.closeFontDialog;\n        this.owner.dialog.buttons = [{\n                click: this.onInsertFontFormat,\n                buttonModel: { content: locale.getConstant('Ok'), cssClass: 'e-flat e-font-okay', isPrimary: true }\n            },\n            {\n                click: this.onCancelButtonClick,\n                buttonModel: { content: locale.getConstant('Cancel'), cssClass: 'e-flat e-font-cancel' }\n            }];\n        this.owner.dialog.dataBind();\n        this.owner.dialog.show();\n    };\n    /**\n     * Applies character format\n     * @param  {Selection} selection\n     * @param  {WCharacterFormat} format\n     * @private\n     */\n    FontDialog.prototype.onCharacterFormat = function (selection, format) {\n        this.owner.owner.editorModule.initHistory('CharacterFormat');\n        if (selection.isEmpty) {\n            if (selection.start.offset === selection.getParagraphLength(selection.start.paragraph)) {\n                // tslint:disable-next-line:max-line-length\n                this.owner.owner.editorModule.applyCharFormatValueInternal(selection, selection.start.paragraph.characterFormat, undefined, format);\n                this.owner.owner.editorModule.reLayout(selection);\n            }\n            this.owner.updateFocus();\n            return;\n        }\n        else {\n            //Iterate and update formating.\n            this.owner.owner.editorModule.setOffsetValue(this.owner.selection);\n            this.owner.owner.editorModule.updateSelectionCharacterFormatting('CharacterFormat', format, false);\n        }\n    };\n    /**\n     * @private\n     */\n    FontDialog.prototype.enableCheckBoxProperty = function (args) {\n        if (this.strikethroughBox.checked && this.doublestrikethrough.checked) {\n            this.strikethroughBox.checked = false;\n            this.doublestrikethrough.checked = false;\n            if (args.event.currentTarget.id === this.target.id + '_doubleStrikeThrough') {\n                this.doublestrikethrough.checked = true;\n            }\n            else {\n                this.strikethroughBox.checked = true;\n            }\n        }\n        if (this.superscript.checked && this.subscript.checked) {\n            this.subscript.checked = false;\n            this.superscript.checked = false;\n            if (args.event.currentTarget.id === this.target.id + '_subScript') {\n                this.subscript.checked = true;\n            }\n            else {\n                this.superscript.checked = true;\n            }\n        }\n    };\n    /**\n     * @private\n     */\n    FontDialog.prototype.unWireEventsAndBindings = function () {\n        this.fontNameList.value = '';\n        this.fontSizeText.value = '';\n        this.fontStyleText.value = '';\n        this.strikethroughBox.checked = false;\n        this.doublestrikethrough.checked = false;\n        this.superscript.checked = false;\n        this.subscript.checked = false;\n        this.bold = undefined;\n        this.italic = undefined;\n        this.underline = undefined;\n        this.strikethrough = undefined;\n        this.baselineAlignment = undefined;\n        this.fontColor = undefined;\n        this.fontSize = undefined;\n        this.fontFamily = undefined;\n    };\n    /**\n     * @private\n     */\n    FontDialog.prototype.destroy = function () {\n        this.owner = undefined;\n        if (this.characterFormat) {\n            this.characterFormat.destroy();\n            this.characterFormat = undefined;\n        }\n        if (!isNullOrUndefined(this.target)) {\n            if (this.target.parentElement) {\n                this.target.parentElement.removeChild(this.target);\n            }\n            for (var m = 0; m < this.target.childNodes.length; m++) {\n                this.target.removeChild(this.target.childNodes[m]);\n                m--;\n            }\n            this.target = undefined;\n        }\n        if (this.fontNameList) {\n            this.fontNameList.destroy();\n        }\n        this.fontNameList = undefined;\n        if (this.fontStyleText) {\n            this.fontStyleText.destroy();\n        }\n        this.fontStyleText = undefined;\n        if (this.fontSizeText) {\n            this.fontSizeText.destroy();\n        }\n        this.fontSizeText = undefined;\n        if (this.colorPicker) {\n            this.colorPicker.destroy();\n        }\n        this.colorPicker = undefined;\n        if (this.underlineDrop) {\n            this.underlineDrop.destroy();\n        }\n        this.underlineDrop = undefined;\n        if (this.strikethroughBox) {\n            this.strikethroughBox.destroy();\n        }\n        this.strikethroughBox = undefined;\n        if (this.doublestrikethrough) {\n            this.doublestrikethrough.destroy();\n        }\n        this.doublestrikethrough = undefined;\n        if (this.superscript) {\n            this.superscript.destroy();\n        }\n        this.superscript = undefined;\n        if (this.subscript) {\n            this.subscript.destroy();\n        }\n        this.subscript = undefined;\n    };\n    return FontDialog;\n}());\nexport { FontDialog };\n/* tslint:enable:no-any */ \n","import { createElement, isNullOrUndefined, L10n, setCulture } from '@syncfusion/ej2-base';\nimport { NumericTextBox } from '@syncfusion/ej2-inputs';\nimport { WTableFormat, WRowFormat, WCellFormat } from '../format/index';\nimport { CheckBox } from '@syncfusion/ej2-buttons';\nimport { DropDownList } from '@syncfusion/ej2-dropdowns';\nimport { Tab } from '@syncfusion/ej2-navigations';\nimport { classList } from '@syncfusion/ej2-base';\nimport { HelperMethods } from '../editor/editor-helper';\n/**\n * The Table properties dialog is used to modify properties of selected table.\n */\nvar TablePropertiesDialog = /** @class */ (function () {\n    /**\n     * @private\n     */\n    function TablePropertiesDialog(viewer) {\n        var _this = this;\n        this.hasTableWidth = false;\n        this.hasCellWidth = false;\n        /**\n         * @private\n         */\n        this.isTableBordersAndShadingUpdated = false;\n        /**\n         * @private\n         */\n        this.isCellBordersAndShadingUpdated = false;\n        this.tabObj = undefined;\n        /**\n         * @private\n         */\n        this.isCellOptionsUpdated = false;\n        /**\n         * @private\n         */\n        this.isTableOptionsUpdated = false;\n        this.onBeforeOpen = function () {\n            _this.owner.updateFocus();\n            _this.loadTableProperties();\n        };\n        /**\n         * @private\n         */\n        this.onCloseTablePropertyDialog = function () {\n            _this.unWireEvent.bind(_this);\n            _this.owner.updateFocus();\n        };\n        /**\n         * @private\n         */\n        this.applyTableProperties = function () {\n            var selection = _this.owner.selection;\n            if (!_this.preferCheckBox.checked && !_this.preferCheckBox.indeterminate) {\n                if (isNullOrUndefined(selection.tableFormat.preferredWidth) || selection.tableFormat.preferredWidth !== 0) {\n                    _this.tableFormat.preferredWidth = 0;\n                    _this.tableFormat.preferredWidthType = 'Point';\n                }\n            }\n            if (_this.tableFormat.hasValue('tableAlignment') && _this.tableFormat.tableAlignment !== 'Left') {\n                if (isNullOrUndefined(selection.tableFormat.leftIndent) || selection.tableFormat.leftIndent !== 0) {\n                    _this.tableFormat.leftIndent = 0;\n                }\n            }\n            if (!_this.rowHeightCheckBox.checked && !_this.rowHeightCheckBox.indeterminate) {\n                if (isNullOrUndefined(selection.rowFormat.height) || selection.rowFormat.height !== 0) {\n                    _this.rowFormat.heightType = 'AtLeast';\n                    _this.rowFormat.height = 0;\n                }\n            }\n            if (!_this.preferredCellWidthCheckBox.checked && !_this.preferredCellWidthCheckBox.indeterminate) {\n                if (isNullOrUndefined(selection.cellFormat.preferredWidth) || selection.cellFormat.preferredWidth === 0) {\n                    _this.cellFormat.preferredWidthType = 'Point';\n                    _this.cellFormat.preferredWidth = 0;\n                }\n            }\n            else {\n                if (_this.cellFormat.preferredWidthType === 'Percent') {\n                    if (!_this.tableFormat.hasValue('preferredWidth') && !_this.tableFormat.hasValue('preferredWidthType')\n                        && _this.owner.selection.start.paragraph.associatedCell.ownerTable.tableFormat.preferredWidth === 0) {\n                        // tslint:disable-next-line:max-line-length\n                        var containerWidth = _this.owner.selection.start.paragraph.associatedCell.ownerTable.getOwnerWidth(true);\n                        var tableWidth = _this.owner.selection.start.paragraph.associatedCell.ownerTable.getTableClientWidth(containerWidth);\n                        _this.tableFormat.preferredWidthType = 'Percent';\n                        _this.tableFormat.preferredWidth = tableWidth / HelperMethods.convertPixelToPoint(_this.owner.clientArea.width) * 100;\n                    }\n                }\n            }\n            if (_this.rowHeightValue) {\n                _this.rowFormat.height = _this.rowHeightValue;\n            }\n            _this.owner.owner.editorModule.initComplexHistory('TableProperties');\n            _this.owner.owner.editorModule.onTableFormat(_this.tableFormat);\n            _this.owner.owner.editorModule.onRowFormat(_this.rowFormat);\n            _this.owner.owner.editorModule.onCellFormat(_this.cellFormat);\n            _this.owner.owner.editorHistory.updateComplexHistory();\n            _this.closeTablePropertiesDialog();\n            _this.owner.updateFocus();\n        };\n        /**\n         * @private\n         */\n        this.applyTableSubProperties = function () {\n            if (_this.isCellOptionsUpdated) {\n                var cellFormat = _this.owner.owner.cellOptionsDialogModule.cellFormat;\n                _this.owner.owner.cellOptionsDialogModule.applySubCellOptions(cellFormat);\n            }\n            if (_this.isTableOptionsUpdated) {\n                var tableFormat = _this.owner.owner.tableOptionsDialogModule.tableFormat;\n                _this.owner.owner.tableOptionsDialogModule.applySubTableOptions(tableFormat);\n            }\n            _this.isCellOptionsUpdated = false;\n            _this.isTableOptionsUpdated = false;\n        };\n        /**\n         * @private\n         */\n        this.unWireEvent = function () {\n            //Table Format\n            _this.preferCheckBox.change = undefined;\n            _this.tableWidthBox.change = undefined;\n            _this.tableWidthType.change = undefined;\n            _this.leftIndentBox.change = undefined;\n            //Row Format\n            _this.rowHeightCheckBox.change = undefined;\n            _this.rowHeightBox.change = undefined;\n            _this.rowHeightType.change = undefined;\n            _this.repeatHeader.change = undefined;\n            _this.allowRowBreak.change = undefined;\n            //Cell Format\n            _this.preferredCellWidthCheckBox.change = undefined;\n            _this.cellWidthBox.change = undefined;\n            _this.cellWidthType.change = undefined;\n            _this.cellFormat.destroy();\n            _this.rowFormat.destroy();\n            _this.tableFormat.destroy();\n            _this.rowHeightValue = undefined;\n            _this.owner.dialog2.open = _this.owner.selection.hideCaret.bind(_this.owner);\n        };\n        /**\n         * @private\n         */\n        this.closeTablePropertiesDialog = function () {\n            _this.owner.dialog2.hide();\n            _this.owner.updateFocus();\n        };\n        /**\n         * @private\n         */\n        this.changeTableCheckBox = function () {\n            var enable = (_this.preferCheckBox.checked || _this.preferCheckBox.indeterminate);\n            _this.tableWidthBox.enabled = enable;\n            _this.tableWidthType.enabled = enable;\n            if (enable) {\n                _this.tableFormat.preferredWidthType = (_this.tableWidthType.value === 'Points') ?\n                    'Point' : _this.tableWidthType.value;\n            }\n            else {\n                _this.tableFormat.preferredWidthType = _this.owner.selection.tableFormat.preferredWidthType;\n            }\n        };\n        /**\n         * @private\n         */\n        this.changeTableAlignment = function (event) {\n            _this.updateClassForAlignmentProperties(_this.tableTab);\n            var element = event.target;\n            classList(element, ['e-de-table-alignment-active'], ['e-de-table-properties-alignment']);\n            if (element.classList.contains('e-de-table-left-alignment')) {\n                _this.leftIndentBox.enabled = true;\n            }\n            else {\n                _this.leftIndentBox.enabled = false;\n            }\n            _this.tableFormat.tableAlignment = _this.getTableAlignment();\n        };\n        /**\n         * @private\n         */\n        this.changeTableRowCheckBox = function () {\n            _this.rowHeightType.enabled = _this.rowHeightCheckBox.checked;\n            _this.rowHeightBox.enabled = _this.rowHeightCheckBox.checked;\n            if (_this.rowHeightType.enabled) {\n                _this.rowFormat.heightType = _this.rowHeightType.value;\n            }\n            else {\n                _this.rowFormat.heightType = _this.owner.selection.rowFormat.heightType;\n            }\n        };\n        /**\n         * @private\n         */\n        this.changeTableCellCheckBox = function () {\n            _this.cellWidthType.enabled = _this.preferredCellWidthCheckBox.checked;\n            _this.cellWidthBox.enabled = _this.preferredCellWidthCheckBox.checked;\n        };\n        /**\n         * @private\n         */\n        this.changeCellAlignment = function (event) {\n            _this.updateClassForCellAlignment(_this.cellTab);\n            var element = event.target;\n            classList(element, ['e-de-table-alignment-active'], ['e-de-tablecell-alignment']);\n            _this.cellFormat.verticalAlignment = _this.getCellAlignment();\n        };\n        //#endregion\n        /**\n         * @private\n         */\n        this.showTableOptionsDialog = function () {\n            _this.owner.owner.tableOptionsDialogModule.show();\n            _this.owner.dialog2.element.style.pointerEvents = 'none';\n        };\n        /**\n         * @private\n         */\n        this.showBordersShadingsPropertiesDialog = function () {\n            _this.owner.owner.bordersAndShadingDialogModule.show();\n            _this.owner.dialog2.element.style.pointerEvents = 'none';\n        };\n        /**\n         * @private\n         */\n        this.showCellOptionsDialog = function () {\n            _this.owner.owner.cellOptionsDialogModule.show();\n            _this.owner.dialog2.element.style.pointerEvents = 'none';\n        };\n        this.owner = viewer;\n    }\n    Object.defineProperty(TablePropertiesDialog.prototype, \"cellFormat\", {\n        /**\n         * @private\n         */\n        get: function () {\n            if (isNullOrUndefined(this.cellFormatIn)) {\n                return this.cellFormatIn = new WCellFormat();\n            }\n            return this.cellFormatIn;\n        },\n        /**\n         * @private\n         */\n        set: function (value) {\n            this.cellFormatIn = value;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(TablePropertiesDialog.prototype, \"tableFormat\", {\n        /**\n         * @private\n         */\n        get: function () {\n            if (isNullOrUndefined(this.tableFormatIn)) {\n                this.tableFormatIn = new WTableFormat();\n                return this.tableFormatIn;\n            }\n            return this.tableFormatIn;\n        },\n        /**\n         * @private\n         */\n        set: function (value) {\n            this.tableFormatIn = value;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(TablePropertiesDialog.prototype, \"rowFormat\", {\n        /**\n         * @private\n         */\n        get: function () {\n            if (isNullOrUndefined(this.rowFormatInternal)) {\n                this.rowFormatInternal = new WRowFormat();\n                return this.rowFormatInternal;\n            }\n            return this.rowFormatInternal;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    TablePropertiesDialog.prototype.getModuleName = function () {\n        return 'TablePropertiesDialog';\n    };\n    /**\n     * @private\n     */\n    TablePropertiesDialog.prototype.initTablePropertyDialog = function (localValue) {\n        var id = this.owner.owner.containerId + '_TablePropertiesDialog';\n        this.target = createElement('div', { id: id, className: 'e-de-table-properties-dlg' });\n        this.owner.owner.element.appendChild(this.target);\n        var ejtabContainer = createElement('div', { id: this.target.id + '_TabContainer' });\n        this.target.appendChild(ejtabContainer);\n        this.tableTab = createElement('div', {\n            id: this.target.id + '_TablePropertiesContentDialogTab', className: 'e-de-table-ppty-dlg-tabs'\n        });\n        this.rowTab = createElement('div', {\n            id: this.target.id + '_RowPropertiesDialogTab', className: 'e-de-table-ppty-dlg-tabs'\n        });\n        this.cellTab = createElement('div', {\n            id: this.target.id + '_CellPropertiesDialogTab', className: 'e-de-table-ppty-dlg-tabs'\n        });\n        var separatorLine = createElement('div', { className: 'e-de-table-dialog-separator-line' });\n        // tslint:disable-next-line:max-line-length\n        var ejtab = createElement('div', { id: this.target.id + '_TablePropertiesDialogTab', className: 'e-de-table-ppty-tab' });\n        var headerContainer = createElement('div', { className: 'e-tab-header' });\n        var tableHeader = createElement('div', {\n            id: this.target.id + '_tableHeader', innerHTML: localValue.getConstant('Table')\n        });\n        var rowHeader = createElement('div', {\n            id: this.target.id + '_rowHeader', innerHTML: localValue.getConstant('Row')\n        });\n        var cellHeader = createElement('div', {\n            id: this.target.id + '_cellHeader', innerHTML: localValue.getConstant('Cell')\n        });\n        headerContainer.appendChild(tableHeader);\n        headerContainer.appendChild(rowHeader);\n        headerContainer.appendChild(cellHeader);\n        var contentContainer = createElement('div', { className: 'e-content' });\n        var tableContent = createElement('div', { id: this.target.id + '_tableContent' });\n        var rowContent = createElement('div', { id: this.target.id + '_rowContent' });\n        var cellContent = createElement('div', { id: this.target.id + '_cellContent' });\n        tableContent.appendChild(this.tableTab);\n        rowContent.appendChild(this.rowTab);\n        cellContent.appendChild(this.cellTab);\n        contentContainer.appendChild(tableContent);\n        contentContainer.appendChild(rowContent);\n        contentContainer.appendChild(cellContent);\n        ejtab.appendChild(headerContainer);\n        ejtab.appendChild(contentContainer);\n        ejtabContainer.appendChild(ejtab);\n        this.initTableProperties(this.tableTab, localValue);\n        this.initTableRowProperties(this.rowTab, localValue);\n        this.initTableCellProperties(this.cellTab, localValue);\n        this.tabObj = new Tab({}, ejtab);\n        this.target.appendChild(separatorLine);\n        var alignMentButtons = this.tableTab.getElementsByClassName(this.tableTab.id + 'e-de-table-alignment');\n        for (var i = 0; i < alignMentButtons.length; i++) {\n            alignMentButtons[i].addEventListener('click', this.changeTableAlignment);\n        }\n        var cellAlignment = this.cellTab.getElementsByClassName(this.cellTab.id + 'e-de-table-cell-alignment');\n        for (var i = 0; i < cellAlignment.length; i++) {\n            cellAlignment[i].addEventListener('click', this.changeCellAlignment);\n        }\n        var tableTabHeader = this.tabObj.element.getElementsByClassName('e-item e-toolbar-item')[0];\n        var tableTabHeaderItem = tableTabHeader.getElementsByClassName('e-tab-wrap')[0];\n        tableTabHeaderItem.classList.add('e-de-table-ppty-dlg-table-header');\n        var rowTabHeader = this.tabObj.element.getElementsByClassName('e-item e-toolbar-item')[1];\n        var rowTabHeaderItem = rowTabHeader.getElementsByClassName('e-tab-wrap')[0];\n        rowTabHeaderItem.classList.add('e-de-table-ppty-dlg-row-header');\n        var cellTabHeader = this.tabObj.element.getElementsByClassName('e-item e-toolbar-item')[2];\n        var cellTabHeaderItem = cellTabHeader.getElementsByClassName('e-tab-wrap')[0];\n        cellTabHeaderItem.classList.add('e-de-table-ppty-dlg-cell-header');\n        this.tabObj.element.getElementsByClassName('e-indicator')[0].style.right = '155px';\n    };\n    /**\n     * @private\n     */\n    TablePropertiesDialog.prototype.show = function () {\n        var localValue = new L10n('documenteditor', this.owner.owner.defaultLocale);\n        localValue.setLocale(this.owner.owner.locale);\n        setCulture(this.owner.owner.locale);\n        if (!this.target) {\n            this.initTablePropertyDialog(localValue);\n        }\n        if (this.owner.selection.caret.style.display !== 'none') {\n            this.owner.selection.caret.style.display = 'none';\n        }\n        this.owner.dialog2.header = localValue.getConstant('Table Properties');\n        this.owner.dialog2.position = { X: 'center', Y: 'center' };\n        this.owner.dialog2.width = 'auto';\n        this.owner.dialog2.height = 'auto';\n        this.owner.dialog2.content = this.target;\n        this.owner.dialog2.beforeOpen = this.onBeforeOpen;\n        this.owner.dialog2.close = this.onCloseTablePropertyDialog;\n        this.owner.dialog2.open = this.wireEvent.bind(this);\n        this.owner.dialog2.buttons = [{\n                click: this.applyTableProperties,\n                buttonModel: { content: localValue.getConstant('Ok'), cssClass: 'e-flat e-table-ppty-okay', isPrimary: true }\n            },\n            {\n                click: this.closeTablePropertiesDialog,\n                buttonModel: { content: localValue.getConstant('Cancel'), cssClass: 'e-flat e-table-ppty-cancel' }\n            }];\n        //this.tabObj.select(0);\n        this.owner.dialog2.dataBind();\n        this.owner.dialog2.show();\n    };\n    /**\n     * @private\n     */\n    TablePropertiesDialog.prototype.calculateGridValue = function (table) {\n        table.calculateGrid();\n        table.isGridUpdated = false;\n        table.buildTableColumns();\n        table.isGridUpdated = true;\n        this.owner.selection.owner.isLayoutEnabled = true;\n        this.owner.layout.reLayoutTable(table);\n        this.owner.owner.editorModule.reLayout(this.owner.selection);\n        this.owner.owner.editorModule.updateSelectionTextPosition(true);\n        var history = this.owner.owner.editorHistory;\n        if (history && history.currentBaseHistoryInfo) {\n            if (history.currentBaseHistoryInfo.modifiedProperties.length > 0) {\n                history.currentBaseHistoryInfo.updateSelection();\n            }\n            history.updateHistory();\n        }\n        this.owner.owner.editorModule.fireContentChange();\n    };\n    /**\n     * @private\n     */\n    TablePropertiesDialog.prototype.loadTableProperties = function () {\n        this.setTableProperties();\n        this.setTableRowProperties();\n        this.setTableCellProperties();\n        if (!this.owner.owner.bordersAndShadingDialogModule) {\n            this.bordersAndShadingButton.disabled = true;\n        }\n        else {\n            this.bordersAndShadingButton.disabled = false;\n        }\n        // if (!this.owner.owner.tableOptionsDialogModule) {\n        //     this.tableOptionButton.disabled = true;\n        // } else {\n        this.tableOptionButton.disabled = false;\n        // }\n        // if (!this.owner.owner.cellOptionsDialogModule) {\n        //     this.cellOptionButton.disabled = true;\n        // } else {\n        this.cellOptionButton.disabled = false;\n        // }\n    };\n    /**\n     * @private\n     */\n    TablePropertiesDialog.prototype.wireEvent = function () {\n        this.owner.selection.hideCaret();\n        //Table Format\n        this.preferCheckBox.change = this.changeTableCheckBox.bind(this);\n        this.tableWidthBox.change = this.onTableWidthChange.bind(this);\n        this.tableWidthType.change = this.onTableWidthTypeChange.bind(this);\n        this.leftIndentBox.change = this.onLeftIndentChange.bind(this);\n        //Row Format\n        this.rowHeightCheckBox.change = this.changeTableRowCheckBox.bind(this);\n        this.rowHeightBox.change = this.onRowHeightChange.bind(this);\n        this.rowHeightType.change = this.onRowHeightTypeChange.bind(this);\n        this.allowRowBreak.change = this.onAllowBreakAcrossPage.bind(this);\n        this.repeatHeader.change = this.onRepeatHeader.bind(this);\n        //Cell Format\n        this.preferredCellWidthCheckBox.change = this.changeTableCellCheckBox.bind(this);\n        this.cellWidthBox.change = this.onCellWidthChange.bind(this);\n        this.cellWidthType.change = this.onCellWidthTypeChange.bind(this);\n    };\n    //#region Table Format\n    /**\n     * @private\n     */\n    // tslint:disable-next-line:max-func-body-length\n    TablePropertiesDialog.prototype.initTableProperties = function (element, localValue) {\n        var container = createElement('div', { id: element.id + '_table_TabContainer' });\n        var sizeHeader = createElement('div', {\n            id: container.id + '_sizeLabel', innerHTML: localValue.getConstant('Size'),\n            styles: 'width:100%;margin:0px;padding-top: 20px;padding-bottom: 0px;', className: 'e-de-table-dialog-options-label'\n        });\n        var parentContainer = createElement('div', { styles: 'display: inline-flex;' });\n        var childContainer1 = createElement('div', {\n            styles: 'float: left;',\n            className: 'e-de-table-container-div'\n        });\n        var childContainer2 = createElement('div', {\n            className: 'e-de-table-ppty-dlg-preferred-width-div'\n        });\n        var child1 = createElement('div', {\n            styles: 'display: inline;',\n            className: 'e-de-table-ppty-dlg-measure-div'\n        });\n        var child2 = createElement('div', {\n            styles: 'display: inline;position: absolute;',\n            className: 'e-de-table-ppty-dlg-measure-drop-down-div'\n        });\n        var childContainer3 = createElement('div');\n        var preferCheckBox = createElement('input', {\n            id: element.id + '_Prefer_Width_CheckBox', attrs: { 'type': 'checkbox' }\n        });\n        this.preferredWidth = createElement('input', { id: element.id + 'preferred_Width' });\n        var controlDiv = createElement('div');\n        var tableWidthType = createElement('select', {\n            innerHTML: '<option>' + localValue.getConstant('Points') +\n                '</option><option>' + localValue.getConstant('Percent') + '</option>', id: element.id + '_width_dropdown'\n        });\n        var labeltext = createElement('label', {\n            innerHTML: localValue.getConstant('Measure in'), styles: 'width: 60px;font-size: 11px; font-weight: normal;'\n        });\n        var alignmentHeader = createElement('div', {\n            innerHTML: localValue.getConstant('Alignment'), className: 'e-de-table-dialog-options-label',\n            styles: 'width: 100%;margin: 0px;padding-bottom: 15px'\n        });\n        var alignmentContainer = createElement('div', { styles: 'height:70px;' });\n        var classDivName = element.id + 'e-de-table-alignment';\n        var leftAlignDiv = createElement('div', { className: 'e-de-table-dia-align-div' });\n        this.left = createElement('div', {\n            className: 'e-icons e-de-table-properties-alignment e-de-table-left-alignment ' + classDivName,\n            id: element.id + '_left_alignment', styles: 'width:54px;height:54px;margin:2px'\n        });\n        leftAlignDiv.appendChild(this.left);\n        var centerAlignDiv = createElement('div', { className: 'e-de-table-dia-align-div' });\n        this.center = createElement('div', {\n            className: 'e-icons e-de-table-properties-alignment  e-de-table-center-alignment ' + classDivName,\n            id: element.id + '_center_alignment', styles: 'width:54px;height:54px;margin:2px'\n        });\n        centerAlignDiv.appendChild(this.center);\n        this.right = createElement('div', {\n            styles: 'width:54px;height:54px;margin:2px', id: element.id + '_right_alignment',\n            className: 'e-icons e-de-table-properties-alignment  e-de-table-right-alignment ' + classDivName\n        });\n        var rightAlignDiv = createElement('div', { className: 'e-de-table-dia-align-div' });\n        rightAlignDiv.appendChild(this.right);\n        var leftlabel = createElement('label', {\n            innerHTML: localValue.getConstant('Left'), className: 'e-de-table-dia-align-label'\n        });\n        var centerlabel = createElement('label', {\n            innerHTML: localValue.getConstant('Center'), className: 'e-de-table-dia-align-label'\n        });\n        var rightlabel = createElement('label', {\n            innerHTML: localValue.getConstant('Right'), className: 'e-de-table-dia-align-label'\n        });\n        var leftIndenetContainer = createElement('div', {\n            className: 'e-de-table-ppty-dlg-left-indent-container'\n        });\n        var leftIndentLabel = createElement('label', {\n            innerHTML: localValue.getConstant('Indent from left'),\n            styles: 'font-weight: normal;font-size: 11px;float:right;margin-right:121px;'\n        });\n        var leftIndentBox = createElement('div', {\n            styles: 'margin-top: 27px;'\n        });\n        this.leftIndent = createElement('input', { id: element.id + '_left_indent' });\n        var tableOptionContiner = createElement('div', {\n            className: 'e-de-tbl-dlg-border-btn'\n        });\n        this.bordersAndShadingButton = createElement('button', {\n            innerHTML: localValue.getConstant('Borders and Shading'),\n            id: element.id + '_borders_and_shadings', className: 'e-control e-btn e-flat e-de-ok-button'\n        });\n        this.tableOptionButton = createElement('button', {\n            className: 'e-control e-btn e-flat', innerHTML: localValue.getConstant('Options'),\n            id: element.id + '_table_cellmargin'\n        });\n        this.tableOptionButton.addEventListener('click', this.showTableOptionsDialog);\n        this.bordersAndShadingButton.addEventListener('click', this.showBordersShadingsPropertiesDialog);\n        tableOptionContiner.appendChild(this.bordersAndShadingButton);\n        tableOptionContiner.appendChild(this.tableOptionButton);\n        leftIndenetContainer.appendChild(leftIndentLabel);\n        leftIndentBox.appendChild(this.leftIndent);\n        leftIndenetContainer.appendChild(leftIndentBox);\n        alignmentContainer.appendChild(leftAlignDiv);\n        alignmentContainer.appendChild(centerAlignDiv);\n        alignmentContainer.appendChild(rightAlignDiv);\n        leftAlignDiv.appendChild(leftlabel);\n        centerAlignDiv.appendChild(centerlabel);\n        rightAlignDiv.appendChild(rightlabel);\n        alignmentContainer.appendChild(leftIndenetContainer);\n        container.appendChild(sizeHeader);\n        element.appendChild(container);\n        childContainer1.appendChild(preferCheckBox);\n        parentContainer.appendChild(childContainer1);\n        childContainer2.appendChild(this.preferredWidth);\n        parentContainer.appendChild(childContainer2);\n        controlDiv.appendChild(tableWidthType);\n        child1.appendChild(labeltext);\n        child2.appendChild(controlDiv);\n        childContainer3.appendChild(child1);\n        childContainer3.appendChild(child2);\n        parentContainer.appendChild(childContainer3);\n        element.appendChild(parentContainer);\n        element.appendChild(alignmentHeader);\n        element.appendChild(alignmentContainer);\n        element.appendChild(tableOptionContiner);\n        this.tableWidthBox = new NumericTextBox({\n            value: 0, decimals: 2, min: 0, max: 1584, width: 120, enablePersistence: false\n        });\n        this.tableWidthBox.appendTo(this.preferredWidth);\n        this.leftIndentBox = new NumericTextBox({\n            value: 0, decimals: 2, min: -1584, max: 1584, width: 140, enablePersistence: false\n        });\n        this.leftIndentBox.appendTo(this.leftIndent);\n        this.preferCheckBox = new CheckBox({\n            label: localValue.getConstant('Preferred Width')\n        });\n        this.preferCheckBox.appendTo(preferCheckBox);\n        this.tableWidthType = new DropDownList({ width: '120px' });\n        this.tableWidthType.appendTo(tableWidthType);\n    };\n    /**\n     * @private\n     */\n    TablePropertiesDialog.prototype.onTableWidthChange = function () {\n        this.tableFormat.preferredWidth = this.tableWidthBox.value;\n    };\n    /**\n     * @private\n     */\n    TablePropertiesDialog.prototype.onTableWidthTypeChange = function () {\n        var value;\n        var table = this.owner.selection.start.paragraph.associatedCell.ownerTable;\n        var width = HelperMethods.convertPixelToPoint(this.owner.clientArea.width);\n        if (this.tableWidthType.text === 'Percent' && this.owner.selection.tableFormat.preferredWidthType !== 'Percent') {\n            value = this.tableWidthBox.value / width * 100;\n            this.formatNumericTextBox(this.tableWidthBox, 'Percent', value);\n        }\n        else if (this.tableWidthType.text === 'Points' && this.owner.selection.tableFormat.preferredWidthType !== 'Point') {\n            value = width / 100 * this.tableWidthBox.value;\n            this.formatNumericTextBox(this.tableWidthBox, 'Point', value);\n        }\n        else {\n            if (this.tableWidthBox.format === '#\\'\\%\\'') {\n                if (this.tableWidthType.text === 'Points') {\n                    value = width / 100 * this.tableWidthBox.value;\n                }\n                else {\n                    value = this.tableWidthBox.value;\n                }\n            }\n            else {\n                if (this.tableWidthType.text === 'Percent') {\n                    value = this.tableWidthBox.value / width * 100;\n                }\n                else {\n                    value = this.tableWidthBox.value;\n                }\n            }\n            // tslint:disable-next-line:max-line-length\n            this.formatNumericTextBox(this.tableWidthBox, (this.tableWidthType.text === 'Points') ? 'Point' : this.tableWidthType.text, value);\n        }\n        this.tableFormat.preferredWidthType = (this.tableWidthType.text === 'Points') ? 'Point' : this.tableWidthType.text;\n    };\n    /**\n     * @private\n     */\n    TablePropertiesDialog.prototype.onLeftIndentChange = function () {\n        this.tableFormat.leftIndent = this.leftIndentBox.value;\n    };\n    TablePropertiesDialog.prototype.setTableProperties = function () {\n        //instance of Table Property values\n        var tableFormat = this.owner.selection.tableFormat;\n        var tableHasWidth = tableFormat.preferredWidth > 0;\n        var preferredWidth = tableFormat.preferredWidth;\n        if (isNullOrUndefined(tableFormat.preferredWidth)) {\n            this.preferCheckBox.indeterminate = true;\n            var startTable = this.owner.selection.start.paragraph.associatedCell.ownerTable;\n            var table = startTable.combineWidget(this.owner);\n            preferredWidth = table.tableFormat.preferredWidth;\n        }\n        else {\n            this.preferCheckBox.checked = tableHasWidth;\n        }\n        this.tableWidthBox.enabled = tableHasWidth;\n        this.tableWidthType.enabled = tableHasWidth;\n        this.formatNumericTextBox(this.tableWidthBox, tableFormat.preferredWidthType, preferredWidth);\n        if (tableFormat.preferredWidthType === 'Auto' || tableFormat.preferredWidthType === 'Point') {\n            this.tableWidthType.index = 0;\n        }\n        else {\n            this.tableWidthType.index = 1;\n        }\n        this.leftIndentBox.value = tableFormat.leftIndent;\n        this.leftIndentBox.enabled = tableFormat.tableAlignment === 'Left';\n        classList(this.left, [], ['e-de-table-alignment-active']);\n        classList(this.right, [], ['e-de-table-alignment-active']);\n        classList(this.center, [], ['e-de-table-alignment-active']);\n        if (tableFormat.tableAlignment === 'Left') {\n            this.left.classList.add('e-de-table-alignment-active');\n        }\n        else if (tableFormat.tableAlignment === 'Center') {\n            this.center.classList.add('e-de-table-alignment-active');\n        }\n        else if (tableFormat.tableAlignment === 'Right') {\n            this.right.classList.add('e-de-table-alignment-active');\n        }\n    };\n    /**\n     * @private\n     */\n    TablePropertiesDialog.prototype.getTableAlignment = function () {\n        var id = this.tableTab.id;\n        var groupButtons = this.tableTab.getElementsByClassName(id + 'e-de-table-alignment');\n        for (var j = 0; j < groupButtons.length; j++) {\n            var groupButton = groupButtons[j];\n            if (groupButton.classList.contains('e-de-table-alignment-active')) {\n                if (j === 0) {\n                    return 'Left';\n                }\n                else if (j === 1) {\n                    return 'Center';\n                }\n                else {\n                    return 'Right';\n                }\n            }\n        }\n        return undefined;\n    };\n    /**\n     * @private\n     */\n    TablePropertiesDialog.prototype.updateClassForAlignmentProperties = function (element) {\n        var id = element.id;\n        var groupButtons = element.getElementsByClassName(id + 'e-de-table-alignment');\n        for (var j = 0; j < groupButtons.length; j++) {\n            var groupButton = groupButtons[j];\n            if (groupButton.classList.contains('e-de-table-alignment-active')) {\n                classList(groupButton, ['e-de-table-properties-alignment'], ['e-de-table-alignment-active']);\n            }\n        }\n    };\n    //#endregion\n    //#region Row Format\n    /**\n     * @private\n     */\n    TablePropertiesDialog.prototype.initTableRowProperties = function (element, localValue) {\n        var rowDiv = createElement('div', { styles: 'width: 100%;' });\n        var sizeLabeldiv = createElement('div', {\n            innerHTML: localValue.getConstant('Size'),\n            styles: 'width: 100%;padding-top: 20px;padding-bottom: 10px;',\n            className: 'e-de-table-dialog-options-label'\n        });\n        var parentDiv = createElement('div', { styles: 'display: inline;width: 100%;' });\n        var childDiv1 = createElement('div', {\n            styles: 'display: inline;float: left;',\n            className: 'e-de-table-header-div'\n        });\n        var rowHeightCheckBox = createElement('input', {\n            attrs: { 'type': 'checkbox' }, id: element.id + '_height_CheckBox'\n        });\n        var childdiv2 = createElement('div', {\n            styles: 'display: inline-block;',\n            className: 'e-de-row-ht-top'\n        });\n        this.rowHeight = createElement('input', {\n            attrs: { 'type': 'text' }, 'id': element.id + '_table_row_height'\n        });\n        var child2 = createElement('div', {\n            styles: 'float: right;display: inline;width: auto;margin-top: 5px;'\n        });\n        var child3 = createElement('div', {\n            styles: 'display: inline;',\n            className: 'e-de-table-ppty-dlg-row-height-label'\n        });\n        var child4 = createElement('div', {\n            styles: 'display: inline;',\n            className: 'e-de-table-subheader-div'\n        });\n        var controlDiv = createElement('div');\n        var rowHeightType = createElement('select', {\n            innerHTML: '<option>' + localValue.getConstant('At least')\n                + '</option><option>' + localValue.getConstant('Exactly') + '</option>',\n            id: element.id + '_height_type'\n        });\n        var labeltext = createElement('label', {\n            innerHTML: localValue.getConstant('Row height is'), styles: 'font-size: 11px;font-weight: normal;width: 75px;'\n        });\n        rowDiv.appendChild(sizeLabeldiv);\n        element.appendChild(rowDiv);\n        childDiv1.appendChild(rowHeightCheckBox);\n        parentDiv.appendChild(childDiv1);\n        childdiv2.appendChild(this.rowHeight);\n        parentDiv.appendChild(childdiv2);\n        controlDiv.appendChild(rowHeightType);\n        child3.appendChild(labeltext);\n        child4.appendChild(controlDiv);\n        child2.appendChild(child3);\n        child2.appendChild(child4);\n        parentDiv.appendChild(child2);\n        element.appendChild(parentDiv);\n        var alignmentDiv = createElement('div', {\n            innerHTML: localValue.getConstant('Options'), styles: 'width: 100%;',\n            className: 'e-de-table-dialog-options-label'\n        });\n        // tslint:disable-next-line:max-line-length\n        var allowRowContainer = createElement('div', { className: 'e-de-table-ppty-options-break' });\n        var repeatHeaderContaniner = createElement('div', { className: 'e-de-table-ppty-options-header-row' });\n        var allowRowBreak = createElement('input', {\n            attrs: { 'type': 'checkbox' }, id: element.id + '_allow_row_break'\n        });\n        var repeatHeader = createElement('input', {\n            attrs: { 'type': 'checkbox' }, 'id': element.id + '_repeat_header'\n        });\n        allowRowContainer.appendChild(allowRowBreak);\n        repeatHeaderContaniner.appendChild(repeatHeader);\n        element.appendChild(alignmentDiv);\n        element.appendChild(allowRowContainer);\n        element.appendChild(repeatHeaderContaniner);\n        this.rowHeightBox = new NumericTextBox({\n            value: 0, decimals: 2, min: 0, max: 1584, width: 120, enablePersistence: false\n        });\n        this.rowHeightBox.appendTo(this.rowHeight);\n        this.rowHeightCheckBox = new CheckBox({\n            label: localValue.getConstant('Specify height')\n        });\n        this.rowHeightCheckBox.appendTo(rowHeightCheckBox);\n        this.rowHeightType = new DropDownList({ width: '120px' });\n        this.rowHeightType.appendTo(rowHeightType);\n        this.allowRowBreak = new CheckBox({\n            label: localValue.getConstant('Allow row to break across pages')\n        });\n        this.allowRowBreak.appendTo(allowRowBreak);\n        this.repeatHeader = new CheckBox({\n            label: localValue.getConstant('Repeat as header row at the top of each page')\n        });\n        this.repeatHeader.appendTo(repeatHeader);\n    };\n    TablePropertiesDialog.prototype.setTableRowProperties = function () {\n        var rowFormat = this.owner.selection.rowFormat;\n        var enableRowHeight = (rowFormat.height > 0 || rowFormat.heightType === 'Exactly');\n        //instance of table row values\n        if (enableRowHeight) {\n            this.rowHeightCheckBox.checked = true;\n        }\n        else {\n            if (rowFormat.heightType === undefined) {\n                this.rowHeightCheckBox.indeterminate = true;\n                enableRowHeight = true;\n            }\n            else {\n                this.rowHeightCheckBox.checked = false;\n            }\n        }\n        this.rowHeightBox.enabled = enableRowHeight;\n        this.rowHeightType.enabled = enableRowHeight;\n        // let enabledHeader: boolean = this.enableRepeatHeader() ? false : true;\n        var enabledHeader = true;\n        if (isNullOrUndefined(this.owner.selection.rowFormat.isHeader)) {\n            this.repeatHeader.indeterminate = true;\n            this.repeatHeader.disabled = true;\n        }\n        else if (this.owner.selection.rowFormat.isHeader) {\n            this.repeatHeader.checked = !enabledHeader;\n            this.repeatHeader.indeterminate = enabledHeader;\n            this.repeatHeader.disabled = enabledHeader;\n        }\n        else {\n            this.repeatHeader.checked = false;\n            this.repeatHeader.indeterminate = false;\n            this.repeatHeader.disabled = enabledHeader;\n        }\n        if (isNullOrUndefined(rowFormat.allowBreakAcrossPages)) {\n            this.allowRowBreak.indeterminate = true;\n        }\n        else {\n            this.allowRowBreak.checked = rowFormat.allowBreakAcrossPages;\n        }\n        this.rowHeightBox.value = rowFormat.height;\n        if (rowFormat.heightType === 'Auto' || rowFormat.heightType === 'AtLeast') {\n            this.rowHeightType.index = 0;\n        }\n        else {\n            this.rowHeightType.index = 1;\n        }\n    };\n    /**\n     * @private\n     */\n    TablePropertiesDialog.prototype.onRowHeightChange = function () {\n        this.rowHeightValue = this.rowHeightBox.value;\n    };\n    /**\n     * @private\n     */\n    TablePropertiesDialog.prototype.onRowHeightTypeChange = function () {\n        this.rowFormat.heightType = this.rowHeightType.text;\n    };\n    /**\n     * @private\n     */\n    TablePropertiesDialog.prototype.onAllowBreakAcrossPage = function () {\n        this.rowFormat.allowBreakAcrossPages = this.allowRowBreak.checked;\n    };\n    /**\n     * @private\n     */\n    TablePropertiesDialog.prototype.onRepeatHeader = function () {\n        this.rowFormat.isHeader = this.repeatHeader.checked;\n    };\n    /**\n     * @private\n     */\n    // public enableRepeatHeader(): boolean {\n    //     let isFirstRow: number = 0;\n    //     for (let i: number = 0; i < this.owner.selection.selectionRanges.length; i++) {\n    //         let range: SelectionRange = this.owner.selection.selectionRanges.getRange(i);\n    //         let table: WTable = range.start.paragraph.associatedCell.ownerTable;\n    //         if (table.childNodes.indexOf(range.start.paragraph.associatedCell.ownerRow) === 0 ||\n    //             table.childNodes.indexOf(range.start.paragraph.associatedCell.ownerRow) === 0) {\n    //             isFirstRow++;\n    //         }\n    //     }\n    //     return isFirstRow === this.owner.selection.selectionRanges.length;\n    // }\n    //#endregion\n    //#region Cell Format\n    /**\n     * @private\n     */\n    TablePropertiesDialog.prototype.initTableCellProperties = function (element, localValue) {\n        var sizeDiv = createElement('div', { styles: 'width: 100%;' });\n        var div = createElement('div', {\n            innerHTML: localValue.getConstant('Size'), className: 'e-de-table-dialog-options-label',\n            styles: 'width: 100%;padding-top: 20px;padding-bottom: 10px;',\n        });\n        var parentdiv = createElement('div', { styles: 'display: inline;width: 100%;' });\n        var childdiv1 = createElement('div', {\n            styles: 'display: inline;float: left;',\n            className: 'e-de-table-cell-header-div'\n        });\n        var preferredCellWidthCheckBox = createElement('input', {\n            attrs: { 'type': 'checkbox' }, id: element.id + '_Prefer_Width_CheckBox_cell'\n        });\n        var childdiv2 = createElement('div', {\n            styles: 'display: inline-block;',\n            className: 'e-de-cell-width-top'\n        });\n        this.preferredCellWidth = createElement('input', {\n            id: element.id + 'tablecell_Width_textBox', attrs: { 'type': 'text' }\n        });\n        var child2 = createElement('div', {\n            styles: 'float: right;display: inline;width: auto;margin-top: 5px;'\n        });\n        var child3 = createElement('div', {\n            styles: 'display: inline;',\n            className: 'e-de-table-ppty-dlg-cell-tab-measure-label'\n        });\n        var child4 = createElement('div', {\n            styles: 'display: inline;float: right;', className: 'e-de-table-cell-subheader-div'\n        });\n        var controlDiv = createElement('div');\n        var cellWidthType = createElement('select', {\n            innerHTML: '<option>' + localValue.getConstant('Points') + '</option><option>' +\n                localValue.getConstant('Percent') + '</option>', 'id': element.id + '_measure_type_cell'\n        });\n        var labeltext = createElement('label', {\n            innerHTML: localValue.getConstant('Measure in'),\n            styles: 'font-size: 11px;font-weight: normal;'\n        });\n        sizeDiv.appendChild(div);\n        element.appendChild(sizeDiv);\n        childdiv1.appendChild(preferredCellWidthCheckBox);\n        parentdiv.appendChild(childdiv1);\n        childdiv2.appendChild(this.preferredCellWidth);\n        parentdiv.appendChild(childdiv2);\n        controlDiv.appendChild(cellWidthType);\n        child3.appendChild(labeltext);\n        child4.appendChild(controlDiv);\n        child2.appendChild(child3);\n        child2.appendChild(child4);\n        parentdiv.appendChild(child2);\n        element.appendChild(parentdiv);\n        var alignmentDiv = createElement('div', {\n            innerHTML: localValue.getConstant('Vertical alignment'),\n            styles: 'width: 100%;margin: 0px;',\n            className: 'e-de-table-dialog-options-label'\n        });\n        var classDivName = element.id + 'e-de-table-cell-alignment';\n        var divAlignment = createElement('div', {\n            styles: 'width: 100%;height: 100px;'\n        });\n        var divStyle = 'width:54px;height:54px;margin:2px;border-style:solid;border-width:1px';\n        var topAlignDiv = createElement('div', { className: 'e-de-table-dia-align-div' });\n        this.cellTopAlign = createElement('div', {\n            styles: divStyle, id: element.id + '_cell_top-alignment',\n            className: 'e-icons e-de-tablecell-alignment  e-de-tablecell-top-alignment ' + classDivName\n        });\n        topAlignDiv.appendChild(this.cellTopAlign);\n        var centerAlignDiv = createElement('div', { className: 'e-de-table-dia-align-div' });\n        this.cellCenterAlign = createElement('div', {\n            styles: divStyle, id: element.id + '_cell_center-alignment',\n            className: 'e-icons e-de-tablecell-alignment  e-de-tablecell-center-alignment ' + classDivName\n        });\n        centerAlignDiv.appendChild(this.cellCenterAlign);\n        var bottomAlignDiv = createElement('div', { className: 'e-de-table-dia-align-div' });\n        this.cellBottomAlign = createElement('div', {\n            styles: divStyle, id: element.id + '_cell_bottom-alignment',\n            className: 'e-icons e-de-tablecell-alignment e-de-tablecell-bottom-alignment  ' + classDivName\n        });\n        bottomAlignDiv.appendChild(this.cellBottomAlign);\n        var topLabel = createElement('label', {\n            innerHTML: localValue.getConstant('Top'), className: 'e-de-table-dia-align-label'\n        });\n        var centerLabel = createElement('label', {\n            innerHTML: localValue.getConstant('Center'), className: 'e-de-table-dia-align-label'\n        });\n        var bottomLabel = createElement('label', {\n            innerHTML: localValue.getConstant('Bottom'), className: 'e-de-table-dia-align-label'\n        });\n        this.cellOptionButton = createElement('button', {\n            innerHTML: localValue.getConstant('Options'), id: element.id + '_table_cellmargin',\n            className: 'e-de-tbl-dlg-op-btn e-control e-btn e-flat e-de-cell-options',\n        });\n        divAlignment.appendChild(topAlignDiv);\n        divAlignment.appendChild(centerAlignDiv);\n        divAlignment.appendChild(bottomAlignDiv);\n        topAlignDiv.appendChild(topLabel);\n        centerAlignDiv.appendChild(centerLabel);\n        bottomAlignDiv.appendChild(bottomLabel);\n        element.appendChild(alignmentDiv);\n        element.appendChild(divAlignment);\n        element.appendChild(this.cellOptionButton);\n        this.cellOptionButton.addEventListener('click', this.showCellOptionsDialog);\n        this.cellWidthBox = new NumericTextBox({\n            value: 0, decimals: 2, min: 0, max: 1584, width: 120, enablePersistence: false\n        });\n        this.cellWidthBox.appendTo(this.preferredCellWidth);\n        this.preferredCellWidthCheckBox = new CheckBox({ label: localValue.getConstant('Preferred Width') });\n        this.preferredCellWidthCheckBox.appendTo(preferredCellWidthCheckBox);\n        this.cellWidthType = new DropDownList({ width: '120px' });\n        this.cellWidthType.appendTo(cellWidthType);\n    };\n    TablePropertiesDialog.prototype.setTableCellProperties = function () {\n        var cellFormat = this.owner.selection.cellFormat;\n        //instance of table cell Values\n        this.hasCellWidth = cellFormat.preferredWidth > 0;\n        var preferredWidth = cellFormat.preferredWidth;\n        if (isNullOrUndefined(cellFormat.preferredWidth)) {\n            this.preferredCellWidthCheckBox.indeterminate = true;\n            preferredWidth = this.owner.selection.start.paragraph.associatedCell.cellFormat.preferredWidth;\n        }\n        else {\n            this.preferredCellWidthCheckBox.checked = this.hasCellWidth;\n        }\n        this.cellWidthBox.enabled = this.hasCellWidth;\n        this.cellWidthType.enabled = this.hasCellWidth;\n        if (cellFormat.preferredWidthType === 'Auto' || cellFormat.preferredWidthType === 'Point') {\n            this.cellWidthType.index = 0;\n        }\n        else {\n            this.cellWidthType.index = 1;\n        }\n        this.formatNumericTextBox(this.cellWidthBox, cellFormat.preferredWidthType, preferredWidth);\n        classList(this.cellTopAlign, ['e-de-tablecell-alignment'], ['e-de-table-alignment-active']);\n        classList(this.cellCenterAlign, ['e-de-tablecell-alignment'], ['e-de-table-alignment-active']);\n        classList(this.cellBottomAlign, ['e-de-tablecell-alignment'], ['e-de-table-alignment-active']);\n        if (cellFormat.verticalAlignment === 'Top') {\n            this.cellTopAlign.classList.add('e-de-table-alignment-active');\n        }\n        else if (cellFormat.verticalAlignment === 'Center') {\n            this.cellCenterAlign.classList.add('e-de-table-alignment-active');\n        }\n        else if (cellFormat.verticalAlignment === 'Bottom') {\n            this.cellBottomAlign.classList.add('e-de-table-alignment-active');\n        }\n    };\n    /**\n     * @private\n     */\n    TablePropertiesDialog.prototype.updateClassForCellAlignment = function (element) {\n        var cellAlignments = element.getElementsByClassName(element.id + 'e-de-table-cell-alignment');\n        for (var j = 0; j < cellAlignments.length; j++) {\n            var cellAlignment = cellAlignments[j];\n            if (cellAlignment.classList.contains('e-de-table-alignment-active')) {\n                classList(cellAlignment, ['e-de-tablecell-alignment'], ['e-de-table-alignment-active']);\n            }\n        }\n    };\n    /**\n     * @private\n     */\n    TablePropertiesDialog.prototype.formatNumericTextBox = function (textBox, format, value) {\n        if (format === 'Auto' || format === 'Point') {\n            textBox.format = 'n2';\n        }\n        else {\n            textBox.format = '#\\'\\%\\'';\n        }\n        textBox.step = 1;\n        textBox.decimals = 2;\n        textBox.value = value;\n    };\n    /**\n     * @private\n     */\n    TablePropertiesDialog.prototype.getCellAlignment = function () {\n        var id = this.cellTab.id;\n        var groupButtons = this.cellTab.getElementsByClassName(id + 'e-de-table-cell-alignment');\n        for (var j = 0; j < groupButtons.length; j++) {\n            var groupButton = groupButtons[j];\n            if (groupButton.classList.contains('e-de-table-alignment-active')) {\n                if (j === 0) {\n                    return 'Top';\n                }\n                else if (j === 1) {\n                    return 'Center';\n                }\n                else {\n                    return 'Bottom';\n                }\n            }\n        }\n        return this.owner.selection.cellFormat.verticalAlignment;\n    };\n    /**\n     * @private\n     */\n    TablePropertiesDialog.prototype.onCellWidthChange = function () {\n        this.cellFormat.preferredWidth = this.cellWidthBox.value;\n    };\n    /**\n     * @private\n     */\n    TablePropertiesDialog.prototype.onCellWidthTypeChange = function () {\n        var value;\n        var table = this.owner.selection.start.paragraph.associatedCell.ownerTable;\n        var containerWidth = table.getOwnerWidth(true);\n        var tableWidth = table.getTableClientWidth(containerWidth);\n        if (this.cellWidthType.text === 'Percent' && this.owner.selection.cellFormat.preferredWidthType !== 'Percent') {\n            value = this.cellWidthBox.value / tableWidth * 100;\n            this.formatNumericTextBox(this.cellWidthBox, 'Percent', value);\n        }\n        else if (this.cellWidthType.text === 'Points' && this.owner.selection.cellFormat.preferredWidthType !== 'Point') {\n            value = tableWidth / 100 * this.cellWidthBox.value;\n            this.formatNumericTextBox(this.cellWidthBox, 'Point', value);\n        }\n        else {\n            if (this.cellWidthBox.format === '#\\'\\%\\'') {\n                if (this.cellWidthType.text === 'Points') {\n                    value = tableWidth / 100 * this.cellWidthBox.value;\n                }\n                else {\n                    value = this.cellWidthBox.value;\n                }\n            }\n            else {\n                if (this.cellWidthType.text === 'Percent') {\n                    value = this.cellWidthBox.value / tableWidth * 100;\n                }\n                else {\n                    value = this.cellWidthBox.value;\n                }\n            }\n            // tslint:disable-next-line:max-line-length\n            this.formatNumericTextBox(this.cellWidthBox, (this.cellWidthType.text === 'Points') ? 'Point' : this.cellWidthType.text, value);\n        }\n        this.cellFormat.preferredWidthType = (this.cellWidthType.text === 'Points') ? 'Point' : this.cellWidthType.text;\n    };\n    /**\n     * @private\n     */\n    TablePropertiesDialog.prototype.destroy = function () {\n        if (!isNullOrUndefined(this.target)) {\n            if (this.target.parentElement) {\n                this.target.parentElement.removeChild(this.target);\n            }\n            for (var s = 0; s < this.target.childNodes.length; s++) {\n                this.target.removeChild(this.target.childNodes[s]);\n                s--;\n            }\n            this.target = undefined;\n        }\n        this.dialog = undefined;\n        this.target = undefined;\n        this.cellAlignment = undefined;\n        this.tableAlignment = undefined;\n        this.owner = undefined;\n        this.preferCheckBox = undefined;\n        this.tableWidthType = undefined;\n        this.preferredWidth = undefined;\n        this.rowHeightType = undefined;\n        this.rowHeightCheckBox = undefined;\n        this.rowHeight = undefined;\n        this.cellWidthType = undefined;\n        this.preferredCellWidthCheckBox = undefined;\n        this.preferredCellWidth = undefined;\n        this.tableTab = undefined;\n        this.rowTab = undefined;\n        this.cellTab = undefined;\n        this.left = undefined;\n        this.center = undefined;\n        this.right = undefined;\n        this.leftIndent = undefined;\n        this.allowRowBreak = undefined;\n        this.repeatHeader = undefined;\n        this.cellTopAlign = undefined;\n        this.cellCenterAlign = undefined;\n        this.cellBottomAlign = undefined;\n        this.tableFormat.destroy();\n        this.cellFormat.destroy();\n        this.tableFormat = undefined;\n        this.cellFormat = undefined;\n    };\n    return TablePropertiesDialog;\n}());\nexport { TablePropertiesDialog };\n","import { createElement, isNullOrUndefined, L10n, setCulture } from '@syncfusion/ej2-base';\nimport { NumericTextBox } from '@syncfusion/ej2-inputs';\nimport { WTableFormat, WBorder, WBorders, WShading, WCellFormat } from '../format/index';\nimport { DropDownList } from '@syncfusion/ej2-dropdowns';\nimport { ColorPicker } from '@syncfusion/ej2-inputs';\n/**\n * The Borders and Shading dialog is used to modify borders and shading options for selected table or cells.\n */\nvar BordersAndShadingDialog = /** @class */ (function () {\n    /**\n     * @private\n     */\n    function BordersAndShadingDialog(viewer) {\n        var _this = this;\n        this.cellFormat = new WCellFormat();\n        this.tableFormat = new WTableFormat();\n        this.applyBordersShadingsProperties = function () {\n            var tablePropertiesDialog = _this.owner.owner.tablePropertiesDialogModule;\n            var selectedCell = _this.owner.selection.start.paragraph.associatedCell;\n            //Need to bind the properties with current cell and current table formats.\n            var borders = undefined;\n            if (_this.checkClassName(_this.previewDivTopTop) || _this.checkClassName(_this.previewDivTopBottom)\n                || _this.checkClassName(_this.previewDivTopCenter) || _this.checkClassName(_this.previewDivBottomcenter)\n                || _this.checkClassName(_this.previewDivBottomLeft) || _this.checkClassName(_this.previewDivBottomRight)\n                || _this.checkClassName(_this.previewDivDiagonalRight) || _this.checkClassName(_this.previewDivLeftDiagonal)) {\n                borders = new WBorders();\n                if (_this.checkClassName(_this.previewDivTopTop)) {\n                    borders.top = _this.getBorder();\n                }\n                if (_this.checkClassName(_this.previewDivTopBottom)) {\n                    borders.bottom = _this.getBorder();\n                }\n                if (_this.checkClassName(_this.previewDivBottomLeft)) {\n                    borders.left = _this.getBorder();\n                }\n                if (_this.checkClassName(_this.previewDivBottomRight)) {\n                    borders.right = _this.getBorder();\n                }\n                if (_this.checkClassName(_this.previewDivTopCenter)) {\n                    borders.horizontal = _this.getBorder();\n                }\n                if (_this.checkClassName(_this.previewDivBottomcenter)) {\n                    borders.vertical = _this.getBorder();\n                }\n                if (_this.checkClassName(_this.previewDivLeftDiagonal)) {\n                    borders.diagonalDown = _this.getBorder();\n                }\n                if (_this.checkClassName(_this.previewDivDiagonalRight)) {\n                    borders.diagonalUp = _this.getBorder();\n                }\n            }\n            var shading = new WShading();\n            var editorModule = _this.owner.owner.editorModule;\n            shading.backgroundColor = _this.shadingColorPicker.value;\n            if (_this.ulelementShading.index === 0) {\n                _this.applyTo = 0;\n                if (tablePropertiesDialog) {\n                    tablePropertiesDialog.isCellBordersAndShadingUpdated = true;\n                }\n                _this.cellFormat.borders = new WBorders();\n                if (!isNullOrUndefined(borders)) {\n                    editorModule.applyBordersInternal(_this.cellFormat.borders, borders);\n                }\n                else if (_this.noneDiv.classList.contains('e-de-table-border-inside-setting-click')) {\n                    editorModule.applyBordersInternal(_this.cellFormat.borders, new WBorders());\n                }\n                // Once option has been added for texture and foreground, need to handle this similar to Shading Fill.\n                if (!isNullOrUndefined(selectedCell.cellFormat.shading)) {\n                    shading.foregroundColor = selectedCell.cellFormat.shading.foregroundColor;\n                    shading.textureStyle = selectedCell.cellFormat.shading.textureStyle;\n                }\n                _this.cellFormat.shading = new WShading();\n                editorModule.applyShading(_this.cellFormat.shading, shading);\n            }\n            else {\n                if (tablePropertiesDialog) {\n                    tablePropertiesDialog.isTableBordersAndShadingUpdated = true;\n                }\n                _this.applyTo = 1;\n                var currentTableFormat = _this.owner.owner.selection.tableFormat.table.tableFormat;\n                _this.tableFormat.copyFormat(currentTableFormat);\n                _this.tableFormat.borders = new WBorders();\n                if (!isNullOrUndefined(borders)) {\n                    editorModule.applyBordersInternal(_this.tableFormat.borders, borders);\n                }\n                else if (_this.noneDiv.classList.contains('e-de-table-border-inside-setting-click')) {\n                    editorModule.applyBordersInternal(_this.tableFormat.borders, new WBorders());\n                }\n                // Once option has been added for texture and foreground, need to handle this similar to Shading Fill.\n                if (!isNullOrUndefined(currentTableFormat.shading)) {\n                    shading.foregroundColor = currentTableFormat.shading.foregroundColor;\n                    shading.textureStyle = currentTableFormat.shading.textureStyle;\n                }\n                _this.tableFormat.shading = new WShading();\n                editorModule.applyShading(_this.tableFormat.shading, shading);\n            }\n            _this.applyFormat();\n            _this.closeDialog();\n        };\n        /**\n         * @private\n         */\n        this.closeDialog = function () {\n            _this.owner.dialog.hide();\n            _this.closeBordersShadingsDialog();\n        };\n        this.closeBordersShadingsDialog = function () {\n            _this.owner.dialog2.element.style.pointerEvents = '';\n            _this.owner.updateFocus();\n        };\n        this.handleSettingCheckBoxAction = function (event) {\n            var targetId = event.target.id;\n            var tableBorderDialogId = _this.target.id;\n            var targetDiv;\n            if (targetId === tableBorderDialogId + '_None_Div' || targetId === tableBorderDialogId + '_None_Div_Container'\n                || targetId === tableBorderDialogId + '_None_Div_Transparent') {\n                _this.updateClassForSettingDivElements();\n                _this.noneDiv.classList.add('e-de-table-border-inside-setting-click');\n                _this.setSettingPreviewDivElement('none');\n            }\n            else if (targetId === tableBorderDialogId + '_Box_Div' || targetId === tableBorderDialogId + '_Box_Div_Container'\n                || targetId === tableBorderDialogId + '_Box_Div_Transparent') {\n                _this.updateClassForSettingDivElements();\n                _this.boxDiv.classList.add('e-de-table-border-inside-setting-click');\n                _this.setSettingPreviewDivElement('box');\n            }\n            else if (targetId === tableBorderDialogId + '_All_Div' || targetId === tableBorderDialogId + '_All_Div_Container'\n                || targetId === tableBorderDialogId + '_All_Div_Transparent') {\n                _this.updateClassForSettingDivElements();\n                _this.allDiv.classList.add('e-de-table-border-inside-setting-click');\n                _this.setSettingPreviewDivElement('all');\n            }\n            else {\n                _this.updateClassForSettingDivElements();\n                _this.customDiv.classList.add('e-de-table-border-inside-setting-click');\n                _this.setSettingPreviewDivElement('customDiv');\n            }\n        };\n        this.handlePreviewCheckBoxAction = function (event) {\n            var target = event.target;\n            var targetId = target.id;\n            var tableBorderDialog = _this.target;\n            var tableBorderDialogId = _this.target.id;\n            var checkBox;\n            var compareClass = 'e-de-table-border-inside-preview-click';\n            _this.customDiv.click();\n            if (targetId === tableBorderDialogId + '_Preview_Div_TopTop_Container' || targetId === tableBorderDialogId + '_Preview_Div_TopTop'\n                || targetId === tableBorderDialogId + '_previewDivTopTopTransParent') {\n                _this.handlePreviewCheckBoxShowHide(tableBorderDialogId, compareClass, _this.previewDivTopTop);\n                _this.showHidePreviewDivElements(tableBorderDialogId, compareClass, '_Preview_Div', '_Preview_Div_TopTop', 'TopTop');\n            }\n            else if (targetId === tableBorderDialogId + '_Preview_Div_TopCenter_Container'\n                || targetId === tableBorderDialogId + '_Preview_Div_TopCenter'\n                || targetId === tableBorderDialogId + '_previewDivTopCenterTransParent') {\n                _this.handlePreviewCheckBoxShowHide(tableBorderDialogId, compareClass, _this.previewDivTopCenter);\n                // tslint:disable-next-line:max-line-length\n                _this.showHidePreviewDivElements(tableBorderDialogId, compareClass, '_Preview_Div_Horizontal', '_Preview_Div_TopCenter', 'TopCenter');\n            }\n            else if (targetId === tableBorderDialogId + '_Preview_Div_TopBottom_Container' || targetId === tableBorderDialogId + '_Preview_Div_TopBottom'\n                || targetId === tableBorderDialogId + '_previewDivTopBottomTransParent') {\n                _this.handlePreviewCheckBoxShowHide(tableBorderDialogId, compareClass, _this.previewDivTopBottom);\n                _this.showHidePreviewDivElements(tableBorderDialogId, compareClass, '_Preview_Div', '_Preview_Div_TopBottom', 'TopBottom');\n            }\n            else if (targetId === tableBorderDialogId + '_Preview_Div_LeftDiagonal_Container'\n                || targetId === tableBorderDialogId + '_Preview_Div_LeftDiagonal'\n                || targetId === tableBorderDialogId + '_previewDivLeftDiagonalTransParent') {\n                _this.handlePreviewCheckBoxShowHide(tableBorderDialogId, compareClass, _this.previewDivLeftDiagonal);\n                // tslint:disable-next-line:max-line-length\n                _this.showHidePreviewDivElements(tableBorderDialogId, compareClass, '_Preview_Div_Left_Diagonal', '_Preview_Div_LeftDiagonal', 'LeftDiagonal');\n            }\n            else if (targetId === tableBorderDialogId + '_Preview_Div_BottomLeft_Container' || targetId === tableBorderDialogId + '_Preview_Div_BottomLeft'\n                || targetId === tableBorderDialogId + '_previewDivBottomLeftTransparent') {\n                _this.handlePreviewCheckBoxShowHide(tableBorderDialogId, compareClass, _this.previewDivBottomLeft);\n                _this.showHidePreviewDivElements(tableBorderDialogId, compareClass, '_Preview_Div', '_Preview_Div_BottomLeft', 'BottomLeft');\n            }\n            else if (targetId === tableBorderDialogId + '_Preview_Div_BottomCenter_Container'\n                || targetId === tableBorderDialogId + '_Preview_Div_BottomCenter'\n                || targetId === tableBorderDialogId + '_previewDivBottomcenterTransparent') {\n                _this.handlePreviewCheckBoxShowHide(tableBorderDialogId, compareClass, _this.previewDivBottomcenter);\n                // tslint:disable-next-line:max-line-length\n                _this.showHidePreviewDivElements(tableBorderDialogId, compareClass, '_Preview_Div_Vertical', '_Preview_Div_BottomCenter', 'BottomCenter');\n            }\n            else if (targetId === tableBorderDialogId + '_Preview_Div_BottomRight_Container' || targetId === tableBorderDialogId + '_Preview_Div_BottomRight'\n                || targetId === tableBorderDialogId + '_previewDivBottomRightTransparent') {\n                _this.handlePreviewCheckBoxShowHide(tableBorderDialogId, compareClass, _this.previewDivBottomRight);\n                _this.showHidePreviewDivElements(tableBorderDialogId, compareClass, '_Preview_Div', '_Preview_Div_BottomRight', 'BottomRight');\n            }\n            else if (targetId === tableBorderDialogId + '_Preview_Div_RightDiagonal_Container'\n                || targetId === tableBorderDialogId + '_Preview_Div_RightDiagonal'\n                || targetId === tableBorderDialogId + '_previewDivDiagonalRightTransparent') {\n                _this.handlePreviewCheckBoxShowHide(tableBorderDialogId, compareClass, _this.previewDivDiagonalRight);\n                // tslint:disable-next-line:max-line-length\n                _this.showHidePreviewDivElements(tableBorderDialogId, compareClass, '_Preview_Div_Right_Diagonal', '_Preview_Div_RightDiagonal', 'RightDiagonal');\n            }\n        };\n        this.applyTableCellPreviewBoxes = function () {\n            _this.customDiv.click();\n            if (!isNullOrUndefined(_this.ulelementShading)) {\n                if (_this.ulelementShading.index === 0) {\n                    _this.previewDivBottomcenterContainer.style.display = 'none';\n                    _this.previewDivTopCenterContainer.style.display = 'none';\n                    _this.previewVerticalDiv.style.display = 'none';\n                    _this.previewHorizontalDiv.style.display = 'none';\n                    _this.previewDivLeftDiagonal.style.display = '';\n                    _this.previewDivDiagonalRight.style.display = '';\n                    _this.previewDivBottomRightContainer.style.left = '80px';\n                }\n                else {\n                    _this.previewDivLeftDiagonal.style.display = 'none';\n                    _this.previewDivDiagonalRight.style.display = 'none';\n                    _this.previewDivBottomcenterContainer.style.display = '';\n                    _this.previewDivTopCenterContainer.style.display = '';\n                    _this.previewVerticalDiv.style.display = '';\n                    _this.previewHorizontalDiv.style.display = '';\n                    _this.previewDivBottomRightContainer.style.left = '110px';\n                }\n            }\n        };\n        this.applyPreviewTableBackgroundColor = function (args) {\n            if (!isNullOrUndefined(args.currentValue)) {\n                var color = args.currentValue.hex;\n                _this.previewDiv.style.backgroundColor = color;\n            }\n        };\n        this.applyPreviewTableBorderColor = function (args) {\n            if (!isNullOrUndefined(args.currentValue)) {\n                var color = args.currentValue.hex;\n                _this.previewDiv.style.borderColor = color;\n                _this.previewRightDiagonalDiv.style.backgroundColor = color;\n                _this.previewLeftDiagonalDiv.style.backgroundColor = color;\n                _this.previewVerticalDiv.style.backgroundColor = color;\n                _this.previewHorizontalDiv.style.backgroundColor = color;\n            }\n        };\n        this.owner = viewer;\n    }\n    BordersAndShadingDialog.prototype.getModuleName = function () {\n        return 'BordersAndShadingDialog';\n    };\n    /**\n     * @private\n     */\n    // tslint:disable-next-line:max-func-body-length\n    BordersAndShadingDialog.prototype.initBordersAndShadingsDialog = function (localeValue) {\n        var instance = this;\n        this.target = createElement('div', {\n            id: instance.owner.owner.containerId + '_table_border_shadings',\n            className: 'e-de-table-border-shading-dlg'\n        });\n        this.owner.owner.element.appendChild(this.target);\n        var displayText = createElement('div', {\n            innerHTML: localeValue.getConstant('Borders'), styles: 'position: absolute;top: 65px;',\n            id: this.target.id + '_border_label', className: 'e-de-table-border-heading'\n        });\n        var settingsContiner = createElement('div', {\n            styles: 'display: inline-block;position: absolute;top: 105px;width: 100px;height: 235px;border-style: none;',\n            id: this.target.id + '_border_settings'\n        });\n        var styleContainer = createElement('div', {\n            // tslint:disable-next-line:max-line-length\n            styles: 'display: inline-block;position: absolute;left: 125px;top: 125px;width: 150px;height: 235px;padding-left: 40px;border-style: none;padding-right: 40px;',\n            id: this.target.id + '_border_style'\n        });\n        var previewContiner = createElement('div', {\n            // tslint:disable-next-line:max-line-length\n            styles: 'display: inline-block;position: absolute;left: 345px;top: 87px;width: 180px;height: 235px;padding: 0px;border-style: none;',\n            id: this.target.id + '_border_preview'\n        });\n        var styleText = createElement('div', {\n            innerHTML: localeValue.getConstant('Style'), styles: 'width: 100%;padding-bottom: 10px;',\n            className: 'e-de-table-element-subheading'\n        });\n        var dropDownList = createElement('select', {\n            id: this.target.id + '_border_style_dropDown'\n        });\n        dropDownList.innerHTML = '<option>' + localeValue.getConstant('None') + '</option><option>'\n            + localeValue.getConstant('Single') + '</option><option>' + localeValue.getConstant('Dot') + '</option><option>'\n            + localeValue.getConstant('DashSmallGap') + '</option><option>' + localeValue.getConstant('DashLargeGap') + '</option><option>'\n            + localeValue.getConstant('DashDot') + '</option><option>' + localeValue.getConstant('DashDotDot') + '</option><option>'\n            + localeValue.getConstant('Double') + '</option><option>' + localeValue.getConstant('Triple') + '</option><option>'\n            + localeValue.getConstant('ThinThickSmallGap') + '</option><option>'\n            + localeValue.getConstant('ThickThinSmallGap') + '</option><option>' + localeValue.getConstant('ThinThickThinSmallGap')\n            + '</option><option>' + localeValue.getConstant('ThinThickMediumGap') + '</option><option>'\n            + localeValue.getConstant('ThickThinMediumGap') + '</option><option>' + localeValue.getConstant('ThinThickThinMediumGap')\n            + '</option><option>' + localeValue.getConstant('ThinThickLargeGap') + '</option><option>'\n            + localeValue.getConstant('ThickThinLargeGap') + '</option><option>' + localeValue.getConstant('ThinThickThinLargeGap')\n            + '</option><option>' + localeValue.getConstant('SingleWavy') + '</option><option>'\n            + localeValue.getConstant('DoubleWavy') + '</option><option>' + localeValue.getConstant('DashDotStroked')\n            + '</option><option>' + localeValue.getConstant('Emboss3D') + '</option><option>' + localeValue.getConstant('Engrave3D')\n            + '</option><option>' + localeValue.getConstant('Outset') + '</option><option>'\n            + localeValue.getConstant('Inset') + '</option><option>' + localeValue.getConstant('Thick') + '</option>';\n        var widthText = createElement('div', {\n            innerHTML: localeValue.getConstant('Width'), styles: 'width:100%;padding-top: 20px;padding-bottom: 10px;',\n            className: 'e-de-table-element-subheading'\n        });\n        var widthNumeric = createElement('input', {\n            id: this.target.id + '_width'\n        });\n        var colorText = createElement('div', {\n            innerHTML: localeValue.getConstant('Color'), styles: 'padding-top: 25px;',\n            className: 'e-de-table-setting-heading'\n        });\n        var borderColorPickerElement = createElement('input', {\n            attrs: { 'type': 'color' },\n            id: this.target.id + '_border_color',\n            styles: 'width: 30px;position: absolute;left: 90px;',\n            className: 'e-dlg-clr-pkr-top'\n        });\n        var settingText = createElement('div', {\n            innerHTML: localeValue.getConstant('Setting'), styles: 'width: 100%;position: absolute;',\n            className: 'e-de-table-setting-heading'\n        });\n        var noneDivContainer = createElement('div', {\n            id: this.target.id + '_None_Div_Container', className: 'e-de-table-border-none'\n        });\n        this.noneDiv = createElement('div', {\n            id: this.target.id + '_None_Div',\n            className: 'e-de-table-border-inside-setting e-de-table-border-setting-genral'\n        });\n        var noneDivLabel = createElement('label', {\n            innerHTML: localeValue.getConstant('None'), className: 'e-de-table-setting-labels-heading',\n            styles: 'padding-left: 10px;top: 20px;position: absolute;',\n            id: this.target.id + '_None_Div_Label'\n        });\n        var boxDivContainer = createElement('div', {\n            id: this.target.id + '_Box_Div_Container', className: 'e-de-table-border-box'\n        });\n        this.boxDiv = createElement('div', {\n            id: this.target.id + '_Box_Div',\n            className: 'e-de-table-border-inside-setting e-de-table-border-setting-genral'\n        });\n        var boxDivLabel = createElement('label', {\n            innerHTML: localeValue.getConstant('Box'), className: 'e-de-table-setting-labels-heading',\n            styles: 'padding-left: 10px;top: 20px;position: absolute;',\n            id: this.target.id + '_Box_Div_Label'\n        });\n        var allDivContainer = createElement('div', {\n            id: this.target.id + '_All_Div_Container', className: 'e-de-table-border-all'\n        });\n        this.allDiv = createElement('div', {\n            id: this.target.id + '_All_Div',\n            className: 'e-de-table-border-inside-setting e-de-table-border-setting-genral'\n        });\n        var allDivLabel = createElement('label', {\n            innerHTML: localeValue.getConstant('All'), className: 'e-de-table-setting-labels-heading',\n            styles: 'padding-left: 10px;top: 25px;position: absolute;',\n            id: this.target.id + '_All_Div_Label'\n        });\n        var customDivContainer = createElement('div', {\n            id: this.target.id + '_Custom_Div_Container', className: 'e-de-table-border-custom'\n        });\n        this.customDiv = createElement('div', {\n            id: this.target.id + '_Custom_Div',\n            className: 'e-de-table-border-inside-setting e-de-table-border-setting-genral'\n        });\n        var customDivLabel = createElement('label', {\n            innerHTML: localeValue.getConstant('Custom'), className: 'e-de-table-setting-labels-heading',\n            styles: 'padding-left: 10px;top: 25px;position: absolute;',\n            id: this.target.id + '_Custom_Div_Label'\n        });\n        this.noneDivTransparent = createElement('div', {\n            id: this.target.id + '_None_Div_Transparent', className: 'e-icons e-de-table-border-setting e-de-table-border-none-setting'\n        });\n        this.boxDivTransparent = createElement('div', {\n            id: this.target.id + '_Box_Div_Transparent', className: 'e-icons e-de-table-border-setting e-de-table-border-box-setting'\n        });\n        this.allDivTransparent = createElement('div', {\n            id: this.target.id + '_All_Div_Transparent', className: 'e-icons e-de-table-border-setting e-de-table-border-all-setting'\n        });\n        this.customDivTransparent = createElement('div', {\n            id: this.target.id + '_Custom_Div_Transparent', className: 'e-icons e-de-table-border-setting e-de-table-border-custom-setting'\n        });\n        var previewText = createElement('div', {\n            innerHTML: localeValue.getConstant('Preview'), className: 'e-de-table-setting-heading',\n            styles: 'position: absolute;top: 20px;left: 10px;'\n        });\n        this.previewDiv = createElement('div', {\n            styles: 'width: 80px;height: 80px;position: absolute; left: 50px;top: 50px;',\n            id: this.target.id + '_Preview_Div', className: 'e-de-border-dlg-preview-div'\n        });\n        this.previewRightDiagonalDiv = createElement('div', {\n            styles: 'position: absolute;width:1px;height:113px;left: 90px;top: 34px;transform: rotate(135deg);',\n            id: this.target.id + '_Preview_Div_Right_Diagonal',\n            className: 'e-de-border-dlg-preview-inside-divs'\n        });\n        this.previewLeftDiagonalDiv = createElement('div', {\n            styles: 'position: absolute;width: 1px;height: 113px;left: 90px;top: 34px;transform:rotate(45deg);',\n            id: this.target.id + '_Preview_Div_Left_Diagonal',\n            className: 'e-de-border-dlg-preview-inside-divs'\n        });\n        this.previewVerticalDiv = createElement('div', {\n            styles: 'width: 1px;height: 81px;position: absolute;left: 90px;top: 50px;',\n            id: this.target.id + '_Preview_Div_Vertical',\n            className: 'e-de-border-dlg-preview-inside-divs'\n        });\n        this.previewHorizontalDiv = createElement('div', {\n            styles: 'width: 81px;height: 1px;position: absolute;left: 50px;top: 90px;',\n            id: this.target.id + '_Preview_Div_Horizontal',\n            className: 'e-de-border-dlg-preview-inside-divs'\n        });\n        this.previewDivTopTopContainer = createElement('div', {\n            styles: 'top: 50px;position: absolute;left: 10px;', id: this.target.id + '_Preview_Div_TopTop_Container'\n        });\n        this.previewDivTopTop = createElement('div', {\n            id: this.target.id + '_Preview_Div_TopTop',\n            className: 'e-de-table-border-inside-preview e-de-table-border-preview-genral'\n        });\n        this.previewDivTopCenterContainer = createElement('div', {\n            styles: 'top: 80px;position: absolute;left: 10px;', id: this.target.id + '_Preview_Div_TopCenter_Container'\n        });\n        this.previewDivTopCenter = createElement('div', {\n            id: this.target.id + '_Preview_Div_TopCenter',\n            className: 'e-de-table-border-inside-preview e-de-table-border-preview-genral'\n        });\n        this.previewDivTopBottomContainer = createElement('div', {\n            styles: 'top: 110px;position: absolute;left: 10px;', id: this.target.id + '_Preview_Div_TopBottom_Container'\n        });\n        this.previewDivTopBottom = createElement('div', {\n            id: this.target.id + '_Preview_Div_TopBottom',\n            className: 'e-de-table-border-inside-preview e-de-table-border-preview-genral'\n        });\n        this.previewDivLeftDiagonalContainer = createElement('div', {\n            styles: 'top: 145px;position: absolute;left: 10px;', id: this.target.id + '_Preview_Div_LeftDiagonal_Container'\n        });\n        this.previewDivLeftDiagonal = createElement('div', {\n            id: this.target.id + '_Preview_Div_LeftDiagonal',\n            className: 'e-de-table-border-inside-preview e-de-table-border-preview-genral'\n        });\n        this.previewDivBottomLeftContainer = createElement('div', {\n            styles: 'top: 145px;position: absolute;left: 50px', id: this.target.id + '_Preview_Div_BottomLeft_Container'\n        });\n        this.previewDivBottomLeft = createElement('div', {\n            id: this.target.id + '_Preview_Div_BottomLeft',\n            className: 'e-de-table-border-inside-preview e-de-table-border-preview-genral'\n        });\n        this.previewDivBottomcenterContainer = createElement('div', {\n            styles: 'top: 145px;position: absolute;left: 80px;', id: this.target.id + '_Preview_Div_BottomCenter_Container'\n        });\n        this.previewDivBottomcenter = createElement('div', {\n            id: this.target.id + '_Preview_Div_BottomCenter',\n            className: 'e-de-table-border-inside-preview e-de-table-border-preview-genral'\n        });\n        this.previewDivBottomRightContainer = createElement('div', {\n            styles: 'top: 145px;position: absolute;left: 110px;', id: this.target.id + '_Preview_Div_BottomRight_Container'\n        });\n        this.previewDivBottomRight = createElement('div', {\n            id: this.target.id + '_Preview_Div_BottomRight',\n            className: 'e-de-table-border-inside-preview e-de-table-border-preview-genral'\n        });\n        this.previewDivDiagonalRightContainer = createElement('div', {\n            styles: 'top: 145px; position: absolute; left: 110px;', id: this.target.id + '_Preview_Div_RightDiagonal_Container'\n        });\n        this.previewDivDiagonalRight = createElement('div', {\n            id: this.target.id + '_Preview_Div_RightDiagonal',\n            className: 'e-de-table-border-inside-preview e-de-table-border-preview-genral'\n        });\n        this.previewDivTopTopTransParent = createElement('div', {\n            id: this.target.id + '_previewDivTopTopTransParent',\n            className: 'e-icons e-de-table-border-preview e-de-table-border-toptop-alignment'\n        });\n        this.previewDivTopCenterTransParent = createElement('div', {\n            id: this.target.id + '_previewDivTopCenterTransParent',\n            className: 'e-icons e-de-table-border-preview e-de-table-border-topcenter-alignment'\n        });\n        this.previewDivTopBottomTransParent = createElement('div', {\n            id: this.target.id + '_previewDivTopBottomTransParent',\n            className: 'e-icons e-de-table-border-preview e-de-table-border-topbottom-alignment'\n        });\n        this.previewDivLeftDiagonalTransParent = createElement('div', {\n            id: this.target.id + '_previewDivLeftDiagonalTransParent',\n            className: 'e-icons e-de-table-border-preview e-de-table-border-diagionalup-alignment'\n        });\n        this.previewDivBottomLeftTransparent = createElement('div', {\n            id: this.target.id + '_previewDivBottomLeftTransparent',\n            className: 'e-icons e-de-table-border-preview e-de-table-border-bottomleft-alignment'\n        });\n        this.previewDivBottomcenterTransparent = createElement('div', {\n            id: this.target.id + '_previewDivBottomcenterTransparent',\n            className: 'e-icons e-de-table-border-preview e-de-table-border-bottomcenter-alignment'\n        });\n        this.previewDivBottomRightTransparent = createElement('div', {\n            id: this.target.id + '_previewDivBottomRightTransparent',\n            className: 'e-icons e-de-table-border-preview e-de-table-border-bottomright-alignment'\n        });\n        this.previewDivDiagonalRightTransparent = createElement('div', {\n            id: this.target.id + '_previewDivDiagonalRightTransparent',\n            className: 'e-icons e-de-table-border-preview e-de-table-border-diagionaldown-alignment'\n        });\n        this.shadingContiner = createElement('div', {\n            /* tslint:disable:max-line-length */\n            styles: 'display:inline-block;position:absolute;left:17px;width:400px;height:100px;padding:0px;border-style: none;margin-left:10px;',\n            id: this.target.id + '_shading_preview', className: 'e-de-table-shading-preview'\n        });\n        var shadingText = createElement('div', {\n            innerHTML: localeValue.getConstant('Shading'), className: 'e-de-table-border-heading',\n            styles: 'padding-top: 30px;left: 5px;'\n        });\n        var shadings = createElement('div', { styles: 'display:flex;' });\n        var label = createElement('div', {\n            innerHTML: localeValue.getConstant('Fill'), className: 'e-de-table-setting-heading e-de-table-border-fill',\n            styles: 'top: 50px;left: 10px;'\n        });\n        var shadingColorPickerElement = createElement('input', {\n            attrs: { 'type': 'color' },\n            id: this.target.id + '_shading_color', styles: 'position: absolute;top: 75px;left: 40px;width: 30px;'\n        });\n        var shdApply = createElement('div', {\n            styles: 'position:absolute;top:41px;left:150px;width:180px;'\n        });\n        var div = createElement('div', {\n            styles: 'width:100px;padding-bottom: 10px;', innerHTML: localeValue.getConstant('Apply To'),\n            className: 'e-de-table-element-subheading'\n        });\n        var divsion = createElement('div', { styles: 'width:100px;position:absolute;' });\n        var ulelementShading = createElement('select', {\n            innerHTML: '<option>' + localeValue.getConstant('Cell') + '</option>'\n                + '<option>' + localeValue.getConstant('Table') + '</option>',\n            id: this.target.id + '_shading'\n        });\n        divsion.appendChild(ulelementShading);\n        this.noneDiv.appendChild(this.noneDivTransparent);\n        this.boxDiv.appendChild(this.boxDivTransparent);\n        this.allDiv.appendChild(this.allDivTransparent);\n        this.customDiv.appendChild(this.customDivTransparent);\n        noneDivContainer.appendChild(this.noneDiv);\n        noneDivContainer.appendChild(noneDivLabel);\n        boxDivContainer.appendChild(this.boxDiv);\n        boxDivContainer.appendChild(boxDivLabel);\n        allDivContainer.appendChild(this.allDiv);\n        allDivContainer.appendChild(allDivLabel);\n        customDivContainer.appendChild(this.customDiv);\n        customDivContainer.appendChild(customDivLabel);\n        settingsContiner.appendChild(settingText);\n        settingsContiner.appendChild(noneDivContainer);\n        settingsContiner.appendChild(boxDivContainer);\n        settingsContiner.appendChild(allDivContainer);\n        settingsContiner.appendChild(customDivContainer);\n        this.previewDivBottomcenter.appendChild(this.previewDivBottomcenterTransparent);\n        this.previewDivBottomRight.appendChild(this.previewDivBottomRightTransparent);\n        this.previewDivBottomLeft.appendChild(this.previewDivBottomLeftTransparent);\n        this.previewDivTopTop.appendChild(this.previewDivTopTopTransParent);\n        this.previewDivTopCenter.appendChild(this.previewDivTopCenterTransParent);\n        this.previewDivTopBottom.appendChild(this.previewDivTopBottomTransParent);\n        this.previewDivDiagonalRight.appendChild(this.previewDivDiagonalRightTransparent);\n        this.previewDivLeftDiagonal.appendChild(this.previewDivLeftDiagonalTransParent);\n        this.previewDivBottomcenterContainer.appendChild(this.previewDivBottomcenter);\n        this.previewDivBottomLeftContainer.appendChild(this.previewDivBottomLeft);\n        this.previewDivBottomRightContainer.appendChild(this.previewDivBottomRight);\n        this.previewDivDiagonalRightContainer.appendChild(this.previewDivDiagonalRight);\n        this.previewDivLeftDiagonalContainer.appendChild(this.previewDivLeftDiagonal);\n        this.previewDivTopBottomContainer.appendChild(this.previewDivTopBottom);\n        this.previewDivTopCenterContainer.appendChild(this.previewDivTopCenter);\n        this.previewDivTopTopContainer.appendChild(this.previewDivTopTop);\n        previewContiner.appendChild(previewText);\n        previewContiner.appendChild(this.previewDiv);\n        previewContiner.appendChild(this.previewRightDiagonalDiv);\n        previewContiner.appendChild(this.previewHorizontalDiv);\n        previewContiner.appendChild(this.previewLeftDiagonalDiv);\n        previewContiner.appendChild(this.previewVerticalDiv);\n        previewContiner.appendChild(this.previewDivBottomcenterContainer);\n        previewContiner.appendChild(this.previewDivBottomLeftContainer);\n        previewContiner.appendChild(this.previewDivBottomRightContainer);\n        previewContiner.appendChild(this.previewDivDiagonalRightContainer);\n        previewContiner.appendChild(this.previewDivLeftDiagonalContainer);\n        previewContiner.appendChild(this.previewDivTopBottomContainer);\n        previewContiner.appendChild(this.previewDivTopCenterContainer);\n        previewContiner.appendChild(this.previewDivTopTopContainer);\n        shdApply.appendChild(div);\n        shdApply.appendChild(divsion);\n        shadings.appendChild(label);\n        shadings.appendChild(shadingColorPickerElement);\n        shadings.appendChild(shdApply);\n        this.shadingContiner.appendChild(shadingText);\n        this.shadingContiner.appendChild(shadings);\n        styleContainer.appendChild(styleText);\n        styleContainer.appendChild(dropDownList);\n        styleContainer.appendChild(widthText);\n        styleContainer.appendChild(widthNumeric);\n        styleContainer.appendChild(colorText);\n        styleContainer.appendChild(borderColorPickerElement);\n        this.target.appendChild(displayText);\n        this.target.appendChild(settingsContiner);\n        this.target.appendChild(styleContainer);\n        this.target.appendChild(previewContiner);\n        this.target.appendChild(this.shadingContiner);\n        // Handling Setting Container\n        noneDivContainer.addEventListener('click', this.handleSettingCheckBoxAction);\n        boxDivContainer.addEventListener('click', this.handleSettingCheckBoxAction);\n        allDivContainer.addEventListener('click', this.handleSettingCheckBoxAction);\n        customDivContainer.addEventListener('click', this.handleSettingCheckBoxAction);\n        // Handling Preview Div Container\n        this.previewDivBottomcenterContainer.addEventListener('click', this.handlePreviewCheckBoxAction);\n        this.previewDivBottomLeftContainer.addEventListener('click', this.handlePreviewCheckBoxAction);\n        this.previewDivBottomRightContainer.addEventListener('click', this.handlePreviewCheckBoxAction);\n        this.previewDivTopTopContainer.addEventListener('click', this.handlePreviewCheckBoxAction);\n        this.previewDivTopBottomContainer.addEventListener('click', this.handlePreviewCheckBoxAction);\n        this.previewDivTopCenterContainer.addEventListener('click', this.handlePreviewCheckBoxAction);\n        this.previewDivDiagonalRightContainer.addEventListener('click', this.handlePreviewCheckBoxAction);\n        this.previewDivLeftDiagonalContainer.addEventListener('click', this.handlePreviewCheckBoxAction);\n        // handling dropdown change\n        this.borderWidth = new NumericTextBox({\n            value: 0, min: 0, max: 6, decimals: 2,\n            width: 150, enablePersistence: false\n        });\n        this.borderWidth.appendTo(widthNumeric);\n        this.borderStyle = new DropDownList({\n            width: '150px', popupHeight: '150px', index: 1\n        });\n        this.borderStyle.appendTo(dropDownList);\n        this.ulelementShading = new DropDownList({\n            width: '150px', change: this.applyTableCellPreviewBoxes, index: 1\n        });\n        this.ulelementShading.appendTo(ulelementShading);\n        this.borderColorPicker = new ColorPicker({\n            value: '#000000', change: this.applyPreviewTableBorderColor\n        });\n        this.borderColorPicker.appendTo(borderColorPickerElement);\n        this.shadingColorPicker = new ColorPicker({\n            value: '#000000', change: this.applyPreviewTableBackgroundColor\n        });\n        this.shadingColorPicker.appendTo(shadingColorPickerElement);\n    };\n    BordersAndShadingDialog.prototype.applyFormat = function () {\n        var selection = this.owner.selection;\n        var editorModule = this.owner.owner.editorModule;\n        editorModule.initComplexHistory('BordersAndShading');\n        editorModule.isBordersAndShadingDialog = true;\n        if (this.applyTo === 0) {\n            editorModule.onCellFormat(this.cellFormat);\n        }\n        else {\n            editorModule.onTableFormat(this.tableFormat);\n        }\n        if (!isNullOrUndefined(this.owner.owner.editorHistory.currentHistoryInfo)) {\n            this.owner.owner.editorHistory.updateComplexHistory();\n        }\n        editorModule.isBordersAndShadingDialog = false;\n    };\n    BordersAndShadingDialog.prototype.getBorder = function () {\n        var border = new WBorder();\n        border.color = this.borderColorPicker.value;\n        border.lineStyle = this.borderStyle.text;\n        border.lineWidth = this.borderWidth.value;\n        return border;\n    };\n    BordersAndShadingDialog.prototype.checkClassName = function (element) {\n        return element.classList.contains('e-de-table-border-inside-preview-click');\n    };\n    /**\n     * @private\n     */\n    BordersAndShadingDialog.prototype.show = function () {\n        var localeValue = new L10n('documenteditor', this.owner.owner.defaultLocale);\n        localeValue.setLocale(this.owner.owner.locale);\n        setCulture(this.owner.owner.locale);\n        if (!this.target) {\n            this.initBordersAndShadingsDialog(localeValue);\n        }\n        this.loadBordersShadingsPropertiesDialog();\n        this.owner.dialog.content = this.target;\n        this.owner.dialog.header = localeValue.getConstant('Borders and Shading');\n        this.owner.dialog.beforeOpen = this.owner.updateFocus;\n        this.owner.dialog.close = this.closeBordersShadingsDialog;\n        this.owner.dialog.position = { X: 'center', Y: 'top' };\n        this.owner.dialog.width = 'auto';\n        this.owner.dialog.height = 'auto';\n        this.owner.dialog.buttons = [{\n                click: this.applyBordersShadingsProperties,\n                buttonModel: { content: localeValue.getConstant('Ok'), cssClass: 'e-flat e-table-border-shading-okay', isPrimary: true }\n            },\n            {\n                click: this.closeDialog,\n                buttonModel: { content: localeValue.getConstant('Cancel'), cssClass: 'e-flat e-table-border-shading-cancel' }\n            }];\n        this.owner.dialog.dataBind();\n        this.owner.dialog.show();\n    };\n    BordersAndShadingDialog.prototype.updateClassForSettingDivElements = function () {\n        var settingDivs = this.target.getElementsByClassName('e-de-table-border-inside-setting');\n        for (var j = 0; j < settingDivs.length; j++) {\n            if (settingDivs[j].className.indexOf('e-de-table-border-inside-setting-click') !== -1) {\n                var tempClassName = settingDivs[j].className;\n                tempClassName = tempClassName.replace('e-de-table-border-inside-setting-click', '');\n                settingDivs[j].className = tempClassName;\n            }\n        }\n    };\n    BordersAndShadingDialog.prototype.setSettingPreviewDivElement = function (position) {\n        switch (position) {\n            case 'none':\n                this.previewDivTopTop.classList.remove('e-de-table-border-inside-preview-click');\n                this.previewDivTopCenter.classList.remove('e-de-table-border-inside-preview-click');\n                this.previewDivTopBottom.classList.remove('e-de-table-border-inside-preview-click');\n                this.previewDivLeftDiagonal.classList.remove('e-de-table-border-inside-preview-click');\n                this.previewDivDiagonalRight.classList.remove('e-de-table-border-inside-preview-click');\n                this.previewDivBottomRight.classList.remove('e-de-table-border-inside-preview-click');\n                this.previewDivBottomLeft.classList.remove('e-de-table-border-inside-preview-click');\n                this.previewDivBottomcenter.classList.remove('e-de-table-border-inside-preview-click');\n                this.isShowHidePreviewTableElements('none');\n                break;\n            case 'box':\n                this.previewDivTopCenter.classList.remove('e-de-table-border-inside-preview-click');\n                this.previewDivLeftDiagonal.classList.remove('e-de-table-border-inside-preview-click');\n                this.previewDivDiagonalRight.classList.remove('e-de-table-border-inside-preview-click');\n                this.previewDivBottomcenter.classList.remove('e-de-table-border-inside-preview-click');\n                this.previewDivTopTop.classList.add('e-de-table-border-inside-preview-click');\n                this.previewDivTopBottom.classList.add('e-de-table-border-inside-preview-click');\n                this.previewDivBottomRight.classList.add('e-de-table-border-inside-preview-click');\n                this.previewDivBottomLeft.classList.add('e-de-table-border-inside-preview-click');\n                this.isShowHidePreviewTableElements('box');\n                break;\n            case 'all':\n                this.previewDivLeftDiagonal.classList.remove('e-de-table-border-inside-preview-click');\n                this.previewDivDiagonalRight.classList.remove('e-de-table-border-inside-preview-click');\n                this.previewDivBottomcenter.classList.add('e-de-table-border-inside-preview-click');\n                this.previewDivTopTop.classList.add('e-de-table-border-inside-preview-click');\n                this.previewDivTopBottom.classList.add('e-de-table-border-inside-preview-click');\n                this.previewDivBottomRight.classList.add('e-de-table-border-inside-preview-click');\n                this.previewDivBottomLeft.classList.add('e-de-table-border-inside-preview-click');\n                this.previewDivTopCenter.classList.add('e-de-table-border-inside-preview-click');\n                this.isShowHidePreviewTableElements('all');\n                break;\n        }\n    };\n    BordersAndShadingDialog.prototype.isShowHidePreviewTableElements = function (settingDiv) {\n        switch (settingDiv) {\n            case 'none':\n                this.previewDiv.style.border = 'none';\n                this.previewRightDiagonalDiv.style.display = 'none';\n                this.previewLeftDiagonalDiv.style.display = 'none';\n                this.previewHorizontalDiv.style.display = 'none';\n                this.previewVerticalDiv.style.display = 'none';\n                break;\n            case 'box':\n                this.previewDiv.style.border = '1px solid rgba(0, 0, 0, .54)';\n                this.previewRightDiagonalDiv.style.display = 'none';\n                this.previewLeftDiagonalDiv.style.display = 'none';\n                this.previewHorizontalDiv.style.display = 'none';\n                this.previewVerticalDiv.style.display = 'none';\n                break;\n            case 'all':\n                this.previewDiv.style.border = '1px solid rgba(0, 0, 0, .54)';\n                this.previewRightDiagonalDiv.style.display = 'none';\n                this.previewLeftDiagonalDiv.style.display = 'none';\n                this.previewHorizontalDiv.style.display = 'block';\n                this.previewVerticalDiv.style.display = 'block';\n                break;\n        }\n    };\n    BordersAndShadingDialog.prototype.handlePreviewCheckBoxShowHide = function (tableBorderDialogId, compareClass, element) {\n        if (element.classList.contains(compareClass)) {\n            element.classList.remove(compareClass);\n        }\n        else {\n            element.classList.add(compareClass);\n        }\n    };\n    // tslint:disable-next-line:max-line-length\n    BordersAndShadingDialog.prototype.showHidePreviewDivElements = function (tableBorderDialogId, compareClass, elementClass, compareElementClass, position) {\n        var setElement = document.getElementById(tableBorderDialogId + elementClass);\n        var compareElement = document.getElementById(tableBorderDialogId + compareElementClass);\n        if (position === 'TopTop') {\n            this.setPropertyPreviewDivElement(setElement, compareElement, compareClass, 'border-top');\n        }\n        else if (position === 'TopCenter') {\n            this.setPropertyPreviewDivElement(setElement, compareElement, compareClass, 'display');\n        }\n        else if (position === 'TopBottom') {\n            this.setPropertyPreviewDivElement(setElement, compareElement, compareClass, 'border-bottom');\n        }\n        else if (position === 'LeftDiagonal') {\n            this.setPropertyPreviewDivElement(setElement, compareElement, compareClass, 'display');\n        }\n        else if (position === 'BottomLeft') {\n            this.setPropertyPreviewDivElement(setElement, compareElement, compareClass, 'border-left');\n        }\n        else if (position === 'BottomCenter') {\n            this.setPropertyPreviewDivElement(setElement, compareElement, compareClass, 'display');\n        }\n        else if (position === 'BottomRight') {\n            this.setPropertyPreviewDivElement(setElement, compareElement, compareClass, 'border-right');\n        }\n        else if (position === 'RightDiagonal') {\n            this.setPropertyPreviewDivElement(setElement, compareElement, compareClass, 'display');\n        }\n    };\n    BordersAndShadingDialog.prototype.setPropertyPreviewDivElement = function (ele, compareElement, compareClass, property) {\n        if (compareElement.classList.contains(compareClass) && property.split('-')[0] === 'border') {\n            /* tslint:disable:no-any */\n            ele.style[property] = '1px solid rgba(0, 0, 0, .54)';\n        }\n        else if (compareElement.classList.contains(compareClass) && property === 'display') {\n            ele.style[property] = 'block';\n        }\n        else {\n            ele.style[property] = 'none';\n            /* tslint:enable:no-any */\n        }\n    };\n    BordersAndShadingDialog.prototype.loadBordersShadingsPropertiesDialog = function () {\n        var tableFormat = this.owner.selection.tableFormat.table.tableFormat;\n        var lineStyle;\n        var borderColor;\n        var fillColor;\n        var borderWidth;\n        if (!isNullOrUndefined(tableFormat) && !isNullOrUndefined(tableFormat.borders)) {\n            this.cloneBorders(tableFormat.borders);\n            if (isNullOrUndefined(tableFormat.borders) || isNullOrUndefined(tableFormat.borders.top)) {\n                lineStyle = 1;\n                borderColor = '#000000';\n                borderWidth = 0;\n                fillColor = '#000000';\n            }\n            else {\n                lineStyle = this.getLineStyle(tableFormat.borders.top.lineStyle);\n                borderColor = tableFormat.borders.top.color;\n                borderWidth = tableFormat.borders.top.getLineWidth();\n                fillColor = tableFormat.shading.backgroundColor;\n            }\n        }\n        this.borderColorPicker.value = borderColor;\n        this.shadingColorPicker.value = fillColor;\n        /* tslint:disable:no-any */\n        var colorPickerEvent = {\n            target: this.borderColorPicker, ctrlKey: false,\n            shiftKey: false, which: 0\n        };\n        var fillColorEvent = {\n            target: this.shadingColorPicker, ctrlKey: false,\n            shiftKey: false, which: 0\n        };\n        /* tslint:enable:no-any */\n        this.applyPreviewTableBackgroundColor(fillColorEvent);\n        this.applyPreviewTableBorderColor(colorPickerEvent);\n        this.ulelementShading.index = 1;\n        this.previewDivLeftDiagonal.style.display = 'none';\n        this.previewDivDiagonalRight.style.display = 'none';\n        this.borderWidth.value = borderWidth;\n        this.borderStyle.index = lineStyle;\n    };\n    // tslint:disable:max-func-body-length\n    BordersAndShadingDialog.prototype.cloneBorders = function (borders) {\n        var topBorder = false;\n        var bottomBorder = false;\n        var leftBorder = false;\n        var rightBorder = false;\n        var horizontalBorder = false;\n        var verticalBorder = false;\n        var diagonalDownBorder = false;\n        var customBorder = false;\n        var diagonalUpBorder = false;\n        if (borders !== null) {\n            if (borders.top && (borders.top.hasNoneStyle || borders.top.lineStyle !== 'None')) {\n                topBorder = true;\n            }\n            if (borders.bottom && (borders.bottom.hasNoneStyle || borders.bottom.lineStyle !== 'None')) {\n                bottomBorder = true;\n            }\n            if (borders.left && (borders.left.hasNoneStyle || borders.left.lineStyle !== 'None')) {\n                leftBorder = true;\n            }\n            if (borders.right && (borders.right.hasNoneStyle || borders.right.lineStyle !== 'None')) {\n                rightBorder = true;\n            }\n            if (borders.horizontal && (borders.horizontal.hasNoneStyle || borders.horizontal.lineStyle !== 'None')) {\n                horizontalBorder = true;\n            }\n            if (borders.vertical && (borders.vertical.hasNoneStyle || borders.vertical.lineStyle !== 'None')) {\n                verticalBorder = true;\n            }\n            if (borders.diagonalDown && (borders.diagonalDown.hasNoneStyle || borders.diagonalDown.lineStyle !== 'None')) {\n                diagonalDownBorder = true;\n            }\n            if (borders.diagonalUp && (borders.diagonalUp.hasNoneStyle || borders.diagonalUp.lineStyle !== 'None')) {\n                diagonalUpBorder = true;\n            }\n            if (!(!topBorder || !bottomBorder || !leftBorder || !rightBorder)) {\n                if (!(!topBorder || !bottomBorder || !leftBorder || !rightBorder || !horizontalBorder\n                    || !verticalBorder || diagonalUpBorder || diagonalDownBorder)) {\n                    if ((topBorder && bottomBorder && leftBorder && rightBorder && horizontalBorder && verticalBorder\n                        && !diagonalUpBorder && !diagonalDownBorder)) {\n                        if (borders.top.hasNoneStyle && borders.bottom.hasNoneStyle && borders.left.hasNoneStyle\n                            && borders.right.hasNoneStyle && borders.horizontal.hasNoneStyle && borders.vertical.hasNoneStyle) {\n                            this.setSettingPreviewDivElement('none');\n                            this.customDiv.classList.remove('e-de-table-border-inside-setting-click');\n                            this.noneDiv.classList.add('e-de-table-border-inside-setting-click');\n                            this.boxDiv.classList.remove('e-de-table-border-inside-setting-click');\n                            this.allDiv.classList.remove('e-de-table-border-inside-setting-click');\n                        }\n                        else {\n                            this.setSettingPreviewDivElement('all');\n                            this.allDiv.classList.add('e-de-table-border-inside-setting-click');\n                            this.customDiv.classList.remove('e-de-table-border-inside-setting-click');\n                            this.noneDiv.classList.remove('e-de-table-border-inside-setting-click');\n                            this.boxDiv.classList.remove('e-de-table-border-inside-setting-click');\n                        }\n                    }\n                }\n                else if ((leftBorder && bottomBorder && topBorder && rightBorder && !horizontalBorder && !verticalBorder)) {\n                    if (borders.top.hasNoneStyle && borders.bottom.hasNoneStyle && borders.left.hasNoneStyle\n                        && borders.right.hasNoneStyle && borders.horizontal.hasNoneStyle && borders.vertical.hasNoneStyle) {\n                        this.setSettingPreviewDivElement('none');\n                        this.boxDiv.classList.remove('e-de-table-border-inside-setting-click');\n                        this.allDiv.classList.remove('e-de-table-border-inside-setting-click');\n                        this.customDiv.classList.remove('e-de-table-border-inside-setting-click');\n                        this.noneDiv.classList.add('e-de-table-border-inside-setting-click');\n                    }\n                    else {\n                        this.setSettingPreviewDivElement('box');\n                        this.customDiv.classList.remove('e-de-table-border-inside-setting-click');\n                        this.noneDiv.classList.remove('e-de-table-border-inside-setting-click');\n                        this.boxDiv.classList.add('e-de-table-border-inside-setting-click');\n                        this.allDiv.classList.remove('e-de-table-border-inside-setting-click');\n                    }\n                }\n                else {\n                    customBorder = true;\n                }\n            }\n            else {\n                customBorder = true;\n            }\n            this.previewDivLeftDiagonal.classList.remove('e-de-table-border-inside-preview-click');\n            this.previewDivDiagonalRight.classList.remove('e-de-table-border-inside-preview-click');\n            if (customBorder) {\n                this.customDiv.classList.add('e-de-table-border-inside-setting-click');\n                this.noneDiv.classList.remove('e-de-table-border-inside-setting-click');\n                this.boxDiv.classList.remove('e-de-table-border-inside-setting-click');\n                this.allDiv.classList.remove('e-de-table-border-inside-setting-click');\n                if (topBorder) {\n                    this.previewDivTopTop.classList.add('e-de-table-border-inside-preview-click');\n                }\n                else {\n                    this.previewDivTopTop.classList.remove('e-de-table-border-inside-preview-click');\n                }\n                if (bottomBorder) {\n                    this.previewDivTopBottom.classList.add('e-de-table-border-inside-preview-click');\n                }\n                else {\n                    this.previewDivTopBottom.classList.remove('e-de-table-border-inside-preview-click');\n                }\n                if (leftBorder) {\n                    this.previewDivBottomLeft.classList.add('e-de-table-border-inside-preview-click');\n                }\n                else {\n                    this.previewDivBottomLeft.classList.remove('e-de-table-border-inside-preview-click');\n                }\n                if (rightBorder) {\n                    this.previewDivBottomRight.classList.add('e-de-table-border-inside-preview-click');\n                }\n                else {\n                    this.previewDivBottomRight.classList.remove('e-de-table-border-inside-preview-click');\n                }\n                if (verticalBorder) {\n                    this.previewDivBottomcenter.classList.add('e-de-table-border-inside-preview-click');\n                }\n                else {\n                    this.previewDivBottomcenter.classList.remove('e-de-table-border-inside-preview-click');\n                }\n                if (horizontalBorder) {\n                    this.previewDivTopCenter.classList.add('e-de-table-border-inside-preview-click');\n                }\n                else {\n                    this.previewDivTopCenter.classList.remove('e-de-table-border-inside-preview-click');\n                }\n            }\n        }\n    };\n    BordersAndShadingDialog.prototype.getLineStyle = function (lineStyle) {\n        switch (lineStyle) {\n            case 'Single': return 1;\n            case 'Dot': return 2;\n            case 'DashSmallGap': return 3;\n            case 'DashLargeGap': return 4;\n            case 'DashDot': return 5;\n            case 'DashDotDot': return 6;\n            case 'Double': return 7;\n            case 'Triple': return 8;\n            case 'ThinThickSmallGap': return 9;\n            case 'ThickThinSmallGap': return 10;\n            case 'ThinThickThinSmallGap': return 11;\n            case 'ThinThickMediumGap': return 12;\n            case 'ThickThinMediumGap': return 13;\n            case 'ThinThickThinMediumGap': return 14;\n            case 'ThinThickLargeGap': return 15;\n            case 'ThickThinLargeGap': return 16;\n            case 'ThinThickThinLargeGap': return 17;\n            case 'SingleWavy': return 18;\n            case 'DoubleWavy': return 19;\n            case 'DashDotStroked': return 20;\n            case 'Emboss3D': return 21;\n            case 'Engrave3D': return 22;\n            case 'Outset': return 23;\n            case 'Inset': return 24;\n            case 'Thick': return 25;\n        }\n        return 0;\n    };\n    /**\n     * @private\n     */\n    BordersAndShadingDialog.prototype.destroy = function () {\n        if (!isNullOrUndefined(this.target)) {\n            if (this.target.parentElement) {\n                this.target.parentElement.removeChild(this.target);\n            }\n            for (var k = 0; k < this.target.childNodes.length; k++) {\n                this.target.removeChild(this.target.childNodes[k]);\n                k--;\n            }\n            this.target = undefined;\n        }\n        if (this.cellFormat) {\n            this.cellFormat.destroy();\n            this.cellFormat = undefined;\n        }\n        if (this.tableFormat) {\n            this.tableFormat.destroy();\n            this.tableFormat = undefined;\n        }\n        this.dialog = undefined;\n        this.target = undefined;\n        if (!isNullOrUndefined(this.borderStyle)) {\n            this.borderStyle.destroy();\n        }\n        this.borderStyle = undefined;\n        if (!isNullOrUndefined(this.borderColorPicker)) {\n            this.borderColorPicker.destroy();\n        }\n        this.borderColorPicker = undefined;\n        if (!isNullOrUndefined(this.shadingColorPicker)) {\n            this.shadingColorPicker.destroy();\n        }\n        this.shadingColorPicker = undefined;\n        if (!isNullOrUndefined(this.ulelementShading)) {\n            this.ulelementShading.destroy();\n        }\n        this.ulelementShading = undefined;\n        this.noneDivTransparent = undefined;\n        this.boxDivTransparent = undefined;\n        this.allDivTransparent = undefined;\n        this.customDivTransparent = undefined;\n        this.previewDiv = undefined;\n        this.previewRightDiagonalDiv = undefined;\n        this.previewLeftDiagonalDiv = undefined;\n        this.previewVerticalDiv = undefined;\n        this.previewHorizontalDiv = undefined;\n        this.previewDivTopTopContainer = undefined;\n        this.previewDivTopTop = undefined;\n        this.previewDivTopCenterContainer = undefined;\n        this.previewDivTopCenter = undefined;\n        this.previewDivTopBottomContainer = undefined;\n        this.previewDivTopBottom = undefined;\n        this.previewDivLeftDiagonalContainer = undefined;\n        this.previewDivLeftDiagonal = undefined;\n        this.previewDivBottomLeftContainer = undefined;\n        this.previewDivBottomLeft = undefined;\n        this.previewDivBottomcenterContainer = undefined;\n        this.previewDivBottomcenter = undefined;\n        this.previewDivBottomRightContainer = undefined;\n        this.previewDivBottomRight = undefined;\n        this.previewDivDiagonalRightContainer = undefined;\n        this.previewDivDiagonalRight = undefined;\n        this.previewDivTopTopTransParent = undefined;\n        this.previewDivTopCenterTransParent = undefined;\n        this.previewDivTopBottomTransParent = undefined;\n        this.previewDivLeftDiagonalTransParent = undefined;\n        this.previewDivBottomLeftTransparent = undefined;\n        this.previewDivBottomcenterTransparent = undefined;\n        this.previewDivBottomRightTransparent = undefined;\n        this.previewDivDiagonalRightTransparent = undefined;\n        this.shadingContiner = undefined;\n        this.noneDiv = undefined;\n        this.customDiv = undefined;\n        this.allDiv = undefined;\n        this.boxDiv = undefined;\n    };\n    return BordersAndShadingDialog;\n}());\nexport { BordersAndShadingDialog };\n","import { CheckBox } from '@syncfusion/ej2-buttons';\nimport { NumericTextBox } from '@syncfusion/ej2-inputs';\nimport { WTableFormat } from '../index';\nimport { isNullOrUndefined, L10n, createElement, setCulture } from '@syncfusion/ej2-base';\nimport { CellOptionsDialog } from './index';\n/**\n * The Table options dialog is used to modify default cell margins and cell spacing of selected table.\n */\nvar TableOptionsDialog = /** @class */ (function () {\n    /**\n     * @private\n     */\n    function TableOptionsDialog(viewer) {\n        var _this = this;\n        /**\n         * @private\n         */\n        this.applyTableCellProperties = function () {\n            var tableFormat = _this.owner.selection.tableFormat;\n            if (!isNullOrUndefined(_this.bottomMarginBox.value || _this.leftMarginBox.value\n                || _this.rightMarginBox.value || _this.topMarginBox.value || _this.cellSpaceTextBox.value)\n                && (tableFormat.bottomMargin !== _this.bottomMarginBox.value\n                    || tableFormat.leftMargin !== _this.leftMarginBox.value\n                    || tableFormat.rightMargin !== _this.rightMarginBox.value\n                    || tableFormat.topMargin !== _this.topMarginBox.value\n                    || tableFormat.cellSpacing !== _this.cellSpaceTextBox.value)) {\n                _this.owner.owner.tablePropertiesDialogModule.isTableOptionsUpdated = true;\n                _this.applyTableOptions(_this.tableFormat);\n                _this.owner.owner.tablePropertiesDialogModule.applyTableSubProperties();\n            }\n            _this.closeCellMarginsDialog();\n        };\n        /**\n         * @private\n         */\n        this.closeCellMarginsDialog = function () {\n            _this.owner.dialog.hide();\n            _this.owner.dialog.element.style.pointerEvents = '';\n            _this.owner.updateFocus();\n        };\n        /**\n         * @private\n         */\n        this.changeAllowSpaceCheckBox = function () {\n            if (_this.allowSpaceCheckBox.checked) {\n                _this.cellSpaceTextBox.enabled = true;\n            }\n            else {\n                _this.cellSpaceTextBox.enabled = false;\n            }\n        };\n        /**\n         * @private\n         */\n        this.removeEvents = function () {\n            _this.owner.dialog2.element.style.pointerEvents = '';\n            _this.owner.updateFocus();\n        };\n        this.owner = viewer;\n    }\n    Object.defineProperty(TableOptionsDialog.prototype, \"tableFormat\", {\n        /**\n         * @private\n         */\n        get: function () {\n            if (isNullOrUndefined(this.tableFormatIn)) {\n                return this.tableFormatIn = new WTableFormat();\n            }\n            return this.tableFormatIn;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    /**\n     * @private\n     */\n    TableOptionsDialog.prototype.getModuleName = function () {\n        return 'TableOptionsDialog';\n    };\n    /**\n     * @private\n     */\n    TableOptionsDialog.prototype.initTableOptionsDialog = function (localValue) {\n        var instance = this.owner;\n        this.target = createElement('div', {\n            id: this.owner.owner.containerId + '_insertCellMarginsDialog', className: 'e-de-table-options-dlg'\n        });\n        this.owner.owner.element.appendChild(this.target);\n        var innerDiv = createElement('div', { styles: 'width: 475px;position: relative;height: 180px;' });\n        var innerDivLabel = createElement('Label', {\n            id: this.target.id + '_innerDivLabel', className: 'e-de-cell-dia-options-label',\n            innerHTML: localValue.getConstant('Default cell margins')\n        });\n        innerDiv.appendChild(innerDivLabel);\n        CellOptionsDialog.getCellMarginDialogElements(this, innerDiv, localValue);\n        var div = createElement('div', { styles: 'width: 475px; position: relative;' });\n        var cellSpaceLabel = createElement('Label', {\n            className: 'e-de-cell-dia-options-label',\n            id: this.target.id + '_cellSpaceLabel'\n        });\n        cellSpaceLabel.innerHTML = localValue.getConstant('Default cell spacing');\n        div.appendChild(cellSpaceLabel);\n        var table2 = createElement('TABLE', {\n            styles: 'height: 30px;padding-bottom: 15px;'\n        });\n        var tr3 = createElement('tr');\n        var td5 = createElement('td');\n        var allowSpaceCheckBox = createElement('input', {\n            attrs: { 'type': 'checkbox' }, id: this.target.id + '_cellcheck'\n        });\n        var td6 = createElement('td', { styles: 'padding-left: 15px;', });\n        this.cellspacingTextBox = createElement('input', {\n            attrs: { 'type': 'text' }, id: this.target.id + '_cellspacing'\n        });\n        td5.appendChild(allowSpaceCheckBox);\n        td6.appendChild(this.cellspacingTextBox);\n        tr3.appendChild(td5);\n        tr3.appendChild(td6);\n        table2.appendChild(tr3);\n        div.appendChild(table2);\n        var divBtn = document.createElement('div');\n        this.target.appendChild(div);\n        this.target.appendChild(divBtn);\n        this.cellSpaceTextBox = new NumericTextBox({\n            value: 0, min: 0, max: 264.5, width: 150,\n            decimals: 2, enablePersistence: false\n        });\n        this.cellSpaceTextBox.appendTo(this.cellspacingTextBox);\n        this.allowSpaceCheckBox = new CheckBox({\n            label: localValue.getConstant('Allow spacing between cells'),\n            change: this.changeAllowSpaceCheckBox,\n            cssClass: 'e-de-tbl-margin-sub-header',\n        });\n        this.allowSpaceCheckBox.appendTo(allowSpaceCheckBox);\n    };\n    /**\n     * @private\n     */\n    TableOptionsDialog.prototype.loadCellMarginsDialog = function () {\n        var tableFormat = this.owner.selection.tableFormat;\n        this.cellSpaceTextBox.value = tableFormat.cellSpacing;\n        this.bottomMarginBox.value = tableFormat.bottomMargin;\n        this.topMarginBox.value = tableFormat.topMargin;\n        this.rightMarginBox.value = tableFormat.rightMargin;\n        this.leftMarginBox.value = tableFormat.leftMargin;\n        if (tableFormat.cellSpacing > 0) {\n            this.allowSpaceCheckBox.checked = true;\n            this.cellSpaceTextBox.enabled = true;\n        }\n        else {\n            this.allowSpaceCheckBox.checked = false;\n            this.cellSpaceTextBox.enabled = false;\n        }\n    };\n    /**\n     * @private\n     */\n    TableOptionsDialog.prototype.applySubTableOptions = function (tableFormat) {\n        this.owner.owner.editorHistory.initComplexHistory(this.owner.selection, 'TableMarginsSelection');\n        this.applyTableOptionsHistory(tableFormat);\n        if (!isNullOrUndefined(this.owner.owner.editorHistory.currentHistoryInfo)) {\n            this.owner.owner.editorHistory.updateComplexHistory();\n        }\n    };\n    /**\n     * @private\n     */\n    TableOptionsDialog.prototype.applyTableOptionsHelper = function (tableFormat) {\n        this.applySubTableOptionsHelper(tableFormat);\n    };\n    /**\n     * @private\n     */\n    TableOptionsDialog.prototype.applyTableOptionsHistory = function (tableFormat) {\n        this.owner.owner.editorModule.initHistory('TableOptions');\n        this.applySubTableOptionsHelper(tableFormat);\n    };\n    /**\n     * @private\n     */\n    TableOptionsDialog.prototype.applySubTableOptionsHelper = function (tableFormat) {\n        var ownerTable = this.owner.selection.start.currentWidget.paragraph.associatedCell.ownerTable;\n        ownerTable = ownerTable.combineWidget(this.owner);\n        var currentTableFormat = ownerTable.tableFormat;\n        if (!isNullOrUndefined(this.owner.owner.editorHistory.currentBaseHistoryInfo)) {\n            this.owner.owner.editorHistory.currentBaseHistoryInfo.addModifiedTableOptions(currentTableFormat);\n        }\n        currentTableFormat.cellSpacing = tableFormat.cellSpacing;\n        currentTableFormat.leftMargin = tableFormat.leftMargin;\n        currentTableFormat.topMargin = tableFormat.topMargin;\n        currentTableFormat.rightMargin = tableFormat.rightMargin;\n        currentTableFormat.bottomMargin = tableFormat.bottomMargin;\n        this.owner.owner.tablePropertiesDialogModule.calculateGridValue(ownerTable);\n    };\n    /**\n     * @private\n     */\n    TableOptionsDialog.prototype.applyTableOptions = function (tableFormat) {\n        tableFormat.leftMargin = this.leftMarginBox.value;\n        tableFormat.topMargin = this.topMarginBox.value;\n        tableFormat.bottomMargin = this.bottomMarginBox.value;\n        tableFormat.rightMargin = this.rightMarginBox.value;\n        if (this.allowSpaceCheckBox.checked) {\n            tableFormat.cellSpacing = this.cellSpaceTextBox.value;\n        }\n    };\n    /**\n     * @private\n     */\n    TableOptionsDialog.prototype.show = function () {\n        var documentLocale = new L10n('documenteditor', this.owner.owner.defaultLocale);\n        documentLocale.setLocale(this.owner.owner.locale);\n        setCulture(this.owner.owner.locale);\n        if (!this.target) {\n            this.initTableOptionsDialog(documentLocale);\n        }\n        this.loadCellMarginsDialog();\n        this.owner.dialog.header = documentLocale.getConstant('Table Options');\n        this.owner.dialog.content = this.target;\n        this.owner.dialog.beforeOpen = undefined;\n        this.owner.dialog.position = { X: 'center', Y: 'top' };\n        //  this.owner.dialog.cssClass = 'e-de-table-margin-size';\n        this.owner.dialog.height = 'auto';\n        this.owner.dialog.width = 'auto';\n        this.owner.dialog.open = undefined;\n        this.owner.dialog.beforeOpen = this.owner.updateFocus;\n        this.owner.dialog.close = this.removeEvents;\n        this.owner.dialog.buttons = [{\n                click: this.applyTableCellProperties,\n                buttonModel: { content: documentLocale.getConstant('Ok'), cssClass: 'e-flat e-table-cell-okay', isPrimary: true }\n            },\n            {\n                click: this.closeCellMarginsDialog,\n                buttonModel: { content: documentLocale.getConstant('Cancel'), cssClass: 'e-flat e-table-cell-cancel' }\n            }];\n        this.owner.dialog.dataBind();\n        this.owner.dialog.show();\n    };\n    /**\n     * @private\n     */\n    TableOptionsDialog.prototype.destroy = function () {\n        if (!isNullOrUndefined(this.target)) {\n            if (this.target.parentElement) {\n                this.target.parentElement.removeChild(this.target);\n            }\n            for (var p = 0; p < this.target.childNodes.length; p++) {\n                this.target.removeChild(this.target.childNodes[p]);\n                p--;\n            }\n            this.target = undefined;\n        }\n        this.dialog = undefined;\n        this.target = undefined;\n        this.owner = undefined;\n        this.cellspacingTextBox = undefined;\n        this.allowSpaceCheckBox = undefined;\n    };\n    return TableOptionsDialog;\n}());\nexport { TableOptionsDialog };\n","import { CheckBox } from '@syncfusion/ej2-buttons';\nimport { NumericTextBox } from '@syncfusion/ej2-inputs';\nimport { WCellFormat } from '../index';\nimport { isNullOrUndefined, L10n, createElement, setCulture } from '@syncfusion/ej2-base';\n/**\n * The Cell options dialog is used to modify margins of selected cells.\n */\nvar CellOptionsDialog = /** @class */ (function () {\n    /**\n     * @private\n     */\n    function CellOptionsDialog(viewer) {\n        var _this = this;\n        /**\n         * @private\n         */\n        this.removeEvents = function () {\n            _this.owner.dialog2.element.style.pointerEvents = '';\n            _this.owner.updateFocus();\n        };\n        /**\n         * @private\n         */\n        this.changeSameAsTable = function () {\n            if (_this.sameAsTableCheckBox.checked) {\n                _this.leftMarginBox.enabled = false;\n                _this.rightMarginBox.enabled = false;\n                _this.bottomMarginBox.enabled = false;\n                _this.topMarginBox.enabled = false;\n            }\n            else {\n                _this.leftMarginBox.enabled = true;\n                _this.rightMarginBox.enabled = true;\n                _this.bottomMarginBox.enabled = true;\n                _this.topMarginBox.enabled = true;\n            }\n        };\n        /**\n         * @private\n         */\n        this.applyTableCellProperties = function () {\n            var cellFormat = _this.owner.selection.cellFormat;\n            if (!isNullOrUndefined(_this.bottomMarginBox.value || _this.leftMarginBox.value\n                || _this.rightMarginBox.value || _this.topMarginBox.value) &&\n                (cellFormat.bottomMargin !== _this.bottomMarginBox.value || cellFormat.leftMargin !== _this.leftMarginBox.value\n                    || cellFormat.rightMargin !== _this.rightMarginBox.value || cellFormat.topMargin !== _this.topMarginBox.value)) {\n                _this.owner.owner.tablePropertiesDialogModule.isCellOptionsUpdated = true;\n                _this.applyTableOptions(_this.cellFormat);\n                _this.owner.owner.tablePropertiesDialogModule.applyTableSubProperties();\n            }\n            _this.closeCellMarginsDialog();\n        };\n        /**\n         * @private\n         */\n        this.closeCellMarginsDialog = function () {\n            _this.owner.dialog.hide();\n            _this.owner.dialog.element.style.pointerEvents = '';\n        };\n        this.owner = viewer;\n    }\n    Object.defineProperty(CellOptionsDialog.prototype, \"cellFormat\", {\n        /**\n         * @private\n         */\n        get: function () {\n            if (isNullOrUndefined(this.cellFormatIn)) {\n                return this.cellFormatIn = new WCellFormat();\n            }\n            return this.cellFormatIn;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    /**\n     * @private\n     */\n    CellOptionsDialog.prototype.getModuleName = function () {\n        return 'CellOptionsDialog';\n    };\n    /**\n     * @private\n     */\n    CellOptionsDialog.prototype.initCellMarginsDialog = function (localValue) {\n        var instance = this.owner;\n        this.target = createElement('div', {\n            id: this.owner.owner.containerId + '_tableCellMarginsDialog', className: 'e-de-table-cell-margin-dlg'\n        });\n        this.owner.owner.element.appendChild(this.target);\n        var innerDiv = createElement('div', { styles: 'width: 475px;position: relative;height: 165px;' });\n        var innerDivLabel = createElement('Label', {\n            className: 'e-de-cell-dia-options-label', id: this.target.id + '_innerDivLabel'\n        });\n        innerDivLabel.innerHTML = localValue.getConstant('Cell margins');\n        innerDiv.appendChild(innerDivLabel);\n        var table = createElement('TABLE', {\n            styles: 'height: 40px;padding-bottom: 0px;', className: 'e-de-cell-margin-top'\n        });\n        var tr = createElement('tr');\n        var td = createElement('td', { className: 'e-de-tbl-btn-seperator' });\n        var sameAsTableCheckBox = createElement('input', {\n            attrs: { 'type': 'checkbox' }, id: this.target.id + '_sameAsCheckBox'\n        });\n        td.appendChild(sameAsTableCheckBox);\n        tr.appendChild(td);\n        table.appendChild(tr);\n        innerDiv.appendChild(table);\n        CellOptionsDialog.getCellMarginDialogElements(this, innerDiv, localValue);\n        var divBtn = document.createElement('div');\n        this.target.appendChild(divBtn);\n        this.sameAsTableCheckBox = new CheckBox({\n            label: localValue.getConstant('Same as the whole table'),\n            change: this.changeSameAsTable\n        });\n        this.sameAsTableCheckBox.appendTo(sameAsTableCheckBox);\n        this.sameAsTableCheckBox.addEventListener('change', this.changeSameAsTable);\n    };\n    /**\n     * @private\n     */\n    CellOptionsDialog.prototype.show = function () {\n        var localizeValue = new L10n('documenteditor', this.owner.owner.defaultLocale);\n        localizeValue.setLocale(this.owner.owner.locale);\n        setCulture(this.owner.owner.locale);\n        if (!this.target) {\n            this.initCellMarginsDialog(localizeValue);\n        }\n        this.loadCellMarginsDialog();\n        this.owner.dialog.header = localizeValue.getConstant('Cell Options');\n        this.owner.dialog.position = { X: 'center', Y: 'top' };\n        this.owner.dialog.height = 'auto';\n        this.owner.dialog.width = 'auto';\n        this.owner.dialog.content = this.target;\n        this.owner.dialog.beforeOpen = undefined;\n        this.owner.dialog.open = undefined;\n        this.owner.dialog.close = this.removeEvents;\n        this.owner.dialog.buttons = [{\n                click: this.applyTableCellProperties,\n                buttonModel: { content: localizeValue.getConstant('Ok'), cssClass: 'e-flat e-table-cell-margin-okay', isPrimary: true }\n            },\n            {\n                click: this.closeCellMarginsDialog,\n                buttonModel: { content: localizeValue.getConstant('Cancel'), cssClass: 'e-flat e-table-cell-margin-cancel' }\n            }];\n        this.owner.dialog.show();\n    };\n    /**\n     * @private\n     */\n    CellOptionsDialog.prototype.loadCellMarginsDialog = function () {\n        var cellFormat = this.owner.selection.cellFormat;\n        this.sameAsTable = isNullOrUndefined(cellFormat.leftMargin || cellFormat.topMargin\n            || cellFormat.rightMargin || cellFormat.bottomMargin);\n        if (this.sameAsTable) {\n            var tableFormat = this.owner.selection.tableFormat;\n            this.loadCellProperties(tableFormat, false, true);\n        }\n        else {\n            this.loadCellProperties(cellFormat, true, false);\n        }\n    };\n    CellOptionsDialog.prototype.loadCellProperties = function (format, enableTextBox, enableCheckBox) {\n        this.leftMarginBox.value = format.leftMargin;\n        this.rightMarginBox.value = format.rightMargin;\n        this.topMarginBox.value = format.topMargin;\n        this.bottomMarginBox.value = format.bottomMargin;\n        this.leftMarginBox.enabled = enableTextBox;\n        this.rightMarginBox.enabled = enableTextBox;\n        this.topMarginBox.enabled = enableTextBox;\n        this.bottomMarginBox.enabled = enableTextBox;\n        this.sameAsTableCheckBox.checked = enableCheckBox;\n    };\n    /**\n     * @private\n     */\n    CellOptionsDialog.prototype.applySubCellOptions = function (cellFormat) {\n        this.owner.owner.editorHistory.initComplexHistory(this.owner.selection, 'CellMarginsSelection');\n        this.owner.owner.editorModule.initHistory('CellOptions');\n        /* tslint:disable:max-line-length */\n        var startTable = this.owner.selection.start.paragraph.associatedCell.ownerTable;\n        startTable = startTable.combineWidget(this.owner);\n        this.applyCellmarginsValue(this.owner.selection.start.paragraph.associatedCell.ownerRow.combineWidget(this.owner), this.owner.selection.start, this.owner.selection.end, cellFormat);\n        this.owner.owner.editorModule.reLayout(this.owner.selection, false);\n        if (!isNullOrUndefined(this.owner.owner.editorHistory.currentHistoryInfo)) {\n            this.owner.owner.editorHistory.updateComplexHistory();\n        }\n    };\n    /**\n     * @private\n     */\n    CellOptionsDialog.prototype.applyCellmarginsValue = function (row, start, end, cellFormat) {\n        this.applyCellMarginsInternal(row, cellFormat);\n        if (end.paragraph.associatedCell.ownerRow === row) {\n            return;\n        }\n        var newRow = row.nextWidget;\n        if (!isNullOrUndefined(newRow)) {\n            this.applyCellmarginsValue(newRow, start, end, cellFormat);\n        }\n    };\n    CellOptionsDialog.prototype.applyCellMarginsInternal = function (row, cellFormat) {\n        if (!isNullOrUndefined(this.owner.owner.editorHistory.currentBaseHistoryInfo)) {\n            var currentFormat = row.childWidgets[0].cellFormat;\n            /* tslint:disable:max-line-length */\n            cellFormat = this.owner.owner.editorHistory.currentBaseHistoryInfo.addModifiedCellOptions(currentFormat, cellFormat, row.ownerTable);\n        }\n        if (!isNullOrUndefined(cellFormat)) {\n            this.applyCellMarginsForCells(row, cellFormat);\n        }\n    };\n    /**\n     * @private\n     */\n    CellOptionsDialog.prototype.applyCellMarginsForCells = function (row, cellFormat) {\n        var rowCells = row.childWidgets;\n        this.iterateCells(rowCells, cellFormat);\n    };\n    /**\n     * @private\n     */\n    CellOptionsDialog.prototype.iterateCells = function (cells, cellFormat) {\n        for (var i = 0; i < cells.length; i++) {\n            this.applySubCellMargins(cells[i].cellFormat, cellFormat);\n        }\n        this.owner.owner.tablePropertiesDialogModule.calculateGridValue(cells[0].ownerTable);\n    };\n    /**\n     * @private\n     */\n    CellOptionsDialog.prototype.applySubCellMargins = function (sourceFormat, cellFormat) {\n        sourceFormat.leftMargin = cellFormat.leftMargin;\n        sourceFormat.topMargin = cellFormat.topMargin;\n        sourceFormat.rightMargin = cellFormat.rightMargin;\n        sourceFormat.bottomMargin = cellFormat.bottomMargin;\n    };\n    /**\n     * @private\n     */\n    CellOptionsDialog.prototype.applyTableOptions = function (cellFormat) {\n        if (!this.sameAsTableCheckBox.checked) {\n            cellFormat.leftMargin = this.leftMarginBox.value;\n            cellFormat.topMargin = this.topMarginBox.value;\n            cellFormat.bottomMargin = this.bottomMarginBox.value;\n            cellFormat.rightMargin = this.rightMarginBox.value;\n        }\n    };\n    /**\n     * @private\n     */\n    CellOptionsDialog.prototype.destroy = function () {\n        if (!isNullOrUndefined(this.target)) {\n            if (this.target.parentElement) {\n                this.target.parentElement.removeChild(this.target);\n            }\n            for (var y = 0; y < this.target.childNodes.length; y++) {\n                this.target.removeChild(this.target.childNodes[y]);\n                y--;\n            }\n            this.target = undefined;\n        }\n        this.dialog = undefined;\n        this.target = undefined;\n        this.owner = undefined;\n        this.sameAsTableCheckBox = undefined;\n    };\n    /**\n     * @private\n     */\n    CellOptionsDialog.getCellMarginDialogElements = function (dialog, div, locale) {\n        if (!isNullOrUndefined(dialog)) {\n            var table = createElement('TABLE', { className: 'e-de-cell-margin-top' });\n            var tr1 = createElement('tr', { styles: 'height: 50px;color:black;' });\n            var td1 = createElement('td');\n            var topLabel = createElement('label', {\n                innerHTML: locale.getConstant('Top'), className: 'e-de-cell-dia-label-common',\n                id: dialog.target.id + '_TopLabel'\n            });\n            var topTextBox = createElement('input', {\n                attrs: { 'type': 'text' }, styles: 'width:100%', id: dialog.target.id + '_Top'\n            });\n            td1.appendChild(topLabel);\n            td1.appendChild(topTextBox);\n            var td2 = createElement('td', { className: 'e-de-tbl-btn-seperator' });\n            var leftLabel = createElement('label', {\n                innerHTML: locale.getConstant('Left'), className: 'e-de-cell-dia-label-common',\n                id: dialog.target.id + '_leftLabel'\n            });\n            var leftTextBox = createElement('input', {\n                attrs: { 'type': 'text' },\n                styles: 'width:100%', id: dialog.target.id + '_left'\n            });\n            td2.appendChild(leftLabel);\n            td2.appendChild(leftTextBox);\n            tr1.appendChild(td1);\n            tr1.appendChild(td2);\n            var tr2 = createElement('tr', { styles: 'height: 50px;color:black;' });\n            var td3 = createElement('td', { styles: 'width:40%;' });\n            var bottomLabel = createElement('label', {\n                innerHTML: locale.getConstant('Bottom'),\n                className: 'e-de-cell-dia-label-common', id: dialog.target.id + '_bottomLabel'\n            });\n            var bottomTextBox = createElement('input', {\n                attrs: { 'type': 'text' },\n                styles: 'width:100%', id: dialog.target.id + '_bottom'\n            });\n            td3.appendChild(bottomLabel);\n            td3.appendChild(bottomTextBox);\n            var td4 = createElement('td', { styles: 'width:40%;' });\n            var rightLabel = createElement('label', {\n                innerHTML: locale.getConstant('Right'), id: dialog.target.id + '_rightLabel',\n                className: 'e-de-cell-dia-label-common'\n            });\n            var rightTextBox = createElement('input', {\n                attrs: { 'type': 'text' },\n                styles: 'width:100%', id: dialog.target.id + '_right'\n            });\n            td4.appendChild(rightLabel);\n            td4.appendChild(rightTextBox);\n            tr2.appendChild(td3);\n            tr2.appendChild(td4);\n            table.appendChild(tr1);\n            table.appendChild(tr2);\n            div.appendChild(table);\n            dialog.target.appendChild(div);\n            dialog.topMarginBox = new NumericTextBox({\n                value: 0, min: 0, max: 1584, width: 150, decimals: 2,\n                enablePersistence: false\n            });\n            dialog.topMarginBox.appendTo(topTextBox);\n            dialog.leftMarginBox = new NumericTextBox({\n                value: 0, min: 0, max: 1584, width: 150,\n                decimals: 2, enablePersistence: false\n            });\n            dialog.leftMarginBox.appendTo(leftTextBox);\n            dialog.bottomMarginBox = new NumericTextBox({\n                value: 0, min: 0, max: 1584, width: 150, decimals: 2,\n                enablePersistence: false\n            });\n            dialog.bottomMarginBox.appendTo(bottomTextBox);\n            dialog.rightMarginBox = new NumericTextBox({\n                value: 0, min: 0, max: 1584, width: 150,\n                decimals: 2, enablePersistence: false\n            });\n            dialog.rightMarginBox.appendTo(rightTextBox);\n        }\n    };\n    return CellOptionsDialog;\n}());\nexport { CellOptionsDialog };\n","import { ListView } from '@syncfusion/ej2-lists';\nimport { Button } from '@syncfusion/ej2-buttons';\nimport { createElement, L10n, setCulture } from '@syncfusion/ej2-base';\n/**\n * The Styles dialog is used to create or modify styles.\n */\nvar StylesDialog = /** @class */ (function () {\n    /**\n     * @private\n     */\n    function StylesDialog(viewer) {\n        var _this = this;\n        this.updateStyleNames = function () {\n            var collection = _this.owner.owner.viewer.styles.getStyleNames('Paragraph');\n            var defaultStyleNames = ['Normal', 'Heading 1', 'Heading 2', 'Heading 3', 'Heading 4', 'Heading 5', 'Heading 6'];\n            var finalList = collection.concat(defaultStyleNames).filter(function (v, i, a) { return a.indexOf(v) === i; });\n            return finalList;\n        };\n        this.modifyStyles = function () {\n            _this.owner.dialog.hide();\n            _this.owner.owner.styleDialogModule.show(_this.styleName, _this.localValue.getConstant('Modify Style'));\n        };\n        /* tslint:disable:no-any */\n        this.selectHandler = function (args) {\n            _this.styleName = args.text;\n        };\n        this.addNewStyles = function () {\n            _this.owner.dialog.hide();\n            _this.owner.owner.styleDialogModule.show();\n        };\n        this.owner = viewer;\n    }\n    /**\n     * @private\n     */\n    StylesDialog.prototype.getModuleName = function () {\n        return 'StylesDialog';\n    };\n    /**\n     * @private\n     */\n    StylesDialog.prototype.initStylesDialog = function (localValue, styles) {\n        var instance = this;\n        var id = this.owner.owner.containerId + '_insert_styles';\n        this.target = createElement('div', { id: id, className: 'e-de-styles' });\n        var headerValue = localValue.getConstant('Styles');\n        var dlgFields = createElement('div', { innerHTML: headerValue, className: 'e-styles-dlgfields' });\n        this.target.appendChild(dlgFields);\n        var commonDiv = createElement('div', { className: 'e-styles-common' });\n        this.target.appendChild(commonDiv);\n        var searchDiv = createElement('div', { className: 'e-styles-list' });\n        commonDiv.appendChild(searchDiv);\n        var listviewDiv = createElement('div', { className: 'e-styles-listViewDiv', id: 'styles_listview' });\n        searchDiv.appendChild(listviewDiv);\n        this.listviewInstance = new ListView({\n            dataSource: styles,\n            cssClass: 'e-styles-listview',\n        });\n        this.listviewInstance.appendTo(listviewDiv);\n        this.listviewInstance.addEventListener('select', this.selectHandler);\n        var buttonDiv = createElement('div', { className: 'e-styles-button' });\n        commonDiv.appendChild(buttonDiv);\n        var newButtonDiv = createElement('div', { className: 'e-styles-addbutton' });\n        buttonDiv.appendChild(newButtonDiv);\n        var newButtonElement = createElement('button', { innerHTML: localValue.getConstant('New'), id: 'new' });\n        newButtonDiv.appendChild(newButtonElement);\n        var newbutton = new Button({ cssClass: 'e-button-custom' });\n        newbutton.appendTo(newButtonElement);\n        newButtonElement.addEventListener('click', this.addNewStyles);\n        var modifybuttonDiv = createElement('div', { className: 'e-styles-addbutton' });\n        buttonDiv.appendChild(modifybuttonDiv);\n        var modifyButtonElement = createElement('button', { innerHTML: localValue.getConstant('Modify'), id: 'modify' });\n        modifybuttonDiv.appendChild(modifyButtonElement);\n        var addbutton = new Button({ cssClass: 'e-button-custom' });\n        addbutton.appendTo(modifyButtonElement);\n        modifyButtonElement.addEventListener('click', this.modifyStyles);\n    };\n    /**\n     * @private\n     */\n    StylesDialog.prototype.show = function () {\n        var styles = this.updateStyleNames();\n        var localValue = new L10n('documenteditor', this.owner.owner.defaultLocale);\n        localValue.setLocale(this.owner.owner.locale);\n        setCulture(this.owner.owner.locale);\n        this.localValue = localValue;\n        this.initStylesDialog(localValue, styles);\n        this.owner.dialog.content = this.target;\n        this.owner.dialog.beforeOpen = this.owner.updateFocus;\n        this.owner.dialog.close = this.owner.updateFocus;\n        this.owner.dialog.header = 'Styles';\n        this.owner.dialog.height = 'auto';\n        this.owner.dialog.width = 'auto';\n        this.owner.dialog.buttons = [{\n                click: this.hideObjects.bind(this),\n                buttonModel: { content: localValue.getConstant('Cancel'), cssClass: 'e-flat e-hyper-insert', isPrimary: true }\n            }];\n        this.owner.dialog.dataBind();\n        this.owner.dialog.show();\n    };\n    StylesDialog.prototype.hideObjects = function () {\n        this.owner.dialog.hide();\n    };\n    /**\n     * @private\n     */\n    StylesDialog.prototype.destroy = function () {\n        if (this.listviewInstance) {\n            this.listviewInstance.destroy();\n            this.listviewInstance = undefined;\n        }\n    };\n    return StylesDialog;\n}());\nexport { StylesDialog };\n"],"names":["Dictionary","this","keysInternal","valuesInternal","item","Object","defineProperty","prototype","get","length","enumerable","configurable","getItem","i","push","add","key","value","isNullOrUndefined","ReferenceError","indexOf","index","RangeError","set","remove","splice","containsKey","clear","destroy","undefined","WUniqueFormat","type","referenceCount","uniqueFormatType","propertiesHash","isEqual","source","property","modifiedValue","isBorderEqual","isCharacterFormatEqual","isParagraphFormatEqual","isCellFormatEqual","isShadingEqual","isRowFormatEqual","isListFormatEqual","isTableFormatEqual","isListLevelEqual","isSectionFormatEqual","isNotEqual","modifiedProperty","targetValue","propertyType","getPropertyType","sourceValue","getBorderPropertyType","getCharacterFormatPropertyType","getParaFormatPropertyType","getCellFormatPropertyType","getShadingPropertyType","getRowFormatType","getListFormatType","getTableFormatType","getListLevelType","getSectionFormatType","cloneItems","format","keys","mergeProperties","hash","cloneProperties","WUniqueFormats","items","addUniqueFormat","matchedFormat","updateUniqueFormat","uniqueFormat","__extends","extendStatics","setPrototypeOf","__proto__","Array","d","b","p","hasOwnProperty","__","constructor","create","__decorate","decorators","target","desc","c","arguments","r","getOwnPropertyDescriptor","Reflect","decorate","DocumentEditor","_super","options","element","_this","call","enableHeaderFooterIn","isShiftingEnabled","isLayoutEnabled","isPastingContent","parser","disableHistoryIn","findResultsList","documentName","tablePropertiesDialogModule","bordersAndShadingDialogModule","cellOptionsDialogModule","tableOptionsDialogModule","paragraphDialogModule","imageResizerModule","useCtrlClickToFollowHyperlink","pageOutline","enableCursorOnReadOnly","enableLocalPaste","defaultLocale","Table","Row","Cell","Ok","Cancel","Size","Preferred Width","Points","Percent","Measure in","Alignment","Left","Center","Right","Justify","Indent from left","Borders and Shading","Options","Specify height","At least","Exactly","Row height is","Allow row to break across pages","Repeat as header row at the top of each page","Vertical alignment","Top","Bottom","Default cell margins","Default cell spacing","Allow spacing between cells","Cell margins","Same as the whole table","Borders","None","Single","Dot","DashSmallGap","DashLargeGap","DashDot","DashDotDot","Double","Triple","ThinThickSmallGap","ThickThinSmallGap","ThinThickThinSmallGap","ThinThickMediumGap","ThickThinMediumGap","ThinThickThinMediumGap","ThinThickLargeGap","ThickThinLargeGap","ThinThickThinLargeGap","SingleWavy","DoubleWavy","DashDotStroked","Emboss3D","Engrave3D","Outset","Inset","Thick","Style","Width","Height","Letter","Tabloid","Legal","Statement","Executive","A3","A4","A5","B4","B5","Custom Size","Different odd and even","Different first page","From edge","Header","Footer","Margin","Paper","Layout","Orientation","Landscape","Portrait","Table Of Contents","Show page numbers","Right align page numbers","Nothing","Tab leader","Show levels","Use hyperlinks instead of page numbers","Build table of contents from","Styles","Available styles","TOC level","Heading","List Paragraph","Normal","Outline levels","Table entry fields","Modify","Color","Setting","Box","All","Custom","Preview","Shading","Fill","Apply To","Table Properties","Cell Options","Table Options","Insert Table","Number of columns","Number of rows","Text to display","Address","Insert Hyperlink","Edit Hyperlink","Insert","General","Indentation","Before text","Special","First line","Hanging","After text","By","Before","Line Spacing","After","At","Multiple","Spacing","Define new Multilevel list","List level","Choose level to modify","Level","Number format","Number style for this level","Enter formatting for number","Start at","Restart list after","Position","Text indent at","Aligned at","Follow number with","Tab character","Space","Arabic","UpRoman","LowRoman","UpLetter","LowLetter","Number","Leading zero","Bullet","Ordinal","Ordinal Text","For East","No Restart","Font","Font style","Underline style","Font color","Effects","Strikethrough","Superscript","Subscript","Double strikethrough","Regular","Bold","Italic","Cut","Copy","Paste","Hyperlink","Open Hyperlink","Copy Hyperlink","Remove Hyperlink","Paragraph","Merge Cells","Insert Above","Insert Below","Insert Left","Insert Right","Delete","Delete Table","Delete Row","Delete Column","File Name","Format Type","Save","Navigation","Results","Replace","Replace All","We replaced all","Find","No matches","All Done","Result","of","instances","with","Click to follow link","Continue Numbering","Bookmark name","Close","Restart At","Properties","Name","Style type","Style based on","Style for following paragraph","Formatting","Numbering and Bullets","Numbering","Update Field","Edit Field","Bookmark","Page Setup","No bookmarks found","Number format tooltip information","Format","Create New Style","Modify Style","New","Bullets","Use bookmarks","Table of Contents","viewer","PageLayoutViewer","SfdtReader","DocumentEditor_1","updateScrollBars","isDocumentLoaded","pages","selectionModule","editorModule","editorHistoryModule","searchModule","contextMenuModule","id","isDocumentLoadedIn","enableEditorHistory","selection","getDocumentStart","getDocumentEnd","isReadOnly","enableImageResizer","preRender","render","initializeComponents","openBlank","container","style","minHeight","minWidth","getModuleName","onPropertyChanged","model","oldProp","_i","_a","zoomFactor","localizeDialogs","optionsPaneModule","isOptionsPaneShow","showHideOptionsPane","locale","l10n","L10n","setLocale","setCulture","initOptionsPane","initParagraphDialog","pageSetupDialogModule","initPageSetupDialog","fontDialogModule","initFontDialog","hyperlinkDialogModule","initHyperlinkDialog","initContextMenu","listDialogModule","initListDialog","initTablePropertyDialog","initBordersAndShadingsDialog","initCellMarginsDialog","initTableOptionsDialog","tableDialogModule","initTableDialog","styleDialogModule","initStyleDialog","tableOfContentsDialogModule","initTableOfContentDialog","getPersistData","clearPreservedCollectionsInViewer","LayoutViewer","clearDocumentItems","getDocumentEditorElement","fireContentChange","eventArgs","trigger","fireDocumentChange","fireSelectionChange","isCompositionStart","Browser","isDevice","predictText","fireZoomFactorChange","fireViewChange","visiblePages","startPage","endPage","showParagraphDialog","paragraphFormat","isReadOnlyMode","show","showPageSetupDialog","showFontDialog","characterFormat","showCellOptionsDialog","showTableOptionsDialog","showTableDialog","showTableOfContentsDialog","showStyleDialog","showHyperlinkDialog","showBookmarkDialog","bookmarkDialogModule","showStylesDialog","stylesDialogModule","showListDialog","showTablePropertiesDialog","showBordersAndShadingDialog","requiredModules","modules","enablePrint","member","args","enableSfdtExport","enableWordExport","enableTextExport","enableSelection","enableEditor","enableSearch","enableContextMenu","enableOptionsPane","enableHyperlinkDialog","enableTableDialog","enableBookmarkDialog","enableTableOfContentsDialog","enablePageSetupDialog","enableStyleDialog","enableListDialog","enableParagraphDialog","enableFontDialog","enableTablePropertiesDialog","enableBordersAndShadingDialog","enableTableOptionsDialog","open","sfdtText","lists","abstractLists","styles","WStyles","onDocumentChanged","convertJsonToDocument","intializeDefaultStyles","scrollToPage","pageNumber","enableAllModules","Inject","Print","SfdtExport","WordExport","TextExport","Selection","Search","Editor","ImageResizer","EditorHistory","ContextMenu","OptionsPane","HyperlinkDialog","TableDialog","BookmarkDialog","TableOfContentsDialog","PageSetupDialog","StyleDialog","ListDialog","ParagraphDialog","BulletsAndNumberingDialog","FontDialog","TablePropertiesDialog","BordersAndShadingDialog","TableOptionsDialog","CellOptionsDialog","StylesDialog","resize","width","height","updateViewerSize","focusIn","updateFocus","fitPage","pageFitType","print","printWindow","Error","printModule","serialize","sfdtExportModule","save","fileName","formatType","wordExportModule","textExportModule","jsonString","blob","Blob","saveAsBlob","Promise","resolve","reject","section","BodyWidget","sectionFormat","WSectionFormat","paragraph","ParagraphWidget","WParagraphFormat","WCharacterFormat","childWidgets","containerWidget","sections","hfs","parseHeaderFooter","header","footer","evenHeader","evenFooter","firstPageHeader","firstPageFooter","headersFooters","findByName","baseStyle","listFormat","getStyleNames","styleType","getStyles","showDialog","dialogType","showOptionsPane","destroyDependentModules","classList","innerHTML","Property","Event","NotifyPropertyChanges","Component","navigator","userAgent","browserUserAgent","getPageHeight","getPageWidth","printElement","document","createElement","overflow","generatePrintContent","window","write","toString","close","focus","interval","setInterval","ready","clearInterval","htmlString","page","pageHeight","boundingRectangle","pageWidth","isPrinting","renderWidgets","canvasURL","pageCanvas","toDataURL","node","uniqueSectionFormat","ownerBase","getPropertyValue","setPropertyValue","uniqueSectionFormats","hasValue","getPropertyDefaultValue","initializeUniqueSectionFormat","propValue","uniqueSectionFormatTemp","addUniqueSectionFormat","copyFormat","history","isUndoing","isRedoing","updateUniqueSectionFormat","cloneFormat","WLevelOverride","overrideListLevel","levelNumber","startAt","WList","listId","sourceListId","abstractListId","abstractList","levelOverrides","getListLevel","levelOverride","getLevelOverride","levels","mergeList","list","WListFormat","uniqueListFormat","baseListStyle","basedOn","listLevelNumber","WParagraphStyle","initializeUniqueListFormat","uniqueListFormats","uniqueListFormatTemp","addUniqueListFormat","clearFormat","ApplyStyle","getValue","mergeFormat","WTabStop","positionIn","deletePositionIn","justification","leader","position","deletePosition","tabJustification","uniqueParagraphFormat","tabs","getUpdatedTabs","inTabs","tabStops","tab","_b","_c","hasTabStop","concat","filter","a","sort","getListFormatParagraphFormat","level","listLevel","ifListFormat","getDefaultValue","docParagraphFormat","documentParagraphFormat","bodyWidget","initializeUniqueParagraphFormat","uniqueParagraphFormats","uniqueParaFormatTemp","addUniqueParaFormat","updateUniqueParagraphFormat","leftIndent","rightIndent","firstLineIndent","beforeSpacing","afterSpacing","lineSpacing","lineSpacingType","textAlignment","outlineLevel","uniqueCharacterFormat","baseCharStyle","charStyleValue","checkCharacterStyle","baseStyleValue","checkBaseStyle","docCharacterFormat","documentCharacterFormat","name","returnPropertyType","initializeUniqueCharacterFormat","uniqueCharacterFormats","uniqueCharFormatTemp","addUniqueCharacterFormat","isEqualFormat","fontSize","fontFamily","bold","italic","baselineAlignment","underline","fontColor","strikethrough","highlightColor","isSameFormat","updateUniqueCharacterFormat","HelperMethods","insert","spanText","text","slice","join","substring","indexOfAny","wordSplitCharacter","j","temp","lastIndexOfAny","addCssStyle","css","cssText","appendChild","createTextNode","getElementsByTagName","getHighlightColorCode","color","convertPointToPixel","point","round","convertPixelToPoint","pixel","isLinkedFieldCharacter","inline","FieldElementBox","fieldType","fieldEnd","fieldBegin","removeSpace","charAt","replace","trimStart","trimEnd","endsWith","writeCharacterFormat","isInline","styleName","decimalDigits","Math","wordBefore","wordAfter","wordSplitCharacters","Point","xPosition","yPosition","xIn","yIn","copy","WStyle","copyStyle","paraStyle","next","link","WCharacterStyle","charStyle","collection","contains","pop","returnStyle","map","styleObjects","styles_1","returnStyleObject","JSON","stringify","WBorder","uniqueBorderFormat","initializeUniqueBorder","uniqueBorderFormats","uniqueBorderFormatTemp","addUniqueBorderFormat","getLineWidth","lineStyle","lineArray","getBorderLineWidthArray","lineWidth","borderLineArray","abs","getBorderWeight","weight","numberOfLines","getNumberOfLines","borderNumber","getBorderNumber","getPrecedence","border","shadow","space","WBorders","leftIn","rightIn","topIn","bottomIn","horizontalIn","verticalIn","diagonalUpIn","diagonalDownIn","lineWidthIn","left","top","bottom","right","horizontal","vertical","diagonalDown","diagonalUp","valueIn","borders","WShading","uniqueShadingFormat","initializeUniqueShading","uniqueShadingFormats","uniqueShadingTemp","addUniqueShading","shading","backgroundColor","foregroundColor","textureStyle","WTableFormat","owner","uniqueTableFormat","assignTableMarginValue","initializeUniqueTableFormat","uniqueTableFormats","uniqueTableFormatTemp","addUniqueTableFormat","leftMargin","topMargin","rightMargin","bottomMargin","initializeTableBorders","tableFormat","tableAlignment","cellSpacing","preferredWidth","preferredWidthType","WRowFormat","uniqueRowFormat","beforeWidth","afterWidth","heightType","initializeUniqueRowFormat","uniqueRowFormats","uniqueRowFormatTemp","addUniqueRowFormat","allowBreakAcrossPages","isHeader","gridBefore","gridBeforeWidth","gridBeforeWidthType","gridAfter","gridAfterWidth","gridAfterWidthType","WCellFormat","uniqueCellFormat","initializeUniqueCellFormat","uniqueCellFormats","uniqueCellFormatTemp","addUniqueCellFormat","containsMargins","verticalAlignment","cellWidth","columnSpan","rowSpan","Rect","x","y","clone","Widget","bodyWidgets","widget","indexInOwner","previousPage","previousContainer","TableCellWidget","getPreviousSplitWidget","TableRowWidget","HeaderFooterWidget","previousRenderedWidget","lastChild","nextPage","nextContainer","getNextSplitWidget","nextRenderedWidget","firstChild","previous","equals","BlockWidget","getPreviousSplitWidgets","widgets","previousSplitWidget","unshift","getSplitWidgets","nextSplitWidget","combineWidget","root","shift","splitWidget","combine","TableWidget","combineRows","addWidgets","destroyInternal","LineWidget","removeChild","child","margin","BlockContainer","apply","sectionFormatIn","getHierarchicalIndex","hierarchicalIndex","headerFooterType","getTableCellWidget","touchPoint","tableCellWidget","n","chilgWidget","headerWidget","footerWidget","headerFooter","block","blockAdv","isPageBreak","children","getIndex","ownerTable","ownerRow","getContainerWidth","isInsideTable","associatedCell","cellFormat","isEndsWithPageBreak","isEmpty","inlineElement","TextElementBox","ImageElementBox","BookmarkElementBox","getInline","offset","indexInInline","count","isStarted","splittedWidget","k","line","ListTextElementBox","getLength","cloneLine","flags","leftBorderWidth","rightBorderWidth","topBorderWidth","bottomBorderWidth","tableHolder","WTableHolder","spannedRowCollection","row","combineCells","tableCell","getOwnerWidth","isBasedOnViewer","getTableWidth","rowWidth","getTableClientWidth","clientWidth","tableWidth","getCellWidth","containerWidth","cell","getMinimumPreferredWidth","fitCellsToClientArea","factor","rowFormat","calculateGrid","tempGrid","spannedCells","tableCellInfo","rowCellInfo","currOffset","startOffset","columnIndex","removeSpannedCell","rowIndex","m","cellIndex","columns","updateColumnSpans","getGridCount","buildTableColumns","isGridUpdated","resetColumns","rowSpannedCells","isAutoWidth","addColumns","rowSpannedCell","minWidth_1","ownerColumn","validateColumnWidths","fitColumns","setWidthToCells","rw","getMaxRowWidth","updateWidth","dragValue","totalPreferredWidth","getTotalWidth","convertPointToPercent","tablePreferredWidth","ownerWidth","table","getTableOf","getRowOf","fitChildToClientArea","getColumnCellsForSelection","startCell","endCell","cells","start","end","splitWidthToTableCells","tableClientWidth","splitWidthToRowCells","insertTableRowsInternal","tableRows","startIndex","updateRowIndex","getCellStartOffset","tableGrids","headerHeight","description","title","getCellOf","getCell","tableGrid","prevOffset","gridStartIndex","getOffsetIndex","getCellOffset","updateRowBySpannedCells","getPreviousRowSpannedCells","currentRowIndex","spannedCell","include","previousWidget","cellWidget","getContainerTable","previousCell","nextCell","cellPreferredWidth","getCellLeftBorder","leftBorder","cellBorder","rowBorders","tableBorders","getLeftBorderToRenderByHierarchy","prevCell","previousRow","prevRowCell","getPreviousCellLeftBorder","getLeftBorderWidth","getRightBorderWidth","getCellSpacing","actualCellSpacing","hasNoneStyle","prevCellRightBorder","getBorderBasedOnPriority","adjacentBorder","borderWeight","adjacentBorderWeight","borderPriority","adjacentBorderPriority","borderColInRGB","convertHexToRGB","R1","G1","g","B1","adjacentBorderColInRGB","R2","G2","B2","borderBrightness","adjacentBorderBrightness","getCellRightBorder","rightBorder","getRightBorderToRenderByHierarchy","nextWidget","getAdjacentCellRightBorder","nextCellLeftBorder","getCellTopBorder","topBorder","getTopBorderToRenderByHierarchy","prevTopCell","prevRow","getPreviousCellTopBorder","previousTopCell","prevTopCellBottomBorder","getCellBottomBorder","bottomBorder","getBottomBorderToRenderByHierarchy","nextBottomCell","nextRow","getAdjacentCellBottomBorder","prevBottomCellTopBorder","colorCode","colCodeNo","parseInt","paragraphWidget","lineIndex","splitParagraph","lastElement","isFirstLine","isLastLine","getOffset","textIndex","getEndOffset","previousLine","elementBox","ElementBox","linkFieldCharacter","linkFieldTraversingForward","fields","fieldSeparator","linkFieldTraversingBackwardSeparator","isFieldEnd","linkFieldTraversingBackward","previousNode","childNode","prevParagraph","nextLine","childElement","lineWidget","objectCharacter","String","fromCharCode","hasFieldEnd","fieldBeginInternal","fieldSeparatorInternal","fieldEndInternal","field","baselineOffset","span","FieldTextElementBox","fieldText","TabElementBox","tabText","tabLeader","bookmarkTypeIn","refereneceIn","nameIn","reference","bookmarkType","isInlineImage","imageStr","imgElement","isInlineImageIn","isMetaFile","src","image","imageString","isListFollowCharacter","isFollowCharacter","Page","repeatHeaderRowTableWidget","editor","removeFieldInWidget","removePage","tableColumns","getPreviousSpannedCellWidth","previousColumnIndex","curColumnIndex","currentColumnIndex","WColumn","availableWidth","endOffset","isFitColumns","preferredTableWidth","totalColumnWidth","isNaN","column","maxWidth","contextMenuInstance","onContextMenuInternal","event","showHideElements","preventDefault","localValue","contextMenu","containerId","body","ul","listStyle","padding","maxHeight","oncontextmenu","disableBrowserContextmenu","menuItems","getConstant","iconCss","separator","menuOptions","select","handleContextMenuItem","Menu","beforeOpen","caret","showCaret","onClose","cut","pasteInternal","updateToc","navigateHyperlink","copyHyperlink","removeHyperlink","mergeCells","insertRow","insertColumn","deleteTable","deleteRow","deleteColumn","applyContinueNumbering","applyRestartNumbering","getElementById","paste","updateField","editField","font","tableProperties","insertTable","hyperlink","openHyperlink","editHyperlink","continueNumbering","restartAt","display","nextSibling","hideToolTip","copiedData","contextType","listLevelPattern","isCellSelected","getHyperlinkField","isImageField","canMergeCells","previousSibling","parentElement","WAbstractList","abstractListIdIn","WListLevel","uniqueListLevel","followCharacter","numberFormat","restartLevel","initializeUniqueWListLevel","uniqueListLevels","uniqueListLevelTemp","addUniqueWListLevel","dotBullet","squareBullet","arrowBullet","circleBullet","allowLayout","isInitialLoad","maxTextHeight","maxBaseline","maxTextBaseline","isFieldCode","layout","layoutItems","createNewPage","addBodyWidget","clientActiveArea","pageIndex","i_1","prevPage","sectionIndex","insertPage","layoutSection","updateFieldElements","ownerWidget","nextBlock","updateClientAreaForBlock","layoutBlock","layoutHeaderFooter","headerFooterWidget","getCurrentPageHeaderFooter","updateHFClientArea","layoutHeaderFooterItems","updateHeaderFooterToParent","typeIndex","getHeaderFooter","clearTableWidget","linkFieldInHeaderFooter","linkFieldInParagraph","linkFieldInTable","updateClientAreaLocation","pargaraph","shiftChildLocation","clientArea","shiftTop","widgetTop","footerMaxHeight","max","childWidget","shiftChildLocationForTableWidget","tableWidget","shiftChildLocationForTableRowWidget","rowWidget","shiftChildLocationForTableCellWidget","moveToLine","layoutParagraph","layoutTable","addParagraphWidget","area","textHelper","getParagraphMarkWidth","addLineWidget","layoutListItems","layoutEmptyLineWidget","updateClientWidth","layoutLine","updateWidgetToPage","clearLineMeasures","moveElementFromNextLine","layoutElement","nextElement","layoutFieldCharacters","nextNode","moveToNextLine","moveFromNextPage","hasValidElement","getFieldResult","checkAndSplitTabOrLineBreakCharacter","getTextSize","getTabWidth","moveToNextPage","updateFieldText","previousElement","cutClientWidth","textWrap","addElementToLine","currentLine","addSplittedLineWidget","splitTextForClientArea","checkLineWidgetWithClientArea","splitElementForClientArea","elementIndex","getNextValidElementForField","char","character","splitByLineBreakOrTab","currentElement","splitCurrentWidget","cutFromLeft","splitTextElementWordByWord","fieldStacks","isEmptyLine","isShiftEnter","paragraphMarkSize","getParagraphMarkSize","getBeforeSpacing","getLineSpacing","BaselineOffset","cutFromTop","getListById","clearListElementBox","layoutList","currentListLevel","getListNumber","updateTextSize","addListLevels","val","getListLevelPattern","splittedElementBox","movedElementBox","newLineWidget","splitByWord","getSplitIndexByWord","getWidth","substr","splitByCharacter","textElement","getTextSplitIndexByCharacter","splitWidth","measureTextExcludingSpaceAtEnd","splittedElement","trim","getTextIndexAfterSpace","splittedText","isSplitByWord","textWidth","characterUptoWS","checkPreviousElement","spiltBy","inlineIndex","remainder","newSpan","newText","paraFormat","isParagraphStart","isParagraphEnd","maxDescent","updateLineWidget","measurement","measureText","subWidth","whiteSpaceCount","getWidthAndSpace","getSubWidth","spaceCount","addSubWidth","alignElements","alignLineElements","nextBody","moveBlocksToNextPage","updateClientArea","nextParagraph","insertIndex","isLastElement","getCellContentHeight","enableHeaderAndFooter","shiftFooterChildLocation","top_2","footerDistance","lastTextElement","index_1","lastIndexOf","updateListValues","getListText","getListStartValue","renderedLists","getAbstractListById","startVal","listAdv","listText","levelKey","match","getListTextListLevel","getAsLetter","number","quotient","letter","listValue","getAsRoman","toUpperCase","toLowerCase","getAsLeadingZero","generateNumber","magnitude","numberstring","retval","levelOverrideAdv","fposition","isCustomTab","defaultTabWidth","tabPosition","tabwidth","getRightTabWidth","diff","clientActiveWidth","nextIndex","totalClientWidth","clientActiveAreaWidth","justify","trimSpace","lineText","elementText","isParagraphFirstLine","isParagraphLastLine","lastLineWidget","lastInline","moveNextWidgetsToTable","rowWidgets","moveFromNext","currentRow","currentTable","nextWidgets","addTableCellWidget","maxCellMarginTop","maxCellMarginBottom","prevColumnIndex","cellspace","prevSpannedCellWidth","addWidgetToTable","tableCollection","rowCollection","endRowWidget","prevWidget","rowWidgetIndex","prevIndex","addTableWidget","updateRowHeightBySpannedCell","updateRowHeightByCellSpacing","updateHeightForRowWidget","updateRowHeight","updateSpannedRowCollection","prevRowWidget","mergedCellHeight","isRowSpanEnd","splittedCellWidgets","splittedCell","isVerticalMergedCellContinue","colIndex","splitWidgets","tableRowWidget","isLastRow","isFirstLineFitForRow","getSplittedWidgetForRow","insertSplittedCellWidgets","getSplittedWidget","updateWidgetLocation","updateWidgetsToTable","tableWidgets","rowHeight","getRowHeight","isAllowBreakAcrossPages","moveRowToNextTable","continueHeader","isInsertSplittedWidgets","updateWidgetsToPage","prevBodyWidget","curretTable","currentRenderingPage","updateChildLocationForRow","getHeader","getHeaderHeight","flag","row_1","updateWidgetToRow","lastWidget","cellHeight","isUpdateVerticalPosition","isLayouted","cellspacing","currentRowWidgetIndex","rowSpanWidgetEndIndex","splitSpannedCellWidget","spanEndRowWidget","childWidget_1","updateHeightForCellWidget","updateCellVerticalPosition","updateHeightForTableWidget","previousRowIndex","insertRowSpannedWidget","length_1","insertEmptySplittedCellWidget","previousLeft","emptyCellWidget","createCellWidget","splitMinimalWidget","splittedPara","getSplittedWidgetForPara","tableCol","tableHeight","splittedTable","getSplittedWidgetForTable","createTableWidget","newTable","lineBottom","rowBottom","splittedRow","allowRowBreakAcrossPages","isFirstLineFitForPara","paraWidget","cellwidget","isFirstLineFitInShiftWidgets","containerCellWidget","isFirstLineFitForTable","isFit","isFirstLineFitForCell","updateChildLocationForTable","spacing","updateChildLocationForCell","isUpdateToTop","displacement","getDisplacement","updateCellContentVerticalPosition","location","updateTableWidgetLocation","cellContentHeight","contentHeight","getTableLeftBorder","getTableRightBorder","getTableTopBorder","getTableBottomBorder","getCellDiagonalUpBorder","getCellDiagonalDownBorder","layoutNextItemsBlock","blockToShift","updateNextBlockList","currentWidget","blocks","isInsertingTOC","updateContainerWidget","getFirstParagraphInFirstCell","updateWholeListItems","updateListItemsTillEnd","updateClientAreaForLine","startLineWidget","getTop","getParentTable","reLayoutParagraph","elementBoxIndex","layoutBodyWidgetCollection","reLayoutTable","reLayoutLine","isInHeaderFooter","updateHCFClientAreaWithTop","isBlockInHeader","block_1","clearPosition","clearHeight","clearRowWidget","clearCellWidget","blockIndex","shiftNextWidget","curretBlock","checkAndGetBlock","currentParagraph","shiftNextWidgets","tableView","updateClientAreaTopOrLeft","layoutRow","tables","rows","addTableRowWidget","updateClientAreaForRow","layoutCell","getMaxTopOrBottomCellMargin","borderWidth","topOrBottom","updateClientAreaForCell","shiftLayoutedItems","reLayoutOrShiftWidgets","removeEmptyPages","fieldCode","getFieldCode","shiftWidgetsBlock","updateRenderedListItems","shiftWidgetsForPara","shiftWidgetsForTable","prevBodyObj","getBodyWidgetOfPreviousBlock","shiftToPreviousWidget","updateClientAreaByWidget","isFitInClientArea","nextBodyWidget","createOrGetNextBodyWidget","previousBlock","isSplittedToNewPage","shiftTableWidget","shiftRowWidget","shiftCellWidget","shiftParagraphWidget","prevObj","updateVerticalPositionToTop","combinedTable","isUpdateTop","tablewidget","previousBodyWidget","firstLine","maxElementHeight","getMaxElementHeight","paragraphView","widgetIndex","updateParagraphWidgetInternal","activeArea","lastLine","newParagraphWidget","destroyAndScroll","scrollToBottom","createSplitBody","lastBlock","newBody","lineToLayout","Renderer","pageLeft","pageTop","pageCanvasIn","getContext","containerCanvas","selectionCanvas","getColor","pageContext","fillStyle","beginPath","fillRect","closePath","strokeStyle","strokeRect","setPageSize","rect","clip","renderHFWidgets","renderHeaderSeparator","restore","clearRect","selectionContext","dpr","devicePixelRatio","globalAlpha","scale","cliped","widgetHeight","headerFooterHeight","getScaledValue","renderWidget","ctx","min","renderDashLine","getHeaderFooterType","renderHeaderFooterMark","renderHeaderFooterMarkText","footerHeight","differentFirstPage","differentOddAndEvenPages","setLineDash","moveTo","lineTo","stroke","w","h","content","textBaseline","fillText","renderHeader","renderParagraphWidget","renderTableWidget","renderTableCellWidget","renderLine","renderTableRowWidget","renderTableOutline","visibleBounds","selectedWidgets","addSelectionHighlightTable","renderTableCellOutline","clipRect","addSelectionHighlight","searchHighlighters","widgetInfo","toSkipFieldCode","underlineY","getUnderlineYPosition","renderListTextElementBox","renderImageElementBox","renderTextElementBox","lineHeight","breakCharacterFormat","renderUnderline","renderStrikeThrough","isHeightType","scaledWidth","tabElement","getTabLeader","tabString","getTabLeaderString","floor","xPos","yPos","renderedHeight","underlineHeight","lineCount","widgetWidth","isClipped","containerWid","drawImage","renderSingleBorder","cellTopMargin","cellBottomMargin","cellLeftMargin","cellRightMargin","renderCellBackground","nextRowIsInCurrentTableWidget","nextRowWidget","bgColor","top_1","startX","startY","endX","endY","TextHelper","context","containerContext","paragraphMark","getHeight","textTrimEndWidth","getFormatText","heightInfoCollection","sizeInfo","getHeightInternal","formatText","toLocaleLowerCase","textHeight","spanElement","whiteSpace","innerText","applyStyle","parentDiv","tempDiv","setAttribute","offsetHeight","textTopVal","offsetTop","lineBreakMark","fontWeight","fontStyle","listCharacterFormat","Zoom","onMouseWheelInternal","ctrlKey","pageX","viewerContainer","offsetLeft","pageContainer","offsetWidth","wheel","detail","wheelDelta","setZoomFactor","onZoomFactorChanged","updateCaretPosition","updateTouchMarkPosition","updateImageResizerPosition","zoom","clearContent","handleZoom","currentPage","selectionStartPageIn","selectionEndPageIn","tableLefts","tapCount","timer","isTimerStarted","preZoomFactor","preDifference","fieldEndParagraph","fieldToLayout","containerTop","containerLeft","isMouseDown","isSelectionChangedOnMouseMoved","isControlPressed","isTouchInput","useTouchSelectionMark","touchDownOnSelectionMark","isCompositionUpdated","isCompositionCanceled","isCompositionEnd","prefix","suffix","preDefinedStyles","isRowOrCellResizing","isMouseDownInFooterRegion","pageFitTypeIn","fieldCollection","isPageField","mouseDownOffset","zoomFactorInternal","compositionStart","compositionUpdated","compositionEnd","onImageResizer","isImageResizerVisible","isImageResizing","MouseEvent","onMouseUpInternal","TouchEvent","onTouchUpInternal","onKeyPressInternal","keyCode","charCode","handleTextInput","onTextInputInternal","editableDiv","onPaste","onFocusOut","hideCaret","scrollHandler","vtHeight","scrollTop","onWindowResize","resizeTimer","setTimeout","updateViewerSizeInternal","clearTimeout","onContextMenu","onMouseDownInternal","offsetX","offsetY","clientHeight","updateCursor","isLeftButtonPressed","enableImageResizerMode","selectedResizeElement","cursorPoint","findFocusedPage","isCursorInsidePageRect","isCursorInFooterRegion","tableResize","isInCellResizerArea","isInRowResizerArea","startingPoint","handleResize","which","checkCursorIsInSelection","getLineWidget","onMouseMoveInternal","isImageMoveToNextPage","handleImageResizingOnMouse","handleResizing","updateTextPositionForSelection","touchY","textPosition","touchPoint_1","moveTextPosition","checkForCursorVisibility","onDoubleTap","checkAndEnableHeaderFooter","selectCurrentWord","isListTextSelected","isIE","updateResizingHistory","isImageSelected","navigateHyperLinkOnEvent","isSelectionInListText","selectListText","mouseUpInternal","scrollToPosition","updateHistoryForImageResizer","imageResizer","leftValue","topValue","onTouchStartInternal","touches","zoomX","clientX","zoomY","clientY","getTouchOffsetValue","resizeObj","getImagePointOnTouch","selectedElement","getCaretBottom","onTouchMoveInternal","touch","handleImageResizingOnTouch","currentDiff","sqrt","pow","onPinchOutInternal","onPinchInInternal","changedTouches","touchStart","touchEnd","onKeyUpInternal","getSelection","anchorOffset","setEditableDivCaretPosition","onKeyDownInternal","isHandled","keyEventArgs","ctrl","metaKey","shiftKey","alt","altKey","initalizeStyles","bookmarks","containerCanvasIn","selectionCanvasIn","visibleBoundsIn","zoomModule","dialogInternal","initDialog","dialogInternal2","initDialog2","onPageFitTypeChanged","getListLevelNumber","getBookmarks","includeHidden","bookmark","tabIndex","outline","className","pointerEvents","contentEditable","initializeImageResizer","initTouchEllipse","wireEvent","initCaret","addEventListener","dialogTarget","Dialog","showCloseIcon","allowDragging","visible","isModal","X","Y","zIndex","beforeClose","appendTo","tocStyles","tocBookmarkId","editorHistory","selectRange","documentStart","ellipse","getPage","pageGap","getLeftValue","isInsideRect","selectionLineWidget","button","getBoundingClientRect","touchOffsetValues","pageY","updatedZoomFactor","optionsRect","optionsPane","ceil","beforeLayout","currentResizingTable","resizerPosition","headerDistance","updateClientAreaForTable","POSITIVE_INFINITY","updateTextPosition","selectCurrentParagraph","startPosition","endPosition","getLineWidgetInternal","prevLineWidget","prevTop","scrollLeft","caretInfo","updateCaretSize","caretHeight","updateCaretToPage","scrollBarWidth","isMouseDragged","pageBottom","getPageTop","getLineWidgetBodyWidget","clearSelectionHighlight","clearSelectionHighlightInSelectedWidgets","scrollToLastPage","containerHeight","fieldCodes","split","fieldCategory","fieldPattern","getFieldText","pattern","unWireEvent","removeEventListener","hyperlinkField","div","isRowResize","isCellResize","resizePosition","getImagePoint","lineLeft","getLineStartLeft","getHyperLinkFieldInCurrentSelection","updateTextPositionIn","getLeft","setHyperlinkContentToToolTip","cursor","currentPoint","updateCurrentPage","pageRight","prevScaleFactor","verticalHeight","horizontalWidth","horWidth","prevPageTop","prevY","prevValue","prevX","getCurrentHeaderFooter","createHeaderFooterWidget","viewerWidth","viewerHeight","displayPixelRatio","updateScrollBarPosition","parseFloat","updateVisiblePages","pageH","left_1","isTopFit","isBottomFit","isMiddleFit","addVisiblePage","setImageResizerPositions","renderPage","renderVisiblePages","json","jsonObject","parse","parseCharacterFormat","parseParagraphFormat","background","parseAbstractList","parseList","parseStyles","parseSections","data","parseStyle","wStyle","basedStyle","getStyle","styleString","linkStyle","charaStyle","nextStyleString","abstract","parseListLevel","listCollection","parseLevelOverride","parseSectionFormat","parseTextBody","oddHeader","oddFooter","parseBody","styleObj","inlines","parseParagraph","parseTable","parseTableFormat","tableRow","parseRowFormat","parseRowGridValues","parseCellFormat","writeInlineFormat","lineWidgetCount","bookmarkStart","sourceFormat","parseBorders","parseShading","isSamePaddingAsTable","parseCellMargin","sourceBorders","destBorder","parseBorder","sourceBorder","sourceShading","destShading","texture","inlineFormat","parseListFormat","parseTabStop","wTabs","tabStop","SelectionCharacterFormat","boldIn","italicIn","underlineIn","strikeThroughIn","baselineAlignmentIn","highlightColorIn","fontSizeIn","fontColorIn","notifyPropertyChanged","fontFamilyIn","propertyName","isCleared","isRetrieveFormatting","propertyValue","onApplyCharacterFormat","combineFormat","selectionCharacterFormat","SelectionParagraphFormat","leftIndentIn","rightIndentIn","beforeSpacingIn","afterSpacingIn","textAlignmentIn","firstLineIndentIn","lineSpacingIn","lineSpacingTypeIn","listLevelNumberIn","levelPattern","onApplyListInternal","onApplyParagraphFormat","copyToFormat","getList","currentAbstractList","cloneListLevel","cloneLevelOverride","setList","onApplyList","history_1","setOffsetValue","updateListChangesInHistory","updateListParagraphs","applyListChanges","layoutWholeDocument","updateSelectionTextPosition","currentBaseHistoryInfo","modifiedProperties","updateSelection","updateHistory","SelectionSectionFormat","differentFirstPageIn","differentOddAndEvenPagesIn","pageHeightIn","pageWidthIn","leftMarginIn","bottomMarginIn","topMarginIn","rightMarginIn","headerDistanceIn","footerDistanceIn","getPropertyvalue","onApplySectionFormat","SelectionTableFormat","backgroundIn","tableAlignmentIn","cellSpacingIn","preferredWidthIn","tableIn","preferredWidthTypeIn","onApplyTableFormat","SelectionCellFormat","verticalAlignmentIn","onApplyTableCellFormat","clearCellFormat","SelectionRowFormat","heightIn","heightTypeIn","isHeaderIn","allowRowBreakAcrossPagesIn","onApplyTableRowFormat","clearRowFormat","SelectionImageFormat","updateImageFormat","onImageFormat","copyImageFormat","clearImageFormat","HtmlExport","fieldCheck","writeHtml","html","serializeSection","string","serializeParagraph","serializeTable","blockStyle","tagAttributes","serializeParagraphStyle","createAttributesTag","serializeInlines","endTag","serializeImageContainer","serializeInlineStyle","serializeSpan","spanClass","decodeHtmlNames","imageStyle","imageSource","serializeCell","cellHtml","serializeCellBordersStyle","createTableStartTag","serializeRow","createTableEndTag","createRowStartTag","isList","paragraphClass","serializeCharacterFormat","serializeParagraphFormat","serializeTableBorderStyle","borderStyle","convertBorderLineStyle","serializeBorderStyle","borderPosition","tagValue","localProperties","sb","createTag","s","tableStyle","createRowEndTag","htmlText","TextPosition","isUpdateLocation","getStartOffset","getLineLength","getHierarchicalIndexInternal","setPositionForSelection","physicalLocation","isLastRenderedInline","getParagraphLength","setPositionFromLine","setPosition","positionAtStart","updatePhysicalPosition","setPositionInternal","setPositionForCurrentIndex","getParagraphWidget","setPositionParagraph","newValue","moveNextLine","getPhysicalPositionInternal","isAtSamePosition","isInSameParagraph","isExistBefore","isExistAfter","startParagraph","endParagraph","offsetInLine","setPositionForLineWidget","lineLength","nextLineWidget","getNextRenderedBlock","prevLine","curretOffSet","moveNextPosition","isNavigate","getNextStartInline","moveNextPositionInternal","fieldEndOffset","fieldEndIndex","isForwardSelection","moveToInline","nextOffset","getNextValidOffset","info","nextValidInline","getNextValidElement","getStartLineOffset","inlineObj","updateOffsetToNextParagraph","moveToPreviousParagraphInTable","previousParagraph","currentPara","getPreviousSelectionCell","getPreviousParagraphBlock","isHighlight","getNextSelectionBlock","getContainerCellOf","getNextParagraphBlock","updateOffsetToPrevPosition","inlineInfo","getPreviousValidOffset","getPreviousSelectionBlock","previousInline","getPreviousValidElement","moveToNextParagraphStartInternal","movePreviousPosition","movePreviousPositionInternal","hasValidInline","moveBackward","nextInline","getNextRenderedElementBox","fieldBeginOffset","moveForward","fieldBeginIndex","selectionStartIndex","selectionStartInlineObj","selectionStartInline","inlineObj_1","selectionStart","selectionEnd","moveToWordStartInternal","getPreviousWordOffset","calculateOffset","getNextWordOffset","isInField","endSelection","excludeSpace","getNextWordOffsetSpan","getNextWordOffsetImage","getNextWordOffsetFieldBegin","getNextWordOffsetFieldSeperator","getNextWordOffsetFieldEnd","wordEndIndex","txt","getPreviousWordOffsetSpan","getPreviousWordOffsetImage","getPreviousWordOffsetFieldBegin","getPreviousWordOffsetFieldSeparator","getPreviousWordOffsetFieldEnd","getPreviousWordOffsetBookMark","wordStartIndex","setPreviousWordOffset","validateForwardFieldSelection","currentIndex","selectionEndIndex","isPositionMoved","validateBackwardFieldSelection","paragraphStartInternal","moveToPreviousParagraph","moveToNextParagraphInTableCheck","paragraphValue","moveToParagraphStartInternal","moveToParagraphEndInternal","moveToNextParagraph","splittedParagraph","moveToNextParagraphInTable","moveUp","moveToLineStartInternal","getFirstCellInRegion","lastParagraph","getLastParagraph","prevBlock","getLastBlockInLastCell","getLineWidgetParagraph","upDownSelectionLength","getLastCellInRegion","updateTextPositionWidget","moveDown","moveToLineEndInternal","getFirstParagraph","getFirstBlockInFirstCell","moveToPreviousLine","firstElement","getFirstElementInternal","getIndexInInline","prevInline","moveToWordEndInternal","incrementValue","getNextSelectionCell","moveUpInTable","lineStart","isMoveToLineEnd","moveDownInTable","firstItemWidth","getLeftInternal","isPositionUpdated","isBackwardSelection","containerCell","getSelectedCell","isInContainerCell","containsCell","isContainerCellSelected","isAtParagraphStart","getContainerCell","isForward","SelectionWidgetInfo","widthIn","fieldBeginAdv","linkInternal","localRef","opensNewWindow","parseFieldValues","typeInternal","codes","isLocalRef","code","parseFieldValue","setLinkType","endChar","endIndex","navigationLink","ImageFormat","imageContainer","documentEditor","isSkipLayouting","contextTypeInternal","skipFormatRetrieval","isMoveDownOrMoveUp","characterFormatIn","paragraphFormatIn","rowFormatIn","cellFormatIn","tableFormatIn","imageFormatInternal","htmlWriterIn","startInternal","endInternal","selectionStartPage","selectionEndPage","getText","goToHeader","enableHeadersFootersRegion","goToFooter","closeHeaderFooter","disableHeaderFooter","goToPage","updateTextPositionForBlockContainer","selectTable","selectTableInternal","selectRow","selectTableRow","selectColumn","selectColumnInternal","selectCell","selectTableCell","selectionSettings","pageCoordinates","extend","toggleBold","toggleItalic","toggleUnderline","toggleStrikethrough","toggleHighlightColor","toggleSubscript","toggleSuperscript","toggleTextAlignment","increaseIndent","decreaseIndent","fireRequestNavigate","linkType","localReference","navigateBookmark","hyperLinkField","linkText","getLinkText","copyToClipboard","highlightSelection","isSelectionChanged","hideImageResizer","highlightSelectedContent","createHighlightBorder","selectionWidget","clipSelection","createHighlightBorderInsideTable","isVisiblePage","canvasContext","removeSelectionHighlight","currentParaWidget","pageRect","selectCurrentWordRange","fireSelectionChanged","wordStart","extendToParagraphStart","extendToParagraphEnd","updateForwardSelection","updateBackwardSelection","extendToPreviousLine","extendToLineEnd","extendToLineStart","firstrow","firstcell","selectionLength","isMovePrevious","cellStart","getCellLeft","cellEnd","cellLeft","firstBlock","getFirstParagraphBlock","lastrow","lastcell","moveToLineStart","moveToLineEnd","setPositionForBlock","lastPage","handleControlEndKey","documentEnd","selectContent","handleControlHomeKey","handleControlLeftKey","extendToWordStart","handleControlRightKey","extendToWordEnd","handleControlDownKey","handleControlUpKey","handleShiftLeftKey","extendBackward","handleShiftUpKey","handleShiftRightKey","extendForward","handleShiftDownKey","extendToNextLine","handleControlShiftLeftKey","handleControlShiftUpKey","handleControlShiftRightKey","handleControlShiftDownKey","handleLeftKey","handleUpKey","handleRightKey","handleEndKey","handleHomeKey","handleDownKey","handleShiftEndKey","handleShiftHomeKey","handleControlShiftEndKey","handleControlShiftHomeKey","handleTabKey","isNavigateInCell","isShiftTab","selectPreviousCell","selectNextCell","updateListLevel","selectTableCellInternal","clearMultiSelection","firstParagraph","selectParagraph","firstLineWidget","getTable","firstPara","lastPara","getLastParagraphBlock","selectPosition","startTextPos","endTextPos","columnCells","startCellColumnCells","endCellColumnCells","startPos","endPos","selectAll","getContainerWidget","extendToWordStartEnd","isNavigation","getTextPosition","includeObject","getTextInternal","startInlineObj","elementInfo","getRenderedInline","endInlineObj","endInline","getTextInline","nextParagraphWidget","endParagraphWidget","startLineIndex","getFieldCodeInternal","getTocFieldInternal","getNextParagraph","getPreviousParagraph","getFirstParagraphInCell","getLastParagraphInLastCell","getLastParagraphInFirstRow","getPreviousTextInline","getNextTextInline","cell1","cell2","isExistBeforeInline","currentInline","isExistAfterInline","getPreviousRenderedBlock","getNextParagraphCell","getFirstBlockInNextHeaderFooter","getLastBlockInPreviousHeaderFooter","getPreviousParagraphCell","endLine","getLineInfo","childLength","getElementInfo","getPreviousParagraphSelection","getFirstParagraphInLastRow","getPreviousSelectionRow","getNextParagraphSelection","getNextSelection","getNextSelectionRow","getCellInTable","getPreviousSelection","selLength","isMovePrev","validOffset","size","maxBaselineOffset","getPhysicalPositionInline","startInline","fieldValue","elementBoxObj","getElementBoxInternal","positionImageResizer","showImageResizer","highlight","highlightCell","startElement","endElement","endLineWidget","startLineObj","getStartLineWidget","endLineObj","getEndLineWidget","highlightParagraph","highlightNextBlock","highlightTable","getLineWidgetInternalInline","linewidget","highlightCells","endCellLeft","endCellRight","tableWidgetCollection","startTableIndex","endTableIndex","highlightRow","startRowIndex","endRowIndex","highlightInternal","getNextParagraphRow","getPreviousParagraphRow","containsRow","highlightCellWidget","sourceCell","getSelectedCells","highlightContainer","previousValidInline","validateTextPosition","getElementBox","getFieldCharacterPosition","getNextLineWidget","getPreviousTextElement","getNextTextElement","measureObj","firstInline","getEndPosition","getRenderedField","elementObj","getCaretHeight","isEmptySelection","isItalic","getFieldCharacterHeight","heightElement","maxLineHeight","paragarph","textSizeInfo","charHeight","elementHeight","top_3","isNonEmptySelection","clearChildSelectionHighlight","clearSelectionHighlightLineWidget","getLineWidgetParaWidget","getLineWidgetTableWidget","getLineWidgetRowWidget","leftCellSpacing","rightCellSpacing","topCellSpacing","bottomCellSpacing","getLineWidgetCellWidget","getFirstBlock","caretPosition","isImageSelectedObj","selectInternal","includeParagraphMark","elementValues","getFirstElement","selectParaMark","prevWidth","charIndex","curIndex","textMetrics","isLineEnd","updatePositionObj","selectFirstBlock","selects","skipSelectionChange","retrieveCurrentFormatProperties","retrieveImageFormat","retrieveCharacterFormat","retrieveParagraphFormat","retrieveSectionFormat","retrieveTableFormat","imageFormat","setCurrentContextType","contextIsinImage","contextIsinTable","tocField","isInHeader","tableAdv","retrieveCellFormat","retrieveRowFormat","getCellFormat","getRowFormat","tempTableRow","startTable","endTable","startParaSection","endParaSection","startPageIndex","endPageIndex","getParagraphFormatForSelection","getParagraphFormatInternalInParagraph","getParagraphFormatInternalInCell","getParagraphFormatInternalInBlock","getParagraphFormatInternalInTable","getParagraphFormatInCell","getParagraphFormatInBlock","getParagraphFormatInParagraph","getParagraphFormatInTable","cellAdv","getParagraphFormatInRow","getParaFormatForCell","startCellIn","endCellIn","para","elemInfo","getCharacterFormatForSelection","getCharacterFormatInTableCell","getCharacterFormat","getCharacterFormatForTableRow","tableRowAdv","getCharacterFormatForSelectionCell","getCharacterFormatForBlock","getCharacterFormatInternalInTable","startIn","endIn","getCharacterFormatInternal","setCharacterFormat","isFieldStartSelected","fieldInline","inlineAndIndex","getNextValidCharacterFormatOfField","getNextValidCharacterFormat","getCharacterFormatInTable","isSelected","top_4","copySelectionParagraphFormat","getHyperlinkDisplayText","isNestedField","displayText","toolTipElement","toolTipText","top_5","showToolTip","toolTipField","toolTipObject","Popup","relateTo","hide","cursorPosition","lineStartLeft","checkedFields","getHyperLinkFields","getHyperLinkFieldInternal","paragraphIsInFieldResult","inlineIsInFieldResult","getBlock","bodyIndex","getBlockInternal","fieldParagraph","selectionIndex","highlightListText","updateImageSize","getSelectedCellsInTable","startColumnIndex","endColumnIndex","startRowindex","copySelectedContent","isCut","htmlWriter","handleCut","htmlContent","removeAllRanges","range","createRange","selectNodeContents","addRange","copySuccess","execCommand","e","parentNode","caretLeft","caretStartLeft","caretEndLeft","page_1","getSelectionPage","childNodes","setStart","collapse","skipUpdate","paragraphInfo","transform","caretHeightInfo","searchResults","pagePoint","isCursorInHeaderRegion","moveToStart","bookmrkElmnt","bookmrkEnd","endoffset","selectBookmark","getTocField","tocPara","isTocStyle","TextSearch","isFooter","find","findOption","findNext","hierarchicalPosition","stringToRegex","textSearchResults","clearResults","results","findDocument","currentSearchResult","textToFind","option","RegExp","isPatternEmpty","wordEmpty","patternRegExp","findAll","isFirstMatch","hierachicalPosition","findInline","findInlineText","inlineEle","stringBuilder","spans","matchObject","matches","exec","result","addResult","spanKeys","spanLength","SearchWidgetInfo","leftInternal","widthInternal","TextSearchResult","TextSearchResults","innerList","textSearchResult","SearchResults","search","navigate","textToReplace","replaceInternal","replaceAll","replaceAllInternal","clearSearchHighlight","isHandledOddPageHeader","isHandledEvenPageHeader","isHandledOddPageFooter","isHandledEvenPageFooter","textSearch","searchResultsInternal","findOptions","replaceText","insertText","endTextPosition","initComplexHistory","currentHistoryInfo","updateComplexHistory","updateComplexWithoutHistory","highlightResult","highlightSearchResult","highlightSearchResultParaWidget","findHighLight","addSearchHighlightBorder","highlighters","searchHighlight","addSearchResultItems","addFindResultView","addFindResultViewForSearch","suffixtext","lastIndex","boxObj","box","boxIndex","shiftIndex","headerFooterString","listElement","layoutViewer","matchCase","wholeWord","searchText","resultsText","messageDivText","replaceButtonText","replaceAllButtonText","focusedIndex","focusedElement","isOptionsPane","replacePaneText","findPaneText","matchDivReplaceText","tabInstance","isReplace","selectedTabItem","previousIndex","selectedIndex","previousTab","querySelector","nextTab","insertBefore","firstElementChild","onFindPane","onReplacePane","searchOptionChange","clearSearchResultItems","inputText","searchInput","navigateSearchResult","messageDiv","localeValue","resultContainer","resultsListBlock","clearFocusElement","wholeWordsChange","matchInput","checked","wholeInput","matchChange","onWireEvents","searchIcon","searchIconClickInternal","navigateToNextResult","navigateNextResultButtonClick","navigateToPreviousResult","navigatePreviousResultButtonClick","onKeyDown","onEnableDisableReplaceButton","resultListBlockClick","closeButton","replaceButton","onReplaceButtonClick","replaceAllButton","onReplaceAllButtonClick","replaceDiv","occurrenceDiv","replaceTabContentDiv","findDiv","findTabButtonHeader","replaceTabButtonHeader","getMessageDivHeight","disabled","replaceWith","onKeyDownOnOptionPane","focusIndex","HTMLInputElement","HTMLLIElement","click","findText","selectionText","inputElement","matchDiv","patterns","resultsContainerHeight","currentelement","listElementsDiv","liElement","listElements","currentlist","list_1","searchDiv","closeSpan","findTab","tabHeader","findTabButton","replaceTabButton","tabContent","findTabContent","findTabContentDiv","searchTextBoxContainer","attrs","placeholder","CheckBox","label","change","replaceTabContent","createReplacePane","Tab","selected","findHeader","getElementsByClassName","replaceHeader","replaceButtonDiv","emptyDiv6","currentIndexValue","blur","text_1","scrollHeight","optionPaneContainer","hideTab","textBox","selectedText","resultListBox","message","TableResizer","resizeNode","initResizingHistory","getRowReSizerPosition","getCellReSizerPosition","getTableWidget","startingPointX","resizerBoundaryWidth","getCellReSizerPositionInternal","childTableWidget","getTableWidgetFromWidget","childCellWidget","getActualWidth","resizeTableCellColumn","resizeTableRow","parentTable","reLayout","currentHeight","selectionFlag","setPreferredWidth","newIndent","resizeColumnWithSelection","rightColumn","prevDragValue","newWidth","dragOffset","updateCellPreferredWidths","updateGridValue","resizeColumnAtLastColumnIndex","resizeCellAtMiddle","selectedCells","resizeColumnAtStart","leftColumnCollection","getColumnCells","increaseOrDecreaseWidth","updateRowsGridAfterWidth","rightColumnCollection","isColumnResizing","isColumnSelected","changeWidthOfCells","selectedRow","newGridBefore","updateGridBefore","leastGridBefore","getLeastGridBefore","updateWidthForCells","hasTableWidth","leftColumn","isContinue","isUpdate","getOffsetValue","isLeftSideCollection","ignoreRow","isIncrease","minimumWidth","isSelection","maxRowWidth","currentRowWidth","getRowWidth","toUpdateGridAfter","leftColumnCells","rightColumnCells","columnCell","applyProperties","tableHistoryInfo","isAutoFit","updateGridBeforeWidth","updateGridAfterWidth","nodes","editHyperlinkInternal","isHandledComplex","refListNumber","incrementListNumber","removedBookmarkElements","pageRefFields","isBordersAndShadingDialog","nbsp","lineFeed","textBoxText","textContent","handleBackKey","insertField","fieldCodeSpan","fieldResultSpan","pasteContentsInternal","clearDirectFormatting","clearFormatting","getCompleteStyles","action","getPrefixAndSuffix","boxInfo","spaceIndex","prefixAdded","endInlineInfo","suffixAdded","toggleBaselineAlignment","acceptTab","handleEnterKey","handleDelete","handleShiftEnter","insertPageBreak","redo","undo","onBackSpace","onDelete","onEnter","animationTimer","copyInsertFormat","insertFormat","sFormat","insertPosition","isRemoved","initHistory","getParagraphInfo","editPosition","removeSelectedContents","updateInsertPosition","insertTextInline","tempSpan","splittedSpan","updateEndPosition","isSelectionOnHyperlink","checkAndConvertList","checkAndConvertToHyperlink","insertSectionBreak","insertSection","newSectionFormat","newParagraph","splitTable","updateNextBlocksIndex","splitParagraphInternal","splitBodyWidget","startBlock","newBodyWidget","updateSectionIndex","insertRemoveHeaderFooter","updateBlockIndex","startBodyWidget","increaseIndex","currentSectionIndex","isTab","convertList","isLeadingZero","tabValue","previousText","checkNumberFormat","checkLeadingZero","deleteSelectedContents","leadingZeroText","autoConvertList","newList","newAbstractList","isBullet","isZero","getPageFromBlockWidget","insertImageText","insertFieldBeginText","insertFieldSeparatorText","insertFieldEndText","insertBookMarkText","spanObj","spanIndex","previousInlineObj","nextInlineObj","isEnter","tabCharIndex","lowerCaseText","containsURL","atIndex","dotIndex","autoFormatHyperlink","url","blockInfo","createHyperlinkElement","appylingHyperlinkFormat","updateCharacterFormatWithUpdate","initInsertInline","begin","insertHyperlinkfield","isBookmark","unLinkFieldCharacter","fieldIndex","insertHyperlink","insertHyperlinkInternal","fieldStartPosition","insertHyperlinkByFormat","insertElement","insertInlineInSelection","insertElementInCurrentLine","isReLayout","checkIsNotRedoing","checkEndPosition","updateHistoryPosition","fieldResult","fieldObj","newFieldBegin","insertInlineInternal","removedNodes","insertClonedFieldResult","getClonedFieldResultWithSel","getClonedFieldResult","insertParagraph","insertBlock","curParagraph","fieldSeparatorPosition","pasteWindow","pasteLocal","clipboardData","getData","pasteContents","document_1","getBlocks","pasteContent","arr","insertParaFormat","removeSelectedContentInternal","pasteCopiedData","insertTableRows","insertBlockInternal","insertTableInternal","moveRows","removeBlock","insertBlockTable","moveInlines","checkInsertPosition","deleteSelectedContent","curInline","insertElementInternal","prevElement","newElement","relayout","startPara","insertNewParagraphWidget","insertImage","insertPicture","createTable","startLine","above","rowPlacement","getOwnerCell","cloneTableToHistoryInfo","rowCount","getRowCountToInsert","isAffectedByRowSpannedCell","cellCountInfo","updateRowspan","newRow","createRowAndColumn","updateCellFormatForInsertedRow","cellFormats","isCellIncluded","isRowSpanned","clonedRowIndex","columnPlacement","newCell","columnCount","getColumnCountToInsert","createColumn","isCellInserted","j_1","rowCell","getOwnerRow","isStart","startRow","endRow","getOwnerTable","mergeSelectedCellsInTable","startOwnerCell","endOwnerCell","mergedCell","mergeSelectedCells","cellInfo","updateSelectedCellsInTable","rowStartIndex","mergeBorders","updateBlockIndexAfterMerge","mergedCellborders","cellBorders","startCellIndex","canMergeSelectedCellsInTable","startLeft","endLeft","selectionLeft","selectionRight","isRowLeftWithinSel","isRowRightWithinSel","rowLeft","rowRight","checkCellWithInSelection","isPrevCellWithinSel","checkPrevOrNextCellIsWithinSel","isNextCellWithinSel","isNoRowSpan","isCellWithInSel","checkCurrentCell","checkCellWidth","isPrev","prevOrNextCell","isPrevCellWithInSel","cellOwner","spannedCellOwner","checkRowSpannedCells","insertAfter","insertIndex_1","isMoved","moveContent","removeEmptyLine","updateHeaderFooterWidget","isHandledComplexHistory","updateHeaderFooterWidgetToPage","shiftPageContent","isEvenPage","updateHeaderFooterWidgetToPageInternal","hfWidget","headerOrFooter","removeFieldInBlock","removeFieldTable","removeField","checkAndShiftFromBottom","update","isAtParagraphEnd","applyCharFormatValue","applyCharacterFormatForListText","updateSelectionCharacterFormatting","values","applyListCharacterFormatByValue","updateListCharacterFormat","updateListTextSelRange","startPositionInternal","endPositionInternal","initHistoryPosition","startSelectionReLayouting","currentList","clearList","applyBullet","bullet","applyBulletOrNumbering","applyNumbering","baseAlignment","updateProperty","initializeHistory","updateParagraphFormatInternal","currentUnderline","script","completeStylesString","name_1","existingStyles","styleNames_1","name_2","createStyle","createStyleIn","getUniqueStyleName","uniqueName","getUniqueName","matchArray","updateCharacterFormat","applyCharFormatSelectedContent","applyCharFormat","applyCharFormatCell","applyCharFormatForSelectedPara","splittedLastParagraph","splittedWidets","getNextParagraphForCharacterFormatting","widgetCollection","applyCharFormatForTable","inlineLength","applyCharFormatInline","getCurrentSelectionValue","updateFontSize","fontsizeCollection","formatInline","getCharacterFormatValueOfCell","applyCharFormatForSelectedCell","applyCharFormatRow","applyCharFormatForTableCell","applyCharFormatForSelTable","startCellLeft","startCellRight","applyCharFormatValueInternal","copyInlineCharacterFormat","destFormat","addModifiedProperties","modifiedFormat","getIndentIncrementValue","applyParaFormatProperty","layoutItemBlock","updateSelectionParagraphFormatting","increaseLevel","nextListLevel","incrementFactor","currentParagraphIndent","getIndentIncrementValueInternal","fPosition","updateParagraphFormat","applyParaFormatSelectedContent","applyCharacterStyle","applyParaFormat","applyParaFormatInCell","addModifiedPropertiesForParagraphFormat","copyParagraphFormat","copyFromListLevelParagraphFormat","onListFormatChange","updateListParagraphFormat","listlevel","oldFormat","newFormat","applyContinueNumberingInternal","numberingInfo","getContinueNumberingInfo","getParagraphFormat","listPattern","changeListId","revertContinueNumbering","levelNum","listType","baseHistoryInfo","addModifiedPropertiesForContinueNumbering","checkNumberArabic","restartListAt","createListLevels","restartListAtInternal","changeRestartNumbering","addModifiedPropertiesForRestartNumbering","levelPatterns","indexOfLevelPattern","getNextParagraphForFormatting","obj","cellContainer","getParaFormatValueInCell","applyParaFormatCellInternal","applyParagraphFormatRow","applyParaFormatTableCell","wCell","applyParagraphFormatTableInternal","wRow","startValue","endValue","applyParaFormatTable","updateSectionFormat","startSectionIndex","endSectionIndex","applyPropertyValueForSection","getTableFormatAction","applyTablePropertyValue","updateSelectionTableFormat","getRowAction","applyRowPropertyValue","getTableCellAction","applyCellPropertyValue","addModifiedPropertiesForSection","startInfo","endInfo","combineSection","nextSection","combineSectionChild","updateTableFormat","updateCellFormat","updateRowFormat","tableStartPosition","newStartPosition","updateFormatForCell","rowStartPosition","rowEndPosition","applyRowFormat","reLayoutSelectionOfTable","reLayoutSelection","isEnded","reLayoutSelectionOfBlock","removeSelectedContent","editAction","deletePara","deleteTableCell","getParagraphForSelection","deleteCells","removeRow","updateTable","paragraphStart","endParagraphStartOffset","isCombineNextParagraph","lastLinelength","isEndInAdjacentTable","isStartParagraph","removeInlines","deleteSection","deleteBlock","insertParagraphPaste","addRemovedNodes","checkAndInsertBlock","combineSectionInternal","currentSection","lastBlockIndex","paragraphAdv","deleteTableBlock","deletePreviousBlock","updateEditPosition","deleteCellsInTable","deleteCell","deleteContainer","isDeleteCells","cell_1","setActionInternal","copyChildToClipboard","checkClearCells","deleteContent","splitEndRow","enableHistoryMode","clonedTable","deleteParagraphMark","removeContent","copyListLevel","destination","listParagraphs","updateListParagraphsInBlock","startListLevel","tempList","abstractListAdv","listName","bulletCharacters","isInsertPageBreak","initialStart","breakParagraph","pageBreak","updateIndex","currentCellIndex","increment","singleBackspace","skipBackSpace","insertRemoveBookMarkElements","bookMark","bookMarkStart","bookMarkEnd","isBackSpace","deleteSelectedContentInternal","getParagraph","lineInfo","canRedo","canUndo","historyInfo","undoStack","startBlockInfo","endBlockInfo","currentLineWidget","setPositionForHistory","removeOffset","removeAtOffset","singleDelete","nextRenderedInline","bookMarkBegin","paraEndOffset","singleDeleteInternal","updateEditPositionOnMerge","base64String","imageElementBox","insertPictureInternal","fitImageToPage","onPortrait","onLandscape","copyValues","changeMarginValue","onPaperSize","currentBlock","updateListItems","updateListItemsForPara","updateListItemsForTable","updateListItemsForRow","updateListItemsForCell","updateRenderedListItemsForPara","updateRenderedListItemsForTable","updateRenderedListItemsForRow","updateRenderedListItemsForCell","getParagraphInfoInternal","lineOffset","insertPageNumber","createFields","insertPageCount","fieldtext","insertBookmark","bookmarkEnd","insertElements","updateComplexHistoryInternal","deleteBookmark","bookmarkName","setBookmarkInfo","deleteBookmarkInternal","getSelectionInfo","startElementInfo","endElementInfo","endElements","startElements","insertElementsInternal","elements","hfString","getBodyWidget","getBlockByIndex","blockObj","getParagraphInternal","getHeaderFooterWidget","getBodyWidgetInternal","isInsertPosition","applyBorders","settings","getBorder","borderColor","clearAllBorderValues","selectedCell","getTopBorderCellsOnSelection","getLeftBorderCellsOnSelection","getRightBorderCellsOnSelection","getBottomBorderCellsOnSelection","getAdjacentCellToApplyBottomBorder","clearBorder","getAdjacentCellToApplyRightBorder","applyAllBorders","applyInsideBorders","updateGridForTableDialog","borderType","isLastSelectedRow","isLastRightCell","nextRowIndex","getAdjacentBottomBorderOnEmptyCells","rightBorderCells","getSelectedCellsNextWidgets","topBorderCells","leftBorderCells","bottomBorderCells","nextCellColIndex","isSingleCell","startPosIn","endPosIn","applyBordersInternal","applyBorder","applyShading","onTableFormat","applyTableFormat","addModifiedTableProperties","handleTableFormat","applyFormat","shiftNextItem","onRowFormat","rowStartPos","rowEndPos","addModifiedRowProperties","handleRowFormat","onCellFormat","updateCellMargins","cellStartPosition","cellEndPosition","applyCellmarginsValue","getSelectedCellInColumn","rowEndIndex","addModifiedCellProperties","handleCellFormat","isTocField","insertTableOfContents","validateTocSettings","getTocSettings","tocSettings","includePageNumber","rightAlign","startLevel","endLevel","swtiches","swtch","includeHyperlink","includeOutlineLevels","decodeTSwitch","tSwitch","levelSettings","tableOfContentsSettings","constructTocFieldCode","buildToc","tocLastPara","tocLastLine","appendEndField","appendEmptyPara","updatePageRef","emptyPara","emptyLine","tocFieldCode","constructTSwitch","isFirstPara","tocDomBody","createHeadingLevels","createOutlineLevels","isHeadingStyle","isOutlineLevelStyle","insertTocBookmark","createTOCWidgets","levelStyle","headingStyle","createTocFieldElement","tocLine","headingStyleName","tocStyleName","insertTocHyperlink","pageField","insertTocPageNumber","bookMarkname","isRightAlign","pageRef","generateBookmarkName","formatString","onCellContentAlignment","ModifiedLevel","modified","ownerListLevelIn","modifiedListLevelIn","ownerListLevel","modifiedListLevel","ModifiedParagraphFormat","ownerFormat","ownerFormatIn","modifiedFormatIn","RowHistoryFormat","rowHeightType","revertChanges","isRedo","currentRowHeightType","TableHistoryInfo","TableFormatHistoryInfo","copyProperties","RowFormatHistoryInfo","CellFormatHistoryInfo","tableHierarchicalIndex","CellHistoryFormat","BaseHistoryInfo","ownerIn","modifiedPropertiesIn","modifiedNodeLength","removedNodesIn","actionIn","selectionStartIn","selectionEndIn","insertPositionIn","endPositionIn","revertBookmark","bookmarkInfo","recordChanges","revert","selectionStartTextPosition","selectionEndTextPosition","revertModifiedProperties","deletedNodes","insertTextPosition","isRemoveContent","isRedoAction","revertModifiedNodes","isDelete","revertResizing","revertTableDialogProperties","revertProperties","redoAction","lastNode","firstNode","insertRemovedNodes","prevTableHistoryInfo","tableHistoryInfoCurrent","currentPropertyIndex","applyTableOptionsHelper","previousFormat","currentFormat","skipRemove","prevLength","nextFormat","addModifiedPropertiesForList","previousLevel","getProperty","modifiedLevel","updateListChanges","addModifiedCellOptions","copyCellOptions","addModifiedTableOptions","copyTableOptions","getCharacterPropertyValue","previousTableFormat","resizeContainerDiv","topLeftRect","topMiddleRect","topRightRect","bottomLeftRect","bottomMiddleRect","bottomRightRect","leftMiddleRect","rightMiddleRect","topLeftRectParent","topMiddleRectParent","topRightRectParent","bottomLeftRectParent","bottomMiddleRectParent","bottomRightRectParent","leftMiddleRectParent","rightMiddleRectParent","resizeMarkSizeIn","selectedImageWidget","imageResizerPoints","ImageResizingPoints","imageResizerDiv","currentImageElementBoxIn","imageResizerDivElement","resizeDiv","initResizeMarks","currentImageElementBox","currentPageDiv","currentPageDivWidth","currentPageDivHeight","imageResizerDivWidth","imageResizerDivHeight","resizeMarkSize","setImageResizerPosition","selectedImageInfo","SelectedImageInfo","initResizeContainerDiv","opacity","setImageResizingPoints","applyPropertiesForTouch","applyPropertiesForMouse","resizeRectElement","boxShadow","handleImageResizing","points","topRightResizing","topLeftResizing","topMiddleResizing","bottomRightResizing","bottomLeftResizing","leftMiddleResizing","imageHeight","initHistoryForImageResizer","getOuterResizingPoint","getInnerResizingPoint","touchEvent","imageResizingPoints","bottomMiddle","bottomRight","bottomLeft","topMiddle","topRight","topLeft","rightMiddle","leftMiddle","touchPoints","imageResizingPointsOnTouch","selectedElements","HistoryInfo","isChild","isChildHistoryInfo","modifiedActions","addModifiedAction","undoStackIn","redoStackIn","historyInfoStack","modifiedParaFormats","undoLimitIn","redoLimitIn","redoStack","rowHistoryFormat","cellHistoryFormat","redoLimit","undoLimit","clearRedoStack","hasAction","modifiedLevelsInternal","modifiedCollection","revertListChanges","clearHistory","clearUndoStack","documentPath","stylePath","numberingPath","settingsPath","headerPath","footerPath","imagePath","appPath","corePath","contentTypesPath","generalRelationPath","wordRelationPath","headerRelationPath","footerRelationPath","xmlContentType","fontContentType","documentContentType","settingsContentType","footerContentType","headerContentType","numberingContentType","stylesContentType","webSettingsContentType","appContentType","coreContentType","customContentType","customXmlContentType","relationContentType","tableStyleContentType","settingsRelType","footerRelType","headerRelType","documentRelType","numberingRelType","stylesRelType","fontRelType","tableStyleRelType","coreRelType","appRelType","customRelType","imageRelType","hyperlinkRelType","controlRelType","packageRelType","customXmlRelType","customUIRelType","attachedTemplateRelType","wNamespace","wpNamespace","pictureNamespace","aNamespace","a14Namespace","rNamespace","rpNamespace","vNamespace","oNamespace","xmlNamespace","w10Namespace","cpNamespace","dcNamespace","docPropsNamespace","veNamespace","mNamespace","wneNamespace","customPropsNamespace","vtNamespace","chartNamespace","slNamespace","dtNamespace","wmlNamespace","w14Namespace","wpCanvasNamespace","wpDrawingNamespace","wpGroupNamespace","wpInkNamespace","wpShapeNamespace","w15Namespace","diagramNamespace","eNamespace","pNamespace","certNamespace","cRelationshipsTag","cRelationshipTag","cIdTag","cTypeTag","cTargetTag","cUserShapesTag","cExternalData","twipsInOnePoint","twentiethOfPoint","borderMultiplier","percentageFactor","emusPerPoint","cConditionalTableStyleTag","cTableFormatTag","cTowFormatTag","cCellFormatTag","cParagraphFormatTag","cCharacterFormatTag","packageType","relsPartPath","documentRelsPartPath","webSettingsPath","wordMLDocumentPath","wordMLStylePath","wordMLNumberingPath","wordMLSettingsPath","wordMLHeaderPath","wordMLFooterPath","wordMLCommentsPath","wordMLImagePath","wordMLFootnotesPath","wordMLEndnotesPath","wordMLAppPath","wordMLCorePath","wordMLCustomPath","wordMLFontTablePath","wordMLChartsPath","wordMLDefaultEmbeddingPath","wordMLEmbeddingPath","wordMLDrawingPath","wordMLThemePath","wordMLFontsPath","wordMLDiagramPath","wordMLControlPath","wordMLVbaProject","wordMLVbaData","wordMLVbaProjectPath","wordMLVbaDataPath","wordMLWebSettingsPath","wordMLCustomItemProp1Path","wordMLFootnoteRelPath","wordMLEndnoteRelPath","wordMLSettingsRelPath","wordMLNumberingRelPath","wordMLFontTableRelPath","wordMLCustomXmlPropsRelType","wordMLControlRelType","wordMLDiagramContentType","lastSection","mRelationShipID","mDocPrID","mDifferentFirstPage","mBookmarks","mDocumentImages","mExternalLinkImages","mHeaderFooterImages","mHeaderFooterColl","mArchive","then","clearDocument","setDocument","ZipArchive","compressionLevel","mVerticalMerge","mGridSpans","serializeDocument","serializeStyles","serializeNumberings","serializeSettings","serializeCoreProperties","serializeAppProperties","serializeFontTable","contenttype","serializeSettingsRelation","serializeHeaderFooters","serializeDocumentRelations","serializeGeneralRelations","serializeContentTypes","mSections","mLists","mAbstractLists","defCharacterFormat","defParagraphFormat","defaultTabWidthValue","mStyles","blockOwner","writer","XmlWriter","writeStartElement","writeCommonAttributeStrings","serializeDocumentBody","writeEndElement","archiveItem","ZipArchiveItem","buffer","addItem","writeAttributeString","writeCustom","writeDup","last","serializeBodyItems","serializeSectionProperties","serializeHFReference","serializeSectionType","serializePageSetup","serializeColumns","pageSetup","serializePageSize","serializePageMargins","roundToTwoDecimal","marginValue","sectionBreakCode","hfId","hf","getNextRelationShipID","addHeaderFooter","hfType","hfColl","blockCollection","isLastSection","serializeBodyItem","sec","serializeParagraphItems","paraItems","serializeFieldCharacter","serializePicture","serializeBookMark","serializeTextRange","bookmarkId","getBookmarkId","serializeDrawing","serializeInlinePicture","cx","cy","serializeDrawingGraphics","startsWith","sourceString","startString","picture","updateShapeId","documentImages","externalImages","tOwner","updateHFImageRels","addImageRelation","imageCollection","relationId","headerId","types","hfKeys","headerImages","headerFooterImages","serializeTableFormat","serializeTableGrid","serializeTableRows","grid","serializeGridColumns","serializeRowFormat","serializeCells","pointWidth","serializeCellFormat","itemIndex","serializeCellWidth","serializeCellMerge","serializeGridSpan","serializeBorders","serializeShading","serializeTableCellDirection","serializeCellVerticalAlign","cf","collKey","isserialized","createMerge","serializeColumnSpan","checkMergeCell","num","alignment","gridValue","serializeTableWidth","serializeTableAlignment","serializeCellSpacing","serializeTableIndentation","serializeTableBorders","serializeTblLayout","getTextureStyle","multipler","serializeBorder","tagName","multiplier","sz","getBorderStyle","tableIndent","writeElementString","isField","writeString","serializeListFormat","serializeParagraphSpacing","serializeIndentation","serializeParagraphAlignment","serializeTabs","serializeTab","getTabJustification","lf","txtAlignment","serializeDefaultStyles","serializeDocumentStyles","zipArchiveItem","serializeBoolProperty","getHighlightColor","getUnderlineStyle","underlineStyle","tag","serializeAbstractListStyles","serializeListInstances","listStyles","generateHex","ilvl","cnt","serializeListLevel","random","levelIndex","getLevelPattern","serializeLevelFollow","serializeLevelText","patternType","lvlIndex","fc","tabWidth","contentType","serializeHeaderFooter","headerFooterPath","headerFooterRelsPath","serializeHeader","serializeFooter","writeHFCommonAttributes","serializeHFRelations","serializeImagesRelations","serializeRelationShip","serializeHeaderFooterRelations","images","base64ImageString","extension","formatClippedString","imageBlob","encodedString","input","chr1","chr2","chr3","enc2","enc3","enc4","keyStr","resultIndex","totalLength","output","Uint8Array","serializeExternalLinkImages","serializeHFRelation","relType","relationshipID","relationshipType","targetPath","resetRelationShipID","serializeDefaultContentType","serializeOverrideContentType","serializeHFContentTypes","serializeHeaderFootersContentType","partName","curSectionIndex","inField","StreamWriter","writeInternal","streamWriter","sectionCount","updateLastParagraph","writeBody","writeNewLine","writeSectionEnd","writeHeadersFooters","bodyItemsCount","bodyItem","isLastPara","writeParagraph","writeTable","writeText","writeHeaderFooter","writeLine","paragraphs","pCount","writeInlineStyles","writeParagraphFormat","endPara","createSection","createParagraph","writeBodyWidget","writeStyles","writeLists","doc","writeHeaderFooters","writeBlock","writeNextBlock","writeLines","writeInlines","writeInline","isEnd","started","ended","writeListFormat","writeTabs","listIdValue","writeRow","createRow","writeCell","createCell","writeTableFormat","writeRowFormat","writeCellFormat","writeShading","wShading","writeBorder","wBorder","writeBorders","wBorders","wCellFormat","wRowFormat","wTableFormat","writeStyle","writeList","writeAbstractList","wAbstractList","writeListLevel","wList","wListLevel","navigationUrl","bookmarkDropdown","bookmarkCheckbox","onKeyUpOnUrlBox","displayTextBox","urlTextBox","onInsertHyperlink","urlValue","enableOrDisableInsertButton","onKeyUpOnDisplayBox","onInsertButtonClick","onCancelButtonClick","dialog","clearValue","loadHyperlinkDialog","localObj","bookmarkDiv","addressText","dataSource","insertButton","closeHyperlinkDialog","onUseBookmarkChange","onBookmarkchange","instance","autofocus","bookmarkText","bookmarkTextElement","bookmarkValue","DropDownList","popupHeight","noRecordsTemplate","bookmarkCheckDiv","bookmarkCheck","buttons","buttonModel","cssClass","isPrimary","dataBind","address","keyUpInsertTable","rowsCountBox","columnsCountBox","onInsertTableClick","rowValueTextBox","columnValueTexBox","columnContainer","columnValue","rowContainer","rowValue","NumericTextBox","enablePersistence","addBookmark","textBoxInput","selectHandler","setSelectionRange","gotoBookmark","initBookmarkDialog","headerValue","dlgFields","commonDiv","textBoxDiv","listviewDiv","listviewInstance","ListView","buttonDiv","addbuttonDiv","addButtonElement","Button","deleteButtonDiv","deleteButtonElement","gotoButtonDiv","gotoButtonElement","removeObjects","bind","loadTableofContentDialog","enabled","showLevel","closeTableOfContentDialog","unWireEventsAndBindings","changeShowLevelValue","changeByValue","headings","heading1","heading2","heading3","heading4","heading5","heading6","heading7","heading8","heading9","reset","normal","changeStyle","headingValue","srcElement","getElementValue","checkLevel","changeHeadingStyle","changePageNumberValue","changeRightAlignValue","changeStyleValue","applyTableOfContentProperties","applyLevelSetting","ownerId","generalDiv","genLabel","leftGeneralDiv","rightGeneralDiv","leftBottomGeneralDiv","rightBottomGeneralDiv","pageNumberDiv","rightAlignDiv","tabDiv","tabLeaderLabelDiv","tabLeaderLabel","tabLeaderDiv","showDiv","showLevelLabelDiv","showLevelLabel","showLevelDiv","buildTableDiv","buildTableLabel","tr1","td1","availableLabel","td2","tocLabel","tableDiv","table1","tr2","td3","heading1Label","td4","tr3","td5","heading2Label","td6","tr4","td7","heading3Label","td8","tr5","td9","heading4Label","td10","tr6","td11","heading5Label","td12","tr7","td13","heading6Label","td14","tr8","td15","heading7Label","td16","tr9","td17","heading8Label","td18","tr10","td19","heading9Label","td20","tr12","td23","normalLabel","td24","stylesLevelDiv","fieldsDiv","outDiv","outlineDiv","resetButtonDiv","resetElement","tocStylesDiv","tocStylesLabel","listViewDiv","styleValues","listViewInstance","modifyButtonDiv","modifyElement","getHeadingLevel","newStartLevel","newEndLevel","isEndLevel","isPortrait","loadPageSetupDialog","topMarginBox","leftMarginBox","bottomMarginBox","rightMarginBox","widthBox","heightBox","checkBox1","checkBox2","headerBox","footerBox","landscape","portrait","closePageSetupDialog","keyUpInsertPageSettings","applyPageSetupProperties","changeByPaperSize","paperSize","ejtabContainer","marginTab","paperTab","layoutTab","ejtab","headerContainer","marginHeader","paperHeader","layoutHeader","contentContainer","marginContent","paperContent","layoutContent","initMarginProperties","initPaperSizeProperties","initLayoutProperties","tabObj","marginDiv","leftMarginDiv","rightMarginDiv","topLabel","topTextBox","bottomBoxLabel","bottomTextBox","leftBoxLabel","leftTextBox","rightLabel","rightTextBox","decimals","orientationDiv","orientationLabeldiv","orientationPropDiv","portraitDiv","landscapeDiv","RadioButton","sizeDiv","leftSizeDiv","rightSizeDiv","widthLabel","widthTextBox","heightLabel","heightTextBox","paperSizeDiv","layoutDiv","firstPageDiv","oddOrEvenDiv","textLabelDiv","textLabel","propertyDiv","leftLayoutDiv","rightLayoutDiv","headerLabel","footerLabel","keyUpParagraphSettings","applyParagraphFormat","changeBeforeSpacing","changeAfterSpacing","changeLeftIndent","changeRightIndent","changeLineSpacingValue","changeFirstLineIndent","changeByTextAlignment","special","byIn","changeBySpacing","atIn","loadParagraphDialog","selectionFormat","alignValue","lineSpaceValue","isApply","onParagraphFormat","closeParagraphDialog","alignLabel","indentionDiv","leftIndentionDiv","rightIndentionDiv","spacingDiv","leftSpacingDiv","rightSpacingDiv","indentLabel","beforeTextLabel","specialLabel","afterTextLabel","byLabel","by","spaceLabel","beforeLabel","lineSpaceLabel","afterLabel","atLabel","lineSpacingAt","step","local","q","ListViewModel","listIn","levelNumberIn","createList","listLevelAdv","viewModel","textIndent","alignedAt","listLevelElement","followNumberWith","numberStyle","restartBy","isListCharacterFormat","onTextIndentChanged","onStartValueChanged","onListLevelValueChanged","updateDialogValues","updateRestartLevelBox","onNumberFormatChanged","onAlignedAtValueChanged","onFollowCharacterValueChanged","onLevelPatternValueChanged","numberFormatTextBox","loadListDialog","dialog2","disposeBindingForListUI","closeListDialog","listLevelDiv","numberStyleDiv","numberFormatDiv","indentsDiv","startAtTextBox","textIndentAtTextBox","alignedAtTextBox","followCharacterElement","numberStyleEle","restartElement","formatInfoToolTip","Tooltip","option_1","listPatternConverter","followCharacterConverter","l","styleBasedOn","styleParagraph","onlyThisDocument","template","openDialog","showNumberingBulletDialog","setBoldProperty","fontButtonClicked","setItalicProperty","setUnderlineProperty","fontSizeUpdate","fontFamilyChanged","fontColorUpdate","currentValue","rgba","setLeftAlignment","setRightAlignment","setCenterAlignment","setJustifyAlignment","increaseBeforeAfterSpacing","decreaseBeforeAfterSpacing","updateNextStyle","typedName","getTypeValue","isUserNextParaUpdated","isEdit","editStyleName","updateOkButton","enableOrDisableOkButton","styleTypeChange","isInteracted","toggleDisable","updateStyleNames","styleBasedOnChange","styleParagraphChange","numberingBulletDialog","showNumberBulletDialog","onOkButtonClick","styleNameElement","updateList","createLinkStyle","loadStyleDialog","okButton","closeStyleDialog","properties","styleNameTypeDiv","nameWholeDiv","nameValue","styleTypeWholeDiv","styleTypeDivElement","styleTypeValue","styleBasedParaDiv","styleBasedOnWholeDiv","styleBasedOnDivElement","styleBasedOnValue","styleParagraphWholeDiv","styleParagraphDivElement","styleParagraphValue","formatting","optionsDiv","fontOptionsDiv","createFontOptions","paragraphOptionsDiv","createParagraphOptions","createFormatDropdown","formatBtn","dropDownbtn","DropDownButton","beforeItemRender","fontFamilyElement","ComboBox","popupWidth","showClearButton","fontSizeElement","sizeDataSource","fontGroupButton","createButtonElement","fontColorElement","ColorPicker","alignmentDiv","leftAlign","centerAlign","lineSpacingDiv","singleLineSpacing","onePointFiveLineSpacing","doubleLineSpacing","indentingDiv","buttonElement","removeAttribute","paragraphFOrmat","nxtName","basedOnIndex","numberListClick","setActiveElement","currentTarget","bulletListClick","symbol","loadNumberingBulletDialog","closeNumberingBulletDialog","initNumberingBulletDialog","tabTarget","createNumberList","createBulletList","heightAdjustMode","refresh","numberListDiv","ulTag","numberedNone","createNumberNoneListTag","numberedNumberDot","createNumberListTag","numberedNumberBrace","numberedUpRoman","numberedUpLettter","numberedLowLetterDot","numberedLowLetterBrace","numberedLowRoman","text1","text2","text3","liTag","liInnerDiv","cssFloat","createBulletListTag","liNextDiv","bulletListDiv","bulletNone","bulletDot","bulletCircle","bulletSquare","bulletFlower","bulletArrow","bulletTick","childElementCount","fontStyleInternal","fontNameList","fontStyleText","fontSizeText","colorPicker","underlineDrop","strikethroughBox","doublestrikethrough","superscript","subscript","loadFontDialog","getItems","closeFontDialog","onInsertFontFormat","onCharacterFormat","fontStyleUpdate","fontFamilyUpdate","underlineUpdate","hex","singleStrikeUpdate","enableCheckBoxProperty","doubleStrikeUpdate","superscriptUpdate","subscriptUpdate","createInputElement","effectLabel","strikeThroughElement","superScriptElement","subScriptElement","doubleStrikeThroughElement","fontDiv","getFontDiv","getFontSizeDiv","colorDiv","fontColorDiv","fontColorLabel","fontEffectsDiv","fontEffectSubDiv1","fontEffectSubDiv2","sizeSubDiv1","sizeLabel","underlineElement","sizeSubDiv2","underlineLabel","fontSubDiv1","fontNameLabel","fontNameValues","fontSubDiv2","fontStyleLabel","fontStyleValues","hasCellWidth","isTableBordersAndShadingUpdated","isCellBordersAndShadingUpdated","isCellOptionsUpdated","isTableOptionsUpdated","onBeforeOpen","loadTableProperties","onCloseTablePropertyDialog","applyTableProperties","preferCheckBox","indeterminate","rowHeightCheckBox","preferredCellWidthCheckBox","rowHeightValue","closeTablePropertiesDialog","applyTableSubProperties","applySubCellOptions","applySubTableOptions","tableWidthBox","tableWidthType","leftIndentBox","rowHeightBox","repeatHeader","allowRowBreak","cellWidthBox","cellWidthType","changeTableCheckBox","enable","changeTableAlignment","updateClassForAlignmentProperties","tableTab","getTableAlignment","changeTableRowCheckBox","changeTableCellCheckBox","changeCellAlignment","updateClassForCellAlignment","cellTab","getCellAlignment","showBordersShadingsPropertiesDialog","rowFormatInternal","rowTab","separatorLine","tableHeader","rowHeader","cellHeader","tableContent","rowContent","cellContent","initTableProperties","initTableRowProperties","initTableCellProperties","alignMentButtons","cellAlignment","calculateGridValue","setTableProperties","setTableRowProperties","setTableCellProperties","bordersAndShadingButton","tableOptionButton","cellOptionButton","onTableWidthChange","onTableWidthTypeChange","onLeftIndentChange","onRowHeightChange","onRowHeightTypeChange","onAllowBreakAcrossPage","onRepeatHeader","onCellWidthChange","onCellWidthTypeChange","sizeHeader","parentContainer","childContainer1","childContainer2","child1","child2","childContainer3","controlDiv","labeltext","alignmentHeader","alignmentContainer","classDivName","leftAlignDiv","centerAlignDiv","center","leftlabel","centerlabel","rightlabel","leftIndenetContainer","leftIndentLabel","tableOptionContiner","formatNumericTextBox","tableHasWidth","groupButtons","groupButton","rowDiv","sizeLabeldiv","childDiv1","childdiv2","child3","child4","allowRowContainer","repeatHeaderContaniner","enableRowHeight","parentdiv","childdiv1","preferredCellWidth","divAlignment","divStyle","topAlignDiv","cellTopAlign","cellCenterAlign","bottomAlignDiv","cellBottomAlign","centerLabel","bottomLabel","cellAlignments","applyBordersShadingsProperties","tablePropertiesDialog","checkClassName","previewDivTopTop","previewDivTopBottom","previewDivTopCenter","previewDivBottomcenter","previewDivBottomLeft","previewDivBottomRight","previewDivDiagonalRight","previewDivLeftDiagonal","shadingColorPicker","ulelementShading","applyTo","noneDiv","currentTableFormat","closeDialog","closeBordersShadingsDialog","handleSettingCheckBoxAction","targetId","tableBorderDialogId","updateClassForSettingDivElements","setSettingPreviewDivElement","boxDiv","allDiv","customDiv","handlePreviewCheckBoxAction","compareClass","handlePreviewCheckBoxShowHide","showHidePreviewDivElements","applyTableCellPreviewBoxes","previewDivBottomcenterContainer","previewDivTopCenterContainer","previewVerticalDiv","previewHorizontalDiv","previewDivBottomRightContainer","applyPreviewTableBackgroundColor","previewDiv","applyPreviewTableBorderColor","previewRightDiagonalDiv","previewLeftDiagonalDiv","settingsContiner","styleContainer","previewContiner","styleText","dropDownList","widthText","widthNumeric","colorText","borderColorPickerElement","settingText","noneDivContainer","noneDivLabel","boxDivContainer","boxDivLabel","allDivContainer","allDivLabel","customDivContainer","customDivLabel","noneDivTransparent","boxDivTransparent","allDivTransparent","customDivTransparent","previewText","previewDivTopTopContainer","previewDivTopBottomContainer","previewDivLeftDiagonalContainer","previewDivBottomLeftContainer","previewDivDiagonalRightContainer","previewDivTopTopTransParent","previewDivTopCenterTransParent","previewDivTopBottomTransParent","previewDivLeftDiagonalTransParent","previewDivBottomLeftTransparent","previewDivBottomcenterTransparent","previewDivBottomRightTransparent","previewDivDiagonalRightTransparent","shadingContiner","shadingText","shadings","shadingColorPickerElement","shdApply","divsion","borderColorPicker","loadBordersShadingsPropertiesDialog","settingDivs","tempClassName","isShowHidePreviewTableElements","settingDiv","elementClass","compareElementClass","setElement","compareElement","setPropertyPreviewDivElement","ele","fillColor","cloneBorders","getLineStyle","colorPickerEvent","fillColorEvent","horizontalBorder","verticalBorder","diagonalDownBorder","customBorder","diagonalUpBorder","applyTableCellProperties","cellSpaceTextBox","applyTableOptions","closeCellMarginsDialog","changeAllowSpaceCheckBox","allowSpaceCheckBox","removeEvents","innerDiv","innerDivLabel","getCellMarginDialogElements","cellSpaceLabel","table2","cellspacingTextBox","divBtn","loadCellMarginsDialog","applyTableOptionsHistory","applySubTableOptionsHelper","documentLocale","changeSameAsTable","sameAsTableCheckBox","tr","td","localizeValue","sameAsTable","loadCellProperties","enableTextBox","enableCheckBox","applyCellMarginsInternal","applyCellMarginsForCells","rowCells","iterateCells","applySubCellMargins","leftLabel","defaultStyleNames","v","modifyStyles","addNewStyles","initStylesDialog","newButtonDiv","newButtonElement","modifybuttonDiv","modifyButtonElement","hideObjects"],"mappings":"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"}