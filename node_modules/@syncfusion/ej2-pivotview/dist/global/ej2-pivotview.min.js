/*!
*  filename: ej2-pivotview.min.js
*  version : 16.3.24
*  Copyright Syncfusion Inc. 2001 - 2018. All rights reserved.
*  Use of this code is subject to the terms of our license.
*  A copy of the current license can be obtained at any time by e-mailing
*  licensing@syncfusion.com. Any infringement will be prosecuted under
*  applicable laws. 
*/
this.ej=this.ej||{},this.ej.pivotview=function(e,t,i,r,a,n,o,l,s,d,p,h){"use strict";var c=function(){function e(){}return e.getType=function(e){return e&&e.getDay?e.getHours()>0||e.getMinutes()>0||e.getSeconds()>0||e.getMilliseconds()>0?"datetime":"date":typeof e},e.resetTime=function(e){return e.setHours(0,0,0,0),e},e}(),u=function(){function e(e,i,r,a,n){this.formatFields={},this.calculatedFields={},this.calculatedFormulas={},this.valueAxis=0,this.saveDataHeaders={},this.columnCount=0,this.rowCount=0,this.colFirstLvl=0,this.rowFirstLvl=0,this.rowStartPos=0,this.colStartPos=0,this.enableValueSorting=!1,this.headerCollection={rowHeaders:[],columnHeaders:[],rowHeadersCount:0,columnHeadersCount:0},this.valueMatrix=[],this.indexMatrix=[],this.rMembers=[],this.cMembers=[],this.memberCnt=-1,this.pageInLimit=!1,this.endPos=0,this.colHdrBufferCalculated=!1,this.colValuesLength=1,this.rowValuesLength=1,this.slicedHeaders=[],this.fieldFilterMem={},this.filterPosObj={};var o;return this.globalize=new t.Internationalization,this.enableSort=e.enableSorting,this.allowValueFilter=e.allowValueFilter,this.isValueFilterEnabled=!1,this.enableValueSorting=n,o=e.data[0],this.fields=Object.keys(o),this.rows=e.rows?e.rows:[],this.columns=e.columns?e.columns:[],this.filters=e.filters?e.filters:[],this.formats=e.formatSettings?e.formatSettings:[],this.values=e.values?e.values:[],this.calculatedFieldSettings=e.calculatedFieldSettings?e.calculatedFieldSettings:[],this.enableSort=void 0===e.enableSorting||e.enableSorting,this.validateFilters(e),this.isExpandAll=!(!this.isValueFiltersAvail||!e.allowValueFilter)||e.expandAll,this.drilledMembers=e.drilledMembers?this.isValueFiltersAvail&&e.allowValueFilter?[]:e.drilledMembers:[],this.isMutiMeasures=this.values.length>1,this.valueAxis="row"===e.valueAxis?1:0,this.rowValuesLength=1===this.valueAxis?this.values.length:1,this.colValuesLength=0===this.valueAxis?this.values.length:1,this.valueSortSettings=e.valueSortSettings||{sortOrder:"None",headerDelimiter:".",headerText:"",columnIndex:void 0},this.valueSortData=[],this.savedFieldList=r,this.getFieldList(o,this.enableSort,e.allowValueFilter),this.fillFieldMembers(e.data,this.indexMatrix),this.updateSortSettings(e.sortSettings,this.enableSort),this.pageSettings=a||this.pageSettings,this.valueMatrix=this.generateValueMatrix(e.data),this.filterMembers=[],this.updateFilterMembers(e),this.generateGridData(e),this}return e.prototype.getFormattedFields=function(e){for(var t=this.formats.length;t--;)this.formatFields[this.formats[t].name]=this.formats[t]},e.prototype.getFieldList=function(e,i,r){var a,n=this.fields,o=t.extend([],this.rows,null,!0);o=o.concat(this.columns,this.values,this.filters),this.getFormattedFields(o),this.getCalculatedField(n);var l=n.length;if(this.savedFieldList)for(this.fieldList=this.savedFieldList;l--;){s=n[l];this.fieldList[s]?(this.fieldList[s].isSelected=!1,this.fieldList[s].index=l,this.fieldList[s].filter=[],this.fieldList[s].isExcelFilter=!1,this.isValueFiltersAvail&&r&&(this.fieldList[s].dateMember=[],this.fieldList[s].formattedMembers={},this.fieldList[s].members={})):this.fieldList[s]={id:s,caption:s,type:void 0===a||"undefined"===a?"number":a,index:l,filter:[],sort:i?"Ascending":"None",isSelected:!1}}else for(;l--;){var s=n[l];a=c.getType(e[s]),this.fieldList||(this.fieldList={}),this.fieldList[s]={id:s,caption:s,type:void 0===a||"undefined"===a?"number":a,index:l,filter:[],sort:i?"Ascending":"None",isSelected:!1}}this.updateTreeViewData(o)},e.prototype.updateFieldList=function(e){for(var t=this.fields,i=t.length;i--;)this.fieldList[t[i]].isExcelFilter=e[t[i]].isExcelFilter},e.prototype.updateTreeViewData=function(e){for(var t=e.length,i=this.calculatedFieldSettings.length;t--;)this.fieldList[e[t].name]&&(this.fieldList[e[t].name].caption=e[t].caption?e[t].caption:e[t].name,this.fieldList[e[t].name].isSelected=!0,this.fieldList[e[t].name].aggregateType=e[t].type,this.fieldList[e[t].name].showNoDataItems=e[t].showNoDataItems);for(;i--;)this.fieldList[this.calculatedFieldSettings[i].name].aggregateType="CalculatedField",this.fieldList[this.calculatedFieldSettings[i].name].formula=this.calculatedFieldSettings[i].formula},e.prototype.getCalculatedField=function(e){for(var i=0,r=this.calculatedFieldSettings;i<r.length;i++){var a=r[i];this.calculatedFields[a.name]=t.extend({},a,null,!0),this.calculatedFields[a.name].actualFormula=a.formula}for(var n=Object.keys(this.calculatedFields),o=0,l=n.length;o<l;o++){var s=(a=this.calculatedFields[n[o]]).properties,d=(s?s.formula:a.formula).replace(/ +/g,""),p=d.replace(/"/g,"");a.formula=p.indexOf("^")>-1?this.powerFunction(p):p,a.name=s?s.name:a.name,e.push(a.name);for(var h=d.split('"'),c=0,u=h.length;c<u;c++){var m=h[c],g=m.split(/[ .:;?!~,`"&|()<>{}\[\]\r\n\/\\]+/);if(-1!==["Sum","Count","Min","Max","Avg"].indexOf(g[0])){var v=e.indexOf(g[1]);this.calculatedFormulas[a.name]?this.calculatedFormulas[a.name].push({index:v,type:g[0],formula:m}):this.calculatedFormulas[a.name]=[{index:v,type:g[0],formula:m}]}}}},e.prototype.validateFilters=function(e){this.isValueFiltersAvail=!1;var i=e.filterSettings?e.filterSettings:[],r=t.extend([],this.rows,null,!0);r=r.concat(this.columns);for(var a=0,n=i;a<n.length;a++){for(var o=n[a],l=0,s=r;l<s.length;l++){var d=s[l];if(o.name===d.name&&"Value"===o.type){this.isValueFiltersAvail=!0;break}}if(this.isValueFiltersAvail)break}},e.prototype.fillFieldMembers=function(e,t){for(var i=this.fields,r=e.length,a=this.fieldList,n=i.length,o=0;o<n;o++){var l=i[o];a[l].members||(a[l].members={}),a[l].formattedMembers||(a[l].formattedMembers={}),a[l].dateMember||(a[l].dateMember=[]);for(var s=a[l].members,d=Object.keys(s).length>0,p=a[l].formattedMembers,h=a[l].dateMember,c=0,u=0,m=0;m<r;m++){var g=e[m][l];if(!d){var v=g,f=this.getFormattedValue(g,l);f.formattedText&&(v=f.formattedText),s.hasOwnProperty(g)?s[g].index.push(m):(c++,s[g]={index:[m],ordinal:c,isDrilled:!!this.isExpandAll},h.push({formattedText:f.formattedText,actualText:f.actualText})),p.hasOwnProperty(v)?p[v].index.push(m):(u++,p[v]={index:[m],ordinal:u,isDrilled:!!this.isExpandAll})}t[m]?t[m][o]=s[g].ordinal:(t[m]=[],t[m][o]=s[g].ordinal)}}this.fillDrilledInfo()},e.prototype.fillDrilledInfo=function(){for(var e=0;e<this.drilledMembers.length;e++)for(var t=this.drilledMembers[e].name,i=0;i<this.drilledMembers[e].items.length;i++){var r=this.drilledMembers[e].items[i],a=this.fieldList[t];a&&a.members[r]&&(a.members[r].isDrilled=!this.isExpandAll)}},e.prototype.generateValueMatrix=function(e){for(var t=this.fields,i=e.length,r=[],a=t.length,n=this.fieldList;i--;){e[i];var o=a;for(r[i]=[];o--;){var l=t[o];r[i][o]="number"===n[l].type?e[i][l]:1}}return r},e.prototype.updateSortSettings=function(e,t){for(var i=0,r=e?e.length:0;i<r&&t;i++)this.fieldList[e[i].name].sort=e[i].order},e.prototype.updateFilterMembers=function(e){var t=this.filterMembers,i={},r=this.getFilters(e,i),a=this.indexMatrix.length;if(r)for(var n=i.include.index,o=0;o<n.length;o++)void 0!==i.exclude&&void 0!==i.exclude.indexObject[n[o]]||t.push(n[o]);else for(o=0;o<a;o++)void 0!==i.exclude&&void 0!==i.exclude.indexObject[o]||t.push(o)},e.prototype.getFilters=function(e,t){for(var i=e.filterSettings?e.filterSettings:[],r=(this.filters,!1),a=[],n=0,o=i.length;n<o;n++){var l=i[n].properties?i[n].properties:i[n];this.fieldList[l.name].isSelected&&this.isValidFilterField(l,e.allowLabelFilter)&&(this.applyLabelFilter(l),a=l?l.items:[],l.type&&"Include"===l.type?(this.frameFilterList(a,l.name,t,"include",l.showLabelFilter,r),r=!0):this.frameFilterList(a,l.name,t,"exclude",l.showLabelFilter),l.showLabelFilter&&(l.items=[],l.type=l.showDateFilter?"Date":l.showNumberFilter?"Number":"Label"))}return r},e.prototype.isValidFilterField=function(e,i){var r=!1,a=["Include","Exclude"],n=t.extend([],this.rows,null,!0);if(n=n.concat(this.columns),this.fieldList[e.name].isSelected&&a.indexOf(e.type)>=0){for(var o=!1,l=0,s=this.values;l<s.length;l++){h=s[l];if(e.name===h.name){o=!0;break}}o||(r=!0)}else for(var d=0,p=n;d<p.length;d++){var h=p[d];if(e.name===h.name&&i&&["Label","Date","Number"].indexOf(e.type)>=0){r=!0;break}}return r},e.prototype.applyLabelFilter=function(e){if(["Label","Date","Number"].indexOf(e.type)>=0){var t=Object.keys(this.fieldList[e.name].members);if(e.showLabelFilter=!0,"Label"===e.type)e.items=this.getLabelFilterMembers(t,e.condition,e.value1,e.value2);else if("Date"===e.type)e.showDateFilter=!0,e.items=this.getDateFilterMembers(t,e.name,e.condition,e.value1,e.value2);else{e.showNumberFilter=!0,e.items=[];for(var i=0,r=t;i<r.length;i++){var a=r[i],n=this.getParsedValue(e.name,e.value1),o=this.getParsedValue(e.name,e.value2);this.validateFilterValue(parseInt(a,10),e.condition,n,o)&&e.items.push(a)}}var l=["DoesNotBeginWith","DoesNotContains","DoesNotEndsWith","DoesNotEquals","NotBetween"];e.type=l.indexOf(e.condition)>-1&&!e.showNumberFilter?"Exclude":"Include"}else e.showLabelFilter=!1},e.prototype.getLabelFilterMembers=function(e,t,i,r){for(var a=[],n=0,o=e;n<o.length;n++){var l=o[n],s=l.toLowerCase();if(i.toString())switch(t){case"Equals":case"DoesNotEquals":s===i.toLowerCase()&&a.push(l);break;case"BeginWith":case"DoesNotBeginWith":0===s.indexOf(i.toLowerCase())&&a.push(l);break;case"EndsWith":case"DoesNotEndsWith":null!=s.match(i.toLowerCase()+"$")&&a.push(l);break;case"Contains":case"DoesNotContains":s.indexOf(i.toLowerCase())>-1&&a.push(l);break;case"GreaterThan":s>i.toLowerCase()&&a.push(l);break;case"GreaterThanOrEqualTo":s>=i.toLowerCase()&&a.push(l);break;case"LessThan":s<i.toLowerCase()&&a.push(l);break;case"LessThanOrEqualTo":s<=i.toLowerCase()&&a.push(l);break;case"Between":case"NotBetween":s>=i.toLowerCase()&&s<=r.toLowerCase()&&a.push(l)}}return a},e.prototype.getDateFilterMembers=function(e,t,i,r,a){for(var n=[],o=0,l=e;o<l.length;o++){var s=l[o],d=new Date(s);if(r)switch(i){case"Equals":case"DoesNotEquals":c.resetTime(d).getTime()===c.resetTime(r).getTime()&&n.push(this.getFormattedValue(s,t).formattedText);break;case"After":c.resetTime(d).getTime()>c.resetTime(r).getTime()&&n.push(this.getFormattedValue(s,t).formattedText);break;case"AfterOrEqualTo":c.resetTime(d).getTime()>=c.resetTime(r).getTime()&&n.push(this.getFormattedValue(s,t).formattedText);break;case"Before":c.resetTime(d).getTime()<c.resetTime(r).getTime()&&n.push(this.getFormattedValue(s,t).formattedText);break;case"BeforeOrEqualTo":c.resetTime(d).getTime()<=c.resetTime(r).getTime()&&n.push(this.getFormattedValue(s,t).formattedText);break;case"Between":case"NotBetween":c.resetTime(d).getTime()>=c.resetTime(r).getTime()&&c.resetTime(d).getTime()<=c.resetTime(a).getTime()&&n.push(this.getFormattedValue(s,t).formattedText)}}return n},e.prototype.validateFilterValue=function(e,t,i,r){var a=!1;if("number"==typeof i)switch(t){case"Equals":e===i&&(a=!0);break;case"DoesNotEquals":e!==i&&(a=!0);break;case"GreaterThan":e>i&&(a=!0);break;case"GreaterThanOrEqualTo":e>=i&&(a=!0);break;case"LessThan":e<i&&(a=!0);break;case"LessThanOrEqualTo":e<=i&&(a=!0);break;case"Between":e>=i&&e<=r&&(a=!0);break;case"NotBetween":e>=i&&e<=r||(a=!0)}return a},e.prototype.frameFilterList=function(e,t,i,r,a,n){var o=this,l=function(){var l=0,s=o.fieldList[t];s.filter=e,s.type=r,s.isExcelFilter=a;var d=s.formattedMembers,p=n,h={},c={};for(h[r]={indexObject:{},index:[]},o.fieldFilterMem[t]={memberObj:{}};e[l];){var u=d[e[l]].index;if("include"===r)for(var m=0,g=u.length;m<g;m++)p&&void 0===i[r].indexObject[u[m]]||(h[r].indexObject[u[m]]=u[m],h[r].index.push(u[m]));else{for(var m=0,g=u.length;m<g;m++)void 0===i[r].indexObject[u[m]]&&(i[r].indexObject[u[m]]=u[m],i[r].index.push(u[m]));o.fieldFilterMem[t].memberObj[e[l]]=e[l]}l++}if("include"===r){i[r]=h[r];for(m=0;m<e.length;m++)c[e[m]]=e[m];for(var v=Object.keys(d),m=0,g=v.length;m<g;m++)void 0===c[v[m]]&&(o.fieldFilterMem[t].memberObj[v[m]]=v[m])}};i[r]?l():(i[r]={indexObject:{},index:[]},l())},e.prototype.applyValueFiltering=function(e,i,r,a,n,o,l){this.isValueFiltered=!1;var s=t.extend({},r[r.length-1],null,!0);return this.getFilteredData(r,a,n,o,i,e.name,s,l),this.isValueFiltered&&(o.push(s),r=o),r},e.prototype.getFilteredData=function(e,i,r,a,n,o,l,s){for(var d=e.length,p=0;p<d;p++)if(r[o])if(e[p].level===n){this.isValueFiltered=!0,this.fieldList[o].isExcelFilter=!0;var h=0,c=r[o].measure,u=this.fieldList[c].index,m=this.fieldList[c].aggregateType;h="row"===s?this.getAggregateValue(e[p].index,i.indexObject,u,m):this.getAggregateValue(i.index,e[p].indexObject,u,m);var g=this.getParsedValue(c,r[o].value1),v=this.getParsedValue(c,r[o].value2);if(this.validateFilterValue(h,r[o].condition,g,v)||"grand sum"===e[p].type)"grand sum"!==e[p].type&&(a.push(t.extend({},e[p],null,!0)),a[a.length-1].isLevelFiltered=!0);else{var f=this.removefilteredData(e[p],this.valueFilteredData),y=f||e[p];this.validateFilteredParentData(y,this.valueFilteredData,l,0,n,s)}}else e[p].hasChild&&e[p].members.length>0&&"grand sum"!==e[p].type&&(a.push(t.extend({},e[p],null,!0)),a[a.length-1].members=[],a[a.length-1].isLevelFiltered=!0,this.getFilteredData(e[p].members,i,r,a[a.length-1].members,n,o,l,s))},e.prototype.getParsedValue=function(e,i){if(this.formatFields[e]&&i){var r=t.extend({},this.formatFields[e],null,!0);return delete r.name,this.globalize.parseNumber(i,r)}return parseInt(i,10)},e.prototype.removefilteredData=function(e,i){for(var r,a=t.extend([],i,null,!0),n=0;n<a.length;n++){if(e.isLevelFiltered&&e.axis===a[n].axis&&e.valueSort.levelName===a[n].valueSort.levelName&&e.actualText===a[n].actualText&&e.axis===a[n].axis&&e.level===a[n].level&&e.ordinal===a[n].ordinal){r=a[n],i.splice(n,1);break}i[n].hasChild&&i[n].members.length>0&&this.removefilteredData(e,i[n].members)}return r},e.prototype.validateFilteredParentData=function(e,t,i,r,a,n){if(t.length>0)for(var o=0,l=t;o<l.length;o++){var s=l[o];if(s.level===r){if("row"===n)for(var d=0,p=h=e.index;d<p.length;d++){y=p[d];i.index.indexOf(y)>=0&&i.index.splice(i.index.indexOf(y),1),e.valueSort.levelName.toString().indexOf(s.valueSort.levelName.toString())>=0&&s.level!==a&&s.index.indexOf(y)>=0&&s.index.splice(s.index.indexOf(y),1)}else for(var h=e.indexObject,c=0,u=Object.keys(h);c<u.length;c++){y=u[c];h.hasOwnProperty(y)&&(delete i.indexObject[y],e.valueSort.levelName.toString().indexOf(s.valueSort.levelName.toString())>=0&&s.level!==a&&delete s.indexObject[y])}s&&s.members.length>0&&s.members[0].level===r+1&&s.members[0].level!==a&&this.validateFilteredParentData(e,s.members,i,r+1,a,n)}}else if("row"===n)for(var m=0,g=h=e.index;m<g.length;m++){y=g[m];i.index.indexOf(y)>=0&&i.index.splice(i.index.indexOf(y),1)}else for(var h=e.indexObject,v=0,f=Object.keys(h);v<f.length;v++){var y=f[v];h.hasOwnProperty(y)&&delete i.indexObject[y]}},e.prototype.updateFramedHeaders=function(e,i,r,a,n){for(var o=0,l=e;o<l.length;o++){var s=l[o];this.isHeaderAvail=!1,(this.validateFilteredHeaders(s,r,n)||"grand sum"===s.type)&&("row"===n?this.rowCount+=this.rowValuesLength:this.columnCount+=this.colValuesLength,a.push(t.extend({},s,null,!0)),a[a.length-1].members=[],s.hasChild&&s.isDrilled&&s.members.length>0&&this.updateFramedHeaders(s.members,i,r,a[a.length-1].members,n))}return this.filterFramedHeaders},e.prototype.validateFilteredHeaders=function(e,t,i){for(var r=0,a=t;r<a.length;r++){var n=a[r];if(!this.isHeaderAvail){if(e.actualText===n.actualText&&e.level===n.level&&e.valueSort.levelName===n.valueSort.levelName)return"row"===i?n.index.length>0?(this.isHeaderAvail=!0,e.index=n.index,!0):(this.isHeaderAvail=!1,e.index=n.index,!1):Object.keys(n.indexObject).length>0?(this.isHeaderAvail=!0,e.indexObject=n.indexObject,!0):(this.isHeaderAvail=!1,e.indexObject=n.indexObject,!1);n.hasChild&&n.members.length>0&&"grand sum"!==n.type&&this.validateFilteredHeaders(e,n.members,i)}}return this.isHeaderAvail},e.prototype.isEmptyDataAvail=function(e,t){this.isEmptyData=!1,e.length>0&&"grand sum"===e[e.length-1].type&&0===e[e.length-1].index.length&&(this.isEmptyData=!0),t.length>0&&"grand sum"===t[t.length-1].type&&0===Object.keys(t[t.length-1].indexObject).length&&(this.isEmptyData=!0)},e.prototype.generateGridData=function(e,i){this.fields;var r=e.columns?e.columns:[],a=e.data,n=e.rows?e.rows:[],o=e.filterSettings,l=e.values;this.isExpandAll=e.expandAll,this.drilledMembers=e.drilledMembers?e.drilledMembers:[],this.isEmptyData=!1;var s=[];if(n[0]&&n[0].showNoDataItems||r[0]&&r[0].showNoDataItems)for(d=0;d<this.indexMatrix.length;d++)s.push(d);for(var d=0;d<this.filterMembers.length;d++)this.filterPosObj[this.filterMembers[d]]=this.filterMembers[d];this.valueSortSettings.columnIndex=void 0;(new Date).getTime();this.isValueFilterEnabled||(i&&!this.enableValueSorting||(this.columnCount=0,this.rowCount=0,this.cMembers=[],this.rMembers=[],0!==n.length&&(this.rMembers=this.getIndexedHeaders(n,a,0,n[0].showNoDataItems?s:this.filterMembers,"row","")),0!==r.length&&(this.cMembers=this.getIndexedHeaders(r,a,0,r[0].showNoDataItems?s:this.filterMembers,"column","")),this.insertAllMembersCommon()),this.saveDataHeaders=this.isValueFiltersAvail&&e.allowValueFilter?{rowHeaders:t.extend([],this.rMembers,null,!0),columnHeaders:t.extend([],this.cMembers,null,!0)}:{}),this.pivotValues=[],this.headerContent=[],this.valueContent=[],this.valueFilteredData=[],this.filterFramedHeaders=[];var p=[],h=[],c=[],u=[],m=this.values.length;if(this.isValueFiltersAvail&&e.allowValueFilter){this.valueFilteredData=[];var g=this.saveDataHeaders.rowHeaders,v=this.saveDataHeaders.columnHeaders;if(o.length>0){for(var f={},y={},b=0,S=l;b<S.length;b++){var C=S[b];y[C.name]=C}for(var x=0,w=o;x<w.length;x++){var E=w[x];g=c.length>0?c:g,v=u.length>0?u:v,this.valueFilteredData=[];var D=E.properties?E.properties:E;if("Value"===D.type&&this.fieldList[E.name].isSelected){f[E.name]=E,D.items=[];for(var M=!1,T=n.length,F=r.length,L=0;L<T;L++)if(D.name===n[L].name&&y[D.measure]&&!M){M=!0,c=this.applyValueFiltering(n[L],L,g,v[v.length-1],f,this.valueFilteredData,"row");break}for(var O=0;O<F;O++)if(D.name===r[O].name&&y[D.measure]&&!M){M=!0,u=this.applyValueFiltering(r[O],O,v,g[g.length-1],f,this.valueFilteredData,"column");break}}}}c=c.length>0?c:g,u=u.length>0?u:v,this.isEmptyDataAvail(c,u);var P=t.extend({},this.fieldList,null,!0);this.indexMatrix=[];var A=e.data[0];this.getFieldList(A,this.enableSort,e.allowValueFilter),this.fillFieldMembers(e.data,this.indexMatrix),this.updateSortSettings(e.sortSettings,this.enableSort),this.valueMatrix=this.generateValueMatrix(e.data),this.filterMembers=[],this.updateFilterMembers(e),this.rMembers=0!==n.length?this.getIndexedHeaders(n,a,0,n[0].showNoDataItems?s:this.filterMembers,"row",""):this.rMembers,this.cMembers=0!==r.length?this.getIndexedHeaders(r,a,0,r[0].showNoDataItems?s:this.filterMembers,"column",""):this.cMembers,this.insertAllMembersCommon(),this.updateFieldList(P),this.rowCount=0,this.columnCount=0,this.rMembers=this.updateFramedHeaders(this.rMembers,this.rMembers,c,this.filterFramedHeaders,"row"),this.filterFramedHeaders=[],this.cMembers=this.updateFramedHeaders(this.cMembers,this.cMembers,u,this.filterFramedHeaders,"column"),this.isValueFilterEnabled=!0}this.applyValueSorting(),this.pageSettings&&(!i||this.enableValueSorting?(this.headerCollection.rowHeaders=t.extend([],this.rMembers,null,!0),this.headerCollection.columnHeaders=t.extend([],this.cMembers,null,!0),this.headerCollection.rowHeadersCount=this.rowCount,this.headerCollection.columnHeadersCount=this.columnCount):(this.rMembers=i.rowHeaders,this.cMembers=i.columnHeaders,this.rowCount=i.rowHeadersCount,this.columnCount=i.columnHeadersCount,(this.columns.length>1||this.rows.length>1||this.allowValueFilter)&&(this.headerCollection=t.extend({},i,null,!0))),this.calculatePagingValues(),this.enableValueSorting&&this.allowValueFilter||(n.length>0&&this.insertPosition(n,a,0,this.filterMembers,"row","",this.rMembers),r.length>0&&this.insertPosition(r,a,0,this.filterMembers,"column","",this.cMembers),this.rMembers=this.insertTotalPosition(this.rMembers),this.cMembers=this.insertTotalPosition(this.cMembers))),this.getHeaderData(this.cMembers,h,this.pivotValues,0,this.valueAxis?1:m),this.insertSubTotals(),this.getTableData(this.rMembers,p,h,0,this.pivotValues,m),this.pageSettings&&this.removeIndexProperties(),this.isEngineUpdated=!0;(new Date).getTime()},e.prototype.applyValueSorting=function(){if(this.valueSortSettings.headerText&&""!==this.valueSortSettings.headerText&&this.values.length>0){for(var e=this.valueSortSettings.headerText.split(this.valueSortSettings.headerDelimiter),t="",i=void 0,r=void 0,a=void 0,n=0;n<this.values.length;n++){if(this.values[n].caption===e[e.length-1]){a=this.values[n].name;break}a=e[e.length-1]}if(this.values.length>1&&a&&this.fieldList[a]){for(n=0;n<e.length-1;n++)t=""===t?e[n]:t+this.valueSortSettings.headerDelimiter+e[n];i=this.fieldList[a].index,r=this.fieldList[a].aggregateType}else t=this.valueSortSettings.headerText,i=this.fieldList[this.values[0].name].index,r=this.fieldList[this.values[0].name].aggregateType;var o=void 0;0===this.valueAxis?(o=this.getMember(this.cMembers,t))&&this.sortByValueRow(this.rMembers,o,this.valueSortSettings.sortOrder,i,r):(o=this.getMember(this.rMembers,t))&&this.sortByValueRow(this.cMembers,o,this.valueSortSettings.sortOrder,i,r)}},e.prototype.getMember=function(e,t){for(var i,r=e.length,a=0;a<r;a++){if(e[a].valueSort.levelName===t){i=e[a];break}if(e[a].members.length>0&&(i=this.getMember(e[a].members,t)),i)return i}return i},e.prototype.sortByValueRow=function(e,t,i,r,a){for(var n=e.length,o=0;o<n;o++){for(var l=o;l<n&&"grand sum"!==e[o].type&&"grand sum"!==e[l].type;l++)if("Descending"===i?this.getAggregateValue(e[o].index,t.indexObject,r,a)<this.getAggregateValue(e[l].index,t.indexObject,r,a):this.getAggregateValue(e[o].index,t.indexObject,r,a)>this.getAggregateValue(e[l].index,t.indexObject,r,a)){var s={};s=e[o],e[o]=e[l],e[l]=s}e[o].members.length>0&&this.sortByValueRow(e[o].members,t,i,r,a)}},e.prototype.insertAllMembersCommon=function(){this.insertAllMember(this.rMembers,this.filterMembers,"","row"),this.insertAllMember(this.cMembers,this.filterMembers,"","column")},e.prototype.removeIndexProperties=function(){for(i=0;i<this.headerContent.length;i++)if(this.headerContent[i])for(var e=0;e<Object.keys(this.headerContent[i]).length;e++){var t=Number(Object.keys(this.headerContent[i])[e]);this.headerContent[i][t].index=[],this.headerContent[i][t].indexObject={},this.pivotValues[i][t].index=[],this.pivotValues[i][t].indexObject={}}for(var i=this.headerContent.length;i<this.pivotValues.length;i++)this.headerContent[i]&&(this.valueContent[i-this.headerContent.length][0].index=[],this.valueContent[i-this.headerContent.length][0].indexObject={},this.pivotValues[i][0].index=[],this.pivotValues[i][0].indexObject={})},e.prototype.insertSubTotals=function(){for(var e=this.pivotValues.length,i=0;i<e;i++){var r=this.pivotValues[i];if(r)for(var a=void 0,n=1,o=void 0,l=r.length-1;l>0;l--){var s=r[l];if(s){a&&(a.colSpan=n,a.colIndex=a.colIndex-(n-1)),o={index:s.index,indexObject:s.indexObject},s.index=[],s.indexObject={},a=t.extend({},s,null,!0),s.index=o.index,s.indexObject=o.indexObject;for(var d=i+1;this.pivotValues[d]&&!this.pivotValues[d][l];){this.pivotValues[i][l].isDrilled||(this.pivotValues[i][l].rowSpan=d-i+1,a.rowSpan=d-i+1);var p="sum"===s.type||"grand sum"===s.type?s.type:"sum";this.pivotValues[d][l]=this.headerContent[d][l]={type:p,formattedText:"sum"===s.type||"grand sum"===s.type?s.formattedText:s.formattedText+" Total",axis:"column",level:-1,colIndex:l,rowIndex:d,valueSort:s.valueSort},s.valueSort&&s.valueSort[this.valueSortSettings.headerText]&&(this.valueSortSettings.columnIndex=l);var h=!1;"grand sum"===p?(this.pivotValues[i][l].rowSpan=d-i+1,a.rowSpan=d-i+1):"sum"!==this.pivotValues[i][l].type&&this.pivotValues[i][l].isDrilled?(this.pivotValues[i+1][l].rowSpan=d-i,h=!0):this.pivotValues[d][l].rowSpan=-1,d>i+1&&("sum"===this.pivotValues[i][l].type||h)&&(this.pivotValues[d][l].rowSpan=-1),d++}n=1}else r[l]=this.headerContent[i][l]=t.extend({},a,null,!0),r[l].index=this.headerContent[i][l].index=o.index,r[l].indexObject=this.headerContent[i][l].indexObject=o.indexObject,n++,r[l].colSpan=n,r[l].colIndex=r[l].colIndex-(n-1);1===l&&a&&(a.colSpan=n,a.colIndex=a.colIndex-(n-1))}}},e.prototype.getIndexedHeaders=function(e,t,r,a,n,o){var l=[],s=this.enableValueSorting||this.allowValueFilter||!this.pageSettings;if(e){var d=e.length,p={},h=e[r].name,c=e[r],u=this.fieldList[h],m={},g=!1,v=a.length<1&&r>0||c.showNoDataItems,f={};if(v){for(var y=0,b=u.dateMember.length;y<b;y++)f[u.dateMember[y].actualText]=u.dateMember[y].actualText;a.length<1&&(g=!0,a.length=u.dateMember.length)}for(var y=0,b=a.length;y<b;y++){var S={};S.hasChild=r<d-1,S.level=r,S.axis=n,S.colSpan=1;var C=g?u.members[Object.keys(f)[0]].ordinal:this.indexMatrix[a[y]][u.index],x=g?Object.keys(f)[0]:t[a[y]][h];if(delete f[x],!v||!this.fieldFilterMem[h]||this.fieldFilterMem[h].memberObj[x]!==x){S.isDrilled=!!S.hasChild&&u.members[x].isDrilled;var w=this.getFormattedValue(x,h);S.actualText=w.actualText,S.formattedText=w.formattedText;var E=!v||void 0!==this.filterPosObj[a[y]]&&!g;p&&p[C]?E&&(s?(p[C].index.push(a[y]),p[C].indexObject[a[y]]=a[y]):void 0===m[C]?m[C]=[a[y]]:m[C].push(a[y])):(p[C]={index:[],indexObject:{}},S.index=p[C].index,S.indexObject=p[C].indexObject,E&&(s?(S.index=p[C].index=[a[y]],p[C].indexObject[a[y]]=a[y],S.indexObject=p[C].indexObject):m[C]=[a[y]]),S.ordinal=C,S.valueSort={},s&&(0!==r?(S.valueSort.levelName=o+this.valueSortSettings.headerDelimiter+S.formattedText,S.valueSort[o+this.valueSortSettings.headerDelimiter+S.formattedText]=1):(S.valueSort[S.formattedText]=1,S.valueSort.levelName=S.formattedText)),S.members=[],l.push(S)),v&&!g&&r>0&&y+1===a.length&&Object.keys(f).length>0&&(g=!0,b=Object.keys(f).length,y=-1)}}for(var D=0,M=l.length;D<M;D++)if("row"===n?this.rowCount+=this.rowValuesLength:this.columnCount+=this.colValuesLength,d-1>r&&l[D].isDrilled){if(s){var T=null;l[D].valueSort&&l[D].valueSort.levelName&&(T=l[D].valueSort.levelName),o=T||l[D].formattedText}var F=s?l[D].index:m[l[D].ordinal];l[D].members=this.getIndexedHeaders(e,t,r+1,void 0===F?[]:F,n,o)}return this.enableSort?new i.DataManager(l).executeLocal((new i.Query).sortBy("actualText",u.sort.toLowerCase())):l}return l},e.prototype.getOrderedIndex=function(e){for(var t={},i=0;i<e.length;i++)"grand sum"!==e[i].type&&(t[e[i].ordinal]=i);return t},e.prototype.insertPosition=function(e,t,i,r,a,n,o){var l=[],s=this.getOrderedIndex(o);if(e){for(var d={},p=e[i].name,h=this.fieldList[p],c=0,u=r.length;c<u;c++){var m={},g=this.indexMatrix[r[c]][h.index],v=o[s[g]],f=this.getFormattedValue(t[r[c]][p],p);v&&v.formattedText===f.formattedText&&(d&&d[g]?(d[g].index.push(r[c]),d[g].indexObject[r[c]]=r[c]):(d[g]={index:[],indexObject:{}},v.index=d[g].index=[r[c]],d[g].indexObject[r[c]]=r[c],v.indexObject=d[g].indexObject,v.valueSort={},0!==i?(v.valueSort.levelName=n+this.valueSortSettings.headerDelimiter+v.formattedText,v.valueSort[n+this.valueSortSettings.headerDelimiter+v.formattedText]=1):(v.valueSort[v.formattedText]=1,v.valueSort.levelName=v.formattedText),m.members=[],l.push(m)))}for(var y=o.length-l.length;y>0;)l.push({members:[]}),y--;for(var b=0,S=l.length;b<S;b++)if(o[b].members.length>0){var C=null;o[b].valueSort&&o[b].valueSort.levelName&&(C=o[b].valueSort.levelName),n=C||o[b].formattedText,l[b].members=this.insertPosition(e,t,i+1,o[b].index,a,n,o[b].members)}return l}return l},e.prototype.insertTotalPosition=function(e){var t=e[e.length-1];if(t&&"grand sum"===t.type){t.index=this.filterMembers;for(var i=0,r=this.filterMembers.length;i<r;i++)t.indexObject[this.filterMembers[i]]=this.filterMembers[i]}return e},e.prototype.calculatePagingValues=function(){var e=!!("None"!==this.valueSortSettings.sortOrder&&""!==this.valueSortSettings.headerText||this.enableValueSorting);if(this.pageSettings){1===this.valueAxis?this.rowValuesLength=this.values.length:this.colValuesLength=this.values.length,this.memberCnt=-this.rowValuesLength,this.rowStartPos=(this.pageSettings.rowCurrentPage*this.pageSettings.rowSize-this.pageSettings.rowSize)*this.rowValuesLength;var t=this.rowStartPos+3*this.pageSettings.rowSize*this.rowValuesLength>this.rowCount?this.rowCount-3*this.pageSettings.rowSize*this.rowValuesLength:this.rowStartPos;t<0&&(t=this.rowStartPos=0,this.pageSettings.rowCurrentPage=1),this.rowFirstLvl=(this.rowStartPos-t)%this.pageSettings.rowSize,this.rowStartPos=t,this.endPos=this.rowStartPos+3*this.pageSettings.rowSize*this.rowValuesLength,this.endPos=this.endPos>this.rowCount?this.rowCount:this.endPos,this.rMembers=e?this.rMembers:this.performSlicing(this.rMembers,[],this.rowStartPos,"row"),this.memberCnt=-this.colValuesLength,this.pageInLimit=!1,this.colHdrBufferCalculated=!1,this.colStartPos=(this.pageSettings.columnCurrentPage*this.pageSettings.columnSize-this.pageSettings.columnSize)*this.colValuesLength,(t=this.colStartPos+3*this.pageSettings.columnSize*this.colValuesLength>this.columnCount?this.columnCount-3*this.pageSettings.columnSize*this.colValuesLength:this.colStartPos)<0&&(t=this.colStartPos=0,this.pageSettings.columnCurrentPage=1),this.colFirstLvl=(this.colStartPos-t)%this.pageSettings.columnSize,this.colStartPos=t,e||(this.endPos=this.colStartPos+3*this.pageSettings.columnSize*this.colValuesLength,this.endPos=this.endPos>this.columnCount?this.columnCount:this.endPos,this.cMembers=this.performSlicing(this.cMembers,[],this.colStartPos,"column")),this.memberCnt=-1,this.pageInLimit=!1}},e.prototype.performSlicing=function(e,t,i,r){for(var a=0;e[a];){if(this.memberCnt+="column"===r?this.colValuesLength:this.rowValuesLength,i<=this.memberCnt&&this.endPos>=this.memberCnt&&!this.pageInLimit&&("column"===r?this.colFirstLvl=this.colFirstLvl+e[a].level:this.rowFirstLvl=this.rowFirstLvl+e[a].level,this.pageInLimit=!0),this.pageInLimit&&this.endPos<=this.memberCnt){if("column"!==r)break;if(0===e[a].members.length){if(this.colHdrBufferCalculated)break;this.colHdrBufferCalculated=!0,this.endPos+=e[a].level*this.colValuesLength}else if(this.colHdrBufferCalculated)break}var n=e[a].members;if(t.push(e[a]),e[a].members.length>0&&(t[t.length-1].members=[],t[t.length-1].members=this.performSlicing(n,[],i,r)),this.pageInLimit||t.pop(),0===e[a].level&&this.pageInLimit&&this.endPos<=this.memberCnt)break;a++}return t},e.prototype.insertAllMember=function(e,t,i,r){var a=e.length,n=this.enableValueSorting||this.allowValueFilter||!this.pageSettings;if(i=" Total",e[a]={hasChild:!1,index:n?t:[],level:0,axis:r,isDrilled:!1,indexObject:{},members:[],formattedText:"Grand"+i,ordinal:a,type:"grand sum",valueSort:{}},e[a].valueSort[e[a].formattedText]=1,e[a].valueSort.levelName=e[a].formattedText,n)for(var o=0,l=t.length;o<l;o++)e[a].indexObject[t[o]]=t[o];"row"===r?this.rowCount+=this.rowValuesLength:this.columnCount+=this.colValuesLength},e.prototype.getTableData=function(e,t,i,r,a,n){for(var o=e.length,l=0;l<o;l++){t[r=a.length]=e[l];var s=r-Number(Object.keys(t)[0]),d=!t[r].members.length;if(e[l].colIndex=0,e[l].rowIndex=r,a[r]?a[r][0]=this.valueContent[s][0]=e[l]:(a[r]=[],this.valueContent[s]={},a[r][0]=this.valueContent[s][0]=e[l]),this.valueAxis&&this.isMutiMeasures){for(var p=r,h=s,c=0;c<n;c++){r++,s++;var u=this.values[c].caption?this.values[c].caption:this.values[c].name,m={axis:"row",formattedText:u,level:0,valueSort:{},colIndex:0,rowIndex:r,type:"value"};a[r]||(a[r]=[],this.valueContent[s]={},a[r][0]=this.valueContent[s][0]=m);var g=a[r][0].valueSort;g[a[r-c-1][0].valueSort.levelName+this.valueSortSettings.headerDelimiter+u]=1,g.levelName=a[r-c-1][0].valueSort.levelName+this.valueSortSettings.headerDelimiter+u;for(var v=0,f=1,y=i.length;v<y;++v)this.updateRowData(e,i,r,a,c,l,v,f,s),f=a[r].length,a[p][f-1]=this.valueContent[h][f-1]={axis:"value",actualText:"",colSpan:1,colIndex:f,formattedText:"",hasChild:!1}}this.recursiveRowData(e,t,i,r,a,n,d,l,n)}else{for(var v=0,f=1,y=i.length;v<y;++v)for(c=0;c<n;c++)this.updateRowData(e,i,r,a,c,l,v,f,s),f=a[r].length;this.recursiveRowData(e,t,i,r,a,n,d,l,0)}}},e.prototype.recursiveRowData=function(e,t,i,r,a,n,o,l,s){o||this.getTableData(t[r-s].members,t,i,r,a,n),t[r-s].members=[]},e.prototype.updateRowData=function(e,t,i,r,a,n,o,l,s){var d=this.fieldList[this.values[a].name].index,p=this.fieldList[this.values[a].name].aggregateType,h=this.values[a].name,c=0;c=this.getAggregateValue(e[n].index,t[o].indexObject,d,p);var u=e[n].hasChild||t[o].hasChild||"grand sum"===e[n].type||"grand sum"===t[o].type,m=this.getFormattedValue(c,h).formattedText;r[i][l]=this.valueContent[s][l]={axis:"value",actualText:h,formattedText:m,value:c,rowIndex:i,colIndex:l,isSum:u}},e.prototype.getHeaderData=function(e,t,i,r,a){for(var n=e.length,o=this.columns.length,l=this.valueSortSettings.headerText,s=0;s<n;s++){e[s].members.length&&this.getHeaderData(e[s].members,t,i,r,a),t[r=t.length]=e[s];var d=e[s].level;if(e[s].rowIndex=d,e[s].colIndex=r*a+a,i[d]?i[d][r*a+a]=this.headerContent[d][r*a+a]=e[s]:(i[d]=[],this.headerContent[d]={},i[d][r*a+a]=this.headerContent[d][r*a+a]=e[s]),this.isMutiMeasures&&!this.valueAxis)for(var p=0;p<a;p++){var h=this.values[p].caption?this.values[p].caption:this.values[p].name,c={axis:"column",formattedText:h,level:0,valueSort:{},colIndex:r*a+1+p,rowIndex:o};i[o]?i[o][r*a+1+p]=this.headerContent[o][r*a+1+p]=c:(i[o]=[],this.headerContent[o]={},i[o][r*a+1+p]=this.headerContent[o][r*a+1+p]=c);var u=i[o][r*a+1+p].valueSort;u[e[s].valueSort.levelName+this.valueSortSettings.headerDelimiter+h]=1,u.levelName=e[s].valueSort.levelName+this.valueSortSettings.headerDelimiter+h,u&&u[l]&&(this.valueSortSettings.columnIndex=r*a+1+p)}else e[s].valueSort&&e[s].valueSort[l]&&(this.valueSortSettings.columnIndex=r*a+1);t[r].members=[]}},e.prototype.getAggregateValue=function(e,t,i,r){e.length;var a=0,n=0,o=0;if(r&&"count"===r.toLowerCase())for(;void 0!==e[a];)void 0!==t[e[a]]&&(n+=1),a++;else if(r&&"min"===r.toLowerCase())for(var l=!0;void 0!==e[a];)void 0!==t[e[a]]&&(l?(n=this.valueMatrix[e[a]][i],l=!1):n=this.valueMatrix[e[a]][i]<n?this.valueMatrix[e[a]][i]:n),a++;else if(r&&"max"===r.toLowerCase())for(var s=!0;void 0!==e[a];)void 0!==t[e[a]]&&(s?(n=this.valueMatrix[e[a]][i],s=!1):n=this.valueMatrix[e[a]][i]>n?this.valueMatrix[e[a]][i]:n),a++;else if(r&&"calculatedfield"===r.toLowerCase())for(;void 0!==e[a];){if(void 0!==t[e[a]]){var d=this.calculatedFields[this.fields[i]],p=d.formula,h={};if(this.calculatedFormulas[d.name])for(var c=this.calculatedFormulas[d.name],u=0,m=c.length;u<m;u++){var g=c[u],v=h[g.formula];if(void 0===v){var f=g.type;v=this.getAggregateValue(e,t,g.index,f),h[g.formula]=v}p=p.replace(g.formula,v.toString())}n=this.evaluate(p),JSON.parse(n.toString())}a++}else for(;void 0!==e[a];)void 0!==t[e[a]]&&(n+=this.valueMatrix[e[a]][i],o++),a++;return r&&"avg"===r.toLowerCase()&&0!==n?n/o:n},e.prototype.getFormattedValue=function(e,i){var r={formattedText:void 0!==e?null===e?"null":e.toString():void 0,actualText:void 0!==e?null===e?"null":e:void 0};if(this.formatFields[i]&&e){var a=t.extend({},this.formatFields[i],null,!0);delete a.name,!a.minimumSignificantDigits&&a.minimumSignificantDigits<1&&delete a.minimumSignificantDigits,!a.maximumSignificantDigits&&a.maximumSignificantDigits<1&&delete a.maximumSignificantDigits,a.type?r.formattedText=this.globalize.formatDate(new Date(e),a):r.formattedText=this.globalize.formatNumber(e,a),r.actualText=e,a.type&&"date"===this.formatFields[i].type&&(a.format="yyyy/MM/dd/HH/mm/ss",r.actualText=this.globalize.formatDate(new Date(e),a))}return r},e.prototype.powerFunction=function(e){if(e.indexOf("^")>-1){for(var t=[];e.indexOf("(")>-1;)e=e.replace(/(\([^\(\)]*\))/g,function(e,i){return t.push(i),"~"+(t.length-1)});for(t.push(e),e="~"+(t.length-1);e.indexOf("~")>-1;)e=e.replace(new RegExp("~(\\d+)","g"),function(e,i){return t[i].replace(/(\w*)\^(\w*)/g,"Math.pow($1,$2)")})}return e},e.prototype.evaluate=function(e){return Function('"use strict";return ('+e+")")()},e}(),m="ui-update",g="data-ready",v="e-pivotfieldlist",f="e-rtl",y="e-device",b="e-icons",S="e-pivot-calc-input",C="e-flat",x="e-format",w="e-pivot-formula",E=function(){function e(e){this.colPos=0,this.lastSpan=0,this.parent=e,this.engine=e.engineModule,this.gridSettings=e.gridSettings,this.formatList=this.getFormatList()}return e.prototype.render=function(){var e=this.parent,i=this.parent.engineModule;this.injectGridModules(e),this.rowStartPos=this.getRowStartPos(),this.parent.grid&&this.parent.grid.element&&this.parent.element.querySelector(".e-grid")?(i.isEngineUpdated?(this.parent.enableValueSorting&&(i.valueContent=this.frameDataSource("value")),i.isEngineUpdated=!1):(i.headerContent=this.frameDataSource("header"),i.valueContent=this.frameDataSource("value")),this.parent.grid.setProperties({columns:this.frameStackedHeaders(),dataSource:e.dataSource.values.length>0&&!this.engine.isEmptyData?i.valueContent:this.frameDataSource("value")},!0),this.parent.grid.notify("datasource-modified",{}),this.parent.grid.refreshColumns(),this.parent.element.querySelector(".e-movablecontent").querySelector("colGroup").innerHTML=this.parent.grid.getHeaderContent().querySelector(".e-movableheader").querySelector("colgroup").innerHTML,this.parent.grid.width=this.calculateGridWidth(),this.parent.height>this.engine.valueContent.length*this.gridSettings.rowHeight?this.parent.grid.height="auto":this.parent.grid.height=this.parent.height):(this.parent.element.innerHTML="",this.bindGrid(this.parent,!!this.engine.isEmptyData),this.parent.element.appendChild(t.createElement("div",{id:this.parent.element.id+"_grid"})),this.parent.grid.appendTo("#"+this.parent.element.id+"_grid")),this.parent.grid.on(a.headerRefreshed,function(){if(this.parent.enableVirtualization){var e=this.parent.element.querySelector(".e-movableheader"),i=this.parent.element.querySelector(".e-movablecontent"),r=i.querySelector(".e-virtualtrack");this.parent.virtualHeaderDiv=e.querySelector(".e-virtualtrack"),e.querySelector(".e-virtualtrack")?t.remove(e.querySelector(".e-virtualtrack")):this.parent.virtualHeaderDiv=t.createElement("div",{className:"e-virtualtrack"}),e.appendChild(this.parent.virtualHeaderDiv),r&&t.setStyleAttribute(this.parent.virtualHeaderDiv,{height:0,width:r.style.width}),t.setStyleAttribute(e.querySelector(".e-table"),{transform:i.querySelector(".e-table").style.transform.split(",")[0]+",0px)"}),e.scrollLeft=i.scrollLeft}},this)},e.prototype.bindGrid=function(e,t){var i=this;this.injectGridModules(e),this.parent.grid=new a.Grid({frozenColumns:1,frozenRows:0,dataSource:t?this.frameEmptyData():this.frameDataSource("value"),columns:t?this.frameEmptyColumns():this.frameStackedHeaders(),height:this.engine&&e.height>this.engine.valueContent.length*this.gridSettings.rowHeight||t?"auto":e.height,width:t?this.parent.width:this.calculateGridWidth(),locale:e.locale,enableRtl:e.enableRtl,allowExcelExport:e.allowExcelExport,allowPdfExport:e.allowPdfExport,allowResizing:this.gridSettings.allowResizing,allowTextWrap:this.gridSettings.allowTextWrap,allowReordering:this.gridSettings.allowReordering,allowSelection:this.gridSettings.allowSelection,contextMenuItems:this.gridSettings.contextMenuItems,selectedRowIndex:this.gridSettings.selectedRowIndex,selectionSettings:this.gridSettings.selectionSettings,printMode:this.gridSettings.printMode,rowHeight:this.gridSettings.rowHeight,gridLines:this.gridSettings.gridLines,contextMenuClick:this.gridSettings.contextMenuClick?this.gridSettings.contextMenuClick.bind(this.parent):void 0,contextMenuOpen:this.gridSettings.contextMenuOpen?this.gridSettings.contextMenuOpen.bind(this.parent):void 0,beforeCopy:this.gridSettings.beforeCopy?this.gridSettings.beforeCopy.bind(this.parent):void 0,beforePrint:this.gridSettings.beforePrint?this.gridSettings.beforePrint.bind(this.parent):void 0,printComplete:this.gridSettings.printComplete?this.gridSettings.printComplete.bind(this.parent):void 0,rowSelecting:this.gridSettings.rowSelecting?this.gridSettings.rowSelecting.bind(this.parent):void 0,rowSelected:this.gridSettings.rowSelected?this.gridSettings.rowSelected.bind(this.parent):void 0,rowDeselecting:this.gridSettings.rowDeselecting?this.gridSettings.rowDeselecting.bind(this.parent):void 0,rowDeselected:this.gridSettings.rowDeselected?this.gridSettings.rowDeselected.bind(this.parent):void 0,cellSelecting:this.gridSettings.cellSelecting?this.gridSettings.cellSelecting.bind(this.parent):void 0,cellSelected:this.gridSettings.cellSelected?this.gridSettings.cellSelected.bind(this.parent):void 0,cellDeselecting:this.gridSettings.cellDeselecting?this.gridSettings.cellDeselecting.bind(this.parent):void 0,cellDeselected:this.gridSettings.cellDeselected?this.gridSettings.cellDeselected.bind(this.parent):void 0,resizeStart:this.gridSettings.resizeStart?this.gridSettings.resizeStart.bind(this.parent):void 0,columnDragStart:this.gridSettings.columnDragStart?this.gridSettings.columnDragStart.bind(this):void 0,columnDrag:this.gridSettings.columnDrag?this.gridSettings.columnDrag.bind(this):void 0,columnDrop:this.gridSettings.columnDrop?this.gridSettings.columnDrop.bind(this):void 0,resizing:this.setGroupWidth.bind(this),resizeStop:this.onResizeStop.bind(this),queryCellInfo:function(t){e.renderModule.rowCellBoundEvent(t)},dataBound:function(t){e.element.querySelector(".e-firstcell")&&(e.enableRtl?e.element.querySelector(".e-firstcell").style.borderRight="none":e.element.querySelector(".e-firstcell").style.borderLeft="none"),i.parent.grid.widthService.setWidthToTable(),e.notify("content-ready",{})},headerCellInfo:function(t){e.renderModule.columnCellBoundEvent(t)},excelHeaderQueryCellInfo:function(t){e.renderModule.excelColumnEvent(t)},pdfHeaderQueryCellInfo:function(t){e.renderModule.pdfColumnEvent(t)},excelQueryCellInfo:function(t){e.renderModule.excelRowEvent(t)},pdfQueryCellInfo:function(t){e.renderModule.pdfRowEvent(t)}})},e.prototype.injectGridModules=function(e){a.Grid.Inject(a.Freeze),e.allowExcelExport&&a.Grid.Inject(a.ExcelExport),e.allowPdfExport&&a.Grid.Inject(a.PdfExport),this.gridSettings.allowSelection&&a.Grid.Inject(a.Selection),this.gridSettings.allowReordering&&a.Grid.Inject(a.Reorder),this.gridSettings.allowResizing&&a.Grid.Inject(a.Resize),this.gridSettings.contextMenuItems&&a.Grid.Inject(a.ContextMenu)},e.prototype.updateGridSettings=function(){this.injectGridModules(this.parent),this.parent.grid.allowResizing=this.gridSettings.allowResizing,this.parent.grid.allowTextWrap=this.gridSettings.allowTextWrap,this.parent.grid.allowReordering=this.gridSettings.allowReordering,this.parent.grid.allowSelection=this.gridSettings.allowSelection,this.parent.grid.contextMenuItems=this.gridSettings.contextMenuItems,this.parent.grid.selectedRowIndex=this.gridSettings.selectedRowIndex,this.parent.grid.selectionSettings=this.gridSettings.selectionSettings,this.parent.grid.printMode=this.gridSettings.printMode,this.parent.grid.rowHeight=this.gridSettings.rowHeight,this.parent.grid.gridLines=this.gridSettings.gridLines},e.prototype.appendValueSortIcon=function(e,i,r,a){var n=this.parent.dataSource.valueSortSettings,o="grand sum"===e.type&&1===this.parent.dataSource.values.length?0:this.parent.dataSource.values.length>1?this.parent.engineModule.headerContent.length-1:0===this.parent.dataSource.columns.length?0:this.parent.engineModule.headerContent.length-1,l=n&&n.headerText?e.valueSort.levelName===n.headerText:a===n.columnIndex;if(void 0!==n&&l&&r===o&&"column"===this.parent.dataSource.valueAxis&&(i.querySelector(".e-sortfilterdiv")?(i.querySelector(".e-sortfilterdiv").classList.add("Descending"===n.sortOrder?"e-descending":"e-ascending"),i.querySelector(".e-sortfilterdiv").classList.add("Descending"===n.sortOrder?"e-icon-descending":"e-icon-ascending")):i.appendChild(t.createElement("div",{className:"Descending"===n.sortOrder?"e-icon-descending e-icons e-descending e-sortfilterdiv":"e-icon-ascending e-icons e-ascending e-sortfilterdiv"})),!t.isNullOrUndefined(e.hasChild)&&"grand sum"!==e.type&&i.querySelector(".e-expand")&&(i.querySelector(".e-icon-descending")||i.querySelector(".e-icon-ascending")))){var s=i.querySelector(".e-icon-descending")||i.querySelector(".e-icon-ascending");t.setStyleAttribute(s,{"padding-top":"12px"})}return i},e.prototype.onResizeStop=function(e){var t="0.formattedText"===e.column.field?"0.formattedText":e.column.customAttributes.cell.valueSort.levelName;this.parent.resizeInfo[t]=Number(e.column.width.toString().split("px")[0]),this.parent.grid.headerModule.refreshUI(),this.setGroupWidth(e)},e.prototype.setGroupWidth=function(e){if(this.parent.showGroupingBar&&this.parent.groupingBarModule&&this.parent.element.querySelector(".e-grouping-bar")){if(this.parent.groupingBarModule.refreshUI(),this.parent.element.querySelector(".e-group-row").offsetWidth<245){e.cancel=!0;var t=this.parent.grid.columns;t&&t.length>0&&(t[0].width=250),this.parent.element.querySelector(".e-frozenheader").querySelector("col").style.width="250px",this.parent.element.querySelector(".e-frozencontent").querySelector("col").style.width="250px"}this.parent.element.querySelector(".e-group-values").style.width=this.parent.element.querySelector(".e-group-row").offsetWidth+"px",this.parent.element.querySelector(".e-group-row").style.height=this.parent.element.querySelector(".e-headercontent").offsetHeight+"px"}this.parent.trigger("touchend"===e.e.type||"mouseup"===e.e.type?"resizeStop":"resizing",e)},e.prototype.rowCellBoundEvent=function(e){var i=e.cell;if(i&&this.engine){i.setAttribute("index",(Number(i.getAttribute("index"))+this.engine.headerContent.length).toString());var r=e.data[0];if("0"===i.getAttribute("aria-colindex")){var a=r.type&&"value"===r.type;i.innerText="";var n=r.level?r.level:a?this.lastSpan+1:0;do{n>0&&i.appendChild(t.createElement("span",{className:0===n?"":"e-nextspan"})),n--}while(n>-1);n=r.level?r.level:0,this.lastSpan=a?this.lastSpan:n,!r.hasChild&&n>0&&i.appendChild(t.createElement("span",{className:"e-lastspan"}));var o=void 0;this.parent.dataSource.rows.length>0&&(!r.valueSort||Object.keys(r.valueSort).length>0)&&(o=n>-1?this.parent.dataSource.rows[n].name:"",i.setAttribute("fieldname",o));var l=r.formattedText;r.type&&("grand sum"===r.type?(i.classList.add("e-gtot"),l=this.parent.localeObj.getConstant("grandTotal")):i.classList.add("e-stot")),i.classList.add("e-rowsheader"),!0===r.hasChild&&i.appendChild(t.createElement("div",{className:(!0===r.isDrilled?"e-collapse":"e-expand")+" "+b,attrs:{title:!0===r.isDrilled?this.parent.localeObj.getConstant("collapse"):this.parent.localeObj.getConstant("expand")}})),i.appendChild(t.createElement("span",{className:"e-cellvalue",innerHTML:l}));var s=this.parent.pivotView.dataSource.valueSortSettings;if(s&&s.headerText&&"row"===this.parent.dataSource.valueAxis&&this.parent.pivotValues[Number(i.getAttribute("index"))][0].valueSort.levelName&&this.parent.pivotValues[Number(i.getAttribute("index"))][0].valueSort.levelName===s.headerText){var d=i.querySelector(".e-expand")||i.querySelector(".e-collapse")?"padding-top: 18px":"padding-top: 12px";i.appendChild(t.createElement("div",{className:"Descending"===s.sortOrder?"e-icon-descending e-icons e-descending e-sortfilterdiv":"e-icon-ascending e-icons e-ascending e-sortfilterdiv",styles:d}))}}else{var p="0"===i.innerText.toString()?"":i.innerText;i.innerText="",i.classList.add("e-valuescontent"),(r=e.data[Number(i.getAttribute("aria-colindex"))]).isSum&&i.classList.add("e-summary"),r.cssClass&&i.classList.add(r.cssClass),i.appendChild(t.createElement("span",{className:"e-cellvalue",innerHTML:p}))}}this.parent.trigger("queryCellInfo",e)},e.prototype.columnCellBoundEvent=function(e){if(e.cell.column&&e.cell.column.customAttributes){var i=e.cell.column.customAttributes.cell,r=e.node;if(i){var a=i.level?i.level:0;-1===i.level&&!i.rowSpan&&i.rowIndex!==this.engine.headerContent.length-1||-1===i.rowSpan?e.node.style.display="none":i.rowSpan>1&&(e.node.setAttribute("rowspan",i.rowSpan.toString()),e.node.setAttribute("aria-rowspan",i.rowSpan.toString()),i.rowIndex+i.rowSpan===this.engine.headerContent.length&&(e.node.style.borderBottomWidth="0px")),e.node.setAttribute("aria-colindex",i.colIndex.toString()),e.node.setAttribute("index",i.rowIndex.toString());var n=void 0;if(!(this.parent.dataSource.values&&"column"===this.parent.dataSource.valueAxis&&this.parent.dataSource.values.length>1&&i.rowIndex===this.engine.headerContent.length-1)&&this.parent.dataSource.columns&&this.parent.dataSource.columns.length>0&&(n=a>-1?this.parent.dataSource.columns[a].name:"",r.setAttribute("fieldname",n)),i.type){r.classList.add("grand sum"===i.type?"e-gtot":"e-stot");var o="grand sum"===i.type?this.parent.localeObj.getConstant("grandTotal"):i.formattedText.split("Total")[0]+this.parent.localeObj.getConstant("total");null!==r.querySelector(".e-headertext")?r.querySelector(".e-headertext").innerText=o:r.querySelector(".e-stackedheadercelldiv").innerText=o}if(r.classList.add("e-columnsheader"),!0===i.hasChild){var l=r.querySelector(".e-headercelldiv");l&&(l.style.height="auto",l.style.lineHeight="normal");var s=t.createElement("div",{className:(!0===i.isDrilled?"e-collapse":"e-expand")+" "+b,attrs:{title:!0===i.isDrilled?this.parent.localeObj.getConstant("collapse"):this.parent.localeObj.getConstant("expand")}});r.children[0].classList.add("e-cellvalue"),window.navigator.userAgent.indexOf("Edge")>-1||window.navigator.userAgent.indexOf("Trident")>-1?r.children[0].style.display="table":r.children[0].style.display="block",r.insertBefore(s,r.children[0])}r=this.appendValueSortIcon(i,r,i.rowIndex,i.colIndex)}}this.parent.trigger("headerCellInfo",e)},e.prototype.getRowStartPos=function(){for(var e,t=this.parent.pivotValues,i=0;i<t.length;i++)if(t[i]&&t[i][0]&&"row"===t[i][0].axis){e=i;break}return e},e.prototype.frameDataSource=function(e){var t=[];if(this.parent.dataSource.values.length>0&&!this.engine.isEmptyData)if(this.parent.enableValueSorting||!this.engine.isEngineUpdated){for(var i=0,r=this.parent.pivotValues,a="value"===e?this.rowStartPos:0,n="value"===e?r.length:this.rowStartPos,o=a;o<n;o++)if(r[o]){t[i="header"===e?o:i]={};for(var l=0;l<r[o].length;l++)r[o][l]&&(t[i][l]=r[o][l]);i++}}else t="value"===e?this.engine.valueContent:this.engine.headerContent;else t=this.frameEmptyData();return t},e.prototype.frameEmptyData=function(){return[{0:{formattedText:this.parent.localeObj.getConstant("grandTotal")},1:{formattedText:this.parent.localeObj.getConstant("emptyData")}}]},e.prototype.calculateColWidth=function(e){var t=isNaN(this.parent.width)?this.parent.width.toString().indexOf("%")>-1?parseFloat(this.parent.width.toString())/100*this.parent.element.offsetWidth:this.parent.element.offsetWidth:Number(this.parent.width);return this.parent.showGroupingBar&&this.parent.groupingBarModule&&this.parent.grid&&this.parent.dataSource.rows.length>0&&(t-=this.parent.grid.columns[0].width,e-=1),e*this.gridSettings.columnWidth+80<t?t/e:this.gridSettings.columnWidth},e.prototype.calculateGridWidth=function(){var e=this.engine.pivotValues[0].length*this.gridSettings.columnWidth+80,t=this.parent.width;return"auto"===this.parent.width&&this.parent.element.offsetWidth<e&&(t=this.parent.element.offsetWidth),t},e.prototype.frameStackedHeaders=function(){var e=[];if(this.parent.dataSource.values.length>0&&!this.engine.isEmptyData){var t=this.engine.headerContent.length,i=[],r=[],a=this.calculateColWidth(this.engine.pivotValues[0].length);do{var n=[],o=0;t--;var l=this.engine.headerContent[t];if(l)for(var s=0;s<Object.keys(l).length+(l[0]?0:1);s++){var d=l[s]&&l[s].colSpan?l[s].colSpan:1,p=(l[s]&&l[s].rowSpan&&l[s].rowSpan,l[s]?"grand sum"===l[s].type?this.parent.localeObj.getConstant("grandTotal"):"sum"===l[s].type?l[s].formattedText.split("Total")[0]+this.parent.localeObj.getConstant("total"):l[s].formattedText:"");if(t===this.engine.headerContent.length-1)n[o]={field:s+".formattedText",headerText:p,customAttributes:{cell:l[s]},width:l[s]?this.setSavedWidth(l[s].valueSort.levelName,a):a,minWidth:30,format:0===s?"":this.formatList[(s-1)%this.parent.dataSource.values.length]};else if(i[s]){for(var h=d,c=[],u=s;h>0;){if(n[o]){if(!e[r[u]])break;c.push(e[r[u]])}else n[o]={headerText:p,customAttributes:{cell:l[s]},width:l[s]?this.setSavedWidth(l[s].valueSort.levelName,a):a,minWidth:30},c=[e[r[u]]];h-=i[u],u+=i[u]}n[o].columns=c}n[o]&&(n[o].clipMode=this.gridSettings.clipMode),i[s]=d,r[s]=o,o++,s=s+d-1}e=n.length>0?n:e}while(t>0);e[0]={field:"0.formattedText",width:this.setSavedWidth("0.formattedText",this.parent.showGroupingBar&&this.parent.groupingBarModule?a<250?250:a:a<200?200:a),minWidth:30,headerText:"",allowReordering:!1}}else e=this.frameEmptyColumns();return e},e.prototype.setSavedWidth=function(e,t){return t=this.parent.resizeInfo[e]?this.parent.resizeInfo[e]:t},e.prototype.frameEmptyColumns=function(){var e=[],t=this.calculateColWidth(2);return e.push({field:"0.formattedText",headerText:"",minWidth:30,width:t}),e.push({field:"1.formattedText",headerText:this.parent.localeObj.getConstant("grandTotal"),minWidth:30,width:t}),e},e.prototype.getFormatList=function(){for(var e=[],t=0;t<this.parent.dataSource.values.length;t++){var i=this.parent.dataSource.values[t];if(this.parent.dataSource.formatSettings.length>0){for(var r="",a=0;a<this.parent.dataSource.formatSettings.length;a++){var n=this.parent.dataSource.formatSettings[a];if(i.name===n.name){r=n.format;break}}e.push(r)}else e.push("N")}return e},e.prototype.excelColumnEvent=function(e){e=this.exportHeaderEvent(e),this.parent.trigger("excelHeaderQueryCellInfo",e)},e.prototype.pdfColumnEvent=function(e){e=this.exportHeaderEvent(e),this.parent.trigger("pdfHeaderQueryCellInfo",e)},e.prototype.excelRowEvent=function(e){"0.formattedText"===e.column.field?(this.colPos=0,e.style={hAlign:"Left",indent:2*e.data[0].level}):(this.colPos++,e.value=e.data[this.colPos].value||e.data[this.colPos].formattedText),e=this.exportContentEvent(e),this.parent.trigger("excelQueryCellInfo",e)},e.prototype.pdfRowEvent=function(e){"0.formattedText"===(e=this.exportContentEvent(e)).column.field&&(e.style={paragraphIndent:10*e.data[0].level}),this.parent.trigger("pdfQueryCellInfo",e)},e.prototype.exportHeaderEvent=function(e){var t=1;if(e.gridCell.column.customAttributes){var i=e.gridCell.column.customAttributes.cell;t=i.rowSpan?i.rowSpan:1}else t=Object.keys(this.engine.headerContent).length;return e.cell.rowSpan&&e.cell.rowSpan!==t&&t>-1&&(e.cell.rowSpan=t),e},e.prototype.exportContentEvent=function(e){return"0"===e.value&&(e.value=""),e.value="grand sum"===e.data[Number(e.column.field.split(".formattedText")[0])].type?this.parent.localeObj.getConstant("grandTotal"):e.value,e},e}(),D=function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])};return function(t,i){function r(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),M=function(e,t,i,r){var a,n=arguments.length,o=n<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,r);else for(var l=e.length-1;l>=0;l--)(a=e[l])&&(o=(n<3?a(o):n>3?a(t,i,o):a(t,i))||o);return n>3&&o&&Object.defineProperty(t,i,o),o},T=function(e){function i(){return null!==e&&e.apply(this,arguments)||this}return D(i,e),M([t.Property()],i.prototype,"name",void 0),M([t.Property()],i.prototype,"caption",void 0),M([t.Property("Sum")],i.prototype,"type",void 0),M([t.Property()],i.prototype,"axis",void 0),M([t.Property(!1)],i.prototype,"showNoDataItems",void 0),i}(t.ChildProperty),F=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}D(t,e)}(T),function(e){function i(){return null!==e&&e.apply(this,arguments)||this}D(i,e),M([t.Property()],i.prototype,"backgroundColor",void 0),M([t.Property()],i.prototype,"color",void 0),M([t.Property()],i.prototype,"fontFamily",void 0),M([t.Property()],i.prototype,"fontSize",void 0)}(t.ChildProperty),function(e){function i(){return null!==e&&e.apply(this,arguments)||this}return D(i,e),M([t.Property()],i.prototype,"name",void 0),M([t.Property("Include")],i.prototype,"type",void 0),M([t.Property()],i.prototype,"items",void 0),M([t.Property("DoesNotEquals")],i.prototype,"condition",void 0),M([t.Property()],i.prototype,"value1",void 0),M([t.Property()],i.prototype,"value2",void 0),M([t.Property()],i.prototype,"measure",void 0),i}(t.ChildProperty)),L=function(e){function i(){return null!==e&&e.apply(this,arguments)||this}return D(i,e),M([t.Property()],i.prototype,"measure",void 0),M([t.Property()],i.prototype,"label",void 0),M([t.Property()],i.prototype,"conditions",void 0),M([t.Property()],i.prototype,"value1",void 0),M([t.Property()],i.prototype,"value2",void 0),M([t.Property()],i.prototype,"style",void 0),i}(t.ChildProperty),O=function(e){function i(){return null!==e&&e.apply(this,arguments)||this}return D(i,e),M([t.Property()],i.prototype,"name",void 0),M([t.Property("Ascending")],i.prototype,"order",void 0),i}(t.ChildProperty),P=(function(e){function i(){return null!==e&&e.apply(this,arguments)||this}D(i,e),M([t.Property()],i.prototype,"name",void 0),M([t.Property()],i.prototype,"minimumFractionDigits",void 0),M([t.Property()],i.prototype,"maximumFractionDigits",void 0),M([t.Property()],i.prototype,"minimumSignificantDigits",void 0),M([t.Property()],i.prototype,"maximumSignificantDigits",void 0),M([t.Property(!0)],i.prototype,"useGrouping",void 0),M([t.Property()],i.prototype,"skeleton",void 0),M([t.Property()],i.prototype,"type",void 0),M([t.Property()],i.prototype,"currency",void 0),M([t.Property()],i.prototype,"minimumIntegerDigits",void 0),M([t.Property()],i.prototype,"format",void 0)}(t.ChildProperty),function(e){function i(){return null!==e&&e.apply(this,arguments)||this}return D(i,e),M([t.Property()],i.prototype,"name",void 0),M([t.Property()],i.prototype,"formula",void 0),i}(t.ChildProperty)),A=function(e){function i(){return null!==e&&e.apply(this,arguments)||this}return D(i,e),M([t.Property()],i.prototype,"name",void 0),M([t.Property()],i.prototype,"items",void 0),i}(t.ChildProperty),q=function(e){function i(){return null!==e&&e.apply(this,arguments)||this}return D(i,e),M([t.Property()],i.prototype,"headerText",void 0),M([t.Property(".")],i.prototype,"headerDelimiter",void 0),M([t.Property("None")],i.prototype,"sortOrder",void 0),i}(t.ChildProperty),N=function(e){function i(){return null!==e&&e.apply(this,arguments)||this}return D(i,e),M([t.Property()],i.prototype,"data",void 0),M([t.Collection([],T)],i.prototype,"rows",void 0),M([t.Collection([],T)],i.prototype,"columns",void 0),M([t.Collection([],T)],i.prototype,"values",void 0),M([t.Collection([],T)],i.prototype,"filters",void 0),M([t.Property(!1)],i.prototype,"expandAll",void 0),M([t.Property("column")],i.prototype,"valueAxis",void 0),M([t.Collection([],F)],i.prototype,"filterSettings",void 0),M([t.Collection([],O)],i.prototype,"sortSettings",void 0),M([t.Property(!0)],i.prototype,"enableSorting",void 0),M([t.Property(!1)],i.prototype,"allowLabelFilter",void 0),M([t.Property(!1)],i.prototype,"allowValueFilter",void 0),M([t.Property([])],i.prototype,"formatSettings",void 0),M([t.Collection([],A)],i.prototype,"drilledMembers",void 0),M([t.Complex({},q)],i.prototype,"valueSortSettings",void 0),M([t.Collection([],P)],i.prototype,"calculatedFieldSettings",void 0),M([t.Collection([],L)],i.prototype,"conditionalFormatSettings",void 0),i}(t.ChildProperty),I=function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])};return function(t,i){function r(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),j=function(e,t,i,r){var a,n=arguments.length,o=n<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,r);else for(var l=e.length-1;l>=0;l--)(a=e[l])&&(o=(n<3?a(o):n>3?a(t,i,o):a(t,i))||o);return n>3&&o&&Object.defineProperty(t,i,o),o},k=function(e){function i(){return null!==e&&e.apply(this,arguments)||this}return I(i,e),j([t.Property("Both")],i.prototype,"gridLines",void 0),j([t.Property(!1)],i.prototype,"allowTextWrap",void 0),j([t.Property(!1)],i.prototype,"allowReordering",void 0),j([t.Property(!0)],i.prototype,"allowResizing",void 0),j([t.Property(null)],i.prototype,"rowHeight",void 0),j([t.Property(110)],i.prototype,"columnWidth",void 0),j([t.Property("Ellipsis")],i.prototype,"clipMode",void 0),j([t.Property(!1)],i.prototype,"allowSelection",void 0),j([t.Property(-1)],i.prototype,"selectedRowIndex",void 0),j([t.Property({mode:"Row",cellSelectionMode:"Flow",type:"Single"})],i.prototype,"selectionSettings",void 0),j([t.Property("AllPages")],i.prototype,"printMode",void 0),j([t.Property()],i.prototype,"contextMenuItems",void 0),j([t.Event()],i.prototype,"beforeCopy",void 0),j([t.Event()],i.prototype,"printComplete",void 0),j([t.Event()],i.prototype,"beforePrint",void 0),j([t.Event()],i.prototype,"contextMenuOpen",void 0),j([t.Event()],i.prototype,"contextMenuClick",void 0),j([t.Event()],i.prototype,"queryCellInfo",void 0),j([t.Event()],i.prototype,"headerCellInfo",void 0),j([t.Event()],i.prototype,"rowSelecting",void 0),j([t.Event()],i.prototype,"rowSelected",void 0),j([t.Event()],i.prototype,"rowDeselecting",void 0),j([t.Event()],i.prototype,"rowDeselected",void 0),j([t.Event()],i.prototype,"cellSelecting",void 0),j([t.Event()],i.prototype,"cellSelected",void 0),j([t.Event()],i.prototype,"cellDeselecting",void 0),j([t.Event()],i.prototype,"cellDeselected",void 0),j([t.Event()],i.prototype,"resizeStart",void 0),j([t.Event()],i.prototype,"resizing",void 0),j([t.Event()],i.prototype,"resizeStop",void 0),j([t.Event()],i.prototype,"pdfHeaderQueryCellInfo",void 0),j([t.Event()],i.prototype,"pdfQueryCellInfo",void 0),j([t.Event()],i.prototype,"excelHeaderQueryCellInfo",void 0),j([t.Event()],i.prototype,"excelQueryCellInfo",void 0),j([t.Event()],i.prototype,"columnDragStart",void 0),j([t.Event()],i.prototype,"columnDrag",void 0),j([t.Event()],i.prototype,"columnDrop",void 0),i}(t.ChildProperty),V=function(){function e(e){this.parent=e}return e.prototype.getModuleName=function(){return"excelExport"},e.prototype.exportToExcel=function(e){if(this.parent.enableVirtualization){var t=this.parent.engineModule.pageSettings;this.parent.engineModule.pageSettings=null,this.parent.engineModule.generateGridData(this.parent.dataSource),this.parent.engineModule.pageSettings=t}var i={fileName:"default",header:"",footer:"",dataCollections:[this.parent.engineModule.pivotValues]};this.parent.trigger("beforeExport",i);for(var r=i.fileName,a=i.dataCollections,o=[],l=0;l<a.length;l++){for(var s=a[l],d=0,p=s.length,h=0,c=this.parent.renderModule.getFormatList(),u=[],m=0,g=0;g<p;g++)if(s[g]){h++,d=s[g].length;for(var v=[],f=0;f<d;f++)if(s[g][f]){var y=s[g][f];if(-1!==y.level||y.rowSpan){var b="value"===y.axis?y.value:y.formattedText;b="grand sum"===y.type?this.parent.localeObj.getConstant("grandTotal"):"sum"===y.type?b.toString().replace("Total",this.parent.localeObj.getConstant("total")):"0"===b?"":b,(-1!==y.level||y.rowSpan)&&(v.push({index:f+1,value:b,colSpan:y.colSpan,rowSpan:y.rowSpan}),"value"===y.axis?(v[v.length-1].style={numberFormat:c[(f-1)%this.parent.dataSource.values.length],bold:!1,wrapText:!0},y.style&&(v[v.length-1].style.backColor=y.style.backgroundColor,v[v.length-1].style.fontColor=y.style.color,v[v.length-1].style.fontName=y.style.fontFamily,v[v.length-1].style.fontSize=Number(y.style.fontSize.split("px")[0]))):(v[v.length-1].style={bold:!0,vAlign:"Center",wrapText:!0,indent:1===f?10*y.level:0},"row"===y.axis&&0===f&&(v[v.length-1].style.hAlign="Left",v[v.length-1].style.indent=2*y.level,m=y.level>m?y.level:m)),v[v.length-1].style.borders={color:"#000000",lineStyle:"Thin"})}f+=y.colSpan?y.colSpan-1:0}else v.push({index:f+1,value:"",colSpan:1,rowSpan:1});u.push({index:h,cells:v})}for(var S=[],f=0;f<d;f++)S.push({index:f+1,width:100});m>0&&(S[0].width=100+20*m),o.push({columns:S,rows:u})}new n.Workbook({worksheets:o},"Excel"===e?"xlsx":"csv").save(r+("Excel"===e?".xlsx":".csv"))},e}(),B=function(){function e(e){this.parent=e}return e.prototype.getModuleName=function(){return"pdfExport"},e.prototype.exportToPDF=function(){var e,t=this.applyEvent(),i=0,r=t.args.dataCollections[i],a=r&&r.length>0?r[0].length:0,n=0;do{var l=new o.PdfGrid;if(r&&r.length>0){l.columns.add(r[0].length-n>=6?6:r[0].length-n);for(var s=r.length,d=0,p=0,h=0;h<s;h++)if(r[h]){var c=!(r[h][0]&&"row"===r[h][0].axis),u=r[h].length>n+6?n+6:r[h].length;c&&l.headers.add(1);for(var m=c?l.headers.getHeader(d):l.rows.addRow(),g=0,v=!0,f=n;f<u;f++){var y=!1;if(r[h][f]){var b=r[h][f];if(-1!==b.level||b.rowSpan){var S=b.formattedText;S="grand sum"===b.type?this.parent.localeObj.getConstant("grandTotal"):"sum"===b.type?S.toString().replace("Total",this.parent.localeObj.getConstant("total")):"0"===S?"":S,(-1!==b.level||b.rowSpan)&&(m.cells.getCell(g).columnSpan=b.colSpan?6-g<b.colSpan?6-g:b.colSpan:1,c&&b.rowSpan&&b.rowSpan>1&&(m.cells.getCell(g).rowSpan=b.rowSpan?b.rowSpan:1),m.cells.getCell(g).value=S.toString()),""!==S&&(v=!1)}p=b.level>p&&0===f?b.level:p,y="value"===b.axis,f+=m.cells.getCell(g).columnSpan?m.cells.getCell(g).columnSpan-1:0,g+=m.cells.getCell(g).columnSpan?m.cells.getCell(g).columnSpan-1:0,b.style&&(m=this.applyStyle(m,b,g))}else m.cells.getCell(g).value="",0===f&&c&&this.parent.dataSource.columns&&this.parent.dataSource.columns.length>0&&l.headers.getHeader(0).cells.getCell(0).rowSpan++;var C=new o.PdfStringFormat;C.paragraphIndent=!c&&0===f&&r[h][f]?15*r[h][f].level:0,C.alignment=y?o.PdfTextAlignment.Right:o.PdfTextAlignment.Left,C.lineAlignment=o.PdfVerticalAlignment.Middle,m.cells.getCell(g).style.stringFormat=C,g++}v&&(m.height=16),d++}0===n&&(l.columns.getColumn(0).width=100+20*p)}var x=new o.PdfLayoutFormat;x.paginateBounds=new o.RectangleF(0,0,0,0),0===n&&this.parent.dataSource.columns&&this.parent.dataSource.columns.length>0&&l.headers.getHeader(0).cells.getCell(0).rowSpan--,e=e?l.draw(e.page,new o.PointF(10,e.bounds.y+e.bounds.height+10),x):l.draw(t.page,new o.PointF(10,20),x),(n+=6)>=a&&t.args.dataCollections.length>i+1&&(i++,a=(r=t.args.dataCollections[i])&&r.length>0?r[0].length:0,n=0)}while(n<a);t.document.save(t.args.fileName+".pdf"),t.document.destroy()},e.prototype.applyStyle=function(e,t,i){var r=this.parent.conditionalFormattingModule.hexToRgb(t.style.backgroundColor),a=new o.PdfSolidBrush(new o.PdfColor(r.r,r.g,r.b));e.cells.getCell(i).style.backgroundBrush=a;var n=Number(t.style.fontSize.split("px")[0]),l=new o.PdfStandardFont(o.PdfFontFamily.TimesRoman,n,o.PdfFontStyle.Regular);return e.cells.getCell(i).style.font=l,r=this.parent.conditionalFormattingModule.hexToRgb(t.style.color),a=new o.PdfSolidBrush(new o.PdfColor(r.r,r.g,r.b)),e.cells.getCell(i).style.textBrush=a,e},e.prototype.applyEvent=function(){if(this.parent.enableVirtualization){var e=this.parent.engineModule.pageSettings;this.parent.engineModule.pageSettings=null,this.parent.engineModule.generateGridData(this.parent.dataSource),this.parent.engineModule.pageSettings=e}var t={fileName:"default",header:"",footer:"",dataCollections:[this.parent.engineModule.pivotValues]};this.parent.trigger("beforeExport",t);var i=t.header,r=t.footer,a=new o.PdfDocument,n=a.pages.add(),l=new o.PdfStandardFont(o.PdfFontFamily.TimesRoman,15,o.PdfFontStyle.Regular),s=new o.PdfSolidBrush(new o.PdfColor(0,0,0)),d=new o.PdfPen(new o.PdfColor(0,0,0),.5),p=new o.PdfPageTemplateElement(new o.RectangleF(0,0,n.graphics.clientSize.width,20));p.graphics.drawString(i,l,d,s,0,0,new o.PdfStringFormat(o.PdfTextAlignment.Center)),a.template.top=p;var h=new o.PdfPageTemplateElement(new o.RectangleF(0,0,n.graphics.clientSize.width,20));return h.graphics.drawString(r,l,d,s,0,0,new o.PdfStringFormat(o.PdfTextAlignment.Center)),a.template.bottom=h,{document:a,page:n,args:t}},e}(),R=function(){function e(e){this.keyConfigs={tab:"tab",enter:"enter"},this.parent=e,this.parent.element.tabIndex=-1===this.parent.element.tabIndex?0:this.parent.element.tabIndex,this.pivotViewKeyboardModule=new t.KeyboardEvents(this.parent.element,{keyAction:this.keyActionHandler.bind(this),keyConfigs:this.keyConfigs,eventName:"keydown"})}return e.prototype.keyActionHandler=function(e){switch(e.action){case"tab":this.processTab(e);break;case"enter":this.processEnter(e)}},e.prototype.getNextButton=function(e){var t=[].slice.call(this.parent.element.querySelectorAll(".e-pivot-button")),i=e;if(this.parent.grid.element.querySelector(".e-pivot-button"))for(var r=t.length,a=0;a<r;a++)if(t[a].getAttribute("data-uid")===e.getAttribute("data-uid")){i=t[a+1]?t[a+1]:i;break}return i},e.prototype.processTab=function(e){var i=e.target;if(i&&t.closest(i,".e-pivot-button")){var r=this.parent.grid.serviceLocator.getService("focus"),a=this.getNextButton(i);if(a.getAttribute("data-uid")!==i.getAttribute("data-uid"))r.currentInfo.skipAction=!0,a.focus();else{r.focus();l=r.getFocusedElement();t.addClass([l],["e-focused","e-focus"]),l.setAttribute("tabindex","0")}return void e.preventDefault()}if(!this.parent.showGroupingBar&&this.parent.showFieldList){if(i&&t.closest(i,".e-toggle-field-list")){(r=this.parent.grid.serviceLocator.getService("focus")).focus();l=r.getFocusedElement();t.addClass([l],["e-focused","e-focus"]),l.setAttribute("tabindex","0")}}else if(!this.parent.showGroupingBar&&!this.parent.showFieldList&&i&&t.closest(i,".e-pivotview")){var n=t.closest(i,".e-pivotview"),r=this.parent.grid.serviceLocator.getService("focus"),o=[].slice.call(n.getElementsByTagName("tr"));if(i.innerHTML===o[o.length-1].lastChild.innerHTML)r.currentInfo.skipAction=!0;else{r.focus();var l=r.getFocusedElement();t.addClass([l],["e-focused","e-focus"]),l.setAttribute("tabindex","0")}}},e.prototype.processEnter=function(e){var i=e.target;if(i&&t.closest(i,".e-grid")&&i.querySelector("."+b))return i.querySelector("."+b).click(),void e.preventDefault()},e.prototype.destroy=function(){this.pivotViewKeyboardModule&&this.pivotViewKeyboardModule.destroy()},e}(),H=function(){function e(e){this.parent=e,this.parent.contextMenuModule=this}return e.prototype.render=function(){this.renderContextMenu()},e.prototype.renderContextMenu=function(){var e={cssClass:"e-pivot-context-menu",items:[{text:this.parent.localeObj.getConstant("addToFilter"),id:"Context_Filters"},{text:this.parent.localeObj.getConstant("addToRow"),id:"Context_Rows"},{text:this.parent.localeObj.getConstant("addToColumn"),id:"Context_Columns"},{text:this.parent.localeObj.getConstant("addToValue"),id:"Context_Values"}],enableRtl:this.parent.enableRtl,beforeOpen:this.onBeforeMenuOpen.bind(this),select:this.onSelectContextMenu.bind(this)};this.parent.element.appendChild(t.createElement("ul",{id:this.parent.element.id+"_PivotContextMenu"})),this.menuObj=new l.ContextMenu(e),this.menuObj.appendTo("#"+this.parent.element.id+"_PivotContextMenu")},e.prototype.onBeforeMenuOpen=function(e){var i=[].slice.call(e.element.querySelectorAll("li")),r=this.fieldElement.querySelector(".e-content").getAttribute("data-type");if(t.removeClass(i,"e-disabled"),"CalculatedField"===r)for(var a=0,n=i;a<n.length;a++){var o=n[a];o.textContent!==this.parent.localeObj.getConstant("addToValue")&&t.addClass([o],"e-disabled")}},e.prototype.onSelectContextMenu=function(e){if(null!==e.element.textContent){var t=this.fieldElement.getAttribute("data-uid"),i=e.item.id.replace("Context_","").toLowerCase();this.parent.pivotCommon.dataSourceUpdate.updateDataSource(t,i,-1),this.parent.updateDataSource(!0),this.fieldElement=void 0}},e.prototype.destroy=function(){this.parent.isDestroyed&&this.menuObj&&!this.menuObj.isDestroyed&&this.menuObj.destroy()},e}(),z=function(){function e(e){this.previousValues={top:0,left:0},this.parent=e,this.addInternalEvents()}return e.prototype.getModuleName=function(){return"virtualscroll"},e.prototype.addInternalEvents=function(){this.parent.on("content-ready",this.wireEvents,this)},e.prototype.wireEvents=function(){var e=this.parent.element.querySelector(".e-movablecontent"),i=this.parent.element.querySelector(".e-frozencontent"),r=this.parent.element.querySelector(".e-movableheader");t.EventHandler.clearEvents(e),t.EventHandler.clearEvents(i),this.parent.engineModule&&(t.EventHandler.add(e,"scroll touchmove pointermove",this.onHorizondalScroll(r,e,i),this),t.EventHandler.add(e,"scroll wheel touchmove pointermove",this.onVerticalScroll(i,e),this),t.EventHandler.add(e,"mouseup touchend",this.common(r,e,i),this)),this.parent.grid.isPreventScrollEvent=!0},e.prototype.update=function(e,t,i,a,n){if("vertical"===this.direction){var o="row"===this.parent.dataSource.valueAxis?this.parent.dataSource.values.length:1,l=this.parent.pageSettings.rowSize*o*this.parent.gridSettings.rowHeight,s=Math.ceil(i/l);if(this.parent.scrollPosObject.vertical===s)return void r.hideSpinner(this.parent.element);r.showSpinner(this.parent.element),this.parent.scrollPosObject.vertical=s,this.parent.engineModule.pageSettings.rowCurrentPage=s>1?s:1,this.parent.engineModule.generateGridData(this.parent.dataSource,this.parent.engineModule.headerCollection),this.parent.pivotValues=this.parent.engineModule.pivotValues;h=l*(p=Math.ceil(this.parent.engineModule.rowStartPos/(this.parent.pageSettings.rowSize*o)))-this.parent.engineModule.rowFirstLvl*o*this.parent.gridSettings.rowHeight;this.parent.scrollPosObject.verticalSection=h}else{var d="column"===this.parent.dataSource.valueAxis?this.parent.dataSource.values.length:1,l=this.parent.pageSettings.columnSize*d*this.parent.gridSettings.columnWidth,s=Math.ceil(a/l);if(this.parent.scrollPosObject.horizontal===s)return void r.hideSpinner(this.parent.element);r.showSpinner(this.parent.element),this.parent.scrollPosObject.horizontal=s,this.parent.engineModule.pageSettings.columnCurrentPage=s>1?s:1,this.parent.engineModule.generateGridData(this.parent.dataSource,this.parent.engineModule.headerCollection),this.parent.pivotValues=this.parent.engineModule.pivotValues;var p=Math.ceil(this.parent.engineModule.colStartPos/(this.parent.pageSettings.columnSize*d)),h=l*p-this.parent.engineModule.colFirstLvl*d*this.parent.gridSettings.columnWidth;this.parent.scrollPosObject.horizontalSection=h}},e.prototype.common=function(e,t,i){var r=this;return function(i){r.update(e,t,t.scrollTop,t.scrollLeft,i)}},e.prototype.onHorizondalScroll=function(e,i,r){var a,n=this;return function(o){var l=i.scrollLeft;if("wheel"!==o.type&&"touchmove"!==o.type||(clearTimeout(a),a=setTimeout(function(){l="touchmove"===o.type?i.scrollLeft:l,n.update(e,i,i.scrollTop,l,o)},300)),n.previousValues.left===l)return void(r.scrollTop=i.scrollTop);n.direction="horizondal";var s=n.parent.scrollPosObject.horizontalSection>l?-(n.parent.scrollPosObject.horizontalSection-l):l+e.offsetWidth-(n.parent.scrollPosObject.horizontalSection+i.querySelector(".e-table").offsetWidth);(n.parent.scrollPosObject.horizontalSection>l||s>1)&&(l>e.clientWidth?(n.parent.scrollPosObject.left<1&&(n.parent.scrollPosObject.left=e.clientWidth),n.parent.scrollPosObject.left=n.parent.scrollPosObject.left-50,s=n.parent.scrollPosObject.horizontalSection>l?s-n.parent.scrollPosObject.left:s+n.parent.scrollPosObject.left):s=-n.parent.scrollPosObject.horizontalSection,t.setStyleAttribute(i.querySelector(".e-table"),{transform:"translate("+(n.parent.scrollPosObject.horizontalSection+s)+"px,"+n.parent.scrollPosObject.verticalSection+"px)"}),t.setStyleAttribute(e.querySelector(".e-table"),{transform:"translate("+(n.parent.scrollPosObject.horizontalSection+s)+"px,0px)"}),n.parent.scrollPosObject.horizontalSection=n.parent.scrollPosObject.horizontalSection+s),n.previousValues.left=l,e.scrollLeft=i.scrollLeft}},e.prototype.onVerticalScroll=function(e,i){var r,a=this;return function(n){var o=i.scrollTop;if("wheel"!==n.type&&"touchmove"!==n.type||(clearTimeout(r),r=setTimeout(function(){a.update(null,i,i.scrollTop,i.scrollLeft,n)},300)),a.previousValues.top!==o){a.direction="vertical";var l=a.parent.scrollPosObject.verticalSection>o?-(a.parent.scrollPosObject.verticalSection-o):o+e.clientHeight-(a.parent.scrollPosObject.verticalSection+e.querySelector(".e-table").offsetHeight);(a.parent.scrollPosObject.verticalSection>o||l>1)&&(o>e.clientHeight?(a.parent.scrollPosObject.top<1&&(a.parent.scrollPosObject.top=e.clientHeight),a.parent.scrollPosObject.top=a.parent.scrollPosObject.top-50,l=a.parent.scrollPosObject.verticalSection>o?l-a.parent.scrollPosObject.top:l+a.parent.scrollPosObject.top):l=-a.parent.scrollPosObject.verticalSection,t.setStyleAttribute(e.querySelector(".e-table"),{transform:"translate(0px,"+(a.parent.scrollPosObject.verticalSection+l)+"px)"}),t.setStyleAttribute(i.querySelector(".e-table"),{transform:"translate("+a.parent.scrollPosObject.horizontalSection+"px,"+(a.parent.scrollPosObject.verticalSection+l)+"px)"}),a.parent.scrollPosObject.verticalSection=a.parent.scrollPosObject.verticalSection+l),a.previousValues.top=o,e.scrollTop=i.scrollTop,i.scrollTop=e.scrollTop}}},e.prototype.removeInternalEvents=function(){this.parent.isDestroyed||this.parent.off("content-ready",this.wireEvents)},e.prototype.destroy=function(){this.removeInternalEvents()},e}(),W=function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])};return function(t,i){function r(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),G=function(e,t,i,r){var a,n=arguments.length,o=n<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,r);else for(var l=e.length-1;l>=0;l--)(a=e[l])&&(o=(n<3?a(o):n>3?a(t,i,o):a(t,i))||o);return n>3&&o&&Object.defineProperty(t,i,o),o},U=function(e){function i(){return null!==e&&e.apply(this,arguments)||this}return W(i,e),G([t.Property(!0)],i.prototype,"showFilterIcon",void 0),G([t.Property(!0)],i.prototype,"showSortIcon",void 0),G([t.Property(!0)],i.prototype,"showRemoveIcon",void 0),i}(t.ChildProperty),_=function(e){function a(t,i){var r=e.call(this,t,i)||this;return r.resizeInfo={},r.scrollPosObject={vertical:0,horizontal:0,verticalSection:0,horizontalSection:0,top:0,left:0,scrollDirection:{direction:"",position:0}},r.needsID=!0,r.pivotView=r,r}return W(a,e),n=a,a.prototype.requiredModules=function(){var e,t=[];return this.allowConditionalFormatting&&t.push({args:[this],member:"conditionalformatting"}),this.allowCalculatedField&&(e=!0,t.push({args:[this],member:"calculatedfield"})),this.showGroupingBar&&(e=!0,t.push({args:[this],member:"grouping"})),this.showFieldList&&(e=!0,t.push({args:[this],member:"fieldlist"})),this.allowExcelExport&&t.push({args:[this],member:"excelExport"}),this.allowPdfExport&&t.push({args:[this],member:"pdfExport"}),this.enableVirtualization&&t.push({args:[this],member:"virtualscroll"}),e&&t.push({args:[this],member:"common"}),t},a.prototype.preRender=function(){this.initProperties(),this.isAdaptive=t.Browser.isDevice,this.toolTip=new r.Tooltip({target:"td.e-valuescontent",showTipPointer:!1,enableRtl:this.enableRtl,beforeRender:this.setToolTip.bind(this),beforeOpen:this.onBeforeTooltipOpen}),this.keyboardModule=new R(this),this.contextMenuModule=new H(this),this.toolTip.appendTo(this.element),this.globalize=new t.Internationalization(this.locale),this.defaultLocale={grandTotal:"Grand Total",total:"Total",value:"Value",noValue:"No value",row:"Row",column:"Column",collapse:"Collapse",expand:"Expand",rowAxisPrompt:"Drop row here",columnAxisPrompt:"Drop column here",valueAxisPrompt:"Drop value here",filterAxisPrompt:"Drop filter here",filter:"Filter",filtered:"Filtered",sort:"Sort",filters:"Filters",rows:"Rows",columns:"Columns",values:"Values",close:"Close",cancel:"Cancel",delete:"Delete",calculatedField:"Calculated Field",createCalculatedField:"Create Calculated Field",fieldName:"Enter the field name",error:"Error",invalidFormula:"Invalid formula.",dropText:'Example: ("Sum(Order_Count)" + "Sum(In_Stock)") * 250',dropTextMobile:"Add fields and edit formula here.",dropAction:"Calculated field cannot be place in any other region except value axis.",alert:"Alert",warning:"Warning",ok:"OK",search:"Search",drag:"Drag",remove:"Remove",sum:"Sum",average:"Average",count:"Count",min:"Min",max:"Max",allFields:"All Fields",formula:"Formula",addToRow:"Add to Row",addToColumn:"Add to Column",addToValue:"Add to Value",addToFilter:"Add to Filter",emptyData:"No records to display",fieldExist:"A field already exists in this name. Please enter a different name.",confirmText:"A calculation field already exists in this name. Do you want to replace it?",noMatches:"No matches",format:"Summaries values by",edit:"Edit",clear:"Clear",formulaField:"Drag and drop fields to formula",dragField:"Drag field to formula",clearFilter:"Clear",by:"by",member:"Member",label:"Label",date:"Date",enterValue:"Enter value",chooseDate:"Enter date",Before:"Before",BeforeOrEqualTo:"Before Or Equal To",After:"After",AfterOrEqualTo:"After Or Equal To",labelTextContent:"Show the items for which the label",dateTextContent:"Show the items for which the date",valueTextContent:"Show the items for which",Equals:"Equals",DoesNotEquals:"Does Not Equal",BeginWith:"Begins With",DoesNotBeginWith:"Does Not Begin With",EndsWith:"Ends With",DoesNotEndsWith:"Does Not End With",Contains:"Contains",DoesNotContains:"Does Not Contain",GreaterThan:"Greater Than",GreaterThanOrEqualTo:"Greater Than Or Equal To",LessThan:"Less Than",LessThanOrEqualTo:"Less Than Or Equal To",Between:"Between",NotBetween:"Not Between",And:"and",NotEquals:"Not Equals",AllValues:"All Values",conditionalFormating:"Conditional Formatting",apply:"APPLY",condition:"Add Condition",formatLabel:"Format"},this.localeObj=new t.L10n(this.getModuleName(),this.defaultLocale,this.locale),this.isDragging=!1,this.addInternalEvents()},a.prototype.onBeforeTooltipOpen=function(e){e.element.classList.add("e-pivottooltipwrap")},a.prototype.initProperties=function(){if(this.setProperties({pivotValues:[]},!0),this.queryCellInfo=this.gridSettings.queryCellInfo?this.gridSettings.queryCellInfo.bind(this):void 0,this.headerCellInfo=this.gridSettings.headerCellInfo?this.gridSettings.headerCellInfo.bind(this):void 0,this.resizing=this.gridSettings.resizing?this.gridSettings.resizing.bind(this):void 0,this.resizeStop=this.gridSettings.resizeStop?this.gridSettings.resizeStop.bind(this):void 0,this.pdfHeaderQueryCellInfo=this.gridSettings.pdfHeaderQueryCellInfo?this.gridSettings.pdfHeaderQueryCellInfo.bind(this):void 0,this.pdfQueryCellInfo=this.gridSettings.pdfQueryCellInfo?this.gridSettings.pdfQueryCellInfo.bind(this):void 0,this.excelHeaderQueryCellInfo=this.gridSettings.excelHeaderQueryCellInfo?this.gridSettings.excelHeaderQueryCellInfo.bind(this):void 0,this.excelQueryCellInfo=this.gridSettings.excelQueryCellInfo?this.gridSettings.excelQueryCellInfo.bind(this):void 0,this.columnDragStart=this.gridSettings.columnDragStart?this.gridSettings.columnDragStart.bind(this):void 0,this.columnDrag=this.gridSettings.columnDrag?this.gridSettings.columnDrag.bind(this):void 0,this.columnDrop=this.gridSettings.columnDrop?this.gridSettings.columnDrop.bind(this):void 0,null===this.gridSettings.rowHeight&&this.setProperties({gridSettings:{rowHeight:this.isAdaptive?48:36}},!0),this.enableVirtualization&&(this.height="string"==typeof this.height&&-1===this.height.indexOf("%")?Number(this.height.split("px")[0]):this.height,this.width="string"==typeof this.width&&-1===this.width.indexOf("%")?Number(this.width.split("px")[0]):this.width,this.height="number"==typeof this.height?this.height:300,this.width="number"==typeof this.width?this.width:800),this.enableVirtualization){var e=1,t=1;"row"===this.dataSource.valueAxis?t=this.dataSource.values.length:e=this.dataSource.values.length,this.pageSettings={columnCurrentPage:1,rowCurrentPage:1,columnSize:Math.ceil((Math.floor(this.width/this.gridSettings.columnWidth)-1)/e),rowSize:Math.ceil(Math.floor(this.height/this.gridSettings.rowHeight)/t)},this.allowExcelExport&&n.Inject(V),this.allowPdfExport&&n.Inject(B)}},a.prototype.render=function(){r.createSpinner({target:this.element},this.createElement),this.trigger("load",{dataSource:this.dataSource}),this.updateClass(),this.notify("init-groupingbar",{}),this.notify("initial-load",{}),this.isAdaptive&&this.contextMenuModule.render()},a.prototype.addInternalEvents=function(){this.on("initial-load",this.generateData,this),this.on(g,this.renderPivotGrid,this),this.on("content-ready",this.onContentReady,this)},a.prototype.removeInternalEvents=function(){this.off("initial-load",this.generateData),this.off(g,this.renderPivotGrid),this.off("content-ready",this.onContentReady)},a.prototype.getPersistData=function(){var e=["dataSource","pivotValues","gridSettings"];return this.addOnPersist(e)},a.prototype.getModuleName=function(){return"pivotview"},a.prototype.copy=function(e){this.grid.copy(e)},a.prototype.onPropertyChanged=function(t,i){for(var r=0,a=Object.keys(t);r<a.length;r++)switch(a[r]){case"dataSource":this.notify("initial-load",{});break;case"pivotValues":this.notify(g,{});break;case"gridSettings":this.renderModule.updateGridSettings();break;case"locale":case"currencyCode":this.toolTip.destroy(),e.prototype.refresh.call(this);break;case"enableRtl":this.notify(g,{}),this.updateClass();break;case"groupingBarSettings":this.axisFieldModule.render()}},a.prototype.renderPivotGrid=function(){this.enableVirtualization&&(this.virtualscrollModule=new z(this)),this.renderModule=new E(this),this.renderModule.render(),(this.showFieldList||this.showGroupingBar)&&this.notify(m,this),this.trigger("dataBound"),this.allowConditionalFormatting&&this.applyFormatting()},a.prototype.updateDataSource=function(e){r.showSpinner(this.element),this.engineModule=new u(this.dataSource,"",this.engineModule.fieldList,this.pageSettings,this.enableValueSorting);var t={dataSource:this.dataSource,pivotValues:this.engineModule.pivotValues};this.trigger("enginePopulated",t),this.pivotCommon.engineModule=this.engineModule,this.pivotCommon.dataSource=this.dataSource,this.setProperties({pivotValues:this.engineModule.pivotValues},!0),this.renderPivotGrid()},a.prototype.destroy=function(){this.removeInternalEvents(),this.showGroupingBar&&this.groupingBarModule&&this.groupingBarModule.destroy(),this.enableVirtualization&&this.virtualscrollModule&&this.virtualscrollModule.destroy(),this.allowConditionalFormatting&&this.conditionalFormattingModule&&this.conditionalFormattingModule.destroy(),this.isAdaptive&&this.contextMenuModule&&this.contextMenuModule.destroy(),this.keyboardModule&&this.keyboardModule.destroy(),this.unwireEvents(),t.removeClass([this.element],v),t.removeClass([this.element],f),t.removeClass([this.element],y),this.element.innerHTML="",e.prototype.destroy.call(this)},a.prototype.excelExport=function(e,t,i,r){this.enableVirtualization?this.excelExportModule.exportToExcel("Excel"):this.grid.excelExport(e,t,i,r)},a.prototype.csvExport=function(e,t,i,r){this.enableVirtualization?this.excelExportModule.exportToExcel("CSV"):this.grid.csvExport(e,t,i,r)},a.prototype.pdfExport=function(e,t,i,r){this.enableVirtualization?this.pdfExportModule.exportToPDF():this.grid.pdfExport(e,t,i,r)},a.prototype.onDrill=function(e){var i=e.parentElement.getAttribute("fieldname"),a=this.engineModule.pivotValues[Number(e.parentElement.getAttribute("index"))][Number(e.parentElement.getAttribute("aria-colindex"))].actualText;this.engineModule.fieldList[i].members[a].isDrilled=!e.classList.contains("e-collapse");var n=!1,o=t.extend({},this.dataSource,null,!0).properties;if(o.drilledMembers&&0!==o.drilledMembers.length){for(var l=0;l<o.drilledMembers.length;l++){var s=o.drilledMembers[l];if(s.name===i){n=!0;var d=s.items.indexOf(a);d>-1?s.items.splice(d,1):s.items.push(a)}}n||o.drilledMembers.push({name:i,items:[a]})}else o.drilledMembers=[{name:i,items:[a]}];this.setProperties({dataSource:{drilledMembers:o.drilledMembers}},!0),r.showSpinner(this.element),this.engineModule.generateGridData(this.dataSource),this.setProperties({pivotValues:this.engineModule.pivotValues},!0),this.renderPivotGrid()},a.prototype.onContentReady=function(){if(this.showFieldList?r.hideSpinner(this.pivotFieldListModule.fieldListSpinnerElement):this.fieldListSpinnerElement&&r.hideSpinner(this.fieldListSpinnerElement),this.isEmptyGrid?this.isEmptyGrid=!1:r.hideSpinner(this.element),this.enableVirtualization&&this.engineModule){this.element.querySelector(".e-movablecontent")&&!this.element.querySelector(".e-movablecontent").querySelector(".e-virtualtrack")&&(this.virtualDiv=t.createElement("div",{className:"e-virtualtrack"}),this.element.querySelector(".e-movablecontent").appendChild(this.virtualDiv)),this.element.querySelector(".e-movableheader")&&!this.element.querySelector(".e-movableheader").querySelector(".e-virtualtrack")?(this.virtualHeaderDiv=t.createElement("div",{className:"e-virtualtrack"}),this.element.querySelector(".e-movableheader").appendChild(this.virtualHeaderDiv)):this.virtualHeaderDiv=this.element.querySelector(".e-movableheader").querySelector(".e-virtualtrack");var e=this.element.querySelector(".e-movablecontent").querySelector(".e-table"),i=this.gridSettings.rowHeight*this.engineModule.rowCount+.1-e.clientHeight,a=this.gridSettings.columnWidth*this.engineModule.columnCount-this.grid.columns[0].width;t.setStyleAttribute(this.virtualDiv,{height:(i>.1?i:.1)+"px",width:(a>.1?a:.1)+"px"}),t.setStyleAttribute(this.virtualHeaderDiv,{height:0,width:(a>.1?a:.1)+"px"});var n=this.element.querySelector(".e-movablecontent"),o=this.element.querySelector(".e-frozencontent"),l=this.element.querySelector(".e-movableheader");t.setStyleAttribute(o.querySelector(".e-table"),{transform:"translate(0px,"+this.scrollPosObject.verticalSection+"px)"}),t.setStyleAttribute(n.querySelector(".e-table"),{transform:"translate("+this.scrollPosObject.horizontalSection+"px,"+this.scrollPosObject.verticalSection+"px)"}),t.setStyleAttribute(l.querySelector(".e-table"),{transform:"translate("+this.scrollPosObject.horizontalSection+"px,0px)"})}this.element.style.minWidth="500px",this.grid.element.style.minWidth="500px",this.unwireEvents(),this.wireEvents()},a.prototype.setToolTip=function(e){var t=Number(e.target.getAttribute("aria-colindex")),i=Number(e.target.getAttribute("index")),r=this.pivotValues[i][t];this.toolTip.content="",r?this.toolTip.content="<div class=e-pivottooltip><p class=e-tooltipheader>"+this.localeObj.getConstant("row")+":</p><p class=e-tooltipcontent>"+this.getRowText(i,0)+"</p></br><p class=e-tooltipheader>"+this.localeObj.getConstant("column")+":</p><p class=e-tooltipcontent>"+this.getColText(0,t,i)+"</p></br><p class=e-tooltipheader>"+this.localeObj.getConstant("value")+":</p><p class=e-tooltipcontent>"+("0"===r.formattedText?this.localeObj.getConstant("noValue"):r.formattedText)+"</p></div>":e.cancel=!0},a.prototype.getRowText=function(e,t){for(var i=this.pivotValues[e][t],r=i.level,a="grand sum"===i.type?this.localeObj.getConstant("grandTotal"):i.formattedText;r>0;)e--,r>(i=this.pivotValues[e][t]).level&&(a=a+" - "+("grand sum"===i.type?this.localeObj.getConstant("grandTotal"):i.formattedText),r=i.level);return a.split(" - ").reverse().join(" - ")},a.prototype.getColText=function(e,t,i){for(var r=this.pivotValues[0][t],a=r.axis,n="grand sum"===r.type?this.localeObj.getConstant("grandTotal"):r.formattedText;"value"!==a&&i>e;)e++,this.pivotValues[e]&&(a=(r=this.pivotValues[e][t]).axis,"sum"!==r.type&&"grand sum"!==r.type&&"value"!==a&&(n=n+" - "+r.formattedText));return n},a.prototype.updateClass=function(){this.enableRtl?t.addClass([this.element],f):t.removeClass([this.element],f),this.isAdaptive?t.addClass([this.element],y):t.removeClass([this.element],y)},a.prototype.wireEvents=function(){t.EventHandler.add(this.element,this.isAdaptive?"touchend":"click",this.mouseClickHandler,this),window.addEventListener("resize",this.onWindowResize.bind(this),!0)},a.prototype.mouseClickHandler=function(e){var t=e.target;if((t.classList.contains("e-headercell")||t.classList.contains("e-headercelldiv")||t.classList.contains("e-rowsheader")||t.classList.contains("e-rowcell")||t.classList.contains("e-stackedheadercelldiv")||t.classList.contains("e-headertext")||t.classList.contains("e-ascending")||t.classList.contains("e-descending"))&&this.enableValueSorting){var i=null;if(t.classList.contains("e-headercell")||t.classList.contains("e-rowsheader")||t.classList.contains("e-rowcell")?i=t:t.classList.contains("e-stackedheadercelldiv")||t.classList.contains("e-headercelldiv")||t.classList.contains("e-ascending")||t.classList.contains("e-descending")?i=t.parentElement:t.classList.contains("e-headertext")&&(i=t.parentElement.parentElement),this.CellClicked(t),i.parentElement.parentElement.parentElement.parentElement.classList.contains("e-movableheader")&&"column"===this.dataSource.valueAxis||i.parentElement.classList.contains("e-row")&&"row"===this.dataSource.valueAxis){var a=Number(i.getAttribute("aria-colindex")),n=Number(i.getAttribute("index"));"row"===this.dataSource.valueAxis&&this.dataSource.values.length>1?n="value"===this.pivotValues[n][a].type?n:n+1:"column"===this.dataSource.valueAxis&&this.dataSource.values.length>1&&(a=Number(i.getAttribute("aria-colindex"))+Number(i.getAttribute("aria-colspan"))-1,n=this.engineModule.headerContent.length-1),this.setProperties({dataSource:{valueSortSettings:{columnIndex:Number(i.getAttribute("aria-colindex"))+Number(i.getAttribute("aria-colspan"))-1,sortOrder:"Descending"===this.dataSource.valueSortSettings.sortOrder?"Ascending":"Descending",headerText:this.pivotValues[n][a].valueSort.levelName,headerDelimiter:this.dataSource.valueSortSettings.headerDelimiter?this.dataSource.valueSortSettings.headerDelimiter:"."}}},!0),r.showSpinner(this.element),this.engineModule.enableValueSorting=!0,this.engineModule.generateGridData(this.dataSource,this.engineModule.headerCollection),this.setProperties({pivotValues:this.engineModule.pivotValues},!0),this.renderPivotGrid()}}else{if(!t.classList.contains("e-collapse")&&!t.classList.contains("e-expand"))return void this.CellClicked(t);this.onDrill(t)}},a.prototype.onWindowResize=function(){var e=this;clearTimeout(this.timeOutObj),this.timeOutObj=setTimeout(function(){if(e.element&&e.element.classList.contains("e-pivotview")&&e.engineModule){var t=e.renderModule.calculateColWidth(e.dataSource.values.length>0?e.engineModule.pivotValues[0].length:2);e.grid.width=e.renderModule.calculateGridWidth();for(var i=0;i<e.grid.columns.length;i++)0===i&&t<(e.showGroupingBar&&e.groupingBarModule?250:200)?e.grid.columns[i].width=e.showGroupingBar&&e.groupingBarModule?250:200:e.grid.columns[i].width=t;e.grid.headerModule.refreshUI(),e.showGroupingBar&&e.groupingBarModule&&e.element.querySelector(".e-grouping-bar")&&e.groupingBarModule.setGridRowWidth()}},500)},a.prototype.CellClicked=function(e){var t=null;e.classList.contains("e-headercell")||e.classList.contains("e-rowcell")?t=e:e.classList.contains("e-stackedheadercelldiv")||e.classList.contains("e-cellvalue")||e.classList.contains("e-headercelldiv")?t=e.parentElement:e.classList.contains("e-headertext")&&(t=e.parentElement.parentElement),t&&this.cellClick&&this.trigger("cellClick",{currentCell:t,data:this.pivotValues[Number(t.getAttribute("index"))][Number(t.getAttribute("aria-colindex"))]})},a.prototype.unwireEvents=function(){t.EventHandler.remove(this.element,this.isAdaptive?"touchend":"click",this.mouseClickHandler),window.removeEventListener("resize",this.onWindowResize.bind(this),!0)},a.prototype.renderEmptyGrid=function(){this.isEmptyGrid=!0,this.element.innerHTML="",this.renderModule=new E(this),this.renderModule.bindGrid(this,!0),this.grid.showSpinner=function(){},this.grid.hideSpinner=function(){},this.element.appendChild(t.createElement("div",{id:this.element.id+"_grid"})),this.grid.appendTo("#"+this.element.id+"_grid")},a.prototype.initEngine=function(){this.trigger("enginePopulating",{dataSource:this.dataSource}),this.engineModule=new u(this.dataSource,"",void 0,this.pageSettings,this.enableValueSorting),this.setProperties({pivotValues:this.engineModule.pivotValues},!0),this.trigger("enginePopulated",{pivotValues:this.pivotValues}),this.notify(g,{}),this.isEmptyGrid=!1},a.prototype.generateData=function(){var e=this;this.renderEmptyGrid(),r.showSpinner(this.element),this.dataSource&&this.dataSource.data?this.dataSource.data instanceof i.DataManager?setTimeout(function(){e.dataSource.data.executeQuery(new i.Query).then(function(t){e.element.querySelector(".e-spinner-pane")||r.showSpinner(e.element),e.setProperties({dataSource:{data:t.result}},!0),e.initEngine()})},100):this.dataSource.data.length>0?this.initEngine():r.hideSpinner(this.element):r.hideSpinner(this.element)},a.prototype.applyFormatting=function(){if(this.pivotValues){for(var e=0;e<this.pivotValues.length;e++)for(var t=1;this.pivotValues[e]&&t<this.pivotValues[e].length;t++)if("value"===this.pivotValues[e][t].axis){this.pivotValues[e][t].style=void 0,this.pivotValues[e][t].cssClass=void 0;for(var i=this.dataSource.conditionalFormatSettings,r=0;r<i.length;r++)if(this.checkCondition(this.pivotValues[e][t].value,i[r].conditions,i[r].value1,i[r].value2)){var a=this.dataSource.values.length>1?this.dataSource.columns.length:0===this.dataSource.columns.length?0:this.dataSource.columns.length-1;i[r].measure&&1!==this.dataSource.values.length&&!(this.pivotValues[a][t].valueSort.levelName.indexOf(i[r].measure)>-1)||i[r].label&&!this.pivotValues[this.dataSource.values.length>1?a-1:a][t].valueSort[i[r].label]&&!this.pivotValues[e][0].valueSort[i[r].label]||(i[r].style&&i[r].style.backgroundColor&&(i[r].style.backgroundColor=this.conditionalFormattingModule.isHex(i[r].style.backgroundColor.substr(1))?i[r].style.backgroundColor:this.conditionalFormattingModule.colourNameToHex(i[r].style.backgroundColor)),i[r].style&&i[r].style.color&&(i[r].style.color=this.conditionalFormattingModule.isHex(i[r].style.color.substr(1))?i[r].style.color:this.conditionalFormattingModule.colourNameToHex(i[r].style.color)),this.pivotValues[e][t].style=i[r].style,this.pivotValues[e][t].cssClass="format"+this.element.id+r)}}for(var n=this.dataSource.conditionalFormatSettings,r=0;r<n.length;r++){var o=function(){var e=document.createElement("style");return e.appendChild(document.createTextNode("")),document.head.appendChild(e),e.sheet}(),l="color: "+n[r].style.color+"!important;background-color: "+n[r].style.backgroundColor+"!important;font-size: "+n[r].style.fontSize+"!important;font-family: "+n[r].style.fontFamily+" !important;";o.insertRule(".format"+this.element.id+r+"{"+l+"}",0)}}},a.prototype.checkCondition=function(e,t,i,r){switch(t){case"LessThan":return e<i;case"LessThanOrEqualTo":return e<=i;case"GreaterThan":return e>i;case"GreaterThanOrEqualTo":return e>=i;case"Equals":return e===i;case"NotEquals":return e!==i;case"Between":return i<r&&e>=i&&e<=r||i>r&&e<=i&&e>=r;case"NotBetween":return!(i<r&&e>=i&&e<=r||i>r&&e<=i&&e>=r);default:return!1}},G([t.Property("USD")],a.prototype,"currencyCode",void 0),G([t.Property(!1)],a.prototype,"showFieldList",void 0),G([t.Complex({},k)],a.prototype,"gridSettings",void 0),G([t.Complex({},U)],a.prototype,"groupingBarSettings",void 0),G([t.Complex({},N)],a.prototype,"dataSource",void 0),G([t.Property()],a.prototype,"pivotValues",void 0),G([t.Property(!1)],a.prototype,"showGroupingBar",void 0),G([t.Property(!1)],a.prototype,"showValuesButton",void 0),G([t.Property(!1)],a.prototype,"allowCalculatedField",void 0),G([t.Property(!1)],a.prototype,"enableValueSorting",void 0),G([t.Property(!1)],a.prototype,"allowConditionalFormatting",void 0),G([t.Property("auto")],a.prototype,"height",void 0),G([t.Property("auto")],a.prototype,"width",void 0),G([t.Property(!1)],a.prototype,"allowExcelExport",void 0),G([t.Property(!1)],a.prototype,"enableVirtualization",void 0),G([t.Property(!1)],a.prototype,"allowPdfExport",void 0),G([t.Event()],a.prototype,"queryCellInfo",void 0),G([t.Event()],a.prototype,"headerCellInfo",void 0),G([t.Event()],a.prototype,"resizing",void 0),G([t.Event()],a.prototype,"resizeStop",void 0),G([t.Event()],a.prototype,"pdfHeaderQueryCellInfo",void 0),G([t.Event()],a.prototype,"pdfQueryCellInfo",void 0),G([t.Event()],a.prototype,"excelHeaderQueryCellInfo",void 0),G([t.Event()],a.prototype,"excelQueryCellInfo",void 0),G([t.Event()],a.prototype,"columnDragStart",void 0),G([t.Event()],a.prototype,"columnDrag",void 0),G([t.Event()],a.prototype,"columnDrop",void 0),G([t.Event()],a.prototype,"load",void 0),G([t.Event()],a.prototype,"enginePopulating",void 0),G([t.Event()],a.prototype,"enginePopulated",void 0),G([t.Event()],a.prototype,"dataBound",void 0),G([t.Event()],a.prototype,"created",void 0),G([t.Event()],a.prototype,"destroyed",void 0),G([t.Event()],a.prototype,"beforeExport",void 0),G([t.Event()],a.prototype,"cellClick",void 0),a=n=G([t.NotifyPropertyChanges],a);var n}(t.Component),Q=function(){function e(e){this.keyConfigs={shiftF:"shift+F",shiftS:"shift+S",delete:"delete"},this.parent=e,this.parent.element.tabIndex=-1===this.parent.element.tabIndex?0:this.parent.element.tabIndex,this.keyboardModule=new t.KeyboardEvents(this.parent.element,{keyAction:this.keyActionHandler.bind(this),keyConfigs:this.keyConfigs,eventName:"keydown"})}return e.prototype.keyActionHandler=function(e){switch(e.action){case"shiftF":this.processFilter(e);break;case"shiftS":this.processSort(e);break;case"delete":this.processDelete(e)}},e.prototype.processSort=function(e){var i=e.target;if(i&&t.closest(i,".e-pivot-button")&&!t.closest(i,".e-values")&&!t.closest(i,".e-axis-filter"))return i.querySelector(".e-sort").click(),void e.preventDefault()},e.prototype.processFilter=function(e){var i=e.target;if(i&&t.closest(i,".e-pivot-button")&&!t.closest(i,".e-values"))return i.querySelector(".e-btn-filter").click(),void e.preventDefault()},e.prototype.processDelete=function(e){var i=e.target;if(i&&t.closest(i,".e-pivot-button"))return i.querySelector(".e-remove").click(),void e.preventDefault()},e.prototype.destroy=function(){this.keyboardModule&&this.keyboardModule.destroy()},e}(),Y=function(){function e(e){this.parent=e}return e.prototype.updateSorting=function(e){this.parent.filterDialog.dialogPopUp&&this.parent.filterDialog.dialogPopUp.close();var i=e.target,r=i.parentElement.id,a=i.classList.contains("e-descend"),n=this.getSortItemByName(r);if(t.isNullOrUndefined(n)){var o={name:r,order:a?"Ascending":"Descending"};this.parent.dataSource.sortSettings.push(o)}else(n=n.properties?n.properties:n).order=a?"Ascending":"Descending";a?t.removeClass([i],"e-descend"):t.addClass([i],"e-descend")},e.prototype.updateFiltering=function(e){var r=e.target,a=r.parentElement.id,n=r.parentElement.textContent,o=!1,l=[];this.parent.engineModule.fieldList[a].dateMember=new i.DataManager(this.parent.engineModule.fieldList[a].dateMember).executeLocal((new i.Query).sortBy("actualText",this.parent.engineModule.fieldList[a].sort.toLowerCase()));var s=this.getFilterItemByName(a);t.isNullOrUndefined(s)||(o="Include"===s.type,l=s.items);var d=this.getTreeData(o,this.parent.engineModule.fieldList[a].dateMember,l);this.parent.filterDialog.dialogPopUp&&this.parent.filterDialog.dialogPopUp.close();var p;p=p="pivotfieldlist"!==this.parent.moduleName?this.parent.element:document.getElementById(this.parent.parentID+"_Wrapper"),this.parent.filterDialog.createFilterDialog(d,a,n,p)},e.prototype.getSortItemByName=function(e){var t=this.parent.dataSource.sortSettings;return new i.DataManager({json:t}).executeLocal((new i.Query).where("name","equal",e))[0]},e.prototype.getFilterItemByName=function(e){var t=this.parent.dataSource.filterSettings;return new i.DataManager({json:t}).executeLocal((new i.Query).where("name","equal",e))[0]},e.prototype.getFormatItemByName=function(e){var t=this.parent.dataSource.formatSettings;return new i.DataManager({json:t}).executeLocal((new i.Query).where("name","equal",e))[0]},e.prototype.searchTreeNodes=function(e,t){for(var i=[],r=[],a=0,n=[].slice.call(t.element.querySelectorAll("li"));a<n.length;a++){var o=n[a];o.querySelector(".e-list-text").textContent.toLowerCase().indexOf(e.value.toLowerCase())>-1?i.push(o):r.push(o)}t.enableNodes(i),t.disableNodes(r)},e.prototype.getTreeData=function(e,t,i){for(var r=[],a=0,n=t;a<n.length;a++){var o=n[a],l={id:o.formattedText,name:o.formattedText,checkedStatus:!e};i&&i.indexOf(o.formattedText)>=0&&(l.checkedStatus=!!e),r.push(l)}return r},e}(),K=function(){function e(e){this.parent=e}return e.prototype.onStateModified=function(e,i){var r="",a=!0,n=t.closest(e.target,".e-droppable"),o=-1;if(this.parent.dataSourceUpdate.btnElement=e.element?e.element.parentElement:void 0,n&&(r="e-rows"===n.classList[1]?"rows":"e-columns"===n.classList[1]?"columns":"e-values"===n.classList[1]?"values":"e-filters"===n.classList[1]?"filters":""),e.cancel&&""===r||this.parent.dataSourceUpdate.btnElement&&"true"===this.parent.dataSourceUpdate.btnElement.getAttribute("isValue")&&("filters"===r||"values"===r||r.indexOf(this.parent.dataSource.valueAxis)>-1))return a=!1;if(""!==r){if(this.parent.engineModule.fieldList[i]&&"CalculatedField"===this.parent.engineModule.fieldList[i].aggregateType&&"values"!==r){var l=this.parent.localeObj.getConstant("warning"),s=this.parent.localeObj.getConstant("dropAction");return this.parent.errorDialog.createErrorDialog(l,s),a=!1}o=this.getButtonPosition(e.target,r)}return this.parent.dataSourceUpdate.updateDataSource(i,r,o),a},e.prototype.getButtonPosition=function(e,i){var r=-1,a=t.closest(e,".e-pvt-btn-div");if(!t.isNullOrUndefined(a)){a=a.querySelector(".e-pivot-button");for(var n=this.parent.element.querySelector(".e-"+i),o=[].slice.call(n.querySelectorAll(".e-pivot-button")),l=0,s=o.length;l<s;l++)if(o[l].id===a.id){r=l;break}}return r},e}(),X=function(){function e(e){this.parent=e}return e.prototype.updateDataSource=function(e,t,i){var r;if(this.control&&this.btnElement&&"true"===this.btnElement.getAttribute("isvalue"))switch(t){case"":this.control.setProperties({dataSource:{values:[]}},!0);break;case"rows":this.control.setProperties({dataSource:{valueAxis:"row"}},!0);break;case"columns":this.control.setProperties({dataSource:{valueAxis:"column"}},!0)}else"CalculatedField"===(r=(r=this.removeFieldFromReport(e.toString()))||this.getNewField(e.toString())).type&&""!==t&&(t="values");if(r)switch(t){case"filters":-1!==i?this.parent.dataSource.filters.splice(i,0,r):this.parent.dataSource.filters.push(r);break;case"rows":-1!==i?this.parent.dataSource.rows.splice(i,0,r):this.parent.dataSource.rows.push(r);break;case"columns":-1!==i?this.parent.dataSource.columns.splice(i,0,r):this.parent.dataSource.columns.push(r);break;case"values":-1!==i?this.parent.dataSource.values.splice(i,0,r):this.parent.dataSource.values.push(r)}},e.prototype.removeFieldFromReport=function(e){for(var t,i=!1,r=[this.parent.dataSource.rows,this.parent.dataSource.columns,this.parent.dataSource.values,this.parent.dataSource.filters],a=0,n=r.length;a<n;a++)if(!i&&r[a])for(var o=0,l=r[a].length;o<l;o++)if(r[a][o].name===e){t=r[a][o],r[a].splice(o,1),i=!0;break}return t},e.prototype.getNewField=function(e){var t=this.parent.engineModule.fieldList[e];return{name:e,caption:t.caption,type:t.aggregateType,showNoDataItems:t.showNoDataItems}},e}(),Z=function(){function e(e){this.parent=e}return e.prototype.createErrorDialog=function(e,i){var a=t.createElement("div",{id:this.parent.parentID+"_ErrorDialog",className:"e-pivot-error-dialog"});this.parent.element.appendChild(a),this.errorPopUp=new r.Dialog({animationSettings:{effect:"Fade"},allowDragging:!1,header:e,content:i,isModal:!0,visible:!0,showCloseIcon:!0,enableRtl:this.parent.enableRtl,width:"auto",height:"auto",position:{X:"center",Y:"center"},buttons:[{click:this.closeErrorDialog.bind(this),buttonModel:{cssClass:"e-ok-btn",content:this.parent.localeObj.getConstant("ok"),isPrimary:!0}}],closeOnEscape:!0,target:document.body,close:this.removeErrorDialog.bind(this)}),this.errorPopUp.appendTo(a)},e.prototype.closeErrorDialog=function(){this.errorPopUp.hide()},e.prototype.removeErrorDialog=function(){t.remove(document.getElementById(this.parent.parentID+"_ErrorDialog").parentElement)},e}(),$=function(){function e(e){this.parent=e}return e.prototype.createFilterDialog=function(e,i,a,n){var o=t.createElement("div",{id:this.parent.parentID+"_EditorTreeView",className:"e-member-editor-dialog",attrs:{"data-fieldName":i,"aria-label":a},styles:"visibility:hidden;"}),l=this.parent.localeObj.getConstant("filter")+' "'+a+'" '+this.parent.localeObj.getConstant("by");this.filterObject=this.getFilterObject(i),this.allowExcelLikeFilter=this.isExcelFilter(i),this.parent.element.appendChild(o),this.dialogPopUp=new r.Dialog({animationSettings:{effect:this.allowExcelLikeFilter?"None":"Fade"},allowDragging:!1,header:this.allowExcelLikeFilter?l:a,content:this.allowExcelLikeFilter?"":this.createTreeView(e,a,i),isModal:"Popup"===this.parent.renderMode||!!this.parent.isAdaptive,visible:!0,showCloseIcon:!!this.allowExcelLikeFilter,enableRtl:this.parent.enableRtl,width:"auto",height:this.allowExcelLikeFilter?"400px":"350px",position:{X:"center",Y:"center"},buttons:[{buttonModel:{cssClass:"e-ok-btn",content:this.parent.localeObj.getConstant("ok"),isPrimary:!0}},{buttonModel:{cssClass:"e-clear-filter-button"+(this.allowExcelLikeFilter?"":" e-disable"),iconCss:"e-icons e-clear-filter-icon",enableRtl:this.parent.enableRtl,content:this.parent.localeObj.getConstant("clearFilter"),disabled:!this.filterObject}},{click:this.closeFilterDialog.bind(this),buttonModel:{cssClass:"e-cancel-btn",content:this.parent.localeObj.getConstant("cancel")}}],closeOnEscape:!0,target:n,close:this.removeFilterDialog.bind(this)}),this.dialogPopUp.appendTo(o),this.allowExcelLikeFilter?(this.createTabMenu(e,a,i),t.addClass([this.dialogPopUp.element],"e-excel-filter"),this.updateCheckedState(a)):this.updateCheckedState(a),t.setStyleAttribute(this.dialogPopUp.element,{visibility:"visible"}),this.allowExcelLikeFilter&&this.dialogPopUp.element.querySelector(".e-dlg-closeicon-btn").focus()},e.prototype.createTreeView=function(e,i,r){var a=this,n=t.createElement("div",{id:this.parent.parentID+"EditorDiv",className:"e-member-editor-wrapper"+(this.allowExcelLikeFilter?" e-excelfilter":"")}),o=t.createElement("div",{id:this.parent.parentID+"_SearchDiv",attrs:{tabindex:"-1"},className:"e-editor-search-wrapper"}),d=t.createElement("input",{attrs:{type:"text"}});o.appendChild(d);var p=t.createElement("div",{id:this.parent.parentID+"_AllDiv",attrs:{tabindex:"-1"},className:"e-select-all-wrapper"}),h=t.createElement("div",{className:"e-select-all"}),c=t.createElement("div",{className:"e-member-editor-container"}),u=t.createElement("div",{className:"e-member-prompt e-disable",innerHTML:this.parent.localeObj.getConstant("noMatches")});p.appendChild(h),n.appendChild(o),n.appendChild(p),n.appendChild(u),this.editorSearch=new s.MaskedTextBox({placeholder:this.parent.localeObj.getConstant("search")+' "'+i+'"',enableRtl:this.parent.enableRtl,cssClass:"e-editor-search",change:function(e){a.parent.eventBase.searchTreeNodes(e,a.memberTreeView);var r=a.dialogPopUp.element,n=[].slice.call(a.memberTreeView.element.querySelectorAll("li")),o=[].slice.call(a.memberTreeView.element.querySelectorAll(".e-disable"));n.length===o.length?(a.allMemberSelect.disableNodes([a.allMemberSelect.element.querySelector("li")]),r.querySelector(".e-ok-btn").setAttribute("disabled","disabled"),t.removeClass([u],"e-disable")):(a.allMemberSelect.enableNodes([a.allMemberSelect.element.querySelector("li")]),r.querySelector(".e-ok-btn").removeAttribute("disabled"),t.addClass([u],"e-disable")),a.updateCheckedState(i)}}),this.editorSearch.appendTo(d);var m=[{id:"all",name:"All",checkedStatus:!0}];return this.allMemberSelect=new l.TreeView({fields:{dataSource:m,id:"id",text:"name",isChecked:"checkedStatus"},showCheckBox:!0,enableRtl:this.parent.enableRtl}),this.allMemberSelect.appendTo(h),n.appendChild(c),this.memberTreeView=new l.TreeView({fields:{dataSource:e,id:"id",text:"name",isChecked:"checkedStatus"},showCheckBox:!0,enableRtl:this.parent.enableRtl,nodeChecking:this.validateTreeNode.bind(this)}),this.memberTreeView.appendTo(c),n},e.prototype.createTabMenu=function(e,i,r){var a=t.createElement("div",{className:"e-filter-tab-wrapper"});this.dialogPopUp.content=a,this.dialogPopUp.dataBind();for(var n=["Label","Value","Include","Exclude"],o="((-|\\+)?[0-9]+(\\.[0-9]+)?)+",s=Object.keys(this.parent.engineModule.fieldList[r].members)[0],d=this.parent.eventBase.getFormatItemByName(r),p=[{header:{text:this.parent.localeObj.getConstant("member"),iconCss:this.filterObject&&n.indexOf(this.filterObject.type)>1?"e-selected-option-icon":""},content:this.createTreeView(e,i,r)}],h=0,c=n;h<c.length;h++){var u=c[h];if("Label"===u&&this.parent.dataSource.allowLabelFilter||"Value"===u&&this.parent.dataSource.allowValueFilter){var m="Label"===u&&s.match(o)&&s.match(o)[0].length===s.length?"Number":"Label"===u&&"Invalid Date"!==new Date(s).toString()&&(d&&d.type||this.filterObject&&"Date"===this.filterObject.type)?"Date":u,g={header:{text:"Number"===m?this.parent.localeObj.getConstant("label"):this.parent.localeObj.getConstant(m.toLowerCase()),iconCss:this.filterObject&&this.filterObject.type===m?"e-selected-option-icon":""},content:this.createCustomFilter(r,this.filterObject&&this.filterObject.type===m?this.filterObject:void 0,m.toLowerCase())};p.push(g)}}var v=this.filterObject?["Label","Date","Number"].indexOf(this.filterObject.type)>=0?1:"Value"===this.filterObject.type?this.parent.dataSource.allowLabelFilter&&this.parent.dataSource.allowValueFilter?2:1:0:0;this.tabObj=new l.Tab({heightAdjustMode:"Auto",items:p,height:"100%",selectedItem:v,enableRtl:this.parent.enableRtl}),this.tabObj.appendTo(a),v>0&&t.addClass([this.dialogPopUp.element.querySelector(".e-filter-div-content."+(1===v&&this.parent.dataSource.allowLabelFilter?"e-label-filter":"e-value-filter"))],"e-selected-tab")},e.prototype.createCustomFilter=function(e,i,r){for(var a=[],n=[],o=this.parent.dataSource.values,l="DoesNotEquals",s=0,d={label:["Equals","DoesNotEquals","BeginWith","DoesNotBeginWith","EndsWith","DoesNotEndsWith","Contains","DoesNotContains","GreaterThan","GreaterThanOrEqualTo","LessThan","LessThanOrEqualTo","Between","NotBetween"],date:["Equals","DoesNotEquals","Before","BeforeOrEqualTo","After","AfterOrEqualTo","Between","NotBetween"],value:["Equals","DoesNotEquals","GreaterThan","GreaterThanOrEqualTo","LessThan","LessThanOrEqualTo","Between","NotBetween"]},p=["Between","NotBetween"],h="label"===r?d.label:"date"===r?d.date:d.value,c=0,u=h;c<u.length;c++){var m=u[c];l=i&&m===i.condition?h.indexOf(i.condition)>=0?i.condition:h[0]:l,a.push({value:m,text:this.parent.localeObj.getConstant(m)})}for(var g=o.length;g--;)n.unshift({value:o[g].name,text:o[g].caption?o[g].caption:o[g].name}),s=i&&"Value"===i.type&&i.measure===o[g].name&&i.condition===l?g:s;var v=t.createElement("div",{className:"e-filter-div-content e-"+(["date","number"].indexOf(r)>=0?"label":r)+"-filter",id:this.parent.parentID+"_"+r+"_filter_div_content",attrs:{"data-type":r,"data-fieldName":e,"data-operator":l,"data-measure":this.parent.dataSource.values.length>0?this.parent.dataSource.values[s].name:"","data-value1":i&&l===i.condition?i.value1.toString():"","data-value2":i&&l===i.condition?i.value1.toString():""}}),f=t.createElement("div",{className:"e-filter-text-div",innerHTML:this.parent.localeObj.getConstant(r+"TextContent")}),y=t.createElement("div",{className:"e-between-text-div "+(-1===p.indexOf(l)?"e-disable":""),innerHTML:this.parent.localeObj.getConstant("And")}),b=t.createElement("div",{className:"e-separator-div"}),S=t.createElement("div",{className:"e-filter-option-wrapper-1"}),C=t.createElement("div",{className:"e-measure-option-wrapper "+(["label","date","number"].indexOf(r)>=0?"e-disable":"")}),x=t.createElement("div",{className:"e-condition-option-wrapper"}),w=t.createElement("div",{className:"e-filter-option-wrapper-2"}),E=t.createElement("div",{id:this.parent.parentID+"_"+r+"_measure_option_wrapper"}),D=t.createElement("div",{id:this.parent.parentID+"_"+r+"_contition_option_wrapper"}),M=t.createElement("div",{className:"e-filter-input-div-1"}),T=t.createElement("div",{className:"e-filter-input-div-2 "+(-1===p.indexOf(l)?"e-disable":"")}),F=t.createElement("input",{id:this.parent.parentID+"_"+r+"_input_option_1",attrs:{type:"text"}}),L=t.createElement("input",{id:this.parent.parentID+"_"+r+"_input_option_2",attrs:{type:"text"}});return M.appendChild(F),T.appendChild(L),C.appendChild(E),C.appendChild(b),x.appendChild(D),S.appendChild(C),S.appendChild(x),w.appendChild(M),w.appendChild(y),w.appendChild(T),this.createElements(i,p,E,D,F,L,n,a,s,l,r),v.appendChild(f),v.appendChild(S),v.appendChild(w),v},e.prototype.createElements=function(e,i,r,n,o,l,h,c,u,m,g){var v=this;if(new d.DropDownList({dataSource:h,enableRtl:this.parent.enableRtl,fields:{value:"value",text:"text"},index:u,cssClass:"e-value-options",width:"100%",change:function(e){var t=v.dialogPopUp.element.querySelector(".e-selected-tab");v.updateInputValues(t,g,o,l),a.setStyleAndAttributes(t,{"data-measure":e.value})}}).appendTo(r),new d.DropDownList({dataSource:c,enableRtl:this.parent.enableRtl,fields:{value:"value",text:"text"},value:m,cssClass:"e-filter-operator",width:"100%",change:function(e){var r=v.dialogPopUp.element.querySelector(".e-selected-tab");v.updateInputValues(r,g,o,l);for(var n=0,s=["e-between-text-div","e-filter-input-div-2"];n<s.length;n++){var d=s[n];i.indexOf(e.value)>=0?t.removeClass([r.querySelector("."+d)],"e-disable"):t.addClass([r.querySelector("."+d)],"e-disable")}a.setStyleAndAttributes(r,{"data-operator":e.value})}}).appendTo(n),"date"===g){var f=new p.DatePicker({placeholder:this.parent.localeObj.getConstant("chooseDate"),enableRtl:this.parent.enableRtl,format:"dd/MM/yyyy",value:e&&m===e.condition?e.value1:null,change:function(e){var t=v.dialogPopUp.element.querySelector(".e-selected-tab");a.setStyleAndAttributes(t,{"data-value1":e.value,"data-value2":y.value})},width:"100%"}),y=new p.DatePicker({placeholder:this.parent.localeObj.getConstant("chooseDate"),enableRtl:this.parent.enableRtl,format:"dd/MM/yyyy",value:e&&m===e.condition?e.value2:null,change:function(e){var t=v.dialogPopUp.element.querySelector(".e-selected-tab");a.setStyleAndAttributes(t,{"data-value1":f.value,"data-value2":e.value})},width:"100%"});f.appendTo(o),y.appendTo(l)}else{var b=new s.MaskedTextBox({placeholder:this.parent.localeObj.getConstant("enterValue"),enableRtl:this.parent.enableRtl,value:e&&m===e.condition?e.value1:"",change:function(e){var t=v.dialogPopUp.element.querySelector(".e-selected-tab");a.setStyleAndAttributes(t,{"data-value1":e.value,"data-value2":S.value})},width:"100%"}),S=new s.MaskedTextBox({placeholder:this.parent.localeObj.getConstant("enterValue"),enableRtl:this.parent.enableRtl,value:e&&m===e.condition?e.value2:"",change:function(e){var t=v.dialogPopUp.element.querySelector(".e-selected-tab");a.setStyleAndAttributes(t,{"data-value1":b.value,"data-value2":e.value})},width:"100%"});b.appendTo(o),S.appendTo(l)}},e.prototype.updateInputValues=function(e,i,r,n){var o,l;if("date"===i){var s=r.ej2_instances[0],d=n.ej2_instances[0];o=t.isNullOrUndefined(s.value)?"":s.value.toString(),l=t.isNullOrUndefined(d.value)?"":d.value.toString()}else{var s=r.ej2_instances[0],d=n.ej2_instances[0];o=s.value,l=d.value}a.setStyleAndAttributes(e,{"data-value1":o,"data-value2":l})},e.prototype.validateTreeNode=function(e){e.node.classList.contains("e-disable")&&(e.cancel=!0)},e.prototype.updateCheckedState=function(e){var i=this.dialogPopUp.element;a.setStyleAndAttributes(i,{role:"menu","aria-haspopup":"true"});var r=[].slice.call(this.memberTreeView.element.querySelectorAll("li")),n=r.filter(function(e){return!e.classList.contains("e-disable")}),o=this.getUnCheckedNodes(n),l=this.getCheckedNodes(n),s=this.allMemberSelect.element.querySelector("li").querySelector("span.e-frame");l.length>0?(o.length>0?(t.removeClass([s],"e-check"),t.addClass([s],"e-stop")):0===o.length&&(t.removeClass([s],"e-stop"),t.addClass([s],"e-check")),i.querySelector(".e-ok-btn").removeAttribute("disabled")):o.length>0&&0===l.length&&(t.removeClass([s],["e-check","e-stop"]),this.getCheckedNodes(r).length===l.length&&i.querySelector(".e-ok-btn").setAttribute("disabled","disabled"))},e.prototype.getCheckedNodes=function(e){return e.filter(function(e){return e.querySelector(".e-frame").classList.contains("e-check")})},e.prototype.getUnCheckedNodes=function(e){return e.filter(function(e){return!e.querySelector(".e-frame").classList.contains("e-check")})},e.prototype.isExcelFilter=function(e){for(var t=!1,i=0,r=this.parent.dataSource.filters;i<r.length;i++)if(r[i].name===e){t=!0;break}return!(t||!this.parent.dataSource.allowLabelFilter&&!this.parent.dataSource.allowValueFilter)},e.prototype.getFilterObject=function(e){var t=this.parent.eventBase.getFilterItemByName(e);if(t&&(["Label","Date","Number"].indexOf(t.type)>=0&&this.parent.dataSource.allowLabelFilter||"Value"===t.type&&this.parent.dataSource.allowValueFilter||["Include","Exclude"].indexOf(t.type)>=0))return t},e.prototype.closeFilterDialog=function(){this.allowExcelLikeFilter&&this.tabObj&&!this.tabObj.isDestroyed&&this.tabObj.destroy(),this.dialogPopUp.hide()},e.prototype.removeFilterDialog=function(){this.dialogPopUp&&!this.dialogPopUp.isDestroyed&&this.dialogPopUp.destroy(),document.getElementById(this.parent.parentID+"_EditorTreeView")&&t.remove(document.getElementById(this.parent.parentID+"_EditorTreeView"))},e}(),J=function(){function e(e){return this.element=e.element,this.moduleName=e.moduleName,this.dataSource=e.dataSource,this.engineModule=e.pivotEngine,this.enableRtl=e.enableRtl,this.isAdaptive=e.isAdaptive,this.renderMode=e.renderMode,this.parentID=e.id,this.localeObj=e.localeObj,this.nodeStateModified=new K(this),this.dataSourceUpdate=new X(this),this.eventBase=new Y(this),this.filterDialog=new $(this),this.errorDialog=new Z(this),this.keyboardModule=new Q(this),this}return e.prototype.destroy=function(){this.keyboardModule&&this.keyboardModule.destroy()},e}(),ee=function(){function e(e){this.parent=e}return e.prototype.render=function(){var e=t.createElement("div",{id:this.parent.element.id+"_Wrapper",className:"e-pivotfieldlist-wrapper",styles:"width:"+this.parent.element.style.width});this.parent.isAdaptive?t.addClass([e],y):t.removeClass([e],y),this.parent.enableRtl?t.addClass([e],f):t.removeClass([e],f),this.parent.cssClass&&t.addClass([e],this.parent.cssClass),this.parentElement=t.createElement("div",{className:"e-field-list-container"}),this.parent.element.appendChild(e),this.parent.isAdaptive&&(e.removeAttribute("style"),this.parentElement=t.createElement("div",{className:"e-adaptive-container"}),this.renderAdaptiveLayout(e)),"Popup"===this.parent.renderMode?(this.renderFieldListDialog(e),this.unWireDialogEvent(this.parent.element.querySelector(".e-toggle-field-list")),this.wireDialogEvent(this.parent.element.querySelector(".e-toggle-field-list"))):this.renderStaticLayout(e)},e.prototype.renderStaticLayout=function(e){if(!this.parent.isAdaptive){var i=t.createElement("div",{className:"e-field-list-title"}),r=t.createElement("div",{className:"e-title-content",innerHTML:this.parent.localeObj.getConstant("staticFieldList")});i.appendChild(r),i.appendChild(this.createCalculatedButton()),t.addClass([e],"e-static"),e.appendChild(i),e.appendChild(this.parentElement)}},e.prototype.renderFieldListDialog=function(e){var i=t.createElement("div",{className:"e-toggle-field-list e-icons e-select-table",attrs:{tabindex:"0",title:this.parent.localeObj.getConstant("fieldList"),"aria-disabled":"false","aria-label":this.parent.localeObj.getConstant("fieldList")}});if(this.parent.element.appendChild(i),this.parent.isAdaptive){this.fieldListDialog=new r.Dialog({animationSettings:{effect:"Zoom"},content:this.parentElement,isModal:!0,showCloseIcon:!1,visible:!1,allowDragging:!1,closeOnEscape:!1,enableRtl:this.parent.enableRtl,width:"100%",height:"100%",position:{X:"center",Y:"center"},buttons:[{click:this.showFieldListDialog.bind(this),buttonModel:{cssClass:"e-field-list-btn e-small e-round",iconCss:b+" e-add-icon",isPrimary:!0}},{click:this.showCalculatedField.bind(this),buttonModel:{cssClass:"e-calculated-field-btn e-small e-round e-disable",iconCss:b+" e-add-icon",isPrimary:!0}},{click:this.onCloseFieldList.bind(this),buttonModel:{content:this.parent.localeObj.getConstant("close"),cssClass:"e-cancel-btn"}}],target:document.body,close:this.removeFieldListIcon.bind(this)}),this.fieldListDialog.appendTo(e),t.setStyleAttribute(e.querySelector("#"+e.id+"_dialog-content"),{padding:"0"});var a=e.querySelector(".e-footer-content");t.addClass([a],"e-field-list-footer"),t.removeClass([a.querySelector(".e-calculated-field-btn")],"e-flat"),t.removeClass([a.querySelector(".e-field-list-btn")],"e-flat")}else{var n="<div class=e-title-header><div class=e-title-content>"+this.parent.localeObj.getConstant("fieldList")+"</div></div>";this.fieldListDialog=new r.Dialog({animationSettings:{effect:"Zoom"},header:n,content:this.parentElement,isModal:!1,showCloseIcon:!1,visible:!1,allowDragging:!0,enableRtl:this.parent.enableRtl,width:this.parent.element.style.width,position:{X:"center",Y:this.parent.element.offsetTop},buttons:[{click:this.onCloseFieldList.bind(this),buttonModel:{content:this.parent.localeObj.getConstant("close"),cssClass:"e-cancel-btn",isPrimary:!0}}],closeOnEscape:!0,target:t.isNullOrUndefined(this.parent.target)?document.body:"string"==typeof this.parent.target?document.querySelector(this.parent.target):this.parent.target,close:this.removeFieldListIcon.bind(this)}),this.fieldListDialog.appendTo(e),t.setStyleAttribute(e.querySelector("#"+e.id+"_title"),{width:"100%"}),e.querySelector(".e-title-header").appendChild(this.createCalculatedButton())}},e.prototype.updateDataSource=function(e){for(var t=["filters","columns","rows","values"],i=0,r=e;i<r.length;i++){var a=r[i],n=t[this.adaptiveElement.selectedItem];this.parent.pivotCommon.dataSourceUpdate.updateDataSource(a,n,-1)}this.parent.axisFieldModule.render(),this.parent.updateDataSource(!0)},e.prototype.renderAdaptiveLayout=function(e){var i=this,r=t.createElement("div",{className:"e-field-list-footer"});e.appendChild(this.parentElement);var a=[{header:{text:this.parent.localeObj.getConstant("filters")},content:this.createAxisTable("filters")},{header:{text:this.parent.localeObj.getConstant("columns")},content:this.createAxisTable("columns")},{header:{text:this.parent.localeObj.getConstant("rows")},content:this.createAxisTable("rows")},{header:{text:this.parent.localeObj.getConstant("values")},content:this.createAxisTable("values")},{header:{text:this.parent.localeObj.getConstant("createCalculatedField")},content:"Calculated Field Related UI"}];this.parent.allowCalculatedField||a.pop(),this.adaptiveElement=new l.Tab({heightAdjustMode:"Auto",items:a,height:"100%",enableRtl:this.parent.enableRtl,selected:function(r){e.querySelector(".e-field-list-btn")&&(4!==r.selectedIndex?(t.addClass([e.querySelector(".e-calculated-field-btn")],"e-disable"),t.removeClass([e.querySelector(".e-field-list-btn")],"e-disable")):(t.removeClass([e.querySelector(".e-calculated-field-btn")],"e-disable"),t.addClass([e.querySelector(".e-field-list-btn")],"e-disable"))),4===r.selectedIndex?(i.adaptiveElement.items[4].content="",i.adaptiveElement.dataBind(),i.parent.notify("init-calculatedfield",{})):i.parent.axisFieldModule.render()}}),"Fixed"===this.parent.renderMode?(r.appendChild(this.createAddButton()),t.addClass([e],"e-static"),this.adaptiveElement.appendTo(this.parentElement),this.parentElement.appendChild(r)):this.adaptiveElement.appendTo(this.parentElement)},e.prototype.createCalculatedButton=function(){var e=t.createElement("div",{id:this.parent.element.id+"_CalculatedField"}),i=new h.Button({cssClass:"e-calculated-field e-disable",content:this.parent.localeObj.getConstant("calculatedField"),enableRtl:this.parent.enableRtl});return i.appendTo(e),this.parent.calculatedFieldModule&&t.removeClass([e],"e-disable"),i.element.onclick=this.showCalculatedField.bind(this),e},e.prototype.createAddButton=function(){var e=t.createElement("div",{className:"e-field-list-footer-content"}),i=t.createElement("div",{}),r=t.createElement("div",{}),a=new h.Button({cssClass:"e-calculated-field-btn e-small e-round e-disable",iconCss:b+" e-add-icon",enableRtl:this.parent.enableRtl}),n=new h.Button({cssClass:"e-field-list-btn e-small e-round",iconCss:b+" e-add-icon",enableRtl:this.parent.enableRtl});return n.appendTo(i),a.appendTo(r),e.appendChild(i),e.appendChild(r),a.element.onclick=this.showCalculatedField.bind(this),n.element.onclick=this.showFieldListDialog.bind(this),e},e.prototype.createAxisTable=function(e){var i=t.createElement("div",{className:"e-field-list-"+e}),r=t.createElement("div",{className:"e-axis-content e-"+e}),a=t.createElement("span",{className:"e-draggable-prompt",innerHTML:this.parent.localeObj.getConstant("addPrompt")});return i.appendChild(r),i.appendChild(a),i},e.prototype.showCalculatedField=function(e){this.parent.isAdaptive||this.parent.dialogRenderer.fieldListDialog&&(this.parent.dialogRenderer.fieldListDialog.hide(),t.addClass([this.parent.element.querySelector(".e-toggle-field-list")],"e-hide")),this.parent.notify("init-calculatedfield",{})},e.prototype.showFieldListDialog=function(e){var t=this.adaptiveElement.selectedItem;this.parent.treeViewModule.render(t)},e.prototype.onShowFieldList=function(){t.addClass([this.parent.element.querySelector(".e-toggle-field-list")],"e-hide"),this.parent.dialogRenderer.fieldListDialog.show(),this.parent.dialogRenderer.fieldListDialog.element.style.top=parseInt(this.parent.dialogRenderer.fieldListDialog.element.style.top,10)<0?"0px":this.parent.dialogRenderer.fieldListDialog.element.style.top},e.prototype.onCloseFieldList=function(){this.parent.dialogRenderer.fieldListDialog.hide()},e.prototype.removeFieldListIcon=function(){document.getElementById(this.parent.element.id+"calculateddialog")||t.removeClass([this.parent.element.querySelector(".e-toggle-field-list")],"e-hide")},e.prototype.keyPress=function(e){e.target;if(13===e.keyCode&&e.target)return e.target.click(),void e.preventDefault()},e.prototype.wireDialogEvent=function(e){t.EventHandler.add(e,"keydown",this.keyPress,this),t.EventHandler.add(e,"click",this.onShowFieldList,this)},e.prototype.unWireDialogEvent=function(e){t.EventHandler.remove(e,"keydown",this.keyPress),t.EventHandler.remove(e,"click",this.onShowFieldList)},e}(),te=function(){function e(e){this.selectedNodes=[],this.parent=e,this.addEventListener()}return e.prototype.render=function(e){if(this.parentElement=this.parent.dialogRenderer.parentElement,this.parent.isAdaptive)this.renderTreeDialog(e);else{var i=t.createElement("div",{className:"e-field-table"}),r=t.createElement("div",{className:"e-field-header",innerHTML:this.parent.localeObj.getConstant("allFields")});if(this.treeViewElement=t.createElement("div",{id:this.parent.element.id+"_TreeView",className:"e-field-list"}),i.appendChild(r),i.appendChild(this.treeViewElement),this.parentElement.appendChild(i),"Fixed"===this.parent.renderMode){var a=t.createElement("div",{className:"e-center-div"}),n=t.createElement("div",{className:"e-center-title",innerHTML:this.parent.localeObj.getConstant("centerHeader")});this.parentElement.appendChild(a),this.parentElement.appendChild(n)}this.renderTreeView()}},e.prototype.renderTreeView=function(){this.fieldTable=new l.TreeView({fields:{dataSource:this.getTreeData(),id:"id",text:"caption",isChecked:"isSelected"},nodeChecked:this.nodeStateChange.bind(this),cssClass:"e-field-list-tree",showCheckBox:!0,allowDragAndDrop:!0,sortOrder:"Ascending",enableRtl:this.parent.enableRtl,nodeDragStart:this.dragStart.bind(this),nodeDragStop:this.dragStop.bind(this)}),this.treeViewElement.innerHTML="",this.fieldTable.appendTo(this.treeViewElement),this.getTreeUpdate()},e.prototype.renderTreeDialog=function(e){var i=this,a=t.createElement("div",{id:this.parent.element.id+"_FieldListTreeView",className:"e-adaptive-field-list-dialog"});this.parentElement.appendChild(a),this.fieldDialog=new r.Dialog({animationSettings:{effect:"Fade"},allowDragging:!1,header:this.parent.localeObj.getConstant("adaptiveFieldHeader"),content:this.createTreeView(this.getTreeData(e)),isModal:!0,visible:!0,showCloseIcon:!1,enableRtl:this.parent.enableRtl,width:"auto",height:"350px",position:{X:"center",Y:"center"},buttons:[{click:this.closeTreeDialog.bind(this),buttonModel:{cssClass:"e-cancel-btn",content:this.parent.localeObj.getConstant("cancel")}},{click:this.onFieldAdd.bind(this),buttonModel:{cssClass:"e-ok-btn",content:this.parent.localeObj.getConstant("add"),isPrimary:!0}}],closeOnEscape:!0,target:this.parentElement.parentElement,close:function(){document.getElementById(i.parent.element.id+"_FieldListTreeView")&&t.remove(document.getElementById(i.parent.element.id+"_FieldListTreeView"))}}),this.fieldDialog.appendTo(a)},e.prototype.createTreeView=function(e){var i=this,r=t.createElement("div",{id:this.parent.element.id+"EditorDiv",className:"e-member-editor-wrapper"}),a=t.createElement("div",{id:this.parent.element.id+"_SearchDiv",attrs:{tabindex:"-1"},className:"e-editor-search-wrapper"}),n=t.createElement("input",{attrs:{type:"text"}});a.appendChild(n);var o=t.createElement("div",{className:"e-member-editor-container"});return r.appendChild(a),this.editorSearch=new s.MaskedTextBox({placeholder:this.parent.localeObj.getConstant("search"),enableRtl:this.parent.enableRtl,cssClass:"e-editor-search",change:function(e){i.parent.pivotCommon.eventBase.searchTreeNodes(e,i.fieldTable)}}),this.editorSearch.appendTo(n),r.appendChild(o),this.fieldTable=new l.TreeView({fields:{dataSource:e,id:"id",text:"caption",isChecked:"isSelected"},showCheckBox:!0,sortOrder:"Ascending",enableRtl:this.parent.enableRtl,nodeChecked:this.addNode.bind(this)}),this.fieldTable.appendTo(o),r},e.prototype.dragStart=function(e){if(e.event.target.classList.contains("e-drag")){this.parent.isDragging=!0,t.addClass([e.draggedNode.querySelector(".e-list-text")],"e-list-selected");var i=this.parent.engineModule.fieldList[e.draggedNode.getAttribute("data-uid")],r=["e-rows","e-columns","e-filters"];if(i&&"CalculatedField"===i.aggregateType)for(var a=0,n=r;a<n.length;a++){var o=n[a];t.addClass([this.parentElement.querySelector("."+o)],"e-drag-restrict")}}else e.cancel=!0},e.prototype.dragStop=function(e){e.cancel=!0,this.parent.isDragging=!1;for(var i=0,r=["e-rows","e-columns","e-filters"];i<r.length;i++){var a=r[i];t.removeClass([this.parentElement.querySelector("."+a)],"e-drag-restrict")}t.removeClass([e.draggedNode.querySelector(".e-list-text")],"e-list-selected"),this.parent.pivotCommon.filterDialog.dialogPopUp&&this.parent.pivotCommon.filterDialog.dialogPopUp.close();var n=e.draggedNodeData.id.toString();this.isNodeDropped(e,n)&&this.parent.pivotCommon.nodeStateModified.onStateModified(e,n)&&(this.parent.updateDataSource(),this.parent.axisFieldModule.render())},e.prototype.isNodeDropped=function(e,i){var r=!0;if("true"===e.draggedNodeData.isChecked){var a=this.getButton(i),n=t.closest(a,".e-droppable"),o=t.closest(e.target,".e-droppable");if(a&&n===o){for(var l=[].slice.call(n.querySelectorAll(".e-pivot-button")),s=t.closest(e.target,".e-pvt-btn-div"),d=void 0,p=-1,h=0,c=l.length;h<c;h++)if(l[h].id===a.id&&(d=h),s){var u=s.querySelector(".e-pivot-button");l[h].id===u.id&&(p=h)}if(d===p||d===l.length-1&&-1===p){var m=document.getElementById(this.parent.element.id+"_Wrapper");t.removeClass([].slice.call(m.querySelectorAll(".e-drop-indicator")),"e-drop-hover"),r=!1}}}return r},e.prototype.getButton=function(e){for(var t,i=document.getElementById(this.parent.element.id+"_Wrapper"),r=[].slice.call(i.querySelectorAll(".e-pivot-button")),a=0,n=r.length;a<n;a++)if(r[a].id===e){t=r[a];break}return t},e.prototype.nodeStateChange=function(e){this.parent.pivotCommon.filterDialog.dialogPopUp&&this.parent.pivotCommon.filterDialog.dialogPopUp.close();var i=t.closest(e.node,".e-text-content"),r=this.parent.pivotFieldList[e.data[0].id.toString()];if("check"===e.action){t.addClass([i.querySelector(".e-list-text")],"e-selected-node");var a=this.parent.pivotCommon.dataSourceUpdate.getNewField(e.data[0].id.toString());"number"===r.type?this.parent.dataSource.values.push(a):this.parent.dataSource.rows.push(a)}else t.removeClass([i.querySelector(".e-list-text")],"e-selected-node"),this.parent.pivotCommon.dataSourceUpdate.removeFieldFromReport(e.data[0].id.toString());this.parent.updateDataSource(!0),this.parent.axisFieldModule.render()},e.prototype.addNode=function(e){var t=this.parent.pivotFieldList[e.data[0].id.toString()];if("check"===e.action)this.selectedNodes.push(t.id.toString());else for(var i=this.selectedNodes.length;i--;)if(this.selectedNodes[i]===t.id.toString()){this.selectedNodes.splice(i,1);break}},e.prototype.getTreeUpdate=function(){for(var e=0,i=[].slice.call(this.treeViewElement.querySelectorAll(".e-text-content"));e<i.length;e++){var r=i[e],a=t.createElement("span",{attrs:{tabindex:"-1",title:this.parent.localeObj.getConstant("drag"),"aria-disabled":"false"},className:b+" e-drag"});t.prepend([a],r),r.querySelector(".e-check")&&t.addClass([r.querySelector(".e-list-text")],"e-selected-node")}},e.prototype.refreshTreeView=function(){this.fieldTable.fields={dataSource:this.getTreeData(),id:"id",text:"caption",isChecked:"isSelected"},this.fieldTable.dataBind(),this.getTreeUpdate()},e.prototype.getTreeData=function(e){var i=[],r=Object.keys(this.parent.pivotFieldList),a=t.extend({},this.parent.pivotFieldList,null,!0);if(this.parent.isAdaptive){for(var n=[this.parent.dataSource.filters,this.parent.dataSource.columns,this.parent.dataSource.rows,this.parent.dataSource.values][e],o=r.length;o--;)a[r[o]].isSelected=!1;for(var l=0,s=n;l<s.length;l++)a[s[l].name].isSelected=!0}for(var d=a,p=0,h=r;p<h.length;p++){var c=d[h[p]];i.push(c)}return i},e.prototype.onFieldAdd=function(e){this.parent.dialogRenderer.updateDataSource(this.selectedNodes),this.closeTreeDialog()},e.prototype.closeTreeDialog=function(){this.selectedNodes=[],this.fieldDialog.hide()},e.prototype.addEventListener=function(){this.parent.on("tree-view-update",this.refreshTreeView,this)},e.prototype.removeEventListener=function(){this.parent.isDestroyed||this.parent.off("tree-view-update",this.refreshTreeView)},e.prototype.destroy=function(){this.removeEventListener()},e}(),ie=function(){function e(e){this.parent=e}return e.prototype.render=function(){if(!this.parent.isAdaptive){var e=t.createElement("div",{className:"e-axis-table"});this.leftAxisPanel=t.createElement("div",{className:"e-left-axis-fields"}),this.rightAxisPanel=t.createElement("div",{className:"e-right-axis-fields"}),this.parent.dialogRenderer.parentElement.appendChild(e),e.appendChild(this.leftAxisPanel),e.appendChild(this.rightAxisPanel),this.axisTable=e,this.renderAxisTable()}this.parent.axisFieldModule.render()},e.prototype.renderAxisTable=function(){for(var e=["filters","rows","columns","values"],i=0,r=e.length;i<r;i++){var a=t.createElement("div",{className:"e-field-list-"+e[i]}),n=t.createElement("div",{className:"e-axis-wrapper"}),o=t.createElement("div",{className:"e-axis-header",innerHTML:this.parent.localeObj.getConstant(e[i])});n.appendChild(this.getIconupdate(e[i])),n.appendChild(o);var l=t.createElement("div",{className:"e-axis-content e-"+e[i]}),s=void 0;s="rows"===e[i]?this.parent.localeObj.getConstant("dropRowPrompt"):"columns"===e[i]?this.parent.localeObj.getConstant("dropColPrompt"):"values"===e[i]?this.parent.localeObj.getConstant("dropValPrompt"):this.parent.localeObj.getConstant("dropFilterPrompt");var d=t.createElement("span",{className:"e-draggable-prompt",innerHTML:s});new t.Droppable(l,{});a.appendChild(n),a.appendChild(l),a.appendChild(d),i<=1?this.leftAxisPanel.appendChild(a):this.rightAxisPanel.appendChild(a),this.unWireEvent(l),this.wireEvent(l)}},e.prototype.getIconupdate=function(e){var i=t.createElement("span",{attrs:{tabindex:"-1","aria-disabled":"false"},className:"e-axis-icon-wrapper"}),r=t.createElement("span",{attrs:{tabindex:"-1","aria-disabled":"false"},className:b+" e-axis-"+e});return i.appendChild(r),i},e.prototype.wireEvent=function(e){t.EventHandler.add(e,"mouseover",this.updateDropIndicator,this),t.EventHandler.add(e,"mouseleave",this.updateDropIndicator,this)},e.prototype.unWireEvent=function(e){t.EventHandler.remove(e,"mouseover",this.updateDropIndicator),t.EventHandler.remove(e,"mouseleave",this.updateDropIndicator)},e.prototype.updateDropIndicator=function(e){var i=this.parent.dialogRenderer.parentElement;if(this.parent.isDragging&&e.target.classList.contains("e-axis-content")&&"mouseover"===e.type){t.removeClass([].slice.call(i.querySelectorAll(".e-drop-indicator")),"e-drop-hover"),t.removeClass([].slice.call(i.querySelectorAll(".e-drop-indicator-last")),"e-drop-hover");var r=[].slice.call(e.target.querySelectorAll(".e-pvt-btn-div"));r.length>0&&t.addClass([r[r.length-1].querySelector(".e-drop-indicator-last")],"e-drop-hover")}else"mouseleave"===e.type&&(t.removeClass([].slice.call(i.querySelectorAll(".e-drop-indicator")),"e-drop-hover"),t.removeClass([].slice.call(i.querySelectorAll(".e-drop-indicator-last")),"e-drop-hover"))},e}(),re=function(){function e(e){this.parent=e,this.parent.pivotButtonModule=this,this.addEventListener()}return e.prototype.renderPivotButton=function(e){var i,r=t.extend([],e.field,null,!0),a=e.axis,n=-1,o="pivotfieldlist"==this.parent.getModuleName()&&this.parent.pivotGridModule?this.parent.pivotGridModule.showValuesButton:this.parent.showValuesButton;if(("row"===this.parent.dataSource.valueAxis&&"rows"===e.axis||"column"===this.parent.dataSource.valueAxis&&"columns"===e.axis)&&o&&this.parent.dataSource.values.length>1&&(n=r.length,r.push({name:this.parent.localeObj.getConstant("values"),caption:this.parent.localeObj.getConstant("values"),axis:e.axis})),this.parentElement="pivotview"===this.parent.getModuleName()?this.parent.element:document.getElementById(this.parent.element.id+"_Wrapper"),"pivotfieldlist"===this.parent.getModuleName()){if(this.parentElement=document.getElementById(this.parent.element.id+"_Wrapper"),!this.parentElement.querySelector(".e-field-list-"+a))return;l=this.parentElement.querySelector(".e-field-list-"+a).querySelector(".e-draggable-prompt");0===r.length?t.removeClass([l],"e-disable"):t.addClass([l],"e-disable"),i=this.parentElement.querySelector(".e-field-list-"+a).querySelector(".e-axis-content")}else this.parentElement=this.parent.element,i=this.parentElement.querySelector(".e-group-"+a);if(i)if("pivotview"===this.parent.getModuleName()&&0===r.length){var l=t.createElement("span",{className:"e-draggable-prompt",innerHTML:"rows"===a?this.parent.localeObj.getConstant("rowAxisPrompt"):"columns"===a?this.parent.localeObj.getConstant("columnAxisPrompt"):"values"===a?this.parent.localeObj.getConstant("valueAxisPrompt"):this.parent.localeObj.getConstant("filterAxisPrompt")});i.appendChild(l)}else for(var s=0,d=r.length;s<d;s++){var p=t.createElement("div",{className:"e-pvt-btn-div"+(0===s?" e-first-btn":""),attrs:{"data-tag":a+":"+r[s].name}}),c=t.createElement("div",{id:r[s].name,className:"e-pivot-button",attrs:{"data-uid":r[s].name,tabindex:"0",isvalue:s===n?"true":"false","aria-disabled":"false","aria-label":r[s].caption?r[s].caption:r[s].name}}),u=t.createElement("span",{attrs:{tabindex:"-1","aria-disabled":"false"},className:"e-drop-indicator"}),m=t.createElement("span",{attrs:{tabindex:"-1","aria-disabled":"false"},className:"e-drop-indicator-last"}),g=this.createButtonDragIcon(c),v=t.createElement("span",{attrs:{tabindex:"-1","aria-disabled":"false",oncontextmenu:"return false;","data-type":n===s?"":this.parent.engineModule.fieldList[r[s].name].aggregateType},className:"e-content",innerHTML:r[s].caption?r[s].caption:r[s].name});c.appendChild(v),-1===["filters","values"].indexOf(a)&&n!==s&&this.createSortOption(c,r[s].name),"values"!==a&&n!==s&&this.createFilterOption(c,r[s].name);var f=t.createElement("span",{attrs:{tabindex:"-1","aria-disabled":"false"},className:b+" e-remove"});"pivotview"===this.parent.getModuleName()&&(this.parent.groupingBarSettings.showRemoveIcon?t.removeClass([f],"e-disable"):t.addClass([f],"e-disable")),c.appendChild(f),p.appendChild(u),p.appendChild(c),p.appendChild(m),i.appendChild(p),new h.Button({enableRtl:this.parent.enableRtl}).appendTo(c),this.unWireEvent(p,s===n?"values":a),this.wireEvent(p,s===n?"values":a),("pivotview"===this.parent.getModuleName()&&!this.parent.isAdaptive||"pivotfieldlist"===this.parent.getModuleName())&&this.createDraggable("pivotview"===this.parent.getModuleName()?v:g)}},e.prototype.createDraggable=function(e){this.draggable=new t.Draggable(e,{clone:!0,enableTailMode:!0,enableAutoScroll:!0,helper:this.createDragClone.bind(this),dragStart:this.onDragStart.bind(this),drag:this.onDragging.bind(this),dragStop:this.onDragStop.bind(this)})},e.prototype.createButtonDragIcon=function(e){var i=t.createElement("span",{attrs:{tabindex:"-1","aria-disabled":"false"}}),r=t.createElement("span",{attrs:{tabindex:"-1","aria-disabled":"false"},className:b+" e-drag"});return i.appendChild(r),e.appendChild(i),i},e.prototype.createSortOption=function(e,i){var r="Descending"===this.parent.engineModule.fieldList[i].sort?"e-descend":"",a=t.createElement("span",{attrs:{tabindex:"-1","aria-disabled":"false"},className:b+" e-sort "+r});return this.parent.dataSource.enableSorting?t.removeClass([a],"e-disable"):t.addClass([a],"e-disable"),"pivotview"===this.parent.getModuleName()&&(this.parent.groupingBarSettings.showSortIcon?t.removeClass([a],"e-disable"):t.addClass([a],"e-disable")),e.appendChild(a),a},e.prototype.createFilterOption=function(e,i){var r=0===this.parent.engineModule.fieldList[i].filter.length?this.parent.engineModule.fieldList[i].isExcelFilter?"e-pv-filtered":"e-pv-filter":"e-pv-filtered",a=t.createElement("span",{attrs:{tabindex:"-1","aria-disabled":"false"},className:"e-btn-filter e-icons "+r});return"pivotview"===this.parent.getModuleName()&&(this.parent.groupingBarSettings.showFilterIcon?t.removeClass([a],"e-disable"):t.addClass([a],"e-disable")),e.appendChild(a),a},e.prototype.createDragClone=function(e){var i=t.closest(e.element,".e-pivot-button"),r=t.createElement("div",{id:this.parent.element.id+"_DragClone",className:"e-button-drag-clone"}),a=t.createElement("span",{className:"e-text-content",innerHTML:i.textContent});return r.appendChild(a),document.body.appendChild(r),r},e.prototype.onDragStart=function(e){this.parent.isDragging=!0;var i=t.closest(e.element,".e-pivot-button"),r=this.parent.engineModule.fieldList[i.getAttribute("data-uid")],a=["e-rows","e-columns","e-filters"];if(t.addClass([i],"e-list-selected"),r&&"CalculatedField"===r.aggregateType)for(var n=0,o=a;n<o.length;n++){var l=o[n];t.addClass([this.parentElement.querySelector("."+l)],"e-drag-restrict")}},e.prototype.onDragging=function(e){this.draggable.setProperties({cursorAt:{top:!t.isNullOrUndefined(e.event.targetTouches)||t.Browser.isDevice?60:-20}})},e.prototype.onDragStop=function(e){this.parent.isDragging=!1;var i=t.closest(e.element,".e-pivot-button");t.removeClass([].slice.call(this.parentElement.querySelectorAll(".e-pivot-button")),"e-list-selected"),t.removeClass([].slice.call(this.parentElement.querySelectorAll(".e-drop-indicator")),"e-drop-hover");for(var r=0,a=["e-rows","e-columns","e-filters"];r<a.length;r++){var n=a[r];t.removeClass([this.parentElement.querySelector("."+n)],"e-drag-restrict")}this.parent.pivotCommon.filterDialog.dialogPopUp&&this.parent.pivotCommon.filterDialog.dialogPopUp.close(),document.getElementById(this.parent.element.id+"_DragClone")&&t.remove(document.getElementById(this.parent.element.id+"_DragClone")),this.isButtonDropped(e.target,i)&&(this.parent.pivotCommon.dataSourceUpdate.control="pivotview"===this.parent.getModuleName()?this.parent:this.parent.pivotGridModule?this.parent.pivotGridModule:this.parent,this.parent.pivotCommon.nodeStateModified.onStateModified(e,i.id)&&(this.parent.updateDataSource(),this.parent.axisFieldModule.render()))},e.prototype.isButtonDropped=function(e,i){var r=t.closest(i,".e-droppable"),a=!0;if(r===t.closest(e,".e-droppable")){for(var n=[].slice.call(r.querySelectorAll(".e-pivot-button")),o=t.closest(e,".e-pvt-btn-div"),l=void 0,s=-1,d=0,p=n.length;d<p;d++)if(n[d].id===i.id&&(l=d),o){var h=o.querySelector(".e-pivot-button");n[d].id===h.id&&(s=d)}(l===s||l===n.length-1&&-1===s)&&(t.removeClass([].slice.call(this.parentElement.querySelectorAll(".e-drop-indicator")),"e-drop-hover"),a=!1)}return a},e.prototype.updateSorting=function(e){("pivotview"===this.parent.getModuleName()&&this.parent.enableValueSorting||"pivotfieldlist"===this.parent.getModuleName()&&void 0!==this.parent.pivotGridModule&&this.parent.pivotGridModule.enableValueSorting)&&"rows"===e.target.parentElement.parentElement.getAttribute("data-tag").split(":")[0]&&(this.parent.dataSource.valueSortSettings.headerText=""),this.parent.pivotCommon.eventBase.updateSorting(e),this.parent.updateDataSource(!0)},e.prototype.updateFiltering=function(e){this.parent.pivotCommon.eventBase.updateFiltering(e);var t=e.target.parentElement.id;this.dialogPopUp=this.parent.pivotCommon.filterDialog.dialogPopUp,this.memberTreeView=this.parent.pivotCommon.filterDialog.memberTreeView,this.parent.pivotCommon.filterDialog.memberTreeView.nodeChecked=this.nodeStateModified.bind(this),this.parent.pivotCommon.filterDialog.allMemberSelect.nodeChecked=this.nodeStateModified.bind(this),this.bindDialogEvents(t)},e.prototype.bindDialogEvents=function(e){var i=this;this.parent.pivotCommon.filterDialog.allowExcelLikeFilter&&this.parent.pivotCommon.filterDialog.tabObj?(this.updateDialogButtonEvents(this.parent.pivotCommon.filterDialog.tabObj.selectedItem,e),this.dialogPopUp.buttons[1].click=this.ClearFilter.bind(this),this.parent.pivotCommon.filterDialog.tabObj.selected=function(r){i.updateDialogButtonEvents(r.selectedIndex,e),t.removeClass([].slice.call(i.dialogPopUp.element.querySelectorAll(".e-selected-tab")),"e-selected-tab"),r.selectedIndex>0&&t.addClass([i.dialogPopUp.element.querySelector(".e-filter-div-content."+(1===r.selectedIndex&&i.parent.dataSource.allowLabelFilter?"e-label-filter":"e-value-filter"))],"e-selected-tab")}):this.updateDialogButtonEvents(0,e)},e.prototype.updateDialogButtonEvents=function(e,t){this.dialogPopUp.buttons[0].click=0===e?this.updateFilterState.bind(this,t):this.updateCustomFilter.bind(this)},e.prototype.updateCustomFilter=function(e){var t=this.dialogPopUp.element.querySelector(".e-selected-tab"),i=t.getAttribute("data-fieldname"),r=t.getAttribute("data-type"),a=t.getAttribute("data-measure"),n=t.getAttribute("data-operator"),o=t.getAttribute("data-value1"),l=t.getAttribute("data-value2"),s="value"===r?"Value":"date"===r?"Date":"number"===r?"Number":"Label",d={name:i,type:s,measure:a,condition:n,value1:"date"===r?new Date(o):o,value2:"date"===r?new Date(l):l},p=this.parent.pivotCommon.eventBase.getFilterItemByName(i);p?((p=p.properties?p.properties:p).type=s,p.measure=a,p.condition=n,p.value1="date"===r?new Date(o):o,p.value2="date"===r?new Date(l):l):this.parent.dataSource.filterSettings.push(d),this.dialogPopUp.hide(),this.refreshPivotButtonState(i,!0),this.parent.updateDataSource(!0)},e.prototype.ClearFilter=function(e){var t=this.dialogPopUp.element.getAttribute("data-fieldname");this.dialogPopUp.hide(),this.removeDataSourceSettings(t),this.refreshPivotButtonState(t,!1),this.parent.updateDataSource(!0)},e.prototype.removeButton=function(e){var t=e.target,i=t.parentElement.id;"true"===t.parentElement.getAttribute("isvalue")?this.parent.setProperties({dataSource:{values:[]}},!0):this.parent.pivotCommon.dataSourceUpdate.removeFieldFromReport(i),"pivotfieldlist"===this.parent.getModuleName()&&this.parent.axisFieldModule.render(),this.parent.updateDataSource()},e.prototype.nodeStateModified=function(e){"all"===e.node.parentElement.parentElement.getAttribute("data-uid")&&(this.memberTreeView.nodeChecked=null,"check"===e.action?this.memberTreeView.checkAll():this.memberTreeView.uncheckAll(),this.memberTreeView.nodeChecked=this.nodeStateModified.bind(this)),this.parent.pivotCommon.filterDialog.updateCheckedState()},e.prototype.updateFilterState=function(e,t){for(var i=[].slice.call(this.memberTreeView.element.querySelectorAll("li")),r=0,a={items:[],name:e,type:"Include"},n=0,o=i.length;n<o;n++)i[n].querySelector(".e-frame").classList.contains("e-check")?a.items.push(i[n].getAttribute("data-uid")):r+=1;var l=this.parent.pivotCommon.eventBase.getFilterItemByName(e);l?((l=l.properties?l.properties:l).items=a.items,l.type=a.type):this.parent.dataSource.filterSettings.push(a),this.dialogPopUp.hide(),this.refreshPivotButtonState(e,r>0),0===r&&this.removeDataSourceSettings(e),this.parent.updateDataSource(!0)},e.prototype.refreshPivotButtonState=function(e,i){for(var r,a=0,n=[].slice.call(this.parentElement.querySelectorAll(".e-pivot-button"));a<n.length;a++){var o=n[a];if(o.getAttribute("data-uid")===e){r=o.querySelector(".e-btn-filter");break}}i?(t.removeClass([r],"e-pv-filter"),t.addClass([r],"e-pv-filtered")):(t.removeClass([r],"e-pv-filtered"),t.addClass([r],"e-pv-filter"))},e.prototype.removeDataSourceSettings=function(e){for(var t=this.parent.dataSource.filterSettings,i=0,r=t.length;i<r;i++)if(t[i].name===e){t.splice(i,1);break}},e.prototype.updateDropIndicator=function(e){if(this.parent.isDragging){t.removeClass([].slice.call(this.parentElement.querySelectorAll(".e-drop-indicator-last")),"e-drop-hover"),t.removeClass([].slice.call(this.parentElement.querySelectorAll(".e-drop-indicator")),"e-drop-hover");var i=t.closest(e.target,".e-pvt-btn-div");t.addClass([i.querySelector(".e-drop-indicator")],"e-drop-hover")}},e.prototype.wireEvent=function(e,i){t.EventHandler.add(e,"mouseover",this.updateDropIndicator,this),-1===["filters","values"].indexOf(i)&&t.EventHandler.add(e.querySelector(".e-sort"),"click",this.updateSorting,this),"values"!==i&&t.EventHandler.add(e.querySelector(".e-btn-filter"),"click",this.updateFiltering,this),t.EventHandler.add(e.querySelector(".e-remove"),"click",this.removeButton,this)},e.prototype.unWireEvent=function(e,i){t.EventHandler.remove(e,"mouseover",this.updateDropIndicator),-1===["filters","values"].indexOf(i)&&t.EventHandler.remove(e.querySelector(".e-sort"),"click",this.updateSorting),"values"!==i&&t.EventHandler.remove(e.querySelector(".e-btn-filter"),"click",this.updateFiltering),t.EventHandler.remove(e.querySelector(".e-remove"),"click",this.removeButton)},e.prototype.addEventListener=function(){this.handlers={load:this.renderPivotButton},this.parent.isDestroyed||this.parent.on("pivot-button-update",this.handlers.load,this)},e.prototype.removeEventListener=function(){this.parent.isDestroyed||this.parent.off("pivot-button-update",this.handlers.load)},e.prototype.destroy=function(){this.removeEventListener()},e}(),ae=function(){function e(e){this.parent=e}return e.prototype.render=function(){this.pivotButton=new re(this.parent),this.createPivotButtons()},e.prototype.createPivotButtons=function(){var e=[this.parent.dataSource.rows,this.parent.dataSource.columns,this.parent.dataSource.values,this.parent.dataSource.filters],t=this.parent.dialogRenderer.parentElement;t.querySelector(".e-field-list-filters")&&(t.querySelector(".e-field-list-filters").querySelector(".e-axis-content").innerHTML=""),t.querySelector(".e-field-list-rows")&&(t.querySelector(".e-field-list-rows").querySelector(".e-axis-content").innerHTML=""),t.querySelector(".e-field-list-columns")&&(t.querySelector(".e-field-list-columns").querySelector(".e-axis-content").innerHTML=""),t.querySelector(".e-field-list-values")&&(t.querySelector(".e-field-list-values").querySelector(".e-axis-content").innerHTML="");for(var i=["rows","columns","values","filters"],r=0,a=e.length;r<a;r++)if(e[r]){var n={field:e[r],axis:i[r].toString()};this.parent.notify("pivot-button-update",n)}},e}(),ne=function(){function e(e){this.parent=e,this.parent.dialogRenderer=new ee(this.parent),this.parent.treeViewModule=new te(this.parent),this.parent.axisTableModule=new ie(this.parent),this.parent.axisFieldModule=new ae(this.parent)}return e.prototype.render=function(){this.parent.dialogRenderer.render(),this.parent.isAdaptive||this.parent.treeViewModule.render(),this.parent.axisTableModule.render()},e}(),oe=function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])};return function(t,i){function r(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),le=function(e,t,i,r){var a,n=arguments.length,o=n<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,r);else for(var l=e.length-1;l>=0;l--)(a=e[l])&&(o=(n<3?a(o):n>3?a(t,i,o):a(t,i))||o);return n>3&&o&&Object.defineProperty(t,i,o),o},se=function(e){function i(t,i){return e.call(this,t,i)||this}return oe(i,e),i.prototype.requiredModules=function(){var e=[];return this.allowCalculatedField&&e.push({args:[this],member:"calculatedfield"}),e},i.prototype.preRender=function(){this.isAdaptive=t.Browser.isDevice,this.globalize=new t.Internationalization(this.locale),this.renderModule=new ne(this),this.defaultLocale={staticFieldList:"Pivot Field List",fieldList:"Field List",dropFilterPrompt:"Drop filter here",dropColPrompt:"Drop column here",dropRowPrompt:"Drop row here",dropValPrompt:"Drop value here",addPrompt:"Add field here",adaptiveFieldHeader:"Choose field",centerHeader:"Drag fields between axes below:",add:"add",drag:"Drag",filter:"Filter",filtered:"Filtered",sort:"Sort",remove:"Remove",filters:"Filters",rows:"Rows",columns:"Columns",values:"Values",calculatedField:"Calculated Field",createCalculatedField:"Create Calculated Field",fieldName:"Enter the field name",error:"Error",invalidFormula:"Invalid formula.",dropText:'Example: ("Sum(Order_Count)" + "Sum(In_Stock)") * 250',dropTextMobile:"Add fields and edit formula here.",dropAction:"Calculated field cannot be place in any other region except value axis.",search:"Search",close:"Close",cancel:"Cancel",delete:"Delete",alert:"Alert",warning:"Warning",ok:"OK",sum:"Sum",average:"Average",count:"Count",min:"Min",max:"Max",allFields:"All Fields",formula:"Formula",fieldExist:"A field already exists in this name. Please enter a different name.",confirmText:"A calculation field already exists in this name. Do you want to replace it?",noMatches:"No matches",format:"Summaries values by",edit:"Edit",clear:"Clear",formulaField:"Drag and drop fields to formula",dragField:"Drag field to formula",clearFilter:"Clear",by:"by",enterValue:"Enter value",chooseDate:"Enter date",Equals:"Equals",DoesNotEquals:"Does Not Equal",BeginWith:"Begins With",DoesNotBeginWith:"Does Not Begin With",EndsWith:"Ends With",DoesNotEndsWith:"Does Not End With",Contains:"Contains",DoesNotContains:"Does Not Contain",GreaterThan:"Greater Than",GreaterThanOrEqualTo:"Greater Than Or Equal To",LessThan:"Less Than",LessThanOrEqualTo:"Less Than Or Equal To",Between:"Between",NotBetween:"Not Between",Before:"Before",BeforeOrEqualTo:"Before Or Equal To",After:"After",AfterOrEqualTo:"After Or Equal To",member:"Member",label:"Label",date:"Date",value:"Value",labelTextContent:"Show the items for which the label",dateTextContent:"Show the items for which the date",valueTextContent:"Show the items for which",And:"and",apply:"APPLY"},this.localeObj=new t.L10n(this.getModuleName(),this.defaultLocale,this.locale),this.isDragging=!1,this.captionData=[],this.wireEvent()},i.prototype.render=function(){this.trigger("load",{dataSource:this.dataSource}),t.addClass([this.element],v),this.enableRtl?t.addClass([this.element],f):t.removeClass([this.element],f),this.isAdaptive?t.addClass([this.element],y):t.removeClass([this.element],y),this.cssClass&&t.addClass([this.element],this.cssClass),this.notify("initial-load",{})},i.prototype.wireEvent=function(){this.on("initial-load",this.generateData,this),this.on(g,this.fieldListRender,this)},i.prototype.unWireEvent=function(){this.pivotGridModule&&this.pivotGridModule.isDestroyed||(this.off("initial-load",this.generateData),this.off(g,this.fieldListRender))},i.prototype.getPersistData=function(){var e=["dataSource"];return this.addOnPersist(e)},i.prototype.getModuleName=function(){return"pivotfieldlist"},i.prototype.onPropertyChanged=function(e,i){for(var r=!1,a=0,n=Object.keys(e);a<n.length;a++){switch(n[a]){case"locale":this.refresh();break;case"enableRtl":this.enableRtl?t.addClass([this.element],f):t.removeClass([this.element],f),r=!0}r&&this.fieldListRender()}},i.prototype.generateData=function(){if(this.pivotFieldList={},this.dataSource&&this.dataSource.data){this.trigger("enginePopulating",{dataSource:this.dataSource});var e=this.pivotGridModule?this.pivotGridModule.pageSettings:void 0,t=this.pivotGridModule?this.pivotGridModule.enableValueSorting:void 0;this.engineModule=new u(this.dataSource,"",void 0,e,t),this.pivotFieldList=this.engineModule.fieldList;var i={pivotFieldList:this.pivotFieldList,pivotValues:this.engineModule.pivotValues};this.trigger("enginePopulated",i)}this.notify(g,{}),this.trigger("dataBound")},i.prototype.fieldListRender=function(){this.element.innerHTML="","Popup"===this.renderMode&&this.dialogRenderer.fieldListDialog&&!this.dialogRenderer.fieldListDialog.isDestroyed&&(this.dialogRenderer.fieldListDialog.destroy(),t.remove(document.getElementById(this.element.id+"_Wrapper"))),this.renderModule.render(),this.fieldListSpinnerElement="Popup"===this.renderMode?this.dialogRenderer.fieldListDialog.element:this.element.querySelector(".e-pivotfieldlist-wrapper"),r.createSpinner({target:this.fieldListSpinnerElement},this.createElement);var e={pivotEngine:this.engineModule,dataSource:this.dataSource,id:this.element.id,element:document.getElementById(this.element.id+"_Wrapper"),moduleName:this.getModuleName(),enableRtl:this.enableRtl,isAdaptive:this.isAdaptive,renderMode:this.renderMode,localeObj:this.localeObj};this.pivotCommon=new J(e)},i.prototype.getFieldCaption=function(e){if(this.getFields(e),this.captionData.length>0)for(var t=this.captionData.length;t--;)if(this.captionData[t])for(var i=0,r=this.captionData[t];i<r.length;i++){var a=r[i].properties;a&&(this.engineModule.fieldList[a.name]&&a.caption?this.engineModule.fieldList[a.name].caption=a.caption:this.engineModule.fieldList[a.name].caption=a.name)}},i.prototype.getFields=function(e){var i=t.extend({},e,null,!0).properties;this.captionData=[i.rows,i.columns,i.values,i.filters]},i.prototype.updateDataSource=function(e){this.pivotGridModule&&r.showSpinner(this.pivotGridModule.element),r.showSpinner(this.fieldListSpinnerElement);var t=this.pivotGridModule?this.pivotGridModule.pageSettings:void 0,i=this.pivotGridModule?this.pivotGridModule.enableValueSorting:void 0;this.engineModule=new u(this.dataSource,"",this.pivotFieldList,t,i),this.getFieldCaption(this.dataSource);var a={dataSource:this.dataSource,pivotFieldList:this.pivotFieldList,pivotValues:this.engineModule.pivotValues};this.trigger("enginePopulated",a),this.pivotCommon.engineModule=this.engineModule,this.pivotCommon.dataSource=this.dataSource,this.pivotFieldList=this.engineModule.fieldList,e||!this.treeViewModule.fieldTable||this.isAdaptive||this.notify("tree-view-update",{}),this.updateView(this.pivotGridModule),this.pivotGridModule?this.pivotGridModule.fieldListSpinnerElement=this.fieldListSpinnerElement:r.hideSpinner(this.fieldListSpinnerElement)},i.prototype.update=function(e){e&&(this.setProperties({dataSource:e.dataSource},!0),this.engineModule=e.engineModule,this.pivotFieldList=e.engineModule.fieldList,this.pivotGridModule=e,this.getFieldCaption(e.dataSource),this.pivotCommon.engineModule=this.engineModule,this.pivotCommon.dataSource=this.dataSource,this.treeViewModule.fieldTable&&!this.isAdaptive&&this.notify("tree-view-update",{}),this.axisFieldModule.render())},i.prototype.updateView=function(e){e&&(e.setProperties({dataSource:this.dataSource},!0),e.engineModule=this.engineModule,e.pivotValues=this.engineModule.pivotValues,e.dataBind())},i.prototype.destroy=function(){this.unWireEvent(),this.treeViewModule&&this.treeViewModule.destroy(),this.pivotButtonModule&&this.pivotButtonModule.destroy(),e.prototype.destroy.call(this),this.element.innerHTML="",t.removeClass([this.element],v),t.removeClass([this.element],f),t.removeClass([this.element],y),"Popup"===this.renderMode&&(this.dialogRenderer.fieldListDialog&&!this.dialogRenderer.fieldListDialog.isDestroyed&&this.dialogRenderer.fieldListDialog.destroy(),document.getElementById(this.element.id+"_Wrapper")&&t.remove(document.getElementById(this.element.id+"_Wrapper")))},le([t.Complex({},N)],i.prototype,"dataSource",void 0),le([t.Property("Popup")],i.prototype,"renderMode",void 0),le([t.Property()],i.prototype,"target",void 0),le([t.Property("")],i.prototype,"cssClass",void 0),le([t.Property(!1)],i.prototype,"allowCalculatedField",void 0),le([t.Property(!1)],i.prototype,"showValuesButton",void 0),le([t.Event()],i.prototype,"load",void 0),le([t.Event()],i.prototype,"enginePopulating",void 0),le([t.Event()],i.prototype,"enginePopulated",void 0),le([t.Event()],i.prototype,"dataBound",void 0),le([t.Event()],i.prototype,"created",void 0),le([t.Event()],i.prototype,"destroyed",void 0),i=le([t.NotifyPropertyChanges],i)}(t.Component),de="CalculatedField",pe=function(){function e(e){this.parent=e,this.existingReport=null,this.parent.calculatedFieldModule=this,this.removeEventListener(),this.addEventListener(),this.parentID=this.parent.element.id,this.dialog=null,this.inputObj=null,this.treeObj=null,this.droppable=null,this.menuObj=null,this.newFields=null,this.isFieldExist=!0,this.formulaText=null,this.fieldText=null,this.isEdit=!1,this.currentFieldName=null,this.confirmPopUp=null}return e.prototype.getModuleName=function(){return"calculatedfield"},e.prototype.keyActionHandler=function(e){var t=e.currentTarget.querySelector(".e-hover.e-node-focus");if(t)switch(e.action){case"moveRight":this.displayMenu(t.previousSibling);break;case"enter":var i=t.getAttribute("data-field"),r=t.getAttribute("data-type"),a=this.dialog.element.querySelector("#"+this.parentID+"droppable");""===a.value?a.value=r===de?t.getAttribute("data-uid"):'"'+r+"("+i+')"':""!==a.value&&(a.value=r===de?a.value+t.getAttribute("data-uid"):a.value+'"'+r+"("+i+')"')}},e.prototype.fieldClickHandler=function(e){var t=e.event.target.parentElement;(e.event.target.classList.contains(x)||e.event.target.classList.contains("e-edit")||e.event.target.classList.contains("e-edited"))&&this.displayMenu(t.parentElement)},e.prototype.displayMenu=function(e){null===document.querySelector("."+this.parentID+"calculatedmenu")||!e.querySelector(".e-list-icon").classList.contains(b)||e.querySelector(".e-list-icon").classList.contains("e-edited")||e.querySelector(".e-list-icon").classList.contains("e-edit")||"LI"!==e.tagName?e.querySelector(".e-list-icon").classList.contains("e-edit")&&"LI"===e.tagName?(t.addClass([e.querySelector(".e-list-icon")],"e-edited"),t.removeClass([e.querySelector(".e-list-icon")],"e-edit"),e.querySelector(".e-edited").setAttribute("title",this.parent.localeObj.getConstant("clear")),this.isEdit=!0,this.currentFieldName=e.getAttribute("data-field"),this.inputObj.value=e.getAttribute("data-caption"),this.dialog.element.querySelector("."+S).value=e.getAttribute("data-caption"),document.querySelector("#"+this.parentID+"droppable").value=e.getAttribute("data-uid")):e.querySelector(".e-list-icon").classList.contains("e-edited")&&"LI"===e.tagName&&(t.addClass([e.querySelector(".e-list-icon")],"e-edit"),t.removeClass([e.querySelector(".e-list-icon")],"e-edited"),e.querySelector(".e-edit").setAttribute("title",this.parent.localeObj.getConstant("edit")),this.isEdit=!1,this.inputObj.value="",this.dialog.element.querySelector("."+S).value="",document.querySelector("#"+this.parentID+"droppable").value=""):(this.menuObj.close(),this.curMenu=e.querySelector(".e-list-text"),this.openContextMenu())},e.prototype.openContextMenu=function(){var e=this.curMenu.getBoundingClientRect();this.parent.enableRtl?this.menuObj.open(e.top+30,e.left-100):this.menuObj.open(e.top+30,e.left+150)},e.prototype.selectContextMenu=function(e){if(null!==e.element.textContent){var i=t.closest(this.curMenu,".e-list-item").getAttribute("data-caption");t.closest(this.curMenu,".e-list-item").setAttribute("data-type",e.element.textContent),this.curMenu.textContent=i+" ("+e.element.textContent+")",t.addClass([this.curMenu.parentElement.parentElement],["e-node-focus","e-hover"]),this.curMenu.parentElement.parentElement.setAttribute("tabindex","-1"),this.curMenu.parentElement.parentElement.focus()}},e.prototype.createMenu=function(){var e=[{text:"Count"},{text:"Avg"},{text:"Min"},{text:"Max"},{text:"Sum"}],i={cssClass:this.parentID+"calculatedmenu",items:e,enableRtl:this.parent.enableRtl,beforeOpen:this.beforeMenuOpen.bind(this),select:this.selectContextMenu.bind(this)};this.parent.element.appendChild(t.createElement("ul",{id:this.parentID+"contextmenu"})),this.menuObj=new l.ContextMenu(i),this.menuObj.appendTo("#"+this.parentID+"contextmenu")},e.prototype.applyFormula=function(){var e=this,i=!1;if(t.removeClass([document.getElementById(this.parentID+"ddlelement")],"e-empty-field"),Object.keys(e.parent.engineModule.fieldList).forEach(function(t,r){e.inputObj.value&&e.inputObj.value===t&&"CalculatedField"!==e.parent.engineModule.fieldList[t].aggregateType&&(i=!0)}),i)return void e.parent.pivotCommon.errorDialog.createErrorDialog(e.parent.localeObj.getConstant("error"),e.parent.localeObj.getConstant("fieldExist"));this.newFields=t.extend([],this.parent.dataSource.calculatedFieldSettings,null,!0),this.existingReport=t.extend({},this.parent.dataSource,null,!0);var r=this.parent.dataSource,a=document.querySelector("#"+this.parentID+"droppable");if(null!==this.inputObj.value&&""!==this.inputObj.value&&""!==a.value){var n={name:this.inputObj.value,type:"CalculatedField"},o={name:this.inputObj.value,formula:a.value};if(this.isFieldExist=!0,this.isEdit){for(l=0;l<r.values.length;l++)if(r.values[l].type===de&&null!==this.currentFieldName&&r.values[l].name===this.currentFieldName&&this.isEdit)for(s=0;s<r.calculatedFieldSettings.length;s++)r.calculatedFieldSettings[s].name===this.currentFieldName&&(r.values[l].caption=this.inputObj.value,r.calculatedFieldSettings[s].formula=a.value,this.parent.engineModule.fieldList[this.currentFieldName].caption=this.inputObj.value,this.isFieldExist=!1)}else for(var l=0;l<r.values.length;l++)if(r.values[l].type===de&&r.values[l].name===n.name){for(var s=0;s<r.calculatedFieldSettings.length;s++)if(r.calculatedFieldSettings[s].name===n.name)return void this.createConfirmDialog(e.parent.localeObj.getConstant("alert"),e.parent.localeObj.getConstant("confirmText"));this.isFieldExist=!1}this.isFieldExist&&(r.values.push(n),r.calculatedFieldSettings.push(o)),this.addFormula(r,n.name)}else null===this.inputObj.value||""===this.inputObj.value?(t.addClass([document.getElementById(this.parentID+"ddlelement")],"e-empty-field"),document.getElementById(this.parentID+"ddlelement").focus()):this.parent.pivotCommon.errorDialog.createErrorDialog(this.parent.localeObj.getConstant("error"),this.parent.localeObj.getConstant("invalidFormula"))},e.prototype.addFormula=function(e,t){try{this.parent.setProperties({dataSource:e},!0),this.parent.updateDataSource(!1),this.isEdit=!1,this.dialog?this.dialog.close():(this.inputObj.value="",this.formulaText=null,this.fieldText=null,this.parent.dialogRenderer.parentElement.querySelector("."+S).value="",this.parent.dialogRenderer.parentElement.querySelector("#"+this.parentID+"droppable").value="")}catch(e){this.parent.engineModule.fieldList[t]&&delete this.parent.engineModule.fieldList[t],this.parent.pivotCommon.errorDialog.createErrorDialog(this.parent.localeObj.getConstant("error"),this.parent.localeObj.getConstant("invalidFormula")),this.parent.setProperties({dataSource:this.existingReport},!0),this.parent.updateDataSource(!1)}},e.prototype.getFieldListData=function(e){var t=[];return Object.keys(e.engineModule.fieldList).forEach(function(i){var r=null;r="string"===e.engineModule.fieldList[i].type||"include"===e.engineModule.fieldList[i].type||"exclude"===e.engineModule.fieldList[i].type?"Count":void 0!==e.engineModule.fieldList[i].aggregateType?e.engineModule.fieldList[i].aggregateType:"Sum",t.push({index:e.engineModule.fieldList[i].index,name:e.engineModule.fieldList[i].caption+" ("+r+")",type:r,icon:x+" "+b,formula:e.engineModule.fieldList[i].formula,field:i,caption:e.engineModule.fieldList[i].caption?e.engineModule.fieldList[i].caption:i})}),t},e.prototype.beforeMenuOpen=function(e){e.element.style.zIndex=(this.dialog.zIndex+1).toString(),e.element.style.display="inline"},e.prototype.fieldDropped=function(e){e.cancel=!0;var t=e.draggedNode.getAttribute("data-field"),i=e.draggedNode.getAttribute("data-type"),r=this.dialog.element.querySelector("#"+this.parentID+"droppable");if(e.target.id===this.parentID+"droppable"&&""===r.value)r.value=i===de?e.draggedNodeData.id.toString():'"'+i+"("+t+')"',r.focus();else if(e.target.id===this.parentID+"droppable"&&""!==r.value){var a=void 0,n=r.selectionStart,o=r.value,l=o.substring(0,n),s=o.substring(n,o.length);i===de?(a=l+e.draggedNodeData.id.toString(),r.value=l+e.draggedNodeData.id.toString()+s):(a=l+'"'+i+"("+t+')"',r.value=l+'"'+i+"("+t+')"'+s),r.focus(),r.setSelectionRange(a.length,a.length)}else e.cancel=!0},e.prototype.createDialog=function(){var e=this;null!==document.querySelector("#"+this.parentID+"calculateddialog")&&t.remove(document.querySelector("#"+this.parentID+"calculateddialog")),this.parent.element.appendChild(t.createElement("div",{id:this.parentID+"calculateddialog",className:"e-pivot-calc-dialog-div"})),this.dialog=new r.Dialog({allowDragging:!0,position:{X:"center",Y:"center"},buttons:[{click:function(){return e.applyFormula()},buttonModel:{content:this.parent.localeObj.getConstant("ok"),isPrimary:!0}},{click:function(){e.dialog.close(),e.isEdit=!1},buttonModel:{content:this.parent.localeObj.getConstant("cancel")}}],close:function(i){"pivotfieldlist"===e.parent.getModuleName()&&(e.parent.axisFieldModule.render(),"Fixed"!==e.parent.renderMode&&(t.addClass([e.parent.element.querySelector(".e-toggle-field-list")],"e-hide"),e.parent.dialogRenderer.fieldListDialog.show())),e.treeObj.destroy(),e.dialog.destroy(),e.newFields=null,t.remove(document.getElementById(e.parentID+"calculateddialog")),t.remove(document.querySelector("."+e.parentID+"calculatedmenu"))},beforeOpen:function(t){e.dialog.element.querySelector(".e-dlg-header").setAttribute("title",e.parent.localeObj.getConstant("createCalculatedField"))},animationSettings:{effect:"Zoom"},width:"25%",isModal:!1,closeOnEscape:!0,enableRtl:this.parent.enableRtl,showCloseIcon:!0,header:this.parent.localeObj.getConstant("createCalculatedField"),target:document.body}),this.dialog.appendTo("#"+this.parentID+"calculateddialog")},e.prototype.renderDialogElements=function(){var e=t.createElement("div",{id:this.parentID+"outerDiv",className:"e-pivot-calc-outer-div"});if("pivotfieldlist"===this.parent.getModuleName()&&null!==this.parent.dialogRenderer.parentElement.querySelector("."+w)&&this.parent.isAdaptive){var i=t.createElement("div",{id:this.parentID+"accordDiv",className:"e-pivot-accord"});e.appendChild(i);var r=t.createElement("div",{id:this.parentID+"buttonDiv",className:"e-pivot-button-div"}),a=t.createElement("button",{id:this.parentID+"addBtn",innerHTML:"ADD",className:"e-pivot-add-button"}),n=t.createElement("button",{id:this.parentID+"cancelBtn",innerHTML:"CANCEL",className:"e-pivot-cancel-button"});r.appendChild(n),r.appendChild(a),e.appendChild(r)}else{var o=t.createElement("div",{id:this.parentID+"outerDiv",className:"e-pivot-calc-input-div"}),l=t.createElement("input",{id:this.parentID+"ddlelement",attrs:{type:"text",tabindex:"1"},className:S});if(o.appendChild(l),e.appendChild(o),!this.parent.isAdaptive){var s=t.createElement("div",{className:"e-pivot-all-field-title",innerHTML:this.parent.localeObj.getConstant("formulaField")});e.appendChild(s)}var d=t.createElement("div",{id:this.parentID+"control_wrapper",className:"e-pivot-treeview-outer"});if(d.appendChild(t.createElement("div",{id:this.parentID+"tree",className:"e-pivot-treeview"})),e.appendChild(d),!this.parent.isAdaptive){var p=t.createElement("div",{className:"e-pivot-formula-title",innerHTML:this.parent.localeObj.getConstant("formula")});e.appendChild(p)}var h=t.createElement("textarea",{id:this.parentID+"droppable",className:w,attrs:{placeholder:this.parent.isAdaptive?this.parent.localeObj.getConstant("dropTextMobile"):this.parent.localeObj.getConstant("dropText")}});if(e.appendChild(h),this.parent.isAdaptive){var r=t.createElement("div",{id:this.parentID+"buttonDiv",className:"e-pivot-button-div"}),c=t.createElement("button",{id:this.parentID+"okBtn",innerHTML:this.parent.localeObj.getConstant("apply"),className:"e-pivot-ok-button"});r.appendChild(c),e.appendChild(r)}}return e},e.prototype.renderAdaptiveLayout=function(){document.querySelector("#"+this.parentID+"droppable")&&(this.formulaText=document.querySelector("#"+this.parentID+"droppable").value,this.fieldText=this.inputObj.value),this.renderMobileLayout(this.parent.dialogRenderer.adaptiveElement)},e.prototype.createTreeView=function(){var e=this;this.treeObj=new l.TreeView({fields:{dataSource:this.getFieldListData(this.parent),id:"formula",text:"name",iconCss:"icon"},allowDragAndDrop:!0,enableRtl:this.parent.enableRtl,nodeCollapsing:function(e){e.cancel=!0},nodeDragStart:function(i){if(i.event.target.classList.contains("e-drag")){var r=document.querySelector(".e-drag-item.e-treeview");t.addClass([r],"e-pivot-calc"),r.style.zIndex=(e.dialog.zIndex+1).toString(),r.style.display="inline"}else i.cancel=!0},nodeClicked:this.fieldClickHandler.bind(this),nodeDragStop:this.fieldDropped.bind(this),drawNode:this.drawTreeNode.bind(this),sortOrder:"Ascending"}),this.treeObj.appendTo("#"+this.parentID+"tree")},e.prototype.drawTreeNode=function(e){var i=e.nodeData.field;e.node.setAttribute("data-field",i),e.node.setAttribute("data-caption",e.nodeData.caption),e.node.setAttribute("data-type",e.nodeData.type);var r=t.createElement("span",{attrs:{tabindex:"-1","aria-disabled":"false",title:this.parent.localeObj.getConstant("dragField")},className:b+" e-drag"});t.prepend([r],e.node.querySelector(".e-text-content")),t.append([e.node.querySelector("."+x)],e.node.querySelector(".e-text-content")),"number"!==this.parent.engineModule.fieldList[i].type&&this.parent.engineModule.fieldList[i].aggregateType!==de?t.removeClass([e.node.querySelector("."+x)],b):e.node.querySelector("."+x).setAttribute("title",this.parent.localeObj.getConstant("format")),this.parent.engineModule.fieldList[i].aggregateType===de&&(e.node.querySelector("."+x).setAttribute("title",this.parent.localeObj.getConstant("edit")),t.addClass([e.node.querySelector("."+x)],"e-edit"),t.removeClass([e.node.querySelector("."+x)],x))},e.prototype.createTypeContainer=function(e){for(var i=t.createElement("div",{id:this.parentID+"control_wrapper",className:"e-pivot-treeview-outer"}),r=["Sum","Count","Avg","Min","Max"],a=0;a<5;a++){var n=t.createElement("input",{id:this.parentID+"radio"+e+r[a],attrs:{type:"radio","data-ftxt":e},className:"e-pivot-calc-radio"});i.appendChild(n)}return i},e.prototype.getAccordionData=function(e){var t=this,i=[];return Object.keys(e.engineModule.fieldList).forEach(function(r,a){i.push({header:"<input id="+t.parentID+"_"+a+' class=e-pivot-calc-check type="checkbox" data-field='+r+" data-caption="+t.parent.engineModule.fieldList[r].caption+" data-type="+t.parent.engineModule.fieldList[r].type+"/>",content:e.engineModule.fieldList[r].aggregateType===de||"number"!==t.parent.engineModule.fieldList[r].type?"":t.createTypeContainer(r).outerHTML})}),i},e.prototype.renderMobileLayout=function(e){var t=this;e.items[4].content=this.renderDialogElements().outerHTML,e.dataBind();var i=new h.Button({cssClass:C,isPrimary:!0});if(i.appendTo("#"+this.parentID+"cancelBtn"),i.element&&(i.element.onclick=this.cancelBtnClick.bind(this)),null!==this.parent.dialogRenderer.parentElement.querySelector("."+w)&&this.parent.isAdaptive){var r=new h.Button({cssClass:C+" e-outline",isPrimary:!0});r.appendTo("#"+this.parentID+"okBtn"),this.inputObj=new s.MaskedTextBox({placeholder:this.parent.localeObj.getConstant("fieldName")}),this.inputObj.appendTo("#"+this.parentID+"ddlelement"),null!==this.formulaText&&null!==this.parent.dialogRenderer.parentElement.querySelector("#"+this.parentID+"droppable")&&(this.parent.dialogRenderer.parentElement.querySelector("#"+this.parentID+"droppable").value=this.formulaText),null!==this.fieldText&&null!==this.parent.dialogRenderer.parentElement.querySelector("."+S)&&(this.parent.dialogRenderer.parentElement.querySelector("."+S).value=this.fieldText,this.inputObj.value=this.fieldText),r.element&&(r.element.onclick=this.applyFormula.bind(this))}else if(this.parent.isAdaptive){var a=new l.Accordion({items:this.getAccordionData(this.parent),enableRtl:this.parent.enableRtl,expanding:function(e){0===e.element.querySelectorAll(".e-radio-wrapper").length&&Object.keys(t.parent.engineModule.fieldList).forEach(function(i){var r=["Sum","Count","Avg","Min","Max"];if(i===e.element.querySelector("[data-field").getAttribute("data-field"))for(var a=0;a<5;a++)new h.RadioButton({label:r[a],name:"AggregateType"+i,change:function(e){var t=e.event.target.parentElement.querySelector(".e-label").innerText,i=e.event.target.closest(".e-acrdn-item").querySelector("[data-field").getAttribute("data-caption");e.event.target.closest(".e-acrdn-item").querySelector(".e-label").innerText=i+" ("+t+")",e.event.target.closest(".e-acrdn-item").querySelector("[data-type").setAttribute("data-type",t)}}).appendTo("#"+t.parentID+"radio"+i+r[a])})}}),n=new h.Button({cssClass:C,isPrimary:!0});n.appendTo("#"+this.parentID+"addBtn"),a.appendTo("#"+this.parentID+"accordDiv"),Object.keys(this.parent.engineModule.fieldList).forEach(function(e,i){var r=null;r="string"===t.parent.engineModule.fieldList[e].type||"include"===t.parent.engineModule.fieldList[e].type||"exclude"===t.parent.engineModule.fieldList[e].type?"Count":void 0!==t.parent.engineModule.fieldList[e].aggregateType?t.parent.engineModule.fieldList[e].aggregateType:"Sum",new h.CheckBox({label:t.parent.engineModule.fieldList[e].caption+" ("+r+")"}).appendTo("#"+t.parentID+"_"+i),document.querySelector("#"+t.parentID+"_"+i).setAttribute("data-field",e),document.querySelector("#"+t.parentID+"_"+i).setAttribute("data-type",r)}),n.element&&(n.element.onclick=this.addBtnClick.bind(this))}},e.prototype.cancelBtnClick=function(){this.renderMobileLayout(this.parent.dialogRenderer.adaptiveElement)},e.prototype.addBtnClick=function(){for(var e=document.querySelectorAll(".e-accordion .e-check"),t="",i=null,r=null,a=0;a<e.length;a++)if(i=e[a].parentElement.querySelector("[data-field]").getAttribute("data-field"),-1===(r=e[a].parentElement.querySelector("[data-field]").getAttribute("data-type")).indexOf(de))t=t+'"'+r+"("+i+')"';else for(var n=0;n<this.parent.dataSource.calculatedFieldSettings.length;n++)if(this.parent.dataSource.calculatedFieldSettings[n].name===i){t+=this.parent.dataSource.calculatedFieldSettings[n].formula;break}this.formulaText=null!==this.formulaText?this.formulaText+t:t,this.renderMobileLayout(this.parent.dialogRenderer.adaptiveElement)},e.prototype.createCalculatedFieldDialog=function(){this.parent.isAdaptive&&"pivotfieldlist"===this.parent.getModuleName()?this.renderAdaptiveLayout():this.parent.isAdaptive||(this.renderDialogLayout(),this.dialog.element.style.top=parseInt(this.dialog.element.style.top,10)<0?"0px":this.dialog.element.style.top)},e.prototype.renderDialogLayout=function(){this.newFields=t.extend([],this.parent.dataSource.calculatedFieldSettings,null,!0),this.createDialog(),this.dialog.content=this.renderDialogElements(),this.dialog.refresh(),this.inputObj=new s.MaskedTextBox({placeholder:this.parent.localeObj.getConstant("fieldName")}),this.inputObj.appendTo("#"+this.parentID+"ddlelement"),this.createTreeView(),this.createMenu(),this.droppable=new t.Droppable(this.dialog.element.querySelector("#"+this.parentID+"droppable")),this.keyboardEvents=new t.KeyboardEvents(this.parent.calculatedFieldModule.dialog.element,{keyAction:this.keyActionHandler.bind(this),keyConfigs:{moveRight:"rightarrow",enter:"enter"},eventName:"keydown"})},e.prototype.createConfirmDialog=function(e,i){var a=t.createElement("div",{id:this.parentID+"_ErrorDialog",className:"e-pivot-error-dialog"});this.parent.element.appendChild(a),this.confirmPopUp=new r.Dialog({animationSettings:{effect:"Fade"},allowDragging:!1,showCloseIcon:!0,enableRtl:this.parent.enableRtl,width:"auto",height:"auto",position:{X:"center",Y:"center"},buttons:[{click:this.replaceFormula.bind(this),buttonModel:{cssClass:"e-ok-btn e-outline",content:this.parent.localeObj.getConstant("ok"),isPrimary:!0}},{click:this.removeErrorDialog.bind(this),buttonModel:{cssClass:"e-cancel-btn",content:this.parent.localeObj.getConstant("cancel"),isPrimary:!0}}],header:e,content:i,isModal:!0,visible:!0,closeOnEscape:!0,target:document.body,close:this.removeErrorDialog.bind(this)}),this.confirmPopUp.appendTo(a)},e.prototype.replaceFormula=function(){for(var e=this.parent.dataSource,t=document.querySelector("#"+this.parentID+"droppable"),i=0;i<e.values.length;i++)if(e.values[i].type===de&&e.values[i].name===this.inputObj.value)for(var r=0;r<e.calculatedFieldSettings.length;r++)e.calculatedFieldSettings[r].name===this.inputObj.value&&(e.calculatedFieldSettings[r].formula=t.value);this.addFormula(e,this.inputObj.value),this.removeErrorDialog()},e.prototype.removeErrorDialog=function(){document.getElementById(this.parentID+"_ErrorDialog")&&t.remove(document.getElementById(this.parentID+"_ErrorDialog").parentElement)},e.prototype.addEventListener=function(){this.parent.isDestroyed||this.parent.on("init-calculatedfield",this.createCalculatedFieldDialog,this)},e.prototype.removeEventListener=function(){this.parent.isDestroyed||this.parent.off("init-calculatedfield",this.createCalculatedFieldDialog)},e.prototype.destroy=function(){this.removeEventListener()},e}();se.Inject(pe);var he=function(){function e(e){this.parent=e,this.addEventListener()}return e.prototype.getModuleName=function(){return"fieldlist"},e.prototype.initiateModule=function(){this.element=t.createElement("div",{id:this.parent.element.id+"_PivotFieldList",styles:"position:"+(this.parent.enableRtl?"static":"absolute")+";height:0;width:"+this.parent.element.style.width}),this.parent.element.parentElement.setAttribute("id","ContainerWrapper"),this.parent.element.parentElement.appendChild(this.element),this.parent.element.parentElement.appendChild(this.parent.element),this.parent.pivotFieldListModule=new se({dataSource:{rows:[],columns:[],values:[],filters:[]},renderMode:"Popup",allowCalculatedField:this.parent.allowCalculatedField,enableRtl:this.parent.enableRtl,locale:this.parent.locale,target:this.parent.element.parentElement}),this.parent.pivotFieldListModule.appendTo("#"+this.element.id)},e.prototype.updateControl=function(){var e=this;this.element&&(t.prepend([this.element],this.parent.element),this.parent.grid&&this.parent.showGroupingBar&&this.parent.groupingBarModule?(clearTimeout(this.timeOutObj),this.timeOutObj=setTimeout(function(){e.parent.grid&&e.parent.grid.element&&(t.setStyleAttribute(e.element.querySelector(".e-toggle-field-list"),{left:t.formatUnit(e.parent.enableRtl?-Math.abs((e.parent.isAdaptive?500:e.parent.grid.element.offsetWidth)-e.element.querySelector(".e-toggle-field-list").offsetWidth):(e.parent.isAdaptive?500:e.parent.grid.element.offsetWidth)-e.element.querySelector(".e-toggle-field-list").offsetWidth)}),e.parent.enableRtl?t.addClass([e.element.querySelector(".e-toggle-field-list")],"e-fieldlist-left"):t.removeClass([e.element.querySelector(".e-toggle-field-list")],"e-fieldlist-left"))})):this.parent.enableRtl?t.removeClass([this.element.querySelector(".e-toggle-field-list")],"e-fieldlist-left"):t.addClass([this.element.querySelector(".e-toggle-field-list")],"e-fieldlist-left"),t.setStyleAttribute(this.element,{width:t.formatUnit(this.parent.element.offsetWidth)})),this.parent.pivotFieldListModule.update(this.parent)},e.prototype.addEventListener=function(){this.handlers={load:this.initiateModule,update:this.updateControl},this.parent.isDestroyed||(this.parent.on("init-groupingbar",this.handlers.load,this),this.parent.on(m,this.handlers.update,this))},e.prototype.removeEventListener=function(){this.parent.isDestroyed||(this.parent.off("init-groupingbar",this.handlers.load),this.parent.off(m,this.handlers.update))},e.prototype.destroy=function(){this.removeEventListener(),this.parent.pivotFieldListModule&&this.parent.pivotFieldListModule.destroy()},e}(),ce=function(){function e(e){this.parent=e,this.parent.commonModule=this,this.addEventListener()}return e.prototype.getModuleName=function(){return"common"},e.prototype.initiateCommonModule=function(){if(this.parent.pivotCommon)this.parent.pivotCommon.element=this.parent.element,this.parent.pivotCommon.engineModule=this.parent.engineModule,this.parent.pivotCommon.parentID=this.parent.element.id,this.parent.pivotCommon.dataSource=this.parent.dataSource.properties?this.parent.dataSource.properties:this.parent.dataSource,this.parent.pivotCommon.moduleName=this.parent.getModuleName(),this.parent.pivotCommon.enableRtl=this.parent.enableRtl,this.parent.pivotCommon.isAdaptive=t.Browser.isDevice,this.parent.pivotCommon.renderMode="Popup",this.parent.pivotCommon.localeObj=this.parent.localeObj;else{var e={pivotEngine:this.parent.engineModule,dataSource:this.parent.dataSource.properties?this.parent.dataSource.properties:this.parent.dataSource,id:this.parent.element.id,element:this.parent.element,moduleName:this.parent.getModuleName(),enableRtl:this.parent.enableRtl,isAdaptive:t.Browser.isDevice,renderMode:"Popup",localeObj:this.parent.localeObj};this.parent.pivotCommon=new J(e)}},e.prototype.addEventListener=function(){this.handlers={load:this.initiateCommonModule},this.parent.isDestroyed||this.parent.on(m,this.handlers.load,this)},e.prototype.removeEventListener=function(){this.parent.isDestroyed||this.parent.off(m,this.handlers.load)},e.prototype.destroy=function(){this.removeEventListener(),this.parent.pivotCommon&&this.parent.pivotCommon.destroy()},e}(),ue=function(){function e(e){this.parent=e}return e.prototype.render=function(){this.pivotButton=new re(this.parent),this.createPivotButtons();for(var e=[].slice.call(this.parent.element.querySelector(".e-group-rows").querySelectorAll(".e-pvt-btn-div")),i=e.length,r=0;r<i;r++){var a=t.createElement("span",{className:"e-indent-div",styles:"width:"+24*r+"px"});t.prepend([a],e[r])}},e.prototype.createPivotButtons=function(){var e=[this.parent.dataSource.rows,this.parent.dataSource.columns,this.parent.dataSource.values,this.parent.dataSource.filters];this.parent.element.querySelector(".e-group-rows").innerHTML="",this.parent.element.querySelector(".e-group-columns").innerHTML="",this.parent.element.querySelector(".e-group-values").innerHTML="",this.parent.element.querySelector(".e-group-filters").innerHTML="";for(var t=["rows","columns","values","filters"],i=0,r=e.length;i<r;i++)if(e[i]){var a={field:e[i],axis:t[i].toString()};this.parent.notify("pivot-button-update",a)}},e}();_.Inject(ce);var me=function(){function e(e){this.parent=e,this.parent.groupingBarModule=this,this.addEventListener(),this.parent.axisFieldModule=new ue(this.parent),this.touchObj=new t.Touch(this.parent.element,{tapHold:this.tapHoldHandler.bind(this)})}return e.prototype.getModuleName=function(){return"grouping"},e.prototype.renderLayout=function(){this.groupingTable=t.createElement("div",{className:"e-grouping-bar"}),this.leftAxisPanel=t.createElement("div",{className:"e-left-axis-fields"}),this.rightAxisPanel=t.createElement("div",{className:"e-right-axis-fields"});var e=t.createElement("div",{className:"e-axis-row e-axiswrapper"}),i=t.createElement("div",{className:"e-axis-column e-axiswrapper"}),r=t.createElement("div",{className:"e-axis-value e-axiswrapper"}),a=t.createElement("div",{className:"e-axis-filter e-axiswrapper"});this.rowPanel=t.createElement("div",{className:"e-group-rows e-rows"}),this.columnPanel=t.createElement("div",{className:"e-group-columns e-columns"}),this.valuePanel=t.createElement("div",{className:"e-group-values e-values"}),this.filterPanel=t.createElement("div",{className:"e-group-filters e-filters"}),e.appendChild(this.rowPanel),i.appendChild(this.columnPanel),r.appendChild(this.valuePanel),a.appendChild(this.filterPanel),this.rowAxisPanel=e,this.columnAxisPanel=i,this.valueAxisPanel=r,this.filterAxisPanel=a,this.leftAxisPanel.appendChild(r),this.leftAxisPanel.appendChild(e),this.rightAxisPanel.appendChild(a),this.rightAxisPanel.appendChild(i),this.groupingTable.appendChild(this.leftAxisPanel),this.groupingTable.appendChild(this.rightAxisPanel);for(var n=0,o=[this.rowPanel,this.columnPanel,this.valuePanel,this.filterPanel];n<o.length;n++){var l=o[n];new t.Droppable(l,{}),this.unWireEvent(l),this.wireEvent(l)}},e.prototype.appendToElement=function(){this.parent.element.querySelector(".e-grouping-bar")&&t.remove(this.parent.element.querySelector(".e-grouping-bar"));var e=this.parent.element.querySelector(".e-frozenheader").querySelector("colgroup").children[0];if(this.filterPanel.removeAttribute("style"),this.columnPanel.removeAttribute("style"),this.rowPanel.removeAttribute("style"),this.filterPanel.removeAttribute("style"),Object.keys(this.parent.engineModule.headerContent).length){var i=this.parent.element.querySelector(".e-frozenheader").querySelector(".e-columnheader");t.addClass([i],"e-row"),i.removeAttribute("style"),t.addClass([i.querySelector(".e-headercell")],"e-group-row"),i.querySelector(".e-group-row").appendChild(this.rowAxisPanel),i.querySelector(".e-group-row").querySelector(".e-headercelldiv").style.display="none",i.querySelector(".e-group-row").querySelector(".e-sortfilterdiv").style.display="none"}t.prepend([this.groupingTable],this.parent.element),t.setStyleAttribute(this.groupingTable,{width:t.formatUnit(this.parent.isAdaptive?500:this.parent.grid.width)}),this.parent.axisFieldModule.render(),this.setGridRowWidth();var r=t.formatUnit(this.groupingTable.offsetWidth-parseInt(e.style.width,10));t.setStyleAttribute(this.valuePanel,{width:e.style.width}),t.setStyleAttribute(this.rightAxisPanel,{width:r});var a=this.valuePanel.offsetHeight/2;a>this.columnPanel.offsetHeight&&(t.setStyleAttribute(this.filterPanel,{height:t.formatUnit(a)}),t.setStyleAttribute(this.columnPanel,{height:t.formatUnit(a+1)}));var n=this.parent.element.querySelector(".e-headercontent").offsetHeight;t.setStyleAttribute(this.rowPanel,{height:n+"px"}),this.parent.element.querySelector(".e-frozenheader").querySelector(".e-rhandler").style.height=n+"px";for(var o=[].slice.call(this.parent.element.querySelector(".e-movableheader").querySelector("thead").querySelectorAll("tr")).filter(function(e){return e.childNodes.length>0}),l=n/o.length,s=0,d=o;s<d.length;s++){var p=d[s];t.setStyleAttribute(p,{height:l+"px"});for(var h=0,c=[].slice.call(p.querySelectorAll(".e-rhandler"));h<c.length;h++){var u=c[h];t.setStyleAttribute(u,{height:l+"px"})}}},e.prototype.refreshUI=function(){var e=this;t.setStyleAttribute(this.groupingTable,{width:t.formatUnit(this.parent.isAdaptive?500:this.parent.grid.width)});var i=this.parent.element.querySelector(".e-frozenheader").querySelector("colgroup").children[0],r=t.formatUnit(this.groupingTable.offsetWidth-parseInt(i.style.width,10));if(t.setStyleAttribute(this.valuePanel,{width:i.style.width}),t.setStyleAttribute(this.rightAxisPanel,{width:r}),this.parent.showFieldList&&this.parent.pivotFieldListModule&&this.parent.pivotFieldListModule.element){var a=this.parent.pivotFieldListModule.element;clearTimeout(this.timeOutObj),this.timeOutObj=setTimeout(function(){t.setStyleAttribute(a.querySelector(".e-toggle-field-list"),{left:t.formatUnit(e.parent.enableRtl?-Math.abs((e.parent.isAdaptive?500:e.parent.grid.element.offsetWidth)-a.querySelector(".e-toggle-field-list").offsetWidth):(e.parent.isAdaptive?500:e.parent.grid.element.offsetWidth)-a.querySelector(".e-toggle-field-list").offsetWidth)})})}if(!this.parent.grid.element.querySelector(".e-group-row")){var n=this.parent.element.querySelector(".e-frozenheader").querySelector(".e-columnheader");t.addClass([n],"e-row"),t.addClass([n.querySelector(".e-headercell")],"e-group-row"),n.querySelector(".e-group-row").appendChild(this.rowAxisPanel),t.setStyleAttribute(n.querySelector(".e-group-row").querySelector(".e-headercelldiv"),{display:"none"}),t.setStyleAttribute(n.querySelector(".e-group-row").querySelector(".e-sortfilterdiv"),{display:"none"});var o=this.parent.element.querySelector(".e-headercontent").offsetHeight;t.setStyleAttribute(this.rowPanel,{height:o+"px"}),this.parent.element.querySelector(".e-frozenheader").querySelector(".e-rhandler").style.height=o+"px";for(var l=[].slice.call(this.parent.element.querySelector(".e-movableheader").querySelector("thead").querySelectorAll("tr")).filter(function(e){return e.childNodes.length>0}),s=o/l.length,d=0,p=l;d<p.length;d++){var h=p[d];t.setStyleAttribute(h,{height:s+"px"});for(var c=0,u=[].slice.call(h.querySelectorAll(".e-rhandler"));c<u.length;c++){var m=u[c];t.setStyleAttribute(m,{height:s+"px"})}}}},e.prototype.setGridRowWidth=function(){var e=this.parent.element.querySelector(".e-frozenheader").querySelector("colgroup").children[0];if(this.rowPanel.querySelector(".e-pivot-button")&&!this.parent.isAdaptive){var i=[].slice.call(this.rowPanel.querySelectorAll(".e-pvt-btn-div")),r=i[i.length-1],a=r.querySelector(".e-pivot-button").offsetWidth+r.querySelector(".e-indent-div").offsetWidth+20,n=t.formatUnit(a<250?250:a),o=this.parent.element.querySelector(".e-frozenheader").querySelector("table"),l=this.parent.element.querySelector(".e-frozencontent").querySelector("table"),s=this.parent.element.querySelector(".e-frozencontent").querySelector("colgroup").children[0],d=parseInt(n,10),p=this.parent.grid.columns;p&&p.length>0&&(p[0].width=(p[0].width,d>250?d:250));for(var h=this.parent.renderModule.calculateColWidth(this.parent.dataSource.values.length>0?this.parent.engineModule.pivotValues[0].length:2),c=0;c<p.length;c++)0!==c&&(p[c].columns?this.setColWidth(p[c].columns,h):p[c].width=h);this.parent.grid.headerModule.refreshUI(),e.style.width=n,s.style.width=n,o.style.width=n,l.style.width=n,t.setStyleAttribute(o,{width:n}),t.setStyleAttribute(l,{width:n})}this.refreshUI()},e.prototype.setColWidth=function(e,t){for(var i=0;i<e.length;i++)e[i].columns?this.setColWidth(e[i].columns,t):e[i].width=t},e.prototype.wireEvent=function(e){t.EventHandler.add(e,"mouseover",this.dropIndicatorUpdate,this),t.EventHandler.add(e,"mouseleave",this.dropIndicatorUpdate,this)},e.prototype.unWireEvent=function(e){t.EventHandler.remove(e,"mouseover",this.dropIndicatorUpdate),t.EventHandler.remove(e,"mouseleave",this.dropIndicatorUpdate)},e.prototype.dropIndicatorUpdate=function(e){(this.parent.isDragging&&e.target.classList.contains("e-droppable")&&"mouseover"===e.type||"mouseleave"===e.type)&&(t.removeClass([].slice.call(this.parent.element.querySelectorAll(".e-drop-indicator")),"e-drop-hover"),t.removeClass([].slice.call(this.parent.element.querySelectorAll(".e-drop-indicator-last")),"e-drop-hover"))},e.prototype.tapHoldHandler=function(e){var i=t.closest(e.originalEvent.target,".e-pivot-button");if(!t.isNullOrUndefined(i)&&this.parent.isAdaptive){var r=i.getBoundingClientRect();return this.parent.contextMenuModule.fieldElement=i,void this.parent.contextMenuModule.menuObj.open(r.top,r.left)}},e.prototype.addEventListener=function(){this.handlers={load:this.renderLayout,end:this.appendToElement},this.parent.isDestroyed||(this.parent.on("init-groupingbar",this.handlers.load,this),this.parent.on(m,this.handlers.end,this))},e.prototype.removeEventListener=function(){this.parent.isDestroyed||(this.parent.off("init-groupingbar",this.handlers.end),this.parent.off(m,this.handlers.load))},e.prototype.destroy=function(){this.removeEventListener(),this.parent.pivotButtonModule&&(this.parent.pivotButtonModule.destroy(),this.touchObj&&!this.touchObj.isDestroyed&&this.touchObj.destroy())},e}(),ge=function(){function e(e){this.parent=e,this.parent.conditionalFormattingModule=this,this.parentID=this.parent.element.id,this.dialog=null,this.fieldsDropDown=[],this.conditionsDropDown=[],this.fontNameDropDown=[],this.fontSizeDropDown=[],this.fontColor=[],this.backgroundColor=[],this.newFormat=[]}return e.prototype.getModuleName=function(){return"conditionalformatting"},e.prototype.createDialog=function(){var e=this;null!==document.querySelector("#"+this.parentID+"conditionalformatting")&&t.remove(document.querySelector("#"+this.parentID+"conditionalformatting")),this.parent.element.appendChild(t.createElement("div",{id:this.parentID+"conditionalformatting"}));var i=[{click:function(){var t={conditions:"LessThan",value1:0,style:{backgroundColor:"white",color:"black",fontFamily:"Arial",fontSize:"12px"}};e.refreshConditionValues(),e.newFormat.push(t),e.addFormat()},buttonModel:{cssClass:this.parent.isAdaptive?"e-small e-round e-format-condition-button":"e-format-condition-button",iconCss:b+" e-add-icon",content:this.parent.isAdaptive?"":this.parent.localeObj.getConstant("condition")}},{click:function(){e.refreshConditionValues(),e.parent.setProperties({dataSource:{conditionalFormatSettings:e.newFormat}},!0),e.parent.renderPivotGrid(),e.destroy()},buttonModel:{cssClass:"e-flat e-primary e-format-apply-button",content:this.parent.localeObj.getConstant("apply")}},{click:function(){e.destroy(),e.newFormat=[]},buttonModel:{cssClass:"e-flat e-primary e-format-cancel-button",content:this.parent.localeObj.getConstant("cancel")}}];this.parent.isAdaptive?this.dialog=new r.Dialog({animationSettings:{effect:"Zoom"},isModal:!0,width:"100%",height:"100%",showCloseIcon:!1,closeOnEscape:!1,enableRtl:this.parent.enableRtl,position:{X:"center",Y:"center"},allowDragging:!0,buttons:i,beforeOpen:function(t){e.dialog.element.querySelector(".e-dlg-header").setAttribute("title",e.parent.localeObj.getConstant("conditionalFormating"))},cssClass:"e-pivot-formatting-dialog",header:this.parent.localeObj.getConstant("conditionalFormating"),target:document.body}):this.dialog=new r.Dialog({allowDragging:!0,position:{X:"center",Y:this.parent.element.offsetTop},buttons:i,beforeOpen:function(t){e.dialog.element.querySelector(".e-dlg-header").setAttribute("title",e.parent.localeObj.getConstant("conditionalFormating"))},cssClass:"e-pivot-formatting-dialog",isModal:!1,closeOnEscape:!0,enableRtl:this.parent.enableRtl,showCloseIcon:!0,header:this.parent.localeObj.getConstant("conditionalFormating"),target:this.parent.element}),this.dialog.appendTo("#"+this.parentID+"conditionalformatting")},e.prototype.refreshConditionValues=function(){for(var e=0;e<this.newFormat.length;e++)this.newFormat[e].value1=Number(document.querySelector("#"+this.parentID+"conditionvalue1"+e).value),this.newFormat[e].value2=Number(document.querySelector("#"+this.parentID+"conditionvalue2"+e).value)},e.prototype.addFormat=function(){for(var e=t.createElement("div",{id:this.parentID+"formatDiv",className:"e-new-format"}),i=0;i<this.newFormat.length;i++)e.appendChild(this.createDialogElements(i));this.dialog.setProperties({content:e},!1);for(i=0;i<this.newFormat.length;i++)this.renderDropDowns(i),this.renderColorPicker(i)},e.prototype.createDialogElements=function(e){var i=this.newFormat[e],r=t.createElement("div",{id:this.parentID+"outerDiv"+e,className:"e-format-outer-div"}),a=t.createElement("button",{id:this.parentID+"removeButton"+e,className:"e-format-delete-button",attrs:{title:this.parent.localeObj.getConstant("delete")}});r.appendChild(a);var n=t.createElement("div",{id:this.parentID+"innerDiv",className:"e-format-inner-div"}),o=t.createElement("table",{id:this.parentID+"cftable",className:"e-format-table"}),l=t.createElement("tr"),s=t.createElement("td"),d=t.createElement("span",{id:this.parentID+"valuelabel"+e,className:"e-format-value-label",innerHTML:this.parent.localeObj.getConstant("value")});s.appendChild(d),l.appendChild(s),o.appendChild(l),l=t.createElement("tr"),s=t.createElement("td");var p=t.createElement("div",{id:this.parentID+"measure"+e}),h=t.createElement("input",{id:this.parentID+"measureinput"+e,attrs:{type:"text",tabindex:"1"}});p.appendChild(h),s.appendChild(p),l.appendChild(s),s=t.createElement("td");var c=t.createElement("div",{id:this.parentID+"condition"}),u=t.createElement("input",{id:this.parentID+"conditioninput"+e,attrs:{type:"text",tabindex:"1"}});c.appendChild(u),s.appendChild(c),l.appendChild(s),s=t.createElement("td");var m="Between"!==i.conditions&&"NotBetween"!==i.conditions?"display:none; width:10px":"",g=t.createElement("input",{id:this.parentID+"conditionvalue1"+e,attrs:{type:"text",tabindex:"1",value:t.isNullOrUndefined(i.value1)?"0":i.value1.toString()},styles:this.parent.isAdaptive?""===m?"width: 28%":"width: 100%":""===m?"width: 45px":"width: 120px",className:"e-input e-format-value1"});s.appendChild(g);var v=t.createElement("span",{id:this.parentID+"valuespan"+e,className:"e-format-value-span",innerHTML:"&",styles:m});s.appendChild(v);var f=t.createElement("input",{id:this.parentID+"conditionvalue2"+e,attrs:{type:"text",tabindex:"1",value:t.isNullOrUndefined(i.value2)?"0":i.value2.toString()},styles:this.parent.isAdaptive&&""===m?"width: 28%":""===m?"width: 45px":m,className:"e-input e-format-value2"});s.appendChild(f),l.appendChild(s),o.appendChild(l),this.parent.isAdaptive&&(n.appendChild(o),o=t.createElement("table",{id:this.parentID+"cftable",className:"e-format-table"})),l=t.createElement("tr"),s=t.createElement("td");var y=t.createElement("span",{id:this.parentID+"formatlabel"+e,className:"e-format-label",innerHTML:this.parent.localeObj.getConstant("formatLabel")});s.appendChild(y),l.appendChild(s),o.appendChild(l),l=t.createElement("tr"),s=t.createElement("td");var b=t.createElement("div",{id:this.parentID+"fontname"}),S=t.createElement("input",{id:this.parentID+"fontnameinput"+e,attrs:{type:"text",tabindex:"1"}});b.appendChild(S),s.appendChild(b),l.appendChild(s),s=t.createElement("td");var C=t.createElement("div",{id:this.parentID+"fontsize"}),x=t.createElement("input",{id:this.parentID+"fontsizeinput"+e,attrs:{type:"text",tabindex:"1"}});C.appendChild(x),s.appendChild(C),l.appendChild(s),this.parent.isAdaptive&&(o.appendChild(l),l=t.createElement("tr"),o.appendChild(l),l=t.createElement("tr")),s=t.createElement("td");var w=t.createElement("input",{id:this.parentID+"fontcolor"+e,attrs:{type:"color",tabindex:"1"},className:"e-format-font-color"});s.appendChild(w);var E=t.createElement("input",{id:this.parentID+"backgroundcolor"+e,attrs:{type:"color",tabindex:"1"},className:"e-format-back-color"});s.appendChild(E),l.appendChild(s),s=t.createElement("td");var D=t.createElement("div",{id:this.parentID+"valuepreview"+e,className:"e-input e-format-value-preview",innerHTML:"123.45"});return s.appendChild(D),l.appendChild(s),o.appendChild(l),n.appendChild(o),r.appendChild(n),r},e.prototype.renderDropDowns=function(e){var i=this,r=this.newFormat[e],a=[];a.push({index:0,name:this.parent.localeObj.getConstant("AllValues"),field:this.parent.localeObj.getConstant("AllValues")});for(var n=0;n<this.parent.dataSource.values.length;n++)a.push({index:n+1,name:this.parent.dataSource.values[n].caption||this.parent.dataSource.values[n].name,field:this.parent.dataSource.values[n].name});var o=t.isNullOrUndefined(r.measure)?this.parent.localeObj.getConstant("AllValues"):r.measure;this.fieldsDropDown[e]=new d.DropDownList({dataSource:a,fields:{text:"name"},value:o,width:this.parent.isAdaptive?"100%":"120px",popupHeight:"200px",change:function(t){i.newFormat[e].measure=t.value.toString()===i.parent.localeObj.getConstant("AllValues")?void 0:t.value.toString()}}),this.fieldsDropDown[e].appendTo("#"+this.parentID+"measureinput"+e);var l=[{value:"LessThan",name:this.parent.localeObj.getConstant("LessThan")},{value:"LessThanOrEqualTo",name:this.parent.localeObj.getConstant("LessThanOrEqualTo")},{value:"GreaterThan",name:this.parent.localeObj.getConstant("GreaterThan")},{value:"GreaterThanOrEqualTo",name:this.parent.localeObj.getConstant("GreaterThanOrEqualTo")},{value:"Equals",name:this.parent.localeObj.getConstant("Equals")},{value:"NotEquals",name:this.parent.localeObj.getConstant("NotEquals")},{value:"Between",name:this.parent.localeObj.getConstant("Between")},{value:"NotBetween",name:this.parent.localeObj.getConstant("NotBetween")}];o=t.isNullOrUndefined(r.conditions)?"LessThan":r.conditions,this.conditionsDropDown[e]=new d.DropDownList({dataSource:l,fields:{value:"value",text:"name"},value:o,width:this.parent.isAdaptive?"100%":"120px",popupHeight:"200px",popupWidth:"200px",change:function(t){i.newFormat[e].conditions=t.value,"Between"===t.value||"NotBetween"===t.value?(document.querySelector("#"+i.parentID+"valuespan"+e).style.display="inline-block",document.querySelector("#"+i.parentID+"valuespan"+e).style.width=i.parent.isAdaptive?"10%":"10px",document.querySelector("#"+i.parentID+"conditionvalue2"+e).style.display="inline-block",document.querySelector("#"+i.parentID+"conditionvalue2"+e).style.width=i.parent.isAdaptive?"28%":"45px",document.querySelector("#"+i.parentID+"conditionvalue1"+e).style.width=i.parent.isAdaptive?"28%":"45px"):(document.querySelector("#"+i.parentID+"valuespan"+e).style.display="none",document.querySelector("#"+i.parentID+"conditionvalue2"+e).style.display="none",document.querySelector("#"+i.parentID+"conditionvalue1"+e).style.width=i.parent.isAdaptive?"100%":"120px")}}),this.conditionsDropDown[e].appendTo("#"+this.parentID+"conditioninput"+e);var s=[{index:0,name:"Arial"},{index:1,name:"San Serif"},{index:2,name:"Impact"},{index:3,name:"Trebuchet MS"},{index:4,name:"Serif"},{index:5,name:"Verdana"},{index:6,name:"Courier New"},{index:7,name:"Times New Roman"},{index:8,name:"Tahoma"},{index:9,name:"Gerogia"}];o=t.isNullOrUndefined(r.style.fontFamily)?"Arial":r.style.fontFamily,this.fontNameDropDown[e]=new d.DropDownList({dataSource:s,fields:{text:"name"},value:o,width:this.parent.isAdaptive?"100%":"120px",popupWidth:"150px",popupHeight:"200px",change:function(t){i.newFormat[e].style.fontFamily=t.value.toString(),document.querySelector("#"+i.parentID+"valuepreview"+e).style.fontFamily=t.value}}),this.fontNameDropDown[e].appendTo("#"+this.parentID+"fontnameinput"+e);var p=[{index:0,name:"9px"},{index:1,name:"10px"},{index:2,name:"11px"},{index:3,name:"12px"},{index:4,name:"13px"},{index:5,name:"14px"},{index:6,name:"15px"},{index:6,name:"16px"}];o=t.isNullOrUndefined(r.style.fontSize)?"12px":r.style.fontSize,this.fontSizeDropDown[e]=new d.DropDownList({dataSource:p,fields:{text:"name"},popupHeight:"200px",value:o,width:this.parent.isAdaptive?"100%":"120px",change:function(t){i.newFormat[e].style.fontSize=t.value.toString(),document.querySelector("#"+i.parentID+"valuepreview"+e).style.fontSize=t.value}}),this.fontSizeDropDown[e].appendTo("#"+this.parentID+"fontsizeinput"+e)},e.prototype.renderColorPicker=function(e){var i=this,r=this.newFormat[e],a=t.isNullOrUndefined(r.style.color)?"black":r.style.color,n=this.isHex(a.substr(1))?a:this.colourNameToHex(a);document.querySelector("#"+this.parentID+"valuepreview"+e).style.color=n,this.fontColor[e]=new s.ColorPicker({cssClass:"e-format-color-picker",value:n,mode:"Palette",change:function(t){i.newFormat[e].style.color=t.currentValue.hex,document.querySelector("#"+i.parentID+"valuepreview"+e).style.color=t.currentValue.hex}}),this.fontColor[e].appendTo("#"+this.parentID+"fontcolor"+e),t.addClass([this.fontColor[e].element.nextElementSibling.querySelector(".e-selected-color")],b),a=t.isNullOrUndefined(r.style.backgroundColor)?"white":r.style.backgroundColor,n=this.isHex(a.substr(1))?a:this.colourNameToHex(a),document.querySelector("#"+this.parentID+"valuepreview"+e).style.backgroundColor=n,document.querySelector("#"+this.parentID+"valuepreview"+e).style.fontFamily=r.style.fontFamily,document.querySelector("#"+this.parentID+"valuepreview"+e).style.fontSize=r.style.fontSize,this.backgroundColor[e]=new s.ColorPicker({cssClass:"e-format-color-picker",value:n,mode:"Palette",change:function(t){i.newFormat[e].style.backgroundColor=t.currentValue.hex,document.querySelector("#"+i.parentID+"valuepreview"+e).style.backgroundColor=t.currentValue.hex}}),this.backgroundColor[e].appendTo("#"+this.parentID+"backgroundcolor"+e),t.addClass([this.backgroundColor[e].element.nextElementSibling.querySelector(".e-selected-color")],b);var o=new h.Button({iconCss:b+" e-format-delete-icon",cssClass:C});o.appendTo("#"+this.parentID+"removeButton"+e),o.element.onclick=function(){i.newFormat.splice(e,1),i.addFormat()}},e.prototype.isHex=function(e){for(var t=parseInt(e,16);"0"===e.charAt(0);)e=e.substr(1);return t.toString(16)===e.toLowerCase()||0===t&&""===e},e.prototype.hexToRgb=function(e){var t=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(e);return t?{r:parseInt(t[1],16),g:parseInt(t[2],16),b:parseInt(t[3],16)}:null},e.prototype.colourNameToHex=function(e){var t={aliceblue:"#f0f8ff",antiquewhite:"#faebd7",aqua:"#00ffff",aquamarine:"#7fffd4",azure:"#f0ffff",beige:"#f5f5dc",bisque:"#ffe4c4",black:"#000000",blanchedalmond:"#ffebcd",blue:"#0000ff",blueviolet:"#8a2be2",brown:"#a52a2a",burlywood:"#deb887",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkgray:"#a9a9a9",darkgreen:"#006400",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkseagreen:"#8fbc8f",darkslateblue:"#483d8b",darkslategray:"#2f4f4f",darkturquoise:"#00ced1",darkviolet:"#9400d3",deeppink:"#ff1493",deepskyblue:"#00bfff",dimgray:"#696969",dodgerblue:"#1e90ff",firebrick:"#b22222",floralwhite:"#fffaf0",forestgreen:"#228b22",fuchsia:"#ff00ff",gainsboro:"#dcdcdc",ghostwhite:"#f8f8ff",gold:"#ffd700",goldenrod:"#daa520",gray:"#808080",green:"#008000",greenyellow:"#adff2f",honeydew:"#f0fff0",hotpink:"#ff69b4","indianred ":"#cd5c5c",indigo:"#4b0082",ivory:"#fffff0",khaki:"#f0e68c",lavender:"#e6e6fa",lavenderblush:"#fff0f5",lawngreen:"#7cfc00",lemonchiffon:"#fffacd",lightblue:"#add8e6",lightcoral:"#f08080",lightcyan:"#e0ffff",lightgoldenrodyellow:"#fafad2",lightgrey:"#d3d3d3",lightgreen:"#90ee90",lightpink:"#ffb6c1",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",lightskyblue:"#87cefa",lightslategray:"#778899",lightsteelblue:"#b0c4de",lightyellow:"#ffffe0",lime:"#00ff00",limegreen:"#32cd32",linen:"#faf0e6",magenta:"#ff00ff",maroon:"#800000",mediumaquamarine:"#66cdaa",mediumblue:"#0000cd",mediumorchid:"#ba55d3",mediumpurple:"#9370d8",mediumseagreen:"#3cb371",mediumslateblue:"#7b68ee",mediumspringgreen:"#00fa9a",mediumturquoise:"#48d1cc",mediumvioletred:"#c71585",midnightblue:"#191970",mintcream:"#f5fffa",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",navajowhite:"#ffdead",navy:"#000080",oldlace:"#fdf5e6",olive:"#808000",olivedrab:"#6b8e23",orange:"#ffa500",orangered:"#ff4500",orchid:"#da70d6",palegoldenrod:"#eee8aa",palegreen:"#98fb98",paleturquoise:"#afeeee",palevioletred:"#d87093",papayawhip:"#ffefd5",peachpuff:"#ffdab9",peru:"#cd853f",pink:"#ffc0cb",plum:"#dda0dd",powderblue:"#b0e0e6",purple:"#800080",rebeccapurple:"#663399",red:"#ff0000",rosybrown:"#bc8f8f",royalblue:"#4169e1",saddlebrown:"#8b4513",salmon:"#fa8072",sandybrown:"#f4a460",seagreen:"#2e8b57",seashell:"#fff5ee",sienna:"#a0522d",silver:"#c0c0c0",skyblue:"#87ceeb",slateblue:"#6a5acd",slategray:"#708090",snow:"#fffafa",springgreen:"#00ff7f",steelblue:"#4682b4",tan:"#d2b48c",teal:"#008080",thistle:"#d8bfd8",tomato:"#ff6347",turquoise:"#40e0d0",violet:"#ee82ee",wheat:"#f5deb3",white:"#ffffff",whitesmoke:"#f5f5f5",yellow:"#ffff00",yellowgreen:"#9acd32"};return void 0!==t[e.toLowerCase()]?t[e.toLowerCase()]:"#d5d5d5"},e.prototype.showConditionalFormattingDialog=function(){this.newFormat=[];for(var e=0;e<this.parent.dataSource.conditionalFormatSettings.length;e++)this.newFormat.push(t.extend({},this.parent.dataSource.conditionalFormatSettings[e].properties,null,!0));this.createDialog(),this.dialog.refresh(),this.addFormat()},e.prototype.destroy=function(){if(this.dialog&&!this.dialog.isDestroyed){this.dialog.hide();for(var e=0;e<this.newFormat.length;e++)this.fontColor[e]&&!this.fontColor[e].isDestroyed&&this.fontColor[e].destroy(),this.backgroundColor[e]&&!this.backgroundColor[e].isDestroyed&&this.backgroundColor[e].destroy();this.dialog.destroy()}},e}();return e.GroupingBarSettings=U,e.PivotView=_,e.Render=E,e.ExcelExport=V,e.PDFExport=B,e.KeyboardInteraction=R,e.VirtualScroll=z,e.PivotFieldList=se,e.TreeViewRenderer=te,e.AxisFieldRenderer=ae,e.AxisTableRenderer=ie,e.DialogRenderer=ee,e.EventBase=Y,e.NodeStateModified=K,e.DataSourceUpdate=X,e.FieldList=he,e.CommonKeyboardInteraction=Q,e.GroupingBar=me,e.CalculatedField=pe,e.ConditionalFormatting=ge,e.PivotCommon=J,e.load="load",e.enginePopulating="enginePopulating",e.enginePopulated="enginePopulated",e.beforePivotTableRender="beforePivotTableRender",e.afterPivotTableRender="afterPivotTableRender",e.beforeExport="beforeExport",e.excelHeaderQueryCellInfo="excelHeaderQueryCellInfo",e.pdfHeaderQueryCellInfo="pdfHeaderQueryCellInfo",e.excelQueryCellInfo="excelQueryCellInfo",e.pdfQueryCellInfo="pdfQueryCellInfo",e.dataBound="dataBound",e.queryCellInfo="queryCellInfo",e.headerCellInfo="headerCellInfo",e.resizing="resizing",e.resizeStop="resizeStop",e.cellClick="cellClick",e.initialLoad="initial-load",e.uiUpdate=m,e.scroll="scroll",e.contentReady="content-ready",e.dataReady=g,e.initSubComponent="init-groupingbar",e.treeViewUpdate="tree-view-update",e.pivotButtonUpdate="pivot-button-update",e.initCalculatedField="init-calculatedfield",e.click="click",e.ErrorDialog=Z,e.FilterDialog=$,e.PivotContextMenu=H,e.PivotEngine=u,e.PivotUtil=c,e}({},ej.base,ej.data,ej.popups,ej.grids,ej.excelexport,ej.pdfexport,ej.navigations,ej.inputs,ej.dropdowns,ej.calendars,ej.buttons),this.ejs=ej;
//# sourceMappingURL=ej2-pivotview.min.js.map
